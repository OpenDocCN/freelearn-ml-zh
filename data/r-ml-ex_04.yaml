- en: Chapter 3. Predicting Customer Shopping Trends with Market Basket Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章. 使用市场篮子分析预测客户购物趋势
- en: After the previous [Chapter 2](part0022_split_000.html#KVCC1-973e731d75c2419489ee73e3a0cf4be8
    "Chapter 2. Let's Help Machines Learn"), *Let's Help Machine Learn*, you now know
    how to make machines learn from observations and data points so that they can
    find out interesting patterns, trends, and make predictions. In this chapter,
    we will be dealing with one of the complex problems faced by retailers, stores,
    and e-commerce marketplaces today. With the advent of modern technology and innovations,
    shopping has become a relatively pleasant and enjoyable experience which we can
    enjoy from the comfort of our home, without even venturing to an actual store,
    using the web or dedicated apps which provide shopping facilities. With a humongous
    number of retailers, stores, marketplaces, and sellers, competition is pretty
    stiff, and to attract customers, they have to use all the data they can gather
    from consumers about their personal traits and shopping patterns, and use machine
    learning techniques to try and make shopping experiences as personalized as possible
    based on each customer.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章[第2章](part0022_split_000.html#KVCC1-973e731d75c2419489ee73e3a0cf4be8 "第2章.
    让我们帮助机器学习")之后，“让我们帮助机器学习”，你现在知道如何让机器从观察和数据点中学习，以便它们可以发现有趣的模式、趋势并进行预测。在本章中，我们将处理零售商、商店和电子商务市场今天面临的一个复杂问题。随着现代技术和创新的兴起，购物已经变成了一种相对愉快和享受的体验，我们可以在家中舒适地享受这种体验，甚至无需冒险去实体店，只需使用提供购物功能的网络或专用应用程序。由于有大量的零售商、商店、市场和服务商，竞争相当激烈，为了吸引顾客，他们必须使用他们能从消费者那里收集到的关于他们个人特征和购物模式的所有数据，并使用机器学习技术尝试使购物体验尽可能个性化，基于每个顾客。
- en: 'You might be wondering how machine learning can help in making shopping experiences
    personalized for each user! The answer lies in two things: data and algorithms.
    Using a combination of both of these, retailers are able to figure out what are
    the most trending items that the consumers buy, the likes and dislikes of the
    customers, the peak times when the sales go up and come down, the trending combination
    of products which people tend to buy, and the product reviews and prices which
    are being offered by other retailers for the same products. Retailers have their
    own data science teams which aggregate this data and apply various machine learning
    algorithms which are used to analyze the trending products and build recommender
    engines which predict what the customers are most likely to buy, and give recommendations
    to the customers based on their interests and shopping history.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能想知道机器学习如何帮助为每个用户个性化购物体验！答案在于两个方面：数据和算法。通过结合这两者，零售商能够找出消费者购买的最热门商品，客户的喜好和厌恶，销售上升和下降的峰值时间，人们倾向于购买的产品趋势组合，以及其他零售商提供的相同产品的产品评论和价格。零售商有自己的数据科学团队，他们汇总这些数据并应用各种机器学习算法，这些算法用于分析趋势产品并构建推荐引擎，预测客户最有可能购买的产品，并根据他们的兴趣和购物历史向客户提供建议。
- en: 'In this chapter, we will be focusing on product based recommendations where
    the algorithms focus on customer shopping transactional data, where we observe
    common patterns of product combinations bought by the customers, to detect and
    predict what products customers are most likely to buy and what they have bought
    in the past. The main techniques we will be focusing on in this chapter are as
    follows:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将重点关注基于产品的推荐，其中算法专注于客户购物交易数据，我们观察到客户购买的产品组合的常见模式，以检测和预测客户最有可能购买的产品以及他们过去购买的产品。本章我们将重点关注以下技术：
- en: Product contingency matrix evaluation
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品条件矩阵评估
- en: Frequent itemsets generation
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 频繁项集生成
- en: Association rule mining
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关联规则挖掘
- en: Trend analysis using association rules and pattern mining however have their
    own limitations. They do not provide a more personalized shopping experience for
    each customer based on attributes like their interests, products they have bought
    and rated. We will be looking at that in the subsequent chapter where we focus
    on algorithms such as user-based collaborative filtering, which takes into account
    both product based and user based features when building recommender engines.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，使用关联规则和模式挖掘进行趋势分析有其局限性。它们不能根据客户的兴趣、他们购买和评价的产品等属性为每位客户提供更加个性化的购物体验。我们将在下一章中探讨这一点，我们将专注于用户基于协同过滤等算法，这些算法在构建推荐引擎时既考虑基于产品的特征，也考虑基于用户的特点。
- en: What is most interesting is that all the retailers and e-commerce marketplaces,
    such as Staples, Macy's, Target, Amazon, Flipkart, Alibaba, Rakuten, Lazada, and
    many many others, have their own data science teams, which solve a wide variety
    of problems including the one we discussed earlier. They make use of all the data
    generated from customer shopping transactions, product stocks, deliveries, SLAs,
    reviews, advertisements, click-through rates, bounce rates, pricing data, and
    many other sources. They process this data and feed it into their machine learning
    algorithm based engines to generate data driven insights to increase sales and
    profits for the business. Now this is definitely one domain which is hot in the
    market right now. Let's now look further into some of the machine learning techniques
    and algorithms which help them in making such great data driven decisions!
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 最有趣的是，所有零售商和电子商务平台，例如Staples、Macy's、Target、Amazon、Flipkart、Alibaba、Rakuten、Lazada以及许多其他公司，都有自己的数据科学团队，这些团队解决包括我们之前讨论过的问题在内的各种问题。他们利用从客户购物交易、产品库存、配送、服务等级协议（SLAs）、评论、广告、点击率、跳出率、定价数据以及许多其他来源生成的大量数据。他们处理这些数据，并将其输入到基于机器学习的算法引擎中，以生成数据驱动的洞察力，从而提高业务的销售和利润。现在这无疑是市场上目前非常热门的一个领域。现在让我们进一步探讨一些帮助他们在做出如此伟大的数据驱动决策时使用的机器学习技术和算法！
- en: Detecting and predicting trends
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测和预测趋势
- en: In this section, we will talk about what exactly we mean by trends and how the
    retailers detect and predict these trends. Basically, a trend in the retail context
    can be defined as a specific pattern or behavior which occurs over a period of
    time. This may involve a product or a combination of products being sold out in
    a very short period of time or even the reverse. A simple example would be a best-selling
    smartphone being prebooked and out of stock before even hitting the shelves on
    any e-commerce marketplace, or a combination of products like the classic beer
    and diapers combination which is frequently found in shopping baskets or carts
    of customers!
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论我们所说的“趋势”究竟是什么，以及零售商如何检测和预测这些趋势。基本上，在零售环境中，趋势可以被定义为在一定时期内发生的一种特定模式或行为。这可能涉及在非常短的时间内售罄的产品或产品组合，甚至相反的情况。一个简单的例子就是一款热销智能手机在甚至上架到任何电子商务平台之前就被预订并售罄，或者像经典啤酒和尿布组合这样的产品组合，这在客户的购物篮或购物车中经常被找到！
- en: How can we even start analyzing shopping carts or start to detect and predict
    shopping trends. Like I mentioned earlier, we can achieve this with a combination
    of the right data and algorithms. Let's assume that we are heading a large retail
    chain. First we will have to keep track of each and every transaction which is
    taking place from our stores and website. We will need to gather data points relevant
    to the items being purchased, stockouts, combinations of items purchased together,
    and customer transactions to begin with.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何甚至开始分析购物车或开始检测和预测购物趋势呢？就像我之前提到的，我们可以通过结合正确的数据和算法来实现这一点。假设我们领导着一个大型零售连锁店。首先，我们必须跟踪我们商店和网站上发生的每一笔交易。我们需要收集与购买的商品、缺货、一起购买的商品组合以及客户交易相关的数据点，作为开始。
- en: Once we have this data, we can start processing, normalizing, and aggregating
    this data to machine readable formats, which can be easily operated on and fed
    to machine learning algorithms for product recommendations based on the shopping
    trends. We can achieve this by using the right data structures and constructs
    which we learned back in [Chapter 1](part0014_split_000.html#DB7S2-973e731d75c2419489ee73e3a0cf4be8
    "Chapter 1. Getting Started with R and Machine Learning"), *Getting Started with
    R and Machine Learning*. There are several machine learning algorithms which help
    us in analyzing the shopping transactional data and recommending products based
    on the shopping trends. The main paradigm under which these algorithms fall is
    popularly known as **market basket analysis**. Interestingly, these algorithms
    use statistical and machine learning concepts such as probability, support, confidence,
    lift, pattern detection, and many more to determine what are the items being bought
    together frequently, which helps us in analyzing shopping transactions and detecting
    and predicting trends. This ultimately helps us in making product recommendations
    for the customers and also making business decisions wisely, if we were running
    a retail chain! Do note that the only data we will be using in both these algorithms
    is pure shopping transactions based data.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们有了这些数据，我们就可以开始处理、归一化和汇总这些数据到机器可读的格式，这些格式可以轻松操作并输入到机器学习算法中，以基于购物趋势进行产品推荐。我们可以通过使用我们在[第1章](part0014_split_000.html#DB7S2-973e731d75c2419489ee73e3a0cf4be8
    "第1章。使用R和机器学习入门")，“使用R和机器学习入门”中学到的合适的数据结构和构造来实现这一点。有几个机器学习算法可以帮助我们分析购物交易数据，并根据购物趋势推荐产品。这些算法主要遵循的范式通常被称为**市场篮子分析**。有趣的是，这些算法使用统计和机器学习概念，如概率、支持度、置信度、提升度、模式检测等，来确定哪些商品经常一起购买，这有助于我们分析购物交易、检测和预测趋势。这最终帮助我们为客户做出产品推荐，如果我们经营着一家零售连锁店，还可以明智地做出商业决策！请注意，在这两个算法中，我们将使用的数据仅基于纯购物交易数据。
- en: Before we start diving into building algorithms to analyze the shopping carts
    and transactions, let us first see what market basket analysis actually means
    and the concepts associated with it. This will come in handy later on, when we
    implement machine learning algorithms using some of these concepts to solve real
    world problems.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始构建算法来分析购物车和交易之前，让我们首先看看市场篮子分析实际上意味着什么以及与之相关的概念。这将在我们稍后使用这些概念中的某些来实现机器学习算法以解决现实世界问题时派上用场。
- en: Market basket analysis
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 市场篮子分析
- en: Market basket analysis consists of some modeling techniques which are typically
    used by retailers and e-commerce marketplaces to analyze shopping carts and transactions
    to find out what customers buy the most, what kind of items they buy, what the
    peak season is for specific items to be sold the most, and so on. We will be focusing
    on item based transactional patterns in this chapter for detecting and predicting
    what items people are buying and are most likely to buy. Let us first look at
    the formal definition of market basket analysis and then we will look at core
    concepts, metrics, and techniques tied to it. Finally, we will conclude with how
    to actually use these results to make data driven decisions.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 市场篮子分析包括一些建模技术，这些技术通常由零售商和电子商务市场用来分析购物车和交易，以找出顾客购买最多的是什么，他们购买的商品类型，特定商品销售最旺盛的旺季是什么，等等。在本章中，我们将关注基于商品的交易模式，以检测和预测人们购买的商品以及他们最有可能购买的商品。让我们首先看看市场篮子分析的形式定义，然后我们将探讨与之相关的核心概念、指标和技术。最后，我们将总结如何实际使用这些结果来做出数据驱动的决策。
- en: What does market basket analysis actually mean?
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 市场篮子分析实际上意味着什么？
- en: Market basket analysis typically encompasses several modeling techniques based
    upon the simple principle that while shopping if you buy a certain group of items
    (also known as an itemset in machine learning lingo), you are likely to buy an
    other specific item or items along with that itemset. We analyze human shopping
    patterns and apply statistical techniques to generate frequent itemsets. These
    itemsets contain combination of items that people are most likely to buy together,
    based on past shopping history.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 市场篮子分析通常包括基于这样一个简单原则的几种建模技术：在购物时，如果你购买一组特定的商品（在机器学习术语中称为项集），你很可能还会购买与该项集相关的其他特定商品。我们分析人类的购物模式，并应用统计技术来生成频繁项集。这些项集包含人们最有可能一起购买的商品组合，基于过去的购物历史。
- en: A simple example of an itemset would be people buying beer and diapers frequently
    at the market. The itemset can be depicted as `{ beer, diapers }`. A frequent
    itemset is indicated by an itemset which occurs more frequently than usual and
    is specified by a metric known as support, which we will be talking about later
    on. Hence, from the preceding example you can say that if I buy beer, I am also
    most likely to buy `diapers`, and recommend that product to me. We can also build
    item association rules on top of these itemsets by analyzing shopping purchases.
    An example association rule can be denoted by using itemsets using the notation,
    `{ beer, diapers } -> { milk }` which would indicate that if I am buying beer
    and diapers together, I am most likely to also purchase milk along with that!
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的项集例子就是人们在市场上经常同时购买啤酒和尿布。这个项集可以表示为 `{ beer, diapers }`。频繁项集是指比通常发生频率更高的项集，它由一个称为支持度的度量来指定，我们稍后会讨论这个度量。因此，从先前的例子中，你可以得出结论，如果我买了啤酒，我也很可能会买
    `diapers`，并推荐这个产品给我。我们还可以通过分析购物购买来在这些项集之上建立项关联规则。一个关联规则的例子可以用项集表示，记作 `{ beer,
    diapers } -> { milk }`，这表示如果我同时购买啤酒和尿布，我很可能还会购买牛奶！
- en: Core concepts and definitions
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 核心概念和定义
- en: Now that you know what market basket analysis actually does, let us look at
    some definitions and concepts which are widely used in the algorithms and techniques.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经知道了市场篮子分析实际上做什么，让我们来看看在算法和技术中广泛使用的定义和概念。
- en: '**Transactional datasets** indicate databases or datasets where the customer''s
    shopping transactions are recorded daily/weekly and consist of various items bought
    together by the customers. We will take an example transactional dataset which
    we will also be using later on in the chapter for our algorithms. Consider the
    following dataset, which you can also get from the `shopping_transaction_log.csv`
    file for this chapter. The data is represented in the following figure:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**事务数据集**指的是记录客户每日/每周购物交易的数据库或数据集，包括客户一起购买的各种商品。我们将举一个例子，这个例子我们将在本章的算法中再次使用。考虑以下数据集，你也可以从本章的
    `shopping_transaction_log.csv` 文件中获取这个数据集。数据如下图所示：'
- en: '![Core concepts and definitions](img/00078.jpeg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![核心概念和定义](img/00078.jpeg)'
- en: Each cell in the preceding dataset is also defined as an item. Items are also
    denoted by the symbol In where `n` denotes the `n-th` item number, and examples
    are enclosed in curly braces in formal definitions and when building algorithm
    pseudocode or doing some computations by hand. For example, cell combination `(1,
    A)` indicates item `I1` whose value is depicted as `{ beer }`.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的数据集中的每个单元格也被定义为项。项也用符号 In 表示，其中 `n` 表示第 `n` 个项号，例子在正式定义和构建算法伪代码或手动进行一些计算时用花括号括起来。例如，单元格组合
    `(1, A)` 表示项 `I1`，其值表示为 `{ beer }`。
- en: '**Itemsets** are defined as sets or groups of items which were bought together
    in any shopping transaction. Hence, these items are said to co-occur based on
    the transactions. We will denote itemsets as `ISn` where *n* denotes the `n-th`
    itemset number. The itemset values will will be enclosed in curly braces. Each
    row in the preceding dataset denotes a particular transaction and the combination
    of items form the itemsets. The itemset `IS1` is depicted by `{ beer, diapers,
    bread }`.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '**项集**被定义为在任意购物交易中一起购买的项的集合或组。因此，这些项根据交易被认为是共同出现的。我们将项集表示为 `ISn`，其中 *n* 表示第
    `n` 个项集号。项集值将被括在花括号中。前面数据集中的每一行表示一个特定的交易，项的组合形成项集。项集 `IS1` 表示为 `{ beer, diapers,
    bread }`。'
- en: '**Association** **rules** or just rules are statements which have a **left-hand
    side** (**LHS**) and a **right-hand side** (**RHS**), and indicate that if we
    have the items on the LHS for purchase, we are likely to be interested in purchasing
    the RHS items too. This signifies that the itemsets are associated with each other.
    They are denoted as `ISx → ISy`, which means that if I have itemset `x` in my
    shopping cart, I will also be interested in purchasing itemset `y` along with
    it. An example rule can be `{ beer } → { diapers }` which indicates that if I
    have beer in my cart, there is a chance I will buy diapers too! We will now see
    some metrics which determine how to measure frequent itemsets and the strength
    of the association rules.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**关联规则**或简称规则是具有**左侧**（**LHS**）和**右侧**（**RHS**）的陈述，表明如果我们购买左侧的物品，我们很可能也会对购买右侧的物品感兴趣。这表明项集相互关联。它们表示为
    `ISx → ISy`，这意味着如果我的购物车中有项集 `x`，我也会对购买与之一起的项集 `y` 感兴趣。一个例子规则可以是 `{ beer } → {
    diapers }`，这表明如果我的购物车中有啤酒，我也有可能购买尿布！我们现在将看到一些指标，这些指标决定了如何衡量频繁项集和关联规则的力量。'
- en: The **frequency** of an itemset is basically the number of times a particular
    itemset occurs in the list of all transactions. Do note that the itemset can be
    a subset of a larger itemset in the transactions and still be counted because
    the subset denotes that the itemset containing the specific set of items was bought
    along with some other products. We can denote it as `f(ISn)`, where `ISn` is a
    particular itemset and function `f( )` gives us the frequency of that itemset
    in the whole transactional based dataset. Taking our previous dataset, `f(IS{beer,
    diapers})` is six, which indicates `IS{beer, diapers}` has been purchased six
    times in total out of all the transactional data in our dataset.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 项集的**频率**基本上是指特定项集在所有事务列表中出现的次数。请注意，项集可以是事务中较大项集的子集，仍然可以计数，因为子集表示包含特定物品集合的项集与其他产品一起被购买。我们可以用
    `f(ISn)` 来表示它，其中 `ISn` 是特定的项集，函数 `f( )` 给出该项集在整个基于事务的数据集中的频率。以我们之前的示例数据集为例，`f(IS{beer,
    diapers})` 是六，这表明 `IS{beer, diapers}` 在我们的数据集中的所有事务数据中总共被购买了六次。
- en: The **support** of an itemset is defined as the fraction of transactions in
    our transactional dataset which consists of that particular itemset. Basically,
    it means the number of times that itemset was purchased divided by the total number
    of transactions in the dataset. It can be denoted as ![Core concepts and definitions](img/00079.jpeg),
    where `S( )` denotes the support of the itemset `ISn`. Taking our preceding example,
    `S(IS{beer, diapers})` is ![Core concepts and definitions](img/00080.jpeg) which
    gives us `66.67%`. The support for an association rule is similar and can be depicted
    as ![Core concepts and definitions](img/00081.jpeg), where we use the intersection
    operator to see the frequency of both the itemsets occurring together in the transactional
    dataset. The support for the rule we defined earlier, `S(IS{beer} → IS{diapers})`,
    is once again ![Core concepts and definitions](img/00080.jpeg) or `66.67%` because
    the itemset combining beer and diapers occurs six times in total, as we saw earlier.
    When evaluating results from association rules or frequent itemsets, the higher
    the support, the better it is. Support is more about measuring the quality of
    rules detecting what has already happened from the past transactions.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 项集的**支持度**定义为我们的事务数据集中包含该特定项集的事务的分数。基本上，这意味着该项集被购买次数除以数据集中的事务总数。它可以表示为 ![核心概念和定义](img/00079.jpeg)，其中
    `S( )` 表示项集 `ISn` 的支持度。以我们之前的例子为例，`S(IS{beer, diapers})` 是 ![核心概念和定义](img/00080.jpeg)，这给出了
    `66.67%` 的支持度。关联规则的支持度类似，可以表示为 ![核心概念和定义](img/00081.jpeg)，其中我们使用交集运算符来查看事务数据集中两个项集同时出现的频率。我们之前定义的规则
    `S(IS{beer} → IS{diapers})` 的支持度再次是 ![核心概念和定义](img/00080.jpeg) 或 `66.67%`，因为啤酒和尿布组合的项集总共出现了六次，正如我们之前看到的。在评估关联规则或频繁项集的结果时，支持度越高，越好。支持度更多地是关于衡量规则检测过去交易中已经发生的事情的质量。
- en: The **confidence** of an association rule is defined as the probability or likelihood
    that, for a new transaction containing itemset in the LHS of the rule, the transaction
    also contains the itemset on the RHS of the rule. The confidence for a rule can
    be depicted as ![Core concepts and definitions](img/00082.jpeg), where `C( )`
    denotes the confidence of the rule. Do note that since calculation of support
    involves dividing itemset frequency by the total number of transactions in the
    denominator, the RHS of the preceding equation ultimately reduces to getting the
    frequency of the itemsets for both the numerator and denominator. Thus we get
    ![Core concepts and definitions](img/00083.jpeg) as the reduced formula for getting
    confidence. The confidence for our earlier rule `C(IS{beer} → IS{diapers})` is
    ![Core concepts and definitions](img/00084.jpeg) or `100%`, which means the probability
    of buying diapers, if I have beer in my shopping basket, is a hundred percent!
    That is pretty high and if you go back to the dataset, you can see that it is
    true because for every transaction involving beer, we can see diapers associated
    with it. Thus, you can see that making predictions and recommendations is not
    rocket science but just simple applied math and statistical methods on top of
    data. Remember that confidence is more about detecting the quality of rules predicting
    what can happen in the future based on the past transactional data.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 关联规则的**置信度**定义为对于包含规则左侧项集的新事务，该事务也包含规则右侧项集的概率或可能性。一个规则的置信度可以表示为![核心概念和定义](img/00082.jpeg)，其中`C(
    )`表示规则的置信度。请注意，由于支持率的计算涉及将项集频率除以分母中的事务总数，前面方程的右侧最终简化为获取分子和分母中项集的频率。因此，我们得到![核心概念和定义](img/00083.jpeg)作为获取置信度的简化公式。我们之前规则的置信度`C(IS{beer}
    → IS{diapers})`是![核心概念和定义](img/00084.jpeg)或`100%`，这意味着如果我的购物篮里有啤酒，购买尿布的概率是百分之百！这相当高，如果你回到数据集，你可以看到这是真的，因为对于涉及啤酒的每一笔交易，我们都可以看到与之相关的尿布。因此，你可以看到，进行预测和推荐并不是火箭科学，只是基于数据应用简单的数学和统计方法。记住，置信度更多地是关于检测基于过去交易数据预测未来可能发生的事情的规则质量。
- en: The **lift** of an association rule is defined as the ratio of the support of
    the combination of two itemsets on the LHS and RHS together divided by the product
    of the support of each of the itemsets. The lift for a rule can be depicted as
    ![Core concepts and definitions](img/00085.jpeg), where `L( )` denotes the lift
    of the rule. For our example rule, `L(IS{beer} → IS{diapers})` is, ![Core concepts
    and definitions](img/00086.jpeg) which evaluates to ![Core concepts and definitions](img/00087.jpeg)
    giving us the value of `1.125` which is pretty decent! The lift of a rule in general
    is another metric to evaluate the quality of the rule. If the lift is `> 1` then
    it indicates that the presence of the itemset in the LHS is responsible for the
    increase in probability that the customer is also going to buy the itemset on
    the RHS. This is another very important way to determine itemset associations
    and which items influence people to buy other items, because if the lift has a
    value `= 1`, it means that the itemsets on the LHS and RHS are independent and
    buying one itemset will not affect the customer to buy the other itemset. If the
    lift is `< 1`, it indicates that if the customer has an itemset on the LHS then
    the probability of buying the itemset on the RHS is relatively low.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 关联规则的**提升度**定义为左侧（LHS）和右侧（RHS）两个项集组合的支持率之和与每个项集支持率乘积的比值。一个规则的提升度可以表示为![核心概念和定义](img/00085.jpeg)，其中`L(
    )`表示规则的提升度。对于我们的示例规则`L(IS{beer} → IS{diapers})`，![核心概念和定义](img/00086.jpeg)评估结果为![核心概念和定义](img/00087.jpeg)，得到值为`1.125`，这是一个相当不错的值！一般来说，规则的提升度是衡量规则质量的一个指标。如果提升度`>
    1`，则表示左侧项集的存在导致客户购买右侧项集的概率增加。这是确定项集关联和哪些商品影响人们购买其他商品的一种非常重要的方式，因为如果提升度的值为`= 1`，则表示左侧和右侧的项集是独立的，购买一个项集不会影响客户购买另一个项集。如果提升度`<
    1`，则表示如果客户在左侧有一个项集，那么购买右侧项集的概率相对较低。
- en: Techniques used for analysis
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 用于分析的技术
- en: If you have been overwhelmed by all the mathematical information in the previous
    section, just relax and take a deep breath! You do not need to remember everything
    because most of the time, the algorithms will compute everything for you! The
    thing where you need to be good at is using these techniques and algorithms in
    the right way and interpreting the results to filter out what is necessary and
    useful. The earlier mentioned concepts will help you when you start implementing
    and applying the techniques later on, which we will briefly describe in this section.
    We will mainly be talking about three techniques which we will be exploring in
    this chapter.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你被上一节中所有的数学信息压倒了，那就放松一下，深呼吸！你不需要记住所有东西，因为大多数时候，算法会为你计算一切！你需要擅长的是正确使用这些技术和算法，并解释结果以筛选出必要和有用的信息。前面提到的概念将在你开始实施和应用技术时有所帮助，我们将在本节中简要描述这些技术。我们将主要讨论三种技术，我们将在本章中探讨这些技术。
- en: Evaluation of a product contingency matrix is the simplest approach to start
    with, which is more of a global trend capturing mechanism and shows the top most
    products that are being bought together in a contingency matrix. The R package
    `arules`, which we will be using later on, has a nice function called **crossTable**
    which helps in cross-tabulating the joint occurrences across pairs of items into
    a contingency matrix. We will use this matrix to predict which products the customers
    would most likely buy with some other product from the matrix.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 产品应急矩阵的评估是最简单的起点，它更多的是一种全局趋势捕捉机制，并在应急矩阵中显示一起购买的最顶级产品。我们稍后将使用的R包`arules`有一个名为**crossTable**的不错函数，它有助于将成对项目的联合发生情况交叉制表到应急矩阵中。我们将使用这个矩阵来预测客户最有可能与矩阵中的某些其他产品一起购买的产品。
- en: Frequent itemset generation takes off from where product contingency matrix
    stops, because it has a severe limitation of not being able to deal with pairs
    of products at any point in time. Hence, to get into itemsets which can have any
    number of products and detect patterns from there, we will be building our own
    frequent itemset generator using machine learning! Using this, we will be able
    to get frequent itemsets with specific support values indicating the sets of items
    likely to be purchased together, and hence forming the basis of recommending products
    to the customers.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 频繁项集生成从产品应急矩阵的停止点开始，因为它有一个严重的限制，即在任何时间点都无法处理成对的产品。因此，为了进入可以包含任意数量产品的项集并从中检测模式，我们将使用机器学习构建自己的频繁项集生成器！使用这个工具，我们将能够获取具有特定支持值的频繁项集，这些项集表示可能一起购买的项目集合，从而为客户推荐产品的基础。
- en: Finally, we will be implementing association rule mining using the wonderful
    Apriori algorithm which uses frequent itemsets as a part of its rule generation
    process. You have already seen a demo of this in the [Chapter 2](part0022_split_000.html#KVCC1-973e731d75c2419489ee73e3a0cf4be8
    "Chapter 2. Let's Help Machines Learn"), *Let's Help Machines Learn*. However,
    this time we will be using its full-fledged capabilities to view the association
    rules between product itemsets, evaluating the quality of the rules using the
    metrics we discussed earlier, and also using these rules to make trend predictions
    and recommendations for products in shopping transactions.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将使用神奇的Apriori算法实现关联规则挖掘，该算法将频繁项集作为其规则生成过程的一部分。你已经在[第2章](part0022_split_000.html#KVCC1-973e731d75c2419489ee73e3a0cf4be8
    "第2章。让我们帮助机器学习")中看到了这个演示，*让我们帮助机器学习*。然而，这次我们将使用其全部功能来查看产品项集之间的关联规则，使用我们之前讨论的指标来评估规则的质量，并使用这些规则对购物交易中的产品进行趋势预测和推荐。
- en: Making data driven decisions
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于数据的决策
- en: You now know what market basket analysis is, what techniques are used for it,
    and what results they give us. Remember that the output of market basket analysis
    is a set of items or products which co-occur frequently in transactions. Now this
    can happen because of strong support, confidence, and lift which boost its association
    and the customers tend to buy them, or it could also be because the retailer has
    placed the items together or side by side in the store or website. However, do
    remember that strong associations do not always happen just by chance and that
    is what the retailers are always trying to find out using the techniques we talked
    about earlier to boost sales.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在已经知道了市场篮子分析是什么，用于它的技术有哪些，以及它们能给我们带来什么结果。记住，市场篮子分析的结果是一组在交易中频繁共同出现的商品或产品。这可能是因为强大的支持度、置信度和提升度增强了其关联性，顾客倾向于购买它们，或者也可能是零售商将商品放置在商店或网站中一起或并排。然而，务必记住，强大的关联性并不总是偶然发生的，这正是零售商一直在试图通过我们之前讨论的技术来找出以提升销售额。
- en: 'The following are some crucial data driven decisions which the retailers usually
    tend to take based on the results obtained from market basket analysis:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些基于市场篮子分析结果，零售商通常倾向于采取的一些关键数据驱动决策：
- en: Frequent itemsets containing pairs of products such as diapers and beer should
    be typically placed side by side in the store, which would give customers easy
    access and they would tend to buy them more.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应将包含如尿布和啤酒这样的产品对的频繁项集通常放置在商店中并排，这将使顾客容易访问，并且他们倾向于购买更多。
- en: Frequent itemsets which have a large number of distinct items or product counts
    should be placed in a specific category or theme for the itemset, such as special
    grocery combos or baby products. Discounts offered on the whole itemset attracts
    more customers.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应将包含大量不同商品或产品计数的频繁项集放置在特定类别或主题中，例如特殊的杂货组合或婴儿产品。对整个项集提供的折扣会吸引更多顾客。
- en: Association rules having a long list of items in the itemset or products obtained
    from frequent itemsets or contingency matrices can be shown as product suggestions
    and recommendations to the customers, in specific product pages associated with
    the itemsets, when they browse the shopping or e-commerce website. Care should
    be taken that the lift of these rules be greater than 1 at least, like we discussed
    earlier.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 来自频繁项集或关联矩阵的具有长列表的商品或产品项集的关联规则可以显示为产品建议和推荐，当顾客浏览购物或电子商务网站时，在特定于项集的产品页面上。应注意，这些规则的提升度至少应大于1，就像我们之前讨论的那样。
- en: Recommendation systems, targeted advertising, and marketing everything can be
    built upon the results obtained from market basket analysis.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以基于市场篮子分析的结果构建推荐系统、定向广告和营销等。
- en: These decisions if made at the right place and right time can help the retailers
    immensely in boosting their sales and making good profits.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在正确的时间和地点做出这些决策，将极大地帮助零售商提升销售额和获得良好的利润。
- en: Now that we have a solid grasp of what market basket analysis actually does
    and how it works, we will start by building a simple algorithm for our first technique,
    where we make product recommendations using a product contingency matrix based
    on top trending products purchased in a supermarket, and then move on to building
    more sophisticated analyzers and recommenders using powerful machine learning
    capabilities of the R language.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对市场篮子分析实际上做什么以及它是如何工作的有了坚实的理解，我们将从构建第一个技术的一个简单算法开始，即使用超市中购买的热门产品的产品关联矩阵进行产品推荐，然后继续构建更复杂的分析器和推荐器，利用R语言的强大机器学习功能。
- en: Evaluating a product contingency matrix
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估产品关联矩阵
- en: We will be doing a couple of things here. First, we will analyze a small toy
    dataset belonging to a supermarket, by using a product contingency matrix of product
    pair purchases based on their frequency. Then we will move on to contingency matrices
    based on other metrics such as support, lift, and so on by using another dataset.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里将做几件事情。首先，我们将通过使用基于产品对购买频率的产品关联矩阵，分析一个属于超市的小型玩具数据集。然后我们将使用另一个数据集，通过支持度、提升度等其他指标构建关联矩阵。
- en: 'The data for our first matrix consists of the six most popular products sold
    at the supermarket and also the number of times each product was sold by itself
    and in combination with the other products. We have the data in the form of a
    data table captured in a `csv` file, as you can see in the following figure:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们第一个矩阵的数据包括超市销售的六种最受欢迎的产品，以及每种产品单独销售和与其他产品组合销售的次数。我们以`csv`文件的形式拥有这些数据，如图所示：
- en: '![Evaluating a product contingency matrix](img/00088.jpeg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![评估产品列联表](img/00088.jpeg)'
- en: To analyze this data, we first need to understand what it depicts. Basically,
    each cell value denotes the number of times that product combination was sold.
    Thus, the cell combination `(1, A)` denotes the product combination `(milk, milk)`,
    which is basically the number of times milk was bought. Another example is the
    cell combination `(4, C)` which is analogous to cell combination `(3, D)` which
    indicates the number of times bread was bought along with butter. This is also
    often known as a contingency matrix and in our case it is a product contingency
    matrix since it deals with product data. Let us follow our standard machine learning
    pipeline of getting the data, analyzing it, running it on our algorithm, and getting
    the intended results.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 为了分析这些数据，我们首先需要了解它描述了什么。基本上，每个单元格的值表示该产品组合被售出的次数。因此，单元格组合 `(1, A)` 表示产品组合 `(牛奶,
    牛奶)`，这基本上是牛奶被购买的次数。另一个例子是单元格组合 `(4, C)`，它与单元格组合 `(3, D)` 相似，表示购买黄油时面包被购买的次数。这通常也被称为列联表，在我们的案例中，它是一个产品列联表，因为它处理产品数据。让我们遵循我们的标准机器学习流程，获取数据，分析它，在我们的算法上运行它，并获取预期的结果。
- en: Getting the data
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取数据
- en: '[PRE0]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Output:**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Getting the data](img/00089.jpeg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![获取数据](img/00089.jpeg)'
- en: Analyzing and visualizing the data
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析并可视化数据
- en: 'Here, we will do some exploratory analysis of the dataset to see what kind
    of story the data tells us. For that, we will first look at the transactions related
    to buying milk and bread in the following code snippet:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将对数据集进行一些探索性分析，看看数据告诉我们什么样的故事。为此，我们首先将查看以下代码片段中与购买牛奶和面包相关的交易：
- en: '[PRE2]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Thus, you can see that just by sorting the data columns we are able to see the
    top products which were bought in combination with bread or with milk. When recommending
    top products to buy from the matrix, we will remove the product from the recommendation
    list if that product is in the shopping cart already, because, if I buy bread,
    it makes no sense to recommend bread to me. Now, we will visualize the complete
    dataset using a mosaic plot. Do note that the product combinations which were
    bought very frequently will have high frequency values and will be indicated by
    a significant area in the mosaic plot.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，你可以看到，仅仅通过排序数据列，我们就能看到与面包或牛奶一起购买的顶级产品。在从矩阵中推荐顶级产品时，如果该产品已经在购物车中，我们将从推荐列表中删除该产品，因为，如果我买了面包，向我推荐面包就没有意义了。现在，我们将使用mosaic图可视化整个数据集。请注意，购买频率非常高的产品组合将具有高频率值，并在mosaic图中用显著区域表示。
- en: '[PRE3]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The code generates the following mosaic plot where we apply a gradient using
    the color parameter and specify that axis labels be at right angles to the axis
    using the `las` parameter to make a cleaner plot.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 代码生成了以下mosaic图，我们使用颜色参数应用渐变，并使用`las`参数指定轴标签与轴成直角，以制作更干净的图形。
- en: '![Analyzing and visualizing the data](img/00090.jpeg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![分析并可视化数据](img/00090.jpeg)'
- en: From the preceding plot you can note that it is now very easy to see which products
    were bought a large number of times in combination with another product. Ignoring
    the same product row and column values, we can easily deduce that product combinations
    such as beer and diapers were bought very frequently!
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的图中你可以注意到，现在很容易看出哪些产品与其他产品一起被大量购买。忽略相同的产品行和列值，我们可以轻松推断出像啤酒和尿布这样的产品组合被频繁购买！
- en: Note
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The background story about our beer – diapers combination was actually discovered
    by Walmart sometime back when they analyzed customer transactional data to find
    that, on Fridays, young American dads tend to buy beer and diapers together. They
    would celebrate the weekend with their friends but, having fathered an offspring,
    they also carried out essential duties of taking care of their children's needs.
    In fact, Walmart placed beer and diapers side by side in stores and their sales
    went up significantly! This is the power of analytics and machine learning which
    enables us to find out unknown and unexpected patterns.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 关于我们啤酒-尿布组合的背景故事实际上是在沃尔玛分析客户交易数据时发现的，当时他们发现，在周五，年轻的美国父亲们倾向于一起购买啤酒和尿布。他们会与朋友们庆祝周末，但作为父亲，他们也需要履行照顾孩子需求的基本职责。实际上，沃尔玛将啤酒和尿布并排放置在商店里，其销量显著上升！这正是分析学和机器学习的力量，它使我们能够发现未知和意外的模式。
- en: Global recommendations
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 全球推荐
- en: 'Now we will recommend products based on the product chosen by a customer in
    his shopping cart. Do note that we mention this as global recommendations because
    these product recommendations are neither based on association rules or frequent
    itemsets that we will be exploring after this. They are purely based on the global
    product contingency matrix of product pair purchase counts. The following code
    snippet enables us to recommend the top two suggested products for each item from
    the matrix:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将根据客户购物车中选择的商品推荐产品。请注意，我们将其称为全球推荐，因为这些产品推荐既不是基于关联规则或频繁项集，这些是我们将在之后探讨的。它们纯粹是基于产品对购买计数的全球列联表。以下代码片段使我们能够从矩阵中为每个项目推荐前两个建议的产品：
- en: '[PRE4]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'This gives us the following output:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这给我们以下输出：
- en: '[PRE5]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Thus you can see that, based on the product pair purchases from the contingency
    matrix, we get the top two products which people would tend to buy, based on the
    global trends captured in that matrix. Now we will look at some more ways to generate
    more advanced contingency matrices based on some other metrics.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，你可以看到，基于从列联表中的产品对购买情况，我们得到了人们倾向于购买的前两个产品，这些产品是基于矩阵中捕捉到的全球趋势。现在我们将探讨更多基于其他指标生成更高级列联表的方法。
- en: Advanced contingency matrices
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级列联表
- en: Until now we have just used product contingency matrices based on product purchase
    frequencies. We will now look at creating some more contingency matrices using
    metrics such as support and lift, which we talked about earlier, since they are
    better indicators for items which have a probability of being purchased together
    by customers when shopping. For this we will be using the package `arules` available
    in the **Comprehensive R Archive Network** (**CRAN**) repositories. You can download
    it if not present using the `install.packages('arules')` command. Once it is installed,
    we will look at a standard grocery based transactional log database and build
    the contingency matrices using the standard machine learning methodology that
    we used in the previous chapters to work on any dataset or problem.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们只是使用了基于产品购买频率的产品列联表。现在我们将探讨使用支持度和提升度等指标创建更多列联表，这些指标我们在之前已经讨论过，因为它们是客户在购物时可能一起购买的商品的更好指标。为此，我们将使用**综合R档案网络**（**CRAN**）仓库中可用的`arules`包。如果你没有安装，可以使用`install.packages('arules')`命令下载。一旦安装完成，我们将查看一个基于标准杂货的交易日志数据库，并使用我们在前几章中用于处理任何数据集或问题的标准机器学习方法来构建列联表。
- en: 'First, we will start by loading the required package and the data into our
    workspace and looking at what the transactional data looks like:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将从加载所需的包和数据到我们的工作空间开始，并查看交易数据的样貌：
- en: '[PRE6]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Each preceding transaction is a set of products which were purchased together,
    just as we had discussed in the previous sections. We will now build several contingency
    matrices on different matrices and view the top five product pairs which customers
    would be interested in buying together. The following code snippet shows us a
    count based product contingency matrix:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 每个先前的交易都是一个购买的产品集合，正如我们在前几节中讨论的那样。现在我们将构建几个基于不同矩阵的列联表，并查看客户可能感兴趣一起购买的前五对产品。以下代码片段显示了基于计数的商品列联表：
- en: '[PRE7]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '**Output:**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Advanced contingency matrices](img/00091.jpeg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![高级列联表](img/00091.jpeg)'
- en: 'Here we see a similar matrix to what we had worked with earlier. Now we will
    create a support based product contingency matrix:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这里我们看到的是一个与我们之前工作过的类似的矩阵。现在我们将创建一个基于支持的产品条件矩阵：
- en: '[PRE8]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Output:**'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出结果：**'
- en: '![Advanced contingency matrices](img/00092.jpeg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![高级条件矩阵](img/00092.jpeg)'
- en: Finally, we look at another matrix based on the metric lift which we discussed
    earlier. If you remember, the higher the value of lift, if greater than 1, the
    stronger the chance of both products being bought together by customers.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们来看另一个基于之前讨论的度量提升的矩阵。如果你还记得，提升值越高，如果大于1，客户同时购买两种产品的可能性就越强。
- en: '[PRE9]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '**Output:**'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出结果：**'
- en: '![Advanced contingency matrices](img/00093.jpeg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![高级条件矩阵](img/00093.jpeg)'
- en: From the preceding matrix, you can get such insights as that people tend to
    buy yoghurt and whole milk together, or that soda and whole milk do not really
    go together since it has a lift value less than `1`. These kinds of insights help
    in planning product placement in stores and shopping websites for better sales
    and recommendations.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的矩阵中，你可以得到这样的见解，比如人们倾向于一起购买酸奶和全脂牛奶，或者苏打水和全脂牛奶实际上并不搭配，因为它的提升值小于`1`。这些类型的见解有助于在商店和购物网站上规划产品摆放，以实现更好的销售和推荐。
- en: 'However, some of the main issues with this model are as follows:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这个模型的一些主要问题如下：
- en: High number of products leads to a huge matrix which is difficult to work with
    since it needs more time and space to process.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品数量众多会导致矩阵变得非常大，难以处理，因为它需要更多的时间和空间来处理。
- en: Can detect pairs of items in frequent itemsets only for recommendations. It
    is possible to find out combinations of more than two items from this model but
    that needs additional logic related to set theory.
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只能检测频繁项集中的项目对以进行推荐。从这个模型中可以找到超过两个项目的组合，但这需要与集合理论相关的额外逻辑。
- en: Faces the cold start problem, typically known in recommender engines, which
    happens when a new product is launched and we cannot predict recommendations or
    how it will sell in the market since our historical data does not have any information
    associated with it.
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 面临推荐引擎中通常所说的冷启动问题，当新产品推出时，由于我们的历史数据没有与之相关的任何信息，我们无法预测推荐或它在市场上的销售情况。
- en: Frequent itemset generation
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 频繁项集生成
- en: We will now look at a better technique to find patterns and detect frequently
    bought products. For this, we will be using the frequent itemset generation technique.
    We will be implementing this algorithm from scratch because, even though when
    we solve any machine learning or optimization problem we usually use readymade
    machine learning algorithms out of the box which are optimized and available in
    various R packages, one of the main objectives of this book is to make sure we
    understand what exactly goes on behind the scenes of a machine learning algorithm.
    Thus, we will see how we can build some of these algorithms ourselves using the
    principles of mathematics, statistics, and logic.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将探讨一种更好的技术来寻找模式和检测频繁购买的产品。为此，我们将使用频繁项集生成技术。我们将从头实现这个算法，因为尽管当我们解决任何机器学习或优化问题时，我们通常使用现成的机器学习算法，这些算法经过优化，可在各种R包中使用，但本书的主要目标之一是确保我们了解机器学习算法背后的具体运作。因此，我们将看到如何使用数学、统计学和逻辑原理构建一些这些算法。
- en: Getting started
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开始
- en: The data we will be using for this is the `shopping_transaction_log.csv` dataset
    which we used to explain the concepts of market basket analysis at the beginning
    of the chapter. The code we will be using for this section is available in the
    `ch3_frequent` itemset `generation.R` file. We will first go through all the functions
    and then define the main function which utilizes all the helper functions to define
    a workflow for frequent itemset generation.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用的数据集是`shopping_transaction_log.csv`，我们在本章开头用它来解释市场篮子分析的概念。本节我们将使用的代码可在`ch3_frequent`项集`generation.R`文件中找到。我们首先将遍历所有函数，然后定义主函数，该函数利用所有辅助函数定义频繁项集生成的流程。
- en: 'We will start by loading some library dependencies and utility functions:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先加载一些库依赖项和实用函数：
- en: '[PRE10]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Data retrieval and transformation
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据检索和转换
- en: Next, we will define the functions for getting the data and transforming it
    into the required format of a data frame consisting of products and purchase frequency.
    We also have a function to prune this data frame if we want to remove products
    below a certain purchase frequency threshold.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将定义获取数据和将其转换为包含产品和购买频率的数据框所需格式的函数。我们还有一个函数，如果我们想删除购买频率低于某个阈值的商品，可以修剪这个数据框。
- en: '[PRE11]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Building an itemset association matrix
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建项集关联矩阵
- en: Now, we will implement three functions to help us build the itemset association
    matrix. We start with building the first function, which returns us different
    unique itemset combinations from the list of items in our transactional dataset
    based on the number of items in each itemset passed as a parameter. This helps
    us in getting itemsets of a particular count.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将实现三个函数来帮助我们构建项集关联矩阵。我们首先构建第一个函数，该函数根据每个项集中项的数量，从我们的交易数据集中物品列表中返回不同的唯一项集组合。这有助于我们获取特定数量的项集。
- en: '[PRE12]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The following function builds a frequency contingency table showing the occurrence
    of each itemset in each transaction from the dataset. This forms the basis of
    getting the data for building our frequent itemsets. The itemset association matrix
    shows on a high level the occurrence of the different unique itemsets generated
    in the previous function per transaction in our dataset.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数构建一个频率列联表，显示数据集中每个交易中每个项集的发生情况。这构成了获取构建我们的频繁项集所需数据的基础。项集关联矩阵在高级别上显示了在先前的函数中按交易生成的不同唯一项集的发生情况。
- en: '[PRE13]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Once we have the itemset association matrix, we use it in the following function,
    to sum up these individual itemset occurrences to get the total occurrence of
    each itemset in the whole dataset:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们有了项集关联矩阵，我们就在以下函数中使用它，将这些单个项集发生次数加起来，以获取整个数据集中每个项集的总发生次数：
- en: '[PRE14]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Creating a frequent itemsets generation workflow
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建频繁项集生成工作流程
- en: Finally, we will define the function which will utilize all the previous functions
    to create a workflow for generating the frequent itemsets. The main parameters
    we will be taking here include `data.file.path` which contains the location of
    the dataset, `itemset.combination.nums` which denotes the number of items which
    should be in each itemset, `item.min.freq` which denotes the minimum purchase
    count threshold of each item, and `minsup` which tells us the minimum support
    for the generated frequent itemsets.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将定义一个函数，该函数将利用所有前面的函数来创建生成频繁项集的工作流程。这里我们将使用的主要参数包括`data.file.path`，它包含数据集的位置，`itemset.combination.nums`，它表示每个项集中应包含的项的数量，`item.min.freq`，它表示每个项的最小购买计数阈值，以及`minsup`，它告诉我们生成频繁项集的最小支持度。
- en: '[PRE15]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Detecting shopping trends
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测购物趋势
- en: Now it's time to test our algorithm! We will first generate all the frequent
    itemsets that have two items where each item has been purchased at least three
    times in the overall dataset and have a minimum support of at least 20%. To do
    this, you will have to fire up the following function in the R console. Do remember
    to load all the previous functions in memory first.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是测试我们的算法的时候了！我们首先将生成所有频繁项集，其中包含两个物品，每个物品在整体数据集中至少购买过三次，并且最小支持度至少为20%。为此，你必须在R控制台中运行以下函数。请记住，首先在内存中加载所有前面的函数。
- en: '[PRE16]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: We get the following itemset contingency matrix, which is used to generate the
    frequent itemsets. The left side rows indicate the transactions and each column
    represents an itemset.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下项集列联矩阵，它用于生成频繁项集。左侧的行表示交易，每一列代表一个项集。
- en: '![Detecting shopping trends](img/00094.jpeg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![检测购物趋势](img/00094.jpeg)'
- en: 'The final frequent itemsets will be shown both in the console and in the plot
    section in the form of a pretty table, as follows:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 最终的频繁项集将以漂亮的表格形式在控制台和绘图部分显示，如下所示：
- en: '![Detecting shopping trends](img/00095.jpeg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![检测购物趋势](img/00095.jpeg)'
- en: 'Thus, you can clearly see that the itemset `{beer, diapers}` is our most frequent
    itemset with a support of approximately `67%`, which has occurred six times in
    total in our dataset, and the association matrix shows you the exact transactions
    where it has occurred. Thus, this function detects a trend of people buying beer
    and diapers or diapers and milk more frequently, and thus we can recommend people
    the same when they are shopping. We will also take a look at the frequent itemsets
    containing three items next:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，你可以清楚地看到，项集 `{beer, diapers}` 是我们最频繁的项集，支持率约为 `67%`，在我们的数据集中总共发生了六次，关联矩阵显示了它发生的确切交易。因此，这个功能检测到人们购买啤酒和尿布或尿布和牛奶的频率更高，因此当他们在购物时，我们可以向他们推荐相同的产品。我们还将查看包含三个项目的频繁项集：
- en: '[PRE17]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'This gives us the following table showing the frequent itemsets with their
    necessary statistics:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这给我们以下表格，显示了频繁项集及其必要的统计数据：
- en: '![Detecting shopping trends](img/00096.jpeg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![检测购物趋势](img/00096.jpeg)'
- en: Thus we see that we get two frequent itemsets with support greater than 20%.
    Of course remember that this is a small dataset and the bigger the dataset you
    have containing purchase transactions, the more patterns you will get with stronger
    support.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们看到我们得到了两个支持率大于20%的频繁项集。当然，请记住，这是一个小数据集，你拥有的包含购买交易的数据集越大，你将得到的模式越多，支持率也越强。
- en: We have successfully built an algorithm for generating frequent itemsets! You
    can use this same algorithm on new datasets to generate more and more frequent
    itemsets and then we can start recommending products for people to purchase as
    soon as we see them buying one or more items from any of the frequent itemsets.
    A simple example would be if we see people buying beer, we can recommend diapers
    and milk to them since that shopping trend was detected by our algorithm in the
    frequent itemsets earlier.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经成功构建了一个生成频繁项集的算法！您可以使用这个相同的算法在新数据集上生成越来越多的频繁项集，然后我们可以在看到他们从任何频繁项集中购买一个或多个商品时立即开始推荐产品。一个简单的例子是，如果我们看到人们购买啤酒，我们可以向他们推荐尿布和牛奶，因为我们的算法在之前的频繁项集中检测到了这种购物趋势。
- en: Association rule mining
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关联规则挖掘
- en: We will now be implementing the final technique in market basket analysis for
    finding out association rules between itemsets to detect and predict product purchase
    patterns which can be used for product recommendations and suggestions. We will
    be notably using the Apriori algorithm from the `arules` package which uses an
    implementation for generating frequent itemsets first, which we discussed earlier.
    Once it has the frequent itemsets, the algorithm generates necessary rules based
    on parameters such as support, confidence, and lift. We will also show how you
    can visualize and interact with these rules using the `arulesViz` package. The
    code for this implementation is in the `ch3_association` rule `mining.R` file
    which you can directly load and follow the book.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将实现市场篮子分析的最终技术，以找出项集之间的关联规则，以检测和预测产品购买模式，这些模式可用于产品推荐和建议。我们将特别使用来自 `arules`
    包的 Apriori 算法，该算法首先使用我们之前讨论的生成频繁项集的实现。一旦它有了频繁项集，算法就会根据支持度、置信度和提升度等参数生成必要的规则。我们还将展示如何使用
    `arulesViz` 包可视化和交互这些规则。此实现的代码位于 `ch3_association` 规则 `mining.R` 文件中，您可以直接加载并按照书籍进行操作。
- en: Loading dependencies and data
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载依赖和数据
- en: We will first load the necessary package and data dependencies. Do note that
    we will be using the `Groceries` dataset which we discussed earlier in the section
    dealing with advanced contingency matrices.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先加载必要的包和数据依赖。请注意，我们将使用之前在处理高级列联矩阵的章节中讨论的 `Groceries` 数据集。
- en: '[PRE18]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Exploratory analysis
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索性分析
- en: We will do some basic exploratory analysis on our dataset here, to see what
    kind of data we are dealing with and what products are the most popular among
    the customers.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在这里对我们的数据集进行一些基本的探索性分析，以了解我们正在处理的数据类型以及哪些产品在客户中最受欢迎。
- en: '[PRE19]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '**Output:**'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Exploratory analysis](img/00097.jpeg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![探索性分析](img/00097.jpeg)'
- en: '[PRE20]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![Exploratory analysis](img/00098.jpeg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![探索性分析](img/00098.jpeg)'
- en: Detecting and predicting shopping trends
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测和预测购物趋势
- en: 'We will be generating association rules now using the Apriori algorithm, which
    we talked about earlier, to detect shopping trends so that we can predict what
    customers might buy in the future and even recommend it to them. We will start
    off with a normal workflow for generating association rules:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将使用之前提到的Apriori算法生成关联规则，以检测购物趋势，以便我们可以预测顾客未来可能会购买什么，甚至向他们推荐。我们将从生成关联规则的正常工作流程开始：
- en: '[PRE22]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '**Output:**'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Detecting and predicting shopping trends](img/00099.jpeg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![检测和预测购物趋势](img/00099.jpeg)'
- en: The way to interpret these rules is that you observe the items on the LHS and
    the items on the RHS, and conclude that if a customer has the item(s) from the
    LHS in his shopping cart, there is a chance of him also buying the item(s) on
    the RHS. This chance can be quantified using the metrics which are present in
    the remaining columns. We have discussed the significance of these metrics in
    the concepts of market basket analysis. From the previous rules, we can say that
    there is a 73.3% confidence that if a customer buys honey, he will also buy whole
    milk. From the previous rules, we see a trend that items such as honey, cocoa,
    pudding, and cooking chocolate all need milk as an essential ingredient, which
    might explain why people tend to buy that together with these products and we
    can recommend that to the customers. Feel free to tune the parameters for lift,
    support, and confidence to extract more rules from the dataset to get more and
    more patterns!
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 解释这些规则的方式是观察左侧的物品和右侧的物品，并得出结论：如果顾客购物车中有左侧的物品，那么他购买右侧物品的可能性会增加。这种可能性可以使用剩余列中存在的指标进行量化。我们已经在市场篮子分析的概念中讨论了这些指标的重要性。从之前的规则中，我们可以得出结论，如果顾客购买蜂蜜，他有73.3%的置信度会购买全脂牛奶。从之前的规则中，我们看到蜂蜜、可可、布丁和烹饪巧克力等物品都需要牛奶作为基本成分，这或许可以解释为什么人们倾向于将这些产品一起购买，并且我们可以向顾客推荐这些产品。请随意调整提升度、支持和置信度的参数，以从数据集中提取更多规则，以获得更多模式！
- en: 'Often the rules generated by the Apriori algorithm have duplicate association
    rules which need to be removed before we examine the set of rules. You can do
    the same using the following utility function on the generated rules:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，Apriori算法生成的规则中会有重复的关联规则，在检查规则集之前需要将其删除。您可以使用以下实用函数对生成的规则执行相同的操作：
- en: '[PRE23]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: There are also ways to sort rules by specific metrics to see the rules with
    the best quality. We will look at the best rules using the previous metric parameter
    values sorted by the best confidence values.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 也可以通过特定的指标对规则进行排序，以查看最佳质量的规则。我们将使用之前按最佳置信度值排序的指标参数值来查看最佳规则。
- en: '[PRE24]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '**Output:**'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Detecting and predicting shopping trends](img/00100.jpeg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![检测和预测购物趋势](img/00100.jpeg)'
- en: 'We see itemsets in the previous rules like `{ rice, sugar }`, which have a
    strong tendency to be purchased along with `{ whole milk }`. The confidence values
    are pretty high (and they should be since we sorted them!) of 100% and the lift
    is also greater than 1, indicating a positive association between the itemsets.
    Do note that in large datasets, the support values may not be very high and that
    is perfectly normal because we are searching some specific patterns in the whole
    transaction dataset which may not even cover 1% of the total transactions present
    due to the varied type of transactions. However, it is extremely important for
    us to detect these patterns to make informed decisions about predicting what products
    might get sold together and recommending them to the customers. We will next look
    at another example of showing the best quality rules sorted by lift:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的规则中，我们看到如`{ rice, sugar }`这样的项目集有很强的倾向与`{ whole milk }`一起购买。置信度值相当高（而且应该是这样的，因为我们已经对它们进行了排序！），为100%，提升度也大于1，表明项目集之间存在正相关。请注意，在大数据集中，支持值可能不是很高，这是完全正常的，因为我们正在搜索整个交易数据集中的一些特定模式，这些模式可能连1%的总交易量都覆盖不了，因为交易类型繁多。然而，对于我们来说，检测这些模式以做出关于预测可能一起销售的产品并推荐给顾客的明智决策至关重要。接下来，我们将查看另一个按提升度排序的最佳质量规则的示例：
- en: '[PRE25]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '**Output:**'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Detecting and predicting shopping trends](img/00101.jpeg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![检测和预测购物趋势](img/00101.jpeg)'
- en: We see that these rules have really high lift and good confidence too making
    them items which customers would tend to buy together the most!
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到这些规则具有非常高的提升度和良好的置信度，这使得它们成为顾客最倾向于一起购买的物品！
- en: 'We will now look at detecting specific shopping patterns which we discussed
    earlier. One way to do this is to target specific items and generate association
    rules containing those items explicitly. The first way is to predict what items
    the customers might have in their shopping cart if they have bought an item on
    the RHS of association rules. We do this by specifying the item explicitly as
    shown next and analyze the transactional dataset:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将探讨检测特定购物模式，这是我们之前讨论过的。一种实现方式是针对特定商品，并生成包含这些商品的关联规则。第一种方式是预测如果顾客在关联规则的右侧购买了某个商品，他们购物车中可能包含哪些商品。我们通过明确指定商品，如下所示，并分析交易数据集来完成这项工作：
- en: '[PRE26]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '**Output:**'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Detecting and predicting shopping trends](img/00102.jpeg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![检测和预测购物趋势](img/00102.jpeg)'
- en: It is interesting to note that people tend to buy beverages together, such as
    coffee, water, beer, and other miscellaneous beverages along with soda from the
    previous rules. Thus you can see that it is quite easy to predict when the users
    might buy soda using these rules and take action accordingly.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，人们倾向于一起购买饮料，例如咖啡、水、啤酒以及其他杂项饮料，以及从之前的规则中提到的汽水。因此，你可以看到，使用这些规则预测用户何时可能购买汽水并采取相应行动是非常容易的。
- en: 'We can also predict what items the users are going to buy if they have already
    put some specific items in their shopping cart, by explicitly setting specific
    itemset values on the LHS of the association rules using the following technique:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以通过在关联规则的左侧明确设置特定的商品集值，使用以下技术来预测如果用户已经在他们的购物车中放入了一些特定的商品，他们将购买哪些商品：
- en: '[PRE27]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '**Output:**'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出：**'
- en: '![Detecting and predicting shopping trends](img/00103.jpeg)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![检测和预测购物趋势](img/00103.jpeg)'
- en: You can clearly see from the previous rules that people tend to buy milk if
    they have yogurt and sugar in their shopping cart together or individually. Thus,
    by targeting specific itemsets, you can offer specific product based recommendations
    to the customers.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从之前的规则中清楚地看到，如果人们在购物车中同时或单独购买了酸奶和糖，他们倾向于购买牛奶。因此，通过针对特定的商品集，你可以向客户提供基于特定产品的推荐。
- en: Visualizing association rules
  id: totrans-163
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可视化关联规则
- en: 'There is an excellent package, `arulesViz` which provides an interactive way
    to visualize the association rules and interact with them. Following is a sample
    visualization for the preceding association rules:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 有一个优秀的包`arulesViz`，它提供了一种交互式的方式来可视化关联规则并与它们交互。以下是对之前关联规则的一个示例可视化：
- en: '[PRE28]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This visualization generated by `arulesViz` is completely interactive and you
    can play around with the vertices and edges, and place the itemsets according
    to your desire to find more and more trends and patterns from various rules.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 由`arulesViz`生成的这个可视化是完全交互式的，你可以玩转顶点和边，根据你的意愿放置商品集，以从各种规则中找到更多和更多的趋势和模式。
- en: This concludes our discussion on the main techniques which are being used in
    market basket analysis to detect and predict trends from shopping transaction
    logs and take actions accordingly from the derived insights.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这就结束了我们对市场篮子分析中使用的检测和预测购物交易日志趋势的主要技术的讨论，并据此采取行动。
- en: Summary
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we covered a lot of ground! We started with a discussion about
    how trends are detected and predicted in the retail vertical. Then we dived into
    what market basket analysis really means and the core concepts, mathematical formulae
    underlying the algorithms, and the critical metrics which are used to evaluate
    the results obtained from the algorithms, notably, support, confidence, and lift.
    We also discussed the most popular techniques used for analysis, including contingency
    matrix evaluation, frequent itemset generation, and association rule mining. Next,
    we talked about how to make data driven decisions using market basket analysis.
    Finally, we implemented our own algorithms and also used some of the popular libraries
    in R, such as `arules`, to apply these techniques to some real world transactional
    data for detecting, predicting, and visualizing trends. Do note that these machine
    learning techniques only talk about product based recommendations purely based
    on purchase and transactional logs. The human element is missing here since we
    don't take into account the likes and dislikes based on user purchase or ratings.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们覆盖了大量的内容！我们从一个关于如何在零售领域检测和预测趋势的讨论开始。然后我们深入探讨了市场篮子分析的真实含义以及算法背后的核心概念、数学公式，以及用于评估从算法中获得的结果的关键指标，特别是支持度、置信度和提升度。我们还讨论了用于分析的最流行技术，包括列联表评估、频繁项集生成和关联规则挖掘。接下来，我们讨论了如何使用市场篮子分析进行数据驱动决策。最后，我们实现了自己的算法，并使用了一些流行的R库，如`arules`，将这些技术应用于一些真实世界的交易数据，以检测、预测和可视化趋势。请注意，这些机器学习技术只讨论基于购买和交易日志的产品推荐，纯粹基于购买和交易日志。这里缺少了人性化的元素，因为我们没有考虑到基于用户购买或评分的喜好和厌恶。
- en: In the next chapter, we will be tackling some of these very problems and building
    robust recommendation engines for recommending products taking into account products
    as well as user interests.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将解决这些问题的其中一些，并构建用于推荐产品的稳健推荐引擎，这些推荐将考虑到产品以及用户兴趣。
