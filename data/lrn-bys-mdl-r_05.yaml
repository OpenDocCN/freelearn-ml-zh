- en: Chapter 5. Bayesian Regression Models
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第5章 贝叶斯回归模型
- en: In the previous chapter, we covered the theory of Bayesian linear regression
    in some detail. In this chapter, we will take a sample problem and illustrate
    how it can be applied to practical situations. For this purpose, we will use the
    **generalized linear model** (**GLM**) packages in R. Firstly, we will give a
    brief introduction to the concept of GLM to the readers.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们详细介绍了贝叶斯线性回归的理论。在本章中，我们将通过一个示例问题来说明它如何应用于实际情况。为此，我们将使用R中的**广义线性模型**（**GLM**）包。首先，我们将向读者简要介绍GLM的概念。
- en: Generalized linear regression
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 广义线性回归
- en: 'Recall that in linear regression, we assume the following functional form between
    the dependent variable *Y* and independent variable *X*:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，在线性回归中，我们假设依赖变量*Y*和自变量*X*之间的以下函数形式：
- en: '![Generalized linear regression](img/image00438.jpeg)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
  zh: '![广义线性回归](img/image00438.jpeg)'
- en: 'Here, ![Generalized linear regression](img/image00439.jpeg) is a set of basis
    functions and ![Generalized linear regression](img/image00440.jpeg) is the parameter
    vector. Usually, it is assumed that ![Generalized linear regression](img/image00441.jpeg),
    so ![Generalized linear regression](img/image00442.jpeg) represents an intercept
    or a bias term. Also, it is assumed that ![Generalized linear regression](img/image00443.jpeg)
    is a noise term distributed according to the normal distribution with mean zero
    and variance ![Generalized linear regression](img/image00444.jpeg). We also showed
    that this results in the following equation:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![广义线性回归](img/image00439.jpeg)是一组基函数，![广义线性回归](img/image00440.jpeg)是参数向量。通常，假设![广义线性回归](img/image00441.jpeg)，因此![广义线性回归](img/image00442.jpeg)代表一个截距或偏差项。此外，假设![广义线性回归](img/image00443.jpeg)是一个按照均值为零、方差![广义线性回归](img/image00444.jpeg)的正态分布分布的噪声项。我们还展示了这导致以下方程：
- en: '![Generalized linear regression](img/image00445.jpeg)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![广义线性回归](img/image00445.jpeg)'
- en: 'One can generalize the preceding equation to incorporate not only the normal
    distribution for noise but any distribution in the exponential family (reference
    1 in the *References* section of this chapter). This is done by defining the following
    equation:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 可以将前面的方程推广，不仅包括噪声的正态分布，还包括指数族中的任何分布（参考本章“参考文献”部分的第1条参考文献）。这是通过定义以下方程来实现的：
- en: '![Generalized linear regression](img/image00446.jpeg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![广义线性回归](img/image00446.jpeg)'
- en: Here, *g* is called a link function. The well-known models, such as logistic
    regression, log-linear models, Poisson regression, and so on, are special cases
    of GLM. For example, in the case of ordinary linear regression, the link function
    would be ![Generalized linear regression](img/image00447.jpeg). For logistic regression,
    it is ![Generalized linear regression](img/image00448.jpeg), which is the inverse
    of the logistic function, and for Poisson regression, it is ![Generalized linear
    regression](img/image00449.jpeg).
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*g*被称为连接函数。众所周知，如逻辑回归、对数线性模型、泊松回归等模型，都是广义线性模型（GLM）的特殊情况。例如，在普通线性回归的情况下，连接函数将是![广义线性回归](img/image00447.jpeg)。对于逻辑回归，它是![广义线性回归](img/image00448.jpeg)，即逻辑函数的逆，而对于泊松回归，它是![广义线性回归](img/image00449.jpeg)。
- en: In the Bayesian formulation of GLMs, unlike ordinary linear regression, there
    are no closed-form analytical solutions. One needs to specify prior probabilities
    for the regression coefficients. Then, their posterior probabilities are typically
    obtained through Monte Carlo simulations.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在GLM的贝叶斯公式中，与普通线性回归不同，没有封闭形式的解析解。需要指定回归系数的先验概率。然后，通常通过蒙特卡洛模拟获得它们的后验概率。
- en: The arm package
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: arm包
- en: In this chapter, for the purpose of illustrating Bayesian regression models,
    we will use the **arm** package of R. This package was developed by Andrew Gelman
    and co-workers, and it can be downloaded from the website at [http://CRAN.R-project.org/package=arm](http://CRAN.R-project.org/package=arm).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，为了说明贝叶斯回归模型，我们将使用R的**arm**包。这个包是由Andrew Gelman及其同事开发的，可以从[http://CRAN.R-project.org/package=arm](http://CRAN.R-project.org/package=arm)网站下载。
- en: The arm package has the `bayesglm` function that implements the Bayesian generalized
    linear model with an independent normal, t, or Cauchy prior distributions, for
    the model coefficients. We will use this function to build Bayesian regression
    models.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: arm包具有`bayesglm`函数，该函数实现了具有独立正态、t或Cauchy先验分布的贝叶斯广义线性模型，用于模型系数。我们将使用此函数构建贝叶斯回归模型。
- en: The Energy efficiency dataset
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 能源效率数据集
- en: 'We will use the Energy efficiency dataset from the UCI Machine Learning repository
    for the illustration of Bayesian regression (reference 2 in the *References* section
    of this chapter). The dataset can be downloaded from the website at [http://archive.ics.uci.edu/ml/datasets/Energy+efficiency](http://archive.ics.uci.edu/ml/datasets/Energy+efficiency).
    The dataset contains the measurements of energy efficiency of buildings with different
    building parameters. There are two energy efficiency parameters measured: heating
    load (*Y1*) and cooling load (*Y2*).'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用来自UCI机器学习仓库的能源效率数据集来展示贝叶斯回归（本章*参考文献*部分的参考2）。数据集可以从网站[http://archive.ics.uci.edu/ml/datasets/Energy+efficiency](http://archive.ics.uci.edu/ml/datasets/Energy+efficiency)下载。该数据集包含具有不同建筑参数的建筑能源效率测量值。测量了两个能源效率参数：供暖负荷（*Y1*）和冷却负荷（*Y2*）。
- en: 'The building parameters used are: relative compactness (*X1*), surface area
    (*X2*), wall area (*X3*), roof area (*X4*), overall height (*X5*), orientation
    (*X6*), glazing area (*X7*), and glazing area distribution (*X8*). We will try
    to predict heating load as a function of all the building parameters using both
    ordinary regression and Bayesian regression, using the `glm` functions of the
    arm package. We will show that, for the same dataset, Bayesian regression gives
    significantly smaller prediction intervals.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 使用的建筑参数包括：相对紧凑度（*X1*）、表面积（*X2*）、墙体面积（*X3*）、屋顶面积（*X4*）、整体高度（*X5*）、朝向（*X6*）、玻璃面积（*X7*）和玻璃面积分布（*X8*）。我们将尝试使用普通回归和贝叶斯回归，利用arm包的`glm`函数，将供暖负荷作为所有建筑参数的函数进行预测。我们将表明，对于同一数据集，贝叶斯回归给出了显著更小的预测区间。
- en: Regression of energy efficiency with building parameters
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建筑参数与能源效率的回归
- en: 'In this section, we will do a linear regression of the building''s energy efficiency
    measure, heating load (*Y1*) as a function of the building parameters. It would
    be useful to do a preliminary descriptive analysis to find which building variables
    are statistically significant. For this, we will first create bivariate plots
    of *Y1* and all the *X* variables. We will also compute the Spearman correlation
    between *Y1* and all the *X* variables. The R script for performing these tasks
    is as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将对建筑的能源效率指标进行线性回归，将供暖负荷（*Y1*）作为建筑参数的函数。进行初步的描述性分析以找出哪些建筑变量具有统计学意义将是有用的。为此，我们将首先创建*Y1*和所有*X*变量的双变量图。我们还将计算*Y1*和所有*X*变量之间的Spearman相关系数。执行这些任务的R脚本如下：
- en: '[PRE0]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![Regression of energy efficiency with building parameters](img/image00450.jpeg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![建筑参数与能源效率的回归](img/image00450.jpeg)'
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: From the b-plots and correlation coefficient values, we can conclude that variables
    X6 and X8 do not have a significant influence on Y1 and, hence, can be dropped
    from the model.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 从b图和相关系数值中，我们可以得出结论，变量X6和X8对Y1没有显著影响，因此可以从模型中删除。
- en: Ordinary regression
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 普通回归
- en: 'Before we look at the Bayesian linear regression, let''s do an ordinary linear
    regression. The following R code fits the linear regression model using the `lm`
    function in the base R on the training data and predicts the values of *Y1* on
    the test dataset:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们查看贝叶斯线性回归之前，让我们先进行普通线性回归。以下R代码使用基础R中的`lm`函数在训练数据上拟合线性回归模型，并在测试数据集上预测*Y1*的值：
- en: '[PRE2]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Bayesian regression
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 贝叶斯回归
- en: To perform Bayesian linear regression, we use the `bayesglm()` function of the
    arm package. As we described in the introduction, for the GLM, if we choose family
    as `gaussian` (the same as normal distribution) and link function as `identity`,
    then the GLM is equivalent to ordinary linear regression. Hence, if we use the
    `bayesglm()` function with the `gaussian` family and the `identity` link function,
    then we are performing a Bayesian linear regression.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行贝叶斯线性回归，我们使用arm包的`bayesglm()`函数。正如我们在引言中所描述的，对于GLM，如果我们选择`gaussian`（与正态分布相同）作为家族，并且选择`identity`作为连接函数，那么GLM就等同于普通线性回归。因此，如果我们使用`bayesglm()`函数并带有`gaussian`家族和`identity`连接函数，那么我们就是在执行贝叶斯线性回归。
- en: 'For the Bayesian model, we need to specify a prior distribution. For the Gaussian
    distribution, the default settings are `prior.mean = 0`, `prior.scale = NULL`,
    and `prior.df = Inf`. The following R code can be used for Bayesian linear regression:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 对于贝叶斯模型，我们需要指定一个先验分布。对于高斯分布，默认设置是 `prior.mean = 0`，`prior.scale = NULL`，和 `prior.df
    = Inf`。以下R代码可用于贝叶斯线性回归：
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To compare the results of the ordinary regression and Bayesian regression,
    we plot the prediction on test data with prediction errors for both methods on
    a single graph. For this purpose, we will use the **ggplot2** package:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 为了比较普通回归和贝叶斯回归的结果，我们在一个图表上绘制测试数据的预测值以及两种方法的预测误差。为此，我们将使用**ggplot2**包：
- en: '[PRE4]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![Bayesian regression](img/image00451.jpeg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![贝叶斯回归](img/image00451.jpeg)'
- en: One can see that the Bayesian approach gives much more compact, 95% confident
    prediction intervals compared to ordinary regression. This is happening because,
    in the Bayesian approach, one computes a distribution of parameters. The prediction
    is made using a set of values sampled from the posterior distribution and averaged
    to get the final prediction and confidence interval.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看到，与普通回归相比，贝叶斯方法给出了更加紧凑的95%置信预测区间。这是因为，在贝叶斯方法中，我们计算参数的分布。预测是通过从后验分布中抽取一系列值并平均得到最终预测和置信区间来进行的。
- en: Simulation of the posterior distribution
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 后验分布的模拟
- en: 'If one wants to find out the posterior of the model parameters, the `sim( )`
    function of the arm package becomes handy. The following R script will simulate
    the posterior distribution of parameters and produce a set of histograms:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果想找出模型参数的后验分布，arm包中的`sim( )`函数就变得很有用。以下R脚本将模拟参数的后验分布并生成一系列直方图：
- en: '[PRE5]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![Simulation of the posterior distribution](img/image00452.jpeg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![后验分布的模拟](img/image00452.jpeg)'
- en: Exercises
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: 'Use the multivariate dataset named Auto MPG from the UCI Machine Learning repository
    (reference 3 in the *References* section of this chapter). The dataset can be
    downloaded from the website at [https://archive.ics.uci.edu/ml/datasets/Auto+MPG](https://archive.ics.uci.edu/ml/datasets/Auto+MPG).
    The dataset describes automobile fuel consumption in **miles per gallon** (**mpg**)
    for cars running in American cities. From the folder containing the datasets,
    download two files: `auto-mpg.data` and `auto-mpg.names`. The `auto-mpg.data`
    file contains the data and it is in space-separated format. The `auto-mpg.names`
    file has several details about the dataset, including variable names for each
    column. Build a regression model for the fuel efficiency, as a function displacement
    (*disp*), horse power (*hp*), weight (*wt*), and acceleration (*accel*), using
    both OLS and Bayesian GLM. Predict the values for mpg in the test dataset using
    both the OLS model and Bayesian GLM model (using the `bayesglm` function). Find
    the **Root Mean Square Error** (**RMSE**) values for OLS and Bayesian GLM and
    compare the accuracy and prediction intervals for both the methods.'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用来自UCI机器学习仓库的多变量数据集Auto MPG（本章参考文献部分的第3个参考文献）。数据集可以从网站[https://archive.ics.uci.edu/ml/datasets/Auto+MPG](https://archive.ics.uci.edu/ml/datasets/Auto+MPG)下载。该数据集描述了在美国城市行驶的汽车的每加仑燃油消耗量（**mpg**）。从包含数据集的文件夹中下载两个文件：`auto-mpg.data`和`auto-mpg.names`。`auto-mpg.data`文件包含数据，格式为空格分隔。`auto-mpg.names`文件包含关于数据集的多个细节，包括每列的变量名。使用OLS和贝叶斯GLM构建燃油效率回归模型，作为排量（*disp*）、马力（*hp*）、重量（*wt*）和加速度（*accel*）的函数。使用OLS模型和贝叶斯GLM模型（使用`bayesglm`函数）预测测试数据集中的mpg值。计算OLS和贝叶斯GLM的**均方根误差**（**RMSE**）值，并比较两种方法的准确性和预测区间。
- en: References
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: Friedman J., Hastie T., and Tibshirani R. *The Elements of Statistical Learning
    – Data Mining, Inference, and Prediction*. Springer Series in Statistics. 2009
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Friedman J., Hastie T., and Tibshirani R. *统计学习的要素 – 数据挖掘、推理与预测*. 施普林格统计学系列.
    2009
- en: Tsanas A. and Xifara A. "Accurate Quantitative Estimation of Energy Performance
    of Residential Buildings Using Statistical Machine Learning Tools". Energy and
    Buildings. Vol. 49, pp. 560-567\. 2012
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Tsanas A. and Xifara A. "使用统计机器学习工具准确估计住宅建筑的能源性能". 能源与建筑. 第49卷，第560-567页. 2012
- en: 'Quinlan R. "Combining Instance-based and Model-based Learning". In: Tenth International
    Conference of Machine Learning. 236-243\. University of Massachusetts, Amherst.
    Morgan Kaufmann. 1993\. Original dataset is from StatLib library maintained by
    Carnegie Mellon University.'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 'Quinlan R. "Combining Instance-based and Model-based Learning". In: Tenth International
    Conference of Machine Learning. 236-243\. University of Massachusetts, Amherst.
    Morgan Kaufmann. 1993\. Original dataset is from StatLib library maintained by
    Carnegie Mellon University.'
- en: Summary
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we illustrated how Bayesian regression is more useful for prediction
    with a tighter confidence interval using the Energy efficiency dataset and the
    `bayesglm` function of the arm package. We also learned how to simulate the posterior
    distribution using the `sim` function in the same R package. In the next chapter,
    we will learn about Bayesian classification.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们展示了如何使用能源效率数据集和arm包中的`bayesglm`函数，通过更紧的置信区间来提高贝叶斯回归在预测中的实用性。我们还学习了如何使用同一R包中的`sim`函数来模拟后验分布。在下一章中，我们将学习贝叶斯分类。
