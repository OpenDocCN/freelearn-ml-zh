- en: ChapterÂ 3
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¬¬3ç« 
- en: Hierarchical Models
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹
- en: Hierarchical models are one honking great idea â€“ letâ€™s do more of those! - The
    zen of Bayesian modeling
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„æƒ³æ³•â€”â€”è®©æˆ‘ä»¬åšæ›´å¤šè¿™æ ·çš„æ¨¡å‹å§ï¼- è´å¶æ–¯å»ºæ¨¡çš„ç¦…æ„
- en: In *Chapter [2](CH02.xhtml#x1-440002)*, we saw a tips example where we had multiple
    groups in our data, one for each of Thursday, Friday, Saturday, and Sunday. We
    decided to model each group separately. Thatâ€™s sometimes fine, but we should be
    aware of our assumptions. By modeling each group independently, we are assuming
    the groups are unrelated. In other words, we are assuming that knowing the tip
    for one day does not give us any information about the tip for another day. That
    could be too strong an assumption. Would it be possible to build a model that
    allows us to share information between groups? Thatâ€™s not only possible, but is
    also the main topic of this chapter. Lucky you!
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨*ç¬¬[2ç« ](CH02.xhtml#x1-440002)*ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªå°è´¹çš„ä¾‹å­ï¼Œå…¶ä¸­æ•°æ®ä¸­æœ‰å¤šä¸ªç»„ï¼Œæ¯ä¸ªç»„å¯¹åº”æ˜ŸæœŸå››ã€æ˜ŸæœŸäº”ã€æ˜ŸæœŸå…­å’Œæ˜ŸæœŸæ—¥ã€‚æˆ‘ä»¬å†³å®šåˆ†åˆ«å»ºæ¨¡æ¯ä¸ªç»„ã€‚è¿™æ ·åšæœ‰æ—¶æ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘ä»¬åº”å½“æ³¨æ„æˆ‘ä»¬çš„å‡è®¾ã€‚é€šè¿‡ç‹¬ç«‹å»ºæ¨¡æ¯ä¸ªç»„ï¼Œæˆ‘ä»¬å‡è®¾è¿™äº›ç»„æ˜¯äº’ä¸ç›¸å…³çš„ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å‡è®¾çŸ¥é“ä¸€å¤©çš„å°è´¹ä¿¡æ¯å¹¶ä¸èƒ½ç»™æˆ‘ä»¬æä¾›å…¶ä»–ä¸€å¤©çš„å°è´¹ä¿¡æ¯ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªè¿‡äºå¼ºçš„å‡è®¾ã€‚é‚£ä¹ˆï¼Œæ˜¯å¦æœ‰å¯èƒ½æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œå…è®¸æˆ‘ä»¬åœ¨ç»„ä¹‹é—´å…±äº«ä¿¡æ¯å‘¢ï¼Ÿè¿™ä¸ä»…å¯èƒ½ï¼Œè€Œä¸”æ­£æ˜¯æœ¬ç« çš„ä¸»è¦å†…å®¹ã€‚å¹¸è¿çš„æ˜¯ï¼Œä½ æ¥äº†ï¼
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹ä¸»é¢˜ï¼š
- en: Hierarchical models
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹
- en: Partial pooling
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éƒ¨åˆ†åˆå¹¶
- en: Shrinkage
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ”¶ç¼©
- en: 3.1 Sharing information, sharing priors
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.1 ä¿¡æ¯å…±äº«ï¼Œå…±äº«å…ˆéªŒ
- en: Hierarchical models are also known as multilevel models, mixed-effects models,
    random-effects models, or nested models. They are particularly useful when dealing
    with data that can be described as grouped or having different levels, such as
    data nested within geographic regions (for example, cities belonging to a province
    and provinces belonging to a country), or with a hierarchical structure (such
    as students nested within schools, or patients nested within hospitals) or repeated
    measurements on the same individuals.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºå¤šçº§æ¨¡å‹ã€æ··åˆæ•ˆåº”æ¨¡å‹ã€éšæœºæ•ˆåº”æ¨¡å‹æˆ–åµŒå¥—æ¨¡å‹ã€‚å½“æ•°æ®å¯ä»¥è¢«æè¿°ä¸ºåˆ†ç»„æˆ–å…·æœ‰ä¸åŒå±‚çº§æ—¶ï¼Œåˆ†å±‚æ¨¡å‹å°¤å…¶æœ‰ç”¨ï¼Œæ¯”å¦‚æ•°æ®åµŒå¥—åœ¨åœ°ç†åŒºåŸŸä¸­ï¼ˆä¾‹å¦‚ï¼Œå±äºä¸€ä¸ªçœçš„åŸå¸‚å’Œå±äºä¸€ä¸ªå›½å®¶çš„çœï¼‰ï¼Œæˆ–è€…å…·æœ‰åˆ†å±‚ç»“æ„ï¼ˆå¦‚å­¦ç”ŸåµŒå¥—åœ¨å­¦æ ¡å†…ï¼Œæˆ–è€…ç—…äººåµŒå¥—åœ¨åŒ»é™¢ä¸­ï¼‰ï¼Œæˆ–è€…æ˜¯å¯¹åŒä¸€ä¸ªä½“çš„é‡å¤æµ‹é‡ã€‚
- en: '![PIC](img/file87.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![PIC](img/file87.png)'
- en: '**FigureÂ 3.1**: The differences between a pooled model, an unpooled model,
    and a hierarchical model'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾3.1**ï¼šåˆå¹¶æ¨¡å‹ã€éåˆå¹¶æ¨¡å‹å’Œåˆ†å±‚æ¨¡å‹ä¹‹é—´çš„å·®å¼‚'
- en: Hierarchical models are a natural way to share information between groups. In
    a hierarchical model, the parameters of the prior distributions are themselves
    given a prior distribution. These higher-level priors are often called hyperpriors;
    â€hyperâ€ means â€overâ€ in Greek. Having hyperpriors allows the model to share information
    between groups, while still allowing differences between groups. In other words,
    we can think of the parameters of the prior distributions as belonging to a common
    population of parameters. *Figure [3.1](#x1-68003r1)* shows a diagram with the
    high-level differences between a pooled model (a single group), an unpooled model
    (all separated groups), and a hierarchical model, also known as a partially pooled
    model.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹æ˜¯ä¸€ä¸ªè‡ªç„¶çš„æ–¹å¼ï¼Œç”¨äºåœ¨ä¸åŒç»„ä¹‹é—´å…±äº«ä¿¡æ¯ã€‚åœ¨åˆ†å±‚æ¨¡å‹ä¸­ï¼Œå…ˆéªŒåˆ†å¸ƒçš„å‚æ•°æœ¬èº«ä¹Ÿä¼šèµ‹äºˆä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒã€‚è¿™äº›æ›´é«˜å±‚æ¬¡çš„å…ˆéªŒé€šå¸¸è¢«ç§°ä¸ºè¶…å…ˆéªŒï¼›â€œè¶…â€åœ¨å¸Œè…Šè¯­ä¸­æ„å‘³ç€â€œåœ¨â€¦â€¦ä¹‹ä¸Šâ€ã€‚æ‹¥æœ‰è¶…å…ˆéªŒä½¿å¾—æ¨¡å‹å¯ä»¥åœ¨ç»„ä¹‹é—´å…±äº«ä¿¡æ¯ï¼ŒåŒæ—¶ä»å…è®¸ç»„ä¹‹é—´å­˜åœ¨å·®å¼‚ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå…ˆéªŒåˆ†å¸ƒçš„å‚æ•°å±äºä¸€ä¸ªå…±åŒçš„å‚æ•°ç¾¤ä½“ã€‚*å›¾
    [3.1](#x1-68003r1)* æ˜¾ç¤ºäº†ä¸€ä¸ªå›¾ç¤ºï¼Œå±•ç¤ºäº†åˆå¹¶æ¨¡å‹ï¼ˆå•ä¸€ç»„ï¼‰ã€éåˆå¹¶æ¨¡å‹ï¼ˆæ‰€æœ‰åˆ†å¼€çš„ç»„ï¼‰å’Œåˆ†å±‚æ¨¡å‹ï¼ˆä¹Ÿç§°ä¸ºéƒ¨åˆ†åˆå¹¶æ¨¡å‹ï¼‰ä¹‹é—´çš„é«˜å±‚æ¬¡å·®å¼‚ã€‚
- en: The concept of a hierarchical model may seem confusingly simple, almost trivial,
    but it has subtle implications. That is why in the rest of this chapter we will
    use different examples to understand their implications. I am sure that these
    examples will not only help you better understand this concept but will also convince
    you that it is a very useful tool to apply to your own problems.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å±‚æ¨¡å‹çš„æ¦‚å¿µçœ‹èµ·æ¥å¯èƒ½è¿‡äºç®€å•ï¼Œå‡ ä¹æ˜¯å¾®ä¸è¶³é“çš„ï¼Œä½†å®ƒæœ‰ç€æ·±è¿œçš„å½±å“ã€‚å› æ­¤ï¼Œåœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸åŒçš„ä¾‹å­æ¥ç†è§£å®ƒä»¬çš„å«ä¹‰ã€‚æˆ‘ç›¸ä¿¡è¿™äº›ä¾‹å­ä¸ä»…èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è¿™ä¸€æ¦‚å¿µï¼Œè¿˜èƒ½è¯´æœä½ ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œèƒ½å¤Ÿåº”ç”¨äºä½ è‡ªå·±çš„é—®é¢˜ã€‚
- en: 3.2 Hierarchical shifts
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.2 åˆ†å±‚è½¬å˜
- en: Proteins are molecules formed by 20 units called amino acids. Each amino acid
    can appear in a protein 0 or more times. Just as a melody is defined by a sequence
    of musical notes, a protein is defined by a sequence of amino acids. Some musical
    note variations can result in small variations of the melody and other variations
    in completely different melodies. Something similar happens with proteins. One
    way to study proteins is by using nuclear magnetic resonance (the same technique
    used for medical imaging). This technique allows us to measure various quantities,
    one of which is called a chemical shift. You may remember that we saw an example
    using chemical shifts in *Chapter [2](CH02.xhtml#x1-440002)*.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: è›‹ç™½è´¨æ˜¯ç”±20ç§å«åšæ°¨åŸºé…¸çš„å•ä½ç»„æˆçš„åˆ†å­ã€‚æ¯ç§æ°¨åŸºé…¸å¯ä»¥åœ¨è›‹ç™½è´¨ä¸­å‡ºç°0æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚å°±åƒæ—‹å¾‹æ˜¯ç”±ä¸€ç³»åˆ—éŸ³ç¬¦å®šä¹‰çš„ï¼Œè›‹ç™½è´¨åˆ™æ˜¯ç”±ä¸€ç³»åˆ—æ°¨åŸºé…¸å®šä¹‰çš„ã€‚ä¸€äº›éŸ³ç¬¦çš„å˜åŒ–å¯èƒ½å¯¼è‡´æ—‹å¾‹çš„å¾®å°å˜åŒ–ï¼Œè€Œå…¶ä»–éŸ³ç¬¦çš„å˜åŒ–åˆ™å¯èƒ½å¯¼è‡´å®Œå…¨ä¸åŒçš„æ—‹å¾‹ã€‚è›‹ç™½è´¨ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æƒ…å†µã€‚ç ”ç©¶è›‹ç™½è´¨çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ ¸ç£å…±æŒ¯ï¼ˆä¸åŒ»å­¦æˆåƒä½¿ç”¨çš„æŠ€æœ¯ç›¸åŒï¼‰ã€‚è¿™é¡¹æŠ€æœ¯ä½¿æˆ‘ä»¬èƒ½å¤Ÿæµ‹é‡å¤šç§é‡ï¼Œå…¶ä¸­ä¹‹ä¸€å«åšåŒ–å­¦ä½ç§»ã€‚ä½ å¯èƒ½è¿˜è®°å¾—æˆ‘ä»¬åœ¨*ç¬¬[2](CH02.xhtml#x1-440002)*ç« ä¸­çœ‹è¿‡ä¸€ä¸ªä½¿ç”¨åŒ–å­¦ä½ç§»çš„ä¾‹å­ã€‚
- en: 'Suppose we want to compare a theoretical method of computing chemical shift
    against the experimental observations to evaluate the ability of the theoretical
    method to reproduce the experimental values. Luckily for us, someone has already
    run the experiments and carried out the theoretical calculations, and we just
    need to compare them. The following dataset contains chemical shift values for
    a set of proteins. If you inspect the `cs_data` DataFrame, you will see that it
    has four columns:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬æƒ³å°†ä¸€ç§ç†è®ºçš„åŒ–å­¦ä½ç§»è®¡ç®—æ–¹æ³•ä¸å®éªŒè§‚å¯Ÿç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œä»¥è¯„ä¼°è¯¥ç†è®ºæ–¹æ³•æ˜¯å¦èƒ½å†ç°å®éªŒå€¼ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰äººå·²ç»åšäº†å®éªŒå¹¶è¿›è¡Œäº†ç†è®ºè®¡ç®—ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å®ƒä»¬è¿›è¡Œæ¯”è¾ƒã€‚ä»¥ä¸‹æ•°æ®é›†åŒ…å«äº†ä¸€ç»„è›‹ç™½è´¨çš„åŒ–å­¦ä½ç§»å€¼ã€‚å¦‚æœä½ æŸ¥çœ‹`cs_data`æ•°æ®æ¡†ï¼Œä½ ä¼šå‘ç°å®ƒæœ‰å››åˆ—ï¼š
- en: The first is a code that identifies the protein (you can get a lot of information
    about that protein by entering that code at [https://www.rcsb.org/](https://www.rcsb.org/))
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¬¬ä¸€åˆ—æ˜¯ä¸€ä¸ªä»£ç ï¼Œç”¨æ¥è¯†åˆ«è›‹ç™½è´¨ï¼ˆä½ å¯ä»¥é€šè¿‡åœ¨[https://www.rcsb.org/](https://www.rcsb.org/)è¾“å…¥è¯¥ä»£ç æ¥è·å–æœ‰å…³è¯¥è›‹ç™½è´¨çš„è®¸å¤šä¿¡æ¯ï¼‰
- en: The second column has the name of the amino acid (you might notice that there
    are only 19 unique names; one of the amino acids is missing from this dataset)
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¬¬äºŒåˆ—æ˜¯æ°¨åŸºé…¸çš„åç§°ï¼ˆä½ å¯èƒ½ä¼šæ³¨æ„åˆ°è¿™é‡Œåªæœ‰19ä¸ªç‹¬ç‰¹çš„åç§°ï¼›è¯¥æ•°æ®é›†ä¸­ç¼ºå°‘ä¸€ç§æ°¨åŸºé…¸ï¼‰
- en: The third contains theoretical values of chemical shift (calculated using quantum
    methods)
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¬¬ä¸‰åˆ—åŒ…å«äº†åŒ–å­¦ä½ç§»çš„ç†è®ºå€¼ï¼ˆä½¿ç”¨é‡å­æ–¹æ³•è®¡ç®—å¾—å‡ºï¼‰
- en: The fourth has experimental values
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¬¬å››åˆ—åŒ…å«äº†å®éªŒå€¼
- en: Now that we have the data, how should we proceed? One option is to take the
    empirical differences and fit a Gaussian or maybe Studentâ€™s t model. Because amino
    acids are a family of chemical compounds, it would make sense to assume they are
    all the same and estimate a single Gaussian for all the differences. But you may
    argue that there are 20 different kinds of amino acids, each one with different
    chemical properties, and hence a better choice is to fit 20 separated Gaussians.
    What should we do?
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†æ•°æ®ï¼Œæ¥ä¸‹æ¥åº”è¯¥æ€ä¹ˆåšï¼Ÿä¸€ä¸ªé€‰é¡¹æ˜¯é‡‡ç”¨ç»éªŒå·®å¼‚å¹¶æ‹Ÿåˆä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œæˆ–è€…ä¹Ÿè®¸æ˜¯å­¦ç”Ÿtåˆ†å¸ƒã€‚å› ä¸ºæ°¨åŸºé…¸æ˜¯ä¸€ç±»åŒ–å­¦åŒ–åˆç‰©ï¼Œå‡è®¾å®ƒä»¬éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸ºæ‰€æœ‰å·®å¼‚ä¼°ç®—ä¸€ä¸ªå•ä¸€çš„é«˜æ–¯åˆ†å¸ƒæ˜¯æœ‰é“ç†çš„ã€‚ä½†ä½ å¯èƒ½ä¼šè®¤ä¸ºï¼Œæœ‰20ç§ä¸åŒç±»å‹çš„æ°¨åŸºé…¸ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„åŒ–å­¦æ€§è´¨ï¼Œå› æ­¤ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©æ˜¯æ‹Ÿåˆ20ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒã€‚æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿ
- en: Letâ€™s take a moment to think about which option is the best. If we combine all
    the data, our estimates are going to be more accurate, but we will not be able
    to get information from individual groups (amino acids). On the contrary, if we
    treat them as separate groups, we will get a much more detailed analysis but with
    less accuracy. What should we do?
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´æ€è€ƒä¸€ä¸‹ï¼Œå“ªä¸ªé€‰é¡¹æ˜¯æœ€å¥½çš„ã€‚å¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰æ•°æ®åˆå¹¶ï¼Œä¼°ç®—ç»“æœä¼šæ›´å‡†ç¡®ï¼Œä½†æˆ‘ä»¬æ— æ³•ä»å•ä¸ªç»„ï¼ˆæ°¨åŸºé…¸ï¼‰ä¸­è·å–ä¿¡æ¯ã€‚ç›¸åï¼Œå¦‚æœæˆ‘ä»¬å°†å®ƒä»¬ä½œä¸ºç‹¬ç«‹çš„ç»„å¤„ç†ï¼Œæˆ‘ä»¬å°†è·å¾—æ›´è¯¦ç»†çš„åˆ†æï¼Œä½†å‡†ç¡®æ€§è¾ƒå·®ã€‚æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿ
- en: When in doubt, everything! (Not sure this is good general advice for your life,
    but I like the song [https://www.youtube.com/watch?v=1di09XZUlIw](https://www.youtube.com/watch?v=1di09XZUlIw)).
    We can build a hierarchical model; that way, we allow estimates at the group level
    but with the restriction that they all belong to a larger group or population.
    To better understand this, letâ€™s build a hierarchical model for the chemical shift
    data.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æœ‰ç–‘é—®æ—¶ï¼Œä»€ä¹ˆéƒ½è¡Œï¼(ä¸ç¡®å®šè¿™æ˜¯å¦æ˜¯ä½ ç”Ÿæ´»ä¸­å¥½çš„æ™®éå»ºè®®ï¼Œä½†æˆ‘å–œæ¬¢è¿™é¦–æ­Œ [https://www.youtube.com/watch?v=1di09XZUlIw](https://www.youtube.com/watch?v=1di09XZUlIw))ã€‚æˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå±‚çº§æ¨¡å‹ï¼›é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å…è®¸åœ¨ç»„çº§åˆ«è¿›è¡Œä¼°ç®—ï¼Œä½†æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå³å®ƒä»¬éƒ½å±äºä¸€ä¸ªæ›´å¤§çš„ç»„æˆ–äººç¾¤ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥ä¸ºåŒ–å­¦ä½ç§»æ•°æ®å»ºç«‹ä¸€ä¸ªå±‚çº§æ¨¡å‹ã€‚
- en: 'To see the difference between a non-hierarchical (unpooled) model and a hierarchical
    one, we are going to build two models. The first one is essentially the same as
    the `comparing_groups` model from *Chapter [2](CH02.xhtml#x1-440002)*:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æŸ¥çœ‹éå±‚æ¬¡æ¨¡å‹ï¼ˆéæ±‡èšæ¨¡å‹ï¼‰å’Œå±‚æ¬¡æ¨¡å‹ä¹‹é—´çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸¤ä¸ªæ¨¡å‹ã€‚ç¬¬ä¸€ä¸ªæ¨¡å‹æœ¬è´¨ä¸Šä¸*ç¬¬ [2](CH02.xhtml#x1-440002)*
    ç« ä¸­çš„`comparing_groups`æ¨¡å‹ç›¸åŒï¼š
- en: '**CodeÂ 3.1**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»£ç  3.1**'
- en: '[PRE0]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now, we will build the hierarchical version of the model. We are adding two
    hyperpriors, one for the mean of *Î¼* and one for the standard deviation of *Î¼*.
    We are leaving *Ïƒ* without hyperpriors; in other words, we are assuming that the
    variance between observed and theoretical values should be the same for all groups.
    This is a modeling choice, and you may face a problem where this seems unacceptable
    and consider it necessary to add a hyperprior for *Ïƒ*; feel free to do that:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ„å»ºæ¨¡å‹çš„å±‚æ¬¡ç‰ˆæœ¬ã€‚æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªè¶…å…ˆéªŒï¼Œä¸€ä¸ªç”¨äº*Î¼*çš„å‡å€¼ï¼Œå¦ä¸€ä¸ªç”¨äº*Î¼*çš„æ ‡å‡†å·®ã€‚æˆ‘ä»¬å°†*Ïƒ*ç•™ç©ºï¼Œä¸æ·»åŠ è¶…å…ˆéªŒï¼›æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å‡è®¾è§‚å¯Ÿå€¼ä¸ç†è®ºå€¼ä¹‹é—´çš„æ–¹å·®å¯¹äºæ‰€æœ‰ç»„éƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™æ˜¯ä¸€ä¸ªå»ºæ¨¡é€‰æ‹©ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œè§‰å¾—è¿™ç§å‡è®¾ä¸å¯æ¥å—ï¼Œå¹¶è®¤ä¸ºæœ‰å¿…è¦ä¸º*Ïƒ*æ·»åŠ ä¸€ä¸ªè¶…å…ˆéªŒï¼›ä½ å¯ä»¥è‡ªç”±è¿™æ ·åšï¼š
- en: '**CodeÂ 3.2**'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»£ç  3.2**'
- en: '[PRE1]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '*Figure [3.2](#x1-69030r2)* shows the graphical representation of the `cs_h`
    and `cs_nh` models. We can see that we have one more level for `cs_h` representing
    the hyperpriors for *Î¼*.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '*å›¾ [3.2](#x1-69030r2)* æ˜¾ç¤ºäº†`cs_h`å’Œ`cs_nh`æ¨¡å‹çš„å›¾å½¢è¡¨ç¤ºã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ`cs_h`å¤šäº†ä¸€ä¸ªå±‚çº§ï¼Œç”¨äºè¡¨ç¤º*Î¼*çš„è¶…å…ˆéªŒã€‚'
- en: '![PIC](img/file88.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file88.png)'
- en: '**FigureÂ 3.2**: Graph representation of the non-hierarchical (left) and hierarchical
    (right) models for the chemical shift data. Each subfigure was generated with
    the `pm.model_to_graphviz(.)` function'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.2**ï¼šåŒ–å­¦ä½ç§»æ•°æ®çš„éå±‚æ¬¡ï¼ˆå·¦ï¼‰å’Œå±‚æ¬¡ï¼ˆå³ï¼‰æ¨¡å‹çš„å›¾å½¢è¡¨ç¤ºã€‚æ¯ä¸ªå­å›¾éƒ½æ˜¯é€šè¿‡`pm.model_to_graphviz(.)`å‡½æ•°ç”Ÿæˆçš„'
- en: We are going to compare the results using ArviZâ€™s `plot_forest` function. We
    can pass more than one model to this function. This is useful when we want to
    compare the values of parameters from different models such as with the present
    example. In *Figure [3.3](#x1-69031r3)*, we have a plot for the 40 estimated means,
    one per amino acid (20) for each of the two models. We also have their 94% HDI
    and the inter-quantile range (the central 50% of the distribution). The vertical
    dashed line is the global mean according to the hierarchical model. This value
    is close to zero, as expected for theoretical values faithfully reproducing experimental
    ones.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨ArviZçš„`plot_forest`å‡½æ•°æ¥æ¯”è¾ƒç»“æœã€‚æˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªæ¨¡å‹ä¼ é€’ç»™æ­¤å‡½æ•°ã€‚å½“æˆ‘ä»¬å¸Œæœ›æ¯”è¾ƒä¸åŒæ¨¡å‹ä¸­å‚æ•°çš„å€¼æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å½“å‰ç¤ºä¾‹ä¸­æ‰€å±•ç¤ºçš„ã€‚åœ¨*å›¾
    [3.3](#x1-69031r3)*ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«40ä¸ªä¼°è®¡å‡å€¼çš„å›¾ï¼Œæ¯ä¸ªæ°¨åŸºé…¸ï¼ˆå…±20ä¸ªï¼‰å¯¹åº”ä¸¤ä¸ªæ¨¡å‹ä¸­çš„ä¸€ä¸ªã€‚æˆ‘ä»¬è¿˜å±•ç¤ºäº†å®ƒä»¬çš„94% HDIå’Œå››åˆ†ä½è·ï¼ˆåˆ†å¸ƒçš„ä¸­å¤®50%ï¼‰ã€‚å‚ç›´è™šçº¿è¡¨ç¤ºæ ¹æ®å±‚æ¬¡æ¨¡å‹å¾—åˆ°çš„å…¨å±€å‡å€¼ã€‚è¯¥å€¼æ¥è¿‘é›¶ï¼Œæ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œç†è®ºå€¼ä¸å®éªŒå€¼ç›¸ç¬¦ã€‚
- en: '![PIC](img/file89.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file89.png)'
- en: '**FigureÂ 3.3**: Chemical shift differences for the hierarchical and non-hierarchical
    models'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.3**ï¼šå±‚æ¬¡å’Œéå±‚æ¬¡æ¨¡å‹çš„åŒ–å­¦ä½ç§»å·®å¼‚'
- en: The most relevant part of this plot is that the estimates from the hierarchical
    model are pulled toward the partially pooled mean, or equivalently they are shrunken
    in comparison to the unpooled estimates. You will also notice that the effect
    is more notorious for those groups farther away from the mean (such as `PRO`)
    and that the uncertainty is on par with or smaller than that from the non-hierarchical
    model. The estimates are partially pooled because we have one estimate for each
    group, but estimates for individual groups restrict each other through the hyperprior.
    Therefore, we get an intermediate situation between having a single group with
    all chemical shifts together and having 20 separate groups, one per amino acid.
    And that, ladies, gentlemen, and non-binary-gender-fluid people, is the beauty
    of hierarchical models.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥å›¾çš„æœ€ç›¸å…³éƒ¨åˆ†æ˜¯å±‚æ¬¡æ¨¡å‹çš„ä¼°è®¡å€¼è¢«æ‹‰å‘éƒ¨åˆ†æ±‡èšçš„å‡å€¼ï¼Œæˆ–è€…è¯´å®ƒä»¬ç›¸æ¯”äºéæ±‡èšçš„ä¼°è®¡å€¼è¢«â€œæ”¶ç¼©â€ã€‚ä½ è¿˜ä¼šæ³¨æ„åˆ°ï¼Œè¿™ç§æ•ˆåº”åœ¨é‚£äº›ç¦»å‡å€¼è¾ƒè¿œçš„ç»„ï¼ˆå¦‚`PRO`ï¼‰ä¸­æ›´åŠ æ˜æ˜¾ï¼Œè€Œä¸”ä¸ç¡®å®šæ€§ä¸éå±‚æ¬¡æ¨¡å‹çš„ç›¸å½“ï¼Œç”šè‡³æ›´å°ã€‚ä¼°è®¡å€¼æ˜¯éƒ¨åˆ†æ±‡èšçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ºæ¯ä¸ªç»„éƒ½æœ‰ä¸€ä¸ªä¼°è®¡ï¼Œä½†å„ä¸ªç»„çš„ä¼°è®¡å€¼é€šè¿‡è¶…å…ˆéªŒç›¸äº’çº¦æŸã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ç§ä»‹äºå°†æ‰€æœ‰åŒ–å­¦ä½ç§»æ”¾åœ¨ä¸€ä¸ªç»„ä¸­å’Œå°†æ¯ä¸ªæ°¨åŸºé…¸åˆ†ä¸º20ä¸ªç‹¬ç«‹ç»„ä¹‹é—´çš„ä¸­é—´æƒ…å†µã€‚å„ä½å¥³å£«ã€å…ˆç”Ÿä»¥åŠéäºŒå…ƒæ€§åˆ«æµåŠ¨è€…ï¼Œè¿™å°±æ˜¯å±‚æ¬¡æ¨¡å‹çš„ç¾å¦™ä¹‹å¤„ã€‚
- en: 3.3 Water quality
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.3 æ°´è´¨
- en: 'Suppose we want to analyze the quality of water in a city, so we take samples
    by dividing the city into neighborhoods. We may think we have two options for
    analyzing this data:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬æƒ³åˆ†æä¸€ä¸ªåŸå¸‚çš„æ°´è´¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šè¿‡å°†åŸå¸‚åˆ’åˆ†ä¸ºå¤šä¸ªç¤¾åŒºæ¥è¿›è¡Œé‡‡æ ·ã€‚æˆ‘ä»¬å¯èƒ½è®¤ä¸ºæœ‰ä¸¤ç§é€‰æ‹©æ¥åˆ†æè¿™äº›æ•°æ®ï¼š
- en: Study each neighborhood as a separate entity
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ¯ä¸ªç¤¾åŒºä½œä¸ºä¸€ä¸ªç‹¬ç«‹å®ä½“è¿›è¡Œç ”ç©¶
- en: Pool all the data together and estimate the water quality of the city as a single
    big group
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ‰€æœ‰æ•°æ®æ±‡æ€»åœ¨ä¸€èµ·ï¼Œå¹¶å°†åŸå¸‚çš„æ°´è´¨ä¼°ç®—ä¸ºä¸€ä¸ªå¤§çš„æ•´ä½“ã€‚
- en: 'You have probably already noticed the pattern here. We can justify the first
    option by saying we obtain a more detailed view of the problem, which otherwise
    could become invisible or less evident if we average the data. The second option
    can be justified by saying that if we pool the data, we obtain a bigger sample
    size and hence a more accurate estimation. But we already know we have a third
    option: we can do a hierarchical model!'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°è¿™é‡Œçš„æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯´æˆ‘ä»¬è·å¾—äº†é—®é¢˜çš„æ›´è¯¦ç»†è§†å›¾æ¥è¯æ˜ç¬¬ä¸€ä¸ªé€‰é¡¹çš„åˆç†æ€§ï¼Œå¦åˆ™å¦‚æœæˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œå¹³å‡å¤„ç†ï¼Œé—®é¢˜å¯èƒ½ä¼šå˜å¾—ä¸å¯è§æˆ–ä¸é‚£ä¹ˆæ˜æ˜¾ã€‚ç¬¬äºŒä¸ªé€‰é¡¹çš„åˆç†æ€§å¯ä»¥é€šè¿‡è¯´å¦‚æœæˆ‘ä»¬å°†æ•°æ®æ±‡æ€»ï¼Œæˆ‘ä»¬å°±èƒ½è·å¾—æ›´å¤§çš„æ ·æœ¬é‡ï¼Œä»è€Œå¾—åˆ°æ›´å‡†ç¡®çš„ä¼°è®¡æ¥è¯æ˜ã€‚ä½†æ˜¯æˆ‘ä»¬å·²ç»çŸ¥é“æˆ‘ä»¬æœ‰ç¬¬ä¸‰ä¸ªé€‰é¡¹ï¼šæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªå±‚æ¬¡æ¨¡å‹ï¼
- en: 'For this example, we are going to use synthetic data. I love using synthetic
    data; it is a great way to understand things. If you donâ€™t understand something,
    simulate it! There are many uses for synthetic data. Here, we are going to imagine
    we have collected water samples from three different regions of the same city
    and measured the lead content of water; samples with concentrations of lead above
    recommendations from the World Health Organization are marked with zero and samples
    with values below the recommendations are marked with one. This is a very simple
    scenario. In a more realistic example, we would have a continuous measurement
    of lead concentration and probably many more groups. Nevertheless, for our current
    purposes, this example is good enough to uncover the details of hierarchical models.
    We can generate the synthetic data with the following code:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åˆæˆæ•°æ®ã€‚æˆ‘å–œæ¬¢ä½¿ç”¨åˆæˆæ•°æ®ï¼›å®ƒæ˜¯ç†è§£äº‹ç‰©çš„ä¸€ä¸ªå¥½æ–¹æ³•ã€‚å¦‚æœä½ ä¸ç†è§£æŸä¸ªä¸œè¥¿ï¼Œå°±æ¨¡æ‹Ÿå®ƒï¼åˆæˆæ•°æ®æœ‰å¾ˆå¤šç”¨é€”ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å‡è®¾æˆ‘ä»¬å·²ç»ä»åŒä¸€åŸå¸‚çš„ä¸‰ä¸ªä¸åŒåŒºåŸŸæ”¶é›†äº†æ°´æ ·ï¼Œå¹¶æµ‹é‡äº†æ°´ä¸­çš„é“…å«é‡ï¼›é“…å«é‡è¶…è¿‡ä¸–ç•Œå«ç”Ÿç»„ç»‡å»ºè®®å€¼çš„æ ·æœ¬æ ‡è®°ä¸ºé›¶ï¼Œä½äºå»ºè®®å€¼çš„æ ·æœ¬æ ‡è®°ä¸ºä¸€ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åœºæ™¯ã€‚åœ¨æ›´ç°å®çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šæœ‰é“…æµ“åº¦çš„è¿ç»­æµ‹é‡ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæœ‰æ›´å¤šçš„ç»„ã€‚ç„¶è€Œï¼Œé’ˆå¯¹æˆ‘ä»¬å½“å‰çš„ç›®çš„ï¼Œè¿™ä¸ªä¾‹å­è¶³å¤Ÿæ­ç¤ºå±‚æ¬¡æ¨¡å‹çš„ç»†èŠ‚ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç ç”Ÿæˆåˆæˆæ•°æ®ï¼š
- en: '**CodeÂ 3.3**'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»£ç  3.3**'
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We are simulating an experiment where we have measured three groups, each one
    consisting of a certain number of samples; we store the total number of samples
    per group in the `N_samples` list. Using the `G_samples` list, we keep a record
    of the number of good-quality samples per group. The rest of the code is there
    just to generate a list of the data, filled with zeros and ones.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨æ¨¡æ‹Ÿä¸€ä¸ªå®éªŒï¼Œæˆ‘ä»¬æµ‹é‡äº†ä¸‰ä¸ªç»„ï¼Œæ¯ä¸ªç»„åŒ…å«ä¸€å®šæ•°é‡çš„æ ·æœ¬ï¼›æˆ‘ä»¬å°†æ¯ç»„çš„æ ·æœ¬æ€»æ•°å­˜å‚¨åœ¨`N_samples`åˆ—è¡¨ä¸­ã€‚ä½¿ç”¨`G_samples`åˆ—è¡¨ï¼Œæˆ‘ä»¬è®°å½•æ¯ç»„ä¸­è‰¯å¥½æ°´è´¨æ ·æœ¬çš„æ•°é‡ã€‚å…¶ä½™çš„ä»£ç ä»…ç”¨äºç”Ÿæˆä¸€ä¸ªåŒ…å«é›¶å’Œä¸€çš„æ•°æ®åˆ—è¡¨ã€‚
- en: 'The model for this problem is similar to the one we used for the coin problem,
    except for two important features:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªé—®é¢˜çš„æ¨¡å‹ä¸æˆ‘ä»¬ç”¨äºç¡¬å¸é—®é¢˜çš„æ¨¡å‹ç±»ä¼¼ï¼Œé™¤äº†ä¸¤ä¸ªé‡è¦ç‰¹å¾ï¼š
- en: We have defined two hyperpriors that will influence the Beta prior.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªè¶…å…ˆéªŒï¼Œè¿™äº›å°†å½±å“Betaå…ˆéªŒã€‚
- en: 'Instead of setting hyperpriors on the parameters *Î±* and *Î²*, we are defining
    the Beta distribution in terms of *Î¼*, the mean, and *Î½*, the concentration (or
    precision) of the Beta distribution. The precision is analog to the inverse of
    the standard deviation; the larger the value of *Î½*, the more concentrated the
    Beta distribution will be. In statistical notation, our model is as follows:'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¸æ˜¯å¯¹å‚æ•°*Î±*å’Œ*Î²*è®¾ç½®è¶…å…ˆéªŒï¼Œè€Œæ˜¯é€šè¿‡*Î¼*ï¼ˆå‡å€¼ï¼‰å’Œ*Î½*ï¼ˆBetaåˆ†å¸ƒçš„æµ“åº¦æˆ–ç²¾åº¦ï¼‰æ¥å®šä¹‰Betaåˆ†å¸ƒã€‚ç²¾åº¦ç±»ä¼¼äºæ ‡å‡†å·®çš„å€’æ•°ï¼›*Î½*çš„å€¼è¶Šå¤§ï¼ŒBetaåˆ†å¸ƒå°±è¶Šé›†ä¸­ã€‚åœ¨ç»Ÿè®¡ç¬¦å·ä¸­ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '![ Î¼ âˆ¼ Beta(ğ›¼Î¼,ğ›½Î¼) Î½ âˆ¼ â„‹ğ’© (ÏƒÎ½) Î¸i âˆ¼ Beta(Î¼,Î½) y âˆ¼ Bernoulli(Î¸) i i ](img/file90.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![ Î¼ âˆ¼ Beta(ğ›¼Î¼,ğ›½Î¼) Î½ âˆ¼ â„‹ğ’© (ÏƒÎ½) Î¸i âˆ¼ Beta(Î¼,Î½) y âˆ¼ Bernoulli(Î¸) i i ](img/file90.jpg)'
- en: Notice that we are using the subscript *i* to indicate that the model has groups
    with different values for some of the parameters. Using Kruschke diagrams (see
    *Figure [3.4](#x1-70010r4)*), we can recognize that the new model has one additional
    level compared to the one from *Figure [1.14](CH01.xhtml#x1-39001r14)*. Notice
    also that for this model, we are parametrizing the Beta prior distribution in
    terms of *Î¼* and *Î½* instead of *Î±* and *Î²*. This is a common practice in Bayesian
    statistics, and it is done because *Î¼* and *Î½* are more intuitive parameters than
    *Î±* and *Î²*.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹æ ‡*i*æ¥è¡¨ç¤ºæ¨¡å‹ä¸­æŸäº›å‚æ•°åœ¨ä¸åŒç»„ä¹‹é—´çš„å–å€¼ã€‚é€šè¿‡Kruschkeå›¾ï¼ˆè§*å›¾ [3.4](#x1-70010r4)*ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–°æ¨¡å‹ç›¸æ¯”äº*å›¾
    [1.14](CH01.xhtml#x1-39001r14)*ï¼Œå¤šäº†ä¸€ä¸ªé¢å¤–çš„å±‚çº§ã€‚è¿˜è¦æ³¨æ„ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯ç”¨*Î¼*å’Œ*Î½*æ¥å‚æ•°åŒ–Betaå…ˆéªŒåˆ†å¸ƒï¼Œè€Œä¸æ˜¯ä½¿ç”¨*Î±*å’Œ*Î²*ã€‚è¿™æ˜¯è´å¶æ–¯ç»Ÿè®¡ä¸­çš„å¸¸è§åšæ³•ï¼Œå› ä¸º*Î¼*å’Œ*Î½*æ¯”*Î±*å’Œ*Î²*æ›´ç›´è§‚ã€‚
- en: '![PIC](img/file91.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file91.png)'
- en: '**FigureÂ 3.4**: Hierarchical model'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.4**ï¼šå±‚æ¬¡æ¨¡å‹'
- en: 'Letâ€™s write the model in PyMC:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åœ¨PyMCä¸­ç¼–å†™è¿™ä¸ªæ¨¡å‹ï¼š
- en: '**CodeÂ 3.4**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»£ç  3.4**'
- en: '[PRE3]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 3.4 Shrinkage
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.4 æ”¶ç¼©æ•ˆåº”
- en: 'To show you one of the main consequences of hierarchical models, I will require
    your assistance, so please join me in a brief experiment. I will need you to print
    and save the summary computed with `az.summary(idata_h)`. Then, I want you to
    rerun the model two more times after making small changes to the synthetic data.
    Remember to save the summary after each run. In total, we will have three runs:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å±•ç¤ºå±‚æ¬¡æ¨¡å‹çš„ä¸»è¦åæœï¼Œæˆ‘éœ€è¦ä½ çš„å¸®åŠ©ï¼Œè¯·å‚ä¸ä¸€ä¸ªç®€çŸ­çš„å®éªŒã€‚æˆ‘éœ€è¦ä½ æ‰“å°å¹¶ä¿å­˜é€šè¿‡`az.summary(idata_h)`è®¡ç®—å‡ºçš„æ‘˜è¦ã€‚ç„¶åï¼Œæˆ‘å¸Œæœ›ä½ åœ¨å¯¹åˆæˆæ•°æ®åšäº›å°è°ƒæ•´åï¼Œå†è¿è¡Œæ¨¡å‹ä¸¤æ¬¡ã€‚è®°å¾—æ¯æ¬¡è¿è¡Œåä¿å­˜æ‘˜è¦ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¸‰æ¬¡è¿è¡Œï¼š
- en: One run setting all the elements of `G_samples` to 18
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€è½®è®¾ç½®`G_samples`çš„æ‰€æœ‰å…ƒç´ ä¸º18
- en: One run setting all the elements of `G_samples` to 3
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€è½®è®¾ç½®`G_samples`çš„æ‰€æœ‰å…ƒç´ ä¸º3
- en: One last run setting one element to 18 and the other two to 3
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ€åä¸€è½®è®¾ç½®ä¸€ä¸ªå…ƒç´ ä¸º18ï¼Œå¦å¤–ä¸¤ä¸ªä¸º3
- en: Before continuing, please take a moment to think about the outcome of this experiment.
    Focus on the estimated mean value of *Î¸* in each experiment. Based on the first
    two runs of the model, could you predict the outcome for the third case?
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·èŠ±ç‚¹æ—¶é—´æ€è€ƒä¸€ä¸‹è¿™ä¸ªå®éªŒçš„ç»“æœã€‚é‡ç‚¹å…³æ³¨æ¯ä¸ªå®éªŒä¸­*Î¸*çš„ä¼°è®¡å‡å€¼ã€‚æ ¹æ®å‰ä¸¤æ¬¡è¿è¡Œçš„æ¨¡å‹ï¼Œä½ èƒ½é¢„æµ‹ç¬¬ä¸‰ç§æƒ…å†µçš„ç»“æœå—ï¼Ÿ
- en: 'If we put the result in a table, we get something more or less like this; remember
    that small variations could occur due to the stochastic nature of the sampling
    process:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æŠŠç»“æœæ”¾åœ¨è¡¨æ ¼ä¸­ï¼Œä¼šå¾—åˆ°å¤§è‡´å¦‚ä¸‹çš„å†…å®¹ï¼›è®°ä½ï¼Œç”±äºé‡‡æ ·è¿‡ç¨‹çš„éšæœºæ€§ï¼Œå¯èƒ½ä¼šæœ‰å°çš„å˜åŒ–ï¼š
- en: '| G_samples | Mean |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| G_samples | Mean |'
- en: '| 18, 18, 18 | 0.6, 0.6, 0.6 |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 18, 18, 18 | 0.6, 0.6, 0.6 |'
- en: '| 3, 3, 3 | 0.11, 0.11, 0.11 |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 3, 3, 3 | 0.11, 0.11, 0.11 |'
- en: '| 18, 3, 3 | 0.55, 0.13, 0.13 |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| 18, 3, 3 | 0.55, 0.13, 0.13 |'
- en: '**TableÂ 3.1**: Sample data and corresponding means'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '**è¡¨æ ¼ 3.1**ï¼šæ ·æœ¬æ•°æ®å’Œå¯¹åº”çš„å‡å€¼'
- en: In the first row, we can see that for a dataset of 18 good samples out of 30,
    we get a mean value for *Î¸* of 0.6; remember that now the mean of *Î¸* is a vector
    of 3 elements, 1 per group. Then, on the second row, we have only 3 good samples
    out of 30 and the mean of *Î¸* is 0.11\. These results should not be surprising;
    our estimates are practically the same as the empirical means. The interesting
    part comes in the third row. Instead of getting a mix of the mean estimates of
    *Î¸* from the other two rows, such as 0.6, 0.11, and 0.11, we get different values,
    namely 0.55, 0.13, and 0.13.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ç¬¬ä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å¯¹äºä¸€ä¸ªç”±30ä¸ªæ ·æœ¬ä¸­æŒ‘é€‰å‡ºçš„18ä¸ªå¥½æ ·æœ¬ç»„æˆçš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¾—åˆ°çš„*Î¸*å‡å€¼æ˜¯0.6ï¼›è¯·è®°ä½ï¼Œç°åœ¨*Î¸*çš„å‡å€¼æ˜¯ä¸€ä¸ªåŒ…å«3ä¸ªå…ƒç´ çš„å‘é‡ï¼Œæ¯ä¸ªç»„å¯¹åº”ä¸€ä¸ªå…ƒç´ ã€‚ç„¶åï¼Œåœ¨ç¬¬äºŒè¡Œä¸­ï¼Œåªæœ‰30ä¸ªæ ·æœ¬ä¸­çš„3ä¸ªæ˜¯å¥½æ ·æœ¬ï¼Œ*Î¸*çš„å‡å€¼ä¸º0.11ã€‚è¿™äº›ç»“æœå¹¶ä¸ä»¤äººæƒŠè®¶ï¼›æˆ‘ä»¬çš„ä¼°è®¡å€¼ä¸ç»éªŒå‡å€¼å‡ ä¹ç›¸åŒã€‚æœ‰è¶£çš„éƒ¨åˆ†å‡ºç°åœ¨ç¬¬ä¸‰è¡Œã€‚æˆ‘ä»¬æ²¡æœ‰å¾—åˆ°æ¥è‡ªå‰ä¸¤è¡Œçš„*Î¸*å‡å€¼çš„æ··åˆç»“æœï¼Œå¦‚0.6ã€0.11å’Œ0.11ï¼Œè€Œæ˜¯å¾—åˆ°äº†ä¸åŒçš„å€¼ï¼Œå³0.55ã€0.13å’Œ0.13ã€‚
- en: What on Earth happened? Did we make a mistake somewhere? Nothing like that.
    What we are seeing is that the estimates have shrunk toward the common mean. This
    is totally OK; indeed this is just a consequence of our model. By using hyperpriors,
    we are estimating the parameters of the Beta prior distribution from the data.
    Each group is informing the rest, and each group is informed by the estimation
    of the others.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æ˜¯ä¸æ˜¯å“ªé‡Œå‡ºé”™äº†ï¼Ÿå¹¶ä¸æ˜¯é‚£æ ·ã€‚æˆ‘ä»¬çœ‹åˆ°çš„ç°è±¡æ˜¯ä¼°è®¡å€¼å·²ç»å‘å…±åŒå‡å€¼æ”¶ç¼©äº†ã€‚è¿™æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼›å®é™…ä¸Šï¼Œè¿™åªæ˜¯æˆ‘ä»¬æ¨¡å‹çš„ä¸€ä¸ªç»“æœã€‚é€šè¿‡ä½¿ç”¨è¶…å…ˆéªŒï¼Œæˆ‘ä»¬æ˜¯ä»æ•°æ®ä¸­ä¼°è®¡Betaå…ˆéªŒåˆ†å¸ƒçš„å‚æ•°ã€‚æ¯ä¸ªç»„éƒ½åœ¨å‘å…¶ä»–ç»„æä¾›ä¿¡æ¯ï¼ŒåŒæ—¶æ¯ä¸ªç»„ä¹Ÿé€šè¿‡å…¶ä»–ç»„çš„ä¼°è®¡ç»“æœæ¥è·å¾—ä¿¡æ¯ã€‚
- en: '*Figure [3.5](#x1-71004r5)* shows the posterior estimates of *Î¼* and *Î½* plugged
    into a Beta distribution. In other words, this is the posterior distribution of
    the inferred Beta prior distribution.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*å›¾ [3.5](#x1-71004r5)* æ˜¾ç¤ºäº†å°†*Î¼*å’Œ*Î½*çš„åéªŒä¼°è®¡å€¼ä»£å…¥Betaåˆ†å¸ƒã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ˜¯æ¨æ–­Betaå…ˆéªŒåˆ†å¸ƒçš„åéªŒåˆ†å¸ƒã€‚'
- en: '![PIC](img/file92.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file92.png)'
- en: '**FigureÂ 3.5**: Posterior distribution of the inferred Beta prior distribution'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.5**: æ¨æ–­Betaå…ˆéªŒåˆ†å¸ƒçš„åéªŒåˆ†å¸ƒ'
- en: Why is shrinkage desirable? Because it contributes to more stable inferences.
    This is, in many ways, similar to what we saw with the Studentâ€™s t-distribution
    and the outliers; using a heavy-tailed distribution results in a more robust model
    to data points away from the mean. Introducing hyperpriors results in a more conservative
    model, one that is less responsive to extreme values in individual groups. Imagine
    that the sample sizes are different from each neighborhood, some small, some large;
    the smaller the sample size, the easier it is to get bogus results. At an extreme,
    if you take only one sample in a given neighborhood, you may just hit the only
    really old lead pipe in the whole neighborhood or, on the contrary, the only one
    made out of PVC. In one case, you will overestimate the bad quality and in the
    other underestimate it. Under a hierarchical model, the misestimation of one group
    will be ameliorated by the information provided by the other groups. A larger
    sample size will also do the trick but, more often than not, that is not an option.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆæ”¶ç¼©æ˜¯å¯å–çš„ï¼Ÿå› ä¸ºå®ƒæœ‰åŠ©äºæ›´ç¨³å®šçš„æ¨æ–­ã€‚ä»å¤šä¸ªæ–¹é¢æ¥çœ‹ï¼Œè¿™ç±»ä¼¼äºæˆ‘ä»¬åœ¨å­¦ç”Ÿtåˆ†å¸ƒå’Œå¼‚å¸¸å€¼ä¸­çœ‹åˆ°çš„æƒ…å†µï¼›ä½¿ç”¨é‡å°¾åˆ†å¸ƒèƒ½å¤Ÿä½¿æ¨¡å‹å¯¹åç¦»å‡å€¼çš„æ•°æ®ç‚¹æ›´å…·é²æ£’æ€§ã€‚å¼•å…¥è¶…å…ˆéªŒä¼šå¯¼è‡´æ¨¡å‹æ›´ä¸ºä¿å®ˆï¼Œä½¿å…¶å¯¹å•ä¸ªç»„ä¸­æç«¯å€¼çš„ååº”æ›´ä¸ºè¿Ÿç¼“ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸åŒé‚»é‡Œä¹‹é—´çš„æ ·æœ¬é‡ä¸åŒï¼Œæœ‰çš„è¾ƒå°ï¼Œæœ‰çš„è¾ƒå¤§ï¼›æ ·æœ¬é‡è¶Šå°ï¼Œå‡ºç°è™šå‡ç»“æœçš„å¯èƒ½æ€§è¶Šå¤§ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœä½ åœ¨æŸä¸ªé‚»é‡Œåªå–ä¸€ä¸ªæ ·æœ¬ï¼Œå¯èƒ½ä¼šç¢°åˆ°æ•´ä¸ªé‚»é‡Œå”¯ä¸€çš„è€æ—§é“…ç®¡ï¼Œæˆ–è€…ç›¸åï¼Œå”¯ä¸€çš„PVCç®¡ã€‚åœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œä½ ä¼šé«˜ä¼°å·®çš„è´¨é‡ï¼Œè€Œåœ¨å¦ä¸€ç§æƒ…å†µä¸‹ï¼Œä½ ä¼šä½ä¼°å®ƒã€‚åœ¨å±‚çº§æ¨¡å‹ä¸‹ï¼Œä¸€ä¸ªç»„çš„é”™è¯¯ä¼°è®¡ä¼šé€šè¿‡å…¶ä»–ç»„æä¾›çš„ä¿¡æ¯å¾—åˆ°ç¼“è§£ã€‚æ›´å¤§çš„æ ·æœ¬é‡ä¹Ÿèƒ½èµ·åˆ°ç±»ä¼¼çš„æ•ˆæœï¼Œä½†å¾€å¾€è¿™ç§æ–¹æ³•ä¸å¯è¡Œã€‚
- en: The amount of shrinkage depends on the data; a group with more data will pull
    the estimate of the other groups harder than a group with fewer data points. If
    several groups are similar and one group is different, the similar groups are
    going to inform the others of their similarity and reinforce a common estimation,
    while pulling the estimation for the less similar group toward them; this is exactly
    what we saw in the previous example. The hyperpriors also have a role in modulating
    the amount of shrinkage. We can effectively use an informative prior distribution
    to shrink our estimate to some reasonable value if we have trustworthy information
    about the group-level distribution.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æ”¶ç¼©çš„ç¨‹åº¦å–å†³äºæ•°æ®ï¼›æ•°æ®é‡æ›´å¤šçš„ç»„ä¼šæ¯”æ•°æ®é‡è¾ƒå°‘çš„ç»„æ›´å¼ºçƒˆåœ°æ‹‰åŠ¨å…¶ä»–ç»„çš„ä¼°è®¡å€¼ã€‚å¦‚æœå‡ ä¸ªç»„ç›¸ä¼¼ï¼Œè€ŒæŸä¸€ä¸ªç»„ä¸åŒï¼Œé‚£ä¹ˆç›¸ä¼¼çš„ç»„ä¼šå°†å®ƒä»¬çš„ç›¸ä¼¼æ€§ä¼ é€’ç»™å…¶ä»–ç»„ï¼Œå¹¶å¼ºåŒ–å…±åŒçš„ä¼°è®¡ï¼ŒåŒæ—¶å°†ä¸åŒç»„çš„ä¼°è®¡å€¼å‘å®ƒä»¬æ‹‰æ‹¢ï¼›è¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­çœ‹åˆ°çš„æƒ…å†µã€‚è¶…å…ˆéªŒåœ¨è°ƒèŠ‚æ”¶ç¼©é‡æ–¹é¢ä¹Ÿèµ·ç€ä½œç”¨ã€‚å¦‚æœæˆ‘ä»¬å¯¹ç»„çº§åˆ†å¸ƒæœ‰å¯ä¿¡çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨ä¿¡æ¯æ€§å…ˆéªŒåˆ†å¸ƒå°†ä¼°è®¡å€¼æ”¶ç¼©åˆ°ä¸€ä¸ªåˆç†çš„å€¼ã€‚
- en: Shrinkage
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: æ”¶ç¼©
- en: In a hierarchical model, groups sharing a common hyperprior are effectively
    sharing information through the hyperprior. This results in shrinkage, that is,
    individual estimates are shrunk toward the common mean. By partially pooling the
    data, we are modeling the groups as some middle ground between the groups being
    independent of each other and being a single big group.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å±‚çº§æ¨¡å‹ä¸­ï¼Œå…±äº«ç›¸åŒè¶…å…ˆéªŒçš„ç»„å®é™…ä¸Šé€šè¿‡è¶…å…ˆéªŒå…±äº«ä¿¡æ¯ã€‚è¿™å¯¼è‡´äº†æ”¶ç¼©ç°è±¡ï¼Œä¹Ÿå°±æ˜¯ï¼Œå•ç‹¬çš„ä¼°è®¡å€¼ä¼šå‘å…±åŒçš„å‡å€¼æ”¶ç¼©ã€‚é€šè¿‡éƒ¨åˆ†æ±‡æ€»æ•°æ®ï¼Œæˆ‘ä»¬å°†ç»„è§†ä¸ºä¸€ç§åœ¨ç‹¬ç«‹ç»„å’Œå•ä¸€å¤§ç»„ä¹‹é—´çš„ä¸­é—´çŠ¶æ€ã€‚
- en: Nothing prevents us from building a hierarchical model with just two groups,
    but we would prefer to have several groups. Intuitively, the reason is that getting
    shrinkage is like assuming each group is a data point, and we are estimating the
    standard deviation at the group level. Generally, we do not trust an estimation
    with too few data points unless we have a strong prior informing our estimation.
    Something similar is true for a hierarchical model.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢æˆ‘ä»¬åªä½¿ç”¨ä¸¤ä¸ªç»„æ¥æ„å»ºå±‚çº§æ¨¡å‹ï¼Œä½†æˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨å¤šä¸ªç»„ã€‚ç›´è§‚æ¥çœ‹ï¼ŒåŸå› æ˜¯æ”¶ç¼©çš„è¿‡ç¨‹å°±åƒå‡è®¾æ¯ä¸ªç»„éƒ½æ˜¯ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œæˆ‘ä»¬åœ¨ç»„å±‚é¢ä¸Šä¼°è®¡æ ‡å‡†å·®ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œé™¤éæˆ‘ä»¬æœ‰å¼ºæœ‰åŠ›çš„å…ˆéªŒä¿¡æ¯æ¥æŒ‡å¯¼æˆ‘ä»¬çš„ä¼°è®¡ï¼Œå¦åˆ™æˆ‘ä»¬ä¸å¤ªä¿¡ä»»æ•°æ®ç‚¹è¿‡å°‘çš„ä¼°è®¡ã€‚å±‚çº§æ¨¡å‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- en: 3.5 Hierarchies all the way up
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.5 å±‚çº§æ¨¡å‹é€å±‚æ„å»º
- en: 'Various data structures lend themselves to hierarchical descriptions that can
    encompass multiple levels. For example, consider professional football (soccer)
    players. As in many other sports, players have different positions. We may be
    interested in estimating some skill metrics for each player, for the positions,
    and for the overall group of professional football players. This kind of hierarchical
    structure can be found in many other domains as well:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: å„ç§æ•°æ®ç»“æ„æœ‰åŠ©äºå±‚æ¬¡åŒ–æè¿°ï¼Œå¯ä»¥æ¶µç›–å¤šä¸ªå±‚çº§ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘èŒä¸šè¶³çƒï¼ˆè¶³çƒï¼‰è¿åŠ¨å‘˜ã€‚ä¸è®¸å¤šå…¶ä»–è¿åŠ¨ä¸€æ ·ï¼Œè¿åŠ¨å‘˜æœ‰ä¸åŒçš„èŒä½ã€‚æˆ‘ä»¬å¯èƒ½æœ‰å…´è¶£ä¼°ç®—æ¯ä¸ªè¿åŠ¨å‘˜ã€æ¯ä¸ªèŒä½ä»¥åŠæ‰€æœ‰èŒä¸šè¶³çƒè¿åŠ¨å‘˜çš„æŠ€èƒ½æŒ‡æ ‡ã€‚è¿™ç§å±‚æ¬¡åŒ–ç»“æ„åœ¨è®¸å¤šå…¶ä»–é¢†åŸŸä¹Ÿèƒ½æ‰¾åˆ°ï¼š
- en: 'Medical research: Suppose we are interested in estimating the effectiveness
    of different drugs for treating a particular disease. We can categorize patients
    based on their demographic information, disease severity, and other relevant factors
    and build a hierarchical model to estimate the probability of cure or treatment
    success for each subgroup. We can then use the parameters of the subgroup distribution
    to estimate the overall probability of cure or treatment success for the entire
    patient population.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŒ»å­¦ç ”ç©¶ï¼šå‡è®¾æˆ‘ä»¬æœ‰å…´è¶£ä¼°è®¡ä¸åŒè¯ç‰©æ²»ç–—æŸç§ç–¾ç—…çš„æ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®æ‚£è€…çš„ä¸ªäººä¿¡æ¯ã€ç–¾ç—…ä¸¥é‡ç¨‹åº¦å’Œå…¶ä»–ç›¸å…³å› ç´ å¯¹æ‚£è€…è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æ„å»ºä¸€ä¸ªå±‚æ¬¡æ¨¡å‹æ¥ä¼°ç®—æ¯ä¸ªå­ç»„çš„æ²»æ„ˆæˆ–æ²»ç–—æˆåŠŸçš„æ¦‚ç‡ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­ç»„åˆ†å¸ƒçš„å‚æ•°æ¥ä¼°ç®—æ•´ä¸ªæ‚£è€…ç¾¤ä½“çš„æ²»æ„ˆæˆ–æ²»ç–—æˆåŠŸçš„æ€»ä½“æ¦‚ç‡ã€‚
- en: 'Environmental science: Suppose we are interested in estimating the impact of
    a certain pollutant on a particular ecosystem. We can categorize different habitats
    within the ecosystem (e.g., rivers, lakes, forests, wetlands) and build a hierarchical
    model to estimate the distribution of pollutant levels within each habitat. We
    can then use the parameters of the habitat distribution to estimate the overall
    distribution of pollutant levels within the ecosystem.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¯å¢ƒç§‘å­¦ï¼šå‡è®¾æˆ‘ä»¬æœ‰å…´è¶£ä¼°è®¡æŸç§æ±¡æŸ“ç‰©å¯¹ç‰¹å®šç”Ÿæ€ç³»ç»Ÿçš„å½±å“ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ç”Ÿæ€ç³»ç»Ÿå†…çš„ä¸åŒæ –æ¯åœ°ï¼ˆä¾‹å¦‚æ²³æµã€æ¹–æ³Šã€æ£®æ—ã€æ¹¿åœ°ï¼‰è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æ„å»ºä¸€ä¸ªå±‚æ¬¡æ¨¡å‹æ¥ä¼°ç®—æ¯ä¸ªæ –æ¯åœ°å†…çš„æ±¡æŸ“ç‰©æ°´å¹³åˆ†å¸ƒã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ –æ¯åœ°åˆ†å¸ƒçš„å‚æ•°æ¥ä¼°ç®—æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­æ±¡æŸ“ç‰©æ°´å¹³çš„æ€»ä½“åˆ†å¸ƒã€‚
- en: 'Market research: Suppose we are interested in understanding the purchasing
    behavior of consumers for a particular product across different regions. We can
    categorize consumers based on their demographic information (e.g., age, gender,
    income, education) and build a hierarchical model to estimate the distribution
    of purchasing behavior for each subgroup. We can then use the parameters of the
    subgroup distribution to estimate the distribution of purchasing behavior for
    the overall group of consumers.'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¸‚åœºç ”ç©¶ï¼šå‡è®¾æˆ‘ä»¬æœ‰å…´è¶£äº†è§£ä¸åŒåœ°åŒºæ¶ˆè´¹è€…è´­ä¹°æŸä¸€äº§å“çš„è¡Œä¸ºã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®æ¶ˆè´¹è€…çš„ä¸ªäººä¿¡æ¯ï¼ˆä¾‹å¦‚å¹´é¾„ã€æ€§åˆ«ã€æ”¶å…¥ã€æ•™è‚²ï¼‰å¯¹å…¶è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æ„å»ºä¸€ä¸ªå±‚æ¬¡æ¨¡å‹æ¥ä¼°ç®—æ¯ä¸ªå­ç»„çš„è´­ä¹°è¡Œä¸ºåˆ†å¸ƒã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­ç»„åˆ†å¸ƒçš„å‚æ•°æ¥ä¼°ç®—æ•´ä¸ªæ¶ˆè´¹è€…ç¾¤ä½“çš„è´­ä¹°è¡Œä¸ºåˆ†å¸ƒã€‚
- en: Going back to our football players, we have collected data from the *Premier
    League*, *Ligue 1*, *Bundesliga*, *Serie A*, and *La Liga* over the course of
    four years (2017 to 2020). Letâ€™s suppose we are interested in the goals-per-shot
    metric. This is what statisticians usually call a *success rate*, and we can estimate
    it with a Binomial model where the parameter *n* is the number of shots and the
    observations *y* is the number of goals. This leaves us with an unknown value
    for *p*. In previous examples, we have been calling this parameter *Î¸* and we
    have used a Beta distribution to model it. We will do the same now, but hierarchically.
    See *Figure [3.6](#x1-72002r6)* for a graphical representation of the entire model.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å›åˆ°æˆ‘ä»¬çš„è¶³çƒè¿åŠ¨å‘˜æ•°æ®ï¼Œæˆ‘ä»¬æ”¶é›†äº†æ¥è‡ª*è‹±è¶…è”èµ›*ã€*æ³•ç”²è”èµ›*ã€*å¾·ç”²è”èµ›*ã€*æ„ç”²è”èµ›*å’Œ*è¥¿ç”²è”èµ›*çš„æ•°æ®ï¼Œæ•°æ®è¦†ç›–äº†å››å¹´ï¼ˆ2017è‡³2020å¹´ï¼‰ã€‚å‡è®¾æˆ‘ä»¬æœ‰å…´è¶£äº†è§£æ¯æ¬¡å°„é—¨çš„è¿›çƒæ•°ã€‚è¿™é€šå¸¸æ˜¯ç»Ÿè®¡å­¦å®¶æ‰€è¯´çš„*æˆåŠŸç‡*ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒé¡¹æ¨¡å‹æ¥ä¼°ç®—ï¼Œæ¨¡å‹ä¸­å‚æ•°*n*æ˜¯å°„é—¨æ¬¡æ•°ï¼Œè§‚å¯Ÿå€¼*y*æ˜¯è¿›çƒæ•°ã€‚è¿™æ ·å°±å‰©ä¸‹äº†ä¸€ä¸ªæœªçŸ¥çš„å‚æ•°*p*ã€‚åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ­¤å‚æ•°ç§°ä¸º*Î¸*ï¼Œå¹¶ä½¿ç”¨Betaåˆ†å¸ƒå¯¹å…¶å»ºæ¨¡ã€‚æˆ‘ä»¬ç°åœ¨ä¹Ÿä¼šè¿™æ ·åšï¼Œä½†é‡‡ç”¨å±‚æ¬¡åŒ–çš„æ–¹æ³•ã€‚è¯·å‚è§*å›¾[3.6](#x1-72002r6)*ï¼Œå®ƒæä¾›äº†æ•´ä¸ªæ¨¡å‹çš„å›¾å½¢è¡¨ç¤ºã€‚
- en: '![PIC](img/file93.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![PIC](img/file93.png)'
- en: '**FigureÂ 3.6**: Hierarchical model for the football players example. Notice
    that we have one more level than in previous hierarchical models'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾3.6**ï¼šè¶³çƒè¿åŠ¨å‘˜ç¤ºä¾‹çš„å±‚æ¬¡æ¨¡å‹ã€‚æ³¨æ„ï¼Œä¸ä¹‹å‰çš„å±‚æ¬¡æ¨¡å‹ç›¸æ¯”ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªå±‚çº§ã€‚'
- en: In our model, *Î¸* represents the success rate for each player, and thus it is
    a vector of size `n_players`. We use a Beta distribution to model *Î¸*. The hyperparameters
    of the Beta distribution will be the vectors *Î¼*[*p*] and *Î½*[*p*], which are
    vectors of size 4, representing the four positions in our dataset (defender `DF`,
    midfielder `MF`, forward `FW`, and goalkeeper `GK`). We will need to properly
    index the vectors *Î¼*[*p*] and *Î½*[*p*] to match the total number of players.
    Finally, we will have two global parameters, *Î¼* and *Î½*, representing the professional
    football players.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­ï¼Œ*Î¸*è¡¨ç¤ºæ¯ä¸ªçƒå‘˜çš„æˆåŠŸç‡ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªå¤§å°ä¸º`n_players`çš„å‘é‡ã€‚æˆ‘ä»¬ä½¿ç”¨Betaåˆ†å¸ƒæ¥å»ºæ¨¡*Î¸*ã€‚Betaåˆ†å¸ƒçš„è¶…å‚æ•°å°†æ˜¯*Î¼*[*p*]å’Œ*Î½*[*p*]å‘é‡ï¼Œè¿™äº›å‘é‡çš„å¤§å°ä¸º4ï¼Œä»£è¡¨æˆ‘ä»¬æ•°æ®é›†ä¸­å››ä¸ªä½ç½®ï¼ˆåå«`DF`ã€ä¸­åœº`MF`ã€å‰é”‹`FW`å’Œé—¨å°†`GK`ï¼‰ã€‚æˆ‘ä»¬éœ€è¦æ­£ç¡®åœ°ç´¢å¼•å‘é‡*Î¼*[*p*]å’Œ*Î½*[*p*]ï¼Œä»¥åŒ¹é…çƒå‘˜çš„æ€»æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æœ‰ä¸¤ä¸ªå…¨å±€å‚æ•°ï¼Œ*Î¼*å’Œ*Î½*ï¼Œè¡¨ç¤ºèŒä¸šè¶³çƒè¿åŠ¨å‘˜ã€‚
- en: 'The PyMC model is defined in the following block of code. `pm.Beta(â€™`*Î¼*`â€™,
    1.7, 5.8)` was chosen with the help of PreliZ as a prior with 95% of the mass
    between 0 and 0.5\. This is an example of a weakly informative prior, as there
    is little doubt that a success rate of 0.5 is a high value. Sports statistics
    are well-studied, and there is a lot of prior information that could be used to
    define stronger priors. For this example, we will settle on this prior. A similar
    justification can be done for the prior `pm.Gamma(â€™![](img/nu.PNG)â€™, mu=125, sigma=50)`,
    which we define as the maximum entropy Gamma prior with 90% of the mass between
    50 and 200:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: PyMCæ¨¡å‹åœ¨ä¸‹é¢çš„ä»£ç å—ä¸­å®šä¹‰ã€‚`pm.Beta(â€™`*Î¼*`â€™, 1.7, 5.8)`æ˜¯åœ¨PreliZçš„å¸®åŠ©ä¸‹é€‰æ‹©çš„å…ˆéªŒï¼Œ95%çš„è´¨é‡åˆ†å¸ƒåœ¨0åˆ°0.5ä¹‹é—´ã€‚è¿™æ˜¯ä¸€ä¸ªå¼±ä¿¡æ¯å…ˆéªŒçš„ç¤ºä¾‹ï¼Œå› ä¸ºå‡ ä¹æ²¡æœ‰ç–‘é—®ï¼Œ0.5çš„æˆåŠŸç‡æ˜¯ä¸€ä¸ªè¾ƒé«˜çš„å€¼ã€‚ä½“è‚²ç»Ÿè®¡æ•°æ®ç ”ç©¶å¾—éå¸¸é€å½»ï¼Œå­˜åœ¨å¤§é‡å¯ç”¨äºå®šä¹‰æ›´å¼ºå…ˆéªŒçš„ä¿¡æ¯ã€‚å¯¹äºè¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªå…ˆéªŒã€‚ç±»ä¼¼çš„ç†ç”±ä¹Ÿé€‚ç”¨äºå…ˆéªŒ`pm.Gamma(â€™![](img/nu.PNG)â€™,
    mu=125, sigma=50)`ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸ºæœ€å¤§ç†µGammaå…ˆéªŒï¼Œ90%çš„è´¨é‡åˆ†å¸ƒåœ¨50åˆ°200ä¹‹é—´ï¼š
- en: '**CodeÂ 3.5**'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»£ç  3.5**'
- en: '[PRE4]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In the top panel of *Figure [3.7](#x1-72024r7)*, we have the posterior distribution
    for the global parameter *Î¼*. The posterior distribution is close to 0.1\. This
    means that overall for a professional football player (from a top league), the
    probability of scoring a goal is on average 10%. This is a reasonable value, as
    scoring goals is not an easy task and we are not discriminating positions, i.e,
    we are considering players whose main role is not scoring goals. In the middle
    panel, we have the estimated *Î¼*[*p*] value for the forward position; as expected,
    it is higher than the global parameter *Î¼*. In the bottom panel, we have the estimated
    *Î¸* value for Lionel Messi, with a value of 0.17, which is higher than the global
    parameter *Î¼* and the forward position *Î¼*[*p*] value. This is also expected,
    as Lionel Messi is the best football player in the world, and his main role is
    scoring goals.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨*å›¾ [3.7](#x1-72024r7)*çš„é¡¶éƒ¨é¢æ¿ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å…¨å±€å‚æ•°*Î¼*çš„åéªŒåˆ†å¸ƒã€‚åéªŒåˆ†å¸ƒæ¥è¿‘äº0.1ã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºä¸€åèŒä¸šè¶³çƒè¿åŠ¨å‘˜ï¼ˆæ¥è‡ªé¡¶çº§è”èµ›ï¼‰ï¼Œè¿›çƒçš„æ¦‚ç‡å¹³å‡ä¸º10%ã€‚è¿™æ˜¯ä¸€ä¸ªåˆç†çš„å€¼ï¼Œå› ä¸ºè¿›çƒå¹¶éæ˜“äº‹ï¼Œå¹¶ä¸”æˆ‘ä»¬æ²¡æœ‰åŒºåˆ†ä½ç½®ï¼Œå³æˆ‘ä»¬è€ƒè™‘çš„æ˜¯é‚£äº›ä¸»è¦è§’è‰²ä¸æ˜¯è¿›çƒçš„çƒå‘˜ã€‚åœ¨ä¸­é—´é¢æ¿ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å‰é”‹ä½ç½®çš„ä¼°è®¡*Î¼*[*p*]å€¼ï¼›å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå®ƒé«˜äºå…¨å±€å‚æ•°*Î¼*ã€‚åœ¨åº•éƒ¨é¢æ¿ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†æ¢…è¥¿çš„ä¼°è®¡*Î¸*å€¼ï¼Œå€¼ä¸º0.17ï¼Œé«˜äºå…¨å±€å‚æ•°*Î¼*å’Œå‰é”‹ä½ç½®*Î¼*[*p*]å€¼ã€‚è¿™ä¹Ÿæ˜¯å¯ä»¥é¢„æœŸçš„ï¼Œå› ä¸ºæ¢…è¥¿æ˜¯ä¸–ç•Œä¸Šæœ€ä¼˜ç§€çš„è¶³çƒè¿åŠ¨å‘˜ï¼Œä»–çš„ä¸»è¦è§’è‰²æ˜¯è¿›çƒã€‚
- en: '![PIC](img/file94.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file94.png)'
- en: '**FigureÂ 3.7**: Posterior distribution for the mean global parameter (top),
    mean forward position (middle), and the *Î¸* parameter for Messi (bottom)'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.7**ï¼šå…¨å±€å‚æ•°çš„åéªŒåˆ†å¸ƒï¼ˆé¡¶éƒ¨ï¼‰ã€å‰å‘ä½ç½®çš„å‡å€¼ï¼ˆä¸­éƒ¨ï¼‰ä»¥åŠæ¢…è¥¿çš„*Î¸*å‚æ•°ï¼ˆåº•éƒ¨ï¼‰'
- en: '*Figure [3.8](#x1-72025r8)* shows a forest plot for the posterior distribution
    for the parameter *Î¼*[*p*]. The posterior distribution for the forward position
    is centered around 0.13, as we have already seen, and is the highest of the four.
    This makes sense as the role of the players at a forward position is scoring goals
    as well as assisting them. The lowest value of *Î¼*[*p*] is for the goalkeeper
    position. This is expected, as the main role is to stop the opposing team from
    scoring, and not to score goals. The interesting aspect is that the uncertainty
    is very high; this is because we have very few goalkeepers scoring goals in our
    dataset, three to be precise. The posterior distributions for the defender and
    midfielder positions are somewhat in the middle, being slightly higher for the
    midfielder. We can explain this as the main role of a midfielder is to defend
    and attack, and thus the probability of scoring a goal is higher than a defender
    but lower than a forward.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '*å›¾ [3.8](#x1-72025r8)* å±•ç¤ºäº†å‚æ•° *Î¼*[*p*] çš„åéªŒåˆ†å¸ƒçš„æ£®æ—å›¾ã€‚æ­£å¦‚æˆ‘ä»¬å·²ç»çœ‹åˆ°çš„ï¼Œå‰é”‹ä½ç½®çš„åéªŒåˆ†å¸ƒé›†ä¸­åœ¨ 0.13
    é™„è¿‘ï¼Œå¹¶ä¸”æ˜¯å››ä¸ªä½ç½®ä¸­æœ€é«˜çš„ã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºå‰é”‹çš„è§’è‰²æ˜¯è¿›çƒä»¥åŠåŠ©æ”»ã€‚*Î¼*[*p*] çš„æœ€ä½å€¼å‡ºç°åœ¨å®ˆé—¨å‘˜ä½ç½®ã€‚è¿™æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºå®ˆé—¨å‘˜çš„ä¸»è¦è§’è‰²æ˜¯é˜»æ­¢å¯¹æ–¹è¿›çƒï¼Œè€Œä¸æ˜¯è¿›çƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸ç¡®å®šæ€§éå¸¸é«˜ï¼›è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ•°æ®é›†ä¸­è¿›çƒçš„å®ˆé—¨å‘˜æ•°é‡éå¸¸å°‘ï¼Œå‡†ç¡®æ¥è¯´åªæœ‰ä¸‰åã€‚åå«å’Œä¸­åœºçš„ä½ç½®çš„åéªŒåˆ†å¸ƒå¤§è‡´å¤„äºä¸­é—´ï¼Œä¸”ä¸­åœºç•¥é«˜äºåå«ã€‚æˆ‘ä»¬å¯ä»¥è§£é‡Šä¸ºï¼Œä¸­åœºçš„ä¸»è¦è§’è‰²æ˜¯æ—¢è¦é˜²å®ˆä¹Ÿè¦è¿›æ”»ï¼Œå› æ­¤è¿›çƒçš„æ¦‚ç‡æ¯”åå«é«˜ï¼Œä½†ä½äºå‰é”‹ã€‚'
- en: '![PIC](img/file95.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](img/file95.png)'
- en: '**FigureÂ 3.8**: Posterior distribution for the parameter *Î¼*'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›¾ 3.8**ï¼šå‚æ•° *Î¼* çš„åéªŒåˆ†å¸ƒ'
- en: '*p, the mean position*'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '*pï¼Œå‡å€¼ä½ç½®*'
- en: You Need to Know When to Stop
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦çŸ¥é“ä½•æ—¶åœæ­¢
- en: It is possible to create hierarchical models with as many levels as we want.
    But unless the problem necessitates additional structure, adding more levels than
    required does not enhance the quality of our model or inferences. Instead, we
    will get entangled in a web of hyperpriors and hyperparameters without the ability
    to assign any meaningful interpretation to them. The goal of building models is
    to make sense of data, and thus useful models are usually those that reflect and
    take advantage of the structure of the data.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºå…·æœ‰ä»»æ„å±‚çº§çš„å±‚çº§æ¨¡å‹ã€‚ä½†é™¤éé—®é¢˜éœ€è¦é¢å¤–çš„ç»“æ„ï¼Œå¦åˆ™æ·»åŠ è¶…è¿‡å¿…è¦å±‚çº§çš„å±‚æ¬¡ä¸ä¼šæå‡æ¨¡å‹æˆ–æ¨æ–­çš„è´¨é‡ã€‚ç›¸åï¼Œæˆ‘ä»¬ä¼šé™·å…¥è¶…å…ˆéªŒå’Œè¶…å‚æ•°çš„è¿·ç½‘ä¸­ï¼Œè€Œæ— æ³•ä¸ºå®ƒä»¬èµ‹äºˆä»»ä½•æœ‰æ„ä¹‰çš„è§£é‡Šã€‚æ„å»ºæ¨¡å‹çš„ç›®æ ‡æ˜¯ç†è§£æ•°æ®ï¼Œå› æ­¤ï¼Œå®ç”¨çš„æ¨¡å‹é€šå¸¸æ˜¯é‚£äº›èƒ½å¤Ÿåæ˜ å¹¶åˆ©ç”¨æ•°æ®ç»“æ„çš„æ¨¡å‹ã€‚
- en: 3.6 Summary
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.6 å°ç»“
- en: 'In this chapter, we have presented one of the most important concepts to learn
    from this book: hierarchical models. We can build hierarchical models every time
    we can identify subgroups in our data. In such cases, instead of treating the
    subgroups as separate entities or ignoring the subgroups and treating them as
    a single group, we can build a model to partially pool information among groups.
    The main effect of this partial pooling is that the estimates of each subgroup
    will be biased by the estimates of the rest of the subgroups. This effect is known
    as shrinkage and, in general, is a very useful trick that helps to improve inferences
    by making them more conservative (as each subgroup informs the others by pulling
    estimates toward it) and more informative. We get estimates at the subgroup level
    and the group level.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« ä»‹ç»äº†æœ¬ä¹¦ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼šå±‚çº§æ¨¡å‹ã€‚æ¯å½“æˆ‘ä»¬èƒ½åœ¨æ•°æ®ä¸­è¯†åˆ«å‡ºå­ç¾¤æ—¶ï¼Œå°±å¯ä»¥æ„å»ºå±‚çº§æ¨¡å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸æ˜¯å°†å­ç¾¤å½“ä½œç‹¬ç«‹çš„å®ä½“ï¼Œæˆ–å¿½ç•¥å­ç¾¤å°†å®ƒä»¬è§†ä¸ºå•ä¸€ç¾¤ä½“ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œåœ¨ç¾¤ä½“ä¹‹é—´éƒ¨åˆ†åˆå¹¶ä¿¡æ¯ã€‚éƒ¨åˆ†åˆå¹¶çš„ä¸»è¦æ•ˆæœæ˜¯ï¼Œæ¯ä¸ªå­ç¾¤çš„ä¼°è®¡ä¼šå—åˆ°å…¶ä»–å­ç¾¤ä¼°è®¡çš„å½±å“ã€‚è¿™ç§æ•ˆåº”è¢«ç§°ä¸ºæ”¶ç¼©æ•ˆåº”ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æŠ€å·§ï¼Œé€šè¿‡è®©æ¨æ–­æ›´åŠ ä¿å®ˆï¼ˆå› ä¸ºæ¯ä¸ªå­ç¾¤é€šè¿‡å°†ä¼°è®¡æ‹‰å‘è‡ªå·±æ¥å½±å“å…¶ä»–å­ç¾¤ï¼‰å’Œæ›´å…·ä¿¡æ¯é‡ï¼Œæ¥å¸®åŠ©æ”¹è¿›æ¨æ–­ã€‚æˆ‘ä»¬åœ¨å­ç¾¤å±‚é¢å’Œç¾¤ä½“å±‚é¢éƒ½èƒ½è·å¾—ä¼°è®¡ã€‚
- en: Paraphrasing the Zen of Python, we can certainly say *hierarchical models are
    one* *honking great idea, letâ€™s do more of those!* In the following chapters,
    we will keep building hierarchical models and learn how to use them to build better
    models. We will also discuss how hierarchical models are related to the pervasive
    overfitting/underfitting issue in statistics and machine learning in *Chapter
    [5](CH05.xhtml#x1-950005)*. In *Chapter [10](CH10.xhtml#x1-18900010)*, we will
    discuss some technical problems that we may find when sampling from hierarchical
    models and how to diagnose and fix those problems.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å€Ÿç”¨ Python ç¦…æ„çš„è¡¨è¾¾æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è‚¯å®šåœ°è¯´ï¼Œ*å±‚æ¬¡æ¨¡å‹æ˜¯ä¸€ä¸ª* *éå¸¸æ£’çš„ä¸»æ„ï¼Œè®©æˆ‘ä»¬åšæ›´å¤šè¿™æ ·çš„äº‹æƒ…ï¼* åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ„å»ºå±‚æ¬¡æ¨¡å‹ï¼Œå¹¶å­¦ä¹ å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥æ„å»ºæ›´å¥½çš„æ¨¡å‹ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºå±‚æ¬¡æ¨¡å‹ä¸ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ä¸­æ™®éå­˜åœ¨çš„è¿‡æ‹Ÿåˆ/æ¬ æ‹Ÿåˆé—®é¢˜çš„å…³ç³»ï¼Œå†…å®¹å°†åœ¨*ç¬¬[5](CH05.xhtml#x1-950005)ç« *ä¸­è¿›è¡Œæ¢è®¨ã€‚åœ¨*ç¬¬[10](CH10.xhtml#x1-18900010)ç« *ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºåœ¨ä»å±‚æ¬¡æ¨¡å‹ä¸­é‡‡æ ·æ—¶å¯èƒ½é‡åˆ°çš„ä¸€äº›æŠ€æœ¯é—®é¢˜ï¼Œå¹¶æ¢è®¨å¦‚ä½•è¯Šæ–­å’Œè§£å†³è¿™äº›é—®é¢˜ã€‚
- en: 3.7 Exercises
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.7 ç»ƒä¹ 
- en: 'Using your own words explain the following concepts in two or three sentences:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç”¨ä½ è‡ªå·±çš„è¯è§£é‡Šä»¥ä¸‹æ¦‚å¿µï¼Œç”¨ä¸¤åˆ°ä¸‰å¥è¯ï¼š
- en: Complete pooling
  id: totrans-104
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: å®Œå…¨æ±‡æ€»
- en: No pooling
  id: totrans-105
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ— æ±‡æ€»
- en: Partial pooling
  id: totrans-106
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: éƒ¨åˆ†æ±‡æ€»
- en: Repeat the exercise we did with `model_h`. This time, without a hierarchical
    structure, use a flat prior such as Beta(*Î±* = 1*,*Î²** = 1). Compare the results
    of both models.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é‡å¤æˆ‘ä»¬åœ¨`model_h`ä¸­è¿›è¡Œçš„ç»ƒä¹ ã€‚è¿™ä¸€æ¬¡ï¼Œä¸ä½¿ç”¨å±‚æ¬¡ç»“æ„ï¼Œä½¿ç”¨ä¸€ä¸ªç®€å•çš„å…ˆéªŒï¼Œæ¯”å¦‚ Beta(*Î±* = 1*,*Î²* = 1)ã€‚æ¯”è¾ƒä¸¤ç§æ¨¡å‹çš„ç»“æœã€‚
- en: Create a hierarchical version of the tips example from *Chapter [2](CH02.xhtml#x1-440002)*,
    by partially pooling across the days of the week. Compare the results to those
    obtained without the hierarchical structure.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åˆ›å»ºä¸€ä¸ªå±‚æ¬¡åŒ–ç‰ˆæœ¬çš„ *ç¬¬[2](CH02.xhtml#x1-440002)ç« * ä¸­çš„ tips ç¤ºä¾‹ï¼Œé€šè¿‡åœ¨ä¸€å‘¨çš„å¤©æ•°ä¹‹é—´è¿›è¡Œéƒ¨åˆ†æ±‡æ€»ã€‚å°†ç»“æœä¸æ²¡æœ‰å±‚æ¬¡ç»“æ„æ—¶è·å¾—çš„ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚
- en: For each subpanel in *Figure [3.7](#x1-72024r7)*, add a reference line representing
    the empirical mean value at each level, that is, the global mean, the forward
    mean, and Messiâ€™s mean. Compare the empirical values to the posterior mean values.
    What do you observe?
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¯¹*å›¾[3.7](#x1-72024r7)*ä¸­çš„æ¯ä¸ªå­é¢æ¿ï¼Œæ·»åŠ ä¸€æ¡è¡¨ç¤ºæ¯ä¸ªå±‚çº§çš„ç»éªŒå‡å€¼çš„å‚è€ƒçº¿ï¼Œå³å…¨å±€å‡å€¼ã€å‰å‘å‡å€¼å’Œæ¢…è¥¿çš„å‡å€¼ã€‚æ¯”è¾ƒç»éªŒå€¼å’ŒåéªŒå‡å€¼ã€‚ä½ è§‚å¯Ÿåˆ°ä»€ä¹ˆï¼Ÿ
- en: Amino acids are usually grouped into categories such as `polar`, `non-polar`,
    `charged`, and `special`. Build a hierarchical model similar to `cs_h` but including
    a group effect for the amino acid category. Compare the results to those obtained
    in this chapter.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ°¨åŸºé…¸é€šå¸¸è¢«åˆ†ä¸º`ææ€§`ã€`éææ€§`ã€`å¸¦ç”µ`å’Œ`ç‰¹æ®Š`ç­‰ç±»åˆ«ã€‚æ„å»ºä¸€ä¸ªç±»ä¼¼äº`cs_h`çš„å±‚æ¬¡æ¨¡å‹ï¼Œä½†åŒ…æ‹¬ä¸€ä¸ªæ°¨åŸºé…¸ç±»åˆ«çš„ç»„æ•ˆåº”ã€‚å°†ç»“æœä¸æœ¬ç« ä¸­è·å¾—çš„ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚
- en: Join our community Discord space
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ å…¥æˆ‘ä»¬çš„ç¤¾åŒº Discord ç©ºé—´
- en: 'Join our Discord community to meet like-minded people and learn alongside more
    than 5000 members at: [https://packt.link/bayesian](https://packt.link/bayesian)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: åŠ å…¥æˆ‘ä»¬çš„ Discord ç¤¾åŒºï¼Œä¸å¿—åŒé“åˆçš„äººäº¤æµï¼Œå¹¶å’Œè¶…è¿‡ 5000 åæˆå‘˜ä¸€èµ·å­¦ä¹ ï¼Œé“¾æ¥åœ°å€ï¼š[https://packt.link/bayesian](https://packt.link/bayesian)
- en: '![PIC](img/file1.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![PIC](img/file1.png)'
