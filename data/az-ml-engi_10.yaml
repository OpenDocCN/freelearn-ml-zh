- en: '10'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '10'
- en: Using Deep Learning in Azure Machine Learning
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Azure Machine Learning 中使用深度学习
- en: '**Deep learning** is a subclass of machine learning. It is based on artificial
    neural networks, a programming paradigm inspired by the human biological nervous
    system, and it enables a computer to learn from a very large amount of observational
    data.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**深度学习**是机器学习的一个子类。它基于人工神经网络，这是一种受人类生物神经系统启发的编程范式，它使计算机能够从大量观察数据中学习。'
- en: There are some machine learning problems – such as image recognition, image
    classification, object detection, speech recognition, and natural language processing
    – that traditional machine learning techniques do not provide performant solutions
    for, whereas deep learning techniques do. This chapter will show you the deep
    learning capabilities available within AML that you can use to solve some of the
    previously mentioned problems.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 存在一些机器学习问题——例如图像识别、图像分类、目标检测、语音识别和自然语言处理——传统机器学习技术无法提供性能良好的解决方案，而深度学习技术则可以。本章将向你展示
    AML 中可用的深度学习能力，你可以使用这些能力来解决一些之前提到的问题。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Labeling image data for training an object detection model by using the AML
    Data Labeling feature
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AML 数据标注功能为训练目标检测模型标注图像数据
- en: Training an object detection model using Azure AutoML
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Azure AutoML 训练目标检测模型
- en: Deploying an object detection model to an online endpoint using the AML Python
    SDK
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AML Python SDK 将目标检测模型部署到在线端点
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To access your workspace, recall the steps from the previous chapter:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问你的工作区，回顾前一章中的步骤：
- en: Go to [https://ml.azure.com](https://ml.azure.com).
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往 [https://ml.azure.com](https://ml.azure.com)。
- en: Select your workspace name.
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你的工作区名称。
- en: On the workspace user interface on the left side, click **Compute**.
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧的工作区用户界面上，点击 **计算**。
- en: 'On the **Compute** screen, select your compute instance and select **Start**:'
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **计算** 屏幕上，选择你的计算实例并选择 **启动**：
- en: '![Figure 10.1 – Start compute](img/B18003_10_001.jpg)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.1 – 启动计算](img/B18003_10_001.jpg)'
- en: Figure 10.1 – Start compute
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.1 – 启动计算
- en: Your compute instance status will change from **Stopped** to **Starting**.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你的计算实例状态将从 **停止** 变为 **启动**。
- en: In the previous chapter, we cloned the Git repository; if you have not already
    done so, continue to follow these steps. If you have already cloned the repository,
    skip to *step 7*.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在前一章中，我们克隆了 Git 仓库；如果你还没有这样做，请继续按照以下步骤操作。如果你已经克隆了仓库，请跳转到 *步骤 7*。
- en: 'Open the terminal on your compute instance. Note the path will include your
    user in the directory. Type the following into the terminal to clone the sample
    notebooks into your working directory:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的计算实例上打开终端。注意路径将包括你的用户目录。在终端中输入以下内容以将示例笔记本克隆到你的工作目录：
- en: '[PRE0]'
  id: totrans-19
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Clicking on the refresh icon shown in *Figure 10**.2* will update and refresh
    the notebooks displayed on your screen:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击图 *图 10.2* 中显示的刷新图标将更新并刷新屏幕上显示的笔记本：
- en: '![Figure 10.2 – Refresh icon](img/B18003_10_002.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.2 – 刷新图标](img/B18003_10_002.jpg)'
- en: Figure 10.2 – Refresh icon
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.2 – 刷新图标
- en: 'Review the notebooks in your `Azure-Machine-Learning-Engineering` directory.
    This will display the files cloned into your working directory, as shown in *Figure
    10**.3*:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看你的 `Azure-Machine-Learning-Engineering` 目录中的笔记本。这将显示克隆到你的工作目录中的文件，如图 *图 10.3*
    所示：
- en: '![Figure 10.3 – Azure-Machine-Learning-Engineering](img/B18003_10_003.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.3 – Azure-Machine-Learning-Engineering](img/B18003_10_003.jpg)'
- en: Figure 10.3 – Azure-Machine-Learning-Engineering
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.3 – Azure-Machine-Learning-Engineering
- en: Labeling image data using the Data Labeling feature of Azure Machine Learning
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure Machine Learning 的数据标注功能标注图像数据
- en: In the field of computer vision, object detection is a challenging task for
    predicting the location of objects in an image and predicting the object types.
    Just like any other supervised machine learning task, in order to train an object
    detection model, we need to have training data and, in this case, a lot of labeled
    data, as deep learning works best on a large labeled dataset. Data scientists
    who develop computer vision models know how tedious and time-consuming it can
    be to label images, and even more time-consuming when it comes to labeling images
    for object detection models. The **Azure Machine Learning** (**Azure ML**) service
    has a powerful feature called **Data Labeling**, which significantly enhances
    the user experience for image labeling, leveraging built-in capabilities such
    as ML-assisted labeling by automatically training a model to pre-label images
    for you to review, accelerating the labeling process.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算机视觉领域，目标检测是预测图像中对象位置和对象类型的一个具有挑战性的任务。就像任何其他监督机器学习任务一样，为了训练目标检测模型，我们需要有训练数据，在这种情况下，大量的标注数据，因为深度学习在大型标注数据集上表现最佳。开发计算机视觉模型的数据科学家知道标注图像是多么繁琐和耗时，而对于标注目标检测模型图像来说，更是耗时。**Azure
    机器学习**（**Azure ML**）服务有一个名为**数据标注**的强大功能，该功能通过利用内置功能（如自动训练模型以预标注图像供您审查的机器学习辅助标注）显著提升了图像标注的用户体验，从而加速了标注过程。
- en: 'In this section, you will learn how to label your images for training an object
    detection model by leveraging the Data Labeling feature of Azure ML by following
    these steps:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将通过以下步骤了解如何利用 Azure ML 的数据标注功能来为训练目标检测模型标注您的图像：
- en: 'Go to the `chapter 10` folder of the cloned repository of this book that you
    have been using. You will see the `images` folder, which has two subfolders: `train`
    and `test`. You will be using the images in the `train` folder in the next step.
    Please note that these images were cloned to our repository from the public repository
    hosted at [https://github.com/EdjeElectronics/TensorFlow-Object-Detection-API-Tutorial-Train-Multiple-Objects-Windows-10](https://github.com/EdjeElectronics/TensorFlow-Object-Detection-API-Tutorial-Train-Multiple-Objects-Windows-10).'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往您一直在使用的本书克隆仓库的`chapter 10`文件夹。您将看到`images`文件夹，其中包含两个子文件夹：`train`和`test`。在下一步中，您将使用`train`文件夹中的图像。请注意，这些图像是从托管在[https://github.com/EdjeElectronics/TensorFlow-Object-Detection-API-Tutorial-Train-Multiple-Objects-Windows-10](https://github.com/EdjeElectronics/TensorFlow-Object-Detection-API-Tutorial-Train-Multiple-Objects-Windows-10)的公共仓库中克隆到我们的仓库中的。
- en: 'Navigate to the Azure ML workspace and select **Data Labeling** from the left
    menu bar and then click **Add project**, as shown in *Figure 10**.4*:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 Azure ML 工作区，从左侧菜单栏中选择**数据标注**，然后点击**添加项目**，如图*图 10.4*所示：
- en: '![Figure 10.4 – Creating a new Data Labeling project](img/B18003_10_004.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.4 – 创建新的数据标注项目](img/B18003_10_004.jpg)'
- en: Figure 10.4 – Creating a new Data Labeling project
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.4 – 创建新的数据标注项目
- en: 'Go ahead and give your project a name, then select **Image** for **Media type**
    and **Object Identification (Bounding Box)** for **Labeling task type**, and click
    **Next**, as shown in *Figure 10**.5*:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 继续为您的项目命名，然后选择**媒体类型**为**图像**，选择**标注任务类型**为**对象识别（边界框**），并点击**下一步**，如图*图 10.5*所示：
- en: '![Figure 10.5 – Filling out the project details](img/B18003_10_005.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.5 – 填写项目详情](img/B18003_10_005.jpg)'
- en: Figure 10.5 – Filling out the project details
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.5 – 填写项目详情
- en: 'You can skip the next step and go to **Select or create data** and click **Create**
    to create your dataset. Pick a name and type in a description for your image data
    asset and then click **Next**, as shown in *Figure 10**.6*:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以跳过下一步，直接转到**选择或创建数据**并点击**创建**来创建您的数据集。选择一个名称，并为您的图像数据资产输入描述，然后点击**下一步**，如图*图
    10.6*所示：
- en: '![Figure 10.6 – Creating an image data asset](img/B18003_10_006.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.6 – 创建图像数据资产](img/B18003_10_006.jpg)'
- en: Figure 10.6 – Creating an image data asset
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.6 – 创建图像数据资产
- en: 'Select **From local files**, as shown in *Figure 10**.7*:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**从本地文件**，如图*图 10.7*所示：
- en: '![Figure 10.7 – Selecting the image data source](img/B18003_10_007.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.7 – 选择图像数据源](img/B18003_10_007.jpg)'
- en: Figure 10.7 – Selecting the image data source
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.7 – 选择图像数据源
- en: 'Select a datastore for uploading your images, as shown in *Figure 10**.8*:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择用于上传图像的数据存储，如图*图 10.8*所示：
- en: '![Figure 10.8 – Selecting the storage type and the datastore for your images](img/B18003_10_008.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.8 – 选择图像的存储类型和数据存储](img/B18003_10_008.jpg)'
- en: Figure 10.8 – Selecting the storage type and the datastore for your images
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.8 – 选择你的图像的存储类型和数据存储
- en: 'Click `train` folder from *step 1*, select all the images as shown in *Figure
    10**.9*, and click **Next**:'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从*步骤1*的`train`文件夹中点击，选择如图*图10.9*所示的全部图像，然后点击**下一步**：
- en: '![Figure 10.9 – Uploading image files from your local drive](img/B18003_10_009.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图10.9 – 从你的本地驱动器上传图像文件](img/B18003_10_009.jpg)'
- en: Figure 10.9 – Uploading image files from your local drive
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.9 – 从你的本地驱动器上传图像文件
- en: Review the details for your image data asset and click **Create**.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审查你的图像数据资产详情，并点击**创建**。
- en: 'In this step, you need to add labels for each object found in the images, which
    in this case will be `Two`, `Three`, `Four`, and so on up to `Ten`, as well as
    `Soldier`, `Queen`, and `King`, as shown in *Figure 10**.10*. Then click **Next**:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此步骤中，你需要为图像中找到的每个对象添加标签，在这个例子中将是`Two`、`Three`、`Four`等，直到`Ten`，以及`Soldier`、`Queen`和`King`，如图*图10.10*所示。然后点击**下一步**：
- en: '![Figure 10.10 – Adding labels for the objects in all images](img/B18003_10_010.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![图10.10 – 为所有图像中的对象添加标签](img/B18003_10_010.jpg)'
- en: Figure 10.10 – Adding labels for the objects in all images
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.10 – 为所有图像中的对象添加标签
- en: You can skip **Labeling instructions (optional)** and go to **ML assisted labeling
    (optional)**. Make sure **ML assisted labeling (optional)** is enabled, as shown
    in *Figure 10**.11*, and then click **Create project**:![Figure 10.11 – Reviewing
    and creating the data labeling project](img/B18003_10_011.jpg)
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以跳过**标注说明（可选）**，转到**ML辅助标注（可选）**。确保**ML辅助标注（可选）**被启用，如图*图10.11*所示，然后点击**创建项目**：![图10.11
    – 审查和创建数据标注项目](img/B18003_10_011.jpg)
- en: Figure 10.11 – Reviewing and creating the data labeling project
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.11 – 审查和创建数据标注项目
- en: 'Click on the project you just created from the project list, as shown in *Figure
    10**.12*:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击项目列表中你刚刚创建的项目，如图*图10.12*所示：
- en: '![Figure 10.12 – Data labeling project list](img/B18003_10_012.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图10.12 – 数据标注项目列表](img/B18003_10_012.jpg)'
- en: Figure 10.12 – Data labeling project list
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.12 – 数据标注项目列表
- en: 'You can see the dashboard with the different options that the **Data Labeling**
    feature gives you to assist with the labeling process. Go ahead and click on **Label
    data** near the top, as shown in *Figure 10**.13*:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以看到仪表板，它提供了**数据标注**功能的不同选项，以协助标注过程。继续点击顶部附近的**标注数据**，如图*图10.13*所示：
- en: '![Figure 10.13 – Data labeling dashboard](img/B18003_10_013.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![图10.13 – 数据标注仪表板](img/B18003_10_013.jpg)'
- en: Figure 10.13 – Data labeling dashboard
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.13 – 数据标注仪表板
- en: 'In this step, you will start labeling the images by drawing bounding boxes
    around objects found in the images and assigning labels associated with them,
    as shown in *Figure 10**.14*:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此步骤中，你将通过在图像中找到的对象周围绘制边界框并分配相关标签来开始标注图像，如图*图10.14*所示：
- en: '![Figure 10.14 – Drawing bounding boxes around the objects and assigning them
    labels](img/B18003_10_014.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![图10.14 – 在对象周围绘制边界框并分配标签](img/B18003_10_014.jpg)'
- en: Figure 10.14 – Drawing bounding boxes around the objects and assigning them
    labels
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.14 – 在对象周围绘制边界框并分配标签
- en: 'Once enough images have been labeled, ML-assisted labeling will start, and
    you will see that the next images are pre-labeled for you to quickly review the
    bounding boxes around the objects and their labels. After you are done labeling
    all the images, you will see the summary of your labeled data, such as **Label
    class distribution** and so on, as shown in *Figure 10**.15*:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦足够多的图像被标注，ML辅助标注将开始，你将看到下一批图像已经为你预标注，以便你快速审查围绕对象的边界框及其标签。在你完成所有图像的标注后，你将看到你标注数据的摘要，例如**标签类别分布**等，如图*图10.15*所示：
- en: '![Figure 10.15 – Label class distribution](img/B18003_10_015.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图10.15 – 标签类别分布](img/B18003_10_015.jpg)'
- en: Figure 10.15 – Label class distribution
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.15 – 标签类别分布
- en: 'Next, click **Export** and select **Labeled** for **Asset type** and **Azure
    ML dataset** for **Export format**, as shown in *Figure 10**.16*:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击**导出**，对于**资产类型**选择**标注**，对于**导出格式**选择**Azure ML数据集**，如图*图10.16*所示：
- en: '![Figure 10.16 – Exporting your label image data](img/B18003_10_016.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图10.16 – 导出你的标签图像数据](img/B18003_10_016.jpg)'
- en: Figure 10.16 – Exporting your label image data
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.16 – 导出你的标签图像数据
- en: 'You should see a message indicating that your data was exported successfully,
    as shown in *Figure 10**.17*:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你应该会看到一个消息，表明你的数据已成功导出，如图*图10.17*所示：
- en: '![Figure 10.17 – Labeled data exported successfully](img/B18003_10_017.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![图10.17 – 标注数据成功导出](img/B18003_10_017.jpg)'
- en: Figure 10.17 – Labeled data exported successfully
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.17 – 标记数据成功导出
- en: In this section, you learned how to leverage Azure ML-assisted labeling to accelerate
    the labeling of your images for training an object detection model, which we will
    train in the next section.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您学习了如何利用 Azure ML 辅助标记来加速您图像的标记，以便为训练对象检测模型做准备，我们将在下一节中进行训练。
- en: Training an object detection model using Azure AutoML
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure AutoML 训练对象检测模型
- en: 'In this section, we will show you how to use Azure **Automated Machine Learning**
    (**AutoML**) to train an object detection model by following these steps:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将向您展示如何通过以下步骤使用 Azure **Automated Machine Learning** (**AutoML**) 训练一个对象检测模型：
- en: Click on **Automated ML** from the left navigation bar and then click **New
    Automated** **ML job**.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧导航栏中点击 **Automated ML**，然后点击 **新建 Automated** **ML 作业**。
- en: '![Figure 10.18 – Creating a new Automated ML job](img/B18003_10_018.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.18 – 创建新的 Automated ML 作业](img/B18003_10_018.jpg)'
- en: Figure 10.18 – Creating a new Automated ML job
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.18 – 创建新的 Automated ML 作业
- en: Select the image data asset that you created in the last section and click **Next**.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您在上一个部分中创建的图像数据资产，然后点击 **下一步**。
- en: 'In this step, you will configure the training job, as shown in *Figure 10**.19*.
    The first thing to notice is that AutoML has automatically set the task type to
    `playing_cards_experiment`. For **Target column**, select **label (List)**, and
    for the compute type, select **Compute cluster**. Since you do not have a GPU
    cluster (which is needed for deep learning tasks such as object detection), you
    will need to create one by selecting **+ New** and following the steps in the
    cluster creation wizard. Once your GPU compute cluster is created, it can be selected,
    and then you can click **Next**:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此步骤中，您将配置训练作业，如图 *图 10*.19* 所示。首先要注意的是，AutoML 已经自动将任务类型设置为 `playing_cards_experiment`。对于
    **目标列**，选择 **label (List**)，对于计算类型，选择 **Compute cluster**。由于您没有 GPU 集群（这是进行对象检测等深度学习任务所需的），您需要通过选择
    **+ 新建** 并遵循集群创建向导中的步骤来创建一个。一旦您的 GPU 计算集群创建完成，就可以选择它，然后您可以点击 **下一步**：
- en: '![Figure 10.19 – Configuring the object detection job](img/B18003_10_019.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.19 – 配置对象检测作业](img/B18003_10_019.jpg)'
- en: Figure 10.19 – Configuring the object detection job
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.19 – 配置对象检测作业
- en: 'You can leave the default values that are selected for the algorithm details
    and the hyperparameter tuning settings, as shown in *Figure 10**.20*, and then
    click **Next**:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以保留算法细节和超参数调整设置中默认选中的值，如图 *图 10*.20* 所示，然后点击 **下一步**：
- en: '![Figure 10.20 – Selecting the model and configuring the hyperparameter tuning](img/B18003_10_020.jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.20 – 选择模型和配置超参数调整](img/B18003_10_020.jpg)'
- en: Figure 10.20 – Selecting the model and configuring the hyperparameter tuning
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.20 – 选择模型和配置超参数调整
- en: 'In this final step, you will set your validation type. We will again keep the
    default selected value, which is **Auto**, as shown in *Figure 10**.21*. Then,
    click **Finish** to start the model training:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此最后步骤中，您将设置您的验证类型。我们将再次保留默认选中的值，即 **Auto**，如图 *图 10*.21* 所示。然后，点击 **完成** 以开始模型训练：
- en: '![Figure 10.21 – Selecting the validation type](img/B18003_10_021.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.21 – 选择验证类型](img/B18003_10_021.jpg)'
- en: Figure 10.21 – Selecting the validation type
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.21 – 选择验证类型
- en: 'Depending on the size of your dataset, it can take anywhere between 15 minutes
    to a couple of hours for the model training to complete. Once the training job
    is completed, you can see it under **Recent Automated ML jobs**, as shown in *Figure
    10**.22*:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据您的数据集大小，模型训练完成可能需要 15 分钟到几个小时不等。一旦训练作业完成，您可以在 **最近完成的 Automated ML 作业** 下看到它，如图
    *图 10*.22* 所示：
- en: '![Figure 10.22 – Automated ML jobs](img/B18003_10_022.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.22 – Automated ML 作业](img/B18003_10_022.jpg)'
- en: Figure 10.22 – Automated ML jobs
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.22 – Automated ML 作业
- en: 'Select your latest run to see some statistics, such as **Best model summary**,
    **Primary metric**, **Algorithm name**, and **Duration**, as shown in *Figure
    10**.23*:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您最新的运行实例以查看一些统计信息，例如**最佳模型摘要**、**主要指标**、**算法名称**和**持续时间**，如图 *图 10*.23* 所示：
- en: '![Figure 10.23 – Completed Automated ML job](img/B18003_10_023.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.23 – 完成的 Automated ML 作业](img/B18003_10_023.jpg)'
- en: Figure 10.23 – Completed Automated ML job
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.23 – 完成的 Automated ML 作业
- en: In this section, you learned how to leverage Azure AutoML to train an object
    detection model using the image data that you had labeled by leveraging another
    tool called **Data Labeling**. In the next section, you will learn how to deploy
    the trained model to a managed online endpoint for consumption by client applications.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您学习了如何利用 Azure AutoML 通过使用另一个名为 **Data Labeling** 的工具标记的图像数据来训练对象检测模型。在下一节中，您将学习如何将训练好的模型部署到托管在线端点，以便客户端应用程序使用。
- en: Deploying the object detection model to an online endpoint using the Azure ML
    Python SDK
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure ML Python SDK 将对象检测模型部署到在线端点
- en: Just like any other ML model, a deep learning model is not useful unless it
    is deployed and consumers can send data for inference. In our case, it would be
    sending image data and getting results back containing object types and locations
    within the raw image.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 就像任何其他机器学习模型一样，深度学习模型除非部署并且消费者可以发送数据进行推理，否则是没有用的。在我们的情况下，这将是通过发送图像数据并获取包含原始图像中对象类型和位置的返回结果来实现。
- en: 'In this section, we will show you how to use the Azure ML Python SDK to register
    your previously trained model and deploy it to an online endpoint for real-time
    inference by following these steps:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将向您展示如何使用 Azure ML Python SDK 按照以下步骤注册您之前训练的模型并将其部署到在线端点，以便进行实时推理：
- en: Open the `chapter 10` notebook, which is inside the repository that you cloned
    by following the steps in the *Technical requirements* section of the chapter.
    Please note that our repository for this chapter uses most of the code from the
    original repository hosted at `https://github.com/Azure/azureml-examples`.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 `第 10 章` 笔记本，该笔记本位于您按照章节中 *技术要求* 部分的步骤克隆的存储库中。请注意，本章节的存储库使用了大部分来自 `https://github.com/Azure/azureml-examples`
    原始存储库的代码。
- en: 'The first couple of cells import the required libraries and connect your notebook
    to the Azure ML workspace, as shown in *Figure 10**.24*:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前几个单元格导入所需的库并将您的笔记本连接到 Azure ML 工作区，如图 *图 10*.24* 所示：
- en: '![Figure 10.24 – Importing the required libraries and connecting to the Azure
    ML workspace](img/B18003_10_024.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.24 – 导入所需库并连接到 Azure ML 工作区](img/B18003_10_024.jpg)'
- en: Figure 10.24 – Importing the required libraries and connecting to the Azure
    ML workspace
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.24 – 导入所需库并连接到 Azure ML 工作区
- en: 'You are going to use the MLflow library (in particular, the MLflow client)
    to access the models and other artifacts generated by AutoML. The next couple
    of cells show how to install the latest version of the MLflow packages, how to
    obtain the URI for the MLflow tracking server, and how to initialize the MLflow
    client, as shown in *Figure 10**.25*:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将使用 MLflow 库（特别是 MLflow 客户端）来访问 AutoML 生成的模型和其他工件。接下来的几个单元格展示了如何安装 MLflow 包的最新版本，如何获取
    MLflow 跟踪服务器的 URI，以及如何初始化 MLflow 客户端，如图 *图 10*.25* 所示：
- en: '![Figure 10.25 – Setting up the MLflow client to access the AutoML-trained
    model](img/B18003_10_025.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.25 – 设置 MLflow 客户端以访问 AutoML 训练的模型](img/B18003_10_025.jpg)'
- en: Figure 10.25 – Setting up the MLflow client to access the AutoML-trained model
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.25 – 设置 MLflow 客户端以访问 AutoML 训练的模型
- en: 'Go to the Azure ML workspace and click on the `AutoML_ada7f120-62e2-46fd-8ef7-59cae1106262`,
    as shown in *Figure 10**.26*. We will use the job name in the next step:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往 Azure ML 工作区，并点击 `AutoML_ada7f120-62e2-46fd-8ef7-59cae1106262`，如图 *图 10*.26*
    所示。在下一步中，我们将使用作业名称：
- en: '![Figure 10.26 – Getting the AutoML job name](img/B18003_10_026.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.26 – 获取 AutoML 作业名称](img/B18003_10_026.jpg)'
- en: Figure 10.26 – Getting the AutoML job name
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.26 – 获取 AutoML 作业名称
- en: 'Now that we have the AutoML job name, we can get the AutoML best model ID,
    as shown in *Figure 10**.27*. This will be used in a later step to retrieve the
    actual trained model:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们已经获得了 AutoML 作业名称，我们可以获取 AutoML 最佳模型 ID，如图 *图 10*.27* 所示。这将在后续步骤中用于检索实际训练的模型：
- en: '![Figure 10.27 – Getting the AutoML best model ID](img/B18003_10_027.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.27 – 获取 AutoML 最佳模型 ID](img/B18003_10_027.jpg)'
- en: Figure 10.27 – Getting the AutoML best model ID
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.27 – 获取 AutoML 最佳模型 ID
- en: 'The next cell creates a local folder and downloads the best model and its artifacts
    into this folder, as shown in *Figure 10**.28*:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一个单元格创建一个本地文件夹，并将最佳模型及其工件下载到该文件夹中，如图 *图 10*.28* 所示：
- en: '![Figure 10.28 – Downloading the best model in a local folder](img/B18003_10_028.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![图 10.28 – 在本地文件夹中下载最佳模型](img/B18003_10_028.jpg)'
- en: Figure 10.28 – Downloading the best model in a local folder
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.28 – 在本地文件夹中下载最佳模型
- en: 'The next cell creates a managed online endpoint for the model to be invoked
    from, as shown in *Figure 10**.29*:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一个单元格创建了一个用于调用的托管在线端点，如图*图10.29*所示：
- en: '![Figure 10.29 – Creating an online endpoint for the model to be invoked from](img/B18003_10_029.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![图10.29 – 为从其调用模型创建在线端点](img/B18003_10_029.jpg)'
- en: Figure 10.29 – Creating an online endpoint for the model to be invoked from
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.29 – 为从其调用模型创建在线端点
- en: 'The next cell registers the model to the workspace, as shown in *Figure 10**.30*:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一个单元格将模型注册到工作区，如图*图10.30*所示：
- en: '![Figure 10.30 – Registering the best model to the Azure ML workspace](img/B18003_10_030.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![图10.30 – 将最佳模型注册到Azure ML工作区](img/B18003_10_030.jpg)'
- en: Figure 10.30 – Registering the best model to the Azure ML workspace
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.30 – 将最佳模型注册到Azure ML工作区
- en: 'The next cell creates a deployment, which contains settings such as an ID for
    the model to be deployed, the compute cluster type, the number of cluster nodes,
    and the name of the endpoint that was created a couple of steps ago, as shown
    in *Figure 10**.31*:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一个单元格创建了一个部署，其中包含要部署的模型的ID、计算集群类型、集群节点数量以及之前创建的端点名称，如图*图10.31*所示：
- en: '![Figure 10.31 – Registering the best model to the Azure ML workspace](img/B18003_10_031.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![图10.31 – 将最佳模型注册到Azure ML工作区](img/B18003_10_031.jpg)'
- en: Figure 10.31 – Registering the best model to the Azure ML workspace
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.31 – 将最佳模型注册到Azure ML工作区
- en: 'The next couple of cells show you how to invoke the endpoint and pass a test
    image to the model for inference, as shown in *Figure 10**.32*:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来的几个单元格将向您展示如何调用端点并将测试图像传递给模型进行推理，如图*图10.32*所示：
- en: '![Figure 10.32 – Sending a test image to the model for inference](img/B18003_10_032.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![图10.32 – 向模型发送测试图像进行推理](img/B18003_10_032.jpg)'
- en: Figure 10.32 – Sending a test image to the model for inference
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.32 – 向模型发送测试图像进行推理
- en: 'Finally, let’s see how well the model scored the test image (which is how well
    it was able to find an object, identify its type, and find its location within
    the image). *Figure 10**.33* shows the Python code to help you to visualize the
    model output that was returned by the endpoint:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们看看模型对测试图像的评分如何（这是指它能够找到对象、识别其类型以及在图像中找到其位置的能力）。*图10.33*显示了帮助您可视化端点返回的模型输出的Python代码：
- en: '![Figure 10.33 – Python code to visualize the model output](img/B18003_10_033.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![图10.33 – 可视化模型输出的Python代码](img/B18003_10_033.jpg)'
- en: Figure 10.33 – Python code to visualize the model output
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.33 – 可视化模型输出的Python代码
- en: '*Figure 10**.34* shows the model output with a bounding box around the identified
    object:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*图10.34*显示了带有识别对象周围边界框的模型输出：'
- en: '![Figure 10.34 – Model output showing the bounding box around the identified
    object](img/B18003_10_034.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![图10.34 – 显示识别对象周围边界框的模型输出](img/B18003_10_034.jpg)'
- en: Figure 10.34 – Model output showing the bounding box around the identified object
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.34 – 显示识别对象周围边界框的模型输出
- en: Let’s summarize the chapter next.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们总结本章内容。
- en: Summary
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we covered a quick introduction to deep learning and the importance
    of having a lot of labeled data for the model to perform well. We then showed
    you how to use the Azure ML Data Labeling capability to assist with labeling image
    data to train an object detection model. We then showed you how to use AutoML
    to train an object detection model, and finally, you learned how to deploy your
    model to an online endpoint and score a test image, all using Azure ML.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们简要介绍了深度学习以及拥有大量标记数据对模型表现的重要性。然后，我们向您展示了如何使用Azure ML数据标注功能来辅助标注图像数据以训练目标检测模型。接着，我们向您展示了如何使用AutoML训练目标检测模型，最后，您学习了如何使用Azure
    ML将模型部署到在线端点并评分测试图像。
- en: In the next chapter, we will show you how to do distributed model training in
    Azure ML.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将向您展示如何在Azure ML中执行分布式模型训练。
