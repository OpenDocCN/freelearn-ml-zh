- en: Data Cleansing and Preliminary Data Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据清洗和初步数据分析
- en: After acquiring the right data, the most difficult and time-consuming task is
    getting it ready for analysis. Understanding what can and cannot be done with
    a given dataset is the first step before any model can be used. This chapter demonstrates
    how to use Excel functions to search and replace patterns, and how to find wrong
    data types and missing data. It also contains some useful diagrams so that we
    can get insights from the data and understand the different variables.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在获取到正确数据后，最困难且耗时的工作是将其准备好进行分析。在可以使用任何模型之前，了解给定数据集可以做什么和不能做什么是第一步。本章演示了如何使用Excel函数搜索和替换模式，以及如何找到错误的数据类型和缺失数据。它还包含一些有用的图表，以便我们可以从数据中获得洞察力并理解不同的变量。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Cleansing data
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据清洗
- en: Visualizing data for preliminary analysis
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化数据以进行初步分析
- en: Understanding unbalanced datasets
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解不平衡数据集
- en: Technical requirements
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will need to download the `titanic.xls` file from the GitHub repository
    at [https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter04](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter04).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要从GitHub仓库[https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter04](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter04)下载`titanic.xls`文件。
- en: Cleansing data
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据清洗
- en: Data is never clean – it always contains missing values, errors, incorrect formats,
    and other problems that make it impossible to feed to a machine learning model
    without preprocessing. This is what data cleansing is all about – correcting all
    these problems before starting the real analysis.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 数据永远不会干净——它总是包含缺失值、错误、不正确的格式和其他问题，这些问题使得在没有预处理的情况下无法将其提供给机器学习模型。这就是数据清洗的全部内容——在开始真正的分析之前纠正所有这些问题。
- en: As an example of how to clean a dataset, we will use the Titanic passengers
    dataset. We will repeat the procedure described in the *Importing data from another
    Excel workbook* section of the previous chapter, to import data from an Excel
    workbook. We will use real data from the Titanic passengers and demonstrate how
    you can prepare it for analysis.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 作为如何清洗数据集的示例，我们将使用泰坦尼克号乘客数据集。我们将重复上一章中“从另一个Excel工作簿导入数据”部分所描述的程序，以从Excel工作簿中导入数据。我们将使用泰坦尼克号乘客的实时数据，并演示如何为分析准备它。
- en: 'To clean a dataset, perform the necessary steps, as follows:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要清洗数据集，执行以下必要步骤：
- en: 'Navigate to Data | From File | From Workbook, as shown in the following screenshot:'
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到数据 | 从文件 | 从工作簿，如下面的截图所示：
- en: '![](img/44011b03-34b4-4aaa-9bc8-ef221b664b59.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/44011b03-34b4-4aaa-9bc8-ef221b664b59.png)'
- en: 'After selecting the `titanic.xlsx` file and the `Passenger data` worksheet,
    we get a preview of the file''s contents, as shown in the following screenshot:'
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在选择`titanic.xlsx`文件和`Passenger data`工作表后，我们预览了文件的内容，如下面的截图所示：
- en: '![](img/561f7e44-7d61-4c23-b997-0e749b8e6281.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/561f7e44-7d61-4c23-b997-0e749b8e6281.png)'
- en: Click on Edit and start the data cleansing process. The first thing we notice
    is that we don't need the column containing the passenger names; it gives no useful
    information to our analysis. In fact, in most cases, we will be required to remove
    personal information from our data, due to privacy policies.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“编辑”并开始数据清洗过程。我们首先注意到我们不需要包含乘客姓名的列；它对我们的分析没有提供任何有用的信息。实际上，在大多数情况下，我们会被要求从我们的数据中删除个人信息，这是由于隐私政策的要求。
- en: Select the `name` column.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`name`列。
- en: 'Click on Remove Columns*;* the resulting table will look as follows:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“移除列*；*”后的表格将如下所示：
- en: '![](img/98090ad2-7a35-405c-b00a-6eb91851614d.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/98090ad2-7a35-405c-b00a-6eb91851614d.png)'
- en: 'Replace all `nulls` in the `cabin` column with `unknown`:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`cabin`列中的所有`nulls`替换为`unknown`：
- en: '![](img/d851c474-8819-4bd8-8f62-3195c2e1dc10.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/d851c474-8819-4bd8-8f62-3195c2e1dc10.png)'
- en: 'There are two other columns that contain missing values: `boat` and `body`.
    According to the data dictionary, they tell us which lifeboat the passenger was
    located in (if they survived), and which ID was assigned to their body in the
    case of their death. There are missing values, but there are also some cases where
    we cannot have a value; clearly, a dead passenger did not use a boat and a surviving
    passenger body was not identified. We will use some functions to account for these
    options.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 还有两列包含缺失值：`boat` 和 `body`。根据数据字典，它们告诉我们乘客所在的救生艇（如果他们幸存），以及他们死亡时分配给其身体的ID。存在缺失值，但也有一些情况下我们无法获得值；显然，已故乘客没有使用救生艇，幸存者的身体ID未识别。我们将使用一些函数来处理这些选项。
- en: In Query Editor, select the Add Column tab.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在查询编辑器中，选择“添加列”选项卡。
- en: Select Custom Column.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择自定义列。
- en: The dialog shows us an option to name the new column and define its contents.
    Type `boat_corrected` into the textbox.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对话框显示我们可以命名新列并定义其内容。在文本框中输入 `boat_corrected`。
- en: 'Define a function to calculate the column''s contents, as follows:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个函数来计算列的内容，如下所示：
- en: '*if [survived]=1 and [boat] = null then "unknown" else [boat]*'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '*if [survived]=1 and [boat] = null then "unknown" else [boat]*'
- en: 'This means that if the passenger survived and the boat name is missing, we
    set the value to `unknown`. Otherwise, we just copy the value into the original
    column, as demonstrated in the following screenshot:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着如果乘客幸存且船名缺失，我们将值设置为 `unknown`。否则，我们只需将值复制到原始列中，如下面的截图所示：
- en: '![](img/167f4f10-59b8-4ac3-adea-d581269e580d.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/167f4f10-59b8-4ac3-adea-d581269e580d.png)'
- en: 'Add another new column in order to correct the values in `body` and define
    a different value for the column:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加另一个新列，以纠正 `body` 中的值，并为该列定义不同的值：
- en: '*if [survived]=0 and [body] = null then "not recovered" else [body]*'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '*if [survived]=0 and [body] = null then "not recovered" else [body]*'
- en: In this case, we want to say that if the passenger did not survive the shipwreck
    and there is no body ID, then it was probably not recovered from the water.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们想说的是，如果乘客在船难中没有幸存，并且没有身体ID，那么他们可能没有被从水中打捞上来。
- en: 'The result, after reordering the columns, is as follows:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 重新排序列后的结果是以下内容：
- en: '![](img/1637fc80-aa94-41ce-a8ca-184338163e9e.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1637fc80-aa94-41ce-a8ca-184338163e9e.png)'
- en: 'There are still `null` values in the new columns; they correspond to the preceding
    cases (that is, the dead passenger with no boat, or the survivor with no body
    ID). Replace these values with `N/A`; the resulting table is shown in the following
    screenshot:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 新列中仍有 `null` 值；它们对应于前面的情况（即没有救生艇的已故乘客，或没有身体ID的幸存者）。将这些值替换为 `N/A`；结果表格如下所示：
- en: '![](img/266a83c3-bffb-4ff6-a8e7-526de7031b0d.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/266a83c3-bffb-4ff6-a8e7-526de7031b0d.png)'
- en: The last column to be modified is `age`. We are going to simplify this by grouping
    the passengers into age range and replace the missing values.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 最后要修改的列是 `age`。我们将通过将乘客分组到年龄范围来简化这一点，并用缺失值替换。
- en: Replace all the missing values (`null`) with `-1`. We can do this easily by
    selecting the column and clicking on Replace Values.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有缺失值（`null`）替换为 `-1`。我们可以通过选择列并点击“替换值”来完成此操作。
- en: Navigate to the Add Column tab.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“添加列”选项卡。
- en: 'Click on Conditional Column and define several groups, depending on the age
    range, as demonstrated in the following screenshot:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“条件列”并定义几个组，具体取决于年龄范围，如下面的截图所示：
- en: '![](img/62e9901e-5a60-40f5-b3b3-fb61bac13468.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/62e9901e-5a60-40f5-b3b3-fb61bac13468.png)'
- en: 'The result is a new column (`Age group`) that contains the different age groups
    instead of the age value and replaces the `null` values with `unknown`. The resulting
    table is as follows:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个新的列（`Age group`），它包含不同的年龄组而不是年龄值，并用 `unknown` 替换 `null` 值。结果表格如下：
- en: '![](img/e68cd6d2-bd76-456b-8f5c-6e1a978c7dee.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/e68cd6d2-bd76-456b-8f5c-6e1a978c7dee.png)'
- en: Our dataset is now clean and ready for some preliminary analysis, which we will
    show in the next section.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集现在已清理完毕，准备进行一些初步分析，我们将在下一节中展示。
- en: Visualizing data for preliminary analysis
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可视化数据以进行初步分析
- en: After cleaning the dataset, it is always recommended to visualize it. This helps
    us gain an understanding of the different variables, how their values are distributed,
    and the correlations that exist between them (we will explore correlations in
    more detail in the next chapter). We can determine which variables are important
    to our analyses, which ones give us more information, and which ones can be discarded
    for being redundant.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在清理数据集之后，总是建议对其进行可视化。这有助于我们了解不同的变量，它们值的分布情况以及它们之间的相关性（我们将在下一章中更详细地探讨相关性）。我们可以确定哪些变量对我们的分析很重要，哪些变量提供了更多信息，以及哪些变量因为冗余可以被舍弃。
- en: 'We will start by looking a several bar plots, where we will either count the
    number of occurrences of each value (using a histogram), or we will show the percentage
    of each value with respect to the total (using a bar plot). To achieve this, perform
    the following steps:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先查看几个条形图，我们将要么计数每个值的出现次数（使用直方图），要么显示每个值相对于总数的百分比（使用条形图）。为了实现这一点，请执行以下步骤：
- en: 'Right-click on any cell within the table to access the Quick Analysis option:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在表格中的任何单元格上右键单击以访问快速分析选项：
- en: '![](img/2734cb57-0024-4c90-a871-5c108cf017ae.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/2734cb57-0024-4c90-a871-5c108cf017ae.png)'
- en: 'In the pop-up window, we can choose the chart type. Select Clustered Column,
    as shown in the following screenshot:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在弹出窗口中，我们可以选择图表类型。选择簇状柱形图，如图所示：
- en: '![](img/a7420df0-40ff-4eea-bb36-15732c1c7e96.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a7420df0-40ff-4eea-bb36-15732c1c7e96.png)'
- en: By default, Excel creates a pivot table showing some variables; we need to change
    the variables and the grouping operation to reflect what we need.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Excel创建了一个显示一些变量的数据透视表；我们需要更改变量和分组操作，以反映我们的需求。
- en: 'In the lower-right corner, we will see a window labeled Σ. Inside it, we can
    click on the variable and display the menu, as shown in the following screenshot:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在右下角，我们将看到一个标记为Σ的窗口。在里面，我们可以点击变量并显示菜单，如图所示：
- en: '![](img/a9b2eae9-63ad-4c83-92a8-db4b401c6416.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a9b2eae9-63ad-4c83-92a8-db4b401c6416.png)'
- en: 'Click on Value Field Settings; you will see a pop-up window, similar to the
    one in the following screenshot, where you can change from Sum to Count, since
    we want to Count the values, and then calculate the Sum of them:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击值字段设置；您将看到一个弹出窗口，类似于以下截图，您可以在其中将总和更改为计数，因为我们想计数值，然后计算它们的总和：
- en: '![](img/b523e8a3-3b04-455c-8413-c771a9db2856.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/b523e8a3-3b04-455c-8413-c771a9db2856.png)'
- en: We converted the `Age` variable into `Age group`, so that is the variable that
    we now want to use. That is, we want to count how many passengers there are in
    a given age group.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将`Age`变量转换为`Age group`，因此这是我们现在想要使用的变量。也就是说，我们想要计算给定年龄组中有多少乘客。
- en: Change the selection in PivotChart Fields to `Age group`.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据透视表字段的选择更改为`Age group`。
- en: 'Now, change the chart title and move it so that it looks similar to the following
    screenshot:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，更改图表标题并移动它，使其看起来类似于以下截图：
- en: '![](img/1a6d080d-636b-4e98-8c36-fa6d790bb6ed.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1a6d080d-636b-4e98-8c36-fa6d790bb6ed.png)'
- en: We can see that most of the listed passengers are adults. We have missing information
    for many of the passengers in the list, and the rest of the groups share a small
    number of passengers. The table that is used in the chart can be seen in the top-left
    corner.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，列表中的大多数乘客都是成年人。我们对列表中的许多乘客有缺失信息，其余的群体共享少量乘客。图表中使用的表格可以在左上角看到。
- en: 'An interesting question to ask is, *Is there any difference in the survival
    probability for different age groups?* To answer this, we need to add the `survived`
    variable to the Axis (Categories) window, which is available at the bottom right-hand
    corner of the sheet. We do this by dragging the variable from the PivotCharts
    Fields window and dropping it into Axis. The resulting chart is as follows:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有趣的问题是要问，*不同年龄组的生存概率是否有差异？* 为了回答这个问题，我们需要将`survived`变量添加到轴（类别）窗口中，该窗口位于工作表的右下角。我们通过从数据透视表字段窗口拖动变量并将其放入轴来实现这一点。生成的图表如下：
- en: '![](img/c3fbc1b6-58d2-41ac-98a4-626b6f85f3c3.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/c3fbc1b6-58d2-41ac-98a4-626b6f85f3c3.png)'
- en: 'There''s a notable problem with this chart – we cannot easily compare the age
    groups since their members are very different in number. The solution is to refer
    everything to the total number of passengers in each age group and show percentages
    instead. Looking at the previous chart, we can see that the data is grouped first
    by `Age group`, and then by `survived`. The first one is the parent variable.
    Repeat the steps we described previously to navigate to the Value Field Settings
    menu; you will see a pop-up window like the one that''s shown in the following
    screenshot:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这个图表有一个显著的问题——我们无法轻易地比较年龄组，因为它们的成员数量差异很大。解决方案是将所有内容都参照每个年龄组的总乘客数，并显示百分比。查看之前的图表，我们可以看到数据首先按`年龄组`分组，然后按`生还情况`分组。第一个是父变量。重复我们之前描述的步骤，导航到值字段设置菜单；你将看到一个类似于以下截图中的弹出窗口：
- en: '![](img/c4279dc3-3ac7-46b8-ba07-f304b0e10808.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/c4279dc3-3ac7-46b8-ba07-f304b0e10808.png)'
- en: Click on the Show Values As tab, as shown in the preceding screenshot.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击显示值方式标签页，如前述截图所示。
- en: 'Choose the % of Parent Total option and the `Age group` field as the parent;
    the result is shown in the following screenshot:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择父总百分比选项，并将`年龄组`字段作为父变量；结果如下截图所示：
- en: '![](img/29b28933-9525-44da-a880-9b405763e61a.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![图表](img/29b28933-9525-44da-a880-9b405763e61a.png)'
- en: The percentage is relative to the total number of passengers within each age
    group, and it is now easier to compare. A large percentage of the elderly group
    did not survive the shipwreck, most adults suffered the same fate, and the numbers
    for children and teenagers seem even. It is also clear that most infants survived,
    probably because they were given priority to board the lifeboats.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 百分比是相对于每个年龄组内乘客总数的，现在比较起来更容易。老年组的大多数人没有在沉船中幸存，大多数成年人遭遇了同样的命运，儿童和青少年的数字似乎很均匀。很明显，大多数婴儿都幸存了，可能是因为他们在登船时被优先考虑。
- en: 'Repeating the same steps, we can assume that it was more probable for passengers
    travelling in first class to survive compared to other passengers; consider the
    following chart:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 重复相同的步骤，我们可以假设头等舱的乘客比其他乘客更有可能生还；考虑以下图表：
- en: '![](img/092b7049-dbdc-4d2e-8d70-eb83f36d5f0c.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/092b7049-dbdc-4d2e-8d70-eb83f36d5f0c.png)'
- en: Yes, it was easier to survive if you traveled first class than if you were in
    third. This is a known fact about the Titanic tragedy, and we can see it reflected
    in the data. Travel conditions were very different in different classes, as well
    as safety measures.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，如果你是头等舱乘客，比在三等舱更容易生还。这是泰坦尼克号悲剧的一个已知事实，我们可以在数据中看到它的反映。不同舱位的旅行条件以及安全措施都大不相同。
- en: 'Now, what about gender? Does it matter if the passenger was a man or a woman?
    Let''s build a histogram of the number of men and women that survived and use
    it to answer our question. The resulting chart is shown in the following screenshot:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，关于性别呢？乘客是男性还是女性有关系吗？让我们构建一个男性和女性生还人数的直方图，并使用它来回答我们的问题。结果图表如下截图所示：
- en: '![](img/fed2c9b4-1511-406e-82bd-35a0d9d98559.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![图表](img/fed2c9b4-1511-406e-82bd-35a0d9d98559.png)'
- en: As you can see, gender clearly matters. The women survivors have a higher probability
    than men, at least in general terms. The reason for this might be because women
    were given priority to board the lifeboats, while the men, especially the young
    ones, were delayed in order to help other passengers, and so they couldn't make
    it to the lifeboats in time.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，性别显然很重要。女性生还者的概率比男性高，至少在一般意义上是这样。这其中的原因可能是因为女性在登船时被优先考虑，而男性，尤其是年轻人，被延迟以帮助其他乘客，因此他们没有及时到达救生艇。
- en: We have used a combination of the previous knowledge of our dataset and information
    from the data to better understand what we can and cannot do with it. You are
    encouraged to create diagrams for other variables and combinations, and try to
    understand the results. It is extremely important to understand the basic details
    of a dataset in order to understand whether the result we obtain from the machine
    learning models make sense.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们结合了我们对数据集的先前知识和数据信息，以更好地理解我们可以和不能做什么。我们鼓励你为其他变量和组合创建图表，并尝试理解结果。为了理解我们从机器学习模型中获得的结果是否合理，理解数据集的基本细节至关重要。
- en: Understanding unbalanced datasets
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解不平衡数据集
- en: 'To be able to compare the results of different variables, we need to take into
    account the different number of samples of each class. Let''s suppose that we
    want to train a machine learning model to predict whether a given passenger would
    survive, based on age group, gender, and class. If we plot the distribution of
    values in the `survived` variable, we will see the following:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 为了能够比较不同变量的结果，我们需要考虑每个类别的样本数量不同。假设我们想要训练一个机器学习模型来预测给定乘客是否会幸存，基于年龄组、性别和舱位。如果我们绘制`survived`变量值的分布，我们会看到以下情况：
- en: '![](img/2cc73f59-c193-47c3-a681-124cb8a95598.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/2cc73f59-c193-47c3-a681-124cb8a95598.png)'
- en: It is clear from the preceding diagram and table that there are nearly twice
    as many non-survivors than survivors. If we use this dataset as is, we are introducing
    a bias to our dataset that will affect the results. Predicting `0` for the survival
    variable will be approximately two times more probable than predicting `1`. An
    exception to this statement are decision trees and their related predictive models
    (such as random forests and XGBoost), which can correctly deal with unbalanced
    datasets. Other models, especially neural networks, are very sensitive to uneven
    datasets. Race, gender, and other biases in algorithms raise concerns about the
    wide use of **Artificial Intelligence** (**AI**) to make decisions at all levels.
    This is a serious problem when applying AI to real life, and possible solutions
    to prevent it are still under study.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的图表和表格中可以清楚地看出，非幸存者的人数几乎是幸存者的两倍。如果我们直接使用这个数据集，我们会在数据集中引入一个偏差，这将影响结果。预测生存变量为`0`的概率将大约是预测为`1`的两倍。这个陈述的例外是决策树及其相关的预测模型（如随机森林和XGBoost），它们可以正确处理不平衡的数据集。其他模型，尤其是神经网络，对不均匀的数据集非常敏感。算法中的种族、性别和其他偏差引发了关于**人工智能**（**AI**）在所有级别上广泛应用的担忧。当将AI应用于现实生活时，这是一个严重的问题，防止这种情况的可能的解决方案仍在研究中。
- en: 'Given enough data entries, an easy way to balance the dataset is to randomly
    choose a number of entries from the majority class that is equal to that of the
    minority class. In this case, we might choose 500 rows from the rows that show
    `survivor` as `0`. Let''s do that using the following steps:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 给定足够的数据条目，平衡数据集的一个简单方法是从多数类别随机选择与少数类别数量相等的条目。在这种情况下，我们可能从显示`survivor`为`0`的行中选择500行。让我们使用以下步骤来完成：
- en: 'Filter the entries, as shown in the following screenshot:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下截图所示筛选条目：
- en: '![](img/1eba5675-8e45-4da5-b57e-2aff05112f8f.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1eba5675-8e45-4da5-b57e-2aff05112f8f.png)'
- en: Copy the entries and paste them into a new worksheet.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制条目并将它们粘贴到一个新的工作表中。
- en: Insert a new column at the beginning, named `ID`.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在开头插入一个新列，命名为`ID`。
- en: Turn the data into a table (Insert | Table, keeping the first row as headers).
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据转换成表格（插入 | 表格，保留第一行作为标题）。
- en: 'Enter the following formula in the first cell and copy it into the rest of
    the column:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一个单元格中输入以下公式，并将其复制到该列的其余部分：
- en: '*=RAND()*'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '*=RAND()*'
- en: 'Make sure that the automatic calculation is switched off. To do this, navigate
    to Formulas | Calculation Options and check Manual. This will prevent the random
    numbers from changing automatically:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保自动计算已关闭。为此，导航到公式 | 计算选项并勾选手动。这将防止随机数自动更改：
- en: '![](img/65a3b784-6970-467f-8acd-a323c3b0b6c4.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/65a3b784-6970-467f-8acd-a323c3b0b6c4.png)'
- en: Order the data by ID (you can choose ascending or descending order, it does
    not make any difference).
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按ID排序数据（你可以选择升序或降序，这没有关系）。
- en: Select the first 500 rows to be your random sample.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择前500行作为你的随机样本。
- en: Copy these rows to a new sheet.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这些行复制到新工作表中。
- en: Add the 500 rows with `survived` as `1`.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加500行，其中`survived`为`1`。
- en: You have now a perfectly balanced dataset containing 1,000 entries, which you
    can now use to train your machine learning model.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你有一个包含1,000个条目的完美平衡数据集，你可以用它来训练你的机器学习模型。
- en: Summary
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we explored different methods of dealing with missing data
    and learned how to group or summarize it. We have shown you how important it is
    to visualize the data after cleaning, in order to be able to understand and interpret
    the results, from basic to more advanced model predictions. This is the beginning
    of any feature engineering, since we transform and/or discard features based on
    their values. Too many missing values will imply that we cannot use that variable
    (or feature), or a high correlation will imply that we can discard one of the
    correlated variables. We will dive deeper into correlations in the next chapter,
    showing you how to measure them quantitatively, using different methods.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了处理缺失数据的不同方法，并学习了如何对其进行分组或汇总。我们向您展示了在数据清洗后可视化数据的重要性，以便能够理解和解释从基本到更高级模型预测的结果。这是任何特征工程的开端，因为我们根据特征值进行转换和/或丢弃特征。过多的缺失值将意味着我们无法使用该变量（或特征），或者高度相关性将意味着我们可以丢弃相关变量中的一个。我们将在下一章中更深入地探讨相关性，向您展示如何使用不同的方法进行定量测量。
- en: Preliminary data visualization is extremely important to gain an understanding
    of data properties and to interpret the results we obtain, even after applying
    a machine learning model.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 初步数据可视化对于理解数据属性和解释我们获得的结果至关重要，即使在应用机器学习模型之后。
- en: Questions
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Reviewing what was explained in the previous chapter, build a decision tree
    using `class`, `gender`, and `Age group` as features, and `survived` as the target
    variable. You should be able to define some conditions for a passenger to survive.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 回顾上一章所解释的内容，使用`class`（类别）、`gender`（性别）和`Age group`（年龄组）作为特征，`survived`（幸存）作为目标变量，构建一个决策树。你应该能够为乘客生存定义一些条件。
- en: What variables in the dataset do you think are highly correlated?
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你认为数据集中哪些变量高度相关？
- en: Suppose that the dataset contains a numerical variable with only a few missing
    values. Is it possible to replace these missing values with numerical values?
    What value would you use?
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设数据集包含一个只有少数缺失值的数值变量。是否可以用数值替换这些缺失值？你会使用什么值？
- en: Explain what bias means and why it is important to avoid it.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解释偏差的含义以及为什么需要避免它。
- en: What other types of diagrams could be use for preliminary data analysis? Try
    some of them in the given dataset.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 还有哪些类型的图表可以用于初步数据分析？在给定的数据集中尝试一些。
- en: Further reading
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Best Practices in Data Cleaning: A Complete Guide to Everything You Need to
    Do Before and After Collecting Your Data*, *1st Edition*, by Jason W. Osborn'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《数据清洗最佳实践：收集数据前后的完整指南》，第一版，作者Jason W. Osborn*'
- en: '*Introduction to Data Visualization Techniques Using Microsoft Excel 2013 &
    Web-based Tools*, by Tufts Data Lab'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《使用Microsoft Excel 2013和基于Web的工具的数据可视化技术入门》，作者Tufts Data Lab*'
- en: '*Analysing the Classification of Imbalanced Data-sets with Multiple Classes:
    Binarization Techniques and Ad-Hoc Approaches for Preprocessing and Cost Sensitive
    Learning*, by A. Fernández, V. López, M. Galar, M.J. del Jesus and F. Herrera'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《分析多类别不平衡数据集的分类：预处理和成本敏感学习的二值化技术和临时方法》，作者A. Fernández, V. López, M. Galar,
    M.J. del Jesus 和 F. Herrera*'
