- en: '15'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '15'
- en: Recommender Systems – Predict What Movies a User Would Like to Watch
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 推荐系统 – 预测用户想看哪些电影
- en: Recommender systems, as the name suggests, are solutions that are designed to
    provide recommendations to users based on various parameters, such as past behavior,
    item similarity, or even user demographics. These systems are used in a range
    of applications, such as for suggesting videos on YouTube, movies on Netflix,
    or products on Amazon.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 如其名所示，推荐系统是针对基于各种参数（如过去的行为、项目相似性，甚至用户人口统计信息）向用户提供推荐的设计解决方案。这些系统被广泛应用于各种应用中，例如在YouTube上推荐视频、Netflix上的电影或Amazon上的产品。
- en: The primary goal of recommender systems is to personalize online user experiences
    to drive business outcomes such as higher user engagement and increased revenues.
    As the amount of available content and choices increases, personalized recommendations
    become crucial for enhancing user experience and ensuring that the customers don’t
    get overwhelmed by the available options.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 推荐系统的主要目标是使在线用户体验个性化，以推动业务成果，如提高用户参与度和增加收入。随着可用内容和选择的增加，个性化推荐对于提升用户体验和确保客户不会被可用的选项所淹没变得至关重要。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Overview of the different types of recommender systems
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不同类型推荐系统的概述
- en: Deploying a movie recommender system on Vertex AI
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Vertex AI上部署电影推荐系统
- en: First, we’ll look at the different types of recommender systems you will typically
    find in the wild.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将探讨在野外通常可以找到的不同类型的推荐系统。
- en: Different types of recommender systems
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 不同类型的推荐系统
- en: 'In this section, we’ll delve into the diverse types of recommendation engines,
    shedding light on their methodologies and the unique advantages each brings to
    the table:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将深入探讨各种类型的推荐引擎，揭示它们的方法论以及每种推荐引擎带来的独特优势：
- en: '**Collaborative filtering**:'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协同过滤**：'
- en: 'This approach is based on the idea that users who have agreed in the past will
    agree in the future about their preference for certain items. As shown in the
    following figure, the model tries to find similar users by looking at their viewing/reading
    and recommends the content viewed by one user to other, similar users:'
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这种方法基于这样一个理念：过去同意过某些物品偏好的用户在未来也可能会同意。如图所示，该模型通过观察用户的观看/阅读行为来尝试找到相似用户，并将一个用户的观看内容推荐给其他相似用户：
- en: '![Figure 15.1 – Collaborative filtering](img/B17792_15_1.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![图15.1 – 协同过滤](img/B17792_15_1.jpg)'
- en: Figure 15.1 – Collaborative filtering
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.1 – 协同过滤
- en: '**Content-based filtering**:'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于内容的过滤**：'
- en: This method uses item attributes to recommend additional items similar to what
    the user likes, based on their previous actions or explicit feedback.
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此方法使用项目属性，根据用户的先前行为或明确反馈推荐与用户喜欢的类似的其他项目。
- en: For example, if a user has shown a preference for movies directed by Christopher
    Nolan, the system will rank the movies that were directed by him higher when making
    recommendations. Here, the content (director, genre, actors, and more) of the
    movies is taken into account.
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 例如，如果一个用户表现出对克里斯托弗·诺兰执导的电影的偏好，那么在推荐时，系统会优先推荐他执导的电影。在这里，电影的（导演、类型、演员等）内容被考虑在内。
- en: '**Advantages**: Can handle new items, so there’s no need for other user’s data.'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**优势**：可以处理新项目，因此不需要其他用户的数据。'
- en: '**Challenges**: Over-specialization (may only show very similar items) and
    requires good quality metadata.'
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**挑战**：过度专业化（可能只显示非常相似的项目）且需要高质量的元数据。'
- en: 'As shown in the following figure, in content-based filtering, the model tries
    to find content similar to the content the user has viewed in the past and then
    recommends similar content to the user in the future:'
  id: totrans-19
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如下图所示，在基于内容的过滤中，模型试图找到与用户过去观看的内容相似的内容，并在未来向用户推荐相似内容：
- en: '![Figure 15.2 – Content-based filtering](img/B17792_15_2.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![图15.2 – 基于内容的过滤](img/B17792_15_2.jpg)'
- en: Figure 15.2 – Content-based filtering
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.2 – 基于内容的过滤
- en: '**Demographic filtering**:'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人口统计过滤**：'
- en: Demographic recommenders provide personalized recommendations by categorizing
    users based on personal attributes and then offering recommendations based on
    demographic classes.
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 人口统计推荐器通过根据个人属性对用户进行分类，然后根据人口统计类别提供个性化推荐。
- en: For example, if data indicates that males aged 18-24 in a particular region
    have a high affinity for action movies such as *Fast and Furious*, then a male
    in that age bracket from that region would be more likely to receive a recommendation
    for that movie or similar action-packed movies.
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 例如，如果数据显示某个特定地区的18-24岁男性对动作电影如《速度与激情》有很高的亲和力，那么来自该地区该年龄段的男性更有可能收到对该电影或类似动作电影的推荐。
- en: '**Advantages**: Straightforward and doesn’t need past user-item interactions.'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**优点**：简单直接，不需要过去的用户-项目交互。'
- en: '**Challenges**: Less personalized, stereotype-based, and requires user demographic
    data.'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**挑战**：个性化程度较低，基于刻板印象，且需要用户人口统计数据。'
- en: In practice, many state-of-the-art systems use hybrid methods that combine elements
    from multiple types of recommendation techniques to overcome the limitations of
    any single approach. An example is Netflix’s recommendation engine, which uses
    a mix of collaborative, content-based, and other techniques to provide its users
    with movie and show recommendations.
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在实践中，许多最先进的系统使用混合方法，结合多种推荐技术元素，以克服任何单一方法的局限性。Netflix的推荐引擎就是一个例子，它结合了协同过滤、基于内容的和其他技术，为用户提供电影和电视剧推荐。
- en: Next, we’ll look at how content recommender systems are evaluated in real-world
    applications through user behavior and feedback.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨如何通过用户行为和反馈评估内容推荐系统在现实世界中的应用。
- en: Real-world evaluation of recommender systems
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐系统在现实世界中的评估
- en: In the real world, the evaluation of recommender systems extends beyond traditional
    machine learning metrics to encompass a broader range of **key performance indicators**
    (**KPIs**) that align more closely with business objectives and user experience.
    Unlike typical “lab” settings, where accuracy metrics such as precision, recall,
    or RMSE are emphasized, real-world evaluations prioritize KPIs such as **click-through
    rate** (**CTR**), conversion rate, and user engagement. These KPIs offer a direct
    reflection of how users interact with the recommendations in a live environment.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实世界中，推荐系统的评估不仅超越了传统的机器学习指标，还涵盖了更广泛的**关键绩效指标**（**KPIs**），这些指标与商业目标和用户体验更加紧密地一致。与典型的“实验室”环境不同，在“实验室”环境中，如精确度、召回率或RMSE等准确性指标被强调，现实世界的评估更优先考虑KPIs，如**点击率**（**CTR**）、转化率和用户参与度。这些KPIs直接反映了用户在真实环境中如何与推荐内容互动。
- en: For instance, a high CTR indicates that users find the recommendations relevant
    enough to explore them further, while a strong conversion rate suggests that the
    recommendations are effective in driving the desired user actions, such as purchases
    or content consumption.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，高CTR表明用户认为推荐内容足够相关，值得进一步探索，而强的转化率表明推荐内容在驱动期望的用户行为方面是有效的，例如购买或内容消费。
- en: 'Additionally, metrics such as **customer lifetime value** (**CLV**) and **net
    promoter score** (**NPS**) provide insights into the long-term impact of the recommender
    system on business revenue and user loyalty. By focusing on these KPIs, organizations
    can assess the real-world effectiveness of their recommender systems, ensuring
    they not only perform well in terms of machine learning metrics but also contribute
    positively to user satisfaction and business goals. This approach recognizes that
    the ultimate success of recommender systems lies in their ability to enhance the
    user experience and drive business outcomes, rather than just achieving high scores
    on traditional evaluation metrics. Let’s take a closer look at the different types
    of metrics:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，如**客户终身价值**（**CLV**）和**净推荐值**（**NPS**）等指标提供了关于推荐系统对商业收入和用户忠诚度长期影响的见解。通过关注这些KPIs，组织可以评估其推荐系统在现实世界中的实际效果，确保它们不仅在机器学习指标上表现良好，而且对用户满意度和商业目标有积极贡献。这种方法认识到推荐系统最终的成功在于它们增强用户体验和推动业务成果的能力，而不仅仅是实现传统评估指标上的高分。让我们更深入地了解不同类型的指标：
- en: '**Engagement metrics**:'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**参与度指标**：'
- en: Engagement metrics assess how users interact with the recommendations, providing
    insights into the system’s ability to capture and retain user interest.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 参与度指标评估用户如何与推荐内容互动，从而提供关于系统捕捉和保持用户兴趣能力的见解。
- en: 'Let’s look at some different engagement metrics:'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 让我们来看看一些不同的参与度指标：
- en: '**CTR**: The ratio of clicks to the number of recommendations displayed, indicating
    how engaging the recommendations are'
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CTR**：点击次数与显示推荐次数的比率，表明推荐内容的吸引力'
- en: '**Conversion rate**: The percentage of recommendations that result in a desired
    action, such as a purchase or a subscription'
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转化率**：导致期望行动（如购买或订阅）的推荐所占的百分比'
- en: '**Average time spent**: The amount of time users spend interacting with the
    recommended content, reflecting user engagement and content relevance'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均花费时间**：用户与推荐内容互动的时间量，反映了用户参与度和内容相关性'
- en: '**User satisfaction**:'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户满意度**：'
- en: User satisfaction metrics evaluate the extent to which users are pleased with
    the recommendations, serving as a direct indicator of the system’s success from
    the user’s perspective.
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用户满意度指标评估用户对推荐的满意程度，作为系统成功直接指标的用户视角。
- en: 'The following are some user satisfaction metrics:'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下是一些用户满意度指标：
- en: '**User feedback and ratings**: Direct user feedback on the recommended items,
    providing insights into user satisfaction'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户反馈和评分**：对推荐项目的直接用户反馈，提供对用户满意度的见解'
- en: '**NPS**: A metric that gauges user satisfaction and loyalty by asking users
    how likely they are to recommend the system to others'
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**NPS（净推荐值）**：通过询问用户他们向他人推荐系统的可能性来衡量用户满意度和忠诚度的指标'
- en: '**Business** **impact metrics**:'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**业务影响指标**：'
- en: Business impact metrics quantify the economic value and effectiveness of the
    recommender system in contributing to the organization’s financial goals.
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 业务影响指标量化了推荐系统对组织财务目标的贡献的经济价值和有效性。
- en: 'The following are key business impact metrics:'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下是一些关键的业务影响指标：
- en: '**Revenue per user** (**RPU**): The average revenue generated per user, indicating
    the economic value of the recommendations'
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**每用户收入（RPU）**：每个用户产生的平均收入，表明推荐的经济价值'
- en: '**CLV**: The total revenue expected from a user over their lifetime, impacted
    by the effectiveness of the recommendations'
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CLV（客户终身价值）**：用户在其整个生命周期内预期的总收入，受推荐效果的影响'
- en: '**Coverage metrics**:'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**覆盖度指标**：'
- en: Coverage metrics determine the extent to which the recommender system effectively
    utilizes the available content and reaches a wide user base.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 覆盖度指标决定了推荐系统有效利用可用内容并触及广泛用户群体的程度。
- en: 'The following are some different coverage metrics:'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下是一些不同的覆盖度指标：
- en: '**Catalog coverage**: The proportion of items in the catalog recommended to
    users, reflecting the system’s ability to utilize the entire inventory'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目录覆盖度**：推荐给用户的目录中项目的比例，反映了系统利用整个库存的能力'
- en: '**User coverage**: The percentage of users receiving relevant recommendations.
    This is crucial for user inclusivity and engagement'
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户覆盖度**：收到相关推荐的用户的百分比。这对于用户包容性和参与度至关重要'
- en: In recommender systems, KPIs are essential for monitoring performance, understanding
    user preferences, and aligning recommendations with business goals. A balanced
    focus on accuracy, user engagement, satisfaction, and business impact ensures
    the development of an effective and user-centric recommender system. Continuous
    monitoring and optimization of these KPIs are vital to maintaining relevance and
    effectiveness in a dynamic user environment.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在推荐系统中，KPI（关键绩效指标）对于监控性能、理解用户偏好以及将推荐与业务目标对齐至关重要。在准确性、用户参与度、满意度和业务影响之间保持平衡的关注，确保开发出一个有效且以用户为中心的推荐系统。持续监控和优化这些KPI对于在动态用户环境中保持相关性和有效性至关重要。
- en: Now, let’s look at how to build and deploy a recommender system on Vertex AI.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看如何在Vertex AI上构建和部署推荐系统。
- en: Deploying a movie recommender system on Vertex AI
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Vertex AI上部署电影推荐系统
- en: 'Now, let’s walk through an example of creating a movie recommendation system
    based on a collaborative filtering type model, deploying it on Vertex AI, and
    then querying it to get movie recommendations for specific users and movie genre
    types. The key steps are as follows:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过一个基于协同过滤类型模型的电影推荐系统创建示例，将其部署在Vertex AI上，然后查询它以获取特定用户和电影类型推荐的电影。关键步骤如下：
- en: Data preparation
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据准备
- en: Model design and training
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型设计和训练
- en: Local model testing
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 本地模型测试
- en: Registering the model on Vertex AI
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Vertex AI上注册模型
- en: Deploying the model
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型部署
- en: Getting predictions
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取预测
- en: Note
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The notebook for this exercise can be found at [https://github.com/PacktPublishing/The-Definitive-Guide-to-Google-Vertex-AI/blob/main/Chapter15/Chp-15_Movie_Recommender.ipynb](https://github.com/PacktPublishing/The-Definitive-Guide-to-Google-Vertex-AI/blob/main/Chapter15/Chp-15_Movie_Recommender.ipynb).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 本练习的笔记本可以在 [https://github.com/PacktPublishing/The-Definitive-Guide-to-Google-Vertex-AI/blob/main/Chapter15/Chp-15_Movie_Recommender.ipynb](https://github.com/PacktPublishing/The-Definitive-Guide-to-Google-Vertex-AI/blob/main/Chapter15/Chp-15_Movie_Recommender.ipynb)
    找到。
- en: '**Dataset**: To train the model, we will use the **MovieLens dataset** (*F.
    Maxwell Harper and Joseph A. Konstan. 2015\. The MovieLens Datasets: History and
    Context. ACM Transactions on Interactive Intelligent Systems (TiiS) 5, 4:* *19:1–19:19.*
    [https://doi.org/10.1145/2827872](https://doi.org/10.1145/2827872)).'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**数据集**：为了训练模型，我们将使用 **MovieLens 数据集** (*F. Maxwell Harper 和 Joseph A. Konstan.
    2015\. The MovieLens Datasets: History and Context. ACM Transactions on Interactive
    Intelligent Systems (TiiS) 5, 4:* *19:1–19:19.* [https://doi.org/10.1145/2827872](https://doi.org/10.1145/2827872))。'
- en: The MovieLens dataset is one of the most popular datasets that’s used in the
    field of recommendation systems. It’s a collection of movie ratings and has been
    produced by the *GroupLens Research Project* at the *University* *of Minnesota*.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: MovieLens 数据集是推荐系统领域中使用的最受欢迎的数据集之一。它是一组电影评分，由明尼苏达大学的 *GroupLens 研究项目* 制作。
- en: 'Additional details about this dataset:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 关于此数据集的更多详细信息：
- en: 'Data: The dataset contains multiple versions with different sizes (ranging
    from 100k ratings to 25M ratings). It consists of movie ratings, movie metadata
    (genres and year of release), and demographic data of the users.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 数据：该数据集包含多个版本，大小不同（从 100k 评分到 25M 评分不等）。它包括电影评分、电影元数据（类型和发行年份）以及用户的统计数据。
- en: 'Data fields:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 数据字段：
- en: '**User data**: User ID, age, gender, occupation, and ZIP code'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户数据**：用户 ID、年龄、性别、职业和邮政编码'
- en: '**Movie data**: Movie ID, title, release date, and associated genres (such
    as action, adventure, comedy, and so on)'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电影数据**：电影 ID、标题、上映日期和相关的类型（如动作、冒险、喜剧等）'
- en: '**Ratings**: User ID, movie ID, rating (typically on a scale of 1 to 5), and
    timestamp'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**评分**：用户 ID、电影 ID、评分（通常在 1 到 5 的范围内）和时间戳'
- en: 'Use cases: It is mainly used for experimenting with collaborative filtering,
    content-based filtering, and hybrid recommendation algorithms.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 用例：主要用于实验协作过滤、基于内容的过滤和混合推荐算法。
- en: The dataset aids in understanding user behavior and patterns in movie ratings.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 该数据集有助于理解用户在电影评分中的行为和模式。
- en: The MovieLens dataset’s popularity stems from its relatively clean data, which
    lacks much of the noise and inconsistencies found in larger, more real-world datasets.
    This makes it ideal for prototyping, learning, and initial experimentation in
    the realm of recommender systems.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: MovieLens 数据集的流行源于其相对干净的数据，其中缺乏在更大、更真实世界数据集中发现的许多噪声和不一致性。这使得它非常适合原型设计、学习和推荐系统领域的初步实验。
- en: Now, let’s use this dataset to create a simple collaborative filtering-based
    movie recommendation solution.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用这个数据集来创建一个简单的基于协作过滤的电影推荐解决方案。
- en: Data preparation
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据准备
- en: 'In this section, we will download and preprocess the MovieLens dataset to get
    the model training data ready for the recommendation model. Follow these steps:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将下载并预处理 MovieLens 数据集，以便为推荐模型准备模型训练数据。请按照以下步骤操作：
- en: '`ml-latest-small.zip` file, which contains the MovieLens dataset:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 包含 MovieLens 数据集的 `ml-latest-small.zip` 文件：
- en: '[PRE0]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`ratings.csv` file into a DataFrame for processing:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `ratings.csv` 文件转换为 DataFrame 以进行处理：
- en: '[PRE1]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Encode the data**: Encode both the user and movie IDs as integer indices
    for model training:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**编码数据**：将用户和电影 ID 编码为整数索引以进行模型训练：'
- en: '[PRE2]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Since our training data is now ready in the form of the `users` and `movies`
    DataFrames, let’s build the recommender model.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的训练数据现在已准备好，以 `users` 和 `movies` DataFrame 的形式，让我们构建推荐模型。
- en: Model building
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型构建
- en: 'In this section, we’ll build the structure of our deep learning recommendation
    model using Keras and train it on the dataset we created in the previous section:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用 Keras 构建我们的深度学习推荐模型结构，并在上一节中创建的数据集上对其进行训练：
- en: '`RecommendationModel` model class, which uses embeddings for users and movies:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '`RecommendationModel` 模型类，它使用用户和电影的嵌入：'
- en: '[PRE3]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The model calculates a match score through a dot product of user and movie embeddings.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 模型通过用户和电影嵌入的点积来计算匹配分数。
- en: '[PRE4]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**Model compilation**: Compile the model using binary cross-entropy as the
    loss function and Adam as the optimizer:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型编译**：使用二元交叉熵作为损失函数和 Adam 作为优化器来编译模型：'
- en: '[PRE5]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '**Model training**: Train the model using the training data and validate it
    using the validation data:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型训练**：使用训练数据训练模型，并使用验证数据验证模型：'
- en: '[PRE6]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Local model testing
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 本地模型测试
- en: 'Before deploying the model, let’s test its predictions locally to ensure it
    works as expected:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在部署模型之前，让我们在本地测试其预测以确保其按预期工作：
- en: '**Prepare the test data**: For a random user, create an array of movies they
    haven’t watched yet:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**准备测试数据**：对于随机用户，创建一个他们尚未观看的电影数组：'
- en: '[PRE7]'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '**Predict ratings**: Use the model to predict ratings for movies the user hasn’t
    rated before:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**预测评分**：使用模型预测用户之前未评分的电影的评分：'
- en: '[PRE8]'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Recommend movies**: Now, based on the predicted ratings, let’s identify and
    display the top 10 movie recommendations for the user:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**推荐电影**：现在，根据预测的评分，让我们识别并显示用户的顶级10部电影推荐：'
- en: '[PRE9]'
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The final predictions from the model are shown here. Your list of movies will
    vary based on the user selected from the dataset:'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 模型的最终预测结果如下。您的电影列表将根据用户从数据集中选择的用户而变化：
- en: '[PRE10]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: So, it seems like the model is working well in the local environment and can
    generate movie recommendations. Now, let’s deploy the model to the cloud.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，看起来模型在本地环境中运行良好，可以生成电影推荐。现在，让我们将模型部署到云端。
- en: Deploying the model on Google Cloud
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Google Cloud上部署模型
- en: 'The first step is to deploy the model on GCP so that we can upload and register
    our local model on Vertex AI. Follow these steps:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是在GCP上部署模型，这样我们就可以在Vertex AI上上传和注册我们的本地模型。请按照以下步骤操作：
- en: '**Register the model on Vertex AI**: To register/upload the model on Vertex
    AI, we need to save the core machine learning model artifacts to a **Google Cloud
    Storage** (**GCS**) bucket:'
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**在Vertex AI上注册模型**：要在Vertex AI上注册/上传模型，我们需要将核心机器学习模型工件保存到**Google Cloud Storage**（**GCS**）桶中：'
- en: '[PRE11]'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Now, we must upload the saved model to the Vertex AI Model Registry. To do
    this, we will need to pass the following parameters:'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，我们必须将保存的模型上传到Vertex AI模型注册表。为此，我们需要传递以下参数：
- en: '`display_name`: The model’s display name that will be displayed in the Vertex
    AI Model Registry.'
  id: totrans-113
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`display_name`：将在Vertex AI模型注册表中显示的模型的显示名称。'
- en: '`artifact_uri`: The location of the saved model in GCS.'
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`artifact_uri`：保存模型在GCS中的位置。'
- en: '`serving_container_image_uri`: The Docker image to be used as a serving container.
    You can use one of the images provided as part of Vertex AI or upload a custom
    container image to the GCP Artifact Registry. This chapter’s Jupyter Notebook
    provides more details.'
  id: totrans-115
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`serving_container_image_uri`：用作服务容器的Docker镜像。您可以使用Vertex AI提供的镜像之一，或者将自定义容器镜像上传到GCP工件注册表。本章的Jupyter
    Notebook提供了更多详细信息。'
- en: '`is_default_version`: This specifies whether this will be the default version
    for the model resource.'
  id: totrans-116
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`is_default_version`：这指定了这将是否是模型资源的默认版本。'
- en: '`version_ailiases`: Alternative alias names for the model version.'
  id: totrans-117
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version_ailiases`：模型版本的替代别名。'
- en: '`version_description`: User description of the model version.'
  id: totrans-118
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version_description`：用户对模型版本的描述。'
- en: '[PRE12]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '**Deploy the model as a Vertex** **AI endpoint**:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**将模型部署为Vertex AI端点**：'
- en: 'Create an endpoint on Vertex AI and deploy the model for real-time inference.
    Ensure you provide a display name:'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在Vertex AI上创建端点并部署模型以进行实时推理。请确保您提供显示名称：
- en: '[PRE13]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Now, deploy the model to the newly created endpoint while specifying the machine
    type and other configuration settings:'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，在指定机器类型和其他配置设置的同时，将模型部署到新创建的端点：
- en: '[PRE14]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Using the model for inference
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用模型进行推理
- en: 'This is the fun part! We’ll use our machine learning model, which has been
    deployed in Google Cloud Vertex AI, to make predictions using API calls. First,
    we’ll create a Python function to send the prediction requests, then create a
    test/inference dataset we can send to the model as part of our request. Finally,
    we’ll parse the prediction response we receive back from the model. Let’s get
    started:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 这是最有趣的部分！我们将使用部署在Google Cloud Vertex AI上的机器学习模型，通过API调用进行预测。首先，我们将创建一个Python函数来发送预测请求，然后创建一个测试/推理数据集，我们可以将其作为请求的一部分发送给模型。最后，我们将解析从模型收到的预测响应。让我们开始吧：
- en: '`predict_custom_trained_model_sample` so that you can make predictions using
    the deployed model on Vertex AI:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`predict_custom_trained_model_sample`，这样您就可以使用部署在Vertex AI上的模型进行预测：'
- en: '[PRE15]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '**Create the inference dataset**: Create a sample inference dataset for a user
    and genre:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建推理数据集**：为用户和流派创建一个样本推理数据集：'
- en: '[PRE16]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Create a prediction input dataset consisting of all movies in the selected
    genre that the user has not watched (not rated):'
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个预测输入数据集，包含用户未观看（未评分）的所选流派中的所有电影：
- en: '[PRE17]'
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '**Send a prediction request**: Submit the inference dataset to the Vertex AI
    Prediction API endpoint:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**发送预测请求**：将推理数据集提交到Vertex AI预测API端点：'
- en: '[PRE18]'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '**Parse the results**: Parse the predictions received from the API endpoint
    and combine them:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**解析结果**：解析从API端点收到的预测并将它们组合：'
- en: '[PRE19]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '**Create a DataFrame**: Create a DataFrame from the instances list/array:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建DataFrame**：从实例列表/数组创建DataFrame：'
- en: '[PRE20]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '**Print**: Print the final recommended list of movies:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**打印**：打印最终推荐的影片列表：'
- en: '[PRE21]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The output will look something like this:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE22]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Starting with a dataset of movies rated by users, we were able to train a model
    that can now provide movie recommendations for the users in the group.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 从一个用户评分的电影数据集开始，我们能够训练一个模型，现在可以为组内的用户提供电影推荐。
- en: Summary
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we provided a brief overview of recommender systems, different
    techniques used for building them, and detailed steps for training, deploying,
    and querying a movie recommender model on Google Cloud’s Vertex AI. Since the
    key objective was to showcase how you can address a real-world use case using
    GCP Vertex AI, we kept the core model somewhat simple. But if you are interested
    in doing a deeper dive into recommender solutions, you can look at courses such
    as *Recommender Systems Specialization* on Coursera.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们简要概述了推荐系统、构建它们所使用的不同技术，以及如何在Google Cloud的Vertex AI上训练、部署和查询电影推荐模型的详细步骤。由于关键目标是展示如何使用GCP
    Vertex AI解决真实世界的用例，我们保持了核心模型相对简单。但如果你对深入了解推荐解决方案感兴趣，可以查看Coursera上的*推荐系统专项课程*。
- en: In the next chapter, we will look into another real-world use case around building
    a vision-based machine learning solution to detect defects during the manufacturing
    process.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨另一个真实世界的用例，即构建基于视觉的机器学习解决方案，以在制造过程中检测缺陷。
- en: References
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'To learn more about the topics that were covered in this chapter, take a look
    at the following resources:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于本章所涉及主题的信息，请查看以下资源：
- en: '*Collaborative Filtering for Movie* *Recommendations*: [https://keras.io/examples/structured_data/collaborative_filtering_movielens/](https://keras.io/examples/structured_data/collaborative_filtering_movielens/)'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '*电影推荐中的协同过滤*：[https://keras.io/examples/structured_data/collaborative_filtering_movielens/](https://keras.io/examples/structured_data/collaborative_filtering_movielens/)'
- en: '*Get started with Vertex AI Model* *Registry*: [https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/model_registry/get_started_with_model_registry.ipynb](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/model_registry/get_started_with_model_registry.ipynb)'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '*开始使用Vertex AI模型注册表*：[https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/model_registry/get_started_with_model_registry.ipynb](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/model_registry/get_started_with_model_registry.ipynb)'
