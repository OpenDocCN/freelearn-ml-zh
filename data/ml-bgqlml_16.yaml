- en: '*Chapter 12*: Using BigQuery ML with AI Notebooks'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第 12 章*：使用 AI 笔记本与 BigQuery ML'
- en: For data scientists and machine learning engineers, notebooks are a fundamental
    productivity tool. Notebooks allow us to interact with computing resources because
    we can use them to write and execute code, visualize the results, and share the
    outcomes with other data scientists. Data engineers, data scientists, and machine
    learning engineers make experiments and explore data before deploying code into
    the production environment. They leverage notebooks because they offer a flexible
    and agile environment to develop and test in.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 对于数据科学家和机器学习工程师来说，笔记本是一个基本的生产力工具。笔记本允许我们与计算资源进行交互，因为我们可以使用它们来编写和执行代码，可视化结果，并与其他数据科学家分享成果。数据工程师、数据科学家和机器学习工程师在将代码部署到生产环境之前进行实验和探索数据。他们利用笔记本，因为它们提供了一个灵活且敏捷的环境来开发和测试。
- en: In this chapter, we'll learn what **AI Platform Notebooks** is, how to provision
    a notebook environment, and how to use it to develop a BigQuery ML model.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习 **AI 平台笔记本** 是什么，如何配置笔记本环境，以及如何使用它来开发 BigQuery ML 模型。
- en: We'll start by discovering the basics of notebooks and then start getting some
    hands-on practice with **Google Cloud Platform** (**GCP**).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从了解笔记本的基础知识开始，然后开始进行一些与 **Google Cloud Platform**（**GCP**）的动手实践。
- en: 'In this chapter, we''ll cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Discovering AI Platform Notebooks
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现 AI 平台笔记本
- en: Implementing BigQuery ML models within notebooks
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在笔记本中实现 BigQuery ML 模型
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'This chapter requires that you have access to a web browser and can leverage
    the following:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本章要求您能够访问网络浏览器，并可以利用以下资源：
- en: A GCP account to access the Google Cloud Console
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 GCP 账户以访问 Google Cloud Console
- en: A GCP project to host BigQuery datasets
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个用于托管 BigQuery 数据集的 GCP 项目
- en: Now that we know about the technical requirements for this chapter, let's learn
    how to develop a machine learning model using AI Platform Notebooks.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了本章的技术要求，让我们学习如何使用 AI 平台笔记本开发机器学习模型。
- en: 'Check out the following video to see the Code in Action: [https://bit.ly/2QVZ1oY](https://bit.ly/2QVZ1oY)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下视频以了解代码的实际应用：[https://bit.ly/2QVZ1oY](https://bit.ly/2QVZ1oY)
- en: Discovering AI Platform Notebooks
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发现 AI 平台笔记本
- en: In this section, we'll learn what **AI Platform Notebooks** is and the advantages
    that it can provide.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习 **AI 平台笔记本** 是什么以及它能够提供的优势。
- en: '**AI Platform Notebooks** is a fully managed service that allows data engineers
    and data scientists to use a JupyterLab development environment. This service
    allows us to develop, evaluate, test, and deploy machine learning models.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**AI 平台笔记本** 是一个完全托管的服务，允许数据工程师和数据科学家使用 JupyterLab 开发环境。此服务允许我们开发、评估、测试和部署机器学习模型。'
- en: '**JupyterLab** is a web tool for data scientists that is developed and maintained
    by Project Jupyter ([https://jupyter.org/about](https://jupyter.org/about)). The
    goal of the project is to develop open source software and standards that offer
    a unique interface across different programming languages.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**JupyterLab** 是由 Project Jupyter 开发和维护的一个面向数据科学家的网络工具（[https://jupyter.org/about](https://jupyter.org/about)）。该项目的目标是开发开源软件和标准，为不同的编程语言提供独特的界面。'
- en: 'Using AI Platform Notebooks with JupyterLab can bring several advantages:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 AI 平台笔记本与 JupyterLab 可以带来几个优势：
- en: We can easily set up our pre-configured machine learning environments with the
    most important and useful ML libraries, such as TensorFlow, Keras, PyTorch, and
    others.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以轻松设置预配置的机器学习环境，其中包含最重要的和最有用的 ML 库，如 TensorFlow、Keras、PyTorch 等。
- en: We can leverage the scalability of the cloud by increasing the size of the hardware
    resources according to our requirements. For example, we can improve the performance
    of our notebook by scaling up the RAM or adding **Graphics Processing Units**
    (**GPUs**).
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过根据我们的需求增加硬件资源的大小来利用云的可扩展性。例如，我们可以通过增加 RAM 或添加 **图形处理单元**（**GPU**）来提高我们笔记本的性能。
- en: We are allowed to access the other Google Cloud services from our notebook without
    the need to perform any additional configuration. From AI Platform Notebooks,
    we can easily leverage BigQuery, Dataflow, and Dataproc.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以在不进行任何额外配置的情况下从我们的笔记本访问其他 Google Cloud 服务。从 AI 平台笔记本，我们可以轻松利用 BigQuery、Dataflow
    和 Dataproc。
- en: We can integrate our development environment with code versioning applications
    such as Git.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以将我们的开发环境与代码版本控制应用程序（如 Git）集成。
- en: We can easily share our notebooks with colleagues or friends, thus making collaboration
    faster and increasing productivity.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以轻松地将我们的笔记本与同事或朋友分享，从而加快协作速度并提高生产力。
- en: 'In the following screenshot, you can see the web interface of a JupyterLab
    notebook:'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在以下屏幕截图中，您可以看到 JupyterLab 笔记本的网页界面：
- en: '![Figure 12.1 –JupyterLab''s web interface'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 12.1 – JupyterLab 的网页界面'
- en: '](img/B16722_12_001.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16722_12_001.jpg)'
- en: Figure 12.1 –JupyterLab's web interface
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.1 – JupyterLab 的网页界面
- en: 'A notebook can contain descriptive content, code blocks, and results. It is
    composed of a sequence of cells that can be executed. There are two types of cells:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 笔记本可以包含描述性内容、代码块和结果。它由一系列可执行的单元格组成。有两种类型的单元格：
- en: '**Code cells**: Contain executable code to run. The result of their execution
    is visualized immediately after the code.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**代码单元格**：包含可执行的代码以运行。它们的执行结果将在代码之后立即可视化。'
- en: '**Markdown cells**: Contain HTML code to produce headers, lists, and formatted
    text. These cells are usually used to describe the code and make the entire notebook
    readable and easy to understand.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Markdown 单元格**：包含 HTML 代码以生成标题、列表和格式化文本。这些单元格通常用于描述代码，并使整个笔记本易于阅读和理解。'
- en: Let's move on to the next section!
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们进入下一节！
- en: AI Platform Notebooks pricing
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: AI 平台笔记本定价
- en: In this section, you'll understand how the price of AI Notebooks is calculated
    and billed to your Google Cloud account.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将了解 AI 笔记本的价格是如何计算并记入您的 Google Cloud 账户的。
- en: Since the JupyterLab software is open source, when you use AI Platform Notebooks,
    you're only charged for the Google Cloud resources that you consume.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 JupyterLab 软件是开源的，当您使用 AI 平台笔记本时，您只需为消耗的 Google Cloud 资源付费。
- en: 'To start using AI Platform Notebooks, you''ll have to pay for the following:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 AI 平台笔记本，您需要支付以下费用：
- en: '**Google Compute Engine** (**GCE**), the virtual machine that''s used to deploy
    your development environment. GCE is charged according to the provisioned number
    of virtual CPUs, memory, and disk that you have.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Google Compute Engine**（**GCE**），用于部署您的开发环境的虚拟机。GCE 根据您配置的虚拟 CPU 数量、内存和磁盘收费。'
- en: Any other service that can be invoked from the notebook, such as BigQuery.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何可以从笔记本调用的其他服务，例如 BigQuery。
- en: Tip
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 小贴士
- en: Remember to turn off the GCE that hosts your AI Platform Notebook when you are
    not using it. If the virtual machine is left active, you will continue to pay
    for those resources, even if you are not actually using them.
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记得在您不使用 AI 平台笔记本时关闭托管它的 GCE。如果虚拟机保持激活状态，即使您实际上没有使用，您也将继续为这些资源付费。
- en: Now that we've learned what AI Platform Notebooks is and why it can be useful
    when you're developing a machine learning model, in the next section, we'll understand
    how to configure our first notebook.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们已经了解了 AI 平台笔记本是什么以及为什么在开发机器学习模型时它可能很有用，在下一节中，我们将了解如何配置我们的第一个笔记本。
- en: Configuring the first notebook
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置第一个笔记本
- en: In this section, we'll set up our first AI Platform notebook, which will be
    used to train, evaluate, and test the BigQuery ML model.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将设置我们的第一个 AI 平台笔记本，该笔记本将用于训练、评估和测试 BigQuery ML 模型。
- en: 'After logging into the GCP console, we can start configuring our first notebook.
    Let''s get started:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 登录 GCP 控制台后，我们可以开始配置我们的第一个笔记本。让我们开始吧：
- en: First, let's browse the console's navigation menu until we find the **AI Platform
    (Unified)** item. From the submenu, select **Notebooks**:![Figure 12.2 – AI Platform
    Notebooks in the console's menu
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们浏览控制台的导航菜单，直到我们找到**AI 平台（统一）**项。从子菜单中选择**笔记本**：![图 12.2 – 控制菜单中的 AI 平台笔记本
- en: '](img/B16722_12_002.jpg)'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16722_12_002.jpg)'
- en: Figure 12.2 – AI Platform Notebooks in the console's menu
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.2 – 控制菜单中的 AI 平台笔记本
- en: If this is the first time that we're accessing this service, we will be asked
    to enable the API. We can click the blue **ENABLE** button to start using the
    service:![Figure 12.3 – Enabling the Notebooks API
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果这是我们第一次访问此服务，我们将被要求启用 API。我们可以点击蓝色的**启用**按钮开始使用该服务：![图 12.3 – 启用笔记本 API
- en: '](img/B16722_12_003.jpg)'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16722_12_003.jpg)'
- en: Figure 12.3 – Enabling the Notebooks API
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.3 – 启用笔记本 API
- en: After a few minutes, the service will be enabled and ready to use. We'll be
    redirected to a web page containing the statistics of the API that we've just
    enabled:![Figure 12.4 – The statistics of the Notebooks API
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 几分钟后，服务将被启用并准备好使用。我们将被重定向到一个包含我们刚刚启用的 API 统计信息的网页：![图 12.4 – 笔记本 API 的统计数据
- en: '](img/B16722_12_004.jpg)'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16722_12_004.jpg)'
- en: Figure 12.4 – The statistics of the Notebooks API
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.4 – Notebooks API 的统计信息
- en: Selecting the **Notebooks** item from the console's navigation menu once more,
    we'll access the page dedicated to AI Platform Notebooks. By selecting the blue
    **CREATE INSTANCE** button, we'll start configuring the notebook:![Figure 12.5
    – Creating new instances
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次从控制台的导航菜单中选择 **Notebooks** 项，我们将访问专门用于 AI 平台笔记本的页面。通过选择蓝色 **创建实例** 按钮，我们将开始配置笔记本：![图
    12.5 – 创建新实例
- en: '](img/B16722_12_005.jpg)'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片 B16722_12_005.jpg]'
- en: Figure 12.5 – Creating new instances
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.5 – 创建新实例
- en: To create a notebook instance, we need to choose an `bigqueryml-packt-notebook`
    for **Instance name**, **us-west1** for **Region**, **use-west1-a** for **Zone**,
    **Debian 10** for **Operating System**, and **Python 3 (with Intel MKL)** for
    **Environment**.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建笔记本实例，我们需要选择 **Instance name** 为 `bigqueryml-packt-notebook`，**Region** 为
    **us-west1**，**Zone** 为 **use-west1-a**，**Operating System** 为 **Debian 10**，以及
    **Environment** 为 **Python 3 (with Intel MKL)**。
- en: Scrolling down the configuration page, select **n1-standard-2** for **Machine
    type**. After that, we can start creating the instance by clicking the blue **CREATE**
    button:![Figure 12.7 – Additional options for creating a notebook instance
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到配置页面，选择 **n1-standard-2** 作为 **机器类型**。之后，我们可以通过点击蓝色 **创建** 按钮开始创建实例：![图 12.7
    – 创建笔记本实例的附加选项
- en: '](img/B16722_12_007.jpg)'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片 B16722_12_007.jpg]'
- en: Figure 12.7 – Additional options for creating a notebook instance
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.7 – 创建笔记本实例的附加选项
- en: After a few minutes, the notebook instance will be ready to use. Upon selecting
    **OPEN JUPYTERLAB**, the JupyterLab notebook will open a new window containing
    the development environment:![Figure 12.8 – The list of notebook instances available
    in the GCP project
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 几分钟后，笔记本实例将准备好使用。在选择了 **打开 JUPYTERLAB** 后，JupyterLab 笔记本将打开一个包含开发环境的新窗口：![图
    12.8 – GCP 项目中可用的笔记本实例列表
- en: '](img/B16722_12_008.jpg)'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片 B16722_12_008.jpg]'
- en: Figure 12.8 – The list of notebook instances available in the GCP project
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.8 – GCP 项目中可用的笔记本实例列表
- en: In the web interface of the JupyterLab notebook, we can initialize the first
    notebook file by selecting **Python 3** as the notebook type:![Figure 12.9 – Selecting
    the runtime engine to use in the notebook
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 JupyterLab 笔记本的网页界面中，我们可以通过选择笔记本类型为 **Python 3** 来初始化第一个笔记本文件：![图 12.9 – 选择笔记本中使用的运行时引擎
- en: '](img/B16722_12_009.jpg)'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片 B16722_12_009.jpg]'
- en: Figure 12.9 – Selecting the runtime engine to use in the notebook
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 12.9 – 选择笔记本中使用的运行时引擎
- en: 'Upon making this selection, a new notebook file will be created and ready for
    us to develop our BigQuery ML machine learning model:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在做出此选择后，将创建一个新的笔记本文件，并准备好供我们开发 BigQuery ML 机器学习模型：
- en: '![Figure 12.10 – When the notebook is initialized, an empty file is displayed'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 12.10 – 当笔记本初始化时，显示一个空文件'
- en: '](img/B16722_12_010.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片 B16722_12_010.jpg]'
- en: Figure 12.10 – When the notebook is initialized, an empty file is displayed
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.10 – 当笔记本初始化时，显示一个空文件
- en: In this section, we configured our first AI Platform notebook. In the next section,
    we'll use it to execute some code blocks in order to create, evaluate, and test
    a BigQuery ML machine learning model.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们配置了我们的第一个 AI 平台笔记本。在下一节中，我们将使用它来执行一些代码块，以创建、评估和测试一个 BigQuery ML 机器学习模型。
- en: Implementing BigQuery ML models within notebooks
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在笔记本中实现 BigQuery ML 模型
- en: In this section, we'll leverage the notebook instance that we configured in
    the *Configuring the first notebook* section to run BigQuery SQL statements and
    develop the BigQuery ML machine learning model.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将利用在 *配置第一个笔记本* 部分配置的笔记本实例来运行 BigQuery SQL 语句并开发 BigQuery ML 机器学习模型。
- en: To learn how a notebook can be used, we'll reuse some of the code blocks that
    we built in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting
    Numerical Values with Linear Regression*. It's important to remember that the
    goal of the use case was to predict the rental time of each ride for the New York
    City bike sharing service. To achieve this goal, we've trained a simple linear
    regression machine learning model. In this section, we'll use the same technique;
    that is, we'll be embedding the code into an AI Platform notebook.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解如何使用笔记本，我们将重用我们在 [*第 4 章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)
    中构建的一些代码块，*使用线性回归预测数值*。重要的是要记住，用例的目标是预测纽约市自行车共享服务的每次骑行时间。为了实现这一目标，我们训练了一个简单的线性回归机器学习模型。在本节中，我们将使用相同的技巧；也就是说，我们将代码嵌入到
    AI 平台笔记本中。
- en: Compiling the AI notebook
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 编译 AI 笔记本
- en: 'In this section, we''ll compile the notebook using **Code** cells to embed
    the SQL queries and **Markdown** cells to create titles and descriptions. Let''s
    start compiling our notebook by performing the following steps:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用**代码**单元格嵌入SQL查询，并使用**Markdown**单元格创建标题和描述。让我们通过执行以下步骤开始编译我们的笔记本：
- en: 'First, let''s create a title for our notebook. From the cell type drop-down
    menu, we can select **Markdown** and insert the following code block into the
    first cell of the notebook:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们为我们的笔记本创建一个标题。从单元格类型下拉菜单中，我们可以选择**Markdown**并将以下代码块插入到笔记本的第一个单元格中：
- en: '[PRE0]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'In the following screenshot, you can see how the first cell is configured:'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在以下屏幕截图中，您可以看到第一个单元格的配置方式：
- en: '![Figure 12.11 – An example of a Markdown cell'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图12.11 – Markdown单元格的示例'
- en: '](img/B16722_12_011.jpg)'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/B16722_12_011.jpg)'
- en: Figure 12.11 – An example of a Markdown cell
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图12.11 – Markdown单元格的示例
- en: The **#** character preceding the text is used to identify a title at the first
    level.
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 文本前面的**#**字符用于识别一级标题。
- en: 'By clicking on the **+** button in the notebook menu, you''ll add a new cell.
    Let''s select **Markdown** as the cell type and insert the following text, which
    describes the notebook:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在笔记本菜单中点击**+**按钮，您将添加一个新的单元格。让我们选择**Markdown**作为单元格类型，并插入以下文本，该文本描述了笔记本：
- en: '[PRE1]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: To check whether we've written the previous steps properly, we can use the Run
    button in the notebook menu. We can run each cell to visualize the result:![Figure
    12.12 – The Run button in the notebook menu
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了检查我们是否正确地编写了之前的步骤，我们可以使用笔记本菜单中的运行按钮。我们可以运行每个单元格以可视化结果：![图12.12 – 笔记本菜单中的运行按钮
- en: '](img/B16722_12_012.jpg)'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/B16722_12_012.jpg)'
- en: Figure 12.12 – The Run button in the notebook menu
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图12.12 – 笔记本菜单中的运行按钮
- en: 'In the following screenshot, you can see the outcome of executing the first
    two steps, which contain the title and a short description:'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在以下屏幕截图中，您可以看到执行前两个步骤的结果，其中包含标题和简短描述：
- en: '![Figure 12.13 – The result of executing the first few cells'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图12.13 – 执行前几个单元格的结果'
- en: '](img/B16722_12_013.jpg)'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/B16722_12_013.jpg)'
- en: Figure 12.13 – The result of executing the first few cells
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图12.13 – 执行前几个单元格的结果
- en: Let's add a subtitle to start the data preparation section of the model. We'll
    add another `##` character preceding the text is used to identify a title of the
    second level. It can be considered a subtitle of the title we wrote in *Step 1*.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在模型的数据准备部分开始之前添加一个副标题。我们将在文本之前添加另一个`##`字符来识别二级标题。它可以被认为是我们在*步骤1*中编写的标题的副标题。
- en: Now, we're ready to create the `12_notebook` BigQuery dataset, which will be
    used to host our BigQuery ML models. Let's create a `12_notebook` dataset in `US`
    within the current GCP project. At the end of the cell, the `print` command is
    used to present a confirmation message, stating that the dataset has been created
    successfully.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们准备好创建`12_notebook` BigQuery数据集，该数据集将用于托管我们的BigQuery ML模型。让我们在当前GCP项目中的`US`下创建一个`12_notebook`数据集。在单元格末尾，`print`命令用于显示确认消息，表明数据集已成功创建。
- en: 'Now, we can add a new `` `12_notebook.training_table` `` table:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以添加一个新的`12_notebook.training_table`表格：
- en: '[PRE2]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `%%bigquery` keyword allows us to include code blocks that contain SQL queries.
    The SQL statement will be run directly on BigQuery through the native integration
    of the AI Platform notebook and the analytical database.
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`%%bigquery`关键字允许我们包含包含SQL查询的代码块。SQL语句将通过AI平台笔记本和关系型数据库的本地集成直接在BigQuery上运行。'
- en: The business logic to create the table is the same as what we used to create
    the `` `04_nyc_bike_sharing.training_table` `` table in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*.
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 创建表格的业务逻辑与我们用于在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中创建`04_nyc_bike_sharing.training_table`表格的方式相同，*使用线性回归预测数值*。
- en: Now, let's include an additional `` `04_nyc_bike_sharing.evaluation_table` ``
    table in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting
    Numerical Values with Linear Regression*.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中包含一个额外的`04_nyc_bike_sharing.evaluation_table`表格，*使用线性回归预测数值*。
- en: Finally, let's add another `` `04_nyc_bike_sharing.prediction_table` `` table
    in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting
    Numerical Values with Linear Regression*.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中添加另一个`04_nyc_bike_sharing.prediction_table`表格，*使用线性回归预测数值*。
- en: 'Let''s add a subtitle to start the training section of the model. We''ll add
    a **Markdown** cell by inserting the following title:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在模型的训练部分开始之前添加一个副标题。我们将通过插入以下标题来添加一个**Markdown**单元格：
- en: '[PRE3]'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Now, we're ready to write the BigQuery ML query that will train our machine
    learning model from the notebook. Let's add a new `` `12_notebook.trip_duration_notebook`
    `` machine learning model contains the same business logic that we used in [*Chapter
    4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting Numerical Values
    with Linear Regression*, to train the `` `04_nyc_bike_sharing.trip_duration_by_stations_and_day`
    `` model.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们已经准备好编写将使用笔记本训练我们的机器学习模型的BigQuery ML查询。让我们添加一个新的`` `12_notebook.trip_duration_notebook`
    ``机器学习模型，它包含我们在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中使用的相同业务逻辑，即使用``
    `04_nyc_bike_sharing.trip_duration_by_stations_and_day` ``模型来训练。
- en: 'Let''s add a subtitle to start the training section of the model. We''ll add
    a **Markdown** cell by inserting the following title:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在模型的训练部分开始之前添加一个副标题。我们将通过插入以下标题来添加一个**Markdown**单元格：
- en: '[PRE4]'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Now, we're ready to write the BigQuery ML query that will evaluate the machine
    learning model. Let's add a new `` `12_notebook.trip_duration_notebook` `` machine
    learning model contains the same business logic that we used in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*, to evaluate the `` `04_nyc_bike_sharing.trip_duration_by_stations_and_day`
    `` model.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们已经准备好编写将评估机器学习模型的BigQuery ML查询。让我们添加一个新的`` `12_notebook.trip_duration_notebook`
    ``机器学习模型，它包含我们在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中使用的相同业务逻辑，即使用``
    `04_nyc_bike_sharing.trip_duration_by_stations_and_day` ``模型来评估。
- en: 'Let''s add a subtitle to start the prediction section of the model. We''ll
    add a **Markdown** cell by inserting the following title:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在模型的预测部分开始之前添加一个副标题。我们将通过插入以下标题来添加一个**Markdown**单元格：
- en: '[PRE5]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Now, we can include the BigQuery ML query that we'll use for our ML model. Let's
    add a new `` `12_notebook.trip_duration_notebook` `` machine learning model contains
    the same business logic that we used in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*, to use the `` `04_nyc_bike_sharing.trip_duration_by_stations_and_day`
    `` model.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以包含我们将用于我们的机器学习模型的BigQuery ML查询。让我们添加一个新的`` `12_notebook.trip_duration_notebook`
    ``机器学习模型，它包含我们在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中使用的相同业务逻辑，即使用``
    `04_nyc_bike_sharing.trip_duration_by_stations_and_day` ``模型来预测数值。
- en: At the end of the compilation phase, we can save the notebook using the **Save
    Notebook** button in the main menu or by using the **Save Notebook As…** option.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在编译阶段结束时，我们可以使用主菜单中的**保存笔记本**按钮或使用**另存为笔记本…**选项来保存笔记本。
- en: In this section, we compiled our notebook using code cells and Markdown cells.
    In the next section, we'll run the code that we've written in the notebook.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们使用代码单元格和Markdown单元格编译了我们的笔记本。在下一节中，我们将运行笔记本中编写的代码。
- en: Running the code in the AI notebook
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在AI笔记本中运行代码
- en: In this section, we'll run the code that we wrote in the *Compiling the AI notebook*
    section. Let's start by taking a look at the notebook that we've prepared.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将运行我们在*编译AI笔记本*部分编写的代码。让我们先看看我们准备好的笔记本。
- en: 'In the following screenshot, we can visualize our AI notebook, which alternates
    between descriptive cells and code cells:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的屏幕截图中，我们可以可视化我们的AI笔记本，它交替显示描述性单元格和代码单元格：
- en: '![Figure 12.14 – The entire notebook file compiled'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 12.14 – The entire notebook file compiled'
- en: '](img/B16722_12_014.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B16722_12_014.jpg]'
- en: Figure 12.14 – The entire notebook file compiled
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.14 – 整个笔记本文件已编译
- en: 'To run the entire notebook, we can simply open the **Run** menu at the top
    of the window and select **Run All Cells**, as shown in the following screenshot:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行整个笔记本，我们只需在窗口顶部打开**运行**菜单并选择**运行所有单元格**，如图所示：
- en: '![Figure 12.15 – Running all the cells'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 12.15 – Running all the cells'
- en: '](img/B16722_12_015.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B16722_12_015.jpg]'
- en: Figure 12.15 – Running all the cells
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.15 – 运行所有单元格
- en: Upon selecting **Run All Cells**, all the cells in the AI Platform notebook
    will be executed sequentially.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 选择**运行所有单元格**后，AI平台笔记本中的所有单元格将依次执行。
- en: At the end of the evaluation step, the results of the `ML.EVALUATE` function
    will be shown in the *Evaluating the linear regression* section.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估步骤结束时，`ML.EVALUATE`函数的结果将在*评估线性回归*部分显示。
- en: 'The following screenshot shows the values returned by the evaluation stage:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了评估阶段返回的值：
- en: '![Figure 12.16 – The values returned by the evaluation function'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 12.16 – 评估函数返回的值'
- en: '](img/B16722_12_016.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B16722_12_016.jpg](img/B16722_12_016.jpg)'
- en: Figure 12.16 – The values returned by the evaluation function
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.16 – 评估函数返回的值
- en: At the end of the prediction step, the results of the `ML.PREDICT` function
    will be shown in the `Testing the linear regression` section.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测步骤结束时，`ML.PREDICT`函数的结果将在“测试线性回归”部分显示。
- en: 'In the following screenshot, we can visualize the results presented at the
    end of the notebook:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，我们可以可视化笔记本末尾呈现的结果：
- en: '![Figure 12.17 – The values returned by the PREDICT function'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 12.17 – PREDICT函数返回的值'
- en: '](img/B16722_12_017.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B16722_12_017.jpg](img/B16722_12_017.jpg)'
- en: Figure 12.17 – The values returned by the PREDICT function
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.17 – PREDICT函数返回的值
- en: As you can see, after executing the code block, the notebook presents the results
    of the predictions immediately after the SQL statement. This characteristic is
    particularly important if we wish to increase the readability and understanding
    of the BigQuery ML development steps.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，在执行代码块后，笔记本立即在SQL语句之后呈现预测结果。如果我们希望提高BigQuery ML开发步骤的可读性和理解性，这一特性尤为重要。
- en: In this section, we learned how to compile an AI notebook and how to run all
    the cells that contain code blocks or titles and descriptions.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们学习了如何编译人工智能笔记本以及如何运行包含代码块或标题和描述的所有单元格。
- en: Summary
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned what AI notebooks are and why they can be useful
    in the development of a machine learning model, and we also understood the pricing
    model. We discovered the relationship between Google AI Platform Notebooks and
    the open source environment JupyterLab.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了人工智能笔记本是什么以及为什么它们在机器学习模型开发中可能很有用，我们还了解了定价模型。我们发现了Google AI Platform
    Notebooks与开源环境JupyterLab之间的关系。
- en: First, we provisioned our first notebook instance using the Google Cloud Console
    web interface. Then, we used this new instance to develop a simple linear regression
    model, alternating code blocks and descriptive cells in the notebook file in the
    meantime.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用Google Cloud Console网页界面配置了我们的第一个笔记本实例。然后，我们使用这个新实例开发了一个简单的线性回归模型，同时在笔记本文件中交替使用代码块和描述性单元格。
- en: Finally, we executed all the steps in the notebook and visualized the results
    directly in its web interface.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们在笔记本中执行了所有步骤，并在其网页界面中直接可视化结果。
- en: In the next chapter, we'll learn how to invoke TensorFlow models directly from
    BigQuery using BigQuery ML.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何使用BigQuery ML直接从BigQuery调用TensorFlow模型。
- en: Further resources
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多资源
- en: '**NYC Bike Sharing public dataset**: [https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike](https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike
    )'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**纽约自行车共享公共数据集**：[https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike](https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike)'
- en: '**BigQuery ML create model**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create
    )'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML创建模型**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create)'
- en: '**BigQuery ML evaluate model**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate
    )'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML评估模型**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate)'
- en: '**BigQuery ML PREDICT**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict
    )'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML PREDICT**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict)'
- en: '**BigQuery ML linear regression example**: [https://cloud.google.com/bigquery-ml/docs/bigqueryml-natality](https://cloud.google.com/bigquery-ml/docs/bigqueryml-natality)'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML线性回归示例**：[https://cloud.google.com/bigquery-ml/docs/bigqueryml-natality](https://cloud.google.com/bigquery-ml/docs/bigqueryml-natality)'
- en: '**Jupyter Notebooks best practices**: [https://cloud.google.com/blog/products/ai-machine-learning/best-practices-that-can-improve-the-life-of-any-developer-using-jupyter-notebooks](https://cloud.google.com/blog/products/ai-machine-learning/best-practices-that-can-improve-the-life-of-any-developer-using-jupyter-notebooks)'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Jupyter Notebooks最佳实践**: [https://cloud.google.com/blog/products/ai-machine-learning/best-practices-that-can-improve-the-life-of-any-developer-using-jupyter-notebooks](https://cloud.google.com/blog/products/ai-machine-learning/best-practices-that-can-improve-the-life-of-any-developer-using-jupyter-notebooks)'
- en: '**Prototyping models in AI Platform**: [https://codelabs.developers.google.com/codelabs/prototyping-caip-notebooks/#0](https://codelabs.developers.google.com/codelabs/prototyping-caip-notebooks/#0)'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在AI平台上原型设计模型**: [https://codelabs.developers.google.com/codelabs/prototyping-caip-notebooks/#0](https://codelabs.developers.google.com/codelabs/prototyping-caip-notebooks/#0)'
