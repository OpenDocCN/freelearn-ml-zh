- en: '*Chapter 11*: Implementing Deep Neural Networks'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第11章*：实现深度神经网络'
- en: '**Deep Neural Networks** (**DNNs**) are one of the most advanced techniques
    to implement machine learning algorithms. They''re widely used for different use
    cases and can be considered pervasive in everyday life.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**深度神经网络**（**DNNs**）是实现机器学习算法的最先进技术之一。它们在多种用例中广泛使用，并且可以被认为是日常生活中无处不在的。'
- en: When we interact with a virtual assistant, or we use mobile applications for
    automatic translation and image recognition, we're leveraging the capabilities
    of DNNs trained with large datasets of audio and images.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们与虚拟助手互动，或使用移动应用程序进行自动翻译和图像识别时，我们正在利用使用大量音频和图像数据集训练的深度神经网络（DNNs）的能力。
- en: After reading this chapter, you'll be able to develop, evaluate, and test a
    DNN using BigQuery ML. In this chapter, we'll see all the stages necessary to
    implement a DNN by using BigQuery ML to predict the duration of rentals related
    to the New York City bike-sharing service.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读本章后，您将能够使用BigQuery ML开发、评估和测试一个DNN。在本章中，我们将看到使用BigQuery ML通过预测与纽约市自行车共享服务相关的租赁时长来实施DNN的所有必要阶段。
- en: 'Using BigQuery ML, we''ll go through the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 使用BigQuery ML，我们将探讨以下主题：
- en: Introducing the business scenario
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍商业场景
- en: Discovering DNNs
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现DNNs
- en: Preparing the dataset
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备数据集
- en: Training the DNN models
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 训练DNN模型
- en: Evaluating the DNN models
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估DNN模型
- en: Using the DNN models
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用DNN模型
- en: Drawing business conclusions
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提取业务结论
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'This chapter requires you to have access to a web browser and to be able to
    leverage the following:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本章要求您能够访问网络浏览器，并能够利用以下内容：
- en: A GCP account to access Google Cloud Console
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个GCP账户以访问Google Cloud Console
- en: A GCP project to host the BigQuery datasets
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个GCP项目来托管BigQuery数据集
- en: Now that we're ready with the technical requirements, let's dive into the analysis
    and development of our BigQuery ML DNN models.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好了技术要求，让我们深入分析和发展我们的BigQuery ML DNN模型。
- en: 'Check out the following video to see the Code in Action: [https://bit.ly/33lbq8A](https://bit.ly/33lbq8A)'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下视频以查看代码的实际应用：[https://bit.ly/33lbq8A](https://bit.ly/33lbq8A)
- en: Introducing the business scenario
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍商业场景
- en: In this section, you'll be introduced to the business scenario that will be
    handled with the DNNs technique.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将了解到将使用DNN技术处理的商业场景。
- en: The business scenario is very similar to the use case presented and used in
    [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting Numerical
    Values with Linear Regression*. In this chapter, we'll use the same dataset related
    to the New York City bike-sharing service, but we'll apply more advanced machine
    learning algorithms.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 商业场景与在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中介绍和使用的用例非常相似，即*使用线性回归预测数值*。在这一章中，我们将使用与纽约市自行车共享服务相关的相同数据集，但我们将应用更先进的机器学习算法。
- en: We can remember that the hypothetical goal of the ML model is to predict the
    trip time of a bike rental. The predicted value could be used to provide a better
    experience to the customers of the bike-sharing service through the new mobile
    application. Leveraging the predicted ride duration, the customer will get a clear
    indication of the time it will take to reach a specific destination and also an
    estimation of the ride cost.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以记住，机器学习模型的假设目标是预测自行车租赁的行程时间。预测值可以用于通过新的移动应用程序为自行车共享服务的客户提供更好的体验。利用预测的骑行时长，客户将得到到达特定目的地所需时间的明确指示，以及骑行成本的估计。
- en: Now that we've explained and understood the business scenario, let's take a
    look at the machine learning technique that we can use to automatically classify
    trees according to their features.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经解释并理解了商业场景，让我们来看看我们可以使用的机器学习技术，以自动根据特征对树木进行分类。
- en: Discovering DNNs
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发现DNNs
- en: In this section, we'll learn what **DNNs** are, and we'll understand which regression
    and classification use cases can be managed with advanced machine learning algorithms.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习什么是**DNNs**，并了解哪些回归和分类用例可以使用高级机器学习算法来管理。
- en: '**Artificial Neural Networks** (**ANNs**) are artificial systems that try to
    reproduce the human brain. They''re inspired by biological neural networks and
    are composed of neurons and synapses that connect the neurons. Each neuron of
    the artificial network is a component that applies a specific mathematical activation
    function to the input and returns an output that is passed through a synapse to
    the next neuron. In ANNs, the neurons are usually organized in layers between
    the input and the output.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**人工神经网络**（**ANNs**）是试图复制人脑的人工系统。它们受到生物神经网络的启发，由神经元和连接神经元的突触组成。人工网络中的每个神经元都是一个组件，它对输入应用特定的数学激活函数，并返回一个通过突触传递给下一个神经元的输出。在ANNs中，神经元通常组织在输入和输出之间的层中。'
- en: Different from linear models, ANNs are designed to model non-linear relationships
    between the input and the output variables.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 与线性模型不同，ANNs旨在模拟输入和输出变量之间的非线性关系。
- en: '**DNNs** are ANNs composed of multiple layers between the input and the output,
    usually two or more. Each layer of neurons is called a **hidden layer** and its
    function is to accept a series of input signals and return to the next layer a
    series of output signals.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**DNNs**是由多个层组成的ANNs，这些层位于输入和输出之间，通常是两层或更多。每个神经元的层被称为**隐藏层**，其功能是接受一系列输入信号，并将一系列输出信号返回给下一层。'
- en: 'In the following diagram, we can see that a DNN is composed of three input
    variables, two hidden layers, and an output variable:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下图中，我们可以看到DNN由三个输入变量、两个隐藏层和一个输出变量组成：
- en: '![Figure 11.1 – Diagram of a DNN'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.1 – DNN的示意图'
- en: '](img/B16722_11_001.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B16722_11_001.jpg]'
- en: Figure 11.1 – Diagram of a DNN
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.1 – DNN的示意图
- en: Each neuron in the network applies a specific function to the input signal and
    returns the output of the function as the output of the neuron. Training a DNN
    is an activity focused on finding the right weights of each synapse between each
    neuron in the network.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 网络中的每个神经元都对输入信号应用特定的函数，并将该函数的输出作为神经元的输出。训练DNN是一项专注于找到网络中每个神经元之间每个突触的正确权重的活动。
- en: 'Although, to achieve the potential of DNNs we need important hardware resources,
    the machine learning models implemented with this technique can achieve optimal
    results in important tasks that are typical of the human brain. Some examples
    are as follows:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，为了实现DNNs的潜力，我们需要重要的硬件资源，但使用这种技术实现的机器学习模型可以在典型的人脑任务中实现最佳结果。以下是一些例子：
- en: '**Speech recognition**: The ability to process an audio file to identify the
    words of a speech, making them readable. This capability is widely used in the
    virtual assistants of our smartphones or in contact center applications.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**语音识别**：处理音频文件以识别语音中的单词，使其可读的能力。这种能力在智能手机的虚拟助手或接触中心应用程序中得到广泛应用。'
- en: '**Image and face recognition**: The possibility to recognize different entities,
    animals, or persons in pictures and videos. This technique is particularly useful
    to automatically extract insights from images and videos avoiding any manual effort.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**图像和面部识别**：在图片和视频中识别不同实体、动物或人物的可能性。这项技术特别有用，可以自动从图像和视频中提取见解，避免任何人工努力。'
- en: '**Natural language processing**: Widely used to analyze and retrieve information
    from free texts and to analyze the sentiment of the messages. For example, these
    kinds of algorithms are used to automatically identify the policy violations in
    the social networks or to evaluate the sentiment in the product reviews.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自然语言处理**：广泛用于分析和检索自由文本中的信息，以及分析消息的情感。例如，这类算法被用于自动识别社交网络中的政策违规，或在产品评论中评估情感。'
- en: Now that we've discovered what DNNs are, let's focus on how BigQuery ML offers
    these powerful algorithms.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经了解了DNNs是什么，让我们关注BigQuery ML如何提供这些强大的算法。
- en: DNNs in BigQuery ML
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: BigQuery ML中的DNNs
- en: In this section, we'll learn the model type options provided by BigQuery ML
    to create a DNN model.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习BigQuery ML提供的创建DNN模型模型类型选项。
- en: 'BigQuery ML allows you to create two different types of DNNs:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: BigQuery ML 允许您创建两种不同类型的深度神经网络（DNNs）：
- en: '**DNNClassifier**: This algorithm can be used to classify events, objects,
    or entities into a finite number of discrete classes.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNNClassifier**：此算法可用于将事件、对象或实体分类到有限数量的离散类别中。'
- en: '**DNNRegressor**: This kind of model is similar to the previous one with the
    difference that it returns a continuous result. For this reason, it can be used
    to predict numerical values.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNNRegressor**：这种模型与之前的模型类似，区别在于它返回一个连续的结果。因此，它可以用来预测数值。'
- en: 'For our business scenario, we''ll use **DNNRegressor** because our goal is
    to predict a continuous value: *the ride time of the bike rental*.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的业务场景，我们将使用**DNNRegressor**，因为我们的目标是预测一个连续值：*自行车租赁的骑行时间*。
- en: 'When we''ve chosen which type of DNN to use according to our use case, the
    next choice will be focused on the function that each neuron will apply to the
    input signal. BigQuery ML allows us to choose one of the following functions:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的用例选择了要使用的DNN类型后，下一个选择将集中在每个神经元将应用于输入信号的功能。BigQuery ML允许我们选择以下函数之一：
- en: '**Rectified Linear Function** (**ReLU**): This is a linear function that returns
    the input value itself if it''s positive, otherwise zero.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Rectified Linear Function** (**ReLU**)：这是一个线性函数，如果输入值是正的，则返回输入值本身，否则返回零。'
- en: '**ReLU6**: This is similar to the previous function with a capped maximum output
    value of 6\. This is just an arbitrary value that derives from empirical tests
    of the different functions.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ReLU6**：这与之前的函数类似，但最大输出值被限制为6。这只是一个从不同函数的经验测试中得出的任意值。'
- en: '**Concatenated Rectified Linear Units** (**CReLU**): Different from the previous
    functions, it preserves the negative values.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Concatenated Rectified Linear Units** (**CReLU**)：与之前的函数不同，它保留了负值。'
- en: '**Exponential Linear Unit** (**ELU**): This is an exponential function that
    tends to converge to the result faster and produce outputs with more accuracy.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Exponential Linear Unit** (**ELU**)：这是一个指数函数，它倾向于更快地收敛到结果并产生更精确的输出。'
- en: '**Scaled Exponential Linear Unit** (**SELU**): This is an evolution of ELU
    that adds the self-normalization of the math function.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Scaled Exponential Linear Unit** (**SELU**)：这是ELU的演变，它添加了数学函数的自我归一化。'
- en: '**SIGMOID**: This is similar to a step function and always outputs a value
    between 0 and 1\. This function introduces non-linearity into the DNN.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SIGMOID**：这与一个阶梯函数类似，始终输出介于0和1之间的值。这个函数将非线性引入DNN。'
- en: '**TANH**: This is similar to the sigmoid function but returns a value between
    -1 and 1.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TANH**：这与sigmoid函数类似，但返回的值介于-1和1之间。'
- en: Each function has some pros and cons, and they should be chosen according to
    the use case and to the training dataset to achieve the best results. For our
    business scenario, we'll experiment with the training of DNNs using some of these
    functions and choose the function that produces the best results.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 每个函数都有一些优点和缺点，并且应根据用例和训练数据集来选择，以实现最佳结果。对于我们的业务场景，我们将尝试使用这些函数中的一些来训练DNN，并选择产生最佳结果的函数。
- en: Now that we've learned the basics of DNNs and the main options that BigQuery
    ML offers through its SQL interface, let's start preparing the data for the creation
    of our machine learning models.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经学习了DNN的基础知识和BigQuery ML通过其SQL界面提供的主要选项，让我们开始准备创建我们的机器学习模型所需的数据。
- en: Preparing the dataset
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备数据集
- en: Before starting the ML implementation, it's necessary to analyze and prepare
    the data for our use case. Since the dataset has been already used in [*Chapter
    4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting Numerical Values
    with Linear Regression*, we will not start the analysis from the beginning, but
    we will focus exclusively on the queries relevant for our use case.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始ML实现之前，有必要分析和准备我们用例的数据。由于数据集已经在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中使用了，*使用线性回归预测数值*，我们将不会从头开始分析，但我们将专注于与我们用例相关的查询。
- en: 'To start the preparation of our data, we need to do the following:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 开始准备我们的数据，我们需要做以下事情：
- en: Log into Google Cloud Console and access the **BigQuery** user interface from
    the navigation menu.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录Google Cloud控制台，并通过导航菜单访问**BigQuery**用户界面。
- en: Create a new dataset under the project that we created in [*Chapter 2*](B16722_02_Final_ASB_ePub.xhtml#_idTextAnchor039),
    *Setting Up Your GCP and BigQuery Environment*. For this use case, we'll create
    the dataset `11_nyc_bike_sharing_dnn` with the default options.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[*第2章*](B16722_02_Final_ASB_ePub.xhtml#_idTextAnchor039)中创建的项目下创建一个新的数据集，*设置您的GCP和BigQuery环境*。对于这个用例，我们将使用默认选项创建数据集`11_nyc_bike_sharing_dnn`。
- en: 'Now we''re ready to create the table that will contain the training dataset.
    Let''s execute the following SQL statement:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们已经准备好创建包含训练数据集的表。让我们执行以下SQL语句：
- en: '[PRE0]'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The result of the query is stored in the new table, `` `11_nyc_bike_sharing_dnn.training_table`
    ``, which we've created to support the following steps of our use case.
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 查询结果存储在新创建的表中，名为 `` `11_nyc_bike_sharing_dnn.training_table` ``，我们创建此表是为了支持我们用例的以下步骤。
- en: The `SELECT` statement extracts the fields from the table `citibike_trips` and
    applies some transformations. `tripduration` is converted from seconds to minutes.
    The fields `start_station_name` and `end_station_name` are extracted as is. Using
    `starttime`, the query calculates whether the rental is happening during the week
    or at the weekend. Finally, the age of the customer at the time of the ride is
    calculated using the difference between `starttime` and `birth_year`.
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SELECT` 语句从 `citibike_trips` 表中提取字段并应用一些转换。`tripduration` 从秒转换为分钟。`start_station_name`
    和 `end_station_name` 字段直接提取。使用 `starttime`，查询计算租赁是否发生在工作日或周末。最后，使用 `starttime`
    和 `birth_year` 之间的差值计算顾客在骑行时的年龄。'
- en: As we've already done in the [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*, the `WHERE` clause allows
    us to consider only the months that we want to use for the training stage. The
    time frame goes from April 2017 to February 2018 for the training dataset. In
    the same `WHERE` clause, we've also applied the filters that come from the data
    quality checks.
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 正如我们在 [*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061) 中所做的那样，*使用线性回归预测数值值*，`WHERE`
    子句允许我们仅考虑我们想要用于训练阶段的月份。对于训练数据集，时间范围从2017年4月到2018年2月。在相同的 `WHERE` 子句中，我们还应用了来自数据质量检查的过滤器。
- en: 'After the creation of the training table, we can create the second table dedicated
    to the records that will be used to evaluate our machine learning model:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在创建训练表之后，我们可以创建第二个表，专门用于记录将用于评估我们的机器学习模型的：
- en: '[PRE1]'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The query is very similar to the statement used to create the training table.
    The only difference is related to the period selected in the `WHERE` clause. For
    the table `` `11_nyc_bike_sharing_dnn.evaluation_table` ``, we've focused our
    `SELECT` statement on the records related to the months of March and April of
    2018 that were previously excluded from the training table.
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 查询与用于创建训练表的语句非常相似。唯一的区别是 `WHERE` 子句中选择的时期。对于 `` `11_nyc_bike_sharing_dnn.evaluation_table`
    `` 表，我们专注于之前从训练表中排除的2018年3月和4月的记录。
- en: 'Adopting the same approach, we can also create the table that will be used
    to test our machine learning model:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 采用相同的方法，我们也可以创建用于测试我们的机器学习模型的表：
- en: '[PRE2]'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The query applies the same logic used to create the training and the evaluation
    table but takes into consideration only the month of May 2018.
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 查询应用了创建训练和评估表时使用的相同逻辑，但仅考虑了2018年5月的月份。
- en: Now that we've segmented our dataset and are clear on which records to use for
    the training, evaluation, and test phase, let's train our DNN models with BigQuery
    ML.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经分割了数据集，并且明确了用于训练、评估和测试阶段的记录，让我们使用 BigQuery ML 训练我们的 DNN 模型。
- en: Training the DNN models
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 训练 DNN 模型
- en: 'Now that we''ve segmented the dataset into multiple tables to support the different
    stages of the ML model life cycle, let''s train our DNN regression models using
    different activation functions:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经将数据集分割成多个表以支持机器学习模型生命周期的不同阶段，让我们使用不同的激活函数来训练我们的深度神经网络（DNN）回归模型：
- en: 'First of all, we can start with the training of a DNN model by using the `RELU`
    function. Let''s execute the following SQL statement to create the machine learning
    model `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu` ``:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们可以通过使用 `RELU` 函数开始训练一个 DNN 模型。让我们执行以下 SQL 语句来创建机器学习模型 `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu`
    ``：
- en: '[PRE3]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In the SQL statement, we can notice the keywords `CREATE OR REPLACE MODEL` used
    to create a new model. These keywords are followed by the identifier of the model
    represented by the concatenation of the dataset and ML model name.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 SQL 语句中，我们可以注意到用于创建新模型的 `CREATE OR REPLACE MODEL` 关键字。这些关键字后面跟着由数据集和机器学习模型名称连接而成的模型标识符。
- en: After these first lines, we find the `OPTIONS` keyword where the type of machine
    learning model is specified. Since we're trying to predict the continuous field
    `tripduration`, we've chosen to use `DNN_REGRESSOR` as `model_type`.
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这些第一行之后，我们发现 `OPTIONS` 关键字，其中指定了机器学习模型类型。由于我们试图预测连续字段 `tripduration`，我们选择了使用
    `DNN_REGRESSOR` 作为 `model_type`。
- en: 'The other important option during the training of a DNN is the activation function
    that will be applied to the neurons of the network. For this first attempt, we''re
    using one of the most common functions: `RELU`. This choice is specified with
    the clause `ACTIVATION_FN = ''RELU''`.'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在训练深度神经网络（DNN）期间，另一个重要的选项是应用于网络神经元的激活函数。对于这次尝试，我们使用最常见的一种函数：`RELU`。这个选择通过`ACTIVATION_FN
    = 'RELU'`子句来指定。
- en: After `OPTIONS`, we need to specify the set of records on which the ML model
    will be trained. Since we've already identified the relevant fields in [*Chapter
    4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting Numerical Values
    with Linear Regression*, the query uses the fields `start_station_name`, `end_station_name`,
    `is_weekend`, and `age` as features of the DNN model.
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在`OPTIONS`之后，我们需要指定机器学习模型将要训练的记录集。由于我们已经在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中识别了相关字段，即使用线性回归预测数值，查询使用`start_station_name`、`end_station_name`、`is_weekend`和`age`作为DNN模型的特征。
- en: With the keywords `as label`, we are instructing BigQuery ML to use `tripduration`
    as the label of our machine learning model. As an alternative, it is possible
    to include the label among the list of `OPTIONS` with the keyword `INPUT_LABEL_COLS`.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用关键词`as label`，我们指示BigQuery ML将`tripduration`作为我们机器学习模型的标签。作为替代，我们可以在包含关键词`INPUT_LABEL_COLS`的`OPTIONS`列表中包含标签。
- en: Since DNNs are advanced and complex models, it can take several minutes before
    converging to the solution and generating the machine learning model.
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 由于DNN是高级且复杂的模型，在收敛到解决方案并生成机器学习模型之前可能需要几分钟。
- en: At the end of the execution of the SQL query, we can select the DNN model `trip_duration_by_stations_day_age_relu`
    in the BigQuery navigation menu and click on the `tripduration`.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在SQL查询执行结束时，我们可以在BigQuery导航菜单中选择`trip_duration_by_stations_day_age_relu` DNN模型，并点击`tripduration`。
- en: 'As you can see in the following screenshot, the **Mean absolute error** is
    very close to 4 minutes:'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如以下截图所示，**平均绝对误差**非常接近4分钟：
- en: '![Figure 11.2 – The Evaluation tab shows some key performance indicators of
    the DNN model'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图11.2 – 评估选项卡显示了DNN模型的一些关键性能指标'
- en: '](img/B16722_11_002.jpg)'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16722_11_002.jpg)'
- en: Figure 11.2 – The Evaluation tab shows some key performance indicators of the
    DNN model
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图11.2 – 评估选项卡显示了DNN模型的一些关键性能指标
- en: 'As a second attempt, we can try to change the activation function in the neurons
    of our neural network to see if the performance of the first model can be further
    improved. Let''s run the following SQL statement using the `CRELU` activation
    function:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为第二次尝试，我们可以尝试更改神经网络中的激活函数，看看是否可以进一步提高第一个模型的表现。让我们使用`CRELU`激活函数运行以下SQL语句：
- en: '[PRE4]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The query to train the DNN `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`
    `` is very similar to the SQL statement that we used in our first attempt. The
    only difference is represented by the different activation function specified
    in `OPTIONS`. Using the clause `ACTIVATION_FN = 'CRELU'`, we're using the `CRELU`
    function in the neurons of the network.
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 训练DNN的查询`11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`与我们第一次尝试中使用的SQL语句非常相似。唯一的区别在于`OPTIONS`中指定的不同激活函数。使用`ACTIVATION_FN
    = 'CRELU'`子句，我们在网络神经元中使用`CRELU`函数。
- en: The execution of the training query will take several minutes to complete.
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 训练查询的执行将需要几分钟才能完成。
- en: At the end of the execution of the SQL query, we can select the DNN model `trip_duration_by_stations_day_age_crelu`
    in the BigQuery navigation menu and visualize the performance in the **Evaluation**
    tab.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在SQL查询执行结束时，我们可以在BigQuery导航菜单中选择`trip_duration_by_stations_day_age_crelu` DNN模型，并在**评估**选项卡中可视化性能。
- en: 'As you can see in the following screenshot, the **Mean absolute error** is
    almost close to 4 minutes:'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如以下截图所示，**平均绝对误差**几乎接近4分钟：
- en: '![Figure 11.3 – The Evaluation tab shows some key performance indicators of
    the DNN model'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.3 – 评估选项卡显示了DNN模型的一些关键性能指标'
- en: '](img/B16722_11_003.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16722_11_003.jpg)'
- en: Figure 11.3 – The Evaluation tab shows some key performance indicators of the
    DNN model
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.3 – 评估选项卡显示了DNN模型的一些关键性能指标
- en: Now, let's start the evaluation of the DNNs that we've trained in this section.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们开始评估在本节中训练的DNN。
- en: Evaluating the DNN models
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估DNN模型
- en: 'To evaluate our BigQuery ML DNNs, we''ll use the `ML.EVALUATE` function and
    the table that we''ve expressly created as an evaluation dataset:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估我们的 BigQuery ML DNNs，我们将使用 `ML.EVALUATE` 函数以及我们专门创建的作为评估数据集的表格：
- en: 'First of all, we can start evaluating the model `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu`
    ``. Let''s run the following query:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们可以开始评估模型 `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu`
    ``。让我们运行以下查询：
- en: '[PRE5]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'In the SQL statement, we can notice the keyword `ML.EVALUATE` is used to evaluate
    the DNN. The evaluation function is followed by the identifier of the BigQuery
    ML model: `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu`
    ``.'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 SQL 语句中，我们可以注意到使用了关键字 `ML.EVALUATE` 来评估 DNN。评估函数后面跟着 BigQuery ML 模型的标识符：``
    `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_relu` ``。
- en: 'The evaluation function is applied on the `SELECT` statement that extracts
    all the fields from the table: `` `11_nyc_bike_sharing_dnn.evaluation_table` ``.'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 评估函数应用于提取表 `` `11_nyc_bike_sharing_dnn.evaluation_table` `` 中所有字段的 `SELECT`
    语句。
- en: 'After some seconds, we can see the results of the evaluation stage as shown
    in the following screenshot:'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 几秒钟后，我们可以看到以下截图所示的评估阶段的结果：
- en: '![Figure 11.4 – The results of the evaluation SQL statement'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 11.4 – 评估 SQL 语句的结果'
- en: '](img/B16722_11_004.jpg)'
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16722_11_004.jpg)'
- en: Figure 11.4 – The results of the evaluation SQL statement
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.4 – 评估 SQL 语句的结果
- en: We can notice that the **mean_absolute_error** value is not so different from
    the value that we've achieved during the training phase. We can say that our model
    is not affected by overfitting and works well on the new records of the evaluation
    dataset.
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们可以注意到 **平均绝对误差** 值与我们训练阶段达到的值并没有太大的不同。我们可以说，我们的模型没有受到过拟合的影响，并且在评估数据集的新记录上表现良好。
- en: 'Let''s apply the same evaluation logic on the second model, `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`
    ``. To evaluate the performance of this BigQuery ML model, we run the following
    SQL statement:'
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在第二个模型 `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`
    `` 上应用相同的评估逻辑。为了评估这个 BigQuery ML 模型的性能，我们运行以下 SQL 语句：
- en: '[PRE6]'
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The only difference between the last query and the previous one is in the name
    of the DNN that is subject to the evaluation: `` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`
    ``.'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最后一个查询与上一个查询的唯一区别在于受评估的 DNN 的名称：`` `11_nyc_bike_sharing_dnn.trip_duration_by_stations_day_age_crelu`
    ``。
- en: 'After some seconds, we''ll see the results of the evaluation as presented in
    the following screenshot:'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 几秒钟后，我们将看到以下截图所示的评估结果：
- en: '![Figure 11.5 – The results of the evaluation SQL statement'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.5 – 评估 SQL 语句的结果'
- en: '](img/B16722_11_005.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16722_11_005.jpg)'
- en: Figure 11.5 – The results of the evaluation SQL statement
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.5 – 评估 SQL 语句的结果
- en: Also, in this case, the **mean_absolute_error** value is not far from the value
    of 4 minutes that we achieved during the training stage. This model is not affected
    by overfitting and works similar to the previous one.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在这种情况下，**平均绝对误差** 值与我们训练阶段达到的 4 分钟值相差不远。这个模型没有受到过拟合的影响，并且与之前的模型相似。
- en: Now that we've evaluated our BigQuery ML models, let's see how we can use the
    DNN based on the `ReLU` activation function to get predictions about the duration
    of the bike rentals.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经评估了我们的 BigQuery ML 模型，让我们看看如何使用基于 `ReLU` 激活函数的 DNN 来预测自行车租赁的持续时间。
- en: Using the DNN models
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 DNN 模型
- en: In this section, we'll use the DNN model based on the `ReLU` function and trained
    to leverage the BigQuery ML capabilities to predict the duration of the bike rides
    for the New York City bike-sharing company.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用基于 `ReLU` 函数的 DNN 模型，并训练它利用 BigQuery ML 功能来预测纽约市自行车共享公司的骑行持续时间。
- en: 'To test our DNN, we''ll use the `ML.PREDICT` function on the table `prediction_table`.
    Let''s run the following SQL statement:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试我们的 DNN，我们将在 `prediction_table` 表上使用 `ML.PREDICT` 函数。让我们运行以下 SQL 语句：
- en: '[PRE7]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The query statement is composed of a `SELECT` keyword that extracts the actual
    and the predicted duration of the rental. It calculates the difference in minutes
    and orders the results from the minimum to the maximum difference of minutes.
    To calculate the difference, we've used the `ABS` function that extracts the absolute
    value of a numeric.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 查询语句由一个 `SELECT` 关键字组成，它提取了租赁的实际和预测持续时间。它计算了分钟数的差异，并按分钟数的最小差异到最大差异排序。为了计算差异，我们使用了
    `ABS` 函数，该函数提取了数字的绝对值。
- en: The `ML.PREDICT` function is applied to the `SELECT` statement, which extracts
    the features and the actual duration from `prediction_table`. This last field
    is used only for comparison with the predicted value and is not used by the DNN
    to return the prediction.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '`ML.PREDICT` 函数应用于 `SELECT` 语句，该语句从 `prediction_table` 中提取特征和实际持续时间。这个最后字段仅用于与预测值进行比较，并且不用于
    DNN 返回预测。'
- en: 'In the following screenshot, you can see the results of the query execution:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下屏幕截图，你可以看到查询执行的结果：
- en: '![Figure 11.6 – The output of the query shows the actual and the predicted
    label'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.6 – 查询输出显示了实际和预测标签'
- en: with the difference expressed in minutes
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 差异以分钟表示
- en: '](img/B16722_11_006.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16722_11_006.jpg)'
- en: Figure 11.6 – The output of the query shows the actual and the predicted label
    with the difference expressed in minutes
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.6 – 查询输出显示了实际和预测标签，差异以分钟表示
- en: Now that we've tested our BigQuery ML model, let's look at some final considerations
    comparing the results of the DNN based on the `CReLU` activation function with
    the results that we achieved using linear regression in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经测试了我们的 BigQuery ML 模型，让我们来看看一些最终的考虑因素，比较基于 `CReLU` 激活函数的 DNN 结果与我们在 [*第
    4 章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061) 中使用线性回归所取得的结果，*使用线性回归预测数值值*。
- en: Drawing business conclusions
  id: totrans-128
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 提炼商业结论
- en: In this section, we'll apply our DNN model and understand how many times the
    BigQuery ML model is able to predict a rental duration close to the actual one.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将应用我们的 DNN 模型，并了解 BigQuery ML 模型能够预测接近实际租赁持续时间的次数。
- en: We'll add a parent `SELECT COUNT` statement to the previous query to count how
    many times the difference between the actual duration and the predicted one is
    less than `15` minutes.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在之前的查询中添加一个父 `SELECT COUNT` 语句，以计算实际持续时间与预测值之间的差异小于 `15` 分钟的次数。
- en: 'Let''s execute the following query to calculate how often the trip duration
    predictions are far from the actual values:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们执行以下查询来计算预测的行程持续时间与实际值相差较远的情况发生的频率：
- en: '[PRE8]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The result of the `SELECT COUNT` query returns a value of 1,640,446 predictions
    with a difference between the predicted and the actual value of less than `15`
    minutes.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '`SELECT COUNT` 查询的结果返回了 1,640,446 个预测值，预测值与实际值之间的差异小于 `15` 分钟。'
- en: Considering that the total size of the table `prediction_table` is 1,728,078,
    we can say that in 94.92% of the cases our DNN is able to predict the trip duration
    with a difference less than 15 minutes.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到 `prediction_table` 表的总大小为 1,728,078，我们可以说在 94.92% 的情况下，我们的 DNN 能够预测行程持续时间，差异小于
    15 分钟。
- en: Now we can compare the best results that we've achieved with the DNN with the
    performance that we've reached using the linear regression model in [*Chapter
    4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061), *Predicting Numerical Values
    with Linear Regression*.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以将我们用 DNN 达到的最佳结果与我们在 [*第 4 章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)
    中使用线性回归模型所达到的性能进行比较，*使用线性回归预测数值值*。
- en: Deep neural networks versus linear models
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 深度神经网络与线性模型
- en: 'In the following table, the results of the DNN model based on the `CReLU` activation
    function are compared to the linear regression model:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下表格中，基于 `CReLU` 激活函数的 DNN 模型的结果与线性回归模型进行了比较：
- en: '![Figure 11.7 – Comparison between the DNN model and the linear regression
    model'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.7 – DNN 模型与线性回归模型的比较'
- en: '](img/B16722_11_007.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16722_11_007.jpg)'
- en: Figure 11.7 – Comparison between the DNN model and the linear regression model
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.7 – DNN 模型与线性回归模型的比较
- en: Looking at the preceding table, we can say that to predict the trip duration
    of the New York City bike-sharing service, the best results can be achieved using
    a DNN model. For this reason, we can suggest using a DNN model to suggest the
    trip duration to the customers of the company. Using the DNN we can decrease the
    mean absolute error by more than 43%. In some industries, such an improvement
    could be a great competitive advantage for the company.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查看前面的表格，我们可以得出结论，为了预测纽约市自行车共享服务的行程持续时间，使用 DNN 模型可以获得最佳结果。因此，我们可以建议使用 DNN 模型向公司的客户提供行程持续时间建议。使用
    DNN，我们可以将平均绝对误差降低超过 43%。在某些行业中，这样的改进可能为公司带来巨大的竞争优势。
- en: Summary
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we've implemented two DNNs. We remembered the business scenario
    that was already introduced in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*. The use case was based on
    the need to predict the rental time for the New York City bike-sharing service.
    After that, we learned the basics of DNNs and the different activation functions
    that can be used to implement the neurons in a network.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们实现了两个DNN。我们回顾了在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中已经介绍过的业务场景，即*使用线性回归预测数值*。用例基于预测纽约市自行车共享服务的租赁时间的需求。之后，我们学习了DNN的基础知识以及可以用于实现网络中神经元的各种激活函数。
- en: 'We segmented the BigQuery public dataset into three different tables: one to
    host training data, the second one for the evaluation stage, and the last one
    to test our DNN model.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将BigQuery公共数据集分割成三个不同的表：一个用于存放训练数据，第二个用于评估阶段，最后一个用于测试我们的DNN模型。
- en: During the training phase of the BigQuery ML model, we tested two different
    activation functions, `ReLU` and `CReLU`, comparing the mean absolute error to
    find the best one.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在BigQuery ML模型的训练阶段，我们测试了两种不同的激活函数，`ReLU`和`CReLU`，通过比较平均绝对误差来找到最佳的一个。
- en: After that, we evaluated our DNN models on a new set of records to prevent any
    overfitting and get more confident about the good quality of our BigQuery ML models.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我们在一组新的记录上评估了我们的深度神经网络（DNN）模型，以防止过拟合，并对我们BigQuery ML模型的高质量更有信心。
- en: Finally, we applied the model, based on the `ReLU` function, to the last subset
    of records to predict the trip duration of each bike rental. We discovered that
    our BigQuery ML model is able to predict a trip duration within a range of 15
    minutes of the actual one for more than 94% of the rentals.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将基于`ReLU`函数的模型应用于最后一批记录，以预测每辆自行车租赁的行程时长。我们发现我们的BigQuery ML模型能够预测超过94%的租赁的行程时长，其预测值与实际行程时长相差不超过15分钟。
- en: Finally, we also compared the performance of the DNN model with the linear regression
    outcomes achieved in [*Chapter 4*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061),
    *Predicting Numerical Values with Linear Regression*. We noticed that the DNN
    outperforms linear regression, decreasing the mean absolute error by 43%, and
    can achieve better results for our business scenario.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们还比较了DNN模型与在[*第4章*](B16722_04_Final_ASB_ePub.xhtml#_idTextAnchor061)中实现的线性回归结果。我们注意到DNN优于线性回归，将平均绝对误差降低了43%，并且能够为我们业务场景实现更好的结果。
- en: In the next chapter, we'll learn how to use BigQuery ML with GCP AI notebooks.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何使用BigQuery ML与GCP AI笔记本结合使用。
- en: Further resources
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步资源
- en: '**NYC Bike-Sharing Public Dataset**: [https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike](https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike)'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**纽约市自行车共享公共数据集**：[https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike](https://console.cloud.google.com/marketplace/product/city-of-new-york/nyc-citi-bike)'
- en: '**BigQuery ML Create Model**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-dnn-models](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-dnn-models)'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML创建模型**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-dnn-models](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-dnn-models)'
- en: '**BigQuery ML Evaluate Model**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate)'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML评估模型**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate)'
- en: '**BigQuery ML Predict**: [https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict)'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BigQuery ML预测**：[https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict](https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict)'
