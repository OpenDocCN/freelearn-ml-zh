- en: Scalable Computing for Data Science
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据科学可扩展计算
- en: In this chapter, we will learn how to use Azure in data science. We are going
    to look at how to prepare data, which includes cleaning and transforming it, creating
    engineering features, creating and training a machine learning model, and finally,
    making predictions using the machine learning model.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何使用 Azure 进行数据科学。我们将探讨如何准备数据，包括清洗和转换数据，创建工程特征，创建和训练机器学习模型，最后，使用机器学习模型进行预测。
- en: To build a machine learning algorithm with big data, we need to process a lot
    of data to train it. To do this, we need a lot of computing power. We also need
    the compute to be able to scale dynamically based on the load to serve these machine
    learning models at scale so that they can perform predictions.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 要构建大数据机器学习算法，我们需要处理大量数据来训练它。为此，我们需要大量的计算能力。我们还需要计算能力能够根据负载动态扩展，以便大规模地提供这些机器学习模型，以便它们可以执行预测。
- en: In the era before public clouds, we had to buy all of our hardware beforehand.
    We had to pay for it all, ...
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在公有云出现之前的时代，我们必须事先购买所有硬件。我们必须为所有这些硬件付费，...
- en: Different scalable compute options in Azure
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 中的不同可扩展计算选项
- en: 'There are two types of scaling possible in Azure to help us scale our CPUs
    and/or GPUs:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Azure 中，我们可以进行两种类型的扩展，以帮助我们扩展我们的 CPU 和/或 GPU：
- en: '**Vertical scaling**: Increasing the number of CPU cores and the memory of
    the VM.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**垂直扩展**：增加虚拟机的 CPU 内核和内存数量。'
- en: '**Horizontal scaling**: Increasing the number of VMs in the cluster, while
    keeping the CPU cores and the memory the same in each virtual machine. When we
    use horizontal scaling, we may have to write additional code to perform parallel
    or distributed computing using a supported framework.'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**水平扩展**：在集群中增加虚拟机的数量，同时保持每个虚拟机中的 CPU 内核和内存不变。当我们使用水平扩展时，我们可能需要编写额外的代码来使用支持的框架执行并行或分布式计算。'
- en: Introduction to DSVMs
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DSVMs 简介
- en: A DSVM is a Linux or Windows container that is made up of popular data science
    tools and frameworks. It can help us quickly get started with data analytics and
    data science. It supports a number of OSes; currently, we can create a DSVM with
    Windows 2012, Windows 2016, Ubuntu Linux, and CentOS Linux. The idea behind DSVMs
    is to decrease the time it takes to create a working environment.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: DSVM 是由流行的数据科学工具和框架组成的 Linux 或 Windows 容器。它可以帮助我们快速开始数据分析和数据科学。它支持多种操作系统；目前，我们可以使用
    Windows 2012、Windows 2016、Ubuntu Linux 和 CentOS Linux 创建 DSVM。DSVM 的理念是减少创建工作环境所需的时间。
- en: A DSVM has preconfigured libraries that are tested for compatibility. It is
    updated every few months so that it uses the latest compatible version of tools,
    libraries, and frameworks. It supports GPU VMs and comes pre-installed with the
    necessary drivers. A DSVM also includes tutorials and guides on how to get started.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: DSVM 预配置了经过兼容性测试的库。它每隔几个月就会更新，以便使用工具、库和框架的最新兼容版本。它支持 GPU 虚拟机，并预装了必要的驱动程序。DSVM
    还包括有关如何开始的教程和指南。
- en: A DSVM is likely ...
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: DSVM 很可能 ...
- en: Provisioning a DSVM
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 部署 DSVM
- en: 'Let''s now go through the steps required to create a DSVM. In this example,
    we will create a Windows 2016 DSVM, but the steps are similar if you want to create
    a Linux DSVM:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们现在通过创建 DSVM 所需的步骤。在这个例子中，我们将创建一个 Windows 2016 DSVM，但如果您想创建 Linux DSVM，步骤是相似的：
- en: Go to the Azure portal at [https://portal.azure.com](https://portal.azure.com).
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请访问 Azure 门户 [https://portal.azure.com](https://portal.azure.com)。
- en: 'Click on Create a resource, and then go to AI + Machine Learning and click
    on Data Science Virtual Machine – Windows 2016:'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击创建资源，然后转到 AI + 机器学习，并点击数据科学虚拟机 – Windows 2016：
- en: '![](img/fe0efb54-7a49-44da-a69e-440cfb3b7e95.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/fe0efb54-7a49-44da-a69e-440cfb3b7e95.jpg)'
- en: 'Alternatively, we can search for `data science virtual machine` in the Azure
    portal:'
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 或者，我们可以在 Azure 门户中搜索 `数据科学虚拟机`：
- en: '![](img/4218cb20-5eae-4eb2-915c-c82d8bc1c627.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/4218cb20-5eae-4eb2-915c-c82d8bc1c627.png)'
- en: 'A window will appear that will show you some of the key characteristics of
    the DSVM that you choose:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将会弹出一个窗口，显示您选择的 DSVM 的一些关键特性：
- en: '![](img/f0bc8ff3-867a-455d-b423-edd84e394aea.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/f0bc8ff3-867a-455d-b423-edd84e394aea.png)'
- en: 'We can create a DSVM quickly by providing the necessary information. This includes
    the Resource group, the Region, a Username, and a Password:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以通过提供必要的信息快速创建 DSVM。这包括资源组、区域、用户名和密码：
- en: '![](img/05d93bb1-32ba-429e-8451-19eef79d5aa0.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/05d93bb1-32ba-429e-8451-19eef79d5aa0.png)'
- en: 'An important parameter that we need to consider is the VM SIZE. Here, we have
    the option of selecting a CPU- and/or a GPU-based VM. We have lots of options
    based on our CPU, our memory, and our networking requirements. A sample screenshot
    of different types of VMs is shown as follows:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要考虑的一个重要参数是虚拟机大小。在这里，我们有选择基于CPU和/或GPU的虚拟机的选项。根据我们的CPU、内存和网络需求，我们有大量的选项。以下是一个不同类型虚拟机的示例截图：
- en: '![](img/f8457362-aa48-4828-9035-39a5a45f70ed.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f8457362-aa48-4828-9035-39a5a45f70ed.png)'
- en: Wait for a few minutes while Azure creates our virtual machine. Once it is ready,
    we will get a notification in the portal.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在Azure创建我们的虚拟机时，请等待几分钟。一旦准备就绪，我们将在门户中收到通知。
- en: 'After our VM has been created, we can access it using RDP or SSH, depending
    on the OS. From the overview window, we can look at different metrics when our
    VM is running, such as CPU usage or disk operations. These metrics can help us
    to decide whether we need to resize our VM:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的虚拟机创建完成后，我们可以使用RDP或SSH根据操作系统访问它。从概览窗口，我们可以查看虚拟机运行时的不同指标，例如CPU使用率或磁盘操作。这些指标可以帮助我们决定是否需要调整虚拟机的大小：
- en: '![](img/e4eb6bf0-af66-452e-b22c-aa6035326594.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e4eb6bf0-af66-452e-b22c-aa6035326594.png)'
- en: 'We can also configure the VM to shut down automatically using the Auto-shutdown option
    from the portal:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以通过门户的“自动关机”选项配置虚拟机自动关机：
- en: '![](img/feac6770-f34f-4538-a661-f21d8d2d7ebe.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](img/feac6770-f34f-4538-a661-f21d8d2d7ebe.png)'
- en: After we log in to our DSVM, we can start using its tools as if it were our
    local machine. For more information about each of the tools, please refer to the
    following website: [https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/provision-vm#important-directories-on-the-vm](https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/provision-vm#important-directories-on-the-vm).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们登录到DSVM后，我们可以像使用本地机器一样开始使用其工具。有关每个工具的更多信息，请参阅以下网站：[https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/provision-vm#important-directories-on-the-vm](https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/provision-vm#important-directories-on-the-vm)。
- en: After using the VM, we can stop it from the portal to avoid paying for it unnecessarily.
    When we want to use it in the future, we can start it again without having to
    recreate it.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 使用完虚拟机后，我们可以从门户停止它，以避免不必要的费用。当我们想要在未来使用它时，我们可以再次启动它，而无需重新创建。
- en: Let's now move on to look at a variant of a DSVM – a DLVM.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来看一下DSVM的一个变体——DLVM。
- en: DLVM
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DLVM
- en: A DLVM is a special type of DSVM that has a base image that is customized for
    deep learning. We can use either Windows 2016 or Ubuntu Linux as the OS. It has
    pre-installed frameworks, tools, and tutorials to get you started quickly with
    deep learning.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: DLVM是一种特殊的DSVM，其基础镜像是为深度学习定制的。我们可以使用Windows 2016或Ubuntu Linux作为操作系统。它预装了框架、工具和教程，以便您快速开始深度学习。
- en: 'Provisioning a DLVM is similar to provisioning a DSVM. We need to select a
    GPU-based VM for a DLVM:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 配置DLVM与配置DSVM类似。我们需要为DLVM选择一个基于GPU的虚拟机：
- en: Go to the Azure portal and search for `deep learning virtual machine`. We can
    create a DLVM in the same way as we created a DSVM.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往Azure门户，搜索“深度学习虚拟机”。我们可以以创建DSVM相同的方式创建DLVM。
- en: A window will pop up, asking us to provide a name and select an OS, username,
    password, resource group, location, and so on. The next window requires us to
    select a GPU-based VM. As shown in the following screenshot, the VM sizes that
    are not available in your region ...
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 会弹出一个窗口，要求我们提供名称并选择操作系统、用户名、密码、资源组、位置等信息。下一个窗口要求我们选择基于GPU的虚拟机。如下面的截图所示，您所在地区不可用的虚拟机大小...
- en: Batch AI service
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 批量AI服务
- en: DSVMs and DLVMs are good at carrying out single node-based computing. In scenarios
    where we need to distribute training, however, we can use the Batch AI service,
    which allows us to focus on training instead of having to worry about managing
    the cluster. A Batch AI service has VMs that use the same base image as the DSVM,
    meaning that all the libraries, tools, and frameworks that are available in a
    DSVM are available in the Batch AI service as well. The Batch AI service allows
    us to use parallel training and GPU-based VMs for deep learning, and we can also
    deploy a Docker container to a Batch AI node. When using the Batch AI service,
    we can mount our Azure Blob or Azure Data Lake Storage with our cluster. This
    means that we can train with a huge amount of data without having to copy the
    data to the cluster because it can be streamed instead.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: DSVMs和DLVMs擅长执行基于单个节点的计算。然而，在我们需要分布式训练的场景中，我们可以使用批处理AI服务，这使我们能够专注于训练，而不必担心管理集群。批处理AI服务具有使用与DSVM相同基础镜像的VM，这意味着在DSVM中可用的所有库、工具和框架在批处理AI服务中也可用。批处理AI服务允许我们使用并行训练和基于GPU的VM进行深度学习，我们还可以将Docker容器部署到批处理AI节点。当使用批处理AI服务时，我们可以将我们的Azure
    Blob或Azure Data Lake Storage挂载到我们的集群。这意味着我们可以使用大量数据训练，而无需将数据复制到集群，因为它可以流式传输。
- en: At the time of writing, the Batch AI service is only available as a preview,
    so there may be new features when the service is  available generally.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，批处理AI服务仅作为预览版提供，因此当服务普遍可用时可能会有新功能。
- en: Provisioning a Batch AI service
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 部署批处理AI服务
- en: 'Let''s now proceed to create a Batch AI service:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们继续创建一个批处理AI服务：
- en: 'Go to the Azure portal at [https://portal.azure.com](https://portal.azure.com).
    Go to Create a resource and search for `batch ai`:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问Azure门户[https://portal.azure.com](https://portal.azure.com)。转到创建资源并搜索“批处理AI”：
- en: '![](img/a594316f-47c7-4cad-8995-3662c5f33d09.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a594316f-47c7-4cad-8995-3662c5f33d09.png)'
- en: In the next screen, we can create our Batch AI service.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一屏，我们可以创建我们的批处理AI服务。
- en: The screen after that asks for the name, the subscription, the resource group,
    and the location for our Batch AI service workspace. The workspace is where the
    cluster, experiments, and file server can be added.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在那之后的屏幕会要求输入我们的批处理AI服务工作区的名称、订阅、资源组和位置。工作区是添加集群、实验和文件服务的地方。
- en: The Batch AI Cluster will provide the computing power for running your experiments.
    We can provide basic information, such as the number of VMs, the VM type, the
    user account details, and the network ...
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '批处理AI集群将为运行您的实验提供计算能力。我们可以提供基本信息，例如VM数量、VM类型、用户账户详情和网络... '
- en: ACI
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ACI
- en: As a data scientist, after we have trained our machine learning model, we may
    want to deploy the model as a web service for real-time or batch scoring. When
    we train our machine learning model, we use a certain framework and libraries.
    In most cases, the same environment should be available in our deployment environment.
    Containers are a fast and simple way to create such an environment, in which we
    can host our model and dependencies. Containers can be created easily with ACI.
    As data scientists, we can use AML to deploy our machine learning model as a web
    service to an ACI. This way, we can development test our model and then deploy
    it in production. For more details on ACI, refer to the following website: [https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview](https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview).
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据科学家，在我们训练了机器学习模型之后，我们可能希望将其作为Web服务部署以进行实时或批量评分。当我们训练机器学习模型时，我们使用特定的框架和库。在大多数情况下，我们的部署环境中应该有相同的环境。容器是创建此类环境的快速简单方式，在其中我们可以托管我们的模型和依赖项。使用ACI可以轻松创建容器。作为数据科学家，我们可以使用AML将我们的机器学习模型作为Web服务部署到ACI。这样，我们可以开发测试我们的模型，然后将其部署到生产环境中。有关ACI的更多详细信息，请参阅以下网站：[https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview](https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview)。
- en: AKS
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AKS
- en: Kubernetes is an open source project for managing applications that are hosted
    in containers. AKS is a managed Kubernetes service that makes it easy to use Kubernetes.
    Once you test your machine learning model, you can deploy it to a scalable cluster
    with AKS. You can then have a scalable web service for your machine learning model.
    You can use AML to deploy your model to AKS. For more details on AKS, refer to
    the following website: [https://docs.microsoft.com/en-us/azure/aks/intro-kubernetes](https://docs.microsoft.com/en-us/azure/aks/intro-kubernetes).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes 是一个开源项目，用于管理托管在容器中的应用程序。AKS 是一个托管的 Kubernetes 服务，使得使用 Kubernetes
    变得容易。一旦您测试了您的机器学习模型，您就可以将其部署到 AKS 的可扩展集群中。然后，您可以为您的机器学习模型拥有一个可扩展的 Web 服务。您可以使用
    AML 将您的模型部署到 AKS。有关 AKS 的更多详细信息，请参阅以下网站：[https://docs.microsoft.com/en-us/azure/aks/intro-kubernetes](https://docs.microsoft.com/en-us/azure/aks/intro-kubernetes)。
- en: Summary
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we have learned about the different types of compute options
    that are available for you to scale your machine learning training and deployment.
    We learned about the vertical and horizontal scaling compute options that can
    be used to provide you with a large amount of compute power for your machine learning
    projects.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了可供您扩展机器学习训练和部署的不同计算选项。我们了解了可以用来为您提供大量计算能力的垂直和水平扩展计算选项。
- en: In the next chapter, we will learn about the machine learning server, which
    can be used for on-premise deployments.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习机器学习服务器，它可以用于本地部署。
