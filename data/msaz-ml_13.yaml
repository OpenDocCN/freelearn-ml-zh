- en: Chapter 13. Case Study Exercise II
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第13章。案例研究练习II
- en: You already solved a real-world classification problem in the previous chapter.
    In this chapter, we will present a new problem in the form of another case study
    exercise and we will solve it with a very simple solution. This exercise represents
    a regression problem.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 你在上一章已经解决了一个现实世界的分类问题。在这一章中，我们将以另一个案例研究练习的形式提出一个新的问题，并且我们将用一个非常简单的解决方案来解决它。这个练习代表了一个回归问题。
- en: Like in the previous chapter, it won't present a step-by-step guide with all
    the details; however, it will provide pointers so that you can solve the problem.
    This chapter assumes that you have successfully completed all the previous chapters,
    or already know about Azure ML.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 与上一章类似，它不会提供包含所有详细步骤的逐步指南；然而，它将提供一些提示，以便你可以解决问题。本章假设你已经成功完成了所有前面的章节，或者已经了解Azure
    ML。
- en: Problem definition and scope
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题定义和范围
- en: 'The problem is taken from one of the **Kaggle** machine learning competitions,
    where they exposed the datasets with a bit of information and asked the contestants
    to make a prediction from a test dataset using machine learning techniques. It
    is about the **Africa Soil Property Prediction Challenge**. The training dataset
    contains different measurements of the soil and it is expected that the contestants
    are able to predict values for five properties of the soil (target variables):
    **SOC**, **pH**, **Ca**, **P**, and **Sand**. Full details regarding this can
    be found at [https://www.kaggle.com/c/afsis-soil-properties/](https://www.kaggle.com/c/afsis-soil-properties/).'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 问题来自**Kaggle**机器学习竞赛之一，他们在竞赛中提供了一些数据集信息，并要求参赛者使用机器学习技术从测试数据集中进行预测。这是关于**非洲土壤属性预测挑战**。训练数据集包含土壤的不同测量值，并预期参赛者能够预测土壤五个属性（目标变量）的值：**SOC**、**pH**、**Ca**、**P**和**沙**。更多详细信息可以在[https://www.kaggle.com/c/afsis-soil-properties/](https://www.kaggle.com/c/afsis-soil-properties/)找到。
- en: For the purpose of this case study, we will choose just one target variable
    named P and ignore the others. Once you are able to predict one target variable,
    you can follow the same approach and predict others. So, you should try predicting
    all the variables by yourself.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 为了本案例研究的目的，我们将只选择一个目标变量，命名为P，并忽略其他变量。一旦你能够预测一个目标变量，你就可以采用相同的方法来预测其他变量。因此，你应该尝试自己预测所有变量。
- en: The dataset
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据集
- en: You can download the dataset and find the description at [https://www.kaggle.com/c/afsis-soil-properties/data](https://www.kaggle.com/c/afsis-soil-properties/data).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以下载数据集并找到描述[https://www.kaggle.com/c/afsis-soil-properties/data](https://www.kaggle.com/c/afsis-soil-properties/data)。
- en: 'The dataset has been explained in the following term list, as found at the
    preceding web link:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集已在以下术语列表中解释，如前述网页链接所示：
- en: '**PIDN**: This is the unique soil sample identifier.'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PIDN**：这是唯一的土壤样本标识符。'
- en: '**SOC**: This refers to soil organic carbon.'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SOC**：这指的是土壤有机碳。'
- en: '**pH**: These are the pH values.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pH**：这些是pH值。'
- en: '**Ca**: This is the Mehlich-3 extractable calcium.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ca**：这是Mehlich-3可提取的钙。'
- en: '**P**: This is the Mehlich-3 extractable phosphorus.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**P**：这是Mehlich-3可提取的磷。'
- en: '**Sand**: This is the sand content.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**沙**：这是沙含量。'
- en: '**m7497.96 - m599.76**: There are 3,578 mid-infrared absorbance measurements.
    For example, the "m7497.96" column is the absorbance at wavenumber 7497.96 cm-1\.
    We suggest you remove spectra CO2 bands, which are in the region m2379.76 to m2352.76,
    but you do not have to.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**m7497.96 - m599.76**：有3,578个中红外吸收测量值。例如，“m7497.96”列是7497.96 cm-1波数的吸收率。我们建议你移除位于m2379.76到m2352.76区域的CO2光谱带，但你不必这样做。'
- en: '**Depth**: This is the depth of the soil sample (this has two categories: "**Topsoil**"
    and "**Subsoil**"). They have also included some potential spatial predictors
    from remote sensing data sources. Short variable descriptions of different terms
    are provided below and additional descriptions can be found in AfSIS data. The
    data has been mean centered and scaled.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**深度**：这是土壤样本的深度（这有两个类别：“**表层土壤**”和“**底土**”）。他们还从遥感数据源中包含了一些潜在的时空预测因子。以下提供了不同术语的简短变量描述，更多描述可以在AfSIS数据中找到。数据已经进行了均值中心化和缩放。'
- en: '**BSA**: These are the average long-term **Black Sky Albedo** measurements
    from the **MODIS** satellite images (here, BSAN = near-infrared, BSAS = shortwave,
    and BSAV = visible).'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BSA**：这些是从**MODIS**卫星图像中得到的平均长期**黑天空反照率**测量值（在这里，BSAN = 近红外，BSAS = 短波，BSAV
    = 可见光）。'
- en: '**CTI**: This refers to the **Compound Topographic Index** calculated from
    the **Shuttle Radar Topography Mission** elevation data.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CTI**: 这指的是从**航天飞机雷达地形测量任务**的高度数据计算出的**复合地形指数**。'
- en: '**ELEV**: This refers to the Shuttle Radar Topography Mission elevation data.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ELEV**: 这指的是航天飞机雷达地形测量任务的高度数据。'
- en: '**EVI**: This is the average long-term **Enhanced Vegetation Index** from the
    MODIS satellite images.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**EVI**: 这是从MODIS卫星图像中得到的平均长期**增强植被指数**。'
- en: '**LST**: This is the average long-term **Land Surface Temperatures** from the
    MODIS satellite images (here, LSTD = day time temperature and LSTN = night time
    temperature).'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**LST**: 这是从MODIS卫星图像中得到的平均长期**地表温度**（在此，LSTD = 白天温度和LSTN = 夜间温度）。'
- en: '**Ref**: This refers to the average long-term **Reflectance** measurements
    from the MODIS satellite images (here, Ref1 = blue, Ref2 = red, Ref3 = near-infrared,
    and Ref7 = mid-infrared).'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ref**: 这指的是从MODIS卫星图像中得到的平均长期**反射率**测量值（在此，Ref1 = 蓝色，Ref2 = 红色，Ref3 = 近红外，和Ref7
    = 中红外）。'
- en: '**Reli**: This is the topographic **Relief** calculated from the Shuttle Radar
    Topography mission elevation data.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Reli**: 这是从航天飞机雷达地形测量任务的高度数据计算出的**地形起伏**。'
- en: '**TMAP and TMFI**: These refer to the average long-term **Tropical Rainfall
    Monitoring Mission** data (here, TMAP = mean annual precipitation and TMFI = modified
    fournier index).'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TMAP和TMFI**: 这指的是平均长期**热带降雨监测任务**数据（在此，TMAP = 平均年降水量，TMFI = 修改后的富尼耶指数）。'
- en: Download the training dataset ([https://www.kaggle.com/c/afsis-soil-properties/download/train.zip](https://www.kaggle.com/c/afsis-soil-properties/download/train.zip)).
    Note that you may have to create an account to download the dataset. Upload the
    dataset to ML Studio (for this, refer to [Chapter 4](ch04.html "Chapter 4. Getting
    Data in and out of ML Studio"), *Getting Data in and out of ML Studio*, to find
    details on how to upload a dataset from your local machine to ML Studio).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 下载训练数据集（[https://www.kaggle.com/c/afsis-soil-properties/download/train.zip](https://www.kaggle.com/c/afsis-soil-properties/download/train.zip)）。请注意，您可能需要创建一个账户才能下载数据集。将数据集上传到ML
    Studio（为此，请参阅[第4章](ch04.html "第4章。在ML Studio中导入和导出数据")，*在ML Studio中导入和导出数据*，以找到有关如何从您的本地机器上传数据集的详细信息）。
- en: Data exploration and preparation
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据探索和准备
- en: 'Create a new experiment in ML Studio. Drag the uploaded dataset to the canvas
    and visualize it. As you can see, it has 1157 rows and 3600 columns. Usually,
    the data exposed in a Kaggle competition is already cleaned, which saves you the
    effort of data cleansing, such as dealing with missing values. In ML Studio, you
    can''t see all the columns and rows. There are 3,578 columns that have mid-infrared
    absorbance measurements and these entire column names start with the letter ''m''.
    You may like to separate them out. To do so, you can use an **Execute Python Script**
    module with the following code, where the inline comments explain the lines of
    code. For this, refer to [Chapter 10](ch10.html "Chapter 10. Extensibility with
    R and Python"), *Extensibility with R and Python*, to find the details on how
    to integrate a Python/R script inside ML Studio:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在ML Studio中创建一个新的实验。将上传的数据集拖放到画布上并可视化它。如您所见，它有1157行和3600列。通常，在Kaggle竞赛中公开的数据已经过清洗，这为您节省了数据清洗的精力，例如处理缺失值。在ML
    Studio中，您无法看到所有列和行。有3,578列包含中红外吸收测量值，并且这些整个列名都以字母'm'开头。您可能希望将它们分开。为此，您可以使用带有以下代码的**执行Python脚本**模块，其中内联注释解释了代码行。为此，请参阅[第10章](ch10.html
    "第10章。使用R和Python扩展")，*使用R和Python扩展*，以找到有关如何在ML Studio中集成Python/R脚本的详细信息：
- en: '[PRE0]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The model in progress may appear as follows:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 进行中的模型可能如下所示：
- en: '![Data exploration and preparation](img/0792EN_13_02.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![数据探索和准备](img/0792EN_13_02.jpg)'
- en: Alternatively, you can also use an **Execute R Script** module with R code to
    achieve the same.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您也可以使用**执行R脚本**模块和R代码来实现相同的功能。
- en: These extracted 3,578 columns are almost impossible to visualize and will take
    a long time to process in a model, especially when you use the **Sweep Parameters**
    module. It would be worthwhile condensing them into a few lines, so they are easier
    to process. The **Principal Component** **Analysis** module would be of great
    help, as it would extract a given number of the most relevant features from the
    given features. The **Principal Component Analysis** (PCA) is a popular technique
    that takes a feature set and computes a new feature set with reduced dimensionality
    or a lesser number of features or components; with most of the information contained
    in the original feature set. The **Principal Component Analysis** module present
    in ML Studio takes **Number of dimensions to reduce to** as input, where you can
    specify the desired, low number of features.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这些提取的3,578列几乎无法可视化，并且在模型中处理它们将花费很长时间，尤其是在您使用**参数扫描**模块时。将它们压缩成几行将非常有价值，这样它们就更容易处理了。**主成分分析**模块将非常有帮助，因为它可以从给定的特征中提取出给定数量的最相关特征。**主成分分析**（PCA）是一种流行的技术，它将特征集转换为一个具有降低的维度或更少特征或组件的新特征集；其中包含原始特征集中的大部分信息。ML
    Studio中存在的**主成分分析**模块将**降低到多少维度的数量**作为输入，您可以在其中指定期望的低特征数量。
- en: 'You may try **10** components (for the **Number of dimensions to reduce to**
    option) as its parameter, as shown in the following figure:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以尝试将**10**个组件（用于**降低到多少维度的数量**选项）作为其参数，如图所示：
- en: '![Data exploration and preparation](img/0792EN_13_06.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![数据探索和准备](img/0792EN_13_06.jpg)'
- en: 'You may use another **Execute Python Script** module or **Execute R Script**
    to extract other relevant columns, which are all the columns excluding those that
    start with ''m'' and other target variables (because we are only interested in
    P). You may also like to exclude PIDN, which is the unique soil sample identifier.
    Let''s take a look at the following screenshot:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用另一个**执行Python脚本**模块或**执行R脚本**来提取其他相关列，这些列都是除了以'm'开头和其他目标变量（因为我们只对P感兴趣）之外的所有列。您还可能想排除PIDN，它是唯一的土壤样本标识符。让我们看一下下面的截图：
- en: '![Data exploration and preparation](img/0792EN_13_03.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![数据探索和准备](img/0792EN_13_03.jpg)'
- en: 'The Python code for the same is as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 相同的Python代码如下：
- en: '[PRE1]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Use the two sets of extracted columns to combine, and make, one dataset using
    the **Add Columns** module. By now, you should have a reduced feature set, but
    you still have to find the most relevant ones. Unnecessary data or noise may reduce
    the predictive power of a model, so should be excluded. The **Filter Based Feature
    Selection** module can identify the most important features in a dataset. You
    may try the same with a different number of desired features as parameters, and
    evaluate the performance of the overall model.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 使用提取的两组列进行组合，并使用**添加列**模块制作一个数据集。到目前为止，您应该已经有一个降低的特征集，但您仍然需要找到最相关的特征。不必要的数据或噪声可能会降低模型的预测能力，因此应该被排除。**基于过滤的特征选择**模块可以识别数据集中最重要的特征。您可以尝试使用不同数量的期望特征作为参数，并评估整体模型的性能。
- en: '![Data exploration and preparation](img/0792EN_13_04.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![数据探索和准备](img/0792EN_13_04.jpg)'
- en: 'Before you proceed in building the model, you need to prepare train, validate,
    and test dataset. Let''s take a look at the following screenshot:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在您开始构建模型之前，您需要准备训练、验证和测试数据集。让我们看一下下面的截图：
- en: '![Data exploration and preparation](img/0792EN_13_05.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![数据探索和准备](img/0792EN_13_05.jpg)'
- en: Model development
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型开发
- en: 'After preparing your data, you are not sure which model or regression algorithm
    would perform well for the problem at hand. Because the target variable P is continuous,
    you know that it''s a regression problem. So, it would be worthwhile trying different
    algorithms and choosing the best one. You may use the **Sweep Parameters** module
    to obtain the optimum parameters for the algorithm. You need to pass three inputs
    to the **Sweep Parameters** module: the untrained algorithm, training dataset,
    and validation dataset. Use the **Score** modules to score the test data. Use
    an **Evaluate** module to compare the two models with the scored data.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在准备数据后，您不确定哪种模型或回归算法对当前问题表现良好。因为目标变量P是连续的，您知道这是一个回归问题。因此，尝试不同的算法并选择最佳算法是值得的。您可以使用**参数扫描**模块来获取算法的最佳参数。您需要将三个输入传递给**参数扫描**模块：未训练的算法、训练数据集和验证数据集。使用**评分**模块对测试数据进行评分。使用**评估**模块比较两个模型与评分数据。
- en: You should try different algorithms to choose the best one. The following figure
    is just for your reference, which shows four algorithms.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该尝试不同的算法来选择最佳的一个。下面的图仅作为参考，展示了四种算法。
- en: '![Model development](img/0792EN_13_01_.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![模型开发](img/0792EN_13_01_.jpg)'
- en: Run the model and find out which algorithm performs the best for you.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 运行模型并找出对你来说表现最好的算法。
- en: Model deployment
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型部署
- en: After you are happy with a particular model, save it as a trained model and
    then prepare an experiment for a web service and proceed to deploy the model.
    Refer to [Chapter 11](ch11.html "Chapter 11. Publishing a Model as a Web Service"),
    *Publishing a Model as a Web Service*, to find the details on how to deploy a
    model to the staging environment and test it visually in ML Studio.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 当你对某个特定模型满意后，将其保存为训练模型，然后为网络服务准备一个实验，并继续部署模型。请参考[第11章](ch11.html "第11章。将模型作为网络服务发布")，*将模型作为网络服务发布*，以找到如何将模型部署到预发布环境并在ML
    Studio中可视测试的详细信息。
- en: Summary
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this last chapter, you solved another real-world problem. You started with
    understanding the problem and then, acquired the necessary data. After initial
    data exploration, you realized that the data has a large number of columns, so
    you used Python script modules to first split the data into two sets of features,
    and then used the PCA algorithm to get a reduced set of features. Then, you used
    the **Filter Based Feature Selection** module, which can identify most of the
    important features from the reduced dataset. To select the right model, you tried
    different algorithms and trained them with optimum parameters using the **Sweep
    Parameters** modules. Finally, you selected the model and proceeded to publish
    it as a web service.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后一章中，你解决了另一个现实世界的问题。你从理解问题开始，然后获取了必要的数据。在初步数据探索后，你意识到数据有大量的列，因此你使用Python脚本模块首先将数据分为两组特征，然后使用PCA算法得到一组减少的特征。然后，你使用了**基于过滤的特征选择**模块，该模块可以从减少的数据集中识别出大多数重要特征。为了选择正确的模型，你尝试了不同的算法，并使用**参数扫描**模块用最佳参数进行训练。最后，你选择了模型，并继续将其发布为网络服务。
