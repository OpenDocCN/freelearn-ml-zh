- en: Appendix
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录
- en: 1\. Introduction to Clustering
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1\. 聚类简介
- en: 'Activity 1.01: Implementing k-means Clustering'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 1.01：实现 k-means 聚类
- en: 'Solution:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-4
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库：
- en: '[PRE0]'
  id: totrans-5
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Load the seeds data file using `pandas`:'
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `pandas` 加载种子数据文件：
- en: '[PRE1]'
  id: totrans-7
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Return the first five rows of the dataset, as follows:'
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回数据集的前五行，如下所示：
- en: '[PRE2]'
  id: totrans-9
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The output is as follows:'
  id: totrans-10
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.25: Displaying the first five rows of the dataset'
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 1.25：显示数据集的前五行'
- en: '](img/B15923_01_25.jpg)'
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_01_25.jpg)'
- en: 'Figure 1.25: Displaying the first five rows of the dataset'
  id: totrans-13
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 1.25：显示数据集的前五行
- en: 'Separate the `X` features as follows:'
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式分离 `X` 特征：
- en: '[PRE3]'
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Check the features as follows:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式检查特征：
- en: '[PRE4]'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The output is as follows:'
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.26: Printing the features'
  id: totrans-19
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 1.26：打印特征'
- en: '](img/B15923_01_26.jpg)'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_01_26.jpg)'
- en: 'Figure 1.26: Printing the features'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 1.26：打印特征
- en: 'Define the `k_means` function as follows and initialize the k-centroids randomly.
    Repeat this process until the difference between the new/old `centroids` equals
    `0`, using the `while` loop:'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义 `k_means` 函数，如下所示，并随机初始化 k-质心。使用 `while` 循环重复此过程，直到新旧 `centroids` 之间的差值为
    `0`：
- en: '[PRE5]'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Convert the pandas DataFrame into a NumPy matrix:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 pandas DataFrame 转换为 NumPy 矩阵：
- en: '[PRE6]'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Run our seeds matrix through the `k_means` function we created earlier:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将我们的种子矩阵传递给之前创建的 `k_means` 函数：
- en: '[PRE7]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Print the labels:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印标签：
- en: '[PRE8]'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The output is as follows:'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.27: Printing the labels'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 1.27：打印标签'
- en: '](img/B15923_01_27.jpg)'
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_01_27.jpg)'
- en: 'Figure 1.27: Printing the labels'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 1.27：打印标签
- en: 'Plot the coordinates as follows:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式绘制坐标：
- en: '[PRE9]'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The output is as follows:'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.28: Plotting the coordinates'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 1.28：绘制坐标'
- en: '](img/B15923_01_28.jpg)'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_01_28.jpg)'
- en: 'Figure 1.28: Plotting the coordinates'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 1.28：绘制坐标
- en: 'Calculate the silhouette score as follows:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式计算轮廓系数：
- en: '[PRE10]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The output is as follows:'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE11]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: By completing this activity, you have gained hands-on experience of tuning a
    k-means clustering algorithm for a real-world dataset. The seeds dataset is seen
    as a classic "hello world"-type problem in the data science space and is helpful
    for testing foundational techniques.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 通过完成此活动，您已经获得了在实际数据集上调优 k-means 聚类算法的实践经验。种子数据集被视为数据科学领域经典的“Hello World”类型问题，对于测试基础技术非常有帮助。
- en: Note
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2JPZ4M8](https://packt.live/2JPZ4M8).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考 [https://packt.live/2JPZ4M8](https://packt.live/2JPZ4M8)。
- en: You can also run this example online at [https://packt.live/2Ocncuh](https://packt.live/2Ocncuh).
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在 [https://packt.live/2Ocncuh](https://packt.live/2Ocncuh) 上在线运行此示例。
- en: 2\. Hierarchical Clustering
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2\. 层次聚类
- en: 'Activity 2.01: Comparing k-means with Hierarchical Clustering'
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 2.01：将 k-means 与层次聚类进行比较
- en: 'Solution:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the necessary packages from scikit-learn (`KMeans`, `AgglomerativeClustering`,
    and `silhouette_score`), as follows:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 scikit-learn 导入必要的包（`KMeans`，`AgglomerativeClustering` 和 `silhouette_score`），如下所示：
- en: '[PRE12]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Read the wine dataset into the Pandas DataFrame and print a small sample:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将酒类数据集读取到 Pandas DataFrame 中并打印一个小样本：
- en: '[PRE13]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The output is as follows:'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 2.25: The output of the wine dataset'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.25：酒类数据集的输出'
- en: '](img/B15923_02_25.jpg)'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_02_25.jpg)'
- en: 'Figure 2.25: The output of the wine dataset'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.25：酒类数据集的输出
- en: 'Visualize the wine dataset to understand the data structure:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可视化酒类数据集以理解数据结构：
- en: '[PRE14]'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The output is as follows:'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 2.26: A plot of raw wine data'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.26：原始酒类数据的绘图'
- en: '](img/B15923_02_26.jpg)'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_02_26.jpg)'
- en: 'Figure 2.26: A plot of raw wine data'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.26：原始酒类数据的绘图
- en: 'Use the `sklearn` implementation of k-means on the wine dataset, knowing that
    there are three wine types:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在酒类数据集上使用 `sklearn` 实现 k-means 聚类，已知有三种酒类：
- en: '[PRE15]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Use the `sklearn` implementation of hierarchical clustering on the wine dataset:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `sklearn` 实现层次聚类，应用于酒类数据集：
- en: '[PRE16]'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Plot the predicted clusters from k-means as follows:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式绘制 k-means 的预测聚类：
- en: '[PRE17]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The output is as follows
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 2.27: A plot of clusters from k-means clustering'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.27：k-means 聚类的聚类图'
- en: '](img/B15923_02_27.jpg)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_02_27.jpg)'
- en: 'Figure 2.27: A plot of clusters from k-means clustering'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.27：k-means 聚类的聚类图
- en: 'Plot the predicted clusters from hierarchical clustering as follows:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如下所示绘制层次聚类的预测聚类：
- en: '[PRE18]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The output is as follows:'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 2.28: A plot of clusters from agglomerative clustering'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.28：从聚合聚类中绘制的聚类图'
- en: '](img/B15923_02_28.jpg)'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_02_28.jpg)'
- en: 'Figure 2.28: A plot of clusters from agglomerative clustering'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.28：聚合聚类的聚类图
- en: Note
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: In *Figure 2.23* and *Figure 2.24*, each color represents a single cluster.
    The colors of the clusters will change every time the code is executed.
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在*图 2.23*和*图 2.24*中，每种颜色代表一个单独的聚类。每次执行代码时，聚类的颜色都会发生变化。
- en: 'Compare the silhouette score of each clustering method:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 比较每种聚类方法的轮廓分数：
- en: '[PRE19]'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The output will be as follows:'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出将如下所示：
- en: '[PRE20]'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: As you can see from the preceding silhouette metric, agglomerative clustering
    narrowly beats k-means clustering when it comes to separating the clusters by
    mean intra-cluster distance. This is not the case for every version of agglomerative
    clustering, however. Instead, try different linkage types and examine how the
    silhouette score and clustering changes between each.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的轮廓指标可以看出，在按平均簇内距离分离聚类时，聚合聚类稍微优于 k-means 聚类。然而，这并不是每个聚合聚类版本的情况。相反，尝试不同的连接类型，并检查每种类型下的轮廓分数和聚类的变化。
- en: Note
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2AFA60Z](https://packt.live/2AFA60Z).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问该特定部分的源代码，请参考[https://packt.live/2AFA60Z](https://packt.live/2AFA60Z)。
- en: You can also run this example online at [https://packt.live/3fe2lTi](https://packt.live/3fe2lTi).
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在线运行此示例，访问[https://packt.live/3fe2lTi](https://packt.live/3fe2lTi)。
- en: 3\. Neighborhood Approaches and DBSCAN
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 3. 邻域方法和 DBSCAN
- en: 'Activity 3.01: Implementing DBSCAN from Scratch'
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 3.01：从零实现 DBSCAN
- en: 'Solution:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Generate a random cluster dataset as follows:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成一个随机的聚类数据集，如下所示：
- en: '[PRE21]'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Visualize the generated data:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可视化生成的数据：
- en: '[PRE22]'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'The output is as follows:'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![Figure 3.15: Plot of the data generated'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.15：生成的数据的绘图'
- en: '](img/B15923_03_15.jpg)'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_15.jpg)'
- en: 'Figure 3.15: Plot of the data generated'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 3.15：生成的数据的绘图
- en: 'Create functions from scratch that allow you to call DBSCAN on a dataset:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从头开始创建函数，允许你在数据集上调用 DBSCAN：
- en: '[PRE23]'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Use your created DBSCAN implementation to find clusters in the generated dataset.
    Feel free to use hyperparameters as you see fit, tuning them based on their performance
    in *Step 5*:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用你创建的 DBSCAN 实现来查找生成数据集中的聚类。根据需要调整超参数，并根据它们在*第 5 步*中的表现进行调优：
- en: '[PRE24]'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Visualize the clustering performance of your DBSCAN implementation:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可视化你实现的 DBSCAN 聚类性能：
- en: '[PRE25]'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The output is as follows:'
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![Figure 3.16: Plot of DBSCAN implementation'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.16：DBSCAN 实现的绘图'
- en: '](img/B15923_03_16.jpg)'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_16.jpg)'
- en: 'Figure 3.16: Plot of DBSCAN implementation'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.16：DBSCAN 实现的绘图
- en: In the preceding output, you can see that there are four clearly defined clusters
    in our generated data. The non-highlighted points fall out of neighborhood range
    and thus are considered noise. While it may not be ideal since not every point
    is accounted for, for most business cases, this noise is acceptable. If it is
    not acceptable in your scenario, you can tune the supplied hyperparameters to
    be more forgiving of distance.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的输出中，你可以看到我们生成的数据中有四个明确定义的聚类。未突出显示的点超出了邻域范围，因此被视为噪声。尽管这可能不是理想的，因为不是每个点都被考虑在内，但对于大多数商业案例来说，这种噪声是可以接受的。如果在你的场景中不能接受，你可以调整提供的超参数，使得距离容忍度更高。
- en: As you may have noticed, it takes quite some time for a custom implementation
    to run. This is because we explored the non-vectorized version of this algorithm
    for the sake of clarity. In most cases, you should aim to use the DBSCAN implementation
    provided by scikit-learn, as it is highly optimized.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你可能已经注意到的，定制实现的运行时间较长。这是因为我们为了清晰起见，探索了非向量化版本的算法。在大多数情况下，你应该使用 scikit-learn
    提供的 DBSCAN 实现，因为它经过高度优化。
- en: Note
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3c1rONO](https://packt.live/3c1rONO).
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问该特定部分的源代码，请参考[https://packt.live/3c1rONO](https://packt.live/3c1rONO)。
- en: You can also run this example online at [https://packt.live/2ZVoFuO](https://packt.live/2ZVoFuO).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在线运行此示例，访问[https://packt.live/2ZVoFuO](https://packt.live/2ZVoFuO)。
- en: 'Activity 3.02: Comparing DBSCAN with k-means and Hierarchical Clustering'
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 3.02：将 DBSCAN 与 k-means 和层次聚类进行比较
- en: 'Solution:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the necessary packages:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入必要的包：
- en: '[PRE26]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Load the wine dataset from *Chapter 2*, *Hierarchical Clustering*, and familiarize
    yourself again with what the data looks like:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从*第 2 章*，*层次聚类*中加载葡萄酒数据集，并再次熟悉数据的外观：
- en: '[PRE27]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The output is as follows:'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![Figure 3.17: First five rows of the wine dataset'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.17：葡萄酒数据集的前五行'
- en: '](img/B15923_03_17.jpg)'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_17.jpg)'
- en: 'Figure 3.17: First five rows of the wine dataset'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 3.17：葡萄酒数据集的前五行
- en: 'Visualize the data:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可视化数据：
- en: '[PRE28]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The output is as follows:'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 3.18: Plot of the data'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.18：数据图示'
- en: '](img/B15923_03_18.jpg)'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_18.jpg)'
- en: 'Figure 3.18: Plot of the data'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 3.18：数据图示
- en: 'Generate clusters using k-means, agglomerative clustering, and DBSCAN:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 k-means、凝聚聚类和 DBSCAN 生成聚类：
- en: '[PRE29]'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Evaluate a few different options for DSBSCAN hyperparameters and their effect
    on the silhouette score:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 评估不同的 DSBSCAN 超参数选项及其对轮廓得分的影响：
- en: '[PRE30]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The output is as follows:'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 3.19: Printing the silhouette score for clusters'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.19：打印聚类的轮廓得分'
- en: '](img/B15923_03_19.jpg)'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_19.jpg)'
- en: 'Figure 3.19: Printing the silhouette score for clusters'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 3.19：打印聚类的轮廓得分
- en: 'Generate the final clusters based on the highest silhouette score (`eps`: `35`,
    `min_samples`: `3`):'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据最高的轮廓得分生成最终聚类（`eps`：`35`，`min_samples`：`3`）：
- en: '[PRE31]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Visualize clusters generated using each of the three methods:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可视化使用三种方法生成的聚类：
- en: '[PRE32]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'The output is as follows:'
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 3.20: Plot of clusters using different algorithms'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 3.20：使用不同算法绘制聚类图'
- en: '](img/B15923_03_20.jpg)'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_03_20.jpg)'
- en: 'Figure 3.20: Plot of clusters using different algorithms'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 3.20：使用不同算法绘制聚类图
- en: 'Evaluate the silhouette score of each approach:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 评估每种方法的轮廓得分：
- en: '[PRE33]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The output is as follows:'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE34]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: As you can see, DBSCAN isn't automatically the best choice for your clustering
    needs. One key trait that makes it different from other algorithms is the use
    of noise as a potential clustering. In some cases, this is great, as it removes
    outliers; however, there may be situations where it is not tuned well enough and
    classifies too many points as noise. You can improve the silhouette score further
    by tuning the hyperparameters while fitting your clustering algorithms – try a
    few different combinations and see how they affect your score.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，DBSCAN 并不是自动适合你聚类需求的最佳选择。与其他算法的一个关键区别在于它将噪声视为潜在的聚类。在某些情况下，这很有帮助，因为它能够去除异常值；然而，也可能会出现它调整得不够好，导致过多的点被分类为噪声的情况。你可以通过在拟合聚类算法时调整超参数进一步提高轮廓得分——尝试几种不同的组合，看看它们如何影响得分。
- en: Note
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2BNSQvC](https://packt.live/2BNSQvC).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取此特定部分的源代码，请参考 [https://packt.live/2BNSQvC](https://packt.live/2BNSQvC)。
- en: You can also run this example online at [https://packt.live/3iElboS](https://packt.live/3iElboS).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在网上运行这个示例，链接地址为 [https://packt.live/3iElboS](https://packt.live/3iElboS)。
- en: 4\. Dimensionality Reduction Techniques and PCA
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 4\. 降维技术与PCA
- en: 'Activity 4.01: Manual PCA versus scikit-learn'
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 4.01：手动 PCA 与 scikit-learn
- en: 'Solution:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the `pandas`, `numpy`, and `matplotlib` plotting libraries and the scikit-learn
    `PCA` model:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pandas`、`numpy` 和 `matplotlib` 绘图库以及 scikit-learn 的 `PCA` 模型：
- en: '[PRE35]'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Load the dataset and select only the sepal features as per the previous exercises.
    Display the first five rows of the data:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载数据集，并按照之前的练习仅选择花萼特征。显示数据的前五行：
- en: '[PRE36]'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The output is as follows:'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 4.36: The first five rows of the data'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.36：数据的前五行'
- en: '](img/B15923_04_36.jpg)'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_36.jpg)'
- en: 'Figure 4.36: The first five rows of the data'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.36：数据的前五行
- en: 'Compute the `covariance` matrix for the data:'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算数据的`协方差`矩阵：
- en: '[PRE37]'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The output is as follows:'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE38]'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Transform the data using the scikit-learn API and only the first principal
    component. Store the transformed data in the `sklearn_pca` variable:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 scikit-learn API 转换数据，并仅使用第一个主成分。将转换后的数据存储在 `sklearn_pca` 变量中：
- en: '[PRE39]'
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Transform the data using the manual PCA and only the first principal component.
    Store the transformed data in the `manual_pca` variable:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用手动PCA转换数据，并仅使用第一个主成分。将转换后的数据存储在 `manual_pca` 变量中：
- en: '[PRE40]'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Plot the `sklearn_pca` and `manual_pca` values on the same plot to visualize
    the difference:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在同一图上绘制 `sklearn_pca` 和 `manual_pca` 值，以可视化差异：
- en: '[PRE41]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The output is as follows:'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 4.37: A plot of the data'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.37：数据图示'
- en: '](img/B15923_04_37.jpg)'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_37.jpg)'
- en: 'Figure 4.37: A plot of the data'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.37：数据图示
- en: 'Notice that the two plots look almost identical, except that one is a mirror
    image of the other and there is an offset between the two. Display the components
    of the `sklearn_pca` and `manual_pca` models:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注意，两个图几乎一模一样，只是一个是另一个的镜像，且两者之间有偏移。显示 `sklearn_pca` 和 `manual_pca` 模型的组件：
- en: '[PRE42]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'The output is as follows:'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE43]'
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Now, print `P`:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，打印 `P`：
- en: '[PRE44]'
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'The output is as follows:'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE45]'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Notice the difference in the signs; the values are identical, but the signs
    are different, producing the mirror image result. This is just a difference in
    convention, and nothing meaningful.
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意符号上的差异；数值是相同的，但符号不同，产生镜像结果。这只是约定上的差异，没有实际意义。
- en: 'Multiply the `manual_pca` models by `-1` and replot:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`manual_pca`模型乘以`-1`并重新绘制：
- en: '[PRE46]'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'The output is as follows:'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.38: Replotted data'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.38：重新绘制的数据'
- en: '](img/B15923_04_38.jpg)'
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_38.jpg)'
- en: 'Figure 4.38: Replotted data'
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.38：重新绘制的数据
- en: 'Now, all we need to do is deal with the offset between the two. The scikit-learn
    API subtracts the mean of the data prior to the transform. Subtract the mean of
    each column from the dataset before completing the transform with manual PCA:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们只需处理两者之间的偏移。scikit-learn API会在转换之前先减去数据的均值。在进行手动PCA转换之前，从数据集中减去每列的均值：
- en: '[PRE47]'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Multiply the result by `-1`:'
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将结果乘以`-1`：
- en: '[PRE48]'
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Replot the individual `sklearn_pca` and `manual_pca` values:'
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新绘制各个`sklearn_pca`和`manual_pca`值：
- en: '[PRE49]'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The output is as follows:'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.39: Replotting the data'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.39：重新绘制数据'
- en: '](img/B15923_04_39.jpg)'
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_39.jpg)'
- en: 'Figure 4.39: Replotting the data'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.39：重新绘制数据
- en: The final plot will demonstrate that the dimensionality reduction completed
    by the two methods is, in fact, the same. The differences lie in the differences
    in the signs of the `covariance` matrices, as the two methods simply use a different
    feature as the baseline for comparison. Finally, there is also an offset between
    the two datasets, which is attributed to the mean samples being subtracted before
    executing the transform in the scikit-learn PCA.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 最终图将展示两种方法完成的降维实际上是相同的。差异体现在`covariance`矩阵符号上的不同，因为两种方法仅使用不同的特征作为基准进行比较。最后，两个数据集之间也存在偏移，这归因于在执行scikit-learn
    PCA转换之前已减去均值样本。
- en: Note
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2O9MEk4](https://packt.live/2O9MEk4).
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考[https://packt.live/2O9MEk4](https://packt.live/2O9MEk4)。
- en: You can also run this example online at [https://packt.live/3gBntTU](https://packt.live/3gBntTU).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在线运行此示例，访问[https://packt.live/3gBntTU](https://packt.live/3gBntTU)。
- en: 'Activity 4.02: PCA Using the Expanded Seeds Dataset'
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 4.02：使用扩展的种子数据集进行PCA
- en: 'Solution:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pandas` and `matplotlib`. To enable 3D plotting, you will also need
    to import `Axes3D`:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入`pandas`和`matplotlib`。为了启用3D绘图，你还需要导入`Axes3D`：
- en: '[PRE50]'
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Read in the dataset and select the `A`, `LK`, and `C` columns:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 读取数据集并选择`A`、`LK`和`C`列：
- en: '[PRE51]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The output is as follows:'
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.40: Area, length, and compactness of the kernel'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.40：内核的面积、长度和紧凑性'
- en: '](img/B15923_04_40.jpg)'
  id: totrans-219
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_40.jpg)'
- en: 'Figure 4.40: Area, length, and compactness of the kernel'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.40：内核的面积、长度和紧凑性
- en: 'Plot the data in three dimensions:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在三维空间中绘制数据：
- en: '[PRE52]'
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The output is as follows:'
  id: totrans-223
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.41: Expanded Seeds dataset plot'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.41：扩展的种子数据集绘图'
- en: '](img/B15923_04_41.jpg)'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_41.jpg)'
- en: 'Figure 4.41: Expanded Seeds dataset plot'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.41：扩展的种子数据集绘图
- en: 'Create a `PCA` model without specifying the number of components:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个不指定主成分数量的`PCA`模型：
- en: '[PRE53]'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Fit the model to the dataset:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模型拟合到数据集：
- en: '[PRE54]'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The output is as follows:'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE55]'
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Display the eigenvalues or `explained_variance_ratio_`:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示特征值或`explained_variance_ratio_`：
- en: '[PRE56]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'The output is as follows:'
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE57]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: We want to reduce the dimensionality of the dataset, but still keep at least
    90% of the variance. What is the minimum number of components required to keep
    90% of the variance?
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们希望减少数据集的维度，但仍保留至少90%的方差。为了保留90%的方差，最少需要多少个主成分？
- en: Only the first component is required for at least a 90% variance. The first
    component provides 99.7% of the variance within the dataset.
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 至少需要第一主成分以保留90%以上的方差。第一主成分提供了数据集99.7%的方差。
- en: 'Create a new `PCA` model, this time specifying the number of components required
    to retain at least 90% of the variance:'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的`PCA`模型，这次指定所需的主成分数量，以保留至少90%的方差：
- en: '[PRE58]'
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Transform the data using the new model:'
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用新模型转换数据：
- en: '[PRE59]'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'Restore the transformed data to the original dataspace:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将转换后的数据恢复到原始数据空间：
- en: '[PRE60]'
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Plot the restored data in three dimensions in one subplot and the original
    data in a second subplot to visualize the effect of removing some of the variance:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在一个子图中绘制恢复后的三维数据，在第二个子图中绘制原始数据，以可视化去除部分方差的效果：
- en: '[PRE61]'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'The output is as follows:'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.42: Plot of the expanded and the restored Seeds datasets'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 4.42：扩展和恢复后的 Seeds 数据集的绘图'
- en: '](img/B15923_04_42.jpg)'
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_04_42.jpg)'
- en: 'Figure 4.42: Plot of the expanded and the restored Seeds datasets'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.42：扩展和恢复后的 Seeds 数据集的绘图
- en: Looking at the preceding diagram, we can see that we have removed much of the
    noise within the data, but retained the most important information regarding the
    trends within the data. You can see that, in general, the compactness of the wheat
    kernel increases as the area increases.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的图表中可以看出，我们已经去除了数据中的大部分噪声，但保留了关于数据趋势的最重要信息。你可以看到，通常情况下，小麦粒的紧密度随着面积的增大而增加。
- en: Note
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: When applying PCA, it is important to keep in mind the size of the data being
    modeled, along with the available system memory. The singular value decomposition
    process involves separating the data into the eigenvalues and eigenvectors and
    can be quite memory-intensive. If the dataset is too large, you may either be
    unable to complete the process, suffer significant performance loss, or lock up
    your system.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在应用 PCA 时，必须考虑所建模数据的大小以及可用的系统内存。奇异值分解过程涉及将数据分离为特征值和特征向量，这可能会占用大量内存。如果数据集过大，可能会导致无法完成处理、性能显著下降或系统崩溃。
- en: To access the source code for this specific section, please refer to [https://packt.live/2ZVpaFc](https://packt.live/2ZVpaFc).
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考 [https://packt.live/2ZVpaFc](https://packt.live/2ZVpaFc)。
- en: You can also run this example online at [https://packt.live/3gIrR3D](https://packt.live/3gIrR3D).
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在线运行这个示例，网址：[https://packt.live/3gIrR3D](https://packt.live/3gIrR3D)。
- en: 5\. Autoencoders
  id: totrans-256
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5. 自编码器
- en: 'Activity 5.01: The MNIST Neural Network'
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 5.01：MNIST 神经网络
- en: 'Solution:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'In this activity, you will train a neural network to identify images in the
    MNIST dataset and reinforce your skills in training neural networks:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个活动中，你将训练一个神经网络来识别 MNIST 数据集中的图像，并强化你在训练神经网络方面的技能：
- en: 'Import `pickle`, `numpy`, `matplotlib`, and the `Sequential` and `Dense` classes
    from Keras:'
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pickle`、`numpy`、`matplotlib` 以及 Keras 中的 `Sequential` 和 `Dense` 类：
- en: '[PRE62]'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'Load the `mnist.pkl` file, which contains the first 10,000 images and corresponding
    labels from the MNIST dataset that are available in the accompanying source code.
    The MNIST dataset is a series of 28 x 28 grayscale images of handwritten digits
    0 through 9\. Extract the images and labels:'
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载 `mnist.pkl` 文件，该文件包含来自 MNIST 数据集的前 10,000 张图像及其对应标签，这些数据可在随附的源代码中找到。MNIST
    数据集是包含 0 到 9 手写数字的 28 x 28 灰度图像系列。提取图像和标签：
- en: '[PRE63]'
  id: totrans-263
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Plot the first 10 samples along with the corresponding labels:'
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制前 10 个样本及其相应的标签：
- en: '[PRE64]'
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The output is as follows:'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 5.40: First 10 samples'
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.40：前 10 个样本'
- en: '](img/B15923_05_40.jpg)'
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_40.jpg)'
- en: 'Figure 5.40: First 10 samples'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 5.40：前 10 个样本
- en: 'Encode the labels using one-hot encoding:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用独热编码对标签进行编码：
- en: '[PRE65]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'The output is as follows:'
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE66]'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Prepare the images for input into a neural network. As a hint, there are two
    separate steps in this process:'
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备好输入神经网络的图像。作为提示，这个过程分为两个独立的步骤：
- en: '[PRE67]'
  id: totrans-275
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Construct a neural network model in Keras that accepts the prepared images,
    has a hidden layer of 600 units with a ReLU activation function, and an output
    of the same number of units as classes. The output layer uses a `softmax` activation
    function:'
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Keras 中构建一个神经网络模型，接受已准备好的图像，具有 600 个单元的隐藏层并使用 ReLU 激活函数，输出层的单元数与类别数相同。输出层使用
    `softmax` 激活函数：
- en: '[PRE68]'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Compile the model using multiclass cross-entropy, stochastic gradient descent,
    and an accuracy performance metric:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用多类交叉熵、随机梯度下降和准确率性能指标来编译模型：
- en: '[PRE69]'
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'Train the model. How many epochs are required to achieve at least 95% classification
    accuracy on the training data? Let''s have a look:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 训练模型。需要多少个 epoch 才能在训练数据上达到至少 95% 的分类准确率？我们来看看：
- en: '[PRE70]'
  id: totrans-281
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'The output is as follows:'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 5.41: Training the model'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.41：训练模型'
- en: '](img/B15923_05_41.jpg)'
  id: totrans-284
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_41.jpg)'
- en: 'Figure 5.41: Training the model'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.41：训练模型
- en: 15 epochs are required to achieve at least 95% classification accuracy on the
    training set.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 需要 15 个 epoch 才能在训练集上达到至少 95% 的分类准确率。
- en: In this example, we have measured the performance of the neural network classifier
    using the data that the classifier was trained with. In general, this method should
    not be used as it typically reports a higher level of accuracy than you should
    expect from the model. In supervised learning problems, there are a number of
    **cross-validation** techniques that should be used instead. As this is a course
    on unsupervised learning, cross-validation lies outside the scope of this book.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们使用分类器训练的数据来衡量神经网络分类器的性能。通常情况下，不应该使用这种方法，因为它通常报告比你期望的模型准确度更高。在监督学习问题中，应使用若干
    **交叉验证** 技术。由于这是一本关于无监督学习的课程，交叉验证超出了本书的范围。
- en: Note
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2VZpLnZ](https://packt.live/2VZpLnZ).
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考 [https://packt.live/2VZpLnZ](https://packt.live/2VZpLnZ)。
- en: You can also run this example online at [https://packt.live/2Z9ueGz](https://packt.live/2Z9ueGz).
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在网上运行这个示例，访问 [https://packt.live/2Z9ueGz](https://packt.live/2Z9ueGz)。
- en: 'Activity 5.02: Simple MNIST Autoencoder'
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 5.02：简单的 MNIST 自动编码器
- en: 'Solution:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pickle`, `numpy`, and `matplotlib`, as well as the `Model`, `Input`,
    and `Dense` classes, from Keras:'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pickle`、`numpy` 和 `matplotlib`，以及 Keras 中的 `Model`、`Input` 和 `Dense` 类：
- en: '[PRE71]'
  id: totrans-294
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'Load the images from the supplied sample of the MNIST dataset that is provided
    with the accompanying source code (`mnist.pkl`):'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从提供的 MNIST 数据集样本中加载图像，样本随附有源代码 (`mnist.pkl`)：
- en: '[PRE72]'
  id: totrans-296
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Prepare the images for input into a neural network. As a hint, there are **two**
    separate steps in this process:'
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备将图像输入到神经网络中。作为提示，这个过程有 **两个** 独立的步骤：
- en: '[PRE73]'
  id: totrans-298
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'Construct a simple autoencoder network that reduces the image size to 10 x
    10 after the encoding stage:'
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个简单的自动编码器网络，将图像大小在编码阶段压缩至 10 x 10：
- en: '[PRE74]'
  id: totrans-300
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Compile the autoencoder using a binary cross-entropy loss function and `adadelta`
    gradient descent:'
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用二元交叉熵损失函数和 `adadelta` 梯度下降法编译自动编码器：
- en: '[PRE75]'
  id: totrans-302
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'Fit the encoder model:'
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 拟合编码器模型：
- en: '[PRE76]'
  id: totrans-304
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'The output is as follows:'
  id: totrans-305
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.42: Training the model'
  id: totrans-306
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.42：训练模型'
- en: '](img/B15923_05_42.jpg)'
  id: totrans-307
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_42.jpg)'
- en: 'Figure 5.42: Training the model'
  id: totrans-308
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 5.42：训练模型
- en: 'Calculate and store the output of the encoding stage for the first five samples:'
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并存储编码阶段前五个样本的输出：
- en: '[PRE77]'
  id: totrans-310
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'Reshape the encoder output to 10 x 10 (10 x 10 = 100) pixels and multiply by
    255:'
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将编码器的输出重塑为 10 x 10（10 x 10 = 100）像素，并乘以 255：
- en: '[PRE78]'
  id: totrans-312
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'Calculate and store the output of the decoding stage for the first five samples:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并存储解码阶段前五个样本的输出：
- en: '[PRE79]'
  id: totrans-314
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'Reshape the output of the decoder to 28 x 28 and multiply by 255:'
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将解码器的输出重塑为 28 x 28，并乘以 255：
- en: '[PRE80]'
  id: totrans-316
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'Plot the original image, the encoder output, and the decoder:'
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制原始图像、编码器输出和解码器：
- en: '[PRE81]'
  id: totrans-318
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'The output is as follows:'
  id: totrans-319
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.43: The original image, the encoder output, and the decoder'
  id: totrans-320
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.43：原始图像、编码器输出和解码器'
- en: '](img/B15923_05_43.jpg)'
  id: totrans-321
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_43.jpg)'
- en: 'Figure 5.43: The original image, the encoder output, and the decoder'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.43：原始图像、编码器输出和解码器
- en: So far, we have shown how a simple single hidden layer in both the encoding
    and decoding stage can be used to reduce the data to a lower dimension space.
    We can also make this model more complicated by adding additional layers to both
    the encoding and the decoding stages.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经展示了如何使用编码和解码阶段的简单单隐层将数据降维。我们还可以通过向编码和解码阶段添加额外的层，使该模型更加复杂。
- en: Note
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3f5ZSdH](https://packt.live/3f5ZSdH).
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考 [https://packt.live/3f5ZSdH](https://packt.live/3f5ZSdH)。
- en: You can also run this example online at [https://packt.live/2W0ZkhP](https://packt.live/2W0ZkhP).
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在网上运行这个示例，访问 [https://packt.live/2W0ZkhP](https://packt.live/2W0ZkhP)。
- en: 'Activity 5.03: MNIST Convolutional Autoencoder'
  id: totrans-327
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 5.03：MNIST 卷积自动编码器
- en: 'Solution:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pickle`, `numpy`, `matplotlib`, and the `Model` class from `keras.models`,
    and import `Input`, `Conv2D`, `MaxPooling2D`, and `UpSampling2D` from `keras.layers`:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pickle`、`numpy`、`matplotlib` 和 `keras.models` 中的 `Model` 类，导入 `keras.layers`
    中的 `Input`、`Conv2D`、`MaxPooling2D` 和 `UpSampling2D`：
- en: '[PRE82]'
  id: totrans-330
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'Load the data:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载数据：
- en: '[PRE83]'
  id: totrans-332
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'Rescale the images to have values between 0 and 1:'
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将图像缩放至 0 到 1 之间：
- en: '[PRE84]'
  id: totrans-334
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'We need to reshape the images to add a single depth channel for use with convolutional
    stages. Reshape the images to have a shape of 28 x 28 x 1:'
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要重塑图像，以添加一个深度通道，以便用于卷积阶段。将图像重塑为 28 x 28 x 1：
- en: '[PRE85]'
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'Define an input layer. We will use the same shape input as an image:'
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义输入层。我们将使用与图像相同形状的输入：
- en: '[PRE86]'
  id: totrans-338
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'Add a convolutional stage with 16 layers or filters, a 3 x 3 weight matrix,
    a ReLU activation function, and using the same padding, which means the output
    has the same length as the input image:'
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个具有 16 层或滤波器的卷积阶段，使用 3 x 3 的权重矩阵，ReLU 激活函数，并使用相同的填充，这意味着输出与输入图像的长度相同：
- en: '[PRE87]'
  id: totrans-340
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'Add a max pooling layer to the encoder with a 2 x 2 kernel:'
  id: totrans-341
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为编码器添加一个最大池化层，使用 2 x 2 的卷积核：
- en: '[PRE88]'
  id: totrans-342
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'Add a decoding convolutional layer:'
  id: totrans-343
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加解码卷积层：
- en: '[PRE89]'
  id: totrans-344
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Add an upsampling layer:'
  id: totrans-345
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加上采样层：
- en: '[PRE90]'
  id: totrans-346
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'Add the final convolutional stage, using one layer as per the initial image
    depth:'
  id: totrans-347
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加最后一个卷积阶段，按照初始图像的深度使用一层：
- en: '[PRE91]'
  id: totrans-348
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'Construct the model by passing the first and last layers of the network to
    the `Model` class:'
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将网络的第一层和最后一层传递给 `Model` 类来构建模型：
- en: '[PRE92]'
  id: totrans-350
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'Display the structure of the model:'
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示模型结构：
- en: '[PRE93]'
  id: totrans-352
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'The output is as follows:'
  id: totrans-353
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.44: Structure of the model'
  id: totrans-354
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.44: 模型结构'
- en: '](img/B15923_05_44.jpg)'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_44.jpg)'
- en: 'Figure 5.44: Structure of the model'
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 5.44: 模型结构'
- en: 'Compile the autoencoder using a binary cross-entropy loss function and `adadelta`
    gradient descent:'
  id: totrans-357
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用二元交叉熵损失函数和 `adadelta` 梯度下降法编译自编码器：
- en: '[PRE94]'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'Now, let''s fit the model; again, we pass the images as the training data and
    as the desired output. Train for 20 epochs as convolutional networks take a lot
    longer to compute:'
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们拟合模型；再次，将图像作为训练数据和期望的输出。由于卷积网络的计算时间较长，因此训练 20 个 epoch：
- en: '[PRE95]'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE95]'
- en: 'The output is as follows:'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.45: Training the model'
  id: totrans-362
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.45: 训练模型'
- en: '](img/B15923_05_45.jpg)'
  id: totrans-363
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_45.jpg)'
- en: 'Figure 5.45: Training the model'
  id: totrans-364
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 5.45: 训练模型'
- en: 'Calculate and store the output of the encoding stage for the first five samples:'
  id: totrans-365
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并存储前五个样本的编码阶段输出：
- en: '[PRE96]'
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'Reshape the encoder output for visualization, where each image is X*Y in size:'
  id: totrans-367
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了可视化，重塑编码器输出，每个图像的大小为 X*Y：
- en: '[PRE97]'
  id: totrans-368
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'Get the output of the decoder for the first five images:'
  id: totrans-369
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取解码器对前五个图像的输出：
- en: '[PRE98]'
  id: totrans-370
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'Reshape the decoder output to 28 x 28 in size:'
  id: totrans-371
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将解码器输出重塑为 28 x 28 的大小：
- en: '[PRE99]'
  id: totrans-372
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'Reshape the original images back to 28 x 28 in size:'
  id: totrans-373
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将原始图像重塑回 28 x 28 的大小：
- en: '[PRE100]'
  id: totrans-374
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE100]'
- en: 'Plot the original image, the mean encoder output, and the decoder:'
  id: totrans-375
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制原始图像、平均编码器输出和解码器：
- en: '[PRE101]'
  id: totrans-376
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE101]'
- en: 'The output is as follows:'
  id: totrans-377
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.46: The original image, the encoder output, and the decoder'
  id: totrans-378
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 5.46: 原始图像、编码器输出和解码器'
- en: '](img/B15923_05_46.jpg)'
  id: totrans-379
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_05_46.jpg)'
- en: 'Figure 5.46: The original image, the encoder output, and the decoder'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '图 5.46: 原始图像、编码器输出和解码器'
- en: At the end of this activity, you will have developed an autoencoder comprising
    convolutional layers within the neural network. Note the improvements made in
    the decoder representations. This architecture has a significant performance benefit
    over fully connected neural network layers and is extremely useful in working
    with image-based datasets and generating artificial data samples.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次活动结束时，您将开发一个包含卷积层的自编码器神经网络。注意解码器表示的改进。与全连接神经网络层相比，这种架构在性能上有显著优势，并且在处理基于图像的数据集和生成人工数据样本时极为有用。
- en: Note
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2CdpIxY](https://packt.live/2CdpIxY).
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参见 [https://packt.live/2CdpIxY](https://packt.live/2CdpIxY)。
- en: You can also run this example online at [https://packt.live/3iKz8l2](https://packt.live/3iKz8l2).
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在在线运行此示例 [https://packt.live/3iKz8l2](https://packt.live/3iKz8l2)。
- en: 6\. t-Distributed Stochastic Neighbor Embedding
  id: totrans-385
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 6. t-分布随机邻域嵌入
- en: 'Activity 6.01: Wine t-SNE'
  id: totrans-386
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '活动 6.01: 葡萄酒 t-SNE'
- en: 'Solution:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pandas`, `numpy`, and `matplotlib`, as well as the `t-SNE` and `PCA`
    models from scikit-learn:'
  id: totrans-388
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pandas`、`numpy` 和 `matplotlib`，以及来自 scikit-learn 的 `t-SNE` 和 `PCA` 模型：
- en: '[PRE102]'
  id: totrans-389
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE102]'
- en: 'Load the Wine dataset using the `wine.data` file included in the accompanying
    source code and display the first five rows of data:'
  id: totrans-390
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用随附源代码中的 `wine.data` 文件加载葡萄酒数据集，并显示数据的前五行：
- en: '[PRE103]'
  id: totrans-391
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'The output is as follows:'
  id: totrans-392
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.25: The first five rows of the Wine dataset'
  id: totrans-393
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.25: 葡萄酒数据集的前五行'
- en: '](img/B15923_06_25.jpg)'
  id: totrans-394
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_25.jpg)'
- en: 'Figure 6.25: The first five rows of the Wine dataset'
  id: totrans-395
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 6.25: 葡萄酒数据集的前五行'
- en: 'The first column contains the labels; extract this column and remove it from
    the dataset:'
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第一列包含标签；提取该列并将其从数据集中移除：
- en: '[PRE104]'
  id: totrans-397
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE104]'
- en: 'Execute PCA to reduce the dataset to the first six components:'
  id: totrans-398
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行 PCA，将数据集降到前六个主成分：
- en: '[PRE105]'
  id: totrans-399
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE105]'
- en: 'Determine the amount of variance within the data described by these six components:'
  id: totrans-400
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定这六个成分描述的数据中的方差量：
- en: '[PRE106]'
  id: totrans-401
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE106]'
- en: 'The output is as follows:'
  id: totrans-402
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE107]'
  id: totrans-403
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE107]'
- en: 'Create a t-SNE model using a specified random state and a `verbose` value of
    1:'
  id: totrans-404
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个使用指定随机状态并设置`verbose`值为1的t-SNE模型：
- en: '[PRE108]'
  id: totrans-405
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE108]'
- en: 'The output is as follows:'
  id: totrans-406
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.26: Creating a t-SNE model'
  id: totrans-407
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图6.26：创建t-SNE模型'
- en: '](img/B15923_06_26.jpg)'
  id: totrans-408
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_26.jpg)'
- en: 'Figure 6.26: Creating a t-SNE model'
  id: totrans-409
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图6.26：创建t-SNE模型
- en: 'Fit the PCA data to the t-SNE model:'
  id: totrans-410
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将PCA数据拟合到t-SNE模型：
- en: '[PRE109]'
  id: totrans-411
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE109]'
- en: 'The output is as follows:'
  id: totrans-412
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.27: Fitting the PCA data to the t-SNE model'
  id: totrans-413
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图6.27：将PCA数据拟合到t-SNE模型'
- en: '](img/B15923_06_27.jpg)'
  id: totrans-414
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_27.jpg)'
- en: 'Figure 6.27: Fitting the PCA data to the t-SNE model'
  id: totrans-415
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图6.27：将PCA数据拟合到t-SNE模型
- en: 'Confirm that the shape of the t-SNE fitted data is two-dimensional:'
  id: totrans-416
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确认t-SNE拟合数据的形状是二维的：
- en: '[PRE110]'
  id: totrans-417
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE110]'
- en: 'The output is as follows:'
  id: totrans-418
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE111]'
  id: totrans-419
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE111]'
- en: 'Create a scatter plot of the two-dimensional data:'
  id: totrans-420
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建二维数据的散点图：
- en: '[PRE112]'
  id: totrans-421
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE112]'
- en: 'The output is as follows:'
  id: totrans-422
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.28: Scatter plot of the two-dimensional data'
  id: totrans-423
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图6.28：二维数据的散点图'
- en: '](img/B15923_06_28.jpg)'
  id: totrans-424
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_28.jpg)'
- en: 'Figure 6.28: Scatter plot of the two-dimensional data'
  id: totrans-425
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图6.28：二维数据的散点图
- en: 'Create a secondary scatter plot of the two-dimensional data with the class
    labels applied to visualize any clustering that may be present:'
  id: totrans-426
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建带有类别标签的二维数据二次散点图，以可视化可能存在的聚类：
- en: '[PRE113]'
  id: totrans-427
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE113]'
- en: 'The output is as follows:'
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.29: Secondary plot of the two-dimensional data'
  id: totrans-429
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图6.29：二维数据的二次图'
- en: '](img/B15923_06_15.jpg)'
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_15.jpg)'
- en: 'Figure 6.29: Secondary plot of the two-dimensional data'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.29：二维数据的二次图
- en: Note that while there is an overlap between the wine classes, it can also be
    seen that there is some clustering within the data. The first wine class is predominantly
    positioned in the top left-hand corner of the plot, the second wine class in the
    bottom-right, and the third wine class is between the first two. This representation
    certainly couldn't be used to classify individual wine samples with great confidence,
    but it shows an overall trend and the series of clusters contained within the
    high-dimensional data that we were unable to see earlier.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，尽管不同种类的葡萄酒存在重叠，但也可以看到数据中存在一些聚类。第一种葡萄酒类别主要位于图表的左上角，第二种葡萄酒类别位于右下角，而第三种葡萄酒类别位于前两者之间。这种表示方式肯定不能用来高信心地分类单个葡萄酒样本，但它展示了一个总体趋势以及我们之前无法看到的高维数据中的一系列聚类。
- en: In this section, we covered the basics of generating SNE plots. The ability
    to represent high-dimensional data in a low-dimensional space is critical, especially
    for developing a thorough understanding of the data at hand. Occasionally, these
    plots can be tricky to interpret as the exact relationships are sometimes contradictory,
    sometimes leading to misleading structures.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中，我们介绍了生成SNE图的基础知识。将高维数据表示为低维空间的能力至关重要，尤其是为了更全面地理解手头的数据。有时，这些图表可能很难解读，因为其中的确切关系有时是矛盾的，有时会导致误导性的结构。
- en: Note
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2ZSVKrf](https://packt.live/2ZSVKrf).
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考[https://packt.live/2ZSVKrf](https://packt.live/2ZSVKrf)。
- en: You can also run this example online at [https://packt.live/2CgAWBE](https://packt.live/2CgAWBE).
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在线运行这个例子，访问[https://packt.live/2CgAWBE](https://packt.live/2CgAWBE)。
- en: 'Activity 6.02: t-SNE Wine and Perplexity'
  id: totrans-437
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动6.02：t-SNE葡萄酒与困惑度
- en: 'Solution:'
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pandas`, `numpy`, and `matplotlib`, as well as the `t-SNE` and `PCA`
    models from scikit-learn:'
  id: totrans-439
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入`pandas`、`numpy`和`matplotlib`，以及从scikit-learn导入`t-SNE`和`PCA`模型：
- en: '[PRE114]'
  id: totrans-440
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE114]'
- en: 'Load the Wine dataset and inspect the first five rows:'
  id: totrans-441
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载葡萄酒数据集并检查前五行：
- en: '[PRE115]'
  id: totrans-442
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE115]'
- en: 'The output is as follows:'
  id: totrans-443
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.30: The first five rows of the Wine dataset'
  id: totrans-444
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图6.30：葡萄酒数据集的前五行'
- en: '](img/B15923_06_30.jpg)'
  id: totrans-445
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_30.jpg)'
- en: 'Figure 6.30: The first five rows of the Wine dataset'
  id: totrans-446
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图6.30：葡萄酒数据集的前五行
- en: 'The first column provides the labels; extract them from the DataFrame and store
    them in a separate variable. Ensure that the column is removed from the DataFrame:'
  id: totrans-447
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第一列提供了标签；从DataFrame中提取它们并存储到单独的变量中。确保将该列从DataFrame中删除：
- en: '[PRE116]'
  id: totrans-448
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE116]'
- en: 'Execute PCA on the dataset and extract the first six components:'
  id: totrans-449
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对数据集执行PCA并提取前六个成分：
- en: '[PRE117]'
  id: totrans-450
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE117]'
- en: 'Construct a loop that iterates through the perplexity values (1, 5, 20, 30,
    80, 160, 320). For each loop, generate a t-SNE model with the corresponding perplexity
    and print a scatter plot of the labeled wine classes. Note the effect of different
    perplexity values:'
  id: totrans-451
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个循环，遍历困惑度值（1、5、20、30、80、160、320）。对于每个循环，生成一个带有相应困惑度的 t-SNE 模型，并打印带标签的葡萄酒类别的散点图。注意不同困惑度值的影响：
- en: '[PRE118]'
  id: totrans-452
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE118]'
- en: 'A perplexity value of 1 fails to separate the data into any particular structure:'
  id: totrans-453
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 困惑度值为 1 无法将数据分离成任何特定结构：
- en: '![Figure 6.31: Plot for perplexity of 1'
  id: totrans-454
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.31：困惑度为 1 的图]'
- en: '](img/B15923_06_31.jpg)'
  id: totrans-455
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_31.jpg)'
- en: 'Figure 6.31: Plot for perplexity of 1'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.31：困惑度为 1 的图
- en: 'Increasing the perplexity to 5 leads to a very non-linear structure that is
    difficult to separate, and it''s hard to identify any clusters or patterns:'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 增加困惑度到 5 会导致非常非线性的结构，难以分离，并且很难识别任何簇或模式：
- en: '![Figure 6.32: Plot for perplexity of 5'
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.32：困惑度为 5 的图]'
- en: '](img/B15923_06_32.jpg)'
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_32.jpg)'
- en: 'Figure 6.32: Plot for perplexity of 5'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.32：困惑度为 5 的图
- en: 'A perplexity of 20 finally starts to show some sort of horse-shoe structure.
    While visually obvious, this can still be tricky to implement:'
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 困惑度为 20 时，最终开始显示某种马蹄形结构。虽然在视觉上很明显，但实现起来仍然很棘手：
- en: '![Figure 6.33: Plot for perplexity of 20'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.33：困惑度为 20 的图]'
- en: '](img/B15923_06_33.jpg)'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_33.jpg)'
- en: 'Figure 6.33: Plot for perplexity of 20'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.33：困惑度为 20 的图
- en: 'A perplexity value of 30 demonstrates quite good results. There is a linear
    relationship between the projected structure with some separation between the
    types of wine:'
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 困惑度值为 30 显示了相当不错的结果。投影结构之间存在一定的线性关系，且葡萄酒类型之间有一定的分隔：
- en: '![Figure 6.34: Plot for perplexity of 30'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.34：困惑度为 30 的图]'
- en: '](img/B15923_06_34.jpg)'
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_34.jpg)'
- en: 'Figure 6.34: Plot for perplexity of 30'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.34：困惑度为 30 的图
- en: 'Finally, the last two images in the activity show the extent to which the plots
    can become increasingly complex and non-linear with increasing perplexity:'
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，活动中的最后两张图展示了随着困惑度（perplexity）增加，图表变得越来越复杂和非线性的程度：
- en: '![Figure 6.35: Plot for perplexity of 80'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.35：困惑度为 80 的图]'
- en: '](img/B15923_06_35.jpg)'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_35.jpg)'
- en: 'Figure 6.35: Plot for perplexity of 80'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.35：困惑度为 80 的图
- en: 'Here''s the plot for a perplexity value of 160:'
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 这是困惑度值为 160 时的图：
- en: '![Figure 6.36: Plot for perplexity of 160'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.36：困惑度为 160 的图]'
- en: '](img/B15923_06_36.jpg)'
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_36.jpg)'
- en: 'Figure 6.36: Plot for perplexity of 160'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.36：困惑度为 160 的图
- en: 'Finally, here''s the plot for a perplexity value of 320:'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，这是困惑度值为 320 时的图：
- en: '![Figure 6.37: Plot for perplexity of 320'
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.37：困惑度为 320 的图]'
- en: '](img/B15923_06_37.jpg)'
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_37.jpg)'
- en: 'Figure 6.37: Plot for perplexity of 320'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.37：困惑度为 320 的图
- en: By looking at the individual plots for each of the perplexity values, the effect
    perplexity has on the visualization of data is immediately obvious. Very small
    or very large perplexity values produce a range of unusual shapes that don't indicate
    the presence of any persistent pattern. The most plausible value seems to be 30
    (*Figure 6.35*), which produced the most linear plot.
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查看每个困惑度值的单独图表，困惑度对数据可视化的影响立刻显而易见。非常小或非常大的困惑度值会产生一系列不寻常的形状，这些形状无法表示任何持久的模式。最合适的值似乎是
    30（*图 6.35*），它产生了最线性的图表。
- en: In this activity, we demonstrated the need to be careful when selecting the
    perplexity and that some iteration may be required to determine the correct value.
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个活动中，我们展示了在选择困惑度时需要小心，并且可能需要一些迭代才能确定正确的值。
- en: Note
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3faqESn](https://packt.live/3faqESn).
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参阅 [https://packt.live/3faqESn](https://packt.live/3faqESn)。
- en: You can also run this example online at [https://packt.live/2AF12Oi](https://packt.live/2AF12Oi).
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以在线运行此示例，网址为 [https://packt.live/2AF12Oi](https://packt.live/2AF12Oi)。
- en: 'Activity 6.03: t-SNE Wine and Iterations'
  id: totrans-486
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 6.03：t-SNE 葡萄酒和迭代
- en: 'Solution:'
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import `pandas`, `numpy`, and `matplotlib`, as well as the `t-SNE` and `PCA`
    models from scikit-learn:'
  id: totrans-488
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入 `pandas`、`numpy` 和 `matplotlib`，以及来自 scikit-learn 的 `t-SNE` 和 `PCA` 模型：
- en: '[PRE119]'
  id: totrans-489
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE119]'
- en: 'Load the Wine dataset and inspect the first five rows:'
  id: totrans-490
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载葡萄酒数据集并检查前五行：
- en: '[PRE120]'
  id: totrans-491
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE120]'
- en: 'The output is as follows:'
  id: totrans-492
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.38: The first five rows of the Wine dataset'
  id: totrans-493
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.38：葡萄酒数据集的前五行]'
- en: '](img/B15923_06_38.jpg)'
  id: totrans-494
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_38.jpg)'
- en: 'Figure 6.38: The first five rows of the Wine dataset'
  id: totrans-495
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.38：葡萄酒数据集的前五行
- en: 'The first column provides the labels; extract these from the DataFrame and
    store them in a separate variable. Ensure that the column is removed from the
    DataFrame:'
  id: totrans-496
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第一列提供标签；从 DataFrame 中提取这些标签并将它们存储在一个单独的变量中。确保从 DataFrame 中删除该列：
- en: '[PRE121]'
  id: totrans-497
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE121]'
- en: 'Execute PCA on the dataset and extract the first six components:'
  id: totrans-498
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对数据集执行 PCA 并提取前六个组件：
- en: '[PRE122]'
  id: totrans-499
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE122]'
- en: 'Construct a loop that iterates through the iteration values (`250`, `500`,
    `1000`). For each loop, generate a t-SNE model with the corresponding number of
    iterations and identical number of iterations without progress values:'
  id: totrans-500
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个循环，遍历迭代值（`250`、`500`、`1000`）。对于每个循环，生成具有相应迭代次数和相同进展值但不同迭代次数的 t-SNE 模型：
- en: '[PRE123]'
  id: totrans-501
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE123]'
- en: 'Construct a scatter plot of the labeled wine classes. Note the effect of different
    iteration values:'
  id: totrans-502
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制标记的葡萄酒类别散点图。注意不同迭代值的影响：
- en: '[PRE124]'
  id: totrans-503
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE124]'
- en: 'The output is as follows:'
  id: totrans-504
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.39: Scatter plot of wine classes with 250 iterations'
  id: totrans-505
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.39：带有 250 次迭代的葡萄酒类别散点图'
- en: '](img/B15923_06_39.jpg)'
  id: totrans-506
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_06_39.jpg)'
- en: 'Figure 6.39: Scatter plot of wine classes with 250 iterations'
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.39：带有 250 次迭代的葡萄酒类别散点图
- en: 'Here''s the plot for 500 iterations:'
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 500 次迭代的情况图：
- en: '![Figure 6.40: Scatter plot of wine classes with 500 iterations'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.40：带有 500 次迭代的葡萄酒类别散点图'
- en: '](img/B15923_06_40.jpg)'
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_40.jpg)'
- en: 'Figure 6.40: Scatter plot of wine classes with 500 iterations'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.40：带有 500 次迭代的葡萄酒类别散点图
- en: 'Here''s the plot for 1,000 iterations:'
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 1,000 次迭代的情况图：
- en: '![Figure 6.41: Scatter plot of wine classes with 1,000 iterations'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.41：带有 1,000 次迭代的葡萄酒类别散点图'
- en: '](img/B15923_06_41.jpg)'
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_06_41.jpg)'
- en: 'Figure 6.41: Scatter plot of wine classes with 1,000 iterations'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.41：带有 1,000 次迭代的葡萄酒类别散点图
- en: Again, we can see an improvement in the structure of the data as the number
    of iterations increases. Even in a relatively simple dataset such as this, 250
    iterations is not sufficient to project any structure of data into the lower-dimensional
    space.
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们可以看到随着迭代次数的增加，数据结构得到了改善。即使在这样一个相对简单的数据集中，250 次迭代也不足以将数据结构投射到低维空间中。
- en: As we observed in this activity, there is a balance to find in setting the iteration
    parameter. In this example, 250 iterations were insufficient, and at least 1,000
    iterations were required to stabilize the data.
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在本活动中观察到的，设置迭代参数是一个平衡点。在本例中，250 次迭代不足，至少需要 1,000 次迭代才能稳定数据。
- en: Note
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2ZOJuYv](https://packt.live/2ZOJuYv).
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参阅[https://packt.live/2ZOJuYv](https://packt.live/2ZOJuYv)。
- en: You can also run this example online at [https://packt.live/2Z8wEoP](https://packt.live/2Z8wEoP).
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在[https://packt.live/2Z8wEoP](https://packt.live/2Z8wEoP)上线上运行此示例。
- en: 7\. Topic Modeling
  id: totrans-521
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 7\. 主题建模
- en: 'Activity 7.01: Loading and Cleaning Twitter Data'
  id: totrans-522
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 7.01：加载和清洗 Twitter 数据
- en: 'Solution:'
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the necessary libraries:'
  id: totrans-524
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入必要的库：
- en: '[PRE125]'
  id: totrans-525
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE125]'
- en: Load the LA Times health Twitter data (`latimeshealth.txt`) from [https://packt.live/2Xje5xF](https://packt.live/2Xje5xF).
  id: totrans-526
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[https://packt.live/2Xje5xF](https://packt.live/2Xje5xF)加载 LA Times 健康 Twitter
    数据（`latimeshealth.txt`）。
- en: '[PRE126]'
  id: totrans-527
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE126]'
- en: 'Run a quick exploratory analysis to ascertain the data size and structure:'
  id: totrans-528
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行快速的探索性分析来确定数据的大小和结构：
- en: '[PRE127]'
  id: totrans-529
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE127]'
- en: 'The output is as follows:'
  id: totrans-530
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.49: Shape, column names, and head of data'
  id: totrans-531
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.49：数据形状、列名和数据头'
- en: '](img/B15923_07_49.jpg)'
  id: totrans-532
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_49.jpg)'
- en: 'Figure 7.49: Shape, column names, and head of data'
  id: totrans-533
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.49：数据形状、列名和数据头
- en: 'Extract the tweet text and convert it to a list object:'
  id: totrans-534
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提取推文文本并将其转换为列表对象：
- en: '[PRE128]'
  id: totrans-535
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE128]'
- en: 'The output is as follows:'
  id: totrans-536
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.50: Headlines and their length'
  id: totrans-537
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.50：标题及其长度'
- en: '](img/B15923_07_50.jpg)'
  id: totrans-538
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_50.jpg)'
- en: 'Figure 7.50: Headlines and their length'
  id: totrans-539
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.50：标题及其长度
- en: Write a function to perform language detection and tokenization on white spaces,
    and then replace the screen names and URLs with `SCREENNAME` and `URL`, respectively.
    The function should also remove punctuation, numbers, and the `SCREENNAME` and
    `URL` replacements. Convert everything to lowercase, except `SCREENNAME` and `URL`.
    It should remove all stop words, perform lemmatization, and keep words with five
    or more letters only.
  id: totrans-540
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个函数，在空格上执行语言检测和分词，然后将屏幕名称和网址分别替换为`SCREENNAME`和`URL`。该函数还应删除标点符号、数字以及`SCREENNAME`和`URL`的替换内容。将所有内容转换为小写，除了`SCREENNAME`和`URL`之外。它应该移除所有停用词，执行词形归并，并仅保留五个或更多字母的单词。
- en: '[PRE129]'
  id: totrans-541
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE129]'
- en: 'Apply the function defined in *Step 5* to every tweet:'
  id: totrans-542
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将第 5 步定义的函数应用于每条推文：
- en: '[PRE130]'
  id: totrans-543
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE130]'
- en: 'Remove elements of the output list equal to `None`:'
  id: totrans-544
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除输出列表中等于 `None` 的元素：
- en: '[PRE131]'
  id: totrans-545
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE131]'
- en: 'The output is as follows:'
  id: totrans-546
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.51: Headlines and length after removing None'
  id: totrans-547
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.51: 移除 None 后的标题和长度](img/B15923_07_51.jpg)'
- en: '](img/B15923_07_51.jpg)'
  id: totrans-548
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_51.jpg)'
- en: 'Figure 7.51: Headlines and length after removing None'
  id: totrans-549
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.51: 移除 None 后的标题和长度'
- en: 'Turn the elements of each tweet back into a string. Concatenate using white
    space:'
  id: totrans-550
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将每条推文的元素重新转换为字符串。使用空格连接：
- en: '[PRE132]'
  id: totrans-551
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE132]'
- en: 'The first 10 elements of the output list should resemble the following:'
  id: totrans-552
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出列表的前 10 个元素应类似于以下内容：
- en: '![Figure 7.52: Tweets cleaned for modeling'
  id: totrans-553
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.52: 已清理用于建模的推文](img/B15923_07_52.jpg)'
- en: '](img/B15923_07_22.jpg)'
  id: totrans-554
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_22.jpg)'
- en: 'Figure 7.52: Tweets cleaned for modeling'
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: '图 7.52: 已清理用于建模的推文'
- en: Keep the notebook open for future activities. By completing this activity, you
    should now be fairly comfortable working with textual data and preparing it for
    topic modeling. An important callout would be to recognize the subtle differences
    in data cleaning needs between the exercises and the activity. Modeling is not
    a one-size-fits-all process, which is obvious if you spend sufficient time exploring
    the data before starting any modeling work.
  id: totrans-556
  prefs: []
  type: TYPE_NORMAL
  zh: 保持笔记本打开，便于未来的活动。完成此活动后，你现在应该能够相当自如地处理文本数据并为主题建模做好准备。一个重要的提示是，要注意练习和活动之间在数据清理需求上的细微差别。建模不是一成不变的过程，如果你在开始建模工作前花足够的时间探索数据，这一点会非常明显。
- en: Note
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3e3VifV](https://packt.live/3e3VifV).
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考[https://packt.live/3e3VifV](https://packt.live/3e3VifV)。
- en: You can also run this example online at [https://packt.live/3fegXlU](https://packt.live/3fegXlU).
    You must execute the entire Notebook in order to get the desired result.
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在[https://packt.live/3fegXlU](https://packt.live/3fegXlU)在线运行这个示例。你必须执行整个笔记本，才能得到期望的结果。
- en: 'Activity 7.02: LDA and Health Tweets'
  id: totrans-560
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '活动 7.02: LDA 和健康推文'
- en: 'Solution:'
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Specify the `number_words`, `number_docs`, and `number_features` variables:'
  id: totrans-562
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定 `number_words`、`number_docs` 和 `number_features` 变量：
- en: '[PRE133]'
  id: totrans-563
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE133]'
- en: 'Create a bag-of-words model and assign the feature names to another variable
    for use later on:'
  id: totrans-564
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个词袋模型并将特征名称赋值给另一个变量，以便后续使用：
- en: '[PRE134]'
  id: totrans-565
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE134]'
- en: 'The output is as follows:'
  id: totrans-566
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE135]'
  id: totrans-567
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE135]'
- en: 'Identify the optimal number of topics:'
  id: totrans-568
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定最优主题数量：
- en: '[PRE136]'
  id: totrans-569
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE136]'
- en: 'The output is as follows:'
  id: totrans-570
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.53: Number of topics versus the perplexity score DataFrame'
  id: totrans-571
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.53: 主题数量与困惑度分数的数据框](img/B15923_07_53.jpg)'
- en: '](img/B15923_07_53.jpg)'
  id: totrans-572
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_53.jpg)'
- en: 'Figure 7.53: Number of topics versus the perplexity score DataFrame'
  id: totrans-573
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.53: 主题数量与困惑度分数的数据框'
- en: 'Fit the LDA model using the optimal number of topics:'
  id: totrans-574
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用最优主题数量拟合 LDA 模型：
- en: '[PRE137]'
  id: totrans-575
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE137]'
- en: 'The output is as follows:'
  id: totrans-576
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.54: The LDA model'
  id: totrans-577
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.54: LDA 模型](img/B15923_07_54.jpg)'
- en: '](img/B15923_07_54.jpg)'
  id: totrans-578
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_54.jpg)'
- en: 'Figure 7.54: The LDA model'
  id: totrans-579
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.54: LDA 模型'
- en: 'Create and print the word-topic table:'
  id: totrans-580
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建并打印词汇-主题表：
- en: '[PRE138]'
  id: totrans-581
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE138]'
- en: 'The output is as follows:'
  id: totrans-582
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.55: Word-topic table for the health tweet data'
  id: totrans-583
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.55: 健康推文数据的词汇-主题表](img/B15923_07_53.jpg)'
- en: '](img/B15923_07_55.jpg)'
  id: totrans-584
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_55.jpg)'
- en: 'Figure 7.55: Word-topic table for the health tweet data'
  id: totrans-585
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.55: 健康推文数据的词汇-主题表'
- en: Note
  id: totrans-586
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: The results can differ slightly from what is shown because of the optimization
    algorithms that support both LDA and NMF. Many of the functions do not have a
    seed setting capability.
  id: totrans-587
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 由于支持 LDA 和 NMF 的优化算法，结果可能与所示略有不同。许多函数没有设置种子值的功能。
- en: 'Print the document-topic table:'
  id: totrans-588
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印文档-主题表：
- en: '[PRE139]'
  id: totrans-589
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE139]'
- en: 'The output is as follows:'
  id: totrans-590
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.56: Document topic table'
  id: totrans-591
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.56: 文档主题表](img/B15923_07_56.jpg)'
- en: '](img/B15923_07_56.jpg)'
  id: totrans-592
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_56.jpg)'
- en: 'Figure 7.56: Document topic table'
  id: totrans-593
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.56: 文档主题表'
- en: 'Create a biplot visualization:'
  id: totrans-594
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个双变量图可视化：
- en: '[PRE140]'
  id: totrans-595
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE140]'
- en: 'The output is as follows:'
  id: totrans-596
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 7.57: A histogram and biplot for the LDA model trained on health tweets'
  id: totrans-597
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.57: LDA 模型对健康推文的直方图和双变量图](img/B15923_07_54.jpg)'
- en: '](img/B15923_07_39.jpg)'
  id: totrans-598
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_39.jpg)'
- en: 'Figure 7.57: A histogram and biplot for the LDA model trained on health tweets'
  id: totrans-599
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图 7.57: LDA 模型对健康推文的直方图和双变量图'
- en: Keep the notebook open for future modeling.
  id: totrans-600
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持笔记本打开，以便进行未来的建模。
- en: Before discussing the next topic modeling methodology, non-negative matrix factorization,
    let's work through another bag-of-words modeling approach. You'll recall that
    the `CountVectorizer` algorithm returned the simple count of the number of times
    each word appeared in each document. In this new approach, called TF-IDF or Term
    Frequency – Inverse Document Frequency, weights representing the importance of
    each word to each document are returned instead of the raw counts.
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论下一个主题建模方法之前——非负矩阵分解，我们先通过另一个词袋建模方法。你还记得 `CountVectorizer` 算法是如何返回每个词在每个文档中出现次数的简单计数的吧？在这个新方法中，称为
    TF-IDF（词频-逆文档频率），返回的是代表每个词在每个文档中重要性的权重，而不是原始的计数。
- en: Both the `CountVectorizer` and `TfidfVectorizer` approaches are equally valid.
    When and how each is used depends on the corpus, the topic modeling methodology
    being used, and the amount of noise in the documents. For this next exercise,
    we will use `TfidfVectorizer` and use the output to build the NMF models appearing
    later on in the chapter.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: '`CountVectorizer` 和 `TfidfVectorizer` 两种方法同样有效。何时以及如何使用它们，取决于语料库、使用的主题建模方法以及文档中的噪声量。在接下来的练习中，我们将使用
    `TfidfVectorizer`，并利用输出构建本章稍后出现的 NMF 模型。'
- en: Note
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3e3VifV](https://packt.live/3e3VifV).
  id: totrans-604
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问该特定部分的源代码，请参考 [https://packt.live/3e3VifV](https://packt.live/3e3VifV)。
- en: You can also run this example online at [https://packt.live/3fegXlU](https://packt.live/3fegXlU).
    You must execute the entire Notebook in order to get the desired result.
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在 [https://packt.live/3fegXlU](https://packt.live/3fegXlU) 在线运行此示例。您必须执行整个
    Notebook 才能获得期望的结果。
- en: 'Activity 7.03: Non-negative Matrix Factorization'
  id: totrans-606
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 7.03：非负矩阵分解
- en: 'Solution:'
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Create the appropriate bag-of-words model and output the feature names as another
    variable:'
  id: totrans-608
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建适当的词袋模型，并将特征名称作为另一个变量输出：
- en: '[PRE141]'
  id: totrans-609
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE141]'
- en: 'Define and fit the NMF algorithm using the number of topics (`n_components`)
    value from *Activity 7.02*, *LDA and Health Tweets*:'
  id: totrans-610
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 *活动 7.02* 中的主题数（`n_components`）值来定义并拟合 NMF 算法，*LDA 和健康推文*：
- en: '[PRE142]'
  id: totrans-611
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE142]'
- en: 'The output is as follows:'
  id: totrans-612
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.58: Defining the NMF model'
  id: totrans-613
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.58：定义 NMF 模型'
- en: '](img/B15923_07_58.jpg)'
  id: totrans-614
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_58.jpg)'
- en: 'Figure 7.58: Defining the NMF model'
  id: totrans-615
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.58：定义 NMF 模型
- en: 'Get the topic-document and word-topic tables. Take a few minutes to explore
    the word groupings and try to define the abstract topics:'
  id: totrans-616
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取主题-文档表和词-主题表。花几分钟探索词汇分组，并尝试定义抽象的主题：
- en: '[PRE143]'
  id: totrans-617
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE143]'
- en: 'The output is as follows:'
  id: totrans-618
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.59: Word-topic table'
  id: totrans-619
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.59：词-主题表'
- en: '](img/B15923_07_59.jpg)'
  id: totrans-620
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_59.jpg)'
- en: '[PRE144]'
  id: totrans-621
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE144]'
- en: 'The output is as follows:'
  id: totrans-622
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.60: The topic-document tables with probabilities'
  id: totrans-623
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 7.60：带有概率的主题-文档表'
- en: '](img/B15923_07_60.jpg)'
  id: totrans-624
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_07_60.jpg)'
- en: 'Figure 7.60: The topic-document tables with probabilities'
  id: totrans-625
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.60：带有概率的主题-文档表
- en: Adjust the model parameters and rerun *Step 3* and *Step 4*.
  id: totrans-626
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调整模型参数，并重新运行 *步骤 3* 和 *步骤 4*。
- en: In this activity, we worked through an example topic modeling scenario using
    the TF-IDF bag-of-words model and non-negative matrix factorization. What is really
    important in these examples is trying to understand what the algorithms are doing—not
    just how to fit them—and to comprehend the results. Working with text data is
    often complex and it is crucial to realize that not every algorithm will return
    meaningful results every time. Sometimes, the results are just not useful. That
    is not a reflection on the algorithm or the practitioner; it is simply an example
    of the challenge of extracting insights from data.
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个活动中，我们使用 TF-IDF 词袋模型和非负矩阵分解进行了一个主题建模示例。这里真正重要的是理解这些算法在做什么——而不仅仅是如何拟合它们——并理解结果。处理文本数据通常是复杂的，必须认识到并非每个算法每次都会返回有意义的结果。有时，结果根本就没有用。这不是对算法或从业者的反映，而是从数据中提取洞察的挑战之一。
- en: Note
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3e3VifV](https://packt.live/3e3VifV).
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问该特定部分的源代码，请参考 [https://packt.live/3e3VifV](https://packt.live/3e3VifV)。
- en: You can also run this example online at [https://packt.live/3fegXlU](https://packt.live/3fegXlU).
    You must execute the entire Notebook in order to get the desired result.
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在 [https://packt.live/3fegXlU](https://packt.live/3fegXlU) 在线运行此示例。您必须执行整个
    Notebook 才能获得期望的结果。
- en: 8\. Market Basket Analysis
  id: totrans-631
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 8\. 市场篮分析
- en: 'Activity 8.01: Loading and Preparing Full Online Retail Data'
  id: totrans-632
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 8.01：加载和准备完整的在线零售数据
- en: 'Solution:'
  id: totrans-633
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-634
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库：
- en: '[PRE145]'
  id: totrans-635
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE145]'
- en: 'Load the online retail dataset file:'
  id: totrans-636
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载在线零售数据集文件：
- en: '[PRE146]'
  id: totrans-637
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE146]'
- en: 'Clean and prep the data for modeling, including turning the cleaned data into
    a list of lists:'
  id: totrans-638
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 清理并准备数据用于建模，包括将清理后的数据转换为列表的列表：
- en: '[PRE147]'
  id: totrans-639
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE147]'
- en: 'Encode the data and recast it as a DataFrame. The data is fairly large, so
    to ensure that everything executes correctly, use a machine with at least 8 GB
    of memory:'
  id: totrans-640
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对数据进行编码并将其重新构建为数据框。由于数据量相当大，因此为了确保一切顺利执行，请使用至少具有 8 GB 内存的计算机：
- en: '[PRE148]'
  id: totrans-641
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE148]'
- en: 'The output is as follows:'
  id: totrans-642
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 8.34: A subset of the cleaned, encoded, and recast DataFrame built
    from the complete online retail dataset'
  id: totrans-643
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.34：从完整的在线零售数据集构建的清理、编码和重构后的数据框的一个子集'
- en: '](img/B15923_08_16.jpg)'
  id: totrans-644
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_16.jpg)'
- en: 'Figure 8.34: A subset of the cleaned, encoded, and recast DataFrame built from
    the complete online retail dataset'
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.34：从完整的在线零售数据集构建的清理、编码和重构后的数据框的一个子集
- en: Note
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 注：
- en: To access the source code for this specific section, please refer to [https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz).
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参阅 [https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz)。
- en: This section does not currently have an online interactive example and will
    need to be run locally.
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: 本节目前没有在线交互示例，需要在本地运行。
- en: 'Activity 8.02: Running the Apriori Algorithm on the Complete Online Retail
    Dataset'
  id: totrans-649
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 8.02：在完整在线零售数据集上运行 Apriori 算法
- en: 'Solution:'
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Run the Apriori algorithm on the full data with reasonable parameter settings:'
  id: totrans-651
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在完整数据上运行 Apriori 算法，使用合理的参数设置：
- en: '[PRE149]'
  id: totrans-652
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE149]'
- en: 'The output is as follows:'
  id: totrans-653
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 8.35: The Apriori algorithm results using the complete online retail
    dataset'
  id: totrans-654
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.35：使用完整在线零售数据集的 Apriori 算法结果'
- en: '](img/B15923_08_35.jpg)'
  id: totrans-655
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_35.jpg)'
- en: 'Figure 8.35: The Apriori algorithm results using the complete online retail
    dataset'
  id: totrans-656
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.35：使用完整在线零售数据集的 Apriori 算法结果
- en: 'Filter the results down to the item set containing `10 COLOUR SPACEBOY PEN`.
    Compare the support value with that under *Exercise 8.06*, *Executing the Apriori
    Algorithm*:'
  id: totrans-657
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将结果过滤到包含 `10 COLOUR SPACEBOY PEN` 的项集。将支持度值与 *练习 8.06* 中的结果进行比较，*执行 Apriori
    算法*：
- en: '[PRE150]'
  id: totrans-658
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE150]'
- en: 'The output is as follows:'
  id: totrans-659
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 8.36: Result of item set containing 10 COLOUR SPACEBOY PEN'
  id: totrans-660
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.36：包含 10 COLOUR SPACEBOY PEN 的项集结果'
- en: '](img/B15923_08_36.jpg)'
  id: totrans-661
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_36.jpg)'
- en: 'Figure 8.36: Result of item set containing 10 COLOUR SPACEBOY PEN'
  id: totrans-662
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.36：包含 10 COLOUR SPACEBOY PEN 的项集结果
- en: The support value does change. When the dataset is expanded to include all transactions,
    the support for this item set drops from 0.0178 to 0.015793\. That is, in the
    reduced dataset used for the exercises, this item set appears in 1.78% of the
    transactions, while in the full dataset, it appears in approximately 1.6% of transactions.
  id: totrans-663
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 支持度值确实发生了变化。当数据集扩展到包含所有交易时，该项集的支持度从 0.0178 降到 0.015793。也就是说，在用于练习的简化数据集里，该项集出现在
    1.78% 的交易中，而在完整数据集中，它出现在大约 1.6% 的交易中。
- en: Add another column containing the item set length. Then, filter down to those
    item sets whose length is two and whose support is in the range [`0.02`, `0.021`].
    Are the item sets the same as those found in *Exercise 8.06*, *Executing the Apriori
    Algorithm*, *Step 6*?
  id: totrans-664
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加另一列，包含项集的长度。然后，过滤掉那些长度为 2 且支持度在 [`0.02`, `0.021`] 范围内的项集。与 *练习 8.06* 中的项集相同吗？*执行
    Apriori 算法*，*第 6 步*？
- en: '[PRE151]'
  id: totrans-665
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE151]'
- en: 'The output is as follows:'
  id: totrans-666
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 8.37: The results of filtering based on length and support'
  id: totrans-667
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.37：基于长度和支持度过滤的结果'
- en: '](img/B15923_08_37.jpg)'
  id: totrans-668
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_37.jpg)'
- en: 'Figure 8.37: The results of filtering based on length and support'
  id: totrans-669
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.37：基于长度和支持度过滤的结果
- en: The results did change. Before even looking at the particular item sets and
    their support values, we see that this filtered DataFrame has fewer item sets
    than the DataFrame in the preceding exercise. When we use the full dataset, there
    are fewer item sets that match the filtering criteria; that is, only 17 item sets
    contain 2 items and have a support value greater than or equal to `0.02`, and
    less than `0.021`. In the previous exercise, 32 item sets met these criteria.
  id: totrans-670
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果确实发生了变化。在查看特定项集及其支持度值之前，我们发现这个过滤后的数据框比前一个练习中的数据框少了项集。当我们使用完整数据集时，符合过滤条件的项集更少；也就是说，只有
    17 个项集包含 2 个项目，并且支持度值大于或等于 `0.02`，小于 `0.021`。在上一个练习中，有 32 个项集符合这些标准。
- en: 'Plot the `support` values:'
  id: totrans-671
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制 `support` 值：
- en: '[PRE152]'
  id: totrans-672
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE152]'
- en: 'The output is as follows:'
  id: totrans-673
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 8.38: The distribution of support values'
  id: totrans-674
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.38：支持度值的分布'
- en: '](img/B15923_08_38.jpg)'
  id: totrans-675
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_38.jpg)'
- en: 'Figure 8.38: The distribution of support values'
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.38：支持度值的分布
- en: This plot shows the distribution of support values for the full transaction
    dataset. As you might have assumed, the distribution is right-skewed; that is,
    most of the item sets have lower support values and there is a long tail of support
    values on the higher end of the spectrum. Given how many unique item sets exist,
    it is not surprising that no single item set appears in a high percentage of the
    transactions. With this information, we could tell management that even the most
    prominent item set only appears in approximately 10% of transactions and that
    the vast majority of item sets appear in fewer than 2% of transactions. These
    results may not support changes in store layout, but could very well inform pricing
    and discounting strategies. We would gain more information on how to build these
    strategies by formalizing a number of association rules.
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: 该图显示了完整交易数据集的支持度分布。如你所料，分布呈右偏；即，大多数项集的支持度较低，并且在分布的高端有一长尾。鉴于存在如此多的独特项集，单一项集出现在大多数交易中的比例并不高也不足为奇。有了这些信息，我们可以告诉管理层，即使是最显著的项集，也仅出现在约
    10% 的交易中，而绝大多数项集出现在不到 2% 的交易中。这些结果可能无法支持店面布局的调整，但却可以为定价和折扣策略提供很好的参考。通过形式化一系列关联规则，我们可以获得更多关于如何制定这些策略的信息。
- en: Note
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz).
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问该特定部分的源代码，请参见 [https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz)。
- en: This section does not currently have an online interactive example and will
    need to be run locally.
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: 目前本节没有在线互动示例，需在本地运行。
- en: 'Activity 8.03: Finding the Association Rules on the Complete Online Retail
    Dataset'
  id: totrans-681
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 8.03：在完整在线零售数据集上寻找关联规则
- en: 'Solution:'
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Fit the association rule model on the full dataset. Use the confidence metric
    and a minimum threshold of `0.6`:'
  id: totrans-683
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在完整数据集上拟合关联规则模型。使用置信度度量和最小阈值 `0.6`：
- en: '[PRE153]'
  id: totrans-684
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE153]'
- en: 'The output is as follows:'
  id: totrans-685
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 8.39: The association rules based on the complete online retail dataset'
  id: totrans-686
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.39：基于完整在线零售数据集的关联规则'
- en: '](img/B15923_08_39.jpg)'
  id: totrans-687
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_39.jpg)'
- en: 'Figure 8.39: The association rules based on the complete online retail dataset'
  id: totrans-688
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.39：基于完整在线零售数据集的关联规则
- en: Count the number of association rules. Is the number different from that found
    in *Exercise 8.07*, *Deriving Association Rules*, *Step 1*?
  id: totrans-689
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算关联规则的数量。这个数字与 *练习 8.07*、*推导关联规则*、*步骤 1* 中的结果有区别吗？
- en: '[PRE154]'
  id: totrans-690
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE154]'
- en: There are `498` association rules. Yes, the count is different.
  id: totrans-691
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 有 `498` 条关联规则。是的，数量有所不同。
- en: 'Plot confidence against support:'
  id: totrans-692
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制置信度与支持度的关系图：
- en: '[PRE155]'
  id: totrans-693
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE155]'
- en: 'The output is as follows:'
  id: totrans-694
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 8.40: The plot of confidence against support'
  id: totrans-695
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.40：置信度与支持度的关系图'
- en: '](img/B15923_08_40.jpg)'
  id: totrans-696
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_40.jpg)'
- en: 'Figure 8.40: The plot of confidence against support'
  id: totrans-697
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.40：置信度与支持度的关系图
- en: The plot reveals that there are some association rules featuring relatively
    high support and confidence values for this dataset.
  id: totrans-698
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 该图揭示了该数据集中一些关联规则具有较高的支持度和置信度值。
- en: 'Look at the distributions of lift, leverage, and conviction:'
  id: totrans-699
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看提升值、杠杆值和信念值的分布：
- en: '[PRE156]'
  id: totrans-700
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE156]'
- en: 'The output is as follows:'
  id: totrans-701
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 8.41: The distribution of lift values'
  id: totrans-702
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 8.41：提升值的分布'
- en: '](img/B15923_08_41.jpg)'
  id: totrans-703
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_08_41.jpg)'
- en: 'Figure 8.41: The distribution of lift values'
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.41：提升值的分布
- en: 'Plot the leverage as follows:'
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制杠杆值，如下所示：
- en: '[PRE157]'
  id: totrans-706
  prefs: []
  type: TYPE_PRE
  zh: '[PRE157]'
- en: 'The output is as follows:'
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 8.42: The distribution of leverage values'
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.42：杠杆值的分布'
- en: '](img/B15923_08_42.jpg)'
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_08_42.jpg)'
- en: 'Figure 8.42: The distribution of leverage values'
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.42：杠杆值的分布
- en: 'Plot the conviction as follows:'
  id: totrans-711
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制信念值，如下所示：
- en: '[PRE158]'
  id: totrans-712
  prefs: []
  type: TYPE_PRE
  zh: '[PRE158]'
- en: 'The output is as follows:'
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 8.43: The distribution of conviction values'
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.43：信念值的分布'
- en: '](img/B15923_08_43.jpg)'
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_08_43.jpg)'
- en: 'Figure 8.43: The distribution of conviction values'
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.43：信念值的分布
- en: Having derived association rules, we can return to management with additional
    information, the most important of which would be that there are roughly seven
    item sets that have reasonably high values for both support and confidence. Look
    at the scatterplot of confidence against support to see the seven item sets that
    are separated from all the others. These seven item sets also have high lift values,
    as can be seen in the lift histogram. It seems that we have identified a number
    of actionable association rules – rules that we can use to drive business decisions.
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: 在推导出关联规则后，我们可以为管理层提供附加信息，其中最重要的是大约有七个项目集在支持度和置信度方面都有合理的较高值。查看置信度与支持度的散点图，看看这七个项目集与其他所有项目集是如何分开的。这七个项目集也有较高的提升值，如提升直方图所示。看来我们已经识别出了一些可操作的关联规则——这些规则可以用来推动商业决策。
- en: Note
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz).
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: 若要访问此特定部分的源代码，请参阅[https://packt.live/2Wf2Rcz](https://packt.live/2Wf2Rcz)。
- en: This section does not currently have an online interactive example and will
    need to be run locally.
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: 本节目前没有在线交互式示例，需要在本地运行。
- en: 9\. Hotspot Analysis
  id: totrans-721
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 9\. 热点分析
- en: 'Activity 9.01: Estimating Density in One Dimension'
  id: totrans-722
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动9.01：一维密度估计
- en: 'Solution:'
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: Open a new notebook and install all the necessary libraries.
  id: totrans-724
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的笔记本并安装所有必要的库。
- en: '[PRE159]'
  id: totrans-725
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE159]'
- en: 'Sample 1,000 data points from the standard normal distribution. Add 3.5 to
    each of the last 625 values of the sample (that is, the indices between 375 and
    1,000). Set a random state of 100 using `numpy.random.RandomState` to guarantee
    the same sampled values, and then randomly generate the data points using the
    `rand.randn(1000)` call:'
  id: totrans-726
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从标准正态分布中抽取1,000个数据点。将3.5加到样本中最后625个值（即索引在375到1,000之间的值）。使用`numpy.random.RandomState`设置随机状态为100，以保证采样值一致，然后使用`rand.randn(1000)`调用随机生成数据点：
- en: '[PRE160]'
  id: totrans-727
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE160]'
- en: 'Plot the 1,000-point sample data as a histogram and add a scatterplot below
    it:'
  id: totrans-728
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将1,000个数据点样本绘制成直方图，并在其下方添加一个散点图：
- en: '[PRE161]'
  id: totrans-729
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE161]'
- en: 'The output is as follows:'
  id: totrans-730
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.30: A histogram of the random sample with a scatterplot underneath'
  id: totrans-731
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.30：带有散点图的随机样本直方图'
- en: '](img/B15923_09_30.jpg)'
  id: totrans-732
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_30.jpg)'
- en: 'Figure 9.30: A histogram of the random sample with a scatterplot underneath'
  id: totrans-733
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.30：带有散点图的随机样本直方图
- en: 'Define a grid of bandwidth values. Then, define and fit a grid search cross-validation
    algorithm:'
  id: totrans-734
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一组带宽值的网格。然后，定义并拟合一个网格搜索交叉验证算法：
- en: '[PRE162]'
  id: totrans-735
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE162]'
- en: 'The output is as follows:'
  id: totrans-736
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.31: Output of cross-validation model'
  id: totrans-737
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.31：交叉验证模型的输出'
- en: '](img/B15923_09_31.jpg)'
  id: totrans-738
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_31.jpg)'
- en: 'Figure 9.31: Output of cross-validation model'
  id: totrans-739
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.31：交叉验证模型的输出
- en: 'Extract the optimal bandwidth value:'
  id: totrans-740
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提取最优带宽值：
- en: '[PRE163]'
  id: totrans-741
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE163]'
- en: The optimal bandwidth value is approximately `0.4`.
  id: totrans-742
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最优带宽值大约为`0.4`。
- en: 'Replot the histogram from *Step 3* and overlay the estimated density:'
  id: totrans-743
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新绘制*第3步*中的直方图，并叠加估计的密度：
- en: '[PRE164]'
  id: totrans-744
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE164]'
- en: 'The output is as follows:'
  id: totrans-745
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.32: A histogram of the random sample with the optimal estimated
    density overlaid'
  id: totrans-746
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.32：带有最优估计密度的随机样本直方图'
- en: '](img/B15923_09_32.jpg)'
  id: totrans-747
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_32.jpg)'
- en: 'Figure 9.32: A histogram of the random sample with the optimal estimated density
    overlaid'
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.32：带有最优估计密度的随机样本直方图
- en: Note
  id: totrans-749
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2wmh5yj](https://packt.live/2wmh5yj).
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: 若要访问此特定部分的源代码，请参阅[https://packt.live/2wmh5yj](https://packt.live/2wmh5yj)。
- en: You can also run this example online at [https://packt.live/2W0EAGK](https://packt.live/2W0EAGK).
  id: totrans-751
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以在网上运行此示例，网址为[https://packt.live/2W0EAGK](https://packt.live/2W0EAGK)。
- en: 'Activity 9.02: Analyzing Crime in London'
  id: totrans-752
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动9.02：伦敦犯罪分析
- en: 'Solution:'
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Load the crime data. Use the path where you saved the downloaded directory,
    create a list of the year-month tags, use the `read_csv` command to load the individual
    files iteratively, and then concatenate these files together:'
  id: totrans-754
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载犯罪数据。使用保存下载目录的路径，创建一个年份-月份标签的列表，使用`read_csv`命令迭代加载各个文件，然后将这些文件合并在一起：
- en: '[PRE165]'
  id: totrans-755
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE165]'
- en: 'The output is as follows:'
  id: totrans-756
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE166]'
  id: totrans-757
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE166]'
- en: 'Define the list of year month combinations as follows:'
  id: totrans-758
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义年份和月份组合的列表如下：
- en: '[PRE167]'
  id: totrans-759
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE167]'
- en: 'The output is as follows:'
  id: totrans-760
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE168]'
  id: totrans-761
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE168]'
- en: 'Load the data and print some basic information about it as follows:'
  id: totrans-762
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载数据并打印一些基本信息，如下所示：
- en: '[PRE169]'
  id: totrans-763
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE169]'
- en: 'The output is as follows:'
  id: totrans-764
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.33: An example of one of the individual crime files'
  id: totrans-765
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.33：其中一个单独犯罪文件的示例'
- en: '](img/B15923_09_33.jpg)'
  id: totrans-766
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_33.jpg)'
- en: 'Figure 9.33: An example of one of the individual crime files'
  id: totrans-767
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.33：单个犯罪文件的示例
- en: This printed information is just for the first of the loaded files, which will
    be the criminal information from the Metropolitan Police Service for July 2018\.
    This one file has nearly 100,000 entries. You will notice that there is a great
    deal of interesting information in this dataset, but we will focus on `Longitude`,
    `Latitude`, `Month`, and `Crime type`.
  id: totrans-768
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 打印出的信息仅适用于加载的第一个文件，即2018年7月来自大都会警察局的犯罪数据。该文件包含近10万个条目。你会注意到，这个数据集中有大量有趣的信息，但我们将重点关注`Longitude`（经度）、`Latitude`（纬度）、`Month`（月份）和`Crime
    type`（犯罪类型）。
- en: 'Print diagnostics of the complete and concatenated dataset:'
  id: totrans-769
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印完整且合并的数据集的诊断信息：
- en: '[PRE170]'
  id: totrans-770
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE170]'
- en: 'The output is as follows:'
  id: totrans-771
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.34: Descriptors of the full crime dataset'
  id: totrans-772
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.34：完整犯罪数据集的描述符'
- en: '](img/B15923_09_34.jpg)'
  id: totrans-773
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_34.jpg)'
- en: 'Figure 9.34: Descriptors of the full crime dataset'
  id: totrans-774
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.34：完整犯罪数据集的描述符
- en: 'Subset the data frame down to four variables (`Longitude`, `Latitude`, `Month`,
    and `Crime type`):'
  id: totrans-775
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据框缩小为四个变量（`Longitude`、`Latitude`、`Month`和`Crime type`）：
- en: '[PRE171]'
  id: totrans-776
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE171]'
- en: 'The output is as follows:'
  id: totrans-777
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.35: Crime data in data frame format'
  id: totrans-778
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.35：以数据框格式展示的犯罪数据'
- en: '](img/B15923_09_35.jpg)'
  id: totrans-779
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_35.jpg)'
- en: 'Figure 9.35: Crime data in data frame format'
  id: totrans-780
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.35：以数据框格式展示的犯罪数据
- en: 'Using the `jointplot` function from `seaborn`, fit and visualize three kernel
    density estimation models for bicycle theft in July, September, and December 2018:'
  id: totrans-781
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`seaborn`中的`jointplot`函数，拟合并可视化2018年7月、9月和12月的自行车盗窃案件的三种核密度估计模型：
- en: '[PRE172]'
  id: totrans-782
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE172]'
- en: 'The output is as follows:'
  id: totrans-783
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.36: The estimated joint and marginal densities for bicycle thefts
    in July 2018'
  id: totrans-784
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.36：2018年7月自行车盗窃案件的联合与边际密度估计'
- en: '](img/B15923_09_36.jpg)'
  id: totrans-785
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_36.jpg)'
- en: '[PRE173]'
  id: totrans-786
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE173]'
- en: 'The output is as follows:'
  id: totrans-787
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.37: The estimated joint and marginal densities for bicycle thefts
    in September 2018'
  id: totrans-788
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.37：2018年9月自行车盗窃案件的联合与边际密度估计'
- en: '](img/B15923_09_37.jpg)'
  id: totrans-789
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_37.jpg)'
- en: '[PRE174]'
  id: totrans-790
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE174]'
- en: 'The output is as follows:'
  id: totrans-791
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.38: The estimated joint and marginal densities for bicycle thefts
    in December 2018'
  id: totrans-792
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.38：2018年12月自行车盗窃案件的联合与边际密度估计'
- en: '](img/B15923_09_38.jpg)'
  id: totrans-793
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_38.jpg)'
- en: 'Figure 9.38: The estimated joint and marginal densities for bicycle thefts
    in December 2018'
  id: totrans-794
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.38：2018年12月自行车盗窃案件的联合与边际密度估计
- en: From month to month, the density of bicycle thefts stays quite constant. There
    are slight differences between the densities, which is to be expected given that
    the data that is the foundation of these estimated densities is three one-month
    samples. Given these results, police or criminologists should be confident in
    predicting where future bicycle thefts are most likely to occur.
  id: totrans-795
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从一个月到另一个月，自行车盗窃的密度保持相对稳定。密度之间有些许差异，这是可以预期的，因为这些估计密度的基础数据是三个一个月的样本。根据这些结果，警方或犯罪学家应当对预测未来自行车盗窃事件最可能发生的地方有较高的信心。
- en: 'Repeat *Step 4*; this time, use shoplifting crimes for the months of August,
    October, and November 2018:'
  id: totrans-796
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复*步骤4*；这一次，使用2018年8月、10月和11月的扒窃犯罪数据：
- en: '[PRE175]'
  id: totrans-797
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE175]'
- en: 'The output is as follows:'
  id: totrans-798
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.39: The estimated joint and marginal densities for shoplifting incidents
    in August 2018'
  id: totrans-799
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.39：2018年8月扒窃案件的联合与边际密度估计'
- en: '](img/B15923_09_39.jpg)'
  id: totrans-800
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_39.jpg)'
- en: '[PRE176]'
  id: totrans-801
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE176]'
- en: 'The output is as follows:'
  id: totrans-802
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.40: The estimated joint and marginal densities for shoplifting incidents
    in October 2018'
  id: totrans-803
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.40：2018年10月扒窃案件的联合与边际密度估计'
- en: '](img/B15923_09_40.jpg)'
  id: totrans-804
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_40.jpg)'
- en: '[PRE177]'
  id: totrans-805
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE177]'
- en: 'The output is as follows:'
  id: totrans-806
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 9.41: The estimated joint and marginal densities for shoplifting incidents
    in November 2018'
  id: totrans-807
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图9.41：2018年11月扒窃案件的联合与边际密度估计'
- en: '](img/B15923_09_41.jpg)'
  id: totrans-808
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_41.jpg)'
- en: 'Figure 9.41: The estimated joint and marginal densities for shoplifting incidents
    in November 2018'
  id: totrans-809
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图9.41：2018年11月扒窃案件的联合与边际密度估计
- en: Like the bicycle theft results, the shoplifting densities are quite stable across
    the months. The density from August 2018 looks different from the other two months;
    however, if you look at the longitude and latitude values, you will notice that
    the density is very similar – just shifted and scaled. The reason for this is
    that there were probably a number of outliers forcing the creation of a much larger
    plotting region.
  id: totrans-810
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 与自行车盗窃的结果类似，商店扒窃的密度在几个月内相当稳定。2018年8月的密度看起来与其他两个月不同；但是，如果您查看经度和纬度值，您会注意到密度非常相似——只是偏移和缩放了。其原因是可能存在一些离群值，迫使创建一个更大的绘图区域。
- en: 'Repeat *Step 5*; this time use burglary crimes for the months of July, October,
    and December 2018:'
  id: totrans-811
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复*步骤 5*；这次使用2018年7月、10月和12月的入室盗窃犯罪数据：
- en: '[PRE178]'
  id: totrans-812
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE178]'
- en: 'The output is as follows:'
  id: totrans-813
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.42: The estimated joint and marginal densities for burglaries in
    July 2018'
  id: totrans-814
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 9.42：2018年7月入室盗窃的联合和边际密度的估计'
- en: '](img/B15923_09_42.jpg)'
  id: totrans-815
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15923_09_42.jpg)'
- en: 'Figure 9.42: The estimated joint and marginal densities for burglaries in July
    2018'
  id: totrans-816
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.42：2018年7月入室盗窃的联合和边际密度的估计
- en: 'For the month of October 2018, the code to fit and visualize the kernel density
    estimation model for burglaries is as follows:'
  id: totrans-817
  prefs: []
  type: TYPE_NORMAL
  zh: 对于2018年10月，用于入室盗窃的核密度估计模型的拟合和可视化代码如下：
- en: '[PRE179]'
  id: totrans-818
  prefs: []
  type: TYPE_PRE
  zh: '[PRE179]'
- en: 'The output is as follows:'
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.43: The estimated joint and marginal densities for burglaries in
    October 2018'
  id: totrans-820
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 9.43：2018年10月入室盗窃的联合和边际密度的估计'
- en: '](img/B15923_09_43.jpg)'
  id: totrans-821
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_09_43.jpg)'
- en: 'Figure 9.43: The estimated joint and marginal densities for burglaries in October
    2018'
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.43：2018年10月入室盗窃的联合和边际密度的估计
- en: 'For the month of December 2018, the code to fit and visualize the kernel density
    estimation model for burglaries is as follows:'
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: 对于2018年12月，用于入室盗窃的核密度估计模型的拟合和可视化代码如下：
- en: '[PRE180]'
  id: totrans-824
  prefs: []
  type: TYPE_PRE
  zh: '[PRE180]'
- en: 'The output is as follows:'
  id: totrans-825
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 9.44: The estimated joint and marginal densities for burglaries in
    December 2018'
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 9.44：2018年12月入室盗窃的联合和边际密度的估计'
- en: '](img/B15923_09_44.jpg)'
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15923_09_44.jpg)'
- en: 'Figure 9.44: The estimated joint and marginal densities for burglaries in December
    2018'
  id: totrans-828
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.44：2018年12月入室盗窃的联合和边际密度的估计
- en: Once again, we can see that the distributions are quite similar across the months.
    The only difference is that the densities seem to widen or spread from July to
    December. As always, the noise and inherent lack of information contained in the
    sample data is causing small shifts in the estimated densities.
  id: totrans-829
  prefs: []
  type: TYPE_NORMAL
  zh: 再次可以看到，这些分布在几个月内非常相似。唯一的区别是密度似乎从7月到12月扩展或分散。总是由于样本数据中的噪声和固有信息不足导致估计密度的小变化。
- en: Note
  id: totrans-830
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/2wmh5yj](https://packt.live/2wmh5yj).
  id: totrans-831
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参阅[https://packt.live/2wmh5yj](https://packt.live/2wmh5yj)。
- en: You can also run this example online at [https://packt.live/2W0EAGK](https://packt.live/2W0EAGK).
  id: totrans-832
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在[https://packt.live/2W0EAGK](https://packt.live/2W0EAGK)上在线运行此示例。
