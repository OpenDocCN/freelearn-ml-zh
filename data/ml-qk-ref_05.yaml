- en: Time Series Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间序列分析
- en: In this chapter, we will take a look at time series analysis and learn several
    ways of observing and capturing an event at different points in time. We will
    introduce the concept of white noise and learn about its detection in a series.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨时间序列分析，并学习几种在不同时间点观察和捕捉事件的方法。我们将介绍白噪声的概念，并学习如何在序列中检测它。
- en: We will take the time series data and compute the differences between the consecutive
    observations, which will lead to the formation of a new series. These concepts
    will help us deep dive into time series analysis and help us build a deeper understanding around
    it.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将取时间序列数据，计算连续观测之间的差异，这将导致形成一个新的序列。这些概念将帮助我们深入了解时间序列分析，并帮助我们对其有更深入的理解。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍以下主题：
- en: Introduction to time series analysis
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间序列分析简介
- en: White noise
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 白噪声
- en: Random walk
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机游走
- en: Autoregression
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自回归
- en: Autocorrelation
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自相关
- en: Stationarity
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 稳定性
- en: Differencing
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 差分
- en: AR model
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AR模型
- en: Moving average model
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动平均模型
- en: Autoregressive integrated moving average
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自回归积分移动平均
- en: Optimization of parameters
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参数优化
- en: Anomaly detection
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 异常检测
- en: Introduction to time series analysis
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间序列分析简介
- en: There are several occasions when we might try to observe and capture an event
    at different points in time. Often, we would end up drawing a correlation or association
    between adjacent observations that cannot be handled by an approach that deals
    with data that is independent and identically distributed. The approach that takes
    all of this into consideration in a mathematical and statistical manner is called
    **time series analysis**.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，我们可能会尝试在不同的时间点观察和捕捉事件。通常，我们会在相邻观测之间得出一种关联或关联，这种关联无法通过处理独立且同分布数据的方案来处理。这种在数学和统计方法上考虑所有这些因素的方法被称为
    **时间序列分析**。
- en: Time series analysis has been used in a number of fields, such as the automotive,
    banking, and retail industries, product development, and so on. There is no boundary
    for its use, and so analysts and data scientists are exploring this area to the
    hilt in order to derive the maximum benefit for organizations.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析已在许多领域得到应用，例如汽车、银行和零售业、产品开发等。其应用没有边界，因此分析师和数据科学家正在深入探索这个领域，以从组织中获取最大利益。
- en: In this section, we will go through a few of the concepts around time series
    analysis that will lay the foundation for a deeper understanding in the future.
    Once we have established this foundation, we will jump into modeling.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将探讨时间序列分析的一些概念，这将为进一步的深入理解奠定基础。一旦我们建立了这个基础，我们就会进入建模阶段。
- en: White noise
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 白噪声
- en: A simple series with a collection of uncorrelated random variables with a mean
    of zero and a standard deviation of *σ²* is called **white noise**. In this, variables
    are independent and identically distributed. All values have the same variance
    of *σ²*. In this case, the series is drawn from Gaussian distribution, and is
    called **Gaussian white noise**.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一个由一系列相互独立的随机变量组成，均值为零，标准差为 *σ²* 的简单序列被称为 **白噪声**。在这种情况下，变量是独立且同分布的。所有值都具有相同的方差
    *σ²*。在这种情况下，序列来自高斯分布，被称为 **高斯白噪声**。
- en: When the series turns out to be white noise, it implies that the nature of the
    series is totally random and there is no association within the series. As a result,
    the model can't be developed, and prediction is not possible in this scenario.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 当序列表现为白噪声时，这意味着序列的性质是完全随机的，序列内部没有关联。因此，无法开发模型，在这种情况下无法进行预测。
- en: 'However, when we typically build a time series model with a nonwhite noise
    series, we try to attain a white noise phenomenon within the residuals or errors.
    In simple terms, whenever we try to build a model, the motive is to extract the
    maximum amount of information from the series so that no more information exists
    in the variable. Once we build a model, noise will always be part of it. The equation
    is as follows:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当我们通常使用非白噪声序列构建时间序列模型时，我们试图在残差或误差中实现白噪声现象。简单来说，无论我们何时尝试构建模型，目的都是从序列中提取最大量的信息，以便变量中不再存在更多信息。一旦我们构建了模型，噪声将始终是其一部分。方程如下：
- en: '*Y[t ]= X[t ]+ Error*'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*Y[t ]= X[t ]+ Error*'
- en: So the error series should be totally random in nature, which implies that it
    is white noise. If we have got these errors as white noise, then we can go ahead
    and say that we have extracted all the information possible from the series.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，误差序列在本质上应该是完全随机的，这意味着它是白噪声。如果我们已经得到了这些误差作为白噪声，那么我们就可以继续说我们已经从序列中提取了所有可能的信息。
- en: Detection of white noise in a series
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在序列中检测白噪声
- en: 'We can detect white noise by using the following tools:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用以下工具检测白噪声：
- en: '**Line plot**: Once we have a line plot, we can have an idea of whether the
    series has a constant mean and variance'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**线形图**：一旦我们有了线形图，我们就可以了解序列是否具有恒定的均值和方差'
- en: '**Autocorrelation plot**: Having a correlation plot can give us an inkling
    as to whether there is an association among lagged variables'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自相关图**：有一个相关图可以让我们对滞后变量之间是否存在关联有所了解'
- en: '**Summary**: Checking the mean and variance of the series against the mean
    and variance of meaningful contiguous blocks of values in the series'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**摘要**：检查序列的均值和方差与序列中有意义的连续值块的平均值和方差'
- en: 'Let''s do this in Python:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在Python中这样做：
- en: 'First, we will import all the required libraries as follows:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将按照以下方式导入所有必需的库：
- en: '[PRE0]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, we will set up the white noise series for us to analyze, as follows:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将设置白噪声序列供我们分析，如下所示：
- en: '[PRE1]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Let''s take the summary or statistic of it using the following code:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们使用以下代码来获取其摘要或统计信息：
- en: '[PRE2]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We will get the following output:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/c34dd0d9-d796-4882-816c-dee770bd9a29.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/c34dd0d9-d796-4882-816c-dee770bd9a29.png)'
- en: Here, we can see that the mean is approaching zero and the standard deviation
    is close to 1.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到均值接近零，标准差接近1。
- en: 'Let''s make a line plot now to check out the trend, using the following code:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们制作一个线形图来检查趋势，使用以下代码：
- en: '[PRE3]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We will get the following output:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/50887a2b-3c88-4223-9981-e0c20423e3af.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/50887a2b-3c88-4223-9981-e0c20423e3af.png)'
- en: The line plot looks totally random, and no trend can be observed here.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 线性图看起来完全是随机的，这里无法观察到任何趋势。
- en: 'It''s time to make an autocorrelation plot. Let''s set one up using the following
    code:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 是时候制作自相关图了。让我们使用以下代码设置一个：
- en: '[PRE4]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'We will get the following output:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/e38f049f-3af8-46b0-9f7a-97db972126ff.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/e38f049f-3af8-46b0-9f7a-97db972126ff.png)'
- en: Even in an **autocorrelation** function plot, the correlation breaches the band
    of our confidence level. This tells us that it is a white noise series.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 即使在**自相关**函数图上，相关性也突破了我们的置信区间。这告诉我们它是一个白噪声序列。
- en: Random walk
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 随机游走
- en: 'Random walk is a time series model where the current observation is equal to
    the previous observations with a random modification. It can be described in the
    following manner:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 随机游走是一种时间序列模型，其中当前观测值等于前一个观测值加上一个随机修改。它可以以下述方式描述：
- en: '* x[t]= x[t-1 ]+ w[t]*'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '*x[t]= x[t-1 ]+ w[t]*'
- en: In the preceding formula, *w[t]*is a white noise series.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的公式中，*w[t]*是一个白噪声序列。
- en: 'Sometimes, we might come across a series that reflects irregular growth. In
    these cases, the strategy to predict the next level won''t be the correct one.
    Rather, it might be better to try to predict the change that occurs from one period
    to the next—that is, it may be better to look at the first difference of the series
    in order to find out a significant pattern. The following figure shows a random
    walk pattern:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，我们可能会遇到反映不规则增长的序列。在这些情况下，预测下一个级别的策略可能是不正确的。相反，尝试预测从一个时期到下一个时期的变化可能更好——也就是说，查看序列的一阶差分可能更好地找出一个显著的模式。以下图显示了随机游走模式：
- en: '![](img/ff0118d8-02d9-447b-91bf-e85f8320c801.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/ff0118d8-02d9-447b-91bf-e85f8320c801.png)'
- en: In each time period, going from left to right, the value of the variable takes
    an independent random step up or down, which is called a **random walk**.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个时间段，从左到右，变量的值独立地随机向上或向下迈出一步，这被称为**随机游走**。
- en: 'It can also be described in the following way:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 它也可以用以下方式描述：
- en: '*y(t)= b[o ]+ b[1]*x[t-1] + w[t]*'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '*y(t)= b[o ]+ b[1]*x[t-1] + w[t]*'
- en: 'The following list explains the preceding formula:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表解释了前面的公式：
- en: '*y(t)*: Next value in the series'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*y(t)*：序列中的下一个值'
- en: '*b[o]*: Coefficient, which, if set to a number other than zero, means that
    the random walk comes along with a drift'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*b[o]*：系数，如果设置为非零数字，则表示随机游走伴随着漂移'
- en: '*b[1]*: Coefficient, which is set to 1'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*b[1]*：系数，设置为1'
- en: '*w[t]***:** White noise'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*w[t]*：白噪声'
- en: Autoregression
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自回归
- en: 'An autoregression is a time series model that typically uses the previous values
    of the same series as an explanatory factor for the regression in order to predict
    the next value. Let''s say that we have measured and kept track of a metric over
    time, called *y[t]*, which is measured at time *t* when this value is regressed
    on previous values from that same time series. For example, *y[t]*on *y[t-1]*:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 自回归是一种时间序列模型，通常使用同一序列的先前值作为回归的解释因素，以预测下一个值。假设我们测量并跟踪了随时间变化的指标，称为 *y[t]*，它在时间
    *t* 时测量，并且当这个值回归到同一时间序列的先前值时。例如，*y[t]* 在 *y[t-1]* 上：
- en: '![](img/1724339d-2858-4f5d-a54f-5a0f39cad697.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1724339d-2858-4f5d-a54f-5a0f39cad697.png)'
- en: As shown in the preceding equation, the previous value *y[t-1]* has become the
    predictor here and *y[t]* is the response value that is to be predicted. Also,
    *ε[t]* is normally distributed with a mean of zero and variance of 1. The order
    of the autoregression model is defined by the number of previous values that are
    being used by the model to determine the next value. Therefore, the preceding
    equation is a first-order autoregression, or **AR(1)**. If we have to generalize
    it, a *k*^(*th* )order autoregression, written as **AR(k)**, is a multiple linear
    regression in which the value of the series at any time (*t*) is a (linear) function
    of the values at times *t−1*, *t−2*, …,*t−k.*
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 如前一个方程所示，前一个值 *y[t-1]* 已成为这里的预测值，而 *y[t]* 是要预测的响应值。此外，*ε[t]* 是均值为零，方差为 1 的正态分布。自回归模型的阶数由模型用来确定下一个值的先前值的数量定义。因此，前一个方程是一个一阶自回归，或
    **AR(1)**。如果我们必须推广它，*k* 阶自回归，写作 **AR(k)**，是一个多元线性回归，其中时间序列在任何时间 (*t*) 的值是时间 *t-1*，*t-2*，…，*t-k*
    的值的（线性）函数。
- en: 'The following list shows what the following values means for an AR(1) model:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的列表显示了对于 AR(1) 模型，以下值代表什么：
- en: When *β[1 ]= 0*, *y**t*, itis equivalent to white noise
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 *β[1]= 0*，*y**t*，它等同于白噪声
- en: When *β[1 ]= 1* and *β[0]= 0*, *y[t]*, it is equivalent to a random walk
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 *β[1]= 1* 和 *β[0]= 0* 时，*y[t]* 等同于随机游走
- en: When *β[1 ]= 1* and *β[0 ]≠ 0*, *y[t]*, it is equivalent to a random walk with
    drift
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 *β[1]= 1* 和 *β[0]≠ 0* 时，*y[t]*，它等同于有漂移的随机游走
- en: When *β[1 ]< 1*, *y[t]*, it tends to oscillate between positive and negative
    values
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 *β[1] < 1*，*y[t]*，它倾向于在正负值之间振荡
- en: Autocorrelation
  id: totrans-74
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自相关
- en: 'Autocorrelation is a measure of the correlation between the lagged values of
    a time series. For example, *r[1]* is the autocorrelation between *y[t ]*and *y[t-1;]* similarly,
    *r[2 ]*is the autocorrelation between *y[t ]*and *y[t-2]*. This can be summarized
    in the following formula:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 自相关是衡量时间序列滞后值之间相关性的度量。例如，*r[1]* 是 *y[t]* 和 *y[t-1]* 之间的自相关，同样，*r[2]* 是 *y[t]*
    和 *y[t-2]* 之间的自相关。这可以总结如下公式：
- en: '![](img/a10d9b15-19a3-45ce-bb47-e2c67c544a52.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a10d9b15-19a3-45ce-bb47-e2c67c544a52.png)'
- en: In the preceding formula, *T* is the length of the time series.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一个公式中，*T* 是时间序列的长度。
- en: 'For example, say that we have the correlation coefficients, as shown in the
    following diagram:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设我们有以下相关系数，如图所示：
- en: '![](img/46e209e2-3a8f-4332-a0e4-6df905f03963.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/46e209e2-3a8f-4332-a0e4-6df905f03963.png)'
- en: 'To plot it, we get the following:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 要绘制它，我们得到以下结果：
- en: '![](img/ae116bfd-56ab-48d8-bc93-ff04987c4eda.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/ae116bfd-56ab-48d8-bc93-ff04987c4eda.png)'
- en: 'The following are some observations from this autocorrelation function plot:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个自相关函数图中可以观察到以下内容：
- en: '**r[4]** is higher than other lags, which is mostly because of a seasonal pattern'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**r[4]** 比其他延迟更高，这主要是因为季节性模式'
- en: The blue lines are the indicators of whether correlations are significantly
    different from zero
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝线是表示相关性是否显著不同于零的指标
- en: Autocorrelation at lag 0 is always 1
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 延迟 0 的自相关始终为 1
- en: Stationarity
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 平稳性
- en: A common assumption for a few of the time series models is that data has to
    be stationary. Let's look at what stationarity means regarding time series.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一些时间序列模型，一个常见的假设是数据必须是平稳的。让我们看看平稳性对时间序列意味着什么。
- en: A stationary process is one for which the mean, variance, and autocorrelation
    structure doesn't change over time. What this means is that the data doesn't have
    a trend (increasing or decreasing).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 平稳过程是指其均值、方差和自相关结构随时间不变的过程。这意味着数据没有趋势（增加或减少）。
- en: 'We can describe this by using the following formulas:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用以下公式来描述这一点：
- en: '*E(x[t])= μ*, for all *t*'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '*E(x[t])= μ*，对于所有 *t*'
- en: '*E(x[t]²)= σ*^(*2*), for all *t*'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '*E(x[t]²)= σ²*，对于所有 *t*'
- en: '*cov(x[t],x[k])= cov(x[t+s], x[k+s])*, for all *t*, *k*, and s'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '*cov(x[t],x[k])= cov(x[t+s], x[k+s])*，对于所有 *t*，*k* 和 *s*'
- en: Detection of stationarity
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 稳定性检测
- en: 'There are multiple methods that can help us in figuring out whether the data
    is stationary, listed as follows:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种方法可以帮助我们确定数据是否平稳，如下所示：
- en: '**Plotting the data**: Having a plot of the data with respect to the time variable
    can help us to see whether it has got a trend. We know from the definition of
    stationarity that a trend in the data means that there is no constant mean and
    variance. Let''s do this in Python. For this example, we are using international
    airline passenger data.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**绘制数据图**：根据时间变量绘制数据图可以帮助我们判断是否存在趋势。根据平稳性的定义，数据中的趋势意味着没有恒定的均值和方差。让我们用Python来实现这一点。在这个例子中，我们使用的是国际航空公司乘客数据。'
- en: 'First, let''s load all the required libraries, as follows:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们加载所有必需的库，如下所示：
- en: '[PRE5]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We will get the following output:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/25b20f75-7749-4a04-b737-86f0c5e65b7e.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/25b20f75-7749-4a04-b737-86f0c5e65b7e.png)'
- en: It is quite clear from the plot that there is an increasing trend here and that
    it would vindicate our hypothesis that it is a non-stationary series.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 从图中非常清楚地可以看出，这里存在一个上升趋势，并且这证实了我们的假设，即这是一个非平稳序列。
- en: '**Dividing the data set and computing the summary**: The next method would
    be to divide the data series into two parts and compute the mean and variance.
    By doing this, we will be able to figure out whether the mean and variance are
    constant. Let''s do this by using the following code:'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分割数据集并计算摘要**：下一个方法是将数据序列分为两部分，并计算均值和方差。通过这样做，我们将能够确定均值和方差是否恒定。让我们使用以下代码来实现这一点：'
- en: '[PRE6]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The output is as follows:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE7]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We can see that the mean and variance of series 1 and series 2 are not equal,
    and so we can conclude that the series is not stationary.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到序列1和序列2的均值和方差不相等，因此我们可以得出结论，该序列是非平稳的。
- en: '**Augmented Dickey-Fuller test**: The augmented Dickey-Fuller test is a statistical
    test that tends to give an indication with a certain level of confidence as to
    whether the series is stationary. A statistical test takes the data and tests
    our hypothesis about the data using its assumption and process. Eventually, it
    yields the result with a certain degree of confidence, which helps us in taking
    the decision.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Augmented Dickey-Fuller测试**：Augmented Dickey-Fuller测试是一种统计测试，它倾向于以一定的置信水平指示序列是否平稳。统计测试通过其假设和过程对数据进行测试，以检验我们对数据的假设。最终，它以一定的置信度给出结果，这有助于我们做出决策。'
- en: This test is nothing but the unit root test, which tries to find out whether
    the time series is influenced by the trend. It makes use of the **autoregressive**
    (**AR**) model and optimizes the information criterion at different lag values.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 这个测试实际上就是单位根测试，它试图找出时间序列是否受到趋势的影响。它使用**自回归**（**AR**）模型，并在不同的滞后值上优化信息准则。
- en: 'Here, the null hypothesis is as follows:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，零假设如下：
- en: '***H[o]***: The time series has got the unit root, which implies that the series
    is nonstationary'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***H[o]***：时间序列具有单位根，这意味着序列是非平稳的。'
- en: 'The alternate hypothesis is as follows:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 替代假设如下：
- en: '***H[1]***: The time series doesn''t have a unit root and, as such, it is stationary'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***H[1]***：时间序列没有单位根，因此它是平稳的。'
- en: 'As we know from the rules of hypothesis testing, if we have chosen a significance
    level of 5% for the test, then the result would be interpreted as follows:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 根据假设检验的规则，如果我们为测试选择了5%的显著性水平，那么结果将被解释如下：
- en: If *p-value >0.05* =>, then we fail to reject the null hypothesis. That is,
    the series is nonstationary.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 *p-value >0.05* =>，则我们未能拒绝零假设。也就是说，序列是非平稳的。
- en: If *p-value <0.05* =>, then the null hypothesis is rejected which means that the
    series is stationary.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 *p-value <0.05* =>，则拒绝零假设，这意味着该序列是平稳的。
- en: 'Let''s perform this in Python:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在Python中执行以下操作：
- en: 'First, we will load the libraries, as follows:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将加载库，如下所示：
- en: '[PRE8]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Next, we load the data and time plot as follows:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们按照以下方式加载数据和时间图：
- en: '[PRE9]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The output can be seen in the following diagram:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 输出可以在以下图表中看到：
- en: '![](img/a4fd26e4-ca81-4934-9e9c-41d4270d9dc6.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a4fd26e4-ca81-4934-9e9c-41d4270d9dc6.png)'
- en: 'We then parse the data as follows:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们按照以下方式解析数据：
- en: '[PRE10]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'We then get the following output:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们得到以下输出：
- en: '![](img/981dfc7c-4087-4ad9-adef-0e20d45ce0ff.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](img/981dfc7c-4087-4ad9-adef-0e20d45ce0ff.png)'
- en: '[PRE11]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'From this, we get the following output:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，我们得到以下输出：
- en: '![](img/c73847fc-b69f-407c-89f7-00a57ed3637d.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c73847fc-b69f-407c-89f7-00a57ed3637d.png)'
- en: 'Then we plot the graph, as follows:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们绘制以下图表：
- en: '[PRE12]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The output can be seen as follows:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/ab3a758d-f7b4-49a8-a902-8698cdd85b52.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/ab3a758d-f7b4-49a8-a902-8698cdd85b52.png)'
- en: 'Let''s create a function to perform a stationarity test using the following
    code:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们创建一个函数来执行以下代码的平稳性测试：
- en: '[PRE13]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The output can be seen as follows:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/5eac6c3a-a6f6-4d71-b144-8c49b23ac8ba.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/5eac6c3a-a6f6-4d71-b144-8c49b23ac8ba.png）'
- en: Since *p-value > 0.05* and the *t*-statistic is greater than all the critical
    values (1%,5%,10%), *tt* implies that the series is nonstationary as we failed
    to reject the null hypothesis.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 *p-value > 0.05* 并且 *t*-统计量大于所有临界值（1%，5%，10%），*tt* 意味着该序列是非平稳的，因为我们未能拒绝零假设。
- en: So what can be done if the data is nonstationary? We use differencing to make
    the nonstationary data into stationary data.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如果数据是非平稳的，我们能做什么呢？我们使用差分将非平稳数据转换为平稳数据。
- en: AR model
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AR 模型
- en: An AR model is a part of the stochastic process, wherein specific lagged values
    of *y[t]* are used as predictor variables and regressed on *y[t ]*in order to
    estimate its values. Lagged values are values of the series of the previous period
    that tend to have an impact on the current value of the series. Let's look at
    an example. Say we have to assess and predict tomorrow's weather. We would start
    by thinking of what today's weather is and what yesterday's weather was, as this
    will help us in predicting whether it will be rainy, bright and sunny, or cloudy.
    Subconsciously, we are also cognizant of the fact that the weather of the previous
    day might have an association with today's weather. This is what we call an **AR
    model**.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: AR 模型是随机过程的一部分，其中使用 *y[t]* 的特定滞后值作为预测变量，并对其回归以估计其值。滞后值是前一个时期的时间序列值，这些值往往会影响当前时间序列的值。让我们看一个例子。比如说，我们必须评估和预测明天的天气。我们首先会考虑今天的天气和昨天的天气，因为这有助于我们预测是否会下雨，天气晴朗且阳光明媚，还是多云。潜意识中，我们也会意识到前一天天气可能与今天天气有关联。这就是我们所说的**AR模型**。
- en: 'This has a degree of uncertainty that results in less accuracy in the prediction
    of future values. The formula is the same as the formula for a series with *p*
    lag, as follows:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 这具有一定程度的不确定性，导致对未来值预测的准确性降低。公式与 *p* 滞后序列的公式相同，如下所示：
- en: '![](img/2a650119-f373-4979-bbe5-e04705f4def8.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/2a650119-f373-4979-bbe5-e04705f4def8.png)'
- en: 'In the previous equation,* ω* is the white noise term and *α* is the coefficient,
    which can''t be zero. The aggregated equation appears as follows:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的方程中，* ω* 是白噪声项，*α* 是系数，不能为零。聚合方程如下所示：
- en: '![](img/32d5bfdb-35ea-4877-a922-ed08417f2ab5.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/32d5bfdb-35ea-4877-a922-ed08417f2ab5.png)'
- en: 'Occasionally, we might talk about the order of a model. For example, we might
    describe an AR model as being of order *p*. In this case,the *p* represents the
    number of lagged variables used within the model. For example, an AR(2) model
    or second-orderAR model looks like the following:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，我们可能会讨论模型的阶数。例如，我们可能会将 AR 模型描述为阶数 *p*。在这种情况下，*p* 代表模型中使用的滞后变量的数量。例如，AR(2)
    模型或二阶 AR 模型看起来如下：
- en: '![](img/de8924d2-fec8-4208-99eb-c3ee056e35a1.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/de8924d2-fec8-4208-99eb-c3ee056e35a1.png）'
- en: Moving average model
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 移动平均模型
- en: 'A **moving average model** (**MA**) is a linear combination of historic white
    noise error terms. Let''s have a look at the equation of the model:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '**移动平均模型**（**MA**）是历史白噪声误差项的线性组合。让我们看看该模型的方程：'
- en: '![](img/69f46d0d-cecc-4cfe-9d4e-337c2cb62b95.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/69f46d0d-cecc-4cfe-9d4e-337c2cb62b95.png）'
- en: '![](img/399ae830-4338-4610-8ede-adeabdc9eb61.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/399ae830-4338-4610-8ede-adeabdc9eb61.png)'
- en: Here, *ω* is the white noise with *E(ω[t])=0* and variance =* σ²*.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*ω* 是具有 *E(ω[t])=0* 和方差 =* σ²* 的白噪声。
- en: In order to find out the order of the AR model, we need to plot a partial autocorrelation
    function plot, and then look for the lag where the upper confidence level has
    been crossed for the first time.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 为了找出 AR 模型的阶数，我们需要绘制一个偏自相关函数图，然后寻找第一次被上置信水平跨越的滞后。
- en: Autoregressive integrated moving average
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自回归积分移动平均
- en: 'An **autoregressive integrated moving average** (**ARIMA**) model is a combination
    of the following elements:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '**自回归积分移动平均**（**ARIMA**）模型是以下元素的组合：'
- en: '**Autoregressive operator**: We have already learned what this means; just
    to reiterate, it is the lags of the stationarized series. It is denoted by *p*,
    which is nothing but the number of autoregressive terms. The PACF plot yields
    this component.'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自回归算子**：我们已经学习了这是什么意思；只是为了重申，它是平稳化序列的滞后。它用 *p* 表示，这仅仅是自回归项的数量。PACF 图提供了这个组成部分。'
- en: '**Integration operator**: A series that needs to be differenced to be made
    stationary is said to be an integrated version of a stationary series. It is denoted
    by *d*, which is the amount of differencing that is needed to transform the nonstationary
    time series into a stationary one. This is done by subtracting the observation
    from the current period from the previous one. If this has been done only once
    to the series, it is called **first differenced**. This process eliminates the
    trend out of the series that is growing at a constant rate. In this case, the
    series is growing at an increasing rate, and the differenced series needs another
    round of differencing, which is called **second differencing**.'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**积分算子**：一个需要通过差分使其平稳的序列被称为平稳序列的积分形式。它用*d*表示，这是将非平稳时间序列转换为平稳序列所需的差分量。这是通过从当前周期的观测值中减去前期的观测值来实现的。如果这个过程只对序列进行了一次，那么它被称为**一阶差分**。这个过程消除了序列中按恒定速率增长的趋势。在这种情况下，序列是按递增速率增长的，差分序列需要另一轮差分，这被称为**二阶差分**。'
- en: '**Moving average operator**: The lags of the forecasted errors, which is denoted
    by *q*. It is the number of lagged forecast errors in the equation. The ACF plot
    would yield this component.'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**移动平均算子**：预测误差的滞后，用*q*表示。它是方程中滞后预测误差的数量。ACF图将产生这个成分。'
- en: The ARIMA model can only be applied on stationary series. Therefore, before
    applying it, the stationarity condition has to be checked in the series. The ADF
    test can be performed to establish this.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA模型只能应用于平稳序列。因此，在应用它之前，必须检查序列的平稳性条件。可以使用ADF测试来建立这一点。
- en: 'The equation of ARIMA turns looks like the following:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA方程看起来如下：
- en: '![](img/627d8248-1c5b-4643-85e4-01d8b54e1444.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/627d8248-1c5b-4643-85e4-01d8b54e1444.png)'
- en: The first part of the equation (before the *-* sign) is the autoregressive section,
    and the second part (after the *-* sign)is the MA section.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 方程的前一部分（在*-*符号之前）是自回归部分，第二部分（在*-*符号之后）是移动平均（MA）部分。
- en: We can go ahead and add a seasonal component in ARIMA as well, which would be
    ARIMA *(p,d,q)(p,d,q)[s]*. While adding it, we need to perform seasonal differencing,
    which means subtracting the current observation from the seasonal lag.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以在ARIMA模型中添加季节性成分，这将形成ARIMA *(p,d,q)(p,d,q)[s]*。在添加它时，我们需要执行季节性差分，这意味着从季节滞后中减去当前观测值。
- en: Let's plot ACF and PACF in order to find out the *p* and *q *parameters.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们绘制自相关函数（ACF）和偏自相关函数（PACF）以找出*p*和*q*参数。
- en: 'Here, we take the number of lags as 20 and use the `statsmodel.tsa.stattools `library to
    import the `acf` and `pacf` functions, as follows:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们取滞后数为20，并使用`statsmodel.tsa.stattools`库导入`acf`和`pacf`函数，如下所示：
- en: '[PRE14]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now we will plot with the help of `matplotlib` using the following code:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将使用以下代码通过`matplotlib`绘制图表：
- en: '[PRE15]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The output is as follows:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/daafb80f-b167-4394-8fc0-c8668dffea4d.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/daafb80f-b167-4394-8fc0-c8668dffea4d.png)'
- en: Here, we are measuring the correlation between the time series with a lagged
    version of itself. For instance, at lag 5, ACF would compare the series at time
    instant *t1*, *t2* with the series at instant *t[1-5]*, *…*, *t[2-5]*. It is a
    plot of the coefficients of the correlation with its lagged values.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们正在测量时间序列与其滞后版本之间的相关性。例如，在滞后5的情况下，ACF将比较时间点*t1*，*t2*处的序列与时间点*t[1-5]*，*…*，*t[2-5]*处的序列。这是一张相关系数与其滞后值的相关图。
- en: If we look at the preceding plot carefully, we will see that the upper confidence
    level line has been crossed at lag 2\. Therefore, the order of MA would be *2*
    and *q=2*.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们仔细观察前面的图表，我们会看到在滞后2时上置信水平线已被穿过。因此，移动平均（MA）的阶数将是*2*，而*q=2*。
- en: A partial correlation between the series and lagged values is plotted, and it
    gives us a **partial auto correlation functional** (**PACF**) plot. It's a very
    interesting term. If we go on and compute the correlation between a *Y *variable
    and *X*3 while we know that *Y* has a separation association with *X*1 and *X*2,
    the partial correlation addresses that portion of the correlation that is not
    explained by their correlations with *X*1 and *X*2.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 画出了序列与滞后值之间的部分相关性，并给出了**部分自相关函数**（**PACF**）图。这是一个非常有趣的术语。如果我们继续计算*Y*变量与*X*3之间的相关性，同时我们知道*Y*与*X*1和*X*2有分离的关联，那么部分相关性就解决了这部分相关性，这部分相关性不能由它们与*X*1和*X*2的相关性来解释。
- en: Here, the partial correlation is the square root (reduction in variance by adding
    a variable (here, *X*3) while regressing *Y* on the other variables (here *X*1, *X*2)).
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，偏相关是平方根（通过添加一个变量（此处为*X*3）并在其他变量（此处为*X*1，*X*2）上对*Y*进行回归时减少方差）。
- en: 'In the case of a time series, partial autocorrelation between Y & lagged value
    Y[t-3] will be the value that is not explained by a correlation between *Y* and
    *Y*[*t*-1] and *Y*[*t*-2], as shown in the following code:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在时间序列的情况下，Y与滞后值Y[t-3]之间的偏自相关将是未被*Y*与*Y*[*t*-1]和*Y*[*t*-2]之间的相关性解释的值，如下代码所示：
- en: '[PRE16]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We will get the following output:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/3736fa84-2505-4317-a0b0-04f9398d23e1.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/3736fa84-2505-4317-a0b0-04f9398d23e1.png)'
- en: If we look at the preceding plot carefully, we will see that the upper confidence
    level line has been crossed at lag 2\. Therefore, the order of AR would be 2 and
    *p=2*.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们仔细观察前面的图，我们会看到在滞后2时上置信水平线已被穿过。因此，AR的阶数应该是2，*p=2*。
- en: 'Let''s try out an AR model that is of the order *(p=2, d=1, q=0)*. The *d* value
    has been taken as 1, since it is a case of single differencing. The residual sum
    of the square has been calculated as well to judge how good the model is and compare
    it with others, as shown in the following code:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试一个阶数为*(p=2, d=1, q=0)*的AR模型。*d*值取为1，因为这是一个一阶差分的情况。同时计算了残差平方和，以判断模型的好坏，并与其他模型进行比较，如下代码所示：
- en: '[PRE17]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The output can be seen as follows:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/6302a46b-427d-4c32-9ccd-cd4093856311.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/6302a46b-427d-4c32-9ccd-cd4093856311.png)'
- en: 'Now, we can have a look at the model summary that depicts the coefficients
    of AR1 and AR2 using the following code:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以使用以下代码查看描述AR1和AR2系数的模型摘要：
- en: '[PRE18]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![](img/8386ccb1-d258-419f-bfc0-97f4a536f099.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/8386ccb1-d258-419f-bfc0-97f4a536f099.png)'
- en: 'Now, let''s build an MA model of the order *(p=0,d=1,q=2)* using the following
    code:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下代码构建一个阶数为*(p=0,d=1,q=2)*的MA模型：
- en: '[PRE19]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The output can be seen as follows:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/58645090-67c5-41f9-8af7-fa7641911d6b.jpg)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/58645090-67c5-41f9-8af7-fa7641911d6b.jpg)'
- en: 'Now, let''s combine these two models and build an ARIMA model using the following
    code:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们结合这两个模型，并使用以下代码构建一个ARIMA模型：
- en: '[PRE20]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The output is as follows:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/74a2b07b-767b-4f40-93b7-80652cb8c0dc.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/74a2b07b-767b-4f40-93b7-80652cb8c0dc.png)'
- en: 'We can experience a dip in the value of RSS from the AR model to ARIMA. Now
    **RSS= 1.0292**:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从AR模型到ARIMA模型观察到RSS值的下降。现在**RSS= 1.0292**：
- en: '[PRE21]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'We can see the coefficients of AR1, AR2, MA1, and MA2, and, if we go by *p *values,
    we can see that all these parameters are significant, as shown in the following
    screenshot:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到AR1、AR2、MA1和MA2的系数，并且根据*p*值，我们可以看到所有这些参数都是显著的，如下截图所示：
- en: '![](img/7ef067a9-23ce-4363-9c3d-23505461dc85.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/7ef067a9-23ce-4363-9c3d-23505461dc85.png)'
- en: 'Let''s turn the predicted values into a series using the following code:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用以下代码将预测值转换成一个序列：
- en: '[PRE22]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'We will get the following output:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![](img/4798ec69-cfe0-4653-bcdb-0f09b00e7917.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/4798ec69-cfe0-4653-bcdb-0f09b00e7917.png)'
- en: 'The way to convert the differencing to log scale is to add these differences
    consecutively to the base number. An easy way to do this is to first determine
    the cumulative sum at the index and then add it to the base number. The cumulative
    sum can be found using the following code:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 将差分转换为对数尺度的方法是连续将这些差异添加到基数中。一种简单的方法是首先确定索引处的累积和，然后将其添加到基数中。累积和可以使用以下代码找到：
- en: '[PRE23]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'From this, we will get the following output:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个结果，我们将得到以下输出：
- en: '![](img/44bc962a-af3f-4b2f-beaa-329bc598f642.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/44bc962a-af3f-4b2f-beaa-329bc598f642.png)'
- en: 'We will create a series with all values as the base number and add the differences
    to it in order to add to the base series, as follows:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将创建一个所有值都为基数，并添加差异以添加到基数序列中的序列，如下所示：
- en: '[PRE24]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'The following shows the output:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的代码显示了输出：
- en: '![](img/4362a7c6-a3ea-48c2-a6bb-82810c433dbb.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/4362a7c6-a3ea-48c2-a6bb-82810c433dbb.png)'
- en: 'Let''s now find out the forecast using the following code:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们使用以下代码来找出预测结果：
- en: '[PRE25]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The output can be seen as follows:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![](img/b958ef4c-0375-49af-8a7e-6d8dcc293d1d.png)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/b958ef4c-0375-49af-8a7e-6d8dcc293d1d.png)'
- en: Optimization of parameters
  id: totrans-214
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参数优化
- en: Let's look at how to optimize the parameters of the models.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何优化模型的参数。
- en: AR model
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AR模型
- en: '[PRE26]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Therefore, our model parameters are `p=2`, `d=2`, and `q=0` in this scenario
    for the AR model, as the AIC for this combination is the least.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在这种情况下，AR模型的最优模型参数是`p=2`，`d=2`，`q=0`，因为这种组合的AIC值最小。
- en: ARIMA model
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ARIMA模型
- en: 'Even for the ARIMA model, we can optimize the parameters by using the following
    code:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 即使对于ARIMA模型，我们也可以使用以下代码来优化参数：
- en: '[PRE27]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The following is the output you get by executing the preceding code:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述代码后，您将得到以下输出：
- en: '[PRE28]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The combination with the least **Akaike information criterion** (**AIC**) should
    be chosen.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 应选择具有最小**赤池信息准则**（**AIC**）的组合。
- en: Anomaly detection
  id: totrans-225
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常检测
- en: Anomalies are essentially abnormal patterns in a series that are irregular deviations
    from the expected behavior. For example, many of us have watched a cricket match.
    One form of getting out in this game is to be caught out, and before the ball
    travels straight to the hands of a fielder, it has to touch the bat of a batsman.
    If the stadium is very noisy, sometimes it is too difficult for anyone to judge
    whether the ball has touched the bat or not. To solve this problem, umpires use
    a device called the **snickometer** to help them make the call. The snickometer
    uses the sound from the stump mic to generate a plot of the mic's sound. If the
    plot is a straight line, then the ball did not make contact with the bat; otherwise,
    the plot will show a spike. Therefore, a spike is a sign of an anomaly. Another
    example of an anomaly could be the detection of a malignant tumor in a scan.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 异常本质上是一系列中的异常模式，是不规则偏离预期行为的偏差。例如，我们中的许多人看过板球比赛。在这场比赛中出局的一种方式是被接住，在球直接飞到守门员手中之前，它必须触碰到击球手的球棒。如果体育场非常嘈杂，有时很难判断球是否触碰到球棒。为了解决这个问题，裁判员使用一种称为**snickometer**的设备来帮助他们做出判断。snickometer使用球桩麦克风的声波生成麦克风的声波图。如果图是直线，则球没有接触到球棒；否则，图将显示一个尖峰。因此，尖峰是异常的标志。另一个异常的例子可能是扫描中检测到恶性肿瘤。
- en: 'Anomaly detection is a technique that we can use to figure out aberrant behavior.
    An anomaly can also be called an **outlier**. The following list shows several
    different anomalies:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 异常检测是一种我们可以用来确定异常行为的技巧。异常也可以称为**离群值**。以下列表展示了几个不同的异常类型：
- en: '**Point anomalies**: A point anomaly is a point that breaches the boundary
    of a threshold that has been assigned to keep the whole system in check. There
    is often a system in place to send an alert when this boundary has been breached
    by a point anomaly. For example, fraud detection in the financial industries can
    use point anomaly detection to check whether a transaction has taken place from
    a different city to the card holder''s usual location.'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**点异常**：点异常是突破已分配给整个系统以保持监控的阈值边界的点。通常有一个系统在位，当点异常突破这个边界时，会发送警报。例如，金融行业的欺诈检测可以使用点异常检测来检查是否发生了从不同城市到持卡人常用位置的交易。'
- en: '**Contextual anomalies**: Context-specific observations are called **contextual
    anomalies**. For example, it is commonplace to have lots of traffic on weekdays,
    but a holiday falling on a Monday may make it look like an anomaly.'
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**上下文异常**：特定上下文的观察被称为**上下文异常**。例如，在工作日有大量交通是常见的，但如果假日落在周一，可能会看起来像是一个异常。'
- en: '**Collective anomalies**: A set of collective data instances helps in detecting
    anomalies. Say that someone is unexpectedly trying to copy data form a remote
    machine to a local host. In this case, this anomaly would be flagged as a potential
    cyber attack.'
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集体异常**：一组集体数据实例有助于检测异常。比如说，有人意外地试图从远程机器复制数据到本地主机。在这种情况下，这种异常将被标记为潜在的网络安全攻击。'
- en: In this section, we will focus on contextual anomalies and try to detect them
    with the help of a simple moving average.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将重点关注上下文异常，并尝试使用简单的移动平均来检测它们。
- en: 'First, let''s load all the required libraries as follows:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们按照以下方式加载所有必需的库：
- en: '[PRE29]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Next, we read the dataset using the following code. We are keeping the same
    dataset—namely, `AirPassenger.csv`:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用以下代码读取数据集。我们保持相同的数据集——即`AirPassenger.csv`：
- en: '[PRE30]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'We get the output as follows:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下输出：
- en: '![](img/f9d68dc2-afa6-4892-a030-d439b726a98c.png)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/f9d68dc2-afa6-4892-a030-d439b726a98c.png)'
- en: 'Now we will write a function and create a threshold for detecting the anomalies
    using the following code:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将编写一个函数，并使用以下代码创建一个用于检测异常的阈值：
- en: '[PRE31]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Now, let''s introduce anomalies to the series using the following:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下方法向序列中引入异常：
- en: '[PRE32]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Now, let''s plot it to detect the anomalies introduced using the following
    code:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下代码来绘制它以检测引入的异常：
- en: '[PRE33]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The following diagram shows the output:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了输出结果：
- en: '![](img/7890f46f-ae72-4d05-99ed-1ff3692503b3.png)'
  id: totrans-245
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/7890f46f-ae72-4d05-99ed-1ff3692503b3.png)'
- en: Now, the introduced anomaly can be seen after 1959 as a dip in the number of
    travelers. It should be noted, however, that this is one of the simpler methods.
    ARIMA and Holt-Winters can also be used in this scenario.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，引入的异常可以在1959年之后被看作是旅行者数量的下降。然而，需要注意的是，这是一种较为简单的方法。在此场景下，也可以使用ARIMA和Holt-Winters方法。
- en: Summary
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned about time series analysis and white noise. We were
    introduced to the concepts of random walk, autoregression, autocorrelation, and
    stationarity, which describes how to figure out whether data is stationary.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了时间序列分析和白噪声。我们介绍了随机游走、自回归、自相关和平稳性的概念，这些概念描述了如何判断数据是否平稳。
- en: We also learned about differencing, taking the time series data and computing
    the differences between consecutive observations that lead to the formation of
    a new series. This chapter also talked about the AR model, which is a part of
    a stochastic process wherein the specific lagged values of *y**[t]*are used as
    predictor variables and regressed on *y**[t ]*in order to estimate the values.
    We also learned two optimization parameters, namely the AR model and ARIMA model.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还学习了差分法，即对时间序列数据进行处理，计算连续观测值之间的差异，从而形成一个新的序列。本章还讨论了AR模型，它是随机过程的一部分，其中特定滞后值*y**[t]*被用作预测变量，并回归到*y**[t ]*上来估计值。我们还学习了两个优化参数，即AR模型和ARIMA模型。
- en: In the next chapter, we will learn about natural language processing.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习关于自然语言处理的内容。
