- en: '6'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '6'
- en: Simple Linear Regression
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简单线性回归
- en: 'In previous chapters, we worked with distributions of single variables. Now
    we will discuss the relationships between variables. In this chapter and the next
    chapter, we will investigate the relationship between two or more variables using
    linear regression. In this chapter, we will discuss simple linear regression within
    the framework of `statsmodels`, and finally, we will address the scenarios of
    serial correlation and model validation. As highlighted, our main topics in this
    chapter follow this framework:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们研究了单变量分布。现在我们将讨论变量之间的关系。在本章和下一章中，我们将使用线性回归来研究两个或更多变量之间的关系。在本章中，我们将讨论在
    `statsmodels` 框架内的简单线性回归，最后我们将讨论序列相关性和模型验证的情况。正如所强调的，本章的主要主题遵循以下框架：
- en: Simple linear regression using OLS
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 OLS 的简单线性回归
- en: Coefficients of correlation and determination
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关系数和确定系数
- en: Required model assumptions
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 必要的模型假设
- en: Test for significance
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显著性检验
- en: Handling model errors
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理模型误差
- en: Validating models
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证模型
- en: Simple linear regression using OLS
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 OLS 的简单线性回归
- en: 'We will study one of the simplest machine learning models – simple linear regression.
    We will provide its overview within the context of OLS, where the objective is
    to minimize the sum of the square of errors. It is a straightforward concept related
    to a dependent variable (quantitative response) y and its independent variable
    x, where their relationship can be drawn as a straight line, approximately. Mathematically,
    a simple linear regression model can be written in the following form:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将研究最简单的机器学习模型之一——简单线性回归。我们将在 OLS 的背景下提供其概述，其目标是使误差平方和最小化。这是一个与因变量（定量响应）y 及其自变量
    x 相关的简单概念，它们之间的关系可以近似地表示为一条直线。数学上，简单线性回归模型可以写成以下形式：
- en: y = β 0 + β 1 x + ϵ
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: y = β 0 + β 1 x + ϵ
- en: Here, β 0 is the intercept term and β 1 is the slope of the linear model. The
    error term is denoted as ϵ in the preceding linear model. We can see that in an
    ideal case where the error term is zero, β 0 represents the value of the dependent
    variable y at x = 0\. Within the range of the independent variable x, β 1 represents
    the increase in the outcome y corresponding to a unit change in x. In literature,
    the independent variable x can be called the explanatory variable, predictor,
    input, or feature and the dependent variable y can be called the response variable,
    output, or target. The question is raised, “If we have a sample from a dataset
    (x i, y i) with i = 1,2, … , n points), how do we determine a line of best fit
    using the intercept term and the slope?” By estimating these terms, we will fit
    the best line through the data to show the linear relationship between the independent
    variable and the dependent variable.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，β 0 是截距项，β 1 是线性模型的斜率。误差项在先前的线性模型中表示为 ϵ。我们可以看到，在误差项为零的理想情况下，β 0 代表当 x =
    0 时因变量 y 的值。在自变量 x 的范围内，β 1 代表 x 单位变化引起的 y 的结果增加。在文献中，自变量 x 可以称为解释变量、预测变量、输入或特征，而因变量
    y 可以称为响应变量、输出或目标。问题是，“如果我们有一个来自数据集的样本（x i, y i），其中 i = 1,2, … , n 个点），我们如何通过截距项和斜率确定最佳拟合线？”通过估计这些项，我们将拟合最佳线通过数据，以显示自变量和因变量之间的线性关系。
- en: '![Figure 6.1 – The relationship between x and y – Line of best fit](img/B18945_06_001.jpg)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.1 – x 和 y 之间的关系 – 最佳拟合线](img/B18945_06_001.jpg)'
- en: Figure 6.1 – The relationship between x and y – Line of best fit
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.1 – x 和 y 之间的关系 – 最佳拟合线
- en: 'In the preceding plot example, the blue points are actual values representing
    the relationship between the independent variable x and the dependent variable
    y. The red line is the line of best fit through all these data points. Our objective
    now is to formulate the predicted line (the line of best fit):'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的图表示例中，蓝色点表示实际值，代表自变量 x 和因变量 y 之间的关系。红色线是通过所有这些数据点的最佳拟合线。我们的目标是现在制定预测线（最佳拟合线）：
- en: ˆ y  = ˆ β 0 + ˆ β 1x
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ˆ y  = ˆ β 0 + ˆ β 1x
- en: 'Take a closer look at the relationship between the predicted values and the
    true values. In order to find the line of best fit, we will minimize the vertical
    distances, meaning that we will minimize the errors between the points and the
    line through the data. In other words, we will minimize the sum of square errors,
    which is computed by the following:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 仔细观察预测值和真实值之间的关系。为了找到最佳拟合线，我们将最小化垂直距离，这意味着我们将最小化点与数据线之间的误差。换句话说，我们将最小化平方误差之和，它由以下计算得出：
- en: Σ i=1 n  e i 2
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Σ(i=1 to n) eᵢ²
- en: '![Figure 6.2 – Errors between data points and the line through the data](img/B18945_06_002.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.2 – 数据点与数据线之间的误差](img/B18945_06_002.jpg)'
- en: Figure 6.2 – Errors between data points and the line through the data
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.2 – 数据点与数据线之间的误差
- en: Here,
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，
- en: e i = y i − ˆ y i,
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: eᵢ = yᵢ − ˆyᵢ,
- en: 'where y i is the observed value and ˆ y i is the predicted value of the response
    variable y for the i th observation. The sum of the square of errors is given
    by:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 yᵢ 是第 i 个观测的响应变量 y 的观测值，ˆyᵢ 是预测值。误差平方和由以下给出：
- en: S = Σ i=1 n  (y i − ˆ β 0 − ˆ β 1 x i) 2
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: S = Σ(i=1 to n) (yᵢ − ˆβ₀ − ˆβ₁ xᵢ)²
- en: 'To minimize S, we will take the partial derivatives with respect to ˆ β 0 and
    ˆ β 1\. Then, we see:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 为了最小化 S，我们将对 ˆβ₀ 和 ˆβ₁ 求偏导数。然后，我们看到：
- en: ∂ S _ ∂ ˆ β 0  = − 2Σ(y i − ˆ β 0 − ˆ β 1 x i) = 0,
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ∂ S / ∂ ˆβ₀ = − 2Σ(yᵢ − ˆβ₀ − ˆβ₁ xᵢ) = 0,
- en: ∂ S _ ∂ ˆ β 1  = − 2Σ x i(y i − ˆ β 0 − ˆ β 1 x i) = 0.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ∂ S / ∂ ˆβ₁ = − 2Σ xᵢ(yᵢ − ˆβ₀ − ˆβ₁ xᵢ) = 0.
- en: 'Therefore, it is easy to see that:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，很容易看出：
- en: nˆ β 0 + (Σ i=1 n  x i)ˆ β 1 = Σ i=1 n  y i,
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: nˆβ₀ + (Σ(i=1 to n) xᵢ)ˆβ₁ = Σ(i=1 to n) xᵢ yᵢ,
- en: (Σ i=1 n  x i)ˆ β 0 + (Σ i=1 n  x i 2)ˆ β 1 = Σ i=1 n  x i y i,
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: (Σ(i=1 to n) xᵢ)ˆβ₀ + (Σ(i=1 to n) xᵢ²)ˆβ₁ = Σ(i=1 to n) xᵢ yᵢ,
- en: 'This implies:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着：
- en: ˆ β 0 =  Σ i=1 n  y i _ n  − ˆ β 1  Σ i=1 n  x i _ n ,
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: ˆβ₀ =  Σ(i=1 to n) yᵢ / n − ˆβ₁ / Σ(i=1 to n) xᵢ / n,
- en: Σ i=1 n  x i Σ i=1 n  y i _ n  −  (Σ i=1 n  x i) 2 _ n ˆ β 1 + (Σ i=1 n  x i 2)ˆ β 1
    = Σ i=1 n  x i y i.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: Σ(i=1 to n) xᵢ Σ(i=1 to n) yᵢ / n − (Σ(i=1 to n) xᵢ)² / n ˆβ₁ + (Σ(i=1 to n)
    xᵢ²)ˆβ₁ = Σ(i=1 to n) xᵢ yᵢ.
- en: 'Because  _ y  = Σ i=1 n  y i _ n  and  _ x  = Σ i=1 n  x i _ n , we can rewrite
    the slope and intercept as follows:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 因为  ȳ = Σ(i=1 to n) yᵢ / n 和  x̄ = Σ(i=1 to n) xᵢ / n，我们可以将斜率和截距重写如下：
- en: ˆ β 0 =  _ y  − ˆ β 1 _ x ,
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ˆβ₀ =  ȳ − ˆβ₁ / x̄,
- en: ˆ β 1 =  Σ(x i −  _ x )(y i −  _ y )  ____________  Σ (x i −  _ x ) 2 .
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ˆβ₁ =  Σ(xᵢ −  x̄)(yᵢ −  ȳ) / √(Σ(xᵢ −  x̄)²).
- en: 'In Python, we can implement the following code to find ˆ β 0 and ˆ β 1 as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Python 中，我们可以通过以下代码来找到 ˆβ₀ 和 ˆβ₁：
- en: '[PRE0]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Coefficients of correlation and determination
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 相关系数和确定系数
- en: In this section, we will discuss two related notions – coefficients of correlation
    and coefficients of determination.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论两个相关的概念——相关系数和确定系数。
- en: Coefficients of correlation
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关系数
- en: 'A coefficient of correlation is a measure of the statistical linear relationship
    between two variables and can be computed using the following formula:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 相关系数是衡量两个变量之间统计线性关系的指标，可以使用以下公式计算：
- en: r =  1 _ n − 1 Σ i=1 n (x i −  ‾ x  _ s x )(y i −  ‾ y  _ s y )
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: r =  1 / (n - 1) Σ(i=1 to n) (xᵢ −  x̄) / sₓ (yᵢ −  ȳ) / sᵧ
- en: The reader can go here – [https://shiny.rit.albany.edu/stat/corrsim/](https://shiny.rit.albany.edu/stat/corrsim/)
    – to simulate the correlation relationship between two variables.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 读者可以在此处[https://shiny.rit.albany.edu/stat/corrsim/](https://shiny.rit.albany.edu/stat/corrsim/)模拟两个变量之间的相关关系。
- en: '![Figure 6.3 – Simulated bivariate distribution](img/B18945_06_003.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.3 – 模拟的双变量分布](img/B18945_06_003.jpg)'
- en: Figure 6.3 – Simulated bivariate distribution
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.3 – 模拟的双变量分布
- en: By observing the scatter plots, we can see the direction and the strength of
    the linear relationship between the two variables and their outliers. If the direction
    is positive (r>0), then both variables increase or decrease together.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 通过观察散点图，我们可以看到两个变量及其异常值之间线性关系的方向和强度。如果方向是正的（r>0），那么两个变量同时增加或减少。
- en: '![Figure 6.4 – Simulated bivariate distribution](img/B18945_06_004.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.4 – 模拟的双变量分布](img/B18945_06_004.jpg)'
- en: Figure 6.4 – Simulated bivariate distribution
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.4 – 模拟的双变量分布
- en: 'If the direction is negative, then one variable increases while the other decreases.
    We illustrate this in the following scatter plot:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果方向是负的，那么一个变量增加而另一个变量减少。我们将在下面的散点图中说明这一点：
- en: '![Figure 6.5 – Simulated bivariate distribution](img/B18945_06_005.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.5 – 模拟的双变量分布](img/B18945_06_005.jpg)'
- en: Figure 6.5 – Simulated bivariate distribution
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.5 – 模拟的双变量分布
- en: The coefficient of correlation exists as a value between -1 and 1\. When r =1,
    we have a perfect positive correlation, and when r = -1, we have a perfect negative
    correlation. Observe that the value of the coefficient of correlation does not
    change if, for example, the variable x and the variable y are switched or if all
    values of either variable are linearly scaled. In general, correlation does not
    imply causation.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 相关系数存在于-1和1之间的值。当r = 1时，我们有一个完美的正相关，而当r = -1时，我们有一个完美的负相关。注意，如果，例如，变量x和变量y互换，或者任一变量的所有值都进行线性缩放，相关系数的值不会改变。一般来说，相关性并不表示因果关系。
- en: Coefficients of determination
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 决定系数
- en: 'The coefficient of determination is just r 2, where r is the coefficient of
    correlation, which is a proportion of the variation in the variable y, explained
    by the variable x. The value of r 2 is between 0 and 1, with the linear relationship
    between the two variables becoming stronger as its value approaches 1\. The value
    of r 2 can also be computed using the following formula:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 决定系数就是r²，其中r是相关系数，它是变量y的变异中由变量x解释的比例。r²的值在0和1之间，两个变量之间的线性关系随着其值的接近1而变得更强。r²的值也可以使用以下公式计算：
- en: r 2 = 1 −  S S Res _ S S Tot
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: r² = 1 − SSRes / SSTot
- en: Here, S S Res is the sum of the square of errors and S S Totis the total sum
    of the square of the difference between the actual value and the average value.
    In `statsmodels`, from the output of the OLS regression results, the value of
    determination can be obtained. This output is discussed in the next sections of
    this chapter.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，SSRes是误差平方和，SSTot是实际值与平均值之间差异的平方的总和。在`statsmodels`中，可以从OLS回归结果的输出中获得决定系数的值。这个输出将在本章的下一节中讨论。
- en: Required model assumptions
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 必要的模型假设
- en: 'Like the parametric tests we discussed in [*Chapter 4*](B18945_04.xhtml#_idTextAnchor070)*,
    Parametric Tests*, linear regression is a parametric method and requires certain
    assumptions to be met for the results to be valid. For linear regression, there
    are four assumptions:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们在[*第4章*](B18945_04.xhtml#_idTextAnchor070)*参数测试*中讨论的参数测试一样，线性回归是一种参数方法，并且需要满足某些假设才能使结果有效。对于线性回归，有四个假设：
- en: A linear relationship between variables
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 变量之间的线性关系
- en: The normality of the residuals
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 残差的正态性
- en: The homoscedasticity of the residuals
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 残差的同方差性
- en: Independent samples
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 独立样本
- en: Let’s discuss each of these assumptions individually.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分别讨论这些假设。
- en: A linear relationship between the variables
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 变量之间的线性关系
- en: When thinking about fitting a linear model to data, our first consideration
    should be whether the model is appropriate for the data. When working with two
    variables, the relationship between the variables should be assessed with a scatter
    plot. Let’s look at an example. Three scatter plots are shown in *Figure 6**.6*.
    The data is plotted, and the actual function used to generate the data is drawn
    over the data points. The leftmost plot shows data exhibiting a linear relationship.
    The middle plot shows data exhibiting a quadratic relationship. The rightmost
    plot shows two uncorrelated variables.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 当考虑将线性模型拟合到数据时，我们首先应该考虑模型是否适合数据。当处理两个变量时，应该使用散点图来评估变量之间的关系。让我们看一个例子。图*6**.6*中显示了三个散点图。数据被绘制，并且用于生成数据的实际函数被绘制在数据点上。最左边的图显示了表现出线性关系的数据。中间的图显示了表现出二次关系的数据。最右边的图显示了两个不相关的变量。
- en: '![Figure 6.6 – Three scatter plots depicting three distinct relationships between
    two variables](img/B18945_06_006.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图6.6 – 描述两个变量之间三种不同关系的三个散点图](img/B18945_06_006.jpg)'
- en: Figure 6.6 – Three scatter plots depicting three distinct relationships between
    two variables
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.6 – 描述两个变量之间三种不同关系的三个散点图
- en: Of the example data in *Figure 6**.6*, a linear model would only be appropriate
    for the leftmost data. In this example, we have the benefit of knowing the actual
    relationship of the two variables, but, in real problems, you will have to determine
    whether a linear model is appropriate. Once we have assessed whether a linear
    model is appropriate and fitted a linear model, we can assess the two assumptions
    that depend on the model residuals.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图6**.6*的示例数据中，线性模型仅适用于最左边的数据。在这个例子中，我们有了解两个变量实际关系的优势，但在实际问题中，你必须确定线性模型是否合适。一旦我们评估了线性模型是否合适并拟合了线性模型，我们就可以评估依赖于模型残差的两个假设。
- en: Normality of the residuals
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 残差的正态性
- en: In the previous two chapters, we discussed normality at length and looked at
    several examples of data that are normally distributed and several examples that
    were not normally distributed. In this case, we are making the same assessment,
    but it is for the model residuals rather than for the variables. In fact, unlike
    the previous parametric methods, the *variables themselves do not need to be normally
    distributed, only the residuals*. Let’s look at an example. We will fit a linear
    model on two variables, each of which exhibits a skewed distribution. As can be
    seen in *Figure 6**.7*, even though each variable has a skewed distribution, the
    variables are linearly correlated.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在前两章中，我们详细讨论了正态性，并查看了一些正态分布的数据示例和一些非正态分布的数据示例。在这种情况下，我们进行相同的评估，但这是针对模型残差而不是变量。实际上，与之前的参数方法不同，*变量本身不需要正态分布，只需残差*。让我们来看一个例子。我们将对两个变量拟合一个线性模型，每个变量都表现出偏斜的分布。如图*6.7*所示，尽管每个变量都有偏斜的分布，但变量之间是线性相关的。
- en: '![Figure 6.7 – Distributions of X, Y, and their scatter plots](img/B18945_06_007.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图6.7 – X, Y及其散点图的分布](img/B18945_06_007.jpg)'
- en: Figure 6.7 – Distributions of X, Y, and their scatter plots
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.7 – X, Y及其散点图的分布
- en: Now, let’s look at the residuals from the model fit. The residuals from the
    model fit are shown in *Figure 6**.8*. As we expect, the residuals from this model
    fit appear to be normally distributed. This model appears to meet the assumption
    of normally distributed residuals.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看模型拟合的残差。模型拟合的残差显示在*图6.8*中。正如我们所预期的那样，这个模型拟合的残差看起来是正态分布的。这个模型似乎满足正态分布残差的假设。
- en: '![Figure 6.8 – Residuals from model fit](img/B18945_06_008.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图6.8 – 模型拟合的残差](img/B18945_06_008.jpg)'
- en: Figure 6.8 – Residuals from model fit
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.8 – 模型拟合的残差
- en: With the assumption of normally distributed residuals verified, let’s move on
    to the assumption of homoscedasticity of the residuals.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在验证了正态分布残差的假设后，让我们继续到残差同方差性的假设。
- en: Homoscedasticity of the residuals
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 残差的同方差性
- en: Not only should the residuals be normally distributed, but the residuals should
    also have constant variance over the linear model. **Homoscedasticity** refers
    to the residuals having equal scatter. Conversely, residuals that do exhibit equal
    spread are said to be **heteroscedastic**. Homoscedasticity is generally assessed
    by plotting the residuals against the model predictions with a scatter plot. The
    residuals should appear to be randomly distributed with a mean of 0 and equally
    dispersed along the *x* axis. *Figure 6**.9* shows a scatter plot of the model
    residuals against the predicted value of *Y*. These residuals appear to exhibit
    homoscedasticity.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 不仅残差应该是正态分布的，而且残差在线性模型中应该具有恒定的方差。**同方差性**指的是残差具有相同的分散度。相反，表现出相同分散度的残差被称为**异方差性**。同方差性通常通过散点图来评估残差与模型预测的关系。残差应该看起来是随机分布的，均值为0，并且在*x*轴上均匀分散。*图6.9*显示了模型残差与预测值*Y*的散点图。这些残差看起来表现出同方差性。
- en: '![Figure 6.9 – Scatter plot of model residuals versus prediction](img/B18945_06_009.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图6.9 – 模型残差与预测值的散点图](img/B18945_06_009.jpg)'
- en: Figure 6.9 – Scatter plot of model residuals versus prediction
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.9 – 模型残差与预测值的散点图
- en: 'There are a few common ways the homoscedasticity of the residuals could be
    violated:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 存在几种常见的残差同方差性可能被违反的方式：
- en: The residuals show a systematic change in variance
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 残差显示出方差系统性的变化
- en: There is an extreme outlier
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存在一个极端的异常值
- en: Two examples of these violations are shown in *Figure 6**.10*. The left plot
    shows an extreme outlier, and the right plot shows non-constant variance in the
    residuals. In both cases, the model assumptions are violated.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '*图6.10*展示了这些违反的两种示例。左图显示了一个极端的异常值，右图显示了残差中的非恒定方差。在这两种情况下，模型假设都被违反了。'
- en: '![Figure 6.10 – Example residuals that exhibit poor behavior](img/B18945_06_010.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图6.10 – 表现出不良行为的示例残差](img/B18945_06_010.jpg)'
- en: Figure 6.10 – Example residuals that exhibit poor behavior
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.10 – 表现出不良行为的示例残差
- en: When the residuals show a systematic pattern, it may be an indication that another
    type of model would be more appropriate, or it may be helpful to apply a transformation
    to one or both variables. When an extreme outlier is present, it may be worth
    verifying and investigating the data point to ensure it should be included in
    the analysis. In the next section, we will discuss how extreme outliers impact
    the model fit.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 当残差显示出系统性模式时，这可能表明另一种类型的模型可能更合适，或者对其中一个或两个变量应用转换可能有所帮助。当存在极端异常值时，可能值得验证和调查该数据点，以确保它应该包含在分析中。在下一节中，我们将讨论极端异常值如何影响模型拟合。
- en: Sample independence
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 样本独立性
- en: We have discussed sample independence in previous chapters. There are no graphics
    or statistics that can be used to determine whether samples are independent. *Assessing
    sample independence requires careful analysis of the sampling method and the populations
    from which the samples are drawn*. For example, a common type of data that violates
    the independence assumption is time-series data. Time-series data is a type of
    data that is sampled over time, making it serially correlated. We will discuss
    analysis methods for time-series data in later chapters.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在之前的章节中讨论了样本独立性。没有图形或统计方法可以用来确定样本是否独立。*评估样本独立性需要对抽样方法和样本来源的总体进行仔细分析*。例如，违反独立性假设的常见数据类型是时间序列数据。时间序列数据是一种随时间采样的数据类型，使其具有序列相关性。我们将在后面的章节中讨论时间序列数据的分析方法。
- en: In this section, we discussed the linear regression model assumptions. In the
    next section, we will discuss how to validate a linear model, which will again
    utilize the model residuals.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们讨论了线性回归模型的假设。在下一节中，我们将讨论如何验证线性模型，这又将利用模型残差。
- en: Testing for significance and validating models
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检验显著性和验证模型
- en: Up to this point in the chapter, we have discussed the concepts of the OLS approach
    to linear regression modeling; the coefficients in a linear model; the coefficients
    of correlation and determination; and the assumptions required for modeling with
    linear regression. We will now begin our discussion on testing for significance
    and model validation.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，本章我们已经讨论了线性回归建模的OLS方法的概念；线性模型中的系数；相关系数和确定系数；以及使用线性回归建模所需的假设。现在，我们将开始讨论检验显著性以及模型验证。
- en: Testing for significance
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检验显著性
- en: 'To test for significance, let us load `statsmodels` macrodata data set so we
    can build a model that tests the relationship between real gross private domestic
    investment, `realinv`, and real private disposable income, `realdpi`:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检验显著性，让我们加载`statsmodels`宏数据集，这样我们就可以构建一个测试实际国内私人总投资`realinv`和实际私人可支配收入`realdpi`之间关系的模型：
- en: '[PRE1]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Least squares regression requires a constant coefficient in order to derive
    the `statsmodels’` `add_constant` function here:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 最小二乘回归需要一个常数系数，以便在这里推导出`statsmodels`的`add_constant`函数：
- en: '[PRE2]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The input data does not need to be normally distributed for least squares regression.
    However, it is assumed that the residuals of the model are normally distributed.
    However, it is useful to see the spread of the data to get an understanding of
    their statistics, such as the mean, median, and range, and whether there are outliers
    present. If the residual analysis after the modeling suggests there may be some
    issues, having inspected the model variables will help the analyst understand
    potential root causes.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 输入数据不需要服从正态分布即可进行最小二乘回归。然而，假设模型的残差是正态分布的。然而，查看数据的分布以了解其统计数据（如均值、中位数和范围）以及是否存在异常值是有用的。如果模型后的残差分析表明可能存在一些问题，检查模型变量将有助于分析师了解潜在的根本原因。
- en: '![Figure 6.11 – Visualizing the distributions of the realinv and realdpi variables](img/B18945_06_011.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图6.11 – 可视化*realinv*和*realdpi*变量的分布](img/B18945_06_011.jpg)'
- en: Figure 6.11 – Visualizing the distributions of the *realinv* and *realdpi* variables
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.11 – 可视化*realinv*和*realdpi*变量的分布
- en: When visualizing the relationship between `realinv` and `realdpi`, we can see
    a strong linear relationship, but also a potential serial correlation in the data
    as there appears to be a somewhat **cyclical oscillation** in the data, which
    becomes stronger toward the extreme values, seen in the upper right of the plot.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 当可视化`realinv`和`realdpi`之间的关系时，我们可以看到一个强烈的线性关系，但数据中也存在潜在的序列相关性，因为数据似乎存在某种**周期性振荡**，在图表的右上角这种振荡变得更强烈。
- en: '![Figure 6.12 – Visualizing the relationship between the realinv and realdpi
    variables](img/B18945_06_012.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![图6.12 – 可视化realinv和realdpi变量之间的关系](img/B18945_06_012.jpg)'
- en: Figure 6.12 – Visualizing the relationship between the *realinv* and *realdpi*
    variables
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.12 – 可视化`realinv`和`realdpi`变量之间的关系
- en: 'We will analyze the potential serial correlation seen in the preceding plot
    after a few more steps. First, let us fit the input variable and coefficient to
    the model:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行更多步骤之后，我们将分析前图中观察到的潜在序列相关性。首先，让我们将输入变量和系数拟合到模型中：
- en: '[PRE3]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Next, we will want to print out a summary of the model performance so we can
    begin to gauge the significance of the terms involved:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将打印出模型性能的摘要，以便我们可以开始评估涉及项的重要性：
- en: '[PRE4]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Referring to the results in *Figure 6**.13*, we can see that the `const`, nor
    the input variable, `realinv`, contains zero. Therefore, in addition to the **significant
    p-values** for these variables, we can conclude they are significant contributors
    to the target at the coefficients provided. Now that we have confirmed there is
    statistical significance for both the intercept and the input variable and their
    coefficients, we want to know the level of correlation to the target they represent.
    We can see the **R-squared** statistic is 0.944\. Because the two variables are
    the constant and the input variable, this R-squared statistic explains only the
    input variable.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 参考图6**.13**的结果，我们可以看到`const`（常数）和输入变量`realinv`均不含零。因此，除了这些变量的**显著p值**外，我们还可以得出结论，它们是目标系数提供的显著贡献者。现在我们已经确认截距和输入变量及其系数的统计显著性，我们想知道它们与目标的相关程度。我们可以看到**R平方**统计量为0.944。由于这两个变量是常数和输入变量，这个R平方统计量仅解释了输入变量。
- en: R-squared versus adjusted r-squared
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: R平方与调整后的R平方
- en: For multivariate regression, we would look at the adjusted r-squared value,
    which we can also see is the same – in the univariate/simple regression case –
    as the r-squared value.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 对于多元回归，我们将查看调整后的R平方值，我们也可以看到，在单变量/简单回归的情况下，它与R平方值相同。
- en: The **correlation of determination** – also called goodness of fit – of 0.944
    means real gross private domestic investment explains 94.4% of the variance in
    real private disposable income.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '**确定系数**（也称为拟合优度）为0.944，意味着实际国内私人总投资解释了实际私人可支配收入中94.4%的方差。'
- en: We can see based on the table that the intercept and the `realinv` variable
    are both significant in predicting the target with very low p-values. We can also
    see that neither of the 95% confidence intervals contains 0, which backs up the
    relevancy of their p-values. However, the confidence interval for the constant
    (intercept) suggests there may be a risk of uncertainty in the model and that
    more variables may be needed to reduce that uncertainty and improve model performance.
    Stated differently, we could say a higher level of uncertainty in the constant
    indicates the model has variance left to be explained and that the current model
    is overly biased.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 根据表格，我们可以看到截距和`realinv`变量在预测目标变量时都具有显著性，且p值非常低。我们还可以看到，95%的置信区间均不包含0，这证实了它们p值的关联性。然而，对于常数（截距）的置信区间表明，模型可能存在不确定性的风险，可能需要更多变量来减少这种不确定性并提高模型性能。换句话说，我们可以认为常数的不确定性越高，模型中剩余可解释的方差就越多，当前模型就过于偏颇。
- en: Validating models
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 验证模型
- en: The Durbin-Watson test
  id: totrans-115
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Durbin-Watson检验
- en: It is important to acknowledge that based on the fact that data was observed
    over a 50-year period and random sampling was not performed, it is possible the
    residuals will have a **serial correlation**. We observe a possibility of serial
    correlation in the **Durbin-Watson test** statistic of 0.095, which suggests the
    residuals exhibit positive autocorrelation. The Durbin-Watson statistic tests
    whether there is autocorrelation at the first time lag. This means the Durbin-Watson
    tests whether the change in values between each data point is correlated with
    the value of the previous data point. If that correlation exists, it is considered
    **lag-one autocorrelation**.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要承认，由于数据是在50年的时间跨度内观察到的，并且没有进行随机抽样，因此可能存在序列相关性。我们在Durbin-Watson检验统计量0.095中观察到序列相关性的可能性，这表明残差表现出正自相关性。Durbin-Watson统计量检验是否存在一阶自相关性。这意味着Durbin-Watson检验每个数据点之间的变化是否与先前数据点的值相关。如果存在这种相关性，则被认为是**一阶自相关性**。
- en: Durbin-Watson test statistic
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: Durbin-Watson检验统计量
- en: As a rule of thumb, a Durbin-Watson test statistic below roughly 2.0 (many consider
    1.5 to 2.0 to be reasonable) is considered a flag for positive autocorrelation,
    while a value above roughly 2.0 (many consider 2.0 to 2.5 to be reasonable) indicates
    possible negative autocorrelation. Procedurally, a table lookup is required to
    identify the critical values against which the test statistic should be measured.
    The process follows the same steps for any hypothesis test with respect to comparing
    the test statistic against the critical value. The Durbin-Watson test is typically
    interpreted as a one-tailed test as inference from a two-tailed test is not particularly
    useful. A version of the Durbin-Watson table can be found at [https://www.real-statistics.com/statistics-tables/durbin-watson-table/](https://www.real-statistics.com/statistics-tables/durbin-watson-table/).
    This table produces the critical values for **positive autocorrelation**. To find
    the critical values for **negative autocorrelation**, the positive critical values
    can be subtracted from 4.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，Durbin-Watson 统计量低于大约 2.0（许多人认为 1.5 到 2.0 是合理的）被视为正自相关的一个标志，而高于大约 2.0（许多人认为
    2.0 到 2.5 是合理的）则表明可能存在负自相关。在程序上，需要通过查表来确定与测试统计量应进行比较的关键值。这个过程遵循任何假设检验的相同步骤，即比较测试统计量与临界值。Durbin-Watson
    测试通常被解释为单尾测试，因为从双尾测试中得出的推断并不特别有用。Durbin-Watson 表的版本可以在[https://www.real-statistics.com/statistics-tables/durbin-watson-table/](https://www.real-statistics.com/statistics-tables/durbin-watson-table/)找到。此表产生正自相关的临界值。要找到负自相关的临界值，可以将正临界值从
    4 中减去。
- en: Although we have a Durbin-Watson statistic that suggests serial correlation
    may be present in the data, we will confirm significance by comparing the Durbin-Watson
    statistic to its corresponding positive autocorrelation `statsmodels`’ OLS regression,
    we find the bounds for the `k=1` input variable to be `[1.758, 1.779]`. A value
    within this range should be interpreted as **inconclusive**. A value less than
    the lower bound indicates the presence of enough evidence to reject the null hypothesis
    and thus conclude there is statistically significant positive autocorrelation.
    A value greater than the upper bound indicates there is not enough evidence to
    reject the null hypothesis and thus there is no autocorrelation. Based on the
    results of our model, we can conclude with a 95% level of confidence that there
    is evidence of positive serial correlation in our residuals.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们有一个 Durbin-Watson 统计量表明数据中可能存在序列相关，但我们将通过将其与对应的正自相关 `statsmodels` 的 OLS
    回归进行比较来确认其显著性。我们发现 `k=1` 输入变量的界限为 `[1.758, 1.779]`。在此范围内的值应被解释为**不确定**。低于下限的值表明有足够的证据拒绝零假设，从而得出存在统计上显著的积极自相关的结论。高于上限的值表明没有足够的证据拒绝零假设，因此没有自相关。根据我们模型的结果，我们可以有
    95% 的置信水平得出结论，我们的残差中存在正序列相关的证据。
- en: '![Figure 6.13 – OLS regression model output for realdpi](img/B18945_06_013.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.13 – 为 realdpi 的 OLS 回归模型输出](img/B18945_06_013.jpg)'
- en: Figure 6.13 – OLS regression model output for *realdpi*
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.13 – 为 *realdpi* 的 OLS 回归模型输出
- en: At this point, an analyst may want to consider addressing the serial correlation
    before moving forward. However, for the purpose of following the process of end-to-end
    model validation, we will move forward to the next steps.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，分析师可能想要在继续前进之前解决序列相关问题。然而，为了遵循端到端模型验证的过程，我们将继续进行下一步。
- en: Diagnostic plots for analyzing model errors
  id: totrans-123
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 用于分析模型错误的诊断图
- en: 'As mentioned, y i = β 0 + β 1 x i + e i, where in regression, β 0 + β 1 x i
    is the predicted mean for y i given x i and e i is the error term – also called
    the residual term, which is calculated as the observed value for a data point
    minus the predicted value for that data point. The residuals in least squares
    linear regression must approximate a normal distribution centered around the mean
    with a standard deviation. The method for deriving the residuals for a fitted
    model is to subtract the predicted value from the actual value for each observation.
    Four common visualizations for inspecting the fit of a least squares regression
    model are as follows:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，y_i = β_0 + β_1 x_i + e_i，其中在回归中，β_0 + β_1 x_i 是给定 x_i 的 y_i 的预测均值，而 e_i
    是误差项——也称为残差项，它是通过观察值减去该数据点的预测值来计算的。最小二乘线性回归中的残差必须近似于以均值为中心、具有标准差的正态分布。推导拟合模型的残差的方法是从每个观察的实际值中减去预测值。以下是最小二乘回归模型拟合的四个常见可视化方法：
- en: '**Residuals versus fitted plots**, used to inspect the requirement of a linear
    relationship between the input and target variables'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**残差与拟合图**，用于检查输入和目标变量之间线性关系的必要性'
- en: '**Quantile plots**, used to inspect the assumption of residuals being normally
    distributed'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分位数图**，用于检查残差正态分布的假设'
- en: '**Scale-location plots**, used to inspect the assumption of homoscedasticity,
    or the homogenous distribution of variation'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**尺度-位置图**，用于检查同方差性的假设，或变化的同质性分布'
- en: '**Residuals versus leverage influence plots**, which help identify the impact
    outliers may have on model fit'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**残差与杠杆影响图**，有助于识别异常值可能对模型拟合产生的影响'
- en: 'To produce these plots, we can use the following Python code implementation:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 要生成这些图，我们可以使用以下Python代码实现：
- en: '[PRE5]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The following output contains four common diagnostic plots.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 以下输出包含四个常见的诊断图。
- en: '![Figure 6.14 – Linear regression diagnostic plots](img/B18945_06_014.jpg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![图6.14 – 线性回归诊断图](img/B18945_06_014.jpg)'
- en: Figure 6.14 – Linear regression diagnostic plots
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.14 – 线性回归诊断图
- en: Residuals versus fitted
  id: totrans-134
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 残差与拟合
- en: One requirement of least squares regression is a **linear relationship** between
    the input and target variables. Suffice it to say a strongly correlated relationship
    exists between the input and target variables. This plot helps the analyst assess
    the linearity between the two.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 最小二乘回归的一个要求是输入和目标变量之间的**线性关系**。简单来说，输入和目标变量之间存在强烈的关联关系。这个图帮助分析师评估两者之间的线性关系。
- en: We should expect the fitted line – representing the model – to be horizontal,
    representing the strength of the linear relationship between the input and target
    variable across all data points. The residuals should be roughly evenly spread
    around the line in reasonable proximity. If these attributes cannot be confirmed,
    a non-linear relationship may exist between the two variables. A transformation
    of at least one of the variables – if the variable is skewed – may help resolve
    this type of issue. However, it could also be that a non-parametric model is more
    appropriate, which is often the case when categorical features – or encoded categorical
    features – are present.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该期望拟合线——代表模型——是水平的，表示输入和目标变量之间线性关系在所有数据点上的强度。残差应该在大致合理的距离内均匀地分布在直线周围。如果这些属性无法得到证实，两个变量之间可能存在非线性关系。至少对其中一个变量进行转换——如果变量是偏斜的——可能有助于解决这类问题。然而，也可能是一个非参数模型更为合适，这在存在分类特征——或编码后的分类特征——的情况下通常是这种情况。
- en: Our model produced a plot that does not display evenly spread residuals forming
    around a horizontal line. Rather, the line is concaved down, which suggests a
    polynomial or non-parametric regression may be more appropriate. Additionally,
    the residuals form a pattern toward the right end of the line that suggests there
    may be some serial correlation in the data as it exhibits some sinusoidal behavior.
    We were able to identify the presence of serial correlation using the Durbin-Watson
    statistic. This is likely due to the fact the data was not randomly sampled and
    was collected over a long period of time.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成的图没有显示均匀分布在水平线周围的残差。相反，线是向下凹的，这表明多项式或非参数回归可能更为合适。此外，残差在线的右侧形成了一种模式，这表明数据可能存在一些序列相关性，因为它表现出一些正弦行为。我们能够使用Durbin-Watson统计量识别出序列相关性的存在。这很可能是由于数据不是随机抽取的，而是在很长的一段时间内收集的。
- en: QQ plot of residuals
  id: totrans-138
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 残差的QQ图
- en: Assessment of normality for the QQ plot follows the same procedure as assessing
    normality using the QQ plot in [*Chapter 4*](B18945_04.xhtml#_idTextAnchor070)*,
    Parametric Tests*. The primary purpose of this plot is to assess the required
    assumption of the **normal distribution of errors**. Minor deviation of the residuals
    from the 45-degree line in the plot is normal, but extreme skewness or deviation
    from the line may indicate a poor fit. Such a scenario could indicate poor statistical
    power. In the event of skewness, data transformation – such as a log transformation
    – could be useful to resolve the issue. Dropping outliers may be another suitable
    solution. However, rather than dropping outliers outright, it is advisable to
    ensure there was not an error in data handling that could be resolved to make
    the outliers conform.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: QQ图的正态性评估遵循与在[*第4章*](B18945_04.xhtml#_idTextAnchor070)*，参数检验*中使用QQ图评估正态性的相同程序。此图的主要目的是评估**误差的正态分布**所需的假设。残差在图中45度线附近的轻微偏差是正常的，但极端偏斜或偏离线可能表明拟合度不佳。这种情况可能表明统计功效差。在出现偏斜的情况下，数据转换（如对数转换）可能有助于解决问题。删除异常值可能是一种合适的解决方案。然而，与其直接删除异常值，不如确保没有在数据处理中发生错误，这些错误可以通过使异常值符合要求来解决。
- en: In the QQ plot for our model’s residuals, we can see some moderate left-side
    skewness and extreme right-side skewness, which suggests the three values in the
    right tail could be extreme outliers. Aside from this, we can assume that overall,
    the residual error is approximately normally distributed.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们模型残差的QQ图中，我们可以看到一些适度的左侧偏斜和极端的右侧偏斜，这表明右侧尾部的三个值可能是极端异常值。除此之外，我们可以假设总体上，残差误差近似正态分布。
- en: Scale-location
  id: totrans-141
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 尺度-位置
- en: The scale-location plot of the square root of the standardized residuals helps
    analysts use visual inspection to determine whether there is **homoscedasticity**
    – or *non-constant* variance – of the residuals, which is required for a least
    squares regression model. The plot visualizes the square root of the absolute
    value of the standardized residuals. Analyzing homoscedasticity can sometimes
    be useful for identifying potential issues related to **sample independence**,
    another requirement of least-squares regression. However, the Durbin-Watson test
    should be given more weight for testing this assumption.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 标准化残差的平方根的尺度-位置图有助于分析师通过视觉检查确定残差是否存在**同方差性**——或*非恒定*方差，这是最小二乘回归模型所必需的。该图可视化标准化残差的绝对值的平方根。分析同方差性有时有助于识别与**样本独立性**相关的潜在问题，这是最小二乘回归的另一个要求。然而，在测试此假设时，应更重视Durbin-Watson测试。
- en: In assessing our model, we can see the line has some deviation from being perfectly
    horizontal. Additionally, the residuals, while seeming to have a large amount
    of constant variance, nonetheless at times exhibit patterns, which conflicts with
    the behavior of homoscedasticity. Furthermore, there appear to be three very notable
    outliers. Based on this information, we can reasonably assume a risk of heteroscedasticity
    – or *constant* variance – exists within the model’s residuals.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估我们的模型时，我们可以看到线与完全水平的状态有一些偏差。此外，残差虽然看似具有大量恒定的方差，但有时会表现出模式，这与同方差性的行为相冲突。此外，似乎有三个非常明显的异常值。基于这些信息，我们可以合理地假设模型残差中存在异方差性——或*恒定*方差。
- en: Residuals versus leverage influence
  id: totrans-144
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 残差与杠杆影响
- en: Assessing the residuals versus leverage influence is another approach to assessing
    model fit. In addition to gauging leverage, this plot also shows when **Cook’s
    distance** is beyond a reasonable level.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 评估残差与杠杆影响是评估模型拟合度的一种另一种方法。除了衡量杠杆作用外，此图还显示了**库克距离**何时超出合理水平。
- en: '**Leverage** is used to identify the distance of an individual point from all
    other points. High leverage for a residual likely means the corresponding data
    point is an outlier strongly influencing the model to fit less approximately to
    the overall data and instead give more weight to that specific value. Residuals
    should be between -2 and 2 to not be considered potential outliers. Values between
    +/-2.5 to 3 suggest data points are extreme outliers. Overall, this plot is useful
    for separating outliers that have no significant negative impact on the model
    from the ones that do.'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '**杠杆作用**用于确定一个点与其他所有点之间的距离。对于残差的杠杆作用较高可能意味着相应的数据点是强异常值，强烈影响模型以更不精确地拟合整体数据，并给予该特定值更多的权重。残差应在-2到2之间，否则不应被视为潜在的异常值。介于+/-2.5到3之间的值表明数据点是极端异常值。总的来说，这个图有助于将没有对模型产生显著负面影响的异常值与那些确实有影响的异常值区分开来。'
- en: '**Cook’s distance** is a measurement that uses both an observation’s leverage
    and its residual value. As the leverage is higher, its calculated Cook’s distance
    is higher. In general, a Cook’s distance value greater than 0.5 means a residual
    has leverage that is negatively impacting the model through over-representation
    – essentially, an outlier. Cook’s distance is included in the code and flags the
    residuals that have distances greater than 0.5\. Cook’s distance is particularly
    useful because removing outliers may not have a significant impact on the model.
    However, if the outlier has a high Cook’s distance value, that is a strong indication
    that resolving the outlier **will benefit** the model. Cook’s distance is calculated
    for each data point by removing it from the model and calculating the difference
    in error divided by the mean squared error multiplied by the number of model coefficients
    plus one. Its formulation follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '**库克距离**是一种同时使用观测值的杠杆作用和残差值的测量方法。随着杠杆作用的提高，其计算的库克距离也更高。一般来说，库克距离值大于0.5意味着残差具有杠杆作用，通过过度表示对模型产生负面影响——本质上是一个异常值。库克距离包含在代码中，并标记出距离大于0.5的残差。库克距离特别有用，因为移除异常值可能不会对模型产生重大影响。然而，如果异常值的库克距离值较高，这强烈表明解决异常值**将有助于**模型。库克距离是通过从模型中移除每个数据点并计算误差差异除以均方误差乘以模型系数数量加一来计算的。其公式如下：'
- en: D i =  ∑ j=1 n  (ŷ j − ŷ j(i)) 2  ___________  (p + 1)σ ̂ 2
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: D i =  ∑ j=1 n  (ŷ j − ŷ j(i)) 2  ___________  (p + 1)σ ̂ 2
- en: where ŷ j is the *j*th estimate of the response and ŷ j(i) is the value of the
    *j*th fitted value with the *i*th value removed. *p* is the number of coefficients
    in the model and σ ̂ 2 is the variance of the residuals for all observations,
    including those removed, also called the squared error.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ŷ j 是响应的 *j* 次估计，ŷ j(i) 是移除 *i* 次拟合值后的 *j* 次拟合值。*p* 是模型中的系数数量，σ ̂ 2 是所有观测值的残差方差，包括那些被移除的，也称为平方误差。
- en: In the plot for our model, we can observe three extreme outliers. However, we
    can also see no value of Cook’s distance is greater than 0.5\. As with the scale-location
    plot, the standardized residuals should follow even distribution around a smoothed
    line that is horizontal, which indicates a constant variance. We can see from
    our model’s output that this is not the case.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们模型的图中，我们可以观察到三个极端异常值。然而，我们也可以看到库克距离的值没有大于0.5的。与尺度-位置图一样，标准化残差应围绕一条水平平滑线均匀分布，这表明方差是恒定的。我们可以从我们模型的输出中看到，情况并非如此。
- en: Addressing issues with residuals
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 解决残差问题
- en: 'Alone, each plot can be considered enough to negate the validity of a model.
    However, it is useful to consider all plots since a model may still be useful
    if there is only some deviance from expectations in the diagnostic plots. Some
    approaches to resolving issues with residuals are as follows:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 单独来看，每个图都可以被认为是足以否定模型的有效性。然而，考虑所有图是有用的，因为如果诊断图中只有一些与预期不符的偏差，模型仍然可能是有用的。以下是一些解决残差问题的方法：
- en: Investigating and resolving any data collection issues that may produce outliers
    or data inconsistencies
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调查和解决可能导致异常值或数据不一致性的任何数据收集问题
- en: Removing outliers outright
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 直接移除异常值
- en: Improving the sampling approach using methods such as using random or stratified
    sampling
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用随机或分层抽样等方法改进采样方法
- en: Performing data transformations, such as a log or square root transformation
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行数据转换，例如对数或平方根转换
- en: Including additional input variables that can help explain the target variable
    or any serial correlation that may be present
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含额外的输入变量，这些变量可以帮助解释目标变量或可能存在的任何序列相关性
- en: Handling serial correlation
  id: totrans-158
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 处理序列相关性
- en: If uncertain of the presence of serial correlation in the residuals, a useful
    next step is to analyze a **Partial Autocorrelation Function** (**PACF**) plot
    to assess whether serial correlation exists in the model at a significant level,
    which could explain issues with the model’s residuals.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果对残差中是否存在序列相关性不确定，一个有用的下一步是分析**偏自相关函数**（**PACF**）图，以评估模型在显著水平上是否存在序列相关性，这可能会解释模型残差的问题。
- en: ACF and PACF
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: ACF和PACF
- en: The **PACF** provides a partial correlation between the value of a point and
    previous points, called lags, by controlling for the lags between. Controlling
    the lags between is where the term “partial” comes from. If a specific point at
    lag zero in a dataset is correlated strongly with the value of the third lagging
    point, there would be a significant correlation with a lag of 3, but not a lag
    of 2 or 1\. In time-series modeling, the PACF is used to directly derive the autoregressive
    orders, denoted as *AR(n)* where *n* is the lag. The **Autocorrelation Function**
    (**ACF**), which is used for determining moving average orders, denoted as *MA(n),*
    considers the correlation between data points at lag zero and all previous lagging
    points without controlling for the relationships between them. Stated alternatively,
    autocorrelation in an ACF plot at lag 3 will provide autocorrelation across points
    0 through 3 whereas correlation in a PACF plot at lag 3 will provide autocorrelation
    only between point 0 and point 3, excluding the impact of values at lags 1 and
    2.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '**PACF**通过控制滞后之间的差异，提供了点值与先前点（称为滞后）之间的部分相关性。控制滞后之间的差异是“部分”一词的来源。如果一个数据集中滞后零处的特定点与第三个滞后点的值强烈相关，那么它将与滞后3有显著相关性，但不会与滞后2或1有相关性。在时间序列建模中，PACF用于直接推导自回归阶数，表示为*AR(n)*，其中*n*是滞后。**自相关函数**（**ACF**），用于确定移动平均阶数，表示为*MA(n)*，考虑了在滞后零的数据点与所有先前滞后点之间的相关性，而不控制它们之间的关系。换句话说，ACF图在滞后3处的自相关性将提供从点0到点3的跨点自相关性，而PACF图在滞后3处的相关性将只提供点0和点3之间的自相关性，排除了滞后1和2处值的影响。'
- en: 'We can execute the following code to generate the PACF plot with a 95% confidence
    interval using the most recent 50 data points, ordered by index positioning –
    in this case, by date:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过以下代码生成使用最近50个数据点（按索引位置排序，在本例中按日期排序）的PACF图，并带有95%置信区间：
- en: '[PRE6]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![Figure 6.15 – Partial autocorrelation plot for the model residuals](img/B18945_06_015.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![图6.15 – 模型残差的偏自相关图](img/B18945_06_015.jpg)'
- en: Figure 6.15 – Partial autocorrelation plot for the model residuals
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.15 – 模型残差的偏自相关图
- en: In the PACF plot in *Figure 6**.15*, we see very strong and significant correlations
    at lags 0 and 1\. We observe a low level of significant correlation (approximately
    -0.25) for lags 2 and 36, extending beyond the 95% confidence interval. What this
    tells us is we might be better off modeling the dataset with a first-order autoregressive
    (**AR(1)**) time-series model than a linear regression model.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在图6.15的PACF图中，我们看到在滞后0和1处存在非常强烈且显著的关联。我们观察到滞后2和36的显著关联水平较低（大约为-0.25），并延伸到95%置信区间之外。这告诉我们，我们可能更适合用一阶自回归（**AR(1)**）时间序列模型来建模数据集，而不是线性回归模型。
- en: Answering regression questions with a least squares method when there is a presence
    of significant autocorrelation creates inherit risk. There are methods to adjust
    the results of a model when there is autocorrelation detected, such as taking
    a **first-order difference** – or another type of low-pass filter - or applying
    the Cochrane-Orcutt, Hildreth-Lu, or Yule-Walker adjustments. However, it is ideal
    to perform a time-series analysis, as the results of that type of modeling are
    more robust to time-dependent patterns. We will introduce time series in [*Chapter
    10*](B18945_10.xhtml#_idTextAnchor160), *Introduction to Time Series*, where we
    discuss simple and complex methods for approximating time series to produce more
    useful results.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 当存在显著的自相关时，使用最小二乘法回答回归问题会带来固有的风险。当检测到自相关时，有方法可以调整模型的结果，例如采用**一阶差分**——或另一种类型的低通滤波器——或者应用Cochrane-Orcutt、Hildreth-Lu或Yule-Walker调整。然而，进行时间序列分析是理想的，因为这种类型建模的结果对时间依赖性模式更稳健。我们将在[*第10章*](B18945_10.xhtml#_idTextAnchor160)中介绍时间序列，*时间序列简介*，我们将讨论近似时间序列以产生更有用结果的方法。
- en: Let us consider a first-order difference of the data. Regarding *Figure 6**.16*,
    we first look at the ACF plot and original data for the input variable, `realdpi`.
    We can see an exponentially growing line (original data) that displays an exponentially
    dampening ACF plot. This ACF behavior is typical for **trended** data that often
    benefits from **first-order differencing**. The low autoregressive ordering identified
    in the PACF indicates this may be sufficient for a regression model to proceed.
    Had the ACF shown different behavior, such as sinusoidal (seasonal) autocorrelation,
    or the PACF shown more partial autocorrelation, we would have evidence against
    a first-order difference being a sufficient solution for resolving serial correlation
    and proceeding with least squares regression. ACFs and PACFs for least squares
    regression should ideally have no significantly correlated lags. However, when
    the ACF exhibits this behavior and the PACF shows no significance, or when the
    level of correlation is very low, regression may perform well. It is preferable
    to see no patterns or peaks in either plot. Regardless, in either case, model
    error should be assessed, in addition to the autocorrelation of the residuals,
    to determine if least squares regression performs as needed.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑数据的一阶差分。关于*图6**.16，我们首先查看输入变量`realdpi`的ACF图和原始数据。我们可以看到一个指数增长的线（原始数据），它显示了一个指数衰减的ACF图。这种ACF行为对于**趋势**数据是典型的，这类数据通常从**一阶差分**中受益。在PACF中识别出的低自回归阶数表明，这可能足以使回归模型继续进行。如果ACF显示出不同的行为，例如正弦波（季节性）自相关，或者PACF显示出更多的部分自相关，我们将有证据表明一阶差分不是解决序列相关并继续进行最小二乘回归的充分解决方案。对于最小二乘回归，ACF和PACF的理想情况是没有显著相关的滞后。然而，当ACF表现出这种行为，而PACF没有显示出显著性，或者当相关程度非常低时，回归可能表现良好。最好是两个图表中都没有模式或峰值。无论如何，在两种情况下，都应该评估模型误差，以及残差的自相关性，以确定最小二乘回归是否按需执行。
- en: 'Using the `diff()` `numpy` function, we take a first-order, low-pass difference
    and plot the ACFs, PACFs, and line plots for the original and differenced data.
    We can see a significant reduction in autocorrelation as a result. As an aside,
    the post-differencing autocorrelation suggests an **autoregressive moving average**
    (**ARMA**) model of AR order 1 and MA order 1 may be better suited than least-squares
    regression. However, we will ignore this for the chapter and continue:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`diff()` `numpy`函数，我们对原始数据进行了首次低通差分，并绘制了ACF、PACF和原始数据与差分数据的线图。结果我们可以看到自相关性的显著降低。顺便提一下，差分后的自相关性表明，一阶自回归移动平均（**ARMA**）模型，AR阶数为1，MA阶数为1，可能比最小二乘回归更适合。然而，我们将忽略这一点，继续进行：
- en: '[PRE7]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We get the following result:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到了以下结果：
- en: '![Figure 6.16 – Plots for the realinv variable before and after first-order
    differencing](img/B18945_06_016.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图6.16 – 实inv变量在一阶差分前后的绘图](img/B18945_06_016.jpg)'
- en: Figure 6.16 – Plots for the *realinv* variable before and after first-order
    differencing
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.16 – 实inv变量在一阶差分前后的绘图
- en: 'This gives us data that we may more suitably model using regression. However,
    when using differencing as a method to resolve serial correlation in a least squares
    regression model, we must also differentiate the input variable. Observe the input
    variable, `realinv`, before and after transformation. Here in *Figure 6**.17*,
    we can see similar behavior as with `realdpi`:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 这为我们提供了可能更适合使用回归模型建模的数据。然而，当使用差分作为解决最小二乘回归模型中序列相关性的方法时，我们还必须对输入变量进行微分。观察输入变量`realinv`在变换前后的情况。在这里的*图6.17*中，我们可以看到与`realdpi`相似的行为：
- en: '![Figure 6.17 – Plots for the realdpi variable before and after first-order
    differencing](img/B18945_06_017.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![图6.17 – *realdpi*变量在一阶差分前后的绘图](img/B18945_06_017.jpg)'
- en: Figure 6.17 – Plots for the *realdpi* variable before and after first-order
    differencing
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.17 – *realdpi*变量在一阶差分前后的绘图
- en: 'We can now build a new regression model using the differenced data. It is important
    to note first-order differencing removed one data point from the dataset so one
    value must also be removed from the constant in the design matrix:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以使用差分数据构建一个新的回归模型。首先需要注意的是，一阶差分从数据集中移除了一个数据点，因此设计矩阵中的常数项也必须移除一个值：
- en: '[PRE8]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The output of this model is notably different. We now see an r-squared value
    of `0.045`. Looking at the differenced data, we can see there is a different variance
    in the differenced data for disposable income than there is for investment. This
    means that although the `realinv` variable is useful for predicting `realdpi`
    as it appears significant, there is a lot more influencing real disposable gross
    personal income. We observe that the new Durbin-Watson test statistic is now `2.487`.
    Using the critical values from the table lookup earlier, `[1.758, 1.779]`, we
    see the Durbin-Watson statistic is now above the upper limit. `[2.221, 2.242]`.
    Because the new statistic, `2.487`, is greater than `2.221`, we can confirm there
    is now negative autocorrelation in the model’s residuals. We can see based on
    the PACF plot, as well as the proximity to the critical value range, the autocorrelation
    is much less significant than before, but still present. It could be argued the
    autocorrelation of the residuals is now small enough to be considered resolved,
    however; as noted earlier, a Durbin-Watson statistic less than 2.5 can be considered
    normal. Nonetheless, least-squares regression remains risky compared to time-series
    modeling to generate our predictions. We begin an in-depth overview of this topic
    in [*Chapter 10*](B18945_10.xhtml#_idTextAnchor160)*, Introduction to* *Time Series*.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型的输出明显不同。我们现在看到一个r-squared值为`0.045`。观察差分数据，我们可以看到可支配收入和投资之间的差分数据有不同的方差。这意味着尽管`realinv`变量在预测`realdpi`时似乎很重要，但还有更多因素影响着实际可支配的毛个人收入。我们观察到新的Durbin-Watson统计量现在是`2.487`。使用之前表中查找的临界值`[1.758,
    1.779]`，我们看到Durbin-Watson统计量现在高于上限`[2.221, 2.242]`。因为新的统计量`2.487`大于`2.221`，我们可以确认现在模型残差中存在负自相关。根据PACF图以及与临界值范围的接近程度，我们可以看到自相关比之前显著减少，但仍然存在。然而，可以争辩说残差的自相关现在足够小，可以被认为是解决了；如前所述，Durbin-Watson统计量小于2.5可以被认为是正常的。尽管如此，与时间序列建模相比，最小二乘回归在生成预测时仍然存在风险。我们将在[*第10章*](B18945_10.xhtml#_idTextAnchor160)“*时间序列*简介”中开始对这个主题进行深入概述。
- en: Let us assume, however, that for the sake of moving through the steps of regression
    model validation, we have no autocorrelation in our data. The next step will be
    to test our model.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，为了通过回归模型验证的步骤，我们假设数据中没有自相关。下一步将是测试我们的模型。
- en: Model validation
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型验证
- en: Assuming an analyst has developed a model that produces strong results and appears
    useful based on the previously mentioned plots, the next step is to test the model.
    One conventional approach is to perform a train-and-test split on the data used
    for the original model where we fit all data. In the following code, we run a
    split with the train dataset having 75% of the data and the test dataset having
    25%. The purpose is to assess whether there is a significant difference in performance
    between the two, as well as compared to the original model. The process follows
    the same steps as earlier. Acceptable differences are up to the analyst to decide,
    but in addition to assessing the differences between the metrics already discussed,
    the analyst should also note the coefficients for the slope and input variable,
    as these will be used to predict the target.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 假设分析师已经开发了一个产生强大结果且根据之前提到的图表看起来有用的模型，下一步是测试该模型。一种传统的方法是在用于原始模型的全部数据上执行训练和测试分割，其中我们拟合所有数据。在下面的代码中，我们进行了一个分割，其中训练数据集包含75%的数据，测试数据集包含25%。目的是评估这两个数据集之间以及与原始模型之间性能是否存在显著差异。可接受的差异由分析师决定，但除了评估已讨论的指标之间的差异外，分析师还应注意斜率和输入变量的系数，因为这些将用于预测目标。
- en: 'Here, we split the data. We use the `shuffle` argument to *randomly* shuffle
    the data so that if there is some order to the data, such as it being ordered
    by time, the data will be split randomly:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们分割数据。我们使用`shuffle`参数来**随机**打乱数据，以便如果数据存在某种顺序，例如按时间排序，数据将被随机分割：
- en: '[PRE9]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Now, we build a model using the training data:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们使用训练数据构建一个模型：
- en: '[PRE10]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Finally, we build a model using the testing data:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们使用测试数据构建一个模型：
- en: '[PRE11]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The idea here is that the two models should produce similar results on two different
    partitions of the data.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的想法是，两个模型应该在数据的两个不同部分上产生相似的结果。
- en: 'Another method for validating the model is to compare a metric against a naïve
    model. Let us use the **mean absolute error** (**MAE**). With this model metric,
    we could compare a naïve linear model’s errors where the error is each data point
    minus the average to the model’s predictions. A useful model MAE would need to
    be lower than the naïve model’s MAE. Here, we use the fit model to predict the
    inputs, then compare the model’s predictions to the naïve model’s predictions:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 验证模型的另一种方法是将其与朴素模型进行比较。让我们使用**平均绝对误差**（**MAE**）。使用这个模型指标，我们可以比较朴素线性模型的误差，其中误差是每个数据点减去平均值与模型的预测值。有用的模型MAE需要低于朴素模型的MAE。在这里，我们使用拟合模型来预测输入值，然后比较模型的预测值与朴素模型的预测值：
- en: 'Below we can observe the MAE from the *trained* model:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 下面我们可以观察到**训练**模型的MAE：
- en: '[PRE12]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Here we can see the MAE from the *naïve* model, which makes no assumptions
    other than that the mean will continue to hold the true values:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到**朴素**模型的MAE，该模型除了假设均值将继续保持真实值外，不做任何假设：
- en: '[PRE13]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: We can see the model compares favorably against the naïve model.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到模型与朴素模型相比表现良好。
- en: 'Another method that is popular to use is testing on a holdout dataset. For
    this, a model is constructed and trained on the training data. Then, using that
    model, we apply it to the test data. We would then compare the metric to that
    of the training data. Using the training model’s MAE of 438, we compare it to
    the following:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种流行的测试方法是使用保留数据集进行测试。为此，在训练数据上构建并训练一个模型。然后，使用该模型，将其应用于测试数据。然后，我们将比较指标与训练数据的指标。使用训练模型的MAE为438，我们将其与以下进行比较：
- en: '[PRE14]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'We can see that the error is lower for the test data than for the train data.
    However, since the train and test data are assumed to have different values and
    thus means, we should reassess that the naïve model still produces a higher MAE
    for the test data:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到测试数据的误差低于训练数据的误差。然而，由于假设训练数据和测试数据具有不同的值和均值，我们应该重新评估朴素模型对于测试数据仍然产生较高的MAE：
- en: '[PRE15]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Here we can see the model does provide better MAE than the naïve model at approximately
    the same rate on the test data as on the train data. Therefore, we expect that
    the linear regression model is better than the naïve model.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到模型在测试数据和训练数据上提供了与朴素模型大致相同的MAE，因此我们预计线性回归模型比朴素模型更好。
- en: Summary
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'In this chapter, we discussed an overview of simple linear regression between
    one explanatory variable and one response variable. The topics we covered include
    the following:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了单变量解释变量和单变量响应变量之间简单线性回归的概述。我们涵盖的主题包括以下内容：
- en: The OLS method for simple linear regression
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 简单线性回归的OLS方法
- en: Coefficients of correlation and determination and their calculations and significance
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关系数和确定系数及其计算和意义
- en: The assumptions required for least squares regression
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最小二乘回归所需的前提假设
- en: Methods of analysis for model and parameter significance
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型和参数显著性的分析方法
- en: Model validation
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型验证
- en: We looked closely at the concept of the square of error and how the sum of squared
    errors is meaningful for building and validating linear regression models. Then,
    we walked through the four pertinent assumptions required to make linear regression
    a stable solution. After, we provided an overview of four diagnostic plots and
    their interpretations with respect to assessing the presence of various issues
    related to heteroscedasticity, linearity, outliers, and serial correlation. We
    then walked through an example of using the ACF and PACF to assess serial correlation
    and an example of using first-order differencing to remove serial correlation
    constraints from data and build an OLS model using the differenced data. Finally,
    we provided methods for testing and validating least square regression models.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仔细研究了误差平方的概念以及误差平方和对于构建和验证线性回归模型的意义。然后，我们探讨了使线性回归成为一个稳定解所需的四个相关假设。之后，我们概述了四个诊断图及其在评估与异方差性、线性、异常值和序列相关性相关的问题时的解释。然后，我们通过一个使用ACF和PACF评估序列相关性的例子，以及一个使用一阶差分从数据中移除序列相关性约束并使用差分数据构建OLS模型的例子。最后，我们提供了测试和验证最小二乘回归模型的方法。
- en: In the next chapter, we will extend this concept to include more than one explanatory
    variable, a technique called multiple linear regression. We will also discuss
    various topics related to multiple linear regression, such as variable selection
    and regularization.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将扩展这一概念，包括一个以上的解释变量，这种技术称为多元线性回归。我们还将讨论与多元线性回归相关的各种主题，例如变量选择和正则化。
