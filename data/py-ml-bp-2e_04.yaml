- en: Forecast the IPO Market Using Logistic Regression
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用逻辑回归预测IPO市场
- en: 'In the late 1990s, getting in on the right **Initial Public Offering** (**IPO**)
    was like winning the lottery. First-day returns for some technology companies
    were many times their initial offering price, and if you were lucky enough to
    get in on an allocation, you were in for a windfall. Here are a few of the top
    first-day performers from the period:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在1990年代末，参与正确的**首次公开募股**（**IPO**）就像中了大奖一样。某些科技公司在第一天的回报是其初始发行价格的数倍，如果你足够幸运地获得配售，你就能大赚一笔。以下是这一时期几个首日表现最突出的例子：
- en: VA Linux up 697%, 12/09/99
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VA Linux上涨697%，1999年12月9日
- en: Globe.com up 606%, 11/13/98
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Globe.com上涨606%，1998年11月13日
- en: Foundry Networks up 525%, 9/28/99
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Foundry Networks上涨525%，1999年9月28日
- en: 'While the days of dotcom mania are far behind us, IPOs can still have outsized
    first-day returns. Here are just a few that rose substantially on their first
    day of trading in the past year:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然互联网泡沫的时代已经远去，但IPO仍然可能在首日产生巨大的回报。以下是过去一年内一些在首个交易日上涨显著的例子：
- en: Bloom Energy up 67%
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bloom Energy上涨67%
- en: Pinduoduo up 32%
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拼多多上涨32%
- en: Tenable up 32%
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tenable上涨32%
- en: As you can see, this is still a market worth paying attention to. In this chapter,
    we'll take a closer look at the IPO market. We'll see how we can use machine learning
    to help us decide which IPOs are worth a closer look and which ones we may want
    to take a pass on.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所看到的，这仍然是一个值得关注的市场。在本章中，我们将更深入地了解IPO市场。我们将看看如何利用机器学习帮助我们决定哪些IPO值得关注，哪些我们可能要放弃。
- en: 'Here''s what we''ll cover in this chapter:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容概览：
- en: The IPO market
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPO市场
- en: Data cleansing and feature engineering
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据清洗与特征工程
- en: Binary classification with logistic regression
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用逻辑回归进行二元分类
- en: Model evaluation
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型评估
- en: Feature importance
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征重要性
- en: The IPO market
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IPO市场
- en: Before we jump in and begin modeling, let's first discuss what an IPO, or initial
    public offering, is, and what research tells us about this market. After that,
    we'll discuss a number of strategies that we can apply.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始建模之前，先来讨论一下什么是IPO（首次公开募股），以及研究告诉我们关于这个市场的信息。之后，我们将讨论可以应用的多种策略。
- en: What is an IPO?
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是IPO？
- en: An IPO is the process whereby a private company becomes a public company. Public
    offerings raise capital for the company and give the general public an opportunity
    to invest in the company by buying its shares.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: IPO（首次公开募股）是一个私人公司变成上市公司的过程。公开募股为公司筹集资本，并为公众提供通过购买公司股票来投资该公司的机会。
- en: Though there are variations in how this occurs, in a typical offering, a company
    enlists the help of one or more investment banks to underwrite their offering.
    This means that the banks make a guarantee to the company that they will purchase
    all of the shares being offered at the IPO price on the day of the IPO. The underwriters,
    of course, do not intend to keep all of the shares themselves. With the help of
    the offering company, they go on what's called a **roadshow** to drum up interest
    from institutional clients. These clients put in a **subscription** for the shares,
    which indicates their interest in buying shares on the day of the IPO. This is
    a non-binding contract, as the price of the offering is not finalized until the
    day of the IPO. The underwriter will then set the offer price, given the level
    of interest expressed.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这一过程有所不同，但在典型的发行中，公司会寻求一个或多个投资银行的帮助来承销其发行。这意味着银行向公司保证，他们将在IPO当天按发行价购买所有的股票。当然，承销商并不打算自己持有所有的股票。在发行公司的帮助下，他们会进行所谓的**路演**，以引起机构客户的兴趣。这些客户会对股票进行**认购**，表示他们有兴趣在IPO当天购买股票。这是一份非约束性合同，因为发行价格直到IPO当天才会最终确定。然后，承销商会根据表达出的兴趣来设定发行价格。
- en: What is interesting from our perspective is that research has consistently shown
    a systematic underpricing of IPOs. There are a number of theories as to why this
    happens, and why this level of underpricing seems to vary over time, but studies
    have shown that billions of dollars are left on the table every year.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们的角度来看，值得注意的是，研究表明IPO常常出现系统性的定价过低现象。有许多理论解释为什么会发生这种情况，以及为什么这种定价过低的程度随时间变化，但研究表明，每年都会有数十亿美元未被充分利用。
- en: In an IPO, **money left on the table**, is the difference between the offering
    price of shares and the first day's closing price.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在IPO中，**未被利用的资金**是指股票的发行价格与首日收盘价之间的差额。
- en: One other point that should be mentioned before we move on is the difference
    between the offering price and the opening price. While you can occasionally get
    in on the deal through your broker and receive the IPO at its offering price,
    in nearly all instances, you, as a member of the general public, will have to
    purchase the IPO at the (typically higher) opening price. We'll build our models
    under this assumption.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一点需要在继续之前说明，那就是发行价与开盘价的区别。虽然你偶尔可以通过你的经纪人以发行价参与IPO，但在几乎所有情况下，作为普通公众，你必须以（通常较高的）开盘价购买IPO。我们将在这个假设下构建我们的模型。
- en: Recent IPO market performance
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最近IPO市场表现
- en: Let's now take a look at the performance of the IPO market. We are going to
    pull down data from `IPOScoop.com`, which is a service that provides ratings for
    upcoming IPOs. Go to [https://www.iposcoop.com/scoop-track-record-from-2000-to-present/](https://www.iposcoop.com/scoop-track-record-from-2000-to-present/)
    and click on the button at the bottom of the page to download the spreadsheet.
    We'll load this into pandas and run a number of visualizations using our Jupyter
    notebook.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来看一下IPO市场的表现。我们将从`IPOScoop.com`获取数据，这是一个提供即将上市IPO评级的服务。请访问[https://www.iposcoop.com/scoop-track-record-from-2000-to-present/](https://www.iposcoop.com/scoop-track-record-from-2000-to-present/)，点击页面底部的按钮下载电子表格。我们将把这个文件加载到pandas中，并使用Jupyter笔记本进行一些可视化分析。
- en: 'Unfortunately, the data is in a format that makes it impossible to just read
    into pandas with the normal `.read_csv()` method. What we''ll need to do is use
    a library that lets us read Excel files into Python lists and then perform some
    preprocessing to filter out those rows that aren''t of interest, primarily, header
    rows, and some extraneous information. Follow the steps to set up notebook:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，数据的格式使得我们无法通过常规的`.read_csv()`方法直接加载到pandas中。我们需要使用一个库，允许我们将Excel文件读取为Python列表，然后执行一些预处理，过滤掉那些不相关的行，主要是表头行以及一些额外的信息。请按照以下步骤设置笔记本：
- en: 'Let''s now begin in our notebook by setting up the libraries we''ll need:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们在笔记本中开始，设置我们需要的库：
- en: '[PRE0]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The `xlrd` library is what we'll be using to work with the Excel spreadsheet
    we downloaded earlier. If you don't have it installed already, it can be added
    to your Python distribution at the command line with `pip install xlrd`.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '`xlrd`库是我们将用来处理之前下载的Excel电子表格的库。如果你还没有安装它，可以通过命令行使用`pip install xlrd`将其添加到你的Python环境中。'
- en: 'The next step is to load the workbook, as seen in the following block of code:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是加载工作簿，如下代码块所示：
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now that we have loaded the entire Excel workbook, let''s target the sheet
    we''ll be working with, in this instance, the first one:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们已经加载了整个Excel工作簿，让我们定位到我们要处理的工作表，在这个例子中是第一个工作表：
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Let''s now check that we have the data we are expecting:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们检查一下是否获取了预期的数据：
- en: '[PRE3]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The preceding line of code generates the following output:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上面的代码行会生成以下输出：
- en: '![](img/3dda75ad-b2a1-4060-ac9f-fafd553a3531.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3dda75ad-b2a1-4060-ac9f-fafd553a3531.png)'
- en: 'That number looks about right from comparing it against the spreadsheet, so
    let''s now move on to incorporating the data row by row:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 与电子表格对比后，这个数字看起来差不多，所以我们现在开始逐行地合并数据：
- en: '[PRE4]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The preceding code generates the following output:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码会生成以下输出：
- en: '![](img/48a7dd95-c7a0-439f-8fa4-9ac061ccd8dd.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/48a7dd95-c7a0-439f-8fa4-9ac061ccd8dd.png)'
- en: Let's talk about what happened in that code block. First, we create an empty
    list to which we will add the rows. Then, we loop over each row in the spreadsheet,
    checking whether the first value (the left most cell) is a float. If it is, then
    we add all the cells' values to our list. This works because the `Date` column,
    when read in, appears as a float, and we are only interested in those rows in
    the sheet that start with a date. Note that we also start our loop on line 36
    to skip over the summary data in the sheet.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来解释一下那段代码发生了什么。首先，我们创建了一个空列表，然后将每一行添加到列表中。接着，我们遍历电子表格中的每一行，检查第一列（最左边的单元格）是否为浮动值。如果是的话，我们将该行所有单元格的值添加到我们的列表中。这是因为`Date`列在读取时会作为浮动值出现，而我们只关心那些以日期为开头的行。请注意，我们还从第36行开始循环，以跳过表格中的摘要数据。
- en: 'Let''s now again check that the number of rows we expect are in our list:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们再检查一下我们期望的行数是否在列表中：
- en: '[PRE5]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The preceding code generates the following output:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码会生成以下输出：
- en: '![](img/e32104a5-8946-4314-a073-970f3b20cf9c.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e32104a5-8946-4314-a073-970f3b20cf9c.png)'
- en: After eliminating the header and other rows we aren't interested in, this looks
    about right.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在去除标题和其他不感兴趣的行后，这样看起来差不多正确。
- en: Working on the DataFrame
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理数据框
- en: 'Let''s now move on to getting our DataFrame ready to work with:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们开始准备数据框（DataFrame）以供使用：
- en: '[PRE6]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The preceding code generates the following output:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/3bfc736d-8024-4705-a0d1-c49641e15a64.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3bfc736d-8024-4705-a0d1-c49641e15a64.png)'
- en: 'The data looks good, so let''s now add our columns:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 数据看起来不错，现在让我们添加我们的列：
- en: '[PRE7]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The preceding code generates the following output:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/0284d547-a23d-4365-839d-3b6d69003869.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0284d547-a23d-4365-839d-3b6d69003869.png)'
- en: 'Let''s now convert that `Date` column from a float to a proper date. The `xlrd`
    library has some functionality that can help us with that. We''ll use it in a
    function to get our dates in the proper format:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们把那个`Date`列从浮动数值转换为正确的日期格式。`xlrd`库有一些功能可以帮助我们做到这一点。我们将在一个函数中使用它，确保日期格式正确：
- en: '[PRE8]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The preceding code generates the following output:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/7f0fc1b4-4790-439d-8069-25b0ed825600.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7f0fc1b4-4790-439d-8069-25b0ed825600.png)'
- en: 'Now that we have dates that we can work with, let''s add some additional date-related
    columns that can help us work with the data better:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了可以使用的日期数据，让我们添加一些额外的日期相关列，以帮助我们更好地处理数据：
- en: '[PRE9]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The preceding code generates the following output:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/6bbdc76b-d8ad-4758-8f33-eabf61700a67.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6bbdc76b-d8ad-4758-8f33-eabf61700a67.png)'
- en: 'Now that we''ve completed those steps, let''s check our data in the DataFrame
    against the data in the original spreadsheet:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们完成了这些步骤，让我们将数据框中的数据与原始电子表格中的数据进行对比：
- en: '[PRE10]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The preceding code generates the following output:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/c309883c-42d1-4bad-8c0b-8a50b891b555.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c309883c-42d1-4bad-8c0b-8a50b891b555.png)'
- en: Comparing this to the same values in the spreadsheet shows us that we have nearly
    identical values, so we should be good to continue.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 将此与电子表格中的相同数值进行比较，结果显示我们有几乎相同的数值，所以可以继续进行。
- en: 'We''ll take one additional step here to eliminate what are sometimes referred
    to as *penny stocks*, or particularly low-priced stocks. Then, we''ll check the
    data types to ensure they look appropriate:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将采取一个额外的步骤，排除有时被称为*便士股票*，或者是特别低价的股票。然后，我们将检查数据类型，以确保它们看起来合适：
- en: '[PRE11]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The preceding code generates the following output:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/370f1607-7f12-4a06-8d8c-7a7d759cad45.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](img/370f1607-7f12-4a06-8d8c-7a7d759cad45.png)'
- en: 'This looks to be in line with what we expect, with the exception of the `1st
    Day % Chg` column. We''ll correct that now by changing the data type to a float:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这看起来与我们的预期相符，除了`1st Day % Chg`这一列。我们将通过将数据类型更改为浮动数值来纠正这一点：
- en: '[PRE12]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The preceding code generates the following output:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/65e42628-6df9-4efc-b3b3-de5e128c6278.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/65e42628-6df9-4efc-b3b3-de5e128c6278.png)'
- en: Analyzing the data
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据分析
- en: 'The data types all look good now, so we''ll begin our exploratory analysis
    by graphing the number of IPOs since 2000:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 数据类型现在看起来都没问题了，因此我们将通过绘制自2000年以来IPO的数量来开始我们的探索性分析：
- en: '[PRE13]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The preceding code generates the following output:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/05867657-fc25-4603-a6d9-75ee6f6c1d4e.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/05867657-fc25-4603-a6d9-75ee6f6c1d4e.png)'
- en: From the chart, we can see that most years have over 100 IPOs, but that in the
    years after and including 2001 and 2008, there was a notable reduction, mostly
    likely due to the aftermath of 9/11 and the financial crisis.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 从图表中我们可以看到，大多数年份的IPO数量超过100个，但在2001年及2008年之后，数量明显减少，这很可能是由于9/11事件和金融危机的后果。
- en: Summarizing the performance of the stocks
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结股票表现
- en: 'We''ll get a quick summary of the performance of the stocks over the past 18
    years by executing the following code:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过执行以下代码来快速总结过去18年股票的表现：
- en: '[PRE14]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The preceding code generates the following output:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/4a07bde7-f25a-4c6e-8694-c1ad1b8a207d.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4a07bde7-f25a-4c6e-8694-c1ad1b8a207d.png)'
- en: From the table, we can see the extraordinary average return of the IPO market
    in 2000\. At over 35%, it is more than double any other year on the list. Also
    notable is the fact that every year has had a positive average return for first-day
    performance.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 从表格中，我们可以看到2000年IPO市场的异常平均回报率。超过35%的回报率是列表中任何其他年份的两倍多。另一个显著的事实是，每一年的首次交易表现平均回报率都是正数。
- en: 'Let''s plot first-day performance to get a better feel for it:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们绘制首次交易表现，以便更好地了解它：
- en: '[PRE15]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The preceding code generates the following output:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/8aa3123a-73f8-4315-a7c7-902a9b17dd2e.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8aa3123a-73f8-4315-a7c7-902a9b17dd2e.png)'
- en: The important point about these numbers is that they are not the first-day performance
    that the general investing public could expect to receive on that first-day. Only
    investors who got in on the offering could expect to see these numbers.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 关于这些数字的重要一点是，它们不是普通投资者在第一天能够期望获得的回报。只有那些参与了发行的投资者才能期望看到这些数字。
- en: 'The first-day return that the general public could expect to receive would
    be the difference between the opening price and the closing price. This is entirely
    different, and much less lucrative. Let''s now add a column of data to reflect
    that value and see the results:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 普通投资者在第一天能够期望获得的回报将是开盘价与收盘价之间的差额。这完全不同，也远没有那么有利可图。现在让我们添加一列数据，反映这一值，并看看结果：
- en: '[PRE16]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The preceding code generates the following output:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/a89b4db2-aff1-4b2f-958a-a6394553c6f5.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a89b4db2-aff1-4b2f-958a-a6394553c6f5.png)'
- en: 'This shows returns that are markedly less exciting. Let''s now plot them as
    before:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这显示出的回报明显不如预期那么令人激动。现在让我们像之前一样绘制这些数据：
- en: '[PRE17]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The preceding code generates the following output:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/327d4037-ffc3-4ce8-a799-3cf7b6010f6d.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/327d4037-ffc3-4ce8-a799-3cf7b6010f6d.png)'
- en: Comparing the preceding chart to the earlier one, it is clear that annual average
    returns on the first day are displayed in the range of their order of magnitude
    which is lower in many cases.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 比较前面的图表和早期的图表，可以明显看到，第一天的年平均回报显示在其数量级范围内，而在许多情况下要低得多。
- en: Baseline IPO strategy
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基准IPO策略
- en: Let's now suppose that we bought one share of every IPO at the exact opening
    tick and sold them at the precise closing price listed in these figures; what
    would our returns look like in terms of dollars earned?
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们以每个IPO的精确开盘价购买一股，并以这些数字中精确的收盘价卖出；那么我们的回报在赚取的美元上会是什么样子呢？
- en: 'To answer this question, let''s look at the actual dollar price change from
    open to close:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答这个问题，让我们看看实际的开盘到收盘的美元价格变化：
- en: '[PRE18]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The preceding code generates the following output:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/5b34983d-50e4-4e45-905e-4f60e13f57ce.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5b34983d-50e4-4e45-905e-4f60e13f57ce.png)'
- en: 'From this, we see the first day open-to-close dollar total is just above $28\.
    That number is for over 173 IPOs so far in 2018:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 从中我们可以看到，第一天从开盘到收盘的总金额刚好超过28美元。这个数字是基于2018年迄今为止的173多只IPO：
- en: '[PRE19]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The preceding code generates the following output:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/a2d76b57-b913-4569-9139-4a971495708b.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a2d76b57-b913-4569-9139-4a971495708b.png)'
- en: That reflects a mean first-day gain of just over 16 cents per IPO. And remember,
    this is under ideal conditions where we ignore transaction costs and slippage.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 这反映了每个首次公开募股（IPO）第一天的平均收益略高于16美分。请记住，这是在忽略交易成本和滑点的理想条件下计算的。
- en: Slippage is the difference between your attempted entry or exit price for a
    target stock and the price at which your order is actually fulfilled.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 滑点是你试图进场或出场的目标股票价格与实际成交价格之间的差额。
- en: 'Let''s now take a look at what the distribution of returns for these IPOs look
    like. This may help us understand how to improve our returns over the baseline
    Naïve Bayes strategy of just buying every IPO:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看这些IPO的回报分布是什么样的。这可能有助于我们理解如何提高相对于简单买入每个IPO的基准朴素贝叶斯策略的回报：
- en: '[PRE20]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The preceding code generates the following output:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/06922374-0015-4d9f-9f14-9a8b766491d7.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![](img/06922374-0015-4d9f-9f14-9a8b766491d7.png)'
- en: We see that returns are centered around zero, but there is a long tail to the
    right where there are some exceptional returns. It would be quite financially
    rewarding if we were able to identify some of the commonalities that these exceptional
    IPOs have that we could capitalize on.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到回报围绕零分布，但右侧有一个长尾，那里有一些异常的回报。如果我们能够识别出这些异常IPO的共同特点并加以利用，那将是非常有利可图的。
- en: Let's see whether we can use machine learning to help improve our results from
    a Naïve Bayes approach. A reasonable strategy would seem to be targeting that
    long tail on the right, so we'll focus on feature engineering in the next section.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看是否可以利用机器学习来帮助改善来自朴素贝叶斯方法的结果。一个合理的策略似乎是针对右侧的长尾，所以我们将在下一节专注于特征工程。
- en: Data cleansing and feature engineering
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据清洗和特征工程
- en: What might impact the performance of an offering as it begins trading? Perhaps
    the performance of the market in general or the prestige of the underwriters could
    impact it? Perhaps the day of the week or the month that it trades is important?
    The consideration and inclusion of these factors in a model is called **feature
    engineering**, and modeling this is nearly as important as the data that you use
    to build the model. If your features aren't informative, your model simply won't
    have value.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 什么因素可能影响一只股票在交易开始时的表现？也许整体市场的表现或者承销商的声望会有影响？也许交易的星期几或月份很重要？在模型中考虑并加入这些因素的过程被称为**特征工程**，对其建模几乎和使用的数据一样重要。如果你的特征不具备信息量，那么你的模型就不会有价值。
- en: Let's begin this process by adding a few features that we expect may influence
    the performance of an IPO.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过添加一些我们认为可能影响IPO表现的特征来开始这个过程。
- en: Adding features to influence the performance of an IPO
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加特征以影响首次公开募股（IPO）的表现
- en: 'One measure of demand that could be informative is the **opening gap**. This
    is the difference between the offer price and the opening price of the issue.
    Let''s add that to our DataFrame:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 可能有用的需求度量之一是**开盘缺口**。这是发行价和开盘价之间的差异。让我们把它添加到我们的DataFrame中：
- en: '[PRE21]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Next, let''s get a count of the number of underwriters on the offering. Perhaps
    having more banks involved leads to better marketing of the issue? This is demonstrated
    in the following code block:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们统计一下承销商的数量。也许更多的银行参与能够更好地推广此次发行？这在以下代码块中得到了演示：
- en: '[PRE22]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Let''s quickly see whether there might be anything to this hypothesis by means
    of a visualization:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速通过可视化来查看这个假设是否可能成立：
- en: '[PRE23]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The preceding code generates the following output:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/e3847001-bd88-42f6-ae8c-37227a67f80e.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e3847001-bd88-42f6-ae8c-37227a67f80e.png)'
- en: It's not apparent what the relationship might be from this chart, but clearly
    nine bankers is the sweet spot!
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个图表上并不明显能看出什么关系，但显然九位银行家是最佳的选择！
- en: 'Next, let''s move on to extracting the first underwriter in the list. This
    would be the lead, and perhaps the prestige of this bank is important to the first-day
    gains:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们继续提取列表中的第一个承销商。这将是主承销商，也许该银行的声望对首日收益至关重要：
- en: '[PRE24]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Next, let''s take a quick peek at the data in the new column that we have created:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们快速查看一下我们新创建的列中的数据：
- en: '[PRE25]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The preceding code generates the following output:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/e94235ea-9f21-4a44-a527-a30e63bfeb41.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e94235ea-9f21-4a44-a527-a30e63bfeb41.png)'
- en: Even a cursory examination of the preceding shows us that we have some genuine
    issues with the data. Many names are replicated with different spellings and punctuation.
    We could, at this point, stop and attempt to clean up the data, and this would
    be the proper course of action if we were going to rely on our model for anything
    serious, but as this is just a toy project, we'll forge ahead and hope that the
    impact is minimal.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 即使是粗略检查前面的内容，我们也可以发现数据中存在一些实际问题。很多名字存在不同的拼写和标点形式。在这一点上，我们可以停止并尝试清理数据，如果我们计划依赖我们的模型进行一些重要操作，这将是正确的做法，但因为这只是一个玩具项目，我们将继续进行，希望影响尽可能小。
- en: Binary classification with logistic regression
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用逻辑回归进行二元分类
- en: Instead of attempting to predict what the total first-day return will be, we
    are going to attempt to predict whether the IPO will be one we should buy for
    a trade or not. It is here that we should point out that this is not investment
    advice and is for illustrative purposes only. Please don't run out and start day
    trading IPOs with this model willy-nilly. It will end badly.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不打算预测总的首日回报率，而是尝试预测是否应该购买这只IPO进行交易。此时我们要指出，这不是投资建议，仅用于演示目的。请不要随便拿这个模型去进行IPO日内交易，这样做的结果会很糟糕。
- en: Now, to predict a binary outcome (that's a `1` or `0`/yes or no), we will start
    with a model called **logistic regression**. Logistic regression is actually a
    binary classification model rather than regression. But it does utilize the typical
    form of a linear regression; it just does so within a logistic function.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，要预测二元结果（即`1`或`0`，也就是“是”或“否”），我们将从一个叫做**逻辑回归**的模型开始。逻辑回归实际上是一个二元分类模型，而不是回归模型。但它确实使用了典型的线性回归形式，只不过是在逻辑函数中进行。
- en: 'A typical single variable regression model takes the following form:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 一个典型的单变量回归模型具有以下形式：
- en: '![](img/d94c1fc8-a2fd-4207-b16e-74cb93920de1.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d94c1fc8-a2fd-4207-b16e-74cb93920de1.png)'
- en: Here, *t* is a linear function of a single explanatory variable, *x*. This can,
    of course, be expanded to be a linear combination of many variables. The problem
    with this form for a binary outcome variable is that *t* does not naturally fall
    between 1 and 0.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*t*是单一解释变量*x*的线性函数。当然，这可以扩展为多个变量的线性组合。对于一个二元结果变量，这种形式的问题是*t*自然不会落在1和0之间。
- en: 'The logistic function seen in the following equation has some quite favorable
    mathematical properties, including the fact that it can take any number as an
    input (*t* here) and return a result that falls between 0 and 1:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 下列方程中的逻辑函数具有一些非常有利的数学性质，包括它能够接受任何数值作为输入（此处为*t*）并返回一个介于0和1之间的结果：
- en: '![](img/1de20958-589d-49e8-8675-5e536390b8ff.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1de20958-589d-49e8-8675-5e536390b8ff.png)'
- en: 'The graph is represented as below:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 图表如下所示：
- en: '![](img/4c9c4dcc-4129-444c-99c2-b6be33706634.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4c9c4dcc-4129-444c-99c2-b6be33706634.png)'
- en: 'By replacing *t* with our regression function, we now have a model that is
    able to both give us information on the importance of each predictor (the beta
    coefficients) and provide a form that can be used to give us a binary prediction
    that represents the probability of *success*, or a *positive result*:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将*t*替换为我们的回归函数，现在我们有了一个能够提供每个预测变量的重要性（beta系数）并给出二元预测结果的模型，表示*成功*的概率，或者是*正向结果*：
- en: '![](img/51a0d4c3-1ecd-4071-bb70-e46a5d019cfc.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/51a0d4c3-1ecd-4071-bb70-e46a5d019cfc.png)'
- en: Before we can move on to modeling our data, we need to put it in a form that
    is appropriate for scikit-learn.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续对数据建模之前，需要将数据转换为适合scikit-learn格式的形式。
- en: 'We''ll start by importing a library that can help us with this task; it''s
    called `patsy`. It can be pip-installed if necessary:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过导入一个可以帮助我们完成此任务的库开始；它叫做`patsy`，如果需要，可以通过pip安装：
- en: '[PRE26]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Creating the target for our model
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建我们模型的目标
- en: 'Now, we''ll create the target for our model. This is the column that will tell
    our model whether each IPO should have been invested in or not. We are going to
    say that we should invest in any IPO that has a 2.5% or greater return on day
    one. Obviously, this is an arbitrary number, but it seems like a reasonable value
    for the investment to be worthy of our attention:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将为我们的模型创建目标。这是告诉我们模型每个IPO是否应该被投资的列。我们将假设任何在第一天回报率达到2.5%或更高的IPO都应该投资。显然，这是一个任意的数字，但它似乎是一个合理的值，足以让我们关注这个投资：
- en: '[PRE27]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Now that we have set our target column, we need to set up our predictor variables.
    We''ll again use `patsy` for this:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经设置了目标列，我们需要设置预测变量。我们将再次使用`patsy`来实现：
- en: '[PRE28]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Let''s discuss what''s going on in that line of code. `X` here is our design
    matrix, or the matrix that contains our predictor variables. We have included
    the things we discussed earlier that could have some impact on the performance:
    the size of the opening gap, the month and day of the IPO, the offering price,
    the lead manager, the number of managers, and finally, the star rating that `IPOScoop.com`
    provides in advance of the IPO''s listing.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们讨论一下那行代码的含义。`X`是我们的设计矩阵，或者说是包含我们预测变量的矩阵。我们已经包含了之前讨论过的可能会对性能产生影响的因素：开盘差距大小、IPO的月份和日期、发行价格、主承销商、承销商数量，以及最后，`IPOScoop.com`在IPO上市之前提供的星级评分。
- en: To give some explanation regarding the Qs and Cs found in the lines of code,
    the Qs are simply used to provide quotes in the formula for columns that have
    white space in their names, and the Cs are used to indicate that the referenced
    column should be treated as categorical features and dummy-coded.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明代码行中的Q和C的含义，Q仅用于为包含空格的列名提供引号，而C用于指示引用的列应作为分类特征并进行虚拟编码。
- en: Dummy coding
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 虚拟编码
- en: 'Dummy coding is a method where, if we had one column that had a student''s
    favorite class as a predictor variable in one column, we would turn each class
    into its own column and then place a `1` in that column if it was the favorite
    class of the student, as seen in the following diagram:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟编码是一种方法，如果我们有一列表示学生最喜欢的课程作为预测变量，我们会将每个课程转化为自己的列，并在该列中放置一个`1`，如果它是学生最喜欢的课程，如下图所示：
- en: '![](img/8b57015a-328b-48af-97e7-734144a3cf04.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8b57015a-328b-48af-97e7-734144a3cf04.png)'
- en: 'Source: http://www.statisticssolutions.com/dummy-coding-the-how-and-why/'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '来源: http://www.statisticssolutions.com/dummy-coding-the-how-and-why/'
- en: Once that is done, then the next step is to actually drop one of those columns.
    The dropped column then becomes the **base case**. All the other cases are then
    compared to that case. In our IPO example using months as predictors, we will
    drop January, for example, and then all the other months will be judged against
    January's performance. The same goes for the days of the week or any other categorical
    predictor. This dropping of a column is to prevent multicollinearity, which would
    have a negative impact on the explanatory power of the model.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦完成这一操作，接下来的步骤就是实际删除其中一列。被删除的列将成为**基准情况**。然后，所有其他情况将与该基准情况进行比较。在我们使用月份作为预测变量的IPO示例中，我们将删除一月作为例子，然后所有其他月份将与一月的表现进行比较。星期几或任何其他类别的预测变量也是如此。删除列的目的是防止多重共线性，因为多重共线性会对模型的解释能力产生负面影响。
- en: 'Let''s take a look at what this coding looks like by running the following
    in a Jupyter cell:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过在Jupyter单元格中运行以下代码来看看这个代码的实际效果：
- en: '[PRE29]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The preceding code generates the following output:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/2576a82c-f579-492b-afc4-9bd9705c0051.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2576a82c-f579-492b-afc4-9bd9705c0051.png)'
- en: 'Now that we have both our `X` and `*y*`, we are ready to fit our model. We
    are going use a very basic train/test split and simply train our model on all
    but the last 200 IPOs:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有了`X`和`*y*`，我们准备好拟合模型了。我们将使用一个非常简单的训练/测试划分，并仅在除了最后200只IPO的所有数据上训练我们的模型：
- en: '[PRE30]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: And, with that, we have our model. Let's examine the performance of this very
    simple model.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 至此，我们得到了我们的模型。让我们来评估这个非常简单的模型的表现。
- en: Examining the model performance
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估模型表现
- en: 'We''ll start by making predictions on our test data and then we''ll examine
    whether our predictions were correct:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先对我们的测试数据进行预测，然后检查我们的预测是否正确：
- en: '[PRE31]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'The preceding code generates the following output:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/5c6ec647-0a8f-4d55-984e-cd3266527bf4.png)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5c6ec647-0a8f-4d55-984e-cd3266527bf4.png)'
- en: 'Let''s now look at what percentage of the 200 IPOs in our `test` dataset we
    should have invested in—remember, that means they rose over 2.5% from the open
    to the close:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看我们应该投资的200只IPO中的百分比——记住，这意味着它们从开盘到收盘上涨了超过2.5%：
- en: '[PRE32]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'The preceding code generates the following output:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/512daffe-e875-446f-a0dc-81284e18eb29.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/512daffe-e875-446f-a0dc-81284e18eb29.png)'
- en: 'So, just north of half the IPOs rose over 2.5% from their opening tick to the
    closing tick. Let''s see how accurate our model''s calls were:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，超过一半的IPO从开盘到收盘上涨了超过2.5%。让我们看看我们的模型预测的准确性如何：
- en: '[PRE33]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The preceding code generates the following output:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/9138b386-ade9-4755-af1a-c2908790aed9.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9138b386-ade9-4755-af1a-c2908790aed9.png)'
- en: 'Well, it looks like our model was about as accurate as a coin flip. That doesn''t
    seem too promising. But with investing, what is important is not the accuracy
    but the expectancy. If we had a number of small losses, but a couple of huge wins,
    overall, the model could still be very profitable. Let''s examine whether that''s
    the case here. We''ll join our results data with the first-day change data to
    explore this:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来我们的模型的准确性差不多像抛硬币一样。这似乎不太有前景。但是在投资中，重要的不是准确性，而是预期收益。如果我们有一些小的亏损，但有几个巨大的胜利，总体上，模型仍然可能非常盈利。让我们看看这里是否也是这样。我们将把我们的结果数据与首日变化数据结合起来，以便深入探讨：
- en: '[PRE34]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The preceding code generates the following output:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/d010855b-3879-4bd6-8c26-094f84c74061.png)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d010855b-3879-4bd6-8c26-094f84c74061.png)'
- en: 'First, let''s see what our results would have looked like for one share of
    every one of the 200 IPOs in our test data:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们看看如果我们投资了每一只200只IPO中的一只股票，我们的结果会是什么样的：
- en: '[PRE35]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'The preceding code generates the following output:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/120d38b6-ac84-463f-94f6-e2543c3ec39f.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![](img/120d38b6-ac84-463f-94f6-e2543c3ec39f.png)'
- en: 'From this, we see that we would have gained over $215 in an ideal cost-free
    scenario. Now, let''s examine some of the other statistics concerning these IPOs:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 从这点来看，在理想的无成本情境下，我们将获得超过215美元的收益。现在，让我们来看看与这些IPO相关的其他一些统计数据：
- en: '[PRE36]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The preceding code generates the following output:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下输出：
- en: '![](img/1d9c6402-1bcf-4a5e-b16f-e9f769afd5b2.png)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1d9c6402-1bcf-4a5e-b16f-e9f769afd5b2.png)'
- en: 'Based on the preceding, we see that the average gain was just over $1, and
    the largest loss was 15 times that. How does our model fare against those numbers?
    First, we look at the trades our model said we should take and the resulting gains:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 根据上述内容，我们看到平均收益略超过1美元，而最大亏损是平均收益的15倍。我们的模型与这些数据相比如何？首先，我们看看模型建议我们进行的交易以及相应的收益：
- en: '[PRE37]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The preceding code generates the following output:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码生成了以下输出：
- en: '![](img/feddf7fe-8c00-4af2-8e50-b34aa1a4e4c2.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](img/feddf7fe-8c00-4af2-8e50-b34aa1a4e4c2.png)'
- en: 'Let''s look at the other statistics as well:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们也看看其他统计数据：
- en: '[PRE38]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The preceding code generates the following output:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码生成了以下输出：
- en: '![](img/0f1480c1-5494-4988-942a-70e7de78c7de.png)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0f1480c1-5494-4988-942a-70e7de78c7de.png)'
- en: Here, we see that our model suggested investing in only 34 IPOs, the mean gain
    rose to $1.50, the largest loss was reduced to under $10, and we still were able
    to capture the best performing IPO. It's not stellar, but we may be on to something.
    We'd need to explore further to really know whether we do have something worth
    expanding further.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们看到我们的模型建议只投资34个IPO，平均收益上升到1.50美元，最大损失减少到10美元以下，我们仍然能够捕捉到表现最好的IPO。这不是特别出色，但我们可能发现了一些值得关注的东西。我们需要进一步探索，才能真正知道是否有值得进一步扩展的内容。
- en: Now, let's move on to examine the factors that seem to influence our model's
    performance.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们继续检查那些似乎影响我们模型表现的因素。
- en: Generating the importance of a feature from our model
  id: totrans-211
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从我们的模型中生成特征的重要性
- en: One of the nice features of logistic regression is that it offers predictor
    coefficients that can tell us the relative importance of the predictor variables
    or features. For categorical features, a positive sign on a feature's coefficient
    tells us that, when present, this feature increases the probability of a positive
    outcome versus the baseline. For continuous features, a positive sign tells us
    that an increase in the value of a feature corresponds to an increase in the probability
    of a positive outcome. The size of the coefficient tells us the magnitude of the
    increase in probability.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归的一个优点是，它提供了预测系数，告诉我们预测变量或特征的相对重要性。对于分类特征，特征系数上的正号告诉我们，当该特征存在时，它增加了正面结果的概率，相对于基准。对于连续特征，正号告诉我们特征值的增加对应于正面结果概率的增加。系数的大小告诉我们概率增加的幅度。
- en: 'Let''s generate the importance of the feature from our model, and then we can
    examine the impact it has:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从我们的模型中生成特征的重要性，然后我们可以检查它的影响：
- en: '[PRE39]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The preceding code generates the following output:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码生成了以下输出：
- en: '![](img/0a7f800c-e6c7-4719-b911-69b28c47bb4c.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0a7f800c-e6c7-4719-b911-69b28c47bb4c.png)'
- en: 'In the preceding screenshot, we see those features with the largest coefficients.
    Let''s look at days of the week and their impact there:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的截图中，我们看到了那些具有最大系数的特征。让我们看看星期几及其影响：
- en: '[PRE40]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The preceding code generates the following output:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码生成了以下输出：
- en: '![](img/215fc453-b07c-458f-b65c-65c5472cb9d5.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![](img/215fc453-b07c-458f-b65c-65c5472cb9d5.png)'
- en: Here, the first day of the week would be Monday and would be coded as `T.0`,
    or the base case. All the other days of the week would be compared to Monday.
    From the preceding screenshot, we see that Thursday appears to be the best day
    of the week. Saturday appears to be a terrible day of the week to have an IPO,
    most likely because the market is closed that day. (In all likelihood, those dates
    are just incorrectly recorded.)
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，星期一是每周的第一天，并且被编码为`T.0`，即基准情况。所有其他星期几都会与星期一进行比较。从上面的截图中，我们看到星期四似乎是最好的交易日。星期六似乎是进行首次公开募股（IPO）的糟糕日子，很可能是因为那天市场关闭。（很可能，那些日期只是记录错误。）
- en: Looking further at the features with the highest coefficients, we can now appreciate
    that extracting useful information for the predictive value of each is difficult,
    since many of those features are for things that no longer exist. For example,
    while Deutsche Bank still exists, it no longer underwrites as Deutsche Banc Alex.
    Brown, so that is actually conveying historical information rather than information
    that can be useful going forward.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步观察具有最高系数的特征时，我们现在可以理解，对于每个特征提取有预测价值的有用信息是困难的，因为其中许多特征涉及已经不存在的事物。例如，虽然德意志银行仍然存在，但它不再以德意志银行亚历克斯·布朗的名义进行承销，所以它实际上是在传递历史信息，而不是对未来有用的信息。
- en: Another issue is that features do not reflect how frequently they had an impact.
    The appearance of a bank that was only in business in 2000 and had 3 hugely successful
    IPOs would have a very large positive coefficient, but would be meaningless in
    our modeling efforts.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个问题是，特征并没有反映它们产生影响的频率。一个只在2000年运营并且拥有3个非常成功IPO的银行，其出现会有一个非常大的正系数，但在我们的建模工作中是没有意义的。
- en: Random forest classifier method
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 随机森林分类器方法
- en: Another method of modeling that tells us which features have an impact on our
    model is the feature importance that comes out of a random forest classifier.
    This more accurately reflects the true impact of a given feature.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种建模方法是通过随机森林分类器得出的特征重要性，它告诉我们哪些特征对模型有影响。这种方法更准确地反映了某个特征的真实影响。
- en: 'Let''s run our data through this type of model and examine the results:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将数据输入这种类型的模型并检查结果：
- en: '[PRE41]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The preceding code generates the following output:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/b8c70794-d65c-417b-9ddf-c1bfdde03488.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8c70794-d65c-417b-9ddf-c1bfdde03488.png)'
- en: In the preceding code, we ran a random forest classifier, extracted and sorted
    the importance of the features, and then graphed those values with their error
    bars.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们运行了一个随机森林分类器，提取并排序了特征的重要性，然后将这些值与它们的误差条一起绘制了图表。
- en: From this data, we see that what has the most impact on the model is the opening
    gap, the offer price, and the number of managers involved in the deal. These would
    all seem to make sense as having predictive values, since they indicate that there
    is strong demand for the deal.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些数据中，我们可以看出，模型中影响最大的是开盘差距、报价和参与交易的经理人数。这些特征似乎都有预测价值，因为它们表明该交易有强烈的需求。
- en: Summary
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: We covered a lot of ground in this chapter, but we've only just scratched the
    surface in terms of how to build this type of model. Hopefully, you've gained
    a better understanding of the modeling process, from cleaning the data, to engineering
    the features, to testing. And hopefully, you'll use this information to extend
    the model on your own and improve upon it.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们涵盖了很多内容，但在构建这种类型的模型方面，我们仅仅触及了表面。希望你能更好地理解建模过程，从数据清理、特征工程到测试。并且希望你能利用这些信息自己扩展模型并加以改进。
- en: In the next chapter, we'll turn our attention to a very different domain, as
    we move from numeric data to text-based data.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将转向一个完全不同的领域，从数字数据转向基于文本的数据。
