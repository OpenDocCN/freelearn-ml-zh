- en: '14'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '14'
- en: Bayesian Statistics
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯统计学
- en: In this chapter, we will introduce the Bayesian inference framework, covering
    its core components and implementation details. Bayesian inference introduces
    a useful framework that provides an educated guess on the predictions of the target
    outcome as well as quantified uncertainty estimates. Starting from a prior distribution
    that embeds domain expertise, the Bayesian inference approach allows us to continuously
    learn updated information from the data and update the posterior distribution
    to form a more realistic view of the underlying parameters.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍贝叶斯推断框架，涵盖其核心组件和实现细节。贝叶斯推断引入了一个有用的框架，它提供了对目标结果预测的合理猜测以及量化的不确定性估计。从包含领域专业知识的先验分布开始，贝叶斯推断方法允许我们从数据中持续学习更新信息，并更新后验分布，以形成对潜在参数的更现实的观点。
- en: By the end of this chapter, you will have grasped essential skills when working
    with the Bayesian inference framework. You will learn the core theory behind Bayes’
    theorem and its use in the Bayesian linear regression model.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，你将掌握使用贝叶斯推断框架的基本技能。你将学习贝叶斯定理的核心理论和它在贝叶斯线性回归模型中的应用。
- en: 'We will cover the following main topics in this chapter:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将涵盖以下主要内容：
- en: Introducing Bayesian statistics
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍贝叶斯统计学
- en: Diving deeper into Bayesian inference
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深入了解贝叶斯推断
- en: The full Bayesian inference procedure
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 完整的贝叶斯推断过程
- en: Bayesian linear regression with a categorical variable
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 带有分类变量的贝叶斯线性回归
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To run the code in this chapter, you will need to have the latest versions
    of the following packages:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行本章中的代码，你需要拥有以下软件包的最新版本：
- en: '`ggplot2`, 3.4.0'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggplot2`, 3.4.0'
- en: '`ggridges`, 0.5.4'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggridges`, 0.5.4'
- en: '`rjags`, 4.13'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rjags`, 4.13'
- en: '`coda`, 0.19.4'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`coda`, 0.19.4'
- en: Please note that the versions mentioned along with the packages in the preceding
    list are the latest ones while I am writing this chapter.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，前面提到的软件包版本是在我撰写本章时的最新版本。
- en: All the code and data for this chapter is available at [https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_14/working.R](https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_14/working.R).
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的所有代码和数据均可在[https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_14/working.R](https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_14/working.R)找到。
- en: Introducing Bayesian statistics
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍贝叶斯统计学
- en: The Bayesian approach to statistics and **machine learning** (**ML**) provides
    a logical, transparent, and interpretable framework. This is a uniform framework
    that can build problem-specific models for both statistical inference and prediction.
    In particular, Bayesian inference offers a method to figure out unknown or unobservable
    quantities given known facts (observed data), employing probability to describe
    the uncertainty over the possible values of unknown quantities—namely, random
    variables of interest.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯方法在统计学和**机器学习**（**ML**）中提供了一个逻辑清晰、透明且可解释的框架。这是一个统一的框架，可以为统计推断和预测构建特定问题的模型。特别是，贝叶斯推断提供了一种方法，在已知事实（观察数据）的情况下，通过概率描述未知量的可能值的不确定性——即感兴趣的随机变量。
- en: Using Bayesian statistics, we are able to express our prior assumption about
    unknown quantities and adjust this based on the observed data. It provides the
    Bayesian versions of common statistical procedures such as hypothesis testing
    and linear regression, covered in *Chapters 11*, *Statistics estimation*, and
    *12*, *Linear Regression in R*. Compared to the frequentist approach, which we
    have adopted in all the models covered so far, the Bayesian approach additionally
    allows us to construct problem-specific models that can make the best use of the
    data in a continuous learning fashion (via the Bayesian posterior update, to be
    covered in the following section).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 使用贝叶斯统计学，我们能够表达我们对未知量的先验假设，并根据观察数据调整这一假设。它提供了常见的统计程序（如假设检验和线性回归）的贝叶斯版本，这些内容在*第11章*，*统计估计*和*第12章*，*R中的线性回归*中有所涉及。与迄今为止我们采用的频率主义方法相比，贝叶斯方法还允许我们构建特定问题的模型，以连续学习的方式（通过贝叶斯后验更新，将在下一节中介绍）充分利用数据。
- en: For example, the unknown quantities correspond to the parameters we are trying
    to estimate in a linear or logistic regression model. Instead of treating them
    as fixed quantities and using the principle of maximum likelihood to estimate
    their values, the Bayesian approach treats them as moving variables with their
    respective probability distribution of possible values.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，未知量对应于我们在线性或逻辑回归模型中试图估计的参数。我们不是将它们视为固定量，并使用最大似然原理来估计它们的值，而是贝叶斯方法将它们视为具有各自可能值概率分布的移动变量。
- en: Let us get a first glimpse of the famous Bayesian theorem.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先了解一下著名的贝叶斯定理。
- en: A first look into the Bayesian theorem
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 初探贝叶斯定理
- en: The Bayesian theorem describes the relationship between conditional probabilities
    of statistical quantities. In the context of linear regression, we would treat
    the parameter β as a random variable instead of fixed quantities as we did with
    linear regression in [*Chapter 12*](B18680_12.xhtml#_idTextAnchor258). For example,
    in a simple linear regression model y = βx, instead of obtaining the single best
    parameter β * by minimizing the **ordinary least squares** (**OLS**) given the
    available data (x, y), we would instead treat β as a random variable that follows
    a specific distribution.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯定理描述了统计量条件概率之间的关系。在线性回归的背景下，我们会将参数 β 视为一个随机变量，而不是像我们在[*第12章*](B18680_12.xhtml#_idTextAnchor258)中处理线性回归那样将其视为固定量。例如，在一个简单的线性回归模型
    y = βx 中，我们不会通过最小化给定数据 (x, y) 的**普通最小二乘法**（**OLS**）来获得单个最佳参数 β，而是将 β 视为一个遵循特定分布的随机变量。
- en: 'Doing this involves two distributions about β, the parameter of interest, as
    follows:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 做这件事涉及到关于 β 的两个分布，即感兴趣的参数，如下所示：
- en: The first distribution is the **prior distribution** P(β), which corresponds
    to a subjective distribution we assign to β before we observe any data. This distribution
    encapsulates our prior belief about the probabilities of possible values of β
    before we observe any actual data.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个分布是**先验分布** P(β)，这对应于我们在观察任何数据之前分配给 β 的主观分布。这个分布封装了我们在观察任何实际数据之前对 β 可能值概率的先验信念。
- en: The second distribution is the **posterior distribution** P(β|x, y), which corresponds
    to the updated belief about this distribution after we observe the data. This
    is the distribution we want to estimate through the update. Such an update is
    necessary in order to conform our prior belief to what we actually observe in
    reality.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二个分布是**后验分布** P(β|x, y)，这对应于观察数据后我们对该分布更新的信念。这是我们希望通过更新来估计的分布。这种更新是为了使我们的先验信念与我们在现实中实际观察到的相符合。
- en: Naturally, we would hope that the posterior distribution P(β|x, y) stays closer
    to what the data reflects as the training size gets large, and correspondingly
    stays further away from the prior belief. Here, the data refers to (x, y). To
    proceed with the update, the data would enter as what we call the likelihood function
    P(y|x, β), also referred to as the **generative model**. That is, P(y|x, β) represents
    the likelihood (similar to probability, although in an unnormalized way) of observing
    the target y given the input feature x and parameter value β, where we have treated
    β as a specific value instead of a random variable. In other words, we would first
    sample from the distribution P(β) to obtain a concrete value of β, and then follow
    the specific observation model to obtain the actual data point y given the input
    feature x. For example, we would assume a normal distribution for the observation
    model if the errors are assumed to follow a normal distribution.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 自然地，我们希望随着训练规模的增大，后验分布 P(β|x, y) 越来越接近数据反映的内容，并且相应地越来越远离先验信念。在这里，数据指的是 (x, y)。为了进行更新，数据将以我们所说的似然函数
    P(y|x, β) 的形式进入，也被称为**生成模型**。也就是说，P(y|x, β) 表示在给定输入特征 x 和参数值 β 的情况下观察目标 y 的似然（类似于概率，尽管是非归一化的方式），我们将
    β 视为一个特定的值而不是一个随机变量。换句话说，我们首先从分布 P(β) 中采样以获得 β 的具体值，然后根据特定的观察模型，在给定输入特征 x 的情况下获得实际数据点
    y。例如，如果我们假设误差遵循正态分布，我们会假设观察模型为正态分布。
- en: 'Now, we are ready to compile these three quantities together via the following
    Bayesian theorem:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们准备通过以下贝叶斯定理将这些三个量一起编译：
- en: P(β | x, y) =  P(y|x, β)P(β) _ P(y|x)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: P(β | x, y) =  P(y|x, β)P(β) _ P(y|x)
- en: Here, P(y|x) is referred to as the evidence, which acts as a normalizing constant
    to ensure that the posterior distribution is a valid probability distribution,
    meaning each probability is non-negative and sums (or integrates) to 1.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，P(y|x) 被称为证据，它作为归一化常数，确保后验分布是一个有效的概率分布，这意味着每个概率都是非负的，并且总和（或积分）为 1。
- en: '*Figure 14**.1* illustrates the Bayesian theorem:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '*图14.1* 展示了贝叶斯定理：'
- en: '![Figure 14.1 – Illustrating the Bayesian theorem that calculates the posterior
    distribution ​P​(<?AID d835?><?AID df37?> | x, y)​​](img/B18680_14_001.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![图14.1 – 说明贝叶斯定理计算后验分布 P(𝜷 | x, y)](img/B18680_14_001.jpg)'
- en: Figure 14.1 – Illustrating the Bayesian theorem that calculates the posterior
    distribution P(𝜷 | x, y)
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.1 – 说明贝叶斯定理计算后验分布 P(𝜷 | x, y)
- en: Note that the prior distribution P(β) in Bayesian linear regression could be
    chosen to model our prior belief about the parameter β, which is something not
    available when using the frequentist framework in OLS-based linear regression.
    In practice, we often go with a normal prior distribution, but it could be any
    distribution that captures the prior belief about the probabilities of possible
    values of β before we observe any data. The Bayesian framework thus allows us
    to incorporate the prior knowledge into the modeling in a principled manner. For
    example, if we believe that all features should have similar effects, we can then
    configure the prior distributions of the coefficients to be centered around the
    same value.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，贝叶斯线性回归中的先验分布 P(β) 可以选择来模拟我们对参数 β 的先验信念，这在使用基于 OLS 的线性回归的频率派框架时是不可用的。在实践中，我们通常采用正态先验分布，但它可以是任何在观察任何数据之前捕捉
    β 可能值概率的先验信念的分布。因此，贝叶斯框架允许我们以原则性的方式将先验知识纳入建模中。例如，如果我们认为所有特征应该有相似的影响，我们就可以配置系数的先验分布以围绕相同的值为中心。
- en: Since the parameter β follows a posterior distribution P(β | x, y), the resulting
    prediction y * given a new input data x * will not be a single number, as in the
    case of the frequentist approach. Instead, we will obtain a series of possible
    values of y *, which follows a posterior predictive distribution P( y *| x *,
    β). That is, the prediction y * is treated as a random variable due to the randomness
    in the parameter β. We can then use this distribution to understand the uncertainty
    in the resulting predictions. For example, if the posterior predictive distribution
    P( y *| x *, β) is wide, the resulting predictions, which are sampled from P(
    y *| x *, β), contain a higher degree of uncertainty. On the other hand, if the
    distribution is narrow, the resulting predictions are more concentrated and thus
    more confident. The posterior distribution P(β | x, y) will also continue to evolve
    as new data becomes available.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 由于参数 β 遵循后验分布 P(β | x, y)，给定新的输入数据 x 的结果预测 y 将不会是一个单一的数字，正如频率派方法中的情况。相反，我们将获得一系列可能的
    y 值，这些值遵循后验预测分布 P( y*| x*, β)。也就是说，由于参数 β 的随机性，预测 y 被视为一个随机变量。然后我们可以使用这个分布来理解结果预测的不确定性。例如，如果后验预测分布
    P( y*| x*, β) 较宽，那么从 P( y*| x*, β) 中采样的结果预测将包含更高的不确定性。另一方面，如果分布较窄，结果预测将更加集中，因此更加自信。随着新数据的出现，后验分布
    P(β | x, y) 也将继续演变。
- en: The next section introduces more on the generative model.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将介绍更多关于生成模型的内容。
- en: Understanding the generative model
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解生成模型
- en: In Bayesian inference, the generative model specifies the probability distribution
    that governs how the data is generated. For example, when the available target
    data is binary, we could assume it is generated following a Bernoulli distribution
    with a parameter p that represents the probability of success. To get a list of
    binary outcomes, we would first assign a probability value to p and then use this
    Bernoulli distribution to generate binary labels by repeated sampling from this
    distribution.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在贝叶斯推理中，生成模型指定了控制数据如何生成的概率分布。例如，当可用的目标数据是二进制时，我们可以假设它是按照参数 p 的伯努利分布生成的，其中 p
    代表成功的概率。为了得到一系列的二进制结果，我们首先为 p 分配一个概率值，然后使用这个伯努利分布通过从这个分布中重复采样来生成二进制标签。
- en: Let us go through an exercise to understand the generative process.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个练习来理解生成过程。
- en: Exercise 14.1 – Generating binary outcomes
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习14.1 – 生成二进制结果
- en: 'In this exercise, we will generate a list of binary outcomes based on a Bernoulli
    distribution. This involves comparing a random sample from a uniform distribution
    valued between `0` and `1` to the preset probability of success. Follow the next
    steps:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将根据伯努利分布生成一系列二进制结果。这涉及到将来自均匀分布的 `0` 到 `1` 之间的随机样本与预设的成功概率进行比较。遵循以下步骤：
- en: 'We begin with generating a random number in the range of `0` and `1` using
    a uniform distribution:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先使用均匀分布生成一个介于 `0` 和 `1` 范围内的随机数：
- en: '[PRE0]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Again, remember to set the random seed for reproducibility purposes.
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 再次提醒，为了可重复性，请设置随机种子。
- en: 'Next, we compare the number to a preset probability of `0.2`:'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将数字与预设的概率 `0.2` 进行比较：
- en: '[PRE1]'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This completes the generation of a single binary number. Now, let us expand
    it to 10 numbers.
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这完成了单个二进制数的生成。现在，让我们将其扩展到 10 个数字。
- en: 'With the help of the following code, we’ll generate 10 binary numbers:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在以下代码的帮助下，我们将生成 10 个二进制数：
- en: '[PRE2]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Here, we used a `for` loop to repeatedly generate a uniform random number, compare
    it with the preset probability of success, and then store the result in a vector.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，我们使用 `for` 循环重复生成均匀随机数，将其与预设的成功概率进行比较，然后将结果存储在向量中。
- en: 'Convert the vector to numbers `0` and `1`, as follows:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将向量转换为 `0` 和 `1` 数字，如下所示：
- en: '[PRE3]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note that we have observed 1 instance of success out of 10 draws, despite a
    20% probability of success. As the sample size increases, we would expect the
    empirical probability of success (10% in this case) to be close to the theoretical
    value (20%).
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，尽管成功的概率为 20%，但我们观察到 10 次抽取中有 1 次成功。随着样本量的增加，我们预计成功的经验概率（本例中为 10%）将接近理论值（20%）。
- en: 'It turns out that this generative model corresponds to a binomial process or
    a binomial distribution, which allows us to generate binary outcomes in one shot.
    Specifically, we can use the `rbinom``()` function to simulate data from a binomial
    distribution, as shown in the following code snippet:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，这个生成模型对应于二项过程或二项分布，这允许我们一次性生成二进制结果。具体来说，我们可以使用 `rbinom()` 函数来模拟二项分布的数据，如下面的代码片段所示：
- en: '[PRE4]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Here, `n` is the number of samples to be generated from the generative model,
    `size` is the number of trials to run, and `prob` is the underlying probability
    of success valued between `0.0` and `1.0`.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`n` 是从生成模型中生成的样本数量，`size` 是要运行的试验次数，`prob` 是介于 `0.0` 和 `1.0` 之间的成功基础概率。
- en: Note that we are essentially working with a known parameter p, which is the
    probability of success. In practice, this would be an unknown parameter, something
    we are interested in estimating from the data. Bayesian inference would allow
    us to do that, with the assistance of a prior distribution and the likelihood
    function, as introduced in the following section.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们本质上是在处理一个已知的参数 p，即成功的概率。在实践中，这将是未知参数，是我们从数据中感兴趣估计的东西。贝叶斯推理将允许我们这样做，在下一节中介绍的先验分布和似然函数的帮助下。
- en: Understanding prior distributions
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解先验分布
- en: A prior distribution, an essential component of Bayesian inference, represents
    the prior knowledge or belief about the underlying parameter before we observe
    the actual data. It essentially specifies the probability distribution of the
    parameters based on domain-specific preference or expertise. If we have a valid
    reason to believe that certain values of the parameters are more likely, we can
    choose a prior distribution that reflects this preference.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 先验分布，贝叶斯推理的一个基本组成部分，表示在我们观察实际数据之前对潜在参数的先验知识或信念。它本质上基于特定领域的偏好或专业知识指定参数的概率分布。如果我们有合理的理由相信某些参数值更有可能，我们可以选择一个反映这种偏好的先验分布。
- en: The prior distribution, denoted as P(β), treats β as a random variable and specifies
    its probability distribution. That is, it tells us which values of β are more
    likely than others. In our running example on Bayesian linear regression, the
    prior distribution for β is often chosen to be a multivariate Gaussian distribution.
    This is mainly for mathematical convenience, as the Gaussian distribution has
    nice properties that make it easier to work with. However, if we have no prior
    preference, a uniform distribution (which gives the same probability to all possible
    choices and is thus uninformed) could be a good candidate.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 先验分布，表示为P(β)，将β视为一个随机变量并指定其概率分布。也就是说，它告诉我们哪些β的值比其他值更有可能。在我们关于贝叶斯线性回归的运行示例中，β的先验分布通常选择为多元高斯分布。这主要是出于数学上的便利，因为高斯分布具有一些良好的性质，使得它更容易处理。然而，如果我们没有先验偏好，均匀分布（对所有可能的选择给予相同的概率，因此是无信息的）可能是一个好的候选者。
- en: Note that we can also use the prior to impose a form of regularization on the
    model. By choosing a prior distribution that favors smaller values of the parameters
    (such as a Gaussian distribution centered at `0`), we can discourage the model
    from finding solutions with large coefficients, thus preventing overfitting.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们也可以使用先验对模型施加一种正则化的形式。通过选择一个偏好较小参数值的先验分布（例如，以`0`为中心的高斯分布），我们可以阻止模型找到具有大系数的解，从而防止过拟合。
- en: 'In the following code snippet, we randomly generate 10 samples of P(β) following
    a uniform distribution between `0` and `0.2`:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的代码片段中，我们随机生成10个P(β)样本，这些样本遵循在`0`和`0.2`之间的均匀分布：
- en: '[PRE5]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'When we model the probability of success p ∈ [0,1] as a random variable, we
    often assign a beta distribution as the prior. For example, in the following code
    snippet, we generate 1,000 samples of p from the beta distribution p ∼ Beta(35,55)
    using the `rbeta()` function, followed by showing its density plot after converting
    it to a DataFrame format:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们将成功的概率p ∈ [0,1]建模为一个随机变量时，我们通常将贝塔分布作为先验分布。例如，在下面的代码片段中，我们使用`rbeta()`函数从贝塔分布p
    ∼ Beta(35,55)中生成1,000个p的样本，然后将其转换为DataFrame格式后展示其密度图：
- en: '[PRE6]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Running the preceding code will generate the output shown in *Figure 14**.2*.
    It shows a prior concentration of the probability of success close to `0.4`, within
    the range of `0` and `1`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 运行前面的代码将生成*图14.2*所示的输出。它显示了成功概率在`0`和`1`范围内的`0.4`附近的先验集中：
- en: '![Figure 14.2 – Visualizing the density plot of the prior distribution](img/B18680_14_002.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图14.2 – 可视化先验分布的密度图](img/B18680_14_002.jpg)'
- en: Figure 14.2 – Visualizing the density plot of the prior distribution
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.2 – 可视化先验分布的密度图
- en: 'The Beta(a, b) distribution is defined on the interval from `0` to `1`, thus
    providing a natural and flexible prior to the probability random variable. We
    can tune the `Beta` shape parameters a and b to produce alternative prior models.
    In the following code snippet, we compare the origina`l` `B``e``t``a``(``35``,``55``)`
    prior distributions with two alternatives: `B``e``t``a``(``1``,` `1``)` and `B``e``t``a``(``100``,`
    `100``)`. We then plot all three prior distributions together:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Beta(a, b)分布定义在从`0`到`1`的区间上，因此为概率随机变量提供了一个自然且灵活的先验。我们可以调整`Beta`形状参数a和b以产生不同的先验模型。在下面的代码片段中，我们比较了原始`Beta(35,55)`先验分布与两种替代方案：`Beta(1,1)`和`Beta(100,100)`。然后我们将所有三个先验分布一起绘制出来：
- en: '[PRE7]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The preceding code returns the output shown in *Figure 14**.3*. Each prior
    distribution has a different preference region. For example, distribution B is
    close to a uniform distribution and has no specific preference, while distribution
    C places a strong preference for `0.5`, as indicated by the peak value around
    `0.5` and a narrow spread:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的代码返回*图14.3*所示的输出。每个先验分布都有一个不同的偏好区域。例如，分布B接近均匀分布，没有特定的偏好，而分布C对`0.5`有强烈的偏好，如峰值在`0.5`附近和狭窄的分布所指示：
- en: '![Figure 14.3 – Visualizing three different prior distributions](img/B18680_14_003.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图14.3 – 可视化三种不同的先验分布](img/B18680_14_003.jpg)'
- en: Figure 14.3 – Visualizing three different prior distributions
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.3 – 可视化三种不同的先验分布
- en: In the next section, we’ll introduce you to the likelihood function.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将向您介绍似然函数。
- en: Introducing the likelihood function
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍似然函数
- en: The likelihood function describes how likely the observed data is, given a set
    of fixed model parameters. In a parametric model (a model that assumes a certain
    set of parameters), the likelihood is the probability of the observed data as
    a function of the parameters. The specific form of the likelihood function depends
    on the distribution (more specifically, the observation model) assumed for the
    data. For example, if we assume the data follows a normal distribution, the likelihood
    function would take the form of a normal probability density function.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 似然函数描述了在给定一组固定模型参数的情况下，观察到的数据有多可能。在参数模型（假设一组特定参数的模型）中，似然是观察数据的概率作为参数的函数。似然函数的具体形式取决于数据所假设的分布（更具体地说，是观测模型）。例如，如果我们假设数据遵循正态分布，似然函数将采用正态概率密度函数的形式。
- en: 'Let us look at a concrete example. Suppose we are developing a simple linear
    regression model with standard normal errors, expressed as y = βx + ϵ, where ϵ
    ∼ N(0,1). Here, we have ignored the intercept term and only considered the slope.
    For a specific data point ( x i, y i), we can express the likelihood l i as the
    probability evaluated at the probability density function of the error term:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一个具体的例子。假设我们正在开发一个具有标准正态误差的简单线性回归模型，表示为 y = βx + ϵ，其中 ϵ ∼ N(0,1)。在这里，我们忽略了截距项，只考虑了斜率。对于特定的数据点
    (x_i, y_i)，我们可以将似然 l_i 表示为在误差项的概率密度函数上的概率评估：
- en: l i =  1 _ √ _ 2π   e −(y i−βx i) 2 _ 2
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: l_i = 1 / √2π e^(-(y_i−βx_i)^2 / 2)
- en: 'Since the dataset consists of a total of n input-output pairs, the joint likelihood
    of all data points can be expressed as follows:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 由于数据集由总共 n 个输入输出对组成，所有数据点的联合似然可以表示如下：
- en: L = Π i=1 n  l i = ( 1 _ √ _ 2π  ) n e −∑ i=1 n  (y i−βx i) 2 _ 2
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: L = Π i=1 n l_i = (1 / √2π)^n e^−∑ i=1 n (y_i−βx_i)^2 / 2
- en: 'In practice, we would often work with the log-likelihood after introducing
    the log transformation, as shown here:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，我们通常会引入对数变换后处理对数似然，如下所示：
- en: logL = log( 1 _ √ _ 2π  ) n e −∑ i=1 n  (y i−βx i) 2 _ 2  = − 0.5nlog2π − 0.5∑ i=1 n (y i
    − β x i) 2
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: logL = log(1 / √2π)^n e^−∑ i=1 n (y_i−βx_i)^2 / 2 = −0.5nlog2π − 0.5∑ i=1 n
    (y_i − β x_i)^2
- en: 'Compared to the objective function used in OLS-based linear regression, we
    find that the exponent term ∑ i=1 n  (y i − β x i) 2 is exactly the sum of squared
    errors. When using the maximum likelihood estimation procedure, these two different
    objective functions become equivalent to each other. In other words, we have the
    following:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 与基于 OLS 的线性回归中使用的目标函数相比，我们发现指数项 ∑ i=1 n (y_i − β x_i)^2 正好是平方误差的总和。当使用最大似然估计过程时，这两个不同的目标函数变得彼此等价。换句话说，我们有以下：
- en: logL ≈ − ∑ i=1 n (y i − β x i) 2
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: logL ≈ − ∑ i=1 n (y_i − β x_i)^2
- en: Here, we ignored the constant term ( 1 _ √ _ 2π ) n at the last step.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后一步，我们忽略了常数项 (1 / √2π)^n。
- en: 'Let us go through an example of how to calculate the joint likelihood of a
    set of observed data. In the following code listing, we create a list of data
    points in `x` and `y` and a simple linear regression model with coefficient `b`
    to generate the predicted values in `y_pred`, along with the residual terms in
    residuals:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个例子来了解如何计算一组观察数据的联合似然。在下面的代码列表中，我们创建了一个包含数据点 `x` 和 `y` 的列表，以及一个具有系数 `b`
    的简单线性回归模型，以生成预测值 `y_pred`，以及残差项 `residuals`：
- en: '[PRE8]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We can then plug in the closed-form expression for the joint likelihood and
    calculate the total log-likelihood, as follows:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们可以将联合似然的闭式表达式代入，并计算总对数似然，如下所示：
- en: '[PRE9]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Let us look at another example of the binomial model. As discussed earlier,
    when the underlying parameter p represents the probability of success, we can
    use the `rbinom()` function to obtain the probability of observing a certain outcome
    (number of successes) in a total number of draws and with a specific probability
    of success. In the following code snippet, we first create a vector of probabilities
    to indicate different probabilities of success and calculate the corresponding
    likelihood in a total of 1,000 trials of sampling from a binomial model Bin(p,
    10), where 10 is the total number of draws. Lastly, we visualize all likelihood
    functions via a stacked density plot using the `geom_density_ridges()` function
    from the `ggridges` package:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看二项模型的另一个例子。如前所述，当潜在参数 p 代表成功的概率时，我们可以使用 `rbinom()` 函数来获得在总抽取次数中观察到特定结果（成功次数）的概率。在下面的代码片段中，我们首先创建一个概率向量来表示不同的成功概率，并计算从二项模型
    Bin(p, 10)（其中 10 是总抽取次数）中抽取的 1,000 次试验中的对应似然。最后，我们使用 `ggridges` 包中的 `geom_density_ridges()`
    函数通过堆叠密度图可视化所有似然函数：
- en: '[PRE10]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The preceding code results in the following output:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码产生以下输出：
- en: '![Figure 14.4 – Visualizing the stacked density plot as the likelihood functions
    of different sampling from the binomial distribution](img/B18680_14_004.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.4 – 可视化堆叠密度图作为来自二项分布不同抽样的似然函数](img/B18680_14_004.jpg)'
- en: Figure 14.4 – Visualizing the stacked density plot as the likelihood functions
    of different sampling from the binomial distribution
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.4 – 可视化堆叠密度图作为来自二项分布不同抽样的似然函数
- en: The next section introduces the posterior model.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分介绍了后验模型。
- en: Introducing the posterior model
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 引入后验模型
- en: A posterior distribution represents what we know about unknown parameters after
    observing the available data. It combines the prior beliefs, expressed via the
    prior distribution, with the evidence presented by the data, expressed in the
    likelihood function, to form a new distribution over the possible parameter values,
    which can be either discrete or continuous.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 后验分布代表了观察可用数据后我们对未知参数的了解。它结合了通过先验分布表达的前验信念和数据通过似然函数提供的证据，形成一个新分布，覆盖可能的参数值，这些值可以是离散的或连续的。
- en: 'Based on Bayes’ theorem, the posterior distribution is proportional to the
    product of the prior distribution and the likelihood function:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 基于贝叶斯定理，后验分布与先验分布和似然函数的乘积成比例：
- en: P(β | x, y) ∝ P(y|x, β)P(β)
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: P(β | x, y) ∝ P(y|x, β)P(β)
- en: Note that we do not need to know the evidence term in the denominator when solving
    the optimal value of the parameter β, since P(y|x) is totally independent of β.
    As we gather more data and update our beliefs, the posterior distribution would
    often become more sharply peaked around the true parameter value, indicating an
    increased level of confidence.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，在求解参数 β 的最优值时，我们不需要知道分母中的证据项，因为 P(y|x) 与 β 完全独立。随着我们收集更多数据并更新我们的信念，后验分布通常会围绕真实参数值变得更加尖锐，这表明置信度有所提高。
- en: However, when we need to know P(y|x) in order to calculate P(β | x, y), the
    task is not so straightforward since a closed-form solution may not be available,
    or the parameters are multi-dimensional and prohibit a direct calculation of nested
    integration. In such cases, we would often resort to numerical methods such as
    **Markov chain Monte Carlo** (**MCMC**) or approximate methods such as variational
    inference.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当我们需要知道 P(y|x) 以计算 P(β | x, y) 时，任务并不那么直接，因为可能没有封闭形式的解，或者参数是多维的，这阻止了直接计算嵌套积分。在这种情况下，我们通常会求助于数值方法，如**马尔可夫链蒙特卡洛**（**MCMC**）或近似方法，如变分推断。
- en: Let us go through an exercise to understand the overall inference process. We
    will use the `rjags` package to do the calculations based on our running example.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个练习来了解整体推理过程。我们将使用 `rjags` 包根据我们的运行示例进行计算。
- en: Exercise 14.2 – Obtaining the posterior distribution
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 14.2 – 获取后验分布
- en: 'In this exercise, we will use the `rjags` package to perform Bayesian inference,
    including specifying the model architecture and obtaining the posterior distribution
    for the underlying parameter. Follow the next steps:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用 `rjags` 包进行贝叶斯推理，包括指定模型架构和获取潜在参数的后验分布。按照以下步骤进行：
- en: 'We begin with defining the likelihood function as a binomial distribution (using
    `dbin`) with parameters `p` for the probability of success and `n` for the total
    number of samples. We will also, define the prior distribution for `p` as a beta
    distribution (using `dbeta`) with parameters `a` and `b`:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先定义似然函数为一个二项分布（使用`dbin`），参数`p`代表成功概率，`n`代表样本总数。我们还将定义参数`p`的先验分布为一个贝塔分布（使用`dbeta`），参数为`a`和`b`：
- en: '[PRE11]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Here, we specify `textConnection(bayes_model)` to pass the model specification
    string to `jags`. The data argument is a list specifying the observed data and
    the parameters for the prior distribution.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这里，我们指定`textConnection(bayes_model)`将模型规范字符串传递给`jags`。数据参数是一个列表，指定了观察到的数据和先验分布的参数。
- en: 'Next, we draw samples from the posterior distribution:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们从后验分布中抽取样本：
- en: '[PRE12]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Here, the `coda.samples()` function is used to run MCMC simulations and draw
    samples of the parameter. The `n.iter` argument specifies the number of iterations
    for the MCMC simulation.
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这里，使用`coda.samples()`函数运行MCMC模拟并抽取参数样本。`n.iter`参数指定了MCMC模拟的迭代次数。
- en: 'Finally, we plot the posterior:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们绘制后验分布图：
- en: '[PRE13]'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Running the preceding code will result in the output shown in *Figure 14**.5*:'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行前面的代码将产生*图14.5*中显示的输出：
- en: '![Figure 14.5 – Visualizing the posterior distribution for the underlying parameter
    (probability of success)](img/B18680_14_005.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![图14.5 – 可视化基础参数（成功概率）的后验分布](img/B18680_14_005.jpg)'
- en: Figure 14.5 – Visualizing the posterior distribution for the underlying parameter
    (probability of success)
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.5 – 可视化基础参数（成功概率）的后验分布
- en: In the next section, we’ll dive deeper into Bayesian inference, starting by
    introducing the normal-normal model, a commonly used type of model in Bayesian
    inference.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将更深入地探讨贝叶斯推理，首先介绍正态-正态模型，这是贝叶斯推理中常用的一种模型类型。
- en: Diving deeper into Bayesian inference
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 深入贝叶斯推理
- en: Bayesian inference is a statistical method that makes use of conditional probability
    to update the prior beliefs about the parameters of a statistical model given
    the observed data. The output of Bayesian inference is a posterior distribution,
    which is a probability distribution that represents our updated beliefs about
    the parameter after observing the data.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯推理是一种统计方法，它利用条件概率来更新关于统计模型参数的先验信念，基于观察到的数据。贝叶斯推理的输出是一个后验分布，它表示我们在观察数据后对参数更新的信念。
- en: When calculating the exact posterior distribution is difficult, we would often
    resort to MCMC, which is a technique for estimating the distribution of a random
    variable. It’s a method commonly used to generate samples from the posterior distribution
    in Bayesian inference, especially when the dimensionality of the model parameters
    is high, making an analytical solution intractable.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 当计算精确的后验分布很困难时，我们通常会求助于MCMC，这是一种估计随机变量分布的技术。它是贝叶斯推理中从后验分布中生成样本的常用方法，尤其是在模型参数的维度很高时，使得解析解变得不可行。
- en: The following section introduces the normal-normal model and uses MCMC to estimate
    its posterior distribution.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍正态-正态模型，并使用MCMC来估计其后验分布。
- en: Introducing the normal-normal model
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍正态-正态模型
- en: The normal-normal model is another foundational model in Bayesian inference.
    It refers to the case when the likelihood is normally distributed and the prior
    is also normally distributed, both following a bell-shaped curve. This type of
    model is often used in Bayesian statistics as it has a closed-form solution for
    the posterior distribution, which also happens to be normally distributed.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 正态-正态模型是贝叶斯推理中的另一个基础模型。它指的是当似然函数和先验分布都是正态分布，且都遵循钟形曲线的情况。这类模型在贝叶斯统计中经常被使用，因为它对后验分布有封闭形式的解，而这个解恰好也是正态分布。
- en: Let us look at a concrete exercise of the normal-normal model using MCMC-based
    Bayesian inference.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个基于MCMC的贝叶斯推理的normal-normal模型的具体练习来观察。
- en: Exercise 14.3 – Working with the normal-normal model
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习14.3 – 使用正态-正态模型
- en: 'In this exercise, we will define a normal likelihood function whose mean follows
    a normal prior and whose standard deviation follows a uniform prior. We will then
    use `rjags` to obtain the posterior estimates for the mean and the standard deviation.
    Follow the next steps:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将定义一个正态似然函数，其均值遵循正态先验分布，而标准差遵循均匀先验分布。然后我们将使用`rjags`来获取均值和标准差的后验估计。请按照以下步骤操作：
- en: 'Let’s start with simulating 100 data points that follow a normal distribution
    with a true mean of `2` and a true standard deviation of `1`:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从模拟100个遵循具有真实均值`2`和真实标准差`1`的正态分布的数据点开始：
- en: '[PRE14]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now, we specify the model architecture, including a normal likelihood function
    for the data, a normal prior distribution for the mean variable, and a uniform
    prior for the standard deviation variable. The normal prior is parameterized by
    `0` and `0.1` for the mean and standard deviation, respectively, and the uniform
    prior ranges from `0` to `10`:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们指定模型架构，包括数据的一个正态似然函数、均值变量的正态先验分布和标准差变量的均匀先验。正态先验由`0`和`0.1`分别参数化均值和标准差，而均匀先验的范围从`0`到`10`：
- en: '[PRE15]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The preceding model states that each observation in our data (`y[i]`) follows
    a normal distribution with mean `mu` and precision, `prec`, (defined as the reciprocal
    of the variance, hence `prec <- pow(sigma, -2)`). The mean `mu` follows a normal
    distribution with mean `0` and precision close to `0`, which corresponds to a
    relatively large variance and, therefore, a weak prior belief about `mu`. The
    standard deviation, `sigma`, follows a uniform distribution from `0` to `10`,
    which expresses complete uncertainty about its value between these two bounds.
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 前面的模型表明，我们数据中的每个观测值（`y[i]`）遵循一个具有均值`mu`和精度`prec`的正态分布（定义为方差的倒数，因此`prec <- pow(sigma,
    -2)`）。均值`mu`遵循一个具有均值`0`和接近`0`的精度的正态分布，这对应于相对较大的方差，因此对`mu`的先验信念较弱。标准差`sigma`遵循一个从`0`到`10`的均匀分布，这表达了在这两个界限之间对其值的完全不确定性。
- en: 'Next, compile the model in `jags` and burn in the Markov chain, as follows:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在`jags`中编译模型并烧尽马尔可夫链，如下所示：
- en: '[PRE16]'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Here, the `burn-in` period is a number of initial iterations that we discard
    when performing Bayesian inference, under the assumption that the resulting chain
    may not have converged during this period. The idea is to let the Markov chain
    burn in until it reaches a distribution that is stable and reflective of the posterior
    distribution we are interested in. In this case, we would discard the first 1,000
    iterations of the Markov chain, and these are not used in the subsequent analysis.
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，`burn-in`期是一系列初始迭代次数，我们在进行贝叶斯推理时将其丢弃，假设在此期间产生的链可能没有收敛。想法是让马尔可夫链烧尽，直到它达到一个稳定且能反映我们感兴趣的后续分布的分布。在这种情况下，我们将丢弃马尔可夫链的前1,000次迭代，这些迭代在后续分析中不被使用。
- en: 'Here, we generate samples from the posterior distribution:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，我们从后验分布中生成样本：
- en: '[PRE17]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Here, the `summary()` function provides useful summary statistics for the posterior
    samples of `mu` and `sigma`, including their means, medians, and credible intervals.
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，`summary()`函数为`mu`和`sigma`的后验样本提供了有用的汇总统计信息，包括它们的均值、中位数和可信区间。
- en: 'Finally, let’s visualize the results by running the following command:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，通过运行以下命令来可视化结果：
- en: '[PRE18]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Running the preceding line of code will generate the output shown in *Figure
    14**.6*, which shows trace plots and density plots for the posterior samples of
    `mu` and `sigma`:'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行前面的代码行将生成如*图14*.6所示的输出，该图显示了`mu`和`sigma`的后验样本的轨迹图和密度图：
- en: '![Figure 14.6 – Visualizing the trace plots and density plots for the posterior
    samples](img/B18680_14_006.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![图14.6 – 可视化后验样本的轨迹图和密度图](img/B18680_14_006.jpg)'
- en: Figure 14.6 – Visualizing the trace plots and density plots for the posterior
    samples
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.6 – 可视化后验样本的轨迹图和密度图
- en: In the next section, we will discuss more on the MCMC.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将进一步讨论MCMC。
- en: Introducing MCMC
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍MCMC
- en: A Markov chain is a mathematical model that transits from one state to another
    within a finite or countable number of possible states. It is a sequence of random
    variables where the future state depends only on the present state and not on
    the sequence of events before it. This property is known as the **Markov property**,
    or **memorylessness**.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 马尔可夫链是一个数学模型，在有限或可数的可能状态之间从一个状态过渡到另一个状态。它是一系列随机变量，其中未来的状态只取决于当前状态，而不取决于它之前的事件序列。这个特性被称为**马尔可夫性质**，或**无记忆性**。
- en: In the context of statistical inference, we can sample from complex probability
    distributions and create models of sequence data via Monte Carlo simulations,
    and thus the term MCMC. MCMC algorithms construct a Markov chain of parameter
    values where the stationary distribution of the chain is the posterior distribution
    of the underlying parameters. The chain is generated by iteratively proposing
    new parameter values and accepting or rejecting these candidate values based on
    a preset rule, ensuring that the samples converge to the posterior distribution.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计推断的背景下，我们可以从复杂的概率分布中进行采样，并通过蒙特卡洛模拟创建序列数据的模型，因此术语 MCMC。MCMC 算法构建参数值的马尔可夫链，其中链的平稳分布是潜在参数的后验分布。链是通过迭代提出新的参数值并根据预设规则接受或拒绝这些候选值来生成的，确保样本收敛到后验分布。
- en: 'Let us analyze the details of the previous MCMC chain. In the following code
    snippet, we convert the chain to a DataFrame and print its first few rows:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分析之前 MCMC 链的细节。在下面的代码片段中，我们将链转换为 DataFrame 并打印其前几行：
- en: '[PRE19]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'These are MCMC samples generated to approximate the posterior distribution
    for `mu` and `sigma`, respectively. Each sample depends on the previous sample
    only and is unrelated to other prior samples. We can plot these samples in a line
    plot called a trace plot, as shown in the following code snippet:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是生成以近似 `mu` 和 `sigma` 的后验分布的 MCMC 样本。每个样本仅依赖于前一个样本，与其他先验样本无关。我们可以将这些样本绘制在称为迹图的线图中，如下代码片段所示：
- en: '[PRE20]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Running the preceding code generates the output shown in *Figure 14**.7*. A
    trace plot is a commonly used diagnostic tool in MCMC. It is a graphical representation
    of the values of the samples at each iteration or step of the MCMC algorithm.
    In this case, the trace plot shows no obvious trend, suggesting that both chains
    have converged stably:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 运行上述代码生成 *图 14.7* 中显示的输出。迹图是 MCMC 中常用的诊断工具。它是 MCMC 算法每次迭代或步骤中样本值的图形表示。在这种情况下，迹图没有明显的趋势，表明两条链都稳定收敛：
- en: '![Figure 14.7 – Visualizing the trace plots of MCMC chains](img/B18680_14_007.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.7 – 显示 MCMC 链的迹图](img/B18680_14_007.jpg)'
- en: Figure 14.7 – Visualizing the trace plots of MCMC chains
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.7 – 显示 MCMC 链的迹图
- en: 'Let us observe the first 100 samples using `ggplot()` for `mu`:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用 `ggplot()` 观察 `mu` 的前 100 个样本：
- en: '[PRE21]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Running the preceding code generates the output shown in *Figure 14**.8*. We
    can see that the sampler moves to another region after sufficiently exploring
    the previous region:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 运行上述代码生成 *图 14.8* 中显示的输出。我们可以看到采样器在充分探索了前一个区域后移动到了另一个区域：
- en: '![Figure 14.8 – Visualizing the first 100 iterations of the mu chain](img/B18680_14_008.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.8 – 显示 mu 链的前 100 次迭代](img/B18680_14_008.jpg)'
- en: Figure 14.8 – Visualizing the first 100 iterations of the mu chain
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.8 – 显示 mu 链的前 100 次迭代
- en: 'Note that we can also display the density plot only by setting `trace = FALSE`,
    as follows:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们也可以仅通过设置 `trace = FALSE` 来显示密度图，如下所示：
- en: '[PRE22]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'The preceding code returns the output shown in *Figure 14**.9*:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码返回了 *图 14.9* 中显示的输出：
- en: '![Figure 14.9 – Visualizing the density plot of both chains](img/B18680_14_009.jpg)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.9 – 显示两条链的密度图](img/B18680_14_009.jpg)'
- en: Figure 14.9 – Visualizing the density plot of both chains
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.9 – 显示两条链的密度图
- en: In practice, we would often run multiple chains in MCMC. This allows us to check
    whether all chains converge to the same distribution, which is a critical step
    to ensure that MCMC sampling is done correctly. Since each chain in MCMC starts
    at a different initial point, running multiple chains could help check whether
    the posterior distribution is dependent on the starting values. When all chains
    converge to the same distribution regardless of the initial points, we have a
    higher level of confidence in the stability and robustness of the MCMC process.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，我们通常会运行多个 MCMC 链。这允许我们检查所有链是否收敛到相同的分布，这是确保 MCMC 采样正确执行的关键步骤。由于 MCMC 中的每个链都是从不同的初始点开始的，运行多个链可以帮助检查后验分布是否依赖于起始值。当所有链无论初始点如何都收敛到相同的分布时，我们对
    MCMC 过程的稳定性和鲁棒性有更高的信心。
- en: 'The following code snippet runs MCMC over four chains:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段在四个链上运行 MCMC：
- en: '[PRE23]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'We can check the trace plot as follows:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以如下检查迹图：
- en: '[PRE24]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'As shown in *Figure 14**.10*, all four chains have more or less converged to
    a stable state:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 如 *图 14.10* 所示，所有四个链或多或少都收敛到了一个稳定状态：
- en: '![Figure 14.10 – Visualizing the density plot of both chains](img/B18680_14_010.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.10 – 可视化两个链的密度图](img/B18680_14_010.jpg)'
- en: Figure 14.10 – Visualizing the density plot of both chains
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.10 – 可视化两个链的密度图
- en: 'Finally, we can check the summary of the MCMC samples, as follows:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以检查MCMC样本的摘要，如下所示：
- en: '[PRE25]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: In the next section, we will cover the full Bayesian inference procedure, including
    quantifying the posterior uncertainty and making predictions based on the posterior
    distribution of the parameters.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍完整的贝叶斯推理过程，包括量化后验不确定性和基于参数后验分布进行预测。
- en: The full Bayesian inference procedure
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 完整的贝叶斯推理过程
- en: The full Bayesian inference starts by specifying the model architecture, including
    the prior distribution for unknown (unobserved) parameters and the likelihood
    function that determines how the data is generated. We can then perform MCMC to
    infer the posterior distribution of these parameters given the observed dataset.
    Finally, we can use the posterior distribution to either quantify the uncertainty
    about these parameters or make predictions for new input data with quantified
    uncertainty about the predictions.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的贝叶斯推理首先需要指定模型架构，包括未知（未观测）参数的先验分布以及确定数据生成方式的似然函数。然后，我们可以执行MCMC来推断给定观测数据集的这些参数的后验分布。最后，我们可以使用后验分布来量化这些参数的不确定性，或者对新输入数据进行预测，并量化预测的不确定性。
- en: The following exercise illustrates this process using the `mtcars` dataset.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 以下练习使用 `mtcars` 数据集说明了这个过程。
- en: Exercise 14.4 – Performing full Bayesian inference
  id: totrans-177
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 14.4 – 执行完整贝叶斯推理
- en: 'In this exercise, we will perform Bayesian linear regression with a single
    feature and two unknown parameters: `intercept` and `slope`. The model looks at
    the relationship between car weight (`wt`) and horsepower (`hp`) in the `mtcars`
    dataset. Follow the next steps:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用单个特征和两个未知参数（`intercept` 和 `slope`）执行贝叶斯线性回归。该模型研究 `mtcars` 数据集中汽车重量
    (`wt`) 和马力 (`hp`) 之间的关系。按照以下步骤进行：
- en: 'Specify a Bayesian inference model where each target `wt` is modeled as a realization
    of a random variable following a normal distribution. The `mean` parameter is
    a linear combination of two parameters (`a` for `intercept` and `b` for `slope`)
    with the corresponding input feature. Both `a` and `b` follow a normal distribution,
    and the `variance` parameter follows a uniform distribution. The code is illustrated
    in the following snippet:'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定一个贝叶斯推理模型，其中每个目标 `wt` 被建模为服从正态分布的随机变量的实现。`mean` 参数是两个参数（`a` 为 `intercept`，`b`
    为 `slope`）与相应输入特征的线性组合。`a` 和 `b` 都服从正态分布，而 `variance` 参数服从均匀分布。以下代码片段展示了代码：
- en: '[PRE26]'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Compile the model with three chains and control the random seed for model reproducibility:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用三个链编译模型，并控制随机种子以实现模型的可重复性：
- en: '[PRE27]'
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Run a burn-in period of `three` iterations:'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行`三次`迭代的预热期：
- en: '[PRE28]'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'MCMC samples from the posterior distribution of the parameters, as seen here:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 参数后验分布的MCMC样本，如图所示：
- en: '[PRE29]'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Create a trace plot of the MCMC samples to assess convergence, as follows:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建MCMC样本的迹图以评估收敛性，如下所示：
- en: '[PRE30]'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Running the preceding code generates the output shown in *Figure 14**.11*,
    suggesting a decent convergence for all three parameters:'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行前面的代码生成如图 *14*.11 所示的输出，表明所有三个参数都有良好的收敛性：
- en: '![Figure 14.11 – Visualizing the trace plots of all three parameters](img/B18680_14_011.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.11 – 可视化所有三个参数的迹图](img/B18680_14_011.jpg)'
- en: Figure 14.11 – Visualizing the trace plots of all three parameters
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.11 – 可视化所有三个参数的迹图
- en: 'Calculate the mean of the posterior distributions for parameters `a` and `b`,
    and use these mean values to make point predictions and plot the prediction line
    on a scatterplot of the data, as follows:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算参数 `a` 和 `b` 的后验分布的均值，并使用这些均值进行点预测，并在数据的散点图上绘制预测线，如下所示：
- en: '[PRE31]'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Here, we use the mean of the posterior distribution as the parameter value
    to make a point prediction for each input feature. The commands generate the output
    shown in *Figure 14**.12*:'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，我们使用后验分布的均值作为参数值，对每个输入特征进行点预测。生成的输出如图 *14*.12 所示：
- en: '![Figure 14.12 – Making points predictions using the mean value of the posterior
    distributions for each parameter](img/B18680_14_012.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图 14.12 – 使用每个参数后验分布的均值进行点预测](img/B18680_14_012.jpg)'
- en: Figure 14.12 – Making points predictions using the mean value of the posterior
    distributions for each parameter
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.12 – 使用每个参数的后验分布的均值进行点预测
- en: It is worth noting that Bayesian linear regression offers quantified uncertainty
    compared to frequentist linear regression covered in previous chapters. Such uncertainty
    comes in the form of credible intervals, which differ from the confidence interval.
    Specifically, we obtain the credible interval by treating the parameter as a random
    variable and the data as a fixed quantity, which makes more sense as we only get
    to observe the data once in most cases.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，与之前章节中介绍的频率主义线性回归相比，贝叶斯线性回归提供了量化的不确定性。这种不确定性以可信区间（credible intervals）的形式出现，与置信区间不同。具体来说，我们通过将参数视为随机变量，将数据视为固定量来获得可信区间，这在大多数情况下我们只能观察一次数据时更有意义。
- en: 'Compute the `a` and `b` using the `HPDinterval()` function and plot the confidence
    intervals in the histogram, as follows:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`HPDinterval()`函数计算`a`和`b`，并在直方图中绘制置信区间，如下所示：
- en: '[PRE32]'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Running the commands generates the output shown in *Figure 14**.13*. Here,
    we calculate the 95% credible interval by default:'
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行命令生成*图14.13*所示的输出。在这里，我们默认计算95%的可信区间：
- en: '![Figure 14.13 – Visualizing the posterior distribution and credible interval
    of the model parameters](img/B18680_14_013.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图14.13 – 可视化模型参数的后验分布和可信区间](img/B18680_14_013.jpg)'
- en: Figure 14.13 – Visualizing the posterior distribution and credible interval
    of the model parameters
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.13 – 可视化模型参数的后验分布和可信区间
- en: 'Finally, make posterior predictions for a new input value, 120, and plot the
    posterior predictive distribution based on the list of posterior samples for the
    parameters, as follows:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，对新输入值120进行后验预测，并基于参数的后验样本列表绘制后验预测分布，如下所示：
- en: '[PRE33]'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Running the commands generates the output shown in *Figure 14**.14*. This posterior
    predictive distribution captures the model’s uncertainty about the prediction:'
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行命令生成*图14.14*所示的输出。此后的验预测分布捕捉了模型对预测的不确定性：
- en: '![Figure 14.14 – Visualizing the posterior predictive distribution for a new
    input feature](img/B18680_14_014.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![图14.14 – 可视化新输入特征的后验预测分布](img/B18680_14_014.jpg)'
- en: Figure 14.14 – Visualizing the posterior predictive distribution for a new input
    feature
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.14 – 可视化新输入特征的后验预测分布
- en: The next section covers a Bayesian linear regression model using a categorical
    input variable.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将介绍使用分类输入变量的贝叶斯线性回归模型。
- en: Bayesian linear regression with a categorical variable
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 带有分类变量的贝叶斯线性回归
- en: When the predictor is categorical, such as a binary feature, we would set one
    parameter for each corresponding category. The following exercise demonstrates
    such an example.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 当预测变量是分类变量，例如二元特征时，我们会对每个对应的类别设置一个参数。以下练习演示了这样一个例子。
- en: Exercise 14.5 – Performing Bayesian inference with a categorical variable
  id: totrans-211
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习14.5 – 使用分类变量进行贝叶斯推理
- en: 'In this exercise, we will examine the relationship between `am` (automatic
    or manual transmission, a categorical variable) and `mpg` (miles per gallon, a
    continuous variable). We will define the mean of the normal likelihood for `mpg`
    as a function of `am`, with a different mean `mu[i]` for each level of `am`. We’ll
    also give `mu` a normal prior and standard deviation `s` a uniform prior. Follow
    the next steps:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将检查`am`（自动或手动变速，一个分类变量）与`mpg`（每加仑英里数，一个连续变量）之间的关系。我们将定义`mpg`的正态似然均值作为`am`的函数，每个`am`级别有不同的均值`mu[i]`。我们还将给`mu`一个正态先验，给标准差`s`一个均匀先验。按照以下步骤进行：
- en: 'Specify the aforementioned model architecture, as follows:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下方式指定上述模型架构：
- en: '[PRE34]'
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Compile the model, generate the posterior samples, and show the convergence
    plots:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编译模型，生成后验样本，并显示收敛图：
- en: '[PRE35]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Running the preceding code generates the output shown in *Figure 14**.15*,
    suggesting a decent convergence of all model parameters:'
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 运行前面的代码生成*图14.15*所示的输出，表明所有模型参数的收敛性良好：
- en: '![Figure 14.15 – Visualizing the convergence plots](img/B18680_14_015.jpg)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![图14.15 – 可视化收敛图](img/B18680_14_015.jpg)'
- en: Figure 14.15 – Visualizing the convergence plots
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.15 – 可视化收敛图
- en: 'Plot the distribution of the dataset along with the mean estimate of parameters
    for both levels of the categorical variable, as follows:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下方式绘制数据集的分布以及分类变量两个级别的参数均值估计：
- en: '[PRE36]'
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The preceding code will generate the output shown in *Figure 14**.16*:'
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上述代码将生成*图14.16*中所示的结果：
- en: '![Figure 14.16 – Visualizing the distribution and the mean estimates of the
    dataset](img/B18680_14_016.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![图14.16 – 可视化数据集的分布和均值估计](img/B18680_14_016.jpg)'
- en: Figure 14.16 – Visualizing the distribution and the mean estimates of the dataset
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.16 – 可视化数据集的分布和均值估计
- en: Summary
  id: totrans-225
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter provides a comprehensive introduction to Bayesian statistics, beginning
    with an exploration of the fundamental Bayes’ theorem. We delved into its components,
    starting with understanding the generative model, which helps us simulate data
    and examine how changes in parameters affect the data generation process.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 本章全面介绍了贝叶斯统计，从对贝叶斯定理的基本探讨开始。我们深入研究了其组成部分，从理解生成模型开始，这有助于我们模拟数据并检查参数变化如何影响数据生成过程。
- en: We then focused on understanding the prior distribution, an essential part of
    Bayesian statistics that represents our prior knowledge about an uncertain parameter.
    This was followed by an introduction to the likelihood function, a statistical
    function that determines how likely it is for a set of observations to occur given
    specific parameter values.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们专注于理解先验分布，这是贝叶斯统计的一个基本组成部分，它代表了我们对于一个不确定参数的先验知识。随后，我们介绍了似然函数，这是一个统计函数，它决定了在给定的参数值下，一组观测值发生的可能性。
- en: Next, we introduced the concept of the posterior model. This combines our prior
    distribution and likelihood to give a new probability distribution that represents
    updated beliefs after having seen the data. We also explored more complex models,
    such as the normal-normal model, wherein both the likelihood and the prior are
    normally distributed. We further investigated the mechanics of Bayesian inference
    through the MCMC method, a powerful tool for estimating the distribution of parameters
    and making predictions. A detailed walk-through of the full Bayesian inference
    procedure accompanied this.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们介绍了后验模型的概念。这结合了我们的先验分布和似然函数，给出一个新的概率分布，它代表了在看到数据后的更新信念。我们还探讨了更复杂的模型，例如正态-正态模型，其中似然和先验都是正态分布的。我们进一步通过MCMC方法研究了贝叶斯推理的机制，这是一种强大的工具，用于估计参数分布和进行预测。完整的贝叶斯推理过程的详细说明伴随着这一部分。
- en: Lastly, we discussed Bayesian linear regression with a categorical variable,
    which extends the methodology to models that include categorical predictors.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们讨论了具有分类变量的贝叶斯线性回归，这扩展了方法到包括分类预测因子的模型。
- en: Congratulations! You’ve successfully navigated to the end of this book, a testament
    to your dedication and effort. This journey, hopefully enriching for you and certainly
    so for me, marks a significant milestone in your ongoing exploration of the dynamic
    field of statistics and ML. I’m honored that you chose this book as a companion
    in this voyage, and I trust it has laid a solid foundation for your future pursuits.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已成功到达本书的结尾，这是您奉献和努力的证明。这次旅程，希望对您来说富有成效，对我而言当然也是如此，标志着您在动态的统计学和机器学习领域持续探索中的一个重要里程碑。我很荣幸您选择这本书作为这次航行的伴侣，我相信它为您的未来追求奠定了坚实的基础。
