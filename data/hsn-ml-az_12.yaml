- en: End-to-End Machine Learning
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 端到端机器学习
- en: In this chapter, we will learn about the new capabilities that were launched
    with the Azure Machine Learning service that can help data scientists and AI developers
    with **end-to-end** (**E2E**) machine learning.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习关于与Azure机器学习服务一起推出的新功能，这些功能可以帮助数据科学家和AI开发者进行**端到端**（**E2E**）机器学习。
- en: When developing AI applications, we can use cognitive services, as described
    in [Chapter 3](89299379-0f5e-4602-ad78-9d3d46a0710e.xhtml), *Cognitive Services*.
    Alternatively, we can create custom machine learning models with our own data,
    because cognitive services won't work in every possible scenario. In cases such
    as these, we have to train our own machine learning algorithms. The Azure Machine
    Learning service has an SDK, CLI, and APIs that can help you to create these custom
    models.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在开发AI应用时，我们可以使用第3章中描述的认知服务，即[Cognitive Services]。或者，我们可以使用自己的数据创建定制的机器学习模型，因为认知服务并不适用于所有可能的场景。在这些情况下，我们必须训练自己的机器学习算法。Azure机器学习服务有一个SDK、CLI和API，可以帮助你创建这些定制的模型。
- en: In this chapter, we are going to learn how to use the Azure Machine Learning
    ...
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何使用Azure机器学习 ...
- en: Using the Azure Machine Learning SDK for E2E machine learning
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Azure机器学习SDK进行端到端机器学习
- en: As shown in the following diagram, the first step in E2E machine learning is **data
    preparation**, which includes cleaning the data and featurization. Then, we have
    to create and train a machine learning model in the  **m****odel training **step.
    After that, we have **m****odel deployment**, which means deploying the model
    as a web service to perform predictions. The final step is **m****onitoring**, which
    includes analyzing how the model is performing and then triggering the retraining
    of the model.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 如以下图所示，端到端机器学习的第一步是**数据准备**，这包括数据清洗和特征化。然后，在**模型训练**步骤中，我们必须创建和训练一个机器学习模型。之后，我们有**模型部署**，这意味着将模型作为Web服务部署以执行预测。最后一步是**监控**，这包括分析模型的性能，然后触发模型的重新训练。
- en: '![](img/9fe50b26-c95f-4730-aac1-617edb56ca73.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9fe50b26-c95f-4730-aac1-617edb56ca73.png)'
- en: The Azure ML SDK enables professional data scientists and DevOps engineers to
    carry out E2E machine learning. It allows us to seamlessly use the power of the
    cloud to train and deploy our model. We can start using the Azure ML SDK easily
    by installing it using `pip` in any Python environment. We can scale the compute
    for training by using a cluster of CPUs or GPUs. We can also easily track the
    run history of all experiments with the SDK. This run history is stored in a shareable
    workspace, which allows teams to share the resources and experiment results. Another
    advantage of the SDK is that it allows us to find the best model from multiple
    runs of our experiment, based on a metric that we specify, such as, for example,
    the highest accuracy rate or the lowest rate of errors.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Azure ML SDK使专业数据科学家和DevOps工程师能够执行端到端机器学习。它允许我们无缝使用云的力量来训练和部署我们的模型。我们可以通过在任何Python环境中使用`pip`轻松安装它来开始使用Azure
    ML SDK。我们可以通过使用CPU或GPU集群来扩展训练的计算能力。我们还可以使用SDK轻松跟踪所有实验的运行历史。这个运行历史存储在一个可共享的工作区中，这使得团队能够共享资源和实验结果。SDK的另一个优点是，它允许我们根据我们指定的指标，例如，例如，最高的准确率或最低的错误率，从实验的多次运行中找到最佳的模型。
- en: Once we have a machine learning model that meets our needs, we can put it into
    operation using the Azure ML service. We can create a web service from the model
    that can be deployed in the Azure-managed computer or IoT device. The SDK can
    be installed in any IDE, so you can even deploy the model using VS Code or PyCharm
    if you do not use Jupyter Notebooks or Databricks. For development testing scenarios,
    we can deploy the web service to the **Azure Container Instance** (**ACI)**. To deploy
    the model in production, we can use **Azure Kubernetes Service** (**AKS)**. After
    the web service is deployed to AKS, we can enable monitoring and see how the web
    service is performing.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们有一个满足我们需求的机器学习模型，我们就可以使用Azure ML服务将其投入使用。我们可以从模型创建一个可以在Azure管理的计算机或IoT设备上部署的Web服务。SDK可以安装在任何IDE中，因此即使你不使用Jupyter
    Notebooks或Databricks，你也可以使用VS Code或PyCharm来部署模型。对于开发测试场景，我们可以将Web服务部署到**Azure容器实例**（**ACI**）。要部署生产环境中的模型，我们可以使用**Azure
    Kubernetes服务**（**AKS**）。在Web服务部署到AKS后，我们可以启用监控并查看Web服务的性能。
- en: 'The following sample code shows how to use the SDK for E2E machine learning.
    Start by creating a workspace for your machine learning project. This will be
    created in your Azure subscription and can be shared with different users in your
    organization. This workspace logically groups the computes, experiments, datastores,
    models, images, and deployments that we will need for E2E machine learning:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例代码显示了如何使用SDK进行端到端机器学习。首先，为您的机器学习项目创建一个工作区。这将创建在您的Azure订阅中，并且可以与组织中不同的用户共享。这个工作区逻辑上分组了我们将需要的计算、实验、数据存储、模型、镜像和部署，以进行端到端机器学习：
- en: '![](img/b57e9787-ddf2-4673-9b30-53c819842c43.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b57e9787-ddf2-4673-9b30-53c819842c43.png)'
- en: 'This workspace can be accessed either via code or in the Azure portal within
    our subscription. We can manage all logical components of the workspace and we
    can also manage user permissions. The following screenshot shows the components
    of a workspace as seen in the portal:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这个工作区可以通过代码或在我们的订阅中的Azure门户内访问。我们可以管理工作区的所有逻辑组件，我们还可以管理用户权限。以下截图显示了门户中看到的工作区组件：
- en: '![](img/f628e88a-5de1-4185-a024-5e7256a2ec9f.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f628e88a-5de1-4185-a024-5e7256a2ec9f.png)'
- en: Once we have created a workspace, we can create a training compute that can
    scale automatically based on our training requirements. This compute can use either
    CPU or GPU, and we can use whichever framework we like. We can perform classical
    machine learning with scikit-learn, for example, or deep learning with TensorFlow.
    Any framework or library can be installed using `pip` and used with the SDK. We
    can submit experiment runs to this compute and we will see the results both in
    our environment and in the Azure portal. We can also log metrics as part of our
    training script. Here are some sample screenshots of how experiments run, and
    how corresponding metrics may appear in the Azure portal. We can also access these
    metrics using code with the SDK.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们创建了一个工作区，我们就可以创建一个可以根据我们的训练需求自动扩展的训练计算。这个计算可以使用CPU或GPU，我们可以使用我们喜欢的任何框架。例如，我们可以使用scikit-learn进行经典机器学习，或者使用TensorFlow进行深度学习。任何框架或库都可以使用`pip`安装，并使用SDK使用。我们可以将实验运行提交给这个计算，我们将在我们的环境和Azure门户中看到结果。我们还可以将指标作为我们训练脚本的一部分进行记录。以下是实验运行和相应指标在Azure门户中可能出现的示例截图。我们还可以使用SDK中的代码访问这些指标。
- en: 'The following screenshot shows the number of experiments and the duration it
    took to run each experiment:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了实验的数量以及运行每个实验所需的时间：
- en: '![](img/5b1c89f9-6643-4ca6-b1c6-ea70f39d213e.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5b1c89f9-6643-4ca6-b1c6-ea70f39d213e.png)'
- en: 'This screenshot shows the metrics that are being monitored within a particular
    run:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这张截图显示了特定运行中正在监控的指标：
- en: '![](img/533e4f22-57a0-4a85-b136-31eae588077c.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/533e4f22-57a0-4a85-b136-31eae588077c.jpg)'
- en: 'As mentioned, we can find the best run based on a particular metric of interest.
    An example of a code snippet used to find the best run is as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们可以根据感兴趣的特定指标找到最佳运行。以下是一个用于找到最佳运行的代码片段示例：
- en: '![](img/bef39db5-adb8-42b5-aa26-51bf84a3265d.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bef39db5-adb8-42b5-aa26-51bf84a3265d.jpg)'
- en: 'Once we have found the best run, we can deploy the model as a web service,
    either to ACI or AKS. To do this, we need to provide a scoring script and an environment
    configuration, in addition to the model that we want to deploy. Here is an example
    of code that can be used to deploy models:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们找到了最佳运行，我们可以将模型作为Web服务部署到ACI或AKS。为此，我们需要提供一个评分脚本和一个环境配置，以及我们想要部署的模型。以下是可以用于部署模型的示例代码：
- en: '![](img/4231a365-173d-4dcf-9d54-381308fe24b8.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4231a365-173d-4dcf-9d54-381308fe24b8.png)'
- en: 'When a model is deployed in production to AKS and monitoring is enabled, we
    can view insights on how our web service is performing. We can also add custom
    monitoring for our model. The following screenshot shows how the web service has
    performed over a few days:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 当模型在生产中部署到AKS并启用监控时，我们可以查看我们的Web服务性能的见解。我们还可以为我们的模型添加自定义监控。以下截图显示了Web服务在几天内的表现：
- en: '![](img/5fe13434-0bf9-41c6-baea-8b9db00c35b3.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5fe13434-0bf9-41c6-baea-8b9db00c35b3.png)'
- en: You can get more details about the Azure Machine Learning service at the following
    website: [https://docs.microsoft.com/en-us/azure/machine-learning/service/overview-what-is-azure-ml](https://docs.microsoft.com/en-us/azure/machine-learning/service/overview-what-is-azure-ml).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在以下网站上获取有关Azure机器学习服务的更多详细信息：[https://docs.microsoft.com/en-us/azure/machine-learning/service/overview-what-is-azure-ml](https://docs.microsoft.com/en-us/azure/machine-learning/service/overview-what-is-azure-ml)。
- en: You can also get sample notebooks to get started with the Azure Machine Learning
    SDK at the following website: [https://github.com/Azure/MachineLearningNotebooks](https://github.com/Azure/MachineLearningNotebooks).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以在以下网站上获取示例笔记本，以开始使用 Azure 机器学习 SDK：[https://github.com/Azure/MachineLearningNotebooks](https://github.com/Azure/MachineLearningNotebooks)。
- en: Summary
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we have learned about the new capabilities of the Azure Machine
    Learning service, which makes it easy to perform E2E machine learning. We have
    also learned how professional data scientists and DevOps engineers can benefit
    from the experimentation and model management capabilities of the Azure Machine
    Learning SDK.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了 Azure 机器学习服务的新功能，这使得执行端到端机器学习变得容易。我们还学习了专业数据科学家和 DevOps 工程师如何从 Azure
    机器学习 SDK 的实验和模型管理功能中受益。
