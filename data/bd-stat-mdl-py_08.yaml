- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: Discrete Models
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¦»æ•£æ¨¡å‹
- en: In the previous two chapters, we discussed models for predicting a continuous
    response variable. In this chapter, we will begin discussing models for predicting
    discrete response variables. We will start by discussing the probit and logit
    models for predicting binary outcome variables (categorical variables with two
    levels). Then, we will extend this idea to predicting categorical variables with
    multiple levels. Finally, we will look at predicting count variables, which are
    like categorical variables but only take values of integers and have an infinite
    number of levels.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å‰ä¸¤ä¸ªç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†é¢„æµ‹è¿ç»­å“åº”å˜é‡çš„æ¨¡å‹ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¼€å§‹è®¨è®ºé¢„æµ‹ç¦»æ•£å“åº”å˜é‡çš„æ¨¡å‹ã€‚æˆ‘ä»¬å°†é¦–å…ˆè®¨è®ºç”¨äºé¢„æµ‹äºŒå…ƒç»“æœå˜é‡ï¼ˆå…·æœ‰ä¸¤ä¸ªçº§åˆ«çš„åˆ†ç±»å˜é‡ï¼‰çš„
    probit å’Œ logit æ¨¡å‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¿™ä¸ªæƒ³æ³•æ‰©å±•åˆ°é¢„æµ‹å…·æœ‰å¤šä¸ªçº§åˆ«çš„åˆ†ç±»å˜é‡ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ¢è®¨é¢„æµ‹è®¡æ•°å˜é‡ï¼Œè¿™äº›å˜é‡ç±»ä¼¼äºåˆ†ç±»å˜é‡ï¼Œä½†åªå–æ•´æ•°å€¼ï¼Œå¹¶ä¸”æœ‰æ— é™å¤šä¸ªçº§åˆ«ã€‚
- en: 'In this chapter, weâ€™re going to cover the following main topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹ä¸»è¦ä¸»é¢˜ï¼š
- en: Probit and logit models
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Probit å’Œ logit æ¨¡å‹
- en: Multinomial logit model
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¤šé¡¹å¼ logit æ¨¡å‹
- en: Poisson model
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ³Šæ¾æ¨¡å‹
- en: The negative binomial regression model
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è´ŸäºŒé¡¹å¼å›å½’æ¨¡å‹
- en: Probit and logit models
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Probit å’Œ logit æ¨¡å‹
- en: Previously, we discussed different types of problems that can be solved with
    regression models. In particular, the dependent variable is continuous, such as
    house prices, salaries, and so on. A natural question is if dependent variables
    are not continuous â€“ in other words, if they are categorical â€“ how would we adapt
    our regression equation to predict a categorical response variable? For instance,
    a human resources department in a company wants to conduct an attrition study
    to predict whether an employee will stay with the company or a car dealership
    wants to know if one car can be sold or not based on prices, car models, colors,
    and so on.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¯ä»¥ç”¨å›å½’æ¨¡å‹è§£å†³çš„é—®é¢˜çš„ä¸åŒç±»å‹ã€‚ç‰¹åˆ«æ˜¯ï¼Œå› å˜é‡æ˜¯è¿ç»­çš„ï¼Œä¾‹å¦‚æˆ¿ä»·ã€è–ªæ°´ç­‰ã€‚ä¸€ä¸ªè‡ªç„¶çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœå› å˜é‡ä¸æ˜¯è¿ç»­çš„â€”â€”æ¢å¥è¯è¯´ï¼Œå¦‚æœå®ƒä»¬æ˜¯åˆ†ç±»çš„â€”â€”æˆ‘ä»¬å¦‚ä½•è°ƒæ•´æˆ‘ä»¬çš„å›å½’æ–¹ç¨‹æ¥é¢„æµ‹ä¸€ä¸ªåˆ†ç±»å“åº”å˜é‡ï¼Ÿä¾‹å¦‚ï¼Œä¸€å®¶å…¬å¸çš„äººåŠ›èµ„æºéƒ¨é—¨æƒ³è¦è¿›è¡Œå‘˜å·¥æµå¤±ç‡ç ”ç©¶ï¼Œä»¥é¢„æµ‹å‘˜å·¥æ˜¯å¦ä¼šç•™åœ¨å…¬å¸ï¼Œæˆ–è€…ä¸€å®¶æ±½è½¦ç»é”€å•†æƒ³è¦çŸ¥é“åŸºäºä»·æ ¼ã€è½¦å‹ã€é¢œè‰²ç­‰å› ç´ ï¼Œä¸€è¾†è½¦æ˜¯å¦èƒ½å¤Ÿå”®å‡ºã€‚
- en: 'First, we will study **binary classification**. Here, the outcome (dependent
    variable) is a binary response such as yes/no or to do/not to do. Letâ€™s look back
    at the simple linear regression model:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç ”ç©¶**äºŒå…ƒåˆ†ç±»**ã€‚åœ¨è¿™é‡Œï¼Œç»“æœï¼ˆå› å˜é‡ï¼‰æ˜¯ä¸€ä¸ªäºŒå…ƒå“åº”ï¼Œå¦‚æ˜¯/å¦æˆ–åš/ä¸åšã€‚è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ç®€å•çš„çº¿æ€§å›å½’æ¨¡å‹ï¼š
- en: y = Î²Â 0 + Î²Â 1 x+ Ïµ
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: y = Î²Â 0 + Î²Â 1 x+ Ïµ
- en: 'Here, the predicted outcome is a line crossing data points. With this model,
    we could build a model to predict house prices (the dependent variable) based
    on different independent variables, such as districts, units, stories, or distances.
    The same idea cannot be applied to a binary classification problem. Letâ€™s consider
    a simple example that we want to predict if a house is sold only based on its
    price. Letâ€™s build a model based on linear regression:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œé¢„æµ‹çš„ç»“æœæ˜¯ä¸€æ¡ç©¿è¿‡æ•°æ®ç‚¹çš„çº¿ã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œæ ¹æ®ä¸åŒçš„è‡ªå˜é‡ï¼ˆå¦‚åœ°åŒºã€å•å…ƒã€æ¥¼å±‚æˆ–è·ç¦»ï¼‰æ¥é¢„æµ‹æˆ¿ä»·ï¼ˆå› å˜é‡ï¼‰ã€‚åŒæ ·çš„æƒ³æ³•ä¸èƒ½åº”ç”¨äºäºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬åªæƒ³æ ¹æ®æˆ¿ä»·é¢„æµ‹æˆ¿å±‹æ˜¯å¦å”®å‡ºã€‚è®©æˆ‘ä»¬åŸºäºçº¿æ€§å›å½’æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼š
- en: Sold = Î²Â 0 + Î²Â 1 * Price + Ïµ (1)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Sold = Î²Â 0 + Î²Â 1 * Price + Ïµ (1)
- en: 'Here, Sold = 1 if the house is sold and Sold=0 if it was not sold. By performing
    visualization using linear regression, we can draw a line of best fit through
    the data points. It looks like when the price increases, the chance of selling
    a house decreases:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œå¦‚æœæˆ¿å±‹å”®å‡ºï¼ŒSold = 1ï¼Œå¦‚æœæ²¡æœ‰å”®å‡ºï¼ŒSold = 0ã€‚é€šè¿‡ä½¿ç”¨çº¿æ€§å›å½’è¿›è¡Œå¯è§†åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ç”»å‡ºç©¿è¿‡æ•°æ®ç‚¹çš„æœ€ä½³æ‹Ÿåˆçº¿ã€‚çœ‹èµ·æ¥å½“ä»·æ ¼å¢åŠ æ—¶ï¼Œæˆ¿å±‹å”®å‡ºçš„å¯èƒ½æ€§ä¼šé™ä½ï¼š
- en: '![Figure 8.1 â€“ Line of best fit using linear regression](img/B18945_08_01.jpg)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.1 â€“ ä½¿ç”¨çº¿æ€§å›å½’çš„æœ€ä½³æ‹Ÿåˆçº¿](img/B18945_08_01.jpg)'
- en: Figure 8.1 â€“ Line of best fit using linear regression
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.1 â€“ ä½¿ç”¨çº¿æ€§å›å½’çš„æœ€ä½³æ‹Ÿåˆçº¿
- en: 'So, instead of considering the equation model (*1*), we will be considering
    the following:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šè€ƒè™‘æ–¹ç¨‹æ¨¡å‹(*1*)ï¼Œè€Œæ˜¯è€ƒè™‘ä»¥ä¸‹å†…å®¹ï¼š
- en: Prob(Sold) = Î²Â 0 + Î²Â 1 * Price + Ïµ
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Prob(Sold) = Î²Â 0 + Î²Â 1 * Price + Ïµ
- en: 'Here, Prob(Sold) is the probability of selling a house. The probability value
    will be between 0 and 1; the midpoint of its range is 0.5 when the probability
    of selling a house is equal to the probability of not selling a house. However,
    when the price of a house is very high, then the value of Prob(Sold) can be negative.
    To avoid this problem, we can model the problem with the following equation:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼ŒProb(Sold) è¡¨ç¤ºå‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡ã€‚æ¦‚ç‡å€¼å°†åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼›å½“å‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡ç­‰äºä¸å‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡æ—¶ï¼Œå…¶èŒƒå›´çš„ä¸­é—´å€¼ä¸º 0.5ã€‚ç„¶è€Œï¼Œå½“æˆ¿å±‹ä»·æ ¼éå¸¸é«˜æ—¶ï¼ŒProb(Sold)
    çš„å€¼å¯ä»¥æ˜¯è´Ÿæ•°ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹ç¨‹æ¥å»ºæ¨¡é—®é¢˜ï¼š
- en: PÂ _Â 1 âˆ’ P = Î²Â 0 + Î²Â 1 * Price+ Ïµ (2)
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: P * (1 - P) = Î²_0 + Î²_1 * Price + Ïµ (2)
- en: 'Here, P is the probability of selling a house and 1 âˆ’ P is the probability
    of not selling a house. The value of Â PÂ _Â 1 âˆ’ P is in the range of [0, âˆ) and
    when the probability of selling a car is the same as the probability of not selling
    a car, (P=0.5), then Â PÂ _Â 1 âˆ’ P = 1, or the midpoint of its range is 1\. This
    is also called the **odds ratio**. To interpret the odds ratio, when Â PÂ _Â 1 âˆ’
    P = 1, for every house that is sold, there is a house that is not sold. When P
    = 0.75, then the odds ratio is 3\. In this case, the interpretation is that the
    odds of being able to sell the house are three times higher than the odds of not
    being able to sell the house. Going back to the equation (*2*), the range of the
    odds ratio is [0, âˆ) and its lower limit is 0, but as we discussed previously
    for equation (*1*), when the price of a house is really high, then the estimate
    of the odds ratio could be negative, which contradicts the probability properties.
    In addition, because the midpoint is 1 but the range of the odds ratio is from
    0 to infinity, then the distribution is very skewed with a long right tail. However,
    we expected it to be normally distributed per one of the assumptions of linear
    regression. So, instead of using equation (*2*), we will consider the following:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼ŒP æ˜¯å‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡ï¼Œ1 - P æ˜¯ä¸å‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡ã€‚P * (1 - P) çš„å€¼åœ¨ [0, âˆ) èŒƒå›´å†…ï¼Œå½“å‡ºå”®æ±½è½¦çš„æ¦‚ç‡ä¸ä¸å‡ºå”®æ±½è½¦çš„æ¦‚ç‡ç›¸åŒæ—¶ï¼Œ(P=0.5)ï¼Œåˆ™
    P * (1 - P) = 1ï¼Œæˆ–è€…å…¶èŒƒå›´çš„ä¸­é—´å€¼ä¸º 1ã€‚è¿™ä¹Ÿè¢«ç§°ä¸º **ä¼˜åŠ¿æ¯”**ã€‚è¦è§£é‡Šä¼˜åŠ¿æ¯”ï¼Œå½“ P * (1 - P) = 1 æ—¶ï¼Œå¯¹äºæ¯å‡ºå”®ä¸€æ ‹æˆ¿å±‹ï¼Œå°±æœ‰ä¸€æ ‹æˆ¿å±‹æœªå‡ºå”®ã€‚å½“
    P = 0.75 æ—¶ï¼Œä¼˜åŠ¿æ¯”ä¸º 3ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§£é‡Šæ˜¯èƒ½å¤Ÿå‡ºå”®æˆ¿å±‹çš„æ¦‚ç‡æ˜¯æœªèƒ½å‡ºå”®æˆ¿å±‹æ¦‚ç‡çš„ä¸‰å€ã€‚å›åˆ°æ–¹ç¨‹ (*2*)ï¼Œä¼˜åŠ¿æ¯”çš„èŒƒå›´æ˜¯ [0, âˆ)ï¼Œå…¶ä¸‹é™ä¸º
    0ï¼Œä½†æ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºæ–¹ç¨‹ (*1*) æ—¶æ‰€æŒ‡å‡ºçš„ï¼Œå½“æˆ¿å±‹ä»·æ ¼éå¸¸é«˜æ—¶ï¼Œä¼˜åŠ¿æ¯”çš„ä¼°è®¡å€¼å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œè¿™ä¸æ¦‚ç‡å±æ€§ç›¸çŸ›ç›¾ã€‚æ­¤å¤–ï¼Œç”±äºä¸­é—´å€¼ä¸º 1 ä½†ä¼˜åŠ¿æ¯”çš„èŒƒå›´æ˜¯ä»
    0 åˆ°æ— ç©·å¤§ï¼Œå› æ­¤åˆ†å¸ƒéå¸¸åæ–œï¼Œå³å°¾è¾ƒé•¿ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æœŸæœ›å®ƒç¬¦åˆçº¿æ€§å›å½’çš„ä¸€ä¸ªå‡è®¾ï¼Œå³æ­£æ€åˆ†å¸ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨æ–¹ç¨‹ (*2*)ï¼Œè€Œæ˜¯è€ƒè™‘ä»¥ä¸‹ï¼š
- en: log(Â PÂ _Â 1 âˆ’ P) = Î²Â 0 + Î²Â 1 * Price + Ïµ
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: log(odds) = log(P * (1 - P)) = Î²_0 + Î²_1 * Price + Ïµ
- en: 'The value of log(Â PÂ _Â 1 âˆ’ P) is in the range of (âˆ’ âˆ , âˆ) and the midpoint
    is 0\. Similar to linear regression, we can use the following formula:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: log(P * (1 - P)) çš„å€¼åœ¨ (-âˆ, âˆ) èŒƒå›´å†…ï¼Œä¸­é—´å€¼ä¸º 0ã€‚ç±»ä¼¼äºçº¿æ€§å›å½’ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼ï¼š
- en: log(odds) = log(Â PÂ _Â 1 âˆ’ P) = Î²Â 0 + Î²Â 1 XÂ 1 + Î²Â 2 XÂ 2 + â€¦ = z (3)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: log(odds) = log(P * (1 - P)) = Î²_0 + Î²_1 * X_1 + Î²_2 * X_2 + â€¦ = z (3)
- en: 'We can use this to interpret how the explanatory variables are associated with
    the categorical outcome. We can rewrite the previous equation (*3*) as follows:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ç”¨æ­¤æ¥è§£é‡Šè§£é‡Šå˜é‡ä¸åˆ†ç±»ç»“æœä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¹‹å‰çš„æ–¹ç¨‹ (*3*) é‡æ–°å†™ä¸ºä»¥ä¸‹å½¢å¼ï¼š
- en: F(z) = P = Â eÂ zÂ _Â 1 + eÂ zÂ ,
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: F(z) = P = e^(z - 1) + e^z,
- en: The preceding formula is bounded below by 0 and above by 1 (the predicted probability,
    *P*, of the outcome takes place) and is called the logit model. It is the cumulative
    distribution function of the **logistic distribution**.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: å‰é¢çš„å…¬å¼ä¸‹é™ä¸º 0ï¼Œä¸Šé™ä¸º 1ï¼ˆé¢„æµ‹ç»“æœå‘ç”Ÿçš„æ¦‚ç‡ *P*ï¼‰ï¼Œè¿™è¢«ç§°ä¸º logit æ¨¡å‹ã€‚å®ƒæ˜¯é€»è¾‘åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚
- en: 'Another approach to model the probability of a binary dependent variable is
    **probit regression**. Instead of using the cumulative distribution function of
    logistic regression, we use the cumulative distribution function of the standard
    normal distribution:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨¡å‹äºŒå…ƒå› å˜é‡çš„æ¦‚ç‡çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ **probit å›å½’**ã€‚æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œè€Œä¸æ˜¯é€»è¾‘å›å½’çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼š
- en: F(z) = Â âˆ«Â âˆ’âˆÂ zÏ•(u)du = Ï•(z).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: F(z) = âˆ«_{-âˆ}^z Ï•(u) du = Ï•(z)ã€‚
- en: 'The preceding formula is bounded below by 0 and above by 1 (the predicted probability,
    *P*, of the outcome takes place), and is called the **probit model**. Remember
    the following:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: å‰é¢çš„å…¬å¼ä¸‹é™ä¸º 0ï¼Œä¸Šé™ä¸º 1ï¼ˆé¢„æµ‹ç»“æœå‘ç”Ÿçš„æ¦‚ç‡ *P*ï¼‰ï¼Œè¿™è¢«ç§°ä¸º **probit æ¨¡å‹**ã€‚è®°ä½ä»¥ä¸‹ï¼š
- en: Ï•(z) = P(Z â‰¤ z), Z~ğ’©(0,1).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: Ï•(z) = P(Z â‰¤ z)ï¼Œå…¶ä¸­ Z ~ ğ’©(0,1)ã€‚
- en: Both the logit and probit models are estimated by using the `statsmodels`, we
    have classes for the probit and logit models. The documentation for these classes
    can be found at [https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Probit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Probit.xhtml)
    and [https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Logit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Logit.xhtml).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: logit å’Œ probit æ¨¡å‹éƒ½æ˜¯é€šè¿‡ä½¿ç”¨ `statsmodels` è¿›è¡Œä¼°è®¡çš„ï¼Œæˆ‘ä»¬æœ‰ probit å’Œ logit æ¨¡å‹çš„ç±»ã€‚è¿™äº›ç±»çš„æ–‡æ¡£å¯ä»¥åœ¨
    [https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Probit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Probit.xhtml)
    å’Œ [https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Logit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.Logit.xhtml)
    æ‰¾åˆ°ã€‚
- en: 'Now, letâ€™s create a training dataset to illustrate how to use the `Logit` class
    from `statsmodels` to conduct a logit study:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè®­ç»ƒæ•°æ®é›†æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ `statsmodels` ä¸­çš„ `Logit` ç±»è¿›è¡Œ logit ç ”ç©¶ï¼š
- en: '[PRE0]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here, `Admitted` is the dependent variable and has two possibilities (1 â€“ admitted
    and 0 â€“ not admitted). `GPA` is the GPA grade and `Exp` is the number of years
    of experience. The output of the preceding code is as follows:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œ`Admitted` æ˜¯å› å˜é‡ï¼Œæœ‰ä¸¤ç§å¯èƒ½æ€§ï¼ˆ1 â€“ è¢«å½•å–å’Œ 0 â€“ æœªå½•å–ï¼‰ã€‚`GPA` æ˜¯ GPA æˆç»©ï¼Œ`Exp` æ˜¯ç»éªŒå¹´æ•°ã€‚å‰é¢ä»£ç çš„è¾“å‡ºå¦‚ä¸‹ï¼š
- en: '![Figure 8.2 â€“ Training dataset on GPA grades and years of experience](img/B18945_08_002.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.2 â€“ GPA æˆç»©å’Œç»éªŒå¹´æ•°ä¸Šçš„è®­ç»ƒæ•°æ®é›†](img/B18945_08_002.jpg)'
- en: Figure 8.2 â€“ Training dataset on GPA grades and years of experience
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.2 â€“ GPA æˆç»©å’Œç»éªŒå¹´æ•°ä¸Šçš„è®­ç»ƒæ•°æ®é›†
- en: 'We must also create a testing dataset for this model:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¿…é¡»ä¸ºè¿™ä¸ªæ¨¡å‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ•°æ®é›†ï¼š
- en: '[PRE1]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The resulting output is as follows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: å¾—åˆ°çš„è¾“å‡ºå¦‚ä¸‹ï¼š
- en: '![Figure 8.3 â€“ Testing dataset on GPA grades and years of experience](img/B18945_08_003.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.3 â€“ GPA æˆç»©å’Œç»éªŒå¹´æ•°ä¸Šçš„æµ‹è¯•æ•°æ®é›†](img/B18945_08_003.jpg)'
- en: Figure 8.3 â€“ Testing dataset on GPA grades and years of experience
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.3 â€“ GPA æˆç»©å’Œç»éªŒå¹´æ•°ä¸Šçš„æµ‹è¯•æ•°æ®é›†
- en: 'We will use `logit` from `statsmodels`:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª `statsmodels` çš„ `logit`ï¼š
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This will print the following summary:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†æ‰“å°ä»¥ä¸‹æ‘˜è¦ï¼š
- en: '![Figure 8.4 â€“ Logit Regression Output](img/B18945_08_004.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.4 â€“ Logit å›å½’è¾“å‡º](img/B18945_08_004.jpg)'
- en: Figure 8.4 â€“ Logit Regression Output
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.4 â€“ Logit å›å½’è¾“å‡º
- en: From this output, we can see that `GPA` and `Exp` are significant at the Î± =
    0.05 significance level.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¿™ä¸ªè¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° `GPA` å’Œ `Exp` åœ¨ Î± = 0.05 çš„æ˜¾è‘—æ€§æ°´å¹³ä¸Šæ˜¯æ˜¾è‘—çš„ã€‚
- en: 'The values under the `[0.025 0.975]` heading are the 95% confidence interval
    for `Intercept`, `GPA`, and `Exp`, respectively. The next step is to use `confusion_matrix`
    and `accuracy_score` to compute the accuracy of the model on the test set:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '`[0.025 0.975]` ä¸‹çš„å€¼åˆ†åˆ«æ˜¯ `Intercept`ã€`GPA` å’Œ `Exp` çš„ 95% ç½®ä¿¡åŒºé—´ã€‚ä¸‹ä¸€æ­¥æ˜¯ä½¿ç”¨ `confusion_matrix`
    å’Œ `accuracy_score` æ¥è®¡ç®—æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š'
- en: '[PRE3]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The output is as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºå¦‚ä¸‹ï¼š
- en: '![Figure 8.5 â€“ Confusion matrix on testing dataset](img/B18945_08_005.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.5 â€“ æµ‹è¯•æ•°æ®é›†ä¸Šçš„æ··æ·†çŸ©é˜µ](img/B18945_08_005.jpg)'
- en: Figure 8.5 â€“ Confusion matrix on testing dataset
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.5 â€“ æµ‹è¯•æ•°æ®é›†ä¸Šçš„æ··æ·†çŸ©é˜µ
- en: By using these train and test datasets, the model can predict the outcome perfectly.
    In the next section, we will discuss **multi-class regression** using a similar
    idea as in binary logistic regression.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡ä½¿ç”¨è¿™äº›è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ï¼Œæ¨¡å‹å¯ä»¥å®Œç¾åœ°é¢„æµ‹ç»“æœã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä½¿ç”¨ä¸äºŒå…ƒé€»è¾‘å›å½’ç±»ä¼¼æ€æƒ³çš„**å¤šç±»å›å½’**ã€‚
- en: Multinomial logit model
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¤šé¡¹ logit æ¨¡å‹
- en: 'In practice, there are many situations where the outcomes (dependent variables)
    are not binary but have more than two possibilities. `MNLogit` class from `statsmodels`:
    [https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.MNLogit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.MNLogit.xhtml).'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å®è·µä¸­ï¼Œæœ‰è®¸å¤šæƒ…å†µä¸­ï¼Œç»“æœï¼ˆå› å˜é‡ï¼‰ä¸æ˜¯äºŒå…ƒçš„ï¼Œè€Œæ˜¯æœ‰è¶…è¿‡ä¸¤ç§å¯èƒ½æ€§ã€‚æ¥è‡ª `statsmodels` çš„ `MNLogit` ç±»ï¼š[https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.MNLogit.xhtml](https://www.statsmodels.org/dev/generated/statsmodels.discrete.discrete_model.MNLogit.xhtml)ã€‚
- en: 'Iris data ([https://archive.ics.uci.edu/ml/datasets/iris](https://archive.ics.uci.edu/ml/datasets/iris))
    is one of the best-known statistical and machine learning datasets for education.
    The independent variables are sepal length (in cm), sepal width (in cm), petal
    length (in cm), and petal width (in cm). The dependent variable is a categorical
    variable with three levels: Iris Setosa (0), Iris Versicolor (1), and Iris Virginia
    (2). The following Python codes illustrate how to conduct this using `sklearn`
    and `statsmodels`:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: çˆ±ä¸½ä¸æ•°æ®([https://archive.ics.uci.edu/ml/datasets/iris](https://archive.ics.uci.edu/ml/datasets/iris))æ˜¯æ•™è‚²ä¸­æœ€è‘—åçš„ç»Ÿè®¡å’Œæœºå™¨å­¦ä¹ æ•°æ®é›†ä¹‹ä¸€ã€‚è‡ªå˜é‡æ˜¯è¼ç‰‡é•¿åº¦ï¼ˆå˜ç±³ï¼‰ï¼Œè¼ç‰‡å®½åº¦ï¼ˆå˜ç±³ï¼‰ï¼ŒèŠ±ç“£é•¿åº¦ï¼ˆå˜ç±³ï¼‰å’ŒèŠ±ç“£å®½åº¦ï¼ˆå˜ç±³ï¼‰ã€‚å› å˜é‡æ˜¯ä¸€ä¸ªæœ‰ä¸‰ä¸ªçº§åˆ«çš„åˆ†ç±»å˜é‡ï¼šIris
    Setosaï¼ˆ0ï¼‰ï¼ŒIris Versicolorï¼ˆ1ï¼‰å’ŒIris Virginiaï¼ˆ2ï¼‰ã€‚ä»¥ä¸‹Pythonä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨`sklearn`å’Œ`statsmodels`è¿›è¡Œè¿™ä¸€æ“ä½œï¼š
- en: '[PRE4]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Both methods give us the same test accuracy value (96.67%), with the confusion
    matrix produced as follows:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸¤ç§æ–¹æ³•éƒ½ç»™å‡ºäº†ç›¸åŒçš„æµ‹è¯•å‡†ç¡®ç‡å€¼ï¼ˆ96.67%ï¼‰ï¼Œæ··æ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '![Figure 8.6 â€“ Confusion matrices using sklearn (left) and statsmodels (right)](img/B18945_08_06.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.6 â€“ ä½¿ç”¨sklearnï¼ˆå·¦ï¼‰å’Œstatsmodelsï¼ˆå³ï¼‰çš„æ··æ·†çŸ©é˜µ](img/B18945_08_06.jpg)'
- en: Figure 8.6 â€“ Confusion matrices using sklearn (left) and statsmodels (right)
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.6 â€“ ä½¿ç”¨sklearnï¼ˆå·¦ï¼‰å’Œstatsmodelsï¼ˆå³ï¼‰çš„æ··æ·†çŸ©é˜µ
- en: Poisson model
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ³Šæ¾æ¨¡å‹
- en: In the previous section, we discussed models where the response variable was
    categorical. In this section, we will look at a model for count data. Count data
    is like categorical data (the categories are integers), but there are an infinite
    number of levels (0, 1, 2, 3, and so on). We model count data with the **Poisson
    distribution**. In this section, we will start by examining the Poisson distribution
    and its properties. Then, we will model a count variable with explanatory variables
    using the Poisson model.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å“åº”å˜é‡ä¸ºåˆ†ç±»å˜é‡çš„æ¨¡å‹ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€ä¸ªé’ˆå¯¹è®¡æ•°æ•°æ®çš„æ¨¡å‹ã€‚è®¡æ•°æ•°æ®ç±»ä¼¼äºåˆ†ç±»æ•°æ®ï¼ˆç±»åˆ«ä¸ºæ•´æ•°ï¼‰ï¼Œä½†æ˜¯æœ‰æ— é™å¤šä¸ªçº§åˆ«ï¼ˆ0ã€1ã€2ã€3ç­‰ç­‰ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨**æ³Šæ¾åˆ†å¸ƒ**æ¥å»ºæ¨¡è®¡æ•°æ•°æ®ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆæ£€æŸ¥æ³Šæ¾åˆ†å¸ƒåŠå…¶æ€§è´¨ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ³Šæ¾æ¨¡å‹ç”¨è§£é‡Šå˜é‡å¯¹è®¡æ•°å˜é‡è¿›è¡Œå»ºæ¨¡ã€‚
- en: The Poisson distribution
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ³Šæ¾åˆ†å¸ƒ
- en: 'The Poisson distribution is given by the following formula:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: æ³Šæ¾åˆ†å¸ƒç”±ä»¥ä¸‹å…¬å¼ç»™å‡ºï¼š
- en: P(k) = Â Î»Â k eÂ âˆ’Î»Â _Â k !
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: P(k) = Î»^k e^(-Î») / k!
- en: Here, Î» is the average number of events and k is the number of events for which
    we would like the probability. P(k) is the probability that the k events occur.
    This distribution is used to calculate the probability of k events occurring in
    a fixed time interval or a defined space.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼ŒÎ»æ˜¯äº‹ä»¶çš„å¹³å‡æ•°é‡ï¼Œkæ˜¯æˆ‘ä»¬æƒ³è¦è®¡ç®—æ¦‚ç‡çš„äº‹ä»¶æ•°é‡ã€‚P(k)æ˜¯kä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ã€‚è¿™ä¸ªåˆ†å¸ƒç”¨äºè®¡ç®—åœ¨å›ºå®šæ—¶é—´é—´éš”æˆ–å®šä¹‰ç©ºé—´å†…å‘ç”Ÿkä¸ªäº‹ä»¶çš„æ¦‚ç‡ã€‚
- en: 'The shape of the distribution changes with the value of Î». When Î» is greater
    than 10, the distribution appears approximately normal. However, as Î» approaches
    0, the distribution becomes right-skewed. This is because count data cannot be
    negative. Three example Poisson distributions are shown in *Figure 8**.7* with
    means of 12, 5, and 2\. Notice that the distribution with the mean of 12 is approximately
    normally distributed, while the distributions of 5 and 2 are right-skewed:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å¸ƒçš„å½¢çŠ¶éšç€Î»å€¼çš„æ”¹å˜è€Œå˜åŒ–ã€‚å½“Î»å¤§äº10æ—¶ï¼Œåˆ†å¸ƒçœ‹èµ·æ¥è¿‘ä¼¼äºæ­£æ€åˆ†å¸ƒã€‚ç„¶è€Œï¼Œå½“Î»æ¥è¿‘0æ—¶ï¼Œåˆ†å¸ƒå˜å¾—å³åæ–œã€‚è¿™æ˜¯å› ä¸ºè®¡æ•°æ•°æ®ä¸èƒ½ä¸ºè´Ÿã€‚å›¾8.7*å±•ç¤ºäº†ä¸‰ä¸ªæ³Šæ¾åˆ†å¸ƒçš„ä¾‹å­ï¼Œå…¶å¹³å‡å€¼åˆ†åˆ«ä¸º12ã€5å’Œ2ã€‚æ³¨æ„ï¼Œå¹³å‡å€¼ä¸º12çš„åˆ†å¸ƒè¿‘ä¼¼äºæ­£æ€åˆ†å¸ƒï¼Œè€Œå¹³å‡å€¼ä¸º5å’Œ2çš„åˆ†å¸ƒåˆ™æ˜¯å³åæ–œçš„ï¼š
- en: '![Figure 8.7 â€“ Example Poisson distributions with means of 12, 5, and 2](img/B18945_08_007.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.7 â€“ å¹³å‡å€¼ä¸º12ã€5å’Œ2çš„æ³Šæ¾åˆ†å¸ƒç¤ºä¾‹](img/B18945_08_007.jpg)'
- en: Figure 8.7 â€“ Example Poisson distributions with means of 12, 5, and 2
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.7 â€“ å¹³å‡å€¼ä¸º12ã€5å’Œ2çš„æ³Šæ¾åˆ†å¸ƒç¤ºä¾‹
- en: Another interesting aspect of the distribution is that the mean and variance
    are equal. This means that as the mean increases, the spread of the distribution
    also increases. We can see this in action in the examples in *Figure 8**.7*. The
    distribution with a mean of 2 has a small spread with a large peak at the mean,
    while the distribution with a mean of 12 has a much wider spread with a lower
    peak at the mean.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†å¸ƒçš„å¦ä¸€ä¸ªæœ‰è¶£æ–¹é¢æ˜¯å‡å€¼å’Œæ–¹å·®ç›¸ç­‰ã€‚è¿™æ„å‘³ç€éšç€å‡å€¼çš„å¢åŠ ï¼Œåˆ†å¸ƒçš„åˆ†æ•£åº¦ä¹Ÿä¼šå¢åŠ ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å›¾8.7*çš„ä¾‹å­ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚å‡å€¼ä¸º2çš„åˆ†å¸ƒå…·æœ‰è¾ƒå°çš„åˆ†æ•£åº¦å’Œåœ¨å‡å€¼å¤„çš„å¤§å³°å€¼ï¼Œè€Œå‡å€¼ä¸º12çš„åˆ†å¸ƒå…·æœ‰æ›´å®½çš„åˆ†æ•£åº¦å’Œåœ¨å‡å€¼å¤„è¾ƒä½å³°å€¼ã€‚
- en: Now that we have discussed the Poisson distribution, letâ€™s look at how to set
    up a Poisson model.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºäº†æ³Šæ¾åˆ†å¸ƒï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è®¾ç½®æ³Šæ¾æ¨¡å‹ã€‚
- en: Modeling count data
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¡æ•°æ•°æ®å»ºæ¨¡
- en: 'Now, letâ€™s look at how to model the response variable of counts with the Poisson
    model. As mentioned previously, count data often follows a Poisson distribution.
    The Poisson model is expressed mathematically as follows:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ³Šæ¾æ¨¡å‹å¯¹è®¡æ•°å“åº”å˜é‡è¿›è¡Œå»ºæ¨¡ã€‚å¦‚å‰æ‰€è¿°ï¼Œè®¡æ•°æ•°æ®é€šå¸¸éµå¾ªæ³Šæ¾åˆ†å¸ƒã€‚æ³Šæ¾æ¨¡å‹ç”¨ä»¥ä¸‹æ•°å­¦å…¬å¼è¡¨ç¤ºï¼š
- en: y = eÂ bÂ 0+bÂ 1xÂ 1+â€¦+bÂ nxÂ n
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: y = e^bÂ 0 + bÂ 1xÂ 1 + â€¦ + bÂ nxÂ n
- en: 'Here, y is the response variable, b values are model coefficients, and x variables
    represent explanatory variables. This should appear similar to the equation we
    used in the previous chapter but with the addition of the exponentiation of the
    explanatory variables. This type of model is called a **log-linear** model, which
    is a model where the logarithm of the response variable is modeled by a linear
    combination of variables. We can rewrite this equation by applying the natural
    logarithm to both sides of the equation to make it explicit:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œyæ˜¯å“åº”å˜é‡ï¼Œbå€¼æ˜¯æ¨¡å‹ç³»æ•°ï¼Œxå˜é‡ä»£è¡¨è§£é‡Šå˜é‡ã€‚è¿™åº”è¯¥çœ‹èµ·æ¥ä¸æˆ‘ä»¬åœ¨ä¸Šä¸€ç« ä¸­ä½¿ç”¨çš„æ–¹ç¨‹å¼ç›¸ä¼¼ï¼Œä½†å¢åŠ äº†è§£é‡Šå˜é‡çš„æŒ‡æ•°ã€‚è¿™ç§ç±»å‹çš„æ¨¡å‹ç§°ä¸º**å¯¹æ•°çº¿æ€§**æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ç§å“åº”å˜é‡çš„å¯¹æ•°ç”±å˜é‡çš„çº¿æ€§ç»„åˆå»ºæ¨¡çš„æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æ–¹ç¨‹å¼çš„ä¸¤è¾¹åº”ç”¨è‡ªç„¶å¯¹æ•°æ¥é‡å†™æ­¤æ–¹ç¨‹ï¼Œä½¿å…¶æ›´æ˜ç¡®ï¼š
- en: ln(y) = bÂ 0 + bÂ 1 xÂ 1 + â€¦ + bÂ n xÂ n
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ln(y) = bÂ 0 + bÂ 1 xÂ 1 + â€¦ + bÂ n xÂ n
- en: Now, we have the logarithm of the response variable ( ln(y) ) expressed as a
    linear combination of explanatory variables.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬å°†å“åº”å˜é‡çš„å¯¹æ•°ï¼ˆln(y)ï¼‰è¡¨ç¤ºä¸ºè§£é‡Šå˜é‡çš„çº¿æ€§ç»„åˆã€‚
- en: The natural logarithm
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: è‡ªç„¶å¯¹æ•°
- en: 'The Poisson model uses a special logarithm called the natural logarithm. The
    natural logarithm of a number is the logarithm of that number using the mathematical
    constant e as the base. The natural logarithm is generally written as ln(x), logÂ e(x),
    or log(x) (the first two options are explicit, but the third option can be ambiguous).
    The logarithm operation is the inverse of exponentiation. In this case, the natural
    logarithm is the inverse of the exponential function: ln(eÂ x) = x = eÂ ln(x). The
    natural logarithm and exponential function are commonly used in statistics, mathematics,
    and science.'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: æ³Šæ¾æ¨¡å‹ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„å¯¹æ•°ï¼Œç§°ä¸ºè‡ªç„¶å¯¹æ•°ã€‚ä¸€ä¸ªæ•°çš„è‡ªç„¶å¯¹æ•°æ˜¯ä»¥æ•°å­¦å¸¸æ•°eä¸ºåº•çš„å¯¹æ•°ã€‚è‡ªç„¶å¯¹æ•°é€šå¸¸å†™ä½œln(x)ï¼Œlog_e(x)ï¼Œæˆ–log(x)ï¼ˆå‰ä¸¤ç§æ˜¯æ˜ç¡®çš„ï¼Œä½†ç¬¬ä¸‰ç§å¯èƒ½æ˜¯æœ‰æ­§ä¹‰çš„ï¼‰ã€‚å¯¹æ•°è¿ç®—æ˜¯å¯¹æ•°çš„é€†è¿ç®—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªç„¶å¯¹æ•°æ˜¯å¯¹æ•°å‡½æ•°çš„é€†ï¼šln(e^x)
    = x = e^ln(x)ã€‚è‡ªç„¶å¯¹æ•°å’Œå¯¹æ•°å‡½æ•°åœ¨ç»Ÿè®¡å­¦ã€æ•°å­¦å’Œç§‘å­¦ä¸­å¸¸ç”¨ã€‚
- en: 'Letâ€™s look at an example. We will be using the Bike Sharing Dataset from UCI
    ([https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset](https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset).).
    In this dataset, we have counts of bikes rented each day. There are two types
    of rentals: pre-registered (registered) and on-demand at a location (causal).
    In this example, we will model the weekly mean count of casually rented bikes
    over a given year. The dataset provides several explanatory variables, including
    environmental factors such as temperature and calendar information such as whether
    a holiday occurred.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬å°†ä½¿ç”¨UCIçš„å…±äº«å•è½¦æ•°æ®é›†([https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset](https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset))ã€‚åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬æœ‰æ¯å¤©ç§Ÿèµè‡ªè¡Œè½¦çš„æ•°é‡ã€‚æœ‰ä¸¤ç§ç§Ÿèµç±»å‹ï¼šé¢„å…ˆæ³¨å†Œï¼ˆæ³¨å†Œï¼‰å’ŒæŒ‰éœ€åœ¨åœ°ç‚¹ç§Ÿèµï¼ˆå› æœï¼‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹ç»™å®šå¹´ä»½çš„æ¯å‘¨å¹³å‡éšæ„ç§Ÿèµè‡ªè¡Œè½¦æ•°é‡è¿›è¡Œå»ºæ¨¡ã€‚æ•°æ®é›†æä¾›äº†å‡ ä¸ªè§£é‡Šå˜é‡ï¼ŒåŒ…æ‹¬ç¯å¢ƒå› ç´ ï¼Œå¦‚æ¸©åº¦ï¼Œä»¥åŠæ—¥å†ä¿¡æ¯ï¼Œå¦‚æ˜¯å¦ä¸ºå‡æ—¥ã€‚
- en: 'We will start by setting up the equation for our model and then take a look
    at the results from fitting the model with `statsmodels`. The model equation follows
    the form we discussed previously:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†é¦–å…ˆè®¾ç½®æ¨¡å‹æ–¹ç¨‹ï¼Œç„¶åæŸ¥çœ‹ä½¿ç”¨`statsmodels`æ‹Ÿåˆæ¨¡å‹çš„ç»“æœã€‚æ¨¡å‹æ–¹ç¨‹éµå¾ªæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„å½¢å¼ï¼š
- en: ln(weekly _ mean _ rental _ count) = bÂ 0 + bÂ 1(temperature) + bÂ 1(season)
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: ln(æ¯å‘¨_å¹³å‡_ç§Ÿèµ_æ•°é‡) = bÂ 0 + bÂ 1(æ¸©åº¦) + bÂ 1(å­£èŠ‚)
- en: + bÂ 2(weather _ situation) + bÂ 3(humidity) + bÂ 4(wind _ speed) + bÂ 5(holiday)
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: + bÂ 2(å¤©æ°”_æƒ…å†µ) + bÂ 3(æ¹¿åº¦) + bÂ 4(é£é€Ÿ) + bÂ 5(å‡æ—¥)
- en: 'We can fit this model with the given data using `statsmodels`, similar to how
    we did in the previous chapter. An excerpt of the code to fit the model is shown
    here (see the Jupyter Notebook for details on preprocessing):'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`statsmodels`æ ¹æ®ç»™å®šæ•°æ®æ‹Ÿåˆæ­¤æ¨¡å‹ï¼Œè¿™ä¸æˆ‘ä»¬åœ¨ä¸Šä¸€ç« ä¸­åšçš„æ–¹æ³•ç±»ä¼¼ã€‚æ‹Ÿåˆæ¨¡å‹çš„ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼ˆæœ‰å…³é¢„å¤„ç†è¯¦æƒ…ï¼Œè¯·å‚é˜…Jupyter
    Notebookï¼‰ï¼š
- en: '[PRE5]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'After fitting the model, we can get details on the coefficients using the `summary()`
    method. For this model, we get the following output for the coefficients:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¨¡å‹æ‹Ÿåˆå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`summary()`æ–¹æ³•è·å–ç³»æ•°çš„è¯¦ç»†ä¿¡æ¯ã€‚å¯¹äºè¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ç³»æ•°çš„è¾“å‡ºï¼š
- en: '![Figure 8.8 â€“ Poisson model summary](img/B18945_08_08.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.8 â€“ æ³Šæ¾æ¨¡å‹æ‘˜è¦](img/B18945_08_08.jpg)'
- en: Figure 8.8 â€“ Poisson model summary
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.8 â€“ æ³Šæ¾æ¨¡å‹æ‘˜è¦
- en: Just like the modeling example for linear regression, these coefficient values
    are estimates of the parameters listed in our model. All the explanatory variables
    in the model appear to be significant in the model. Interestingly, based on the
    value of the coefficient estimates, temperature (`atemp`) appears to be the most
    influential factor, followed by humidity (`hum`) and wind speed. With the model
    fit and no need to remove insignificant variables, we can assess the modelâ€™s performance.
    This model has an MAE of 155, which corresponds to a MAPE of 36%.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: å°±åƒçº¿æ€§å›å½’çš„å»ºæ¨¡ç¤ºä¾‹ä¸€æ ·ï¼Œè¿™äº›ç³»æ•°å€¼æ˜¯æˆ‘ä»¬æ¨¡å‹ä¸­åˆ—å‡ºçš„å‚æ•°çš„ä¼°è®¡å€¼ã€‚æ¨¡å‹ä¸­çš„æ‰€æœ‰è§£é‡Šå˜é‡åœ¨æ¨¡å‹ä¸­ä¼¼ä¹éƒ½æ˜¾è‘—ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ ¹æ®ç³»æ•°ä¼°è®¡å€¼ï¼Œæ¸©åº¦ï¼ˆ`atemp`ï¼‰ä¼¼ä¹æ˜¯æœ€æœ‰å½±å“åŠ›çš„å› ç´ ï¼Œå…¶æ¬¡æ˜¯æ¹¿åº¦ï¼ˆ`hum`ï¼‰å’Œé£é€Ÿã€‚ç”±äºæ¨¡å‹æ‹Ÿåˆè‰¯å¥½ä¸”æ— éœ€åˆ é™¤ä¸æ˜¾è‘—çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥è¯„ä¼°æ¨¡å‹çš„è¡¨ç°ã€‚æ­¤æ¨¡å‹å…·æœ‰155çš„MAEï¼Œå¯¹åº”äº36%çš„MAPEã€‚
- en: The Poisson model depends strongly on the assumption that the response variable
    has a Poisson distribution. In the next section, we will look at a similar type
    of model for count data, but with weaker distributional assumptions.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: æ³Šæ¾æ¨¡å‹å¼ºçƒˆä¾èµ–äºå“åº”å˜é‡å…·æœ‰æ³Šæ¾åˆ†å¸ƒçš„å‡è®¾ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹ä¸€ä¸ªç±»ä¼¼ç±»å‹çš„è®¡æ•°æ•°æ®æ¨¡å‹ï¼Œä½†å…·æœ‰è¾ƒå¼±çš„åˆ†å¸ƒå‡è®¾ã€‚
- en: The negative binomial regression model
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è´ŸäºŒé¡¹å›å½’æ¨¡å‹
- en: Another useful approach to **discrete regression** is the **log-linear negative
    binomial regression** model, which uses the negative binomial probability distribution.
    At a high level, negative binomial regression is useful with *over-dispersed count
    data* where the *conditional mean of the count is smaller than the conditional
    variance of the count*. Model **over-dispersion** is where the variance of the
    target variable is greater than the mean assumed by the model. In a regression
    model, the mean is the regression line. We make the determination of using the
    negative binomial model based on target variable counts analysis (mean versus
    variance) and supply a measure of model over-dispersion to the negative binomial
    model to adjust for the over-dispersion, which we will discuss here.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ç§æœ‰ç”¨çš„**ç¦»æ•£å›å½’**æ–¹æ³•æ˜¯**å¯¹æ•°çº¿æ€§è´ŸäºŒé¡¹å›å½’**æ¨¡å‹ï¼Œå®ƒä½¿ç”¨è´ŸäºŒé¡¹æ¦‚ç‡åˆ†å¸ƒã€‚ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼Œè´ŸäºŒé¡¹å›å½’å¯¹äº**è¿‡åº¦åˆ†æ•£çš„è®¡æ•°æ•°æ®**å¾ˆæœ‰ç”¨ï¼Œå…¶ä¸­**è®¡æ•°æ¡ä»¶å‡å€¼**å°äº**è®¡æ•°æ¡ä»¶æ–¹å·®**ã€‚æ¨¡å‹**è¿‡åº¦åˆ†æ•£**æ˜¯æŒ‡ç›®æ ‡å˜é‡çš„æ–¹å·®å¤§äºæ¨¡å‹å‡è®¾çš„å‡å€¼ã€‚åœ¨å›å½’æ¨¡å‹ä¸­ï¼Œå‡å€¼æ˜¯å›å½’çº¿ã€‚æˆ‘ä»¬æ ¹æ®ç›®æ ‡å˜é‡è®¡æ•°åˆ†æï¼ˆå‡å€¼ä¸æ–¹å·®ï¼‰æ¥å†³å®šä½¿ç”¨è´ŸäºŒé¡¹æ¨¡å‹ï¼Œå¹¶å‘è´ŸäºŒé¡¹æ¨¡å‹æä¾›ä¸€ä¸ªåº¦é‡æ¨¡å‹è¿‡åº¦åˆ†æ•£çš„é‡ï¼Œä»¥è°ƒæ•´è¿‡åº¦åˆ†æ•£ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢è®¨è®ºè¿™ä¸€ç‚¹ã€‚
- en: It is important to note that the negative binomial model is not for modeling
    simply discrete data, but specifically **count data** associated with a fixed
    number of **random** trials, such as modeling the number of attempts before an
    event occurs â€“ or failing to occur â€“ in a random sampling scenario. The model
    operates only on count data, where each count response of the target variable
    is based on a finite set of outcomes. Additionally, because the count data is
    the result of repeated binomial trials, the order of count arrangement does not
    matter.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œè´ŸäºŒé¡¹æ¨¡å‹ä¸ä»…ç”¨äºå»ºæ¨¡ç®€å•çš„ç¦»æ•£æ•°æ®ï¼Œè€Œæ˜¯ä¸“é—¨ç”¨äºä¸å›ºå®šæ•°é‡çš„**éšæœº**è¯•éªŒç›¸å…³çš„**è®¡æ•°æ•°æ®**ï¼Œä¾‹å¦‚åœ¨éšæœºæŠ½æ ·åœºæ™¯ä¸­å»ºæ¨¡äº‹ä»¶å‘ç”Ÿå‰ï¼ˆæˆ–æœªå‘ç”Ÿï¼‰çš„å°è¯•æ¬¡æ•°ã€‚è¯¥æ¨¡å‹ä»…å¯¹è®¡æ•°æ•°æ®è¿›è¡Œæ“ä½œï¼Œå…¶ä¸­ç›®æ ‡å˜é‡çš„æ¯ä¸ªè®¡æ•°å“åº”éƒ½åŸºäºæœ‰é™çš„ç»“æœé›†ã€‚æ­¤å¤–ï¼Œç”±äºè®¡æ•°æ•°æ®æ˜¯é‡å¤çš„äºŒé¡¹è¯•éªŒçš„ç»“æœï¼Œè®¡æ•°æ’åˆ—çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚
- en: Negative binomial distribution
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è´ŸäºŒé¡¹åˆ†å¸ƒ
- en: 'The following is an example of the negative binomial distribution of failure
    counts with a conditional mean of 17 and a conditional variance of 52:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹æ˜¯ä¸€ä¸ªè´ŸäºŒé¡¹åˆ†å¸ƒçš„å¤±è´¥è®¡æ•°ç¤ºä¾‹ï¼Œæ¡ä»¶å‡å€¼ä¸º17ï¼Œæ¡ä»¶æ–¹å·®ä¸º52ï¼š
- en: '![Figure 8.9 â€“ Negative binomial distribution example](img/B18945_08_009.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.9 â€“ è´ŸäºŒé¡¹åˆ†å¸ƒç¤ºä¾‹](img/B18945_08_009.jpg)'
- en: Figure 8.9 â€“ Negative binomial distribution example
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.9 â€“ è´ŸäºŒé¡¹åˆ†å¸ƒç¤ºä¾‹
- en: 'The binomial distribution is a construct of counts of successes in a fixed
    count of random trials (X = ( XÂ 1, XÂ 2, â€¦ )) of a Bernoulli random variable, which
    is a variable that has one of two outcome values: 0 or 1\. The negative binomial
    distribution is a construct of the count of failures in a fixed count of random
    draws of the Bernoulli random variable. This distinction is important because
    a model using binomial regression models a binary outcome across observations,
    whereas a negative binomial regression model models a count outcome across observations.
    The negative binomial distribution is the inverse of the binomial distribution.
    The probability mass function for the negative binomial distribution is as follows:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: äºŒé¡¹åˆ†å¸ƒæ˜¯å›ºå®šæ¬¡æ•°éšæœºè¯•éªŒï¼ˆX = ( XÂ 1, XÂ 2, â€¦ ))ä¸­ä¼¯åŠªåˆ©éšæœºå˜é‡æˆåŠŸæ¬¡æ•°çš„æ„å»ºï¼Œä¼¯åŠªåˆ©éšæœºå˜é‡æ˜¯ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªç»“æœå€¼ï¼š0 æˆ– 1 çš„å˜é‡ã€‚è´ŸäºŒé¡¹åˆ†å¸ƒæ˜¯ä¼¯åŠªåˆ©éšæœºå˜é‡å›ºå®šæ¬¡æ•°éšæœºæŠ½å–çš„å¤±è´¥æ¬¡æ•°çš„æ„å»ºã€‚è¿™ç§åŒºåˆ«å¾ˆé‡è¦ï¼Œå› ä¸ºä½¿ç”¨äºŒé¡¹å›å½’æ¨¡å‹çš„æ¨¡å‹åœ¨è§‚æµ‹ä¹‹é—´å»ºæ¨¡äºŒå…ƒç»“æœï¼Œè€Œè´ŸäºŒé¡¹å›å½’æ¨¡å‹åœ¨è§‚æµ‹ä¹‹é—´å»ºæ¨¡è®¡æ•°ç»“æœã€‚è´ŸäºŒé¡¹åˆ†å¸ƒæ˜¯äºŒé¡¹åˆ†å¸ƒçš„é€†ã€‚è´ŸäºŒé¡¹åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°å¦‚ä¸‹ï¼š
- en: P(X âˆ’ x) = (x + n âˆ’ 1Â n âˆ’ 1Â ) pÂ n (1 âˆ’ p)Â x
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: P(X âˆ’ x) = (x + n âˆ’ 1Â n âˆ’ 1Â ) pÂ n (1 âˆ’ p)Â x
- en: Here, there are x failures and n âˆ’ 1 successes in a set of x + n âˆ’ 1 trials
    reaching success at trial x + n.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæœ‰ä¸€ç»„ x + n âˆ’ 1 æ¬¡è¯•éªŒï¼Œå…¶ä¸­ x æ¬¡å¤±è´¥å’Œ n âˆ’ 1 æ¬¡æˆåŠŸï¼Œåœ¨ç¬¬ x + n æ¬¡è¯•éªŒä¸­è¾¾åˆ°æˆåŠŸã€‚
- en: 'Concerning the Poisson distribution, the negative binomial *does not require
    strict adherence to the assumption that conditional variance is equal to the conditional
    mean* as it includes an additional parameter, *Î±*, to explain the extra variance,
    whereas the Poisson model assumes the variance is equal to the mean, *Î¼*. The
    negative binomial model assumes the variance, here based on the Poisson-gamma
    mixture distribution, is equal to the following:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: å…³äºæ³Šæ¾åˆ†å¸ƒï¼Œè´ŸäºŒé¡¹åˆ†å¸ƒ*ä¸éœ€è¦ä¸¥æ ¼éµå¾ªæ¡ä»¶æ–¹å·®ç­‰äºæ¡ä»¶å‡å€¼çš„å‡è®¾*ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸€ä¸ªé¢å¤–çš„å‚æ•° *Î±* æ¥è§£é‡Šé¢å¤–çš„æ–¹å·®ï¼Œè€Œæ³Šæ¾æ¨¡å‹å‡è®¾æ–¹å·®ç­‰äºå‡å€¼ *Î¼*ã€‚è´ŸäºŒé¡¹æ¨¡å‹å‡è®¾æ–¹å·®ï¼Œæ­¤å¤„åŸºäºæ³Šæ¾-ä¼½é©¬æ··åˆåˆ†å¸ƒï¼Œç­‰äºä»¥ä¸‹ï¼š
- en: Î¼(1 + Î±Î¼)
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: Î¼(1 + Î±Î¼)
- en: 'This reduces to the following:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç®€åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼š
- en: (Î¼ + Î± Î¼Â 2)
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: (Î¼ + Î± Î¼Â 2)
- en: 'Stated in terms of the probability of success, *p*, the negative binomial variance
    is calculated as follows:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆåŠŸæ¦‚ç‡ *p* æ¥è¡¨è¿°ï¼Œè´ŸäºŒé¡¹åˆ†å¸ƒçš„æ–¹å·®è®¡ç®—å¦‚ä¸‹ï¼š
- en: n Â 1 âˆ’ pÂ _Â pÂ 2
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: n Â 1 âˆ’ pÂ _Â pÂ 2
- en: 'It has the following mean:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒå…·æœ‰ä»¥ä¸‹å‡å€¼ï¼š
- en: n Â 1 âˆ’ pÂ _Â p
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: n Â 1 âˆ’ pÂ _Â p
- en: 'Because the variance is not expected to equal the mean with the negative binomial
    model, the negative binomial is likely to outperform the Poisson approach *when
    the counts are large enough that the variance in response exceeds the mean*. Similarly,
    to Poisson, a negative binomial is a log-linear model with confidence intervals
    being based on the Wald and drop-in-deviance likelihood ratio. The form of the
    negative binomial modelâ€™s regression equation, shown here, is the same as that
    for Poisson regression:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè´ŸäºŒé¡¹æ¨¡å‹ä¸­æ–¹å·®ä¸ä¸€å®šç­‰äºå‡å€¼ï¼Œå› æ­¤å½“è®¡æ•°è¶³å¤Ÿå¤§ï¼Œå“åº”çš„æ–¹å·®è¶…è¿‡å‡å€¼æ—¶ï¼Œè´ŸäºŒé¡¹åˆ†å¸ƒå¯èƒ½ä¼˜äºæ³Šæ¾æ–¹æ³•ã€‚åŒæ ·ï¼Œä¸æ³Šæ¾ä¸€æ ·ï¼Œè´ŸäºŒé¡¹åˆ†å¸ƒæ˜¯ä¸€ä¸ªå¯¹æ•°çº¿æ€§æ¨¡å‹ï¼Œç½®ä¿¡åŒºé—´åŸºäº
    Wald å’Œ drop-in-deviance ä¼¼ç„¶æ¯”ã€‚è´ŸäºŒé¡¹åˆ†å¸ƒå›å½’æ–¹ç¨‹çš„å½¢å¼ï¼Œå¦‚æ­¤å¤„æ‰€ç¤ºï¼Œä¸æ³Šæ¾å›å½’ç›¸åŒï¼š
- en: ln(y) = bÂ 0 + bÂ 1 xÂ 1 + â€¦ + bÂ n xÂ n
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: ln(y) = bÂ 0 + bÂ 1 xÂ 1 + â€¦ + bÂ n xÂ n
- en: 'It reduces to the following:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒç®€åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼š
- en: y = eÂ bÂ 0 + eÂ bÂ 1xÂ 1 + â€¦ + eÂ bÂ nxÂ n
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: y = eÂ bÂ 0 + eÂ bÂ 1xÂ 1 + â€¦ + eÂ bÂ nxÂ n
- en: 'The **maximum likelihood estimate** of the probability of success for a given
    sample of the distribution is as follows:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåˆ†å¸ƒçš„ç»™å®šæ ·æœ¬ï¼ŒæˆåŠŸæ¦‚ç‡çš„**æœ€å¤§ä¼¼ç„¶ä¼°è®¡**å¦‚ä¸‹ï¼š
- en: nÂ _Â n + Â _Â xÂ Â â€²
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: nÂ _Â n + Â _Â xÂ Â â€²
- en: Maximum likelihood estimation
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€å¤§ä¼¼ç„¶ä¼°è®¡
- en: '**Maximum likelihood estimation** (**MLE**) is an underpinning of the log-odds
    (or logit) and log-likelihood approaches to statistical modeling. Likelihood is
    the probability of the known outcome of a regression model being observed given
    specific regression coefficient values. By default, a set of variables will have
    a higher likelihood than another set of variables if the set provides a higher
    probability of the observed outcome being obtained. The logarithm of the likelihood
    is taken as a measure of goodness-of-fit for a regression model. Out of a set
    of potential coefficient values for each variable, the set of coefficients with
    the maximum log-likelihood values for each variable are referred to as the **maximum
    likelihood estimates**. These values are obtained through an iterative approach
    that generates multiple possible values. If the sample size is sufficiently large
    and an appropriate set of variables has been obtained for the model, the maximum
    likelihood estimates can be considered unbiased.'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**æœ€å¤§ä¼¼ç„¶ä¼°è®¡**ï¼ˆ**MLE**ï¼‰æ˜¯ç»Ÿè®¡å»ºæ¨¡ä¸­å¯¹æ•°ä¼˜åŠ¿ï¼ˆæˆ–logitï¼‰å’Œå¯¹æ•°ä¼¼ç„¶æ–¹æ³•çš„åŸºç¡€ã€‚ä¼¼ç„¶æ˜¯åœ¨ç»™å®šç‰¹å®šçš„å›å½’ç³»æ•°å€¼çš„æƒ…å†µä¸‹ï¼Œè§‚å¯Ÿåˆ°çš„å›å½’æ¨¡å‹å·²çŸ¥ç»“æœçš„æ¦‚ç‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ç»„å˜é‡æ¯”å¦ä¸€ç»„å˜é‡æä¾›æ›´é«˜çš„è§‚å¯Ÿç»“æœæ¦‚ç‡ï¼Œåˆ™è¯¥ç»„å˜é‡å°†å…·æœ‰æ›´é«˜çš„ä¼¼ç„¶ã€‚ä¼¼ç„¶çš„å¯¹æ•°è¢«ç”¨ä½œå›å½’æ¨¡å‹æ‹Ÿåˆä¼˜åº¦çš„åº¦é‡ã€‚å¯¹äºæ¯ä¸ªå˜é‡çš„æ½œåœ¨ç³»æ•°å€¼é›†åˆï¼Œå…·æœ‰æ¯ä¸ªå˜é‡æœ€å¤§å¯¹æ•°ä¼¼ç„¶å€¼çš„ç³»æ•°é›†åˆè¢«ç§°ä¸º**æœ€å¤§ä¼¼ç„¶ä¼°è®¡**ã€‚è¿™äº›å€¼æ˜¯é€šè¿‡è¿­ä»£æ–¹æ³•è·å¾—çš„ï¼Œè¯¥æ–¹æ³•ç”Ÿæˆå¤šä¸ªå¯èƒ½çš„å€¼ã€‚å¦‚æœæ ·æœ¬é‡è¶³å¤Ÿå¤§ï¼Œå¹¶ä¸”å·²ç»ä¸ºæ¨¡å‹è·å¾—äº†ä¸€ç»„é€‚å½“çš„å˜é‡ï¼Œåˆ™æœ€å¤§ä¼¼ç„¶ä¼°è®¡å¯ä»¥è¢«è®¤ä¸ºæ˜¯æ— åçš„ã€‚'
- en: 'Calculating the confidence intervals for negative binomial regression is similar
    to that for logistic regression. The **Wald** approach to the calculation leverages
    a **z-ratio**. Where there are *j* variables in the model, the z-ratio is calculated
    as follows:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—è´ŸäºŒé¡¹å›å½’çš„ç½®ä¿¡åŒºé—´ä¸é€»è¾‘å›å½’ç±»ä¼¼ã€‚è®¡ç®—ä¸­ä½¿ç”¨çš„**Wald**æ–¹æ³•åˆ©ç”¨äº†**zæ¯”ç‡**ã€‚åœ¨æ¨¡å‹ä¸­æœ‰*j*ä¸ªå˜é‡æ—¶ï¼Œzæ¯”ç‡è®¡ç®—å¦‚ä¸‹ï¼š
- en: ( Â Ë†Â Î²Â Â jâˆ’ Î²Â j)Â _Â SE( Â Ë†Â Î²Â Â j)
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ( Ë†Î²j âˆ’ Î²j) _ SE( Ë†Î²j)
- en: 'Here, *SE* is the standard error. The confidence interval is the variableâ€™s
    coefficient estimate plus and minus the half-width confidence interval percentile
    multiplied by the standard error of the coefficient estimate. The z-ratio can
    be used because it is assumed the estimates have standard normal sampling distributions.
    Therefore, we can derive the 95% confidence interval for the variableâ€™s estimated
    coefficient as follows:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œ*SE*æ˜¯æ ‡å‡†è¯¯å·®ã€‚ç½®ä¿¡åŒºé—´æ˜¯å˜é‡çš„ç³»æ•°ä¼°è®¡å€¼åŠ å‡åŠå®½ç½®ä¿¡åŒºé—´ç™¾åˆ†ä½æ•°ä¹˜ä»¥ç³»æ•°ä¼°è®¡å€¼çš„æ ‡å‡†è¯¯å·®ã€‚å¯ä»¥ä½¿ç”¨zæ¯”ç‡ï¼Œå› ä¸ºå‡è®¾ä¼°è®¡å€¼å…·æœ‰æ ‡å‡†æ­£æ€æŠ½æ ·åˆ†å¸ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºå˜é‡çš„ä¼°è®¡ç³»æ•°çš„95%ç½®ä¿¡åŒºé—´å¦‚ä¸‹ï¼š
- en: 'Lower 95% confidence limit:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é™95%ç½®ä¿¡é™ï¼š
- en: Ë†Â Î²Â Â j âˆ’ 0.475 Ã— SE(Â Ë†Â Î²Â Â j)
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: Ë†Î²j âˆ’ 0.475 Ã— SE( Ë†Î²j)
- en: 'Upper 95% confidence limit:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šé™95%ç½®ä¿¡é™ï¼š
- en: Ë†Â Î²Â Â j + 0.475 Ã— SE(Â Ë†Â Î²Â Â j)
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: Ë†Î²j + 0.475 Ã— SE( Ë†Î²j)
- en: 'There are three required assumptions specific to negative binomial regression:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: è´ŸäºŒé¡¹å›å½’æœ‰ä¸‰ä¸ªç‰¹å®šçš„å‡è®¾è¦æ±‚ï¼š
- en: Independence between samples.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ ·æœ¬é—´çš„ç‹¬ç«‹æ€§ã€‚
- en: A linear relationship between the log of the target variable and input variables
    (log-linear model).
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç›®æ ‡å˜é‡çš„å¯¹æ•°ä¸è¾“å…¥å˜é‡ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»ï¼ˆå¯¹æ•°çº¿æ€§æ¨¡å‹ï¼‰ã€‚
- en: Conditional variance is greater than or equal to the conditional mean.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¡ä»¶æ–¹å·®å¤§äºæˆ–ç­‰äºæ¡ä»¶å‡å€¼ã€‚
- en: Independence between samples means there is no serial correlation nor any cluster
    or other conditional dependence between samples. A linear relationship between
    the log of the target variable and input variables means that the relationship
    between the logarithm of the target variable and changes in each input variable
    scales linearly. Except for requirement 3, which we discussed at the start of
    this section, the requirements are essentially the same as for the Poisson model.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: æ ·æœ¬é—´çš„ç‹¬ç«‹æ€§æ„å‘³ç€æ²¡æœ‰åºåˆ—ç›¸å…³æ€§ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ ·æœ¬é—´çš„èšç±»æˆ–å…¶ä»–æ¡ä»¶ä¾èµ–æ€§ã€‚ç›®æ ‡å˜é‡çš„å¯¹æ•°ä¸è¾“å…¥å˜é‡ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»æ„å‘³ç€ç›®æ ‡å˜é‡å¯¹æ•°çš„å¯¹æ•°ä¸æ¯ä¸ªè¾“å…¥å˜é‡çš„å˜åŒ–ä¹‹é—´çš„å…³ç³»æ˜¯çº¿æ€§ç¼©æ”¾çš„ã€‚é™¤äº†æˆ‘ä»¬åœ¨æœ¬èŠ‚å¼€å¤´è®¨è®ºçš„ç¬¬3ä¸ªè¦æ±‚å¤–ï¼Œå…¶ä»–è¦æ±‚åŸºæœ¬ä¸Šä¸æ³Šæ¾æ¨¡å‹ç›¸åŒã€‚
- en: 'Letâ€™s walk through an example in Python using statsmodels. For this, letâ€™s
    load the statsmodels affairs dataset to model child count (the `children` variable)
    using the remaining variables. In line three, we must add the constant required
    to generate an intercept coefficient:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡Pythonä¸­çš„statsmodelsåº“æ¥ä¸¾ä¸€ä¸ªä¾‹å­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½statsmodelsåº“ä¸­çš„affairsæ•°æ®é›†ï¼Œä½¿ç”¨å‰©ä½™å˜é‡æ¥å»ºæ¨¡å„¿ç«¥æ•°é‡ï¼ˆ`children`å˜é‡ï¼‰ã€‚åœ¨ç¬¬ä¸‰è¡Œï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ ç”Ÿæˆæˆªè·ç³»æ•°æ‰€éœ€çš„å¸¸æ•°ï¼š
- en: '[PRE6]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'First, letâ€™s numerically confirm there is over-dispersion present in the target
    variable:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬é€šè¿‡æ•°å€¼æ–¹æ³•ç¡®è®¤ç›®æ ‡å˜é‡ä¸­å­˜åœ¨è¿‡åº¦ç¦»æ•£ï¼š
- en: '[PRE7]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We can see the variance is greater than the mean:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–¹å·®å¤§äºå‡å€¼ï¼š
- en: '`Mean count of children per marriage:` `1.3968740182218033`'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '`æ¯å¯¹å©šå§»çš„å¹³å‡å­©å­æ•°:` `1.3968740182218033`'
- en: '`Variance of the count of children per marriage:` `2.054838616333698`'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '`æ¯å¯¹å©šå§»å­©å­æ•°çš„æ–¹å·®:` `2.054838616333698`'
- en: 'Here, we can see that the conditional mean per marriage is smaller than the
    conditional variance. While not a massive difference, it is enough to consider
    using negative binomial regression. Letâ€™s visually observe the distribution of
    the response:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯å¯¹å©šå§»çš„æ¡ä»¶å‡å€¼å°äºæ¡ä»¶æ–¹å·®ã€‚è™½ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå·¨å¤§çš„å·®å¼‚ï¼Œä½†è¶³ä»¥è€ƒè™‘ä½¿ç”¨è´ŸäºŒé¡¹å¼å›å½’ã€‚è®©æˆ‘ä»¬ç›´è§‚åœ°è§‚å¯Ÿå“åº”çš„åˆ†å¸ƒï¼š
- en: '![Figure 8.10 â€“ Distribution of children](img/B18945_08_010.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.10 â€“ å­©å­çš„åˆ†å¸ƒ](img/B18945_08_010.jpg)'
- en: Figure 8.10 â€“ Distribution of children
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.10 â€“ å­©å­çš„åˆ†å¸ƒ
- en: 'The first five rows of the data can be seen here. Note that the first column
    of the design matrix should always contain the constant:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æ•°æ®çš„å‰äº”è¡Œã€‚è¯·æ³¨æ„ï¼Œè®¾è®¡çŸ©é˜µçš„ç¬¬ä¸€åˆ—åº”å§‹ç»ˆåŒ…å«å¸¸æ•°ï¼š
- en: '![Figure 8.11 â€“ First five records of example data set, including the added
    constant](img/B18945_08_11.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾8.11 â€“ ç¤ºä¾‹æ•°æ®é›†çš„å‰äº”æ¡è®°å½•ï¼ŒåŒ…æ‹¬æ·»åŠ çš„å¸¸æ•°](img/B18945_08_11.jpg)'
- en: Figure 8.11 â€“ First five records of example data set, including the added constant
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾8.11 â€“ ç¤ºä¾‹æ•°æ®é›†çš„å‰äº”æ¡è®°å½•ï¼ŒåŒ…æ‹¬æ·»åŠ çš„å¸¸æ•°
- en: 'In our visual inspection of the distribution of children in *Figure 8**.10*,
    we identified that there is a value of 5.5 for children. This may be the result
    of averaging or an error. A subject matter expert may help determine this, but
    for our analysis, letâ€™s assume it was a mistake and round to a whole number of
    children since people are not fractional. Letâ€™s set up the target array, *y*,
    and design matrix, *X*:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä»¬å¯¹*å›¾8**.10*ä¸­å­©å­åˆ†å¸ƒçš„è§†è§‰æ£€æŸ¥ä¸­ï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºå­©å­çš„å€¼ä¸º5.5ã€‚è¿™å¯èƒ½æ˜¯ç”±å¹³å‡å€¼è®¡ç®—æˆ–é”™è¯¯å¯¼è‡´çš„ã€‚ä¸€ä¸ªä¸»é¢˜ä¸“å®¶å¯èƒ½æœ‰åŠ©äºç¡®å®šè¿™ä¸€ç‚¹ï¼Œä½†ä¸ºäº†æˆ‘ä»¬çš„åˆ†æï¼Œè®©æˆ‘ä»¬å‡è®¾è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶å°†å­©å­æ•°å››èˆäº”å…¥åˆ°æ•´æ•°ï¼Œå› ä¸ºäººä»¬ä¸æ˜¯åˆ†æ•°ã€‚è®©æˆ‘ä»¬è®¾ç½®ç›®æ ‡æ•°ç»„*y*å’Œè®¾è®¡çŸ©é˜µ*X*ï¼š
- en: '[PRE8]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now, letâ€™s create a train and test split for regression modeling. Note that
    `shuffle=True` will provide different results. To obtain a representative sample,
    the data should be randomly shuffled:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸ºå›å½’å»ºæ¨¡åˆ›å»ºä¸€ä¸ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†åˆ†å‰²ã€‚è¯·æ³¨æ„ï¼Œ`shuffle=True`å°†æä¾›ä¸åŒçš„ç»“æœã€‚ä¸ºäº†è·å¾—ä»£è¡¨æ€§æ ·æœ¬ï¼Œæ•°æ®åº”è¯¥éšæœºæ‰“ä¹±ï¼š
- en: '[PRE9]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Because the negative binomial model is based on a Poisson-gamma mixture model,
    we need to estimate the modelâ€™s measure of over-dispersion using a Poisson model.
    A method referred to as **auxiliary OLS regression (without constant)** is provided
    by A. Colin Cameron and Pravin K. Trivedi in *Microeconometrics: Methods and Applications*.
    The authors propose the creation of an over-dispersion test statistic where the
    null hypothesis is Î±=0 and the alternate hypothesis is Î± â‰  0, where *Î±* is the
    estimate of over-dispersion. The auxiliary OLS regression formula is as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºè´ŸäºŒé¡¹å¼æ¨¡å‹åŸºäºæ³Šæ¾-ä¼½é©¬æ··åˆæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ³Šæ¾æ¨¡å‹æ¥ä¼°è®¡æ¨¡å‹çš„è¿‡åº¦åˆ†æ•£åº¦é‡ã€‚A. Colin Cameronå’ŒPravin K. Trivediåœ¨*å¾®è§‚è®¡é‡ç»æµå­¦ï¼šæ–¹æ³•å’Œåº”ç”¨*ä¸­æä¾›äº†ä¸€ä¸ªç§°ä¸º**è¾…åŠ©OLSå›å½’ï¼ˆæ— å¸¸æ•°é¡¹ï¼‰**çš„æ–¹æ³•ã€‚ä½œè€…æå‡ºäº†åˆ›å»ºä¸€ä¸ªè¿‡åº¦åˆ†æ•£æ£€éªŒç»Ÿè®¡é‡ï¼Œå…¶ä¸­é›¶å‡è®¾æ˜¯Î±=0ï¼Œå¤‡æ‹©å‡è®¾æ˜¯Î±
    â‰  0ï¼Œå…¶ä¸­*Î±*æ˜¯è¿‡åº¦åˆ†æ•£çš„ä¼°è®¡ã€‚è¾…åŠ©OLSå›å½’å…¬å¼å¦‚ä¸‹ï¼š
- en: ( yÂ i âˆ’ Â Ë†Â Î¼Â Â i)Â 2 âˆ’ yÂ iÂ Â _Â Â Ë†Â Î¼Â Â iÂ  = Î± Â g( Â Ë†Â Î¼Â Â i)Â _Â Â Ë†Â Î¼Â Â iÂ  + Î¼Â i
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: ( yÂ i âˆ’ Â Ë†Â Î¼Â Â i)Â 2 âˆ’ yÂ iÂ Â _Â Â Ë†Â Î¼Â Â iÂ  = Î± Â g( Â Ë†Â Î¼Â Â i)Â _Â Â Ë†Â Î¼Â Â iÂ  + Î¼Â i
- en: Here, Î¼Â i is an error term and g( Â Ë†Â Î¼Â Â i) is Â Ë†Â Î¼Â Â iÂ 2\. Thus, the right-hand
    operand reduces to Î± Â Ë†Â Î¼Â Â i + Î¼Â i. In terms of negative binomial regression,
    we consider the error to equal zero, so we can factor Î± in as the over-dispersion
    estimate.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œï¼ŒÎ¼Â i æ˜¯ä¸€ä¸ªè¯¯å·®é¡¹ï¼Œg( Â Ë†Â Î¼Â Â i) æ˜¯ Â Ë†Â Î¼Â Â iÂ 2\. å› æ­¤ï¼Œå³æ‰‹è¾¹çš„æ“ä½œæ•°ç®€åŒ–ä¸º Î± Â Ë†Â Î¼Â Â i + Î¼Â iã€‚åœ¨è´ŸäºŒé¡¹å¼å›å½’çš„æœ¯è¯­ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘è¯¯å·®ä¸ºé›¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†Î±ä½œä¸ºè¿‡åº¦åˆ†æ•£ä¼°è®¡å› å­ã€‚
- en: 'In the following code, we have fit our training data to a generalized linear
    model using the Poisson model for the linkage. Then, we used the regression mean
    of the model to build the estimated auxiliary target variable. Because the method
    is â€œwithout constant,â€ we subtract 1 to remove the constant from the process:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä»¥ä¸‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ³Šæ¾æ¨¡å‹å¯¹é“¾æ¥è¿›è¡Œäº†å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„æ‹Ÿåˆã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æ¨¡å‹çš„å›å½’å‡å€¼æ„å»ºäº†ä¼°è®¡çš„è¾…åŠ©ç›®æ ‡å˜é‡ã€‚å› ä¸ºæ–¹æ³•æ˜¯â€œæ— å¸¸æ•°é¡¹â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡å»1ä»¥ä»è¿‡ç¨‹ä¸­ç§»é™¤å¸¸æ•°ï¼š
- en: '[PRE10]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'As we can see, the estimated dispersion for the negative binomial model is
    `0.622034`. Now, we need to assess if the auxiliary estimate is statistically
    significant. We can do this using the p-value from the OLS model:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè´ŸäºŒé¡¹å¼æ¨¡å‹çš„ä¼°è®¡åˆ†æ•£åº¦ä¸º`0.622034`ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°è¾…åŠ©ä¼°è®¡çš„ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨OLSæ¨¡å‹çš„på€¼æ¥å®Œæˆæ­¤æ“ä½œï¼š
- en: '[PRE11]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'This will print the following output:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†æ‰“å°ä»¥ä¸‹è¾“å‡ºï¼š
- en: '![Figure 8.12 â€“ OLS regression results](img/B18945_08_12.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.12 â€“ OLS å›å½’ç»“æœ](img/B18945_08_12.jpg)'
- en: Figure 8.12 â€“ OLS regression results
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.12 â€“ OLS å›å½’ç»“æœ
- en: 'Because the coefficient is significant and greater than 0, we can confirm the
    model has over-dispersion based on the target. The coefficient can be used as
    the measure for that over-dispersion in the negative binomial model, which we
    can use to adjust the variance in the `alpha` argument here:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºç³»æ•°æ˜¾è‘—ä¸”å¤§äº 0ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç›®æ ‡ç¡®è®¤æ¨¡å‹å…·æœ‰è¿‡åº¦åˆ†æ•£ã€‚è¯¥ç³»æ•°å¯ä»¥ç”¨ä½œåœ¨è´ŸäºŒé¡¹æ¨¡å‹ä¸­è¡¡é‡è¿™ç§è¿‡åº¦åˆ†æ•£çš„æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è°ƒæ•´æ­¤å¤„`alpha`å‚æ•°ä¸­çš„æ–¹å·®ï¼š
- en: '[PRE12]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The output is generated as follows:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºå¦‚ä¸‹ç”Ÿæˆï¼š
- en: '![Figure 8.13 â€“ Generalized linear model regression results](img/B18945_08_13.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ 8.13 â€“ å¹¿ä¹‰çº¿æ€§æ¨¡å‹å›å½’ç»“æœ](img/B18945_08_13.jpg)'
- en: Figure 8.13 â€“ Generalized linear model regression results
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 8.13 â€“ å¹¿ä¹‰çº¿æ€§æ¨¡å‹å›å½’ç»“æœ
- en: 'Finally, letâ€™s use the model we built on the training data to predict the training
    data, then again to predict on the test data so that we can compare generalizability
    on unseen data using residual error as a basis of comparison:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®ä¸Šæ„å»ºçš„æ¨¡å‹æ¥é¢„æµ‹è®­ç»ƒæ•°æ®ï¼Œç„¶åå†åœ¨æµ‹è¯•æ•°æ®ä¸Šé¢„æµ‹ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ®‹å·®è¯¯å·®ä½œä¸ºæ¯”è¾ƒçš„åŸºç¡€æ¥æ¯”è¾ƒæœªè§æ•°æ®çš„æ³›åŒ–èƒ½åŠ›ï¼š
- en: '[PRE13]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'We can observe from the root mean squared error that the modelâ€™s performance
    is approximately constant across training and test data, indicating a consistent
    model:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ä»å‡æ–¹æ ¹è¯¯å·®ä¸­è§‚å¯Ÿåˆ°ï¼Œæ¨¡å‹çš„æ€§èƒ½åœ¨è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¸­å¤§è‡´ä¿æŒä¸å˜ï¼Œè¡¨æ˜æ¨¡å‹æ˜¯ä¸€è‡´çš„ï¼š
- en: '`Training Root Mean Squared` `Error: 1.2553439918425695`'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '`è®­ç»ƒå‡æ–¹æ ¹è¯¯å·®ï¼š1.2553439918425695`'
- en: '`Testing Root Mean Squared` `Error: 1.266620561303553`'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '`æµ‹è¯•å‡æ–¹æ ¹è¯¯å·®ï¼š1.266620561303553`'
- en: Summary
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ‘˜è¦
- en: In this chapter, we explained the issue of encountering negative raw probabilities
    that are generated by building a binary classification probability model based
    strictly on linear regression, where probabilities in a range of [0, 1] are expected.
    We provided an overview of the log-odds ratio and probit and logit modeling using
    the cumulative distribution function of both the standard normal distribution
    and logistic distribution, respectively. We also demonstrated methods for applying
    logistic regression to solve binary and multinomial classification problems. Lastly,
    we covered count-based regression using the log-linear Poisson and negative binomial
    models, which can also be logically extended to rate data without modification.
    We provided examples of their implementations.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è§£é‡Šäº†åœ¨ä¸¥æ ¼åŸºäºçº¿æ€§å›å½’æ„å»ºäºŒå…ƒåˆ†ç±»æ¦‚ç‡æ¨¡å‹æ—¶é‡åˆ°è´Ÿçš„åŸå§‹æ¦‚ç‡çš„é—®é¢˜ï¼Œå…¶ä¸­æœŸæœ›æ¦‚ç‡åœ¨[0, 1]èŒƒå›´å†…ã€‚æˆ‘ä»¬åˆ†åˆ«æ¦‚è¿°äº†ä½¿ç”¨æ ‡å‡†æ­£æ€åˆ†å¸ƒå’Œå¯¹æ•°é€»è¾‘åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„å¯¹æ•°ä¼˜åŠ¿æ¯”å’ŒprobitåŠlogitå»ºæ¨¡ã€‚æˆ‘ä»¬è¿˜å±•ç¤ºäº†å°†é€»è¾‘å›å½’åº”ç”¨äºè§£å†³äºŒå…ƒå’Œå¤šé¡¹åˆ†ç±»é—®é¢˜çš„æ–¹æ³•ã€‚æœ€åï¼Œæˆ‘ä»¬ä»‹ç»äº†ä½¿ç”¨å¯¹æ•°çº¿æ€§æ³Šæ¾å’Œè´ŸäºŒé¡¹æ¨¡å‹è¿›è¡Œçš„åŸºäºè®¡æ•°çš„å›å½’ï¼Œè¿™äº›æ¨¡å‹ä¹Ÿå¯ä»¥åœ¨ä¸åšä¿®æ”¹çš„æƒ…å†µä¸‹é€»è¾‘ä¸Šæ‰©å±•åˆ°é€Ÿç‡æ•°æ®ã€‚æˆ‘ä»¬æä¾›äº†å®ƒä»¬å®ç°çš„ç¤ºä¾‹ã€‚
- en: In the following chapter, we will introduce conditional probability using Bayesâ€™
    theorem in addition to dimension reduction and classification modeling using linear
    discriminant analysis and quadratic discriminant analysis.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨è´å¶æ–¯å®šç†çš„æ¡ä»¶æ¦‚ç‡ï¼Œä»¥åŠä½¿ç”¨çº¿æ€§åˆ¤åˆ«åˆ†æå’ŒäºŒæ¬¡åˆ¤åˆ«åˆ†æè¿›è¡Œé™ç»´å’Œåˆ†ç±»å»ºæ¨¡ã€‚
