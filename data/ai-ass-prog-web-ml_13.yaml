- en: '13'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '13'
- en: Building a Regression Model for Customer Spend with ChatGPT
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ChatGPT构建客户消费回归模型
- en: Introduction
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: In the realm of data-driven decision making, understanding customer behavior
    is pivotal for optimizing business strategies. Building on our exploration of
    classification techniques, this chapter shifts focus to regression analysis, specifically
    linear regression, to predict numerical values such as a customer’s annual spending.
    Linear regression helps us discover relationships within data, enabling predictions
    based on observed patterns.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据驱动决策的领域，理解客户行为对于优化商业策略至关重要。基于我们对分类技术的探索，本章将重点转向回归分析，特别是线性回归，以预测数值，例如客户的年度消费。线性回归帮助我们发现数据中的关系，使我们能够根据观察到的模式进行预测。
- en: This chapter will guide you through the process of building a predictive model
    that estimates annual spending by customers based on their interactions with a
    digital platform. We aim to deepen your understanding of linear regression, demonstrating
    how to prepare, process, and utilize datasets to construct accurate and reliable
    models.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将指导您构建一个预测模型，该模型根据客户与数字平台的互动来估计客户的年度消费。我们旨在加深您对线性回归的理解，展示如何准备、处理和利用数据集来构建准确和可靠的模型。
- en: 'As we progress, we will explore various techniques to enhance model accuracy
    and handle complex data scenarios:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 随着我们前进，我们将探索各种技术来提高模型准确性和处理复杂数据场景：
- en: '**Utilizing advanced regularization techniques** to improve model stability
    and performance.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**利用高级正则化技术**来提高模型稳定性和性能。'
- en: '**Generating synthetic datasets** to better understand model behaviors under
    different data conditions.'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**生成合成数据集**以更好地理解模型在不同数据条件下的行为。'
- en: '**Streamlining model development** with comprehensive, end-to-end coding examples.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通过综合、端到端的编码示例简化模型开发**。'
- en: By the end of this chapter, you will be well equipped with the knowledge and
    skills necessary to utilize linear regression for data-driven decision-making
    in your business. Let’s embark on this journey into regression analysis to optimize
    customer engagement and revenue generation on our app or website.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将具备利用线性回归进行商业数据驱动决策所需的知识和技能。让我们开始这段回归分析的旅程，以优化我们应用程序或网站上的客户参与度和收入生成。
- en: 'In this chapter, we will:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将：
- en: '**Build a regression model with ChatGPT:** Readers will learn how ChatGPT can
    assist in generating Python code for building a regression model to predict the
    yearly amount spent by customers on our app or website using the dataset we have,
    offering a hands-on approach to understanding and interacting with datasets.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用ChatGPT构建回归模型**：读者将学习如何使用ChatGPT辅助生成用于构建回归模型的Python代码，以预测客户在我们的应用程序或网站上花费的年度金额，提供一种动手理解与交互数据集的方法。'
- en: '**Apply prompting techniques:** Effective techniques will be introduced to
    craft prompts that guide ChatGPT in providing the most useful code snippets and
    insights for regression tasks.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用提示技术**：将介绍有效的技术来构建提示，引导ChatGPT提供最有用的代码片段和回归任务见解。'
- en: Business problem
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 商业问题
- en: An e-commerce store seeks to optimize customer engagement and increase revenue
    by gaining deeper insights into customer behavior and preferences. By analyzing
    various customer attributes and their purchasing patterns, the store aims to tailor
    its marketing strategies, improve customer retention, and enhance the overall
    shopping experience.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 一家电子商务商店希望通过深入了解客户行为和偏好来优化客户参与度和增加收入。通过分析各种客户属性及其购买模式，商店旨在定制其营销策略，提高客户保留率，并提升整体购物体验。
- en: Problem and data domain
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题与数据领域
- en: We will employ regression techniques to understand the relationship between
    yearly spending and other parameters. **Regression** is a way to find out whether
    and how different factors (like time spent on an app or website) relate to how
    much customers spend in the online store. It helps us understand and predict customer
    behavior. By understanding which factors are most influential in driving sales,
    an e-commerce store can tailor its strategies to enhance these areas and potentially
    increase revenue.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用回归技术来了解年度消费与其他参数之间的关系。**回归**是一种找出不同因素（如花在应用程序或网站上的时间）如何与客户在在线商店的消费金额相关联的方法。它帮助我们理解和预测客户行为。通过了解哪些因素对推动销售最有影响力，电子商务商店可以调整其策略来增强这些领域，并可能增加收入。
- en: Dataset overview
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据集概述
- en: 'The e-commerce store collects the following information from the customer:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 电子商务店铺从客户那里收集以下信息：
- en: '**Email:** This is the customer’s email address. It is a unique identifier
    for each customer and can be used for communication, such as sending order confirmations,
    newsletters, or personalized marketing offers.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件：** 这是客户的电子邮件地址。它是每个客户的唯一标识符，可用于通信，例如发送订单确认、时事通讯或个性化的营销优惠。'
- en: '**Address:** This refers to the physical address of the customer. It’s crucial
    for delivering products they have purchased. Additionally, address data can sometimes
    provide insights into geographical trends in sales and preferences.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**地址：** 这指的是客户的物理地址。对于交付他们购买的产品至关重要。此外，地址数据有时可以提供关于销售和偏好的地理趋势的见解。'
- en: '**Avatar:** This could be a digital representation or image chosen by the user.
    It might not directly impact sales or customer behavior, but it can be part of
    customer engagement strategies, adding a personal touch to user profiles.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**头像：** 这可能是用户选择的数字表示或图像。它可能不会直接影响销售或客户行为，但它可以是客户互动策略的一部分，为用户资料增添个性化触感。'
- en: '**Avg Session Length:** This is the average duration of all sessions combined,
    in minutes. This is like measuring how long a customer spends in your store each
    time they visit. Imagine someone walking around, looking at products for, say,
    33 minutes on average.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均会话时长：** 这是所有会话的平均持续时间，以分钟计算。这就像测量客户每次访问您的店铺时花费的时间。想象一下，有人平均花费33分钟在您的店铺里四处走动，查看产品。'
- en: '**Time on App:** This the duration of presence on the store’s application,
    in minutes. Think of it as how long they are browsing through your app, maybe
    while they are on the bus or waiting in line at the coffee shop.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用使用时间：** 这是指客户在店铺应用上的停留时长，以分钟计算。可以将其视为他们在应用中浏览的时间，比如在公交车上或咖啡店排队时。'
- en: '**Time on Website:** This is similar to the time on the app, but this is for
    your website. If they’re using a computer at home or work to look at your store,
    how long do they stay?'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网站使用时间：** 这与应用使用时间类似，但这是针对您的网站。如果他们在家里或工作场所使用电脑查看您的店铺，他们会停留多久？'
- en: '**Length of Membership:** This is how long these customers have been with your
    store. Some might be new, while others have been shopping with you for years.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会员时长：** 这表示这些客户在您的店铺中的时间长短。有些人可能是新顾客，而其他人可能已经与您合作多年。'
- en: '**Yearly Amount Spent:** This is the total amount of money each customer spends
    at your store in a year, in dollars.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**年度消费金额：** 这是指每位客户在您的店铺中一年内花费的总金额，以美元计算。'
- en: 'In the context of our dataset:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的数据集背景下：
- en: '**Email and address**: These should be used primarily for transactional purposes
    unless the customer has agreed to receive marketing communications. We will not
    use them for analysis.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件和地址：** 这些应主要用于交易目的，除非客户同意接收营销通讯。我们不会将它们用于分析。'
- en: '**Avatar**: This can be used to personalize the user experience but does not
    hold significant analytical value for sales predictions.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**头像：** 这可以用于个性化用户体验，但对于销售预测的统计分析价值不大。'
- en: '**Other data**: Variables like “Time on App” and “Time on Website” can be analyzed
    to improve user experience and business strategies without infringing on personal
    privacy.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**其他数据：** 如“应用使用时间”和“网站使用时间”等变量可以进行分析，以改进用户体验和业务策略，同时不侵犯个人隐私。'
- en: In summary, while data like email, address, and avatar can be valuable for business
    operations and customer engagement, they must be handled with a high degree of
    responsibility, prioritizing the privacy and preferences of the customers.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，虽然像电子邮件、地址和头像这样的数据对于业务运营和客户互动很有价值，但它们必须以高度的责任心处理，优先考虑客户的隐私和偏好。
- en: Note that the data used is not a real dataset and hence the emails, addresses,
    and so on are all made up.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，所使用的数据不是真实的数据集，因此电子邮件、地址等都是虚构的。
- en: Breaking the problem down into features
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将问题分解为特征
- en: 'Given the nature of our dataset, which includes both independent variables
    (like “Avg. Session Length,” “Time on App,” “Time on Website,” and “Length of
    Membership”) and a dependent variable (“Yearly Amount Spent”), we will start with
    a simple regression technique with both ChatGPT and ChatGPT Plus or GPT-4\. This
    will include the following high-level steps:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到我们的数据集包括独立变量（如“平均会话时长”、“应用使用时间”、“网站使用时间”和“会员时长”）以及一个因变量（“年度消费金额”），我们将从使用ChatGPT和ChatGPT
    Plus或GPT-4的简单回归技术开始。这包括以下高级步骤：
- en: '**Building the model step by step**: Users will understand the process of building
    a machine learning model step by step, including loading the dataset, splitting
    it into training and testing sets, training the model, making predictions, and
    evaluating its performance.'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**逐步构建模型**：用户将逐步了解构建机器学习模型的过程，包括加载数据集、将其分为训练集和测试集、训练模型、进行预测以及评估其性能。'
- en: '**Apply regularization techniques**: Users will learn how to apply regularization
    techniques such as Ridge regression and Lasso regression with cross-validation
    to improve the performance of a linear regression model. This includes initializing
    the models, training them using the training data, and evaluating their performance.'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**应用正则化技术**：用户将学习如何应用正则化技术，如岭回归和Lasso回归，并结合交叉验证来提高线性回归模型的表现。这包括初始化模型、使用训练数据训练它们以及评估它们的性能。'
- en: '**Generate a synthetic dataset to add complexity**: Users will discover how
    to generate a synthetic dataset with added complexity using the `make_regression`
    function from the `sklearn.datasets` module. This involves specifying the number
    of samples, features, and noise levels to mimic real-world data.'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**生成一个具有复杂性的合成数据集**：用户将发现如何使用 `sklearn.datasets` 模块中的 `make_regression` 函数生成具有附加复杂性的合成数据集。这涉及到指定样本数量、特征和噪声水平，以模拟真实世界的数据。'
- en: '**Generating code to develop a model in a single step for a synthetic dataset**:
    Users will see how to write end-to-end code in a single step to load the synthetic
    dataset, split it into training and testing sets, train a linear regression model,
    evaluate its performance, and print the evaluation metrics. This allows for a
    streamlined approach to model development and evaluation.'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**为合成数据集生成单步模型开发代码**：用户将看到如何通过单步编写端到端代码来加载合成数据集，将其分为训练集和测试集，训练线性回归模型，评估其性能，并打印评估指标。这允许采用简化的模型开发和评估方法。'
- en: Prompting strategy
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 提示策略
- en: To leverage ChatGPT for machine learning, we need to have a clear understanding
    of how to implement the prompting strategies specifically for code generation
    for machine learning.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 为了利用 ChatGPT 进行机器学习，我们需要清楚地了解如何实现针对代码生成的特定提示策略。
- en: Let’s brainstorm what we would like to achieve in this task to get a better
    understanding of what needs to go into the initial prompt.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们头脑风暴一下在这个任务中我们想要实现的目标，以便更好地理解需要放入初始提示的内容。
- en: 'Strategy 1: Task-Actions-Guidelines (TAG) prompt strategy'
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略 1：任务-行动-指南（TAG）提示策略
- en: '**1.1 – Task**: The specific task or goal is to create a simple linear regression
    model to predict the “**Yearly Amount Spent**” bydataset based on various attributes
    in the dataset.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**1.1 – 任务**: 具体的任务或目标是创建一个简单的线性回归模型，根据数据集中的各种属性预测“**年度消费金额**”。'
- en: '**1.2 – Actions**: In this case, the strategy is to let ChatGPT decide the
    steps, hence no specific steps are provided.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**1.2 – 行动**: 在这种情况下，策略是让 ChatGPT 决定步骤，因此没有提供具体的步骤。'
- en: '**1.3 – Guidelines**: We will provide the following guidelines to ChatGPT in
    our prompt:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**1.3 – 指南**：在我们的提示中，我们将为 ChatGPT 提供以下指南：'
- en: The code should be compatible with Jupyter Notebook
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代码应与 Jupyter Notebook 兼容
- en: Ensure that there are detailed comments for each line of code.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保对每一行代码都有详细的注释。
- en: You have to explain each line of code, which will be then copied into the text
    block of the notebook in detail for each method used in the code before providing
    the code.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须解释每一行代码，然后将其详细地复制到笔记本的文本块中，以便在提供代码之前对代码中使用的每种方法进行说明。
- en: 'Strategy 2: Persona-Instructions-Context (PIC) prompt strategy'
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略 2：角色-指令-上下文（PIC）提示策略
- en: '**2.1 – Persona**: We will adopt the persona of a beginner who needs to learn
    the different steps of model creation; hence the code should be generated step
    by step.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**2.1 – 角色**：我们将扮演一个需要学习模型创建不同步骤的初学者的角色；因此，代码应逐步生成。'
- en: '**2.2 – Instructions**: We have included the step to mount Google Drive explicitly
    since it’s a common oversight.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**2.2 – 指令**：我们明确包括了挂载 Google Drive 的步骤，因为这是一个常见的疏忽。'
- en: '**2.3 – Context**: The most important part is to provide the context of the
    dataset and exact field names to generate the code that can be executed directly,
    or to provide the dataset itself in the case of ChatGPT Plus.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**2.3 – 上下文**: 最重要的是提供数据集的上下文和确切的字段名称，以生成可以直接执行的代码，或者在 ChatGPT Plus 的情况下提供数据集本身。'
- en: 'Strategy 3: Learn-Improvise-Feedback-Evaluate (LIFE) prompt strategy'
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略 3：学习-即兴创作-反馈-评估（LIFE）提示策略
- en: '**3.1 – Learn**:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**3.1 – 学习**:'
- en: We want to learn about linear regression and how it works.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们想了解线性回归及其工作原理。
- en: Understand feature engineering techniques and model evaluation metrics.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解特征工程技术和模型评估指标。
- en: We want to learn how to create a synthetic dataset.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们想学习如何创建合成数据集。
- en: '**3.2 – Improvise**:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**3.2 – 改进**:'
- en: We will use it later while applying regularization techniques.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将在应用正则化技术时使用它。
- en: '**3.3 – Feedback**:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**3.3 – 反馈**:'
- en: If the code provided results in any errors, then feedback should be provided
    back to ChatGPT. We applied it in the Lasso and Ridge code execution using ChatGPT
    Plus.
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果提供的代码导致任何错误，则应向ChatGPT提供反馈。我们已在ChatGPT Plus中应用了Lasso和Ridge代码执行。
- en: '**3.4 – Evaluate**:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**3.4 – 评估**:'
- en: Execute the code provided by ChatGPT to ensure accuracy and validity. This is
    used throughout the chapter.
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行ChatGPT提供的代码以确保准确性和有效性。这一点在本章中一直被使用。
- en: Building a simple linear regression model to predict the “Yearly Amount Spent”
    by customers using the free version of ChatGPT
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ChatGPT的免费版本构建一个简单的线性回归模型来预测“年度消费金额”
- en: When using the free version, it’s important to give ChatGPT a clear description
    of the dataset first, which serves as an effective approach to generating code,
    followed by user evaluation. ChatGPT is already trained very well on Python and
    a machine learning algorithm; hence, we do not need to provide specific steps
    here. To verify that the generated code functions correctly, we will be using
    Google Colab.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用免费版本时，首先向ChatGPT提供一个清晰的关于数据集的描述非常重要，这作为生成代码的有效方法，随后进行用户评估。ChatGPT已经在Python和机器学习算法上训练得很好；因此，我们在这里不需要提供具体的步骤。为了验证生成的代码是否正确运行，我们将使用Google
    Colab。
- en: 'Feature 1: Building the model step by step'
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征1：逐步构建模型
- en: Let’s craft our initial prompt for the classification model.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们为分类模型制定初始提示。
- en: '[P**rompt]**'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示**]'
- en: 'I want to create a simple linear regression model to predict the “Yearly Amount
    Spent” (TAG 1.1) by customers for the e-commerce customers dataset which consists
    of the following columns (PIC 2.3):'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我想创建一个简单的线性回归模型来预测电子商务客户数据集中客户的“年度消费金额”（TAG 1.1），该数据集包含以下列（PIC 2.3）：
- en: '**Email**: The electronic mail unique to each customer, used here as an identification.'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**电子邮件**：每个客户的独特电子邮箱，在此用作识别。'
- en: '**Address**: The physical geographical location of each customer.'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**地址**：每个客户的物理地理位置。'
- en: '**Avatar**: This is the visual anonymity representation of the customers in
    the database.'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**头像**：这是数据库中客户的视觉匿名表示。'
- en: '**Avg. Session Length**: The average duration of all session combined in minutes.'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**平均会话长度**：所有会话合并后的平均持续时间，以分钟为单位。'
- en: '**Time on App**: This the duration of presence on the stores’ application,
    in minutes.'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**应用时间**：这是在商店应用程序中的持续时间，以分钟为单位。'
- en: '**Time on Website**: This is the time duration on the website of the store,
    in minutes.'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**网站时间**：这是在商店网站上的时间长度，以分钟为单位。'
- en: '**Length of Membership**: This is the amount of time a customer remains a registered
    user of the store’s online resources.'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**会员时长**：这是客户作为商店在线资源注册用户的时长。'
- en: '**Yearly Amount Spent**: This is the cost implication of accessing the store’s
    online resources, paid by the customers, in dollars.'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**年度消费金额**：这是客户支付商店在线资源的成本，以美元计算。'
- en: 'I am a beginner user (PIC 2.1), so please provide step by step code and strictly
    follow following instructions (PIC 2.2):'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 我是一个初学者用户（PIC 2.1），所以请提供逐步的代码，并严格遵循以下说明（PIC 2.2）：
- en: Code should be compatible with Jupyter notebook
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代码应与Jupyter笔记本兼容
- en: Ensure that there are detailed comments for each line of code.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保每行代码都有详细的注释。
- en: You have to explain each line of code, which will be then copied in the text
    block of the notebook in detail for each method used in code before providing
    the code.
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须解释每一行代码，然后详细地将其复制到笔记本的文本块中，详细说明代码中使用的每种方法，在提供代码之前。
- en: Also note that the dataset is placed in Google Drive at this path `'/content/drive/My
    Drive/Chapter05/Ecommerce Customers.csv '` (TAG 1.2).
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 还请注意，数据集放置在Google Drive的此路径`'/content/drive/My Drive/Chapter05/Ecommerce Customers.csv
    '`（TAG 1.2）。
- en: So, add the code to mount the drive, load the dataset, provide one step at a
    time, and wait for users feedback.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，添加代码来挂载驱动器，加载数据集，一次提供一步，并等待用户反馈。
- en: '[E**nd of prompt]**'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束**]'
- en: You should receive a response similar to the following.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该收到以下类似的响应。
- en: '![](img/B21232_13_01.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B21232_13_01.png)'
- en: 'Figure 13.1: The initial response from ChatGPT'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.1：ChatGPT的初始响应
- en: '[P**rompt response]**'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: Sure, let’s proceed step by step. First, we need to mount Google Drive in our
    Jupyter Notebook environment so we can access the dataset.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，让我们一步一步来。首先，我们需要在我们的Jupyter Notebook环境中挂载Google Drive，以便我们可以访问数据集。
- en: 'Here’s how you can do it:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这是您可以这样做的：
- en: '[PRE0]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Explanation:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 解释：
- en: '`from google.colab import drive`: This line imports the `drive` module from
    the `google.colab` package.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from google.colab import drive`：这一行从`google.colab`包中导入了`drive`模块。'
- en: '`drive.mount(''/content/drive'')`: This command mounts your Google Drive at
    the specified path `/content/drive`. When you run this cell, it will prompt you
    to authenticate and give you a link to follow to get an authorization code. Once
    you enter the code, your Google Drive will be mounted.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`drive.mount(''/content/drive'')`：这个命令将您的Google Drive挂载到指定的路径`/content/drive`。当您运行这个单元格时，它会提示您进行身份验证，并给您一个链接以获取授权代码。一旦您输入代码，您的Google
    Drive就会挂载。'
- en: Let me know if you have any questions before we proceed.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续之前，如果您有任何问题，请告诉我。
- en: '[E**nd of response]**'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: We will now apply the evaluate prompting strategy and validate the code by executing
    the code in Google Colab for every step. The code runs perfectly fine and mounts
    Google Drive.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将应用评估提示策略，并通过在Google Colab的每一步执行代码来验证代码。代码运行得非常顺利，并挂载了Google Drive。
- en: Please note that it requires permission to access the drive and would prompt
    the user.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，它需要权限来访问驱动器，并会提示用户。
- en: Please refer to the notebook `Learning simple regression with ChatGPT.ipynb`
    for the executable code snippets or copy the code from the prompt response.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考笔记本 `使用ChatGPT学习简单回归.ipynb` 以获取可执行的代码片段，或者从提示响应中复制代码。
- en: Running your cell, you should see a message that says “Mounted at /content/drive
    as a result of calling drive.mount.”
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 运行您的单元格，您应该会看到一个消息说“由于调用drive.mount，已挂载到/content/drive。”
- en: 'We will now instruct ChatGPT to proceed to the next step:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将指示ChatGPT进行下一步：
- en: '[P**rompt]**'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt**]'
- en: Let’s proceed
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续
- en: '[E**nd of prompt]**'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt**]'
- en: 'We should receive a response similar to the following to load the dataset into
    the notebook:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该会收到以下类似的响应，以将数据集加载到笔记本中：
- en: '[P**rompt response]**'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: Great! Now that we have mounted Google Drive, we can load the dataset into our
    notebook.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！现在我们已经挂载了Google Drive，我们可以将数据集加载到我们的笔记本中。
- en: 'Here’s how you can load the dataset:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是如何加载数据集的：
- en: '[PRE1]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Explanation:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 解释：
- en: '`import pandas as pd`: This line imports the pandas library and aliases it
    as `pd`, which is a common convention.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`import pandas as pd`：这一行导入了pandas库，并将其别名为`pd`，这是一个常见的约定。'
- en: '`file_path = ''/content/drive/My Drive/Chapter05/Ecommerce Customers.csv''`:
    This line defines the file path where the dataset is located in your Google Drive.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`file_path = ''/content/drive/My Drive/Chapter05/Ecommerce Customers.csv''`：这一行定义了数据集在您的Google
    Drive中的文件路径。'
- en: '`pd.read_csv(file_path)`: This function reads the CSV file located at the specified
    path and creates a DataFrame from it.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pd.read_csv(file_path)`：这个函数读取指定路径的CSV文件，并从中创建一个DataFrame。'
- en: '`print(ecommerce_data.head())`: This line prints the first few rows of the
    DataFrame to verify that the dataset has been loaded correctly.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`print(ecommerce_data.head())`：这一行打印DataFrame的前几行，以验证数据集是否已正确加载。'
- en: Let me know if you have any questions or if you’d like to proceed to the next
    step!
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或想要进行下一步，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: We executed the code provided by ChatGPT in the notebook and it loads the dataset
    from the defined path and prints the first few rows. As we had given the path
    of the file in the initial prompt, we don’t need to change anything in the code
    and it runs perfectly fine. The takeaway is that we need to be specific with file
    paths and locations where required.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在笔记本中执行了ChatGPT提供的代码，并从定义的路径加载数据集，并打印了前几行。由于我们在初始提示中给出了文件的路径，我们不需要在代码中做任何更改，它运行得非常顺利。得到的经验是，在需要时，我们需要对文件路径和位置进行具体说明。
- en: '![A screenshot of a computer](img/B21232_13_02.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![计算机屏幕截图](img/B21232_13_02.png)'
- en: 'Figure 13.2: Loading the dataset'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.2：加载数据集
- en: Next, we’ll provide the output to ChatGPT and then proceed to *Step 1*. In this
    instance, we’ve employed the strategy of providing additional context to ChatGPT
    by presenting the output textually.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将提供ChatGPT的输出，然后进行*步骤1*。在这种情况下，我们通过以文本形式呈现输出，向ChatGPT提供了额外的上下文。
- en: 'It is important to note that since we are utilizing GPT-3.5, which lacks the
    capability to execute code or process images, we are limited to providing textual
    outputs from the notebook:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要注意，由于我们正在使用GPT-3.5，它没有执行代码或处理图像的能力，所以我们只能从笔记本中提供文本输出：
- en: '[P**rompt]**'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: '[PRE2]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[E**nd of prompt]**'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We anticipate receiving a response similar to the following, wherein ChatGPT
    will offer guidance on the subsequent steps. Initially, we refrained from specifying
    any particular steps in the initial prompt, opting instead to allow ChatGPT to
    determine the subsequent course of action:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 我们预计会收到以下类似的响应，其中ChatGPT将提供后续步骤的指导。最初，我们在初始提示中未指定任何特定步骤，而是选择让ChatGPT确定后续的行动方案：
- en: '[P**rompt response]**'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Great! The dataset has been loaded successfully. Now, we can proceed with building
    our linear regression model to predict the “Yearly Amount Spent” by customers.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！数据集已成功加载。现在，我们可以继续构建我们的线性回归模型来预测客户花费的“年度金额”。
- en: 'The steps involved in building a simple linear regression model are as follows:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 构建简单线性回归模型的步骤如下：
- en: '**Data Preparation**: Split the dataset into input features (`X`) and the target
    variable (`y`).'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据准备**：将数据集分割为输入特征（`X`）和目标变量（`y`）。'
- en: '**Split Data**: Split the dataset into training and testing sets.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分割数据**：将数据集分割为训练集和测试集。'
- en: '**Model Initialization**: Create a linear regression model object.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型初始化**：创建一个线性回归模型对象。'
- en: '**Model Training**: Fit the model to the training data.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型训练**：将模型拟合到训练数据。'
- en: '**Model Evaluation**: Evaluate the model’s performance using the testing data.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型评估**：使用测试数据评估模型性能。'
- en: 'Let’s start with *step 1*:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从*步骤1*开始：
- en: 'Step 1: Data Preparation:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 第1步：数据准备：
- en: '[PRE3]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Explanation:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`X = ecommerce_data[[''Avg. Session Length'', ''Time on App'', ''Time on Website'',
    ''Length of Membership'']]`: This line selects the input features (`''Avg. Session
    Length''`, `''Time on App''`, `''Time on Website''`, `''Length of Membership''`)
    from the dataset and assigns them to the variable `X`.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`X = ecommerce_data[[''Avg. Session Length'', ''Time on App'', ''Time on Website'',
    ''Length of Membership'']]`：这一行从数据集中选择了输入特征（`''Avg. Session Length''`，`''Time
    on App''`，`''Time on Website''`，`''Length of Membership''`）并将其分配给变量`X`。'
- en: '`y = ecommerce_data[''Yearly Amount Spent'']`: This line selects the target
    variable `''Yearly Amount Spent''` from the dataset and assigns it to the variable
    `y`.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`y = ecommerce_data[''Yearly Amount Spent'']`：这一行从数据集中选择了目标变量`''Yearly Amount
    Spent''`并将其分配给变量`y`。'
- en: Let me know if you have any questions or if you’d like to proceed to the next
    step!
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或想要进行下一步，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: ChatGPT has outlined the steps it will adhere to for code generation. Furthermore,
    it has furnished the code for the initial step, data preparation, wherein the
    dataset is divided into features and the target variable. Notably, it adeptly
    discerned the features by excluding email addresses, avatars, and addresses. Additionally,
    it precisely employed the column names as stipulated in the description provided
    in the initial prompt. The strategy employed here involves including the dataset
    column names in the prompt to ensure compatibility with the generated code. Hence,
    the code executes without any modifications or errors.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: ChatGPT概述了它将遵循的代码生成步骤。此外，它提供了第一步的代码，即数据准备，其中数据集被分为特征和目标变量。值得注意的是，它巧妙地排除了电子邮件地址、头像和地址等特征。此外，它精确地使用了初始提示中提供的描述中规定的列名。这里采用的策略是在提示中包含数据集列名，以确保生成的代码的兼容性。因此，代码执行时无需任何修改或错误。
- en: '![](img/B21232_13_03.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B21232_13_03.png)'
- en: 'Figure 13.3: Step 1 – data preparation'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.3：步骤1 – 数据准备
- en: 'Next, we will instruct ChatGPT to proceed:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将指示ChatGPT继续：
- en: '[P**rompt]**'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Let’s proceed to the next step.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续下一步。
- en: '[E**nd of prompt]**'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following to split the data along
    with the explanation:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，以根据说明分割数据：
- en: '[P**rompt response]**'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Great! Now that we have prepared our data by separating the input features (`X`)
    and the target variable (`y`), we can proceed to the next step, which is splitting
    the data into training and testing sets.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！现在我们已经通过分离输入特征（`X`）和目标变量（`y`）来准备我们的数据，我们可以继续到下一步，即将数据分割为训练集和测试集。
- en: 'Step 2: Split Data:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 第2步：分割数据：
- en: '[PRE4]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Explanation:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`from sklearn.model_selection import train_test_split`: This line imports the
    `train_test_split` function from the `sklearn.model_selection` module, which is
    used to split the dataset into training and testing sets.'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from sklearn.model_selection import train_test_split`: 这行代码从 `sklearn.model_selection`
    模块导入 `train_test_split` 函数，该函数用于将数据集分为训练集和测试集。'
- en: '`train_test_split(X, y, test_size=0.2, random_state=42)`: This function splits
    the input features (`X`) and the target variable (`y`) into training and testing
    sets. The `test_size` parameter specifies the proportion of the dataset to include
    in the testing set (in this case, 20% for testing). The `random_state` parameter
    is used for reproducibility, ensuring that the same random split is generated
    each time the code is run.'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`train_test_split(X, y, test_size=0.2, random_state=42)`: 这个函数将输入特征（`X`）和目标变量（`y`）分为训练集和测试集。`test_size`
    参数指定了要包含在测试集中的数据集比例（在本例中，测试集为 20%）。`random_state` 参数用于可重复性，确保每次运行代码时生成相同的随机分割。'
- en: '`X_train, X_test, y_train, y_test`: These variables hold the training and testing
    sets for the input features (`X`) and the target variable (`y`), respectively.'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`X_train, X_test, y_train, y_test`: 这些变量分别持有输入特征（`X`）和目标变量（`y`）的训练集和测试集。'
- en: '`print("Training set shape - X_train:", X_train.shape, "y_train:", y_train.shape)`:
    This line prints the shapes of the training set input features (`X_train`) and
    target variable (`y_train`).'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`print("Training set shape - X_train:", X_train.shape, "y_train:", y_train.shape)`:
    这行代码打印了训练集输入特征（`X_train`）和目标变量（`y_train`）的形状。'
- en: '`print("Testing set shape - X_test:", X_test.shape, "y_test:", y_test.shape)`:
    This line prints the shapes of the testing set input features (`X_test`) and target
    variable (`y_test`).'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`print("Testing set shape - X_test:", X_test.shape, "y_test:", y_test.shape)`:
    这行代码打印了测试集输入特征（`X_test`）和目标变量（`y_test`）的形状。'
- en: Let me know if you have any questions or if you’d like to proceed to the next
    step!
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或想要进行下一步，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: The code executed successfully, and the data was split into training and testing
    sets with the expected 80-20 ratio. Notably, we did not explicitly specify the
    ratio, yet ChatGPT defaulted to the standard 80-20 split.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 代码执行成功，数据已按照预期的 80-20 比例分为训练集和测试集。值得注意的是，我们没有明确指定比例，但 ChatGPT 默认为标准的 80-20 分割。
- en: '![A white screen with text  Description automatically generated with medium
    confidence](img/B21232_13_04.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![带有文本的白色屏幕  自动生成的中等置信度描述](img/B21232_13_04.png)'
- en: 'Figure 13.4: Step 2 – split the data'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.4：步骤 2 – 分割数据
- en: 'Next, we will provide the output of the previous step to ChatGPT, which should
    let ChatGPT know about the shape and it should also provide us the code for the
    next step:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将提供上一步的输出给 ChatGPT，这样 ChatGPT 应该会了解形状，并且也应该为我们提供下一步的代码：
- en: '[P**rompt]**'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: '[PRE5]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[E**nd of prompt]**'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following where the model is initialized:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似的响应，其中模型已初始化：
- en: '[P**rompt response]**'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Perfect! We have successfully split our dataset into training and testing sets.
    The training set contains 400 samples, while the testing set contains 100 samples.
    Each sample consists of four input features and one target variable.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 完美！我们已经成功将数据集分为训练集和测试集。训练集包含 400 个样本，而测试集包含 100 个样本。每个样本由四个输入特征和一个目标变量组成。
- en: Now, let’s proceed to the next step, which is initializing our linear regression
    model.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们进行下一步，即初始化我们的线性回归模型。
- en: 'Step 3: Model Initialization:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤 3：模型初始化：
- en: '[PRE6]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Explanation:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`from sklearn.linear_model import LinearRegression`: This line imports the
    `LinearRegression` class from the `sklearn.linear_model` module, which is used
    to create a linear regression model.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from sklearn.linear_model import LinearRegression`: 这行代码从 `sklearn.linear_model`
    模块导入 `LinearRegression` 类，用于创建线性回归模型。'
- en: '`model = LinearRegression()`: This line initializes a linear regression model
    object and assigns it to the variable model.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`model = LinearRegression()`: 这行代码初始化一个线性回归模型对象，并将其分配给变量 model。'
- en: Let me know if you have any questions or if you’d like to proceed to the next
    step!
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或想要进行下一步，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: The code is executed perfectly fine without any errors. Necessary imports are
    also provided by ChatGPT.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 代码执行得很好，没有任何错误。必要的导入也由 ChatGPT 提供。
- en: '![A screenshot of a computer program  Description automatically generated](img/B21232_13_05.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![计算机程序的截图  自动生成的描述](img/B21232_13_05.png)'
- en: 'Figure 13.5: Step 3 – model initialization'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.5：步骤 3 – 模型初始化
- en: 'We’ll simply direct ChatGPT to continue. It’s worth noting that because our
    initial prompt included the instruction to provide step-by-step code, we don’t
    need to tailor our subsequent prompts to each individual step or task. Instead,
    we’ll allow ChatGPT to lead us, providing it with the outputs from the preceding
    steps as necessary:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将直接指示ChatGPT继续。值得注意的是，由于我们的初始提示中包含了提供逐步代码的指令，我们不需要针对每个单独的步骤或任务调整后续的提示。相反，我们将允许ChatGPT引导我们，在必要时提供前一步骤的输出：
- en: '[P**rompt]**'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt]**'
- en: Let’s proceed.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续。
- en: '[E**nd of prompt]**'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt]**'
- en: 'We should receive a response similar to the following to train the model:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应来训练模型：
- en: '[P**rompt response]**'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response]**'
- en: Great! Now that we have initialized our linear regression model, we can move
    on to the next step, which is training the model using the training data.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！现在我们已经初始化了我们的线性回归模型，我们可以继续下一步，即使用训练数据来训练模型。
- en: 'Step 4: Model Training:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤4：模型训练：
- en: '[PRE7]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Explanation:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`model.fit(X_train, y_train)`: This line fits (or trains) the linear regression
    model using the training data. The `fit` method takes the input features (`X_train`)
    and the corresponding target variable (`y_train`) as arguments and adjusts the
    model’s parameters to minimize the difference between the actual and predicted
    values.'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`model.fit(X_train, y_train)`: 这行代码使用训练数据来拟合（或训练）线性回归模型。`fit`方法接受输入特征（`X_train`）和相应的目标变量（`y_train`）作为参数，并调整模型的参数以最小化实际值和预测值之间的差异。'
- en: Now that our model has been trained, we can proceed to the final step, which
    is evaluating the model’s performance using the testing data.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经训练了模型，我们可以继续到最后一步，即使用测试数据评估模型性能。
- en: Let me know if you have any questions or if you’d like to proceed!
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或希望继续，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response]**'
- en: We will execute the code and that should train the model.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将执行代码，这将训练模型。
- en: '![A computer screen shot of a computer code  Description automatically generated](img/B21232_13_06.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![计算机代码屏幕截图自动生成的描述](img/B21232_13_06.png)'
- en: 'Figure 13.6: Step 4 – model training'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.6：步骤4 – 模型训练
- en: 'We will instruct ChatGPT to proceed:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT继续：
- en: '[P**rompt]**'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt]**'
- en: Let’s proceed
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续
- en: '[E**nd of prompt]**'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt]**'
- en: 'We should receive a response similar to the following to evaluate the performance
    of the model using test data:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应来使用测试数据评估模型的性能：
- en: '[P**rompt response]**'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response]**'
- en: Great! Now that our linear regression model has been trained, we can evaluate
    its performance using the testing data.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！现在我们的线性回归模型已经训练完成，我们可以使用测试数据来评估其性能。
- en: 'Step 5: Model Evaluation:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤5：模型评估：
- en: '[PRE8]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Explanation:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`model.predict(X_test)`: This line uses the trained model to make predictions
    on the input features (`X_test`), which generates the predicted values of the
    target variable.'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`model.predict(X_test)`: 这行代码使用训练好的模型对输入特征（`X_test`）进行预测，从而生成目标变量的预测值。'
- en: '`from sklearn.metrics import mean_squared_error, r2_score`: This line imports
    the `mean_squared_error` and `r2_score` functions from the `sklearn.metrics` module,
    which are used to evaluate the model’s performance.'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from sklearn.metrics import mean_squared_error, r2_score`: 这行代码从`sklearn.metrics`模块导入`mean_squared_error`和`r2_score`函数，这些函数用于评估模型的性能。'
- en: '`mean_squared_error(y_test, y_pred)`: This function calculates the mean squared
    error (`MSE`) between the actual target variable (`y_test`) and the predicted
    values (`y_pred`).'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mean_squared_error(y_test, y_pred)`: 这个函数计算实际目标变量（`y_test`）和预测值（`y_pred`）之间的均方误差（MSE）。'
- en: '`r2_score(y_test, y_pred)`: This function calculates the R-squared (coefficient
    of determination) between the actual target variable (`y_test`) and the predicted
    values (`y_pred`).'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`r2_score(y_test, y_pred)`: 这个函数计算实际目标变量（`y_test`）和预测值（`y_pred`）之间的R平方（确定系数）。'
- en: '`print("Mean Squared Error (MSE):", mse)`: This line prints the mean squared
    error (`MSE`), which measures the average squared difference between the actual
    and predicted values. A lower MSE indicates better model performance.'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`print("均方误差 (MSE):", mse)`: 这行代码打印了均方误差（MSE），它衡量实际值和预测值之间的平均平方差。较低的MSE表示模型性能更好。'
- en: '`print("R-squared (Coefficient of Determination):", r_squared)`: This line
    prints the R-squared value, which represents the proportion of the variance in
    the target variable that is explained by the model. A higher R-squared value (closer
    to 1) indicates better fit.'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`print("R-squared (Coefficient of Determination):", r_squared)`: 这行代码打印出R-squared值，它代表了模型解释目标变量方差的比例。R-squared值越高（越接近1），表明拟合度越好。'
- en: These evaluation metrics will help us assess how well our linear regression
    model is performing in predicting the “Yearly Amount Spent” by customers.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 这些评估指标将帮助我们评估我们的线性回归模型在预测客户“年度花费”方面的表现。
- en: Let me know if you have any questions or if you’d like further explanation on
    any part!
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或需要进一步解释任何部分，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: We execute the code and it runs perfectly fine without any errors and prints
    the **mean-squared error** (**MSE**) and the coefficient of determination (`R-squared`).
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 我们执行代码，它运行得非常完美，没有任何错误，并打印出**均方误差**（MSE）和决定系数（`R-squared`）。
- en: '![A screenshot of a computer  Description automatically generated](img/B21232_13_07.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![计算机屏幕截图，自动生成描述](img/B21232_13_07.png)'
- en: 'Figure 13.7: Model evaluation output'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.7：模型评估输出
- en: 'For those new to machine learning, it’s crucial to assess whether the model
    performance meets acceptable standards. Once more, we’ll seek assistance from
    ChatGPT and furnish it with the output for evaluation:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 对于机器学习的新手来说，评估模型性能是否符合可接受标准至关重要。我们将再次寻求ChatGPT的帮助，并给它提供输出以供评估：
- en: '[P**rompt]**'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: '[PRE9]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[E**nd of prompt]**'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response from ChatGPT explaining the results, which suggests
    that our model is actually performing very well given that R-squared is very close
    to 1:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该从ChatGPT那里收到一个解释结果的响应，这表明鉴于R-squared非常接近1，我们的模型实际上表现非常好：
- en: '[P**rompt response]**'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应提示]**'
- en: 'The evaluation metrics indicate that our linear regression model performs quite
    well on the testing data:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 评估指标表明，我们的线性回归模型在测试数据上的表现相当好：
- en: '**Mean Squared Error (MSE)**: The MSE value is approximately 109.86\. This
    indicates that, on average, the squared difference between the actual and predicted
    values of the “Yearly Amount Spent” is around 109.86\. Lower MSE values are desirable,
    indicating better model performance.'
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差（MSE）**：MSE的值约为109.86。这表明，平均而言，“年度花费”的实际值和预测值之间的平方差约为109.86。MSE值越低，表明模型性能越好。'
- en: '**R-squared (Coefficient of Determination)**: The R-squared value is approximately
    0.978\. This indicates that approximately 97.8% of the variance in the “Yearly
    Amount Spent” can be explained by the linear regression model. A higher R-squared
    value closer to 1 suggests that the model provides a better fit to the data.'
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**R-squared（决定系数）**：R-squared的值约为0.978。这表明大约97.8%的“年度花费”的方差可以通过线性回归模型来解释。R-squared值越高，越接近1，表明模型对数据的拟合度越好。'
- en: Overall, these evaluation metrics suggest that our linear regression model is
    performing well in predicting the “Yearly Amount Spent” by customers based on
    the provided input features.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，这些评估指标表明，我们的线性回归模型在根据提供的输入特征预测客户“年度花费”方面表现良好。
- en: If you have any further questions or need additional assistance, feel free to
    ask!
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何进一步的问题或需要额外的帮助，请随时提问！
- en: '[E**nd of response]**'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: Having now acquired proficiency in utilizing ChatGPT to construct a linear regression
    model incrementally, we’ll transition to the second feature and delve into the
    application of regularization techniques. While our current model exhibits satisfactory
    performance, regularization can prove invaluable, particularly in scenarios where
    the model is either underfitted or overfitted.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经熟练掌握了利用ChatGPT逐步构建线性回归模型，我们将转向第二个特性，深入探讨正则化技术的应用。虽然我们的当前模型表现令人满意，但正则化可以证明非常有价值，尤其是在模型要么欠拟合要么过拟合的情况下。
- en: 'Feature 2: Applying regularization techniques'
  id: totrans-235
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征2：应用正则化技术
- en: 'We will use the learn and improvise prompting strategy (LIFE 3.1 and 3.2) with
    ChatGPT to understand whether the model could be overfitted and what should be
    done in such a case:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用ChatGPT的“学习和改进提示策略”（LIFE 3.1和3.2）来了解模型是否可能过拟合，以及在这种情况下应该做什么：
- en: '[P**rompt]**'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Could the model be overfitting?
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 模型是否可能过拟合？
- en: '[E**nd of prompt]**'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We receive the response from ChatGPT indicating that it is unlikely that our
    model is overfitted but it does suggest some things to consider such as regularization
    techniques and cross-validation:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们收到ChatGPT的响应，表明我们的模型不太可能过拟合，但它确实建议了一些需要考虑的事项，例如正则化技术和交叉验证：
- en: '[P**rompt response]**'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: It’s essential to consider the possibility of overfitting when interpreting
    the model’s performance. Overfitting occurs when the model learns to capture noise
    or random fluctuations in the training data, rather than the underlying relationships
    between the input features and the target variable. This can result in a model
    that performs well on the training data but generalizes poorly to unseen data.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在解释模型性能时，考虑过拟合的可能性是至关重要的。过拟合发生在模型学会捕捉训练数据中的噪声或随机波动，而不是输入特征与目标变量之间的潜在关系。这可能导致模型在训练数据上表现良好，但在未见过的数据上泛化能力差。
- en: 'Here are a few indicators that suggest overfitting may be occurring:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些表明可能发生过拟合的指标：
- en: '**Large Discrepancy Between Training and Testing Performance**: If the model
    performs significantly better on the training data compared to the testing data,
    it may be overfitting. In our case, if the MSE and R-squared values are much better
    on the training set than on the testing set, it could indicate overfitting.'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**训练和测试性能之间的大差异**：如果模型在训练数据上的表现显著优于测试数据，这可能表明模型过拟合。在我们的案例中，如果MSE和R-squared值在训练集上比在测试集上好得多，这可能表明过拟合。'
- en: '**Complexity of the Model**: Overly complex models with a large number of parameters
    relative to the size of the training data are more prone to overfitting. Linear
    regression is relatively simple, but if you were using a more complex model (e.g.,
    polynomial regression with high-degree polynomials), it could increase the risk
    of overfitting.'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型的复杂性**：与训练数据规模相比，参数数量过多的过于复杂的模型更容易过拟合。线性回归相对简单，但如果你使用的是更复杂的模型（例如，具有高次多项式的多项式回归），这可能会增加过拟合的风险。'
- en: '**Regularization Techniques**: Regularization techniques like Lasso or Ridge
    regression can be applied to mitigate overfitting by penalizing large coefficients.
    If overfitting is suspected, applying regularization may help improve the model’s
    generalization performance.'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**正则化技术**：如Lasso或Ridge回归等正则化技术可以通过惩罚大系数来减轻过拟合。如果怀疑过拟合，应用正则化可能有助于提高模型的泛化性能。'
- en: '**Cross-Validation**: Using cross-validation techniques, such as k-fold cross-validation,
    can provide a more robust estimate of the model’s performance by evaluating it
    on multiple train-test splits of the data. If the model’s performance varies significantly
    across different splits, it could indicate overfitting.'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交叉验证**：通过使用交叉验证技术，例如k折交叉验证，可以在对数据的多个训练-测试分割进行评估时，提供一个更稳健的模型性能估计。如果模型在不同分割上的性能有显著差异，这可能表明模型过拟合。'
- en: In our case, with a high R-squared value and a relatively low MSE on the testing
    data, it’s less likely that the model is overfitting. However, it’s always a good
    practice to explore these indicators and consider additional steps to ensure the
    model’s generalization performance. If you suspect overfitting, you could try
    simplifying the model, applying regularization techniques, or using cross-validation
    to further evaluate its performance.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的情况下，由于测试数据上的R-squared值较高，MSE相对较低，模型过拟合的可能性较小。然而，探索这些指标并考虑采取额外步骤以确保模型泛化性能始终是一个好习惯。如果你怀疑模型过拟合，可以尝试简化模型，应用正则化技术，或使用交叉验证进一步评估其性能。
- en: '[E**nd of response]**'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: 'We will ask ChatGPT to apply regularization and cross-validation techniques:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要求ChatGPT应用正则化和交叉验证技术：
- en: '[P**rompt]**'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt**]'
- en: Let’s try applying regularization techniques first and then cross-validation
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 首先尝试应用正则化技术，然后进行交叉验证
- en: '[E**nd of prompt]**'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt**]'
- en: 'ChatGPT should provide us with the code to apply either Lasso or Ridge along
    with cross-validation and also the explanation:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: ChatGPT应为我们提供应用Lasso或Ridge以及交叉验证的代码，并附上解释：
- en: '[P**rompt response]**'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: Sure! Let’s start by applying regularization techniques to our linear regression
    model. Two common regularization techniques are Lasso regression (L1 regularization)
    and Ridge regression (L2 regularization). These techniques add a penalty term
    to the loss function, which helps prevent overfitting by penalizing large coefficients.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 当然！让我们先对我们的线性回归模型应用正则化技术。两种常见的正则化技术是Lasso回归（L1正则化）和岭回归（L2正则化）。这些技术向损失函数中添加一个惩罚项，通过惩罚大的系数来帮助防止过拟合。
- en: We’ll begin by trying Ridge regression, which adds the squared sum of the coefficients
    (L2 norm) to the loss function.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先尝试岭回归，它将系数的平方和（L2范数）添加到损失函数中。
- en: 'Here’s how you can implement Ridge regression with cross-validation:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 这是如何实现带有交叉验证的岭回归的方法：
- en: '[PRE10]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Explanation:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`RidgeCV(alphas=[0.1, 1.0, 10.0], cv=5)`: This initializes a Ridge regression
    model with cross-validation. The `alphas` parameter specifies the regularization
    strength (alpha values) to be tested, and `cv` specifies the number of folds for
    cross-validation.'
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`RidgeCV(alphas=[0.1, 1.0, 10.0], cv=5)`: 这初始化了一个带有交叉验证的岭回归模型。`alphas`参数指定要测试的正则化强度（alpha值），而`cv`指定交叉验证的折数。'
- en: '`ridge_model.fit(X_train, y_train)`: This trains the Ridge regression model
    using the training data.'
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ridge_model.fit(X_train, y_train)`: 这使用训练数据训练岭回归模型。'
- en: '`ridge_model.predict(X_test)`: This makes predictions on the testing data using
    the trained Ridge regression model.'
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ridge_model.predict(X_test)`: 这使用训练好的岭回归模型对测试数据进行预测。'
- en: '`ridge_mse = mean_squared_error(y_test, ridge_y_pred)`: This calculates the
    mean squared error (`MSE`) between the actual and predicted values using Ridge
    regression.'
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ridge_mse = mean_squared_error(y_test, ridge_y_pred)`: 这使用岭回归计算实际值和预测值之间的均方误差（MSE）。'
- en: '`ridge_model.score(X_test, y_test)`: This calculates the R-squared value (coefficient
    of determination) using Ridge regression.'
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ridge_model.score(X_test, y_test)`: 这使用岭回归计算R平方值（确定系数）。'
- en: '`ridge_model.alpha_`: This attribute returns the best alpha (regularization
    strength) selected by cross-validation.'
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ridge_model.alpha_`: 这个属性返回由交叉验证选出的最佳alpha（正则化强度）。'
- en: Let me know if you’d like to proceed with Ridge regression or if you have any
    questions!
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想继续使用岭回归或者有任何问题，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: Let’s try executing the code and see whether it works and shows any improvement.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试执行代码，看看它是否工作并且是否有改进。
- en: '![A screenshot of a computer program  Description automatically generated](img/B21232_13_08.png)'
  id: totrans-270
  prefs: []
  type: TYPE_IMG
  zh: '![计算机程序截图  自动生成的描述](img/B21232_13_08.png)'
- en: 'Figure 13.8: Ridge regression'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.8：岭回归
- en: 'The code is compatible with previously provided code and the output is very
    similar to the linear regression code. But note that ChatGPT doesn’t need any
    specific instructions and it could generate a perfectly fine executable code.
    Next, we will provide ChatGPT with the output and see what it suggests:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 代码与之前提供的代码兼容，输出与线性回归代码非常相似。但请注意，ChatGPT不需要任何特定指令，它可以生成一个完美的可执行代码。接下来，我们将向ChatGPT提供输出，看看它有什么建议：
- en: '[P**rompt]**'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt**]'
- en: '[PRE11]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[E**nd of prompt]**'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt**]'
- en: 'In this case, ChatGPT has interpreted the results and also provided the code
    for Lasso regression with cross-validation. The response may vary depending on
    the suggestions provided by ChatGPT in previous interactions:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，ChatGPT已经解释了结果，并提供了带有交叉验证的Lasso回归代码。响应可能因ChatGPT在先前交互中提供的建议而有所不同：
- en: '[P**rompt response]**'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: It looks like the Ridge regression model with cross-validation performed quite
    similarly to the standard linear regression model. The **Mean Squared Error**
    (**MSE**) and R-squared values are very close to those obtained from the standard
    linear regression model.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来带有交叉验证的岭回归模型与标准线性回归模型表现相当。**均方误差**（**MSE**）和R平方值与标准线性回归模型得到的值非常接近。
- en: The best alpha selected by cross-validation for the Ridge regression model is
    0.1, indicating that a small amount of regularization was applied to the model.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 岭回归模型通过交叉验证选出的最佳alpha是0.1，这表明模型应用了少量的正则化。
- en: Since the performance of Ridge regression with cross-validation is comparable
    to that of the standard linear regression model, we can conclude that regularization
    did not significantly improve the model’s performance in this case.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 由于带有交叉验证的岭回归的性能与标准线性回归模型相当，我们可以得出结论，在这种情况下，正则化并没有显著提高模型性能。
- en: 'Next, let’s try using Lasso regression (L1 regularization) with cross-validation
    to see if it yields any improvement:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们尝试使用带有交叉验证的Lasso回归（L1正则化）来查看它是否会产生任何改进：
- en: '[PRE12]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Let me know if you’d like to proceed with Lasso regression or if you have any
    questions!
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想继续使用Lasso回归或有任何问题，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]'
- en: We will execute the code and see whether it works and produces any different
    results than Ridge regression.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将执行代码，看看它是否工作，以及它是否会产生与Ridge回归不同的结果。
- en: '![A screenshot of a computer program  Description automatically generated](img/B21232_13_09.png)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
  zh: '![计算机程序截图 自动生成描述](img/B21232_13_09.png)'
- en: 'Figure 13.9: Lasso regression'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.9：Lasso回归
- en: Lasso regression with cross-validation also produced similar results to both
    the standard linear regression and Ridge regression models. The MSE and R-squared
    values are very close to those obtained previously.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 使用交叉验证的Lasso回归也产生了与标准线性回归和Ridge回归模型相似的结果。MSE和R-squared值与之前获得的结果非常接近。
- en: However, it’s important to note that the dataset used here may not be complex
    enough to benefit significantly from regularization techniques. In cases where
    the dataset is larger or more complex, regularization may play a more crucial
    role in preventing overfitting and improving model generalization.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，需要注意的是，这里使用的数据集可能不够复杂，无法从正则化技术中获得显著的好处。在数据集更大或更复杂的情况下，正则化可能在防止过拟合和改善模型泛化方面发挥更关键的作用。
- en: Let’s move to the next feature to generate a synthetic dataset for our problem
    to add complexity.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们转到下一个特征，为我们的问题生成一个合成数据集以增加复杂性。
- en: 'Feature 3: Generating a synthetic dataset to add complexity'
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征3：生成一个合成数据集以增加复杂性
- en: 'We will use the conversation style with ChatGPT and ask it to provide code
    to generate a synthetic dataset:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用与ChatGPT的对话风格，并要求它提供生成合成数据集的代码：
- en: '[P**rompt]**'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]'
- en: Can you please provide me a code to generate the synthetic dataset for it to
    add complexity?
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 请提供一段生成合成数据集的代码，以便增加其复杂性？
- en: '[E**nd of prompt]**'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]'
- en: 'You may receive a variant of the following response. However, you may notice
    that this is generic code and is not suitable for generating the code specific
    to our dataset. Hence, we will need to refine the prompt by providing feedback
    to ChatGPT:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会收到以下响应的变体。然而，你可能注意到这只是一个通用的代码，并不适合生成针对我们数据集的特定代码。因此，我们需要通过向ChatGPT提供反馈来细化提示：
- en: '[P**rompt response]**'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]'
- en: Sure! We can generate a synthetic dataset with additional complexity using the
    `make_regression` function from the `sklearn.datasets` module. This function generates
    a random regression problem with specified characteristics, such as the number
    of samples, the number of features, and the noise level.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 当然！我们可以使用`sklearn.datasets`模块中的`make_regression`函数生成一个具有额外复杂性的合成数据集。这个函数生成一个具有指定特征的随机回归问题，例如样本数量、特征数量和噪声水平。
- en: 'Here’s how you can generate a synthetic dataset with added complexity:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是如何生成一个具有增加复杂性的合成数据集的方法：
- en: '[PRE13]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Explanation:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: '`make_regression(n_samples=500, n_features=10, noise=50, random_state=42)`:
    This function generates a synthetic regression dataset with 500 samples, 10 features,
    and increased noise level (specified by the noise parameter). The `random_state`
    parameter ensures reproducibility.'
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`make_regression(n_samples=500, n_features=10, noise=50, random_state=42)`:
    这个函数生成一个包含500个样本、10个特征和增加的噪声水平（由噪声参数指定）的合成回归数据集。`random_state`参数确保了可重复性。'
- en: '`pd.DataFrame(X_synthetic, columns=[f''Feature_{i}'' for i in range(1, 11)])`:
    This creates a DataFrame from the synthetic input features (`X_synthetic`) and
    assigns column names `''Feature_1''` to `''Feature_10''`.'
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pd.DataFrame(X_synthetic, columns=[f''Feature_{i}'' for i in range(1, 11)])`:
    这将从合成输入特征（`X_synthetic`）创建一个DataFrame，并将列名从`''Feature_1''`到`''Feature_10''`分配。'
- en: '`synthetic_data[''Target''] = y_synthetic`: This adds the synthetic target
    variable (`y_synthetic`) to the DataFrame with the column name `''Target''`.'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`synthetic_data[''Target''] = y_synthetic`: 这将合成目标变量（`y_synthetic`）添加到具有列名`''Target''`的DataFrame中。'
- en: '`synthetic_data.to_csv(''synthetic_dataset.csv'', index=False)`: This saves
    the synthetic dataset to a CSV file named `''synthetic_dataset.csv''` without
    including the `index` column.'
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`synthetic_data.to_csv(''synthetic_dataset.csv'', index=False)`: 这将合成数据集保存到名为`''synthetic_dataset.csv''`的CSV文件中，不包括`index`列。'
- en: You can adjust the parameters of the `make_regression` function to control the
    complexity of the synthetic dataset, such as the number of samples, the number
    of features, and the noise level.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以调整`make_regression`函数的参数来控制合成数据集的复杂性，例如样本数量、特征数量和噪声水平。
- en: Let me know if you need further assistance!
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要进一步的帮助，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will simply instruct ChatGPT that we need the code for our dataset:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将简单地指示ChatGPT我们需要为我们的数据集编写代码：
- en: '[P**rompt]**'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: No, I meant for our problem.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 不，我是指我们的问题。
- en: '[E**nd of prompt]**'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'Let’s see what ChatGPT suggests and whether it really works:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看ChatGPT的建议，并判断它是否真的有效：
- en: '[P**rompt response]**'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Got it! We can create a synthetic dataset for our problem by using the same
    input features as the original dataset but with added complexity. We’ll generate
    additional features that are nonlinear combinations of the original features and
    add noise to mimic real-world data.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 明白了！我们可以通过使用与原始数据集相同的输入特征，但增加复杂性来为我们的问题创建一个合成数据集。我们将生成额外的特征，这些特征是原始特征的非线性组合，并添加噪声来模拟真实世界的数据。
- en: 'Here’s how you can generate a synthetic dataset with added complexity for our
    problem:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是如何为我们的问题生成具有增加复杂性的合成数据集的方法：
- en: '[PRE14]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Explanation:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 说明：
- en: We generate synthetic input features (`avg_session_length`, `time_on_app`, `time_on_website`,
    `length_of_membership`) using normal distributions with specified mean and standard
    deviation to mimic the characteristics of the original dataset.
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们使用正态分布生成合成输入特征（`avg_session_length`、`time_on_app`、`time_on_website`、`length_of_membership`），并指定均值和标准差来模拟原始数据集的特征。
- en: We generate the synthetic target variable (`yearly_amount_spent`) as a linear
    combination of the input features with added noise.
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们生成合成目标变量（`yearly_amount_spent`）作为输入特征的线性组合，并添加噪声。
- en: Finally, we create a DataFrame from the synthetic dataset and save it to a CSV
    file.
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们创建一个从合成数据集生成的DataFrame，并将其保存到CSV文件中。
- en: This synthetic dataset will have similar characteristics to the original dataset
    but with added complexity, which can be useful for testing models and understanding
    their performance in more challenging scenarios.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 这个合成数据集将具有与原始数据集相似的特征，但增加了复杂性，这对于测试模型和理解它们在更具挑战性的场景中的性能非常有用。
- en: Let me know if you need further clarification or assistance!
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要进一步的澄清或帮助，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: The code looks impressive and is adapted to our dataset. On executing, it runs
    without any errors and generates a CSV file named `synthetic_ecommerce_data.csv`
    and stores it in the runtime environment of the notebook. It also prints the first
    few rows. You can also download it for future use.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 代码看起来很棒，并且已适配我们的数据集。执行时没有错误，并生成一个名为`synthetic_ecommerce_data.csv`的CSV文件，并将其存储在笔记本的运行环境中。它还打印了前几行。您也可以下载它以供将来使用。
- en: Next, we will request ChatGPT to generate the complete code and evaluate model
    performance with the added noise in the synthetic dataset. Let’s move to our next
    feature.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将请求ChatGPT生成完整的代码，并使用合成的数据集中添加的噪声来评估模型性能。让我们转向下一个特性。
- en: 'Feature 4: Generating code to develop a model in a single step for a synthetic
    dataset'
  id: totrans-327
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特性4：为合成的数据集生成单步开发模型的代码
- en: 'We have learned how to create a regression model step by step in previous features,
    hence we will now request ChatGPT to provide the entire code in a single step
    for the synthetic dataset:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的特性中，我们已经学习了如何逐步创建回归模型，因此现在我们将请求ChatGPT为我们提供合成数据集的整个代码：
- en: '[P**rompt]**'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Now provide me the end-to-end code in a single step to run using the generated
    synthetic dataset.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 现在请提供使用生成的合成数据集运行的单步端到端代码。
- en: '[E**nd of prompt]**'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following where complete code is
    provided, including loading the dataset, splitting the dataset, model training,
    and model evaluation:'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似的响应，其中提供了完整的代码，包括加载数据集、分割数据集、模型训练和模型评估：
- en: '[P**rompt response]**'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Certainly! Below is the end-to-end code that loads the synthetic dataset, splits
    it into training and testing sets, trains a linear regression model, evaluates
    its performance, and prints the evaluation metrics.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 当然！下面是端到端代码，该代码加载合成数据集，将其分割为训练集和测试集，训练线性回归模型，评估其性能，并打印评估指标。
- en: '[PRE15]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This code will load the synthetic dataset from the CSV file, split it into training
    and testing sets, train a linear regression model using the training data, make
    predictions on the testing data, evaluate the model’s performance using Mean Squared
    Error (MSE) and R-squared (Coefficient of Determination), and print the evaluation
    metrics.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码将从CSV文件中加载合成数据集，将其分为训练集和测试集，使用训练数据训练线性回归模型，对测试数据进行预测，使用均方误差（MSE）和R-squared（决定系数）评估模型性能，并打印评估指标。
- en: You can simply run this code in your Python environment, assuming you have the
    pandas library installed to work with DataFrames and the scikit-learn library
    installed for machine learning functionalities.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已安装pandas库以处理数据框，并且已安装scikit-learn库以实现机器学习功能，则可以直接在您的Python环境中运行此代码。
- en: Let me know if you have any questions or if there’s anything else I can assist
    you with!
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有任何问题或需要我提供其他帮助，请告诉我！
- en: '[E**nd of response]**'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]'
- en: We execute the code and it runs seamlessly.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 我们执行了代码，它运行得非常顺畅。
- en: 'The evaluation metrics for the linear regression model trained on the synthetic
    dataset are as follows:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 在合成数据集上训练的线性回归模型的评估指标如下：
- en: '**MSE**: Approximately 2103.19'
  id: totrans-342
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差（MSE）**：大约为2103.19'
- en: '**R-squared (coefficient of determination)**: Approximately 0.9197'
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**R-squared（决定系数）**：约为0.9197'
- en: 'These metrics provide insight into the model’s performance:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 这些指标提供了对模型性能的洞察：
- en: '**MSE**: The MSE measures the average squared difference between the actual
    and predicted values. In this case, the MSE indicates that, on average, the squared
    difference between the actual and predicted yearly amount spent is approximately
    2103.19\. Lower MSE values are desirable, indicating better model performance.'
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差（MSE）**：MSE衡量实际值和预测值之间平均平方差的度量。在这种情况下，MSE表明，平均而言，实际值和预测的年度消费金额之间的平方差约为2103.19。较低的MSE值是期望的，表示模型性能更好。'
- en: '**R-squared (coefficient of determination)**: The R-squared value represents
    the proportion of the variance in the target variable (`Yearly Amount Spent`)
    that is explained by the model. In this case, the R-squared value of approximately
    0.9197 suggests that approximately 91.97% of the variance in the yearly amount
    spent can be explained by the linear regression model. A higher R-squared value
    closer to 1 indicates a better fit.'
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**R-squared（决定系数）**：R-squared值表示模型解释的目标变量（年度消费金额）变差的比例。在这种情况下，R-squared值约为0.9197，表明大约91.97%的年度消费金额变差可以通过线性回归模型解释。R-squared值越接近1，表示拟合度越好。'
- en: Overall, these evaluation metrics suggest that the linear regression model performs
    reasonably well on the synthetic dataset.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，这些评估指标表明线性回归模型在合成数据集上表现良好。
- en: 'In the context of the online e-commerce store, the insights from these models
    can be used for various purposes:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 在在线电子商务商店的背景下，这些模型的洞察力可用于多种目的：
- en: '**Customer segmentation**: The models can help identify high-value customers
    based on their predicted `Yearly Amount Spent`, allowing for targeted marketing
    efforts.'
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**客户细分**：这些模型可以帮助根据预测的`年度消费金额`识别高价值客户，从而实现有针对性的营销活动。'
- en: '**Recommendation systems**: Understanding the factors that influence spending
    can be used to improve product recommendations and enhance the customer shopping
    experience.'
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推荐系统**：理解影响消费的因素可以用来改进产品推荐并提升顾客购物体验。'
- en: '**Retention strategies**: `Length of Membership` appears to be an important
    factor. Strategies to increase customer retention and loyalty can be developed
    based on this insight.'
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**保留策略**：`会员时长`似乎是一个重要因素。可以根据这一洞察力制定提高客户保留和忠诚度的策略。'
- en: '**Optimizing website and app**: Insights into the impact of `Average Session
    Length`, `Time on App`, and `Time on Website` can guide decisions on website and
    app optimization.'
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**优化网站和应用程序**：对`平均会话时长`、`应用程序使用时间`和`网站使用时间`的影响进行了解，可以指导网站和应用程序优化的决策。'
- en: This concludes our learning with ChatGPT 3.5\. Now, let’s see how prompting
    and learning differ with ChatGPT Plus.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 这标志着我们使用ChatGPT 3.5的学习结束。现在，让我们看看ChatGPT Plus中提示和学习的区别。
- en: Learning simple linear regression using ChatGPT Plus
  id: totrans-354
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ChatGPT Plus学习简单线性回归
- en: Now that we have learned about simple linear regression while using ChatGPT,
    let’s learn about linear regression while using ChatGPT Plus. ChatGPT Plus, or
    GPT-4, includes the ability to upload datasets, analyze the dataset, and produce
    results if using simple libraries such as Python and Matplotlib. At the time of
    writing this chapter, it had a GPT assistant named **Data Analysis**, provided
    by OpenAI when using the mobile app. You could also select GPT-4 if using the
    browser version.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经通过使用 ChatGPT 学习了简单线性回归，让我们在使用 ChatGPT Plus 的同时学习线性回归。ChatGPT Plus，或 GPT-4，包括上传数据集、分析数据集以及使用
    Python 和 Matplotlib 等简单库产生结果的能力。在撰写本章时，它有一个名为 **数据分析** 的 GPT 助手，由 OpenAI 在使用移动应用时提供。您也可以选择使用浏览器版本的
    GPT-4。
- en: Note that you can also achieve the same using the free version but would need
    to execute the code yourself and modify the prompt.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，您也可以使用免费版本实现相同的功能，但需要自行执行代码并修改提示。
- en: 'Feature 1: Building a simple linear regression model step by step'
  id: totrans-357
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征 1：逐步构建简单的线性回归模型
- en: We have learned how to create a regression model step by step using the free
    version of ChatGPT where we had to provide the dataset description, instructions
    on from where to load, and code compatible with Jupyter Notebook. In the case
    of ChatGPT Plus, all of that is taken care of by ChatGPT Plus and it also provides
    a runtime environment to execute the code.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经学习了如何使用 ChatGPT 的免费版本逐步创建回归模型，其中我们需要提供数据集描述、从哪里加载的说明以及与 Jupyter Notebook
    兼容的代码。在 ChatGPT Plus 的情况下，所有这些都被 ChatGPT Plus 处理，并且它还提供了一个代码执行环境。
- en: 'Note that it cannot run TensorFlow, Keras, or deep learning libraries:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，它不能运行 TensorFlow、Keras 或深度学习库：
- en: '[P**rompt]**'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: I want to create a simple linear regression model to predict the “Yearly Amount
    Spent” (TAG 1.1) by customers for the attached e-commerce customers dataset (PIC
    2.3)
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 我想创建一个简单的线性回归模型来预测附件中电子商务客户数据集（PIC 2.3）的“年度消费金额”（TAG 1.1）。
- en: 'I am a beginner user (PIC 2.1), so please provide step-by-step code and strictly
    follow the following instructions (PIC 2.2):'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 我是一个初学者用户（PIC 2.1），所以请提供逐步的代码，并严格遵循以下说明（PIC 2.2）：
- en: Ensure that there are detailed comments for each line of code.
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保每行代码都有详细的注释。
- en: You have to explain each line of code and provide one step at a time and wait
    for users feedback
  id: totrans-364
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须解释每一行代码，并一次提供一个步骤，并等待用户反馈
- en: '[E**nd of prompt]**'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following where the complete code
    is provided, including loading the dataset, splitting the dataset, model training,
    and model evaluation:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，其中提供了完整的代码，包括加载数据集、分割数据集、模型训练和模型评估：
- en: '[P**rompt response]**'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Great! Let’s start building a simple linear regression model using Python. We’ll
    be using libraries such as `pandas` for handling the data and `sklearn` for creating
    the regression model.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！让我们开始使用 Python 构建一个简单的线性回归模型。我们将使用 `pandas` 处理数据，以及 `sklearn` 创建回归模型。
- en: 'Step 1: Import Libraries and Load Data'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤 1：导入库和加载数据
- en: First, we’ll import necessary libraries and load your dataset. We’ll also take
    a look at the first few rows of the dataset to understand its structure.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将导入必要的库并加载数据集。我们还将查看数据集的前几行，以了解其结构。
- en: 'Here’s the code for this step:'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 这是这个步骤的代码：
- en: '[PRE16]'
  id: totrans-372
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'This block of code does the following:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码执行以下操作：
- en: '**Imports libraries**: We load `pandas` for data handling, and several modules
    from `sklearn` for splitting the data and performing linear regression.'
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**导入库**: 我们加载 `pandas` 用于数据处理，以及 `sklearn` 的几个模块用于分割数据和执行线性回归。'
- en: '**Loads the data**: The `pd.read_csv` function reads the CSV file into a DataFrame,
    which is a 2-dimensional labeled data structure with columns of potentially different
    types.'
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加载数据**: `pd.read_csv` 函数将 CSV 文件读取到 DataFrame 中，它是一个二维的标签化数据结构，具有可能不同类型的列。'
- en: '**Prints the first few rows**: This helps us see the initial rows of our dataset
    to understand the available data and its format.'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**打印前几行**: 这有助于我们查看数据集的前几行，以便了解可用的数据和其格式。'
- en: Let’s execute this step and check the output to ensure everything is loaded
    correctly and to understand what your data looks like. Shall we proceed?
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们执行这个步骤并检查输出，以确保一切加载正确，并了解您的数据看起来如何。我们继续吗？
- en: '[E**nd of response]**'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to proceed:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示 ChatGPT 继续操作：
- en: '[P**rompt]**'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Yes, please.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: We should receive a response similar to the following, where ChatGPT has executed
    the code and printed the first few rows.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，其中ChatGPT执行了代码并打印了前几行。
- en: 'Note that the file is loaded in ChatGPT’s run time environment; if you need
    to execute code in your local environment or Jupyter Colab, you would be required
    to modify the step to read CSV:'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，文件是在ChatGPT的运行时环境中加载的；如果您需要在本地环境或Jupyter Colab中执行代码，您将需要修改步骤以读取CSV：
- en: '[P**rompt response]**'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: 'Here’s the snapshot of the first few rows of your dataset:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 这是您数据集的前几行的快照：
- en: '| Email | Address | Avatar | Avg. Session Length | Time on App | Time on Website
    | Length of Membership | Yearly Amount Spent |'
  id: totrans-387
  prefs: []
  type: TYPE_TB
  zh: '| 邮箱 | 地址 | 头像 | 平均会话时长 | 应用程序使用时间 | 网站使用时间 | 会员时长 | 年度消费金额 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-388
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| mstephenson@fernandez.com | 835 Frank Tunnel Wrightmouth, MI 82180-9605 |
    Violet | 34.497268 | 12.655651 | 39.577668 | 4.082621 | 587.951054 |'
  id: totrans-389
  prefs: []
  type: TYPE_TB
  zh: '| mstephenson@fernandez.com | 835 Frank Tunnel Wrightmouth, MI 82180-9605 |
    Violet | 34.497268 | 12.655651 | 39.577668 | 4.082621 | 587.951054 |'
- en: '| hduke@hotmail.com | 4547 Archer Common Diazchester, CA 06566-8576 | DarkGreen
    | 31.926272 | 11.109461 | 37.268959 | 2.664034 | 392.204933 |'
  id: totrans-390
  prefs: []
  type: TYPE_TB
  zh: '| hduke@hotmail.com | 4547 Archer Common Diazchester, CA 06566-8576 | DarkGreen
    | 31.926272 | 11.109461 | 37.268959 | 2.664034 | 392.204933 |'
- en: '| pallen@yahoo.com | 24645 Valerie Unions Suite 582 Cobbborough, ... | Bisque
    | 33.000915 | 11.330278 | 37.110597 | 4.104543 | 487.547505 |'
  id: totrans-391
  prefs: []
  type: TYPE_TB
  zh: '| pallen@yahoo.com | 24645 Valerie Unions Suite 582 Cobbborough, ... | Bisque
    | 33.000915 | 11.330278 | 37.110597 | 4.104543 | 487.547505 |'
- en: '| riverarebecca@gmail.com | 1414 David Throughway Port Jason, OH 22070-1220
    | SaddleBrown | 34.305557 | 13.717514 | 36.721283 | 3.120179 | 581.852344 |'
  id: totrans-392
  prefs: []
  type: TYPE_TB
  zh: '| riverarebecca@gmail.com | 1414 David Throughway Port Jason, OH 22070-1220
    | SaddleBrown | 34.305557 | 13.717514 | 36.721283 | 3.120179 | 581.852344 |'
- en: '| mstephens@davidson-herman.com | 14023 Rodriguez Passage Port Jacobville,
    PR 3... | MediumAquaMarine | 33.330673 | 12.795189 | 37.536653 | 4.446308 | 599.406092
    |'
  id: totrans-393
  prefs: []
  type: TYPE_TB
  zh: '| mstephens@davidson-herman.com | 14023 Rodriguez Passage Port Jacobville,
    PR 3... | MediumAquaMarine | 33.330673 | 12.795189 | 37.536653 | 4.446308 | 599.406092
    |'
- en: The dataset includes both customer contact information (like `Email` and `Address`)
    and numerical data related to their interaction with the e-commerce platform (like
    “Avg. Session Length”, “Time on App”, “Time on Website”, and “Length of Membership”).
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集包括客户联系信息（如“邮箱”和“地址”）以及与他们与电子商务平台互动相关的数值数据（如“平均会话时长”、“应用程序使用时间”、“网站使用时间”和“会员时长”）。
- en: 'Step 2: Data Preparation'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 第2步：数据准备
- en: 'The next step will involve preparing the data for our linear regression model.
    This includes:'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步将涉及为我们的线性回归模型准备数据。这包括：
- en: Selecting the relevant numerical columns for the prediction.
  id: totrans-397
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择用于预测的相关数值列。
- en: Splitting the data into a training set and a testing set.
  id: totrans-398
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数据分为训练集和测试集。
- en: Do you have any specific columns you want to use for predicting “Yearly Amount
    Spent”, or should I proceed with a general approach using all numerical columns?
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否有特定的列想要用于预测“年度消费金额”，或者我应该使用所有数值列的一般方法继续操作？
- en: '[E**nd of response]**'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to proceed using numerical columns:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT使用数值列继续操作：
- en: '[P**rompt]**'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Please use only numerical columns.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 请仅使用数值列。
- en: '[E**nd of prompt]**'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    code for selecting the features, splitting the dataset, and printing the shape:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，其中ChatGPT提供了选择特征、分割数据集和打印形状的代码：
- en: '[P**rompt response]**'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: 'Step 2: Data Preparation'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 第2步：数据准备
- en: 'We’ll now proceed with the following steps in preparing the data:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将进行以下步骤来准备数据：
- en: '**Selecting the relevant columns**: We’ll include the columns that are numerical
    and directly relate to customer behavior.'
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选择相关列**：我们将包括与客户行为直接相关的数值列。'
- en: '**Splitting the data into training and testing sets**: This helps us evaluate
    our model on unseen data to ensure it performs well generally.'
  id: totrans-410
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**将数据分为训练集和测试集**：这有助于我们评估模型在未见数据上的表现，以确保其总体表现良好。'
- en: 'Here’s the code to perform these steps:'
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 这是执行这些步骤的代码：
- en: '[PRE17]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'This block of code:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码：
- en: '**Selects features and target**: We separate the columns for the features and
    the target variable which is what we aim to predict.'
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选择特征和目标**：我们将分离特征列和目标变量，这是我们想要预测的内容。'
- en: '**Splits the data**: Using `train_test_split`, we divide the data into training
    and testing sets. The `test_size=0.2` means 20% of the data is reserved for testing.
    `random_state` is set for reproducibility of results.'
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分割数据**：使用`train_test_split`将数据分为训练集和测试集。`test_size=0.2`表示20%的数据被保留用于测试。`random_state`被设置以确保结果的重复性。'
- en: '**Prints shapes**: We print the shapes of our training and testing sets to
    confirm the split was successful.'
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**打印形状**：我们打印训练集和测试集的形状，以确认分割成功。'
- en: Should we run this part of the code to prepare the data and check the split?
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该运行这段代码来准备数据并检查分割吗？
- en: '[E**nd of response]**'
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to proceed with code execution:'
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT继续执行代码：
- en: '[P**rompt]**'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Yes, please.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has executed
    the code and printed the shape of features and labels:'
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似于以下响应，其中ChatGPT已执行代码并打印了特征和标签的形状：
- en: '[P**rompt response]**'
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: 'The data has been successfully split into training and testing sets. Here’s
    the breakdown:'
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 数据已成功分割为训练集和测试集。以下是分解：
- en: '**Training features shape**: 400 rows and 4 columns'
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**训练特征形状**：400行和4列'
- en: '**Testing features shape**: 100 rows and 4 columns'
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**测试特征形状**：100行和4列'
- en: '**Training labels shape**: 400 values'
  id: totrans-428
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**训练标签形状**：400个值'
- en: '**Testing labels shape**: 100 values'
  id: totrans-429
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**测试标签形状**：100个值'
- en: This indicates that 80% of the data is used for training the model, and 20%
    is reserved for testing the model’s performance.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明80%的数据用于训练模型，20%的数据被保留用于测试模型性能。
- en: 'Step 3: Building the Linear Regression Model'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 第3步：构建线性回归模型
- en: 'Now, we’ll create and train the linear regression model using the training
    data. Here’s the plan:'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将使用训练数据创建并训练线性回归模型。以下是计划：
- en: '**Initialize the linear regression model**: This involves setting up our model
    ready to be fitted to the data.'
  id: totrans-433
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**初始化线性回归模型**：这涉及到设置我们的模型，使其准备好拟合数据。'
- en: '**Fit the model to the training data**: This is where the model learns the
    relationship between the features and the target from the training data.'
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**将模型拟合到训练数据**：这是模型从训练数据中学习特征与目标之间关系的地方。'
- en: '**Evaluate the model on the training data**: This step is to get a quick check
    on how well our model has learned from the training data.'
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在训练数据上评估模型**：这一步是为了快速检查我们的模型从训练数据中学到了多少。'
- en: Shall I proceed with this next step and show you the code to build and evaluate
    the model on the training data?
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: 我应该继续进行下一步，并展示如何构建和评估训练数据上的模型吗？
- en: '[E**nd of response]**'
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to proceed to the next steps:'
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT继续下一步：
- en: '[P**rompt]**'
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Yes, Please.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    the code:'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似于以下响应，其中ChatGPT提供了代码：
- en: '[P**rompt response]**'
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Let’s move on to building and training the linear regression model.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续构建和训练线性回归模型。
- en: 'Step 3: Building the Linear Regression Model'
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 第3步：构建线性回归模型
- en: 'Here’s the code to create, train, and initially evaluate the linear regression
    model:'
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是创建、训练和初步评估线性回归模型的代码：
- en: '[PRE18]'
  id: totrans-447
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'This code does the following:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码执行以下操作：
- en: '**Initializes the model**: `LinearRegression()` is called to create a linear
    regression model.'
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**初始化模型**：调用`LinearRegression()`创建线性回归模型。'
- en: '**Fits the model**: `model.fit(X_train, y_train)` adjusts weights on the regression
    line to fit the input features and the target output.'
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拟合模型**：`model.fit(X_train, y_train)`调整回归线上的权重，以适应输入特征和目标输出。'
- en: '**Makes predictions**: `model.predict(X_train)` is used to see how well the
    model has learned to predict the training data.'
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**进行预测**：使用`model.predict(X_train)`来查看模型学习预测训练数据的效果如何。'
- en: '**Calculates errors**: `mean_absolute_error` and `mean_squared_error` provide
    metrics to gauge the model’s accuracy and performance by comparing the predicted
    values against the actual values.'
  id: totrans-452
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计算误差**：`mean_absolute_error`和`mean_squared_error`通过比较预测值与实际值来提供衡量模型准确性和性能的指标。'
- en: Would you like me to run this code now to see how the model performs on the
    training data?
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 你希望我现在运行这段代码，看看模型在训练数据上的表现如何吗？
- en: '[E**nd of response]**'
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to proceed:'
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT继续：
- en: '[P**rompt]**'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Yes, Please.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has executed
    the code and printed the results:'
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该会收到以下类似的响应，其中ChatGPT已执行代码并打印了结果：
- en: '[P**rompt response]**'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: '[**提示响应**]'
- en: 'The linear regression model has been successfully trained on the dataset, and
    here are the performance metrics on the training data:'
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 线性回归模型已在数据集上成功训练，以下是训练数据上的性能指标：
- en: '**Mean Absolute Error (MAE) on training data**: 7.727'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: '**训练数据上的均方绝对误差 (MAE)**: 7.727'
- en: '**Mean Squared Error (MSE) on training data**: 95.823'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: '**训练数据上的均方误差 (MSE)**: 95.823'
- en: 'These metrics help us understand the average errors made by the model in predictions:'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 这些指标帮助我们了解模型在预测中犯的平均误差：
- en: '**MAE** tells us that, on average, the model’s predictions are approximately
    7.73 units away from the actual values.'
  id: totrans-465
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MAE** 告诉我们，平均而言，模型的预测值与实际值相差大约7.73个单位。'
- en: '**MSE** indicates a slightly larger error in the predictions, considering it
    squares the errors, emphasizing larger discrepancies.'
  id: totrans-466
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MSE** 表示预测中存在略微更大的误差，因为它平方了误差，强调了更大的差异。'
- en: 'Next Steps:'
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步：
- en: Now, the model is trained and preliminarily evaluated on the training set. We
    should now test its performance on the unseen testing set to truly evaluate its
    effectiveness.
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，模型已在训练集上训练并初步评估。我们应该现在测试它在未见过的测试集上的性能，以真正评估其有效性。
- en: Would you like to proceed with testing the model on the testing set and seeing
    how it performs with new data?
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 你想要继续在测试集上测试模型并查看它在新数据上的表现吗？
- en: '[E**nd of response]**'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: '[**响应结束**]'
- en: 'We will instruct ChatGPT to proceed with testing the model performance on the
    test set:'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示ChatGPT继续测试模型在测试集上的性能：
- en: '[P**rompt]**'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: '[**提示**]'
- en: Yes, please.
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: '[**提示结束**]'
- en: 'We should receive a response similar to the following, where ChatGPT has executed
    the code and printed the results:'
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该会收到以下类似的响应，其中ChatGPT已执行代码并打印了结果：
- en: '[P**rompt response]**'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: '[**提示响应**]'
- en: 'The evaluation of the model on the testing set yielded the following results:'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试集上对模型的评估产生了以下结果：
- en: '**Mean Absolute Error (MAE) on testing data**: 8.558'
  id: totrans-478
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**测试数据上的均方误差 (MAE)**: 8.558'
- en: '**Mean Squared Error (MSE) on testing data**: 109.864'
  id: totrans-479
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**测试数据上的均方误差 (MSE)**: 109.864'
- en: 'These results tell us the following:'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果告诉我们以下信息：
- en: The **MAE** of 8.558 suggests that the model’s predictions on the testing data
    are, on average, about 8.56 units away from the actual values. This is slightly
    worse than the training MAE, which is to be expected as the model is now predicting
    data it hasn’t seen before.
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 8.558的**MAE**表明，模型在测试数据上的预测值平均而言，与实际值相差大约8.56个单位。这略差于训练MAE，这是可以预料的，因为模型现在正在预测它之前未见过的数据。
- en: The **MSE** of 109.864 is also higher than the training MSE, indicating that
    some predictions have larger errors.
  id: totrans-482
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 109.864的**MSE**也高于训练MSE，这表明某些预测的误差更大。
- en: 'Summary:'
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要：
- en: The model performs reasonably well but shows a typical behavior of slightly
    reduced performance on the testing data compared to the training data. This is
    normal and indicates that the model is generalizing as expected without significant
    overfitting or underfitting.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 模型表现相当不错，但与训练数据相比，在测试数据上表现出轻微的降低性能，这是正常的，表明模型正在按预期泛化，没有出现显著的过拟合或欠拟合。
- en: 'Final Steps:'
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 最终步骤：
- en: 'You now have a functioning linear regression model that can predict the “Yearly
    Amount Spent” based on customer behavior metrics. Depending on your goals, you
    might want to explore further:'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经拥有了一个可以基于客户行为指标预测“年度消费金额”的线性回归模型。根据你的目标，你可能想要进一步探索：
- en: '**Improving the model**: You could look into more sophisticated modelling techniques
    or feature engineering.'
  id: totrans-487
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**改进模型**：你可以考虑更复杂的建模技术或特征工程。'
- en: '**Model interpretation**: Analyse the coefficients of the model to understand
    the impact of each feature.'
  id: totrans-488
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型解释**：分析模型的系数以了解每个特征的影响。'
- en: Would you like to explore any of these additional steps or need further assistance
    with something else?
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: 你想要探索这些额外的步骤，或者需要进一步的帮助吗？
- en: '[E**nd of response]**'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: '[**响应结束**]'
- en: We have seen that similar to the free version, ChatGPT Plus does a pretty good
    job in creating a simple linear regression model step by step, by providing the
    code as well as executing it for us. Next, we will see whether the Plus version
    can apply the regularization techniques.
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到，与免费版本类似，ChatGPT Plus 通过提供代码以及为我们执行代码的方式，一步一步地创建了一个简单的线性回归模型，做得相当不错。接下来，我们将看看
    Plus 版本是否可以应用正则化技术。
- en: 'Feature 2: Applying regularization techniques'
  id: totrans-492
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功能 2：应用正则化技术
- en: 'We will ask ChatGPT Plus to apply regularization techniques:'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要求 ChatGPT Plus 应用正则化技术：
- en: '[P**rompt]**'
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Can you please apply Lasso, Ridge, and cross-validation to check whether it
    leads to any improvement?
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 请问你能应用 Lasso、Ridge 和交叉验证来检查它是否会导致任何改进吗？
- en: '[E**nd of prompt]**'
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    the code for Lasso and Ridge, along with cross-validation:'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到类似于以下响应，其中 ChatGPT 提供了 Lasso 和 Ridge 以及交叉验证的代码：
- en: '[P**rompt response]**'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: 'Step 5: Applying Lasso and Ridge Regression with Cross-Validation'
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 第 5 步：应用 Lasso 和 Ridge 回归与交叉验证
- en: 'Lasso Regression:'
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: Lasso 回归：
- en: Lasso regression not only helps in reducing overfitting but can also be used
    for feature selection since it can shrink the coefficients of less important features
    to zero.
  id: totrans-501
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Lasso 回归不仅有助于减少过拟合，还可以用于特征选择，因为它可以将不太重要的特征的系数缩小到零。
- en: 'Ridge Regression:'
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: Ridge 回归：
- en: Ridge regression reduces the model complexity by imposing a penalty on the size
    of coefficients.
  id: totrans-503
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ridge 回归通过对系数大小施加惩罚来降低模型复杂性。
- en: We’ll use the scikit-learn library, which provides convenient functions to perform
    these analyses.
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 scikit-learn 库，它提供了方便的函数来执行这些分析。
- en: 'Here’s the code to apply Lasso and Ridge with cross-validation:'
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是应用 Lasso 和 Ridge 以及交叉验证的代码：
- en: '[PRE19]'
  id: totrans-506
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'This code performs the following:'
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码执行以下操作：
- en: '**LassoCV and RidgeCV**: These are Lasso and Ridge regression methods with
    built-in cross-validation of the alpha parameter.'
  id: totrans-508
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**LassoCV 和 RidgeCV**：这些是带有内置 alpha 参数交叉验证的 Lasso 和 Ridge 回归方法。'
- en: '**Cross-validation scores**: The `.score()` method returns the R² score that
    indicates the proportion of variance in the dependent variable that is predictable
    from the independent variables.'
  id: totrans-509
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交叉验证分数**：`.score()` 方法返回 R² 分数，表示从独立变量中可预测的因变量方差的比例。'
- en: '**Mean Absolute Error**: This provides an absolute measure of fit quality on
    the testing set.'
  id: totrans-510
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对误差**：这提供了测试集上拟合质量的绝对度量。'
- en: Let’s run this code to see if the regularization and cross-validation can enhance
    the model’s performance. Shall we proceed?
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行这段代码看看正则化和交叉验证是否能提高模型性能。我们继续吗？
- en: '[E**nd of response]**'
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will instruct ChatGPT to execute the code:'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示 ChatGPT 执行代码：
- en: '[P**rompt]**'
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Yes, please.
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，请。
- en: '[E**nd of prompt]**'
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: '**[Prompt response]**'
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: '**[提示响应]**'
- en: In our scenario, ChatGPT encountered an internal error and was unable to execute
    the code. Such errors can occur due to various reasons, including unavailability
    of services at the time of execution, memory issues, or the absence of required
    libraries or dependencies in its runtime environment. It’s important to note that
    you might receive a different response that executes the code flawlessly, as errors
    like these are sporadic. However, we’ve included this scenario to troubleshoot
    and illustrate how to proceed in such cases. Here, we have applied the prompting
    strategy to get feedback from the AI assistant (LIFE 3.3).
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的场景中，ChatGPT 遇到了内部错误，无法执行代码。这种错误可能由于各种原因而发生，包括执行时服务不可用、内存问题或其运行时环境中缺少所需的库或依赖项。重要的是要注意，你可能会收到不同的响应，这些响应可以完美地执行代码，因为这类错误是偶然发生的。然而，我们包括这个场景是为了故障排除并说明在这种情况下如何进行。在这里，我们应用了提示策略以从人工智能助手（LIFE
    3.3）获取反馈。
- en: '[E**nd of response]**'
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'We will now take the suggestion from ChatGPT and execute the code locally using
    Jupyter Colab, and since we are loading the dataset from Google Drive, we will
    provide the instructions in the prompt:'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将根据 ChatGPT 的建议在本地使用 Jupyter Colab 执行代码，因为我们是从 Google Drive 加载数据集，所以我们将在提示中提供说明：
- en: '[P**rompt]**'
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Ok, give me complete code to run locally and note that the file needs to be
    mounted from Google Drive from path `'/content/drive/My Drive/Chapter05/Ecommerce
    Customers.csv'` in the Jupyter notebook.
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，给我完整的本地运行代码，并注意文件需要从 Jupyter 笔记本中的路径 `'/content/drive/My Drive/Chapter05/Ecommerce
    Customers.csv'` 挂载到 Google Drive。
- en: '[E**nd of prompt]**'
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    the complete code:'
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似于以下响应，其中ChatGPT提供了完整的代码：
- en: '[P**rompt response]**'
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应提示]**'
- en: Certainly! Below is the complete code that you can run locally in a Jupyter
    Notebook. This script includes steps for importing the dataset directly from Google
    Drive, preprocessing the data, fitting both Lasso and Ridge regression models
    with cross-validation, and then evaluating them.
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 当然！以下是您可以在本地Jupyter Notebook中运行的完整代码。此脚本包括直接从Google Drive导入数据集、预处理数据、使用交叉验证拟合Lasso和Ridge回归模型，然后评估它们的步骤。
- en: '[PRE20]'
  id: totrans-527
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Instructions for Running the Code:'
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 运行代码的说明：
- en: '**Google Colab Specifics**: The `drive.mount()` function is specific to Google
    Colab and allows you to access files on your Google Drive. If you are not using
    Google Colab, you will need to adjust the file loading method according to your
    development environment.'
  id: totrans-529
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Google Colab特定说明**：`drive.mount()`函数是Google Colab特有的，允许您访问Google Drive上的文件。如果您不使用Google
    Colab，您需要根据您的开发环境调整文件加载方法。'
- en: '**Dependencies**: Ensure you have all required libraries installed. You can
    install them using `pip` (e.g., `pip install pandas scikit-learn google-colab`).'
  id: totrans-530
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**依赖项**：确保您已安装所有必需的库。您可以使用`pip`安装它们（例如，`pip install pandas scikit-learn google-colab`）。'
- en: '**Data Path**: Adjust the `file_path` if your file is located in a different
    directory on your Google Drive.'
  id: totrans-531
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据路径**：如果你的文件位于Google Drive上的不同目录中，请调整`file_path`。'
- en: Run this code in your Jupyter Notebook environment to see how the models perform
    with your data. If you encounter any errors or need further assistance, feel free
    to reach out!
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的Jupyter Notebook环境中运行此代码，以查看模型如何处理你的数据。如果你遇到任何错误或需要进一步的帮助，请随时联系！
- en: '[E**nd of response]**'
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: We execute the code and it runs perfectly fine without any modifications or
    errors. Here, we learned that we can use the hybrid approach of running code within
    ChatGPT Plus or request it to provide the code to execute locally in case of any
    issues.
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: 我们执行代码，它运行得非常好，没有任何修改或错误。在这里，我们了解到我们可以使用在ChatGPT Plus中运行代码的混合方法，或者在出现任何问题时请求它提供在本地执行的代码。
- en: Next, we will move on to Feature 3 of generating a synthetic dataset using ChatGPT
    Plus.
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将继续到功能3，使用ChatGPT Plus生成合成数据集。
- en: 'Feature 3: Generating a synthetic dataset to add complexity'
  id: totrans-536
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功能3：生成合成数据集以增加复杂性
- en: Now, let’s try, if we are able, to generate a synthetic dataset using ChatGPT
    Plus for our dataset. For this purpose, we will use the Data Analyst GPT and start
    a fresh conversation.
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试使用ChatGPT Plus为我们生成数据集。为此，我们将使用数据分析师GPT并开始一次新的对话。
- en: 'Note that specific GPTs can be invoked by providing `@<GPT Name>` in the message
    prompt:'
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，可以通过在消息提示中提供`@<GPT名称>`来调用特定的GPT：
- en: '![A white background with black text  Description automatically generated](img/B21232_13_10.png)Figure
    13.10: Invoking the Data Analyst GPT'
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: '![白色背景，黑色文字，描述自动生成](img/B21232_13_10.png)图13.10：调用数据分析师GPT'
- en: '[P**rompt]**'
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: '@Data Analyst – Provide me the code to generate the synthetic dataset for the
    above dataset from the perspective of predicting `Yearly Amount Spent`, along
    with the code to generate it. <Attach the dataset file here>'
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: '@数据分析师 – 请提供从预测“年度花费”的角度生成上述数据集的合成数据集的代码，以及生成它的代码。 <请在此处附加数据集文件>'
- en: '[E**nd of prompt]**'
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    the code and printed the first few rows:'
  id: totrans-543
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到一个类似于以下响应，其中ChatGPT提供了代码并打印了前几行：
- en: '[P**rompt response]**'
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应提示]**'
- en: To help you generate a synthetic dataset for predicting yearly amount spent,
    I’ll first need to take a look at the structure and content of your provided dataset.
    Let’s start by loading and examining the data from your file. I’ll display the
    first few rows and summary statistics to understand what kind of features we’re
    dealing with. Then, I’ll assist you in creating a synthetic dataset based on this
    structure. Let’s get started with loading the data.
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助您生成预测年度花费的合成数据集，我首先需要查看您提供的数据集的结构和内容。让我们从加载和检查您文件中的数据开始。我将显示前几行和摘要统计信息，以了解我们正在处理什么样的特征。然后，我将协助您根据此结构创建合成数据集。让我们从加载数据开始。
- en: 'The dataset consists of 500 entries with the following features:'
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集包含500个条目，具有以下特征：
- en: '**Email**: The customer’s email address (string).'
  id: totrans-547
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件**：客户的电子邮件地址（字符串）。'
- en: '**Address**: The customer’s address (string).'
  id: totrans-548
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**地址**：客户的地址（字符串）。'
- en: '**Avatar**: The avatar color (string).'
  id: totrans-549
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**头像**：头像颜色（字符串）。'
- en: '**Avg. Session Length**: Average session length in minutes (numeric).'
  id: totrans-550
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均会话时长**：以分钟为单位的平均会话时长（数值）。'
- en: '**Time on App**: Time spent on the app in minutes (numeric).'
  id: totrans-551
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用停留时间**：在应用上花费的时间（以分钟为单位，数值）。'
- en: '**Time on Website**: Time spent on the website in minutes (numeric).'
  id: totrans-552
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网站停留时间**：在网站上花费的时间（以分钟为单位，数值）。'
- en: '**Length of Membership**: Length of membership in years (numeric).'
  id: totrans-553
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会员时长**：以年为单位计算的会员时长（数值）。'
- en: '**Yearly Amount Spent**: Yearly amount spent in dollars (numeric).'
  id: totrans-554
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**年度消费金额**：以美元计算的年度消费金额（数值）。'
- en: To create a synthetic dataset for the purpose of modeling and predicting “Yearly
    Amount Spent”, we can use a technique called **bootstrapping**, which involves
    sampling with replacement from the existing dataset to create a new synthetic
    dataset that has a similar distribution. However, to add some variability and
    simulate a realistic dataset, we can also introduce random noise into the numeric
    fields.
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建用于建模和预测“年度消费金额”的合成数据集，我们可以使用一种称为**重采样**的技术，该技术涉及从现有数据集中有放回地抽样以创建一个新的具有相似分布的合成数据集。然而，为了增加一些变异性并模拟真实数据集，我们还可以在数值字段中引入随机噪声。
- en: 'Here’s a Python code snippet to generate a synthetic dataset using bootstrapping
    and adding noise to the numeric columns:'
  id: totrans-556
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个使用重采样和向数值列添加噪声生成合成数据集的Python代码片段：
- en: '[PRE21]'
  id: totrans-557
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'This code will:'
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码将：
- en: Sample 500 entries from the original dataset, allowing replacements (bootstrapping).
  id: totrans-559
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从原始数据集中抽取500条记录，允许替换（重采样）。
- en: Add Gaussian noise to each numeric column based on 5% of the standard deviation
    of that column.
  id: totrans-560
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据每列标准差的5%向每个数值列添加高斯噪声。
- en: Optionally, the new synthetic dataset can be saved to a CSV file.
  id: totrans-561
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可选地，新的合成数据集可以保存为CSV文件。
- en: Would you like to proceed with generating this synthetic dataset? Or do you
    have any modifications or specific requirements to include in the synthesis process?
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否希望继续生成此合成数据集？或者您在合成过程中有任何修改或特定要求？
- en: '[E**nd of response]**'
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: 'Next, we will instruct ChatGPT to generate the code and provide us with the
    file to download the dataset:'
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将指导ChatGPT生成代码，并为我们提供下载数据集的文件：
- en: '[P**rompt]**'
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Please generate the dataset and make it available to download.
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 请生成数据集并使其可供下载。
- en: '[E**nd of prompt]**'
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has executed
    the code and provided the link to download the synthetic dataset:'
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，其中ChatGPT已执行代码并提供了下载合成数据集的链接：
- en: '[P**rompt response]**'
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: 'The synthetic dataset has been generated and saved. You can download it using
    the link below:'
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: 合成数据集已生成并保存。您可以使用以下链接下载它：
- en: '[PRE22]'
  id: totrans-571
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[E**nd of response]**'
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
  zh: '[响应结束]**'
- en: Here, we learned that ChatGPT Plus can provide the code, execute the code, and
    also generate CSV files available to download.
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们了解到ChatGPT Plus可以提供代码、执行代码，并且生成可供下载的CSV文件。
- en: Next, we will request ChatGPT Plus to generate the complete code and evaluate
    model performance with the added noise in the synthetic dataset. Let’s move to
    our next feature.
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将请求ChatGPT Plus生成完整的代码，并在合成数据集中添加噪声后评估模型性能。让我们转到下一个功能。
- en: 'Feature 4: Generating code to develop a model in a single step for a synthetic
    dataset'
  id: totrans-575
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功能4：为合成数据集生成单步创建模型的代码
- en: '[P**rompt]**'
  id: totrans-576
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示]**'
- en: Can you please generate the complete code to perform linear regression, apply
    Lasso and Ridge regularization techniques on our synthetic dataset, and evaluate
    the model performance?
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 请您生成一个完整的代码，以在我们的合成数据集上执行线性回归，应用Lasso和Ridge正则化技术，并评估模型性能？
- en: '[E**nd of prompt]**'
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示结束]**'
- en: 'We should receive a response similar to the following, where ChatGPT has provided
    the complete code:'
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该收到以下类似的响应，其中ChatGPT提供了完整的代码：
- en: '[P**rompt response]**'
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: '[提示响应]**'
- en: Sure, I can provide you with a Python script that performs linear regression,
    as well as Lasso and Ridge regression, on the synthetic dataset we just created.
    We will also evaluate the model performance using metrics like the R-squared score,
    mean squared error (MSE), and mean absolute error (MAE).
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我可以为您提供一段Python脚本，该脚本可以在我们刚刚创建的合成数据集上执行线性回归，以及Lasso和Ridge回归，我们还将使用R-squared分数、均方误差（MSE）和平均绝对误差（MAE）等指标来评估模型性能。
- en: 'Here is a complete Python code snippet for the whole process:'
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是整个过程的完整Python代码片段：
- en: '[PRE23]'
  id: totrans-583
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Make sure to replace `'/path/to/your/Synthetic_Ecommerce_Customers.csv'` with
    the actual path where your synthetic dataset is stored when running the script
    in your local environment.
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
  zh: 确保在本地环境中运行脚本时，将 `'/path/to/your/Synthetic_Ecommerce_Customers.csv'` 替换为你的合成数据集实际存储的实际路径。
- en: 'This script will:'
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本将：
- en: Load your synthetic dataset.
  id: totrans-586
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加载你的合成数据集。
- en: Select appropriate features and split the data into training and test sets.
  id: totrans-587
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择合适的特征并将数据分为训练集和测试集。
- en: Initialize and train Linear, Lasso, and Ridge regression models.
  id: totrans-588
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始化并训练线性、Lasso 和岭回归模型。
- en: Evaluate and print out the performance metrics for each model.
  id: totrans-589
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估并打印出每个模型的性能指标。
- en: This should help you understand the performance differences and impacts of regularization
    in your predictive models!
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该有助于你理解性能差异和正则化在你预测模型中的影响！
- en: '[E**nd of response]**'
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: 'We will instruct ChatGPT Plus to execute the code for us:'
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指示 ChatGPT Plus 为我们执行代码：
- en: '[P**rompt]**'
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt**]'
- en: Please execute the code.
  id: totrans-594
  prefs: []
  type: TYPE_NORMAL
  zh: 请执行代码。
- en: '[E**nd of prompt]**'
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt**]'
- en: 'ChatGPT Plus should have executed the code and we should receive a response
    similar to the following:'
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: ChatGPT Plus 应已执行代码，我们应该收到以下类似的响应：
- en: '[P**rompt response]**'
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt response**]'
- en: 'The models have been trained and evaluated. Here are the performance metrics
    for each:'
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 模型已经训练和评估。以下是每个模型的性能指标：
- en: 'Linear Regression:'
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
  zh: 线性回归：
- en: '**Mean Squared Error (MSE)**: 133.01'
  id: totrans-600
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差 (MSE)**: 133.01'
- en: '**Mean Absolute Error (MAE)**: 8.79'
  id: totrans-601
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对误差 (MAE)**: 8.79'
- en: '**R-squared (R2)**: 0.977'
  id: totrans-602
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**决定系数 (R2)**: 0.977'
- en: 'Lasso Regression:'
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: Lasso 回归：
- en: '**Mean Squared Error (MSE)**: 133.04'
  id: totrans-604
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差 (MSE)**: 133.04'
- en: '**Mean Absolute Error (MAE)**: 8.79'
  id: totrans-605
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对误差 (MAE)**: 8.79'
- en: '**R-squared (R2)**: 0.977'
  id: totrans-606
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**决定系数 (R2)**: 0.977'
- en: 'Ridge Regression:'
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 岭回归：
- en: '**Mean Squared Error (MSE)**: 133.08'
  id: totrans-608
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差 (MSE)**: 133.08'
- en: '**Mean Absolute Error (MAE)**: 8.79'
  id: totrans-609
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对误差 (MAE)**: 8.79'
- en: '**R-squared (R2)**: 0.977'
  id: totrans-610
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**决定系数 (R2)**: 0.977'
- en: All three models show very similar performance metrics, with high R2 scores
    close to 0.977, indicating that each model explains about 97.7% of the variance
    in the Yearly Amount Spent. The slight differences in MSE and MAE across models
    are minimal, suggesting that regularization (both Lasso and Ridge) does not significantly
    alter the performance in this particular case, possibly due to the absence of
    multicollinearity or other issues that these techniques help address.
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: 所有三个模型都显示出非常相似的性能指标，高 R2 分数接近 0.977，表明每个模型解释了年度消费金额的 97.7% 的方差。模型之间 MSE 和 MAE
    的细微差异很小，表明正则化（Lasso 和岭回归）在此特定情况下并没有显著改变性能，这可能是由于不存在多重共线性或其他这些技术有助于解决的问题。
- en: '[E**nd of response]**'
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of response**]'
- en: By working through this exercise, you’ve not only learned how to perform a regression
    analysis using the free version of ChatGPT and ChatGPT Plus but also how to create
    a linear regression model step by step using your own dataset, apply regularization
    techniques, and generate synthetic datasets.
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 通过完成这个练习，你不仅学习了如何使用 ChatGPT 和 ChatGPT Plus 的免费版本进行回归分析，还学会了如何使用自己的数据集逐步创建线性回归模型，应用正则化技术，并生成合成数据集。
- en: Assignment
  id: totrans-614
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 作业
- en: Generate a single-step code for our dataset and execute it in Google Colab for
    the random forest algorithm.
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: 为我们的数据集生成单步代码，并在 Google Colab 中执行随机森林算法。
- en: Challenge
  id: totrans-616
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 挑战
- en: Can you enhance the following prompt by incorporating prompting strategies to
    ensure the retrieval of a specific dataset, rather than a random one that may
    not exist or may have an incorrect path, ensuring it’s fit for the intended use?
  id: totrans-617
  prefs: []
  type: TYPE_NORMAL
  zh: 你能否通过结合提示策略来增强以下提示，以确保检索到特定的数据集，而不是可能不存在或路径不正确的随机数据集，确保其适用于预期用途？
- en: 'Provide the output from the current prompt as well as the improved prompt:'
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
  zh: 提供当前提示以及改进后的提示的输出：
- en: '[P**rompt]**'
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
  zh: '[P**rompt**]'
- en: Can you please provide me with the complete end-to-end Python code for a publicly
    available advertising dataset along with a detailed explanation that it is compatible
    with the Jupyter Notebook?
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
  zh: 请提供一份完整的端到端 Python 代码，用于公开可用的广告数据集，并详细说明它兼容 Jupyter Notebook。
- en: '[E**nd of prompt]**'
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: '[E**nd of prompt**]'
- en: Summary
  id: totrans-622
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: We explored the application of TAG, PIC, and LIFE prompting strategies in crafting
    regression models, employing both ChatGPT and ChatGPT Plus for rapid analysis
    and predictive tasks. This approach is particularly valuable in the early stages
    of machine learning development, offering immediate insights and the flexibility
    to experiment with different models or algorithms without the burden of managing
    execution environments or programming instances. Additionally, we learned how
    to effectively utilize single prompts for generating comprehensive code. While
    it’s possible to craft prompts for discrete tasks or steps, many of these require
    only succinct lines of code and were not the focus here. Providing feedback is
    instrumental in this process, and validating the output is crucial to ensure the
    code’s functionality.
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: 我们探讨了在构建回归模型中应用 TAG、PIC 和 LIFE 提示策略的应用，同时使用 ChatGPT 和 ChatGPT Plus 进行快速分析和预测任务。这种方法在机器学习发展的早期阶段尤其有价值，它提供了即时的洞察力，并允许在不管理执行环境或编程实例的负担下实验不同的模型或算法。此外，我们还学会了如何有效地利用单个提示来生成全面的代码。虽然可以为离散的任务或步骤创建提示，但其中许多只需要简短的代码行，而这并不是这里的重点。提供反馈在这个过程中至关重要，验证输出对于确保代码的功能性是至关重要的。
- en: In the next chapter, we will learn how to use ChatGPT to generate the code for
    the **multilayer perceptron** (**MLP**) model with the help of the Fashion-MNIST
    dataset.
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何在 Fashion-MNIST 数据集的帮助下，使用 ChatGPT 生成**多层感知器**（**MLP**）模型的代码。
- en: Join our community on Discord
  id: totrans-625
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们的 Discord 社区
- en: 'Join our community’s Discord space for discussions with the author and other
    readers:'
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们的 Discord 空间，与作者和其他读者进行讨论：
- en: '[https://packt.link/aicode](https://packt.link/aicode)'
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/aicode](https://packt.link/aicode)'
- en: '![](img/QR_Code510410532445718281.png)'
  id: totrans-628
  prefs: []
  type: TYPE_IMG
  zh: '![二维码](img/QR_Code510410532445718281.png)'
