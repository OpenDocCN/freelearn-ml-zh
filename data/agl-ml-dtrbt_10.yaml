- en: '*Chapter 8*: Model Scoring and Deployment'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第 8 章*：模型评分和部署'
- en: In the previous chapter, we learned how to use outputs generated by DataRobot
    to understand models and why a model provides a particular prediction. We will
    now learn how to use models to score input datasets and create predictions to
    be used in the intended applications. DataRobot automates many tasks that are
    required for scoring and generating row-level explanations.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们学习了如何使用 DataRobot 生成的输出来理解模型以及为什么模型会提供特定的预测。现在，我们将学习如何使用模型对输入数据集进行评分并创建用于预期应用的预测。DataRobot
    自动化了许多评分和生成行级解释所需的任务。
- en: 'Creating predictions, however, is not where these tasks end. In most cases,
    these predictions need to be transformed into actions for consumption by people
    or applications. This mapping of predictions to actions requires an understanding
    of business and therefore needs a person to interpret the results (in most use
    cases). In this chapter, we will discuss how this is done. We''re going to cover
    the following main topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这些任务并没有结束。在大多数情况下，这些预测需要转换为行动，以便由人员或应用程序消费。这种将预测映射到行动的过程需要理解业务，因此需要有人来解释结果（在大多数用例中）。在本章中，我们将讨论如何进行这项工作。我们将涵盖以下主要主题：
- en: Scoring and prediction methods
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评分和预测方法
- en: Generating prediction explanations
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成预测解释
- en: Analyzing predictions and postprocessing
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析预测和后处理
- en: Deploying DataRobot models
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 DataRobot 模型
- en: Monitoring deployed models
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控已部署的模型
- en: Scoring and prediction methods
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评分和预测方法
- en: 'DataRobot provides multiple methods to score datasets using models that have
    been created. One of the easiest methods is batch scoring via the DataRobot **user
    interface** (**UI**). For this, we need to follow these steps:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: DataRobot 提供了多种方法来使用已创建的模型对数据集进行评分。其中最简单的方法是通过 DataRobot **用户界面**（**UI**）进行批量评分。为此，我们需要遵循以下步骤：
- en: Create a file with the dataset to be scored. Given that we are using a public
    dataset, we will simply use the same dataset to score. In a real project, you
    will have access to a new dataset for which you want to create predictions. For
    our purposes, we simply created a copy of our `imports-85-data.xlsx` dataset file
    and named it `imports-85-data-score.xlsx`.
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含要评分的数据集的文件。鉴于我们正在使用公共数据集，我们将简单地使用相同的数据集进行评分。在实际项目中，您将能够访问一个新数据集，您希望为其创建预测。为了我们的目的，我们简单地复制了我们的
    `imports-85-data.xlsx` 数据集文件，并将其命名为 `imports-85-data-score.xlsx`。
- en: Now, let's select the **Predict** tab and then the **Test Predictions** tab
    for the **XGBoost** (**XGB**) models, as shown in the following screenshot:![Figure
    8.1 – Batch scoring
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们选择 **预测** 选项卡，然后选择 **测试预测** 选项卡，用于 **XGBoost**（**XGB**）模型，如下面的截图所示：![Figure
    8.1 – 批量评分](img/Figure_8.1_B17159.jpg)
- en: '](img/Figure_8.1_B17159.jpg)'
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![Figure 8.1 – B17159.jpg](img/Figure_8.1_B17159.jpg)'
- en: Figure 8.1 – Batch scoring
  id: totrans-13
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.1 – 批量评分
- en: In the preceding screenshot, you will see that you have an option to **drag
    and drop a new dataset** to add the scoring file to the model.
  id: totrans-14
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前面的截图中，您将看到有一个选项可以 **拖放新数据集** 来添加评分文件到模型中。
- en: Let's select our `imports-85-data-score.xlsx` scoring file and drop it into
    the **Drag and drop a new dataset** box. Once you drop the file, it will get uploaded
    and you can see it in the interface, as shown in the following screenshot:![Figure
    8.2 – Computing predictions
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们选择我们的 `imports-85-data-score.xlsx` 评分文件，并将其拖放到 **拖放新数据集** 框中。一旦放下文件，它就会上传，您可以在界面上看到它，如下面的截图所示：![Figure
    8.2 – 计算预测](img/Figure_8.2_B17159.jpg)
- en: '](img/Figure_8.2_B17159.jpg)'
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![Figure 8.2 – B17159.jpg](img/Figure_8.2_B17159.jpg)'
- en: Figure 8.2 – Computing predictions
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.2 – 计算预测
- en: 'You can now click on the `.csv` file that you can view in Excel, as shown in
    the following screenshot:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您可以点击在 Excel 中可以查看的 `.csv` 文件，如下面的截图所示：
- en: '![Figure 8.3 – Downloaded predictions'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.3 – 下载的预测](img/Figure_8.3_B17159.jpg)'
- en: '](img/Figure_8.3_B17159.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.3 – B17159.jpg](img/Figure_8.3_B17159.jpg)'
- en: Figure 8.3 – Downloaded predictions
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.3 – 下载的预测
- en: The downloaded predictions file can now be joined with the original dataset
    for further analysis.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 下载的预测文件现在可以与原始数据集合并，以进行进一步分析。
- en: The second method for scoring a dataset is via the DataRobot batch prediction
    **application programming interface** (**API**), which will be discussed in the
    following section.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 评分数据集的第二种方法是通过 DataRobot 批量预测 **应用程序编程接口**（**API**），将在下一节中讨论。
- en: Generating prediction explanations
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 生成预测解释
- en: 'In this section, we will focus on how to generate explanations along with predictions
    for the scoring dataset. After uploading the scoring dataset (as we discussed
    in the preceding section), you can now go to the **Understand** tab and then select
    the **Prediction Explanations** tab, as shown in the following screenshot:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将重点介绍如何为评分数据集生成预测和解释。在上传评分数据集（如前节所述）后，您现在可以转到**理解**选项卡，然后选择**预测解释**选项卡，如下面的截图所示：
- en: '![Figure 8.4 – Prediction explanations'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.4 – Prediction explanations'
- en: '](img/Figure_8.4_B17159.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/Figure_8.4_B17159.jpg]'
- en: Figure 8.4 – Prediction explanations
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.4 – 预测解释
- en: 'In the preceding screenshot, you can see that it now shows the scoring dataset
    that was uploaded. You can now click on the icon next to the dataset filename
    to compute the explanations. Once the computation is complete, you will see the
    download icon. You can use the download icon to download the generated explanations
    for the predictions made by the model. The explanations come in the form of a
    `.csv` file that can be opened using Excel, as shown in the following screenshot:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，您可以看到现在显示的是已上传的评分数据集。您现在可以点击数据集文件名旁边的图标来计算解释。一旦计算完成，您将看到下载图标。您可以使用下载图标来下载模型预测生成的解释。解释以`.csv`文件的形式提供，可以使用Excel打开，如下面的截图所示：
- en: '![Figure 8.5 – Prediction explanations file'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.5 – Prediction explanations file'
- en: '](img/Figure_8.5_B17159.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/Figure_8.5_B17159.jpg]'
- en: Figure 8.5 – Prediction explanations file
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.5 – 预测解释文件
- en: In the preceding screenshot, we see that the file contains the predictions,
    as well as an explanation for each prediction. For example, if we look at row
    `make` explains 5.17% of the value difference from the base for this automobile.
    Similarly, you can see the relative contribution of each feature value. Notice
    that the features in the file are not sorted by the most important feature and
    also that the most important feature for a given row is not the same as some other
    row. The feature importance will change from row to row.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，我们看到文件包含预测以及每个预测的解释。例如，如果我们查看`make`行，它解释了这辆汽车相对于基准值的5.17%的价值差异。同样，您可以看到每个特征值的相对贡献。请注意，文件中的特征不是按最重要的特征排序的，并且对于给定行最重要的特征与其他行可能不同。特征重要性会随行变化。
- en: Now that we have the predictions and their explanations, let's look at how to
    analyze these and determine how to use them to take actions or make decisions.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了预测及其解释，让我们看看如何分析这些内容，并确定如何使用它们采取行动或做出决策。
- en: Analyzing predictions and postprocessing
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析预测和后处理
- en: 'Before we charge off to deploy the model, it would be advisable to analyze
    the predictions and see if they make sense, whether there are some patterns in
    the errors, and also how to turn the predictions into something actionable. These
    are aspects where traditional data science tools and methods are not of much help,
    and you need to rely on judgment and methods from other disciplines to help formulate
    the next steps. For this, let''s start by combining the scoring dataset file with
    the explanations file. This can be done in **Structured Query Language** (**SQL**),
    Python, or Excel. The combined file looks something like this:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们部署模型之前，分析预测并查看它们是否有意义，是否存在某些错误模式，以及如何将预测转化为可执行的行动，这些都是传统数据科学工具和方法帮助不大，而您需要依赖判断和其他学科的方法来帮助制定下一步的方面。为此，让我们首先将评分数据集文件与解释文件结合起来。这可以在**结构化查询语言**（**SQL**）、Python或Excel中完成。合并后的文件看起来大致如下：
- en: '![Figure 8.6 – Combined scoring data and predictions'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.6 – Combined scoring data and predictions'
- en: '](img/Figure_8.6_B17159.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/Figure_8.6_B17159.jpg]'
- en: Figure 8.6 – Combined scoring data and predictions
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6 – 合并评分数据和预测
- en: 'We also created a new **ERROR** column that simply subtracts **prediction**
    from **price**. We can now use Excel to create a pivot table and look at the results
    from multiple perspectives. For example, let''s create a pivot table and look
    at the **Average of ERROR** value by **symboling**, as shown in the following
    screenshot:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还创建了一个新的**ERROR**列，它简单地从**价格**中减去**预测**。现在我们可以使用Excel创建数据透视表，并从多个角度查看结果。例如，让我们创建一个数据透视表，查看按**符号化**的**ERROR平均值**，如下面的截图所示：
- en: '![Figure 8.7 – Average of ERROR value by symboling'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.7 – Average of ERROR value by symboling'
- en: '](img/Figure_8.7_B17159.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/Figure_8.7_B17159.jpg]'
- en: Figure 8.7 – Average of ERROR value by symboling
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.7 – 按符号化平均ERROR值
- en: 'The preceding screenshot shows that errors are much higher for the value **-2**.
    Looking at the dataset, we find that we have only three data points for **-2**,
    thus it is not a surprise that the model performs poorly. This tells us that we
    cannot trust the results when the **symboling** value is **-2** and that we should
    try to get more data for this value. Analysis such as this can point to areas
    of improvement and where to focus your efforts. We also realize that since this
    is an average error, we should use the average of the absolute percentage value
    of the error to prevent incorrect conclusions, as shown in the following screenshot:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的截图显示，对于值**-2**，错误率要高得多。查看数据集，我们发现我们只有三个**-2**的数据点，因此模型表现不佳并不令人惊讶。这告诉我们，当**符号化**值为**-2**时，我们不能相信结果，我们应该尝试获取更多该值的数据。此类分析可以指出改进的领域以及需要集中精力解决的问题。我们还意识到，由于这是一个平均误差，我们应该使用误差的绝对百分比值的平均值来防止得出错误的结论，如下面的截图所示：
- en: '![Figure 8.8 – Average of abs perc ERROR value by symboling'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.8 – Average of abs perc ERROR value by symboling](img/Figure_8.8_B17159.jpg)'
- en: '](img/Figure_8.8_B17159.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.8 – Average of abs perc ERROR value by symboling](img/Figure_8.8_B17159.jpg)'
- en: Figure 8.8 – Average of abs perc ERROR value by symboling
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.8 – 按符号化计算的绝对百分比误差平均值
- en: Now, we see that the absolute percent error decreases as the **symboling** value
    increases. At this point, there is no hard and fast way to find insights except
    exploring the output data and looking at it from different perspectives to see
    what you can find. Typically, it is a good idea to sort the errors and look at
    rows that have unusually large errors, and then see if you can determine why this
    is so.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们看到随着**符号化**值的增加，绝对百分比误差在减小。在这个阶段，除了探索输出数据并从不同角度观察以寻找可以找到的内容外，没有找到洞察力的明确方法。通常，对错误进行排序并查看具有异常大错误的行是一个好主意，然后看看你是否可以确定为什么会出现这种情况。
- en: 'Now, on to one of the most important aspects of building a data science model—understanding
    which actions to take. Now that we have a reasonable model to predict price, a
    question arises: *What should we do with this information?* Hopefully, the answer
    was determined at the start of the project as to what was the goal of this exercise.
    Let''s assume that the objective is to set the price of a new vehicle by looking
    at the prediction of the model and providing all the parameters such as `engine_size`,
    and so on. We could also imagine that a model such as this could be useful even
    during the design stage when designers are trying to determine trade-offs between
    different parameters such as `bore` or `width`. This goes on to say that a predictive
    model can many times be applied to use cases that were not considered while building
    the model.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们转向构建数据科学模型最重要的一个方面——理解应该采取哪些行动。现在我们有一个合理的模型来预测价格，一个问题随之而来：*我们应该如何利用这些信息？*
    希望在项目开始时就确定了这次练习的目标。让我们假设目标是根据模型预测和提供所有参数（如`engine_size`等）来设定新车辆的价格。我们也可以想象，这样的模型在设计师试图确定不同参数（如`bore`或`width`）之间的权衡时，在设计阶段也是有用的。这进一步说明，预测模型可以多次应用于在构建模型时未考虑到的用例。
- en: This, however, requires us to understand the broader context of the business
    problem. This is the primary reason we took time to discuss and understand the
    business context in [*Chapter 3*](B17159_03_Final_NM_ePub.xhtml#_idTextAnchor073),
    *Understanding and Defining Business Problems*. It might be useful to revisit
    that chapter to refresh the concepts discussed there as we will use some of the
    techniques that were introduced there, such as causal modeling.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这需要我们理解业务问题的更广泛背景。这是我们花费时间讨论和理解业务背景的主要原因，正如我们在[*第3章*](B17159_03_Final_NM_ePub.xhtml#_idTextAnchor073)“理解和定义业务问题”中所讨论的那样。回顾那章以刷新那里讨论的概念可能是有用的，因为我们将使用那里介绍的一些技术，例如因果建模。
- en: 'To determine how we use price prediction, let''s review what we know about
    how price relates to other parameters. In [*Chapter 5*](B17159_05_Final_NM_ePub.xhtml#_idTextAnchor097),
    *Exploratory Data Analysis with DataRobot*, we looked at association analysis
    information. Association strengths using mutual information were generated by
    DataRobot. We can use that information to draw a network graph between different
    features, as shown in the following screenshot. You can do this by drawing a circle
    for each feature, and then creating lines between features that have high association
    strengths:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定我们如何使用价格预测，让我们回顾一下我们关于价格与其他参数之间关系的了解。在[*第 5 章*](B17159_05_Final_NM_ePub.xhtml#_idTextAnchor097)《使用
    DataRobot 进行探索性数据分析》中，我们研究了关联分析信息。DataRobot 生成了使用互信息生成的关联强度。我们可以使用这些信息来绘制不同特征之间的网络图，如下面的截图所示。你可以通过为每个特征画一个圆圈，然后创建具有高关联强度的特征之间的线条来完成此操作：
- en: '![Figure 8.9 – Network graph of associations between features'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.9 – 特征之间关联的网络图'
- en: '](img/Figure_8.9_B17159.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_8.9_B17159.jpg)'
- en: Figure 8.9 – Network graph of associations between features
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.9 – 特征之间关联的网络图
- en: 'In [*Chapter 7*](B17159_07_Final_NM_ePub.xhtml#_idTextAnchor110), *Model Understanding
    and Explainability*, we saw the feature importance for price in terms of **SHapley
    Additive exPlanations** (**SHAP**) values is specific to the model we selected.
    The following might represent a causal diagram for this problem:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第 7 章*](B17159_07_Final_NM_ePub.xhtml#_idTextAnchor110)《模型理解和可解释性》中，我们看到了价格的特征重要性，以**SHapley
    Additive exPlanations**（**SHAP**）值来衡量，是针对我们选择的模型特定的。以下可能代表此问题的因果图：
- en: '![Figure 8.10 – Causal diagram for the XGB model'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.10 – XGB 模型的因果图'
- en: '](img/Figure_8.10_B17159.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_8.10_B17159.jpg)'
- en: Figure 8.10 – Causal diagram for the XGB model
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.10 – XGB 模型的因果图
- en: The left side of the diagram represents the most important features from the
    SHAP values. Let's imagine that the actual price charged is a bit different from
    the prediction. The **Price Delta** feature reflects a decision someone might
    make to charge a price different from the prediction. The **Price** feature impacts
    **Units Sold**, which ultimately affects the profitability. Note that this reflects
    just one possible way of using this model to help make pricing decisions.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图表的左侧表示 SHAP 值中最重要的特征。让我们假设实际收取的价格与预测略有不同。**价格差异**特征反映了某人可能做出的收取与预测不同的价格的决定。**价格**特征影响**销量**，这最终影响盈利能力。请注意，这仅反映了一种使用此模型帮助做出定价决策的可能方式。
- en: If, on the other hand, we imagine that we are trying to help the car design
    team come up with the best car configuration that will also be the most profitable
    one, then we might look at the diagram a bit differently. This is because different
    choices of car or engine design will also impact the cost of the car. Also, we
    know from *Figure 8.9* that the features are not independent. Changing the **bore**
    feature will change the **Engine Size** and the **Horsepower** features. Hence,
    when we are looking into making decisions, we have to think about the causal impacts
    as well. This is a very simplified view, and you can imagine that for a real problem,
    these diagrams will be a lot more complex. Imagine business leaders making those
    decisions by taking into account all of these relationships in their heads. This
    is one of the reasons that many times, models are not used by business users.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，如果我们想象我们正在尝试帮助汽车设计团队制定出既是最优配置也是最盈利的汽车配置，那么我们可能会以不同的方式看待这个图。这是因为不同的汽车或发动机设计选择也会影响汽车的成本。此外，从*图
    8.9* 我们知道特征不是独立的。改变**缸径**特征将改变**发动机尺寸**和**马力**特征。因此，当我们考虑做出决策时，我们必须考虑因果影响。这是一个非常简化的观点，你可以想象对于真实问题，这些图将更加复杂。想象一下，商业领导者通过在脑海中考虑所有这些关系来做出这些决策。这也是为什么许多时候，模型不会被商业用户使用的原因之一。
- en: In our example problem, the causal diagram shown in *Figure 8.10* is fairly
    simple. You can imagine real-world problems where this diagram will be a lot more
    complex. In such cases, it is very difficult to assess the impact the deployment
    of a model will have on the ecosystem. This includes users and other stakeholders.
    Complex problems tend to have many unanticipated consequences, especially when
    the affected parties are people.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例问题中，*图 8.10* 中所示的因果图相当简单。你可以想象现实世界中的问题，其中这个图将更加复杂。在这种情况下，很难评估模型部署对生态系统的影响，这包括用户和其他利益相关者。复杂问题往往有许多未预见的后果，尤其是当受影响的是人的时候。
- en: In such situations, if the potential impact may be large, it is advisable to
    test the new model in a synthetic or simulated environment. With the testing and
    impact analyses complete, we are now ready to deploy our model.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，如果潜在影响可能很大，建议在合成或模拟环境中测试新模型。完成测试和影响分析后，我们现在可以部署我们的模型。
- en: Deploying DataRobot models
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 部署 DataRobot 模型
- en: 'DataRobot makes it pretty easy to deploy the models you have developed. To
    prepare a model for deployment, here are the steps:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: DataRobot 使得部署您开发的模型变得非常简单。为了准备模型进行部署，以下是步骤：
- en: Let's unlock the project so that we can see the metrics for the holdout datasets,
    as shown in the following screenshot:![Figure 8.11 – Unlocking DataRobot models
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们解锁项目，以便我们可以查看保留数据集的指标，如下截图所示：![图 8.11 – 解锁 DataRobot 模型
- en: '](img/Figure_8.11_B17159.jpg)'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.11_B17159.jpg)'
- en: Figure 8.11 – Unlocking DataRobot models
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.11 – 解锁 DataRobot 模型
- en: In the preceding screenshot, you can see the **Unlock project Holdout for all
    models** option on the right side of the interface.
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前面的截图中，您可以在界面的右侧看到**解锁所有模型的保留集项目**选项。
- en: You should unlock the project only after you have selected the model that you
    are choosing for deployment. In our case, we have selected the XGB model that
    uses the **FL1 top23** feature list. Clicking on this option brings up a dialog
    box, as shown in the following screenshot:![Figure 8.12 – Unlocking project holdout
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在选择用于部署的模型之后，您才应该解锁项目。在我们的例子中，我们选择了使用**FL1 top23**特征列表的 XGB 模型。点击此选项将弹出一个对话框，如下截图所示：![图
    8.12 – 解锁项目保留集
- en: '](img/Figure_8.12_B17159.jpg)'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.12_B17159.jpg)'
- en: Figure 8.12 – Unlocking project holdout
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.12 – 解锁项目保留集
- en: Unlocking the project is an irreversible process. Let's unlock the project and
    see the holdout metrics, as shown in the following screenshot:![Figure 8.13 –
    Unlocked project view
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解锁项目是一个不可逆的过程。让我们解锁项目，查看保留集的指标，如下截图所示：![图 8.13 – 解锁项目视图
- en: '](img/Figure_8.13_B17159.jpg)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.13_B17159.jpg)'
- en: Figure 8.13 – Unlocked project view
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.13 – 解锁项目视图
- en: '*Figure 8.13* shows that the holdout values are higher than the cross-validation
    values, as expected. The holdout values are a better representation of the kind
    of performance you should expect from a model after deployment.'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图 8.13* 显示，保留集的值高于交叉验证的值，这是预期的。保留集的值是模型部署后应期望的性能的更好表示。'
- en: Now that the project is unlocked, let's retrain the selected model with 100%
    of the data to improve this model's performance. For that, click on the orange
    **+** sign for the model, as shown in *Figure 8.13*. This will bring up a dialog
    box for changing the sample size, as shown in the following screenshot:![Figure
    8.14 – Defining new sample size
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在项目已解锁，让我们用 100% 的数据重新训练所选模型，以提高该模型的表现。为此，点击模型旁边的橙色**+**号，如图 *图 8.13* 所示。这将弹出一个更改样本大小的对话框，如下截图所示：![图
    8.14 – 定义新的样本大小
- en: '](img/Figure_8.14_B17159.jpg)'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.14_B17159.jpg)'
- en: Figure 8.14 – Defining new sample size
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.14 – 定义新的样本大小
- en: In the preceding screenshot, you see options to change the sample size.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前面的截图中，您可以看到更改样本大小的选项。
- en: Drag the slider bar all the way to **100%** to indicate that you want to train
    the model with 100% of the data, as shown in the following screenshot:![Figure
    8.15 – Setting new sample size
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将滑块拖到**100%**，表示您想用 100% 的数据训练模型，如下截图所示：![图 8.15 – 设置新的样本大小
- en: '](img/Figure_8.15_B17159.jpg)'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.15_B17159.jpg)'
- en: Figure 8.15 – Setting new sample size
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.15 – 设置新的样本大小
- en: You can now click the **Run with new sample size** button. DataRobot will now
    retrain the XGB model with 100% of the data. For the XGB model, you can now click
    on the **Predict** tab and then the **Deploy** tab, as shown in the following
    screenshot:![Figure 8.16 – Deploying a model
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以点击**使用新的样本大小运行**按钮。DataRobot 将现在使用 100% 的数据重新训练 XGB 模型。对于 XGB 模型，您现在可以点击**预测**选项卡，然后点击**部署**选项卡，如下截图所示：![图
    8.16 – 部署模型
- en: '](img/Figure_8.16_B17159.jpg)'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.16_B17159.jpg)'
- en: Figure 8.16 – Deploying a model
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.16 – 部署模型
- en: Next, click on the **Deploy model** button. This will bring up a new page, as
    shown in the following screenshot:![Figure 8.17 – Creating a deployment for the
    model
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击**部署模型**按钮。这将弹出一个新页面，如下截图所示：![图 8.17 – 为模型创建部署
- en: '](img/Figure_8.17_B17159.jpg)'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.17_B17159.jpg)'
- en: Figure 8.17 – Creating a deployment for the model
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 8.17 – 为模型创建部署
- en: You can now give a name to your deployed model. You can also select your prediction
    environment where the deployed model is hosted, as set up by your administrator.
    Under the **Data Drift** section, you can specify if you want to track data drift
    or enable challenger models. You can also enable the storage of prediction rows,
    which allows DataRobot to analyze performance over time. Similarly, you can enable
    the tracking of attributes for segment-based analysis of model performance.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以为您的部署模型命名。您还可以选择部署模型所在的服务预测环境，这是由您的管理员设置的。在**数据漂移**部分，您可以指定是否要跟踪数据漂移或启用挑战者模型。您还可以启用预测行的存储，这允许DataRobot分析随时间推移的性能。同样，您还可以启用跟踪属性，以进行基于段落的模型性能分析。
- en: You can now click the `https://app2.datarobot.com`.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以点击`https://app2.datarobot.com`。
- en: 'You can now invoke this API to generate predictions. You can also see other
    information about your deployment by clicking on different tabs. If you click
    on the **Service Health** tab, you will see a page like this:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以调用此API来生成预测。您还可以通过点击不同的标签页来查看有关您的部署的其他信息。如果您点击**服务健康**标签页，您将看到如下页面：
- en: '![Figure 8.19 – Service health of deployments'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.19 – 部署的服务健康'
- en: '](img/Figure_8.19_B17159.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_8.19_B17159.jpg)'
- en: Figure 8.19 – Service health of deployments
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.19 – 部署的服务健康
- en: The preceding screenshot shows the status of the price prediction model. It
    shows how many predictions have been done, the response time for a prediction,
    and the error rates. The screenshot does not show any values because we just deployed
    this model.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的截图显示了价格预测模型的状态。它显示了已完成的预测数量、预测的响应时间和错误率。截图没有显示任何值，因为我们刚刚部署了此模型。
- en: We are now ready to start monitoring this deployed model.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已准备好开始监控这个部署模型。
- en: Monitoring deployed models
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 监控部署模型
- en: 'As you will have guessed by now, the job of the data science team does not
    end once a model is deployed. We now have to monitor this model to see how it
    is performing, whether it is working as intended, and if we need to intervene
    and make any changes. We''ll proceed as follows:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如您现在所猜到的，一旦模型部署，数据科学团队的工作并没有结束。我们现在必须监控这个模型，看看它的表现如何，是否按预期工作，以及我们是否需要干预并做出任何更改。我们将按以下步骤进行：
- en: To see how that works, let's click on the **Predictions** tab, as shown in the
    following screenshot:![Figure 8.20 – Making predictions using the deployed model
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了了解它是如何工作的，让我们点击**预测**标签页，如下截图所示：![图8.20 – 使用部署的模型进行预测
- en: '](img/Figure_8.20_B17159.jpg)'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.20_B17159.jpg)'
- en: Figure 8.20 – Making predictions using the deployed model
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.20 – 使用部署的模型进行预测
- en: We can now upload a dataset to be scored, by dragging and dropping a file (here,
    we will use the same file that we used before during model training) into the
    **Prediction source** box. We can now see other options becoming available, as
    shown in the following screenshot:![Figure 8.21 – Computing predictions for a
    dataset
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在可以通过拖放文件（在这里，我们将使用在模型训练期间使用的相同文件）到**预测源**框中，上传要评分的数据集。我们现在可以看到其他选项变得可用，如下截图所示：![图8.21
    – 计算数据集的预测
- en: '](img/Figure_8.21_B17159.jpg)'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.21_B17159.jpg)'
- en: Figure 8.21 – Computing predictions for a dataset
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.21 – 计算数据集的预测
- en: After selecting the options, we can click on the **Compute and download predictions**
    button. After DataRobot finishes the computations, we will see the output file
    becoming available, as shown in the following screenshot:![Figure 8.22 – Downloading
    predictions
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在选择选项后，我们可以点击**计算并下载预测**按钮。在DataRobot完成计算后，我们将看到输出文件变得可用，如下截图所示：![图8.22 – 下载预测
- en: '](img/Figure_8.22_B17159.jpg)'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.22_B17159.jpg)'
- en: Figure 8.22 – Downloading predictions
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.22 – 下载预测
- en: 'The output file can now be downloaded and analyzed. Since we are interested
    in monitoring the model, let''s click on the **Service Health** tab, as shown
    in the following screenshot:'
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出文件现在可以下载并分析。由于我们感兴趣的是监控模型，让我们点击**服务健康**标签页，如下截图所示：
- en: '![Figure 8.23 – Service health of the model'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图8.23 – 模型的服务健康'
- en: '](img/Figure_8.23_B17159.jpg)'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/Figure_8.23_B17159.jpg)'
- en: Figure 8.23 – Service health of the model
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.23 – 模型的服务健康
- en: We can now see that the model has serviced 15 requests with a median response
    time of 325 **milliseconds** (**ms**) and an error rate of 0%. The overall service
    health looks good.
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们现在可以看到，该模型已服务了15个请求，平均响应时间为325毫秒（**ms**），错误率为0%。整体服务健康看起来很好。
- en: 'We can now look at the data drift for the model by clicking on the **Data Drift**
    tab, as shown in the following screenshot:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在可以通过点击**数据漂移**选项卡来查看模型的数据漂移，如下面的截图所示：
- en: '![Figure 8.24 – Data drift for the model'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.24 – 模型的数据漂移'
- en: '](img/Figure_8.24_B17159.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_8.24_B17159.jpg)'
- en: Figure 8.24 – Data drift for the model
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.24 – 模型的数据漂移
- en: 'In the preceding screenshot, at the top of the `price`. If you scroll down
    the page, you will see additional graphs, as shown in the following screenshot:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一张截图的顶部是`价格`。如果您向下滚动页面，您将看到额外的图表，如下面的截图所示：
- en: '![Figure 8.25 – Data drift for the model: additional information'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.25 – 模型的数据漂移：附加信息'
- en: '](img/Figure_8.25_B17159.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_8.24_B17159.jpg)'
- en: 'Figure 8.25 – Data drift for the model: additional information'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.25 – 模型的数据漂移：附加信息
- en: The preceding screenshot shows the average prediction values over time. This
    will indicate whether the predictions have been stable or if they have changed
    over time. You will have to rely on your understanding of the business problem
    to determine whether the amount of drift is acceptable or not. DataRobot will
    also give you an indication by showing a red, yellow, or green status. A red status
    would indicate that there is an issue that needs to be resolved; similarly, yellow
    means that you should be aware of potential issues, and green indicates that everything
    looks fine. In general, the issue could be errors in the data pipeline or a change
    in the business environment. A change in the business environment would be an
    indication that the model needs to be retrained.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 上一张截图显示了随时间变化的平均预测值。这将表明预测是否稳定，或者它们是否随时间变化。您将不得不依靠自己对业务问题的理解来确定漂移量是否可接受。DataRobot也会通过显示红色、黄色或绿色状态来给您一个指示。红色状态表示存在需要解决的问题；同样，黄色表示您应该注意潜在的问题，绿色表示一切看起来都很正常。一般来说，问题可能是数据管道中的错误或商业环境的改变。商业环境的改变将表明模型需要重新训练。
- en: If the model needs to be retrained or if you need to rebuild the model, you
    can follow the steps that we have outlined in the preceding chapters. This completes
    a basic view of how you use DataRobot to build and deploy a model.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 如果模型需要重新训练或者您需要重建模型，您可以遵循我们在前几章中概述的步骤。这完成了使用DataRobot构建和部署模型的基本视图。
- en: Summary
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned how to use models after training. We discussed the
    methods that are used to score a dataset and also methods that are used for analyzing
    the resulting outputs. We also covered methods and considerations for turning
    predictions into actions or decisions. This is a critical step whereby you have
    to engage with your business stakeholders to make sure that introducing this model
    will not cause unforeseen problems. This is also the time to work on change management
    tasks such as communicating changes to people who are impacted by the change and
    ensure that users are trained in the new process and know how to use the new capabilities.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何训练模型后使用模型。我们讨论了用于评分数据集的方法以及用于分析结果输出的方法。我们还涵盖了将预测转化为行动或决策的方法和考虑因素。这是一个关键步骤，您必须与业务利益相关者合作，确保引入此模型不会引起未预见到的问题。这也是进行变更管理任务的时候，比如向受变更影响的人传达变更，并确保用户接受新流程的培训，知道如何使用新功能。
- en: We then discussed how to use DataRobot capabilities to rapidly deploy a model
    and then monitor the model performance. It is easy to underestimate the importance
    of this capability. Model deployment and monitoring are not easy, and many organizations
    spend a lot of time and effort trying to deploy a model. Hopefully, we have shown
    how easily this can be accomplished with DataRobot.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接着讨论了如何使用DataRobot功能快速部署模型并监控模型性能。很容易低估这一功能的重要性。模型部署和监控并不容易，许多组织花费大量时间和精力来部署模型。希望我们已经展示了如何使用DataRobot轻松完成这一任务。
- en: We have now completed the basic steps needed to build and deploy a model and
    can now go over some advanced concepts and capabilities of DataRobot. You are
    now ready to dive into advanced topics based on your interest or based on the
    type of project you will be working on. For example, if you are working on a time
    series problem, then you can review [*Chapter 9*](B17159_09_Final_NM_ePub.xhtml#_idTextAnchor125),
    *Forecasting and Time Series Modeling*.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经完成了构建和部署模型所需的基本步骤，现在可以深入了解DataRobot的一些高级概念和功能。你现在可以根据你的兴趣或将要从事的项目类型深入研究高级主题。例如，如果你正在处理时间序列问题，那么你可以回顾[*第9章*](B17159_09_Final_NM_ePub.xhtml#_idTextAnchor125)，*预测和时间序列建模*。
