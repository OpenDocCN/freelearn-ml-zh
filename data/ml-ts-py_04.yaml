- en: '5'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '5'
- en: Forecasting with Moving Averages and Autoregressive Models
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用移动平均和自回归模型进行预测
- en: This chapter is about time-series modeling based on moving averages and autoregression.
    This comprises a large set of models that are very popular in different disciplines,
    including econometrics and statistics. We'll discuss autoregression and moving
    averages models, along with others that combine these two, such as ARMA, ARIMA,
    VAR, GARCH, and others.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍基于移动平均和自回归的时间序列建模。这个主题包含了一大类模型，在不同学科中都非常流行，包括计量经济学和统计学。我们将讨论自回归和移动平均模型，以及一些将这两者结合起来的模型，如
    ARMA、ARIMA、VAR、GARCH 等。
- en: These models are still held in high esteem and find their applications. However,
    many new models have since sprung up that have been shown to be competitive or
    even outperform these simpler ones. Within their main application, however, in
    univariate forecasting, simple models often provide accurate or accurate enough
    predictions, so that these models constitute a mainstay in time-series modeling.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 这些模型仍然受到高度评价并且有广泛的应用。然而，自那时以来，许多新模型涌现出来，证明它们与这些简单模型具有竞争力，甚至能够超越它们。然而，在其主要应用领域，即单变量预测中，简单模型往往能够提供准确或足够准确的预测，因此这些模型在时间序列建模中仍然占据主导地位。
- en: 'We''re going to cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖以下主题：
- en: What are classical models?
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 经典模型是什么？
- en: Moving average and autoregression
  id: totrans-6
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动平均和自回归
- en: Model selection and order
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型选择和阶数
- en: Exponential smoothing
  id: totrans-8
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指数平滑法
- en: ARCH and GARCH
  id: totrans-9
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ARCH 和 GARCH
- en: Vector autoregression
  id: totrans-10
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向量自回归
- en: Python libraries
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 库
- en: statsmodels
  id: totrans-12
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: statsmodels
- en: Python practice
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 实践
- en: Modeling in Python
  id: totrans-14
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Python 中建模
- en: We are going to start with an introduction to classical models.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从经典模型的介绍开始。
- en: What are classical models?
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 经典模型是什么？
- en: In this chapter, we'll deal with models that could be characterized as having
    a longer tradition, and are rooted in statistics and mathematics. They are used
    heavily in econometrics and statistics.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论那些有着更长传统的模型，这些模型根植于统计学和数学领域。它们在计量经济学和统计学中有着广泛应用。
- en: While there is considerable overlap between statistics and machine learning
    approaches, and each community has been absorbing the work of the other, there
    are still a few key differences. Whereas statistics papers are still overwhelmingly
    formal and deductive, machine learning researchers are more pragmatic, relying
    on the predictive accuracy of models.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然统计学和机器学习方法之间有相当多的重叠，而且两个领域的学者都在吸收对方的研究成果，但仍然存在一些关键差异。统计学论文仍然主要是正式和推理性的，而机器学习研究者则更加务实，依赖于模型的预测准确性。
- en: We've talked about the very early history of time-series models in *Chapter
    1*, *Introduction to Time-Series with Python*. In this chapter, we'll discuss
    moving averages and autoregressive approaches for forecasting. These were introduced
    in the early 20^(th) century and popularized by George Box and Gwilym Jenkins
    in 1970 in their book "*Time-Series Analysis Forecasting and Control*." Crucially,
    in their book, Box and Jenkins formalized the ARIMA model and described how to
    apply it to time-series forecasting.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在 *第1章*《Python 时间序列介绍》中讨论了时间序列模型的早期历史。在本章中，我们将讨论用于预测的移动平均和自回归方法。这些方法在 20 世纪初期被提出，并在
    1970 年由 George Box 和 Gwilym Jenkins 在他们的著作《*时间序列分析：预测与控制*》中推广。关键的是，在这本书中，Box 和
    Jenkins 使 ARIMA 模型得到了形式化，并描述了如何将其应用于时间序列预测。
- en: Many time-series exhibit trends and seasonality, while many of the models in
    this chapter assume stationarity. If a time-series is stationary, its mean and
    standard deviation stays constant over time. This implies that the time-series
    has no trend and no cyclic variability.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 许多时间序列展现出趋势和季节性，而本章中的许多模型假设时间序列是平稳的。如果一个时间序列是平稳的，它的均值和标准差会随着时间保持不变。这意味着该时间序列没有趋势，也没有周期性波动。
- en: 'Therefore, the removal of irregular components, trends, and seasonal fluctuations
    is an intrinsic aspect of applying these models. The models then forecast what''s
    left after removing seasonality and trend: business cycles.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，去除不规则成分、趋势和季节波动是应用这些模型的一个内在方面。模型然后预测去除季节性和趋势后的残余部分：商业周期。
- en: 'Thus, to apply classical models, a time-series usually should be decomposed
    into different components. Thus, classical models are usually applied as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，应用经典模型时，时间序列通常需要分解为不同的组成部分。因此，经典模型通常按以下方式应用：
- en: Test for stationarity
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 平稳性检验
- en: Differencing [if stationarity detected]
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 差分处理【如果检测到平稳性】
- en: Fit method and forecast
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 拟合方法和预测
- en: Add back the trend and seasonality
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加回趋势和季节性
- en: Most of the approaches in this chapter are relevant only to univariate time-series.
    Although extensions to multivariate time-series have been proposed, they are not
    as popular as the univariate versions. Univariate time-series consist of a single
    vector or, in other words, one value that changes over time. We'll see **Vector
    Autoregression** (**VAR**) at the end of the chapter though, which is an extension
    to multivariate time-series.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中的大多数方法仅适用于单变量时间序列。尽管已经提出了扩展到多变量时间序列的方法，但它们不像单变量版本那样流行。单变量时间序列由单个向量组成，换句话说，就是一个随时间变化的值。尽管如此，我们将在本章末尾看到**向量自回归**（**VAR**），这是一种多变量时间序列的扩展。
- en: Another important consideration is that most classical models are linear, which
    means they assume linearity in the dependencies between values at the same time
    and between values at different time steps. In practice, the models in this chapter
    work well with a range of time-series that are stationary. This means that the
    distribution is the same over time. Examples of this are temperature changes over
    time. These models are especially valuable in a context where the amount of data
    available is small so that the extra estimation error in non-linear models dominates
    any potential gains in terms of accuracy.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个重要的考虑因素是，大多数经典模型都是线性的，这意味着它们假设时间点之间以及不同时间步长之间的值之间存在线性依赖关系。实际上，本章中的模型在处理一系列平稳时间序列时效果良好。平稳性意味着分布随时间保持不变。一个例子就是温度随时间的变化。这些模型在数据量较小的情况下尤其有价值，因为在这种情况下，非线性模型中的额外估计误差会超过精度上的潜在增益。
- en: However, the stationarity assumption implies that the application of the models
    in this chapter is restricted to time-series that have this property. Alternatively,
    we'd have to preprocess our time-series to enforce stationarity. In contrast,
    the development of statistical methods for nonlinear time-series analysis and
    forecasting has found much less prominence; however, there are some models such
    as the Threshold Autoregressive Model (which we won't cover here).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，平稳性假设意味着本章中模型的应用仅限于具有这一属性的时间序列。否则，我们就需要对时间序列进行预处理，以强制其平稳性。相比之下，非线性时间序列分析与预测的统计方法发展较少受到关注；然而，仍然存在一些模型，例如阈值自回归模型（我们在这里不讨论）。
- en: 'Finally, it is left to note that, while a reasonable first approach, many time-series
    such as temperatures can be predicted much more accurately by high-dimensional
    physics-based models of the atmosphere than by statistical models. This illustrates
    the point of complexity: essentially, modeling is condensing a set of hypotheses
    and formalizing them together with parameters.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，需要指出的是，虽然这是一个合理的初步方法，但许多时间序列（如温度）的预测通过基于物理的大气高维模型，比通过统计模型更为准确。这说明了复杂性的问题：本质上，建模是将一组假设凝练并与参数一起形式化的过程。
- en: Real-world time-series come from complicated processes that can be non-linear
    and non-stationary, and there's more than a single way of describing them, each
    of which has its up- and downsides. Thus, we can think of a modeling problem in
    terms of lots of parameters or just as a single or a couple of parameters. In
    a dedicated section below, we'll discuss the issue of selecting a model from a
    set of alternatives based on the number of parameters and the accuracy.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 现实世界的时间序列来自复杂的过程，这些过程可能是非线性和非平稳的，描述它们的方式有很多种，每种方法都有其优缺点。因此，我们可以从很多参数的角度看待建模问题，或者仅将其视为单一或几个参数。在下面的专门部分，我们将讨论如何根据参数数量和精度，从一组备选模型中选择一个模型的问题。
- en: Nowadays, nonlinear models come from a different direction of research, either
    neural networks or the broader field of machine learning. We'll see neural networks
    in *Chapter 10*, *Deep Learning for Time-Series*, and we'll discuss and apply
    state-of-the-art machine learning in *Chapter 7*, *Machine Learning Models for
    Time-Series*.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，非线性模型来源于不同的研究方向，主要是神经网络或更广泛的机器学习领域。我们将在*第10章*中讨论神经网络，*《时间序列的深度学习》*，并将在*第7章*中讨论并应用最先进的机器学习方法，*《时间序列的机器学习模型》*。
- en: Moving average and autoregression
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移动平均和自回归
- en: Classical models can be grouped into families of models – **moving averages**
    (**MA**), **autoregressive** (**AR**) models, ARMA, and ARIMA. These models were
    formalized and popularized over time in books and papers by many mathematicians
    and statisticians, including Peter Whittle (1951) and George Box and Gwilym Jenkins
    (1970). But let's start earlier.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 经典模型可以分为几类模型——**移动平均**（**MA**）、**自回归**（**AR**）模型、ARMA和ARIMA。这些模型经过时间的推敲，由许多数学家和统计学家在书籍和论文中正式化并普及开来，包括彼得·惠特尔（1951年）和乔治·博克斯与吉威尔姆·詹金斯（1970年）。不过，让我们从更早的时候开始。
- en: The **moving average** marked the beginning of modern time-series predictions.
    In a moving average, the average (usually, the arithmetic mean) of values is taken
    over a specific number of time points (time frame) in the past.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**移动平均**标志着现代时间序列预测的开始。在移动平均中，通常会对过去一段时间内（时间框架）一定数量的时间点的值取平均（通常是算术平均）。'
- en: 'More formally, the **simple moving average**, the unweighted mean over a period
    of k points, is formulated as:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 更正式地说，**简单移动平均**是一个无权重的平均值，计算范围为k个点，公式为：
- en: '![](img/B17577_05_001.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_001.png)'
- en: where *x*[i] represents the observed time-series.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *x*[i] 表示观察到的时间序列。
- en: The moving average can be used to smooth out a time-series, thereby removing
    noise and periodic fluctuations that occur in the short term, effectively working
    as a low-pass filter. Therefore, as mathematician Reginald Hooker pointed out
    in a publication in 1902, the moving average can serve to isolate trend and oscillatory
    components. He conceptualized trend as the direction in which a series is moving
    when oscillations are disregarded.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 移动平均可以用来平滑时间序列，从而去除短期内发生的噪声和周期波动，实际上起到低通滤波器的作用。因此，正如数学家雷金纳德·胡克在1902年的一篇出版物中指出的那样，移动平均可以用来分离趋势和振荡成分。他将趋势概念化为忽略振荡后，序列前进的方向。
- en: 'The moving average can smooth the trend and cycle over the history of a time-series;
    however, as a model, the moving average can be used to forecast into the future
    as well. The time-series is a linear regression of the current value of the series
    against observed values (error terms). The moving average model of order *q*,
    *MA(q)*, can be denoted as:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 移动平均可以平滑时间序列中的趋势和周期；然而，作为一种模型，移动平均也可以用于预测未来。时间序列是当前序列值与观察值（误差项）之间的线性回归。移动平均模型的阶数为
    *q*，即 *MA(q)*，可以表示为：
- en: '![](img/B17577_05_002.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_002.png)'
- en: where ![](img/B17577_05_003.png) is the average (expectation) of *x*[t] (usually
    assumed to be 0), ![](img/B17577_05_004.png) are parameters, and ![](img/B17577_05_005.png)
    is random noise.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ![](img/B17577_05_003.png) 是 *x*[t] 的平均值（期望值）（通常假设为0），![](img/B17577_05_004.png)
    是参数，![](img/B17577_05_005.png) 是随机噪声。
- en: Educated in Cambridge, Hooker worked in the Statistical Branch of the Ministry
    of Agriculture, Fisheries, and Food of the United Kingdom. He was an out-of-hours
    statistician, writing about meteorology and socio-economic topics such as wages,
    marriage rates and trade, and crop forecasting.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 胡克在剑桥大学接受教育，曾在英国农业、渔业和食品部的统计部门工作。他是一个业余统计学家，撰写关于气象学和社会经济话题的文章，如工资、婚姻率、贸易以及作物预测等。
- en: The invention of **AR** techniques dates back to a paper by British statistician
    Udny Yule, a personal friend of Hooker's, in 1927 ("*On a Method of Investigating
    Periodicities in Disturbed Time-Series with special reference to Wolfer's Sunspot
    Numbers*"). An **autoregressive model** regresses the variable on its own lagged
    values. In other words, the current value of the value is driven by immediately
    preceding values using a linear combination.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**AR** 技术的发明可以追溯到1927年，英国统计学家乌德尼·尤尔（Udny Yule）的论文（《*On a Method of Investigating
    Periodicities in Disturbed Time-Series with special reference to Wolfer''s Sunspot
    Numbers*》），尤尔是胡克的朋友。**自回归模型**（autoregressive model）将变量与其自身的滞后值回归。换句话说，当前值由紧接其后的值通过线性组合驱动。'
- en: 'Sunspot variations are highly cyclic as can be seen in this plot of sunspot
    observations over time (loaded through statsmodels data utilities):'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 太阳黑子的变化具有高度周期性，正如这张显示太阳黑子随时间变化的图表所示（通过 statsmodels 数据工具加载）：
- en: '![../../../../../Downloads/Machine-Learning%20for%20Time-Series%20with%20Python/sunspot_act](img/B17577_05_01.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![../../../../../Downloads/Machine-Learning%20for%20Time-Series%20with%20Python/sunspot_act](img/B17577_05_01.png)'
- en: 'Figure 5.1: Sunspot observations by year'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.1：按年划分的太阳黑子观测数据
- en: Yule formulized a linear model driven by noise as an application to sunspot
    numbers, the count of dark spots on the outer shell of the sun. The spots have
    their origin in giant explosions and indicate magnetic activity of the sun, and
    phenomena such as solar flares.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 尤尔提出了一个由噪声驱动的线性模型，用来应用于太阳黑子数目，即太阳外壳上的黑斑数量。这些黑斑源自巨大的爆炸，标志着太阳的磁活动，并且与日冕物质抛射等现象相关。
- en: 'Here are two images of low and high solar activity according to sunspot numbers
    (from NASA):'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是根据太阳黑子数目展示的低太阳活动和高太阳活动的两幅图像（来自NASA）：
- en: '![hat Will Solar Cycle 25 Look Like? | NASA](img/B17577_05_02.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![hat Will Solar Cycle 25 Look Like? | NASA](img/B17577_05_02.png)'
- en: 'Figure 5.2: Solar activity'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.2：太阳活动
- en: Today, we know that the solar cycle is a nearly periodic 11-year change in the
    solar magnetic activity between high magnetic activity (solar maximum) and low
    magnetic activity (solar minimum). At the high point, explosions (solar flares)
    can unleash charged particles into space, potentially endangering life on Earth.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，我们知道太阳周期是太阳磁活动的一个几乎周期性的11年变化，表现为高磁活动（太阳极大期）和低磁活动（太阳极小期）之间的变化。在高点时，爆炸（太阳耀斑）会将带电粒子释放到太空中，可能危及地球上的生命。
- en: Yule studied engineering at **University College London** (**UCL**), went to
    work with Heinrich Hertz in Bonn, returned to UCL to work with Karl Pearson, and
    was later promoted to assistant professor at UCL. After first taking the post
    of statistics at UCL, he moved to Cambridge. He is remembered for his book on
    statistics "*An Introduction to the Theory of Statistics*," which was first published
    in 1911 and went through many editions, as well as for his description of the
    process known today as preferential attachment, where the distribution of new
    quantities to nodes in a network is in accordance with how much the nodes already
    have; this is sometimes noted as "the richer get richer."
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 尤尔（Yule）在**伦敦大学学院**（**UCL**）学习工程学，后来与海因里希·赫兹（Heinrich Hertz）一起在波恩工作，随后回到UCL与卡尔·皮尔逊（Karl
    Pearson）合作，并最终晋升为UCL的助理教授。在UCL担任统计学职位后，他移居剑桥。他因其关于统计学的著作《*统计学理论导论*》而被人们铭记，这本书首次出版于1911年，经过了多个版本的修订。此外，他还因描述了现在被称为优先附着过程的现象而闻名，该过程描述了网络中新节点的分配方式是根据节点已经拥有的数量来决定的；这一过程有时被称为“富者愈富”。
- en: 'Andrey Kolmogorov defined the term **stationary process** in 1931, although
    Louis Bachelier had introduced a similar definition earlier (1900) using different
    terminology. **Stationarity** is defined by three characteristics:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 安德烈·柯尔莫哥洛夫（Andrey Kolmogorov）在1931年定义了**平稳过程**这一术语，尽管路易·巴谢列（Louis Bachelier）在早些时候（1900年）就用不同的术语提出了类似的定义。**平稳性**由三个特征定义：
- en: Finite variation
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 有限变差
- en: Constant mean
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 恒定均值
- en: Constant variation
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 恒定变差
- en: 'Constant variation means that the variation of the time-series in a window
    between two points is constant over time: ![](img/B17577_05_006.png), although
    it can change with the size of the window.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 恒定变差意味着时间序列在两个点之间的窗口内的变化随着时间的推移保持恒定：![](img/B17577_05_006.png)，尽管它可能随窗口的大小变化。
- en: This is weak stationarity. In the literature, unless otherwise specified, usually
    stationarity means weak stationarity. Strict stationarity means that a time-series
    has a probability density function that is unchanged over time. In other words,
    under strict stationarity, the joint distribution over ![](img/B17577_05_007.png)
    is the same as over ![](img/B17577_05_008.png).
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这是弱平稳性。在文献中，除非另有说明，通常平稳性指的是弱平稳性。严格平稳性意味着时间序列具有随时间不变的概率密度函数。换句话说，在严格平稳性下，联合分布在
    ![](img/B17577_05_007.png) 上与在 ![](img/B17577_05_008.png) 上是相同的。
- en: In 1938, Norwegian mathematician Herman Ole Andreas Wold described the decomposition
    of stationary time-series. He observed that stationary time-series can be expressed
    as the sum of a deterministic component (autoregressive) and a stochastic component
    (noise). This decomposition is termed after him today, as **Wold's decomposition**.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 1938年，挪威数学家赫尔曼·奥勒·安德烈亚斯·沃尔德（Herman Ole Andreas Wold）描述了平稳时间序列的分解。他观察到，平稳时间序列可以表示为一个确定性成分（自回归）与一个随机成分（噪声）的和。如今，这一分解方法以他的名字命名，称为**沃尔德分解**。
- en: 'This leads to the formulation of the autoregressive model of order ![](img/B17577_05_009.png),
    *AR(p)*, as:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致了自回归模型的形式化，阶数为 ![](img/B17577_05_009.png)，*AR(p)*，表示为：
- en: '![](img/B17577_05_010.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_010.png)'
- en: where ![](img/B17577_05_011.png) is a model parameter, *c* is a constant, and
    ![](img/B17577_05_012.png) represents noise. In this equation, *p* is a measure
    of the autocorrelation between successive values of the time-series.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ![](img/B17577_05_011.png) 是模型参数，*c* 是一个常数，而 ![](img/B17577_05_012.png) 则代表噪声。在这个方程中，*p*
    是时间序列连续值之间自相关性的度量。
- en: This work was later, in 1951, generalized to multivariate time-series in a Ph.D.
    thesis ("*Hypothesis Testing in Time-Series*") by New Zealander Peter Whittle,
    with Wold as his advisor. Peter Whittle is also credited with the integration
    of the AR and MA models into one, as the **autoregressive moving average** (**ARMA**).
    This was another milestone in the history of time-series modeling, bringing together
    the work of Yule and Hooker.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 此工作后来在1951年被新西兰人彼得·惠特尔的博士论文《*时间序列假设检验*》中推广到多变量时间序列中，彼得·惠特尔的导师是沃尔德。彼得·惠特尔也因将AR和MA模型整合为一个而受到赞誉，这就是**自回归移动平均**（**ARMA**）的另一个里程碑，将尤尔和胡克的工作结合在一起。
- en: 'The ARMA model consists of two types of lagged values, one for the autoregressive
    component and the other for the moving average component. Therefore, we write
    *ARMA(p, q)*, with the first parameter p indicating the order of the autoregression,
    and the second, *q*, the order of the moving average, as:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: ARMA模型包括两种类型的滞后值，一种用于自回归分量，另一种用于移动平均分量。因此，我们写成*ARMA(p, q)*，其中第一个参数p表示自回归的顺序，第二个*q*表示移动平均的顺序，如下所示：
- en: '![](img/B17577_05_013.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_013.png)'
- en: ARMA assumes that the series is stationary. In practice, to ensure stationarity,
    preprocessing has to be applied.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: ARMA假设该系列是稳定的。在实践中，为了确保稳定性，必须应用预处理。
- en: The model parameters were estimated via the least-squares method until George
    Box and Gwilym Jenkins popularized their method of a maximum-likelihood estimation
    of the parameters.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 模型参数是通过最小二乘法估计的，直到乔治·Box 和 Gwilym Jenkins 推广了他们的最大似然估计参数方法。
- en: George Box was one of the most influential figures of not only classical time-series
    prediction, but also the broader field of statistics. Drafted for World War II
    without having finished his studies in chemistry, he performed poison gas experiments
    for the army, teaching himself statistics for analysis in the process.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 乔治·Box 是不仅在古典时间序列预测领域中最有影响力的人物之一，也在更广泛的统计领域中卓有成效。在二战期间，他未完成化学学习就被征召入伍，为军队进行毒气实验，在此过程中自学了统计学以进行分析。
- en: Once the war was over, he studied mathematics and statistics at the University
    College London, completing his Ph.D. with Egon Pearson, the son of Karl Pearson,
    as his advisor. He later headed a research group at Princeton, and then founded
    the statistics department at the University of Wisconsin–Madison.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 战争结束后，他在伦敦大学学院学习数学和统计学，并在埃冈·皮尔逊（Karl Pearson之子）的指导下完成了他的博士学位。后来，他在普林斯顿大学领导了一个研究团队，然后在威斯康星大学麦迪逊分校创立了统计学系。
- en: 'Box and Jenkin''s 1970 book "*Time-Series Analysis: Forecasting and Control*"
    outlined many applied examples for time-series forecasting and seasonal adjustment.
    The so-called Box-Jenkins method is one of the most popular forecasting methods.
    Their book also contained a description of the **autoregressive integrated moving
    average** model (**ARIMA**).'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 'Box 和 Jenkin 的1970年著作 "*Time-Series Analysis: Forecasting and Control*"，详细介绍了时间序列预测和季节调整的许多应用示例。所谓的Box-Jenkins方法是最流行的预测方法之一。他们的书籍还描述了**自回归积分移动平均**模型（**ARIMA**）。'
- en: ARIMA(p, d, q) includes a data preprocessing step, called **integration**, to
    make the time-series stationary, which is by replacing values by subtracting the
    immediate past values, a transformation called **differencing**.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA(p, d, q)包括一个数据预处理步骤，称为**积分**，使时间序列保持稳定，通过替换值来减去即时过去的值，这个转换称为**差分**。
- en: The model integration is parametrized by d, which is the number of times differences
    have been taken between current and previous values. As mentioned, the three parameters
    stand for the three parts of the model.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的积分由参数d参数化，它是当前值和先前值之间进行差分的次数。正如提到的那样，这三个参数代表模型的三个部分。
- en: There are some special cases; ARIMA(p,0,0) stands for AR(p), ARIMA(0,d,0) for
    I(d), and ARIMA(0,0,q) is MA(q). I(0) is sometimes used as a convention to refer
    to stationary time-series, which don't require any differencing to be stationary.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些特殊情况；ARIMA(p,0,0)代表AR(p)，ARIMA(0,d,0)代表I(d)，而ARIMA(0,0,q)则是MA(q)。I(0)有时被用作一个约定，指的是不需要任何差分即可保持稳定的时间序列。
- en: While ARIMA type models effectively consider stationary processes, the **Seasonal
    Auto Regressive Integrative Moving Average** models (**SARIMA**), developed as
    an extension of the ARMA model, can describe processes that exhibit non-stationary
    behaviors both within and across seasons.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 ARIMA 类型模型有效地考虑了平稳过程，但作为 ARMA 模型扩展的 **季节性自回归积分滑动平均** 模型（**SARIMA**）可以描述在季节内外展现非平稳行为的过程。
- en: 'Seasonal ARIMA models are usually stated as ARIMA(p,d,q)(P,D,Q)m. The parameters
    deserve more explanation:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 季节性 ARIMA 模型通常表示为 ARIMA(p,d,q)(P,D,Q)m。各个参数需要进一步解释：
- en: m denotes the number of periods in a season
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: m 表示一个季节中的周期数
- en: P, D, Q parametrize the autoregressive, integration, and moving average components
    of the seasonal part
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: P、D、Q 参数化季节部分的自回归、差分和移动平均组件
- en: p, d, q refer to the ARIMA terms, which we've discussed previously
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: p、d、q 是我们之前讨论过的 ARIMA 项。
- en: P is a measure of autocorrelation between successive seasonal components of
    the time-series.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: P 是度量时间序列中连续季节组件之间自相关性的指标。
- en: 'We can write out the seasonal parts to make this clearer. **Seasonal Autoregression**,
    **SAR**, can be stated as:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以列出季节部分来使其更清楚。**季节性自回归**，**SAR**，可以表示为：
- en: '![](img/B17577_05_014.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_014.png)'
- en: where *s* is the length of the seasonality.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *s* 是季节性周期的长度。
- en: 'Similarly, the **seasonal moving average**, **SMA**, can be written as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，**季节性移动平均**，**SMA**，可以写作如下：
- en: '![](img/B17577_05_015.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_015.png)'
- en: Please note that each of these components will use a distinct set of parameters.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这些组件中的每一个将使用一组不同的参数。
- en: For example, the model SARIMA(0,1,1)(0,1,1)12 process will contain a non-seasonal
    MA(1) term (with the corresponding parameter ![](img/B17577_05_016.png)) and a
    seasonal MA(1) term (with the corresponding parameter ![](img/B17577_05_017.png)).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，模型 SARIMA(0,1,1)(0,1,1)12 过程将包含一个非季节性 MA(1) 项（对应参数 ![](img/B17577_05_016.png)），以及一个季节性
    MA(1) 项（对应参数 ![](img/B17577_05_017.png)）。
- en: Model selection and order
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型选择与顺序
- en: The parameter q in ARMA would typically be 3 or less, but this is more a reflection
    of computing resources rather than statistics. Today, to set the parameters p
    and q, we would typically look at the autocorrelation and partial autocorrelation
    plots, where we could see peaks in the correlation for each lag.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: ARMA 中的参数 q 通常为 3 或更少，但这更多地反映了计算资源的限制，而非统计问题。如今，为了设置 p 和 q 参数，我们通常会查看自相关和偏自相关图，其中我们可以看到每个滞后的相关性峰值。
- en: When we have different models, say models of different p and q, each trained
    on the same dataset, how do we know which one should we use? This is where model
    selection comes in.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们有不同的模型，比如不同的 p 和 q 模型，每个模型都在相同的数据集上进行训练时，我们怎么知道应该使用哪个模型呢？这就是模型选择的作用。
- en: Model selection is the methodology for deciding between competing models. One
    of the main ideas in model selection is Occam's razor, named after the English
    Franciscan friar and scholastic philosopher William of Ockham, who lived between
    circa 1287 and 1347\.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 模型选择是决定竞争模型之间选择的方法论。模型选择中的一个主要思想是奥卡姆剃刀原则，得名于英国方济各会修士、经院哲学家威廉·奥卡姆（William of
    Ockham），他生活在公元1287年至1347年间。
- en: According to Occam's razor, when choosing between competing solutions, one should
    prefer the explanation with the fewest assumptions. Ockham argued based on this
    idea that the principle of divine interventions is so simple that miracles are
    a parsimonious explanation. This rule, also called "*lex parsimoniae*" in Latin,
    expresses that a model should be parsimonious, which means that it should be simple
    yet have high explanatory power.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 根据奥卡姆剃刀原则，在选择竞争性解决方案时，应优先选择假设最少的解释。奥卡姆基于这一思想主张，神圣干预的原则是如此简单，奇迹便是一个简洁的解释。这个规则，也叫做拉丁语中的
    "*lex parsimoniae*"，表明一个模型应当简洁，即使它简单，却应具有较高的解释力。
- en: In science, simpler explanations are preferred out of the principle of falsifiability.
    The simpler a scientific explanation, the easier it can be tested, and possibly
    refuted – this lends the model scientific rigor.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在科学中，出于可证伪性原则，通常偏好更简单的解释。科学解释越简单，越容易进行测试，甚至可能被推翻——这为模型提供了科学的严谨性。
- en: ARMA and other models are usually estimated with the **maximum-likelihood estimation**
    (**MLE**). In MLE, this means maximizing a likelihood function so that, given
    the parameters of the model, the observed data is most likely.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ARMA 和其他模型通常通过 **最大似然估计**（**MLE**）进行估计。在 MLE 中，这意味着最大化似然函数，以便在给定模型参数的情况下，观察到的数据是最有可能的。
- en: One of the most commonly used model selection criteria for the maximum-likelihood
    method is the **Akaike information criterion** (**AIC**), after Hirotugu Akaike,
    who published it first in English in 1973\.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 最大似然法中最常用的模型选择标准之一是 **赤池信息准则** (**AIC**)，得名于 Hirotugu Akaike，他在1973年首次用英语发布了这一准则。
- en: AIC takes the log-likelihood *l* from the maximum-likelihood method and the
    number of parameters *k* in the model.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: AIC 采用最大似然法中的对数似然值 *l* 和模型中的参数个数 *k*。
- en: '![](img/B17577_05_018.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_018.png)'
- en: This is saying that the AIC equals two times the number of parameters minus
    two times the log-likelihood. In model selection, we would prefer the model with
    the lowest AIC, which means it has few parameters, but also high log-likelihood.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这表示 AIC 等于参数个数的两倍减去对数似然的两倍。在模型选择中，我们会选择 AIC 最小的模型，这意味着它的参数少，但对数似然高。
- en: 'For an ARIMA model, we could write more specifically:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 ARIMA 模型，我们可以更具体地写出：
- en: '![](img/B17577_05_019.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_019.png)'
- en: I've omitted the parameter d since it doesn't introduce additional estimations.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我已经省略了参数 d，因为它不会引入额外的估计。
- en: 'The **Bayesian Information Criterion** (**BIC**) was proposed for model selection
    a few years later (1978), by Gideon Schwarz, and looks very much like AIC. It
    additionally takes *N*, the number of samples in the dataset:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '**贝叶斯信息准则** (**BIC**) 是由 Gideon Schwarz 在几年前（1978年）提出的用于模型选择的方法，和 AIC 非常相似。它额外考虑了
    *N*，数据集中的样本数量：'
- en: '![](img/B17577_05_020.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_020.png)'
- en: According to BIC, we want a model with few parameters and high log-likelihood,
    but also a small number of training examples.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 根据 BIC，我们希望选择一个具有较少参数和较高对数似然的模型，但同时样本量也要小。
- en: Exponential smoothing
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指数平滑
- en: Exponential smoothing, dating back to the work of Siméon Poisson, is a technique
    for smoothing time-series data using an exponential window function, which can
    be used to forecast time-series with seasonality and trend.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 指数平滑，追溯至 Siméon Poisson 的工作，是一种通过指数窗口函数平滑时间序列数据的技术，可以用于预测具有季节性和趋势的时间序列。
- en: 'The simplest method, **simple exponential smoothing**, **SES**, *s*[t] of a
    time-series *x*[t] can be denoted as:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的方法，**简单指数平滑**，**SES**，*s*[t] 的时间序列 *x*[t] 可以表示为：
- en: '![](img/B17577_05_021.png)![](img/B17577_05_022.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_021.png)![](img/B17577_05_022.png)'
- en: where ![](img/B17577_05_023.png) is the exponential smoothing factor (a value
    between 0 and 1).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ![](img/B17577_05_023.png) 是指数平滑因子（一个介于 0 和 1 之间的值）。
- en: Essentially, this is the weighted moving average with weights *α* and ![](img/B17577_05_024.png).
    You can think of the second term, ![](img/B17577_05_025.png) as recursive, where,
    when expanding, ![](img/B17577_05_026.png) gets multiplied by itself over and
    over – this is the exponential term.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 本质上，这是一个加权移动平均，权重为 *α* 和 ![](img/B17577_05_024.png)。你可以把第二项 ![](img/B17577_05_025.png)
    看作递归的，在展开时， ![](img/B17577_05_026.png) 会被重复相乘——这就是指数项。
- en: Parameter ![](img/B17577_05_027.png) controls how much the smoothed value is
    determined by current versus previous values. The effect of this formula, as with
    moving averages, is that the result becomes smoother.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 参数 ![](img/B17577_05_027.png) 控制平滑值在当前值和前值之间的决定权重。与移动平均法相似，这个公式的效果是结果变得更加平滑。
- en: Interestingly, John Muth showed in 1960 that SES provided the optimal forecasts
    for a time-series where, at each time step, the values take a random step away
    from its previous value, and steps are independently and identically distributed
    in size plus noise. This kind of time-series is called a random walk, and sometimes,
    the price of a fluctuating stock is assumed to be following such a behavior.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，John Muth 在1960年展示了 SES 在时间序列中提供了最佳预测，其中在每个时间步，值会随机偏离前一个值，而且步长是独立同分布的，加上噪声。这种时间序列称为随机游走，有时，波动的股票价格假定遵循这种行为。
- en: The **Theta method**, another exponential smoothing method, is of particular
    interest to practitioners since it performed well in the M3 competition in 2000\.
    The M3 competition, named after Spyros Makridakis, its organizer, who is a professor
    at the University of Nicosia and Director of the Institute for the Future, was
    a competition for forecasting across 3003 time-series from micro-economics, industry,
    finance, demographic, and other domains. One of its main conclusions was that
    very simple methods can perform well with univariate time-series forecasts. The
    M3 competition proved to be a watershed moment for forecasting, providing benchmarks
    and the **state of the art** (**SOTA**), even though the SOTA has significantly
    changed since then, as we'll see in *Chapter 7*, *Machine Learning Models for
    Time-Series*.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种指数平滑方法是**Theta方法**，它对从业者尤其具有吸引力，因为它在2000年的M3竞赛中表现出色。M3竞赛得名于其组织者斯皮罗斯·马克里达基斯（Spyros
    Makridakis），他是尼科西亚大学的教授兼未来研究所的主任。该竞赛涉及3003个来自微观经济学、工业、金融、人口学等领域的时间序列。其主要结论之一是，非常简单的方法也可以在单变量时间序列预测中表现良好。M3竞赛被证明是预测领域的一个转折点，提供了基准和**最先进的技术**（**SOTA**），尽管自那时以来，SOTA已经发生了显著变化，正如我们在*第七章*《时间序列的机器学习模型》中将看到的那样。
- en: The Theta method was proposed by Vassilis Assimakopoulos and Konstantinos Nikolopoulos
    in 2000 and re-stated in 2001 by Rob Hyndman and Baki Billah. The Theta model
    can be understood as **simple exponential smoothing** (**SES**) with drift.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: Theta方法由瓦西里斯·阿西马科普洛斯（Vassilis Assimakopoulos）和科斯塔斯·尼科洛普洛斯（Konstantinos Nikolopoulos）于2000年提出，并由罗布·海德曼（Rob
    Hyndman）和巴基·比拉（Baki Billah）在2001年重新阐述。Theta模型可以理解为**简单指数平滑**（**SES**）带有漂移项。
- en: This method is based on the decomposition of the de-seasonalized data into two
    lines. The first so-called "theta" line estimates the long-term component, the
    trend, and then takes the weighted average of this trend and the SES.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法基于将去季节化数据分解为两条线。第一条所谓的“theta”线估计长期成分——趋势，然后将此趋势与SES的加权平均值相结合。
- en: 'Let''s state this more formally! The trend component is forecast like this:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更正式地阐述这一点！趋势成分的预测公式如下：
- en: '![](img/B17577_05_028.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_028.png)'
- en: In this equation, *c* is the intercept, ![](img/B17577_05_029.png) is a coefficient
    multiplied by the time step, and ![](img/B17577_05_030.png) is the residual. ![](img/B17577_05_031.png)
    can be fit through ordinary least-squares.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个方程中，*c*是截距，![](img/B17577_05_029.png)是乘以时间步长的系数，![](img/B17577_05_030.png)是残差。![](img/B17577_05_031.png)可以通过普通最小二乘法拟合。
- en: 'The formula for Theta is then taking this trend and adding it to the SES as
    a weighted sum:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: Theta的公式是将这一趋势与SES加权求和：
- en: '![](img/B17577_05_032.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_032.png)'
- en: Here, ![](img/B17577_05_033.png) is the forecast for *X* at time step *t*.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![](img/B17577_05_033.png)是时间步长*t*时刻的*X*预测值。
- en: One of the most popular exponential smoothing methods is the **Holtz-Winters
    method**. Charles Holtz, professor at the University of Chicago, first published
    a method for double exponential smoothing (1957) that allowed forecasting based
    on trend and level. His student Peter Winters extended the method to capture seasonality
    in 1960 ("*Forecasting sales by exponentially weighted moving averages*"). Even later,
    Holtz-Winters smoothing was extended to account for multiple seasonalities (n-order
    smoothing).
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 最流行的指数平滑方法之一是**霍尔茨-温特斯方法**。芝加哥大学的查尔斯·霍尔茨教授于1957年首次发布了一种双重指数平滑方法，该方法允许基于趋势和水平进行预测。他的学生彼得·温特斯在1960年扩展了该方法，以捕捉季节性（“*通过指数加权移动平均法预测销售额*”）。即便在后期，霍尔茨-温特斯平滑法也被进一步扩展，以考虑多重季节性（n阶平滑）。
- en: To apply the Holtz-Winters method, we first remove trend and seasonality. Then
    we forecast the time-series and add back the seasonality and trend.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 为了应用霍尔茨-温特斯方法，我们首先去除趋势和季节性。然后我们预测时间序列并将季节性和趋势加回来。
- en: We can distinguish additive and multiplicative variations of the method. Both
    trend and seasonality can be either additive or multiplicative.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以区分方法的加性和乘法变体。趋势和季节性都可以是加性或乘法的。
- en: An additive seasonality is seasonality added independently of the values of
    the series. A multiplicative seasonal component is added proportionally, when
    the seasonal effect decreases or increases with the values (or the trend) in the
    time-series. A visual inspection can help in deciding between the two variations.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 加性季节性是独立于系列值添加的季节性。乘法季节性成分是按比例添加的，当季节效应随着时间序列中的值（或趋势）的增加或减少而变化时。通过视觉检查可以帮助决定使用哪种变体。
- en: 'The Holtz-Winters method is also called triple exponential smoothing because
    it applies exponential smoothing three times as we''ll see. The Holtz-Winters
    method captures three components:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: Holtz-Winters 方法也称为三重指数平滑法，因为它应用了三次指数平滑，正如我们所见。Holtz-Winters 方法捕捉了三个组成部分：
- en: An estimate of a level for each time point, *L*[t] – this could be an average
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对每个时间点的水平估计，*L*[t] —— 这可能是一个平均值
- en: A trend component *T*
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 趋势分量 *T*
- en: Seasonality *S*[t] with *m* seasons (the number of seasons in a year)
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 季节性 *S*[t]，具有 *m* 个季节（即一年中的季节数）
- en: 'With additive trend and seasonality, in mathematical terms, the Holtz-Winters
    forecast for a value ![](img/B17577_05_034.png) is defined as:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 对于加性趋势和季节性，在数学上，Holtz-Winters 预测值 ![](img/B17577_05_034.png) 定义为：
- en: '![](img/B17577_05_035.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_035.png)'
- en: 'With **multiplicative seasonality**, we multiply by the seasonality:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 **乘法季节性**，我们将其与季节性相乘：
- en: '![](img/B17577_05_036.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_036.png)'
- en: 'The level is updated as follows:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 水平更新如下：
- en: '![](img/B17577_05_037.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_037.png)'
- en: We are updating the current level based on a weighted average of two terms,
    with ![](img/B17577_05_038.png) being the weight between them. These two terms
    are the previous level and the de-seasonalized value of the series.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们基于两个项的加权平均来更新当前水平，其中 ![](img/B17577_05_038.png) 为两者之间的权重。这两个项分别是前一水平和去季节化后的系列值。
- en: 'In this equation, we are de-seasonalizing the series by dividing by the seasonality:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个方程中，我们通过除以季节性来进行去季节化：
- en: '![](img/B17577_05_039.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_039.png)'
- en: 'And the previous trend component gets added up to the previous level like this:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的趋势分量会像这样被加到前一个水平：
- en: '![](img/B17577_05_040.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_040.png)'
- en: 'The trend update is as follows (for additive trend):'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 趋势更新如下（对于加性趋势）：
- en: '![](img/B17577_05_041.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_041.png)'
- en: 'Finally, the (multiplicative) seasonality update is as follows:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，（乘法）季节性更新如下：
- en: '![](img/B17577_05_042.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_042.png)'
- en: We can switch these equations to additive variations as required. A more detailed
    treatment is beyond the scope of this book – we'll leave it here.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以根据需要将这些方程切换为加性变体。本书的范围之外会有更详细的讨论——我们就此止步。
- en: ARCH and GARCH
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ARCH 和 GARCH
- en: Robert F. Engle, professor of economics at MIT, proposed a model for time-series
    forecasting (1982) that he named **ARCH** (**Auto-Regressive Conditionally Heteroscedastic**).
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 麻省理工学院经济学教授 Robert F. Engle 提出了一个时间序列预测模型（1982），他将其命名为 **ARCH**（**自回归条件异方差**）。
- en: For financial institutions, value at risk, the level of financial risk over
    a specific time period, is an important concept for risk management. Therefore,
    it is crucial to account for the covariance structure of asset returns. This is
    what ARCH does and explains its importance.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 对于金融机构而言，风险价值（value at risk），即在特定时间段内的金融风险水平，是风险管理中的一个重要概念。因此，考虑资产收益的协方差结构至关重要。这就是
    ARCH 所做的，也解释了其重要性。
- en: In fact, in recognition of his contributions to the field of time-series econometrics,
    Engle was awarded the 2003 Nobel Prize in Economics (Nobel Memorial Prize in Economic
    Sciences), together with Clive Granger, who we encountered earlier. The citation
    specifically mentioned his groundbreaking work on ARCH.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，鉴于他在时间序列计量经济学领域的贡献，Engle 与之前提到的 Clive Granger 一起，于 2003 年获得了诺贝尔经济学奖（诺贝尔经济科学纪念奖）。表彰中特别提到了他在
    ARCH 方面的开创性工作。
- en: While, in ARMA-type models, returns are modeled as independent and identically
    distributed over time, ARCH allows for time-varying (heteroscedastic) error terms
    by parametrizing higher-order dependence between returns observed at varying frequencies.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在 ARMA 型模型中，收益被建模为独立且在时间上相同分布，而 ARCH 通过对收益在不同频率下的高阶依赖性进行参数化，从而允许时间变化的（异方差）误差项。
- en: 'In ARCH, the residuals are expressed as consisting of a stochastic, *z*[t],
    and a standard deviation, ![](img/B17577_05_043.png), both of which are time-dependent:
    ![](img/B17577_05_044.png).'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在 ARCH 中，残差表示为由一个随机项 *z*[t] 和一个标准差 ![](img/B17577_05_043.png) 组成，这两者都是时间相关的：
    ![](img/B17577_05_044.png)。
- en: 'The standard deviation of the residual at time *t* is modeled depending on
    the residuals of the series at previous points:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 时间 *t* 处残差的标准差模型依赖于前期点的残差：
- en: '![](img/B17577_05_045.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_045.png)'
- en: where q is the number of preceding time points the variance depends on.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 q 是方差依赖的前期时间点的数量。
- en: The model ARCH(q) can be determined using least-squares.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 模型 ARCH(q) 可以通过最小二乘法来确定。
- en: The least-squares algorithm is to solve the linear equations y=X.β for β. It
    consists of finding the parameters that minimize the square of the error, ![](img/B17577_05_046.png).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 最小二乘法算法是求解线性方程 y=X.β 以获得 β。它的原理是找到最小化误差平方和的参数，即 ![](img/B17577_05_046.png)。
- en: '**GARCH** (**generalized ARCH**) was born when Tim Bollerslev (1986) and Stephen
    Taylor (1986) both independently extended Engle''s model to make it more general.
    The main difference between GARCH and ARCH is that the residuals come from an ARCH
    model rather than from an autoregressive model, AR.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '**GARCH**（**广义自回归条件异方差模型**）是在 Tim Bollerslev（1986）和 Stephen Taylor（1986）分别扩展
    Engle 模型使其更具普遍性时诞生的。GARCH 和 ARCH 之间的主要区别在于，残差来自 ARCH 模型，而不是自回归模型 AR。'
- en: Generally, before applying a GARCH or ARCH model, a statistical test for homoscedasticity
    is applied, in other words, whether the variance is constant over time. Commonly
    used is the ARCH-LM test, which works with the null hypothesis that the time-series
    has no ARCH effects.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在应用 GARCH 或 ARCH 模型之前，会进行同方差性的统计检验，换句话说，就是检验方差是否随时间保持恒定。常用的检验方法是 ARCH-LM
    检验，零假设为时间序列没有 ARCH 效应。
- en: Vector autoregression
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 向量自回归
- en: All the previous forecasting methods presented in this chapter are for univariate
    time-series, that is, time-series that consist of a single time-dependent variable,
    a single vector. In practice, we usually know more than our single sequence of
    measurements.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍的所有预测方法都针对单变量时间序列，即由单一时间依赖变量组成的时间序列，一个单一向量。在实践中，我们通常知道比单一测量序列更多的信息。
- en: For example, if our time-series is about the number of ice cream sales, we might
    know the temperatures or the sales of bathing suits. We could expect that the
    sales of ice cream are highly correlated to temperature, in fact, we might expect
    that ice cream is increasingly consumed when temperatures are high. Equally, we
    could speculate that the sales of bathing suits either coincide, pre-date, or
    post-date the sales of ice cream.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们的时间序列是关于冰淇淋销量的，我们可能还知道温度或泳衣的销量。我们可以预期冰淇淋销量与温度高度相关，实际上，当气温较高时，冰淇淋的消费可能会增加。同样，我们也可以推测泳衣的销量与冰淇淋的销量要么同时发生，要么先于冰淇淋销量，或晚于冰淇淋销量。
- en: Vector autoregression models can track the relationships between several variables
    as they change over time. They can capture the linear dependence of a time-series
    on a vector of values that precedes the current timestamp, generalizing the AR
    model to multivariate time-series.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 向量自回归模型可以追踪多个变量随时间变化的关系。它们可以捕捉时间序列与当前时间戳之前的数值向量之间的线性依赖，将 AR 模型推广到多变量时间序列。
- en: 'VAR models are characterized by their order, which refers to the number of
    preceding time points that go into the model. The simplest case, VAR(1), where
    the model takes just one lag of the series, can be formulated as follows:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: VAR 模型的特点是其阶数，即模型中考虑的前几个时间点的数量。最简单的情况是 VAR(1)，其中模型只考虑时间序列的一个滞后项，公式如下：
- en: '![](img/B17577_05_047.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_047.png)'
- en: where *c* is a constant, the intercept of the line, ![](img/B17577_05_048.png)
    are the coefficients of the model, and ![](img/B17577_05_049.png) is the error
    term at point t. *x*[t] and *c* are vectors of length *k*, while ![](img/B17577_05_050.png)
    is a ![](img/B17577_05_051.png) matrix.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *c* 是常数，即直线的截距，![](img/B17577_05_048.png) 是模型的系数，而 ![](img/B17577_05_049.png)
    是 t 时刻的误差项。*x*[t] 和 *c* 是长度为 *k* 的向量，而 ![](img/B17577_05_050.png) 是一个 ![](img/B17577_05_051.png)
    矩阵。
- en: 'A p-order model, VAR(p), is denoted as:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: p 阶模型，VAR(p)，表示为：
- en: '![](img/B17577_05_052.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17577_05_052.png)'
- en: VAR assumes that the error terms have a mean of 0 and that there is no serial
    correlation of error terms.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: VAR 假设误差项的均值为 0，且误差项之间没有序列相关性。
- en: Just like vector autoregression is a multivariate generalization of autoregression,
    **vector ARIMA** (**VARIMA**) is an extension of the univariate ARIMA model to
    multivariate time-series. Although it was formalized already as early as 1957,
    available software implementations only appeared much later.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 就像向量自回归是自回归的多变量推广，**向量 ARIMA**（**VARIMA**）是对单变量 ARIMA 模型的扩展，用于多变量时间序列。尽管早在 1957
    年就已经正式提出，但可用的软件实现直到后来才出现。
- en: In the next section, we'll look at a few libraries in Python that we can use
    for forecasting with classical models.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍一些可以在 Python 中用于经典模型预测的库。
- en: Python libraries
  id: totrans-171
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Python 库
- en: 'There are a few popular libraries for classical time-series modeling in Python,
    but the most popular by far is statsmodels. The following chart compares the popularity
    of libraries in terms of the number of stars on GitHub:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: Python 中有一些流行的经典时间序列建模库，但其中最流行的无疑是 statsmodels。以下图表比较了各库在 GitHub 上的星标数，显示它们的受欢迎程度：
- en: '![forecasting_libraries.png](img/B17577_05_03.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![forecasting_libraries.png](img/B17577_05_03.png)'
- en: 'Figure 5.3: Popularity of Python libraries for classical time-series forecasting'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.3：Python 经典时间序列预测库的受欢迎程度
- en: Statsmodels is clearly the most popular among these libraries. I've only chosen
    to include libraries that are actively maintained and that implement the algorithms
    directly rather than importing them from other libraries. The SkTime or Darts
    libraries, for example, offer traditional forecasting models, but they are not
    implemented there, but in statsmodels.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: Statsmodels 显然是这些库中最受欢迎的。我只选择了那些积极维护并直接实现算法的库，而不是从其他库导入的库。例如，SkTime 或 Darts
    库提供传统的预测模型，但这些模型并未在它们那里实现，而是在 statsmodels 中实现的。
- en: pmdarima (originally pyramid-arima) contains a parameter search to help fit
    the best ARIMA model to univariate time-series. Anticipy contains a number of
    models, such as exponential decay and step models. Arch implements tools for financial
    econometrics and functionality for **Autoregressive Conditional Heteroscedasticity**
    (**ARCH**).
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: pmdarima（最初是 pyramid-arima）包含一个参数搜索功能，帮助拟合最佳 ARIMA 模型到单变量时间序列。Anticipy 包含一些模型，如指数衰减模型和阶梯模型。Arch
    实现了金融计量经济学工具和 **自回归条件异方差性**（**ARCH**）的功能。
- en: While not as active as Scikit-Learn and only maintained by a couple of people,
    statsmodels is the go-to library for traditional statistics and econometrics approaches
    to time-series, with a much stronger emphasis on parameter estimation and statistical
    testing than machine learning.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管 statsmodels 的活跃度不如 Scikit-Learn，且仅由少数人维护，但它仍是时间序列传统统计和计量经济学方法的首选库，尤其在参数估计和统计检验上，强调程度远高于机器学习。
- en: Statsmodels
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Statsmodels
- en: The statsmodels library can help to estimate statistical models and perform
    statistical tests. It's built on SciPy and NumPy and has lots of statistical functions
    and models.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: statsmodels 库可以帮助估计统计模型并进行统计检验。它基于 SciPy 和 NumPy，包含许多统计函数和模型。
- en: 'The following table illustrates some of the modeling classes relevant to this
    chapter:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格展示了与本章相关的一些建模类：
- en: '| Class | Description |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| 类别 | 描述 |'
- en: '| `ar_model.AutoReg` | Univariate Autoregression Model |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| `ar_model.AutoReg` | 单变量自回归模型 |'
- en: '| `arima.model.ARIMA` | Autoregressive Integrated Moving Average (ARIMA) model
    |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| `arima.model.ARIMA` | 自回归积分滑动平均（ARIMA）模型 |'
- en: '| `ExponentialSmoothing` | Holt Winter''s Exponential Smoothing |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| `ExponentialSmoothing` | Holt Winter’s 指数平滑 |'
- en: '| `SimpleExpSmoothing` | Simple Exponential Smoothing |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| `SimpleExpSmoothing` | 简单指数平滑 |'
- en: 'Figure 5.4: A few models implemented in statsmodels'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.4：statsmodels 中实现的几个模型
- en: The ARIMA class also has functionality for SARIMA through a *seasonal_order*
    parameter, ARIMA, with seasonal components. By definition, ARIMA also supports
    MA, AR, and differencing (integration).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA 类还通过 *seasonal_order* 参数支持 SARIMA，即带有季节性组件的 ARIMA。根据定义，ARIMA 还支持 MA、AR
    和差分（集成）。
- en: There are some other models, such as MarkovAutoregression, but we won't go through
    all of these – we will work through a selection.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一些其他模型，如 Markov 自回归模型，但我们不会逐一讲解，我们将选择性地讲解一些。
- en: 'Some other useful functions are listed here:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这里列出了其他一些有用的函数：
- en: '| Function | Description |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 描述 |'
- en: '| `stattools.kpss` | Kwiatkowski-Phillips-Schmidt-Shin test for stationarity
    |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| `stattools.kpss` | Kwiatkowski-Phillips-Schmidt-Shin 平稳性检验 |'
- en: '| `stattools.adfuller` | Augmented Dickey-Fuller unit root test |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| `stattools.adfuller` | 扩展的 Dickey-Fuller 单位根检验 |'
- en: '| `stattools.ccf` | The cross-correlation function |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| `stattools.ccf` | 互相关函数 |'
- en: '| `stattools.pacf` | Partial autocorrelation estimate |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| `stattools.pacf` | 偏自相关估计 |'
- en: '| `stats.diagnostic.het_arch` | Engle''s Test for Autoregressive Conditional
    Heteroscedasticity (ARCH), also referred to as the ARCH-LM test |'
  id: totrans-195
  prefs: []
  type: TYPE_TB
  zh: '| `stats.diagnostic.het_arch` | Engle 的自回归条件异方差性（ARCH）检验，也称为 ARCH-LM 检验 |'
- en: '| `stattools.q_stat` | Ljung-Box Q Statistic |'
  id: totrans-196
  prefs: []
  type: TYPE_TB
  zh: '| `stattools.q_stat` | Ljung-Box Q 统计量 |'
- en: '| `tsa.seasonal.seasonal_decompose` | Seasonal decomposition using moving averages
    |'
  id: totrans-197
  prefs: []
  type: TYPE_TB
  zh: '| `tsa.seasonal.seasonal_decompose` | 使用移动平均法进行季节性分解 |'
- en: '| `tsa.tsatools.detrend` | Detrend a vector |'
  id: totrans-198
  prefs: []
  type: TYPE_TB
  zh: '| `tsa.tsatools.detrend` | 去趋势一个向量 |'
- en: 'Figure 5.5: Useful functions in statsmodels'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.5：statsmodels 中的有用函数
- en: 'As a convention, we import statsmodels like this:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 按照惯例，我们像这样导入 statsmodels：
- en: '[PRE0]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: These statsmodels algorithms are also available through SkTime, which makes
    them available through an interface similar to the Sklearn interface.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 这些 statsmodels 算法也可以通过 SkTime 使用，它通过类似 Sklearn 接口的方式提供访问。
- en: This should be enough for a brief overview. Let's get into the modeling itself!
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该足够提供一个简短的概览。接下来我们进入建模部分！
- en: Python practice
  id: totrans-204
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Python 实践
- en: As mentioned in the introduction to this chapter, we are going to be using the
    statsmodels library for modeling.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 正如本章引言所述，我们将使用 statsmodels 库进行建模。
- en: Requirements
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 需求
- en: 'In this chapter, we''ll use several libraries, which we can quickly install
    from the terminal (or similarly from the anaconda navigator):'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用几个库，这些库可以从终端（或类似地从 Anaconda Navigator）快速安装：
- en: '[PRE1]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We'll execute the commands from the Python (or IPython) terminal, but equally,
    we could execute them from a Jupyter notebook (or a different environment).
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从 Python（或 IPython）终端执行这些命令，当然，我们也可以从 Jupyter notebook（或其他环境）执行。
- en: Let's get down to modeling!
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始建模吧！
- en: Modeling in Python
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Python 中的建模
- en: We'll work with a stock ticker dataset from Yahoo finance that we'll download
    through the yfinance library. We'll first load the dataset, do some quick exploration,
    and then we'll build several models mentioned in this chapter.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 Yahoo 财经的股票代码数据集，通过 yfinance 库下载。我们首先加载数据集，进行一些快速探索，然后构建本章中提到的几个模型。
- en: 'We''ll load a series of Standard & Poor''s depositary receipts (SPDR S&P 500
    ETF Trust):'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将加载一系列标准普尔存托凭证（SPDR S&P 500 ETF 信托基金）：
- en: '[PRE2]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We have to indicate the date range and the ticker symbol. The daily prices come
    for Open, Close, and others. We'll work with the Open prices.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要指定日期范围和股票代码。每日价格包括开盘价、收盘价等。我们将使用开盘价进行分析。
- en: The index column is already a pandas DateTimeIndex so we don't have to convert
    it. Let's plot the series!
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 索引列已经是 pandas 的 DateTimeIndex，因此我们无需进行转换。现在，让我们绘制这个时间序列图！
- en: '[PRE3]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This gives us the following graph:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成以下图表：
- en: '![ticker_price.png](img/B17577_05_04.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![ticker_price.png](img/B17577_05_04.png)'
- en: 'Figure 5.6: Standard & Poor''s depositary receipt prices over time'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.6：标准普尔存托凭证价格随时间变化
- en: Since this is daily data, and there are either 253 or 252 working days in the
    year, I've decided to resample the data to weekly data and make each year consistent.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是每日数据，且每年有 253 或 252 个工作日，我决定将数据重采样为每周数据，使每年数据保持一致。
- en: '[PRE4]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Some years have 53 weeks. We can't handle that, so we'll get rid of the 53rd
    week. We now have weekly data over 52 weeks across 16 years.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 有些年份有 53 周。我们无法处理这种情况，因此将去掉第 53 周。现在我们有跨越 16 年的 52 周的每周数据。
- en: 'One final fix: statsmodels can use the frequency information associated with
    the DateTimeIndex; however, this is often not set and `df1.index.freq` is `None`.
    So, we''ll set it ourselves:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个修正：statsmodels 可以使用与 DateTimeIndex 相关联的频率信息；然而，这通常没有设置，`df1.index.freq`
    为 `None`。所以，我们将自己设置：
- en: '[PRE5]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'If we check now, `df1.index.freq` is `<Week: weekday=6>.`'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: '如果我们现在检查，`df1.index.freq` 为 `<Week: weekday=6>`。'
- en: Setting the frequency can lead to missing values. Therefore, we are carrying
    over from the last valid value for missing values with the `fillna()` operation.
    If we don't do this, some of the models won't converge and give us NaN (not a
    number) values back instead of forecasts.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 设置频率可能会导致缺失值。因此，我们使用 `fillna()` 操作将缺失值替换为最后一个有效值。如果不这样做，某些模型将无法收敛，并且会返回 NaN（非数字）值，而不是预测值。
- en: 'Now we need to get some idea of reasonable ranges for the order of the model.
    We''ll look at the autocorrelation and partial autocorrelation functions for this:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要了解模型阶数的合理范围。我们将查看自相关和部分自相关函数来帮助确定：
- en: '[PRE6]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This gives us the following graph:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成以下图表：
- en: '![pcf_acf.png](img/B17577_05_05.png)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![pcf_acf.png](img/B17577_05_05.png)'
- en: 'Figure 5.7: Partial autocorrelation and autocorrelation'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.7：部分自相关与自相关
- en: These graphs show the correlation of the time-series with itself at lags of
    up to 20 time steps. R or ![](img/B17577_05_053.png) values close to 0 mean that
    consecutive observations at the lags are not correlated with one another. Inversely,
    correlations close to 1 or -1 indicate that there exists a strong positive or
    negative correlation between these observations at the lags.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 这些图表显示了时间序列在最多 20 个时间步的滞后期上的自相关性。R 或 ![](img/B17577_05_053.png) 值接近 0 表示滞后期的连续观察值之间没有相关性。相反，接近
    1 或 -1 的相关性表示这些滞后期的观察值之间存在强烈的正相关或负相关。
- en: Both the autocorrelation and the partial autocorrelation return confidence intervals.
    The correlation is significant if it goes beyond the confidence interval (represented
    as shaded regions).
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 自相关和部分自相关都返回置信区间。如果自相关值超出了置信区间（表示为阴影区域），则表明相关性显著。
- en: We can see that the partial autocorrelation with lag 1 is very high and much
    lower for higher lags. The autocorrelation is significant and high for all lags,
    but the significance drops as the lag increases.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到滞后期为1的部分自相关非常高，而较高滞后的自相关则较低。所有滞后的自相关都显著且较高，但随着滞后期的增加，显著性逐渐降低。
- en: Let's move on to the autoregressive model. From here on, we'll use the statsmodels
    modeling functionality. The interface is very convenient, as you'll see.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续讨论自回归模型。从这里开始，我们将使用statsmodels的建模功能。这个接口非常方便，正如你将看到的那样。
- en: We can't use an autoregressive model straight off because it needs the time-series
    to be stationary, which means the mean and variance is constant over time – no
    seasonality, no trend.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不能直接使用自回归模型，因为它需要时间序列是平稳的，这意味着均值和方差在时间上是恒定的——没有季节性，没有趋势。
- en: 'We can use statsmodels utilities to look at seasonality and trend from the
    time-series:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用statsmodels工具来查看时间序列的季节性和趋势性：
- en: '[PRE7]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We set the period to 1 because each data point (row) corresponds to a year.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将周期设置为1，因为每个数据点（行）对应一年。
- en: 'Let''s see what the components look like:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看各个组成部分的样子：
- en: '![seasonal_decompose.png](img/B17577_05_06.png)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![seasonal_decompose.png](img/B17577_05_06.png)'
- en: 'Figure 5.8: Seasonal decomposition of the time-series'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.8：时间序列的季节性分解
- en: The first subplot is the original time-series. There are both seasonality and
    trend in this dataset, which you can see separated out in the subplots.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个子图是原始时间序列。这个数据集包含季节性和趋势性，您可以在子图中看到这些成分被分离出来。
- en: As discussed, we need a stationary series for modeling. To establish stationarity,
    we need to remove the seasonal and trend components. We could also take off the
    seasonal or trend components that we estimated just before. Alternatively, we
    can use wrapper functionality in statsmodels or set the d parameter in ARIMA.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们需要一个平稳的序列来进行建模。为了建立平稳性，我们需要去除季节性和趋势性成分。我们也可以去除我们之前估算的季节性或趋势性成分。或者，我们可以使用statsmodels中的封装功能，或者在ARIMA中设置d参数。
- en: 'We can use the Augmented Dickey-Fuller and KPSS tests to check for stationarity:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用扩展的迪基-富勒（Augmented Dickey-Fuller）和KPSS检验来检查平稳性：
- en: '[PRE8]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We could have used `statsmodels.tsa.stattools.adfuller` or `statsmodels.tsa.stattools.kpss`,
    but we prefer the convenience of the ARCH library versions. We are leaving it
    to the user to check the output of the KPSS test. We get the following output:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们本可以使用`statsmodels.tsa.stattools.adfuller`或`statsmodels.tsa.stattools.kpss`，但我们更喜欢ARCH库版本的方便性。我们将留给用户检查KPSS检验的输出。我们得到了如下输出：
- en: '![/var/folders/80/g9sqgdws2rn0yc3rd5y3nd340000gp/T/TemporaryItems/NSIRD_screencaptureui_Y7Tw2W/Screenshot
    2021-08-22 at 15.36.52.png](img/B17577_05_07.png)'
  id: totrans-249
  prefs: []
  type: TYPE_IMG
  zh: '![/var/folders/80/g9sqgdws2rn0yc3rd5y3nd340000gp/T/TemporaryItems/NSIRD_screencaptureui_Y7Tw2W/Screenshot
    2021-08-22 at 15.36.52.png](img/B17577_05_07.png)'
- en: 'Figure 5.9: Output from the KPSS test for stationarity'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.9：KPSS检验平稳性的输出
- en: Given the p-value of 0.997, we can reject our null hypothesis of the unit root,
    and we conclude that our process is weakly stationary.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 给定p值为0.997，我们可以拒绝单位根的原假设，并得出结论，我们的过程是弱平稳的。
- en: 'So how do we find good values for the differencing? We can use the pmdarima
    library for this, where there is a function for precisely this purpose:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 那么我们如何找到合适的差分值呢？我们可以使用pmdarima库，它提供了一个专门用于此目的的函数：
- en: '[PRE9]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We get a value of 1\. We would get the same values for the KPSS and the PP tests.
    This means that we can work off the first difference.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到了一个值1。对于KPSS和PP检验，我们会得到相同的值。这意味着我们可以从第一次差分开始工作。
- en: Let's start with an autoregressive model.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从自回归模型开始。
- en: 'As a reminder, ARIMA is parametrized with parameters p, d, q, where:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 提醒一下，ARIMA模型由参数p、d、q来定义，其中：
- en: 'p is for the autoregressive model: AR(p)'
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: p表示自回归模型：AR(p)
- en: d is for the integration
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: d表示积分
- en: 'q is for the moving average: MA(q)'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: q表示移动平均：MA(q)
- en: Therefore, ARIMA(p, d, 0) is AR(p) with a differencing of order d.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，ARIMA(p, d, 0) 就是带有差分阶数d的AR(p)模型。
- en: 'It is reassuring to know that statsmodels checks and warns if the stationarity
    assumption is not warranted. Let''s try to run to fit the following AR model:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 知道statsmodels会检查并警告平稳性假设是否成立，让人放心。让我们尝试运行以拟合以下AR模型：
- en: '[PRE10]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Since we already know we need a differencing of one degree, we can set d to
    1\. Let''s try again. This time, we''ll use the `STLForecast` wrapper that removes
    seasonality and adds it back in. This is necessary since ARIMA can''t handle seasonality
    out of the box:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经知道需要进行一次差分处理，我们可以将 d 设置为 1。再试一次。这次，我们将使用 `STLForecast` 包装器，它能去除季节性并重新加回季节性。这是必要的，因为
    ARIMA 无法直接处理季节性：
- en: '[PRE12]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'We get this summary:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下总结：
- en: '![/var/folders/80/g9sqgdws2rn0yc3rd5y3nd340000gp/T/TemporaryItems/NSIRD_screencaptureui_EjesO5/Screenshot
    2021-08-22 at 17.07.45.png](img/B17577_05_08.png)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![/var/folders/80/g9sqgdws2rn0yc3rd5y3nd340000gp/T/TemporaryItems/NSIRD_screencaptureui_EjesO5/Screenshot
    2021-08-22 at 17.07.45.png](img/B17577_05_08.png)'
- en: 'Figure 5.10: Summary of our ARIMA model'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.10：我们的 ARIMA 模型概述
- en: This result summary gives all the key statistics. We see that the model was
    ARIMA(1, 1, 0). The log-likelihood was -1965\. We also see the BIC and AIC values
    that we can use for model selection if we want.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结果总结提供了所有关键统计数据。我们看到模型是 ARIMA(1, 1, 0)。对数似然值为 -1965。我们还看到了 BIC 和 AIC 值，这些值可以用于模型选择。
- en: Please note that we need to set `trend="t"` here so that the model includes
    a constant. If not, we would get a spurious regression.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们在这里需要设置 `trend="t"`，这样模型就会包含常数项。如果不设置，我们将得到一个虚假的回归结果。
- en: How can we use this model? Let's do some forecasting!
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何使用这个模型？让我们进行一些预测！
- en: '[PRE13]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This gives us a forecast 20 steps into the future.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 这给我们提供了一个未来 20 步的预测。
- en: Let's visualize this!
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来可视化一下！
- en: '[PRE14]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Here''s what we get:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们得到的结果：
- en: '![spy_forecast.png](img/B17577_05_09.png)'
  id: totrans-277
  prefs: []
  type: TYPE_IMG
  zh: '![spy_forecast.png](img/B17577_05_09.png)'
- en: 'Figure 5.11: Forecast of prices for the SPY ticker symbol'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.11：SPY 股票代码的价格预测
- en: The solid line is the data that we know. The dotted line represents our forecast
    20 years into the future. The gray area around our forecast is the 95% confidence
    interval.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 实线表示我们已知的数据，虚线代表我们预测的未来 20 年的结果。我们预测值周围的灰色区域是 95% 的置信区间。
- en: This doesn't look too bad. It's left as an exercise to the reader to try with
    different parameters. Interesting ones to change are the trend parameter and the
    order of the model.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 这个看起来还不错。作为读者的练习，可以尝试使用不同的参数。值得更改的有趋势参数和模型的阶数。
- en: For the moving average, let's create different models to see the difference
    in their forecasts!
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 对于移动平均，我们创建不同的模型来观察它们的预测差异！
- en: 'First, we''ll produce the forecasts:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将生成预测：
- en: '[PRE15]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'In the loop, we are iterating over different q parameters, choosing 0, 10,
    and 20\. We estimate moving average models with these values of q and forecast
    20 years ahead. We also print the AIC values corresponding to each q. This is
    the output we get:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 在循环中，我们正在迭代不同的 q 参数，选择 0、10 和 20。我们使用这些 q 值估计移动平均模型，并预测未来 20 年的价格。同时，我们还打印出每个
    q 对应的 AIC 值。这是我们得到的结果：
- en: '[PRE16]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Now, let''s plot the three forecasts similar to how we did before:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们像之前一样绘制三个预测图：
- en: '[PRE17]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Here''s the new plot:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 这是新的图表：
- en: '![forecasts_qs.png](img/B17577_05_10.png)'
  id: totrans-289
  prefs: []
  type: TYPE_IMG
  zh: '![forecasts_qs.png](img/B17577_05_10.png)'
- en: 'Figure 5.12: Forecasts using different q parameters'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.12：使用不同 q 参数的预测
- en: So, which one of these models is statistically better?
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，这些模型中哪一个在统计学上更好呢？
- en: Let's get back to the AIC. The lower the AIC value, the better the model given
    its log-likelihood and the number of parameters.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回到 AIC。AIC 值越低，模型的效果越好，因为它考虑了对数似然和参数的数量。
- en: In this case, the order of 10 gives us the lowest AIC, and according to this
    criterion, we should therefore choose q=10\. Of course, we only tried three different
    values. I'll leave it as an exercise to come up with a more reasonable parameter
    value for q.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，q=10 的阶数给出了最低的 AIC 值，根据这一标准，我们应该选择 q=10。当然，我们只尝试了三个不同的值。接下来我将留给读者作为练习，找出一个更合理的
    q 参数值。
- en: 'Please note that the pmdarima library has functionality for finding the optimal
    parameter values, and the SkTime library provides an implementation for automatic
    discovery of the optimal order of an ARIMA model: AutoARIMA.'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，pmdarima 库具有查找最优参数值的功能，而 SkTime 库提供了 ARIMA 模型最优阶数的自动发现实现：AutoARIMA。
- en: Let's move on and make a forecast using an exponential smoothing model.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用指数平滑模型进行预测。
- en: 'In the loop, we are iterating over different q parameters, choosing 0, 10,
    and 20\. We estimate moving average models with these values of q and forecast
    20 years ahead. We also print the AIC values corresponding to each q. This is
    what we get:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 在循环中，我们正在迭代不同的 q 参数，选择 0、10 和 20。我们使用这些 q 值估计移动平均模型，并预测未来 20 年的价格。同时，我们还打印出每个
    q 对应的 AIC 值。这是我们得到的结果：
- en: '[PRE18]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: This fits the model to our data.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 这将模型拟合到我们的数据上。
- en: 'Let''s get the forecasts for the next 20 years:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们为接下来的20年获取预测：
- en: '[PRE19]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Now, let''s plot the forecasts:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们绘制预测图：
- en: '[PRE20]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Here''s the plot:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 这是图表：
- en: '![exponential_forecast.png](img/B17577_05_11.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![exponential_forecast.png](img/B17577_05_11.png)'
- en: 'Figure 5.13: Exponential smoothing forecast'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.13：指数平滑预测
- en: Until now, we've just looked at the graphs of 20 step-ahead forecasts. We still
    haven't been very sophisticated with an analysis of our model performance. Let's
    have a look at the errors!
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 直到现在，我们只是看了20步预测的图表。我们还没有对模型的表现进行深入分析。让我们看看误差！
- en: 'For this, we first have to split our dataset into training and testing. We
    can do an n-step ahead forecast and check the error. We''ll just take the time-series
    running up to a certain time point as the training data, and the time points after
    that as test data, where we can compare the predictions to actual data points:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们首先需要将数据集划分为训练集和测试集。我们可以进行n步预测并检查误差。我们只需将截至某一时间点的时间序列作为训练数据，之后的时间点作为测试数据，然后将预测值与实际数据点进行比较：
- en: '[PRE21]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Here''s the plot:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 这是图表：
- en: '![theta_forecast.png](img/B17577_05_12.png)'
  id: totrans-310
  prefs: []
  type: TYPE_IMG
  zh: '![theta_forecast.png](img/B17577_05_12.png)'
- en: 'Figure 5.14: ThetaModel forecast'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.14：Theta模型预测
- en: 'The dotted line is the prediction. It doesn''t seem to line up well with the
    actual behavior of the time-series. Let''s quantify this using one of the error
    metrics we''ve discussed in the previous chapter, *Introduction to Machine Learning
    for Time-Series*:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 虚线是预测值。它似乎与时间序列的实际行为不太吻合。让我们使用我们在上一章《时间序列的机器学习入门》中讨论过的误差度量来量化这个问题：
- en: '[PRE22]'
  id: totrans-313
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: We get a value of `37.06611385754943`. This is the root mean squared error (we
    are setting the `squared` parameter to `False`).
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到一个值为`37.06611385754943`。这是均方根误差（我们将`squared`参数设置为`False`）。
- en: In forecasting competitions, such as on the Kaggle website, the lowest error
    wins. In real life, parsimony (simplicity) is important as well; however, we usually
    still aim for the lowest error (by whichever chosen metric) that we can get.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测比赛中，比如Kaggle网站上的比赛，最低误差获胜。在现实中，简洁性（简单性）也很重要；然而，我们通常仍然追求尽可能低的误差（无论采用哪种度量标准）。
- en: There are a lot more models to explore and to play around with, but it's time
    to conclude this chapter.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 还有很多其他模型可以探索和尝试，但现在是时候总结本章内容了。
- en: Summary
  id: totrans-317
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we've talked about time-series forecasting based on moving
    averages and autoregression. This topic comprises a large set of models that are
    very popular in different disciplines, such as econometrics and statistics. These
    models constitute a mainstay in time-series modeling and provide state-of-the-art
    forecasts.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们讨论了基于移动平均和自回归的时间序列预测。这个主题包含了一大套模型，在不同领域（如计量经济学和统计学）中非常流行。这些模型是时间序列建模的支柱，并提供了最先进的预测方法。
- en: We've discussed autoregression and moving averages models, and others that combine
    these two, including ARMA, ARIMA, VAR, GARCH, and others. In the practice session,
    we've applied a few models to a dataset of stock ticker prices.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了自回归和移动平均模型，以及结合这两者的其他模型，包括ARMA、ARIMA、VAR、GARCH等。在实践环节中，我们已经将一些模型应用于股票价格数据集。
