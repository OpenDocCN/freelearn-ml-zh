# <st c="0">前言</st>

*<st c="8">Python Feature Engineering Cookbook</st>*<st c="44">，涵盖了表格数据特征工程的几乎所有方面，包括缺失数据插补、分类编码、变量转换、离散化、缩放和异常值的处理。</st> <st c="251">它还讨论了如何从日期和时间、文本、时间序列和</st> <st c="336">关系数据集中提取特征。</st>

<st c="356">本书将通过展示如何使用开源 Python 库来加速特征工程过程，通过多个实用的、动手的食谱来减轻特征工程的痛苦。</st> <st c="557">在本书中，您将利用</st> `<st c="632">pandas</st>` <st c="638">和</st> `<st c="643">scikit-learn</st>`<st c="655">来转换和创建新的变量。此外，您还将学习利用四大开源特征工程库的力量——Feature-engine、Category Encoders、Featuretools，以及 tsfresh。</st>

<st c="825">您还将发现第二版中没有的额外食谱。</st> <st c="902">这些包括时间序列中的缺失数据插补、使用决策树创建新特征，以及使用中位数绝对偏差突出显示异常值。</st> <st c="1058">更重要的是，我们提供了指导方针，帮助您根据您的模型和数据特征决定使用哪些转换。</st> <st c="1186">您将确切知道每个特征转换是什么、为什么以及如何实现。</st>

# <st c="1266">本书面向对象</st>

<st c="1287">本书面向机器学习和数据科学的学生和专业人员，以及参与部署机器学习模型的软件工程师，他们希望提高自己在数据转换和特征创建方面的技能，以改善模型训练。</st> <st c="1550">本书旨在为所有对特征工程感兴趣或正在从事特征工程的人提供清晰的指导，说明应该做什么，如何做，以及为什么这样做很重要。</st> <st c="1709">本资源超越了基础知识，提供了实用的见解和详细的解释，帮助您有效地掌握特征工程。</st> <st c="1833"></st>

# <st c="1857">本书涵盖内容</st>

*<st c="1879">第一章</st>*<st c="1889">,</st> *<st c="1891">缺失数据插补</st>*<st c="1912">，探讨了用合适的估计值替换数值、分类和时间序列数据中缺失值的技术。</st> <st c="2034">它涵盖了单次和多次插补方法，并展示了如何使用 scikit-learn</st> <st c="2165">和 Feature-engine 来简化插补过程。</st>

*<st c="2184">第二章</st>*<st c="2194">,</st> *<st c="2196">编码分类变量</st>*<st c="2226">，涵盖了将分类变量转换为数值特征的方法。</st> <st c="2303">它从常见的技巧，如独热编码和顺序编码开始，然后探讨了高基数和线性模型的适应性。</st> <st c="2443">本章还讨论了特定领域的编码方法，如证据权重，并展示了如何使用目标编码等方法对高基数变量进行编码，确保你了解如何规范化过程以</st> <st c="2681">避免过拟合</st>。

*<st c="2699">第三章</st>*<st c="2709">,</st> *<st c="2711">转换数值变量</st>*<st c="2743">，讨论了何时以及为什么需要转换变量以用于机器学习模型。</st> <st c="2836">然后，它展示了不同的变量转换函数，并强调每个函数最适合哪种类型的变量。</st> <st c="2973">到本章结束时，你将了解何时需要转换你的变量，以及为什么你应用对数或平方根等函数。</st>

*<st c="3135">第四章</st>*<st c="3145">,</st> *<st c="3147">执行变量离散化</st>*<st c="3181">，介绍了离散化的概念，并强调了其在机器学习中的应用。</st> <st c="3268">本章探讨了各种离散化方法，详细说明了它们的优缺点。</st> <st c="3370">它涵盖了基本的等宽和等频离散化过程，以及使用决策树和</st> *<st c="3499">k</st>*<st c="3500">-均值</st>进行离散化。</st> <st c="3508">最后，它将离散化与编码相结合，以返回与</st> <st c="3599">目标</st>单调的变量。

*<st c="3610">第五章</st>*<st c="3620">,</st> *<st c="3622">处理异常值</st>*<st c="3643">，介绍了识别异常值及其特征的方法。</st> <st c="3721">然后，它讨论了移除异常值或调整其值以适应可接受边界的技巧，利用 pandas</st> <st c="3844">和 Feature-engine。</st>

*<st c="3863">第六章</st>*<st c="3873">,</st> *<st c="3875">从日期和时间变量中提取特征</st> *<st c="3913">变量</st> *<st c="3923">，描述了如何从日期和时间变量中创建特征。</st> <st c="3989">它涵盖了如何从特征中提取日期和时间组件，以及如何组合日期时间变量以及如何处理不同的</st> <st c="4130">时区</st>。

*<st c="4141">第七章</st>*<st c="4151">，</st> *<st c="4153">执行特征缩放</st>*<st c="4179">，涵盖了将变量置于相似尺度的方法。</st> <st c="4237">它讨论了标准化、如何缩放到最大和最小值以及如何执行更稳健的变量缩放形式。</st> <st c="4369">你还将找到关于根据你的模型</st> <st c="4444">和变量选择哪种方法的指南。</st>

*<st c="4458">第八章</st>*<st c="4468">，</st> *<st c="4470">创建新功能</st>*<st c="4491">，介绍了将现有变量组合起来生成新特征的多种方法。</st> <st c="4575">它展示了如何根据领域知识使用数学运算来组合特征。</st> <st c="4666">然后，它讨论了如何通过正弦、余弦和样条曲线的使用来转换特征。</st> <st c="4761">最后，它展示了通过决策树从一个或多个变量中创建特征的价值。</st>

*<st c="4864">第九章</st>*<st c="4874">，</st> *<st c="4876">使用 Featuretools 从关系数据中提取特征</st>*<st c="4934">，介绍了关系数据集，然后解释了我们可以如何利用 Featuretools 在不同的数据聚合级别创建特征。</st> <st c="5085">你将学习如何自动从数值和分类变量、日期时间以及文本中创建数十个特征。</st>

*<st c="5208">第十章</st>*<st c="5219">，</st> *<st c="5221">使用 tsfresh 从时间序列数据创建特征</st>*<st c="5270">，讨论了如何自动从时间序列数据中创建数百个特征，用于监督分类或回归。</st> <st c="5405">你将利用 tsfresh 的强大功能，自动从你的</st> <st c="5505">时间序列中创建和选择相关特征。</st>

*<st c="5517">第十一章</st>*<st c="5528">，</st> *<st c="5530">从文本变量中提取特征</st>*<st c="5569">，探讨了有效的方法来清理和从短文本片段中提取特征，用于监督学习模型。</st> <st c="5692">本章涵盖了计数单词、句子和字符以及测量词汇多样性的技术。</st> <st c="5795">此外，它指导你通过文本清理过程，并演示了如何通过计数单词来构建特征矩阵。</st>

# <st c="5920">为了最大限度地利用这本书</st>

<st c="5953">本书提供了实用工具和技术，以简化您的特征工程流程，让您能够提高代码质量并简化流程。</st> <st c="6115">本书探讨了使用 Python 转换和创建特征的方法，以有效地训练机器学习模型。</st> <st c="6232">因此，熟悉机器学习和 Python 编程将有助于您理解和应用本书中提出的</st> <st c="6355">概念。</st>

<st c="6374">以下库版本中测试了这些食谱：</st> <st c="6421">**</st>

+   `<st c="6438">category-encoders == 2.6.3</st>`

+   `<st c="6465">Feature-engine == 1.8.0</st>`

+   `<st c="6489">featuretools == 1.31.0</st>`

+   `<st c="6512">matplotlib==3.8.3</st>`

+   `<st c="6530">nltk=3.8.1</st>`

+   `<st c="6541">numpy==1.26.4</st>`

+   `<st c="6555">pandas==2.2.1</st>`

+   `<st c="6569">scikit-learn==1.5.0</st>`

+   `<st c="6589">scipy==1.12.0</st>`

+   `<st c="6603">seaborn==0.13.2</st>`

+   `<st c="6619">tsfresh==0.20.0</st>`

| **<st c="6635">本书涵盖的软件/硬件</st>** **<st c="6665">** | **<st c="6673">操作系统要求</st>** |
| --- | --- |
| <st c="6689">Python 3.9</st> <st c="6701">或更高版本</st> | <st c="6711">Windows、macOS、</st> <st c="6728">或 Linux</st> |

*<st c="6736">请注意，Python 库的较早或较新版本可能会阻止代码运行。如果您使用的是较新版本，请确保检查其文档以获取任何最近的更新、参数名称更改，</st> *<st c="6828">或弃用。</st>*

**<st c="6963">如果您正在使用本书的数字版，我们建议您亲自输入代码或通过 GitHub 仓库（下一节中提供链接）访问代码。这样做将帮助您避免与代码复制和粘贴相关的任何潜在错误。</st> <st c="7145">这样做将帮助您避免与代码复制和粘贴相关的任何潜在错误。</st>**

## <st c="7238">下载示例代码文件</st>

<st c="7270">您可以从 GitHub 下载本书的示例代码文件，网址为</st> [<st c="7340">https://github.com/PacktPublishing/Python-Feature-Engineering-Cookbook-Third-Edition</st>](https://github.com/PacktPublishing/Python-Feature-Engineering-Cookbook-Third-Edition)<st c="7424">。如果代码有更新，它将在现有的</st> <st c="7495">GitHub 仓库</st>中更新。

<st c="7513">我们还有其他代码包，这些代码包来自我们丰富的书籍和视频目录，可在以下网址找到</st> [<st c="7601">https://github.com/PacktPublishing/</st>](https://github.com/PacktPublishing/)<st c="7636">。查看它们！</st>

# <st c="7653">使用的约定</st>

<st c="7670">本书中使用了多种文本约定。</st> <st c="7726">**</st>

`<st c="7736">文本中的代码</st>`<st c="7749">：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名。</st> <st c="7902">以下是一个示例：“我们使用了</st> `<st c="7931">year</st>`<st c="7935">,</st> `<st c="7937">month</st>`<st c="7942">, 和</st> `<st c="7948">quarter</st>` <st c="7955">来分别捕获 DataFrame 中的年、月和季度，在新列中。</st>`

<st c="8044">代码块设置如下</st> <st c="8068">：</st>

```py
 date = "2024-05-17"
rng_hr = pd.date_range(date, periods=20, freq="h")
rng_month = pd.date_range(date, periods=20, freq="ME")
df = pd.DataFrame({"date1": rng_hr, "date2": rng_month})
```

<st c="8262">任何命令行输入或输出都按以下方式编写</st> <st c="8307">：</st>

```py
 pip install yellowbrick
```

<st c="8342">提示或重要注意事项</st>

<st c="8366">看起来像这样。</st>

# <st c="8384">章节</st>

<st c="8393">在本书中，您将找到一些频繁出现的标题（</st>*<st c="8463">准备就绪</st>*<st c="8477">,</st> *<st c="8479">如何操作...</st>*<st c="8494">,</st> *<st c="8496">工作原理...</st>*<st c="8511">,</st> *<st c="8513">还有更多...</st>*<st c="8528">，和</st> *<st c="8534">另请参阅</st>*<st c="8542">）。</st>

<st c="8545">为了清楚地说明如何完成食谱，请按以下方式使用这些部分</st> <st c="8621">：</st>

## <st c="8632">准备就绪</st>

<st c="8646">本节告诉您在食谱中可以期待什么，并描述了如何设置任何软件或任何为食谱所需的初步设置。</st>

## <st c="8792">如何操作…</st>

<st c="8806">本节包含遵循食谱所需的步骤</st> <st c="8858">。</st>

## <st c="8869">工作原理…</st>

<st c="8883">本节通常包含对上一节发生情况的详细说明</st> <st c="8964">。</st>

## <st c="8981">还有更多…</st>

<st c="8995">本节包含有关制作食谱的附加信息，以使您对其有更深入的了解</st> <st c="9092">。</st>

## <st c="9101">另请参阅</st>

<st c="9110">本节提供了有关食谱的其他有用信息的链接</st> <st c="9179">。</st>

# <st c="9190">取得联系</st>

<st c="9203">我们的读者反馈总是受欢迎的</st>

**<st c="9248">一般反馈</st>**<st c="9265">：如果您对本书的任何方面有疑问，请在邮件主题中提及书名，并给我们发送电子邮件</st> <st c="9388">至</st> <st c="9391">customercare@packtpub.com</st><st c="9416">。</st>

**<st c="9417">勘误表</st>**<st c="9424">：尽管我们已经尽一切努力确保我们内容的准确性，但错误仍然可能发生。</st> <st c="9520">如果你在这本书中发现了错误，我们非常感谢你向我们报告。</st> <st c="9615">请访问</st> [<st c="9628">www.packtpub.com/support/errata</st>](http://www.packtpub.com/support/errata)<st c="9659">，选择你的书籍，点击</st> **<st c="9692">勘误提交表</st>** <st c="9714">链接，并输入</st> <st c="9731">详细信息。</st>

**<st c="9743">盗版</st>**<st c="9750">：如果你在互联网上遇到任何形式的我们作品的非法副本，我们非常感谢你提供位置地址或网站名称。</st> <st c="9921">请通过</st> <st c="9942">copyright@packt.com</st> <st c="9961">与我们联系，并提供</st> <st c="9977">材料的链接。</st>

**<st c="9990">如果你对成为作者感兴趣</st>**<st c="10034">：如果你在某个领域有专业知识，并且你对撰写或为书籍做出贡献感兴趣，请</st> <st c="10159">访问</st> [<st c="10165">authors.packtpub.com</st>](http://authors.packtpub.com)<st c="10185">。</st>

# <st c="10186">分享你的想法</st>

<st c="10206">一旦你阅读了</st> *<st c="10224">Python 特征工程食谱</st>*<st c="10259">，我们很乐意听听你的想法！</st> <st c="10294">请</st> [<st c="10301">点击此处直接进入该书的亚马逊评论页面</st>](https://packt.link/r/1835883591) <st c="10352">并分享</st> <st c="10377">你的反馈。</st>

<st c="10391">你的评论对我们和科技社区非常重要，并将帮助我们确保我们提供的是</st> <st c="10500">高质量的内容。</st>

# <st c="10516">下载这本书的免费 PDF 副本</st>

<st c="10554">感谢购买</st> <st c="10577">这本书！</st>

<st c="10587">你喜欢在旅途中阅读，但又无法携带你的印刷</st> <st c="10653">书籍到处走吗？</st>

<st c="10670">你的电子书购买是否与你的选择设备不兼容？</st>

<st c="10740">别担心，现在每购买一本 Packt 书籍，你都可以免费获得该书的 DRM 免费 PDF 版本。</st> <st c="10827">无需付费。</st>

<st c="10835">在任何地方、任何设备上阅读。</st> <st c="10877">从你最喜欢的技术书籍中直接搜索、复制和粘贴代码到你的应用程序中。</st>

<st c="10973">优惠远不止于此，你还可以获得独家折扣、时事通讯和每日免费内容的</st> <st c="11088">邮箱访问。</st>

<st c="11099">遵循以下简单步骤来获得</st> <st c="11133">以下好处：</st>

1.  <st c="11146">扫描二维码或访问以下</st> <st c="11177">链接</st>

![](img/B22396_QR_Free_PDF.jpg)

[<st c="11189">https://packt.link/free-ebook/978-1-83588-358-7</st>](https://packt.link/free-ebook/978-1-83588-358-7)

1.  <st c="11236">提交您的购买证明</st> <st c="11255">证明</st>

1.  <st c="11266">这就完了！</st> <st c="11278">我们将直接将您的免费 PDF 和其他福利发送到您的</st> <st c="11330">电子邮件</st>
