# 11

# ç»Ÿè®¡ä¼°è®¡

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨ä»‹ç»ä¸€ç³»åˆ—ç»Ÿè®¡æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯ä½¿æ‚¨èƒ½å¤Ÿä½¿ç”¨æ•°å€¼å’Œåˆ†ç±»æ•°æ®æ¥è¿›è¡Œæ¨æ–­å’Œä¼°è®¡ã€‚æˆ‘ä»¬å°†æ¢è®¨å…³é”®æ¦‚å¿µå’Œæ–¹æ³•ï¼Œå¦‚å‡è®¾æ£€éªŒã€ç½®ä¿¡åŒºé—´å’Œä¼°è®¡æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯ä½¿æˆ‘ä»¬èƒ½å¤Ÿä»ç»™å®šçš„æ ·æœ¬ä¸­å¯¹æ€»ä½“è¿›è¡Œæ¦‚æ‹¬ã€‚

åˆ°æœ¬ç« ç»“æŸæ—¶ï¼Œæ‚¨å°†æŒæ¡ç»Ÿè®¡æ¨æ–­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶èƒ½å¤Ÿåœ¨ä¸åŒåœºæ™¯ä¸‹è¿›è¡Œå‡è®¾æ£€éªŒã€‚

æœ¬ç« å°†æ¶µç›–ä»¥ä¸‹ä¸»è¦å†…å®¹ï¼š

+   åˆ†ç±»æ•°æ®çš„ç»Ÿè®¡æ¨æ–­

+   æ•°å€¼æ•°æ®çš„ç»Ÿè®¡æ¨æ–­

+   æ„å»ºè‡ªåŠ©æ³•ç½®ä¿¡åŒºé—´

+   ä»‹ç» t åˆ†å¸ƒä¸­ä½¿ç”¨çš„ä¸­å¿ƒæé™å®šç†

+   ä½¿ç”¨ t åˆ†å¸ƒæ„å»ºæ€»ä½“å‡å€¼çš„ç½®ä¿¡åŒºé—´

+   å¯¹ä¸¤ä¸ªå‡å€¼è¿›è¡Œå‡è®¾æ£€éªŒ

+   ä»‹ç»æ–¹å·®åˆ†æï¼ˆANOVAï¼‰

è¦è¿è¡Œæœ¬ç« ä¸­çš„ä»£ç ï¼Œæ‚¨éœ€è¦ä»¥ä¸‹è½¯ä»¶åŒ…çš„æœ€æ–°ç‰ˆæœ¬ï¼š

+   `dplyr`ï¼Œ1.0.10

+   `ggplot2`ï¼Œ3.4.0

+   `socviz`ï¼Œ1.2

+   `infer`ï¼Œ1.0.4

è¯·æ³¨æ„ï¼Œå‰é¢æåˆ°çš„ç‰ˆæœ¬æ˜¯åœ¨æˆ‘æ’°å†™æœ¬ä¹¦æ—¶çš„æœ€æ–°ç‰ˆæœ¬ã€‚æœ¬ç« çš„æ‰€æœ‰ä»£ç å’Œæ•°æ®å‡å¯åœ¨[`github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_11/working.R`](https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_11/working.R)æ‰¾åˆ°ã€‚

# åˆ†ç±»æ•°æ®çš„ç»Ÿè®¡æ¨æ–­

ä¸€ä¸ªåˆ†ç±»å˜é‡å…·æœ‰ä¸åŒçš„ç±»åˆ«æˆ–æ°´å¹³ï¼Œè€Œä¸æ˜¯æ•°å€¼ã€‚åˆ†ç±»æ•°æ®åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­å¾ˆå¸¸è§ï¼Œä¾‹å¦‚æ€§åˆ«ï¼ˆç”·æ€§æˆ–å¥³æ€§ï¼Œå°½ç®¡ç°ä»£è§‚ç‚¹å¯èƒ½ä¸åŒï¼‰ã€æˆ¿äº§é”€å”®ç±»å‹ï¼ˆæ–°æˆ¿æˆ–äºŒæ‰‹æˆ¿ï¼‰å’Œè¡Œä¸šã€‚å› æ­¤ï¼Œå¯¹è¿™äº›å˜é‡è¿›è¡Œåˆç†æ¨æ–­çš„èƒ½åŠ›å¯¹äºåœ¨å¤šç§æƒ…å¢ƒä¸‹å¾—å‡ºæœ‰æ„ä¹‰çš„ç»“è®ºå’Œåšå‡ºæ˜æ™ºçš„å†³ç­–è‡³å…³é‡è¦ã€‚

ä½œä¸ºåˆ†ç±»å˜é‡ï¼Œé€šå¸¸æ„å‘³ç€æˆ‘ä»¬æ— æ³•å°†å…¶ä¼ é€’ç»™æ¨¡å‹ä¸­çš„å­—ç¬¦ä¸²å€¼ï¼ˆå¦‚ `"finance"` æˆ– `"technology"`ï¼‰ï¼Œä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯å°†å˜é‡ä¸€çƒ­ç¼–ç æˆå¤šä¸ªåˆ—ï¼Œæ¯åˆ—å¯¹åº”ä¸€ä¸ªç‰¹å®šè¡Œä¸šï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶å€¼ `0` æˆ– `1`ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸“é—¨ç”¨äºå¤„ç†åˆ†ç±»æ•°æ®çš„å„ç§ç»Ÿè®¡æŠ€æœ¯ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ ¹æ®å¯ç”¨çš„æ ·æœ¬å¾—å‡ºæœ‰ä»·å€¼çš„è§è§£å¹¶å¯¹æ€»ä½“è¿›è¡Œæ¨æ–­ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºé‡è¦æ¦‚å¿µï¼Œå¦‚æ¯”ä¾‹ã€ç‹¬ç«‹æ€§å’Œæ‹Ÿåˆä¼˜åº¦ï¼Œè¿™äº›æ¦‚å¿µæ˜¯ç†è§£å’Œå¤„ç†åˆ†ç±»å˜é‡çš„åŸºç¡€ï¼ŒåŒ…æ‹¬å•å‚æ•°å’Œå¤šå‚æ•°çš„æƒ…å†µã€‚

è®©æˆ‘ä»¬ä»å•ä¸ªå‚æ•°çš„æ¨æ–­å¼€å§‹è®¨è®ºã€‚

## å•ä¸ªå‚æ•°çš„ç»Ÿè®¡æ¨æ–­

ä¸€ä¸ªæ€»ä½“å‚æ•°ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£å¹¶è¦æ¨æ–­çš„ä¸»é¢˜ï¼Œæ˜¯ä¸€ä¸ªæè¿°æ€»ä½“ç‰¹å®šç»Ÿè®¡å±æ€§çš„å›ºå®šæ•°é‡ï¼ŒåŒ…æ‹¬å‡å€¼ã€æ¯”ä¾‹æˆ–æ ‡å‡†å·®ã€‚è¿™ä¸ªæ•°é‡é€šå¸¸å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯éšè—çš„ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å¾—åˆ°å¤§å­¦ä¸­æœ€å—æ¬¢è¿çš„ä¸“ä¸šï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ•´ä¸ªå¤§å­¦æ¯ä¸ªä¸“ä¸šæ³¨å†Œçš„å­¦ç”Ÿæ•°é‡ï¼Œç„¶åè¿”å›è®¡æ•°æœ€å¤§çš„ä¸“ä¸šã€‚

åœ¨å•å‚æ•°ç»Ÿè®¡æ¨æ–­çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡è¿™ä¸ªæœªçŸ¥å‚æ•°æˆ–åŸºäºä»æ ·æœ¬æ”¶é›†çš„ä¿¡æ¯æ¥æµ‹è¯•å…¶å€¼çš„ç›¸å…³å‡è®¾ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç»Ÿè®¡æ¨æ–­å·¥å…·ï¼Œæ ¹æ®å·²çŸ¥çš„æ ·æœ¬æ¥æ¨æ–­æœªçŸ¥çš„äººå£å‚æ•°ã€‚åœ¨å‰ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ç‰¹å®šå­¦æœ¯å¹´åº¦æ³¨å†Œçš„å­¦ç”Ÿæœ‰é™æ ·æœ¬æ¥æ¨æ–­æ•´ä¸ªå¤§å­¦æœ€å—æ¬¢è¿çš„ä¸“ä¸šã€‚

è®©æˆ‘ä»¬å…ˆæ¢ç´¢ **ä¸€èˆ¬ç¤¾ä¼šè°ƒæŸ¥**ï¼ˆ**GSS**ï¼‰æ•°æ®é›†ã€‚

## ä»‹ç»ä¸€èˆ¬ç¤¾ä¼šè°ƒæŸ¥æ•°æ®é›†

GSS æ˜¯ä¸€ä¸ªç»¼åˆæ•°æ®é›†ï¼Œè¢«ç ”ç©¶äººå‘˜å’Œæ”¿ç­–åˆ¶å®šè€…å¹¿æ³›ç”¨äºç†è§£ç¾å›½çš„ç¤¾ä¼šã€æ–‡åŒ–å’Œæ”¿æ²»è¶‹åŠ¿ã€‚è‡ª 1972 å¹´ä»¥æ¥ï¼ŒGSS ç”±èŠåŠ å“¥å¤§å­¦çš„ **å›½å®¶æ°‘æ„ç ”ç©¶ä¸­å¿ƒ**ï¼ˆ**NORC**ï¼‰æŒç»­è¿›è¡Œï¼Œç›®çš„æ˜¯æ”¶é›†å…³äºå¹¿æ³›ä¸»é¢˜çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ€åº¦ã€è¡Œä¸ºå’Œå¯¹å„ç§é—®é¢˜çš„è§‚ç‚¹ã€‚

è®©æˆ‘ä»¬ä» `socviz` åŒ…ä¸­åŠ è½½ GSS æ•°æ®é›†ï¼ˆè¯·è®°ä½é€šè¿‡ `install.packages("socviz")` å®‰è£…æ­¤åŒ…ï¼‰ï¼š

```py

library(socviz)
data(gss_lon)
```

GSS æ•°æ®é›†ç°åœ¨å­˜å‚¨åœ¨ `gss_lon` å˜é‡ä¸­ï¼ŒåŒ…å«æ€»å…± 62,466 è¡Œå’Œ 25 åˆ—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```py

>>> dim(gss_lon)
62466Â Â Â Â 25
```

GSS æ•°æ®é›†åŒ…å«è®¸å¤šå˜é‡ï¼Œæ¶µç›–äº†å„ç§ä¸»é¢˜ï¼Œå¦‚æ•™è‚²ã€æ”¶å…¥ã€å®¶åº­ç»“æ„ã€æ”¿æ²»ä¿¡ä»°å’Œå®—æ•™å½’å±ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ `dplyr` åŒ…ä¸­çš„ `glimpse()` å‡½æ•°æ¥æ£€æŸ¥æ•°æ®é›†çš„ç»“æ„ï¼Œè¯¥å‡½æ•°æ—¨åœ¨å¸®åŠ©æ‚¨å¿«é€Ÿæ¢ç´¢å’Œç†è§£æ•°æ®ç»“æ„ï¼š

```py

>>> glimpse(gss_lon)
```

*å›¾ 11*.1 æ˜¾ç¤ºäº†è¿”å›çš„å‰å‡ ä¸ªå˜é‡çš„æˆªå›¾ã€‚

![å›¾ 11.1 â€“ å±•ç¤ºè¿è¡Œ glimpse() å‡½æ•°çš„ç»“æœçš„å‰å‡ è¡Œ](img/B18680_11_001.jpg)

å›¾ 11.1 â€“ å±•ç¤ºè¿è¡Œ glimpse() å‡½æ•°çš„ç»“æœçš„å‰å‡ è¡Œ

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹åŸºäºåˆ†ç±»å˜é‡çš„ç‰¹å®šç»Ÿè®¡é‡çš„è®¡ç®—ã€‚

## è®¡ç®—æ ·æœ¬æ¯”ä¾‹

æ•°æ®é›†ä¸­çš„ `siblings` åˆ—æ˜¯ä¸€ä¸ªåˆ†ç±»å˜é‡ï¼Œè¿½è¸ªå®¶åº­ä¸­çš„å…„å¼Ÿå§å¦¹æ•°é‡ã€‚åœ¨æ¥ä¸‹æ¥çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®—åœ¨æœ€æ–°çš„ä¸€å¹´ï¼Œå³ 2016 å¹´ï¼Œå®¶åº­æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„å—è®¿è€…æ¯”ä¾‹ã€‚

### ç»ƒä¹  11.1 â€“ è®¡ç®—å…„å¼Ÿå§å¦¹çš„æ ·æœ¬æ¯”ä¾‹

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè·å–`siblings`åˆ—çš„æ‘˜è¦ï¼Œå¹¶å¯¹æ•°æ®é›†è¿›è¡Œå­é›†åŒ–ä»¥å…³æ³¨ 2016 å¹´ï¼Œç„¶åå°†å…¶ç”¨äºè®¡ç®—å®¶åº­ä¸­æœ‰ç‰¹å®šæ•°é‡å…„å¼Ÿå§å¦¹çš„è°ƒæŸ¥æ¯”ä¾‹ï¼š

1.  ä½¿ç”¨`summary()`å‡½æ•°è·å–`siblings`åˆ—çš„æ‘˜è¦ï¼š

    ```py

    >>> summary(gss_lon$siblings)
    Â Â Â Â 0Â Â Â Â Â 1Â Â Â Â Â 2Â Â Â Â Â 3Â Â Â Â Â 4Â Â Â Â Â 5Â Â Â Â 6+Â Â NA's
     3047 10152 11313Â Â 9561Â Â 7024Â Â 5066 14612Â Â 1691
    ```

    ç»“æœè¡¨æ˜ï¼Œå¤§å¤šæ•°è°ƒæŸ¥æ˜¯åœ¨æœ‰å…­ä¸ªæˆ–æ›´å¤šå…„å¼Ÿå§å¦¹çš„å®¶åº­ä¸­è¿›è¡Œçš„ï¼

1.  å¯¹ 2016 å¹´çš„æ•°æ®é›†è¿›è¡Œå­é›†åŒ–ï¼š

    ```py

    gss2016 = gss_lon %>% filter(year == 2016)
    Plot the count of siblings in a bar chart using ggplot().
    ggplot(gss2016, aes(x = siblings)) +
    Â Â geom_bar() +
    Â Â labs(title = "Frequency count of siblings", x = "Number of siblings", y = "Count") +
    Â Â theme(text = element_text(size = 16))
    ```

    è¿è¡Œä»£ç ç”Ÿæˆå›¾*11.2*ã€‚

![å›¾ 11.2 â€“ ä»¥æŸ±çŠ¶å›¾å¯è§†åŒ–å…„å¼Ÿå§å¦¹æ•°é‡çš„é¢‘ç‡è®¡æ•°](img/B18680_11_002.jpg)

å›¾ 11.2 â€“ ä»¥æŸ±çŠ¶å›¾å¯è§†åŒ–å…„å¼Ÿå§å¦¹æ•°é‡çš„é¢‘ç‡è®¡æ•°

1.  è®¡ç®—æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„è°ƒæŸ¥æ¯”ä¾‹ï¼š

    ```py

    p_hat = gss2016 %>%
    Â Â summarize(prop_2sib = mean(siblings=="2", na.rm=TRUE)) %>%
    Â Â pull()
    >>> p_hat
    0.208246
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨`summarize()`å‡½æ•°è®¡ç®—ä¸€ç³»åˆ—äºŒå…ƒå€¼çš„å¹³å‡å€¼ï¼Œè¿™å¯¹åº”äºæœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„è°ƒæŸ¥æ¯”ä¾‹ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨`pull()`å‡½æ•°ä»ç»“æœ DataFrame ä¸­è·å–æ¯”ä¾‹ã€‚

æˆ‘ä»¬ä½¿ç”¨æ ·æœ¬æ¯”ä¾‹æ¥ä¼°è®¡æ€»ä½“ç»Ÿè®¡é‡ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ ¹æ®å¯ç”¨çš„æ ·æœ¬æ•°æ®è®¡ç®—æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„å®¶åº­æ¯”ä¾‹ï¼Œä»¥è¿‘ä¼¼å¦‚æœæˆ‘ä»¬åŸºäºæ€»ä½“ä¸­çš„æ‰€æœ‰æ•°æ®è®¡ç®—ç›¸åŒçš„æ¯”ä¾‹æ—¶å¯¹åº”çš„æ¯”ä¾‹ã€‚è¿™æ ·çš„ä¼°è®¡ä¼´éšç€ä¸€ä¸ªç½®ä¿¡åŒºé—´ï¼Œè¯¥åŒºé—´é‡åŒ–äº†æ€»ä½“æ¯”ä¾‹çš„å¯èƒ½å€¼åˆ—è¡¨ã€‚

ä¸‹ä¸€èŠ‚å°†å±•ç¤ºå¦‚ä½•è®¡ç®—æ ·æœ¬æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´ã€‚

## è®¡ç®—ç½®ä¿¡åŒºé—´

ç½®ä¿¡åŒºé—´æ˜¯åŸºäºæ ·æœ¬æ•°æ®å¯¹æ€»ä½“å‚æ•°è¿›è¡Œæ¨æ–­çš„é‡è¦å·¥å…·ã€‚ç½®ä¿¡åŒºé—´æä¾›äº†ä¸€ä¸ªä¼°è®¡èŒƒå›´ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ€»ä½“å‚æ•°ï¼Œå¦‚æ¯”ä¾‹ï¼Œåœ¨æŒ‡å®šçš„ç½®ä¿¡æ°´å¹³ï¼ˆå¦‚ 95%ï¼‰ä¸‹å¯èƒ½è¢«æ‰¾åˆ°ã€‚å½“å¤„ç†æ ·æœ¬æ¯”ä¾‹æ—¶ï¼Œè®¡ç®—ç½®ä¿¡åŒºé—´ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ€»ä½“ä¸­çš„çœŸå®æ¯”ä¾‹ï¼Œå¹¶è¯„ä¼°ä¸æ€»ä½“æ¯”ä¾‹ä¼°è®¡ç›¸å…³çš„ä¸ç¡®å®šæ€§ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ­¥éª¤æ¥è®¡ç®—ç½®ä¿¡åŒºé—´ï¼š

1.  è®¡ç®—æ ·æœ¬æ¯”ä¾‹ï¼ŒË†pï¼ˆè¯»ä½œ p-hatï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬åŸºäº 2016 å¹´çš„æ ·æœ¬æ•°æ®è®¡ç®—å‡ºçš„å€¼ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼ŒË†p æ˜¯é€šè¿‡å°†æˆåŠŸçš„æ•°é‡ï¼ˆå¯¹äºæ„Ÿå…´è¶£çš„å±æ€§ï¼‰é™¤ä»¥æ€»æ ·æœ¬é‡æ¥è®¡ç®—çš„ã€‚

1.  ç¡®å®šæ‰€éœ€çš„ç½®ä¿¡æ°´å¹³ï¼Œé€šå¸¸è¡¨ç¤ºä¸º(1 âˆ’ Î±) x 100%ï¼Œå…¶ä¸­Î±ä»£è¡¨æ˜¾è‘—æ€§æ°´å¹³ã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ˜¯åœ¨åŸå‡è®¾ä¸ºçœŸæ—¶æ‹’ç»é›¶å‡è®¾çš„æ¦‚ç‡ã€‚æœ€å¸¸ç”¨çš„ç½®ä¿¡æ°´å¹³æ˜¯ 90%ï¼Œ95%å’Œ 99%ã€‚

1.  è®¡ç®—æ ·æœ¬æ¯”ä¾‹çš„æ ‡å‡†è¯¯å·®ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š

SE = âˆš(Ë†p(1 âˆ’ Ë†p) / n)

åœ¨è¿™é‡Œï¼Œæ ‡å‡†è¯¯å·®ä¹Ÿå¯¹åº”äºæ ·æœ¬æ¯”ä¾‹çš„æ ‡å‡†å·®ï¼Œå‡è®¾å®ƒéµå¾ªæˆåŠŸæ¦‚ç‡ä¸ºË†p çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼ˆå›æƒ³ä¸€ä¸‹å‰ä¸€ç« ä¸­ä¼¯åŠªåˆ©åˆ†å¸ƒçš„ä»‹ç»ï¼‰ã€‚è¿™ç§è®¡ç®—ä¾èµ–äºä¸¤ä¸ªå‡è®¾ï¼šæ ·æœ¬ä¸­çš„è§‚æµ‹å€¼æ˜¯ç‹¬ç«‹çš„ï¼Œæ ·æœ¬ä¸­æœ‰è¶³å¤Ÿçš„è§‚æµ‹å€¼ã€‚æ£€æŸ¥ç¬¬äºŒä¸ªå‡è®¾çš„ä¸€ä¸ªå¸¸è§ç»éªŒæ³•åˆ™æ˜¯ç¡®ä¿ nË†p > 10 å’Œ n(1 âˆ’ Ë†p) > 10ã€‚

æˆ–è€…ï¼Œæˆ‘ä»¬ä¸å¿…å‡è®¾ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå¯ä»¥ä½¿ç”¨è‡ªä¸¾è¿‡ç¨‹æ¥ä¼°è®¡æ ‡å‡†è¯¯å·®ï¼Œè€Œä¸åšä»»ä½•åˆ†å¸ƒå‡è®¾ã€‚è‡ªä¸¾æ˜¯ä¸€ç§éå‚æ•°æ–¹æ³•ï¼Œæ¶‰åŠæœ‰æ”¾å›åœ°é‡æ–°æŠ½æ ·æ•°æ®ä»¥åˆ›å»ºæ–°çš„æ ·æœ¬ï¼Œå¯¹æ¯ä¸ªé‡æ–°æŠ½æ ·çš„æ•°æ®é›†è®¡ç®—æ„Ÿå…´è¶£çš„ç»Ÿè®¡é‡ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯æ¯”ä¾‹ï¼‰ï¼Œå¹¶ä»è®¡ç®—ç»Ÿè®¡é‡çš„å˜å¼‚æ€§ä¸­ä¼°è®¡æ ‡å‡†è¯¯å·®ã€‚

4. æ‰¾åˆ°å¯¹åº”äºé¢„è®¾ç½®ä¿¡æ°´å¹³çš„ä¸´ç•Œå€¼ï¼ˆz åˆ†æ•°ï¼‰ã€‚è¿™å¯ä»¥é€šè¿‡`qnorm()`å‡½æ•°å®Œæˆï¼Œå®ƒç»™å‡ºäº†æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„åˆ†ä½æ•°ã€‚

5. è®¡ç®—è¯¯å·®èŒƒå›´ï¼ˆMEï¼‰ä¸ºæ ‡å‡†è¯¯å·®ä¸ä¸´ç•Œå€¼çš„ä¹˜ç§¯ï¼š

ME = SE * z _ score

6. é€šè¿‡ä»æ ·æœ¬æ¯”ä¾‹ä¸­åŠ å‡ ME æ¥è®¡ç®—ç½®ä¿¡åŒºé—´ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š

ä¸‹é™ = Ë†p âˆ’ ME

ä¸Šé™ = Ë†p + ME

ç½®ä¿¡åŒºé—´æ ¹æ®ç‰¹å®šçš„ç½®ä¿¡æ°´å¹³æä¾›äº†æ€»ä½“æ¯”ä¾‹çš„å¯èƒ½å€¼åˆ—è¡¨ã€‚å‚è§*å›¾ 11.3*å¯¹è®¡ç®—è¿‡ç¨‹çš„æ€»ç»“ã€‚

![å›¾ 11.3 â€“ åŸºäºæ ·æœ¬æ¯”ä¾‹è®¡ç®—ç½®ä¿¡åŒºé—´çš„è¿‡ç¨‹æ€»ç»“](img/B18680_11_003.jpg)

å›¾ 11.3 â€“ åŸºäºæ ·æœ¬æ¯”ä¾‹è®¡ç®—ç½®ä¿¡åŒºé—´çš„è¿‡ç¨‹æ€»ç»“

è®©æˆ‘ä»¬å†æ·±å…¥æ¢è®¨ä¸€ä¸‹è‡ªä¸¾è¿‡ç¨‹ã€‚ä¸å‡è®¾ä»»ä½•ç‰¹å®šåˆ†å¸ƒï¼Œè‡ªä¸¾è¿‡ç¨‹æ˜¯ä¸€ç§çµæ´»çš„æ–¹æ³•ï¼Œå¯ä»¥æä¾›æ›´å‡†ç¡®çš„æ ‡å‡†è¯¯å·®ä¼°è®¡ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå°æ ·æœ¬é‡æˆ–æ•°æ®è¡¨ç°ä¸ä½³çš„æƒ…å†µã€‚ç„¶è€Œï¼Œå®ƒå¯èƒ½è®¡ç®—é‡å¾ˆå¤§ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹æ•°æ®é›†æˆ–ç”Ÿæˆè®¸å¤šè‡ªä¸¾å¤åˆ¶æ—¶ã€‚

*å›¾ 11.4* æä¾›äº†è‡ªä¸¾è¿‡ç¨‹çš„ç¤ºæ„å›¾ã€‚è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ï¼š

1.  é¦–å…ˆï¼Œæˆ‘ä»¬ä»æ•´ä¸ªæ•°æ®é›†å¼€å§‹ï¼Œå¹¶æŒ‡å®šæ„Ÿå…´è¶£çš„å˜é‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯`å…„å¼Ÿå§å¦¹`å˜é‡ã€‚è¿™æ˜¯é€šè¿‡`specify()`å‡½æ•°å®ç°çš„ã€‚

1.  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»å˜é‡ä¸­æŠ½å–æ ·æœ¬ï¼Œè¿›è¡Œæœ‰æ”¾å›æŠ½æ ·ï¼Œå…¶ä¸­æ–°æ ·æœ¬çš„å¤§å°ä¸åŸå§‹æ•°æ®é›†ç›¸åŒã€‚è¿™ç§é‡æŠ½æ ·å¼•å…¥äº†éšæœºæ€§åˆ°ç»“æœæ•°æ®é›†ä¸­ã€‚

1.  æˆ‘ä»¬é‡å¤è¿™ä¸ªè¿‡ç¨‹å¤šæ¬¡ï¼Œä½¿ç”¨`generate()`å‡½æ•°å¾—åˆ°ä¸€ç³»åˆ—é€šè¿‡è‡ªä¸¾å¾—åˆ°çš„ä¼ªæ•°æ®é›†ã€‚

1.  å¯¹äºæ¯ä¸ªå¤åˆ¶çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†è®¡ç®—æ„Ÿå…´è¶£çš„æ ·æœ¬ç»Ÿè®¡é‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å…·æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„è§‚å¯Ÿå€¼çš„æ¯”ä¾‹ã€‚è¿™æ˜¯é€šè¿‡`calculate()`å‡½æ•°å®Œæˆçš„ã€‚

1.  è¿™äº›é€šè¿‡é‡å¤æŠ½æ ·åŸå§‹æ•°æ®é›†å¾—åˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡å°†å½¢æˆä¸€ä¸ªåˆ†å¸ƒï¼Œç§°ä¸ºè‡ªåŠ©æ³•åˆ†å¸ƒï¼ˆé€šè¿‡`ggplot()`ç»˜åˆ¶ï¼‰ï¼Œå…¶æ ‡å‡†å·®ï¼ˆé€šè¿‡`summarize()`å‡½æ•°æå–ï¼‰å°†æ˜¯å¯¹æ ‡å‡†è¯¯çš„è‰¯å¥½è¿‘ä¼¼ã€‚

![å›¾ 11.4 â€“ ä½¿ç”¨è‡ªåŠ©æ³•ç¨‹åºè·å–æ ‡å‡†è¯¯çš„ç¤ºæ„å›¾](img/B18680_11_004.jpg)

å›¾ 11.4 â€“ ä½¿ç”¨è‡ªåŠ©æ³•ç¨‹åºè·å–æ ‡å‡†è¯¯çš„ç¤ºæ„å›¾

é€šè¿‡è‡ªåŠ©æ³•å¾—åˆ°çš„æ ·æœ¬ä¼ è¾¾äº†æ ·æœ¬ç»Ÿè®¡é‡ä¸åŒæ°´å¹³çš„ä¸ç¡®å®šæ€§ï¼Œå¹¶å…±åŒå½¢æˆå¤šä¸ªäººå·¥æ ·æœ¬ç»Ÿè®¡é‡çš„å¯†åº¦åˆ†å¸ƒã€‚è‡ªåŠ©æ³•åˆ†å¸ƒçš„æ ‡å‡†å·®éšåç»™å‡ºæ ·æœ¬ç»Ÿè®¡é‡çš„æ ‡å‡†è¯¯ã€‚è¯·æ³¨æ„ï¼Œå¦‚`specify()`ã€`generate()`å’Œ`calculate()`ç­‰å‡½æ•°å‡æ¥è‡ª R ä¸­çš„`infer`åŒ…ã€‚åœ¨ç»§ç»­ä»¥ä¸‹ä»£ç ä¹‹å‰ï¼Œè¯·è®°ä½å®‰è£…æ­¤åŒ…ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ç»ƒä¹ æ¥äº†è§£è®¡ç®—ç½®ä¿¡åŒºé—´çš„è‡ªåŠ©æ³•ç¨‹åºã€‚

### ç»ƒä¹  11.2 â€“ é€šè¿‡è‡ªåŠ©æ³•è®¡ç®—ç½®ä¿¡åŒºé—´

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢è®¡ç®—æ ·æœ¬æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´ã€‚ç½®ä¿¡åŒºé—´åŒ…æ‹¬ä¸€ç³»åˆ—ä¼°è®¡å€¼ï¼Œåœ¨è¿™äº›ä¼°è®¡å€¼ä¸­ï¼Œç»™å®šè§‚å¯Ÿåˆ°çš„æ ·æœ¬ï¼ŒçœŸå®æ€»ä½“æ¯”ä¾‹å¯èƒ½å–å€¼ã€‚è¿™æ˜¯åŸºäºå®é™…è§‚å¯Ÿæ¥é‡åŒ–ä¼°è®¡æ€»ä½“æ¯”ä¾‹ä¸ç¡®å®šæ€§çš„æ–¹æ³•ã€‚é™¤äº†ä½¿ç”¨è‡ªåŠ©æ³•é€æ­¥è®¡ç®—è¿‡ç¨‹å¤–ï¼Œæˆ‘ä»¬è¿˜å°†æ¯”è¾ƒä½¿ç”¨å‡è®¾çš„ä¼¯åŠªåˆ©åˆ†å¸ƒçš„æ›¿ä»£æ–¹æ³•çš„ç»“æœï¼š

1.  ä½¿ç”¨å‰é¢æè¿°çš„`infer`åŒ…ä¸­çš„æŒ‡å®š-ç”Ÿæˆ-è®¡ç®—ç¨‹åºæ„å»ºä¸€ç»„è‡ªåŠ©æ³•æ ·æœ¬ç»Ÿè®¡é‡ã€‚è¯·è®°ä½æ„å»ºä¸€ä¸ªäºŒå…ƒå˜é‡æ¥æŒ‡ç¤ºå…·æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„è§‚å¯Ÿå€¼çš„äºŒå…ƒæ¡ä»¶ï¼š

    ```py

    library(infer)
    gss2016 = gss2016 %>%
    Â Â mutate(siblings_two_ind = if_else(siblings=="2","Y","N")) %>%
    Â Â filter(!is.na(siblings_two_ind))
    bs = gss2016 %>%
    Â Â specify(response = siblings_two_ind,
    Â Â Â Â Â Â Â Â Â Â success = "Y") %>%
    Â Â generate(reps = 500,
    Â Â Â Â Â Â Â Â Â Â Â type = "bootstrap") %>%
    Â Â calculate(stat = "prop")
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨`if_else()`å‡½æ•°åˆ›å»ºä¸€ä¸ªäºŒå…ƒæŒ‡æ ‡å˜é‡ï¼Œä»¥è¡¨ç¤ºå½“å‰è°ƒæŸ¥ä¸­çš„å®¶åº­æ˜¯å¦æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹ã€‚æˆ‘ä»¬è¿˜åˆ é™¤äº†æ­¤åˆ—ä¸­å…·æœ‰`NA`å€¼çš„è¡Œã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨`specify()`å‡½æ•°æŒ‡å‡ºæ„Ÿå…´è¶£çš„`siblings_two_ind`å˜é‡åŠå…¶å¯¹åº”çš„æˆåŠŸçº§åˆ«ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`generate()`å‡½æ•°ç”Ÿæˆ`500`ä¸ªè‡ªåŠ©æ³•æ ·æœ¬ï¼Œå¹¶ä½¿ç”¨`calculate()`å‡½æ•°é€šè¿‡è®¾ç½®`stat = "prop"`æ¥è·å–æ¯ä¸ªè‡ªåŠ©æ³•æ ·æœ¬ä¸­ç›¸åº”çš„æ ·æœ¬ç»Ÿè®¡é‡ï¼ˆæˆåŠŸæ¯”ä¾‹ï¼‰ã€‚

    è®©æˆ‘ä»¬è§‚å¯Ÿè‡ªåŠ©æ³•æ ·æœ¬ç»Ÿè®¡é‡ä¸­çš„å†…å®¹ï¼š

    ```py
    >>> bs
    Response: siblings_two_ind (factor)
    # A tibble: 500 Ã— 2
    Â Â Â replicateÂ Â stat
    Â Â Â Â Â Â Â <int> <dbl>
     1Â Â Â Â Â Â Â Â Â 1 0.205
     2Â Â Â Â Â Â Â Â Â 2 0.209
     3Â Â Â Â Â Â Â Â Â 3 0.218
     4Â Â Â Â Â Â Â Â Â 4 0.189
     5Â Â Â Â Â Â Â Â Â 5 0.207
     6Â Â Â Â Â Â Â Â Â 6 0.205
     7Â Â Â Â Â Â Â Â Â 7 0.221
     8Â Â Â Â Â Â Â Â Â 8 0.214
     9Â Â Â Â Â Â Â Â Â 9 0.212
    10Â Â Â Â Â Â Â Â 10 0.212
    # â€¦ with 490 more rows
    # i Use `print(n = ...)` to see more rows
    ```

    ç»“æœæ˜¾ç¤ºï¼Œ`bs`å¯¹è±¡æ˜¯ä¸€ä¸ªåŒ…å« 500 è¡Œï¼ˆå¯¹åº”äº bootstrap æ ·æœ¬çš„æ€»æ•°ï¼‰å’Œ 2 åˆ—çš„`tibble` DataFrameã€‚ç¬¬ä¸€åˆ—ï¼ˆ`replicate`ï¼‰è¡¨ç¤º bootstrap æ ·æœ¬çš„æ•°é‡ï¼Œç¬¬äºŒåˆ—ï¼ˆ`stat`ï¼‰è¡¨ç¤º bootstrap æ ·æœ¬ä¸­æˆåŠŸçš„æ¯”ä¾‹ï¼ˆå³`siblings_two_ind==2`çš„è¡Œæ•°é™¤ä»¥æ€»è¡Œæ•°ï¼‰ã€‚

1.  åœ¨å¯†åº¦å›¾ä¸­ç»˜åˆ¶ bootstrap æ ·æœ¬ç»Ÿè®¡é‡ï¼š

    ```py

    >>> ggplot(bs, aes(x = stat)) +
    Â Â geom_density() +
    Â Â labs(title = "Density plot of the sample proportions", x = "Sample proportion", y = "Density") +
    Â Â theme(text = element_text(size = 16))
    ```

è¿è¡Œä»£ç ç”Ÿæˆ*å›¾ 11.5*çš„å›¾è¡¨ã€‚è¿™ä¸ªåˆ†å¸ƒçš„åˆ†æ•£ç¨‹åº¦ï¼Œä¸æ ‡å‡†å·®ç›¸å…³ï¼Œç›´æ¥å†³å®šäº†æ ‡å‡†è¯¯å·®çš„å¤§å°ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬å¢åŠ  bootstrap æ ·æœ¬çš„æ•°é‡ï¼Œæˆ‘ä»¬é¢„æœŸå¯†åº¦æ›²çº¿ä¼šæ›´åŠ å¹³æ»‘ã€‚

![å›¾ 11.5 â€“ å¯è§†åŒ–æ‰€æœ‰ bootstrap æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾](img/B18680_11_005.jpg)

å›¾ 11.5 â€“ å¯è§†åŒ–æ‰€æœ‰ bootstrap æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾

1.  å°†æ ‡å‡†è¯¯å·®è®¡ç®—ä¸ºåŸºäº bootstrap æ ·æœ¬æ¯”ä¾‹çš„å®è¯åˆ†å¸ƒçš„æ ‡å‡†å·®ï¼š

    ```py

    SE = bs %>%
    Â Â summarise(sd(stat)) %>%
    Â Â pull()
    >>> SE
    0.007181953
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨`sd()`å‡½æ•°è®¡ç®—`bs`ä¸­`stat`åˆ—çš„æ ‡å‡†å·®ï¼Œç„¶åé€šè¿‡`pull()`å‡½æ•°è¿”å›è¯¥å€¼ã€‚ç„¶åï¼Œæ ‡å‡†è¯¯å·®å°†æ ¹æ®é¢„å®šçš„ z åˆ†æ•°è¿›è¡Œç¼©æ”¾ï¼Œå¹¶ä»åŸå§‹æ ·æœ¬æ¯”ä¾‹ï¼ˆ`p_hat`ï¼‰ä¸­å‡å»å’ŒåŠ ä¸Šï¼Œä»¥è·å¾—ç½®ä¿¡åŒºé—´ã€‚

1.  ä½¿ç”¨ 95%ç½®ä¿¡åŒºé—´è®¡ç®—åŸå§‹æ ·æœ¬æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´ï¼š

    ```py

    >>> c(p_hat - 2*SE, p_hat + 2*SE)
    0.1938821 0.2226099
    ```

    åœ¨è¿™é‡Œï¼Œç”±äº 95%ç½®ä¿¡æ°´å¹³å¯¹åº”äº z åˆ†æ•° 2ï¼Œæˆ‘ä»¬åœ¨ä»åŸå§‹æ ·æœ¬æ¯”ä¾‹ï¼ˆ`p_hat`ï¼‰ä¸­å‡å»å’ŒåŠ ä¸Šä¹‹å‰ï¼Œå°†å…¶ä¸æ ‡å‡†è¯¯å·®ç›¸ä¹˜ä»¥è·å¾—ç½®ä¿¡åŒºé—´ã€‚

1.  å‡è®¾æˆåŠŸçš„æ¦‚ç‡æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œä½¿ç”¨ç»“æ„ä¿¡æ¯è®¡ç®—ç½®ä¿¡åŒºé—´ï¼š

    ```py

    SE2 = sqrt(p_hat*(1-p_hat)/nrow(gss2016))
    >>> c(p_hat - 2*SE2, p_hat + 2*SE2)
    0.193079 0.223413
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¼¯åŠªåˆ©åˆ†å¸ƒçš„æ–¹å·®æ˜¾å¼å½¢å¼æ¥è®¡ç®—æ ‡å‡†è¯¯å·®ã€‚ç»“æœæ˜¾ç¤ºçš„ç½®ä¿¡åŒºé—´ä¸ä½¿ç”¨ bootstrap æ–¹æ³•è·å¾—çš„ç½®ä¿¡åŒºé—´ç›¸å½“ç›¸ä¼¼ã€‚

ç½®ä¿¡åŒºé—´ä¸ºæˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿåˆ°çš„æ ·æœ¬æ¯”ä¾‹ä¼°è®¡æœªçŸ¥æ€»ä½“æ¯”ä¾‹çš„ä¸ç¡®å®šæ€§æä¾›äº†ä¸€ä¸ªä¸ç¡®å®šæ€§åº¦é‡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ä¸‹ä¸€èŠ‚ä¸­è§£é‡Šç½®ä¿¡åŒºé—´ã€‚

## è§£é‡Šæ ·æœ¬æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´

è§£é‡Šæ ·æœ¬æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´æ¶‰åŠç†è§£åŒºé—´çš„å«ä¹‰å’Œç›¸å…³çš„ç½®ä¿¡æ°´å¹³ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œbootstrap æ–¹æ³•æŠ¥å‘Šçš„ç½®ä¿¡åŒºé—´ä¸º`[0.1938821, 0.2226099]`ã€‚å¯¹äºè¿™ä¸ªç½®ä¿¡åŒºé—´æœ‰ä¸¤ä¸ªå±‚é¢çš„è§£é‡Šã€‚

é¦–å…ˆï¼Œç½®ä¿¡åŒºé—´çš„èŒƒå›´è¡¨æ˜ï¼Œå…·æœ‰ä¸¤ä¸ªå…„å¼Ÿå§å¦¹çš„å®¶åº­çš„çœŸå®æ¯”ä¾‹å¾ˆå¯èƒ½åœ¨ 19.39%åˆ° 22.26%ä¹‹é—´ã€‚è¿™ä¸ªèŒƒå›´åŸºäºæ ·æœ¬æ•°æ®ï¼Œå¹¶ä¼°è®¡äº†çœŸå®æ¯”ä¾‹çš„ä¸ç¡®å®šæ€§ã€‚

å…¶æ¬¡ï¼Œ95%çš„ç½®ä¿¡åŒºé—´æ„å‘³ç€å¦‚æœæˆ‘ä»¬å¤šæ¬¡è¿›è¡Œè°ƒæŸ¥ï¼ˆæ— è®ºæ˜¯ 2016 å¹´è¿˜æ˜¯å…¶ä»–å¹´ä»½ï¼‰ï¼Œæˆ‘ä»¬ä¼šç”Ÿæˆä¸åŒå¤§å°çš„éšæœºæ ·æœ¬ï¼ŒåŸºäºè¿™äº›æ ·æœ¬æˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªæ ·æœ¬çš„ 95%ç½®ä¿¡åŒºé—´ã€‚åœ¨è¿™äº›äººå·¥æ ·æœ¬ä¸­ï¼Œæˆ‘ä»¬å°†è·å¾—ä¸€ç³»åˆ—åŒºé—´ï¼Œå…¶ä¸­å¤§çº¦ 95%çš„åŒºé—´å°†åŒ…å«çœŸå®çš„æ€»ä½“æ¯”ä¾‹ã€‚

æ³¨æ„ï¼Œç½®ä¿¡åŒºé—´ä»ç„¶æ˜¯ä¸€ä¸ªä¼°è®¡å€¼ï¼ŒçœŸå®çš„æ€»ä½“æ¯”ä¾‹å¯èƒ½è½åœ¨è®¡ç®—å‡ºçš„åŒºé—´ä¹‹å¤–ã€‚ç„¶è€Œï¼Œç½®ä¿¡åŒºé—´æä¾›äº†ä¸€ç§æœ‰ç”¨çš„æ–¹æ³•æ¥é‡åŒ–ä¼°è®¡çš„ä¸ç¡®å®šæ€§ï¼Œå¹¶åŸºäºè§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»™å‡ºçœŸå®æ€»ä½“æ¯”ä¾‹çš„å¯èƒ½å€¼çš„åˆ—è¡¨ã€‚

ä¸‹ä¸€èŠ‚å°†ä»‹ç»å¯¹æ ·æœ¬æ¯”ä¾‹çš„å‡è®¾æ£€éªŒã€‚

## å¯¹æ ·æœ¬æ¯”ä¾‹è¿›è¡Œå‡è®¾æ£€éªŒ

å¯¹æ ·æœ¬æ¯”ä¾‹çš„å‡è®¾æ£€éªŒä¸å‰é¢ç« èŠ‚ä¸­å¼•å…¥çš„ç½®ä¿¡åŒºé—´å¯†åˆ‡ç›¸å…³ï¼Œå®ƒæ•æ‰äº†åŸºäºæ€»ä½“æ•°æ®å¯¹æœªçŸ¥æ¯”ä¾‹ä¼°è®¡çš„ä¸ç¡®å®šæ€§æ°´å¹³ã€‚è‡ªç„¶åœ°ï¼Œè§‚å¯Ÿå€¼è¾ƒå°‘çš„æ ·æœ¬ä¼šå¯¼è‡´ç½®ä¿¡åŒºé—´è¾ƒå®½ã€‚å¯¹æ ·æœ¬æ¯”ä¾‹çš„å‡è®¾æ£€éªŒæ—¨åœ¨ç¡®å®šæ ·æœ¬ä¸­æ˜¯å¦æœ‰è¶³å¤Ÿçš„è¯æ®æ¥æ”¯æŒæˆ–æ‹’ç»å…³äºæ€»ä½“æ¯”ä¾‹çš„å£°æ˜ã€‚è¿™ä¸ªè¿‡ç¨‹ä»é›¶å‡è®¾ï¼ˆH0ï¼‰å¼€å§‹ï¼Œå®ƒä»£è¡¨äº†å…³äºæ€»ä½“æ¯”ä¾‹çš„åŸºæœ¬å‡è®¾ã€‚ç›¸åº”åœ°ï¼Œå­˜åœ¨ä¸€ä¸ªå¤‡æ‹©å‡è®¾ï¼ˆH1ï¼‰ï¼Œå®ƒä»£è¡¨äº†æˆ‘ä»¬å¯¹é›¶å‡è®¾è¿›è¡Œæµ‹è¯•çš„å£°æ˜æˆ–é™ˆè¿°ã€‚ç„¶åï¼Œå‡è®¾æ£€éªŒå°†è§‚å¯Ÿåˆ°çš„æ ·æœ¬æ¯”ä¾‹ä¸æŒ‡å®šçš„é›¶å‡è®¾è¿›è¡Œæ¯”è¾ƒï¼Œä»¥è¯„ä¼°æˆ‘ä»¬æ˜¯å¦æœ‰è¶³å¤Ÿçš„è¯æ®æ¥æ‹’ç»é›¶å‡è®¾ï¼Œå¹¶æ”¯æŒå¤‡æ‹©å‡è®¾ã€‚

è®©æˆ‘ä»¬æ¦‚è¿°ä¸€ä¸‹è¿›è¡Œå‡è®¾æ£€éªŒæ‰€æ¶‰åŠçš„ç¨‹åºï¼š

1.  **åˆ¶å®šå‡è®¾**ã€‚åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬è®¾å®šé›¶å‡è®¾ï¼ˆH0ï¼‰å’Œå¤‡æ‹©å‡è®¾ï¼ˆH1ï¼‰ã€‚é›¶å‡è®¾é€šå¸¸è¡¨ç¤ºæ²¡æœ‰æ•ˆæœï¼Œæƒ…å†µä¿æŒç°çŠ¶ï¼Œå¦‚ H0 ä¸­çš„ç­‰å·æ‰€ç¤ºã€‚å¦ä¸€æ–¹é¢ï¼Œå¤‡æ‹©å‡è®¾è¡¨ç¤ºå­˜åœ¨æ•ˆæœæˆ–å·®å¼‚ï¼Œå¦‚ H1 ä¸­çš„ä¸ç­‰å·æ‰€ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º H0 å’Œ H1 è®¾å®šä»¥ä¸‹å‡è®¾ï¼š

    +   H0: p = pÂ 0ï¼ˆæ€»ä½“æ¯”ä¾‹ç­‰äºæŒ‡å®šçš„å€¼ï¼ŒpÂ 0ï¼‰

    +   H1: p â‰  pÂ 0ï¼ˆæ€»ä½“æ¯”ä¾‹ä¸ç­‰äº pÂ 0ï¼‰

1.  **é€‰æ‹©æ˜¾è‘—æ€§æ°´å¹³ï¼ˆ**ğœ¶**ï¼‰**ã€‚æ˜¾è‘—æ€§æ°´å¹³æ˜¯æˆ‘ä»¬ç”¨æ¥åœ¨åŸå‡è®¾ä¸ºçœŸæ—¶æ‹’ç»åŸå‡è®¾çš„æ¦‚ç‡é˜ˆå€¼ã€‚å¹¿æ³›ä½¿ç”¨çš„æ˜¾è‘—æ€§æ°´å¹³åŒ…æ‹¬ 0.05ï¼ˆ5%ï¼‰å’Œ 0.01ï¼ˆ1%ï¼‰ã€‚

1.  **è®¡ç®—æ£€éªŒç»Ÿè®¡é‡**ã€‚ç°åœ¨æˆ‘ä»¬æ ¹æ®å®é™…æ•°æ®è§‚å¯Ÿåˆ°ä¸€ä¸ªæ ·æœ¬æ¯”ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—åœ¨é›¶å‡è®¾ä¸ºçœŸçš„æƒ…å†µä¸‹è§‚å¯Ÿåˆ°è¿™æ ·ä¸€ä¸ªæ ·æœ¬æ¯”ä¾‹çš„æ¦‚ç‡ã€‚è¿™å§‹äºä½¿ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—æ ·æœ¬æ¯”ä¾‹çš„æ£€éªŒç»Ÿè®¡é‡ï¼ˆz åˆ†æ•°ï¼‰ï¼š

z = Ë†p âˆ’ p0 * âˆš___________ * p0(1 âˆ’ p0) / n

å…¶ä¸­Ë†p æ˜¯æ ·æœ¬æ¯”ä¾‹ï¼Œp0 æ˜¯åœ¨é›¶å‡è®¾ä¸‹çš„æ€»ä½“æ¯”ä¾‹ï¼Œn æ˜¯æ ·æœ¬å¤§å°ã€‚æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œåˆ†æ¯ç±»ä¼¼äºå‰é¢æåˆ°çš„åŸºäºæ ·æœ¬æ¯”ä¾‹çš„æ ‡å‡†å·®ã€‚ç¡®å®ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªä¼¯åŠªåˆ©åˆ†å¸ƒï¼ŒæˆåŠŸæ¦‚ç‡ä¸º p0ã€‚åœ¨æ€»å…± n ä¸ªè§‚å¯Ÿå€¼ä¸­ï¼Œæ ·æœ¬æ¯”ä¾‹å˜é‡çš„æ ‡å‡†å·®æ˜¯âˆš___________ * p0(1 âˆ’ p0) / nã€‚å…¶æ¬¡ï¼Œæ•´ä¸ªé¡¹å¯¹åº”äºå°†ä¸€ä¸ªæ•°å€¼è½¬æ¢ä¸ºç‰¹å®šåˆ†å¸ƒçš„ z åˆ†æ•°çš„è¿‡ç¨‹ï¼Œè¿™æ˜¯å‰ä¸€ç« è®¨è®ºçš„ä¸»é¢˜ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªå‡å€¼ä¸º p0ï¼Œæ ‡å‡†å·®ä¸ºâˆš___________ * p0(1 âˆ’ p0) / n çš„æ­£æ€åˆ†å¸ƒã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å°†è§‚å¯Ÿåˆ°çš„æ ·æœ¬æ¯”ä¾‹Ë†p è½¬æ¢ä¸ºç›¸åº”çš„ z åˆ†æ•°ï¼Œä»¥ä¾¿äºåç»­è®¡ç®—ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è‡ªåŠ©æ³•åœ¨é›¶å‡è®¾ä¸‹è®¡ç®—ç»éªŒ p å€¼ã€‚

4. **ç¡®å®š p å€¼**ã€‚z åˆ†æ•°æ˜¯ä¸€ä¸ªè½åœ¨æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸Šçš„åº¦é‡ã€‚å®ƒæ˜¯ä¸€ä¸ªæ£€éªŒç»Ÿè®¡é‡ï¼Œæˆ‘ä»¬é€šå¸¸å¯¹è§‚å¯Ÿåˆ°çš„æ£€éªŒç»Ÿè®¡é‡åœ¨æ­¤æˆ–æ›´æç«¯å€¼ä¸Šçš„æ¦‚ç‡æ„Ÿå…´è¶£ã€‚è¿™è¢«ç§°ä¸º p å€¼ï¼Œè®°ä¸ºË†pï¼Œå½“æˆ‘ä»¬å‡è®¾é›¶å‡è®¾ä¸ºçœŸæ—¶ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬è¯•å›¾è¯„ä¼°åœ¨é›¶å‡è®¾ä¸ºçœŸçš„æƒ…å†µä¸‹è§‚å¯ŸæŸäº›ç°è±¡çš„å¯èƒ½æ€§ã€‚å¦‚æœè§‚å¯Ÿåˆ°Ë†p æˆ–æ›´æç«¯æ•°å€¼çš„æ¦‚ç‡éå¸¸å°ï¼Œæˆ‘ä»¬æœ‰ä¿¡å¿ƒé›¶å‡è®¾æ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‹’ç» H0 å¹¶æ”¯æŒ H1ã€‚

æ³¨æ„ï¼Œå¯¹äºåŒå°¾æ£€éªŒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ ‡å‡†æ­£æ€åˆ†å¸ƒå¹¶åŠ å€å•ä¾§æ¦‚ç‡æ¥è®¡ç®— p å€¼ï¼š

p-value = 2P(Z > |z|)

5. **åšå‡ºå†³å®š**ã€‚æœ€åï¼Œæˆ‘ä»¬å°† p å€¼ä¸é¢„è®¾çš„æ˜¾è‘—æ€§æ°´å¹³ï¼ˆÎ±ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹è§„åˆ™åšå‡ºå†³å®šã€‚

å¦‚æœ p å€¼ â‰¤ Î±ï¼Œåˆ™æ‹’ç»é›¶å‡è®¾ï¼Œæ”¯æŒå¤‡æ‹©å‡è®¾ã€‚è¿™æ ·åšè¡¨æ˜æœ‰è¶³å¤Ÿçš„è¯æ®è¡¨æ˜æ€»ä½“æ¯”ä¾‹ä¸å‡è®¾æ¯”ä¾‹ p0 ä¸åŒã€‚

å¦‚æœ p å€¼ > Î±ï¼Œåˆ™ä¸èƒ½æ‹’ç»é›¶å‡è®¾ã€‚è¿™æ„å‘³ç€æ²¡æœ‰è¶³å¤Ÿçš„è¯æ®è¡¨æ˜æ€»ä½“æ¯”ä¾‹ä¸ p0 ä¸åŒã€‚

è¿›è¡Œå‡è®¾æ£€éªŒçš„è¿‡ç¨‹ä¸ä¸Šè¿°ç±»ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ä½¿ç”¨`hypothesise()`å‡½æ•°ï¼ˆä½äº`specify()`ä¹‹åï¼‰ï¼Œå®ƒä½œä¸ºé›¶å‡è®¾ã€‚ç„¶åæˆ‘ä»¬æ‰§è¡Œç›¸åŒçš„è‡ªä¸¾è¿‡ç¨‹ï¼Œä»¥è·å¾—è‡ªä¸¾æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾ï¼Œéšåè®¡ç®—è‡³å°‘ä¸é›¶å‡è®¾ä¸­æŒ‡å‡ºçš„æ¯”ä¾‹ä¸€æ ·æç«¯çš„æ€»ä½“æ¯”ä¾‹çš„æ¦‚ç‡ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»ƒä¹ æ¥å›é¡¾å¯¹æ ·æœ¬æ¯”ä¾‹è¿›è¡Œå‡è®¾æ£€éªŒçš„è¿‡ç¨‹ã€‚

### ç»ƒä¹  11.3 â€“ å¯¹æ ·æœ¬æ¯”ä¾‹è¿›è¡Œå‡è®¾æ£€éªŒ

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†è®¾å®šä¸€ä¸ªé›¶å‡è®¾ä¸­çš„å‡è®¾æ€»ä½“æ¯”ä¾‹ï¼Œå¹¶æ ¹æ®è§‚å¯Ÿåˆ°çš„æ ·æœ¬æ¯”ä¾‹æ¥æ£€éªŒè¿™ä¸ªå‡è®¾çš„æœ‰æ•ˆæ€§ï¼š

1.  åœ¨æ¡å½¢å›¾ä¸­ç»˜åˆ¶ 2016 å¹´æœ‰å’Œæ— åŒèƒèƒçš„å®¶åº­çš„é¢‘ç‡è®¡æ•°ï¼š

    ```py

    gss2016 %>%
    Â Â ggplot(aes(x = siblings_two_ind)) +
    Â Â geom_bar() +
    Â Â labs(title = "Frequency count of families with two siblings", x = "Have two siblings", y = "Count") +
    Â Â theme(text = element_text(size = 16))
    ```

    è¿è¡Œä»£ç ç”Ÿæˆå›¾ 11.6ï¼Œè¯¥å›¾æ˜¾ç¤ºæœ‰ä¸¤ä¸ªåŒèƒèƒçš„å®¶åº­å æ‰€æœ‰å®¶åº­çš„çº¦ 1/4ã€‚

![å›¾ 11.6 â€“ å¯è§†åŒ–æœ‰ä¸¤ä¸ªåŒèƒèƒçš„å®¶åº­çš„é¢‘ç‡è®¡æ•°](img/B18680_11_006.jpg)

å›¾ 11.6 â€“ å¯è§†åŒ–æœ‰ä¸¤ä¸ªåŒèƒèƒçš„å®¶åº­çš„é¢‘ç‡è®¡æ•°

1.  è®¡ç®—æœ‰ä¸¤ä¸ªåŒèƒèƒçš„å®¶åº­çš„æ ·æœ¬æ¯”ä¾‹ï¼š

    ```py

    p_hat = gss2016 %>%
    Â Â summarize(mean(siblings_two_ind=="Y")) %>%
    Â Â pull()
    >>> p_hat
    0.208246
    ```

    è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨`siblings_two_ind=="Y"`æ„å»ºä¸€ç³»åˆ—äºŒå…ƒç»“æœã€‚å–è¯¥åˆ—çš„å¹³å‡å€¼ç»™å‡º`TRUE`å€¼çš„æ¯”ç‡ï¼Œè¿™åœ¨`summarize()`ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨`pull()`æå–æ ·æœ¬æ¯”ä¾‹çš„å€¼ã€‚

1.  ä½¿ç”¨æŒ‡å®š-å‡è®¾-ç”Ÿæˆ-è®¡ç®—ç¨‹åºåœ¨é›¶å‡è®¾ä¸‹ç”Ÿæˆä¸€ç³»åˆ—è‡ªä¸¾æ ·æœ¬æ¯”ä¾‹ï¼Œè¯¥å‡è®¾æŒ‡å®šæ€»ä½“æ¯”ä¾‹ä¸º`0.19`ï¼š

    ```py

    null = gss2016 %>%
    Â Â specify(response = siblings_two_ind,
    Â Â Â Â Â Â Â Â Â Â success = "Y") %>%
    Â Â hypothesise(null = "point",
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â p = 0.19) %>%
    Â Â generate(reps = 500,
    Â Â Â Â Â Â Â Â Â Â Â type = "draw") %>%
    Â Â calculate(stat = "prop")
    >>> null
    Response: siblings_two_ind (factor)
    Null Hypothesis: point
    # A tibble: 500 Ã— 2
    Â Â Â replicateÂ Â stat
    Â Â Â <fct>Â Â Â Â Â <dbl>
     1 1Â Â Â Â Â Â Â Â Â 0.179
     2 2Â Â Â Â Â Â Â Â Â 0.193
     3 3Â Â Â Â Â Â Â Â Â 0.176
     4 4Â Â Â Â Â Â Â Â Â 0.181
     5 5Â Â Â Â Â Â Â Â Â 0.181
     6 6Â Â Â Â Â Â Â Â Â 0.198
     7 7Â Â Â Â Â Â Â Â Â 0.191
     8 8Â Â Â Â Â Â Â Â Â 0.189
     9 9Â Â Â Â Â Â Â Â Â 0.194
    10 10Â Â Â Â Â Â Â Â 0.189
    # â€¦ with 490 more rows
    # i Use `print(n = ...)` to see more rows
    ```

1.  é€šè¿‡å‚ç›´çº¿ç”Ÿæˆè‡ªä¸¾æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾ä»¥åŠé›¶å‡è®¾å»ºè®®çš„æ¯”ä¾‹ï¼š

    ```py

    ggplot(null, aes(x = stat)) +
    Â Â geom_density() +
    Â Â geom_vline(xintercept = p_hat,
    Â Â Â Â Â Â Â Â Â Â Â Â Â color = "red") +
    Â Â labs(title = "Density plot using bootstrap", x = "Sample proportion", y = "Density") +
    Â Â theme(text = element_text(size = 16))
    ```

    è¿è¡Œä»£ç ç”Ÿæˆå›¾ 11.7ï¼Œæ ¹æ®é›¶å‡è®¾ï¼Œçº¢è‰²çº¿ï¼ˆæ ¹æ®é›¶å‡è®¾ï¼‰æ‰€ç¤ºå€¼çš„è§‚å¯Ÿæ¦‚ç‡æ˜¯å¯†åº¦æ›²çº¿å³ä¾§çš„æ€»é¢ç§¯ã€‚ç„¶åæˆ‘ä»¬å°†ç»“æœåŠ å€ï¼Œä»¥è€ƒè™‘ç›¸åçš„æ–¹å‘ã€‚

![å›¾ 11.7 â€“ å¯è§†åŒ–å‡è®¾æ£€éªŒä¸­è‡ªä¸¾æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾](img/B18680_11_007.jpg)

å›¾ 11.7 â€“ å¯è§†åŒ–å‡è®¾æ£€éªŒä¸­è‡ªä¸¾æ ·æœ¬æ¯”ä¾‹çš„å¯†åº¦å›¾

1.  è®¡ç®— p å€¼ï¼š

    ```py

    >>> null %>%
    Â Â summarise(mean(stat > p_hat)) %>%
    Â Â pull()* 2
    0.02
    ```

    ç”±äºè¿™ä¸ªç»“æœå°äºé¢„è®¾çš„æ˜¾è‘—æ€§æ°´å¹³ 5%ï¼Œæˆ‘ä»¬æœ‰è¶³å¤Ÿçš„è¯æ®æ”¯æŒå¤‡æ‹©å‡è®¾å¹¶æ‹’ç»åŸå‡è®¾ã€‚æ¢å¥è¯è¯´ï¼Œå‡è®¾çš„ 19%ä¸çœŸå®æ€»ä½“æ¯”ä¾‹åœ¨ 95%çš„ç½®ä¿¡æ°´å¹³ä¸‹å­˜åœ¨ç»Ÿè®¡å­¦ä¸Šçš„å·®å¼‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒçœŸå®æ€»ä½“æ¯”ä¾‹ä¸æ˜¯ 19%ã€‚

ä¸‹ä¸€ä¸ªéƒ¨åˆ†å°†æ¢è®¨ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´æ ·æœ¬æ¯”ä¾‹å·®å¼‚çš„æ¨æ–­ã€‚

## æ ·æœ¬æ¯”ä¾‹å·®å¼‚çš„æ¨æ–­

ç°åœ¨çš„è®¾ç½®æ˜¯æˆ‘ä»¬æœ‰ä¸¤ä¸ªåˆ†ç±»å˜é‡ã€‚ä»¥æ€§åˆ«å’Œå­¦ä½ä¸ºä¾‹ã€‚æ•°æ®å°†æŠ¥å‘Šå¥³æ€§å’Œç”·æ€§çš„å­¦ä½æŒæœ‰è€…çš„æ¯”ä¾‹ã€‚ä¸€ä¸ªè‡ªç„¶çš„é—®é¢˜æ˜¯è¦é—®ç”·æ€§æ˜¯å¦æ¯”å¥³æ€§æ›´æœ‰å¯èƒ½è·å¾—å­¦ä½ã€‚ç‰¹å®šçš„æ•°æ®é›†å°†æŠ¥å‘Šè¿™äº›æ¯”ä¾‹çš„å¿«ç…§ï¼Œè¿™å¯èƒ½æˆ–å¯èƒ½ä¸ä¼šè¡¨æ˜å­¦ä½æŒæœ‰è€…çš„ç™¾åˆ†æ¯”æ›´é«˜ã€‚å‡è®¾æ£€éªŒçš„å·¥å…·å¯ä»¥ç”¨æ¥å›ç­”ä»¥ä¸‹é—®é¢˜ï¼šå¦‚æœæ•°æ®é›†ä¸­ç”·æ€§æ˜¯å­¦ä½æŒæœ‰è€…çš„æ›´é«˜æ¯”ä¾‹ï¼Œè¿™ç§å·®å¼‚åœ¨ç»Ÿè®¡ä¸Šæ˜¯å¦æ˜¾è‘—ï¼Ÿæ¢å¥è¯è¯´ï¼Œç”·æ€§æ˜¯å¦æ¯”å¥³æ€§æ›´æœ‰å¯èƒ½è·å¾—å­¦ä½ï¼Œåä¹‹äº¦ç„¶ï¼Ÿæœ¬èŠ‚è¯•å›¾å›ç­”è¿™ç±»é—®é¢˜ã€‚

å¯¹ä¸¤ä¸ªåˆ†ç±»å˜é‡ï¼ˆä¾‹å¦‚ï¼Œæ€§åˆ«å’Œå­¦ä½ï¼‰ä¹‹é—´æ ·æœ¬æ¯”ä¾‹å·®å¼‚çš„æ¨æ–­æ¶‰åŠæ¯”è¾ƒä¸¤ä¸ªä¸åŒç¾¤ä½“ä¸­æ¯ä¸ªçº§åˆ«çš„æ ·æœ¬æ¯”ä¾‹ã€‚è¿™ç§åˆ†æé€šå¸¸ç”¨äºå®éªŒæˆ–è§‚å¯Ÿæ€§ç ”ç©¶ï¼Œä»¥ç¡®å®šä¸¤ç»„ä¹‹é—´æ¯”ä¾‹å·®å¼‚çš„å­˜åœ¨æ€§ã€‚ä¸»è¦ç›®æ ‡æ˜¯ä¼°è®¡ç¾¤ä½“æ¯”ä¾‹ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶ç¡®å®šè¿™ç§å·®å¼‚åœ¨ç»Ÿè®¡ä¸Šæ˜¯å¦æ˜¾è‘—ã€‚

å‡è®¾æ£€éªŒçš„ç¨‹åºä¸ä¹‹å‰ç±»ä¼¼ã€‚æˆ‘ä»¬é¦–å…ˆæå‡ºé›¶å‡è®¾ï¼Œå³å‡è®¾ä¸¤ä¸ªç¾¤ä½“çš„æ¯”ä¾‹ä¹‹é—´æ²¡æœ‰å·®å¼‚ï¼Œå³ p1 = p2ï¼Œæˆ–è€… p1 - p2 = 0ã€‚å¤‡æ‹©å‡è®¾éšåè¡¨æ˜å®ƒä»¬çš„å·®å¼‚ä¸æ˜¯é›¶ï¼›å³ p1 - p2 â‰  0ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„æ˜¾è‘—æ€§æ°´å¹³ï¼Œè®¡ç®—æ ·æœ¬ç»Ÿè®¡é‡ï¼ˆæ ·æœ¬æ¯”ä¾‹çš„å·®å¼‚ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´çš„åˆå¹¶æ¯”ä¾‹ï¼‰å’Œæ£€éªŒç»Ÿè®¡é‡ï¼ˆåŸºäºå‡è®¾åˆ†å¸ƒçš„é—­å¼è¡¨è¾¾å¼æˆ–ä½¿ç”¨è‡ªåŠ©æ³•ï¼‰ã€‚æœ€åï¼Œæˆ‘ä»¬è·å¾— p å€¼å¹¶å†³å®šåœ¨é›¶å‡è®¾ä¸‹è§‚å¯Ÿåˆ°çš„ç»“æœæ˜¯å¦å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¹‹å‰çš„ä¾‹å­è¿›è¡Œä¸€ä¸ªå…·ä½“çš„ç»ƒä¹ ã€‚

### ç»ƒä¹  11.4 â€“ å¯¹æ ·æœ¬æ¯”ä¾‹å·®å¼‚è¿›è¡Œå‡è®¾æ£€éªŒ

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨å¦‚ä½•å¯¹æ€§åˆ«å’Œæ›´é«˜å­¦ä½çŠ¶æ€ä¹‹é—´çš„æ ·æœ¬æ¯”ä¾‹å·®å¼‚è¿›è¡Œå‡è®¾æ£€éªŒã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ›´é«˜å­¦ä½å®šä¹‰ä¸ºå­¦å£«å­¦ä½åŠä»¥ä¸Šã€‚ç”·æ€§å’Œå¥³æ€§ç¾¤ä½“ä¸­æ›´é«˜å­¦ä½æŒæœ‰è€…çš„æ¯”ä¾‹å¯èƒ½ä¼šä¸åŒï¼Œæˆ‘ä»¬å°†æµ‹è¯•åœ¨è§‚å¯Ÿåˆ°çš„æ•°æ®ä¸‹è¿™ç§å·®å¼‚æ˜¯å¦æ˜¾è‘—ï¼š

1.  åœ¨ä¹‹å‰çš„ DataFrame `gss2016`ä¸­æ·»åŠ ä¸€ä¸ªåä¸º`higher_degree`çš„äºŒè¿›åˆ¶åˆ—ï¼Œä»¥æŒ‡ç¤ºæ›´é«˜å­¦ä½çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å­¦å£«åŠä»¥ä¸Šï¼š

    ```py

    gss2016 = gss2016 %>%
    Â Â mutate(higher_degree = if_else(degree %in% c("Bachelor","Graduate"), "Y", "N"))
    ```

1.  æ‰“å°`gender`å’Œ`higher_degree`ä¸¤ä¸ªçº§åˆ«çš„æ¯”ç‡ï¼š

    ```py

    >>> table(gss2016$higher_degree)
    Â Â Â NÂ Â Â Â Y
    2008Â Â 854
    >>> table(gss2016$sex)
    Â Â Male Female
    Â Â 1274Â Â Â 1588
    ```

1.  å°†è¿™äº›è®¡æ•°åœ¨æŸ±çŠ¶å›¾ä¸­ç»˜åˆ¶ï¼š

    ```py

    ggplot(gss2016, aes(x = sex, fill=higher_degree)) +
    Â Â geom_bar() +
    Â Â labs(title = "Frequency count for gender and degree", x = "Gender", y = "Count") +
    Â Â theme(text = element_text(size = 16))
    ```

    è¿è¡Œä»£ç ç”Ÿæˆ*å›¾ 11.8*ã€‚

![å›¾ 11.8 â€“ å¯è§†åŒ–æ€§åˆ«å’Œæ›´é«˜å­¦ä½çŠ¶æ€çš„é¢‘ç‡è®¡æ•°](img/B18680_11_008.jpg)

å›¾ 11.8 â€“ å¯è§†åŒ–æ€§åˆ«å’Œæ›´é«˜å­¦ä½çŠ¶æ€çš„é¢‘ç‡è®¡æ•°

æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡åœ¨`geom_bar()`å‡½æ•°ä¸­æŒ‡å®š`position = "fill"`æ¥æŒ‰ç™¾åˆ†æ¯”ç»˜åˆ¶å®ƒä»¬ï¼š

```py

ggplot(gss2016, aes(x = sex, fill=higher_degree)) +
Â Â geom_bar(position = "fill") +
Â Â labs(title = "Sample proportions for gender and degree", x = "Gender", y = "Ratio") +
Â Â theme(text = element_text(size = 16))
```

è¿è¡Œä»£ç ç”Ÿæˆ*å›¾ 11.9*ï¼Œè¯¥å›¾è¡¨æ˜ç”·æ€§å’Œå¥³æ€§ç¾¤ä½“ä¹‹é—´æ›´é«˜å­¦ä½æŒæœ‰è€…æ¯”ä¾‹æ²¡æœ‰æ˜æ˜¾å·®å¼‚ã€‚

![å›¾ 11.9 â€“ å¯è§†åŒ–æ€§åˆ«å’Œæ›´é«˜å­¦ä½çŠ¶æ€çš„é¢‘ç‡è®¡æ•°](img/B18680_11_009.jpg)

å›¾ 11.9 â€“ å¯è§†åŒ–æ€§åˆ«å’Œæ›´é«˜å­¦ä½çŠ¶æ€çš„é¢‘ç‡è®¡æ•°

1.  è®¡ç®—ç”·æ€§å’Œå¥³æ€§ä¹‹é—´æ›´é«˜å­¦ä½æŒæœ‰è€…æ ·æœ¬æ¯”ä¾‹çš„å·®å¼‚ï¼š

    ```py

    p_hats = gss2016 %>%
    Â Â group_by(sex) %>%
    Â Â summarise(mean(higher_degree=="Y", na.rm=TRUE)) %>%
    Â Â pull()
    d_hat = diff(p_hats)
    >>> d_hat
    0.007288771
    ```

    ç»“æœè¿˜æ˜¾ç¤ºï¼Œå·®å¼‚ç›¸å½“å°ï¼Œå¥³æ€§ç¾¤ä½“æ¯”ç”·æ€§ç¾¤ä½“é«˜ 0.7%ï¼ˆå‚è€ƒå‰ä¸€ä¸ªå›¾ä¸­å¥³æ€§ç¾¤ä½“ç•¥é«˜çš„è“è‰²æ¡å½¢ï¼‰ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ç§å·®å¼‚æ˜¯å¦å…·æœ‰ç»Ÿè®¡å­¦æ„ä¹‰ã€‚

1.  åœ¨é›¶å‡è®¾ä¸‹ç”Ÿæˆä¸€ä¸ªè‡ªåŠ©æ ·æœ¬é›†ï¼Œè¯¥å‡è®¾è¡¨æ˜ç”·æ€§å’Œå¥³æ€§ç¾¤ä½“ä¹‹é—´æ›´é«˜å­¦ä½æŒæœ‰è€…æ¯”ä¾‹æ²¡æœ‰å·®å¼‚ï¼š

    ```py

    gss2016 %>%
    Â Â specify(
    Â Â Â Â response = higher_degree,
    Â Â Â Â explanatory = sex,
    Â Â Â Â success = "Y"
    Â Â ) %>%
    Â Â hypothesise(null = "independence") %>%
    Â Â generate(reps = 1, type = "permute")
    Response: higher_degree (factor)
    Explanatory: sex (factor)
    Null Hypothesis: independence
    # A tibble: 2,862 Ã— 3
    # Groups:Â Â Â replicate [1]
    Â Â Â higher_degree sexÂ Â Â Â replicate
    Â Â Â <fct>Â Â Â Â Â Â Â Â Â <fct>Â Â Â Â Â Â <int>
     1 NÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
     2 NÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
     3 YÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
     4 NÂ Â Â Â Â Â Â Â Â Â Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
     5 NÂ Â Â Â Â Â Â Â Â Â Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
     6 NÂ Â Â Â Â Â Â Â Â Â Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
     7 YÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
     8 NÂ Â Â Â Â Â Â Â Â Â Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
     9 NÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
    10 NÂ Â Â Â Â Â Â Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
    # â€¦ with 2,852 more rows
    # i Use `print(n = ...)` to see more rows
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†`higher_degree`ä½œä¸ºå“åº”å˜é‡ï¼Œå°†`sex`ä½œä¸ºè§£é‡Šå˜é‡ï¼Œåœ¨é€»è¾‘å›å½’è®¾ç½®ä¸­ä½¿ç”¨ï¼ˆå°†åœ¨*ç¬¬åä¸‰ç« *ä¸­ä»‹ç»ï¼‰ã€‚åœ¨é›¶å‡è®¾ä¸‹ï¼Œæˆ‘ä»¬ä»åŸå§‹æ•°æ®é›†ä¸­éšæœºæŠ½æ ·å¹¶åˆ›å»ºä¸€ä¸ªå…·æœ‰ç›¸åŒå½¢çŠ¶çš„æ–°çš„äººå·¥æ•°æ®é›†ã€‚

1.  é‡å¤ç›¸åŒçš„è‡ªåŠ©æŠ½æ ·è¿‡ç¨‹ 500 æ¬¡ï¼Œå¹¶è®¡ç®—æ¯å¯¹è‡ªåŠ©æ ·æœ¬ä¸­å¥³æ€§å’Œç”·æ€§ç¾¤ä½“ä¹‹é—´æ›´é«˜å­¦ä½æŒæœ‰è€…æ ·æœ¬æ¯”ä¾‹çš„å·®å¼‚ï¼ˆæ³¨æ„è¿™é‡Œçš„é¡ºåºï¼‰ï¼š

    ```py

    null = gss2016 %>%
    Â Â specify(
    Â Â Â Â higher_degree ~ sex,
    Â Â Â Â success = "Y"
    Â Â ) %>%
    Â Â hypothesise(null = "independence") %>%
    Â Â generate(reps = 500, type = "permute") %>%
    Â Â calculate(stat = "diff in props", order = c("Female", "Male"))
    >>> null
    Response: higher_degree (factor)
    Explanatory: sex (factor)
    Null Hypothesis: independence
    # A tibble: 500 Ã— 2
    Â Â Â replicateÂ Â Â Â Â stat
    Â Â Â Â Â Â Â <int>Â Â Â Â <dbl>
     1Â Â Â Â Â Â Â Â Â 1Â Â 0.00870
     2Â Â Â Â Â Â Â Â Â 2Â Â 0.00587
     3Â Â Â Â Â Â Â Â Â 3 -0.00120
     4Â Â Â Â Â Â Â Â Â 4Â Â 0.0228
     5Â Â Â Â Â Â Â Â Â 5Â Â 0.00446
     6Â Â Â Â Â Â Â Â Â 6 -0.00827
     7Â Â Â Â Â Â Â Â Â 7 -0.0366
     8Â Â Â Â Â Â Â Â Â 8Â Â 0.0129
     9Â Â Â Â Â Â Â Â Â 9Â Â 0.0172
    10Â Â Â Â Â Â Â Â 10 -0.00261
    # â€¦ with 490 more rows
    # i Use `print(n = ...)` to see more rows
    ```

1.  å°†è¿™äº›è‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡ç»˜åˆ¶åœ¨å¯†åº¦æ›²çº¿ä¸Šï¼Œå¹¶å°†è§‚å¯Ÿåˆ°çš„å·®å¼‚ä½œä¸ºå‚ç›´çº¢è‰²çº¿ï¼š

    ```py

    ggplot(null, aes(x = stat)) +
    Â Â geom_density() +
    Â Â geom_vline(xintercept = d_hat, color = "red") +
    Â Â labs(x = "Difference in sample proportion (female - male)", y = "Count") +
    Â Â theme(text = element_text(size = 16))
    ```

    è¿è¡Œä»£ç ç”Ÿæˆ*å›¾ 11.10*ï¼Œè¯¥å›¾æ˜¾ç¤ºçº¢è‰²çº¿å¹¶ä¸ä½äºç»éªŒåˆ†å¸ƒçš„æç«¯ä¸€ä¾§ã€‚è¿™è¡¨æ˜æ¥ä¸‹æ¥è¦è®¡ç®—çš„ p å€¼å¯èƒ½è¾ƒé«˜ã€‚

![å›¾ 11.10 â€“ æ˜¾ç¤ºè‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡å’Œè§‚å¯Ÿåˆ°çš„å·®å¼‚çš„å¯†åº¦å›¾](img/B18680_11_010.jpg)

å›¾ 11.10 â€“ æ˜¾ç¤ºè‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡å’Œè§‚å¯Ÿåˆ°çš„å·®å¼‚çš„å¯†åº¦å›¾

1.  è®¡ç®—åŒå°¾ p å€¼ï¼š

    ```py

    null %>%
    Â Â summarize(pval = 2 * mean(stat > d_hat)) %>%
    Â Â pull()
    0.608
    ```

    ç»“æœæ˜¾ç¤ºä¸€ä¸ªç›¸å½“é«˜çš„ p å€¼ï¼Œè¿™è¡¨æ˜æˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„è¯æ®æ¥æ‹’ç»é›¶å‡è®¾ã€‚æ¢å¥è¯è¯´ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯è¡¨æ˜ç”·æ€§å’Œå¥³æ€§ä¹‹é—´æ›´é«˜å­¦ä½æŒæœ‰è€…çš„æ¯”ä¾‹ä¸åŒã€‚

å‡è®¾æ£€éªŒä¾èµ–äºä¸€ä¸ªé¢„å®šä¹‰çš„æ˜¾è‘—æ€§æ°´å¹³ã€‚è¿™ä¸ªæ˜¾è‘—æ€§æ°´å¹³ï¼Œç”¨Î±è¡¨ç¤ºï¼Œä¸è¯¥è¿‡ç¨‹çš„ç»Ÿè®¡è¯¯å·®æœ‰å…³ã€‚ä¸‹ä¸€èŠ‚ä»‹ç»äº†åœ¨æ‰§è¡Œå‡è®¾æ£€éªŒæ—¶å¸¸è§çš„ä¸¤ç§ç»Ÿè®¡è¯¯å·®ç±»å‹ã€‚

## ä¸€ç±»é”™è¯¯å’ŒäºŒç±»é”™è¯¯

åœ¨è¿›è¡Œå‡è®¾æ£€éªŒå¹¶å¯¹é›¶å‡è®¾ï¼ˆH0ï¼‰å’Œå¤‡æ‹©å‡è®¾ï¼ˆH1ï¼‰åšå‡ºå†³ç­–æ—¶ï¼Œå­˜åœ¨ä¸¤ç§ç±»å‹çš„é”™è¯¯ã€‚å®ƒä»¬è¢«ç§°ä¸ºç¬¬ä¸€ç±»é”™è¯¯å’Œç¬¬äºŒç±»é”™è¯¯ã€‚

ç¬¬ä¸€ç±»é”™è¯¯æŒ‡çš„æ˜¯å‡é˜³æ€§ã€‚å®ƒå‘ç”Ÿåœ¨é›¶å‡è®¾ä¸ºçœŸä½†é”™è¯¯åœ°è¢«æ‹’ç»æ—¶ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åœ¨æ ·æœ¬æ•°æ®ä¸­æ‰¾åˆ°äº†è¡¨æ˜å­˜åœ¨æ˜¾è‘—æ•ˆåº”æˆ–å·®å¼‚çš„è¯æ®ï¼Œæˆ‘ä»¬å€¾å‘äºå¤‡æ‹©å‡è®¾ï¼Œå°½ç®¡å®ƒå®é™…ä¸Šåœ¨æ€»ä½“ä¸­å¹¶ä¸å­˜åœ¨ã€‚æˆ‘ä»¬ç”¨Î±è¡¨ç¤ºç»å†ç¬¬ä¸€ç±»é”™è¯¯çš„æ¦‚ç‡ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºæ˜¾è‘—æ€§æ°´å¹³ï¼Œåœ¨å…ˆå‰çš„ä¾‹å­ä¸­è®¾ç½®ä¸º`0.05`ã€‚5%çš„æ˜¾è‘—æ€§æ°´å¹³æ„å‘³ç€å½“é›¶å‡è®¾ä¸ºçœŸæ—¶ï¼Œæœ‰ 5%çš„æ¦‚ç‡æ‹’ç»é›¶å‡è®¾ã€‚å› æ­¤ï¼Œæ˜¾è‘—æ€§æ°´å¹³ä»£è¡¨çŠ¯å‡é˜³æ€§é”™è¯¯çš„æ¦‚ç‡ã€‚

ç¬¬äºŒç±»é”™è¯¯ä¸“æ³¨äºå‡é˜´æ€§æƒ…å†µã€‚å®ƒå‘ç”Ÿåœ¨æˆ‘ä»¬æœªèƒ½æ‹’ç»ä¸€ä¸ªé”™è¯¯çš„é›¶å‡è®¾æ—¶ã€‚æ¢å¥è¯è¯´ï¼Œå³ä½¿åœ¨æ€»ä½“ä¸­å­˜åœ¨ï¼Œæˆ‘ä»¬åœ¨æ ·æœ¬æ•°æ®ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°æ‹’ç»é›¶å‡è®¾çš„è¯æ®ã€‚çŠ¯ç¬¬äºŒç±»é”™è¯¯çš„æ¦‚ç‡ç”¨Î²è¡¨ç¤ºï¼Œä¹Ÿè¢«ç§°ä¸ºæµ‹è¯•çš„æ•ˆåŠ›ã€‚æ•ˆåŠ›çš„è¡¥æ•°ï¼Œè¡¨ç¤ºä¸º 1 âˆ’ Î²ï¼Œä»£è¡¨åœ¨å‡è®¾é”™è¯¯æ—¶æ‹’ç»é›¶å‡è®¾çš„æ¦‚ç‡ã€‚

ç¬¬ä¸€ç±»é”™è¯¯æ¶‰åŠé”™è¯¯åœ°æ‹’ç»é›¶å‡è®¾ï¼Œè€Œç¬¬äºŒç±»é”™è¯¯æ¶‰åŠåœ¨å‡è®¾é”™è¯¯æ—¶æœªèƒ½æ‹’ç»é›¶å‡è®¾ã€‚åœ¨è¿™ä¸¤ç§ç±»å‹çš„é”™è¯¯éƒ½æ˜¯å‡è®¾æ£€éªŒä¸­çš„é‡è¦è€ƒè™‘å› ç´ ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å¯¼è‡´é”™è¯¯çš„ç»“è®ºã€‚ä¸ºäº†æœ€å¤§é™åº¦åœ°å‡å°‘è¿™äº›é”™è¯¯çš„é£é™©ï¼Œæˆ‘ä»¬å¯ä»¥è°¨æ…åœ°é€‰æ‹©æ˜¾è‘—æ€§æ°´å¹³ï¼ˆÎ±ï¼‰ï¼Œå¹¶ç¡®ä¿ä»–ä»¬çš„ç ”ç©¶å…·æœ‰è¶³å¤Ÿçš„æ•ˆåŠ›ï¼ˆ1 âˆ’ Î²ï¼‰ã€‚æµ‹è¯•çš„æ•ˆåŠ›å–å†³äºæ ·æœ¬å¤§å°ã€æ•ˆåº”é‡ï¼ˆè¿™æ˜¯ä¸€ä¸ªå˜é‡ä¹‹é—´ç»éªŒå…³ç³»çš„é‡åº¦ï¼‰å’Œé€‰æ‹©çš„æ˜¾è‘—æ€§æ°´å¹³ã€‚è¾ƒå¤§çš„æ ·æœ¬å¤§å°å’Œè¾ƒå¤§çš„æ•ˆåº”é‡éƒ½ä¼šå¢åŠ æµ‹è¯•çš„æ•ˆåŠ›ï¼Œä»è€Œé™ä½ç¬¬äºŒç±»é”™è¯¯çš„å¯èƒ½æ€§ã€‚

*å›¾ 11.11* æä¾›äº†å‡è®¾æ£€éªŒä¸­ä¸åŒç±»å‹ç»“æœçš„æ¦‚è¿°ã€‚è¯·æ³¨æ„ï¼Œå‡é˜³æ€§å’Œå‡é˜´æ€§ä¸å†³ç­–çš„è´¨é‡æœ‰å…³ã€‚æ ¹æ®é”™è¯¯å†³ç­–çš„ç±»å‹ï¼Œæˆ‘ä»¬å°†é”™è¯¯åˆ†ç±»ä¸ºç¬¬ä¸€ç±»æˆ–ç¬¬äºŒç±»é”™è¯¯ã€‚

![å›¾ 11.11 â€“ å‡è®¾æ£€éªŒä¸­ä¸åŒç±»å‹ç»“æœæ¦‚è¿°](img/B18680_11_011.jpg)

å›¾ 11.11 â€“ å‡è®¾æ£€éªŒä¸­ä¸åŒç±»å‹ç»“æœæ¦‚è¿°

ä¸‹ä¸€èŠ‚ä»‹ç»äº†å¡æ–¹æ£€éªŒï¼Œè¯¥æ£€éªŒç”¨äºæ£€éªŒä¸¤ä¸ªåˆ†ç±»å˜é‡çš„ç‹¬ç«‹æ€§ã€‚

## æ£€éªŒä¸¤ä¸ªåˆ†ç±»å˜é‡çš„ç‹¬ç«‹æ€§

è¦æ£€æŸ¥ä¸¤ä¸ªåˆ†ç±»å˜é‡çš„ç‹¬ç«‹æ€§ï¼Œæ¶‰åŠæ£€æŸ¥å®ƒä»¬ä¹‹é—´æ˜¯å¦å­˜åœ¨ç»Ÿè®¡ä¸Šæ˜¾è‘—çš„å…³ç³»ã€‚ä¸€ä¸ªå¸¸è§çš„ç¨‹åºæ˜¯ç‹¬ç«‹æ€§å¡æ–¹æ£€éªŒã€‚å®ƒé€šè¿‡æ¯”è¾ƒåˆ—è”è¡¨ä¸­çš„è§‚å¯Ÿé¢‘ç‡ä¸ç‹¬ç«‹æ€§å‡è®¾ä¸‹çš„é¢„æœŸé¢‘ç‡æ¥å·¥ä½œã€‚

è®©æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ä¸¤ä¸ªåˆ†ç±»å˜é‡çš„åˆ—è”è¡¨ã€‚

## ä»‹ç»åˆ—è”è¡¨

åˆ—è”è¡¨ï¼Œä¹Ÿç§°ä¸ºäº¤å‰è¡¨æˆ– crosstabï¼Œæ˜¯ä¸€ç§ç”¨äºæ˜¾ç¤ºä¸¤ä¸ªæˆ–æ›´å¤šåˆ†ç±»å˜é‡é¢‘ç‡åˆ†å¸ƒçš„è¡¨æ ¼ã€‚å®ƒé€šè¿‡æ˜¾ç¤ºå˜é‡çš„ç±»åˆ«å¦‚ä½•åœ¨æ•°æ®ä¸­ç›¸äº¤æˆ–åŒæ—¶å‡ºç°æ¥æ€»ç»“å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å®ƒæä¾›äº†åˆ†ç±»å˜é‡ä¹‹é—´å…³ç³»çš„è‰¯å¥½æ€»ç»“ã€‚

è®©æˆ‘ä»¬ç»§ç»­ä»¥æ€§åˆ«ä¸å­¦ä½ä¹‹é—´çš„å…³ç³»ä¸ºä¾‹ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹æ‰€æœ‰ç±»å‹çš„å­¦ä½ï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼š

```py

>>> table(gss2016$degree)
Lt High SchoolÂ Â Â Â High School Junior CollegeÂ Â Â Â Â Â Â Bachelor Â Â Â Â Â Â Â Graduate
Â Â Â Â Â Â Â Â Â Â Â 328Â Â Â Â Â Â Â Â Â Â Â 1459Â Â Â Â Â Â Â Â Â Â Â Â 215Â Â Â Â Â Â Â Â Â Â Â Â 536 Â Â Â Â Â Â Â Â Â Â Â Â 318
```

ä¸ºäº†è¡¨ç¤ºå…¶ä¸æ€§åˆ«çš„å…³è”ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·ï¼Œå°†å­¦ä½ä¸æ€§åˆ«ä¸€èµ·ç»˜åˆ¶åœ¨å †ç§¯æ¡å½¢å›¾ä¸­ï¼š

```py

ggplot(gss2016, aes(x = sex, fill=degree)) +
Â Â geom_bar() +
Â Â labs(title = "Frequency count for gender and degree", x = "Gender", y = "Count") +
Â Â theme(text = element_text(size = 16))
```

è¿è¡Œä»£ç ç”Ÿæˆå›¾*å›¾ 11.12*ã€‚

![å›¾ 11.12 â€“ åœ¨æ¡å½¢å›¾ä¸­å¯è§†åŒ–æ€§åˆ«ä¸å­¦ä½ä¹‹é—´çš„å…³ç³»](img/B18680_11_012.jpg)

å›¾ 11.12 â€“ åœ¨æ¡å½¢å›¾ä¸­å¯è§†åŒ–æ€§åˆ«ä¸å­¦ä½ä¹‹é—´çš„å…³ç³»

ç„¶è€Œï¼Œè¯¥å›¾æ²¡æœ‰æä¾›æ¯ä¸ªç±»åˆ«çš„ç¡®åˆ‡è®¡æ•°ä¿¡æ¯ã€‚ä¸ºäº†è·å¾—ä¸¤ä¸ªå˜é‡æ¯ä¸ªç±»åˆ«çš„ç¡®åˆ‡é¢‘ç‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—è”è¡¨ï¼š

```py

tab = gss2016 %>%
Â Â select(sex, degree) %>%
Â Â table()
>>> tab
Â Â Â Â Â Â Â Â degree
sexÂ Â Â Â Â Â Lt High School High School Junior College Bachelor Graduate
Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â Â Â Â 147Â Â Â Â Â Â Â Â Â 661Â Â Â Â Â Â Â Â Â Â Â Â Â 89Â Â Â Â Â Â 243Â Â Â Â Â Â 132
Â Â FemaleÂ Â Â Â Â Â Â Â Â Â Â Â 181Â Â Â Â Â Â Â Â Â 798Â Â Â Â Â Â Â Â Â Â Â Â 126Â Â Â Â Â Â 293Â Â Â Â Â Â 186
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`table()`å‡½æ•°åœ¨é€‰æ‹©äº†`sex`å’Œ`degree`ä¹‹åç”Ÿæˆåˆ—è”è¡¨ã€‚

ä¸‹ä¸€èŠ‚ä»‹ç»äº†å¡æ–¹æ£€éªŒï¼Œç”¨äºæ£€éªŒè¿™ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§ã€‚

## åº”ç”¨ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§å¡æ–¹æ£€éªŒ

å¡æ–¹æ£€éªŒæ˜¯ä¸€ç§ç»Ÿè®¡æ£€éªŒï¼Œç”¨äºå†³å®šä¸€ç»„è§‚å¯Ÿæ ·æœ¬ä¸­ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´å¯èƒ½å­˜åœ¨æ˜¾è‘—å…³ç³»ï¼ˆä¾èµ–æ€§ï¼‰ã€‚å®ƒå¯ä»¥ç”¨æ¥æ£€éªŒç‹¬ç«‹æ€§æˆ–æ‹Ÿåˆä¼˜åº¦ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§æ£€éªŒã€‚è¯¥æ£€éªŒæ¯”è¾ƒåˆ—è”è¡¨ä¸­è§‚å¯Ÿåˆ°çš„é¢‘ç‡ä¸é¢„æœŸçš„é¢‘ç‡ï¼Œå‡è®¾å˜é‡æ˜¯ç‹¬ç«‹çš„ã€‚å¦‚æœè§‚å¯Ÿåˆ°çš„é¢‘ç‡å’Œé¢„æœŸçš„é¢‘ç‡æœ‰æ˜¾è‘—å·®å¼‚ï¼Œåˆ™æ£€éªŒè¡¨æ˜å˜é‡ä¸æ˜¯ç‹¬ç«‹çš„ï¼›æ¢å¥è¯è¯´ï¼Œå®ƒä»¬ç›¸äº’ä¾èµ–ã€‚

æŒ‰ç…§ä¹‹å‰çš„ç›¸åŒæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ä¸ªäººå·¥çš„ bootstrap æ•°æ®é›†ä»¥è·å¾—ä¸€ä¸ªæ ·æœ¬ç»Ÿè®¡é‡ï¼Œç§°ä¸ºå¡æ–¹ç»Ÿè®¡é‡ã€‚è¯¥æ•°æ®é›†æ˜¯åœ¨åŸæ•°æ®é›†çš„å½¢çŠ¶ä¸‹ï¼Œå‡è®¾åœ¨é›¶å‡è®¾ä¸‹çš„ç‹¬ç«‹æ€§è¿›è¡Œæ’åˆ—ç”Ÿæˆçš„ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªä¸åŸæ•°æ®é›†å½¢çŠ¶ç›¸åŒçš„ä¸€ä¸ªæ’åˆ—æ•°æ®é›†ï¼Œå‡è®¾åœ¨é›¶å‡è®¾ä¸‹çš„ç‹¬ç«‹æ€§ï¼š

```py

perm_1 = gss2016 %>%
Â Â # Specify the variables of interest
Â Â specify(degree ~ sex) %>%
Â Â # Set up the null hypothesis
Â Â hypothesize(null = "independence") %>%
Â Â # Generate a single permuted dataset
Â Â generate(reps = 1, type = "permute")
>>> perm_1
Response: degree (factor)
Explanatory: sex (factor)
Null Hypothesis: independence
# A tibble: 2,856 Ã— 3
# Groups:Â Â Â replicate [1]
Â Â Â degreeÂ Â Â Â Â Â Â Â Â sexÂ Â Â Â replicate
Â Â Â <fct>Â Â Â Â Â Â Â Â Â Â <fct>Â Â Â Â Â Â <int>
 1 Junior College MaleÂ Â Â Â Â Â Â Â Â Â Â 1
 2 BachelorÂ Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
 3 High SchoolÂ Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
 4 High SchoolÂ Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
 5 High SchoolÂ Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
 6 High SchoolÂ Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
 7 GraduateÂ Â Â Â Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
 8 BachelorÂ Â Â Â Â Â Â FemaleÂ Â Â Â Â Â Â Â Â 1
 9 High SchoolÂ Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
10 High SchoolÂ Â Â Â MaleÂ Â Â Â Â Â Â Â Â Â Â 1
# â€¦ with 2,846 more rows
# i Use `print(n = ...)` to see more rows
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»º 500 ä¸ªæ’åˆ—æ•°æ®é›†å¹¶æå–ç›¸åº”çš„å¡æ–¹ç»Ÿè®¡é‡ï¼š

```py

null_spac = gss2016 %>%
Â Â specify(degree ~ sex) %>%
Â Â hypothesize(null = "independence") %>%
Â Â generate(reps = 500, type = "permute") %>%
Â Â calculate(stat = "Chisq")
>>> null_spac
Response: degree (factor)
Explanatory: sex (factor)
Null Hypothesis: independence
# A tibble: 500 Ã— 2
Â Â Â replicateÂ Â stat
Â Â Â Â Â Â Â <int> <dbl>
 1Â Â Â Â Â Â Â Â Â 1Â Â 3.50
 2Â Â Â Â Â Â Â Â Â 2Â Â 1.11
 3Â Â Â Â Â Â Â Â Â 3 14.0
 4Â Â Â Â Â Â Â Â Â 4Â Â 4.62
 5Â Â Â Â Â Â Â Â Â 5Â Â 1.41
 6Â Â Â Â Â Â Â Â Â 6Â Â 1.41
 7Â Â Â Â Â Â Â Â Â 7Â Â 9.69
 8Â Â Â Â Â Â Â Â Â 8Â Â 4.17
 9Â Â Â Â Â Â Â Â Â 9Â Â 5.97
10Â Â Â Â Â Â Â Â 10Â Â 2.86
# â€¦ with 490 more rows
# i Use `print(n = ...)` to see more rows
```

ä¸ºäº†è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬åœ¨å‡è®¾åˆ†ç±»å˜é‡ä¹‹é—´ç›¸äº’ç‹¬ç«‹çš„æƒ…å†µä¸‹ï¼Œè·å–åˆ—è”è¡¨ä¸­æ¯ä¸ªå•å…ƒæ ¼çš„é¢„æœŸé¢‘ç‡ã€‚å•å…ƒæ ¼çš„é¢„æœŸé¢‘ç‡è®¡ç®—ä¸ºï¼ˆ*è¡Œå’Œ* *åˆ—å’Œ*ï¼‰ */* *æ€»ä½“å’Œ*ï¼š

```py

# calculate expected frequency table
row_totals = rowSums(tab)
col_totals = colSums(tab)
overall_total = sum(tab)
expected = outer(row_totals, col_totals) / overall_total
>>> expected
Â Â Â Â Â Â Â Lt High School High School Junior College Bachelor Graduate
MaleÂ Â Â Â Â Â Â Â Â Â 146.084Â Â Â Â 649.8067Â Â Â Â Â Â Â Â 95.7563 238.7227 141.6303
FemaleÂ Â Â Â Â Â Â Â 181.916Â Â Â Â 809.1933Â Â Â Â Â Â Â 119.2437 297.2773 176.3697
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆè·å–è¡Œå’Œåˆ—çš„å’Œä»¥åŠæ€»å’Œã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨`outer()`å‡½æ•°è·å–è¿™ä¸¤ä¸ªå‘é‡çš„å¤–ç§¯ï¼Œç„¶åå°†å…¶æŒ‰æ€»å’Œç¼©æ”¾ä»¥è·å¾—æ¯ä¸ªå•å…ƒæ ¼çš„é¢„æœŸé¢‘ç‡è®¡æ•°ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æ ¹æ®å¯ç”¨çš„æ ·æœ¬è®¡ç®—è§‚å¯Ÿåˆ°çš„å¡æ–¹ç»Ÿè®¡é‡ï¼š

```py

# Compute chi-square statistic
observed_chi_square = sum((tab - expected)Â² / expected)
>>> observed_chi_square
2.536349
```

æˆ‘ä»¬å¯ä»¥åœ¨ä¹‹å‰é€šè¿‡è‡ªåŠ©æ³•å¾—åˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡çš„å¯†åº¦æ›²çº¿ä¸­ç»˜åˆ¶è§‚å¯Ÿåˆ°çš„å¡æ–¹ç»Ÿè®¡é‡ï¼Œä»¥äº†è§£è§‚å¯Ÿåˆ°çš„ç»Ÿè®¡é‡æ‰€åœ¨çš„ä½ç½®ï¼Œæ®æ­¤æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºç›¸åº”çš„ p å€¼ï¼š

```py

ggplot(null_spac, aes(x = stat)) +
Â Â geom_density() +
Â Â geom_vline(xintercept = observed_chi_square, color = "red") +
Â Â labs(title = "Density curve of bootstrapped chi-square statistic", x = "Chi-square statistic", y = "Density") +
Â Â theme(text = element_text(size = 16))
```

è¿è¡Œä»£ç ç”Ÿæˆäº†*å›¾ 11.13*ï¼Œå®ƒæ˜¾ç¤ºäº†ä¸€ä¸ªè¾ƒé«˜çš„ p å€¼ã€‚

![å›¾ 11.13 â€“ å¯è§†åŒ–è‡ªåŠ©æ³•å¡æ–¹ç»Ÿè®¡é‡çš„å¯†åº¦æ›²çº¿å’Œè§‚å¯Ÿåˆ°çš„ç»Ÿè®¡é‡](img/B18680_11_013.jpg)

å›¾ 11.13 â€“ å¯è§†åŒ–è‡ªåŠ©æ³•å¡æ–¹ç»Ÿè®¡é‡çš„å¯†åº¦æ›²çº¿å’Œè§‚å¯Ÿåˆ°çš„ç»Ÿè®¡é‡

ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¡ç®— p å€¼ã€‚å¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼Œp å€¼ä¸º`0.72`ç¡®å®ç›¸å½“é«˜ï¼Œå› æ­¤æ²¡æœ‰è¶³å¤Ÿçš„è¯æ®æ¥æ‹’ç»é›¶å‡è®¾ï¼š

```py

>>> null_spac %>%
Â Â summarize(pval = 2 * mean(stat < observed_chi_square)) %>%
Â Â pull()
0.72
```

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å‘è§‚å¯Ÿæ•°å€¼æ•°æ®çš„ç»Ÿè®¡æ¨æ–­ã€‚

# æ•°å€¼æ•°æ®çš„ç»Ÿè®¡æ¨æ–­

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å‘ä½¿ç”¨æ•°å€¼æ•°æ®è¿›è¡Œç»Ÿè®¡æ¨æ–­ã€‚æˆ‘ä»¬å°†ä»‹ç»ä¸¤ç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•ä¾èµ–äºè‡ªåŠ©æ³•ç¨‹åºï¼Œå¹¶æ’åˆ—åŸå§‹æ•°æ®é›†ä»¥åˆ›å»ºé¢å¤–çš„è‰ºæœ¯æ•°æ®é›†ï¼Œç„¶åå¯ä»¥ä½¿ç”¨è¿™äº›æ•°æ®é›†æ¥æ¨å¯¼ç½®ä¿¡åŒºé—´ã€‚ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨å¯¹è‡ªåŠ©æ³•æ ·æœ¬åˆ†å¸ƒçš„ç†è®ºå‡è®¾ï¼Œå¹¶ä¾èµ–äº t åˆ†å¸ƒæ¥å®ç°ç›¸åŒçš„ç»“æœã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•è¿›è¡Œ t æ£€éªŒã€æ¨å¯¼ç½®ä¿¡åŒºé—´ä»¥åŠè¿›è¡Œ**æ–¹å·®åˆ†æ**ï¼ˆ**ANOVA**ï¼‰ã€‚

å¦‚å‰æ‰€è¿°ï¼Œè‡ªåŠ©æ³•æ˜¯ä¸€ç§éå‚æ•°é‡é‡‡æ ·æ–¹æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä¼°è®¡ç‰¹å®šç»Ÿè®¡é‡çš„æŠ½æ ·åˆ†å¸ƒï¼Œä¾‹å¦‚å‡å€¼ã€ä¸­ä½æ•°æˆ–æ¯”ä¾‹ï¼Œå°±åƒä¸Šä¸€èŠ‚ä¸­é‚£æ ·ã€‚è¿™æ˜¯é€šè¿‡ä»åŸå§‹æ•°æ®ä¸­åå¤æœ‰æ”¾å›åœ°æŠ½å–éšæœºæ ·æœ¬æ¥å®ç°çš„ã€‚é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç½®ä¿¡åŒºé—´å¹¶æ‰§è¡Œå‡è®¾æ£€éªŒï¼Œè€Œä¸ä¾èµ–äºç‰¹å®šçš„åˆ†å¸ƒå‡è®¾ã€‚

æ­¤å¤–ï¼Œt åˆ†å¸ƒæ˜¯ä¸€ç§æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºåœ¨æ ·æœ¬é‡å°ä¸”æ€»ä½“æ•°æ®çš„æ ‡å‡†å·®æœªçŸ¥çš„æƒ…å†µä¸‹è¿›è¡Œå‡è®¾æ£€éªŒã€‚å®ƒæ˜¯ä¸€ç§æ›´é€šç”¨çš„æ–¹æ³•ï¼Œå‡è®¾é€šè¿‡è‡ªåŠ©æ³•å¾—åˆ°çš„æ ·æœ¬éµå¾ªç‰¹å®šçš„åˆ†å¸ƒã€‚ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªåˆ†å¸ƒæ¥ä¼°è®¡ç½®ä¿¡åŒºé—´å¹¶æ‰§è¡Œå‡è®¾æ£€éªŒã€‚

t æ£€éªŒæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç»Ÿè®¡æ£€éªŒæ–¹æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ¯”è¾ƒä¸¤ç»„æ•°æ®çš„å¹³å‡å€¼ï¼Œæˆ–è€…æ£€éªŒå•ä¸ªç»„æ•°æ®çš„å¹³å‡å€¼æ˜¯å¦ç­‰äºä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬çš„å…´è¶£åœ¨äºç»„æ•°æ®çš„å¹³å‡å€¼ï¼Œå› ä¸ºå˜é‡æ˜¯æ•°å€¼å‹çš„ã€‚è¯¥æ£€éªŒä¾èµ–äº t åˆ†å¸ƒï¼Œå¹¶è€ƒè™‘æ ·æœ¬å¤§å°ã€æ ·æœ¬å¹³å‡å€¼å’Œæ ·æœ¬æ–¹å·®ã€‚

ç½®ä¿¡åŒºé—´æä¾›äº†ä¸€ç»„å¯èƒ½çš„å€¼ï¼Œå…¶ä¸­çœŸå®çš„æ€»ä½“ç»Ÿè®¡é‡ï¼ˆå¦‚å‡å€¼æˆ–æ¯”ä¾‹ï¼‰å¾ˆå¯èƒ½ä½äºï¼Œå¹¶ä¸”å…·æœ‰æŒ‡å®šçš„ç½®ä¿¡æ°´å¹³ï¼ˆç”±æ˜¾è‘—æ€§æ°´å¹³Î±æŒ‡å®šï¼‰ã€‚

æœ€åï¼ŒANOVA åœ¨æ¯”è¾ƒå¤šäºä¸¤ç»„æ—¶æ‰©å±•äº† t æ£€éªŒçš„åº”ç”¨ã€‚ANOVA å¸®åŠ©æˆ‘ä»¬é€šè¿‡å°†è§‚å¯Ÿæ•°æ®çš„æ€»å˜å¼‚æ€§åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç»„é—´å˜å¼‚æ€§ä¸ç»„å†…å˜å¼‚æ€§ï¼Œæ¥ç¡®å®šç»„å‡å€¼ä¹‹é—´å¯èƒ½å­˜åœ¨çš„æ˜¾è‘—å·®å¼‚ã€‚å®ƒæ£€éªŒäº†æ‰€æœ‰ç»„å‡å€¼ç›¸ç­‰çš„é›¶å‡è®¾ã€‚å¦‚æœé›¶å‡è®¾è¢«æ‹’ç»ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¯†åˆ«å“ªäº›ç‰¹å®šçš„ç»„å‡å€¼å½¼æ­¤ä¸åŒã€‚

è®©æˆ‘ä»¬ä»ç”Ÿæˆä¸­ä½æ•°è‡ªåŠ©åˆ†å¸ƒå¼€å§‹ã€‚

## ç”Ÿæˆä¸­ä½æ•°è‡ªåŠ©åˆ†å¸ƒ

å¦‚å‰æ‰€è¿°ï¼Œå½“æ„å»ºå•ä¸ªç»Ÿè®¡é‡çš„è‡ªåŠ©åˆ†å¸ƒæ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡æœ‰æ”¾å›æŠ½æ ·ç”Ÿæˆä¸€ç³»åˆ—è‡ªåŠ©æ ·æœ¬ï¼Œç„¶åè®°å½•æ¯ä¸ªåˆ†å¸ƒçš„ç›¸å…³ç»Ÿè®¡é‡ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºä¸­ä½æ•°ï¼‰ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»ƒä¹ æ¥æ„å»ºè‡ªåŠ©æ ·æœ¬é›†åˆã€‚

### ç»ƒä¹  11.5 â€“ ç”Ÿæˆæ ·æœ¬ä¸­ä½æ•°çš„è‡ªåŠ©åˆ†å¸ƒ

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`infer`åŒ…åº”ç”¨ç›¸åŒçš„æŒ‡å®š-ç”Ÿæˆ-è®¡ç®—å·¥ä½œæµç¨‹ï¼Œä½¿ç”¨`mtcars`æ•°æ®é›†ç”Ÿæˆæ ·æœ¬ä¸­ä½æ•°çš„è‡ªåŠ©åˆ†å¸ƒã€‚

åŠ è½½`mtcars`æ•°æ®é›†å¹¶æŸ¥çœ‹å…¶ç»“æ„ï¼š

```py

data(mtcars)
>>> str(mtcars)
'data.frame':Â Â 32 obs. ofÂ Â 11 variables:
 $ mpg : numÂ Â 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : numÂ Â 6 6 4 6 8 6 8 4 4 6 ...
 $ disp: numÂ Â 160 160 108 258 360 ...
 $ hpÂ Â : numÂ Â 110 110 93 110 175 105 245 62 95 123 ...
 $ drat: numÂ Â 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wtÂ Â : numÂ Â 2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: numÂ Â 16.5 17 18.6 19.4 17 ...
 $ vsÂ Â : numÂ Â 0 0 1 1 0 1 0 1 1 1 ...
 $ amÂ Â : numÂ Â 1 1 1 0 0 0 0 0 0 0 ...
 $ gear: numÂ Â 4 4 4 3 3 3 3 4 4 4 ...
 $ carb: numÂ Â 4 4 1 1 2 1 4 2 2 4 ...
```

ç»“æœæ˜¾ç¤ºï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å« 32 è¡Œå’Œ 11 åˆ—çš„æ•°æ®é›†ã€‚åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`mpg`å˜é‡å¹¶ç”Ÿæˆå…¶ä¸­ä½æ•°çš„è‡ªåŠ©åˆ†å¸ƒï¼š

1.  æ ¹æ®å˜é‡`mpg`ç”Ÿæˆ 10,000 ä¸ªè‡ªåŠ©æ ·æœ¬å¹¶è·å–æ‰€æœ‰æ ·æœ¬çš„ä¸­ä½æ•°ï¼š

    ```py

    bs <- mtcars %>%
    Â Â specify(response = mpg) %>%
    Â Â generate(reps = 10000, type = "bootstrap") %>%
    Â Â calculate(stat = "median")
    >>> bs
    Response: mpg (numeric)
    # A tibble: 10,000 Ã— 2
    Â Â Â replicateÂ Â stat
    Â Â Â Â Â Â Â <int> <dbl>
     1Â Â Â Â Â Â Â Â Â 1Â Â 21.4
     2Â Â Â Â Â Â Â Â Â 2Â Â 22.2
     3Â Â Â Â Â Â Â Â Â 3Â Â 20.4
     4Â Â Â Â Â Â Â Â Â 4Â Â 17.8
     5Â Â Â Â Â Â Â Â Â 5Â Â 19.2
     6Â Â Â Â Â Â Â Â Â 6Â Â 19.2
     7Â Â Â Â Â Â Â Â Â 7Â Â 18.4
     8Â Â Â Â Â Â Â Â Â 8Â Â 20.4
     9Â Â Â Â Â Â Â Â Â 9Â Â 19.0
    10Â Â Â Â Â Â Â Â 10Â Â 21.4
    # â€¦ with 9,990 more rows
    # i Use `print(n = ...)` to see more rows
    ```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨`calculate()`å‡½æ•°ä¸­æŒ‡å®š`stat = "median"`ä»¥ä»æ¯ä¸ªè‡ªåŠ©æ ·æœ¬ä¸­æå–ä¸­ä½æ•°ã€‚

2. å°†è‡ªåŠ©åˆ†å¸ƒä½œä¸ºè‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡çš„å¯†åº¦æ›²çº¿è¿›è¡Œç»˜å›¾ï¼š

```py

ggplot(bs, aes(x = stat)) +
Â Â geom_density() +
Â Â labs(title = "Density plot for bootstrapped median", x = "Median", y = "Probability") +
Â Â theme(text = element_text(size = 16))
```

è¿è¡Œä»£ç ç”Ÿæˆ**å›¾ 11.14**.14 çš„å›¾è¡¨ã€‚

![å›¾ 11.14 â€“ å¯è§†åŒ–è‡ªåŠ©æ³•æ ·æœ¬ä¸­ä½æ•°çš„å¯†åº¦æ›²çº¿](img/B18680_11_014.jpg)

å›¾ 11.14 â€“ å¯è§†åŒ–è‡ªåŠ©æ³•æ ·æœ¬ä¸­ä½æ•°çš„å¯†åº¦æ›²çº¿

ä¸‹ä¸€èŠ‚å°†æ¢è®¨æ„å»ºè‡ªä¸¾ç½®ä¿¡åŒºé—´ã€‚

# æ„å»ºè‡ªä¸¾ç½®ä¿¡åŒºé—´

æˆ‘ä»¬å·²ç»æ¢è®¨äº†å¦‚ä½•ä½¿ç”¨æ ‡å‡†è¯¯å·®æ–¹æ³•æ„å»ºè‡ªä¸¾ç½®ä¿¡åŒºé—´ã€‚è¿™æ¶‰åŠåˆ°ä»è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡ä¸­æ·»åŠ å’Œå‡å»ç¼©æ”¾åçš„æ ‡å‡†è¯¯å·®ã€‚ç»“æœå‘ç°ï¼Œè¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•ï¼Œå®ƒä»…ä½¿ç”¨è‡ªä¸¾åˆ†å¸ƒçš„ç™¾åˆ†ä½æ•°æ¥è·å¾—ç½®ä¿¡åŒºé—´ã€‚

è®©æˆ‘ä»¬ç»§ç»­ä¹‹å‰çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦è®¡ç®—ä¹‹å‰è‡ªä¸¾åˆ†å¸ƒçš„ 95%ç½®ä¿¡åŒºé—´ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—è‡ªä¸¾åˆ†å¸ƒçš„ä¸Šé™å’Œä¸‹é™åˆ†ä½æ•°ï¼ˆåˆ†åˆ«ä¸º 97.5%å’Œ 2.5%ï¼‰æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ä¸‹é¢çš„ä»£ç å®ç°äº†è¿™ä¸€ç‚¹ï¼š

```py

>>> bs %>%
Â Â summarize(
Â Â Â Â l = quantile(stat, 0.025),
Â Â Â Â u = quantile(stat, 0.975)
Â Â )
# A tibble: 1 Ã— 2
Â Â Â Â Â Â lÂ Â Â Â Â u
Â Â <dbl> <dbl>
1Â Â 16.6Â Â 21.4
```

è®©æˆ‘ä»¬ä¹Ÿä½¿ç”¨æ ‡å‡†è¯¯å·®æ–¹æ³•è®¡ç®—è‡ªä¸¾ç½®ä¿¡åŒºé—´ï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼š

```py

SE = bs %>%
Â Â summarise(sd(stat)) %>%
Â Â pull()
observed_median = median(mtcars$mpg)
>>> c(observed_median - 2*SE, observed_median + 2*SE)
16.64783 21.75217
```

å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œç»“æœæ˜¯ä½¿ç”¨ç™¾åˆ†ä½æ•°æ–¹æ³•è·å¾—çš„ç»“æœç›¸è¿‘ã€‚ç„¶è€Œï¼Œæ ‡å‡†è¯¯å·®æ–¹æ³•æ¯”ç™¾åˆ†ä½æ•°æ–¹æ³•æ›´å‡†ç¡®ã€‚

ä¸‹ä¸€èŠ‚å°†ä»‹ç»åœ¨æµ‹è¯•é›¶å‡è®¾åé‡æ–°ä¸­å¿ƒåŒ–è‡ªä¸¾åˆ†å¸ƒã€‚

## é‡æ–°ä¸­å¿ƒåŒ–è‡ªä¸¾åˆ†å¸ƒ

ä¹‹å‰ç« èŠ‚ä¸­çš„è‡ªä¸¾åˆ†å¸ƒæ˜¯é€šè¿‡éšæœºæœ‰æ”¾å›æŠ½æ ·åŸå§‹æ•°æ®é›†ç”Ÿæˆçš„ã€‚æ¯ä¸€ç»„è‡ªä¸¾æ ·æœ¬ä¿æŒä¸åŸå§‹æ ·æœ¬é›†ç›¸åŒçš„å¤§å°ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨è¿™ä¸ªè‡ªä¸¾åˆ†å¸ƒè¿›è¡Œå‡è®¾æ£€éªŒã€‚

åœ¨å¼•å…¥é›¶å‡è®¾åï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„å‡è®¾æ£€éªŒéƒ¨åˆ†ä¸ºä¸¤ä¸ªåˆ†ç±»å˜é‡æ‰€åšçš„æ˜¯åœ¨é›¶å‡è®¾ä¸‹é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„è‡ªä¸¾åˆ†å¸ƒã€‚ç„¶åæˆ‘ä»¬å°†è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡ä½œä¸ºä¸€æ¡å‚ç›´çš„çº¢çº¿æ²¿ç€è‡ªä¸¾åˆ†å¸ƒæ”¾ç½®ï¼Œä»¥è®¡ç®— p å€¼ï¼Œè¡¨ç¤ºè‡³å°‘ä¸è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡ä¸€æ ·æç«¯çš„ç°è±¡å‘ç”Ÿçš„æ¦‚ç‡ã€‚å”¯ä¸€çš„é¢å¤–æ­¥éª¤æ˜¯ç”Ÿæˆé›¶å‡è®¾ä¸‹çš„è‡ªä¸¾åˆ†å¸ƒã€‚

åœ¨é›¶å‡è®¾ä¸‹ç”Ÿæˆè‡ªä¸¾æ ·æœ¬æ—¶ï¼Œä¸»è¦æ€æƒ³æ˜¯æ¶ˆé™¤æˆ‘ä»¬æ­£åœ¨æµ‹è¯•çš„æ•ˆæœå¹¶åˆ›å»ºæ ·æœ¬ï¼Œå‡è®¾é›¶å‡è®¾ä¸ºçœŸã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ ·æœ¬åº”è¯¥æ˜¯å¦‚æœæ²¡æœ‰ç»„é—´å·®å¼‚æ—¶é¢„æœŸçš„æ ·æœ¬ã€‚ä¾‹å¦‚ï¼Œå½“æ¯”è¾ƒä¸¤ç»„ä¹‹é—´çš„å‡å€¼æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿›è¡Œéšæœºæœ‰æ”¾å›æŠ½æ ·ä¹‹å‰ï¼Œä»æ¯ä¸ªè§‚å¯Ÿå€¼ä¸­å‡å»æ€»ä½“å‡å€¼ï¼Œä»¥å°†æ•°æ®ä¸­å¿ƒåœ¨ 0 å‘¨å›´ã€‚

æœ‰å¦ä¸€ç§å®ç°æ–¹å¼ã€‚å›æƒ³ä¸€ä¸‹ï¼ŒåŸå§‹çš„è‡ªåŠ©åˆ†å¸ƒï¼ŒæŒ‰ç…§è®¾è®¡ï¼Œæ˜¯å›´ç»•è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡ä¸­å¿ƒåŒ–çš„ã€‚åœ¨å¼•å…¥é›¶å‡è®¾åï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ç§»åŠ¨åŸå§‹è‡ªåŠ©åˆ†å¸ƒï¼Œä½¿å…¶å›´ç»•é›¶å‡è®¾ä¸­çš„ç»Ÿè®¡é‡ä¸­å¿ƒåŒ–ï¼Œå³é›¶å€¼ã€‚è¿™ä¸ªç§»åŠ¨åçš„è‡ªåŠ©åˆ†å¸ƒä»£è¡¨äº†å¦‚æœæˆ‘ä»¬ä»åŸå§‹æ•°æ®é›†ä¸­ç§»é™¤æ•ˆåº”å¹¶å†æ¬¡è¿›è¡Œè‡ªåŠ©æŠ½æ ·ï¼Œæˆ‘ä»¬å°†å¾—åˆ°çš„ç›¸åŒåˆ†å¸ƒã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å°†è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡æ”¾ç½®åœ¨ç§»åŠ¨åçš„è‡ªåŠ©åˆ†å¸ƒä¸Šï¼Œä»¥è®¡ç®—ç›¸åº”çš„ p å€¼ï¼Œè¿™ä»£è¡¨äº†ç”Ÿæˆè‡³å°‘ä¸å®é™…æ ·æœ¬ç»Ÿè®¡é‡ä¸€æ ·æœ‰åˆ©çš„æ ·æœ¬ç»Ÿè®¡é‡çš„æ¨¡æ‹Ÿæ¯”ä¾‹ã€‚*å›¾ 11.15* å±•ç¤ºäº†è¿™ä¸€è¿‡ç¨‹ã€‚

![å›¾ 11.15 â€“ å°†è‡ªåŠ©åˆ†å¸ƒç§»è‡³å›´ç»•é›¶å€¼ä¸­å¿ƒåŒ–](img/B18680_11_015.jpg)

å›¾ 11.15 â€“ å°†è‡ªåŠ©åˆ†å¸ƒç§»è‡³å›´ç»•é›¶å€¼ä¸­å¿ƒåŒ–

è®©æˆ‘ä»¬ä¸ºå‰ä¸€ä¸ªç¤ºä¾‹ç”Ÿæˆå‡è®¾æ£€éªŒçš„è‡ªåŠ©åˆ†å¸ƒã€‚æˆ‘ä»¬æƒ³è¦æµ‹è¯•`mpg`å˜é‡çš„æ€»ä½“ä¸­ä½æ•°ä¸º 16 çš„é›¶å‡è®¾ã€‚ä»¥ä¸‹ä»£ç ç”Ÿæˆäº†è‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡ï¼Œæˆ‘ä»¬åœ¨`hypothesize()`å‡½æ•°ä¸­é€šè¿‡`med = 16`æŒ‡å®šé›¶å€¼ï¼Œå¹¶é€šè¿‡`null = "point"`æŒ‡å®šç‚¹ä¼°è®¡ï¼š

```py

bs = mtcars %>%
Â Â specify(response = mpg) %>%
Â Â hypothesize(null = "point", med = 16) %>%
Â Â generate(reps = 10000, type = "bootstrap") %>%
Â Â calculate(stat = "median")
>>> bs
Response: mpg (numeric)
Null Hypothesis: point
# A tibble: 10,000 Ã— 2
Â Â Â replicateÂ Â stat
Â Â Â Â Â Â Â <int> <dbl>
 1Â Â Â Â Â Â Â Â Â 1Â Â 16
 2Â Â Â Â Â Â Â Â Â 2Â Â 16.2
 3Â Â Â Â Â Â Â Â Â 3Â Â 18
 4Â Â Â Â Â Â Â Â Â 4Â Â 16.2
 5Â Â Â Â Â Â Â Â Â 5Â Â 16
 6Â Â Â Â Â Â Â Â Â 6Â Â 16.2
 7Â Â Â Â Â Â Â Â Â 7Â Â 16
 8Â Â Â Â Â Â Â Â Â 8Â Â 16
 9Â Â Â Â Â Â Â Â Â 9Â Â 17.8
10Â Â Â Â Â Â Â Â 10Â Â 16
# â€¦ with 9,990 more rows
# i Use `print(n = ...)` to see more rows
```

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨å¯†åº¦å›¾ä¸­ç»˜åˆ¶è¿™äº›è‡ªåŠ©æ ·æœ¬ç»Ÿè®¡é‡ï¼ŒåŒæ—¶å°†è§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»Ÿè®¡é‡ä½œä¸ºå‚ç›´çº¢è‰²çº¿ï¼š

```py

ggplot(bs, aes(x = stat)) +
Â Â geom_density() +
Â Â geom_vline(xintercept = median(mtcars$mpg), color = "red") +
Â Â labs(title = "Density curve of bootstrapped median", x = "Sample median", y = "Density") +
Â Â theme(text = element_text(size = 16))
```

è¿è¡Œä»£ç ç”Ÿæˆäº†*å›¾ 11.16*ä¸­çš„å›¾ï¼Œå®ƒæ˜¾ç¤ºäº†ä¸€ä¸ªè¾ƒå°çš„ p å€¼ã€‚

![å›¾ 11.16 â€“ è‡ªåŠ©æ ·æœ¬ä¸­ä½æ•°å¯†åº¦å›¾å’Œè§‚å¯Ÿæ ·æœ¬ä¸­ä½æ•°ï¼ˆå‚ç›´çº¢è‰²çº¿ï¼‰](img/B18680_11_016.jpg)

å›¾ 11.16 â€“ è‡ªåŠ©æ ·æœ¬ä¸­ä½æ•°å’Œè§‚å¯Ÿæ ·æœ¬ä¸­ä½æ•°çš„å¯†åº¦å›¾ï¼ˆå‚ç›´çº¢è‰²çº¿ï¼‰

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»åŸºäº**ä¸­å¿ƒæé™å®šç†**ï¼ˆ**CLT**ï¼‰çš„å¦ä¸€ç§åŸºäºåˆ†å¸ƒçš„æ¨æ–­æ–¹æ³•ã€‚

# ä»‹ç»åœ¨ t åˆ†å¸ƒä¸­ä½¿ç”¨çš„ä¸­å¿ƒæé™å®šç†

CLTï¼ˆä¸­å¿ƒæé™å®šç†ï¼‰æŒ‡å‡ºï¼Œè®¸å¤šç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡çš„å’Œï¼ˆæˆ–å¹³å‡å€¼ï¼‰çš„åˆ†å¸ƒå°†å…±åŒå½¢æˆä¸€ä¸ªæ­£æ€åˆ†å¸ƒï¼Œæ— è®ºè¿™äº›ä¸ªåˆ«å˜é‡çš„æ½œåœ¨åˆ†å¸ƒå¦‚ä½•ã€‚ç”±äº CLTï¼Œæ­£æ€åˆ†å¸ƒå¸¸è¢«ç”¨æ¥è¿‘ä¼¼å„ç§ç»Ÿè®¡é‡çš„æŠ½æ ·åˆ†å¸ƒï¼Œä¾‹å¦‚æ ·æœ¬å‡å€¼å’Œæ ·æœ¬æ¯”ä¾‹ã€‚

åœ¨ç»Ÿè®¡æ¨æ–­çš„èƒŒæ™¯ä¸‹ï¼Œt åˆ†å¸ƒä¸ä¸­å¿ƒæé™å®šç†ï¼ˆCLTï¼‰ç›¸å…³ã€‚å½“æˆ‘ä»¬ä»æ ·æœ¬ä¸­ä¼°è®¡æ€»ä½“å‡å€¼æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸æ— æ³•è®¿é—®æ€»ä½“çš„çœŸå®æ ‡å‡†å·®ã€‚ç›¸åï¼Œæˆ‘ä»¬æ±‚åŠ©äºæ ·æœ¬æ ‡å‡†å·®ä½œä¸ºä¼°è®¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ·æœ¬å‡å€¼çš„æŠ½æ ·åˆ†å¸ƒä¸éµå¾ªæ­£æ€åˆ†å¸ƒï¼Œè€Œæ˜¯ t åˆ†å¸ƒã€‚æ¢å¥è¯è¯´ï¼Œå½“æˆ‘ä»¬ä»ä¸€ç»„è§‚å¯Ÿåˆ°çš„æ ·æœ¬ä¸­æå–æ ·æœ¬å‡å€¼ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸ç¡®å®šæ€»ä½“æ ‡å‡†å·®ï¼ˆåœ¨å®é™…æ•°æ®å·¥ä½œä¸­è¿™ç§æƒ…å†µå¾ˆå¸¸è§ï¼‰ï¼Œæ ·æœ¬å‡å€¼å¯ä»¥å»ºæ¨¡ä¸º t åˆ†å¸ƒçš„ä¸€ä¸ªå®ç°ã€‚

t åˆ†å¸ƒæ˜¯ä¸€æ—è¿ç»­æ¦‚ç‡åˆ†å¸ƒï¼Œå®ƒä»¬æ˜¯å¯¹ç§°çš„ã€é’Ÿå½¢çš„ï¼Œè¿™æ˜¾ç¤ºäº†ä¸æ­£æ€åˆ†å¸ƒçš„ç›¸ä¼¼æ€§ã€‚ç„¶è€Œï¼Œt åˆ†å¸ƒçš„å°¾éƒ¨æ›´åšï¼Œè¿™è§£é‡Šäº†ç”±äºä»è§‚å¯Ÿæ•°æ®ä¸­ä¼°è®¡æ€»ä½“æ ‡å‡†å·®è€Œäº§ç”Ÿçš„æ›´å¤§ä¸ç¡®å®šæ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œt åˆ†å¸ƒçš„è§‚æµ‹å€¼æ›´æœ‰å¯èƒ½è½å…¥è¿œç¦»å‡å€¼çš„å°¾éƒ¨ï¼ˆä¾‹å¦‚ï¼Œè¿œç¦»å‡å€¼çš„ä¸¤ä¸ªæ ‡å‡†å·®ä¹‹å¤–ï¼‰ï¼Œè€Œæ­£æ€åˆ†å¸ƒåˆ™ä¸ç„¶ã€‚t åˆ†å¸ƒçš„å½¢çŠ¶ä¾èµ–äº**è‡ªç”±åº¦**ï¼ˆ**df**ï¼‰ï¼Œè¿™å–å†³äºæ ·æœ¬å¤§å°å¹¶å†³å®šäº†å°¾éƒ¨çš„åšåº¦ã€‚éšç€æ”¶é›†åˆ°æ›´å¤šæ ·æœ¬ï¼Œdf å¢åŠ ï¼Œt åˆ†å¸ƒé€æ¸é€¼è¿‘æ­£æ€åˆ†å¸ƒã€‚

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬ç®€è¦ä»‹ç»äº†ç”¨äºåœ¨ t åˆ†å¸ƒä¸‹æ‰¾åˆ°æˆªæ–­å€¼çš„`qt()`å‡½æ•°ã€‚ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»ƒä¹ æ¥æ›´ç†Ÿæ‚‰ä¸ t åˆ†å¸ƒç›¸å…³çš„è®¡ç®—ã€‚

### ç»ƒä¹  11.6 â€“ ç†è§£ t åˆ†å¸ƒ

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`pt()`å‡½æ•°æ¥æ‰¾åˆ° t åˆ†å¸ƒä¸‹çš„æ¦‚ç‡ã€‚å¯¹äºç»™å®šçš„æˆªæ–­åˆ†ä½æ•°å€¼`q`å’Œç»™å®šçš„`df`ï¼Œ`pt(q, df)`å‡½æ•°ç»™å‡ºäº†`t`å°äº`q`çš„ t åˆ†å¸ƒä¸‹`df`çš„æ¦‚ç‡ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æœ‰ P(t df < T) = `pt(q = T, df)`ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨`qt()`å‡½æ•°æ¥æ‰¾åˆ° t åˆ†å¸ƒä¸‹ç‰¹å®šæ¦‚ç‡çš„åˆ†ä½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ P(t df < T) = pï¼Œé‚£ä¹ˆ T = `qt(p, df)`ï¼š

1.  æ‰¾åˆ°åœ¨ t åˆ†å¸ƒä¸‹ï¼Œè‡ªç”±åº¦ä¸º 10 ä¸”ä½äº`T=3`çš„æ¦‚ç‡ï¼š

    ```py

    x = pt(3, df = 10)
    >>> x
    0.9933282
    ```

1.  æ‰¾åˆ°åœ¨ t åˆ†å¸ƒä¸‹ï¼Œè‡ªç”±åº¦ä¸º 10 ä¸”`T=3`ä»¥ä¸Šçš„æ¦‚ç‡ï¼š

    ```py

    y = 1 - x
    >>> y
    0.006671828
    ```

    æ³¨æ„ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—åœ¨ t åˆ†å¸ƒä¸‹ä½äºç‰¹å®šæˆªæ–­å€¼çš„æ¦‚ç‡ï¼Œç„¶åå–è¡¥æ•°ä»¥æ‰¾åˆ°é«˜äºé˜ˆå€¼çš„æ¦‚ç‡ã€‚

1.  æ‰¾åˆ°åœ¨ t åˆ†å¸ƒä¸‹ï¼Œè‡ªç”±åº¦ä¸º`100`ä¸”`T=3`ä»¥ä¸Šçš„æ¦‚ç‡ï¼š

    ```py

    z = 1 - pt(3, df = 100)
    >>> z
    0.001703958
    ```

    ç”±äº`df=100`æ¯”`df=10`æ›´æ¥è¿‘æ­£æ€åˆ†å¸ƒï¼Œå› æ­¤å¾—åˆ°çš„æ¦‚ç‡`z`å› æ­¤æ¯”`y`å°ã€‚

1.  æ‰¾åˆ°å…·æœ‰ 10 ä¸ªè‡ªç”±åº¦çš„ t åˆ†å¸ƒçš„ 95 ç™¾åˆ†ä½æ•°ï¼š

    ```py

    d = qt(0.95, df = 10)
    >>> d
    1.812461
    ```

1.  æ‰¾åˆ°ç•Œå®šä¸­é—´ 95 ç™¾åˆ†ä½æ•°ä¸Šé™çš„ t åˆ†å¸ƒçš„æˆªæ–­å€¼ï¼Œè¯¥åˆ†å¸ƒå…·æœ‰`10`ä¸ªè‡ªç”±åº¦ï¼š

    ```py

    e = qt(0.975, df = 10)
    >>> e
    2.228139
    ```

    è¿™é‡Œï¼Œä¸­é—´ 95 ç™¾åˆ†ä½æ•°çš„ä¸Šé™æŒ‡çš„æ˜¯ 97.5 ç™¾åˆ†ä½æ•°ã€‚

1.  æ‰¾åˆ°ç”¨`100`è‡ªç”±åº¦ï¼ˆdfï¼‰ç•Œå®š t åˆ†å¸ƒä¸­é—´ 95%ç™¾åˆ†ä½ä¸Šé™çš„æˆªæ–­å€¼ï¼š

    ```py

    f = qt(0.975, df = 100)
    >>> f
    1.983972
    ```

ä¸‹ä¸€èŠ‚å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ t åˆ†å¸ƒæ¥æ„å»ºæ€»ä½“å‡å€¼çš„ç½®ä¿¡åŒºé—´ã€‚

# æ„å»ºä½¿ç”¨ t åˆ†å¸ƒçš„æ€»ä½“å‡å€¼ç½®ä¿¡åŒºé—´

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å¯¹æ€»ä½“å‡å€¼è¿›è¡Œç»Ÿè®¡æ¨æ–­çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ä»ä¸€ä¸ªæœ‰é™çš„æ ·æœ¬å¼€å§‹ï¼Œä»è¿™ä¸ªæ ·æœ¬ä¸­æˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºæ ·æœ¬å‡å€¼ã€‚ç”±äºæˆ‘ä»¬æƒ³è¦ä¼°è®¡æ€»ä½“å‡å€¼ï¼Œæˆ‘ä»¬å¸Œæœ›åŸºäºè§‚å¯Ÿåˆ°çš„æ ·æœ¬å‡å€¼è¿›è¡Œç»Ÿè®¡æ¨æ–­ï¼Œå¹¶é‡åŒ–æ€»ä½“ç»Ÿè®¡é‡å¯èƒ½å­˜åœ¨çš„èŒƒå›´ã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¸­æ˜¾ç¤ºçš„å¹³å‡æ¯åŠ ä»‘è‹±é‡Œæ•°ï¼Œåœ¨`mtcars`æ•°æ®é›†ä¸­å¤§çº¦æ˜¯ 20ã€‚

```py

>>> mean(mtcars$mpg)
20.09062
```

ç»™å‡ºè¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬ä¸ä¼šå¯¹é‡åˆ°å¦ä¸€ä¸ªå…·æœ‰å¹³å‡`mpg`ä¸º 19 æˆ– 21 çš„ç±»ä¼¼æ•°æ®é›†æ„Ÿåˆ°æƒŠè®¶ã€‚ç„¶è€Œï¼Œå¦‚æœå€¼æ˜¯ 5ã€50ï¼Œç”šè‡³ 100ï¼Œæˆ‘ä»¬å°±ä¼šæ„Ÿåˆ°æƒŠè®¶ã€‚åœ¨è¯„ä¼°æ–°çš„æ ·æœ¬é›†åˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥é‡åŒ–æ ·æœ¬å‡å€¼åœ¨å¤šä¸ªæ ·æœ¬ä¸­çš„å˜å¼‚æ€§ã€‚æˆ‘ä»¬å·²ç»å­¦ä¹ äº†ä¸¤ç§æ–¹æ³•æ¥åšè¿™ä»¶äº‹ï¼šä½¿ç”¨è‡ªåŠ©æ³•æ¥æ¨¡æ‹Ÿäººå·¥æ ·æœ¬æˆ–ä½¿ç”¨ä¸­å¿ƒæé™å®šç†æ¥è¿‘ä¼¼è¿™ç§å˜å¼‚æ€§ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨ä¸­å¿ƒæé™å®šç†æ–¹æ³•ã€‚

æ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼Œä»»ä½•æŠ½æ ·åˆ†å¸ƒçš„æ ·æœ¬å‡å€¼å°†å¤§è‡´å‘ˆæ­£æ€åˆ†å¸ƒï¼Œæ— è®ºåŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æƒ…å†µï¼š

_Â xÂ  âˆ¼ N(mean = Î¼, SE = Â ÏƒÂ _Â âˆšÂ _Â nÂ Â )

æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬æ— æ³•è·å¾—çš„ç†è®ºåˆ†å¸ƒã€‚ä¾‹å¦‚ï¼Œæ€»ä½“æ ‡å‡†å·®Ïƒä¿æŒæœªçŸ¥ï¼Œæˆ‘ä»¬åªèƒ½è·å¾—è§‚å¯Ÿåˆ°çš„æ ·æœ¬ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ ·æœ¬æ ‡å‡†å·® s æ¥ä¼°è®¡æ ‡å‡†è¯¯å·®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

_Â xÂ  âˆ¼ N(mean = Î¼, SE = Â sÂ _Â âˆšÂ _Â nÂ Â )

ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ n - 1 ä¸ªè‡ªç”±åº¦çš„ t åˆ†å¸ƒæ¥è¿›è¡Œå¯¹æ€»ä½“å‡å€¼çš„æ¨æ–­ï¼Œå› ä¸ºå®ƒç”±äº s å¼•å…¥çš„é¢å¤–ä¸ç¡®å®šæ€§è€Œå…·æœ‰æ›´åšçš„å°¾éƒ¨ã€‚

æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œä½¿ç”¨ä¸­å¿ƒæé™å®šç†ï¼ˆCLTï¼‰çš„è¿‘ä¼¼ä¾èµ–äºå‡ ä¸ªå‡è®¾ã€‚ä¾‹å¦‚ï¼Œæ ·æœ¬ä¹‹é—´éœ€è¦ç›¸äº’ç‹¬ç«‹ã€‚å½“æ ·æœ¬æ˜¯éšæœºé€‰æ‹©çš„æ—¶å€™ï¼Œæˆ–è€…å¦‚æœæ ·æœ¬åœ¨æ— æ›¿æ¢çš„æƒ…å†µä¸‹é€‰å–ä¸”å æ€»äººå£çš„ä¸åˆ° 10%ï¼Œè¿™é€šå¸¸å¯ä»¥å¾—åˆ°æ»¡è¶³ã€‚æ ·æœ¬å¤§å°ä¹Ÿéœ€è¦æ›´å¤§ï¼Œä»¥ä¾¿è€ƒè™‘æ ·æœ¬ä¸­å¯èƒ½å­˜åœ¨çš„ååº¦ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`t.test()`å‡½æ•°æ¥æ„å»º 95%ç½®ä¿¡åŒºé—´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```py

# Construct 95% CI for avg mpg
>>> t.test(mtcars$mpg)
Â Â One Sample t-test
data:Â Â mtcars$mpg
t = 18.857, df = 31, p-value < 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 17.91768 22.26357
sample estimates:
mean of x
 20.09062
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨è¿›è¡Œå•æ ·æœ¬ t æ£€éªŒï¼Œå…¶ä¸­é»˜è®¤çš„é›¶å‡è®¾æ˜¯æ€»ä½“å‡å€¼ä¸º 0ã€‚ç»“æœæ˜¾ç¤ºä¸€ä¸ªéå¸¸å°çš„ p å€¼ï¼Œè¿™è¡¨æ˜æˆ‘ä»¬å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼Œæ”¯æŒå¤‡æ‹©å‡è®¾ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ€»ä½“å‡å€¼ä¸æ˜¯ 0ã€‚95%ç½®ä¿¡åŒºé—´ï¼ˆåœ¨`17.91768`å’Œ`22.26357`ä¹‹é—´ï¼‰ä¹Ÿæ˜¯åŸºäºå…·æœ‰`31`ä¸ª df å’Œ`t ç»Ÿè®¡é‡`ä¸º`18.857`çš„ t åˆ†å¸ƒæ„å»ºçš„ã€‚

ä¸‹ä¸€èŠ‚å›é¡¾äº†ä½¿ç”¨è‡ªä¸¾æ¨¡æ‹Ÿå’Œ t æ£€éªŒè¿‘ä¼¼è¿›è¡Œä¸¤ä¸ªå‡å€¼å‡è®¾æ£€éªŒçš„è¿‡ç¨‹ã€‚

# å¯¹ä¸¤ä¸ªå‡å€¼è¿›è¡Œå‡è®¾æ£€éªŒ

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä½¿ç”¨å‡è®¾æ£€éªŒæ¯”è¾ƒä¸¤ä¸ªæ ·æœ¬å‡å€¼çš„è¿‡ç¨‹ã€‚åœ¨æ¯”è¾ƒä¸¤ä¸ªæ ·æœ¬å‡å€¼æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ç¡®å®šä¸¤ä¸ªä¸åŒæ€»ä½“æˆ–ç»„ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾è‘—çš„å·®å¼‚ã€‚

å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ ·æœ¬ç»„ã€‚è¿™ä¸¤ç»„æ ·æœ¬å¯ä»¥ä»£è¡¨æ¯ä¸ªæ ·æœ¬åœ¨å¤„ç†å‰åçš„ç‰¹å®šå€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ¯”è¾ƒè¿™ä¸¤ç»„æ ·æœ¬çš„æ ·æœ¬ç»Ÿè®¡é‡ï¼Œä¾‹å¦‚æ ·æœ¬å‡å€¼ï¼Œå¹¶ç¡®å®šæ²»ç–—æ˜¯å¦æœ‰å½±å“ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªä¸¾æ¨¡æ‹Ÿæˆ– t æ£€éªŒè¿‘ä¼¼æ¥æ‰§è¡Œå‡è®¾æ£€éªŒï¼Œä»¥æ¯”è¾ƒä¸¤ä¸ªç‹¬ç«‹åˆ†å¸ƒçš„å‡å€¼ã€‚

åœ¨å‡è®¾æ£€éªŒä¸­ä½¿ç”¨ t æ£€éªŒæ¯”è¾ƒä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬çš„å‡å€¼æ—¶ï¼ŒåŒæ ·æœ¬ t æ£€éªŒå‡è®¾æ•°æ®å‘ˆæ­£æ€åˆ†å¸ƒï¼Œå¹¶ä¸”ä¸¤ä¸ªæ€»ä½“çš„æ–¹å·®ç›¸ç­‰ã€‚ç„¶è€Œï¼Œåœ¨è¿™äº›å‡è®¾å¯èƒ½ä¸æˆç«‹çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é‡‡ç”¨æ›¿ä»£çš„éå‚æ•°æ£€éªŒæˆ–é‡é‡‡æ ·æ–¹æ³•ï¼Œå¦‚è‡ªä¸¾ï¼Œæ¥å¯¹æ€»ä½“å‡å€¼è¿›è¡Œæ¨æ–­ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»ƒä¹ æ¥çœ‹çœ‹è¿™ä¸¤ç§å‡è®¾æ£€éªŒæ–¹æ³•æ˜¯å¦‚ä½•åº”ç”¨çš„ã€‚

### ç»ƒä¹  11.7 â€“ æ¯”è¾ƒä¸¤ä¸ªå‡å€¼

åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä¸¤ç§æ–¹æ³•ï¼ˆt æ£€éªŒå’Œè‡ªä¸¾ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ ·æœ¬å‡å€¼å¹¶è®¡ç®—æ ·æœ¬å‡å€¼å·®å¼‚çš„ç½®ä¿¡åŒºé—´ï¼š

1.  ç”Ÿæˆä¸€ä¸ªç”±ä¸¤ç»„æ ·æœ¬ç»„æˆçš„è™šæ‹Ÿæ•°æ®é›†ï¼š

    ```py

    # Define two samples
    sample1 = c(10, 12, 14, 16, 18)
    sample2 = c(15, 17, 19, 21, 23)
    # Combine samples into a data frame
    data = tibble(
    Â Â value = c(sample1, sample2),
    Â Â group = factor(rep(c("Group 1", "Group 2"), each = length(sample1)))
    )
    >>> data
    # A tibble: 10 Ã— 2
    Â Â Â value group
    Â Â Â <dbl> <fct>
     1Â Â Â Â 10 Group 1
     2Â Â Â Â 12 Group 1
     3Â Â Â Â 14 Group 1
     4Â Â Â Â 16 Group 1
     5Â Â Â Â 18 Group 1
     6Â Â Â Â 15 Group 2
     7Â Â Â Â 17 Group 2
     8Â Â Â Â 19 Group 2
     9Â Â Â Â 21 Group 2
    10Â Â Â Â 23 Group 2
    ```

    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª`tibble`æ•°æ®æ¡†ï¼Œå…¶ä¸­`value`åˆ—è¡¨ç¤ºæ ·æœ¬è§‚æµ‹å€¼ï¼Œ`group`åˆ—è¡¨ç¤ºç»„å·ã€‚æˆ‘ä»¬å¸Œæœ›è¯„ä¼°è¿™ä¸¤ç»„æ ·æœ¬ä¹‹é—´æ ·æœ¬å‡å€¼çš„å·®å¼‚ã€‚

1.  è¿›è¡Œ 1000 æ¬¡è‡ªä¸¾æŠ½æ ·ï¼Œå¹¶åœ¨ä»¥ä¸‹å‡è®¾ä¸‹è®¡ç®—è‡ªä¸¾ç»Ÿè®¡é‡ï¼šè¿™ä¸¤ä¸ªç»„ç›¸äº’ç‹¬ç«‹ï¼Œå®ƒä»¬çš„å‡å€¼æ²¡æœ‰å·®å¼‚ï¼š

    ```py

    bootstrap_results = data %>%
    Â Â specify(response = value, explanatory = group) %>%
    Â Â hypothesize(null = "independence") %>%
    Â Â generate(reps = 1000, type = "bootstrap") %>%
    Â Â calculate(stat = "diff in means", order = c("Group 1", "Group 2"))
    >>> bootstrap_results
    Response: value (numeric)
    Explanatory: group (factor)
    Null Hypothesis: independence
    # A tibble: 1,000 Ã— 2
    Â Â Â replicateÂ Â stat
    Â Â Â Â Â Â Â <int> <dbl>
     1Â Â Â Â Â Â Â Â Â 1 -7.5
     2Â Â Â Â Â Â Â Â Â 2 -6.17
     3Â Â Â Â Â Â Â Â Â 3 -5
     4Â Â Â Â Â Â Â Â Â 4 -2.20
     5Â Â Â Â Â Â Â Â Â 5 -8.05
     6Â Â Â Â Â Â Â Â Â 6 -4.2
     7Â Â Â Â Â Â Â Â Â 7 -3.5
     8Â Â Â Â Â Â Â Â Â 8 -6.67
     9Â Â Â Â Â Â Â Â Â 9 -4.2
    10Â Â Â Â Â Â Â Â 10 -6.90
    # â€¦ with 990 more rows
    # i Use `print(n = ...)` to see more rows
    ```

    åœ¨è¿™é‡Œï¼Œå‡è®¾æ£€éªŒçš„ç®¡é“é¦–å…ˆé€šè¿‡æŒ‡å®šå“åº”å˜é‡ï¼ˆ`value`ï¼‰å’Œè§£é‡Šå˜é‡ï¼ˆ`group`ï¼‰ï¼Œè®¾ç½®é›¶å‡è®¾ï¼Œåœ¨é›¶å‡è®¾ä¸‹ç”Ÿæˆè‡ªä¸¾æ ·æœ¬ï¼Œç„¶åè®¡ç®—æ¯ä¸ªè‡ªä¸¾æ ·æœ¬çš„æ£€éªŒç»Ÿè®¡é‡ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å‡å€¼å·®å¼‚ï¼‰ã€‚é›¶å‡è®¾è¡¨æ˜æˆ‘ä»¬å‡è®¾ä¸¤ç»„çš„æ ·æœ¬å‡å€¼å€¼æ¥è‡ªåŒä¸€æ€»ä½“ï¼Œå¹¶ä¸”ä»»ä½•è§‚å¯Ÿåˆ°çš„å·®å¼‚ä»…ä»…æ˜¯å¶ç„¶çš„ã€‚

1.  æ ¹æ®è‡ªä¸¾ç»Ÿè®¡é‡è®¡ç®—ç½®ä¿¡åŒºé—´ï¼š

    ```py

    ci = bootstrap_results %>%
    Â Â filter(!is.na(stat)) %>%
    Â Â get_confidence_interval(level = 0.95, type = "percentile")
    >>> ci
    # A tibble: 1 Ã— 2
    Â Â lower_ci upper_ci
    Â Â Â Â Â <dbl>Â Â Â Â <dbl>
    1Â Â Â Â Â Â Â -9Â Â Â Â -1.17
    ```

1.  ä½¿ç”¨`t.test()`å‡½æ•°è¿›è¡ŒåŒæ ·æœ¬ t æ£€éªŒï¼š

    ```py

    t_test_result = t.test(sample1, sample2)
    >>> t_test_result
    Â Â Â Welch Two Sample t-test
    data:Â Â sample1 and sample2
    t = -2.5, df = 8, p-value = 0.03694
    alternative hypothesis: true difference in means is not equal to 0
    95 percent confidence interval:
     -9.6120083 -0.3879917
    sample estimates:
    mean of x mean of y
    Â Â Â Â Â Â Â 14Â Â Â Â Â Â Â Â 19
    ```

    ç»“æœæ˜¾ç¤ºï¼ŒåŸºäº t åˆ†å¸ƒçš„ 95%ç½®ä¿¡åŒºé—´æ¥è¿‘ä½†ä»ç„¶ä¸é€šè¿‡è‡ªä¸¾æŠ½æ ·è·å¾—çš„ç»“æœä¸åŒã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä¼ é€’æ¨¡å‹å½¢å¼æ¥è¿›è¡Œ t æ£€éªŒï¼š

    ```py
    t_test_result2 = t.test(value ~ group, data = data)
    >>> t_test_result2
    Â Â Â Â Welch Two Sample t-test
    data:Â Â value by group
    t = -2.5, df = 8, p-value = 0.03694
    alternative hypothesis: true difference in means between group Group 1 and group Group 2 is not equal to 0
    95 percent confidence interval:
     -9.6120083 -0.3879917
    sample estimates:
    mean in group Group 1 mean in group Group 2
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 14Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 19
    ```

ä¸‹ä¸€èŠ‚ä»‹ç»äº†æ–¹å·®åˆ†æï¼ˆANOVAï¼‰ã€‚

# ä»‹ç»æ–¹å·®åˆ†æï¼ˆANOVAï¼‰

**ANOVA**æ˜¯ä¸€ç§ç”¨äºæ¯”è¾ƒä¸¤ä¸ªä»¥ä¸Šç»„å‡å€¼çš„ç»Ÿè®¡å‡è®¾æ£€éªŒæ–¹æ³•ï¼Œå®ƒæ‰©å±•äº†ä¸Šä¸€èŠ‚è®¨è®ºçš„åŒæ ·æœ¬ t æ£€éªŒã€‚ANOVA çš„ç›®æ ‡æ˜¯åœ¨è€ƒè™‘æ¯ä¸ªç»„å†…çš„å˜å¼‚æ€§ï¼ˆç»„å†…å˜å¼‚æ€§ï¼‰çš„åŒæ—¶ï¼Œæµ‹è¯•ç»„å‡å€¼ä¹‹é—´æ˜¯å¦å­˜åœ¨æ½œåœ¨çš„æ˜¾è‘—å·®å¼‚ï¼ˆç»„é—´å˜å¼‚æ€§ï¼‰ã€‚

ANOVA åœ¨å‡è®¾æ£€éªŒä¸­ä¾èµ–äº F ç»Ÿè®¡é‡ã€‚F ç»Ÿè®¡é‡æ˜¯ä¸¤ä¸ªæ–¹å·®ä¼°è®¡å€¼çš„æ¯”ç‡ï¼šç»„é—´æ–¹å·®å’Œç»„å†…æ–¹å·®ã€‚ç»„é—´æ–¹å·®è¡¡é‡ç»„å‡å€¼ä¹‹é—´çš„å·®å¼‚ï¼Œè€Œç»„å†…æ–¹å·®è¡¨ç¤ºæ¯ä¸ªç»„å†…çš„å˜å¼‚æ€§ã€‚F ç»Ÿè®¡é‡å¯ä»¥æ ¹æ®è¿™ä¸¤ä¸ªç»„æ–¹å·®è®¡ç®—å¾—å‡ºã€‚

åœ¨å‡è®¾æ£€éªŒä¸­ï¼Œæ–¹å·®åˆ†æï¼ˆANOVAï¼‰çš„é›¶å‡è®¾æŒ‡å‡ºæ‰€æœ‰ç»„å‡å€¼ç›¸ç­‰ï¼Œä»»ä½•è§‚å¯Ÿåˆ°çš„å·®å¼‚éƒ½æ˜¯ç”±äºå¶ç„¶æ€§é€ æˆçš„ã€‚å¦ä¸€æ–¹é¢ï¼Œå¤‡æ‹©å‡è®¾åˆ™è¡¨æ˜è‡³å°‘æœ‰ä¸€ä¸ªç»„çš„å‡å€¼ä¸å…¶ä»–ç»„ä¸åŒã€‚å¦‚æœ F ç»Ÿè®¡é‡è¶³å¤Ÿå¤§ï¼Œç»„é—´æ–¹å·®æ˜¾è‘—å¤§äºç»„å†…æ–¹å·®ï¼Œè¿™ä¸ºåå¯¹é›¶å‡è®¾æä¾›äº†è¯æ®ã€‚

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚æˆ‘ä»¬é¦–å…ˆåŠ è½½`PlantGrowth`æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†åŒ…å«æ¤ç‰©ç»è¿‡ä¸‰ç§ä¸åŒå¤„ç†åé‡é‡ï¼š

```py

data(PlantGrowth)
>>> str(PlantGrowth)
'data.frame':Â Â Â 30 obs. ofÂ Â 2 variables:
 $ weight: numÂ Â 4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 3 levels "ctrl","trt1",..: 1 1 1 1 1 1 1 1 1 1 ...
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„æŒ‡å®š-å‡è®¾-ç”Ÿæˆ-è®¡ç®—ç¨‹åºæ‰§è¡Œå•å› ç´  ANOVA æµ‹è¯•ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬é¦–å…ˆæŒ‡å®šå“åº”å˜é‡ï¼ˆ`é‡é‡`ï¼‰å’Œè§£é‡Šå˜é‡ï¼ˆ`ç»„åˆ«`ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`hypothesize(null = "ç‹¬ç«‹æ€§")`å»ºç«‹é›¶å‡è®¾ï¼Œå³å„ç»„å‡å€¼æ²¡æœ‰å·®å¼‚ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨`generate(reps = 1000, type = "permute")`ç”Ÿæˆ 1,000 ä¸ªæ’åˆ—æ•°æ®é›†ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`calculate(stat = "F")`è®¡ç®—æ¯ä¸ªæ’åˆ—æ•°æ®é›†çš„ F ç»Ÿè®¡é‡ï¼š

```py

anova_results = PlantGrowth %>%
Â Â specify(response = weight, explanatory = group) %>%
Â Â hypothesize(null = "independence") %>%
Â Â generate(reps = 1000, type = "permute") %>%
Â Â calculate(stat = "F")
>>> anova_results
Response: weight (numeric)
Explanatory: group (factor)
Null Hypothesis: independence
# A tibble: 1,000 Ã— 2
Â Â Â replicateÂ Â stat
Â Â Â Â Â Â Â <int> <dbl>
 1Â Â Â Â Â Â Â Â Â 1 0.162
 2Â Â Â Â Â Â Â Â Â 2 0.198
 3Â Â Â Â Â Â Â Â Â 3 1.18
 4Â Â Â Â Â Â Â Â Â 4 0.328
 5Â Â Â Â Â Â Â Â Â 5 1.21
 6Â Â Â Â Â Â Â Â Â 6 3.00
 7Â Â Â Â Â Â Â Â Â 7 1.93
 8Â Â Â Â Â Â Â Â Â 8 0.605
 9Â Â Â Â Â Â Â Â Â 9 0.446
10Â Â Â Â Â Â Â Â 10 1.10
# â€¦ with 990 more rows
# i Use `print(n = ...)` to see more rows
```

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è§‚å¯Ÿåˆ°çš„ F ç»Ÿè®¡é‡å’Œä»æ’åˆ—æ•°æ®é›†ä¸­è·å¾—çš„ F ç»Ÿè®¡é‡åˆ†å¸ƒæ¥è®¡ç®— p å€¼ã€‚å½“ p å€¼å°äºé¢„è®¾çš„æ˜¾è‘—æ€§æ°´å¹³ï¼ˆä¾‹å¦‚ï¼Œ`0.05`ï¼‰æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼Œå¹¶è¯´å„ç»„å‡å€¼ä¹‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼š

```py

p_value = anova_results %>%
Â Â get_p_value(obs_stat = anova_results, direction = "right") %>%
Â Â pull()
>>> p_value
0.376
```

ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡å¿ƒæ‹’ç»é›¶å‡è®¾ã€‚

# æ‘˜è¦

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ç”¨äºå‡è®¾æ£€éªŒçš„ä¸åŒç±»å‹çš„ç»Ÿè®¡æ¨æ–­ï¼Œé’ˆå¯¹æ•°å€¼æ•°æ®å’Œåˆ†ç±»æ•°æ®ã€‚æˆ‘ä»¬ä»‹ç»äº†å•å˜é‡ã€åŒå˜é‡å’Œå¤šå˜é‡çš„æ¨æ–­æ–¹æ³•ï¼Œä½¿ç”¨æ¯”ä¾‹ï¼ˆç”¨äºåˆ†ç±»å˜é‡ï¼‰æˆ–å‡å€¼ï¼ˆç”¨äºæ•°å€¼å˜é‡ï¼‰ä½œä¸ºæ ·æœ¬ç»Ÿè®¡é‡ã€‚å‡è®¾æ£€éªŒç¨‹åºï¼ŒåŒ…æ‹¬åŸºäºæ¨¡å‹è¿‘ä¼¼çš„æ–¹æ³•å’ŒåŸºäºè‡ªåŠ©æ³•æ¨¡æ‹Ÿçš„éå‚æ•°æ–¹æ³•ï¼Œæä¾›äº†å¦‚ç½®ä¿¡åŒºé—´å’Œ p å€¼ç­‰æœ‰ä»·å€¼çš„å·¥å…·ã€‚è¿™äº›å·¥å…·ä½¿æˆ‘ä»¬èƒ½å¤Ÿåšå‡ºå†³å®šï¼Œæ˜¯å¦å¯ä»¥æ‹’ç»åŸå‡è®¾è€Œæ¥å—å¤‡æ‹©å‡è®¾ã€‚è¿™æ ·çš„å†³å®šä¹Ÿä¸ç¬¬ä¸€ç±»å’Œç¬¬äºŒç±»é”™è¯¯ç›¸å…³ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æœ€å¹¿æ³›ä½¿ç”¨çš„ç»Ÿè®¡å’Œæœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹ä¸€ï¼šçº¿æ€§å›å½’ã€‚
