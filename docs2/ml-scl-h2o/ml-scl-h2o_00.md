# 前言

在当前这个时间点，**机器学习**（**ML**）几乎无需介绍：它对商业、非营利组织和科学组织都具有普遍性和变革性。机器学习建立在数据之上。我们所有人都意识到每年收集的数据呈指数级增长，以及生成这些数据的来源日益多样化。这本书是关于利用这些海量数据量来进行机器学习的。我们称之为*大规模机器学习*，并在三个支柱上对其进行定义：在大型到海量数据集上构建高质量模型，在多样化的企业环境中部署它们进行评分，以及在过程中解决多个利益相关者的关注点。在这里，规模考虑了数据量和企业环境、模型构建和模型部署。在这本书中，我们将以实际的方式向你展示 H2O 如何克服执行大规模机器学习的许多挑战。

本书从对大规模执行机器学习挑战的概述开始，以及 H2O 框架如何克服这些挑战，同时产生高质量的模型和企业级部署。然后，它过渡到使用 H2O 在规模上的高级模型构建技术和模型部署模式。接着，我们从多个需要理解、部署和维护该系统的企业利益相关者的角度，探讨其技术基础，并展示这与数据科学家活动和需求的关系。最后，我们展示了如何将 H2O 在规模上独立实施或作为功能丰富的大型 H2O AI 云平台的一部分，在那里它承担着令人兴奋的新水平的机器学习可能性和商业价值。

在阅读完这本书之后，你将获得构建高质量可解释机器学习模型所需的知识，这些模型可以从海量数据集中构建，部署到各种企业系统中，并组装最先进的机器学习解决方案，实现独特的商业价值。

# 这本书面向谁

这本书是为数据科学家、机器学习工程师、系统管理员、企业架构师以及想要使用 H2O 大规模构建和部署机器学习模型的充满好奇心的技术人员所写的。那些已经熟悉 H2O 的人将学习高级模型构建技术和部署模式，以及 H2O 内部工作原理的细节。对于机器学习有一定了解但工作经验很少或没有的学生，将了解它在大企业世界中的实施方式。建议具备基本的机器学习知识，并且需要理解 Python 以跟随代码示例。

# 这本书涵盖的内容

*第一章*，*机遇与挑战*，为本书设定了背景。我们将首先围绕三个领域定义大规模机器学习（ML）：在大到巨量数据集上构建高质量模型，在多样化的企业环境中部署它们进行评分，以及在过程中解决多个利益相关者的关注点。然后，我们将认识到在这个背景下机器学习的巨大商业机会和执行挑战。在这种情况下，您将了解到 H2O 如何通过其**H2O-3**、**Sparkling Water**、**Enterprise Steam**和**MOJO**技术克服这些挑战，这些技术构成了 H2O at Scale 框架。

*第二章*，*平台组件和关键概念*，通过描述每个组件在机器学习生命周期中的位置、其关键特性和如何克服大规模机器学习的挑战来概述每个 H2O 组件。然后，我们从概述中提炼出几个关键概念。本章的目标是在您学习如何实现它之前，为您提供 H2O at Scale 如何工作的基础知识。

*第三章*，*基本工作流程 – 数据到可部署模型*，展示了使用 H2O at Scale 框架构建和部署模型所需的最小步骤。将其视为一个带有每个步骤解释的`Hello World`示例。您有其他实现这些步骤的替代方案，它们将会被探讨。在本书的这个阶段，我们将结束一般概述并转向高级主题。

*第四章*，*大规模 H2O 模型构建 – 能力阐述*，开始了我们的模型构建重点，主要对数据科学家感兴趣。在本章中，我们熟悉了 H2O 广泛的建模能力，从数据摄取和处理到算法、模型训练、评估和可解释性技术。将本章视为 H2O 模型构建的“是什么”，而下一章将深入探讨“如何”和“为什么”。

*第五章*，*高级模型构建 – 第一部分*，介绍了数据科学家在构建企业级模型时考虑的高级模型构建主题。我们讨论了数据拆分选项，比较了建模算法，提出了用于超参数优化的两阶段网格搜索策略，介绍了 H2O AutoML，它能够自动将多个算法拟合到数据中，并探讨了用于提高模型性能的特征工程选项。到本章结束时，您应该能够使用 H2O 中可用的一个或多个监督学习算法构建一个企业规模、优化和预测模型。

*第六章*, *高级模型构建 – 第二部分*，通过展示如何在 Apache Spark 管道内构建 H2O 监督学习模型，继续我们的高级模型构建主题。我们回顾了 H2O 的无监督学习方法，讨论了更新 H2O 模型的最佳实践，并介绍了确保 H2O 模型可重复性的要求。

*第七章*, *理解机器学习模型*，概述了 H2O 中用于解释机器学习模型的一组功能。构建一个预测效果好的模型是不够的。在将任何模型投入生产之前，理解它是如何做出决策的至关重要。我们讨论了选择合适的模型度量标准，使用多种诊断方法来建立对模型的信任，以及使用全局和局部解释与模型性能指标相结合来从一组候选模型中选择最佳模型。这包括对模型性能、评分速度和候选模型中满足的假设之间的权衡进行评估。

*第八章*, *整合一切*，以大多数数据科学项目的方式开始：从原始数据和一般业务目标开始。我们精炼数据和问题陈述，使其与业务相关，并且可以用可用数据回答。我们设计各种特征，创建和评估多个候选模型，直到我们得到一个最终模型。我们评估最终模型，并说明了模型部署所需的准备步骤。本章的处理方式准确地反映了企业中数据科学家的职责。

*第九章*, *生产评分和 H2O MOJO*，开始关注模型部署。机器学习工程师、企业架构师、软件开发人员和一般技术人员将特别关注本章。您将熟悉 H2O MOJO 作为评分工件的优势，以及它如何轻松地部署到各种企业系统中。您将通过编写一个批处理文件评分程序来结束，该程序嵌入了一个 MOJO 以展示这种灵活性。

*第十章*, *H2O 模型部署模式*，探讨了 MOJO 可以部署的多种方式。您将首先概述各种可能的部署模式，然后深入到每个模式的实现细节。这些模式涵盖了在多种专门的 H2O 评分软件、第三方集成以及您自己的定制系统中进行实时流评分和批处理评分。

*第十一章*, *管理员和操作视图*，以 H2O 在规模上的企业利益相关者的视角开始关注机器学习。尽管专注于企业利益相关者的活动和关注点，但数据科学家将了解它们如何与自己的活动相关。在本章中，系统管理员和操作员将详细了解如何配置企业 Steam，以及如何确保用户的安全和管理，以便数据科学家可以以受控的方式自行提供环境。我们还将确定围绕维护和故障排除 H2O 工作负载和组件的操作活动。

*第十二章*, *企业架构师和安全视图*，涵盖了 H2O at Scale 组件的企业架构师和安全视角。您将详细了解 H2O 的实施替代方案以及组件如何集成、通信和部署。您将看到 H2O at Scale 框架可以独立部署，也可以作为更大规模的**H2O AI Cloud**的一部分进行部署，我们将在下一章中介绍。

*第十三章*, *介绍 H2O AI Cloud*，概述了 H2O.ai 的全端到端机器学习生命周期平台。H2O at Scale 框架和本书至今所涵盖的一切都是 H2O AI Cloud 的一个较小子集。在本章中，我们将概述 H2O AI 组件及其关键特性，包括四个专门的**模型构建引擎**、一个功能齐全的**MLOps**和**特征存储**，以及一个开源的低代码 SDK，用于构建和集成**AI 应用**并在**应用商店**上托管它们。

*第十四章*, *在大平台环境中的大规模 H2O*，通过总结我们所学的一切，展示了当 H2O at Scale 框架作为 H2O AI Cloud 的一部分使用时，获得了全新的和令人兴奋的可能性。我们提供了这些可能性的示例，然后展示了一个使用 H2O 的参考企业集成框架，以便您想象自己的可能性。

*附录*, *启动 H2O 集群的替代方法*，展示了您可以使用不同的方式创建 H2O 环境来运行本书中的代码示例。

# 要充分利用本书

要运行代码示例，您需要设置一个 H2O 环境。*附录*展示了三种实现方式，并描述了软件版本。

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误。**

从概念上讲，我们在介绍广泛的机器学习概念之前，再介绍 H2O 如何实现它们。因此，您应该能够从您对机器学习的更广泛理解框架中理解书中的讨论。

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件，网址为 [`github.com/PacktPublishing/Machine-Learning-at-Scale-with-H2O`](https://github.com/PacktPublishing/Machine-Learning-at-Scale-with-H2O)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包，可在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 获取。查看它们吧！

# 下载彩色图片

我们还提供了一份包含本书中使用的截图和图表的彩色 PDF 文件。您可以从这里下载：[`packt.link/sDmtM`](https://packt.link/sDmtM)。

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`：表示文本中的代码词汇、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“`h2o.explain` 和 `h2o.explain_row` 方法分别捆绑了一组用于全局和局部解释的可解释性函数和可视化。”

代码块设置如下：

```py
from pysparkling import *
```

```py
import h2o
```

```py
hc = H2Ocontext.getOrCreate()
```

```py
hc
```

任何命令行输入或输出都应如下所示：

```py
PYSPARK_DRIVER_PYTHON="ipython" \
PYSPARK_DRIVER_PYTHON_OPTS="notebook" \
bin/pysparkling
```

**粗体**：表示新术语、重要词汇或您在屏幕上看到的词汇。例如，菜单或对话框中的词汇以**粗体**显示。以下是一个示例：“在 Flow 的**管理员**菜单下，前三个选项是**作业**、**集群状态**和**水表**。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

`customercare@packtpub.com` 并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们非常感谢您能向我们报告。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

`copyright@packt.com` 并附上材料链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

读完 *Machine Learning at Scale with H2O* 后，我们非常乐意听到您的想法！请点击此处直接进入此书的亚马逊评论页面并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。
