# 前言

近年来，机器学习获得了极大的普及。GPT-3 和 4 等大型语言模型的引入加速了这一领域的发展。这些大型语言模型变得如此强大，以至于在本地计算机上训练它们几乎是不可能的。然而，这根本不是必要的。这些语言模型提供了创建新工具的能力，而无需训练它们，因为它们可以通过上下文窗口和提示来引导。

在这本书中，我的目标是展示如何训练、评估和测试机器学习模型——无论是在小型原型还是在完整软件产品中。这本书的主要目标是弥合机器学习在软件工程中的理论知识与实践应用之间的差距。它旨在使你具备理解、有效实施并在你的职业追求中创新 AI 和机器学习技术的技能。

将机器学习融入软件工程的旅程既令人兴奋又充满挑战。当我们深入研究机器学习基础设施的复杂性时，这本书充当了一本全面的指南，帮助软件工程师穿越复杂性和最佳实践，这些对于软件工程师至关重要。它旨在弥合机器学习的理论方面与在现实场景实施中面临的实际挑战之间的差距。

我们首先探讨机器学习的根本概念，为那些新进入该领域的人提供坚实的基础。随着我们的进展，焦点转向基础设施——任何成功机器学习项目的支柱。从数据收集和处理到模型训练和部署，每一步都至关重要，需要仔细考虑和规划。

书中很大一部分内容致力于最佳实践。这些实践不仅仅是理论上的指导方针，而是源自我的研究团队在这个领域工作中发现的真实经验和案例研究。这些最佳实践为处理常见陷阱和确保机器学习系统的可扩展性、可靠性和效率提供了无价的见解。

此外，我们深入探讨了数据和机器学习算法的伦理问题。我们研究了机器学习伦理背后的理论，更深入地探讨了数据和模型许可，最后，探讨了可以量化机器学习中数据和模型偏见的实际框架。

这本书不仅仅是一本技术指南；它是一次穿越软件工程中机器学习演变景观的旅程。无论你是渴望学习的初学者，还是寻求提升技能的资深专业人士，这本书旨在成为一项宝贵的资源，为机器学习这个充满活力且不断变化的领域提供清晰的方向。

# 本书面向的对象

本书精心制作，旨在为寻求在他们的领域中应用人工智能和机器学习实际应用的软件工程师、计算机科学家和程序员提供帮助。内容旨在传授关于与机器学习模型一起工作的基础知识，通过程序员的视角和系统架构师的视角来审视。

本书假设读者对编程原则有所了解，但并不要求在数学或统计学方面有专业知识。这种做法确保了软件开发领域的更广泛的专业人士和爱好者能够接触本书。对于那些没有 Python 先前经验的读者，本书需要掌握语言的基本理解。然而，材料结构旨在帮助快速全面地掌握 Python 的基本知识。相反，对于那些精通 Python 但尚未在专业编程方面有所经验的人，本书作为过渡到以 AI 和 ML 应用为重点的软件工程领域的宝贵资源。

# 本书涵盖的内容

*第一章*，*机器学习与传统软件的比较*，探讨了这两种类型的软件系统最适用的情况。我们了解了程序员用来创建这两种类型软件的软件开发过程，以及我们学习了经典的四种机器学习软件类型 – 基于规则的、监督的、无监督的和强化学习。最后，我们还了解了数据在传统和机器学习软件中的不同作用。

*第二章*，*机器学习系统要素*，回顾了专业机器学习系统的每个要素。我们首先了解哪些要素是重要的以及为什么重要。然后，我们探讨如何创建这些要素以及如何通过将它们组合成一个单一的机器学习系统（所谓的机器学习管道）来工作。

*第三章*，*软件系统中的数据 – 文本、图像、代码和特征*，介绍了三种数据类型 – 图像、文本和格式化文本（程序源代码）。我们探讨了每种类型的数据如何在机器学习中使用，它们应该如何标注以及用于什么目的。引入这三种类型的数据为我们提供了探索不同标注这些数据来源方式的可能性。

*第四章*，*数据获取、数据质量和噪声*，深入探讨了与数据质量相关的话题。我们介绍了一个评估数据质量的理论模型，并提供了实施它的方法和工具。我们还探讨了机器学习中的噪声概念以及如何通过不同的标记化方法来减少它。

*第五章*，*量化并改进数据属性*，深入探讨了数据的属性以及如何改进它们。与上一章相比，我们专注于特征向量而不是原始数据。特征向量已经是数据的一种转换；因此，我们可以改变诸如噪声之类的属性，甚至改变数据被感知的方式。我们专注于文本的处理，这是当今许多机器学习算法的一个重要部分。我们首先理解如何使用简单的算法，如词袋模型，将数据转换为特征向量，以便我们可以在特征向量上工作。

*第六章*，*机器学习系统中数据处理*，深入探讨了数据和算法相互交织的方式。我们经常用通用术语谈论数据，但在这章中，我们解释了机器学习系统中需要哪种类型的数据。我们解释了所有类型的数据都是以数值形式使用的——要么作为特征向量，要么作为更复杂的特征矩阵。然后，我们将解释将非结构化数据（例如文本）转换为结构化数据的必要性。本章将为深入探讨每种类型的数据奠定基础，这是下一章几章的内容。

*第七章*，*数值和图像数据的特征工程*，专注于数值和图像数据的特征工程过程。我们首先回顾了典型的方法，例如**主成分分析**（**PCA**），我们之前曾用它进行可视化。然后，我们转向更高级的方法，如**t-Student 分布随机网络嵌入**（**t-SNE**）和**独立成分分析**（**ICA**）。最终，我们使用自动编码器作为数值和图像数据的降维技术。

*第八章*，*自然语言数据的特征工程*，探讨了使变换器（GPT）技术如此强大的第一步——从自然语言数据中提取特征。自然语言是软件工程中的一种特殊数据源。随着 GitHub Copilot 和 ChatGPT 的引入，变得明显的是，用于软件工程任务的机器学习和人工智能工具不再是科幻。

*第九章*，*机器学习系统类型 – 基于特征和原始数据（深度学习）*，探讨了不同类型的机器学习系统。我们从经典的机器学习模型，如随机森林开始，然后转向卷积和 GPT 模型，这些被称为深度学习模型。它们的名称来源于它们使用原始数据作为输入，并且模型的第一层包括特征提取层。它们也被设计为随着输入数据通过这些模型而逐步学习更抽象的特征。本章展示了这些模型类型，并从经典机器学习进展到生成式 AI 模型。

*第十章*，*经典机器学习系统和神经网络的训练与评估*，对训练和评估过程进行了更深入的探讨。我们首先介绍不同算法背后的基本理论，然后展示它们是如何被训练的。我们从经典的机器学习模型开始，以决策树为例，然后逐渐转向深度学习，探索密集神经网络和一些更高级的网络类型。

*第十一章*，*高级机器学习算法的训练与评估 – GPT 和自编码器*，探讨了基于 GPT 和双向编码器表示转换器（BERT）的生成式 AI 模型的工作原理。这些模型被设计为根据它们训练的模式生成新的数据。我们还探讨了自编码器的概念，其中我们训练一个自编码器根据之前训练的数据生成新的图像。

*第十二章*，*设计机器学习管道及其测试*，描述了 MLOps 的主要目标是弥合数据科学和运维团队之间的差距，促进协作，并确保机器学习项目能够有效地和可靠地在规模上部署。MLOps 有助于自动化和优化整个机器学习生命周期，从模型开发到部署和维护，从而提高生产中机器学习系统的效率和效果。在本章中，我们学习如何在实践中设计和操作机器学习系统。本章展示了如何将管道转化为一个软件系统，重点关注测试 ML 管道及其在 Hugging Face 的部署。

*第十三章*，*设计和实现大规模、健壮的机器学习软件*，解释了如何将机器学习模型与用 Gradio 编写的图形用户界面和数据库中的存储集成。我们使用两个机器学习管道的例子 – 来自我们之前章节的预测缺陷的模型示例和一个生成式 AI 模型，用于根据自然语言提示创建图片。

*第十四章*，*数据获取与管理中的伦理问题*，首先探讨了几个不道德的系统示例，这些系统表现出偏见，例如惩罚某些少数群体的信用评级系统。我们还解释了使用开源数据和揭露受试者身份的问题。然而，本章的核心是对数据管理和软件系统伦理框架的解释和讨论，包括 IEEE 和 ACM 的行为准则。

*第十五章*，*机器学习系统中的伦理问题*，重点关注机器学习系统中的偏见。我们首先探讨了偏见来源，并简要讨论了这些来源。然后，我们探讨了如何发现偏见，如何最小化它们，最后，如何向我们的系统用户传达潜在的偏见。

*第十六章*，*在生态系统中集成机器学习系统*，解释了如何将机器学习系统打包成 Web 服务，使我们能够以非常灵活的方式将它们集成到工作流程中。我们不必编译或使用动态链接库，而可以部署通过 HTTP 协议使用 JSON 协议进行通信的机器学习组件。实际上，我们已经在使用 OpenAI 托管的 GPT-3 模型时看到了如何使用该协议。在本章中，我们探讨了创建自己的带有预训练机器学习模型的 Docker 容器，部署它，并将其与其他组件集成的可能性。

*第十七章*，*总结与下一步行动*，回顾了所有最佳实践，并按章节进行了总结。此外，我们还探讨了机器学习和人工智能的未来可能给软件工程带来的影响。

# 为了充分利用本书

在这本书中，我们使用 Python 和 PyTorch，因此您需要在您的系统上安装这两个软件。我在 Windows 和 Linux 上使用过它们，但它们也可以在 Google Colab 或 GitHub Codespaces（两者都已测试过）这样的云环境中使用**。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.11 | Windows，Ubuntu，Debian Linux 或 Windows Subsystem for Linux (WSL) |
| PyTorch 2.1 | Windows, Ubuntu 或 Debian Linux |

**如果您正在使用这本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误**。

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件：[`github.com/PacktPublishing/Machine-Learning-Infrastructure-and-Best-Practices-for-Software-Engineers`](https://github.com/PacktPublishing/Machine-Learning-Infrastructure-and-Best-Practices-for-Software-Engineers)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有来自我们丰富的书籍和视频目录的其他代码包可供选择，请访问[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。查看它们！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“模型本身是在 model = LinearRegression()这一行上面创建的。”

代码块设置如下：

```py
def fibRec(n):
  if n < 2:
      return n
  else:
      return fibRec(n-1) + fibRec(n-2)
```

任何命令行输入或输出都按以下方式编写：

```py
>python app.py
```

最佳实践

看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**总体反馈**：如果您对本书的任何方面有任何疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现错误，我们将不胜感激，如果您能向我们报告，请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，我们将不胜感激，如果您能提供位置地址或网站名称，请通过 copyright@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《软件工程师的机器学习基础设施和最佳实践》，我们非常乐意听到您的想法！请[点击此处直接进入本书的亚马逊评论页面](https://packt.link/r/1-837-63406-8)并分享您的反馈。

您的评论对我们和科技社区都至关重要，并将帮助我们确保提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢随时随地阅读，但又无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地点、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯以及每天收件箱中的精彩免费内容。

按照以下简单步骤获取优惠：

1.  扫描二维码或访问以下链接

![下载本书的免费 PDF 副本](img/B19548_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83763-406-4`](https://packt.link/free-ebook/978-1-83763-406-4)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他福利发送到您的邮箱
