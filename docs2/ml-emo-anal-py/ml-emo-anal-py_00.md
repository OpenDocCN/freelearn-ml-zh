# 前言

在数字通信已成为我们生活重要组成部分的现代时代，理解和分析通过文本表达的情感已经变得极其重要。从社交媒体平台和客户反馈到聊天机器人和虚拟助手，从书面语言中解码情感的能力已经成为一项宝贵的技能。

这本书是你探索这个迷人领域的门户，为你提供掌握利用 Python 解开人类情感复杂织锦的必要知识和实用技能。无论你是数据科学家、开发者、研究人员，还是对语言与情感的交汇点感到好奇的人，这本书都将作为你的全面指南。

在整本书中，我们将揭示情感背后的理论和技巧。我们探索的核心是 Python，这是一种多才多艺且功能强大的编程语言，广泛用于数据分析，**自然语言处理**（**NLP**）。

在这本书中，我们将逐步建立我们的理解，从 NLP 和情感表示的基础开始。然后，我们将探索特征提取、情感分析和情感分类的各种技术。你将学习如何预处理文本数据，训练机器学习模型，并在情感分析背景下评估它们的性能。此外，我们将深入研究更高级的主题，如处理多标签数据和探索深度学习方法，并研究一个涉及收集了长期推文的案例研究，展示它们如何与真实世界事件相关联。我们还将研究在一个数据集上训练的模型应用于另一个数据集时的鲁棒性。

然而，这本书并不仅仅关注理论概念。这里有大量的实际例子来加强你的理解，并使你能够应用你所学的知识。Python 代码片段和真实世界的数据集将引导你从头开始实现情感分析系统，赋予你开发自己创新解决方案的能力。

在这本书结束时，你将拥有情感分析坚实的基础，并能够利用 Python 的广泛生态系统构建复杂的情感感知应用。你将能够导航文本中表达的情感的细微差别，揭示评论和评论背后的隐藏情感，并开发有洞察力的解决方案。

无论你对客户反馈分析、社交媒体监控或虚拟助手技术中情感分析的可能性感到好奇，这本书都将为你提供知识和技能，通过 Python 解锁丰富的情感世界。

# 这本书面向的对象

这本书是为那些对探索语言、情感和技术交汇点充满热情的人设计的。无论你是数据科学家、Python 开发者、研究人员还是好奇的爱好者，这本书都会满足你的兴趣，并提供你进入情感分析所需的必要知识和技能。

即使你没有数据科学或编程背景，只是对情感和语言的复杂性感到好奇，这本书也会为你提供全面的基础和实践指导，帮助你有效地探索和应用情感分析技术。

# 本书涵盖的内容

*第一章*, *基础*，介绍了情感和情绪，并讨论了为什么它们很重要。它还介绍了自然语言处理和机器学习。

*第二章*, *构建和使用数据集*，概述了数据集。它从现成的数据源开始，然后展示如何创建自己的数据。接下来的部分列出了其他一些可用的免费数据集，描述了如何将数据集转换为适合你的任务，并演示了即使是非英语数据集也可以被使用。最后，本章涵盖了评估技术。

*第三章*, *标注数据*，概述了标注：为什么它很重要，最佳实践，以及如何进行标注。本章还将解释黄金推文，如何评估标注者的适用性，如何构建标注系统，以及是否购买标注工具更好。最后，它讨论了结果，如何衡量其可靠性，以及为什么在任务结束时对标注者进行反馈是个好主意。

*第四章*, *预处理 – 词干提取、分词和解析*，概述了最有可能对情感挖掘有用的工具，并探讨了分词、标注和解析。

*第五章*, *情感词典和向量空间模型*，概述了我们在下一章开发各种算法时将使用的数据集和指标。它还考虑了仅基于情感词典的非常简单的分类器。最后，它探讨了如何计算单个单词表达情感的程度，从而为观察后续章节中更复杂算法的性能提供基准。

*第六章*, *朴素贝叶斯*，概述了如何为 Python `sklearn`包准备数据集。然后简要介绍了朴素贝叶斯方法，并展示了如何实现它。最后，它考虑了为什么算法会这样表现，以及我们可以做些什么来提高其性能。

*第七章*，*支持向量机*，介绍了支持向量机及其在分类中的应用。它还介绍了一些改进方法，以便与多类数据集一起工作，并最终反思了获得的结果。

*第八章*，*神经网络和深度神经网络*，概述了单层神经网络及其作为分类器的应用，以及将其扩展到多层神经网络及其作为分类器的应用。

*第九章*，*探索 Transformer*，介绍了 Transformer 及其核心组件。它还涵盖了 Hugging Face 和现有模型，并最终展示了如何使用 Python 构建基于 Transformer 的模型。

*第十章*，*多分类器*，概述了使用混淆矩阵分析分类器在复杂数据上的行为，以及如何使用中性标签处理未分配标签的推文。最后，它讨论了处理多标签数据集的阈值变化，以及训练多个分类器来处理多标签数据集。

*第十一章*，*案例研究 – 卡塔尔封锁*，讨论了当我们的分类器应用于现实生活中的真实数据时会发生什么，这些数据未经精心整理，我们没有黄金标准，而且这些数据也不是我们训练分类器的数据。最后，它将分类器在收集了较长时间的数据上的输出与正在进行的新闻报道中的事件进行比较，以查看情绪模式的变化是否可以与故事的发展联系起来，以及是否可以检测到公众态度的长期变化以及针对关键事件的即时反应。 

# 为了充分利用本书

为了充分受益于本书，建议您具备 Python 编程的基本知识。在 NLP 或机器学习方面没有背景知识也是可以的，因为本书从头开始涵盖了基本概念和技术。我们将逐步介绍并解释与情感分析相关的 NLP 和机器学习概念，确保具有不同背景的读者能够跟上并掌握材料。您需要安装`scipy`和`sklearn`库，以及 Hugging Face 的`transformers`和`datasets`包、`pandas`、`numpy`，以及用于*第九章*，*探索 Transformer*的`google.colab`库。

| **本书中使用的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python | Windows、macOS X 和 Linux（任何） |
| Hugging Face 的`transformers`和`datasets`包、`pandas`和`numpy` |  |
| Google Colab 库 |  |
| 用于朴素贝叶斯、支持向量机和深度神经网络的`sklearn`包 |  |

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub（[`github.com/PacktPublishing/Machine-Learning-for-Emotion-Analysis`](https://github.com/PacktPublishing/Machine-Learning-for-Emotion-Analysis)）下载本书的示例代码文件。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的书籍和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

重要提示

我们使用多个数据集来训练和评估模型：其中一些允许无限制使用，但有些则附带条件或许可证，说明您只能用于非商业目的。GitHub 仓库中的代码描述了您可以从哪里获取这些数据集；在下载和使用我们的代码示例之前，您必须同意每个数据集指定的条件。我们特别感谢 Saif Mohammed 允许我们使用 SEMEVAL-2017 和 SEMEVAL-2018 竞赛的数据集。如果您想使用这些数据集中的任何一个，请承认提供者，如果您使用了任何 SEMEVAL 数据，那么请引用以下内容：

Mohammad, S. M.，& Bravo-Marquez, F. (2017). WASSA-2017 情感强度共享任务。*《计算方法在主观性、情感和社会媒体分析（WASSA）研讨会论文集》*。

Mohammad, S. M.，Bravo-Marquez, F.，Salameh, M.，& Kiritchenko, S. (2018). SemEval-2018 任务 1：推文中的情感。*《国际语义评估研讨会（SemEval-2018）论文集》*。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“`feedparser`是一个与所有已知格式的 feed 一起工作的 Python 库。”

代码块设置如下：

```py
import pandas as pddata_file_path = "EI-reg-En-anger-train.txt"
df = pd.read_csv(data_file_path, sep='\t')
# drop rows where the emotion is not strong
df[df['Intensity Score'] <= 0.2]
```

任何命令行输入或输出都按以下方式编写：

```py
pip install feedparser
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“为您的应用程序命名，并记下**API 密钥**、**API 密钥密钥**和**Bearer 令牌**值。”

小贴士或重要提示

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件 customercare@packtpub.com 联系我们，并在邮件主题中提及书名。

**勘误**: 尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

**盗版**: 如果您在互联网上以任何形式发现我们作品的非法副本，如果您能向我们提供位置地址或网站名称，我们将不胜感激。请通过 copyright@packtpub.com 联系我们，并提供材料的链接。

**如果您有兴趣成为作者**: 如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com.](http://authors.packtpub.com.)

# 分享您的想法

一旦您阅读了《Python 中的情感分析机器学习》，我们非常乐意听到您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1-803-24068-7)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但又无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何时间、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止这些，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接

![](img/B18714_QR_Free_PDF.jpg)

https://packt.link/free-ebook/9781803240688

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件。

# 第一部分：基础知识

本部分介绍了**自然语言处理**（**NLP**）、**情感分析**（**SA**）和**情感分析**（**EA**）。您将了解 SA 和 EA 背后的基本概念，为什么以及它们是如何不同的，以及为什么 EA 如此具有挑战性。还将介绍一些将要使用的工具。本部分还将探讨其他多情感分类方法，并从心理学的角度讨论情感。最后，将讨论 EA 的重要性、其好处和用途。

本部分包含以下章节：

+   *第一章*，*基础*
