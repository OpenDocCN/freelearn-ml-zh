# 前言

> “软件正在吞噬世界，但 AI 将吞噬软件。”
> 
> —— 英伟达首席执行官黄仁勋

**机器学习**（**ML**），作为更广泛的**人工智能**（**AI**）领域的一部分，正合理地被认为是组织从其数据中提取价值的最强大工具之一。随着机器学习算法能力的逐年增长，越来越明显的是，以可扩展、容错和自动化的方式实施这些算法需要创建新的学科。这些学科，**机器学习工程**（**MLE**）和**机器学习运维**（**MLOps**），正是本书的重点。

本书涵盖了广泛的主题，旨在帮助您了解可以应用于构建您的机器学习解决方案的工具、技术和流程，并着重介绍关键概念，以便您可以在未来的工作中在此基础上进行构建。目标是发展基础知识和广泛的理解，这些知识和理解能够经受时间的考验，而不仅仅是提供一系列对最新工具的介绍，尽管我们确实涵盖了大量的最新工具！

所有代码示例均以 Python 编写，这是当时世界上最流行的编程语言（撰写本文时）和数据应用的**通用语言**。Python 是一种高级面向对象的编程语言，拥有丰富的数据科学和机器学习工具生态系统。例如，*scikit-learn*和*pandas*等包已经成为全球数据科学团队的标准化词汇。本书的核心原则是，仅了解如何使用这些包是不够的。在这本书中，我们将使用这些工具以及许多其他工具，但重点是如何将它们封装到生产级管道中，并使用适当的云和开源工具进行部署。

我们将涵盖从如何组织您的机器学习团队，到软件开发方法和最佳实践，再到通过自动化模型构建，以及如何将您的机器学习管道部署到各种不同的目标，然后到如何扩展您的工作负载以进行大规模批量运行。我们还将讨论，在第二版新增的全新章节中，将机器学习工程和 MLOps 应用于深度学习和生成式 AI 的激动人心的世界，包括如何开始使用**大型语言模型**（**LLMs**）构建解决方案以及新的**LLM 运维**（**LLMOps**）领域。

《使用 Python 进行机器学习工程》的第二版在几乎每一章都比第一版深入得多，包括更新的示例和更多对核心概念的分析。涵盖的工具种类也更加广泛，对开源工具和开发的关注也更多。虽然仍然强调核心概念，但我希望这种更广阔的视角意味着第二版将成为那些希望获得机器学习工程实用知识的人的优秀资源。

虽然对使用开源工具的重视程度更高，但许多示例也将利用来自亚马逊网络服务（AWS）的服务和解决方案。我相信，然而，伴随的解释和讨论将意味着您可以将这里学到的所有内容应用到任何云提供商，甚至是在本地环境中。

*使用 Python 进行机器学习工程*，*第二版*将帮助您应对将 ML 投入生产的挑战，并让您有信心开始在项目中应用 MLOps。我希望您会喜欢它！

# 本书面向的对象

这本书是为那些希望使用机器学习组件构建稳健软件解决方案的机器学习工程师、数据科学家和软件开发人员而写的。它也适用于管理或希望了解这些系统生产生命周期的人。本书假设读者具备中级 Python 知识，并对机器学习的基本概念有所了解。一些 AWS 的基本知识和 bash 或 zsh 等 Unix 工具的使用也将有所帮助。

# 本书涵盖的内容

*第一章*，*机器学习工程简介*，解释了机器学习工程和机器学习操作的核心概念。详细讨论了 ML 团队中的角色，并概述了 ML 工程和 MLOps 的挑战。

*第二章*，*机器学习开发过程*，探讨了如何组织和成功执行一个 ML 工程项目。这包括对敏捷、Scrum 和 CRISP-DM 等开发方法的讨论，然后分享作者开发的项目方法，该方法在整本书中都有所提及。本章还介绍了**持续集成/持续部署**（**CI/CD**）和开发者工具。

*第三章*，*从模型到模型工厂*，展示了如何标准化、系统化和自动化训练和部署机器学习模型的过程。这是通过作者提出的模型工厂概念来实现的，这是一种可重复创建和验证模型的方法。本章还讨论了理解机器学习模型的关键理论概念，并涵盖了不同类型的漂移检测和模型重新训练触发标准。

*第四章*，*打包*，讨论了在 Python 中进行编码的最佳实践，以及这与构建自己的包、库和组件以在多个项目中重用的关系。本章在介绍更高级的概念之前，首先涵盖了基本的 Python 编程概念，然后讨论了包和环境管理、测试、日志记录和错误处理以及安全性。

*第五章*，*部署模式和工具*，教你一些标准的设计 ML 系统并将其投入生产的方法。本章首先关注架构、系统设计和部署模式，然后转向使用更高级的工具来部署微服务，包括容器化和 AWS Lambda。随后详细介绍了流行的 ZenML 和 Kubeflow 管道和部署平台，并提供了示例。

*第六章*，*扩展规模*，主要关于在考虑大数据集的情况下进行开发。为此，详细讨论了 Apache Spark 和 Ray 框架，并提供了工作示例。本章的重点是扩展需要大量计算能力的批处理工作负载。

*第七章*，*深度学习、生成式 AI 和 LLMOps*，涵盖了为生产用例训练和部署深度学习模型的最新概念和技术。本章包括讨论生成模型新趋势的内容，特别关注**大型语言模型**（**LLMs**）以及 ML 工程师将这些模型投入生产的挑战。这引出了定义 LLM 操作（LLMOps）的核心要素。

*第八章*，*构建示例 ML 微服务*，介绍了使用 FastAPI、Docker 和 Kubernetes 构建机器学习微服务的过程，该微服务提供预测解决方案。这汇集了本书中开发的大部分先前概念。

*第九章*，*构建 ETL 机器学习用例*，构建了一个示例批处理 ML 系统，该系统利用标准 ML 算法，并通过使用 LLMs 来增强这些算法。这展示了 LLMs 和 LLMOps 的具体应用，以及 Airflow DAGs 的更高级讨论。

# 为了最大限度地利用本书

+   在本书中，假设读者对 Python 开发有一些了解。为了完整性，涵盖了众多入门级概念，但一般来说，如果你已经编写过至少一些 Python 程序，将更容易理解示例。本书还假设读者对机器学习的主要概念有所了解，例如什么是模型，什么是训练和推理，以及对这些类似概念的理解。其中一些在文本中进行了回顾，但如果你之前已经熟悉了构建机器学习模型的主要思想，即使是基础水平，那么阅读本书将会更加顺畅。

+   在技术方面，为了充分利用本书中的示例，您需要访问一台计算机或服务器，您有权安装和运行 Python 以及其他软件包和应用程序。对于许多示例，假设您有 UNIX 类型终端的访问权限，例如 bash 或 zsh。本书中的示例是在运行 Ubuntu LTS 的 Linux 机器和运行 macOS 的 M2 Macbook Pro 上编写和测试的。如果您使用的是不同的设置，例如 Windows，示例可能需要一些调整才能在您的系统上运行。请注意，使用 M2 Macbook Pro 意味着一些示例会显示一些额外的信息，以便在 Apple Silicon 设备上运行示例。如果您的系统不需要这种额外设置，这些部分可以舒适地跳过。

+   许多基于云的示例利用**亚马逊网络服务**（**AWS**），因此需要一个带有计费设置的 AWS 账户。大多数示例将使用 AWS 提供的免费层服务，但这并不总是可能的。建议谨慎行事，以避免产生大额账单。如果有疑问，建议您查阅 AWS 文档以获取更多信息。作为一个具体的例子，在*第五章*，*部署模式和工具*中，我们使用了 AWS 的**Apache Spark 托管工作流**（**MWAA**）服务。MWAA 没有免费层选项，因此一旦启动示例，您将开始为环境和任何实例付费。在继续之前，请确保您愿意这样做，并且我建议在完成时拆除您的 MWAA 实例。

+   **Conda**和**Pip**被用于本书中的包和环境管理，但在许多情况下也使用了 Poetry。为了方便在本书 GitHub 仓库（[`github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition`](https://github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition)）中每个章节的复现开发环境，每个章节都有一个对应的文件夹，在该文件夹中包含`requirements.txt`和 Conda 的`environment.yml`文件，以及有用的`README`文件。复制环境和任何其他要求的命令在本书每个章节的开头给出。

+   如果您使用的是本书的数字版，我仍然建议您亲自输入代码或从本书的 GitHub 仓库（[`github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition`](https://github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition)）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误。

## 下载示例代码文件

如上所述，本书的代码包托管在 GitHub 上，网址为 [`github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition`](https://github.com/PacktPublishing/Machine-Learning-Engineering-with-Python-Second-Edition)。我们还有其他来自我们丰富图书和视频目录的代码包，可在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 找到。查看它们吧！

## 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表的彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/LMqir`](https://packt.link/LMqir)。

## 使用的约定

本书使用了多种文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“首先，我们必须从`alibi-detect`包中导入`TabularDrift`检测器，以及用于加载数据和分割数据的相关包。”

代码块设置如下：

```py
from sklearn.datasets import load_wine
from sklearn.model_selection import train_test_split
import alibi
from alibi_detect.cd import TabularDrift 
```

任何命令行输入或输出都按以下方式编写，并在文本的主体中作为命令行命令表示：

```py
pip install tensorflow-macos 
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词在文本中会像这样显示。例如：“选择**部署**按钮。这将提供一个下拉菜单，您可以在其中选择**创建**服务。”

对附加资源或背景信息的引用会像这样出现。

有用的提示和重要的注意事项会像这样出现。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：请发送电子邮件至 `feedback@packtpub.com`，并在邮件主题中提及书籍标题。如果您对本书的任何方面有疑问，请通过电子邮件联系 `questions@packtpub.com`。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们非常感谢您向我们报告。请访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，点击 **提交勘误**，并填写表格。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，我们非常感谢您提供位置地址或网站名称。请通过电子邮件联系 `copyright@packtpub.com` 并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [`authors.packtpub.com`](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了 *Python 机器学习工程 - 第二版*，我们非常乐意听到您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1837631964)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在旅途中阅读，但无法携带您的印刷书籍到任何地方吗？您的电子书购买是否与您选择的设备不兼容？

别担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地点、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您将获得独家折扣、新闻通讯以及每天收件箱中的优质免费内容。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接

    ![](img/Free_pdf_QR.png)

    [`packt.link/free-ebook/9781837631964`](https://packt.link/free-ebook/9781837631964)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件。
