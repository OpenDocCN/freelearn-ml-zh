# 前言

我们生活在一个非常激动人心的时代。每一天你都可以发现一个全新的应用或数字设备，它可以为你完成某些任务，娱乐你，让你与家人和朋友保持联系，以图片或视频的形式记录你的记忆，等等。这个列表可能永远也说不完。其中大部分应用或设备——无论是你口袋里的小型智能手机，还是你手腕上的小巧智能手表，或者是你的智能汽车——都得益于生产更便宜、更快的处理器的大幅发展，这些处理器拥有出色的框架和库，反过来又包含了高效执行人类曾经只能依赖自然传感器（如眼睛和耳朵）才能完成的任务的算法和技术。

计算机视觉是计算机科学领域的一个分支，它因硬件和软件技术的最新进步而发生了革命性的变化，作为回应，它也对这些硬件和软件技术产生了同样甚至更大的影响。如今，计算机视觉被用于执行从使用数码相机拍照这样简单的任务到理解自动驾驶汽车的环境以避免事故这样复杂的任务。它还被用于在视频录制中将你的脸变成兔子的形象，以及检测显微镜图像中的癌细胞和组织，这可以挽救生命。对于基于计算机视觉的应用或数字设备，其可能性几乎是无限的，尤其是在考虑到库和框架的巨大进步，这些库和框架是企业和技术人员将他们的想法变为现实的关键。

在过去的几年里，OpenCV，即开源计算机视觉库，已经变成了计算机视觉开发者的一整套工具。它几乎包含了实现你所能想到的大多数计算机视觉问题所需的一切，从对合适的计算机视觉库所期望的最基本操作，如调整图像大小和过滤图像，到使用机器学习训练模型，这些模型可用于准确和快速的对象检测。OpenCV 库包含了开发计算机视觉应用所需的所有内容，它还支持一些最流行的编程语言，如 C++和 Python。你甚至可以在.NET 框架等中找到 OpenCV 的绑定。OpenCV 几乎可以在你所能想到的任何主要操作系统上运行，无论是在移动平台还是桌面平台上。

本书的目标是通过一系列动手示例和样例项目，教会开发者使用 OpenCV 库开发计算机视觉应用。本书的每一章都包含与该章节涵盖主题相对应的多个计算机视觉算法，通过按顺序阅读所有章节，您将了解可用于您应用的广泛计算机视觉算法。本书中涵盖的大多数计算机视觉算法都是相互独立的；然而，强烈建议您从开头开始，并尝试根据章节顺序构建您的计算机视觉知识。之所以称之为“动手”书，是因为确保尝试本书中提供的每个示例——所有这些示例都足够有趣和令人兴奋，足以让您继续前进，并在学习过程中建立信心。

本书是数月辛勤工作的结果，没有 Tiksha Sarang 的无价帮助是不可能的，感谢她的耐心和出色的编辑；Adhithya Haridas，感谢他精确和有洞察力的技术审查和评论；Sandeep Mishra，感谢这个美好的机会；非常有帮助的技术审查员朱清亮先生；以及 Packt Publishing 的每一位帮助我创建和交付本书，并为开源和计算机视觉社区服务的人。

# 本书面向的对象

任何对 C++编程语言有扎实理解，并了解所选操作系统第三方库使用的开发者，会发现本书的主题非常容易理解和操作。另一方面，熟悉 Python 编程语言的开发者也可以使用本书来学习 OpenCV 库的使用；然而，他们需要自己将 C++示例转换为 Python，因为本书的主要关注点将是展示算法的 C++版本。

# 本书涵盖的内容

第一章，《计算机视觉简介》，概述了计算机视觉科学的基础——它是什么；在哪里使用；图像的定义及其基本属性，如像素、深度和通道等。这是一章完全的入门章节，旨在为那些对计算机视觉世界一无所知的人。

第二章，《OpenCV 入门》，介绍了 OpenCV 库并详细介绍了其核心，通过介绍 OpenCV 开发的最重要构建块。您还将了解到如何获取它以及如何使用它。本章还将简要介绍 CMake 的使用以及如何创建和构建 OpenCV 项目，之后您将学习到 Mat 类及其变体、读取和写入图像和视频以及访问相机（以及其他输入源类型）。

第三章，*数组和矩阵运算*，涵盖了用于创建或修改矩阵的基本算法。在本章中，你将学习如何执行矩阵运算，例如叉积、点积和求逆。本章还将介绍许多所谓的逐元素矩阵运算，以及如均值、总和和傅里叶变换等数学运算。

第四章，*绘制、过滤和变换*，尽可能在本书的范围内涵盖广泛的图像处理算法。本章将教你如何在图像上绘制形状和文本。你将学习如何绘制线条、箭头、矩形等。本章还将向你展示一系列用于图像过滤操作的算法，例如平滑滤波、膨胀、腐蚀和图像的形态学操作。到本章结束时，你将熟悉强大的重映射算法以及在计算机视觉中颜色图的用法。

第五章，*反向投影和直方图*，介绍了直方图的概念，并教你如何从单通道和多通道图像中计算它们。你将了解灰度图像和彩色图像的直方图可视化，或者换句话说，从像素的色调值计算出的直方图。在本章中，你还将学习关于反向投影图像的内容；即直方图提取的逆操作。本章还涵盖了直方图比较和直方图均衡化等主题。

第六章，*视频分析 – 运动检测与跟踪*，解释了如何使用计算机视觉中最受欢迎的跟踪算法来处理视频，特别是实时目标检测和跟踪操作。在简要介绍了一般如何处理视频之后，你将了解均值漂移和 CAM 漂移算法，以及卡尔曼滤波，通过实际例子和目标跟踪场景进行学习。到本章结束时，你还将了解背景和前景提取算法及其在实际中的应用。

第七章，*目标检测 – 特征与描述符*，首先简要介绍了使用模板匹配进行目标检测，然后继续教你关于广泛算法的内容，这些算法可用于形状分析。本章涵盖的主题还包括关键点检测链、描述符提取和描述符匹配，这些用于基于特征而不是简单的像素颜色或强度值进行目标检测。

第八章，*计算机视觉中的机器学习*，涵盖了 OpenCV 的机器学习（ML）和深度神经网络（DNN）模块以及一些最重要的算法、类和函数。从 SVM 算法开始，您将学习如何根据相似的训练组训练模型，然后使用该模型对输入数据进行分类。您将学习如何使用 HOG 描述符与 SVM 对图像进行分类。本章还涵盖了 OpenCV 中人工神经网络的实现，然后继续讲解级联分类。本章的最后部分将教授您如何使用来自第三方库（如 TensorFlow）的预训练模型实时检测不同类型的多个对象。

# 为了充分利用本书

虽然每个章节的初始部分都提到了每个章节所需的所有工具和软件，但以下是一个可以作为简单快速参考的列表：

+   安装了最新版本的 Windows、macOS 或 Linux 操作系统（如 Ubuntu）的普通计算机

+   Microsoft Visual Studio（在 Windows 上）

+   Xcode（在 macOS 上）

+   CMake

+   OpenCV

首先，为了了解现在的普通计算机是什么样子，您可以在网上搜索或询问当地商店；然而，您现有的计算机很可能已经足够您开始使用了。

此外，您选择的集成开发环境（IDE）或您使用的构建系统（在这种情况下为 CMake）与本书中提供的示例几乎无关。例如，只要您熟悉该 IDE 和构建系统 OpenCV 库的配置，您就可以使用本书中的确切相同的示例与任何代码编辑器或构建系统一起使用。

# 下载示例代码文件

您可以从 [www.packtpub.com](http://www.packtpub.com) 的账户下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问 [www.packtpub.com/support](http://www.packtpub.com/support) 并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在 [www.packtpub.com](http://www.packtpub.com/support) 登录或注册。

1.  选择 SUPPORT 选项卡。

1.  点击 Code Downloads & Errata。

1.  在搜索框中输入本书的名称，并遵循屏幕上的说明。

下载文件后，请确保使用最新版本解压缩或提取文件夹。

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

该书的代码包也托管在 GitHub 上，地址为 [`github.com/PacktPublishing/Hands-On-Algorithms-for-Computer-Vision`](https://github.com/PacktPublishing/Hands-On-Algorithms-for-Computer-Vision)。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包可供选择，请访问 **[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**。查看它们吧！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`www.packtpub.com/sites/default/files/downloads/HandsOnAlgorithmsforComputerVision_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/HandsOnAlgorithmsforComputerVision_ColorImages.pdf)。

# 使用的约定

本书中使用了多种文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“另一方面，要旋转图像，您可以使用`rotate`函数。”

代码块设置如下：

```py
HistCompMethods method = HISTCMP_CORREL; 
double result = compareHist(histogram1, histogram2, method); 
```

任何命令行输入或输出都按以下方式编写：

```py
pip install opencv-python
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词在文本中显示如下。以下是一个示例：“在我们开始形状分析和特征分析算法之前，我们将学习一种易于使用、功能强大的目标检测方法，称为**模板匹配**。”

警告或重要注意事项看起来像这样。

小技巧和窍门看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：请发送电子邮件至`feedback@packtpub.com`，并在邮件主题中提及书籍标题。如果您对本书的任何方面有疑问，请发送电子邮件至`questions@packtpub.com`。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将非常感激您能向我们报告。请访问[www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上发现我们作品的任何非法副本，我们将非常感激您能提供位置地址或网站名称。请通过链接至材料的方式与我们联系至`copyright@packtpub.com`。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。一旦您阅读并使用了这本书，为何不在您购买它的网站上留下评论呢？潜在读者可以查看并使用您的客观意见来做出购买决定，Packt 公司可以了解您对我们产品的看法，我们的作者也可以看到他们对书籍的反馈。谢谢！

有关 Packt 的更多信息，请访问 [packtpub.com](https://www.packtpub.com/)。

# 目录

1.  标题页

1.  版权和致谢

    1.  计算机视觉的动手算法

1.  献词

1.  Packt 升级销售

    1.  为什么订阅？

    1.  PacktPub.com

1.  贡献者

    1.  关于作者

    1.  关于审稿人

    1.  Packt 正在寻找像你这样的作者

1.  前言

    1.  本书面向对象

    1.  本书涵盖内容

    1.  充分利用本书

        1.  下载示例代码文件

        1.  下载彩色图像

        1.  使用的约定

    1.  取得联系

        1.  评论

1.  计算机视觉简介

    1.  技术要求

    1.  理解计算机视觉

    1.  深入了解图像

        1.  颜色空间

        1.  输入、处理和输出

    1.  计算机视觉框架和库

    1.  摘要

    1.  问题

1.  开始使用 OpenCV

    1.  技术要求

    1.  OpenCV 简介

        1.  OpenCV 中的主要模块

    1.  下载和构建/安装 OpenCV

    1.  使用 C++ 或 Python 与 OpenCV

    1.  理解 Mat 类

        1.  构建 Mat 对象

        1.  删除 Mat 对象

        1.  访问像素

    1.  读取和写入图像

    1.  读取和写入视频

        1.  访问相机

        1.  访问 RTSP 和网络流

    1.  Mat-like 类

    1.  总结

    1.  问题

    1.  进一步阅读

1.  数组和矩阵运算

    1.  技术要求

    1.  Mat 类中包含的操作

        1.  克隆矩阵

        1.  计算叉积

        1.  提取对角线

        1.  计算点积

        1.  了解单位矩阵

        1.  矩阵求逆

        1.  逐元素矩阵乘法

        1.  全一和全零矩阵

        1.  转置矩阵

        1.  重塑 Mat 对象

    1.  逐元素矩阵运算

        1.  基本操作

            1.  加法操作

            1.  加权加法

            1.  减法操作

            1.  乘法和除法操作

        1.  位运算逻辑操作

        1.  比较操作

        1.  数学运算

    1.  矩阵和数组运算

        1.  为外推制作边界

        1.  翻转（镜像）和旋转图像

        1.  处理通道

        1.  数学函数

            1.  矩阵求逆

            1.  元素的平均值和总和

            1.  离散傅里叶变换

            1.  生成随机数

        1.  搜索和定位功能

            1.  定位非零元素

            1.  定位最小和最大元素

            1.  查找表转换

    1.  总结

    1.  问题

1.  绘制、过滤和转换

    1.  技术要求

    1.  在图像上绘制

        1.  在图像上打印文本

        1.  绘制形状

    1.  过滤图像

        1.  模糊/平滑滤波器

        1.  形态学滤波器

        1.  基于导数的滤波器

        1.  任意滤波

    1.  转换图像

        1.  阈值算法

        1.  颜色空间和类型转换

    1.  几何变换

    1.  应用色图

    1.  总结

    1.  问题

1.  逆投影和直方图

    1.  技术要求

    1.  理解直方图

        1.  显示直方图

    1.  直方图的逆投影

        1.  了解更多关于逆投影的信息

    1.  比较直方图

    1.  直方图均衡化

    1.  总结

    1.  问题

    1.  进一步阅读

1.  视频分析 - 运动检测和跟踪

    1.  技术要求

    1.  处理视频

    1.  理解均值漂移算法

    1.  使用连续自适应均值（CAM）变换

    1.  使用卡尔曼滤波进行跟踪和噪声降低

    1.  如何提取背景/前景

        1.  背景分割的示例

    1.  总结

    1.  问题

1.  目标检测 - 特征和描述符

    1.  技术要求

    1.  目标检测中的模板匹配

    1.  检测角点和边缘

        1.  学习哈里斯角点检测算法

        1.  边缘检测算法

    1.  轮廓计算和分析

    1.  检测、描述和匹配特征

    1.  总结

    1.  问题

1.  计算机视觉中的机器学习

    1.  技术要求

    1.  支持向量机

        1.  使用 SVM 和 HOG 进行图像分类

    1.  使用人工神经网络训练模型

    1.  级联分类算法

        1.  使用级联分类器进行目标检测

        1.  训练级联分类器

            1.  创建样本

            1.  创建分类器

    1.  使用深度学习模型

    1.  总结

    1.  问题

1.  评估

    1.  第一章，计算机视觉简介

    1.  开始使用 OpenCV

    1.  第三章，数组和矩阵运算

    1.  第四章，绘图、过滤和变换

    1.  第五章，反向投影和直方图

    1.  第六章，视频分析 - 运动检测和跟踪

    1.  第七章，目标检测 - 特征和描述符

    1.  第八章，计算机视觉中的机器学习

1.  您可能喜欢的其他书籍

    1.  留下评论 - 让其他读者了解您的想法
