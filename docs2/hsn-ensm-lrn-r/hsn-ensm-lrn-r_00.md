# 前言

集成学习！这个机器学习的专门主题广泛涉及将多个模型组合起来，旨在提供更高的准确性和稳定的模型性能。集成方法论基于坚实的理论，其应用已在复杂的数据科学场景中取得了成功。本书抓住了处理这个重要主题的机会。

本书在整本书中使用了中等规模的数据库。所有概念——好吧，大多数概念——都通过软件进行了说明，并且广泛使用了 R 包来阐述观点。虽然已经尽力确保所有代码无错误，但请随时向我们报告代码中的任何错误或问题。该方法已经通过基于早期草稿的两个迷你课程进行了轻微验证。同事们对材料给予了好评，这给了我足够的信心来完成本书。

Packt 编辑团队在技术审阅方面给予了很大帮助，经过多次精炼，手稿终于呈现在您面前。错误和不足之处归咎于作者。

# 本书面向对象

本书面向任何希望通过使用 R 的强大功能构建集成模型来掌握机器学习的人。为了充分利用本书，需要具备机器学习技术的基本知识和 R 编程知识。

# 本书涵盖内容

第一章，*集成技术简介*，将阐述集成学习的必要性、重要数据集、基本统计和机器学习模型以及重要的统计检验。本章展示了本书的精神。

第二章，*自举*，将介绍两个重要概念：刀切法和自举法。本章将帮助您进行与未知复杂参数相关的统计推断。通过 R 程序展示了线性回归、生存分析和时间序列等基本统计模型的自举，更重要的是，它为形成集成方法核心的重新采样技术奠定了基础。

第三章，*Bagging*，将提出第一个使用决策树作为基础模型的集成方法。Bagging 是*bootstrap aggregation*（自举聚合）这两个词的组合。本章展示了决策树剪枝的示例，并为后续章节奠定所需的基础。本章还展示了决策树和 k-NN 分类器的 Bagging。

第四章, *随机森林*，将讨论决策树的重要集合扩展。变量重要性和邻近性图是随机森林的两个重要组成部分，我们对其进行了相关计算。随机森林的细微之处将深入解释。本章还处理了与袋装方法、缺失数据插补以及使用随机森林进行聚类的比较。

第五章, *纯粹的提升算法*，首先陈述提升算法。使用玩具数据，本章随后解释了自适应提升算法的详细计算。然后，梯度提升算法用于回归问题。`gbm`和`adabag`包的使用展示了其他提升算法的实现。本章以袋装、随机森林和提升方法的比较结束。

第六章, *提升细化*，将从提升技术的运作原理进行解释。随后，梯度提升算法被扩展到计数和生存数据集。流行的梯度提升算法的极梯度提升实现细节通过清晰的程序展示。本章以`h2o`包的重要概述结束。

第七章, *通用集合技术*，将研究集合技术成功背后的概率原因。对于分类和回归问题，解释了集合技术的成功。

第八章, *集合诊断*，将探讨集合多样性的条件。在此展示了分类器的成对比较和整体评分者间一致性度量。

第九章, *集合回归模型*，将详细讨论在回归问题中使用集合方法。这里使用了一个来自`kaggle`的复杂住房数据集。回归数据使用多个基学习器进行建模。袋装、随机森林、提升和堆叠在回归数据中都有所展示。

第十章的*Ensembling Survival Models*涉及生存数据。生存分析的概念得到了相当详细的阐述，并展示了传统技术。介绍了生存树的学习方法，然后我们为这种数据结构构建了随机生存森林的集成方法。

第十一章的*Ensembling Time Series Models*处理另一种特殊的数据结构，其中观测值相互依赖。时间序列的核心概念和基本相关模型得到发展。介绍了特殊时间序列模型的 Bagging，并以异构时间序列模型的集成结束本章。

第十二章的*What's Next?*将讨论集成学习中的一些未解决的问题和未来工作的范围。

# 要充分利用本书

1.  R 的官方网站是位于[www.cran.r-project.org](http://www.cran.r-project.org)的**综合 R 档案网络**（**CRAN**）。在撰写本书时，R 的最新版本是 3.5.1。此软件适用于三个平台：Linux、macOS 和 Windows。读者还可以下载一个很好的前端，例如 RStudio。

1.  每一章都有一个标题部分，标题为*技术要求*。它列出了运行该章节代码所需的 R 包。例如，第三章的*Bagging*要求如下：

    +   class

    +   FNN

    +   ipred

    +   mlbench

    +   rpart

然后，读者需要在 R 控制台中运行以下行来安装所有这些包：

```py
install.packages("class")
install.packages("mlbench")
install.packages("FNN")
install.packages("rpart")
install.packages("ipred")
```

## 下载示例代码文件

您可以从[`www.packtpub.com`](http://www.packtpub.com)的账户下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在[`www.packtpub.com`](http://www.packtpub.com)登录或注册。

1.  选择**支持**选项卡。

1.  点击**代码下载与勘误**。

1.  在**搜索**框中输入本书的名称，并遵循屏幕上的说明。

文件下载后，请确保使用最新版本解压缩或提取文件夹：

+   Windows 的 WinRAR / 7-Zip

+   Mac 的 Zipeg / iZip / UnRarX

+   Linux 的 7-Zip / PeaZip

本书代码包也托管在 GitHub 上，地址为[`github.com/PacktPublishing/Hands-On-Ensemble-Learning-with-R`](https://github.com/PacktPublishing/Hands-On-Ensemble-Learning-with-R)。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还提供其他代码包，这些代码包来自我们丰富的图书和视频目录，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

## 下载彩色图像

我们还提供包含本书中使用的截图/图表的彩色 PDF 文件。您可以从这里下载：[`www.packtpub.com/sites/default/files/downloads/HandsOnEnsembleLearningwithR_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/HandsOnEnsembleLearningwithR_ColorImages.pdf)。

## 使用的约定

本书使用了许多文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“使用`dexp`函数计算密度函数值的计算。”

代码块设置如下：

```py
> Events_Prob <- apply(Elements_Prob,1,prod)
> Majority_Events <- (rowSums(APC)>NT/2)
> sum(Events_Prob*Majority_Events)
[1] 0.9112646
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词，例如在菜单或对话框中，这些单词在文本中也以这种方式出现。例如：“从**管理**面板中选择**系统信息**。”

### 注意

警告或重要注意事项以这种方式出现在框中。

### 小贴士

小技巧和技巧以这种方式出现。

# 联系我们

我们读者的反馈总是受欢迎的。

**总体反馈**：请发送电子邮件至 `<feedback@packtpub.com>`，并在邮件主题中提及本书的标题。如果您对本书的任何方面有疑问，请通过电子邮件联系我们，地址为 `<questions@packtpub.com>`。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现错误，我们将不胜感激，如果您能向我们报告，请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上发现我们作品的任何形式的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过电子邮件联系我们，地址为 `<copyright@packtpub.com>`，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

## 评论

请留下您的评价。一旦您阅读并使用了这本书，为何不在购买它的网站上留下评价呢？潜在读者可以查看并使用您的客观意见来做出购买决定，我们 Packt 可以了解您对我们产品的看法，而我们的作者也可以看到他们对书籍的反馈。谢谢！

如需了解 Packt 的更多信息，请访问[packtpub.com](http://packtpub.com)。
