# 5

# æˆæœ¬æ•æ„Ÿå­¦ä¹ 

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†å„ç§é‡‡æ ·æŠ€æœ¯ä»¥åŠå¦‚ä½•å¯¹æ•°æ®è¿›è¡Œè¿‡é‡‡æ ·æˆ–æ¬ é‡‡æ ·ã€‚ç„¶è€Œï¼Œè¿™ä¸¤ç§æŠ€æœ¯éƒ½æœ‰å…¶ç‹¬ç‰¹çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œè¿‡é‡‡æ ·å¯èƒ½ä¼šå› ä¸ºé‡å¤çœ‹åˆ°ç²¾ç¡®æˆ–éžå¸¸ç›¸ä¼¼çš„ä¾‹å­è€Œå¯¼è‡´æ¨¡åž‹è¿‡æ‹Ÿåˆã€‚åŒæ ·ï¼Œåœ¨æ¬ é‡‡æ ·ä¸­ï¼Œæˆ‘ä»¬å¤±åŽ»äº†ä¸€äº›ä¿¡æ¯ï¼ˆè¿™äº›ä¿¡æ¯å¯èƒ½å¯¹æ¨¡åž‹æœ‰ç”¨ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬ä¸¢å¼ƒäº†å¤§å¤šæ•°ç±»åˆ«çš„ä¾‹å­æ¥å¹³è¡¡è®­ç»ƒæ•°æ®é›†ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘ä¹‹å‰æ‰€å­¦æ•°æ®çº§æŠ€æœ¯çš„æ›¿ä»£æ–¹æ¡ˆã€‚

æˆæœ¬æ•æ„Ÿå­¦ä¹ æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥å¤„ç†ä¸å¹³è¡¡æ•°æ®ã€‚æˆ‘ä»¬å°†ä»‹ç»è¿™é¡¹æŠ€æœ¯ï¼Œå¹¶äº†è§£ä¸ºä»€ä¹ˆå®ƒå¯èƒ½æ˜¯æœ‰ç”¨çš„ã€‚è¿™å°†å¸®åŠ©æˆ‘ä»¬ç†è§£æˆæœ¬å‡½æ•°çš„ä¸€äº›ç»†èŠ‚ä»¥åŠæœºå™¨å­¦ä¹ æ¨¡åž‹é»˜è®¤ä¸æ˜¯è®¾è®¡æ¥å¤„ç†ä¸å¹³è¡¡æ•°æ®é›†çš„ã€‚è™½ç„¶æœºå™¨å­¦ä¹ æ¨¡åž‹æ²¡æœ‰é…å¤‡å¤„ç†ä¸å¹³è¡¡æ•°æ®é›†çš„èƒ½åŠ›ï¼Œä½†æˆ‘ä»¬å°†çœ‹åˆ°çŽ°ä»£åº“æ˜¯å¦‚ä½•å®žçŽ°è¿™ä¸€ç‚¹çš„ã€‚

æˆ‘ä»¬å°†æ¶µç›–ä»¥ä¸‹ä¸»é¢˜ï¼š

+   **æˆæœ¬æ•æ„Ÿ** **å­¦ä¹ **ï¼ˆCSLï¼‰çš„æ¦‚å¿µ

+   å®žè·µä¸­çš„æˆæœ¬ç†è§£

+   é€»è¾‘å›žå½’çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

+   å†³ç­–æ ‘çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

+   ä½¿ç”¨`scikit-learn`å’Œ XGBoost æ¨¡åž‹è¿›è¡Œæˆæœ¬æ•æ„Ÿå­¦ä¹ 

+   MetaCost â€“ ä½¿ä»»ä½•åˆ†ç±»æ¨¡åž‹å…·æœ‰æˆæœ¬æ•æ„Ÿæ€§

+   é˜ˆå€¼è°ƒæ•´

åˆ°æœ¬ç« ç»“æŸæ—¶ï¼Œæ‚¨å°†äº†è§£åœ¨åˆ†ç±»é—®é¢˜ä¸­æˆæœ¬çš„å«ä¹‰ï¼Œå¦‚ä½•è°ƒæ•´æ¨¡åž‹å‚æ•°ä»¥è€ƒè™‘è¿™äº›æˆæœ¬ï¼Œä»¥åŠå¦‚ä½•ä¼˜å…ˆè€ƒè™‘å°‘æ•°ç±»åˆ«çš„é¢„æµ‹ä»¥å‡è½»è¯¯åˆ†ç±»çš„æˆæœ¬ã€‚æˆ‘ä»¬è¿˜å°†æŽ¢è®¨ä¸€ä¸ªé€šç”¨çš„å…ƒç®—æ³•ï¼Œè¯¥ç®—æ³•å¯ä»¥ä½¿ä»»ä½•ç®—æ³•å…·æœ‰æˆæœ¬æ•æ„Ÿæ€§ï¼Œä»¥åŠä¸€ç§åŽå¤„ç†æŠ€æœ¯ï¼Œç”¨äºŽè°ƒæ•´é¢„æµ‹é˜ˆå€¼ã€‚

# æŠ€æœ¯è¦æ±‚

ä¸Žä¹‹å‰çš„ç« èŠ‚ç±»ä¼¼ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨å¸¸è§çš„åº“ï¼Œå¦‚`numpy`ã€`scikit-learn`ã€`xgboost`å’Œ`imbalanced-learn`ã€‚æœ¬ç« çš„ä»£ç å’Œç¬”è®°æœ¬å¯åœ¨ GitHub ä¸Šæ‰¾åˆ°ï¼Œç½‘å€ä¸º[`github.com/PacktPublishing/Machine-Learning-for-Imbalanced-Data/tree/main/chapter05`](https://github.com/PacktPublishing/Machine-Learning-for-Imbalanced-Data/tree/main/chapter05)ã€‚æ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»æœ¬ç« ç¬”è®°æœ¬é¡¶éƒ¨çš„**åœ¨ Colab ä¸­æ‰“å¼€**å›¾æ ‡æˆ–é€šè¿‡ä½¿ç”¨ç¬”è®°æœ¬çš„ GitHub URL åœ¨[`colab.research.google.com`](https://colab.research.google.com)å¯åŠ¨å®ƒæ¥æ‰“å¼€è¿™ä¸ª GitHub ç¬”è®°æœ¬ã€‚

# æˆæœ¬æ•æ„Ÿå­¦ä¹ ï¼ˆCSLï¼‰çš„æ¦‚å¿µ

**æˆæœ¬æ•æ„Ÿå­¦ä¹ **ï¼ˆCSLï¼‰æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå…¶ä¸­æœºå™¨å­¦ä¹ æ¨¡åž‹çš„æˆæœ¬å‡½æ•°è¢«æ”¹å˜ä»¥è€ƒè™‘æ•°æ®çš„ä¸å¹³è¡¡ã€‚CSL èƒŒåŽçš„å…³é”®æ´žå¯Ÿæ˜¯æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ¨¡åž‹æˆæœ¬å‡½æ•°åæ˜ ä¸åŒç±»åˆ«çš„ç›¸å¯¹é‡è¦æ€§ã€‚

è®©æˆ‘ä»¬å°è¯•ç†è§£æœºå™¨å­¦ä¹ ä¸­çš„æˆæœ¬å‡½æ•°å’Œå„ç§ç±»åž‹çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ ï¼ˆCSLï¼‰ã€‚

## æˆæœ¬å’Œæˆæœ¬å‡½æ•°

æˆæœ¬å‡½æ•°ä¼°è®¡äº†å®žé™…ç»“æžœä¸Žæ¨¡åž‹é¢„æµ‹ç»“æžœä¹‹é—´çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œé€»è¾‘å›žå½’æ¨¡åž‹çš„æˆæœ¬å‡½æ•°ç”±å¯¹æ•°æŸå¤±å‡½æ•°ç»™å‡ºï¼š

LogLoss = âˆ’ 1 * N * âˆ‘ i=1 N (y_i * log(Ë†y_i) + (1 âˆ’ y_i) * log(1 âˆ’ Ë†y_i))

åœ¨è¿™é‡Œï¼ŒN æ˜¯è§‚å¯Ÿçš„æ€»æ•°ï¼Œy_i æ˜¯çœŸå®žæ ‡ç­¾ï¼ˆ0 æˆ– 1ï¼‰ï¼ŒË†y_i æ˜¯ä»Žæ¨¡åž‹é¢„æµ‹å‡ºçš„æ¦‚çŽ‡å€¼ï¼ˆä»‹äºŽ 0 å’Œ 1 ä¹‹é—´ï¼‰ã€‚

ä¸€ç§ç±»åž‹çš„æˆæœ¬è¢«ç§°ä¸ºè¯¯åˆ†ç±»é”™è¯¯æˆæœ¬ [1] - å³ï¼Œé¢„æµ‹å¤šæ•°ç±»è€Œä¸æ˜¯å°‘æ•°ç±»æˆ–åä¹‹çš„æˆæœ¬ã€‚

å®žé™…ä¸Šï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°å…¶ä»–ç±»åž‹çš„æˆæœ¬ï¼Œä¾‹å¦‚ä»¥ä¸‹è¿™äº›ï¼š

+   æ ‡è®°æ•°æ®é›†çš„æˆæœ¬

+   è®­ç»ƒæˆ–è¯„ä¼°æ¨¡åž‹çš„æˆæœ¬

+   è®­ç»ƒæ•°æ®æ”¶é›†çš„æˆæœ¬

è®©æˆ‘ä»¬è€ƒè™‘æ··æ·†çŸ©é˜µï¼š

|  | **é¢„æµ‹ä¸ºè´Ÿ** | **é¢„æµ‹ä¸ºæ­£** |
| --- | --- | --- |
| **å®žé™…ä¸ºè´Ÿ** | çœŸé˜´æ€§ | å‡é˜³æ€§ |
| **å®žé™…ä¸ºæ­£** | å‡é˜´æ€§ | çœŸé˜³æ€§ |

è¡¨ 5.1 â€“ ç†è§£åˆ†ç±»é”™è¯¯æˆæœ¬çš„æ··æ·†çŸ©é˜µ

å¿ƒç†å­¦ç ”ç©¶è¡¨æ˜Žï¼ŒæŸå¤±å¸¦æ¥çš„ç—›è‹¦æ˜¯æ”¶ç›Šçš„ä¸¤å€ã€‚åŒæ ·ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œâ€œæˆæœ¬â€æ•æ‰äº†æ¨¡åž‹å‡ºé”™ï¼ˆå‡é˜³æ€§ä¸Žå‡é˜´æ€§ï¼‰çš„æ—¶åˆ»ï¼Œè€Œä¸å…³å¿ƒå®ƒæ­£ç¡®çš„æ—¶å€™ï¼ˆçœŸé˜³æ€§ä¸ŽçœŸé˜´æ€§ï¼‰ã€‚è¿™ç§æˆæœ¬æ˜¯è¯¯åˆ†ç±»é”™è¯¯çš„æˆæœ¬ã€‚

å¹¶éžæ‰€æœ‰è¯¯åˆ†ç±»éƒ½æ˜¯ç›¸åŒçš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨å°è¯•é¢„æµ‹æ‚£è€…æ˜¯å¦æ‚£æœ‰ç™Œç—‡ã€‚å¦‚æžœæˆ‘ä»¬çš„æ¨¡åž‹é”™è¯¯åœ°æŒ‡ç¤ºæ‚£è€…æ‚£æœ‰ç™Œç—‡ï¼ˆå‡é˜³æ€§ï¼‰ï¼Œè¿™å¯èƒ½å¯¼è‡´é¢å¤–çš„æµ‹è¯•ã€‚ç„¶è€Œï¼Œå¦‚æžœæˆ‘ä»¬çš„æ¨¡åž‹é”™è¯¯åœ°å»ºè®®æ‚£è€…æ— ç—…ï¼ˆå‡é˜´æ€§ï¼‰ï¼ŒåŽæžœå¯èƒ½æ›´ä¸ºä¸¥é‡ï¼Œå› ä¸ºç–¾ç—…å¯èƒ½ä¼šæœªè¯Šæ–­è€Œè¿›å±•ã€‚å› æ­¤ï¼Œå‡é˜´æ€§æ¯”å‡é˜³æ€§æ›´å…·ç ´åæ€§ã€‚æˆ‘ä»¬çš„æˆæœ¬å‡½æ•°åº”è¯¥è€ƒè™‘è¿™ç§å·®å¼‚ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œå¤§å¤šæ•°æ¨¡åž‹é»˜è®¤å°†å¤šæ•°ç±»å’Œå°‘æ•°ç±»åŒç­‰å¯¹å¾…ã€‚ç„¶è€Œï¼ŒçŽ°ä»£æœºå™¨å­¦ä¹ æ¡†æž¶å¦‚ `scikit-learn`ã€Keras/TensorFlow å’Œ PyTorch æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åœ¨å„ç§å­¦ä¹ ç®—æ³•ä¸­ä¸åŒåœ°æƒè¡¡å„ç§ç±»ã€‚

## æˆæœ¬æ•æ„Ÿå­¦ä¹ ç±»åž‹

æˆæœ¬æ•æ„Ÿå­¦ä¹ ï¼ˆCSLï¼‰æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼Œå³åŠ æƒæ³•å’Œå…ƒå­¦ä¹ ã€‚åœ¨åŠ æƒæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ›´æ–°æœºå™¨å­¦ä¹ æ¨¡åž‹çš„æˆæœ¬å‡½æ•°ï¼Œä»¥åæ˜ ä¸åŒç±»çš„é‡è¦æ€§ã€‚åœ¨å…ƒå­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿æ¨¡åž‹å¯¹æˆæœ¬æ•æ„Ÿï¼Œè€Œæ— éœ€æ›´æ”¹å…¶æˆæœ¬å‡½æ•°ã€‚

åœ¨å…ƒå­¦ä¹ æŠ€æœ¯ MetaCost ä¸­ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è®­ç»ƒå®žä¾‹çš„æ ‡ç­¾ï¼Œä»¥æœ€å°åŒ–é¢„æœŸçš„è¯¯åˆ†ç±»æˆæœ¬ã€‚åŒæ ·ï¼Œåœ¨é˜ˆå€¼è°ƒæ•´æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç¡®å®šä¸€ä¸ªæ¦‚çŽ‡é˜ˆå€¼ï¼Œä»¥æœ€å°åŒ–é¢„æµ‹çš„æ€»è¯¯åˆ†ç±»æˆæœ¬ã€‚*å›¾ 5.1* ä»Žé«˜å±‚æ¬¡ä¸Šå¯¹è¿™äº›æ–¹æ³•è¿›è¡Œäº†åˆ†ç±» [2][3]ï¼š

![å›¾ç‰‡](img/B17259_05_01.jpg)

å›¾ 5.1 â€“ æˆæœ¬æ•æ„Ÿå­¦ä¹ æ–¹æ³•çš„åˆ†ç±»

## CSL ä¸Žé‡é‡‡æ ·çš„åŒºåˆ«

ä¸Žä¹‹å‰è®¨è®ºçš„æ•°æ®çº§åˆ«æŠ€æœ¯ç›¸æ¯”ï¼ŒCSL çš„å…³é”®åŒºåˆ«åœ¨äºŽæ•°æ®çº§åˆ«æŠ€æœ¯è°ƒæ•´ä¸åŒé”™è¯¯ç±»åž‹çš„é¢‘çŽ‡ï¼Œä½†å®ƒä»¬å¯¹å¾…æ‰€æœ‰è¯¯åˆ†ç±»é”™è¯¯éƒ½æ˜¯ä¸€æ ·çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰é‡åˆ°çš„ï¼Œä¸åŒç±»åˆ«çš„è§‚æµ‹å€¼è¢«è¯¯åˆ†ç±»çš„æˆæœ¬å¹¶ä¸ç›¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨ç™Œç—‡æ£€æµ‹ä¸­ï¼Œå°†æ‚£æœ‰ç™Œç—‡çš„æ‚£è€…è¯¯åˆ†ç±»ä¸ºå¥åº·ï¼ˆå‡é˜´æ€§ï¼‰çš„æˆæœ¬è¦é«˜å¾—å¤šï¼Œå› ä¸ºå¦‚æžœæœªæ£€æµ‹æˆ–æœªæ—©æœŸæ²»ç–—ï¼Œæ‚£è€…é£Žé™©å¾ˆé«˜ã€‚åŒæ ·ï¼Œå°†æ¬ºè¯ˆé¢„è®¢è¯¯åˆ†ç±»ä¸ºéžæ¬ºè¯ˆå¯èƒ½ä¼šæ¯”å°†åˆæ³•äº¤æ˜“è¯¯åˆ†ç±»ä¸ºæ¬ºè¯ˆçš„æˆæœ¬æ›´é«˜ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåœ¨åŽä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è”ç³»ç”¨æˆ·å¹¶éªŒè¯äº¤æ˜“çš„åˆæ³•æ€§å³å¯ã€‚é€šè¿‡åº”ç”¨é‡é‡‡æ ·æŠ€æœ¯ï¼Œå¦‚ä¸Šé‡‡æ ·æˆ–ä¸‹é‡‡æ ·ï¼Œæˆ‘ä»¬éšå¼åœ°æ”¹å˜äº†ä¸åŒç±»åž‹é”™è¯¯çš„æˆæœ¬ã€‚å› æ­¤ï¼ŒCSL å’Œé‡é‡‡æ ·æŠ€æœ¯æœ€ç»ˆå¯ä»¥å¯¹æ¨¡åž‹äº§ç”Ÿç­‰æ•ˆçš„å½±å“ã€‚

ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé‡é‡‡æ ·æŠ€æœ¯å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚è®¨è®ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCSL å¯èƒ½æ›´å®žç”¨ï¼š

![å›¾ç‰‡](img/B17259_05_02.jpg)

å›¾ 5.2 â€“ æ¼«ç”»å†æ¬¡å¼ºè°ƒè¯¯åˆ†ç±»é”™è¯¯çš„æ¦‚å¿µ

## é‡å¹³è¡¡æŠ€æœ¯çš„ç¼ºé™·

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç®€è¦åœ°æåˆ°äº†ä¸ºä»€ä¹ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æ›´å–œæ¬¢ä¸åº”ç”¨ä»»ä½•æ•°æ®é‡‡æ ·æŠ€æœ¯ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºä»¥ä¸‹åŽŸå› ï¼š

+   æˆ‘ä»¬å·²ç»æ‹¥æœ‰å¤ªå¤šçš„è®­ç»ƒæ•°æ®ï¼Œå¤„ç†æ›´å¤šçš„æ•°æ®å¯èƒ½ç›¸å½“æ˜‚è´µï¼Œæˆ–è€…ç”±äºŽæœ‰æ›´å¤šçš„è®­ç»ƒæ•°æ®ï¼Œè®­ç»ƒæ—¶é—´å¯èƒ½å¢žåŠ æ•°å€ã€‚

+   æœ‰æ—¶ï¼Œç”±äºŽæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯èƒ½æ— æ³•é€šè¿‡é‡‡æ ·æˆ–æ•°æ®é‡å¹³è¡¡æŠ€æœ¯èŽ·å¾—æœ€ä½³ç»“æžœã€‚

+   å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„å› ç´ æ˜¯ï¼Œåœ¨é‡æ–°å¹³è¡¡æ•°æ®é›†åŽï¼Œæˆ‘ä»¬çš„æ¨¡åž‹çš„é¢„æµ‹åˆ†æ•°å¯èƒ½å˜å¾—ä¸å‡†ç¡®ï¼Œéœ€è¦é‡æ–°æ ¡å‡†ã€‚æˆ‘ä»¬å°†åœ¨*ç¬¬åç« *â€œæ¨¡åž‹æ ¡å‡†â€ä¸­ä»‹ç»è¿™ä¸€ä¸»é¢˜ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å„ç§æ¨¡åž‹æ ¡å‡†æŠ€æœ¯ã€‚

+   é‡å¹³è¡¡æŠ€æœ¯å¯èƒ½å¯¼è‡´æ¨¡åž‹è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆé—®é¢˜ã€‚ç‰¹åˆ«æ˜¯å½“ä½¿ç”¨è¿‡é‡‡æ ·æ—¶ï¼Œå®ƒä»¬ä¼šäº§ç”Ÿé‡å¤æˆ–ç›¸ä¼¼çš„è®­ç»ƒç¤ºä¾‹ï¼Œè¿™å¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆã€‚åŒæ ·ï¼Œå½“ä½¿ç”¨æ¬ é‡‡æ ·æ—¶ï¼Œæ¨¡åž‹å¯èƒ½æ¬ æ‹Ÿåˆï¼Œå› ä¸ºæ¨¡åž‹æ²¡æœ‰åœ¨æ¬ é‡‡æ ·è¿‡ç¨‹ä¸­ä¸¢å¼ƒçš„æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒã€‚

æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å°è¯•ç†è§£æˆæœ¬ç©¶ç«Ÿæ„å‘³ç€ä»€ä¹ˆã€‚

# å®žè·µä¸­ç†è§£æˆæœ¬

åœ¨ä¸ºä¸åŒç±»åˆ«åˆ›å»ºæƒé‡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ¶‰åŠçš„å„ç§æˆæœ¬ç±»åž‹ã€‚è¿™äº›æˆæœ¬æ ¹æ®å…·ä½“æƒ…å†µè€Œå˜åŒ–ã€‚è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸ªæˆæœ¬è®¡ç®—çš„ä¾‹å­ï¼Œä»¥äº†è§£åœ¨è€ƒè™‘æˆæœ¬è®¡ç®—æ—¶åº”è€ƒè™‘ä»€ä¹ˆã€‚

è®©æˆ‘ä»¬ä»¥å„¿ç«¥è‚ºç‚Žä¸ºä¾‹ã€‚æ ¹æ®è”åˆå›½å„¿ç«¥åŸºé‡‘ä¼šï¼Œæ¯ 43 ç§’å°±æœ‰ä¸€ä¸ªå­©å­æ­»äºŽè‚ºç‚Ž[4]ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨ä¸ºå„¿ç«¥è‚ºç‚Žå¼€å‘ä¸€ä¸ªæ–°çš„æµ‹è¯•â€”â€”æˆ‘ä»¬å°†å¦‚ä½•å†³å®šä¸åŒé”™è¯¯çš„æˆæœ¬ï¼Ÿ

è®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹è¡¨ 5.1 ä¸­çš„æ··æ·†çŸ©é˜µã€‚é€šå¸¸ï¼Œå¯¹äºŽçœŸæ­£çš„è´Ÿä¾‹å’ŒçœŸæ­£çš„æ­£ä¾‹ï¼Œä¸ä¼šæœ‰é¢å¤–çš„æˆæœ¬ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨é”™è¯¯çš„è´Ÿä¾‹â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªå­©å­æ‚£æœ‰è‚ºç‚Žï¼Œå´é¢„æµ‹è¯¥å­©å­å¥åº·æ—¶â€”â€”å°†ä¼šæœ‰éžå¸¸é«˜çš„æˆæœ¬ã€‚å¦ä¸€æ–¹é¢ï¼Œå½“ä¸€ä¸ªå¥åº·çš„å„¿ç«¥è¢«é¢„æµ‹ä¸ºæ‚£æœ‰è‚ºç‚Žæ—¶ï¼Œå°†ä¼šæœ‰ä¸Žå­©å­å®¶åº­å¯èƒ½é‡åˆ°çš„éº»çƒ¦ç›¸å…³çš„æˆæœ¬ï¼Œä½†è¿™ä¸ªæˆæœ¬æ¯”å‰ä¸€ç§æƒ…å†µè¦ä½Žå¾—å¤šã€‚æ­¤å¤–ï¼Œè¯¯åˆ†ç±»çš„æˆæœ¬å¯èƒ½å› å­©å­çš„å¹´é¾„è€Œå¼‚ã€‚ä¾‹å¦‚ï¼Œå¹´å¹¼çš„å­©å­æ¯”å¹´é•¿çš„å­©å­é£Žé™©æ›´é«˜ã€‚å› æ­¤ï¼Œå¦‚æžœæ¨¡åž‹åœ¨å¹´å¹¼å­©å­çš„æ¡ˆä¾‹ä¸­å‡ºé”™ï¼Œæˆ‘ä»¬å°†å¯¹æ¨¡åž‹è¿›è¡Œæ›´å¤šçš„æƒ©ç½šã€‚

æˆæœ¬å¯èƒ½å› ç—‡çŠ¶çš„æŒç»­æ—¶é—´è€Œå¼‚ã€‚å¯ä»¥è¿™æ ·è€ƒè™‘ï¼šå¦‚æžœæˆ‘ä»¬çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œé”™è¯¯åœ°è¯Šæ–­äº†ä¸€ä¸ªåªæœ‰ä¸€å¤©æµæ„Ÿç—‡çŠ¶çš„å­©å­ï¼Œè¿™å¹¶ä¸ç†æƒ³ï¼Œä½†ä¹Ÿä¸æ˜¯ç¾éš¾æ€§çš„ã€‚ç„¶è€Œï¼Œå¦‚æžœé‚£ä¸ªå­©å­å·²ç»å¿å—äº† 2 å‘¨çš„æµæ„Ÿç—‡çŠ¶ï¼Œé‚£å°†æ˜¯ä¸€ä¸ªä¸åŒçš„åœºæ™¯ã€‚è¿™ä¸ªé”™è¯¯å°†ç»™æˆ‘ä»¬å¸¦æ¥æ›´å¤§çš„æˆæœ¬ã€‚

è™½ç„¶æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢è®¨è®ºäº†çŽ°å®žä¸–ç•Œçš„é—®é¢˜ï¼Œä½†æœ¬ç« å°†è½¬å‘ä½¿ç”¨åˆæˆæ•°æ®é›†ã€‚è¿™ç§æ–¹æ³•æ—¨åœ¨åœ¨å—æŽ§çŽ¯å¢ƒä¸­å¼ºåŒ–æ¦‚å¿µå’Œæ–¹æ³•ï¼Œä»Žè€Œå¢žå¼ºå­¦ä¹ è¿‡ç¨‹ï¼š

```py
X, y = make_classification(
Â Â Â Â n_samples=50000, n_features=2, n_redundant=0, class_sep=2,\
Â Â Â Â weights=[0.99], random_state=1, n_clusters_per_class=1)
X_train, X_test, y_train, y_test = train_test_split(X, y,\
Â Â Â Â test_size = 0.2, random_state = 0, stratify=y)
print('y_train: ', Counter(y_train))
print('y_test: ', Counter(y_test))
plot_dataset(X_train, y_train)
```

`make_classification`å‡½æ•°äº§ç”Ÿäº†ä¸€äº›é‡å çš„ç‚¹ï¼Œæˆ‘ä»¬æ¸…ç†äº†è¿™äº›ç‚¹ã€‚ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œçœç•¥äº†æ¸…ç†ä»£ç ã€‚æ‚¨å¯ä»¥åœ¨ GitHub ä¸Šçš„å®Œæ•´ç¬”è®°æœ¬ä¸­æŸ¥é˜…ã€‚

ä¹‹å‰çš„ä»£ç äº§ç”Ÿäº†ä»¥ä¸‹è¾“å‡ºå’Œæ•£ç‚¹å›¾ï¼ˆ*å›¾ 5**.3*ï¼‰ï¼š

```py
y_train:Â Â Counter({0: 39404, 1: 596})
y_test:Â Â Counter({0: 9851, 1: 149})
```

![](img/B17259_05_03.jpg)

å›¾ 5.3 â€“ æ˜¾ç¤ºè®­ç»ƒæ•°æ®é›†åˆ†å¸ƒçš„æ•£ç‚¹å›¾

æˆ‘ä»¬å°†æ·±å…¥æŽ¢è®¨å¦‚ä½•å°† CSL åº”ç”¨äºŽé€»è¾‘å›žå½’æ¨¡åž‹ã€‚

# é€»è¾‘å›žå½’çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

é€»è¾‘å›žå½’æ˜¯ä¸€ç§ç®€å•çš„åˆ†ç±»ç®—æ³•ã€‚æˆ‘ä»¬é€šè¿‡å°†ç‰¹å¾è¿›è¡Œçº¿æ€§ç»„åˆæ¥è®­ç»ƒæ¨¡åž‹ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å°†çº¿æ€§ç»„åˆçš„ç»“æžœä¼ é€’ç»™ sigmoid å‡½æ•°ï¼Œä»¥é¢„æµ‹ä¸åŒç±»åˆ«çš„ç±»åˆ«æ¦‚çŽ‡ã€‚

`sigmoid`å‡½æ•°ï¼ˆä¹Ÿç§°ä¸º`logit`å‡½æ•°ï¼‰æ˜¯ä¸€ç§å¯ä»¥å°†ä»»ä½•å®žæ•°è½¬æ¢ä¸º 0 åˆ° 1 ä¹‹é—´å€¼çš„æ•°å­¦å·¥å…·ã€‚è¿™ä¸ªå€¼å¯ä»¥è§£é‡Šä¸ºæ¦‚çŽ‡ä¼°è®¡ï¼š

```py
import numpy as np
def sigmoid(x):
Â Â Â Â Â s = 1/(1+np.exp(-x))
Â Â Â Â Â return s
```

Sigmoid å‡½æ•°çš„å›¾åƒå‘ˆ S å½¢æ›²çº¿ï¼Œçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

![](img/B17259_05_04.jpg)

å›¾ 5.4 â€“ Sigmoid å‡½æ•°

å…·æœ‰æœ€é«˜é¢„æµ‹æ¦‚çŽ‡çš„ç±»åˆ«è¢«ç”¨ä½œç»™å®šæ ·æœ¬çš„é¢„æµ‹ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¦åˆ†ç±»ä¸ºåžƒåœ¾é‚®ä»¶æˆ–éžåžƒåœ¾é‚®ä»¶çš„ç”µå­é‚®ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„é€»è¾‘å›žå½’æ¨¡åž‹è¾“å‡ºéžåžƒåœ¾é‚®ä»¶çš„æ¦‚çŽ‡ä¸º 0.25ï¼Œåžƒåœ¾é‚®ä»¶çš„æ¦‚çŽ‡ä¸º 0.75ã€‚åœ¨è¿™é‡Œï¼Œå…·æœ‰æœ€é«˜é¢„æµ‹æ¦‚çŽ‡çš„ç±»åˆ«æ˜¯â€œåžƒåœ¾é‚®ä»¶â€ï¼ˆ1ï¼‰ï¼Œå› ä¸º 0.75 å¤§äºŽ 0.25ã€‚å› æ­¤ï¼Œæ¨¡åž‹ä¼šé¢„æµ‹è¿™å°é‚®ä»¶æ˜¯åžƒåœ¾é‚®ä»¶ï¼ˆ*å›¾ 5**.5*ï¼‰ï¼š

![](img/B17259_05_05.jpg)

å›¾ 5.5 â€“ é«˜ç±»åˆ«æ¦‚çŽ‡å†³å®šäºŒåˆ†ç±»çš„ç±»åˆ«

å¯¹äºŽäºŒåˆ†ç±»ï¼Œæˆ‘ä»¬åªé¢„æµ‹ä¸€ä¸ªç±»åˆ«çš„æ¦‚çŽ‡ã€‚å¦ä¸€ä¸ªç±»åˆ«çš„æ¦‚çŽ‡æ˜¯ç¬¬ä¸€ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å‡åŽ» 1ã€‚

å¯¹æ•°é€»è¾‘å›žå½’æ¨¡åž‹ä½¿ç”¨æŸå¤±å‡½æ•°è¿›è¡Œè®­ç»ƒã€‚æ¥è‡ªå…·æœ‰ä¸¤ä¸ªç±»åˆ«çš„æ•°æ®é›†çš„ä¸€ä¸ªç¤ºä¾‹çš„æŸå¤±å‡½æ•°çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

cost = âˆ’ y * log(classProbability) âˆ’ (1 âˆ’ y)* log(1 âˆ’ classProbability)

å¯¹äºŽçœŸæ­£çš„é˜³æ€§å’ŒçœŸæ­£çš„é˜´æ€§ï¼Œè¿™ä¸ªæŸå¤±å°†éžå¸¸ä½Žã€‚å¯¹äºŽè¯¯æŠ¥ï¼Œyï¼Œå®žé™…å€¼å°†æ˜¯ 0ï¼›å› æ­¤ï¼Œç¬¬ä¸€ä¸ªé¡¹å°†æ˜¯ 0ï¼Œä½†ç¬¬äºŒä¸ªé¡¹å°†éžå¸¸é«˜ï¼Œå› ä¸ºç±»åˆ«æ¦‚çŽ‡æŽ¥è¿‘ 1ï¼Œè¿™ä¸ªé¡¹å°†æŽ¥è¿‘è´Ÿæ— ç©·å¤§ï¼ˆå› ä¸ºï¼Œlog(0) â†’ âˆ’ âˆžï¼‰ã€‚ç”±äºŽå‰é¢æœ‰ä¸€ä¸ªè´Ÿå·ï¼Œæˆæœ¬å°†æŽ¥è¿‘æ­£æ— ç©·å¤§ã€‚å¯¹è¯¯æ£€æƒ…å†µå¯ä»¥è¿›è¡Œç±»ä¼¼çš„åˆ†æžã€‚æˆæœ¬çš„ä¸€éƒ¨åˆ†å¯ä»¥çœ‹ä½œæ˜¯è¯¯æŠ¥éƒ¨åˆ†ï¼Œå¦ä¸€éƒ¨åˆ†å¯ä»¥çœ‹ä½œæ˜¯è¯¯æ£€éƒ¨åˆ†ï¼š

cost = falsePositiveCost + falseNegativeCost

å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä¸¤ç§ç±»åž‹çš„æˆæœ¬åŒç­‰é‡è¦ã€‚æ‰€ä»¥æˆ‘ä»¬åªæ˜¯ä¸ºå„è‡ªçš„æˆæœ¬æ·»åŠ æƒé‡ï¼ŒW FP å’Œ W FNï¼š

cost = W FP * falsePositiveCost + W FN * falseNegativeCost

è¿™æ˜¯å¯¹æ•°é€»è¾‘å›žå½’ä¸­ CSL çš„æ ¸å¿ƒã€‚ä¸ºäº†å¾—åˆ°æ¨¡åž‹çš„æ€»ä½“æˆæœ¬ï¼Œæˆ‘ä»¬å–æ‰€æœ‰æ•°æ®ç‚¹çš„å¹³å‡æˆæœ¬ï¼š

```py
lr = LogisticRegression(random_state=0, max_iter=150).fit(
Â Â Â Â X_train, y_train)
plot_decision_boundary(X_train, y_train, lr, 'LogisticRegression')
plt.show()
PrecisionRecallDisplay.from_estimator(
Â Â Â Â lr, X_test, y_test, ax = plt.gca(),name = "LogisticRegression")
```

å½“æ‰€æœ‰é”™è¯¯æˆæœ¬ç›¸ç­‰æ—¶ï¼Œæ¨¡åž‹çš„å†³ç­–è¾¹ç•Œå’Œæ¨¡åž‹çš„**ç²¾åº¦-å¬å›žçŽ‡**ï¼ˆ**PR**ï¼‰æ›²çº¿å°†çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

![](img/B17259_05_06.jpg)

å›¾ 5.6 â€“ åŸºçº¿å›žå½’æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

```py
compute_scores(lr, X_test, y_test)
```

ä¹‹å‰çš„ä»£ç è¾“å‡ºäº†ä»¥ä¸‹ F2 åˆ†æ•°ã€ç²¾åº¦å’Œå¬å›žå€¼ï¼š

```py
f2-score: 0.921 precision: 0.926 recall: 0.919
```

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ F2 åˆ†æ•°ä½œä¸ºæˆ‘ä»¬çš„ä¸»è¦æŒ‡æ ‡ã€‚F2 åˆ†æ•°æ˜¯ä»€ä¹ˆï¼Ÿåœ¨*ç¬¬ä¸€ç« *ï¼Œ*æœºå™¨å­¦ä¹ ä¸­æ•°æ®ä¸å¹³è¡¡çš„ä»‹ç»*ï¼Œæˆ‘ä»¬å­¦ä¹ äº† F-beta åˆ†æ•°ã€‚F2 åˆ†æ•°æ˜¯ beta=2 çš„ F-beta åˆ†æ•°ï¼Œè€Œ F1 åˆ†æ•°æ˜¯ beta=1 çš„ F-beta åˆ†æ•°ã€‚å½“å¬å›žçŽ‡æ¯”ç²¾åº¦æ›´é‡è¦æ—¶ï¼Œå®ƒå¾ˆæœ‰ç”¨â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¯æŠ¥æ¯”è¯¯æ£€ï¼ˆé‡è¦ï¼‰çš„æˆæœ¬æ›´é«˜ï¼š

F Î² = Â (1 + Î² 2) Ã— (precision Ã— recall)Â Â ____________________Â Â (Î² 2 Ã— precision) + recallÂ  = Â (5 Ã— precision Ã— recall)Â Â ________________Â Â (4 Ã— precision) + recall

`LogisticRegression`æ¥è‡ª`scikit-learn`åº“æä¾›äº†ä¸€ä¸ª`class_weight`å‚æ•°ã€‚å½“æ­¤å‚æ•°çš„å€¼è®¾ç½®ä¸ºâ€œbalancedâ€æ—¶ï¼Œæ¯ä¸ªç±»åˆ«çš„æƒé‡å°†è‡ªåŠ¨é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š

weightOfClass =  totalNumberOfSamplesÂ Â Â ________________________________Â Â Â numberOfClasses * numberOfSamplesPerClass

ä¾‹å¦‚ï¼Œåœ¨æ•°æ®é›†ä¸­æˆ‘ä»¬æœ‰ 100 ä¸ªç¤ºä¾‹ â€“ 80 ä¸ªå±žäºŽç±»åˆ« 0ï¼Œ20 ä¸ªå±žäºŽç±»åˆ« 1ã€‚æ¯ä¸ªç±»åˆ«çš„æƒé‡è®¡ç®—å¦‚ä¸‹ï¼š

+   ç±»åˆ« 0 çš„æƒé‡ = 100/(2*80) = 0.625

+   ç±»åˆ« 1 çš„æƒé‡ = 100/(2*20) = 2.5

ç”±äºŽç±»åˆ« 0 çš„ç¤ºä¾‹æ•°é‡æ˜¯ç±»åˆ« 1 çš„å››å€ï¼Œç±»åˆ« 1 çš„æƒé‡æ˜¯ 2.5ï¼Œæ˜¯ç±»åˆ« 0 æƒé‡çš„å››å€ï¼Œå³ 0.625ã€‚è¿™å¾ˆæœ‰é“ç†ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ç»™ç±»åˆ« 1 æ›´å¤šçš„æƒé‡ï¼Œå› ä¸ºå®ƒçš„æ•°é‡è¾ƒå°‘ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†`class_weight`ä½œä¸ºä¸€ä¸ªå­—å…¸æ¥æåŠï¼š

```py
LogisticRegression(class_weight={0: 0.5, 1:0.5})
```

è®©æˆ‘ä»¬å°è¯•åœ¨`LogisticRegression`å‡½æ•°ä¸­ä½¿ç”¨`class_weight`å‚æ•°ï¼š

```py
lr_weighted = LogisticRegression(class_weight='balanced', \
Â Â Â Â random_state=0, max_iter=150).fit(X_train, y_train)
plot_decision_boundary(X_train, y_train, lr_weighted, \
Â Â Â Â 'LogisticRegression')
plt.show()
PrecisionRecallDisplay.from_estimator(lr_weighted, X_test,\
Â Â Â Â y_test, ax = plt.gca(),name = "LogisticRegressionWeighted")
```

![](img/B17259_05_07.jpg)

å›¾ 5.7 â€“ â€œå¹³è¡¡â€ç±»åˆ«åŠ æƒé€»è¾‘å›žå½’æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

è®©æˆ‘ä»¬è®¡ç®— F2 åˆ†æ•°ã€ç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡åˆ†æ•°ï¼š

```py
compute_scores(lr_weighted, X_test, y_test)
```

â€œå¹³è¡¡â€ç±»åˆ«åŠ æƒé€»è¾‘å›žå½’æ¨¡åž‹çš„åˆ†æ•°å¦‚ä¸‹ï¼š

```py
f2-score: 0.873 precision: 0.587 recall: 0.993
```

åœ¨åˆ†æžç»“æžœåŽï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå†³ç­–è¾¹ç•Œï¼Œå®ƒæ­£ç¡®åœ°åˆ†ç±»äº†å¤§å¤šæ•°æ­£ç±»ç¤ºä¾‹ã€‚ç²¾ç¡®çŽ‡ä¸‹é™ï¼Œè€Œå¬å›žçŽ‡ä¸Šå‡ã€‚F2 åˆ†æ•°çš„ä¸‹é™å¯ä»¥å½’å› äºŽå¬å›žçŽ‡å’Œç²¾ç¡®çŽ‡å€¼çš„å˜åŒ–ã€‚æ¨¡åž‹åœ¨å¬å›žçŽ‡æ–¹é¢æœ‰æ‰€æé«˜ï¼Œè¡¨æ˜Žå…¶è¯†åˆ«æ‰€æœ‰æ­£ç±»ç¤ºä¾‹çš„èƒ½åŠ›å¾—åˆ°äº†å¢žå¼ºã€‚ç„¶è€Œï¼Œè¿™ç§è¿›æ­¥å¯¼è‡´ç²¾ç¡®çŽ‡åŒæ—¶ä¸‹é™ï¼Œè¿™è¡¨æ˜Žåœ¨è´Ÿç±»ç¤ºä¾‹ï¼ˆæˆ‘ä»¬å¹¶ä¸ç‰¹åˆ«å…³å¿ƒï¼‰ä¸ŠçŠ¯é”™çš„é€ŸçŽ‡å¢žåŠ ã€‚

è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒæ•´`class_weight`å‚æ•°ï¼Œä»¥ä¼˜åŒ–æˆ‘ä»¬çš„ F2 åˆ†æ•°ã€‚æˆ‘ä»¬å§‹ç»ˆå¯ä»¥å°è¯•ä¼˜åŒ–ä»»ä½•å…¶ä»–ç›®æ ‡ï¼Œä¾‹å¦‚å¹³å‡ç²¾ç¡®çŽ‡ã€ç²¾ç¡®çŽ‡æˆ–å¬å›žçŽ‡ç­‰ã€‚`np.linspace(0.05, 0.95, 20)`å‡½æ•°æ˜¯ä¸€ä¸ª`numpy`å‡½æ•°ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªä»‹äºŽ 0.05 å’Œ 0.95 ä¹‹é—´çš„ 20 ä¸ªå‡åŒ€åˆ†å¸ƒçš„æ•°å­—æ•°ç»„ï¼š

```py
from sklearn.metrics import make_scorer, fbeta_score
def f2_func(y_true, y_pred):
Â Â Â Â f2_score = fbeta_score(y_true, y_pred, beta=2.)
Â Â Â Â return f2_score
def f2_scorer():
Â Â Â Â return make_scorer(f2_func)
# Define the parameter grid
param_grid = {
Â Â Â Â 'class_weight': [
Â Â Â Â Â Â Â Â {0: x, 1: 1.0-x} for x in np.linspace(0.05, 0.95, 20)]
}
# Instantiate the grid search model
grid_search =GridSearchCV(
Â Â Â Â LogisticRegression(),param_grid,\
Â Â Â Â cv=3, scoring=f2_scorer(), n_jobs=-1
)
# Fit the grid search to the data
grid_search.fit(X_train, y_train)
# Get the best parameters
best_params = grid_search.best_params_
best_params
```

è¿™ä¼šäº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š

```py
{'class_weight': {0: 0.14473684210526316, 1: 0.8552631578947368}}
```

æˆ‘ä»¬çš„æ ‡å‡†æŒ‡æ ‡å¦‚ä¸‹ï¼š

```py
f2-score: 0.930 precision: 0.892 recall: 0.940
```

åœ¨å¼•å…¥è¿™äº›ç±»åˆ«æƒé‡åŽï¼Œæˆ‘ä»¬çš„å†³ç­–è¾¹ç•Œè¯•å›¾åœ¨é”™è¯¯åˆ†ç±»æ­£ç±»å’Œè´Ÿç±»ç¤ºä¾‹ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ï¼Œå¦‚å›¾*å›¾ 5**.8*æ‰€ç¤ºã€‚è¿™å¯¼è‡´ F2 åˆ†æ•°è¾¾åˆ° 0.93ï¼Œæé«˜äº†ç²¾ç¡®çŽ‡å€¼ï¼ŒåŒæ—¶ä¿æŒé€‚åº¦çš„å¬å›žçŽ‡ï¼š

![](img/B17259_05_08.jpg)

å›¾ 5.8 â€“ ç±»åˆ«åŠ æƒé€»è¾‘å›žå½’æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

ðŸš€ å¾®è½¯åœ¨ç”Ÿäº§ä¸­çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

åœ¨å¾®è½¯çš„ä¸€ä¸ªå®žé™…åº”ç”¨ä¸­ï¼Œä¸»è¦ç›®æ ‡æ˜¯æé«˜ Bing å¹¿å‘Šçš„**ç‚¹å‡»çŽ‡**ï¼ˆ**CTR**ï¼‰é¢„æµ‹[5]ã€‚å®žçŽ°å‡†ç¡®çš„ CTR é¢„æµ‹å¯¹äºŽä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œæ”¶å…¥æµè‡³å…³é‡è¦ã€‚é¢„æµ‹å‡†ç¡®çŽ‡ä»…æé«˜ 0.1%ï¼Œå°±æœ‰å¯èƒ½ä½¿åˆ©æ¶¦å¢žåŠ æ•°äº¿ç¾Žå…ƒã€‚é€šè¿‡ä¸¥æ ¼çš„æµ‹è¯•ï¼Œä¸€ä¸ªç»“åˆ**ç¥žç»ç½‘ç»œ**ï¼ˆ**NNs**ï¼‰å’Œ**æ¢¯åº¦æå‡å†³ç­–æ ‘**ï¼ˆ**GBDTs**ï¼‰çš„é›†æˆæ¨¡åž‹æˆä¸ºæœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚

å¯¹äºŽè®­ç»ƒæ•°æ®é›†ï¼Œä»Žä¸€ä¸ªæœˆçš„æ—¥å¿—æ•°æ®ä¸­éšæœºé€‰æ‹©äº† 5600 ä¸‡ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬åŒ…å«æ•°ç™¾ä¸ªç»Ÿè®¡ç‰¹å¾ã€‚ä¸ºäº†å‡å°‘è®­ç»ƒæˆæœ¬ï¼Œéžç‚¹å‡»æ¡ˆä¾‹è¢«**é™é‡‡æ ·**äº† 50%ï¼Œå¹¶åˆ†é…äº† 2 çš„**ç±»åˆ«æƒé‡**ä»¥ä¿æŒåŽŸå§‹åˆ†å¸ƒã€‚ç„¶åŽä½¿ç”¨ä»ŽéšåŽä¸€å‘¨æ—¥å¿—ä¸­éšæœºæŠ½å–çš„ 4000 ä¸‡ä¸ªæ ·æœ¬çš„æµ‹è¯•æ•°æ®é›†è¯„ä¼°æ¨¡åž‹æ€§èƒ½ã€‚è€Œä¸æ˜¯é‡æ–°æ ¡å‡†æ¨¡åž‹ï¼Œä½¿ç”¨äº†ç±»åˆ«æƒé‡æ¥åœ¨é™é‡‡æ ·åŽä¿æŒå¹³å‡ CTRã€‚

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œä»£ä»·æ•æ„Ÿå­¦ä¹ ã€‚

# å†³ç­–æ ‘çš„ä»£ä»·æ•æ„Ÿå­¦ä¹ 

å†³ç­–æ ‘æ˜¯ä½¿ç”¨æ¡ä»¶å†³ç­–æ¥é¢„æµ‹æ ·æœ¬ç±»åˆ«çš„äºŒå‰æ ‘ã€‚æ¯ä¸ªæ ‘èŠ‚ç‚¹ä»£è¡¨ä¸€ç»„ä¸ŽåŸºäºŽç‰¹å¾çš„è¿žç»­æ¡ä»¶è¯­å¥ç›¸å¯¹åº”çš„æ ·æœ¬ã€‚æˆ‘ä»¬æ ¹æ®ç‰¹å¾å’Œé˜ˆå€¼å€¼å°†èŠ‚ç‚¹åˆ†ä¸ºä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚æƒ³è±¡ä¸€ä¸‹æœ‰ä¸€ç»„å­¦ç”Ÿï¼Œä»–ä»¬çš„èº«é«˜ã€ä½“é‡ã€å¹´é¾„ã€ç­çº§å’Œä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®å¹´é¾„ç‰¹å¾å’Œ 8 çš„é˜ˆå€¼å°†è¿™ä¸ªé›†åˆåˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚çŽ°åœ¨ï¼Œæ‰€æœ‰å¹´é¾„å°äºŽ 8 å²çš„å­¦ç”Ÿå°†è¿›å…¥å·¦å­èŠ‚ç‚¹ï¼Œè€Œæ‰€æœ‰å¹´é¾„å¤§äºŽæˆ–ç­‰äºŽ 8 å²çš„å­¦ç”Ÿå°†è¿›å…¥å³å­èŠ‚ç‚¹ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿žç»­é€‰æ‹©ç‰¹å¾å’Œé˜ˆå€¼å€¼æ¥åˆ›å»ºæ ‘ã€‚æ ‘çš„æ¯ä¸ªå¶èŠ‚ç‚¹å°†åªåŒ…å«æ¥è‡ªä¸€ä¸ªç±»åˆ«çš„èŠ‚ç‚¹ã€‚

åœ¨æž„å»ºå†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šâ€œåº”è¯¥é€‰æ‹©å“ªä¸ªç‰¹å¾å’Œé˜ˆå€¼å¯¹æ¥åˆ†å‰²ç»™å®šèŠ‚ç‚¹çš„æ ·æœ¬é›†ï¼Ÿâ€ç­”æ¡ˆå¾ˆç®€å•ï¼šæˆ‘ä»¬é€‰æ‹©äº§ç”Ÿæœ€å‡åŒ€ï¼ˆæˆ–åŒè´¨ï¼‰æ•°æ®å­é›†çš„å¯¹ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œäº§ç”Ÿçš„ä¸¤ä¸ªç»“æžœå­é›†â€”â€”è¢«ç§°ä¸ºå·¦å³å­èŠ‚ç‚¹â€”â€”åº”è¯¥å„è‡ªä¸»è¦åŒ…å«æ¥è‡ªå•ä¸ªç±»åˆ«çš„å…ƒç´ ã€‚

èŠ‚ç‚¹ä»Žä¸åŒç±»åˆ«ä¸­æ··åˆæ ·æœ¬çš„ç¨‹åº¦è¢«ç§°ä¸ºèŠ‚ç‚¹çš„**ä¸çº¯åº¦**ï¼Œè¿™å¯ä»¥è¢«è§†ä¸ºå†³ç­–æ ‘çš„æŸå¤±åº¦é‡ã€‚ä¸çº¯åº¦è¶Šé«˜ï¼Œæ ·æœ¬é›†çš„å¼‚è´¨æ€§å°±è¶Šå¤§ã€‚ä»¥ä¸‹æ˜¯è®¡ç®—ä¸çº¯åº¦çš„ä¸¤ç§æœ€å¸¸è§æ–¹æ³•ï¼š

+   Gini ç³»æ•°

+   Entropy

è®©æˆ‘ä»¬çœ‹çœ‹ Gini ç³»æ•°å’Œç†µçš„ä¸¤ä¸ªç±» c1 å’Œ c2 çš„å…¬å¼ï¼š

Gini = 1âˆ’ ProportionÂ c1Â 2âˆ’ ProportionÂ c2Â 2

æˆ‘ä»¬å°†å¾—åˆ°ä»¥ä¸‹ç»“æžœï¼š

Entropy = âˆ’ ProportionÂ c1 * log (ProportionÂ c1)

âˆ’ æ¯”ä¾‹ c2 * log (æ¯”ä¾‹ c2)

è¦ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œ CSLï¼Œæˆ‘ä»¬åªéœ€å°†ç±»æƒé‡ä¸Ž Gini å’Œç†µè®¡ç®—ä¸­æ¯ä¸ªç±»çš„é¡¹ç›¸ä¹˜ã€‚å¦‚æžœä¸¤ä¸ªç±»çš„æƒé‡æ˜¯ W1 å’Œ W2ï¼ŒGini å’Œç†µå°†å¦‚ä¸‹æ‰€ç¤ºï¼š

Gini = 1 âˆ’ W1 * æ¯”ä¾‹ c1Â² âˆ’ W2 * æ¯”ä¾‹ c2Â²

Entropy = âˆ’ W1 * æ¯”ä¾‹ c1 * log(æ¯”ä¾‹ c1)

âˆ’ W2 * æ¯”ä¾‹ c2 * log(æ¯”ä¾‹ c2)

çŽ°åœ¨ï¼Œæ¨¡åž‹ä¼˜å…ˆè€ƒè™‘æƒé‡è¾ƒé«˜çš„ç±»ï¼Œè€Œä¸æ˜¯æƒé‡è¾ƒä½Žçš„ç±»ã€‚å¦‚æžœæˆ‘ä»¬ç»™å°‘æ•°ç±»æ›´å¤šçš„æƒé‡ï¼Œæ¨¡åž‹å°†åšå‡ºä¼˜å…ˆè€ƒè™‘å…·æœ‰åŒè´¨å°‘æ•°ç±»æ ·æœ¬çš„èŠ‚ç‚¹çš„å†³ç­–ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†ä¸€äº›å¦‚ä½•å°†ç±»æƒé‡çº³å…¥å†³ç­–æ ‘çš„æŸå¤±å‡½æ•°ä¸­ï¼Œä»¥è€ƒè™‘è¯¯åˆ†ç±»é”™è¯¯ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°`scikit-learn`å¦‚ä½•é€šè¿‡å°†å…¶é›†æˆåˆ°æ¨¡åž‹åˆ›å»º API ä¸­æ¥ç®€åŒ–æ­¤è¿‡ç¨‹ï¼Œä»Žè€Œæ¶ˆé™¤æˆ‘ä»¬æ‰‹åŠ¨è°ƒæ•´æŸå¤±å‡½æ•°çš„éœ€è¦ã€‚

# ä½¿ç”¨ scikit-learn å’Œ XGBoost æ¨¡åž‹è¿›è¡Œæˆæœ¬æ•æ„Ÿå­¦ä¹ 

`scikit-learn`æä¾›äº†ä¸€ä¸ª`class_weight`è¶…å‚æ•°æ¥è°ƒæ•´å¤§å¤šæ•°æ¨¡åž‹ä¸­å„ç§ç±»çš„æƒé‡ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥æ ¹æ®`scikit-learn`ä¸­ä¸åŒå­¦ä¹ ç®—æ³•çš„ä¸åŒæ–¹å¼æŒ‡å®šã€‚ç„¶è€Œï¼Œä¸»è¦æ€æƒ³æ˜¯è¿™ä¸ªå‚æ•°æŒ‡å®šäº†æŸå¤±è®¡ç®—å…¬å¼ä¸­æ¯ä¸ªç±»çš„æƒé‡ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šäº†ä¹‹å‰æåˆ°çš„é€»è¾‘å›žå½’ä¸­çš„æƒé‡ FP å’Œæƒé‡ FN çš„å€¼ã€‚

ä¸Ž`LogisticRegression`å‡½æ•°ç±»ä¼¼ï¼Œå¯¹äºŽ`DecisionTreeClassifier`ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`DecisionTreeClassifier(class_weight='balanced')`æˆ–`DecisionTreeClassifier(class_weight={0: 0.5, 1: 0.5})`ã€‚

å…³äºŽ SVMï¼Œå®ƒç”šè‡³å¯ä»¥é€šè¿‡ä¸ºæ¯ä¸ªç±»æ ‡ç­¾æŒ‡å®šä¸€ä¸ªæƒé‡å€¼æ¥æ‰©å±•åˆ°å¤šç±»åˆ†ç±»ï¼š

```py
svm.SVC(class_weight= {-1: 1.0, 0: 1.0, 1: 1.0})
```

å…³äºŽç¡®å®š`class_weight`å€¼çš„é€šç”¨æŒ‡å¯¼åŽŸåˆ™æ˜¯ä½¿ç”¨å¤šæ•°ç±»ä¸Žå°‘æ•°ç±»æ¯”ä¾‹çš„å€’æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ç½‘æ ¼æœç´¢ç®—æ³•ï¼ˆä½¿ç”¨`scikit-learn`ä¸­çš„`GridSearchCV`å‡½æ•°ï¼‰è¿›è¡Œè¶…å‚æ•°è°ƒæ•´æ¥æ‰¾åˆ°æ›´ä¼˜çš„`class_weight`å€¼ã€‚

ç±»ä¼¼åœ°ï¼ŒXGBoost ä¹Ÿæœ‰`scale_pos_weight`å‚æ•°æ¥æŽ§åˆ¶æ­£è´Ÿæƒé‡çš„å¹³è¡¡ï¼š

```py
XGBClassifier(scale_pos_weight)
```

`scale_pos_weight`çš„é»˜è®¤å€¼æ˜¯ 1ã€‚ä¸€ä¸ªæŽ¨èçš„`scale_pos_weight`å€¼æ˜¯`sum(negative_instances)/sum(positive_instances)`ï¼Œè¿™å¯ä»¥è®¡ç®—ä¸º`float(np.sum(label == 0)) / np.sum(label==1)`ã€‚

XGBoost æœ‰å‡ ä¸ªå…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚ `max_delta_step` å’Œ `min_child_weight`ï¼Œè¿™äº›å‚æ•°å¯ä»¥é’ˆå¯¹ä¸å¹³è¡¡æ•°æ®é›†è¿›è¡Œè°ƒæ•´ã€‚åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œ`max_delta_step` å†³å®šäº†æ›´æ–°æ­¥é•¿çš„å¤§å°ï¼Œå½±å“å­¦ä¹ é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚`min_child_weight` é€šè¿‡å½±å“å†³ç­–æ ‘ä¸­å¶èŠ‚ç‚¹çš„å¤§å°æ¥æŽ§åˆ¶è¿‡æ‹Ÿåˆå¹¶å¢žå¼ºæ³›åŒ–ã€‚åœ¨å¤„ç†ä¸å¹³è¡¡æ•°æ®åœºæ™¯æ—¶ï¼Œè°ƒæ•´è¿™äº›å‚æ•°å¯ä»¥ç­–ç•¥æ€§åœ°æé«˜ç®—æ³•æ€§èƒ½ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ `DecisionTreeClassifier` è§£å†³æˆ‘ä»¬çš„åˆ†ç±»é—®é¢˜ï¼š

```py
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import PrecisionRecallDisplay
dt_clf = DecisionTreeClassifier(random_state=0, max_depth=6).fit(
Â Â Â Â X_train, y_train)
plot_decision_boundary(X,y,dt_clf,'DecisionTreeClassifier')
plt.show()
PrecisionRecallDisplay.from_estimator(
Â Â Â Â dt_clf, X_test, y_test, ax = plt.gca(),\
Â Â Â Â name = "DecisionTreeClassifier")
print(classification_report_imbalanced(
Â Â Â Â y_test,\
Â Â Â Â dt_clf.predict(X_test), \
Â Â Â Â target_names=['class 0', 'class 1']
Â Â Â Â )
)
computescores(dt_clf, X_test, y_test)
```

è¾“å‡ºçš„å†³ç­–è¾¹ç•Œæ¯”é€»è¾‘å›žå½’çš„æ›´å¤æ‚ï¼ˆ*å›¾ 5.9*ï¼‰ï¼Œæ›´å¥½åœ°åˆ†ç¦»äº†ä¸¤ä¸ªç±»åˆ«ï¼Œå¹¶ç»™å‡ºäº† F2 åˆ†æ•°ä¸º 0.932ï¼š

![](img/B17259_05_09.jpg)

å›¾ 5.9 â€“ å†³ç­–æ ‘åˆ†ç±»å™¨æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

æˆ‘ä»¬åœ¨ *å›¾ 5.10* ä¸­é‡çŽ°äº†é€»è¾‘å›žå½’æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œå’Œ PR æ›²çº¿ï¼Œä»¥è¿›è¡Œæ¯”è¾ƒï¼š

![](img/B17259_05_10.jpg)

å›¾ 5.10 â€“ ç”¨äºŽæ¯”è¾ƒçš„é€»è¾‘å›žå½’ï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

æˆ‘ä»¬å¯¹å†³ç­–æ ‘åˆ†ç±»å™¨çš„æ ‡å‡†æŒ‡æ ‡å¦‚ä¸‹ï¼š

```py
f2-score: 0.932 precision: 0.892 recall: 0.94
```

æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ `class_weight='balanced'` å‚æ•°ï¼š

```py
dt_clf_tuned = DecisionTreeClassifier(
Â Â Â Â class_weight = 'balanced', random_state=0, max_depth=6
).fit(X_train, y_train)
```

åœ¨ä½¿ç”¨ä¹‹å‰çš„ä»£ç ç»˜åˆ¶å†³ç­–è¾¹ç•Œã€PR æ›²çº¿å’Œè®¡ç®—åˆ†æ•°åŽï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š

![](img/B17259_05_11.jpg)

å›¾ 5.11 â€“ å†³ç­–æ ‘åˆ†ç±»å™¨æ¨¡åž‹çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ï¼‰

```py
f2-score: 0.934 precision: 0.770 recall: 0.987
```

è°ƒæ•´åŽçš„æƒé‡æé«˜äº† F2 åˆ†æ•°å’Œå¬å›žå€¼ã€‚

æµè¡Œæ¡†æž¶å¦‚ `scikit-learn` ä¹Ÿå…è®¸æˆ‘ä»¬æŒ‡å®š `sample_weight` ä½œä¸ºæ•°æ®é›†ä¸­æ¯ä¸ªè§‚å¯Ÿå€¼çš„æƒé‡åˆ—è¡¨ã€‚`sample_weight` å’Œ `class_weight` å‚æ•°å¯èƒ½ç›¸å½“ä»¤äººå›°æƒ‘ï¼Œå¹¶ä¸”å®ƒä»¬çš„ç›®çš„å¯èƒ½ä¸ä¼šä»Žå®ƒä»¬çš„æ–‡æ¡£ä¸­éžå¸¸æ¸…æ¥šåœ°äº†è§£ä½•æ—¶ä½¿ç”¨ä»€ä¹ˆã€‚ä»¥ä¸‹è¡¨æ ¼è¯´æ˜Žäº†ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«ï¼š

|  | `sample_weight` | `class_weight` |
| --- | --- | --- |
| **ç›®çš„** | ç”¨äºŽæŒ‡å®šå•ä¸ªç¤ºä¾‹çš„æƒé‡ã€‚å½“æŸäº›ç¤ºä¾‹æ¯”å…¶ä»–ç¤ºä¾‹æ›´é‡è¦æ—¶ï¼Œæ— è®ºå®ƒä»¬çš„ç±»åˆ«å¦‚ä½•ï¼Œéƒ½å¯èƒ½å¾ˆæœ‰ç”¨ã€‚å½“æŸäº›æ•°æ®æ›´å¯ä¿¡ï¼ˆä¾‹å¦‚ä½¿ç”¨å†…éƒ¨äººå·¥æ ‡æ³¨å™¨æ ‡æ³¨ï¼‰æ—¶ï¼Œå®ƒå¯ä»¥èŽ·å¾—æ›´é«˜çš„æƒé‡ã€‚å½“æ‚¨å¯¹æ‰¹å¤„ç†ä¸­çš„æ ·æœ¬æ²¡æœ‰ç›¸åŒçš„ä¿¡å¿ƒæ—¶ï¼Œè¿™å¯èƒ½å¾ˆæœ‰ç”¨ã€‚ | ç”¨äºŽçº æ­£ç±»åˆ«ä¸å¹³è¡¡ã€‚å½“ç¤ºä¾‹çš„é‡è¦æ€§å–å†³äºŽå®ƒä»¬çš„ç±»åˆ«æ—¶åº”è¯¥ä½¿ç”¨ã€‚ |
| **ç”¨æ³•** | å¯ä»¥åœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­ä½¿ç”¨ã€‚ç‰¹åˆ«é€‚ç”¨äºŽåœ¨å…·æœ‰ AUC ç­‰æŒ‡æ ‡çš„ä¸åŒæµ‹è¯•é›†ä¸Šæ¯”è¾ƒå¤šä¸ªæ¨¡åž‹æ—¶ï¼Œé€šå¸¸å¸Œæœ›å¹³è¡¡æµ‹è¯•é›†ï¼š`sklearn.metrics.confusion_matrix(â€¦, sample_weight)` `sklearn.linear_model` `.` `LogisticRegression()` `.` `score(â€¦,sample_weight)` | ä¸»è¦åœ¨è®­ç»ƒæœŸé—´ä½¿ç”¨ï¼Œä»¥æŒ‡å¯¼è®­ç»ƒã€‚è€ƒè™‘åˆ°æŸäº›ç±»åˆ«æ¯”å…¶ä»–ç±»åˆ«æ›´é‡è¦ï¼Œå› æ­¤ä¼šè®¡ç®—è¯¯åˆ†ç±»é”™è¯¯ï¼š`sklearn.linear_model` `.` `LogisticRegression(``class_weight`) |
| **åœ¨æ¨¡åž‹è®­ç»ƒæœŸé—´è®¾ç½®å€¼ä¸º 0 çš„å½±å“** | æ¨¡åž‹å°†ä¸ä¼šè€ƒè™‘`samples_weight=0`çš„ç¤ºä¾‹ï¼ˆæ— è®ºç¤ºä¾‹çš„ç±»åˆ«å¦‚ä½•ï¼‰ã€‚ | æ¨¡åž‹å°†ä¸ä¼šè€ƒè™‘å±žäºŽ`class_weight = 0`çš„ç±»åˆ«çš„ä»»ä½•ç¤ºä¾‹ã€‚æ­¤å¤–ï¼Œæ¨¡åž‹æ°¸è¿œä¸ä¼šé¢„æµ‹è¯¥ç±»åˆ«ã€‚ |
| **åº”ç”¨æ¡ˆä¾‹** | å½“é¢„æµ‹å®¢æˆ·æµå¤±æ—¶ï¼Œå¦‚æžœå¤±åŽ»æŸäº›å®¢æˆ·ä¼šå¯¹ä¸šåŠ¡äº§ç”Ÿæ›´å¤§çš„å½±å“ï¼Œå› ä¸ºä»–ä»¬å€¾å‘äºŽæ›´é¢‘ç¹åœ°è´­ä¹°æˆ–èŠ±è´¹æ›´å¤šï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨`sample_weight`ç»™è¿™äº›å®¢æˆ·æ›´é«˜çš„æƒé‡ã€‚ | å¦‚æžœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­ä¸€ä¸ªç±»åˆ«æ˜Žæ˜¾å¤šäºŽå…¶ä»–ç±»åˆ«ï¼Œä½¿ç”¨`class_weight`å¯ä»¥å¸®åŠ©æ¨¡åž‹æ›´å¤šåœ°å…³æ³¨ä»£è¡¨æ€§ä¸è¶³çš„ç±»åˆ«ã€‚ |

è¡¨ 5.2 â€“ scikit-learn åº“ä¸­çš„ sample_weight ä¸Ž class_weight

è­¦å‘Š

å¦‚æžœæˆ‘ä»¬ä½¿ç”¨`sample_weight`å’Œ`class_weight`ï¼Œä¸¤è€…éƒ½ä¼šç›¸ä¹˜ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™ä¸¤ä¸ªå‚æ•°çš„æ•ˆæžœã€‚è¿™ä¸¤ä¸ªå‚æ•°ä»ç„¶å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å¹³è¡¡ç±»åˆ«é‡è¦æ€§å’Œä¸ªä½“å®žä¾‹é‡è¦æ€§ï¼Œå¹¶å®žçŽ°å…¶é¢„æœŸç›®çš„ã€‚

ä½¿ç”¨`numpy`å¯ä»¥æ›´å®¹æ˜“åœ°åˆ›å»º`sample_weight`æ‰€éœ€çš„æƒé‡å€¼åˆ—è¡¨ï¼š`sample_weight = np.where(label==1, 80, 20)`ã€‚ç„¶è€Œï¼Œ`scikit-learn`æœ‰ä¸€ä¸ªåä¸º`sklearn.utils.class_weight.compute_sample_weight()`çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥è‡ªåŠ¨ä»Ž`class_weight`ä¼°è®¡`sample_weight`çš„å€¼ã€‚

`class_weight`ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«æ¯ä¸ªæ ‡ç­¾çš„å€¼æˆ–å¹³è¡¡å€¼ã€‚å¦‚æžœæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºå¹³è¡¡ï¼Œç±»åˆ«æƒé‡å°†ç”±`n_samples/(n_classes * np.bincount(y))`ç¡®å®šã€‚

`class_weight`è¿”å›žçš„å€¼æ˜¯ä¸€ä¸ªå­—å…¸ï¼š`{class_label: weight}`ï¼Œå¯¹äºŽæ¯ä¸ª`class_label`å€¼ã€‚

ç±»ä¼¼åœ°ï¼Œå¦‚æžœä½ éœ€è¦è¿›è¡Œå¤šæ ‡ç­¾åˆ†ç±»ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`sklearn.utils.class_weight.compute_sample_weight`ã€‚

ðŸš€ Airbnb ç”Ÿäº§ä¸­çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

åœ¨ Airbnb çš„ä¸€ä¸ªå®žé™…åº”ç”¨ä¸­[6]ï¼Œè¦è§£å†³çš„ä¸»è¦é—®é¢˜æ˜¯æé«˜æœç´¢å’Œå¯å‘çŽ°æ€§ä»¥åŠä»–ä»¬ä½“éªŒï¼ˆæ‰‹å·¥æ´»åŠ¨ï¼‰å¹³å°çš„ä¸ªæ€§åŒ–ã€‚éšç€ä½“éªŒæ•°é‡çš„å¢žåŠ ï¼Œæœ‰æ•ˆåœ°å¯¹è¿™äº›ä½“éªŒè¿›è¡ŒæŽ’åä»¥åŒ¹é…ç”¨æˆ·åå¥½å¹¶æé«˜é¢„è®¢å˜å¾—è‡³å…³é‡è¦ã€‚

Airbnb æ—¨åœ¨æé«˜å…¶æœç´¢æŽ’åï¼Œä¸ºç”¨æˆ·æä¾›æœ€ç›¸å…³å’Œé«˜è´¨é‡çš„ç»åŽ†ã€‚ä¸ºäº†æå‡å…¶æŽ’åæ¨¡åž‹çš„å“è´¨ï¼Œä»–ä»¬åœ¨ç›®æ ‡å‡½æ•°ä¸­ä½¿ç”¨äº†æ ·æœ¬æƒé‡ï¼ˆåœ¨ä¸Šä¸€èŠ‚ä¸­è®¨è®ºè¿‡ï¼‰ã€‚

é€šè¿‡ä½¿ç”¨æ ·æœ¬æƒé‡ï¼ˆåœ¨ä¸Šä¸€èŠ‚ä¸­è®¨è®ºè¿‡ï¼‰è§£å†³è®­ç»ƒæ•°æ®ä¸­çš„æ•°æ®ä¸å¹³è¡¡é—®é¢˜ã€‚åœ¨ç›®æ ‡å‡½æ•°ä¸­ï¼Œé«˜è´¨é‡çš„ç»åŽ†è¢«èµ‹äºˆæ›´é«˜çš„æƒé‡ï¼Œè€Œä½Žè´¨é‡çš„ç»åŽ†è¢«èµ‹äºˆè¾ƒä½Žçš„æƒé‡ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†åœ¨æœç´¢æŽ’åä¸­æŽ¨å¹¿é«˜è´¨é‡çš„ç»åŽ†ï¼Œå¹¶ä¸”ä»–ä»¬æˆåŠŸåœ°æé«˜äº†é«˜è´¨é‡ç»åŽ†çš„æŽ’åï¼Œå‡å°‘äº†ä½Žè´¨é‡ç»åŽ†ï¼Œè€Œæ²¡æœ‰å½±å“æ•´ä½“é¢„è®¢ï¼Œå¦‚ A/B æµ‹è¯•æ‰€è¯å®žã€‚

Airbnb è¿­ä»£åœ°å¼€å‘å’Œæµ‹è¯•å…¶æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œæœ€ç»ˆå°†å…¶é›†æˆåˆ°å…¶ç”Ÿäº§ç³»ç»Ÿä¸­ï¼Œä»¥å®žæ—¶å¯¹â€œä½“éªŒâ€è¿›è¡ŒæŽ’åã€‚ä»–ä»¬ç»åŽ†äº†å¤šä¸ªé˜¶æ®µï¼Œä»Žå»ºç«‹å¼ºå¤§çš„åŸºçº¿åˆ°ä¸ªæ€§åŒ–ã€åœ¨çº¿è¯„åˆ†ä»¥åŠå¤„ç†å„ç§ä¸šåŠ¡è§„åˆ™ã€‚

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ä¸€ç§å¯ä»¥å°†ä»»ä½•æ¨¡åž‹è½¬æ¢ä¸ºæˆæœ¬æ•æ„Ÿç‰ˆæœ¬çš„æŠ€æœ¯ï¼Œè€Œæ— éœ€æˆ‘ä»¬çŸ¥é“å…¶æŸå¤±å‡½æ•°æˆ–æ¨¡åž‹çš„å†…éƒ¨å·¥ä½œåŽŸç†ã€‚

# MetaCost â€“ ä½¿ä»»ä½•åˆ†ç±»æ¨¡åž‹æˆæœ¬æ•æ„Ÿ

MetaCost é¦–æ¬¡åœ¨ 1999 å¹´ç”± Pedro Domingos [7]å‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ä¸­æå‡ºã€‚MetaCost ä½œä¸ºæœºå™¨å­¦ä¹ ç®—æ³•çš„åŒ…è£…å™¨ï¼Œå°†åº•å±‚ç®—æ³•è½¬æ¢ä¸ºè‡ªèº«çš„æˆæœ¬æ•æ„Ÿç‰ˆæœ¬ã€‚å®ƒå°†åº•å±‚ç®—æ³•è§†ä¸ºé»‘ç›’ï¼Œä¸Žä¸ç¨³å®šç®—æ³•ï¼ˆå¦‚ä¸‹å®šä¹‰ï¼‰é…åˆæœ€ä½³ã€‚å½“ MetaCost é¦–æ¬¡æå‡ºæ—¶ï¼ŒCSL è¿˜å¤„äºŽæ—©æœŸé˜¶æ®µã€‚åªæœ‰å°‘æ•°ç®—æ³•ï¼Œå¦‚å†³ç­–æ ‘ï¼Œå·²è¢«è½¬æ¢ä¸ºå®ƒä»¬çš„æˆæœ¬æ•æ„Ÿç‰ˆæœ¬ã€‚å¯¹äºŽæŸäº›æ¨¡åž‹ï¼Œåˆ›å»ºæˆæœ¬æ•æ„Ÿç‰ˆæœ¬å˜å¾—å¾ˆå®¹æ˜“ï¼Œè€Œå¯¹äºŽå…¶ä»–æ¨¡åž‹ï¼Œåˆ™æ˜¯ä¸€é¡¹éžå¹³å‡¡çš„ä»»åŠ¡ã€‚å¯¹äºŽå®šä¹‰æ¨¡åž‹æˆæœ¬æ•æ„Ÿç‰ˆæœ¬å˜å¾—å›°éš¾çš„ç®—æ³•ï¼Œäººä»¬ä¸»è¦ä¾èµ–äºŽæ•°æ®é‡‡æ ·æŠ€æœ¯ï¼Œå¦‚è¿‡é‡‡æ ·æˆ–æ¬ é‡‡æ ·ã€‚è¿™å°±æ˜¯ Domingos æå‡ºäº†ä¸€ç§å°†å¤§é‡ç®—æ³•è½¬æ¢ä¸ºå®ƒä»¬çš„æˆæœ¬æ•æ„Ÿç‰ˆæœ¬çš„æ–¹æ³•ã€‚MetaCost å¯ä»¥ç”¨äºŽå¤šç±»åˆ†ç±»å’Œæ‰€æœ‰ç±»åž‹çš„æˆæœ¬çŸ©é˜µã€‚

ä¸ç¨³å®šç®—æ³•

å¦‚æžœä¸€ä¸ªç®—æ³•çš„åˆå§‹æ¡ä»¶ï¼ˆä¾‹å¦‚ï¼Œè®­ç»ƒæ•°æ®æˆ–åˆå§‹æƒé‡ï¼‰çš„å¾®å°å˜åŒ–å¯ä»¥å¯¼è‡´æ¨¡åž‹äº§ç”Ÿå¤§çš„å˜åŒ–ï¼Œåˆ™ç§°è¯¥ç®—æ³•ä¸ºä¸ç¨³å®š[8]ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å« 1,000 ä¸ªé¡¹ç›®çš„æ•°æ®é›†ã€‚ä¸€ä¸ªç¨³å®šçš„æ¨¡åž‹ï¼Œå¦‚**K-æœ€è¿‘é‚»**ï¼ˆ**KNN**ï¼‰ï¼Œå¦‚æžœä½ ä»Žæ•°æ®é›†ä¸­ç§»é™¤ä¸€ä¸ªé¡¹ç›®ï¼Œå®ƒä¸ä¼šæ”¹å˜å¤ªå¤šã€‚ç„¶è€Œï¼Œå¦‚æžœä½ ç”¨ 999 ä¸ªé¡¹ç›®è€Œä¸æ˜¯ 1,000 ä¸ªé¡¹ç›®æ¥è®­ç»ƒä¸€ä¸ªå†³ç­–æ ‘æ¨¡åž‹ï¼Œå®ƒå¯èƒ½ä¼šå®Œå…¨é‡æž„ã€‚

è®©æˆ‘ä»¬æ·±å…¥æŽ¢è®¨ MetaCost ç®—æ³•çš„æœºåˆ¶ï¼Œå¦‚å›¾ 5.12 æ‰€ç¤ºï¼š

![å›¾ç‰‡](img/B17259_05_12.jpg)

å›¾ 5.12 â€“ MetaCost ç®—æ³•

MetaCost é€šè¿‡ç»“åˆ bagging çš„æ¦‚å¿µä¸Žè¯¯åˆ†ç±»æˆæœ¬çŸ©é˜µæ¥å·¥ä½œï¼š

1.  é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºåŽŸå§‹æ•°æ®çš„å¤šä¸ª bootstrap æ ·æœ¬ã€‚

1.  å¯¹äºŽæ¯ä¸ª bootstrap æ ·æœ¬ï¼Œæˆ‘ä»¬è®­ç»ƒç»™å®šæ¨¡åž‹çš„ä¸€ä¸ªæ–°å‰¯æœ¬ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸Ž bagging ç›¸åŒã€‚ä½ å¯ä»¥åœ¨å›¾ 5.12 å·¦ä¾§çœ‹åˆ°å‰ä¸¤ä¸ªæ­¥éª¤ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä»ŽåŽŸå§‹æ•°æ®ä¸­åˆ›å»º bootstrap æ ·æœ¬ S1ã€S2 å’Œ S3ã€‚ç„¶åŽï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨æ ·æœ¬ï¼ˆS1ã€S2 å’Œ S3ï¼‰ä¸Šè®­ç»ƒæ¨¡åž‹ L1ã€L2 å’Œ L3ã€‚

1.  æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŽŸå§‹æ•°æ® S é€å…¥ç”± L1ã€L2 å’Œ L3 ç»„æˆçš„é›†æˆä¸­ã€‚

1.  æˆ‘ä»¬å°†æ¥è‡ªæˆæœ¬çŸ©é˜µçš„è¯¯åˆ†ç±»æˆæœ¬ä¸Žé›†æˆé¢„æµ‹çš„ç±»åˆ«æ¦‚çŽ‡ç›¸ä¹˜ï¼Œä»¥èŽ·å¾—å®žé™…æˆæœ¬ã€‚è¿™æ˜¾ç¤ºåœ¨å›¾ 5.12 çš„å³ä¾§ã€‚

1.  ç„¶åŽï¼Œæˆ‘ä»¬é‡æ–°æ ‡è®°æ•°æ®ï¼Œä½¿å¾—æ–°çš„ç±»åˆ«æ ‡ç­¾æœ€å°åŒ–å®žé™…æˆæœ¬ã€‚

1.  æœ€åŽï¼Œæˆ‘ä»¬åœ¨é‡æ–°æ ‡è®°çš„æ•°æ®ä¸Šè®­ç»ƒäº†ä¸€ä¸ªæ–°æ¨¡åž‹çš„å‰¯æœ¬ã€‚è¿™ä¸ªæ¨¡åž‹å‰¯æœ¬è¢«ç”¨ä½œæœ€ç»ˆæ¨¡åž‹ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ *å›¾ 5.13* ä¸­çœ‹åˆ°ä½¿ç”¨ MetaCost é‡æ–°æ ‡è®°æ•°æ®çš„è¿‡ç¨‹ï¼š

![](img/B17259_05_13.jpg)

å›¾ 5.13 â€“ ä½¿ç”¨ MetaCost é‡æ–°æ ‡è®°æ•°æ®çš„è¿‡ç¨‹

åœ¨ *å›¾ 5.13* çš„å·¦ä¾§ï¼Œæˆ‘ä»¬æœ‰åŽŸå§‹æ•°æ®ã€‚æ˜Ÿæ˜Ÿæ˜¯å°‘æ•°ç±»ç¤ºä¾‹ï¼Œæ­£æ–¹å½¢æ˜¯å¤šæ•°ç±»ç¤ºä¾‹ã€‚åœ¨è¿™é‡Œï¼Œæ‰€æœ‰åœ¨æ¤­åœ†å½¢å†…çš„æ ·æœ¬éƒ½è¢«é¢„æµ‹ä¸ºæ˜Ÿæ˜Ÿï¼Œæ‰€æœ‰åœ¨æ¤­åœ†å½¢å¤–çš„æ ·æœ¬éƒ½è¢«é¢„æµ‹ä¸ºæ­£æ–¹å½¢ã€‚å·¦ä¾§çš„æ¤­åœ†å½¢æ˜¯æ ¹æ®å¯¹æ‰€æœ‰é”™è¯¯å…·æœ‰ç›¸åŒè¯¯åˆ†ç±»æˆæœ¬çš„å‡è®¾ç»˜åˆ¶çš„ã€‚åœ¨ä¸­é—´ï¼Œæˆ‘ä»¬æ ¹æ®å®žé™…è¯¯åˆ†ç±»æˆæœ¬ç»˜åˆ¶çš„ä¸€ä¸ªæ‹‰é•¿çš„æ¤­åœ†å½¢åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç±»åˆ«è¾¹ç•Œã€‚è¯·æ³¨æ„ï¼ŒçŽ°åœ¨æ‰€æœ‰çš„æ˜Ÿæ˜Ÿéƒ½è¢«æ­£ç¡®åˆ†ç±»äº†ã€‚åŒæ—¶ï¼Œè¯·æ³¨æ„ï¼ŒçŽ°åœ¨ä¸€äº›æ­£æ–¹å½¢è¢«é”™è¯¯åœ°åˆ†ç±»ä¸ºæ˜Ÿæ˜Ÿã€‚è¿™æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºæ˜Ÿæ˜Ÿçš„è¯¯åˆ†ç±»æˆæœ¬è¿œé«˜äºŽæ­£æ–¹å½¢ã€‚åœ¨æ­¤é˜¶æ®µï¼ŒMetaCost å°†è¿™äº›è¢«é”™è¯¯åˆ†ç±»çš„æ­£æ–¹å½¢é‡æ–°æ ‡è®°ä¸ºæ˜Ÿæ˜Ÿã€‚æœ€åŽï¼ŒMetaCost åœ¨é‡æ–°æ ‡è®°çš„æ•°æ®ä¸Šè®­ç»ƒäº†ä¸€ä¸ªæ¨¡åž‹ã€‚ç”±äºŽå®¹æ˜“è¢«è¯¯è®¤ä¸ºæ˜¯å°‘æ•°ç±»çš„å¤šæ•°ç±»ç¤ºä¾‹å·²è¢«é‡æ–°æ ‡è®°ä¸ºå±žäºŽå°‘æ•°ç±»ï¼Œå› æ­¤æœ€ç»ˆçš„æ¨¡åž‹ä¸å¤ªå¯èƒ½å°†å°‘æ•°ç±»çš„å®žä¾‹æ ‡è®°é”™è¯¯ã€‚

ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæˆ‘ä»¬çœç•¥äº† MetaCost ç®—æ³•çš„å®žçŽ°ã€‚æ‚¨å¯ä»¥åœ¨æœ¬ç« çš„ GitHub ä»“åº“ä¸­æ‰¾åˆ°å®ƒã€‚

æˆ‘ä»¬å°†åº”ç”¨è¯¥ç®—æ³•åˆ°é€»è¾‘å›žå½’æ¨¡åž‹ä¸­ã€‚MetaCost ä½¿ç”¨ä¸€ä¸ªä»£ä»·çŸ©é˜µï¼Œè¿™æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚ä»£ä»·çŸ©é˜µä¸­çš„å€¼å¯¹åº”äºŽæ··æ·†çŸ©é˜µï¼ˆ*è¡¨ 5.1*ä¸­æ··æ·†çŸ©é˜µçš„è½¬ç½®ï¼‰ä¸­å„é¡¹çš„æƒé‡æˆ–æˆæœ¬ï¼š

C = (TN FN FP TPÂ )

å‡è®¾æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¯¹å‡é˜³æ€§å’Œå‡é˜´æ€§å…·æœ‰ç›¸åŒæˆæœ¬çš„ä»£ä»·çŸ©é˜µï¼ˆå³å•ä½çŸ©é˜µï¼‰ï¼š

```py
C = np.array([[0, 1], [1, 0]])
```

*å›¾ 5.14* å±•ç¤ºäº†å†³ç­–è¾¹ç•Œå’ŒæŒ‡æ ‡ï¼Œå®ƒä»¬ä¸Žé€»è¾‘å›žå½’åˆ†ç±»å™¨çš„ç»“æžœï¼ˆ*å›¾ 5.10*ï¼‰éžå¸¸æŽ¥è¿‘ï¼š

![](img/B17259_05_14.jpg)

å›¾ 5.14 â€“ å…·æœ‰å•ä½ä»£ä»·çŸ©é˜µçš„é€»è¾‘å›žå½’æ¨¡åž‹ MetaCost å˜ç§çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ä¾§ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ä¾§ï¼‰

æˆ‘ä»¬å¯ä»¥æ ¹æ®è®­ç»ƒæ•°æ®çš„å¤±è¡¡æ¯”çŽ‡ä¼°è®¡ä»£ä»·çŸ©é˜µï¼š

```py
C = np.array([[0, 66], [1, 0]])
```

*å›¾ 5.15* å±•ç¤ºäº†è¾“å‡ºå†³ç­–å‡½æ•°å’Œ PR æ›²çº¿ï¼š

![](img/B17259_05_15.jpg)

å›¾ 5.15 â€“ å…·æœ‰æ›´ä¼˜ä»£ä»·çŸ©é˜µçš„é€»è¾‘å›žå½’æ¨¡åž‹ MetaCost å˜ç§çš„å†³ç­–è¾¹ç•Œï¼ˆå·¦ä¾§ï¼‰å’Œ PR æ›²çº¿ï¼ˆå³ä¾§ï¼‰

è™½ç„¶ä¸ŽåŸºçº¿ç›¸æ¯” F2 åˆ†æ•°æœ‰æ‰€ä¸‹é™ï¼Œä½†å¬å›žçŽ‡ç¡®å®žå¤§å¹…æé«˜ã€‚

MetaCost ç®—æ³•ä¸­çš„å„ç§æ­¥éª¤ï¼Œå¦‚é‡æ–°æ ‡è®°æ•´ä¸ªè®­ç»ƒé›†ï¼Œå¯èƒ½ç›¸å½“æ˜‚è´µï¼Œè¿™å¯èƒ½ä¼šé˜»æ­¢æˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®é›†å¾ˆå¤§æ—¶ä½¿ç”¨è¿™ç§æŠ€æœ¯ã€‚

æˆæœ¬æ•æ„Ÿçš„é›†æˆæŠ€æœ¯

AdaCost [9]ã€AdaUBoost [10]å’Œ AsymBoost [11]æ˜¯ AdaBoost æ¨¡åž‹çš„æˆæœ¬æ•æ„Ÿä¿®æ”¹ã€‚AdaCost åœ¨è¿­ä»£è®­ç»ƒè¿‡ç¨‹ä¸­æœ€å°åŒ–è¯¯åˆ†ç±»æˆæœ¬ã€‚AdaUBoost é€šè¿‡å¼ºè°ƒå°‘æ•°ç±»æ¥å¤„ç†ä¸å¹³è¡¡æ•°æ®é›†ã€‚AsymBoost ä¸“æ³¨äºŽå‡å°‘æœ€æ˜‚è´µçš„è¯¯åˆ†ç±»ã€‚å®ƒä»¬éƒ½åœ¨è€ƒè™‘è¯¯åˆ†ç±»æˆæœ¬çš„åŒæ—¶è°ƒæ•´æƒé‡ã€‚

è¿™äº›ç®—æ³•èƒŒåŽçš„åŸºæœ¬åŽŸç†æ˜¯ï¼Œé™¤äº†å¯¹è¯¯åˆ†ç±»æˆæœ¬å¤§çš„å®žä¾‹åˆ†é…é«˜åˆå§‹æƒé‡å¤–ï¼Œæ›´æ–°æƒé‡çš„è§„åˆ™ä¹Ÿåº”è€ƒè™‘æˆæœ¬ã€‚è¿™æ„å‘³ç€åº”è¯¥å¢žåŠ æ˜‚è´µè¯¯åˆ†ç±»çš„æƒé‡ï¼ŒåŒæ—¶å‡å°‘æ­£ç¡®åˆ†ç±»çš„æƒé‡ã€‚

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¦ä¸€ç§æˆæœ¬æ•æ„Ÿçš„å…ƒå­¦ä¹ æŠ€æœ¯ï¼Œç§°ä¸ºé˜ˆå€¼è°ƒæ•´ã€‚

# é˜ˆå€¼è°ƒæ•´

å†³ç­–é˜ˆå€¼æ˜¯ä¸€ä¸ªéžå¸¸é‡è¦çš„æ¦‚å¿µï¼Œéœ€è¦å¯†åˆ‡å…³æ³¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æƒ…å†µï¼š

+   é¢„æµ‹æ¦‚çŽ‡ >= 0.5 è¡¨ç¤ºç±»åˆ« 1

+   é¢„æµ‹æ¦‚çŽ‡ < 0.5 è¡¨ç¤ºç±»åˆ« 0

ç„¶è€Œï¼Œé˜ˆå€¼æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å…ƒå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±è°ƒæ•´ã€‚*è¡¨ 5.3*æ˜¾ç¤ºäº†æ¨¡åž‹é¢„æµ‹ä¸ŽçœŸå®žæ ‡ç­¾çš„é¢„æµ‹ã€‚

å¦‚æžœæˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼ 0.5ï¼Œå‡†ç¡®çŽ‡ä¸º 2/4 = 50%ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æžœæˆ‘ä»¬é€‰æ‹©çš„é˜ˆå€¼æ˜¯ 0.80ï¼Œå‡†ç¡®çŽ‡ä¸º 100%ã€‚è¿™è¡¨æ˜Žæ‰€é€‰é˜ˆå€¼çš„é‡è¦æ€§ï¼š

| **é¢„æµ‹è¾“å‡º** | **çœŸå®žè¾“å‡º** |
| --- | --- |
| 0.65 | 0 |
| 0.75 | 0 |
| 0.85 | 1 |
| 0.95 | 1 |

è¡¨ 5.3 â€“ ä¸€ä¸ªæ˜¾ç¤ºæ¨¡åž‹é¢„æµ‹è¾“å‡ºä¸ŽçœŸå®žè¾“å‡ºï¼ˆæ ‡ç­¾ï¼‰çš„è¡¨æ ¼

å¤§å¤šæ•°æŒ‡æ ‡ï¼Œå¦‚å‡†ç¡®çŽ‡ã€ç²¾ç¡®çŽ‡ã€å¬å›žçŽ‡å’Œ F1 åˆ†æ•°ï¼Œéƒ½æ˜¯é˜ˆå€¼ç›¸å…³æŒ‡æ ‡ã€‚

å¦ä¸€æ–¹é¢ï¼Œå¦‚ ROC æ›²çº¿å’Œ PR æ›²çº¿è¿™æ ·çš„æŒ‡æ ‡æ˜¯é˜ˆå€¼æ— å…³çš„ï¼Œè¿™æ„å‘³ç€è¿™äº›å›¾è¡¨è¯„ä¼°çš„æ˜¯æ¨¡åž‹åœ¨æ‰€æœ‰å¯èƒ½çš„é˜ˆå€¼ä¸‹çš„æ€§èƒ½ï¼Œè€Œä¸æ˜¯å•ä¸ªå›ºå®šçš„é˜ˆå€¼ã€‚

åœ¨å¤„ç†æœºå™¨å­¦ä¹ æŒ‡æ ‡ï¼Œå¦‚ F1 æˆ–å‡†ç¡®çŽ‡æ—¶ï¼Œäº†è§£é˜ˆå€¼å€¼çš„ä½œç”¨å¾ˆé‡è¦ã€‚è¿™äº›æŒ‡æ ‡é»˜è®¤ä½¿ç”¨ 0.5 çš„é˜ˆå€¼ã€‚å› æ­¤ï¼Œå°¤å…¶æ˜¯å¯¹äºŽæ–°æ‰‹å’Œä¸­çº§æœºå™¨å­¦ä¹ ä»Žä¸šè€…ï¼Œä¼šäº§ç”Ÿä¸€ç§è¯¯è§£ï¼Œè®¤ä¸ºè¿™äº›æŒ‡æ ‡ä¸å¯é¿å…åœ°ä¸Žè¿™ä¸ªç‰¹å®šçš„é˜ˆå€¼ç›¸å…³è”ã€‚

ç„¶è€Œï¼Œè¿™å¯èƒ½å¯¼è‡´å¯¹æ¨¡åž‹æ€§èƒ½çš„ä¸å‡†ç¡®è§£é‡Šï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠä¸å¹³è¡¡æ•°æ®é›†çš„åœºæ™¯ä¸­ã€‚æŒ‡æ ‡çš„é€‰æ‹©å’Œå†³ç­–é˜ˆå€¼çš„ç¡®å®šæ˜¯ç‹¬ç«‹çš„é€‰æ‹©ï¼Œåº”è¯¥è¿™æ ·å¤„ç†ã€‚ç¡®å®šé€‚å½“çš„é˜ˆå€¼æ˜¯è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªå…³é”®æ­¥éª¤ï¼Œåº”è¯¥ç‹¬ç«‹äºŽæ‰€é€‰çš„æŒ‡æ ‡æ¥è€ƒè™‘ã€‚

æ­¤å¤–ï¼Œä»…ä»…ä¾èµ–äºŽé»˜è®¤çš„é˜ˆå€¼ 0.5 å¯èƒ½ä¼šäº§ç”Ÿè¯¯å¯¼ã€‚é˜ˆå€¼åº”æ ¹æ®é¡¹ç›®çš„å…·ä½“è¦æ±‚å’Œæ•°æ®çš„æ€§è´¨æ¥è®¾ç½®ã€‚å› æ­¤ï¼Œæœºå™¨å­¦ä¹ ä»Žä¸šè€…ç†è§£é˜ˆå€¼ä¸Žæ‰€é€‰æŒ‡æ ‡ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œä»¥å‡†ç¡®è¯„ä¼°å…¶æ¨¡åž‹æ€§èƒ½è‡³å…³é‡è¦ã€‚

åœ¨äºŒå…ƒåˆ†ç±»ä¸­ï¼Œæ”¹å˜é˜ˆå€¼å°†å¾ˆå®¹æ˜“æ”¹å˜é˜ˆå€¼ç›¸å…³çš„æŒ‡æ ‡ï¼Œå¦‚å‡†ç¡®åº¦ã€F1 åˆ†æ•°ã€TPR æˆ– FPRã€‚è®¸å¤šç ”ç©¶[12][13]æåˆ°äº†é˜ˆå€¼è°ƒæ•´çš„ä»·å€¼ï¼Œå°¤å…¶æ˜¯åœ¨è®­ç»ƒæ•°æ®ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ã€‚Provost [14]çš„ä¸€ç¯‡è®ºæ–‡æŒ‡å‡ºï¼Œä½¿ç”¨æœªè°ƒæ•´è¾“å‡ºé˜ˆå€¼çš„æ¨¡åž‹å¯èƒ½æ˜¯ä¸€ä¸ªä¸¥é‡çš„é”™è¯¯ã€‚åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼ŒBuda ç­‰äºº[15]è¡¨æ˜Žï¼Œä½¿ç”¨**éšæœºè¿‡é‡‡æ ·**ï¼ˆ**ROS**ï¼‰å¹¶ç»“åˆé˜ˆå€¼å¤„ç†ï¼Œåœ¨ç”± CIFAR å’Œ MNIST åˆ›å»ºçš„ä¸å¹³è¡¡æ•°æ®é›†ä¸Šä¼˜äºŽç®€å•çš„ ROSã€‚æ— è®ºæ•°æ®æ˜¯å¦ä¸å¹³è¡¡ï¼Œé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„é˜ˆå€¼å¯ä»¥åœ¨æ¨¡åž‹çš„æ€§èƒ½ä¸Šäº§ç”Ÿå¾ˆå¤§çš„å·®å¼‚ã€‚

è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¼˜åŒ–æˆ‘ä»¬çš„é˜ˆå€¼ç›¸å…³æŒ‡æ ‡ï¼ˆä¾‹å¦‚ F1 åˆ†æ•°ï¼‰çš„é˜ˆå€¼ã€‚åœ¨è¿™é‡Œï¼Œæ‰¾åˆ° F1 åˆ†æ•°æœ€å¤§çš„é˜ˆå€¼ï¼ˆ*å›¾ 5.16*ï¼‰ï¼š

![å›¾ç‰‡](img/B17259_05_16.jpg)

å›¾ 5.16 â€“ ä¸€ä¸ªå…·æœ‰æœ€ä½³é˜ˆå€¼çš„ PR æ›²çº¿ï¼Œè¯¥é˜ˆå€¼æ‰¾åˆ°æœ€å¤§çš„ F1 åˆ†æ•°ï¼ˆè¯·å‚é˜…æœ¬ç«  GitHub ä»“åº“ä¸­çš„ç¬”è®°æœ¬ï¼‰

*å›¾ 5.17* å±•ç¤ºäº†ä¸€ä¸ªå›¾è¡¨ï¼Œè¯´æ˜Žäº†ä¿®æ”¹å†³ç­–é˜ˆå€¼å¯¹ä¸å¹³è¡¡æ•°æ®é›†çš„å„ç§åˆ†ç±»æŒ‡æ ‡çš„å½±å“ï¼š**çœŸæ­£ä¾‹çŽ‡**ï¼ˆ**TPR**æˆ–å¬å›žçŽ‡ï¼‰ã€**çœŸè´Ÿä¾‹çŽ‡**ï¼ˆ**TNR**ï¼‰ã€**å‡æ­£ä¾‹çŽ‡**ï¼ˆ**FPR**ï¼‰å’Œç²¾ç¡®åº¦ã€‚æ‰€ä½¿ç”¨çš„æ¨¡åž‹æ˜¯æ²¡æœ‰ä»»ä½•ç±»åˆ«æƒé‡æˆ–å¯¹å°‘æ•°ç±»æ•æ„Ÿæ€§çš„é€»è¾‘å›žå½’ã€‚æœ‰å…³å®Œæ•´ç¬”è®°æœ¬ï¼Œè¯·å‚é˜…æœ¬ç« çš„ GitHub ä»“åº“ï¼š

![å›¾ç‰‡](img/B17259_05_17.jpg)

å›¾ 5.17 â€“ ä¸åŒåˆ†ç±»æŒ‡æ ‡ï¼ˆTPRã€TNRã€FPRã€ç²¾ç¡®åº¦ã€F1 åˆ†æ•°å’Œå‡†ç¡®åº¦ï¼‰ä½œä¸ºå†³ç­–é˜ˆå€¼çš„å‡½æ•°çš„å›¾è¡¨

å…³äºŽè¿™äº›å›¾è¡¨ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹è§‚å¯Ÿï¼š

+   **ç²¾ç¡®åº¦**ï¼šå¦‚æžœé˜ˆå€¼å¢žåŠ ï¼Œç²¾ç¡®åº¦ï¼ˆ Â TPÂ _________________Â Â æ€»é¢„æµ‹ä¸ºæ­£çš„æ¬¡æ•°ï¼‰é€šå¸¸ä¼šä¸Šå‡ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºéšç€é˜ˆå€¼çš„å¢žåŠ ï¼Œæ€»é¢„æµ‹ä¸ºæ­£çš„æ¬¡æ•°ä¼šå‡å°‘ï¼Œå› æ­¤ï¼Œéšç€åˆ†æ¯çš„å‡å°‘ï¼Œç²¾ç¡®åº¦å¢žåŠ ã€‚åŒæ ·ï¼Œç›¸åçš„æƒ…å†µä¹Ÿæ˜¯æ­£ç¡®çš„ï¼šå¦‚æžœé˜ˆå€¼é™ä½Žï¼Œç²¾ç¡®åº¦ä¹Ÿä¼šé™ä½Žã€‚

+   **å¬å›žçŽ‡**ï¼šè®©æˆ‘ä»¬çœ‹çœ‹é˜ˆå€¼å˜åŒ–å¯¹å¬å›žçŽ‡çš„å½±å“ã€‚å¬å›žçŽ‡å®šä¹‰ä¸º Â TPÂ ____________Â Â æ€»æ­£ä¾‹æ•°ï¼Œåˆ†æ¯æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚éšç€é˜ˆå€¼çš„é™ä½Žï¼ŒTP å¯èƒ½ä¼šå¢žåŠ ï¼Œé€šå¸¸ä¼šæé«˜å¬å›žçŽ‡ã€‚

+   **çœŸæ­£ä¾‹çŽ‡**ï¼ˆ**TNR**ï¼‰ï¼šTNR è¡¡é‡çš„æ˜¯å®žé™…è´Ÿä¾‹ä¸­è¢«æ­£ç¡®è¯†åˆ«ä¸ºè´Ÿä¾‹çš„æ¯”ä¾‹ã€‚åœ¨ä¸å¹³è¡¡çš„æ•°æ®é›†ä¸­ï¼Œå¦‚æžœè´Ÿç±»æ˜¯å¤šæ•°ç±»ï¼Œä¸€ä¸ªç®€å•æˆ–è¡¨çŽ°ä¸ä½³çš„åˆ†ç±»å™¨å¯èƒ½å› ä¸ºå¯¹æ‰€æœ‰æˆ–å¤§å¤šæ•°å®žä¾‹é¢„æµ‹å¤šæ•°ç±»è€Œå…·æœ‰å¾ˆé«˜çš„ TNRã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTNR å¯èƒ½ä¼šè¯¯å¯¼æ€§åœ°å¾ˆé«˜ã€‚

+   **è¯¯æŠ¥çŽ‡**ï¼ˆ**FPR**ï¼‰ï¼šè¿™æ˜¯å°†è´Ÿå®žä¾‹é”™è¯¯åœ°åˆ†ç±»ä¸ºæ­£å®žä¾‹çš„æ¯”çŽ‡ã€‚åœ¨ä¸å¹³è¡¡çš„æ•°æ®é›†ä¸­ï¼Œä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨ï¼Œå¦‚æžœå°†æ‰€æœ‰å®žä¾‹éƒ½é¢„æµ‹ä¸ºå¤šæ•°ç±»ï¼ˆè´Ÿç±»ï¼‰ï¼Œå…¶ FPR å°†æŽ¥è¿‘ 0ã€‚

é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨é€‰æ‹©æœ€ä½³å†³ç­–é˜ˆå€¼æ—¶ï¼Œéœ€è¦åœ¨ TPRï¼ˆçœŸæ­£ä¾‹çŽ‡ï¼‰å’Œ TNRï¼ˆçœŸè´Ÿä¾‹çŽ‡ï¼‰ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œå¦‚å›¾ 5**.17**æ‰€ç¤ºã€‚

ðŸš€ Shopify åœ¨ç”Ÿäº§ä¸­çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ 

åœ¨ Shopify çš„å®žé™…åº”ç”¨ä¸­[16]ï¼Œå¹³å°é¢ä¸´ç€ä¸ºæˆç™¾ä¸‡çš„å•†å®¶å¯¹å„ç§å•†å“è¿›è¡Œåˆ†ç±»çš„æŒ‘æˆ˜ã€‚å‡†ç¡®çš„äº§å“åˆ†ç±»å¯¹äºŽå¢žå¼ºæœç´¢å’Œå‘çŽ°åŠŸèƒ½ä»¥åŠå‘å•†å®¶æä¾›ä¸ªæ€§åŒ–è¥é”€æ´žå¯Ÿè‡³å…³é‡è¦ã€‚é‰´äºŽäº§å“æ•°é‡åºžå¤§ä¸”ç§ç±»ç¹å¤šï¼Œæ‰‹åŠ¨åˆ†ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚æœºå™¨å­¦ä¹ æŠ€æœ¯è¢«ç”¨äºŽè‡ªåŠ¨åŒ–åˆ†ç±»è¿‡ç¨‹ï¼Œä»¥é€‚åº”ä¸æ–­æ‰©å±•å’Œå¤šæ ·åŒ–çš„äº§å“èŒƒå›´ã€‚æ‰€ä½¿ç”¨çš„æ•°æ®é›†é«˜åº¦ä¸å¹³è¡¡ï¼Œè¿™ä¸»è¦æ˜¯ç”±äºŽ Shopify é‡‡ç”¨çš„**è°·æ­Œäº§å“åˆ†ç±»æ³•**ï¼ˆ**GPT**ï¼‰çš„å±‚çº§ç»“æž„ã€‚GPT æ‹¥æœ‰è¶…è¿‡ 5,500 ä¸ªç±»åˆ«ï¼Œè¿™ç»™ä¸€ä¸ªå·²ç»å…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜å¢žåŠ äº†å¤æ‚æ€§ã€‚

ä¸ºäº†è§£å†³æ•°æ®ä¸å¹³è¡¡çš„é—®é¢˜ï¼Œå®žæ–½äº†ç±»æƒé‡ã€‚é€šè¿‡åˆ†é…ç±»æƒé‡ï¼Œæ¨¡åž‹å¯ä»¥å¯¹ä»£è¡¨æ€§ä¸è¶³çš„ç±»åˆ«ä¸­çš„é”™è¯¯é¢„æµ‹æ–½åŠ æ›´é«˜çš„æƒ©ç½šï¼Œä»Žè€Œæœ‰æ•ˆåœ°ç¼“è§£è¿™äº›ç±»åˆ«ä¸­æ•°æ®ä¸è¶³çš„é—®é¢˜ã€‚æ¨¡åž‹ç»è¿‡å¾®è°ƒï¼Œä»¥åœ¨å±‚çº§ç²¾åº¦å’Œå¬å›žçŽ‡ä¹‹é—´å–å¾—å¹³è¡¡ã€‚è¿™ç§å¾®è°ƒæ˜¯åŸºäºŽç‰¹å®šçš„ä¸šåŠ¡ç”¨ä¾‹ï¼Œæ—¨åœ¨é€šè¿‡æœ€å°åŒ–è´Ÿé¢äº¤äº’å’Œæ‘©æ“¦æ¥æå‡å•†å®¶ä½“éªŒã€‚å¯¹ç½®ä¿¡é˜ˆå€¼è¿›è¡Œäº†æ‰‹åŠ¨è°ƒæ•´ï¼ˆè¿™è¡¨æ˜Žé˜ˆå€¼è°ƒæ•´åœ¨çŽ°å®žä¸–ç•Œä¸­æ˜¯å¤šä¹ˆç›¸å…³ï¼ï¼‰ï¼Œä»¥ç¡®ä¿åœ¨â€œå®—æ•™å’Œä»ªå¼â€ç­‰æ•æ„Ÿç±»åˆ«ä¸­å®žçŽ°æœ€ä½³æ€§èƒ½ã€‚å¹³è¡¡äº†å„ç§æŒ‡æ ‡ï¼Œå¦‚å±‚çº§å‡†ç¡®çŽ‡ã€ç²¾ç¡®çŽ‡ã€å¬å›žçŽ‡å’Œ F1 åˆ†æ•°ï¼Œä»¥ä½¿æ¨¡åž‹æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚è¯¥æ¨¡åž‹çŽ°åœ¨è¢«å¤šä¸ªå†…éƒ¨å›¢é˜Ÿå’Œåˆä½œä¼™ä¼´ç”Ÿæ€ç³»ç»Ÿç§¯æžç”¨äºŽå¼€å‘è¡ç”Ÿæ•°æ®äº§å“ã€‚

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŽ¢è®¨è°ƒæ•´è¿™äº›é˜ˆå€¼çš„å„ç§æ–¹æ³•ã€‚

## é˜ˆå€¼è°ƒæ•´æ–¹æ³•

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ—¨åœ¨ä¼˜åŒ–ç‰¹å®šçš„ä¸šåŠ¡æŒ‡æ ‡æˆ–æ ‡å‡†æœºå™¨å­¦ä¹ æŒ‡æ ‡ï¼Œè¿™è¦æ±‚æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªæœ€å¤§åŒ–æ„Ÿå…´è¶£æŒ‡æ ‡çš„é˜ˆå€¼ã€‚åœ¨æ–‡çŒ®ä¸­ï¼Œè®¨è®ºäº†å„ç§é˜ˆå€¼è°ƒæ•´æ–¹æ³•ï¼Œä¾‹å¦‚å°†é˜ˆå€¼è®¾ç½®ä¸ºè§‚å¯Ÿæ­£ä¾‹çš„ä¼˜å…ˆæ¦‚çŽ‡ï¼Œä½¿ç”¨ ROC æ›²çº¿ä¼˜åŒ–é«˜ TPR å’Œä½Ž FPRï¼Œæˆ–ä½¿ç”¨ PR æ›²çº¿æœ€å¤§åŒ– F1 åˆ†æ•°æˆ– Fbeta åˆ†æ•°ï¼ˆè§*å›¾ 5**.18*ï¼‰ï¼š

![](img/B17259_05_18.jpg)

å›¾ 5.18 â€“ è°ƒæ•´é˜ˆå€¼çš„æµè¡Œæ–¹æ³•

æˆ‘ä»¬å°†é€ä¸€è®¨è®ºè¿™äº›æ–¹æ³•ã€‚

æˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ç›¸åŒæ•°æ®é›†ã€‚ä»¥ä¸‹ä»£ç å—æ‹Ÿåˆé€»è¾‘å›žå½’æ¨¡åž‹å¹¶èŽ·å–æµ‹è¯•é›†çš„é¢„æµ‹æ¦‚çŽ‡ï¼š

```py
lr = LogisticRegression(max_iter=1000)
lr.fit(X_train, y_train)
y_pred = lr.predict_proba(X_test)
y_pred = y_pred[:, 1]
```

### ä½¿ç”¨å…ˆéªŒé˜ˆå€¼è¿›è¡Œé˜ˆå€¼è°ƒæ•´

ä¸€ä¸ªæ˜Žæ˜¾çš„é˜ˆå€¼å¯ä»¥ä½¿ç”¨çš„æ˜¯è®­ç»ƒæ•°æ®é›†ä¸­æ­£ç±»æ¦‚çŽ‡çš„å€¼[10]ã€‚è®©æˆ‘ä»¬å®žçŽ°è¿™ä¸ªæƒ³æ³•ï¼š

```py
num_pos, num_neg = Counter(y)[1], Counter(y)[0]
prior_threshold = num_pos /(num_pos + num_neg)
print('Prior threshold=%f'% prior_threshold)
# Find the closest threshold from thresholds from ROC curve
fpr, tpr, thresholds = roc_curve(y_test, y_pred)
min_threshold_index = np.absolute( \
Â Â Â Â thresholds-prior_threshold).argmin()
print('Best threshold using prior threshold from ROC \
Â Â Â Â function=%f'% thresholds[min_threshold_index])
print("TPR at threshold=%f" % tpr[min_threshold_index])
print("FPR at threshold=%f" % fpr[min_threshold_index])
print("TNR at threshold=%f" % (1-fpr[min_threshold_index]))
```

è¿™å°†æ‰“å°ä»¥ä¸‹é˜ˆå€¼ï¼š

```py
Prior threshold=0.014900
Best threshold using prior threshold from ROC function=0.014232
TPR value at the threshold=0.675676
FPR value at the threshold=0.147990
TNR value at the threshold=0.852010
```

### ä½¿ç”¨ ROC æ›²çº¿è¿›è¡Œé˜ˆå€¼è°ƒæ•´

å¯¹äºŽ ROC æ›²çº¿ï¼Œå¯ä»¥ä½¿ç”¨å°¤ç™»çš„ J ç»Ÿè®¡é‡[17]æ¥æ‰¾åˆ°æœ€ä¼˜é˜ˆå€¼ã€‚å°¤ç™»çš„ J ç»Ÿè®¡é‡åœ¨ä¸´åºŠé¢†åŸŸæœ‰æ ¹æºï¼Œæ˜¯ä¸€ä¸ªæ•èŽ·è¯Šæ–­æµ‹è¯•æ€§èƒ½çš„å•ä¸ªç»Ÿè®¡é‡ã€‚åœ¨äºŒå…ƒåˆ†ç±»çš„èƒŒæ™¯ä¸‹ï¼Œç»Ÿè®¡é‡ J å®šä¹‰ä¸ºä»¥ä¸‹ï¼š

J = çµæ•åº¦ + ç‰¹å¼‚æ€§ âˆ’ 1 = TPR + TNR âˆ’ 1 = TPR âˆ’ FPR

å…¶å€¼å¯ä»¥ä»Ž-1ï¼ˆTPR=0 å’Œ TNR=0 â€“ å³ï¼Œæ€»æ˜¯é”™è¯¯çš„ç»“æžœï¼‰åˆ° 1ï¼ˆTPR=1 å’Œ FPR=0 â€“ å³ï¼Œå®Œç¾Žç»“æžœï¼‰ä¸ç­‰ã€‚è¿™æ˜¯åœ¨ ROC åˆ†æžä¸­é€‰æ‹©é˜ˆå€¼çš„ä¸€ä¸ªå¸¸è§é€‰æ‹©ï¼Œå› ä¸ºå®ƒå¹³è¡¡äº†çµæ•åº¦ï¼ˆTPRï¼‰å’Œç‰¹å¼‚æ€§ï¼ˆTNRï¼‰ã€‚è¯·æ³¨æ„ï¼ŒTNR = 1-FPRã€‚

æœ€å¤§åŒ–å°¤ç™»æŒ‡æ•° J çš„åŽŸå› ç­‰åŒäºŽé€‰æ‹©æœ€ä¼˜é˜ˆå€¼ï¼Œå› ä¸ºå®ƒæœ¬è´¨ä¸Šæ˜¯åœ¨ ROC æ›²çº¿ä¸Šæ‰¾åˆ°ç¦»æ— æ­§è§†çº¿ï¼ˆå¯¹è§’çº¿ï¼‰æœ€è¿œçš„ç‚¹ã€‚è¿™æ„å‘³ç€å®ƒé€‰æ‹©ä¸€ä¸ªåœ¨ TPR å’Œ FPR ä¹‹é—´å–å¾—å¹³è¡¡çš„é˜ˆå€¼ï¼Œè¿™é€šå¸¸æ˜¯æˆ‘ä»¬åœ¨åˆ†ç±»å™¨ä¸­æƒ³è¦çš„ã€‚

â€œæœ€ä¼˜â€é˜ˆå€¼å¯èƒ½ä¸¥é‡ä¾èµ–äºŽæˆ‘ä»¬ç‰¹å®šåº”ç”¨ä¸­å‡é˜³æ€§ä¸Žå‡é˜´æ€§çš„æˆæœ¬ã€‚ä»¥ä¸‹ä»£ç å—ä½¿ç”¨å°¤ç™»æŒ‡æ•°è¯†åˆ«æœ€ä¼˜åˆ†ç±»é˜ˆå€¼ï¼Œè¯¥æŒ‡æ•°æ˜¯ä»Ž ROC æ›²çº¿è®¡ç®—å¾—å‡ºçš„ï¼š

```py
fpr, tpr, thresholds = roc_curve(y_test, y_pred)
youden_index = tpr - fpr
max_youden_index = np.argmax(youden_index)
best_thresh = thresholds[max_youden_index]
print('Best threshold using Youden index=%f'% best_thresh)
print('Max Youden index value=%f'% youden_index[max_youden_index])
print("TPR value at the threshold=%f" % tpr[max_youden_index])
print("FPR value at the threshold=%f" % fpr[max_youden_index])
print("TNR value at the threshold=%f" % (1-fpr[max_youden_index]))
```

è¿™å°†è¾“å‡ºä»¥ä¸‹å€¼ï¼š

```py
Best threshold using Youden index=0.098879
Max Youden index value=0.622143
TPR value at the threshold=0.635135
FPR value at the threshold=0.012992
TNR value at the threshold=0.987008
```

å¦ä¸€ç§å¸¸ç”¨äºŽæ–‡çŒ®ä¸­çš„é˜ˆå€¼è°ƒæ•´æ–¹æ³•ï¼Œå®ƒä½¿ç”¨ ROC æ›²çº¿ï¼Œå³æœ€å¤§åŒ– TPRï¼ˆä¹Ÿç§°ä¸ºçµæ•åº¦ï¼‰å’Œ TNRï¼ˆä¹Ÿç§°ä¸ºç‰¹å¼‚æ€§ï¼‰çš„å‡ ä½•å¹³å‡å€¼ï¼š

G âˆ’ mean = âˆšÂ __________________Â Â çµæ•åº¦ * ç‰¹å¼‚æ€§Â  = âˆšÂ _TPR * TNRÂ  = âˆšÂ ______________Â Â TPR * (1 âˆ’ FPR)

æœ€å¤§åŒ–å‡ ä½•å¹³å‡å€¼ç­‰åŒäºŽåœ¨ TPR å’Œ TNR ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªè‰¯å¥½çš„å¹³è¡¡ã€‚ä»¥ä¸‹ä»£ç å—ä½¿ç”¨ G-mean æŒ‡æ ‡è®¡ç®—åˆ†ç±»çš„æœ€ä½³é˜ˆå€¼ï¼Œä»¥åŠå…¶ç›¸åº”çš„ TPRã€FPR å’Œ TNR å€¼ã€‚æˆ‘ä»¬ä»Ž`sklearn.metrics`å¯¼å…¥`roc_curve`ï¼š

```py
fpr, tpr, thresholds = roc_curve(y_test, y_pred)
gmean = np.sqrt(tpr*(1-fpr))
max_gmean_index = np.argmax(gmean)
best_thresh = thresholds[max_gmean_index]
print('Best threshold using G-mean=%f'% (best_thresh))
print('Max G-mean value=%f'% (gmean[max_gmean_index]))
print("TPR value at the threshold=%f" % tpr[max_gmean_index])
print("FPR value at the threshold=%f" % fpr[max_gmean_index])
print("TNR value at the threshold=%f" % (1 - fpr[max_youden_index]))
```

è¿™å°†è¾“å‡ºä»¥ä¸‹æœ€ä¼˜å€¼ï¼š

```py
Best threshold using G-mean=0.098879
Max G-mean value=0.791760
TPR value at the threshold=0.635135
FPR value at the threshold=0.012992
TNR value at the threshold=0.987008
```

### ä½¿ç”¨ PR æ›²çº¿è¿›è¡Œé˜ˆå€¼è°ƒæ•´

æ­£å¦‚æˆ‘ä»¬åœ¨*ç¬¬ä¸€ç« *ï¼Œâ€œæœºå™¨å­¦ä¹ ä¸­çš„æ•°æ®ä¸å¹³è¡¡ä»‹ç»â€ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œå½“æ­£ç±»æ¯”è´Ÿç±»æ›´é‡è¦æ—¶ï¼ŒPR æ›²çº¿é€šå¸¸æ¯” ROC æ›²çº¿æ›´é€‚åˆä¸å¹³è¡¡æ•°æ®é›†ã€‚ä½œä¸ºæé†’ï¼Œç®€å•çš„åŽŸå› æ˜¯ PR æ›²çº¿å¿½ç•¥äº†çœŸæ­£çš„è´Ÿä¾‹ï¼Œå› æ­¤ï¼Œå®ƒå¯ä»¥åœ¨ä½¿ç”¨ä¸å¹³è¡¡æ•°æ®é›†ä¸Žå¹³è¡¡æ•°æ®é›†ç›¸æ¯”æ—¶ï¼Œè¡¨ç¤ºæ¨¡åž‹æ€§èƒ½çš„æ˜¾è‘—å·®å¼‚ã€‚è™½ç„¶éšç€æ•°æ®ä¸å¹³è¡¡çš„å¢žåŠ ï¼ŒROC æ›²çº¿ä¸ä¼šå˜åŒ–å¤ªå¤šï¼Œä½†å¦‚æžœä¸¤ä¸ªç±»åˆ«éƒ½åŒæ ·é‡è¦ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚

æˆ‘ä»¬å¸Œæœ›ç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œç†æƒ³æƒ…å†µä¸‹éƒ½æ˜¯ 1ã€‚å› æ­¤ï¼ŒPR æ›²çº¿ä¸Šçš„ä¼˜åŒ–ç‚¹æ˜¯ï¼ˆ1ï¼Œ1ï¼‰ã€‚

å½“æˆ‘ä»¬åç¦»è¿™ä¸ªä¼˜åŒ–ç‚¹æ—¶ï¼Œç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡çš„å€¼éƒ½ä¼šé™ä½Žï¼Œæˆ‘ä»¬å°±ä¸é‚£ä¹ˆä¼˜åŒ–äº†ã€‚

ä¸€ç§æ•æ‰ç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡ä¹‹é—´æƒè¡¡çš„åº¦é‡æ˜¯ F1 åˆ†æ•°ã€‚F1 åˆ†æ•°è¢«å®šä¹‰ä¸ºç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡çš„è°ƒå’Œå¹³å‡å€¼ï¼š

F1 = 2 * (Precision * Recall) / (Precision + Recall)

å¦‚æžœæˆ‘ä»¬åˆ†æžè¿™ä¸ªæ–¹ç¨‹ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å½“ç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡éƒ½æ˜¯ 1 æ—¶ï¼ŒF1 åˆ†æ•°æœ€é«˜ï¼ˆåœ¨ 1 å¤„è¾¾åˆ°æœ€å¤§å€¼ï¼‰ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ PR æ›²çº¿ä¸Šå®šä¹‰çš„ä¼˜åŒ–ç‚¹ã€‚

å› æ­¤ï¼Œä¼˜åŒ–æœ€å¤§ F1 åˆ†æ•°å°†ç¡®ä¿æˆ‘ä»¬åŠªåŠ›æœ€å¤§åŒ–ç²¾ç¡®çŽ‡å’Œå¬å›žçŽ‡ï¼Œæœ‰æ•ˆåœ°æŽ¨åŠ¨æˆ‘ä»¬å‘ PR æ›²çº¿ä¸Šçš„ä¼˜åŒ–ç‚¹é è¿‘ã€‚

æœ€å¤§åŒ– F1 åˆ†æ•°æ˜¯ç¡®å®šæœ€ä½³é˜ˆå€¼çš„ä¸€ç§å¸¸è§ä¸”æœ‰æ•ˆçš„æ–¹æ³•ã€‚ä»¥ä¸‹ä»£ç å—ä½¿ç”¨ä»Ž PR æ›²çº¿æ´¾ç”Ÿçš„ F1 åˆ†æ•°åº¦é‡è®¡ç®—æœ€ä½³é˜ˆå€¼ï¼š

```py
from numpy import argmax
from sklearn.metrics import precision_recall_curve
precision, recall, thresholds = precision_recall_curve(y_test, y_pred)
fscore = 2*precision*recall/(precision+recall)
max_fscore_idx = argmax(fscore)
print('max_fscore_idx==%d' % max_fscore_idx)
print('best threshold using PR curve=%f' % thresholds[max_fscore_idx])
```

è¿™ä¼šè¾“å‡ºä»¥ä¸‹ä¼˜åŒ–å€¼ï¼š

```py
max_fscore_idx==4950
best threshold using PR curve=0.258727
max(fscore)= 0.661290
```

è®©æˆ‘ä»¬ç»˜åˆ¶å…·æœ‰æœ€ä½³é˜ˆå€¼å€¼çš„ PR æ›²çº¿ï¼š

```py
pyplot.plot(recall, precision, marker='.', \
Â Â Â Â label='precision vs recall for various thresholds')
result = pyplot.scatter(recall[max_fscore_idx], \
Â Â Â Â precision[max_fscore_idx], \
Â Â Â Â marker='x', color='red', \
Â Â Â Â label='Best threshold with highest\
Â Â Â Â f1-score')
plt.legend(handles=result.legend_elements()[0], \
Â Â Â Â labels="legend", loc='upper center', \
Â Â Â Â bbox_to_anchor=(1, 1))
pyplot.xlabel('recall')
pyplot.ylabel('precision')
```

PR æ›²çº¿çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

![å›¾ç‰‡](img/B17259_05_19.jpg)

å›¾ 5.19 â€“ æœ€ä½³ F1 åˆ†æ•°é˜ˆå€¼å€¼çš„ PR æ›²çº¿

### ä¸€èˆ¬é˜ˆå€¼è°ƒæ•´

ä½œä¸ºä¸€ç§ä¸€èˆ¬æ–¹æ³•ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¼˜åŒ–ä»»ä½•åº¦é‡ï¼Œå¦‚å¹³å‡ç²¾ç¡®åº¦ã€å‡†ç¡®åº¦ç­‰ï¼Œæˆ–ä»»ä½•å…¶ä»–ä¸šåŠ¡åº¦é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥ç›´æŽ¥ä¼˜åŒ–è¯¥åº¦é‡ã€‚è®©æˆ‘ä»¬ä»¥ I. Unal ç­‰äººåœ¨å…¶ç ”ç©¶[18]ä¸­å®šä¹‰çš„**è”åˆæŒ‡æ•°**ï¼ˆ**IU**ï¼‰åº¦é‡ä¸ºä¾‹ï¼Œå…¶ä¸­åº¦é‡ç”±ä½¿ IU(c)æœ€å°åŒ–çš„é˜ˆå€¼å€¼ c å®šä¹‰ï¼š

IU(c) = (|Sensitivity(c) âˆ’ ROC _ AUC| + |Specificity(c) âˆ’ ROC _ AUC|)

åœ¨è¿™é‡Œï¼ŒSensitivity(c)æ˜¯ c å¤„çš„çµæ•åº¦ï¼ŒSpecificity æ˜¯ c å¤„çš„ç‰¹å¼‚æ€§ï¼ŒROC _ AUC æ˜¯ ROC å›¾çš„**æ›²çº¿ä¸‹é¢ç§¯**ï¼ˆ**AUC**ï¼‰ã€‚

è®©æˆ‘ä»¬å®žçŽ° IU åº¦é‡ï¼Œå¦‚è¿™é‡Œå®šä¹‰çš„ï¼Œä½œä¸ºä¸€ä¸ªè‡ªå®šä¹‰åº¦é‡æ¥æ‰¾åˆ°æœ€å°åŒ–å®ƒçš„æœ€ä½³é˜ˆå€¼ï¼š

```py
from sklearn.metrics import f1_score, auc
def custom_metric(y_test, y_pred):
Â Â Â Â fpr, tpr, thresholds = roc_curve(y_test, y_pred)
Â Â Â Â sensitivity = tpr
Â Â Â Â specificity = 1-fpr #same as tnr
Â Â Â Â roc_auc = auc(fpr, tpr)
Â Â Â Â index_of_union = abs(sensitivity-roc_auc) + \
Â Â Â Â Â Â Â Â abs(specificity-roc_auc)
Â Â Â Â return index_of_union
scores = custom_metric(y_test, y_pred)
min_score_idx = np.argmin(scores)
print('max_score_idx=%d' % min_score_idx)
print('best threshold=%f'% thresholds[min_score_idx])
print('minimum IU-value at the best threshold=%f' % \
Â Â Â Â scores[min_score_idx])
```

è¿™ä¼šäº§ç”Ÿä»¥ä¸‹ä¼˜åŒ–å€¼ï¼š

```py
max_score_idx=34
best threshold=0.000042
minimum IU-value at the best threshold=0.112514
```

è¿™æ ‡å¿—ç€æˆ‘ä»¬å¯¹ç»å…¸å»ºæ¨¡æŠ€æœ¯çš„è®¨è®ºç»“æŸã€‚æˆ‘ä»¬çŽ°åœ¨å‡†å¤‡è¿›å…¥ç ”ç©¶æ·±åº¦å­¦ä¹ é¢†åŸŸä¸­çš„æ•°æ®ä¸å¹³è¡¡ã€‚æˆ‘ä»¬å°†æŽ¢è®¨ä»Žä¸Šä¸€ç« å­¦ä¹ çš„ä¸€èˆ¬æŠ€æœ¯å¦‚ä½•é€‚åº”ä»¥å¢žå¼ºæˆ‘ä»¬å¤„ç†ä¸å¹³è¡¡æ•°æ®æ—¶çš„æ·±åº¦å­¦ä¹ æ¨¡åž‹ã€‚

# æ‘˜è¦

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æŽ¢è®¨äº† CSLï¼ˆç»„åˆè¿‡é‡‡æ ·å’Œæ¬ é‡‡æ ·ï¼‰ï¼Œä½œä¸ºä¸€ç§æ›¿ä»£æ–¹æ¡ˆã€‚ä¸Žå°†æ‰€æœ‰è¯¯åˆ†ç±»é”™è¯¯åŒç­‰å¯¹å¾…çš„æ•°æ®çº§åˆ«æŠ€æœ¯ä¸åŒï¼ŒCSL è°ƒæ•´æ¨¡åž‹çš„æˆæœ¬å‡½æ•°ï¼Œä»¥è€ƒè™‘ä¸åŒç±»åˆ«çš„æ˜¾è‘—æ€§ã€‚å®ƒåŒ…æ‹¬ç±»åˆ«åŠ æƒå’Œå…ƒå­¦ä¹ æŠ€æœ¯ã€‚

ç±»ä¼¼äºŽ`scikit-learn`ã€Keras/TensorFlow å’Œ PyTorch è¿™æ ·çš„åº“æ”¯æŒæˆæœ¬æ•æ„Ÿå­¦ä¹ ã€‚ä¾‹å¦‚ï¼Œ`scikit-learn`æä¾›äº†ä¸€ä¸ª`class_weight`è¶…å‚æ•°æ¥è°ƒæ•´æŸå¤±è®¡ç®—ä¸­çš„ç±»åˆ«æƒé‡ã€‚XGBoost æœ‰ä¸€ä¸ª`scale_pos_weight`å‚æ•°ç”¨äºŽå¹³è¡¡æ­£è´Ÿæƒé‡ã€‚MetaCost é€šè¿‡ä½¿ç”¨è¢‹è£…å’Œè¯¯åˆ†ç±»æˆæœ¬çŸ©é˜µå°†ä»»ä½•ç®—æ³•è½¬æ¢ä¸ºæˆæœ¬æ•æ„Ÿç‰ˆæœ¬ã€‚æ­¤å¤–ï¼Œé˜ˆå€¼è°ƒæ•´æŠ€æœ¯å¯ä»¥é€šè¿‡åŽå¤„ç†æ¨¡åž‹é¢„æµ‹æ¥å¢žå¼º F1 åˆ†æ•°ã€ç²¾ç¡®åº¦å’Œå¬å›žçŽ‡ç­‰æŒ‡æ ‡ã€‚

ä½¿ç”¨å„ç§æ•°æ®é‡‡æ ·å’Œ CSL æŠ€æœ¯çš„å®žéªŒå¯ä»¥å¸®åŠ©ç¡®å®šæœ€ä½³æ–¹æ³•ã€‚æˆ‘ä»¬å°†åœ¨*ç¬¬å…«ç« *ä¸­æ‰©å±•è¿™äº›æ¦‚å¿µï¼Œå³*ç®—æ³•çº§æ·±åº¦å­¦ä¹ æŠ€æœ¯*ã€‚è¿™æ ‡å¿—ç€æˆ‘ä»¬å¯¹ç»å…¸æœºå™¨å­¦ä¹ æ¨¡åž‹çš„è®¨è®ºç»“æŸï¼Œæˆ‘ä»¬å·²ç»æ¯•ä¸šåˆ°æ·±å…¥å­¦ä¹ æŠ€æœ¯ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦ä»‹ç»æ·±åº¦å­¦ä¹ æ¦‚å¿µï¼Œå¹¶çœ‹çœ‹ä¸å¹³è¡¡æ•°æ®é›†åœ¨æ·±åº¦å­¦ä¹ ä¸–ç•Œä¸­å¯èƒ½æˆä¸ºé—®é¢˜ã€‚

# é—®é¢˜

1.  åœ¨ä½¿ç”¨æœ¬ç« ä¸­ä½¿ç”¨çš„ç›¸åŒæ•°æ®é›†çš„åŒæ—¶ï¼Œå°† CSL æŠ€æœ¯åº”ç”¨äºŽ`scikit-learn`ä¸­çš„ SVM æ¨¡åž‹ã€‚ä½¿ç”¨`class_weight`å’Œ`sample_weight`å‚æ•°ï¼Œç±»ä¼¼äºŽæˆ‘ä»¬åœ¨æœ¬ç« ä¸­ç”¨äºŽå…¶ä»–æ¨¡åž‹çš„æ–¹å¼ã€‚æ¯”è¾ƒæ­¤æ¨¡åž‹ä¸Žæœ¬ç« ä¸­å·²ç»é‡åˆ°çš„æ¨¡åž‹çš„è¡¨çŽ°ã€‚

1.  LightGBM æ˜¯å¦ä¸€ä¸ªç±»ä¼¼äºŽ XGBoost çš„æ¢¯åº¦æå‡æ¡†æž¶ã€‚åœ¨æœ¬ç« ä½¿ç”¨çš„æ•°æ®é›†ä¸Šåº”ç”¨æˆæœ¬æ•æ„Ÿå­¦ä¹ æŠ€æœ¯åˆ° LightGBM æ¨¡åž‹ã€‚ä½¿ç”¨`class_weight`å’Œ`sample_weight`å‚æ•°ï¼Œç±»ä¼¼äºŽæˆ‘ä»¬åœ¨æœ¬ç« ä¸­ç”¨äºŽå…¶ä»–æ¨¡åž‹çš„æ–¹å¼ã€‚æ¯”è¾ƒæ­¤æ¨¡åž‹ä¸Žæœ¬ç« ä¸­å·²ç»é‡åˆ°çš„æ¨¡åž‹çš„è¡¨çŽ°ã€‚

1.  AdaCost [10] æ˜¯ä¸€ç§ç»“åˆäº†æå‡å’Œ CSL çš„ AdaBoost å˜ä½“ã€‚å®ƒé€šè¿‡åˆ©ç”¨è¯¯åˆ†ç±»æˆæœ¬æ¥æ›´æ–°è¿žç»­æå‡è½®æ¬¡çš„è®­ç»ƒåˆ†å¸ƒã€‚å°†`scikit-learn`ä¸­çš„`AdaBoostClassifier`æ‰©å±•ä»¥å®žçŽ° AdaCost ç®—æ³•ã€‚æ¯”è¾ƒ AdaCost ä¸Ž MetaCost åœ¨æœ¬ç« ä½¿ç”¨çš„æ•°æ®é›†ä¸Šçš„æ€§èƒ½ã€‚

1.  è°ƒæ•´ XGBoost æ¨¡åž‹çš„è¶…å‚æ•°ï¼Œç‰¹åˆ«æ˜¯`max_depth`ã€`max_delta_step`å’Œ`min_child_weight`ï¼Œä½¿ç”¨æœ¬ç« ä¸­ä½¿ç”¨çš„æ•°æ®é›†ã€‚è°ƒæ•´åŽï¼Œè¯„ä¼°åŠ æƒ XGBoost æ¨¡åž‹æ˜¯å¦ä¼˜äºŽéžåŠ æƒç‰ˆæœ¬ã€‚

# å‚è€ƒæ–‡çŒ®

1.  P. Turney, *å½’çº³æ¦‚å¿µå­¦ä¹ ä¸­çš„æˆæœ¬ç±»åž‹*, åœ¨ç¬¬ 17 å±Šå›½é™…æœºå™¨å­¦ä¹ ä¼šè®®çš„æˆæœ¬æ•æ„Ÿå­¦ä¹ ç ”è®¨ä¼šè®ºæ–‡é›†ï¼Œæ–¯å¦ç¦å¤§å­¦ï¼ŒåŠ åˆ©ç¦å°¼äºšå·žï¼ˆ2000 å¹´ï¼‰ï¼Œç¬¬ 15â€“21 é¡µã€‚

1.  C. X. Ling å’Œ V. S. Sheng, *æˆæœ¬æ•æ„Ÿå­¦ä¹ å’Œç±»* *ä¸å¹³è¡¡é—®é¢˜*.

1.  Sheng, V. S.ï¼Œ& Ling, C. X. (2006). *ä¸ºäº†ä½¿åˆ†ç±»å™¨æˆæœ¬æ•æ„Ÿçš„é˜ˆå€¼æ–¹æ³•*. AAAIâ€™06: ç¬¬ 21 å±Šå…¨å›½äººå·¥æ™ºèƒ½ä¼šè®®è®ºæ–‡é›†ï¼Œç¬¬ 6 å·ï¼Œç¬¬ 476â€“481 é¡µã€‚

1.  *å„¿ç«¥è‚ºç‚Žç»Ÿè®¡æ•°æ®* â€“ è”åˆå›½å„¿ç«¥åŸºé‡‘ä¼šæ•°æ®ï¼š[`data.unicef.org/topic/child-health/pneumonia/`](https://data.unicef.org/topic/child-health/pneumonia/).

1.  X. Ling, W. Deng, C. Gu, H. Zhou, C. Li, å’Œ F. Sun, åœ¨ç¬¬ 26 å±Šå›½é™…ä¸‡ç»´ç½‘ä¼šè®®ï¼ˆWWW '17ï¼‰çš„ä¼´éšä¼šè®®è®ºæ–‡é›†ä¸­ï¼ŒBing æœç´¢å¹¿å‘Šçš„ç‚¹å‡»é¢„æµ‹æ¨¡åž‹é›†æˆï¼Œç€æ–¯ï¼Œæ¾³å¤§åˆ©äºšï¼šACM å‡ºç‰ˆç¤¾ï¼Œ2017 å¹´ï¼Œç¬¬ 689â€“698 é¡µã€‚doi: 10.1145/3041021.3054192.

1.  *æœºå™¨å­¦ä¹ é©±åŠ¨çš„ Airbnb ä½“éªŒæœç´¢æŽ’å*ï¼ˆ2019 å¹´ï¼‰ï¼Œ[`medium.com/airbnb-engineering/machine-learning-powered-search-ranking-of-airbnb-experiences-110b4b1a0789`](https://medium.com/airbnb-engineering/machine-learning-powered-search-ranking-of-airbnb-experiences-110b4b1a0789).

1.  P. Domingos, MetaCost: ä¸€ç§ä½¿åˆ†ç±»å™¨æˆæœ¬æ•æ„Ÿçš„é€šç”¨æ–¹æ³•ï¼Œåœ¨çŸ¥è¯†å‘çŽ°ä¸Žæ•°æ®æŒ–æŽ˜å›½é™…ä¼šè®®è®ºæ–‡é›†ä¸­ï¼Œç¬¬ 155â€“164 é¡µï¼Œ1999 å¹´ã€‚

1.  *ä¸ç¨³å®šçš„å­¦ä¹ è€…*. åœ¨ï¼šSammut, C.ï¼ŒWebb, G.I. (eds) æœºå™¨å­¦ä¹ ä¸Žæ•°æ®æŒ–æŽ˜ç™¾ç§‘å…¨ä¹¦ã€‚Springerï¼Œæ³¢å£«é¡¿ï¼Œé©¬è¨è¯¸å¡žå·žã€‚doi: [`doi.org/10.1007/978-1-4899-7687-1_866`](https://doi.org/10.1007/978-1-4899-7687-1_866).

1.  W. Fan, S. J. Stolfo, J. Zhang, å’Œ P. K. Chan, *AdaCost: è¯¯åˆ†ç±»* *æˆæœ¬æ•æ„Ÿçš„ Boosting*.

1.  G. I. Karakoulas å’Œ J. Shawe-Taylor, *ä¼˜åŒ–ä¸å¹³è¡¡* *è®­ç»ƒé›†* çš„åˆ†ç±»å™¨*.

1.  P. Viola å’Œ M. Jones, *ä½¿ç”¨éžå¯¹ç§° AdaBoost å’Œ* *æ£€æµ‹çº§è”* *è¿›è¡Œå¿«é€Ÿå’Œé²æ£’çš„åˆ†ç±»*.

1.  J. M. Johnson å’Œ T. M. Khoshgoftaar, *é›†æˆå­¦ä¹ è€…çš„è¾“å‡ºé˜ˆå€¼å’Œç±»ä¸å¹³è¡¡å¤§æ•°æ®*, åœ¨ 2021 å¹´ IEEE ç¬¬ 33 å±Šå›½é™…äººå·¥æ™ºèƒ½å·¥å…·ä¼šè®®ï¼ˆICTAIï¼‰ä¸­ï¼ŒåŽç››é¡¿ç‰¹åŒºï¼Œç¾Žå›½ï¼šIEEEï¼Œ2021 å¹´ 11 æœˆï¼Œç¬¬ 1449â€“1454 é¡µã€‚doi: 10.1109/ICTAI52525.2021.00230.

1.  J. M. Johnson å’Œ T. M. Khoshgoftaar, *åœ¨ 2019 å¹´ç¬¬ 18 å±Š IEEE å›½é™…æœºå™¨å­¦ä¹ ä¸Žåº”ç”¨ä¼šè®®ï¼ˆICMLAï¼‰ä¸­ï¼Œå…³äºŽç±»ä¸å¹³è¡¡å¤§æ•°æ®çš„æ·±åº¦å­¦ä¹ å’Œé˜ˆå€¼å¤„ç†*, ä½›ç½—é‡Œè¾¾å·žåšå¡æ‹‰é¡¿ï¼Œç¾Žå›½ï¼Œ2019 å¹´ 12 æœˆï¼Œç¬¬ 755â€“762 é¡µã€‚doi: 10.1109/ICMLA.2019.00134.

1.  F. Provost, *ä¸å¹³è¡¡æ•°æ®é›†çš„æœºå™¨å­¦ä¹ * *å…¥é—¨*.

1.  M. Buda, A. Maki, å’Œ M. A. Mazurowski, *å·ç§¯ç¥žç»ç½‘ç»œä¸­ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜çš„ç³»ç»Ÿç ”ç©¶*, ç¥žç»ç½‘ç»œï¼Œç¬¬ 106 å·ï¼Œç¬¬ 249â€“259 é¡µï¼Œ2018 å¹´ 10 æœˆï¼Œdoi: 10.1016/j.neunet.2018.07.011.

1.  *ä½¿ç”¨ä¸°å¯Œå›¾åƒå’Œæ–‡æœ¬æ•°æ®å¤§è§„æ¨¡åˆ†ç±»äº§å“*ï¼ˆ2021 å¹´ï¼‰ï¼Œ[`shopify.engineering/using-rich-image-text-data-categorize-products`](https://shopify.engineering/using-rich-image-text-data-categorize-products).

1.  W. J. Youden, *è¯Šæ–­æµ‹è¯•è¯„åˆ†æŒ‡æ•°*ï¼Œç™Œç—‡ï¼Œç¬¬ 3 å·ï¼Œç¬¬ 1 æœŸï¼Œç¬¬ 32â€“35 é¡µï¼Œ1950 å¹´ï¼Œdoi: 10.1002/1097-0142(1950)3:1<32::AID-CNCR2820030106>3.0.CO;2-3.

1.  I. Unal, *åœ¨ ROC åˆ†æžä¸­å®šä¹‰æœ€ä½³åˆ‡å‰²ç‚¹å€¼ï¼šä¸€ç§æ›¿ä»£æ–¹æ³•*ï¼Œè®¡ç®—ä¸Žæ•°å­¦åœ¨åŒ»å­¦ä¸­çš„åº”ç”¨ï¼Œç¬¬ 2017 å·ï¼Œç¬¬ 1â€“14 é¡µï¼Œ2017 å¹´ï¼Œdoi: 10.1155/2017/3762651.

1.  X. Ling, W. Deng, C. Gu, H. Zhou, C. Li, å’Œ F. Sun, *ç”¨äºŽ Bing æœç´¢å¹¿å‘Šç‚¹å‡»é¢„æµ‹çš„æ¨¡åž‹é›†æˆ*, åœ¨ç¬¬ 26 å±Šå›½é™…ä¸‡ç»´ç½‘å¤§ä¼šä¼´éšä¼šè®®â€”â€”WWW '17 ä¼´éšä¼šè®®è®ºæ–‡é›†ä¸­ï¼Œç€æ–¯ï¼Œæ¾³å¤§åˆ©äºšï¼šACM å‡ºç‰ˆç¤¾ï¼Œ2017 å¹´ï¼Œç¬¬ 689â€“698 é¡µã€‚doi: 10.1145/3041021.3054192.
