- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: Responsible AI
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 负责任AI
- en: One of the recent research areas to emerge in **artificial intelligence** (**AI**)
    is making models responsible and accountable, thus producing accurate results,
    as opposed to biased or incomplete results. This is a new area of computer science,
    but it is also something many in the data science field are looking into. Microsoft
    is concentrating its efforts on a number of areas, including **Fairness**, **Reliability
    and Safety**, **Privacy** **and** **Security**, **Inclusiveness**, **Transparency**,
    and **Accountability**. Microsoft has provided a toolbox that can be used and
    applied to datasets and models to address these topics. In this chapter, we will
    be exploring what these terms mean and how Microsoft’s Responsible AI Toolbox
    can be leveraged to address these concerns.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在人工智能（**AI**）领域最近出现的研究领域之一是使模型具有责任感和可问责性，从而产生准确的结果，而不是产生有偏见或不完整的结果。这是一个计算机科学的新领域，但也是数据科学领域许多人正在研究的内容。微软正集中精力在多个领域开展工作，包括**公平性**、**可靠性及安全性**、**隐私**
    **和** **安全性**、**包容性**、**透明度**和**问责性**。微软提供了一套工具箱，可用于处理数据集和模型以解决这些问题。在本章中，我们将探讨这些术语的含义以及如何利用微软的负责任AI工具箱来解决这些问题。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Responsible AI principles
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 负责任AI原则
- en: Response AI Toolbox overview
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 响应AI工具箱概述
- en: Responsible AI dashboard
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 负责任AI仪表板
- en: Error analysis
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误分析
- en: Interpretability dashboard
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可解释性仪表板
- en: Fairness dashboard
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公平性仪表板
- en: Responsible AI principles
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 负责任AI原则
- en: 'As mentioned, there are six core principles – Fairness, Reliability and Safety,
    Privacy and Security, Inclusiveness, Transparency, and Accountability – that Microsoft
    has incorporated into their Responsible AI Toolbox. We will briefly explain these
    as follows:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，微软在其负责任AI工具箱中纳入了六个核心原则——**公平性**、**可靠性及安全性**、**隐私**和**安全性**、**包容性**、**透明度**和**问责性**。我们将简要解释如下：
- en: '**Fairness** in the context of AI systems is a sociotechnical challenge that
    scientists and developers need to address to ensure that people are treated equally
    and to reduce unfairness relating to the specific use case we are building the
    model for. In a variety of domains and use cases, AI systems can be used to provide
    resources and opportunities, and through checking fairness we can ensure that
    we are not reinforcing existing stereotypes.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在人工智能系统的**公平性**方面是一个社会技术挑战，科学家和开发者需要解决，以确保人们受到平等对待，并减少与我们构建模型的具体用例相关的公平性问题。在各个领域和用例中，人工智能系统可以用来提供资源和机会，通过检查公平性，我们可以确保我们不会强化现有的刻板印象。
- en: For example, if we are predicting what ethnic groups there are in a certain
    segment of the population and what their food preferences are, not all customer
    segments of cities or states have the same ethnic diversity. So, when we design
    the model, we have to take into consideration all ethnic groups, giving each equal
    distribution within the data, building fairness into the model. Otherwise, the
    model might be skewed by the ethnic group with the highest population available
    in the test set. This is also hard because all cities and states have unequal
    distributions of ethnic groups.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们正在预测某个人口特定段落的民族群体及其食物偏好，并非所有城市或州的客户群体都具有相同的民族多样性。因此，当我们设计模型时，我们必须考虑所有民族群体，在数据中给予每个群体平等分布，将公平性融入模型。否则，模型可能会因为测试集中人口最多的民族群体而出现偏差。这也很难，因为所有城市和州民族群体的分布都是不均匀的。
- en: '**Reliability and Safety**: One important thing to keep in mind is to ensure
    models are safe for others to consume and that the output creates no harm. When
    a model makes predictions, make sure those predictions lead to safe and reliable
    decisions for all consumers. Understand that a wrong prediction can have an adverse
    negative effect when applying the model’s outcome. Spend time making the model’s
    outcome safe and reliable for the use case that it has been designed and developed
    for.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可靠性及安全性**：需要记住的一个重要事项是确保模型对他人来说是安全的，并且输出不会造成伤害。当模型做出预测时，确保这些预测对所有消费者来说都是安全且可靠的决策。理解到错误的预测在应用模型结果时可能会产生负面效应。花时间确保模型的结果对其设计和开发的目的来说是安全且可靠的。'
- en: '**Privacy and Security**: Use cases that depend on human-related data, such
    as predicting patient diagnosis or attrition analysis for companies, use a lot
    of personal data. Proper precautions should be in place to protect **personally
    identifiable information** (**PII**) and privacy. Depending on where the model
    is run, try to run the model closer to where data is stored, and do not move it
    or copy it to ensure privacy. Also, make sure permission is granted individually
    to each person who needs access to the data and not everyone. In some cases, we
    can either encrypt the data or convert PII into something unidentifiable before
    building the model, if possible. There is also talk about synthetic data creation
    for modeling. Depending on the use case, the business problem we are attempting
    to solve must drive the decision on how to protect privacy and apply security.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**隐私和安全**：依赖于人类相关数据的用例，例如预测患者诊断或公司的流失分析，使用了大量个人数据。必须采取适当的预防措施来保护**个人可识别信息**（**PII**）和隐私。根据模型运行的位置，尽量将模型运行在数据存储附近，并确保不将其移动或复制，以保护隐私。同时，确保仅对需要访问数据的人员授予许可，而不是所有人。在某些情况下，如果可能，我们可以在构建模型之前对数据进行加密或将PII转换为不可识别的信息。还有关于为建模创建合成数据的讨论。根据用例，我们试图解决的商业问题必须驱动如何保护隐私和实施安全性的决策。'
- en: '**Inclusiveness** is a core value stating that systems should empower all people,
    users and customers alike. The ability of the AI system to work with every human
    being on the planet regardless of who they are is always the goal. Inclusiveness
    is very similar to fairness. The question to ask is how we can include all of
    the various groups or include all ethnic minority communities in the model, ensuring
    no one is left out. Our dataset should represent all communities so that everyone
    gets proper representation when building our model.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包容性**是一个核心价值观，表明系统应该赋予所有人、用户和客户权力。AI系统与地球上每个不同的人都能协同工作的能力始终是目标。包容性与公平性非常相似。我们要问的问题是，我们如何包括所有不同的群体或包括所有少数民族社区在模型中，确保没有人被排除在外。我们的数据集应该代表所有社区，以便在构建我们的模型时，每个人都能得到适当的代表。'
- en: '**Transparency** in a system is key to ensuring a system can be trusted. The
    system should be transparent, allowing users to know what is going on at any given
    time. This improves trust in the system. We can talk about two different categories
    of transparency:'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统的透明度**是确保系统能够被信任的关键。系统应该是透明的，使用户能够了解任何给定时间正在发生的事情。这提高了对系统的信任。我们可以讨论两种不同的透明度类别：'
- en: '**Transparency on how AI systems are built**: We need to be transparent on
    how the AI systems are built and provide proper documentation on the process and
    purpose of the model we’ve built. Anyone using the model should feel comfortable
    and able to trust the model.'
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AI系统构建的透明度**：我们需要在AI系统的构建上保持透明，并提供关于我们构建的模型的过程和目的的适当文档。任何使用该模型的人都应该感到舒适并能够信任该模型。'
- en: '**Transparency on pitfalls of the models**: Using interpretability to explain
    how the decision was made and what features were used is also an important way
    to gain trust in the model to be consumed.'
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型陷阱的透明度**：使用可解释性来解释决策是如何做出的以及使用了哪些特征，这也是获得对即将使用的模型信任的重要方式。'
- en: '**Accountability**: Given that model building is somewhat unpredictable, we
    must be accountable for what we are building. Proper processes must be in place
    in order for us to accept accountability for the model we build. We should make
    sure that what we build takes privacy into account and that we accept responsibility
    for the trustworthiness of the model. For example, a data scientist who is building
    a model is responsible for building the model by following all of these principles
    and will be held accountable for that model. First and foremost, every organization
    has to have the following:'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**问责制**：鉴于模型构建具有一定的不确定性，我们必须对我们所构建的内容负责。必须建立适当的流程，以便我们能够对我们的模型建设承担问责制。我们应该确保我们所构建的内容考虑到隐私，并且我们接受对模型可信度的责任。例如，构建模型的科学家必须遵循所有这些原则来构建模型，并将对该模型承担问责。首先，每个组织都必须具备以下条件：'
- en: A responsible AI strategy
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 负责任的AI策略
- en: A methodology to develop AI/**machine learning** (**ML**) responsibly
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一种负责任地开发AI/**机器学习**（**ML**）的方法
- en: In order to have a responsible AI strategy, you need to develop business guidelines
    relating to how AI/ML can be used to drive business outcomes, establish how teams
    can apply responsible AI and build better model outcomes, and decide what tools
    and techniques need to be in place to ensure responsible AI. This strategy should
    be the foundation of all AI/ML model development and should be used in any other
    systems. You should also create a framework around which to report and monitor
    risks or leaked AI/ML behavior.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 为了有一个负责任的人工智能策略，您需要制定与如何使用AI/ML来推动业务成果相关的业务指南，确定团队如何应用负责任的人工智能以及构建更好的模型结果，并决定需要哪些工具和技术来确保负责任的人工智能。这个策略应该是所有AI/ML模型开发的基础，并应用于任何其他系统。您还应该创建一个框架，用于报告和监控风险或泄露的AI/ML行为。
- en: In the next section of this chapter, we will discuss how to leverage **raiwidgets**
    (or the **Responsible AI Toolkit SDK**) and how we can analyze the six core principles.
    Not all of these principles are covered by the SDK. For example, while Fairness
    and Transparency are covered by the SDK, Privacy and Security, Reliability, and
    Accountability will be covered by other programming mechanisms.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的下一节中，我们将讨论如何利用**raiwidgets**（或**Responsible AI Toolkit SDK**）以及我们如何分析六个核心原则。并非所有这些原则都由SDK涵盖。例如，虽然公平性和透明度由SDK涵盖，但隐私和安全、可靠性和问责制将由其他编程机制来处理。
- en: 'Follow this URL for more details and up-to-date information: [https://www.microsoft.com/en-us/ai/responsible-ai](https://www.microsoft.com/en-us/ai/responsible-ai).'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 查阅以下URL以获取更多详细信息和新信息：[https://www.microsoft.com/en-us/ai/responsible-ai](https://www.microsoft.com/en-us/ai/responsible-ai)。
- en: Responsible AI Toolbox overview
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 负责任的人工智能工具箱概述
- en: One of the biggest challenges we face in data science is understanding what
    the model does. For example, if the algorithms we use are all black boxes, it’s
    not that easy to know how the decisions are made. To discern how our algorithms
    make decisions, we can make use of responsible AI. This will give us the opportunity
    to explain the model’s decisions, find the features that contribute to the prediction,
    do error analysis on the dataset, and also ensure fairness in the dataset.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在数据科学中面临的最大挑战之一是理解模型的作用。例如，如果我们使用的算法都是黑盒，那么了解决策是如何做出的并不那么容易。为了辨别我们的算法是如何做出决策的，我们可以利用负责任的人工智能。这将给我们机会解释模型的决策，找到对预测有贡献的特征，对数据集进行错误分析，并确保数据集的公平性。
- en: 'Microsoft recently developed a Responsible AI Toolbox that encompasses interpretability,
    fairness, counterfactual analysis, and causal decision-making through three dashboards:
    a **fairness dashboard**, an **error analysis dashboard**, and an **interpretability
    dashboard**.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 微软最近开发了一个包含可解释性、公平性、反事实分析和因果决策的负责任人工智能工具箱，通过三个仪表板：一个**公平性仪表板**、一个**错误分析仪表板**和一个**可解释性仪表板**。
- en: Dashboards simplify the **user interface** (**UI**) by bringing all the toolkit
    output into one UI. Before the toolbox, it was hard because we needed to download
    a separate library and build code for each of the dashboards. Now, it’s very easy,
    and I will show some code to achieve this with the Responsible AI Toolbox.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 仪表板通过将所有工具箱输出集中在一个UI中简化了**用户界面**（**UI**）。在工具箱之前，这很困难，因为我们需要为每个仪表板下载一个单独的库并编写代码。现在，这非常简单，我将展示一些使用负责任的人工智能工具箱实现这一点的代码。
- en: Note
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 备注
- en: The toolbox is in public preview, and there are new developments on the way.
    Make sure your libraries are updated often to check which new features are available
    for you.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 工具箱处于公开预览阶段，并且正在开发新的功能。请确保您的库经常更新，以检查哪些新功能可供您使用。
- en: 'The Toolbox is available here: [https://github.com/microsoft/responsible-ai-toolbox](https://github.com/microsoft/responsible-ai-toolbox).'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 工具箱可在以下位置获取：[https://github.com/microsoft/responsible-ai-toolbox](https://github.com/microsoft/responsible-ai-toolbox)。
- en: Responsible AI dashboard
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 负责任的人工智能仪表板
- en: To leverage the Toolbox, we will create a model to apply the Toolbox to. Let’s
    look at the process of creating and analyzing responsible AI.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了利用工具箱，我们将创建一个模型来应用工具箱。让我们看看创建和分析负责任的人工智能的过程。
- en: 'Let’s go through the steps to create a model in the Azure ML service:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过以下步骤在Azure ML服务中创建一个模型：
- en: Go to the Azure ML Studio UI.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往Azure ML Studio UI。
- en: Start the compute instance.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动计算实例。
- en: Click on **Notebook** in the **Author** section.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**作者**部分点击**笔记本**。
- en: Create a new notebook with Python 3.8 with Azure ML as the kernel.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Python 3.8创建一个新的笔记本，以Azure ML作为内核。
- en: Name the notebook `RAIDashboard.ipynb`.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将笔记本命名为`RAIDashboard.ipynb`。
- en: 'Now, we need to install or upgrade libraries. Only install libraries if they
    aren’t already on your system. At the time of writing, Python 3.8 with the Azure
    ML kernel was used, and it already has `raiwidgets` installed. If there is an
    older version, please use the following upgrade command to upgrade to the latest
    version:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要安装或升级库。只有当它们尚未在您的系统上时才安装库。在撰写本文时，使用了Python 3.8和Azure ML内核，并且已经安装了`raiwidgets`。如果有旧版本，请使用以下升级命令升级到最新版本：
- en: '![Figure 8.1 – Install or upgrade the Responsible AI Toolbox](img/B18003_08_001.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![图8.1 – 安装或升级责任AI工具箱](img/B18003_08_001.jpg)'
- en: Figure 8.1 – Install or upgrade the Responsible AI Toolbox
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.1 – 安装或升级责任AI工具箱
- en: 'Now, let’s upgrade the dependencies:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们升级依赖项：
- en: '![Figure 8.2 – Upgrade the pandas libraries to the newest version](img/B18003_08_002.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![图8.2 – 升级pandas库到最新版本](img/B18003_08_002.jpg)'
- en: Figure 8.2 – Upgrade the pandas libraries to the newest version
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.2 – 升级pandas库到最新版本
- en: Restart the kernel and clear all the outputs. Once the libraries are installed,
    it’s always a good practice to restart the kernel to reflect the installed libraries.
    Some packages force us to restart the kernel to be effective.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动内核并清除所有输出。一旦安装了库，重新启动内核以反映已安装的库总是一个好习惯。一些包强制我们重新启动内核才能生效。
- en: We are now going to load the libraries for us to consume in the notebook. The
    Responsible AI dashboard is used to generate a nice UI to interact with and do
    **what-if analysis**, as well as other types of analysis, including **error analysis**,
    **feature permutation**, and **counterfactual analysis**, on the model created.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在将加载用于在笔记本中使用的库。责任AI仪表板用于生成一个漂亮的用户界面，以便与之交互并进行**假设分析**，以及其他类型的分析，包括**错误分析**、**特征排列**和**反事实分析**，针对创建的模型。
- en: For `RAIInsights`, this is where we calculate all the calculations to generate
    the dashboard. It usually takes time to execute and analyze the model and get
    insights into what the model is doing. Whatever is displayed on the Responsible
    AI dashboard will be calculated by the `RAIInsights` libraries.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`RAIInsights`，这是我们进行所有计算以生成仪表板的地方。执行和分析模型并了解模型正在做什么通常需要时间。在责任AI仪表板上显示的所有内容都将由`RAIInsights`库计算得出。
- en: '![Figure 8.3 – Importing the Responsible AI libraries](img/B18003_08_003.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![图8.3 – 导入责任AI库](img/B18003_08_003.jpg)'
- en: Figure 8.3 – Importing the Responsible AI libraries
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.3 – 导入责任AI库
- en: 'Next, we create a sample regression model to which to apply Responsible AI.
    Let’s import the `shap` and `sklearn` libraries for our model. Here, we are going
    to load the ML libraries and also the library required to split the data for training
    and testing. Later, we will split the dataset into two parts: one for training
    and one for testing. Usually, 80% is used for training and 20% is used for testing.'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们创建一个用于应用责任AI的样本回归模型。让我们导入`shap`和`sklearn`库来构建我们的模型。在这里，我们将加载机器学习库以及用于分割训练和测试数据的库。稍后，我们将数据集分成两部分：一部分用于训练，另一部分用于测试。通常，80%用于训练，20%用于测试。
- en: '![Figure 8.4 – Importing the model’s libraries](img/B18003_08_004.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![图8.4 – 导入模型的库](img/B18003_08_004.jpg)'
- en: Figure 8.4 – Importing the model’s libraries
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.4 – 导入模型的库
- en: Now, let’s load the sample datasets and split the data for training and testing.
    Also, let’s assign the column that is used for the target feature, or label the
    column to be predicted. Here, we are loading a sample dataset for diabetes. Then,
    we are going to assign the column to predict, which is `'y'`. Sometimes, it’s
    called `target_feature`. Then, we use the remaining columns as features to train
    the model.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们加载样本数据集并分割用于训练和测试的数据。同时，让我们指定用于目标特征的列，或者标记要预测的列。在这里，我们正在加载一个用于糖尿病的样本数据集。然后，我们将预测列指定为`'y'`。有时，它被称为`target_feature`。然后，我们使用剩余的列作为特征来训练模型。
- en: '![Figure 8.5 – Loading the sample dataset](img/B18003_08_005.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图8.5 – 加载样本数据集](img/B18003_08_005.jpg)'
- en: Figure 8.5 – Loading the sample dataset
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.5 – 加载样本数据集
- en: Split the data and assign it to different dataframes for modeling. Usually,
    when modeling, the training data is split into two datasets, one for training
    and one for testing. Next, the predicting column, which is called the label or
    target, is also split into training and testing. The following screenshot shows
    the features used for modeling.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分割数据并将其分配给不同的数据框进行建模。通常，在建模时，训练数据被分割成两个数据集，一个用于训练，一个用于测试。接下来，预测列，也称为标签或目标，也被分割成训练和测试。以下截图显示了用于建模的特征。
- en: '![Figure 8.6 – Splitting data for training and testing](img/B18003_08_006.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![图8.6 – 分割数据以进行训练和测试](img/B18003_08_006.jpg)'
- en: Figure 8.6 – Splitting data for training and testing
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6 – 分割数据以进行训练和测试
- en: Now that we have made our model, we need to run it. This is necessary before
    we analyze the model using the Responsible AI Toolbox for fairness, privacy, reliability,
    and bias. Bias means we want to have equal records for the categories we use.
    For example, if we use a dataset that contains ethnicity or sex features, we have
    to make sure we have an equal amount of data for each represented group to avoid
    bias.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经构建了模型，我们需要运行它。在使用负责的人工智能工具箱分析模型的公平性、隐私、可靠性和偏差之前，这是必要的。偏差意味着我们希望我们使用的类别有相等的记录。例如，如果我们使用包含种族或性别特征的数据库，我们必须确保每个代表组的数据量相等，以避免偏差。
- en: 'Let’s now create the responsible AI code by following these steps:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们现在按照以下步骤创建负责的人工智能代码：
- en: First, we need to train the model before we pass it to `RAIInsights` to calculate
    the fairness, bias, and other error analyses.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，在我们将模型传递给`RAIInsights`以计算公平性、偏差和其他错误分析之前，我们需要训练模型。
- en: '![Figure 8.7 – Model configuration and training](img/B18003_08_007.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图8.7 – 模型配置和训练](img/B18003_08_007.jpg)'
- en: Figure 8.7 – Model configuration and training
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.7 – 模型配置和训练
- en: The model is ready. The next step is to apply responsible AI. Let’s configure
    the `RAIInsights` details.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型已准备就绪。下一步是应用负责的人工智能。让我们配置`RAIInsights`的详细信息。
- en: 'We need to pass the following parameters: `model`, `train_data`, `test_data`,
    `target_feature`, the model type (for example, `regression` or `classification`),
    and `categorical_features`.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要传递以下参数：`model`、`train_data`、`test_data`、`target_feature`、模型类型（例如，`regression`或`classification`）以及`categorical_features`。
- en: 'With this, `RAIInsights` is going to produce the following:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，`RAIInsights`将生成以下内容：
- en: An error analysis dashboard
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误分析仪表板
- en: An interpretability dashboard
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可解释性仪表板
- en: A fairness dashboard
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公平性仪表板
- en: A Responsible AI dashboard
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 负责的人工智能仪表板
- en: '![Figure 8.8 – Invoking RAIInsights](img/B18003_08_008.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图8.8 – 调用RAIInsights](img/B18003_08_008.jpg)'
- en: Figure 8.8 – Invoking RAIInsights
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.8 – 调用RAIInsights
- en: 'The next step is to invoke interpretability, error analysis, and fairness and
    build the dashboard:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是调用可解释性、错误分析和公平性，并构建仪表板：
- en: '`IntepretML` is used to understand how the columns affect the prediction made
    by the model. `IntepretML` is an open source package. Here, we combine all the
    open source package output, making it seamless, and show it in `ResponsibleAIDashboard`.'
  id: totrans-76
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`IntepretML`用于理解列如何影响模型做出的预测。`IntepretML`是一个开源软件包。在这里，我们结合所有开源软件包的输出，使其无缝，并在`ResponsibleAIDashboard`中展示。'
- en: '`Error Analysis` package for this.'
  id: totrans-77
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为此使用`Error Analysis`软件包。
- en: '`DiCE` is the open source package that we use to do this analysis.'
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`DiCE`是我们用来进行此分析的开源软件包。'
- en: '`EconML` open source package. This package allows us to change conditions and
    see the impact. For example, what would the impact be if we introduced a new product
    to a customer segment or if we introduced new strategies into the company?'
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`EconML`开源软件包。此软件包允许我们更改条件并查看影响。例如，如果我们向客户细分市场引入新产品或向公司引入新策略，会有什么影响？'
- en: '![Figure 8.9 – Adding explainer, error analysis, and counterfactual packages](img/B18003_08_009.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图8.9 – 添加解释器、错误分析和反事实包](img/B18003_08_009.jpg)'
- en: Figure 8.9 – Adding explainer, error analysis, and counterfactual packages
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.9 – 添加解释器、错误分析和反事实包
- en: 'Now, let’s carry out interpretability, error, and counterfactual analysis:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们进行可解释性、错误和反事实分析：
- en: Usually, it will take some time to do all the calculations. Depending on the
    model type and the size of the dataset, be prepared to spend a little while here.
    Depending on the ML type, causal analysis using `EconML` will also be computed
    for what-if analysis.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通常，进行所有计算需要一些时间。根据模型类型和数据集的大小，请做好在这里花费一些时间的准备。根据机器学习类型，使用`EconML`进行的因果分析也将用于假设分析。
- en: '![Figure 8.10 – Compute responsible AI calculation insights](img/B18003_08_010.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.10 – 计算负责的 AI 计算洞察](img/B18003_08_010.jpg)'
- en: Figure 8.10 – Compute responsible AI calculation insights
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.10 – 计算负责的 AI 计算洞察
- en: Next, we need to build the Responsible AI dashboard. The Toolbox consolidates
    all the output in a dashboard and provides one place to conduct analysis. Please
    remember that not all the principles have been implemented yet, and research and
    development is still an ongoing process with the SDK. *Figure 8**.11* shows the
    creation of the Responsible AI dashboard.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要构建负责的 AI 仪表板。工具箱将所有输出汇总到仪表板中，并提供一个地方进行分析。请记住，并非所有原则都已实施，SDK 的研发仍在进行中。*图
    8.11* 展示了负责的 AI 仪表板的创建。
- en: '![Figure 8.11 – Responsible AI dashboard](img/B18003_08_011.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.11 – 负责的 AI 仪表板](img/B18003_08_011.jpg)'
- en: Figure 8.11 – Responsible AI dashboard
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.11 – 负责的 AI 仪表板
- en: Once the dashboard is built, click on the hyperlink to open it. For each type
    of analysis, please see the heading in the dashboard link.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦构建了仪表板，请单击超链接以打开它。对于每种类型的分析，请参阅仪表板链接中的标题。
- en: 'The link is available here: `responsible-ai-toolbox/tour.ipynb at main ·` `microsoft/responsible-ai-toolbox`
    ([https://github.com/microsoft/responsible-ai-toolbox/blob/main/notebooks/responsibleaidashboard/tour.ipynb](https://github.com/microsoft/responsible-ai-toolbox/blob/main/notebooks/responsibleaidashboard/tour.ipynb)).'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 链接在此处可用：`responsible-ai-toolbox/tour.ipynb at main ·` `microsoft/responsible-ai-toolbox`
    ([https://github.com/microsoft/responsible-ai-toolbox/blob/main/notebooks/responsibleaidashboard/tour.ipynb](https://github.com/microsoft/responsible-ai-toolbox/blob/main/notebooks/responsibleaidashboard/tour.ipynb))。
- en: 'The dashboard created from the preceding code will have a few options to customize
    and work with cohorts:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的代码创建的仪表板将有一些选项来定制和与队列一起工作：
- en: '**Dashboard navigation**: Allows us to filter any analysis'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**仪表板导航**：允许我们过滤任何分析'
- en: '**Cohort settings**: Allows us to work with cohorts'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**队列设置**：允许我们与队列一起工作'
- en: '**Switch global cohort**: Allows us to switch between cohorts and also display
    statistics in popups'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**切换全局队列**：允许我们在队列之间切换，并在弹出窗口中显示统计数据'
- en: '**Create new cohort**: Allows us to create new cohorts as needed'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建新队列**：允许我们根据需要创建新的队列'
- en: Next, we are going to deep dive into the error analysis dashboard to understand
    feature errors.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将深入探讨错误分析仪表板，以了解特征错误。
- en: Error analysis dashboard
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 错误分析仪表板
- en: Error analysis allows us to analyze where the model is underperforming and also
    find errors in the decision-making process.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 错误分析使我们能够分析模型表现不佳的地方，并找到决策过程中的错误。
- en: Error analysis can be done as either a tree map or a heat map. Based on the
    analysis, red represents an error. If you click one of the insight bubbles, you’ll
    see the path the model traversed.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 错误分析可以是树状图或热图。根据分析，红色代表错误。如果您点击其中一个洞察气泡，您将看到模型遍历的路径。
- en: 'Dashboard analysis will be based on the type of ML modeling we choose. The
    two types are classification and regression. In our example, we chose regression.
    The following are two of the accuracy metrics used:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 仪表板分析将基于我们选择的 ML 模型类型。有两种类型：分类和回归。在我们的例子中，我们选择了回归。以下是我们使用的两个准确性指标：
- en: '**Mean** **squared error**'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方误差**'
- en: '**Mean** **absolute error**'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均绝对误差**'
- en: The following screenshot shows the error analysis dashboard UI created by the
    Responsible AI SDK.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了由负责的 AI SDK 创建的错误分析仪表板 UI。
- en: '![Figure 8.12 – Error analysis dashboard](img/B18003_08_012.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.12 – 错误分析仪表板](img/B18003_08_012.jpg)'
- en: Figure 8.12 – Error analysis dashboard
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.12 – 错误分析仪表板
- en: This dashboard provides options to save the error analysis for further analysis
    or share it with others. This feature is very helpful if we need to share information
    with other data scientists or subject matter experts to understand a model’s performance.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 此仪表板提供选项保存错误分析以供进一步分析或与他人共享。如果我们需要与其他数据科学家或领域专家共享信息以了解模型性能，此功能非常有用。
- en: 'The following screenshot shows the error analysis screen with **Heat** **map**
    selected:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了选择**热图**的错误分析屏幕：
- en: '![Figure 8.13 – Heat map error analysis](img/B18003_08_013.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.13 – 热图错误分析](img/B18003_08_013.jpg)'
- en: Figure 8.13 – Heat map error analysis
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.13 – 热图错误分析
- en: In this heat map, we need to select the features for which we want to do error
    analysis. Once we select the features, the system will analyze the error percentage.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个热图中，我们需要选择我们想要进行错误分析的特征。一旦我们选择了特征，系统将分析错误百分比。
- en: Options are available for **Quantile binning** and **Binning threshold**.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了**分位数分箱**和**分箱阈值**的选项。
- en: The following screenshot shows us **Feature List**. This section shows which
    features have been selected and how important each one is to the prediction.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了**特征列表**。本节显示了哪些特征已被选择，以及每个特征对预测的重要性。
- en: '![Figure 8.14 – Feature List](img/B18003_08_014.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.14 – 特征列表](img/B18003_08_014.jpg)'
- en: Figure 8.14 – Feature List
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.14 – 特征列表
- en: This feature illustrates the importance of the columns or features to the predictions.
    There are options to change the maximum depth and leaves of the decision tree
    created by the responsible AI dashboard, as well as how the minimum number of
    samples in one leaf is analyzed.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 此功能说明了列或特征对预测的重要性。有选项可以更改由负责 AI 仪表板创建的决策树的最大深度和叶子数，以及分析一个叶子中样本的最小数量。
- en: Interpretability dashboard
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可解释性仪表板
- en: Now let’s look at the interpretability section of the dashboard. This is where
    each feature is analyzed and the importance and impact of the features are shown.
    The top features are either aggregated or available individually for analysis.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看仪表板的可解释性部分。这是分析每个特征并显示特征的重要性和影响的地方。顶级特征要么是聚合的，要么可以单独进行分析。
- en: '![Figure 8.15 – Aggregated feature importance](img/B18003_08_015.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.15 – 聚合特征重要性](img/B18003_08_015.jpg)'
- en: Figure 8.15 – Aggregated feature importance
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.15 – 聚合特征重要性
- en: In the preceding screenshot, you can see the aggregated feature importance.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，您可以查看聚合的特征重要性。
- en: 'Select **Individual feature importance** to analyze the data row by row. Then,
    select the rows to analyze, as follows:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 选择**单个特征重要性**以逐行分析数据。然后，选择要分析的数据行，如下所示：
- en: '![Figure 8.16 – Selecting data points for feature importance](img/B18003_08_016.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.16 – 选择数据点进行特征重要性分析](img/B18003_08_016.jpg)'
- en: Figure 8.16 – Selecting data points for feature importance
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.16 – 选择数据点进行特征重要性分析
- en: Once the feature data points are selected, scroll down to see the charts. The
    following chart shows the feature importance and its impact on the row that is
    selected. For every row in the dataset, you can analyze the dataset by selecting
    a row.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦选择了特征数据点，向下滚动以查看图表。以下图表显示了特征重要性和其对所选行的影响。对于数据集中的每一行，您可以通过选择一行来分析数据集。
- en: '![Figure 8.17 – Individual feature importance plot](img/B18003_08_017.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.17 – 单个特征重要性图](img/B18003_08_017.jpg)'
- en: Figure 8.17 – Individual feature importance plot
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.17 – 单个特征重要性图
- en: Now click **Individual conditional expectations (ICE) plot** to change the plot.
    The ICE plot will show all the rows with respect to the feature selected and show
    how much impact each row had on the model.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 现在点击**个体条件期望（ICE）图**来更改图表。ICE 图将显示所选特征的所有行，并显示每一行对模型的影响程度。
- en: On selecting **Individual conditional expectation (ICE) plot**, you should see
    what is shown in *Figure 8**.17*. The *x* axis should be the feature selected
    and the *y* axis the prediction. Click the **Feature** dropdown and select the
    feature to see the impact. Also, options to set minimum and maximum steps are
    available. To get more information, click **How to read** **this chart**.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择**个体条件期望（ICE）图**后，您应该看到*图 8.17*中所示的内容。*x* 轴应该是所选特征，而 *y* 轴是预测值。点击**特征**下拉菜单并选择特征以查看其影响。此外，还有设置最小和最大步数的选项。要获取更多信息，请点击**如何阅读****此图表**。
- en: '![Figure 8.18 – Individual conditional expectation (ICE) plot](img/B18003_08_018.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.18 – 个体条件期望（ICE）图](img/B18003_08_018.jpg)'
- en: Figure 8.18 – Individual conditional expectation (ICE) plot
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.18 – 个体条件期望（ICE）图
- en: Now let’s look at model statistics.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看模型统计信息。
- en: Model statistics allow us to analyze distribution across prediction values,
    the model’s performance, and model metrics. Options to switch between a cohort
    and a dataset are also available. Select the *y* value to see the error in the
    dataset, the predicted Y value (the label for the column that the model predicted),
    and what the true Y value (label for the column provided in the training dataset)
    was. These options allow us to understand the model performance.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 模型统计信息使我们能够分析预测值分布、模型性能和模型指标。还有在队列和数据集之间切换的选项。选择 *y* 值以查看数据集中的错误、预测的 Y 值（模型预测的列的标签）以及真实的
    Y 值（训练数据集中提供的列的标签）。这些选项使我们能够了解模型性能。
- en: You can also swap the axes to show errors on the x axis and predictions on the
    Y axis. Also, if you click **Cohort**, there is the option to select a dataset
    and the features to plot and see how the model performed.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以交换轴以在x轴上显示错误并在Y轴上显示预测值。此外，如果您点击**队列**，您可以选择数据集和要绘制的特征，并查看模型的性能。
- en: '![Figure 8.19 – Model statistics](img/B18003_08_019.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![图8.19 – 模型统计](img/B18003_08_019.jpg)'
- en: Figure 8.19 – Model statistics
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.19 – 模型统计
- en: Next, we are going to look into the **Data explorer** feature on the Responsible
    AI dashboard.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将查看负责任AI仪表板上的**数据探索器**功能。
- en: Data explorer
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据探索器
- en: '**Data explorer** is another visual tool for analyzing the predicted value,
    error, and features. You can use either aggregated or individual features. It
    also allows you to select predicted features and training features for what-if
    analysis.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '**数据探索器**是分析预测值、误差和特征的另一个可视化工具。您可以使用聚合或单个特征。它还允许您为假设分析选择预测特征和训练特征。'
- en: '*Figure 8**.20* shows a box plot of how age is grouped or binned into chunks.
    The *x* axis is the index and the *y* axis is the age groups, which can be age
    data points or bins of ages. You have the choice to select either **Aggregate
    plots** or **Individual datapoints** to visualize the difference between aggregated
    and individual plots. Box plots provide a clear visualization of where the outliers
    are and show the range of plotted points.'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '*图8.20* 展示了年龄如何分组或分箱成块的情况。*x* 轴是索引，*y* 轴是年龄组，可以是年龄数据点或年龄的箱。您可以选择选择**聚合图**或**单个数据点**来可视化聚合图和单个图之间的差异。箱形图清晰地显示了异常值的位置，并显示了绘图点的范围。'
- en: We can change the *x* axis from the index to the predicted *y* or true *y* value
    to see the patterns. There is also the option to change the number of bins. In
    the following example, we chose five bins. Also, if you click **age**, there is
    the option to change the feature as well to see how the prediction value changes.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将*x*轴从索引更改为预测的*y*值或真实的*y*值以查看模式。还有更改箱数的选项。在以下示例中，我们选择了五个箱。此外，如果您点击**年龄**，您还可以更改特征以查看预测值的变化。
- en: '![Figure 8.20 – Aggregated plots](img/B18003_08_020.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![图8.20 – 聚合图](img/B18003_08_020.jpg)'
- en: Figure 8.20 – Aggregated plots
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.20 – 聚合图
- en: '**Data explorer** allows us to select the predicted and original values and
    plot either aggregated or individual scatter plots to see how the values align
    or intersect. In the following chart, the *y* axis is the age and the *x* axis
    is the index, and the predicted outcome is a scatter plot. You can change the
    cohort to see various values.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '**数据探索器**允许我们选择预测值和原始值，并绘制聚合图或单个散点图以查看值如何对齐或相交。在下面的图表中，*y* 轴是年龄，*x* 轴是索引，预测结果是一个散点图。您可以选择不同的队列来查看不同的值。'
- en: '![Figure 8.21 – Scatter plot for individual values](img/B18003_08_021.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![图8.21 – 单个值的散点图](img/B18003_08_021.jpg)'
- en: Figure 8.21 – Scatter plot for individual values
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.21 – 单个值的散点图
- en: The preceding charts provide a way to visualize the predicted and error values
    of our model. This enables us to build a better model with more accuracy that
    is more realistic.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 上述图表提供了一种可视化模型预测值和误差值的方法。这使我们能够构建一个更准确、更现实的更好模型。
- en: What-if counterfactuals
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 假设反事实
- en: Now, we can change the datapoints and click **Create what-if counterfactuals**.
    What-if analysis allows us to select the predictor and compare with features to
    see the impact on the outcome. We can also change the index and age and switch
    to see predicted *y* or true *y* values and the features to see the counterfactuals.
    Then, we can select the index value and select one to see how the charts change.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以更改数据点并点击**创建假设反事实**。假设分析允许我们选择预测因子并与特征进行比较，以查看对结果的影响。我们还可以更改索引和年龄，切换到查看预测的*y*值或真实的*y*值以及特征以查看反事实。然后，我们可以选择索引值并选择一个来查看图表如何变化。
- en: We can see a counterfactual chart in the following screenshot and analyze the
    chart by changing features.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下屏幕截图中，我们可以看到一个反事实图表，并通过更改特征来分析图表。
- en: '![Figure 8.22 – Counterfactuals](img/B18003_08_022.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图8.22 – 反事实](img/B18003_08_022.jpg)'
- en: Figure 8.22 – Counterfactuals
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.22 – 反事实
- en: Select the index and then click **Create what-if counterfactual** to see the
    features percentage in the distribution chart. You can also save the chart.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 选择索引然后点击**创建假设反事实**以查看分布图中的特征百分比。您还可以保存图表。
- en: '![Figure 8.23 – What-if counterfactuals](img/B18003_08_023.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图8.23 – 假设反事实](img/B18003_08_023.jpg)'
- en: Figure 8.23 – What-if counterfactuals
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.23 – 假设反事实
- en: In the next section, we are going to see how fairness can be analyzed using
    the SDK.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将看到如何使用SDK分析公平性。
- en: Fairness
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 公平性
- en: Fairness is a topic that we need to investigate in use cases where people are
    involved. Proper precautions should be taken to figure out whether the dataset
    is fair or not. In Azure ML, with the Responsible AI Toolbox, we can create a
    fairness dashboard. To do that, first, we need to know which features need to
    be fair, such as sex and race. Once we know that, we can create a dashboard, as
    shown in *Figure 8**.24*.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 公平性是我们需要在涉及人的用例中调查的一个主题。应采取适当的预防措施来确定数据集是否公平。在Azure ML中，使用负责任的AI工具箱，我们可以创建一个公平性仪表板。为此，首先，我们需要知道哪些特征需要公平，例如性别和种族。一旦我们知道这一点，我们就可以创建一个仪表板，如图*图8**.24*所示。
- en: 'In this section, we are going to create a fairness dashboard with a sample
    dataset:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用样本数据集创建一个公平性仪表板：
- en: Go to the Azure ML Studio UI.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往Azure ML Studio UI。
- en: Start the compute instance.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动计算实例。
- en: Click on **Notebook** in the **Author** section.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**作者**部分点击**笔记本**。
- en: Create a new notebook with Python 3.8 with Azure ML as the kernel.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Python 3.8创建一个新的笔记本，以Azure ML作为内核。
- en: Create a new notebook called `FairnessDashboard`.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`FairnessDashboard`的新笔记本。
- en: 'Import all the required libraries:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所有必需的库：
- en: '![Figure 8.24 – Fairness imports](img/B18003_08_024.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![图8.24 – 公平性导入](img/B18003_08_024.jpg)'
- en: Figure 8.24 – Fairness imports
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.24 – 公平性导入
- en: 'Next, we are going to load the sample dataset:'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将加载样本数据集：
- en: '![Figure 8.25 – Getting the sample data](img/B18003_08_025.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![图8.25 – 获取样本数据](img/B18003_08_025.jpg)'
- en: Figure 8.25 – Getting the sample data
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.25 – 获取样本数据
- en: 'Then, we are going to specify the sensitive features and then use categorical
    columns and label encoder to convert strings to numbers:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将指定敏感特征，然后使用分类列和标签编码器将字符串转换为数字：
- en: '![Figure 8.26 – Feature engineering](img/B18003_08_026.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![图8.26 – 特征工程](img/B18003_08_026.jpg)'
- en: Figure 8.26 – Feature engineering
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.26 – 特征工程
- en: 'Now that we have feature engineering taken care of, the next step is to split
    the dataset for training and testing. We will split the dataset into 80% for training
    and 20% for testing:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们已经处理好了特征工程，下一步是将数据集分割为训练和测试。我们将数据集分割为80%用于训练和20%用于测试：
- en: '![Figure 8.27 – Splitting data for training and testing](img/B18003_08_027.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![图8.27 – 分割数据以进行训练和测试](img/B18003_08_027.jpg)'
- en: Figure 8.27 – Splitting data for training and testing
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.27 – 分割数据以进行训练和测试
- en: 'Next, configure the training:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，配置训练：
- en: '![Figure 8.28 – Training](img/B18003_08_028.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图8.28 – 训练](img/B18003_08_028.jpg)'
- en: Figure 8.28 – Training
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.28 – 训练
- en: Train the model with the dataset. Here, we are using logistic regression for
    modeling.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 使用数据集训练模型。在这里，我们使用逻辑回归进行建模。
- en: 'Next, let’s create a fairness dashboard. A fairness dashboard needs these three
    parameters at a minimum:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们创建一个公平性仪表板。一个公平性仪表板至少需要这三个参数：
- en: '**Sensitive features** – columns that have sensitive data, such as sex or race'
  id: totrans-181
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**敏感特征** – 包含敏感数据的列，例如性别或种族'
- en: '**Original** **label value**'
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**原始** **标签值**'
- en: '**Predicted value** **to analyze**'
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测值** **进行分析**'
- en: Click the URL created by the responsible AI SDK. A new web page will open. Follow
    the navigation in the dashboard to select the sensitive column and see how the
    data is distributed across those features. The main aim here is to provide insights
    into how the features are balanced with sensitive information. For example, if
    we have data with male and female datapoints, we want to make sure that men and
    women have the same amount of representation in the dataset.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 点击由负责的AI SDK创建的URL。将打开一个新的网页。按照仪表板中的导航选择敏感列，查看数据如何分布在这些特征上。这里的主要目的是提供关于特征如何与敏感信息平衡的见解。例如，如果我们有包含男性和女性数据点的数据，我们想确保男性和女性在数据集中有相同数量的代表性。
- en: '![Figure 8.29 – Creating the fairness dashboard](img/B18003_08_029.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![图8.29 – 创建公平性仪表板](img/B18003_08_029.jpg)'
- en: Figure 8.29 – Creating the fairness dashboard
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.29 – 创建公平性仪表板
- en: 'Here is the main page of the dashboard:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是仪表板的主页：
- en: '![Figure 8.30 – Fairness dashboard – intro page](img/B18003_08_030.jpg)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![图8.30 – 公平性仪表板 – 简介页面](img/B18003_08_030.jpg)'
- en: Figure 8.30 – Fairness dashboard – intro page
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.30 – 公平性仪表板 – 简介页面
- en: Click on **Get started** to view the options to analyze fairness.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**开始**以查看分析公平性的选项。
- en: The first step of the process is to select the sensitive features. In the following
    screenshot, we have two columns, **sex** and **race**. In the **sex** column,
    we have two categories, **male** and **female**. For **race**, we have **white**,
    **black**, **Asian-Pac-Islander**, **Other**, and **Amer-Indian-Eskimo**. Let’s
    first select **sex** to examine the sensitive features, and then click **Next**.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该过程的第一个步骤是选择敏感特征。在下面的屏幕截图中，我们有两个列，**性别**和**种族**。在**性别**列中，我们有两个类别，**男性**和**女性**。对于**种族**，我们有**白人**、**黑人**、**亚洲-太平洋岛民**、**其他**和**美洲印第安人-爱斯基摩人**。让我们首先选择**性别**来检查敏感特征，然后点击**下一步**。
- en: '![Figure 8.31 – Fairness dashboard – 01 Sensitive features](img/B18003_08_031.jpg)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.31 – 公平性仪表板 – 01 敏感特征](img/B18003_08_031.jpg)'
- en: Figure 8.31 – Fairness dashboard – 01 Sensitive features
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.31 – 公平性仪表板 – 01 敏感特征
- en: 'Now let’s choose which performance metric to use for our analysis. Options
    for performance metrics are as follows:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们选择用于我们分析的性能指标。性能指标选项如下：
- en: '**Accuracy**'
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**准确率**'
- en: '**Balanced accuracy**'
  id: totrans-196
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平衡准确率**'
- en: '**F1-score**'
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**F1 分数**'
- en: '**Precision**'
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**精确率**'
- en: '**Recall**'
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**回忆**'
- en: The definitions of these metrics are provided in *Figure 8**.32*. For our purposes,
    we are going to choose **Accuracy** as the metric, with **Sex** as the sensitive
    column for us to analyze. Click **Next** to go to **Fairness metrics**.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 这些指标的定义在*图 8**.32*中提供。对于我们来说，我们将选择**准确率**作为指标，以**性别**作为我们分析的敏感列。点击**下一步**进入**公平性指标**。
- en: '![Figure 8.32 – Fairness dashboard – 02 Performance metrics](img/B18003_08_032.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.32 – 公平性仪表板 – 02 性能指标](img/B18003_08_032.jpg)'
- en: Figure 8.32 – Fairness dashboard – 02 Performance metrics
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.32 – 公平性仪表板 – 02 性能指标
- en: Next is one of the most important screens. Select the appropriate fairness metric
    for our analysis. In the following screenshot, you can see the choice. For our
    example, we are choosing **Demographic parity difference**. Then click **Next**
    to see the charts to analyze.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来是最重要的筛选之一。选择适合我们分析的正确公平性指标。在下面的屏幕截图中，你可以看到选择。在我们的例子中，我们选择**人口统计学差异**。然后点击**下一步**来查看分析图表。
- en: '![Figure 8.33 – Fairness dashboard – 03 Fairness metrics](img/B18003_08_033.jpg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.33 – 公平性仪表板 – 03 公平性指标](img/B18003_08_033.jpg)'
- en: Figure 8.33 – Fairness dashboard – 03 Fairness metrics
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.33 – 公平性仪表板 – 03 公平性指标
- en: On the next screen, we can change these selections, see how the fairness metrics
    are calculated, and examine which sensitive features are selected and how fair
    they are.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个屏幕上，我们可以更改这些选择，查看公平性指标是如何计算的，并检查哪些敏感特征被选中以及它们的公平性如何。
- en: '![Figure 8.34 – Fairness results](img/B18003_08_034.jpg)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.34 – 公平性结果](img/B18003_08_034.jpg)'
- en: Figure 8.34 – Fairness results
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.34 – 公平性结果
- en: The preceding chart shows that women are underrepresented in the model, which
    also suggests the model might be biased toward men. So, now we can go back and
    see whether we can get a more balanced dataset to make our model fairer. Try to
    switch the charts to false positive and false negative rates to drill down and
    see the rates of false positives and negatives. You can also change **Performance
    metric**, **Sensitive feature**, and **Fairness metric** and analyze the fairness.
    As these options change, the charts will reflect the changes. This tool provides
    a single place to analyze data for bias and fairness.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的图表显示，模型中女性的代表性不足，这也表明模型可能对男性有偏见。因此，现在我们可以回过头来看看我们是否可以得到一个更平衡的数据集，以使我们的模型更加公平。尝试切换图表到假阳性和假阴性率，以深入查看假阳性和假阴性的比率。你还可以更改**性能指标**、**敏感特征**和**公平性指标**并分析公平性。随着这些选项的变化，图表将反映这些变化。这个工具提供了一个单一的地方来分析数据以查找偏差和公平性。
- en: '![Figure 8.35 – Fairness results – False positive and false negative rates](img/B18003_08_035.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.35 – 公平性结果 – 假阳性率和假阴性率](img/B18003_08_035.jpg)'
- en: Figure 8.35 – Fairness results – False positive and false negative rates
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.35 – 公平性结果 – 假阳性率和假阴性率
- en: We can now drill deeper into black-box models and see how the model made decisions,
    and also analyze the dataset for any bias or errors and ensure fairness.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以深入挖掘黑盒模型，看看模型是如何做出决策的，并分析数据集以查找任何偏差或错误，并确保公平性。
- en: Summary
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: By using the Responsible AI Toolbox SDK, we can analyze data for fairness and
    errors and look deep into decision trees to understand how the model makes decisions.
    Note that there is work to be done in this field. The SDK is still going through
    development, and features are being added, so please remember that the functionality
    will change and new features will be added. At the time of writing, we tested
    with the LightGBM, XGBoost, and PyTorch algorithms for fairness. The Toolbox allows
    us to open black-box models and see how decisions are made, and also produce output
    that is fair and unbiased.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用负责任的AI工具箱SDK，我们可以分析数据以评估公平性和错误，并深入挖掘决策树以理解模型是如何做出决策的。请注意，在这个领域还有工作要做。SDK仍在开发中，功能正在增加，所以请记住，功能将会改变，并将添加新功能。在撰写本文时，我们已使用LightGBM、XGBoost和PyTorch算法对公平性进行了测试。工具箱允许我们打开黑盒模型并查看决策是如何做出的，并且还能生成公平且无偏的输出。
- en: In the next chapter, we will learn how to productionalize ML models.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何将机器学习模型投入生产。
