<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;A Recommender System"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. A Recommender System</h1></div></div></div><p>Recommender systems are common these days. You may not have noticed, but you might already be a user or receiver of such a system somewhere. Most of the well-performing e-commerce platforms use recommendation systems to recommend items to their users. When you see on the Amazon website that a book is recommended to you based on your earlier preferences, purchases, and browse history, Amazon is actually using such a recommendation system. Similarly, Netflix uses its recommendation system to suggest movies for you.</p><p>A recommender or recommendation system is used to recommend a product or information often based on user characteristics, preferences, history, and so on. So, a recommendation is always personalized.</p><p>Until recently, it was not so easy or straightforward to build a recommender, but Azure ML makes it really easy to build one as long as you have your data ready.</p><p>This chapter introduces you to the concept of recommendation systems and also the model available in ML Studio for you to build your own recommender system. It then walks you through the process of building a recommendation system with a simple example.</p><div class="section" title="The Matchbox recommender"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec55"/>The Matchbox recommender</h1></div></div></div><p>Microsoft has developed a <a id="id336" class="indexterm"/>large-scale recommender system <a id="id337" class="indexterm"/>based on a probabilistic model (Bayesian) called <span class="strong"><strong>Matchbox</strong></span>. This model can learn about a user's preferences through observations made on how they rate items, such as movies, content, or other products. Based on those observations, it recommends new items to the users when requested.</p><p>Matchbox uses the available data for each user in the most efficient way possible. The learning algorithm it uses is designed specifically for big data. However, its main feature is that Matchbox takes advantage of metadata available for both users and items. This means that the things it learns about one user or item can be transferred across to other users or items.</p><p>You can find more <a id="id338" class="indexterm"/>information about the Matchbox model at the Microsoft Research project link.</p><div class="section" title="Types of recommendations"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec54"/>Types of recommendations</h2></div></div></div><p>The Matchbox recommender supports the building of four kinds of recommenders, which will include most of the scenarios. Let's take a look at the following list:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Rating Prediction</strong></span>: This predicts ratings for a given user and item, for example, if a new <a id="id339" class="indexterm"/>movie is released, the system will predict what will be your rating for that movie out of 1-5.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Item Recommendation</strong></span>: This recommends items to a given user, for example, Amazon <a id="id340" class="indexterm"/>suggests you books or YouTube suggests you videos to watch on its home page (especially when you are logged in).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Related Users</strong></span>: This <a id="id341" class="indexterm"/>finds users that are related to a given user, for example, LinkedIn suggests people that you can get connected to or Facebook suggests friends to you.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Related Items</strong></span>: This finds the items related to a given item, for example, a blog site suggests <a id="id342" class="indexterm"/>you related posts when you are reading a blog post.</li></ul></div></div><div class="section" title="Understanding the recommender modules"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec55"/>Understanding the recommender modules</h2></div></div></div><p>The Matchbox <a id="id343" class="indexterm"/>recommender comes with three components; as you might have guessed, a module each to train, score, and evaluate the data. The modules are described as follows.</p><div class="section" title="The Train Matchbox recommender"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec38"/>The Train Matchbox recommender</h3></div></div></div><p>This module <a id="id344" class="indexterm"/>contains the algorithm and <a id="id345" class="indexterm"/>generates the trained algorithm, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_09_9.jpg" alt="The Train Matchbox recommender"/></div><p>This module takes the values for the following two parameters.</p><div class="section" title="The number of traits"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec02"/>The number of traits</h4></div></div></div><p>This value decides how <a id="id346" class="indexterm"/>many implicit features (traits) the algorithm will learn about that are related to every user and item. The higher this value, the precise it would be as it would lead to better prediction. Typically, it takes a value in the range of 2 to 20.</p></div><div class="section" title="The number of recommendation algorithm iterations"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec03"/>The number of recommendation algorithm iterations</h4></div></div></div><p>It is the <a id="id347" class="indexterm"/>number of times the algorithm iterates over the data. The higher this value, the better would the predictions be. Typically, it takes a value in the range of 1 to 10.</p></div></div><div class="section" title="The Score Matchbox recommender"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec39"/>The Score Matchbox recommender</h3></div></div></div><p>This module <a id="id348" class="indexterm"/>lets you specify the kind of <a id="id349" class="indexterm"/>recommendation and corresponding parameters you want:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Rating Prediction</li><li class="listitem" style="list-style-type: disc">Item Prediction</li><li class="listitem" style="list-style-type: disc">Related Users</li><li class="listitem" style="list-style-type: disc">Related Items</li></ul></div><p>Let's take a look <a id="id350" class="indexterm"/>at the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_09_10.jpg" alt="The Score Matchbox recommender"/></div><p>The ML Studio help page for the module provides details of all the corresponding parameters.</p></div><div class="section" title="The evaluate recommender"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec40"/>The evaluate recommender</h3></div></div></div><p>This module takes a <a id="id351" class="indexterm"/>test and a scored dataset and <a id="id352" class="indexterm"/>generates evaluation metrics, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_09_11.jpg" alt="The evaluate recommender"/></div><p>It also lets you <a id="id353" class="indexterm"/>specify the kind of recommendation, such <a id="id354" class="indexterm"/>as the score module and corresponding parameters.</p></div></div></div></div>
<div class="section" title="Building a recommendation system"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec56"/>Building a recommendation system</h1></div></div></div><p>Now, it <a id="id355" class="indexterm"/>would be worthwhile that you learn to build one by yourself. We will build a simple recommender system to recommend restaurants to a given user.</p><p>ML Studio includes three sample datasets, described as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Restaurant customer data</strong></span>: This is a set of metadata about customers, including demographics and preferences, for example, <span class="strong"><strong>latitude</strong></span>, <span class="strong"><strong>longitude</strong></span>, <span class="strong"><strong>interest</strong></span>, and <span class="strong"><strong>personality</strong></span>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Restaurant feature data</strong></span>: This is a set of metadata about restaurants and their features, such as food type, dining style, and location, for example, <span class="strong"><strong>placeID</strong></span>, <span class="strong"><strong>latitude</strong></span>, <span class="strong"><strong>longitude</strong></span>, <span class="strong"><strong>price</strong></span>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Restaurant ratings</strong></span>: This contains the ratings given by users to restaurants on a scale of 0 to 2. It contains the columns: <span class="strong"><strong>userID</strong></span>, <span class="strong"><strong>placeID</strong></span>, and <span class="strong"><strong>rating</strong></span>.</li></ul></div><p>Now, we will build a recommender that will recommend a given number of restaurants to a user (<span class="strong"><strong>userID</strong></span>). To build a recommender perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new experiment. In the Search box in the modules palette, type <code class="literal">Restaurant</code>. The preceding three datasets get listed. Drag them all to the canvas one after another.<div class="mediaobject"><img src="graphics/0792EN_09_1.jpg" alt="Building a recommendation system"/></div></li><li class="listitem">Drag a <span class="strong"><strong>Split</strong></span> module and connect it to the output port of the <span class="strong"><strong>Restaurant ratings</strong></span> module. On the properties section to the right, choose <span class="strong"><strong>Splitting mode</strong></span> as <a id="id356" class="indexterm"/><span class="strong"><strong>Recommender Split</strong></span>. Leave the other parameters at their default values.<div class="mediaobject"><img src="graphics/0792EN_09_2.jpg" alt="Building a recommendation system"/></div></li><li class="listitem">Drag a <span class="strong"><strong>Project Columns</strong></span> module to the canvas and select the columns: <span class="strong"><strong>userID</strong></span>, <span class="strong"><strong>latitude</strong></span>, <span class="strong"><strong>longitude</strong></span>, <span class="strong"><strong>interest</strong></span>, and <span class="strong"><strong>personality</strong></span>.<div class="mediaobject"><img src="graphics/0792EN_09_3.jpg" alt="Building a recommendation system"/></div></li><li class="listitem">Similarly, drag another <span class="strong"><strong>Project Columns</strong></span> module and connect it to the <span class="strong"><strong>Restaurant feature data</strong></span> module and select the columns: <span class="strong"><strong>placeID</strong></span>, <span class="strong"><strong>latitude</strong></span>, <span class="strong"><strong>longitude</strong></span>, <span class="strong"><strong>price</strong></span>, <span class="strong"><strong>the_geom_meter</strong></span>, and <span class="strong"><strong>address</strong></span>, <span class="strong"><strong>zip</strong></span>.</li><li class="listitem">Drag a <span class="strong"><strong>Train </strong></span><a id="id357" class="indexterm"/><span class="strong"><strong>Matchbox Recommender</strong></span> module to the canvas and make connections to the three input ports, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/0792EN_09_4.jpg" alt="Building a recommendation system"/></div></li><li class="listitem">Drag a <span class="strong"><strong>Score Matchbox Recommender</strong></span> module to the canvas and make connections to the three input ports and set the property's values, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/0792EN_09_5.jpg" alt="Building a recommendation system"/></div></li><li class="listitem">Run the experiment and when it gets completed, right-click on the output of the <span class="strong"><strong>Score </strong></span><a id="id358" class="indexterm"/><span class="strong"><strong>Matchbox Recommender</strong></span> module and click on <span class="strong"><strong>Visualize</strong></span> to explore the scored data.<div class="mediaobject"><img src="graphics/0792EN_09_6.jpg" alt="Building a recommendation system"/></div></li></ol></div><p>You can note the different restaurants (IDs) recommended as items for a user from the test dataset. The next step is to evaluate the scored prediction. Drag the <span class="strong"><strong>Evaluate Recommender</strong></span> module to the canvas and connect the second output of the <span class="strong"><strong>Split</strong></span> module to its first input port and connect the output of the <span class="strong"><strong>Score Matchbox Recommender</strong></span> module to its second input. Leave the module at its default properties.</p><div class="mediaobject"><img src="graphics/0792EN_09_7.jpg" alt="Building a recommendation system"/></div><p>Run the experiment again and when finished, right-click on the output port of the <span class="strong"><strong>Evaluate Recommender</strong></span> module and click on <span class="strong"><strong>Visualize</strong></span> to find the evaluation metric.</p><p>The evaluation <a id="id359" class="indexterm"/>metric <span class="strong"><strong>Normalized Discounted Cumulative Gain</strong></span> (<span class="strong"><strong>NDCG</strong></span>) is estimated from the ground truth ratings given in the test set. Its value ranges from <span class="emphasis"><em>0.0</em></span> to <span class="emphasis"><em>1.0</em></span>, where <span class="emphasis"><em>1.0</em></span> represents the most ideal ranking of the entities.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec57"/>Summary</h1></div></div></div><p>You started with gaining the basic knowledge about a recommender system. You then understood the Matchbox recommender that comes with ML Studio along with its components. You also explored different kinds of recommendations that you can make with it. Finally, you ended up building a simple recommendation system to recommend restaurants to a given user.</p><p>In the following chapter, you will explore how to extend your experiments beyond the capability of ML Studio by writing code in either R or Python.</p></div></body></html>