- en: Google Compute Engine
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Compute Engine
- en: The core service of **Google Cloud Platform** (**GCP**) is **Google Compute
    Engine** (**GCE**). The GCE allows you to launch spin up **virtual machines**
    (**VMs**) with the right operating system, size, RAM, and appropriate number of
    CPUs or GPUs for your needs. It is an equivalent of AWS EC2\. With GCE, we dive
    into the core of GCP.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**Google Cloud Platform**（**GCP**）的核心服务是**Google Compute Engine**（**GCE**）。GCE允许您根据您的需求启动具有正确操作系统、大小、RAM以及适当数量的CPU或GPU的虚拟机（**VMs**）。它与AWS
    EC2相当。使用GCE，我们深入GCP的核心。'
- en: 'In this chapter, you will learn how to:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习如何：
- en: Create VM instances on GCE that are adapted to your projects.
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在GCE上创建适合您项目的VM实例。
- en: Use Google's command-line tools to manage your VMs.
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用谷歌的命令行工具管理您的VM。
- en: Set up a Python data science stack on a GCE VM with `conda` and `scikit-learn`.
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在GCE虚拟机上设置一个使用`conda`和`scikit-learn`的Python数据科学堆栈。
- en: Access your VM via a password-protected Jupyter Notebook. And we'll cover more
    advanced topics related to images, snapshots, pre-emptibles VMs, startup script,
    and IPs.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过密码保护的Jupyter Notebook访问您的VM。我们还将涵盖与镜像、快照、预占VM、启动脚本和IPs相关的更多高级主题。
- en: By the end of this chapter, you will be able to create and fully manage your
    VM both via the online console and the command-line tools, as well as implement
    a data science workflow and a Jupyter Notebook workspace.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将能够通过在线控制台和命令行工具创建和管理您的VM，以及实现数据科学工作流程和Jupyter Notebook工作空间。
- en: Google Compute Engine
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Compute Engine
- en: Simply put, GCE is a service that lets you create and run VMs on Google infrastructure.
    The GCE allows you to launch spin up VMs with the right operating system, size,
    RAM, and the appropriate number of CPUs or GPUs for your needs. It is the equivalent
    of AWS EC2.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，GCE是一种允许您在谷歌基础设施上创建和运行VM的服务。GCE允许您根据您的需求启动具有正确操作系统、大小、RAM以及适当数量的CPU或GPU的VM。它与AWS
    EC2相当。
- en: 'The GCE was announced on June 28, 2012, at Google I/O 2012 and made available
    to the general public on May 15, 2013\. Compared to AWS EC2, an equivalent product,
    the GCE is a rather new service:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: GCE于2012年6月28日在Google I/O 2012上宣布，并于2013年5月15日对公众开放。与AWS EC2等类似产品相比，GCE是一个相对较新的服务：
- en: '![](img/e183a41b-0cad-4ecf-ac95-e751055a9c16.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e183a41b-0cad-4ecf-ac95-e751055a9c16.png)'
- en: 'The following extracts from the release notes timeline illustrate the rapid
    evolution of the GCE service from a simple contender to a fully fledged player
    in the Cloud computing domain:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是从发布时间线中摘录的内容，展示了GCE服务从简单的竞争者到云计算领域全面参与者的快速演变：
- en: 'May 15, 2013: GCE is available for everyone.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2013年5月15日：GCE对所有用户开放。
- en: 'August 6, 2013: GCE launches load balancing.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2013年8月6日：GCE推出负载均衡。
- en: 'December 3, 2013: GCE is announced as being production ready. *Users can now
    feel confident using Compute Engine to support mission-critical workloads with
    24/7 support and a 99.95% monthly SLA*.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2013年12月3日：GCE被宣布为生产就绪。*用户现在可以放心使用Compute Engine来支持关键任务工作负载，提供24/7的支持和99.95%的月度服务级别协议*。
- en: 'June 25, 2014: **Solid-State Drives** (**SSD**) persistent disks are now available
    in general availability and open to all users and projects.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2014年6月25日：**固态硬盘**（**SSD**）持久磁盘现在普遍可用，对所有用户和项目开放。
- en: 'September 08, 2015: Pre-emptible instances are now generally available to all
    users and projects.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2015年9月8日：可预占实例现在对所有用户和项目普遍可用。
- en: 'March 30, 2016: Persistent disks larger than 10 TB are generally available.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2016年3月30日：大于10 TB的持久磁盘现在普遍可用。
- en: 'July 1, 2016: Shutdown scripts are now generally available to use with compute
    engine instances.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2016年7月1日：关机脚本现在普遍可用，可用于计算引擎实例。
- en: 'September 21, 2017: NVIDIA® Tesla® K80 GPUs are now generally available.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2017年9月21日：NVIDIA® Tesla® K80 GPU现在普遍可用。
- en: 'September 26, 2017: Billing increments for GCE VM instances are reduced from
    per-minute increments to per-second increments.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2017年9月26日：GCE虚拟机实例的计费增量从每分钟增量减少到每秒增量。
- en: The most recent news at the time of writing this is the launch in beta of a
    staggering 96-vCPUs machine types.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在撰写本文时最新的消息是推出了惊人的96-vCPU机器类型。
- en: 'In the past four years, Google has been steadily improving and developing its
    GCE offer at a rapid pace by:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去的四年里，谷歌通过以下方式稳步提高和快速发展其GCE服务：
- en: Expanding regions
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展区域
- en: Adding more powerful machines and Intel CPU platforms
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加更强大的机器和英特尔CPU平台
- en: Adding roles and features
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加角色和功能
- en: Steadily releasing new public images for Windows, Suse, CentOS, Debian, Ubuntu,
    RHEL, or CoreOS
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 持续推出针对 Windows、Suse、CentOS、Debian、Ubuntu、RHEL 或 CoreOS 的新公共镜像
- en: As the timeline illustrates, the GCE service is a young and dynamic service
    that embraces the evolution of its customers needs and anticipates them with bold
    new offers. It reflects Google's drive to become a leader in the Cloud computing
    business and potentially offset Amazon's lead in Cloud computing.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 如时间线所示，GCE 服务是一个年轻且动态的服务，它拥抱其客户需求的变化，并以大胆的新产品来预见它们。它反映了谷歌成为云计算业务领导者的动力，并有可能抵消亚马逊在云计算中的领先地位。
- en: Before we launch our first GCE VM, let's cover a few important concepts.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们启动第一个 GCE 虚拟机之前，让我们先了解一些重要概念。
- en: VMs, disks, images, and snapshots
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 虚拟机、磁盘、镜像和快照
- en: A VM is an on-demand virtual server that you spin up for your needs. It is geographically
    located in one of Google's data centers, but you only choose the region and zone,
    not the precise location. Although you share some of the infrastructure resources
    with other users, this sharing is transparent to you.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机是一个按需虚拟服务器，您可以根据需要启动它。它位于谷歌数据中心的一个地理位置，但您只需选择区域和区域，而不是确切的位置。尽管您与其他用户共享一些基础设施资源，但这种共享对您来说是透明的。
- en: A VM requires a persistent disk to run on and an operating system such as a
    Windows or Linux distribution to boot on. Although very much abstracted in a cloud
    computing context, a GCE disk would refer to a physical drive that the computer
    can boot on.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机需要一个持久磁盘来运行，以及一个操作系统，如 Windows 或 Linux 发行版来启动。尽管在云计算环境中非常抽象，但 GCE 磁盘将指的是计算机可以启动的物理驱动器。
- en: An image exists on top of a persistent disk, and includes the operating system
    necessary to launch the instance. A typical use of an image is to enable sharing
    a VM setup across many different VMs. An image consists of an operating system
    and boot loader and can be used to boot an instance.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 一个镜像位于持久磁盘之上，并包含启动实例所需的操作系统。镜像的一个典型用途是允许在许多不同的虚拟机之间共享虚拟机设置。镜像由操作系统和引导加载程序组成，可以用来启动实例。
- en: A **snapshot** is a reflection of the content of a VM at a given time. A snapshot
    is mostly used for instant backups. Snapshots are stored as diffs, relative to
    the previous one, while images are not.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '**快照**是虚拟机在特定时间点的内容的反映。快照主要用于即时备份。快照作为相对于前一个快照的差异存储，而镜像则不是。'
- en: Images and snapshots are quite similar. It's possible to activate an instance
    using a snapshot or an image.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 镜像和快照非常相似。可以使用快照或镜像激活实例。
- en: When you launch a new instance, GCE starts by attaching a persistent disk to
    your VM. This provides the disk space and gives the instance the root filesystem
    it needs to boot up. The disk uses the image you have chosen and installs the
    OS associated with that image. Public images are provided by Google with specific
    OS while private images are your own images.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当您启动一个新实例时，GCE 首先会将一个持久磁盘附加到您的虚拟机上。这提供了磁盘空间，并为实例提供了启动所需的根文件系统。磁盘使用您选择的镜像，并安装与该镜像关联的操作系统。公共镜像由谷歌提供，具有特定的操作系统，而私有镜像则是您自己的镜像。
- en: By taking snapshots of an image, you can copy data from existing persistent
    disks to new persistent disks. Snapshots are meant for creating instant backups.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 通过对镜像进行快照，您可以将现有持久磁盘中的数据复制到新的持久磁盘。快照旨在创建即时备份。
- en: From the Google Shell, you can access and manage all your resources and files.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Google Shell，您可以访问和管理您所有的资源和文件。
- en: 'For example, let''s list all our existing instances by typing:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，让我们通过输入以下命令来列出所有现有的实例：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We see our newly created sparrow instance.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到了我们新创建的麻雀实例。
- en: Creating a VM
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建虚拟机
- en: Let's now create our first VM instance using the web console.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将使用网络控制台创建我们的第一个虚拟机实例。
- en: 'Go to the GCE console, [https://console.cloud.google.com/](https://console.cloud.google.com/).
    Select the project we created in the previous chapter (or create one if you don''t
    have one yet), and in the menu on the left, click on Compute Engine. Since you
    don''t have a VM yet, you are greeted by the following message. Click on Create
    as shown in the following screenshot:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 前往 GCE 控制台，[https://console.cloud.google.com/](https://console.cloud.google.com/)。选择我们在上一章中创建的项目（或者如果您还没有，可以创建一个），然后在左侧菜单中点击
    Compute Engine。由于您还没有虚拟机，您将看到以下消息。点击创建，如图所示：
- en: '![](img/d0d2a021-5406-4ab0-b29e-764f6527d6e7.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d0d2a021-5406-4ab0-b29e-764f6527d6e7.png)'
- en: For this first VM, we will choose a small one and resize it as we go along.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个第一个虚拟机，我们将选择一个小的，并在进行过程中调整其大小。
- en: 'There are several things you need to decide on at this point:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在此阶段，您需要做出几个决定：
- en: The name of your instance. I will call mine **sparrow**. This name does not
    have to be unique across GCP. Feel free to name yours as you like.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您实例的名称。我将称我的为**麻雀**。这个名称不需要在 GCP 中是唯一的。请随意命名您的。
- en: The region and the zone. It's often better to choose the zone closest to you
    to reduce latency. However, GCP services often open in the US first and become
    available only after a while in other parts of the world. Different zones may
    also have different rules and regulations. For instance, Europe offers stronger
    data related privacy laws than the US. Choose the zone as you see fit. It will
    always be possible to change the zone later.
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 地区和区域。通常最好选择离您最近的地域以减少延迟。然而，GCP 服务通常首先在美国开放，在其他地区的可用性要晚一些。不同地域也可能有不同的规则和法规。例如，欧洲提供比美国更强的数据相关隐私法律。根据您的需要选择区域。您总是可以在以后更改区域。
- en: 'Selecting the right machine type is important. At time of writing this book,
    different machines are grouped in categories as small, standard, high CPU and
    high RAM:'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择正确的机器类型很重要。在撰写本书时，不同的机器被分为小型、标准、高 CPU 和高 RAM 等类别：
- en: '**Small**: Shared CPUs and limited RAM'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**小型**：共享 CPU 和有限的 RAM'
- en: '**Standard VMs**: 3.75 GB of RAM'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准虚拟机**：3.75 GB 的 RAM'
- en: '**High-memory VMs**: 13 GB RAM'
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高内存虚拟机**：13 GB RAM'
- en: '**High-CPU VMs**: 1.8 GB'
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高CPU虚拟机**：1.8 GB'
- en: The small category is perfect to get started with and build some hands-on experience
    with the platform. For more intense projects, you may want more more computational
    power or more memory.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 小型类别非常适合入门并在此平台上积累一些实践经验。对于更复杂的项目，您可能需要更多的计算能力或更多的内存。
- en: Note that free-trial accounts are limited to eight CPUs.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，免费试用账户的 CPU 数量限制为八个。
- en: 'It is also possible to customize the machine you need by setting the number
    of CPUs or memory per CPU you want. This is also where you choose the number of
    GPUs to have on your machine, as shown in the following screenshot:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以通过设置您想要的每个 CPU 的 CPU 数量或内存来定制您需要的机器。这也是您选择机器上 GPU 数量的地方，如下面的截图所示：
- en: '![](img/097b1ed2-0dbd-49e9-a47a-7e6ac40912a4.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/097b1ed2-0dbd-49e9-a47a-7e6ac40912a4.png)'
- en: 'Finally, you need to choose the OS for your VM. The Debian Linux distribution
    is offered by default. You have a choice among several OSes: Windows, CentOS,
    Suse, CoreOS, and Ubuntu. Although Ubuntu is often the most popular choice, there
    is actually little difference between Debian and Ubuntu and we will go with the
    default Debian distribution. If you''re more familiar with the Ubuntu distribution,
    go for it. It should not cause any problems in this chapter.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，您需要为您的虚拟机选择操作系统。默认情况下提供的是 Debian Linux 发行版。您可以在几个操作系统中进行选择：Windows、CentOS、Suse、CoreOS
    和 Ubuntu。尽管 Ubuntu 通常是最受欢迎的选择，但实际上 Debian 和 Ubuntu 之间几乎没有区别，我们将使用默认的 Debian 发行版。如果您更熟悉
    Ubuntu 发行版，请选择它。这在本章中不应引起任何问题。
- en: Ubuntu or Debian?Debian is one of the first Linux distributions with a first
    stable release in 1996\. Ubuntu started as a fork, a branched out version of Debian
    in 2004\. The two distributions are very similar, with Ubuntu being more user
    friendly and having a better desktop/UI experience. Debian is usually preferred
    for servers, a massive package library, with a strong focus on stability and open-licensed
    software. A stable version of Debian is released approximately every two years.
    The Ubuntu release cycle is six months. Ubuntu takes the unstable branch of Debian,
    makes customization especially in terms of the UI, and releases it. For our work,
    there should be close to no difference between either distribution and we will
    use Debian for our VMs.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu 还是 Debian？Debian 是第一个在 1996 年发布第一个稳定版本的 Linux 发行版。Ubuntu 于 2004 年开始作为
    Debian 的分支，即 Debian 的衍生版本。这两个发行版非常相似，Ubuntu 更易于用户使用，并且具有更好的桌面/UI 体验。Debian 通常用于服务器，拥有庞大的软件包库，重点在于稳定性和开源软件。Debian
    的稳定版本大约每两年发布一次。Ubuntu 的发布周期为六个月。Ubuntu 从 Debian 的不稳定分支中提取，特别在 UI 方面进行定制，然后发布。对于我们的工作，这两个发行版之间应该几乎没有区别，我们将使用
    Debian 作为我们的虚拟机。
- en: Leave all the rest of parameters to their default choices. We will come back
    to HTTPs traffic, disks, networking, and `ssh` keys in a few pages.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 将所有其他参数保留为默认选择。我们将在几页后回到 HTTPS 流量、磁盘、网络和 `ssh` 密钥。
- en: 'One very useful feature in the web console that lowers the learning curve to
    mastering the GCP is the two links at the bottom of the VM creation page, Equivalent
    Rest or command line, as shown in the following image:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在网页控制台中，有一个非常有用的功能可以降低掌握GCP的学习曲线，那就是在虚拟机创建页面底部的两个链接，即“等效REST”或“命令行”，如下图中所示：
- en: '![](img/1a1844f3-3d0a-4c89-bda1-6b2f5475795b.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1a1844f3-3d0a-4c89-bda1-6b2f5475795b.png)'
- en: The command line link exists on multiple pages of the web console. It is a very
    useful feature to quickly learn the right syntax and parameters of the GCP command
    line tools.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行链接存在于网页控制台的多个页面中。这是一个非常有用的功能，可以快速学习GCP命令行工具的正确语法和参数。
- en: Our VM is now created, up and running!
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的虚拟机现在已经创建完成，正在运行中！
- en: '![](img/a40c0e77-6c49-4865-b19e-bb64a8c7cb95.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a40c0e77-6c49-4865-b19e-bb64a8c7cb95.png)'
- en: Now that we have a brand new shiny VM, how do we access it? That nicely leads
    us to the Google Shell.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个全新的闪亮的虚拟机，我们该如何访问它？这很自然地引出了Google Shell。
- en: Google Shell
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Shell
- en: The Google Shell is Google's smart way of giving you a standalone terminal in
    your browser to access and manage your resources.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Google Shell是Google在浏览器中为你提供一个独立终端的智能方式，以便访问和管理你的资源。
- en: 'You activate the Google Shell by clicking on the >_ icon in the upper right
    part of the console page:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过点击控制台页面右上角的 >_ 图标来激活Google Shell：
- en: '![](img/5e055b57-d27d-470c-bf22-ec2588696e4d.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/5e055b57-d27d-470c-bf22-ec2588696e4d.png)'
- en: 'The browser window splits into half and the lower part is now a shell terminal:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览器窗口分为两部分，现在下半部分是一个shell终端：
- en: '![](img/4b9953b4-413a-4b27-83cd-6b20c51c1755.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/4b9953b4-413a-4b27-83cd-6b20c51c1755.png)'
- en: This terminal runs on an f1-micro GCE VM with a Debian operating system. It
    is created on a per user and per session basis. It persists when your Cloud Shell
    session is active and is deleted after 20 minutes of inactivity. The instance
    runs on a persistent disk with 5 GB storage. Both the disk and the image are available
    at no extra cost. Although the instance is not persistent across sessions, its
    associated disk is persistent across sessions. Everything you create via the Google
    Shell will be available as you've left it at the beginning of your next session.
    This includes all the files you store, the software you install and the configuration
    files you edit (`.bashrc` and `.vimrc` for instance). This disk is private and
    cannot be accessed by other users. And, finally, the Google Shell instance comes
    pre-installed with the Google Cloud SDK and other popular developer tools such
    as VIM.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这个终端运行在具有Debian操作系统的f1-micro GCE VM上。它是根据每个用户和每个会话创建的。当你的Cloud Shell会话处于活动状态时，它会持续存在，在20分钟的无操作后会被删除。该实例运行在具有5GB存储空间的持久磁盘上。磁盘和镜像都是免费的。尽管实例不会跨会话持久，但与其关联的磁盘是跨会话持久的。你通过Google
    Shell创建的所有内容都将按照你下次会话开始时的状态可用。这包括你存储的所有文件、你安装的软件以及你编辑的配置文件（例如`.bashrc`和`.vimrc`）。这个磁盘是私有的，其他用户无法访问。最后，Google
    Shell实例预装了Google Cloud SDK和其他流行的开发者工具，如VIM。
- en: Some of the commands you run via the web console will be memorized in your Google
    Shell VM. For instance, the SQL queries you run on a Google SQL instance, will
    show up in a `.mysql_history` file in your user's `$HOME` folder. More info on
    the Google Shell can be found in the `README-cloudshell.txt` in your `$HOME` folder.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你通过网页控制台运行的某些命令将被保存在你的Google Shell VM中。例如，你在Google SQL实例上运行的SQL查询，将出现在你用户目录的`$HOME`文件夹中的`.mysql_history`文件中。关于Google
    Shell的更多信息可以在你`$HOME`文件夹中的`README-cloudshell.txt`文件中找到。
- en: 'From the Google Shell, you can access and manage all your resources and files.
    For example, let''s list all our existing instances by typing:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 从Google Shell，你可以访问和管理所有你的资源和文件。例如，让我们通过输入以下命令来列出所有现有的实例：
- en: '[PRE1]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We see our newly created sparrow instance:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到我们新创建的麻雀实例：
- en: '![](img/ba21c51e-c467-4278-a800-0d0c1e6fbfbb.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/ba21c51e-c467-4278-a800-0d0c1e6fbfbb.png)'
- en: 'To access the VM you just created, type in:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问你刚刚创建的虚拟机，请输入：
- en: '[PRE2]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This will run through the creation of the necessary `ssh` keys. And you are
    now no longer on the Google''s Cloud Shell VM instance but on the sparrow VM.
    To check which OS and version we''re running in our sparrow instance, we run:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这将运行必要的`ssh`密钥的创建过程。现在你已经不在Google的Cloud Shell VM实例上了，而是在麻雀VM上了。为了检查我们在麻雀实例上运行的是哪个操作系统和版本，我们运行：
- en: '[PRE3]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: On the sparrow machine, I have Debian GNU/Linux 9 (stretch), while on the Google
    Shell VM, it's Debian GNU/Linux 8 (jessie). Which tells me that the Google Shell
    is not yet on the most recent version of the Debian distribution. You may, of
    course, see different results.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在麻雀机器上，我安装的是Debian GNU/Linux 9（stretch），而在Google Shell VM上，则是Debian GNU/Linux
    8（jessie）。这告诉我Google Shell尚未升级到Debian发行版的最新版本。当然，您可能会看到不同的结果。
- en: Google Cloud Platform SDK
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Cloud Platform SDK
- en: 'GCP offers several standalone **command-line interfaces** (**CLIs**) to manage
    and interact with your GCP resources, `gcloud` being the main one. All secondary
    command-line tools are installed via `gcloud`. At time of writing this, the command-line
    tools are:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: GCP提供了几个独立的**命令行界面（CLIs**）来管理和与您的GCP资源交互，其中`gcloud`是主要的。所有次要命令行工具都是通过`gcloud`安装的。在撰写本文时，命令行工具有：
- en: '`gcloud`: The main CLI to manage your GCP resources and projects: authentication,
    local configuration, developer workflow, and interactions with the GCP APIs. The
    following services can be handled via the `gcloud` CLI: app engine, auth, compute
    engine, container, DataFlow, Dataproc, machine learning, SQL databases as well
    as deployment of Cloud resources, Iam setup, and logging with Stackdriver and
    web resources such as DNS, Domains, or Firebase.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gcloud`：管理您的GCP资源和项目的核心命令行界面：身份验证、本地配置、开发者工作流程以及与GCP API的交互。以下服务可以通过`gcloud`命令行界面处理：应用引擎、身份验证、计算引擎、容器、DataFlow、Dataproc、机器学习、SQL数据库以及Cloud资源的部署、Iam设置、与Stackdriver和Web资源（如DNS、域或Firebase）的日志记录。'
- en: 'Gcloud also takes care of other command-line tools:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Gcloud还负责其他命令行工具：
- en: '`gsutil`: This is the CLI for Google Storage. You use `gsutil` to create and
    delete buckets, upload, download and move files around, set permissions, and so
    forth.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gsutil`：这是Google Storage的命令行界面。您使用`gsutil`创建和删除存储桶、上传、下载和移动文件、设置权限等。'
- en: '`bq`: This is the CLI for interacting with BigQuery.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bq`：这是与BigQuery交互的命令行界面。'
- en: '`datalab`: The Datalab CLI.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`datalab`：Datalab命令行界面。'
- en: All these CLI tools are Python scripts and require Python 2.7 installed on your
    system.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些命令行工具都是Python脚本，需要在您的系统上安装Python 2.7。
- en: To install `gcloud`, the best way is to follow the instructions on the Cloud
    DSK page at [https://cloud.google.com/sdk/downloads](https://cloud.google.com/sdk/downloads).
    Download the right package and run the appropriate commands for your machine.
    The install will guide you through the creation of `ssh` keys. It will install
    three files in your `~/.ssh` folder. Your public and private `ssh` keys (that
    is, `google_compute_engine.pub` and `google_compute_engine`) and the list of know
    hosts (`google_compute_known_hosts`).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装`gcloud`，最佳方式是遵循Cloud DSK页面上的说明[https://cloud.google.com/sdk/downloads](https://cloud.google.com/sdk/downloads)。下载正确的包，并运行适合您机器的相应命令。安装过程将引导您创建`ssh`密钥。它将在您的`~/.ssh`文件夹中安装三个文件。您的公钥和私钥（即`google_compute_engine.pub`和`google_compute_engine`）以及已知主机列表（`google_compute_known_hosts`）。
- en: 'You can verify that `gcloud` is properly installed by running `gcloud version`
    in the terminal. Your output will be similar to:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过在终端中运行`gcloud version`来验证`gcloud`是否正确安装。您的输出将类似于：
- en: '[PRE4]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'As we can see, `gcloud` is not a one-size-fits-all tool. `gcloud` comes loaded
    with components. They can either be other standalone CLIs such as `gsutils`, `bq`,
    `datalab` or `gcloud` extensions (`app-engine-python`), as well as Alpha and Beta
    release levels. To see which components are installed in your `gcloud`, run:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，`gcloud`不是一个万能工具。`gcloud`内置了组件。这些组件可以是其他独立的CLIs，如`gsutils`、`bq`、`datalab`，或者是`gcloud`扩展（如`app-engine-python`），以及Alpha和Beta发布级别。要查看您的`gcloud`中安装了哪些组件，请在终端中运行以下命令：
- en: '[PRE5]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'You will obtain the following result:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 您将获得以下结果：
- en: '![](img/42154b10-241f-48e4-9c48-89d7a0f1745c.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/42154b10-241f-48e4-9c48-89d7a0f1745c.png)'
- en: 'To install or remove components in your current SDK version (173.0.0), use
    this:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 要在当前SDK版本（173.0.0）中安装或删除组件，请使用以下命令：
- en: '[PRE6]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'To update your SDK installation to the latest version (175.0.0), run:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 要将SDK安装更新到最新版本（175.0.0），请运行：
- en: '[PRE7]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Gcloud
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Gcloud
- en: 'Let''s go through a few commands to get a feel for the syntax of the `gcloud`
    CLI:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过几个命令来了解`gcloud`命令行界面的语法：
- en: 'To list all your projects, use:'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要列出所有项目，请使用以下命令：
- en: '[PRE8]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To list all your instances in the `packt-gcp` project, use:'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要列出`packt-gcp`项目中的所有实例，请使用以下命令：
- en: '[PRE9]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The global generic syntax of the `gcloud` that also applies the other CLI tools
    is:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '`gcloud`的全局通用语法也适用于其他CLI工具：'
- en: '[PRE10]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Where `GROUP` is a service or an account element and `COMMAND` is the command
    to send to the `GROUP`. For instance in `gcloud projects list`, `projects` is
    the `GROUP`, an element of your account and `list` is the `COMMAND`. In `gcloud
    compute instances list --project packt-gcp`, the `GROUP` is `compute`, followed
    by a sub-group `instances`, and the `COMMAND` is `list` while `--project packt-gcp`
    are the required parameters.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `GROUP` 是服务或账户元素，`COMMAND` 是要发送到 `GROUP` 的命令。例如，在 `gcloud projects list`
    中，`projects` 是 `GROUP`，您的账户的一个元素，而 `list` 是 `COMMAND`。在 `gcloud compute instances
    list --project packt-gcp` 中，`GROUP` 是 `compute`，后面跟着子组 `instances`，而 `list` 是
    `COMMAND`，`--project packt-gcp` 是必需的参数。
- en: 'gcloud parameters include account settings (keys and region for instance),
    CLI settings (verbosity, format, or specific configuration) as well as arguments
    required by the commands. For example, to start our instance, we need to specify
    two parameters—the region and the instance ID:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: gcloud 参数包括账户设置（例如实例的密钥和区域）、CLI 设置（详细程度、格式或特定配置）以及命令所需的参数。例如，要启动我们的实例，我们需要指定两个参数——区域和实例
    ID：
- en: '[PRE11]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Gcloud config
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Gcloud 配置
- en: 'To avoid having to specify the zone or other parameters, you can set them in
    the `config` with:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免在 `config` 中指定区域或其他参数，您可以在其中设置它们：
- en: '[PRE12]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'And to unset them in the `config`, you can use the following:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 `config` 中取消设置它们，您可以使用以下命令：
- en: '[PRE13]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: For a list of all the different settings available in the `config`, run `gcloud
    config set --help`.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 要列出 `config` 中所有可用的设置，请运行 `gcloud config set --help`。
- en: The zone and region can be also stored in the environment variable `CLOUDSDK_COMPUTE_ZONE`
    and `CLOUDSDK_COMPUTE_REGION`. Environment variables override default properties
    that you set with the `gcloud` `config` commands, but do not override explicit
    flags like `--zone` or `--region`.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 区域和区域也可以存储在环境变量 `CLOUDSDK_COMPUTE_ZONE` 和 `CLOUDSDK_COMPUTE_REGION` 中。环境变量会覆盖您使用
    `gcloud` `config` 命令设置的默认属性，但不会覆盖像 `--zone` 或 `--region` 这样的显式标志。
- en: 'To set the environment variable `CLOUDSDK_COMPUTE_ZONE`, run or add this line
    to your `.bashrc`:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置环境变量 `CLOUDSDK_COMPUTE_ZONE`，请在您的 `.bashrc` 文件中运行或添加以下行：
- en: '[PRE14]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: For more details, see [https://cloud.google.com/compute/docs/gcloud-compute/#set_default_zone_and_region_in_your_local_client](https://cloud.google.com/compute/docs/gcloud-compute/#set_default_zone_and_region_in_your_local_client).
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 更多详情，请参阅 [https://cloud.google.com/compute/docs/gcloud-compute/#set_default_zone_and_region_in_your_local_client](https://cloud.google.com/compute/docs/gcloud-compute/#set_default_zone_and_region_in_your_local_client)。
- en: Accessing your instance with gcloud
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 gcloud 访问您的实例
- en: 'There are two important things you want to do from the start:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 从一开始，您想要做的有两件重要的事情：
- en: Accessing the instance
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问实例
- en: 'Moving files between your instance and another machine. To do `ssh` into your
    instance, run:'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在您的实例和另一台机器之间移动文件。要使用 `ssh` 连接到您的实例，请运行：
- en: '[PRE15]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'In our case:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的案例中：
- en: '[PRE16]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The first time you access your instance from your local system, the platform
    will propagate your keys to the instance, which may take a few minutes. Once connected,
    you can verify that your local public key (`cat ~/.ssh/google_compute_engine.pub`)
    is included in the list of `authorized_keys` on your instance (`cat ~/.ssh/authorized_keys`).
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次从您的本地系统访问您的实例时，平台将传播您的密钥到实例，这可能需要几分钟。一旦连接，您可以通过检查您的本地公钥（`cat ~/.ssh/google_compute_engine.pub`）是否包含在实例的
    `authorized_keys` 列表中（`cat ~/.ssh/authorized_keys`）来验证。
- en: Transferring files with gcloud
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 gcloud 传输文件
- en: 'Transferring files back and forth from your machine (or any other location)
    and your instance is done via Gcloud''s version of the `.csp` command:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Gcloud 的 `.csp` 命令版本在您的机器（或任何其他位置）和实例之间来回传输文件完成：
- en: 'To send a local file to your instance `$HOME` folder:'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要将本地文件发送到您的实例 `$HOME` 文件夹：
- en: '[PRE17]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'For instance, to send a file titled `hello_world.txt` to sparrow, you would
    run this:'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如，要将名为 `hello_world.txt` 的文件发送到 sparrow，您将运行以下命令：
- en: '[PRE18]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Similarly, to download a file from the instance to your local machine `$HOME`
    folder:'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类似地，要从实例下载文件到您的本地机器 `$HOME` 文件夹：
- en: '[PRE19]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We will explore the `gsutil` and `bq` command-line tools in the next chapter
    and the Datalab CLI in [Chapter 4](862553c5-4bb7-4a5c-b7bd-03f0eb8d413e.xhtml),
    *Querying Your data with BigQuery*.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一章中探讨 `gsutil` 和 `bq` 命令行工具，在第四章中探讨 Datalab CLI（*使用 BigQuery 查询您的数据*）。
- en: Managing the VM
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理虚拟机
- en: 'There are several operations that you will want to do as you start working
    with a VM on Google Compute, such as starting instances, stopping instances, resizing
    and modifying disks, and taking snapshots. We go over the most important ones:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 当你开始使用 Google Compute 上的虚拟机时，你将想要执行几个操作，例如启动实例、停止实例、调整磁盘大小和修改磁盘、以及创建快照。我们将介绍其中最重要的：
- en: 'Start and shut down the VM:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动和关闭虚拟机：
- en: '[PRE20]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Check the VM status:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查虚拟机状态：
- en: '[PRE21]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The instance we started with is an f1-micro with not-enough CPU, RAM, or disk
    space for a real-world data science project. We want to change the underlying
    machine and augment its disk space. But, before that, we should take a snapshot
    of our current machine as a backup. If anything goes wrong, we''ll be able to
    restore the instance from the snapshot:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我们开始时使用的实例是一个 f1-micro，对于实际的数据科学项目来说，CPU、RAM 或磁盘空间都不够。我们想更改底层机器并增加其磁盘空间。但在那之前，我们应该对我们的当前机器进行快照作为备份。如果出了问题，我们能够从快照中恢复实例：
- en: 'Taking a snapshot of a VM:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对虚拟机进行快照：
- en: '[PRE22]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'In our case, let''s call our disk `sparrow-backup` as we run:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们的例子中，让我们在运行时将我们的磁盘命名为 `sparrow-backup`：
- en: '[PRE23]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Changing the machine type, you first need to stop your instance with `$ gcloud
    compute instances stop sparrow --project packt-gcp`. Once that''s done, changing
    the machine type is doable with the generic command:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改机器类型时，你首先需要停止你的实例，使用命令 `$ gcloud compute instances stop sparrow --project
    packt-gcp`。一旦完成，就可以使用通用命令更改机器类型：
- en: '[PRE24]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'In our case, if we want to change the type to `n1-standard-1` (3.75 GB memory
    and 1 vCPU), we should run this:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们的例子中，如果我们想将类型更改为 `n1-standard-1`（3.75 GB 内存和 1 个 vCPU），我们应该运行以下命令：
- en: '[PRE25]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'While we''re at it, we would also like to resize the underlying disk from 10
    GB to 100 GB:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们处理这些时，我们还想将底层磁盘从 10 GB 调整到 100 GB：
- en: '[PRE26]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Another important setting is to make sure that the disk will not be deleted
    when the instance is deleted:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 另一个重要的设置是确保在删除实例时不会删除磁盘：
- en: '[PRE27]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'This is an important parameter that can also be set in the compute engine console
    by unselecting Delete boot disk when instance is deleted when creating or editing
    an instance:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个重要的参数，也可以在计算引擎控制台中设置，通过在创建或编辑实例时取消选择“实例删除时删除启动磁盘”：
- en: '![](img/f08c0a52-e038-4c69-9f7a-30c0f9c36661.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/f08c0a52-e038-4c69-9f7a-30c0f9c36661.png)'
- en: 'Instance configuration: The entire instance configuration is available via
    `$ gcloud` compute instances describe sparrow.'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实例配置：整个实例配置可以通过 `$ gcloud` compute instances describe sparrow 获取。
- en: 'Creating the right VM from scratch: in this all these parameters are available
    when you create a VM from scratch. Running the following command will create a
    new `n1-standard-1` instance named `hummingbird` in the `europe-west1-c` zone,
    when running on Ubuntu 17.04, with a 100 GB disk also named `hummingbird`. Note
    that this instance is pre-emptible (`--preemptible`) and the disk will persist
    once the instance is deleted (`--no-boot-disk-auto-delete`):'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从头创建正确的虚拟机：在这个例子中，当你从头创建虚拟机时，所有这些参数都是可用的。运行以下命令将在 `europe-west1-c` 区域创建一个新的
    `n1-standard-1` 实例，名为 `hummingbird`，在 Ubuntu 17.04 上运行，带有 100 GB 的磁盘，也命名为 `hummingbird`。请注意，这个实例是可抢占的（`--preemptible`），并且磁盘在实例删除后将持续存在（`--no-boot-disk-auto-delete`）：
- en: '[PRE28]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'We can verify that we now have two instances in our project:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以验证，现在我们的项目中已经有了两个实例：
- en: 'To keep our resources under control, we should delete this new instance with:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 为了控制我们的资源，我们应该使用以下命令删除这个新实例：
- en: '[PRE29]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Note that if you have set up a different zone as default either in the `config`
    setup or as an environment variable, you need to specify the zone of the instance
    before you can delete it; otherwise, a `resource not found` error message will
    be generated.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，如果你在 `config` 设置或作为环境变量中设置了不同的默认区域，在删除实例之前，你需要指定实例的区域；否则，将生成一个 `资源未找到` 的错误信息。
- en: IPs
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IP 地址
- en: You must have noticed the presence of an internal and an external IP associated
    with our VMs. Each GCP project comes with a **Virtual Private Cloud** (**VPC**)
    network, which is automatically created with the project. A VPC is basically a
    private and isolated virtual network partition that enables your resources to
    talk to each other within a given project, while allowing control of external
    access to the VPC. Upon creation, each instance gets an internal IP address assigned
    to allow other resources within the project's VPC to communicate with the instance.
    To communicate with entities outside the VPC, including connections with the internet,
    the instance requires an external IP address.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 您一定注意到了与我们的VM关联的内部和外部IP的存在。每个GCP项目都附带一个**虚拟专用云**（**VPC**）网络，该网络与项目自动创建。VPC基本上是一个私有和隔离的虚拟网络分区，它使您的资源能够在给定项目内相互通信，同时允许控制对VPC的外部访问。创建时，每个实例都会分配一个内部IP地址，以便项目VPC内的其他资源能够与实例通信。要与VPC之外的对象通信，包括与互联网的连接，实例需要外部IP地址。
- en: IP addresses, both internal and external, can be ephemeral or static. Ephemeral
    IP addresses remain associated with the instance only as long as the instance
    is running. When the instance stops or is terminated, the IP address is released
    in the global GCP pool of IP addresses. For an instance to have a stable IP address,
    the IP address needs to become static. Static addresses generate extra costs.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: IP地址，无论是内部还是外部，可以是短暂的或静态的。短暂的IP地址仅在实例运行期间与实例关联。当实例停止或被终止时，IP地址将在全局GCP IP地址池中释放。为了使实例有一个稳定的IP地址，IP地址需要变为静态。静态地址会产生额外的费用。
- en: 'Changing the nature of an IP address from ephemeral to static can be done via
    the console. Stop the VM and edit it. In the Network interface section, select
    the right type for the internal and external IPs of the VM:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 将IP地址的性质从短暂更改为静态可以通过控制台完成。停止VM并编辑它。在网络接口部分，选择VM的内部和外部IP地址的正确类型：
- en: '![](img/05cdf268-94bc-4386-b5a4-f6db44cbd2a2.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/05cdf268-94bc-4386-b5a4-f6db44cbd2a2.png)'
- en: The management of IPs and VPCs is accessible from the VPC network console at
    [https://console.cloud.google.com/networking/networks/list](https://console.cloud.google.com/networking/networks/list).
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 可以从[VPC网络控制台](https://console.cloud.google.com/networking/networks/list)访问IP地址和VPC的管理。
- en: 'You can create a new static IP address and then attach it to your instance
    directly from the External IP addresses page:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以直接从外部IP地址页面创建一个新的静态IP地址并将其附加到您的实例：
- en: '![](img/fa901139-ba02-475f-9b00-eb1939e74e62.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/fa901139-ba02-475f-9b00-eb1939e74e62.png)'
- en: 'Click on Reserve a static address, select regional for region type, set the
    region to your instance''s region, and attach it to your sparrow instance:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“预留静态地址”，选择区域类型为“区域”，设置区域为您的实例所在区域，并将其附加到您的麻雀实例：
- en: '![](img/c67cd3a2-8491-4dcd-b03d-c4aeb9176d5d.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/c67cd3a2-8491-4dcd-b03d-c4aeb9176d5d.png)'
- en: 'The command-line equivalent of creating a static IP and adding it to the instance
    is:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 创建静态IP并将其添加到实例的命令行等效操作是：
- en: '[PRE30]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: As static IPs are billed even when not used, it is important to release them
    when no longer needed.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 由于静态IP地址即使在未使用时也会计费，因此在不需用时释放它们是很重要的。
- en: Setting up a data science stack on the VM
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在VM上设置数据科学栈
- en: So, now we have a VM running and we're able to send files to it, connect to
    it, and modify it. Everything is ready for us to set it up for data science!
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，现在我们有一个正在运行的虚拟机，我们可以向它发送文件，连接到它，并修改它。一切准备就绪，我们可以为数据科学设置它！
- en: We will install the Python Miniconda stack from continuum, much smaller than
    the full Conda distribution. Do SSH into your instance.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从continuum安装Python Miniconda栈，它比完整的Conda发行版小得多。通过SSH连接到您的实例。
- en: 'Install the mini `sudo apt-get update sudo apt-get install bzip2 wget` from
    [https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh](https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh)
    using the following command:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装mini `sudo apt-get update sudo apt-get install bzip2 wget` from [https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh](https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh)：
- en: '[PRE31]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'And then install the Python stack with `conda`:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后使用`conda`安装Python栈：
- en: '[PRE32]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Don''t forget to do this:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 不要忘记做这件事：
- en: '[PRE33]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: BOX the ipython console
  id: totrans-192
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将ipython控制台框起来
- en: To launch a Jupyter Notebook in your instance and access it over the Web, you
    need to promote the ephemeral external IP address provided by default to your
    VM to a static external IP.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 要在您的实例中启动Jupyter Notebook并通过Web访问它，您需要将默认提供的虚拟机的短暂外部IP地址提升为静态外部IP。
- en: 'You also need to make sure that your instance is accepting HTTP and HTTPS traffic.
    For that, go to your VM page, edit it, and check the following checkboxes:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 您还需要确保您的实例正在接受HTTP和HTTPS流量。为此，前往您的虚拟机页面，编辑它，并检查以下复选框：
- en: '![](img/6ba3f1e3-fea0-41eb-ac82-cad5527409a6.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6ba3f1e3-fea0-41eb-ac82-cad5527409a6.png)'
- en: 'Since your Jupyter Notebook is open to all traffic on the web, you password-protect
    it:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 由于您的Jupyter Notebook对网络上的所有流量都是开放的，您需要通过密码保护它：
- en: 'Generate a configuration:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成配置：
- en: '[PRE34]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'And add a password with:'
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下方式添加密码：
- en: '[PRE35]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: More info on how to protect your public Notebook, including using `ssh` keys
    and adding encryption, is available at [http://jupyter-notebook.readthedocs.io/en/latest/public_server.html](http://jupyter-notebook.readthedocs.io/en/latest/public_server.html).
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 更多关于如何保护您的公共Notebook的信息，包括使用 `ssh` 密钥和添加加密，可在[http://jupyter-notebook.readthedocs.io/en/latest/public_server.html](http://jupyter-notebook.readthedocs.io/en/latest/public_server.html)找到。
- en: 'Launch your Jupyter Notebook with:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启动Jupyter Notebook：
- en: '[PRE36]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'This generates a token and the following message:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成一个令牌和以下消息：
- en: '[PRE37]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Troubleshooting
  id: totrans-206
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 故障排除
- en: 'There is an alternative solution if you encounter problems in accessing your
    Notebook. The idea is to launch the Jupyter Notebook with IP `0.0.0.0`, without
    having to set up a static IP first:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在访问Notebook时遇到问题，有一个替代解决方案。想法是使用IP `0.0.0.0` 启动Jupyter Notebook，而无需先设置静态IP：
- en: '[PRE38]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'This will generate a token. Do SSH into another terminal, adding the following
    flags `--ssh-flag="-L" --ssh-flag="2222:localhost:8888"`:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成一个令牌。然后在另一个终端中SSH进入，添加以下标志 `--ssh-flag="-L" --ssh-flag="2222:localhost:8888"`：
- en: '[PRE39]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: This is how it associates the URL `localhost:2222` with the Jupyter Notebook
    URL `localhost:8888`. You can then access your Notebook at `http://localhost:2222`.
    You also need to enter the token you were given a moment ago.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是如何将URL `localhost:2222` 与Jupyter Notebook URL `localhost:8888` 关联起来。然后您可以在
    `http://localhost:2222` 访问您的Notebook。您还需要输入刚才给出的令牌。
- en: 'This alternative was given by the comments on this blog post by Jeff Delaney,
    *Running a Python Jupyter Notebook on Google Cloud Engine*: [https://jeffdelaney.me/blog/running-jupyter-notebook-google-cloud-platform/](https://jeffdelaney.me/blog/running-jupyter-notebook-google-cloud-platform/).'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 这个替代方案是由Jeff Delaney在以下博客文章的评论中给出的，*在Google Cloud Engine上运行Python Jupyter Notebook*：[https://jeffdelaney.me/blog/running-jupyter-notebook-google-cloud-platform/](https://jeffdelaney.me/blog/running-jupyter-notebook-google-cloud-platform/)。
- en: Adding GPUs to instances
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将GPU添加到实例
- en: 'Check and request for an increase in your quotas for GPUs:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 检查并请求增加您的GPU配额：
- en: Search for GPU. If you have 0 in your allocated quotas, select the type of GPU
    and region and click on edit the quotas. Fill in the request form ([https://console.cloud.google.com/iam-admin/quotas?project=packt-gcp](https://console.cloud.google.com/iam-admin/quotas?project=packt-gcp)).
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索GPU。如果您分配的配额中为0，请选择GPU类型和区域，然后点击编辑配额。填写请求表单([https://console.cloud.google.com/iam-admin/quotas?project=packt-gcp](https://console.cloud.google.com/iam-admin/quotas?project=packt-gcp))。
- en: There are several restrictions when it comes to using GPUs on Google Compute.
    GPUs are not available in shared or pre-emptible machines. GPU instances are terminated
    for regular (weekly) maintenance events. See [https://cloud.google.com/compute/docs/gpus/](https://cloud.google.com/compute/docs/gpus/)
    for up-to-date information on the restrictions. See also [https://cloud.google.com/compute/docs/gpus#introduction](https://cloud.google.com/compute/docs/gpus#introduction)
    to learn what machine types are available based on your desired GPU count.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 在Google Compute上使用GPU时有一些限制。GPU不可用于共享或可抢占的机器。GPU实例会在常规（每周）维护事件中终止。有关限制的最新信息，请参阅[https://cloud.google.com/compute/docs/gpus/](https://cloud.google.com/compute/docs/gpus/)。有关根据您所需的GPU数量了解可用机器类型的信息，请参阅[https://cloud.google.com/compute/docs/gpus#introduction](https://cloud.google.com/compute/docs/gpus#introduction)。
- en: 'To create a VM with GPU from the console:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 从控制台创建带有GPU的虚拟机：
- en: Go to the VM console and click on Create Instance
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往虚拟机控制台，点击创建实例
- en: Select a zone that is GPU compatible
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个兼容GPU的区域
- en: Click on customize the machine type and again on the GPUs link
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击自定义机器类型，然后再次点击GPU链接
- en: 'Select the Number of GPUs and the associated type you require:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择所需的GPU数量和关联的类型：
- en: '![](img/2926c6ff-6316-4560-aa7e-95df0b25f364.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2926c6ff-6316-4560-aa7e-95df0b25f364.png)'
- en: 'Similarly you can create a GPU-enabled instance with `gcloud` with the following
    command:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，您可以使用以下命令使用 `gcloud` 创建启用GPU的实例：
- en: '[PRE40]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Where `--accelerator type= specifies` the type of GPU and `count=` specifies
    the number of GPUs.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `--accelerator type=` 指定GPU类型，`count=` 指定GPU数量。
- en: 'For instance, this command will create an Ubuntu 1604 instance with one NVIDIA®
    Tesla® K80 GPU and two vCPUs in the `us-east1-d` zone. The startup-script metadata
    instructs the instance to install the CUDA toolkit with its recommended driver
    version:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，此命令将在`us-east1-d`区域创建一个带有NVIDIA® Tesla® K80 GPU和两个vCPU的Ubuntu 1604实例。启动脚本元数据指示实例安装CUDA工具包及其推荐的驱动程序版本：
- en: '[PRE41]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: The startup script installs the right CUDA driver for the Ubuntu. For other
    drivers and operating systems, follow the instructions at [https://developer.nvidia.com/cuda-downloads](https://developer.nvidia.com/cuda-downloads).
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 启动脚本为Ubuntu安装正确的CUDA驱动程序。对于其他驱动程序和操作系统，请按照[https://developer.nvidia.com/cuda-downloads](https://developer.nvidia.com/cuda-downloads)上的说明操作。
- en: 'Once the driver has finished installing, you can verify that it is properly
    installed:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦驱动程序安装完成，您可以验证它是否已正确安装：
- en: Do `ssh` into your instance
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过`ssh`连接到您的实例
- en: Type `nvidia-smi` to see your driver version and how much GPU memory you have
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`nvidia-smi`以查看您的驱动程序版本以及您有多少GPU内存
- en: The command `nvcc --version` shows the current CUDA version.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 命令`nvcc --version`显示当前的CUDA版本。
- en: Startup scripts and stop scripts
  id: totrans-233
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启动脚本和停止脚本
- en: 'Startup scripts allow you to run a script when starting up or creating an instance.
    For instance, to always install `miniconda` and related data science packages
    when creating a new instance, simply write the following script in a file on your
    local machine:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 启动脚本允许您在启动或创建实例时运行脚本。例如，要始终在创建新实例时安装`miniconda`和相关数据科学包，只需在您的本地机器上的文件中编写以下脚本：
- en: '[PRE42]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Then as you start the new instance, supply the `--metadata-from-file` flag,
    followed by `startup-script=PATH/TO/FILE`, where `PATH/TO/FILE` is a relative
    path to the startup script:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 然后在启动新实例时，提供`--metadata-from-file`标志，后跟`startup-script=PATH/TO/FILE`，其中`PATH/TO/FILE`是启动脚本相对于当前目录的路径：
- en: '[PRE43]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: You can also use a startup script in extension in the command line or from a
    file stored in Google Storage. For more on startup scripts, visit [https://cloud.google.com/compute/docs/startupscript](https://cloud.google.com/compute/docs/startupscript).
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以在命令行或从存储在Google存储中的文件中使用扩展启动脚本。有关启动脚本更多信息，请访问[https://cloud.google.com/compute/docs/startupscript](https://cloud.google.com/compute/docs/startupscript)。
- en: 'Stop scripts are scripts that are automatically run when an instance is terminated
    or restarted. Similar to startup scripts, you can associate a stop script with
    an instance at creation by adding the `--metadata-from-file flag`, followed by
    `shutdown-script=PATH/TO/FILE`:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 停止脚本是在实例终止或重启时自动运行的脚本。与启动脚本类似，您可以在创建实例时通过添加`--metadata-from-file`标志，后跟`shutdown-script=PATH/TO/FILE`来关联一个停止脚本：
- en: '[PRE44]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Resources and further reading
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 资源和进一步阅读
- en: 'The following are a few interesting articles on setting TensorFlow on GCE:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些关于在GCE上设置TensorFlow的有趣文章：
- en: '**Running distributed TensorFlow on Compute Engine**: [https://cloud.google.com/solutions/running-distributed-tensorflow-on-compute-engine](https://cloud.google.com/solutions/running-distributed-tensorflow-on-compute-engine)'
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在Compute Engine上运行分布式TensorFlow**：[https://cloud.google.com/solutions/running-distributed-tensorflow-on-compute-engine](https://cloud.google.com/solutions/running-distributed-tensorflow-on-compute-engine)'
- en: '**Jupyter + TensorFlow + Nvidia GPU + Docker + GCE**: [https://medium.com/google-cloud/jupyter-tensorflow-nvidia-gpu-docker-google-compute-engine-4a146f085f17](https://medium.com/google-cloud/jupyter-tensorflow-nvidia-gpu-docker-google-compute-engine-4a146f085f17)'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Jupyter + TensorFlow + Nvidia GPU + Docker + GCE**：[https://medium.com/google-cloud/jupyter-tensorflow-nvidia-gpu-docker-google-compute-engine-4a146f085f17](https://medium.com/google-cloud/jupyter-tensorflow-nvidia-gpu-docker-google-compute-engine-4a146f085f17)'
- en: '**Using a GPU and TensorFlow on GCP**: [https://medium.com/google-cloud/using-a-gpu-tensorflow-on-google-cloud-platform-1a2458f42b0](https://medium.com/google-cloud/using-a-gpu-tensorflow-on-google-cloud-platform-1a2458f42b0)'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在GCP上使用GPU和TensorFlow**：[https://medium.com/google-cloud/using-a-gpu-tensorflow-on-google-cloud-platform-1a2458f42b0](https://medium.com/google-cloud/using-a-gpu-tensorflow-on-google-cloud-platform-1a2458f42b0)'
- en: '**Running Jupyter Notebooks on GPU on Google Cloud**: [https://medium.com/google-cloud/running-jupyter-notebooks-on-gpu-on-google-cloud-d44f57d22dbd](https://medium.com/google-cloud/running-jupyter-notebooks-on-gpu-on-google-cloud-d44f57d22dbd)'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在Google Cloud上运行GPU上的Jupyter Notebook**：[https://medium.com/google-cloud/running-jupyter-notebooks-on-gpu-on-google-cloud-d44f57d22dbd](https://medium.com/google-cloud/running-jupyter-notebooks-on-gpu-on-google-cloud-d44f57d22dbd)'
- en: 'Some docker-related resources:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 一些与Docker相关的资源：
- en: '**Docker config to create machines on GCE**: [https://docs.docker.com/machine/drivers/gce/](https://docs.docker.com/machine/drivers/gce/)'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在GCE上创建机器的Docker配置**：[https://docs.docker.com/machine/drivers/gce/](https://docs.docker.com/machine/drivers/gce/)'
- en: '**Logging with stackcriver**: [https://medium.com/google-cloud/how-to-log-your-application-on-google-compute-engine-6600d81e70e3](https://medium.com/google-cloud/how-to-log-your-application-on-google-compute-engine-6600d81e70e3)'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用 stackdriver 进行日志记录**：[https://medium.com/google-cloud/how-to-log-your-application-on-google-compute-engine-6600d81e70e3](https://medium.com/google-cloud/how-to-log-your-application-on-google-compute-engine-6600d81e70e3)'
- en: Summary
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: The GCE is a GCP core service, offering a wide variety of scalable VMs based
    on different OSes. The multiplicity of available OSes, the range of machines with
    CPUs, GPUs, small to huge disk space, and RAM make the GCE a powerful Cloud environment
    adapted to a wide variety of projects and contexts.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: GCE 是 GCP 的核心服务，提供基于不同操作系统的各种可扩展虚拟机。可用的操作系统种类繁多，机器的 CPU、GPU 范围，从小到巨大的磁盘空间和 RAM，使
    GCE 成为一个强大的云环境，适用于各种项目和场景。
- en: 'In this chapter you learned:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了：
- en: How to create, launch, back up, modify, and access multiple VMs
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何创建、启动、备份、修改和访问多个虚拟机 (VM)
- en: The different parameters and variables related to a VM
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与虚拟机 (VM) 相关的不同参数和变量
- en: How to access and use the Google Shell
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何访问和使用 Google Shell
- en: How to use the `gcloud` CLI to carry out the same operations in the GCP
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何使用 `gcloud` CLI 在 GCP 中执行相同的操作
- en: How to install a data science Python stack
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何安装数据科学 Python 栈
- en: How to launch a Jupyter Notebook
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何启动 Jupyter Notebook
- en: There are many more possibilities offered by the power and flexibility of the
    GCE that we haven't covered. Hopefully, by the end of this chapter, you should
    feel comfortable working with instances that are appropriate for your projects
    in a data-focused context.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: GCE 提供了更多由其强大和灵活的特性能带来的可能性，我们尚未涉及。希望到本章结束时，你应该能够在一个以数据为中心的背景下，舒适地使用适合你项目的实例。
- en: In the next chapter, we will learn how to store data on the GCP with Google
    Storage and Google SQL.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何使用 Google Storage 和 Google SQL 在 GCP 上存储数据。
