<html><head></head><body>
		<div id="_idContainer067">
			<h1 id="_idParaDest-42" class="chapter-number"><a id="_idTextAnchor042"/>3</h1>
			<h1 id="_idParaDest-43"><a id="_idTextAnchor043"/>Applying Machine Learning in Your Data Warehouse</h1>
			<p><strong class="bold"><a id="_idTextAnchor044"/>Machine Learning</strong> (<strong class="bold">ML</strong>) is a <a id="_idIndexMarker110"/>routine and necessary part of organizations in today’s modern business world. The origins of ML date back to the 1940s when logician Walter Pitts and neuroscientist Warren McCulloch tried to create a neural network that could map out human <span class="No-Break">thought processes.</span></p>
			<p>Organizations can use their data along with ML algorithms to build a mathematical model to make faster, better-informed decisions, and the value of data to organizations today cannot be understated. Data volumes will continue to grow rapidly and organizations that can most effectively manage their data for predictive analytics and identify trends will have a competitive advantage, lower costs, and increased revenue. But to truly unlock this capability, you must bring ML closer to the data, provide self-service tools that do not require a deep data science background and eliminate unnecessary data movement in order to speed up the time it takes to operationalize ML models into <span class="No-Break">your pipelines.</span></p>
			<p>This chapter will introduce you to ML and discuss common use cases to apply ML in your data warehouse. You will begin to see the <em class="italic">art of the possible</em> and imagine how you can achieve business outcomes faster and more easily through the use of Amazon Redshift ML. We will guide you through the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Understanding the basics of <span class="No-Break">ML algorithms</span></li>
				<li>Traditional steps to <span class="No-Break">implement ML</span></li>
				<li>Overcoming the challenges of <span class="No-Break">implementing ML</span></li>
				<li>Exploring the benefits <span class="No-Break">of ML</span></li>
			</ul>
			<h1 id="_idParaDest-44"><a id="_idTextAnchor045"/>Understanding the basics of ML</h1>
			<p>In <a id="_idIndexMarker111"/>this section, we will go into more detail about machine learning so that you have a general understanding of the <span class="No-Break">following areas:</span></p>
			<ul>
				<li>Supervised versus <span class="No-Break">unsupervised learning</span></li>
				<li><span class="No-Break">Classification problems</span></li>
				<li><span class="No-Break">Regression problems</span></li>
			</ul>
			<p>Let’s start by looking at supervised and <span class="No-Break">unsupervised learning.</span></p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor046"/>Comparing supervised and unsupervised learning</h2>
			<p>A <strong class="bold">supervised learning algorithm</strong> is <em class="italic">supervised</em> by data that contains the known outcome <a id="_idIndexMarker112"/>you want to predict. The ML model learns from this known outcome in the data<a id="_idIndexMarker113"/> and then uses that learning to predict the outcome of <span class="No-Break">new data.</span></p>
			<p>This known outcome in the data is also referred to as the label or target. For example, if you have a dataset containing home sales information, the sales price would typically be <span class="No-Break">the </span><span class="No-Break"><em class="italic">target</em></span><span class="No-Break">.</span></p>
			<p>Supervised learning can be further<a id="_idIndexMarker114"/> broken down <a id="_idIndexMarker115"/>into <strong class="bold">classification</strong> or <span class="No-Break"><strong class="bold">regression</strong></span><span class="No-Break"> problems.</span></p>
			<p>With <strong class="bold">unsupervised learning</strong> the ML model must learn from the data outcome by grouping data based on <a id="_idIndexMarker116"/>similarities, differences, and other patterns without any<a id="_idIndexMarker117"/> guidance or <span class="No-Break">known outcome.</span></p>
			<p>You can use unsupervised algorithms to find patterns in the data. For example, you can use unsupervised learning to perform customer segmentation to be more effective in targeting groups of customers. Other use cases include <span class="No-Break">the following:</span></p>
			<ul>
				<li>Detecting abnormal <span class="No-Break">sensor readings</span></li>
				<li><span class="No-Break">Document tagging</span></li>
			</ul>
			<p>With the rich data that data warehouses contain, you can easily get started training models using both supervised and <span class="No-Break">unsupervised learning.</span></p>
			<p>Let’s dig into more details on classification and regression <span class="No-Break">problem types.</span></p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor047"/>Classification</h2>
			<p>Classification <a id="_idIndexMarker118"/>problems are tasks to <a id="_idIndexMarker119"/>predict class labels, which can be either binary classification or <span class="No-Break">multi-class classification:</span></p>
			<ul>
				<li><strong class="bold">Binary classification</strong> – The outcome can be in one of two possible classes, for example, to predict whether <a id="_idIndexMarker120"/>a customer will churn, whether an<a id="_idIndexMarker121"/> email is spam, or whether a patient is likely to be hospitalized after being infected <span class="No-Break">by COVID-19.</span></li>
				<li><strong class="bold">Multi-class classification</strong> – The <a id="_idIndexMarker122"/>outcome can be in one of three or more possible classes – for example, predict a plant species or which <a id="_idIndexMarker123"/>category a news article belongs to. Other mutli-class classification use cases include <span class="No-Break">the following:</span><ul><li><span class="No-Break">Sales</span><span class="No-Break"><a id="_idIndexMarker124"/></span><span class="No-Break"> forecasting</span></li><li>Intelligent <span class="No-Break">call routing</span></li><li><span class="No-Break">Advertisement optimization</span></li></ul></li>
			</ul>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor048"/>Regression</h2>
			<p>Regression <a id="_idIndexMarker125"/>problems are <a id="_idIndexMarker126"/>used when you have a target of continuous values and want to predict a value based on the <span class="No-Break">input variables.</span></p>
			<p>Regression problems are tasks predicting a continuous <span class="No-Break">numeric value:</span></p>
			<ul>
				<li><strong class="bold">Linear regression</strong>: With linear regression, we predict a numerical outcome such as how much a customer<a id="_idIndexMarker127"/> will spend or the predicted revenue for an <a id="_idIndexMarker128"/>upcoming concert or sporting event. See <a href="B19071_07.xhtml#_idTextAnchor111"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>, <em class="italic">Building Regression Models</em>, for <span class="No-Break">more details.</span></li>
				<li><strong class="bold">Logistic regression</strong>: Logistic regression<a id="_idIndexMarker129"/> is another option to <a id="_idIndexMarker130"/>solve a binary classification problem. We will show some examples of this technique in <a href="B19071_06.xhtml#_idTextAnchor083"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Building </em><span class="No-Break"><em class="italic">Classification Models</em></span><span class="No-Break">.</span></li>
			</ul>
			<p>Regression use case examples<a id="_idIndexMarker131"/> include <span class="No-Break">the following:</span></p>
			<ul>
				<li>Price and <span class="No-Break">revenue prediction</span></li>
				<li>Customer lifetime <span class="No-Break">value prediction</span></li>
				<li>Detecting<a id="_idIndexMarker132"/> whether a customer is going to default<a id="_idIndexMarker133"/> on <span class="No-Break">a loan</span></li>
			</ul>
			<p>Now we will cover the steps to <span class="No-Break">implement ML.</span></p>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor049"/>Traditional steps to implement ML</h1>
			<p>In this section, you will get a better understanding of the critical steps needed to produce an optimal <span class="No-Break">ML model:</span></p>
			<ul>
				<li><span class="No-Break">Data preparation</span></li>
				<li>Machine learning <span class="No-Break">model evaluation</span></li>
			</ul>
			<h2 id="_idParaDest-49"><a id="_idTextAnchor050"/>Data preparation</h2>
			<p>A typical step in <a id="_idIndexMarker134"/>ML is to convert the raw data for input to train your model so that data scientists and data analysts can<a id="_idIndexMarker135"/> apply machine learning algorithms <a id="_idIndexMarker136"/>to the data. You may also hear the terms <strong class="bold">data wrangling</strong> or <span class="No-Break"><strong class="bold">feature engineering</strong></span><span class="No-Break">.</span></p>
			<p>This step is necessary since machine learning algorithms require inputs to be numbered. For example, you may need outliers or anomalies removed from your data. Also, you may need to fill in missing data values such as missing records for holidays. This helps to increase the accuracy of <span class="No-Break">your model.</span></p>
			<p>Additionally, it is important to ensure your training datasets are unbiased. Machine learning models learn from data and it is important that your training dataset has sufficient representation of <span class="No-Break">demographic groups.</span></p>
			<p>Here are some examples of<a id="_idIndexMarker137"/> data <span class="No-Break">preparation steps:</span></p>
			<ul>
				<li><strong class="bold">Determining the inputs needed for your model</strong> – This is the process of identifying the attributes that most influence the ML <span class="No-Break">model outcome.</span></li>
				<li><strong class="bold">Cleaning the data</strong> – Correcting data quality errors, eliminating duplicate rows and anomalous data. You need to investigate the data and look for unusual values – this requires knowledge of the domain and how business logic <span class="No-Break">is applied.</span></li>
				<li><strong class="bold">Transforming the input features</strong> – Machine models require inputs to be numeric. For example, you will use a technique called one-hot encoding when you have data that is not ordinal – such as country or gender data. This will convert the categorical value into a binary value, which creates better classifiers and therefore better models. But as you will see later, when you use the Auto ML feature of Redshift ML, this will have been taken care of <span class="No-Break">for you.</span></li>
				<li><strong class="bold">Splitting your data into training, validation, and </strong><span class="No-Break"><strong class="bold">testing datasets:</strong></span><ul><li><strong class="bold">Training dataset</strong> – This is a<a id="_idIndexMarker138"/> subset of your data that is used to train your model. As a rule of thumb, this is about 80% of your <span class="No-Break">overall dataset.</span></li><li><strong class="bold">Validation dataset</strong> – Optionally, you<a id="_idIndexMarker139"/> may want to create a validation dataset. This is a ~10% subset of data that is used to evaluate the model during the process of hyperparameter tuning. Examples of hyperparameters include the number of classes (<strong class="source-inline">num_class</strong>) for multi-class classification and the number of rounds (<strong class="source-inline">num_rounds</strong>) in an XGBoost model. Note that Amazon Redshift ML automatically tunes <span class="No-Break">your model.</span></li><li><strong class="bold">Testing dataset</strong> – This is the <a id="_idIndexMarker140"/>remaining 10% of your data used to evaluate the model performance after training and tuning <span class="No-Break">the model.</span></li></ul></li>
			</ul>
			<p>Traditionally, data preparation<a id="_idIndexMarker141"/> is a very time-consuming step and one of the reasons machine learning can be complex. As you will see later, Amazon Redshift ML automates many of the data preparation steps so you can focus on creating <span class="No-Break">your models.</span></p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor051"/>Evaluating an ML model</h2>
			<p>After you have created <a id="_idIndexMarker142"/>your model, you need to calculate the model’s accuracy. When using Amazon Redshift ML, you will get a metric to quantify <span class="No-Break">model accuracy.</span></p>
			<p>Here are some common methods used to determine <span class="No-Break">model accuracy:</span></p>
			<ul>
				<li><strong class="bold">Mean squared error</strong> (<strong class="bold">MSE</strong>): MSE is the average of the squared differences between the predicted and actual <a id="_idIndexMarker143"/>values. It is used to measure the effectiveness of regression models. MSE values are always positive: the better a model is at predicting the actual values, the smaller the MSE value is. When the data contains outliers, they tend to dominate the MSE, which might cause subpar <span class="No-Break">prediction performance.</span></li>
				<li><strong class="bold">Accuracy</strong>: The ratio <a id="_idIndexMarker144"/>of the number of correctly classified items to the total number of (correctly and incorrectly) classified items. It is used for binary and multi-class classification. It measures how close the predicted class values are to the actual values. Accuracy values vary between zero and one: one indicates perfect accuracy and zero indicates <span class="No-Break">perfect inaccuracy.</span></li>
				<li><strong class="bold">F1 score</strong>: The F1 score<a id="_idIndexMarker145"/> is the harmonic mean of the precision and recall. It is used for binary classification into classes traditionally referred to as positive and negative. Predictions are said to be true when they match their actual (correct) class and false when they do not. Precision is the ratio of the true positive predictions to all positive predictions (including the false positives) in a dataset and measures the quality of the prediction when it predicts the <span class="No-Break">positive class.</span></li>
				<li><strong class="bold">F1_Macro</strong> – The F1 macro<a id="_idIndexMarker146"/> score applies F1 scoring to multi-class classification. In this context, you have multiple classes to predict. You just calculate the precision and recall for each class, as you did for the positive class in binary classification. F1 macro scores vary between zero and one: one indicates the best possible performance and zero <span class="No-Break">the worst.</span></li>
				<li><strong class="bold">Area under the curve</strong> (<strong class="bold">AUC</strong>): The AUC<a id="_idIndexMarker147"/> metric is used to compare and evaluate binary classification by algorithms such as logistic regression that return probabilities. A threshold is needed to map the probabilities into classifications. The relevant curve is the receiver operating characteristic curve that plots<a id="_idIndexMarker148"/> the <strong class="bold">true positive rate</strong> (<strong class="bold">TPR</strong>) of predictions (or recall) against the <strong class="bold">false positive rate</strong> (<strong class="bold">FPR</strong>) as a function of the threshold value, above which <a id="_idIndexMarker149"/>a prediction is <a id="_idIndexMarker150"/><span class="No-Break">considered positive.</span></li>
			</ul>
			<p>Now let’s take a look at a couple of these evaluation techniques in <span class="No-Break">more detail.</span></p>
			<h3>Regression model evaluation example</h3>
			<p>A regression model’s accuracy is measured <a id="_idIndexMarker151"/>by the <strong class="bold">Mean Square Error</strong> (<strong class="bold">MSE</strong>) and <strong class="bold">Root Mean Square Error</strong> (<strong class="bold">RMSE</strong>). The MSE is the average squared difference between the <a id="_idIndexMarker152"/>predicted values and the actual values in a model’s dataset and is also known as <em class="italic">ground truth</em>. You can square the differences<a id="_idIndexMarker153"/> between the actual and predicted <a id="_idIndexMarker154"/>answers and then get the average to calculate the MSE. The square root of the MSE computes the RMSE. Low MSE and RMSE scores indicate a <span class="No-Break">good model.</span></p>
			<p>Here is an example of a simple way to calculate the MSE and RMSE so that you can compare them to the MSE score your model generated. Let’s assume we have a regression model predicting the number of hotel bookings by a customer for the next month. </p>
			<p>Calculate the MSE and RMSE <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
MSE = (AVG(POWER(( actual_bookings - predicted_bookings)
RMSE = (SQRT(AVG(POWER(( actual_bookings  - predicted_bookings</pre>
			<p>You will calculate the MSE and RMSE for a regression model in one of the exercises in <a href="B19071_07.xhtml#_idTextAnchor111"><span class="No-Break"><em class="italic">Chapter 7</em></span></a><span class="No-Break">.</span></p>
			<p>A <a id="_idIndexMarker155"/>classification model can be evaluated based on accuracy. The accuracy method is fairly straightforward, where it can be measured by taking the percentage of the total number of predictions compared to the total number of <span class="No-Break">correct predictions.</span></p>
			<h3>Binary classification evaluation example</h3>
			<p>A confusion matrix<a id="_idIndexMarker156"/> is useful for understanding the performance of classification models and is a<a id="_idIndexMarker157"/> recommended way to evaluate a classification model. We present the following details for your reference if you want to know more about this topic. We also have a detailed example in <a href="B19071_10.xhtml#_idTextAnchor178"><span class="No-Break"><em class="italic">Chapter 10</em></span></a><span class="No-Break">.</span></p>
			<p>A<a id="_idIndexMarker158"/> confusion<a id="_idIndexMarker159"/> matrix is in a tabular format and contains four cells – <strong class="bold">Actual Values</strong> make up the <em class="italic">x</em> axis and <strong class="bold">Predicted Values</strong> make up the <em class="italic">y</em> axis, and the cells denote <strong class="bold">True Positive</strong>, <strong class="bold">False Positive</strong>, <strong class="bold">False Negative</strong>, and <strong class="bold">True Negative</strong>. This<a id="_idIndexMarker160"/> is good<a id="_idIndexMarker161"/> to measure precision, recall, and<a id="_idIndexMarker162"/> the <strong class="bold">area under the curve</strong> (<strong class="bold">AUC</strong>). <span class="No-Break"><em class="italic">Figure 3</em></span><em class="italic">.1</em> shows a simple <span class="No-Break">confusion matrix:</span></p>
			<table id="table001-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Actual Values</strong></span></p>
						</td>
						<td class="No-Table-Style"/>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">True Positive</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">False Positive</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Predicted Values</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">False Negative</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">True Negative</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.1 – Simple confusion matrix</p>
			<p>In <span class="No-Break"><em class="italic">Figure 3</em></span><em class="italic">.2</em>, we have 100 records in our dataset for our binary classification model where we are trying to predict <span class="No-Break">customer churn:</span></p>
			<table id="table002" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Actual Values</span></p>
						</td>
						<td class="No-Table-Style"/>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">10</span></p>
						</td>
						<td class="No-Table-Style">
							<p>4</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Predicted Values</span></p>
						</td>
						<td class="No-Table-Style">
							<p>6</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">80</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.2 – Confusion matrix</p>
			<p>We can interpret the quality of our predictions from the model <span class="No-Break">as follows:</span></p>
			<ul>
				<li>Correctly predicted 10 customers <span class="No-Break">would churn</span></li>
				<li>Correctly predicted 80 customers would <span class="No-Break">not churn</span></li>
				<li>Incorrectly predicted 4 customers <span class="No-Break">would churn</span></li>
				<li>Incorrectly predicted 6 customers would <span class="No-Break">not churn</span></li>
			</ul>
			<p>The F1 score<a id="_idIndexMarker163"/> is one of the <a id="_idIndexMarker164"/>most important evaluation metrics as it considers the precision and recall rate of the model. For example, an F1 score of <em class="italic">.92</em> means that the model correctly predicted 92% of the time. This method makes sure predictions on both classes are good and <em class="italic">not</em> biased only toward <span class="No-Break">one class.</span></p>
			<p>Using our<a id="_idIndexMarker165"/> confusion matrix example from <span class="No-Break"><em class="italic">Figure 3</em></span><em class="italic">.2</em>, we can <span class="No-Break">calculate precision:</span></p>
			<p><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">10</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">10</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Number"> </span></p>
			<p>This could also be written <span class="No-Break">as follows:</span></p>
			<p><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">u</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">  </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">______________________</span><span class="_-----MathTools-_Math_Base">   </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">u</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">F</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Base"> </span></p>
			<p>We can also calculate recall in a <span class="No-Break">similar way:</span></p>
			<p><span class="_-----MathTools-_Math_Variable">R</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">10</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">10</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Number"> </span></p>
			<p>This could also be written <span class="No-Break">as follows:</span></p>
			<p><span class="_-----MathTools-_Math_Variable">R</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">u</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">  </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">______________________</span><span class="_-----MathTools-_Math_Base">   </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">u</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">F</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Base"> </span></p>
			<p>The F1 score<a id="_idIndexMarker166"/> combines precision and <a id="_idIndexMarker167"/>recall – it can be calculated <span class="No-Break">as follows:</span></p>
			<p><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">×</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">×</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">  </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">___________</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">c</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">r</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">e</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">c</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">a</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">l</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">l</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">)</span></span></p>
			<p>We have shown you the common techniques for evaluating ML models. As we progress through the book, you will see examples of these techniques that you can apply to your ML <span class="No-Break">evaluation processes.</span></p>
			<p>Now that you have learned the basics of ML, we will discuss some common challenges of implementing ML and how to <span class="No-Break">overcome those.</span></p>
			<h1 id="_idParaDest-51"><a id="_idTextAnchor052"/>Overcoming the challenges of implementing ML today</h1>
			<p>Data growth is <a id="_idIndexMarker168"/>both an opportunity and a challenge, and organizations are looking to extract more value from their data. Line-of-business users, data analysts, and developers are being called upon to use this data to deliver business outcomes. These users need easy-to-use tools and don’t typically have the skill set of a typical data scientist nor the luxury of time to learn these skills plus being experts in data management. Central IT departments are overwhelmed with analytics and data requirements and are looking for solutions to enable users with self-service tools delivered on top of powerful systems that are easy to use. Following are some of the <span class="No-Break">main challenges:</span></p>
			<ul>
				<li>Data is more diverse and growing rapidly. We have moved from analyzing terabytes to petabytes and exabytes of data. This data typically is spread across many different data stores across organizations. This means data has to be exported and then landed on another platform to train ML models. Amazon Redshift ML gives you the ability to train models using the data in place without having to move <span class="No-Break">it around.</span></li>
				<li>A lack of expertise in data management impacts the ability to effectively scale to keep up with volumes of data and an increase <span class="No-Break">in usage.</span></li>
				<li>A lack of agility to react quickly to events and customer escalations due to data silos and the time required to train a model and make it available for use in <span class="No-Break">making predictions.</span></li>
				<li>A lack of qualified data scientists to meet today’s demands for machine learning. Demands are driven by the need to improve customer experiences, predict future <a id="_idIndexMarker169"/>revenues, detect fraud, and provide better patient care, just to name <span class="No-Break">a few.</span></li>
			</ul>
			<p>Consider the following workflow for creating an <span class="No-Break">ML model:</span></p>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="image/B19071_03_03.jpg" alt="Figure 3.3 – Typical machine learning workflow"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.3 – Typical machine learning workflow</p>
			<p>Following <a id="_idIndexMarker170"/>are the steps to create an ML model, as shown in <span class="No-Break"><em class="italic">Figure 3</em></span><span class="No-Break"><em class="italic">.3</em></span><span class="No-Break">:</span></p>
			<ol>
				<li>First, we start off with data preparation. This can be a very time-consuming process and data may come from many different sources. This data must be cleansed, wrangled, and split into training and test datasets. It then needs to be exported and then loaded into the environment <span class="No-Break">for training.</span></li>
				<li>Then you must know which ML algorithm you should use or you need to train your model on. This requires a data scientist who is skilled in tools such as R or Python and has experience in knowing which algorithm is best for a particular problem. As you will see in a later chapter, Amazon Redshift ML can automatically determine the algorithm <span class="No-Break">for you.</span></li>
				<li>Then you will iterate many times through training, tuning, and validating the model until you find the best model for your <span class="No-Break">use case.</span></li>
				<li>Then, after you deploy the model, you need to continuously monitor the quality of the model and manage the environment including scaling hardware and applying patches and upgrades <span class="No-Break">as needed.</span></li>
			</ol>
			<p>In order to reduce the time required to build data pipelines for machine learning, we must bring machine learning closer to the data and reduce unnecessary data movement. You can use a data architecture, as we talked about in <a href="B19071_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic">Chapter 1</em></span></a>, <em class="italic">Introduction to Redshift Serverless</em>, with the data warehouse at the center. This also includes your data lake and other operational data stores, which, taken together, provide a unified view of all your data that is organized and easily available in a <span class="No-Break">secure manner.</span></p>
			<p>You can build upon the analytic stack that you have built out and enable your data analysts to build and train their own models. All data warehouse users can leverage the power of ML with no data science experience. DW users can create, train, and deploy ML models with familiar SQL commands. Then, using SQL, they can use those models to analyze the data accessible from Amazon Redshift. You can also leverage your existing models in <a id="_idIndexMarker171"/>Amazon SageMaker and run inferences on data stores in Amazon Redshift. Data scientists can leverage Redshift ML to iterate faster by baselining models directly through Redshift. BI professionals can now run inference queries directly through tools such as <span class="No-Break">Amazon QuickSight.</span></p>
			<p>Once you implement ML in your organization, you will begin to reap many benefits, which we will explore further in the <span class="No-Break">next section.</span></p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor053"/>Exploring the benefits of ML</h1>
			<p>There are three main areas where businesses can see the benefits <span class="No-Break">of ML:</span></p>
			<ul>
				<li><strong class="bold">Increased revenue</strong> – With ML, you <a id="_idIndexMarker172"/>can leverage your data to quickly test new ideas in order to improve customer experiences. For example, using unsupervised learning, you can segment your customers and discover previously unknown purchase patterns, which can drive new focused campaigns for specific product or <span class="No-Break">subscription offerings.</span></li>
				<li><strong class="bold">Better operational and financial efficiency</strong> – ML increases automation and agility within your business so that you can respond to changing market conditions faster. One example is forecasting product demand more accurately. By being able to better manage inventory, organizations can see huge <span class="No-Break">cost savings.</span></li>
				<li><strong class="bold">Increased agility to respond to business risks</strong> – With ML, you can make decisions quicker than ever before. Using ML to detect anomalies, you can quickly take action when your supply chain, product quality, and other areas of your business<a id="_idIndexMarker173"/> <span class="No-Break">face risks.</span></li>
			</ul>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor054"/>Application of ML in a data warehouse</h2>
			<p>Let’s <a id="_idIndexMarker174"/>look at a few use cases at a high level to illustrate some of these benefits. Subsequent chapters will dive into <span class="No-Break">the details:</span></p>
			<ul>
				<li><strong class="bold">Improving customer experience</strong>: ML can be used to reduce customer frustration with long wait times. Chatbots can answer many customer questions quickly, and in some cases, all of <span class="No-Break">their questions:</span><ul><li><strong class="bold">Personalization</strong>: ML can be used to better understand the behaviors and purchase history of customers to make more relevant offerings to customers based on <span class="No-Break">their interests.</span></li><li><strong class="bold">Sentiment analysis</strong>: ML can be used to understand customer sentiment from social media platforms. This analysis can then be used for marketing campaigns and customer <span class="No-Break">retention efforts.</span></li></ul></li>
				<li><strong class="bold">Predicting equipment maintenance</strong>: Consider any company with a fleet of vehicles or equipment. This could be a package delivery company or a service provider company that must be maintained appropriately. Without ML, it is likely that either equipment will be repaired too soon or too frequently, which leads to higher costs, or equipment will be repaired too late, which leads to equipment being out <span class="No-Break">of service.</span></li>
			</ul>
			<p>You can use<a id="_idIndexMarker175"/> ML to predict the optimal time when each vehicle or piece of equipment needs to have maintenance to maximize <span class="No-Break">operational efficiency.</span></p>
			<ul>
				<li><strong class="bold">Financial analysis</strong>: Banks and investment companies use ML for automation, risk analysis, portfolio allocation, and <span class="No-Break">much more:</span><ul><li><strong class="bold">Calculating credit scores</strong> – ML can quickly calculate credit scores and approve loans, which <span class="No-Break">reduces risk.</span></li><li><strong class="bold">Fraud detection</strong> – ML can quickly scan large datasets to detect anomalies and flag transactions and automatically decline or approve a transaction. Depending on the nature of a transaction, the system can automatically decline a withdrawal or purchase until a human makes <span class="No-Break">a decision.</span></li></ul></li>
				<li><strong class="bold">Sports industry</strong>: Auto racing teams can use a model to predict the best strategies for success and the most effective <span class="No-Break">pit strategy:</span><ul><li>Build stronger team rosters by predicting <span class="No-Break">future performance</span></li><li>Improve player safety by predicting <span class="No-Break">future injuries</span></li></ul></li>
				<li><strong class="bold">Health care industry</strong>: Early detection of health conditions by combining ML with historical patient and treatment history and predicting the treatments with the highest probability <a id="_idIndexMarker176"/><span class="No-Break">of success.</span></li>
			</ul>
			<p>These are just some of the benefits of ML. The possibilities are endless and advances are continually being made. As we go through subsequent chapters, you’ll see some use cases in action that you can try out on your own and start building up your ML <span class="No-Break">skill set.</span></p>
			<h1 id="_idParaDest-54"><a id="_idTextAnchor055"/>Summary</h1>
			<p>In this chapter, we walked you through how to apply machine learning to a data warehouse and explained the basics of ML. We also discussed how to overcome the challenges of implementing ML so that you can reap the benefits of ML in <span class="No-Break">your organization.</span></p>
			<p>These benefits contribute to increased revenue, better operational efficiencies, and better responses to changing business conditions. After this chapter, you now have a foundational understanding of the use cases and types of models you can deploy in your <span class="No-Break">data warehouse.</span></p>
			<p>In the next chapter, we will introduce you to Amazon Redshift ML and how you can start achieving <span class="No-Break">business outcomes.</span></p>
		</div>
	

		<div id="_idContainer068" class="Content">
			<h1 id="_idParaDest-55" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor056"/>Part 2:<span xml:lang="en-GB">Getting Started with Redshift ML</span></h1>
			<p><em class="italic">Part 2</em> begins with an overview of Amazon Redshift ML, then dives into how to create various machine learning models using Amazon <span class="No-Break">Redshift ML.</span></p>
			<p>By the end of <em class="italic">Part 2</em>, you will have an understanding of how to create a model by simply running a SQL command, the difference between supervised and unsupervised learning, and how to solve classification, regression, and <span class="No-Break">clustering problems.</span></p>
			<p>This part comprises the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B19071_04.xhtml#_idTextAnchor057"><em class="italic">Chapter 4</em></a>, <em class="italic">Leveraging Amazon Redshift Machine Learning</em></li>
				<li><a href="B19071_05.xhtml#_idTextAnchor068"><em class="italic">Chapter 5</em></a>, <em class="italic">Building Your First Machine Learning Model</em></li>
				<li><a href="B19071_06.xhtml#_idTextAnchor083"><em class="italic">Chapter 6</em></a>, <em class="italic">Building Classification Models</em></li>
				<li><a href="B19071_07.xhtml#_idTextAnchor111"><em class="italic">Chapter 7</em></a>, <em class="italic">Building Regression Models</em></li>
				<li><a href="B19071_08.xhtml#_idTextAnchor139"><em class="italic">Chapter 8</em></a>, <em class="italic">Building Unsupervised Models with K-Means Clustering</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer069">
			</div>
		</div>
		<div>
			<div id="_idContainer070">
			</div>
		</div>
		<div>
			<div id="_idContainer071">
			</div>
		</div>
		<div>
			<div id="_idContainer072">
			</div>
		</div>
		<div>
			<div id="_idContainer073">
			</div>
		</div>
		<div>
			<div id="_idContainer074" class="Basic-Graphics-Frame">
			</div>
		</div>
		<div>
			<div id="_idContainer075">
			</div>
		</div>
		<div>
			<div id="_idContainer076">
			</div>
		</div>
	</body></html>