["```py\n    SELECT COUNT(*)\n    FROM\n      `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE\n      tripduration is NULL\n      OR tripduration<=0;\n    ```", "```py\n    SELECT  MIN (tripduration)/60 minimum_duration_in_minutes,\n            MAX (tripduration)/60  maximum_duration_in_minutes\n    FROM\n      `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE\n      tripduration is not NULL\n      AND tripduration>0;\n    ```", "```py\n    SELECT  COUNT(*)\n    FROM\n      `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE\n      (tripduration is not NULL\n      AND tripduration>0) AND (\n      starttime is NULL\n      OR start_station_name is NULL\n      OR end_station_name is NULL\n      OR start_station_latitude is NULL\n      OR start_station_longitude is NULL\n      OR end_station_latitude is NULL\n      OR end_station_longitude is NULL);\n    ```", "```py\n    SELECT  COUNT(*)\n    FROM\n      `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE\n      (tripduration is not NULL\n      AND tripduration>0)\n      AND ( birth_year is NULL);\n    ```", "```py\n    SELECT\n      EXTRACT (YEAR FROM starttime) year,\n      EXTRACT (MONTH FROM starttime) month,\n      count(*) total\n    FROM\n      `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE \n      EXTRACT (YEAR FROM starttime)=2017 OR\n      EXTRACT (YEAR FROM starttime)=2018\n      AND (tripduration>=3*60 AND tripduration<=3*60*60)\n      AND  birth_year is not NULL\n      AND birth_year < 2007\n    GROUP BY\n      year, month \n    ORDER BY\n      year, month asc;\n    ```", "```py\n    CREATE OR REPLACE TABLE `04_nyc_bike_sharing.training_table` AS\n      SELECT \n        tripduration/60 tripduration,\n                            starttime,\n                            stoptime,\n                            start_station_id,\n                            start_station_name, \n                            start_station_latitude,\n                            start_station_longitude, \n                            end_station_id,\n                            end_station_name, \n                            end_station_latitude,\n                            end_station_longitude, \n                            bikeid,\n                            usertype,\n                            birth_year, \n                            gender,\n                            customer_plan\n      FROM\n        `bigquery-public-data.new_york_citibike.citibike_trips`\n      WHERE \n        (\n           (EXTRACT (YEAR FROM starttime)=2017 AND\n             (EXTRACT (MONTH FROM starttime)>=04 OR\n               EXTRACT (MONTH FROM starttime)<=10))\n            OR (EXTRACT (YEAR FROM starttime)=2018 AND\n              (EXTRACT (MONTH FROM starttime)>=01 OR\n                EXTRACT (MONTH FROM starttime)<=02))\n        )\n        AND (tripduration>=3*60 AND tripduration<=3*60*60)\n        AND birth_year is not NULL\n        AND birth_year < 2007;\n    ```", "```py\n    CREATE OR REPLACE TABLE `04_nyc_bike_sharing.evaluation_table` AS\n    SELECT \n        tripduration/60 tripduration,\n                           starttime,\n                           stoptime,\n                           start_station_id,\n                           start_station_name, \n                           start_station_latitude,\n                           start_station_longitude, \n                           end_station_id,\n                           end_station_name, \n                           end_station_latitude,\n                           end_station_longitude, \n                           bikeid,\n                           usertype,\n                           birth_year, \n                           gender, \n                           customer_plan\n                  FROM\n        `bigquery-public-data.new_york_citibike.citibike_trips`\n                  WHERE \n        (EXTRACT (YEAR FROM starttime)=2018 AND \n          (EXTRACT (MONTH FROM starttime)=03 OR \n            EXTRACT (MONTH FROM starttime)=04))\n        AND (tripduration>=3*60 AND tripduration<=3*60*60)\n        AND  birth_year is not NULL\n        AND birth_year < 2007;\n    ```", "```py\n    CREATE OR REPLACE TABLE `04_nyc_bike_sharing.prediction_table` AS\n    SELECT \n        tripduration/60 tripduration,\n                        starttime,\n                        stoptime,\n                        start_station_id,\n                        start_station_name, \n                        start_station_latitude,\n                        start_station_longitude, \n                        end_station_id,\n                        end_station_name, \n                        end_station_latitude,\n                        end_station_longitude, bikeid,\n                        usertype, birth_year, gender, \n                        customer_plan\n    FROM\n        `bigquery-public-data.new_york_citibike.citibike_trips`\n    WHERE \n        EXTRACT (YEAR FROM starttime)=2018\n        AND EXTRACT (MONTH FROM starttime)=05\n        AND (tripduration>=3*60 AND tripduration<=3*60*60)\n        AND birth_year is not NULL\n        AND birth_year < 2007;\n    ```", "```py\n    CREATE OR REPLACE MODEL `04_nyc_bike_sharing.trip_duration_by_stations`\n    OPTIONS\n      (model_type='linear_reg') AS\n    SELECT\n      start_station_name,\n      end_station_name,\n      tripduration as label\n    FROM\n      `04_nyc_bike_sharing.training_table`;\n    ```", "```py\n    OPTIONS\n      (model_type='linear_reg'\n     input_label_cols=['tripduration'])\n    ```", "```py\n    CREATE OR REPLACE MODEL `04_nyc_bike_sharing.trip_duration_by_stations_and_day`\n    OPTIONS\n      (model_type='linear_reg') AS\n    SELECT\n      start_station_name,\n      end_station_name,\n        IF (EXTRACT(DAYOFWEEK FROM starttime)=1 OR\n              EXTRACT(DAYOFWEEK FROM starttime)=7, \n              true, false) is_weekend,\n      tripduration as label\n    FROM\n      `04_nyc_bike_sharing.training_table`;\n    ```", "```py\n    CREATE OR REPLACE MODEL \n      `04_nyc_bike_sharing.trip_duration_by_stations_day_age`\n    OPTIONS\n      (model_type='linear_reg') AS\n    SELECT\n      start_station_name,\n      end_station_name,\n      IF (EXTRACT(DAYOFWEEK FROM starttime)=1 OR\n            EXTRACT(DAYOFWEEK FROM starttime)=7, \n            true, false) is_weekend,\n      EXTRACT(YEAR FROM starttime)-birth_year as age,\n      tripduration as label\n    FROM\n      `04_nyc_bike_sharing.training_table`;\n    ```", "```py\nSELECT\n  *\nFROM\n  ML.EVALUATE(MODEL `04_nyc_bike_sharing.trip_duration_by_stations_and_day`,\n    (\n    SELECT\n          start_station_name,\n          end_station_name,\n          IF (EXTRACT(DAYOFWEEK FROM starttime)=1 OR \n                EXTRACT(DAYOFWEEK FROM starttime)=7, \n                true, false) is_weekend,\n          tripduration as label\n    FROM\n          `04_nyc_bike_sharing.evaluation_table`));\n```", "```py\nSELECT\n   tripduration as actual_duration,\n   predicted_label as predicted_duration,\n   ABS(tripduration - predicted_label) difference_in_min\nFROM\n  ML.PREDICT(MODEL `04_nyc_bike_sharing.trip_duration_by_stations_and_day`,\n    (\n    SELECT\n          start_station_name,\n          end_station_name,\n          IF (EXTRACT(DAYOFWEEK FROM starttime)=1 OR \n                EXTRACT(DAYOFWEEK FROM starttime)=7, \n                true, false) is_weekend,\n          tripduration\n    FROM\n          `04_nyc_bike_sharing.prediction_table`\n    ))\n    order by  difference_in_min asc;\n```", "```py\nSELECT COUNT (*)\nFROM (\nSELECT\n   tripduration as actual_duration,\n   predicted_label as predicted_duration,\n   ABS(tripduration - predicted_label) difference_in_min\nFROM\n  ML.PREDICT(MODEL `04_nyc_bike_sharing.trip_duration_by_stations_and_day`,\n    (\n    SELECT\n          start_station_name,\n          end_station_name,\n          IF (EXTRACT(DAYOFWEEK FROM starttime)=1 OR \n                EXTRACT(DAYOFWEEK FROM starttime)=7, \n                true, false) is_weekend,\n          tripduration\n    FROM\n          `04_nyc_bike_sharing.prediction_table`\n    ))\n    order by difference_in_min asc) where difference_in_min<=15;\n```"]