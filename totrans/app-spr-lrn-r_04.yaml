- en: '*Chapter 4:*'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第四章：*'
- en: Regression
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回归
- en: Learning Objectives
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 学习目标
- en: 'By the end of this chapter, you will be able to:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将能够：
- en: Formulate regression problems
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建回归问题
- en: Implement various types of regression approaches and its use cases
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现各种类型的回归方法及其用例
- en: Analyze and choose the right regression approach
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析和选择正确的回归方法
- en: Connect statistics and machine learning through the lens of regression
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过回归的视角连接统计学和机器学习
- en: Deep dive into model diagnostics
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深入探讨模型诊断
- en: In this chapter, we will focus on various type of regression and when to use
    which one along with demonstrations in R.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将关注各种类型的回归，以及何时使用哪种类型，同时结合R语言中的演示。
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简介
- en: In the previous chapter, we understood linear regression models and the linear
    relationship between an input variable (independent variable) and a target variable
    (dependent variable or explanatory variable). If one variable is used as an independent
    variable, it is defined as **simple linear regression**. If more than one explanatory
    (independent) variable is used, it's called **multiple linear regression**.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们了解了线性回归模型以及输入变量（自变量）和目标变量（因变量或解释变量）之间的线性关系。如果只使用一个变量作为自变量，则定义为**简单线性回归**。如果使用多个解释变量（自变量），则称为**多重线性回归**。
- en: Regression algorithms and problems are based on predicting a numeric target
    variable (often called **dependent**), given all the input variables (often called
    **independent** variables), for example, predicting a house price based on location,
    area, proximity to a shopping mall, and many other factors. Many of the concepts
    of regression are derived from statistics.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 回归算法和问题基于预测一个数值目标变量（通常称为**因变量**），给定所有输入变量（通常称为**自变量**），例如，根据位置、面积、靠近购物中心等因素预测房价。许多回归的概念都源自统计学。
- en: The entire field of machine learning is now a right balance of mathematics,
    statistics, and computer science. In this chapter, we will use regression techniques
    to understand how to establish a relationship between input(s) and the target
    variable. We will also emphasize on model diagnostics as regression is full of
    assumptions, which needs to be checked before a model can be used in the real
    world.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习的整个领域现在是一个数学、统计学和计算机科学的完美平衡。在本章中，我们将使用回归技术来了解如何建立输入和目标变量之间的关系。我们还将强调模型诊断，因为回归充满了假设，在模型应用于现实世界之前需要检查这些假设。
- en: '*Essentially, all models are wrong, but some are useful. – George Box*'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*本质上，所有模型都是错误的，但有些是有用的。 —— 乔治·博克斯*'
- en: We have briefly touched upon simple and multiple linear regression in *Chapter
    3*, *Introduction to Supervised Learning*. In this chapter, we will focus more
    on **model diagnostics** and other types of **regression algorithm**, and how
    it is different from linear regression.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在第三章“监督学习简介”中，我们简要介绍了简单和多重线性回归。在本章中，我们将更专注于**模型诊断**和其他类型的**回归算法**，以及它与线性回归的不同之处。
- en: Linear Regression
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 线性回归
- en: 'Let''s revisit the multiple linear regression from *Chapter 3*, *Introduction
    to Supervised Learning*. The following equation is the mathematical representation
    of a linear equation, or linear predictor function, with `p` explanatory variables
    and `n` observations:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾第三章“监督学习简介”中的多重线性回归。以下方程是具有`p`个解释变量和`n`个观测值的线性方程或线性预测函数的数学表示：
- en: '![](img/C12624_04_22.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](img/C12624_04_22.jpg)'
- en: Where each ![A picture containing furniture, table
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 其中每个![一张包含家具、桌子的图片
- en: Description automatically generated](img/C12624_04_23.png) is a vector of column
    values (**explanatory variable**) and ![A picture containing furniture
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/C12624_04_23.png)是一个列值的向量（**解释变量**）和![一张包含家具的图片
- en: Description automatically generated](img/C12624_04_24.png) is the **unknown
    parameters** or **coefficients**. ![A picture containing furniture, seat
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/C12624_04_24.png)是**未知参数**或**系数**。![一张包含家具、座椅的图片
- en: Description automatically generated](img/C12624_04_25.png), makes this equation
    suitable for simple linear regression. There are many algorithms to fit this function
    onto the data. The most popular one is **Ordinary Least Square** (**OLS**).
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/C12624_04_25.png)，使这个方程适用于简单线性回归。有许多算法可以将此函数拟合到数据上。最流行的一个是**普通最小二乘法**（**OLS**）。
- en: Before understanding the details of OLS, first let's interpret the equation
    we got while trying to fit the Beijing PM2.5 data from the model building section
    of simple and multiple linear regression from *Chapter 3*, *Introduction to Supervised
    Learning*.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在理解OLS的细节之前，首先让我们解释一下在尝试从第3章，*监督学习简介*中的简单和多元线性回归的模型构建部分拟合北京PM2.5数据时得到的方程：
- en: '![](img/C12624_04_26.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![img/C12624_04_26.jpg]'
- en: If we substitute the values of regression coefficients, ![A drawing of a face
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们代入回归系数的值，![一张人脸的插图
- en: 'Description automatically generated](img/C12624_04_27.png) and ![](img/C12624_04_28.png)
    from the output of the `lm()` function, we get:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/C12624_04_27.png)和![img/C12624_04_28.png]从`lm()`函数的输出中，我们得到：
- en: '![](img/C12624_04_29.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![img/C12624_04_29.jpg]'
- en: The preceding equation attempts to answer the question "Are the factors `DEWP`,
    `TEMP`, and `Iws` important for predicting the `pm2.5` level?"
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的方程试图回答“`DEWP`、`TEMP`和`Iws`这些因素对于预测`pm2.5`水平是否重要？”的问题。
- en: The model estimates how, on average, the `DEWP`, `TEMP`, and `Iws` values affect
    the `pm2.5` level. For example, a unit increase in `DEWP` will increase the `pm2.5`
    value by `4.384196`. That is why we often call these coefficients **weights**.
    It is important to note that if the **R-squared value** is low, these estimated
    coefficients are not reliable.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 该模型估计了平均而言，`DEWP`、`TEMP`和`Iws`值如何影响`pm2.5`水平。例如，`DEWP`增加一个单位，`pm2.5`值将增加`4.384196`。这就是我们通常将这些系数称为**权重**的原因。需要注意的是，如果**R-squared值**低，这些估计的系数是不可靠的。
- en: 'Exercise 50: Print the Coefficient and Residual Values Using the multiple_PM_25_linear_model
    Object'
  id: totrans-30
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习50：使用`multiple_PM_25_linear_model`对象打印系数和残差值
- en: In this exercise, we will print the coefficient and residual values using the
    `multiple_PM25_linear_model` object.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用`multiple_PM25_linear_model`对象打印系数和残差值。
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以完成练习：
- en: 'Extract the attribute coefficients using the `$` operator on the `multiple_PM25_linear_model`
    object:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`multiple_PM25_linear_model`对象上的`$`运算符提取属性系数：
- en: '[PRE0]'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The output is as follows:'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE1]'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Extract the attribute residuals using the `$` operator on the `multiple_PM25_linear_model`
    object:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`multiple_PM25_linear_model`对象上的`$`运算符提取属性残差：
- en: '[PRE2]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The output is as follows:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE3]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Activity 7: Printing Various Attributes Using Model Object Without Using the
    Summary Function'
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动7：不使用汇总函数使用模型对象打印各种属性
- en: In the *Multiple Linear Regression Model* section of *Chapter 3*, *Introduction
    to Supervised Learning*, we created a multiple linear regression model and stored
    it in the model object `multiple_PM25_linear_model` using the model object.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在第3章的*多元线性回归模型*部分，*监督学习简介*中，我们创建了一个多元线性回归模型，并将其存储在模型对象`multiple_PM25_linear_model`中，使用模型对象。
- en: 'This activity will help in understanding how to extract some important model
    attributes once the model is built. In few cases, we will use the `$` operator,
    and in other cases, we will perform some simple calculation. Print the following
    model attributes using the `multiple_PM25_linear_model` object:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 此活动有助于理解在模型构建后如何提取一些重要的模型属性。在少数情况下，我们将使用`$`运算符，在其他情况下，我们将进行一些简单的计算。使用`multiple_PM25_linear_model`对象打印以下模型属性：
- en: Residuals
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 残差
- en: Fitted values
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拟合值
- en: R-Ssquared value
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R-Ssquared值
- en: F-statistic
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: F统计量
- en: Coefficient p-value
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系数p值
- en: 'Let''s print these values using the model object:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用模型对象打印这些值：
- en: 'First, print the coefficient values. Make sure the output is like the output
    of the `summary` function using the `coefficients` option. The coefficients are
    fitted values from the model that uses the OLS algorithm:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，打印系数值。确保输出类似于使用`coefficients`选项的`summary`函数的输出。这些系数是使用OLS算法的模型得到的拟合值：
- en: '[PRE4]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Find the residual value (difference) of the predicted and actual values of
    PM2.5, which should be as small as possible. Residual reflects how far the fitted
    values using the coefficients are from the actual value:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到预测值和实际值之间的残差（差异），应尽可能小。残差反映了使用系数拟合的值与实际值之间的距离：
- en: '[PRE5]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Next, find the fitted values, which should be closer to the actual PM2.5 values
    for best model. Using the coefficients, we can compute the fitted values:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，找到拟合值，这些值应更接近实际的PM2.5值以获得最佳模型。使用系数，我们可以计算拟合值：
- en: '[PRE6]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Find the R-Squared values. They should look the same as the ones you obtained
    in the output of the `summary` function next to the multiple R-squared text. R-square
    helps in evaluating the model performance. If the value is closer to 1, the better
    the model is:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找R-Squared值。它们应该与你在`summary`函数输出中找到的多个R-squared值相同。R-square有助于评估模型性能。如果值越接近1，则模型越好：
- en: '[PRE7]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The output is as follows:'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE8]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Find the F statistic values. Make sure the output looks the same as the one
    you obtained in the output of the `summary` function next to the text F statistics.
    This will tell you if your model fits better than just using the mean of the target
    variables. In many practical applications, F-Statistic is used along with p-values:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找F统计量值。确保输出与你在`summary`函数旁边找到的F统计量文本的输出相同。这将告诉你你的模型是否比仅使用目标变量的均值拟合得更好。在许多实际应用中，F-Statistic与p值一起使用：
- en: '[PRE9]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Finally, find the coefficient p-values and make sure the values look the same
    as the one you obtained in the output of the `summary` function under *coefficients*
    for each variable. It will be present under the column titled `Pr(>|t|):`. If
    the value is less than 0.05, the variable is statistically significant in predicting
    the target variable:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，找到系数p值，并确保这些值与你在`summary`函数下*系数*部分获得的值相同。它将出现在标题为`Pr(>|t|):`的列下。如果值小于0.05，则变量在预测目标变量方面具有统计学意义：
- en: '[PRE10]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Note
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: The solution for this activity can be found on page 449.
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 本活动的解决方案可在第449页找到。
- en: '**Ordinary Least Square** (**OLS**)'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**普通最小二乘法** (**OLS**)'
- en: 'In *Chapter 3*, *Introduction to Supervised Learning*, we saw sum of squared
    residuals ![](img/C12624_04_30.png) (also called the **error sum of square** or
    **residual sum of squares**), which is a measure of the overall model fit, is
    given by the following equation:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在*第3章*，*监督学习简介*中，我们看到了平方残差和![img/C12624_04_30.png]（也称为**误差平方和**或**残差平方和**），这是衡量整体模型拟合程度的指标，其表达式如下：
- en: '![](img/C12624_04_31.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![img/C12624_04_31.jpg]'
- en: Where *T* represents the matrix transpose, and the rows of *X* represent the
    values of all the input variables related to a specific value of the target variable
    are ![](img/C12624_04_32.png). The value of ![A picture containing furniture
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *T* 代表矩阵转置，而 *X* 的行代表与目标变量的特定值相关的所有输入变量的值![img/C12624_04_32.png]。![A picture
    containing furniture](img/C12624_04_32.png)的值。
- en: Description automatically generated](img/C12624_04_33.png) that minimizes ![](img/C12624_04_34.png)is
    called the **OLS estimator** for β. The OLS algorithm is designed to find the
    global minimum of ![A picture containing furniture
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述![img/C12624_04_33.png]，该描述最小化了![img/C12624_04_34.png]，被称为β的**OLS估计量**。OLS算法旨在找到![A
    picture containing furniture](img/C12624_04_32.png)的全局最小值。
- en: Description automatically generated](img/C12624_04_35.png) that will minimize
    ![](img/C12624_04_36.png).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述![img/C12624_04_35.png]，该描述将最小化![img/C12624_04_36.png]。
- en: From the previous chapter, you also learned that the R-squared value for `multiple_PM25_linear_model`
    on the Beijing PM2.5 dataset is quite low for this model to be useful in practical
    applications. One way of interpreting the poor results is to say the predictor
    variables `DEWP` and `TEMP` do not fully explain the variance in PM2.5, so they
    fall short of producing good results.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你也了解到，对于北京PM2.5数据集上的`multiple_PM25_linear_model`，其R-squared值相当低，以至于这个模型在实用应用中难以发挥作用。解释这些不良结果的一种方式是说预测变量`DEWP`和`TEMP`并没有完全解释PM2.5的方差，因此它们未能产生良好的结果。
- en: Before we could jump into the diagnostics of this model, let's see if we could
    explain some of the variances in PM2.5 using the variable `month` (of the readings).
    We will also use an interaction variable (more on this in the *Improving the Model*
    section) *DEWP*TEMP*month* in the `lm()` function that generates all possible
    combination of `DEWP`, `TEMP`, and `month`.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们能够跳入此模型的诊断分析之前，让我们看看是否可以用变量`month`（读数中的月份）来解释PM2.5的一些方差。我们还将使用交互变量（更多内容请参阅*改进模型*部分）*DEWP*TEMP*month*，在`lm()`函数中生成`DEWP`、`TEMP`和`month`的所有可能组合。
- en: The reason for using `month` is justified by *Figure 3.3* in *Chapter 3*, *Introduction
    to Supervised Learning*, where we saw the seasonal effect in the values of `TEMP`,
    `DEWP`, and `PRES` (showing a nice sinusoidal pattern). The output of the following
    exercise shows all the interaction terms that got created to explain the PM2.5
    dataset.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `month` 的原因在 *第3章* 的 *监督学习简介* 中的 *图3.3* 中得到了证明，其中我们看到了 `TEMP`、`DEWP` 和 `PRES`
    的值中的季节性影响（显示出漂亮的正弦波模式）。以下练习的输出显示了为解释 PM2.5 数据集而创建的所有交互项。
- en: Note
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: The expression like `DEWP:TEMP` means multiplication and each value of `month`
    is a separate variable in `multiple_PM25_linear_model,` because we converted `month`
    into `factor` before running the model.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 表达式如 `DEWP:TEMP` 表示乘法，并且每个 `month` 的值在 `multiple_PM25_linear_model` 中都是一个独立的变量，因为我们运行模型之前将
    `month` 转换成了 `factor`。
- en: 'Exercise 51: Add the Interaction Term DEWP:TEMP:month in the lm() Function'
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习51：在lm()函数中添加交互项DEWP:TEMP:month
- en: In this exercise, we will add the interaction term to improve the model performance.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将添加交互项以提高模型性能。
- en: 'We will see how adding an additional interaction term helps in improving the
    model performance in terms of R-squared values. Perform the following steps to
    complete the exercise:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看到添加额外的交互项如何有助于提高模型性能，从R-squared值的角度来看。执行以下步骤以完成练习：
- en: 'Read the Beijing PM2.5 dataset using the following command:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令读取北京PM2.5数据集：
- en: '[PRE11]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Now, convert the `month` object into the `factor` variable as shown here:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将 `month` 对象转换为 `factor` 变量，如下所示：
- en: '[PRE12]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Use the linear model with interaction terms of `DEWP`, `TEMP`, and `month`.
    Observe the term `DEWP*TEMP*month`, which will generate all the combinations of
    the variable `DEWP`, `TEMP`, and `month`:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用具有 `DEWP`、`TEMP` 和 `month` 的交互项的线性模型。观察 `DEWP*TEMP*month` 项，这将生成 `DEWP`、`TEMP`
    和 `month` 变量的所有组合：
- en: '[PRE13]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Print the summary of the model to see the changes in coefficients and r-squared
    values because of the interaction term:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印模型的摘要以查看由于交互项而引起的系数和r-squared值的变化：
- en: '[PRE14]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The output is as follows:'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE15]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Notice the two-fold jump in the R-squared value from 0.216 to 0.4217\. However,
    such a jump is at the cost of **model interpretability**. Though it is simple
    to explain the explanatory power of the model using individual variables, their
    multiplication creates an effect that is difficult to articulate.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 注意R-squared值从0.216到0.4217的两次跳跃。然而，这种跳跃是以**模型可解释性**为代价的。虽然使用单个变量解释模型的可解释性很简单，但它们的乘积会产生难以描述的效果。
- en: In our example of Beijing PM2.5, it is more logical to think of the interaction
    `DEWP` and `TEMP` have with the `month` object of the `year` object, since both
    of these are environmental factors which vary with season.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们北京PM2.5的例子中，更合理地认为 `DEWP` 和 `TEMP` 与 `year` 对象的 `month` 对象的交互，因为这两个都是随季节变化的环境因素。
- en: However, we would also like to perform some diagnostics to fully understand
    how a linear regression model is studied end to end and not just look at the R-squared
    value.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们还想进行一些诊断，以全面了解线性回归模型是如何从头到尾研究的，而不仅仅是查看R-squared值。
- en: Model Diagnostics
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型诊断
- en: Often statistical models such as linear regression and logistic regressions
    come with many assumptions that need to be validated before accepting the final
    solution. A model violating the assumptions will result in erroneous prediction
    and results will be prone to misinterpretation.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，像线性回归和逻辑回归这样的统计模型在接受最终解决方案之前需要验证许多假设。违反假设的模型会导致错误的预测，结果容易产生误解。
- en: 'The following code shows a method for obtaining the diagnostic plots from the
    output of the `lm()` method. The plot has four different plots looking at the
    residuals. Let''s understand how to interpret each plot. All these plots are about
    how well the fit matches the regression assumptions. If there is a violation,
    it will be clearly shown in the plots of the following code:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码显示了从 `lm()` 方法的输出中获取诊断图的方法。该图有四个不同的图，查看残差。让我们了解如何解释每个图。所有这些图都是关于拟合如何符合回归假设的。如果有违反，它将在以下代码的图中清楚地显示：
- en: '[PRE16]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The output is as follows:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.1: Diagnostics plot for the linear model fit on the Beijing PM2.5
    dataset'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '![图4.1：北京PM2.5数据集上线性模型拟合的诊断图'
- en: '](img/C12624_04_01.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/C12624_04_01.jpg)'
- en: 'Figure 4.1: Diagnostics plot for the linear model fit on the Beijing PM2.5
    dataset'
  id: totrans-100
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.1：北京PM2.5数据集上线性模型拟合的诊断图
- en: In the next four sections, we will explore each of the plots with randomly generated
    data from a linear equation ![](img/C12624_04_37.png)and a quadratic equation
    ![](img/C12624_04_38.png), and later come back to explain how the four plots in
    *Figure 4.1* fare in comparison with the ideal scenarios.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-102
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In the quadratic equation, ![](img/C12624_04_39.png) ![](img/C12624_04_40.png)
    is assumed to be normally distributed with mean 0 and variance 2.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: In the following exercise, we will generate the plots using the linear and quadratic
    equations. Later, we will deep dive into understanding the various assumptions
    a linear model should follow using the model fit on the random data generated
    through the two equations.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 52: Generating and Fitting Models Using the Linear and Quadratic Equations'
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will understand the linear and polynomial function and
    what happens when we fit a linear model on both.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: Generate random numbers using a linear and a polynomial equation, and fit a
    linear model on both. Observe the difference between the two plots.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to generate the required plots:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: 'First, define the linear function using the following code:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Define the quadratic function as shown in the following command:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Now, generate the uniform random numbers (`x`), as shown here:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Generate the linear values (`y`) using (`x`), as shown here:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Generate the quadratic values (`y`) using (`x`):'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Fit a linear model for `linear_values_y` using `uniform_random_x`:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Plot the diagnostic plot fora linear relationship:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The plot is as follows:'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.2: Plots using the linear regression'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/C12624_04_02.jpg)'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Figure 4.2: Plots using the linear regression'
  id: totrans-126
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Fit a linear model for `quadratic_values_y` using `uniform_random_x`:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE24]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Generate a diagnostic for non-linear relationships:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE25]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The output is as follows:'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.3: Plots using the quadratic regression'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_03.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.3: Plots using the quadratic regression'
  id: totrans-134
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The difference between the plot in step 7 and 9 show the good and a poor fit
    of a linear relationship. A linear model can't fit a non-linear relationship between
    *y* and *x*. In the next sections, we will deep dive into understanding the four
    parts of the plots generated in step 7 and 9.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: In *Chapter 3*, *Introduction to Supervised Learning*, *Figure 3.5* we discussed
    the various assumptions to consider while building a linear regression model.
    Through the four plots mentioned earlier in the chapter, we will examine if any
    of the assumptions are violated or not.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: Residual versus Fitted Plot
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This type of plot is between the fitted values and the residual (difference
    between `lm()` method. If the predictor and target variables have a non-linear
    relationship, the plot will help us identify.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: 'In the following figure, the top plot shows the point scattered all around
    and the linear relationship between the predictor and target variable is clearly
    captured. In the bottom plot, the unexplained non-linear relationship is left
    out in the residuals, and hence the curve. The bottom plot clearly shows it is
    not the right fit for a linear regression model, a violation of the linear relationship
    between the predictor and target variable:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下图中，上部分图显示了点均匀地散布，预测变量和目标变量之间的线性关系被清楚地捕捉到。在下部分图中，未解释的非线性关系被留在残差和曲线中，因此底部图清楚地显示它不是线性回归模型的正确拟合，违反了预测变量和目标变量之间的线性关系：
- en: '![Figure 4.4: [Top] Residual versus fitted plot of the linear function. [Bottom]
    Residual versus fitted plot of the quadratic function'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 4.4: [Top] Residual versus fitted plot of the linear function. [Bottom]
    Residual versus fitted plot of the quadratic function]'
- en: '](img/C12624_04_04.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/C12624_04_04.jpg]'
- en: 'Figure 4.4: [Top] Residual versus fitted plot of the linear function. [Bottom]
    Residual versus fitted plot of the quadratic function'
  id: totrans-142
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.4：[上] 线性函数的残差与拟合图。[下] 二次函数的残差与拟合图
- en: Normal Q-Q Plot
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 正态Q-Q图
- en: '**Q-Q plot**, also called **Quantile-Quantile plot**, supports to check if
    the data plausibly comes from approximately theoretical distribution; in this
    instance, **Normal Distribution**. A Q-Q plot is a scatterplot shaped by plotting
    two sets of quantiles (points below which a certain proportion of the data falls)
    in contrast to one another. If both groups of quantiles came from a similar distribution,
    we must see the points creating a coarsely straight line. Provided a vector of
    data, the normal Q-Q plot plots the data in sorted order versus quantiles from
    a standard normal distribution.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '**Q-Q图**，也称为**分位数-分位数图**，用于检查数据是否可能来自近似的理论分布；在本例中，为**正态分布**。Q-Q图是通过绘制两组分位数（数据中低于一定比例的点）相对比而形成的散点图。如果两组分位数都来自相似的分布，我们应看到点形成一条大致的直线。给定一个数据向量，正态Q-Q图按顺序绘制数据与标准正态分布的分位数。'
- en: The second assumption in linear regression was that all the predictor variables
    are normally distributed. If it is true, the residuals will also be normally distributed.
    Normal Q-Q is a plot between standardized residuals and theoretical quantiles.
    Visually, we can inspect whether the residuals follow the straight line, if it
    is normally distributed, or if there is any deviation that indicates violation.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 线性回归的第二个假设是所有预测变量都是正态分布的。如果这是真的，残差也将是正态分布的。正态Q-Q图是标准化残差与理论分位数之间的图。直观上，我们可以检查残差是否遵循直线，如果是正态分布的，或者是否有任何偏差表明违反了假设。
- en: 'In the following figure, the top part demonstrates the linear function, which
    shows an alignment with the straight diagonal line, with a few exceptions like
    observation number 39, 30, and 50\. On the other hand, the bottom part of the
    figure shows the quadratic function, which surprisingly shows a fair alignment
    with the straight line, not exactly like the linear, as some divergence is seen
    in the top-right side of the plot:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下图中，图的上部分展示了线性函数，它与直线对齐，除了39号、30号和50号观测值等少数例外。另一方面，图的下半部分展示了二次函数，它意外地与直线有很好的对齐，不像线性函数，因为图中右上角有一些偏差：
- en: '![Figure 4.5: [Top] Normal Q-Q plot of the linear function. [Bottom] Normal
    Q-Q plot of the quadratic function'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 4.5: [Top] Normal Q-Q plot of the linear function. [Bottom] Normal
    Q-Q plot of the quadratic function]'
- en: '](img/C12624_04_05.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/C12624_04_05.jpg]'
- en: 'Figure 4.5: [Top] Normal Q-Q plot of the linear function. [Bottom] Normal Q-Q
    plot of the quadratic function'
  id: totrans-149
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.5：[上] 线性函数的正态Q-Q图。[下] 二次函数的正态Q-Q图
- en: Scale-Location Plot
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标度-位置图
- en: '**Scale-Location plot** shows whether residuals are spread equally along the
    ranges of input variables (predictor). The assumption of equal variance (**homoscedasticity**)
    could also be checked with this plot. If we see a horizontal line with randomly
    spread points, it means that the model is good.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '**标度-位置图**显示残差是否均匀地分布在输入变量（预测变量）的范围内。也可以用此图来检查方差相等的假设（**同方差性**）。如果我们看到一条水平线，点随机分布，这意味着模型是好的。'
- en: 'The plot is between fitted values and the square root of standardized residuals.
    In the following figure, the top plot shows the linear function, and the residuals
    are spread randomly along the horizontal lines, whereas in the bottom plot, there
    seems to be a pattern that is not random. Hence, the variance is not equal:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 该图位于拟合值和标准化残差的平方根之间。在下面的图中，顶部的图显示了线性函数，残差沿着水平线随机分布，而在底部的图中，似乎有一个非随机的模式。因此，方差不相等：
- en: '![Figure 4.6: [Top] Scale-Location plot of the linear function. [Bottom] Scale-Location
    plot of the quadratic function'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '![图4.6：[上] 线性函数的尺度-位置图。[下] 二次函数的尺度-位置图]'
- en: '](img/C12624_04_06.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/C12624_04_06.jpg]'
- en: 'Figure 4.6: [Top] Scale-Location plot of the linear function. [Bottom] Scale-Location
    plot of the quadratic function'
  id: totrans-155
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.6：[上] 线性函数的尺度-位置图。[下] 二次函数的尺度-位置图
- en: Residual versus Leverage
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 残差与杠杆
- en: If there are any influential points in the data, the **Residual versus Leverage**
    plot helps in identifying it. It's common to think that all outlier points are
    influential, that is, it decides how the regression line comes out. However, not
    all outliers are influential points. Even if a point is within a reasonable range
    of values (not an outlier), it could still be an influential point.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 如果数据中存在任何有影响力的点，**残差与杠杆**图有助于识别它。通常认为所有异常点都是有影响力的，即它决定了回归线的形状。然而，并非所有异常点都是有影响力的。即使一个点在合理的值范围内（不是异常点），它仍然可能是有影响力的点。
- en: 'In the next plot, we will look out for far off values at the top-right corner
    or at the bottom-right corner. Those regions are the spaces where observation
    can be *influential* in contrast to a regression line. In *Figure 4.7*, the observations
    of the red dashed line with high `40` and `39` outside of the dashed line (high
    Cook''s distance). Note that these observations are consistently appearing in
    the other three plots as well, giving us a strong reason to eliminate these points,
    if we would like to see the linear relationship in the data. The plot on the top
    seems to have no red dashed line, ascertaining a good fit:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个图中，我们将关注右上角或右下角的远离值。这些区域是观察值相对于回归线可能具有影响力的空间。在*图4.7*中，红色虚线外的观察值`40`和`39`（高Cook距离）。请注意，这些观察值在其他三个图中也持续出现，这给了我们一个强有力的理由，如果我们想看到数据中的线性关系，就应该消除这些点。顶部的图似乎没有红色虚线，这证实了一个良好的拟合：
- en: '![Figure 4.7: [Top] Residual versus Leverage plot of the linear function. [Bottom]
    Residual versus Leverage plot of the quadratic function'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '![图4.7：[上] 线性函数的残差与杠杆作用图。[下] 二次函数的残差与杠杆作用图]'
- en: '](img/C12624_04_07.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/C12624_04_07.jpg]'
- en: 'Figure 4.7: [Top] Residual versus Leverage plot of the linear function. [Bottom]
    Residual versus Leverage plot of the quadratic function'
  id: totrans-161
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.7：[上] 线性函数的残差与杠杆作用图。[下] 二次函数的残差与杠杆作用图]
- en: Now, if we revisit *Figure 4.1*, the diagnostics plot we obtained from the Beijing
    PM2.5 dataset; it seems like the model fit is *not the best* to be used for practical
    purposes. All the four plots show slight violation of linearity, normality and
    homoscedasticity assumptions.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果我们重新审视*图4.1*，即我们从北京PM2.5数据集中获得诊断图；看起来这个模型对于实际应用来说拟合并不是最好的。所有四个图都显示出轻微的违反线性、正态性和同方差性假设。
- en: In the next section, we have listed a few ways to improve the model, which may
    incrementally help increase the R-squared value and better fit the data. Also,
    similar to the visual inspection methods we just discussed, many statistical methods
    such as **Kolmogorov-Smirnov test** for testing normality, **Correlation** for
    testing multicollinearity, **Goldfeld–Quandt test** for testing homoscedasticity
    could be used.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们列出了一些改进模型的方法，这些方法可能有助于逐步提高R平方值并更好地拟合数据。同样，类似于我们刚才讨论的视觉检查方法，许多统计方法，如用于测试正态性的**Kolmogorov-Smirnov检验**，用于测试多重共线性的**相关系数**，用于测试同方差的**Goldfeld-Quandt检验**，都可以使用。
- en: Improving the Model
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 改进模型
- en: So far, we have seen the problems in the data, but you may ask whether you can
    fix or improve it. Let's discuss some ways to do that. In this section, you will
    learn some of the ways, such as variable transformation, dealing with outlier
    points, adding interaction effect and deciding to go with a non-linear model.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经看到了数据中的问题，但你可能会问是否可以修复或改进它。让我们讨论一些改进的方法。在本节中，你将学习一些方法，例如变量转换、处理异常点、添加交互作用以及决定采用非线性模型。
- en: Transform the Predictor or Target Variable
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 转换预测变量或目标变量
- en: The most common way to improve the model is to transform one or more variables
    (could also be the target variable) using a `log` function.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 提高模型的最常见方法是使用对数函数变换一个或多个变量（也可能是目标变量）。
- en: Log transformation corrects the skewed distribution. It gives the ability to
    handle the skewness in the data and at the same time the original value could
    be easily computed once the model is built. The most popular log transformation
    is natural *log*. A more detailed explanation for log transformation could be
    found in the section *Log Transformation* of *Chapter 6*, *Feature Selection and
    Dimensionality Reduction*.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 对数变换可以纠正偏斜分布。它提供了处理数据中偏斜性的能力，同时一旦建立模型，原始值就可以很容易地计算出来。最流行的对数变换是自然对数。关于对数变换的更详细解释，可以在*第6章*的*特征选择和降维*部分的*对数变换*部分找到。
- en: The objective is to bring the normal distribution in the data by transforming.
    So, whichever function helps in attaining that is a good transformation. After
    log, square root is also widely used. Look at the distribution of the transformed
    variable to see if a symmetrical distribution (bell shaped) is obtained; if yes,
    then the transformation is going to be useful.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是通过变换将数据中的正态分布引入。因此，任何有助于达到这一目标的函数都是一种好的变换。在取对数之后，平方根变换也被广泛使用。查看变换后变量的分布，看看是否得到了对称分布（钟形）；如果是，那么这种变换将是有用的。
- en: Choose a Non-Linear Model
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 选择非线性模型
- en: It might be possible to get struck in a scenario where a linear model is not
    a right fit because there is a non-linear relationship between the predictor and
    the target variable and only a non-linear function could fit such data. See the
    section *Polynomial Regression* later in this chapter for more details on such
    a model.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会遇到一种情况，线性模型并不适合，因为预测变量和目标变量之间存在非线性关系，只有非线性函数才能拟合这样的数据。关于此类模型的更多细节，请参阅本章后面的*多项式回归*部分。
- en: Remove an Outlier or Influential Point
  id: totrans-172
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 移除异常值或影响点
- en: As we discussed in the *Residual versus Leverage* section's diagnostic plot,
    we may find an outlier or influential point playing a spoil spot in getting us
    the best model. If you have identified it properly, try seeing by removing the
    observation and see if things improve.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在*残差与杠杆率*部分的诊断图中讨论的那样，我们可能会发现一个异常值或影响点在获得最佳模型时起到了破坏作用。如果你已经正确地识别了它，尝试通过删除观测值来看是否有所改善。
- en: Adding the Interaction Effect
  id: totrans-174
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加交互效应
- en: 'We might at times see the value(s) of two or more predictor (independent) variables
    in the dataset influencing the dependent variable in a multiplicative way. A linear
    regression equation with an interaction term might look like this:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 有时我们可能会看到数据集中两个或更多预测（独立）变量的值以乘法方式影响因变量。一个带有交互项的线性回归方程可能看起来像这样：
- en: '![](img/C12624_04_41.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/C12624_04_41.jpg)'
- en: One can go for the higher order of such an interaction (for example, using three
    variables); however, those are difficult to interpret and usually avoided.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 可以尝试更高阶的这种交互（例如，使用三个变量）；然而，这些很难解释，通常会被避免。
- en: Quantile Regression
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分位数回归
- en: When the data presents outliers, high skewness, and conditions leading to heteroscedasticity,
    we employ quantile regression for modelling. Also, one key question quantile regression
    answers, which linear regression cannot, is "Does `DEWP`, `TEMP`, and `Iws` influence
    PM2.5 levels differently for high PM2.5 than for average PM2.5?"
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 当数据出现异常值、高偏度和导致异方差性的条件时，我们采用分位数回归进行建模。此外，分位数回归回答的一个关键问题是，线性回归无法回答的：“对于高PM2.5和平均PM2.5，`DEWP`、`TEMP`和`Iws`对PM2.5水平的影响是否不同？”
- en: Quantile regression is quite similar to linear regression; however, the quantile
    regression parameter estimates the change in a certain quantile of the `response`
    variable produced by a unit change in the input `predictor` variable. In order
    to fully understand this statement, let's fit our Beijing data using quantile
    regression (without using the interaction terms).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 分位数回归与线性回归非常相似；然而，分位数回归参数估计的是由于输入预测变量单位变化而产生的`响应`变量某个分位数的改变。为了完全理解这个陈述，让我们使用分位数回归（不使用交互项）来拟合我们的北京数据。
- en: We need to install the `quantreg` package to fit the quantile regression into
    the data. The package offers the method, `rq()` to fit the data using the argument
    `tau`, which is the model parameter specifying the value of quantile to be used
    for fitting the model into the data. Observe that the other parts of the arguments
    to the `rq()` method looks similar to `lm()`.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 53: Fit a Quantile Regression on the Beijing PM2.5 Dataset'
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will observe the difference in the quantile regression
    fit at various quantiles, particularly 25th, 50th, and 75th. The `rq()` function
    from `quantreg` will be used for building the model. In *Figure 4.8*, we will
    compare the coefficient values obtained through the `lm()` function versus the
    `rq()` function to compare the two types of regression.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: 'Read the Beijing PM2.5 dataset using the following command:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE26]'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Now, the next step is to install the required package. Use the following command
    to load the `quantreg` package:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Run the quantile regression tau values as 0.25, 0.5, and 0.75, which corresponds
    to the 25th, 50th, and 75th quantiles, respectively:'
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Print the summary of the quantile regression model:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE29]'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The output is as follows:'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE30]'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: The following table summarizes the coefficient values of the linear regression
    that we obtained using `lm()` in the *Regression* section of *Chapter 3*, *Introduction
    to Supervised Learning* and the values we obtained using `rq()` in three quantiles.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: 'According to the linear regression model, the mean PM2.5 level in the atmosphere
    increases by `4.384196` with one unit increase in `DEWP`. The quantile regression
    results in the following table, and it indicates that `DEWP` has a larger negative
    impact on the higher quantiles (observe the 75th quantile) of PM2.5:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.8: Coefficient estimates for the 25th, 50th, 75th quantile regression
    and the linear regression coefficient estimates for the Beijing''s PM2.5 estimation
    model'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_08.jpg)'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.8: Coefficient estimates for the 25th, 50th, 75th quantile regression
    and the linear regression coefficient estimates for the Beijing''s PM2.5 estimation
    model'
  id: totrans-199
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Exercise 54: Plotting Various Quantiles with More Granularity'
  id: totrans-200
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, instead of using the 25th, 50th and 75th quantiles, we will
    use the more granular values for tau in the `rq` function. The plot will help
    visualize the change in the coefficient values based on the quantile value. Use
    the `seq()` function from R that sets the quantile values starting from 0.05 to
    0.95 with an increment of 0.05.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: 'Create a `quantile_regression_PM25_granular` variable:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE31]'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Now, store the value from the previously created variable using the `summary`
    function:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE32]'
  id: totrans-206
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Let''s use the following command to plot the graph. Observe for the different
    values of tau, how the values of `Intercept`, `DEWP`, `TEMP`, and `Iws` change:'
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The output plot is as follows:'
  id: totrans-209
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.9: Shows the various values of coefficients of DEWP, TEMP, and Iws
    for various values of quantiles'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '![图4.9：显示了不同分位数下DEWP、TEMP和Iws的系数的各种值'
- en: '](img/C12624_04_09.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片C12624_04_09.jpg](img/C12624_04_09.jpg)'
- en: 'Figure 4.9: Shows the various values of coefficients of DEWP, TEMP, and Iws
    for various values of quantiles'
  id: totrans-212
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.9：显示了不同分位数下DEWP、TEMP和Iws的系数的各种值
- en: In this exercise, we explored the granularity of the variable using more granular
    values for tau in the `rq` function. The previous figure shows the various values
    of the coefficients of `DEWP`, `TEMP`, and `Iws`. The X-axis in the plot shows
    the quantile. The single dotted line shows the estimation of the quantile regression,
    and the gray area is the confidence interval. The middle gray line is a representation
    of the OLS coefficient estimates, and the double dotted lines display the confidence
    intervals around the OLS coefficients. Observe that the red and the gray areas
    do not overlap, which justifies our use of quantile regression. If the two lines
    overlap, then there is no difference in the estimates using OLS and quantile regression.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们通过在`rq`函数中使用更细粒度的tau值来探索变量的粒度。上一张图显示了`DEWP`、`TEMP`和`Iws`的系数的各种值。图中X轴表示分位数。单条虚线表示分位数回归的估计，灰色区域是置信区间。中间的灰色线是OLS系数估计的表示，双虚线显示OLS系数的置信区间。观察发现红色和灰色区域没有重叠，这证明了我们使用分位数回归的正确性。如果两条线重叠，那么使用OLS和分位数回归的估计就没有差异。
- en: Note
  id: totrans-214
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: We are not claiming that quantile regression is giving better results than linear
    regression. The adjusted R-squared value is still low for this model and it works
    well in the real world. However, we claim that quantile regression can help in
    estimating the PM2.5 at different levels than just the average, which provides
    a robust interpretation for data with outliers, high skewness, and heteroscedasticity.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们并不声称分位数回归比线性回归给出更好的结果。这个模型的调整R平方值仍然很低，但在现实世界中它工作得很好。然而，我们声称分位数回归可以帮助估计PM2.5的不同水平，而不仅仅是平均值，这为具有异常值、高偏度和异方差性的数据提供了稳健的解释。
- en: Polynomial Regression
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 多项式回归
- en: 'Often in real-world data, the response variable and the predictor variable
    don''t have a linear relationship, and we may need a **nonlinear polynomial function**
    to fit the data. Various scatterplot-like residual versus each predictor and residual
    versus fitted values reveal the violation of linearity if any, which could potentially
    help in identifying the need for introducing the quadratic or cubic term in the
    equation. The following function is a generic polynomial equation:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实世界的数据中，响应变量和预测变量往往没有线性关系，我们可能需要一个**非线性多项式函数**来拟合数据。各种散点图样的残差与每个预测变量和残差与拟合值的对比揭示了是否存在违反线性关系的情况，这可能会帮助识别在方程中引入二次或三次项的需要。以下是一个通用的多项式方程：
- en: '![](img/C12624_04_42.jpg)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![图片C12624_04_42.jpg](img/C12624_04_42.jpg)'
- en: Where *k* is the degree of the polynomial. For *k=2*, *f(X)* is called **quadratic**
    and *h=4* is called **cubic**. Note that polynomial regression is still considered
    linear regression since it is still linear in coefficient ![A drawing of a face
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 其中*k*是多项式的次数。对于*k=2*，*f(X)*被称为**二次**，*h=4*被称为**三次**。请注意，多项式回归仍然被认为是线性回归，因为它在系数![一张脸的插图
- en: Description automatically generated](img/C12624_04_43.png).
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成描述](img/C12624_04_43.png)。
- en: Before revisiting the Beijing PM2.5 example, let's understand how polynomial
    regression works using simulated data from the quadratic equation we introduced
    in the *Linear Regression* section.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在重新审视北京PM2.5的例子之前，让我们通过使用我们在*线性回归*部分介绍的二项式方程的模拟数据来理解多项式回归是如何工作的。
- en: 'Exercise 55: Performing Uniform Distribution Using the runif() Function'
  id: totrans-222
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习55：使用runif()函数执行均匀分布
- en: In this exercise, we will generate 50 random numbers from a uniform distribution
    using the function `runif()` in R and store the results in `uniform_random_x`.
    We have defined a function to generate values using the previous quadratic equation.
    Note that we will separately add ![A close up of a logo
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用R中的`runif()`函数生成50个来自均匀分布的随机数，并将结果存储在`uniform_random_x`中。我们已经定义了一个使用之前二次方程生成值的函数。请注意，我们将单独添加![一个标志的特写
- en: Description automatically generated](img/C12624_04_40b.png) to the values returned
    by the function; ![A close up of a logo
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成描述](img/C12624_04_40b.png)到函数返回的值；![一个标志的特写
- en: 'Description automatically generated](img/C12624_04_40a.png) is generated from
    the normal distribution using the `rnorm()` function in R. The final value will
    then be stored in `quadratic_values_y`:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/C12624_04_40a.png)是使用R中的`rnorm()`函数从正态分布生成的。最终值将被存储在`quadratic_values_y`中：
- en: 'Perform these steps to perform the uniform distribution using the `runif()`
    function:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以使用`runif()`函数进行均匀分布：
- en: 'First, define the quadratic equation as illustrated in the following command:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，定义以下命令中所示的二次方程：
- en: '[PRE34]'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Now, generate the uniform random number for `x`:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，生成`x`的均匀随机数：
- en: '[PRE35]'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Add the error term to the quadratic equation, which is normally distributed
    with mean `0` and variance `2` (*standard deviation(sd) = square root of variance*):'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将误差项添加到二次方程中，该误差项是均值为`0`、方差为`2`的正态分布（*标准差(sd) = 方差的平方根*）：
- en: '[PRE36]'
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'To store the data in data frame, let''s use the following command:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将数据存储在数据框中，请使用以下命令：
- en: '[PRE37]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Now, plot the relationship between `x` and `y` based on the quadratic equation:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，根据二次方程绘制`x`和`y`之间的关系图：
- en: '[PRE38]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The output is as follows:'
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.10: Performing uniform distribution using the function runif()'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图4.10：使用函数runif()进行均匀分布'
- en: '](img/C12624_04_10.jpg)'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/C12624_04_10.jpg)'
- en: 'Figure 4.10: Performing uniform distribution using the function runif()'
  id: totrans-240
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.10：使用函数runif()进行均匀分布
- en: The following figure clearly shows the relationship between `uniform_random_x`
    and `quadratic_values_y` is not linear as expected. Now, if we try to fit a linear
    model, we expect to see some trouble in the diagnostics plot.
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 下一个图清楚地显示了`uniform_random_x`和`quadratic_values_y`之间的关系不是线性的，正如预期的那样。现在，如果我们尝试拟合一个线性模型，我们预计会在诊断图中看到一些问题。
- en: Residuals versus fitted value plots in *Figure 4.12* display a curvature and
    they do not demonstrate uniform randomness as we have seen before. Also, **Normal
    Probability Plot** (**NPP**) seems to diverge from a straight line and curves
    down at the far away percentiles. These plots suggest that there is something
    incorrect with the model being used and indicate that a higher-order model may
    be needed.
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图4.12*中的残差与拟合值图显示了曲率，并且它们没有像之前看到的那样表现出均匀的随机性。此外，**正态概率图**（**NPP**）似乎偏离了直线，并在远端百分位数处向下弯曲。这些图表明所使用的模型可能存在问题，并表明可能需要一个更高阶的模型。'
- en: '![Figure 4.11: The plot shows the non-linear relationship between uniformly
    generated random number(x) and the value of x in the quadratic equation'
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图4.11：该图显示了均匀生成的随机数(x)与二次方程中x的值的非线性关系'
- en: '](img/C12624_04_11.jpg)'
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/C12624_04_11.jpg)'
- en: 'Figure 4.11: The plot shows the non-linear relationship between uniformly generated
    random number(x) and the value of x in the quadratic equation'
  id: totrans-245
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.11：该图显示了均匀生成的随机数(x)与二次方程中x的值的非线性关系
- en: 'Now, fit a linear regression model to the polynomial (quadratic) equation and
    display the diagnostic plot:'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将线性回归模型拟合到多项式（二次）方程，并显示诊断图：
- en: '[PRE39]'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The output is as follows:'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.12: Diagnostic plot for the quadratic equation data fit using the
    lm() method'
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图4.12：使用lm()方法对二次方程数据拟合的诊断图'
- en: '](img/C12624_04_12.jpg)'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图片](img/C12624_04_12.jpg)'
- en: 'Figure 4.12: Diagnostic plot for the quadratic equation data fit using the
    lm() method'
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.12：使用lm()方法对二次方程数据拟合的诊断图
- en: Now, let's see how polynomial regression fares on the Beijing PM2.5 dataset.
    We have introduced an additional quadratic term `DEWP^2`, which is simply `DEWP`
    raised to the power `2`. Refer to the scatterplot illustrated in *Figure 3.5*
    of *Chapter 3*, *Introduction to Supervised Learning* to justify the addition
    of such a higher order term.
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，让我们看看多项式回归在北京PM2.5数据集上的表现。我们引入了一个额外的二次项 `DEWP^2`，这仅仅是 `DEWP` 的平方。请参考第3章，*监督学习导论*中的*图3.5*，以证明添加这样一个高阶项的合理性。
- en: 'Use polynomial regression on the Beijing PM2.5 dataset with the quadratic and
    cubic terms:'
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在北京PM2.5数据集上使用多项式回归（二次和三次项）：
- en: '[PRE40]'
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'To print the model summary, use the following command:'
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要打印模型摘要，请使用以下命令：
- en: '[PRE41]'
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The output is as follows:'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE42]'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Observe that in spite of an additional quadratic term, we are not attaining
    any better R-squared value than the linear model. At this juncture, we may conclude
    that the PM2.5 prediction needs a better independent variable, which could explain
    the variance in it to get the R-squared value to any higher level. The diagnostics
    plot seems to show similar interpretation.
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Plot the diagnostics plot using the following command:'
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE43]'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The output is as follows:'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.13: The diagnostics plot for polynomial regression model fit on
    the Beijing PM2.5 dataset'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_13.jpg)'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.13: The diagnostics plot for polynomial regression model fit on the
    Beijing PM2.5 dataset'
  id: totrans-265
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Ridge Regression
  id: totrans-266
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As we saw in linear regression, **Ordinary Least Square** (**OLS**) estimates
    the value of ![A picture containing furniture
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: Description automatically generated](img/C12624_04_44.png) in such a way that
    the sum of squares of residual ![](img/C12624_04_45.png) is minimized.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: Since ![A picture containing furniture
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
- en: Description automatically generated](img/C12624_04_46.png) is an estimate we
    compute from a given sample and it's not a *true population parameter*, we need
    to be careful of certain characteristics of an estimate. The two such primary
    characteristics are the bias and the variance.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
- en: If ![A close up of a logo
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: Description automatically generated](img/C12624_04_48.png) is the fit at the
    ![](img/C12624_04_49.png) value of ![A close up of a logo
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: 'Description automatically generated](img/C12624_04_50.png), then the average
    (or expected) ![](img/C12624_04_47.png) on the test dataset could be decomposed
    into three quantities, the variance, the squared bias, and the variance of error
    terms as represented by the following equation:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/C12624_04_51.jpg)'
  id: totrans-274
  prefs: []
  type: TYPE_IMG
- en: 'For the best estimate, a suitable algorithm such as OLS should simultaneously
    achieve low bias and low variance. We commonly call this the **Bias-Variance**
    trade off. The popular bull''s eye picture shown in the following figure helps
    understand the various scenarios of the tradeoff:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.14: The popular bull''s eye picture for explaining Bias and Variance
    scenarios'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_14.jpg)'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.14: The popular bull''s eye picture for explaining Bias and Variance
    scenarios'
  id: totrans-278
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'The bull''s eye represents the true population value that OLS is trying to
    estimate, and the shots at it are the values of our estimates resulting from four
    different estimators. These are broadly classified into the following:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: Low Bias and Low Variance (most favorable)
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Low Bias and High Variance
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: High Bias and Low Variance
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: High Bias and High Variance (least favorable)
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OLS method treats all variables as equally likely, thus having a low bias (results
    in **under-fitting** during training) and high variance (results in **prediction
    error** in testing data) as shown in the *Figure 4.11*. Such behavior is not ideal
    for obtaining the optimal model complexity. The general solution to this issue
    is to reduce variance at the cost of introducing some bias. This approach is called
    regularization. So, ridge regression could be thought of as an extension of linear
    regression with an additional regularization term.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: OLS方法将所有变量视为同等可能，因此具有低偏差（在训练期间导致**欠拟合**）和高方差（在测试数据中导致**预测误差**），如*图4.11*所示。这种行为对于获得最佳模型复杂度并不理想。解决这个问题的通用方法是牺牲一些偏差来降低方差。这种方法被称为正则化。因此，岭回归可以被视为线性回归的扩展，其中包含一个额外的正则化项。
- en: 'The general form of multiple linear regression could be expressed as follows:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 多元线性回归的一般形式可以表示如下：
- en: '![](img/C12624_04_52.jpg)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
  zh: '![图片 C12624_04_52.jpg](img/C12624_04_52.jpg)'
- en: 'Where, **argmin** means the minimum value of βs that make the function attain
    the minimum. In the context, it finds the βs that minimize the RSS. The βs are
    subject to the following constraints:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，**argmin**表示使函数达到最小值的βs的最小值。在此上下文中，它找到使RSS最小的βs。βs受到以下约束：
- en: '![](img/C12624_04_53.jpg)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![图片 C12624_04_53.jpg](img/C12624_04_53.jpg)'
- en: Regularization Term – L2 Norm
  id: totrans-289
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 正则化项 – L2范数
- en: '![](img/C12624_04_54.jpg)![](img/C12624_04_55.jpg)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![图片 C12624_04_54.jpg](img/C12624_04_54.jpg)![图片 C12624_04_55.jpg](img/C12624_04_55.jpg)'
- en: The penalty term in the ridge beta increases if RSS increases. The following
    figure shows a plot between **Model Complexity** (number of predictors) and **Error**.
    It shows that when the number of predictors increase (model complexity increases),
    the **Variance** goes up and the **Bias** goes down.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 岭回归的惩罚项在RSS增加时增加。以下图表显示了**模型复杂度**（预测变量数量）与**误差**之间的关系。它表明，当预测变量的数量增加（模型复杂度增加）时，**方差**上升，而**偏差**下降。
- en: 'The OLS estimate finds a place in the right side, away from the optimal trade-off
    point. This scenario necessitates the introduction of the regularization term
    and hence ridge regression becomes suitable choice of model:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: OLS估计在右侧找到一个位置，远离最佳权衡点。这种情况需要引入正则化项，因此岭回归成为合适的模型选择：
- en: '![Figure 4.15: Bias versus variance'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '![图4.15：偏差与方差'
- en: '](img/C12624_04_15.jpg)'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/C12624_04_15.jpg](img/C12624_04_15.jpg)'
- en: 'Figure 4.15: Bias versus variance'
  id: totrans-295
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.15：偏差与方差
- en: 'The OLS loss function for ridge regression could be represented by the following
    equation:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 岭回归的OLS损失函数可以表示为以下方程：
- en: '![](img/C12624_04_56.jpg)'
  id: totrans-297
  prefs: []
  type: TYPE_IMG
  zh: '![图片 C12624_04_56.jpg](img/C12624_04_56.jpg)'
- en: Minimizing the ![A drawing of a face
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 最小化![一张人脸的插图
- en: Description automatically generated](img/C12624_04_57.png) function with the
    regularization term that gives the ridge regression estimates. The interesting
    property of this loss function is that as ![](img/C12624_04_58.png) becomes larger,
    the variance decreases and the bias increases.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/C12624_04_57.png)函数具有提供岭回归估计的正则化项。这个损失函数的有趣特性是，当![img/C12624_04_58.png](img/C12624_04_58.png)变得更大时，方差减少，偏差增加。
- en: 'Exercise 56: Ridge Regression on the Beijing PM2.5 dataset'
  id: totrans-300
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习56：北京PM2.5数据集上的岭回归
- en: This exercise fits the ridge regression on the Beijing PM2.5 dataset. We will
    use `glmnet` library's cross-validation function `cv.glmnet()` with the parameter
    `alpha = 0` and varying lambda values. The aim is to obtain an optimal value for
    lambda that will be returned in the `lambda.min` attribute of the function output.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 这个练习在PM2.5数据集上拟合岭回归。我们将使用`glmnet`库的交叉验证函数`cv.glmnet()`，参数`alpha = 0`和变化的lambda值。目标是获得一个最佳的lambda值，它将被函数输出的`lambda.min`属性返回。
- en: 'Let''s perform the following steps to complete the exercise:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们执行以下步骤来完成练习：
- en: 'Load the `glmnet` library and preprocess the PM25 DataFrame:'
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载`glmnet`库并对PM25 DataFrame进行预处理：
- en: '[PRE44]'
  id: totrans-304
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Now, let''s use the following code to set up the `seed` to get similar results:'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下代码来设置`seed`以获得类似的结果：
- en: '[PRE45]'
  id: totrans-306
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'To find the optimal value of lambda after cross validation, execute the following
    command:'
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要在交叉验证后找到lambda的最佳值，请执行以下命令：
- en: '[PRE46]'
  id: totrans-308
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Coefficient values from the model fit:'
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型拟合的系数值：
- en: '[PRE47]'
  id: totrans-310
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'The output is as follows:'
  id: totrans-311
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE48]'
  id: totrans-312
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Use the `predict` function again and pass the matrix X to the `newx` parameter:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`predict`函数再次传递矩阵X到`newx`参数：
- en: '[PRE49]'
  id: totrans-314
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The output is as follows:'
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE50]'
  id: totrans-316
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: We see how ridge regression could be used to fit the Beijing PM2.5 dataset using
    the `glmnet` library.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到如何使用`glmnet`库来拟合北京PM2.5数据集。
- en: LASSO Regression
  id: totrans-318
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LASSO回归
- en: '**Least Absolute Shrinkage and Selection Operator** (**LASSO**) follows a similar
    structure to that of ridge regression, except for the penalty term, which in LASSO
    regression is L1 (sum of absolute values of the coefficient estimates) in contrast
    to ridge regression where it''s L2 (sum of squared coefficients):'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/C12624_04_59.jpg)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
- en: LASSO regression turns some coefficients to zero, thus the effect of a particular
    variable is nullified. This makes it efficient in feature selection while fitting
    data.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 57: LASSO Regression'
  id: totrans-322
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will apply LASSO regression on the Beijing PM2.5 dataset.
    We will use the same `cv.glmnet()` function to find the optimal lambda value.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
- en: 'First, let''s set up `seed` to get similar results using the following command:'
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE51]'
  id: totrans-326
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Now, use the following command to find the optimal value of lambda after cross
    validation:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE52]'
  id: totrans-328
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'Execute the following command to find the coefficient values from the model
    fit:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE53]'
  id: totrans-330
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'The output is as follows:'
  id: totrans-331
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE54]'
  id: totrans-332
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'Use the following command to find the prediction from the model:'
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE55]'
  id: totrans-334
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The output is as follows:'
  id: totrans-335
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE56]'
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Observe the similarity in the predictions of ridge and LASSO regression. The
    Beijing PM2.5 dataset doesn't show any difference in these two approaches.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
- en: Elastic Net Regression
  id: totrans-338
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Elastic Net** combines the penalty terms of ridge and LASSO regression to
    avoid the overdependence on data for variable selection (coefficient values tending
    to zero by which highly correlated variables are kept in check). Elastic Net minimizes
    the following loss function:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/C12624_04_60.jpg)'
  id: totrans-340
  prefs: []
  type: TYPE_IMG
- en: Where the parameter `α` controls the right mix between ridge and LASSO.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
- en: 'In summary, if a model has many predictor variables or correlated variables,
    introducing the regularization term helps in reducing the variance and increase
    bias optimally, thus bringing the right balance of model complexity and error.
    *Figure 4.16* provides a flow diagram to help one choose between multiple, ridge,
    LASSO, and elastic net regression:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.16: Selection criteria to choose between multiple, eidge, LASSO,
    and elastic net regression'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_16.jpg)'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.16: Selection criteria to choose between multiple, ridge, LASSO, and
    elastic net regression'
  id: totrans-345
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Exercise 58: Elastic Net Regression'
  id: totrans-346
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will perform elastic net regression on the Beijing PM2.5
    dataset.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s first set up `seed` to get similar results using the following command:'
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE57]'
  id: totrans-350
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'Now, use the following command to find the optimal value of lambda after cross
    validation:'
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE58]'
  id: totrans-352
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Next, execute the following command to find the coefficient values from the
    model fit:'
  id: totrans-353
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE59]'
  id: totrans-354
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'The output is as follows:'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE60]'
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Use the following command to find the prediction from the model:'
  id: totrans-357
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE61]'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'The output is as follows:'
  id: totrans-359
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE62]'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Elastic Net Regression gives more or less the same predictions as of ridge and
    LASSO regression. In the next section, we compare all three together.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
- en: Comparison between Coefficients and Residual Standard Error
  id: totrans-362
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following tables show the comparison of `DEWP`, `TEMP`, and `Iws`), there
    isn''t much difference in the values, which suggests that ridge, LASSO, and elastic
    net regression with regularization terms are not any better than multiple linear
    regression approach. This also suggests that `DEWP`, `TEMP`, and `Iws` are independent
    variables with low or no correlations:'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.17: Comparison of residual standard error between linear, ridge,
    LASSO, and elastic net regression'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_17.jpg)'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.17: Comparison of residual standard error between linear, ridge, LASSO,
    and elastic net regression'
  id: totrans-366
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'The following figure shows a comparison of the coefficient values of intercept
    and DEWP, TEMP and Iws variables using Linear, Ridge, LASSO and Elastic net regression:'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.18: Comparison of coefficient values between Linear, Ridge, LASSO,
    and Elastic Net regression'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_18.jpg)'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.18: Comparison of coefficient values between Linear, Ridge, LASSO,
    and Elastic Net regression'
  id: totrans-370
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Exercise 59: Computing the RSE of Linear, Ridge, LASSO, and Elastic Net Regressions'
  id: totrans-371
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will compute the RSE of Linear, Ridge, LASSO, and Elastic
    Net regressions.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following code to fit a linear model using the `Iws`, `DEWP`, and `TEMP`
    variables:'
  id: totrans-374
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE63]'
  id: totrans-375
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Now, use the following command for finding the **Residual Standard Error**
    (**RSE**) of linear regression:'
  id: totrans-376
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE64]'
  id: totrans-377
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The output is as follows:'
  id: totrans-378
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE65]'
  id: totrans-379
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Similarly, we will find the RSE of the remaining regression.
  id: totrans-380
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'RSE of ridge regression:'
  id: totrans-381
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE66]'
  id: totrans-382
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'The output is as follows:'
  id: totrans-383
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE67]'
  id: totrans-384
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'RSE of LASSO regression:'
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE68]'
  id: totrans-386
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'The output is as follows:'
  id: totrans-387
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE69]'
  id: totrans-388
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'RSE of Elastic Net regression:'
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE70]'
  id: totrans-390
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'The output is as follows:'
  id: totrans-391
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE71]'
  id: totrans-392
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: This shows that the RSE for all three isn't significantly different.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
- en: Poisson Regression
  id: totrans-394
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In linear regression, we saw an equation of the form:'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/C12624_04_61.jpg)'
  id: totrans-396
  prefs: []
  type: TYPE_IMG
- en: In `Y` is a count or rate (`Y/t`) that has a **Poisson distribution** with expected
    (mean) count of ![](img/C12624_04_62.png) as ![](img/C12624_04_63.png), which
    is equal to variance.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
- en: In case of logistic regression, we would probe for values that can maximize
    log-likelihood to get the **maximum likelihood estimators** (**MLEs**) for coefficients.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
- en: There are no closed-form solutions, hence the estimations of maximum likelihood
    would be obtained using iterative algorithms such as **Newton-Raphson** and **Iteratively
    re-weighted least squares** (**IRWLS**).
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
- en: 'Poisson regression is suitable for the count-dependent variable, which must
    meet the following guidelines:'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
- en: It follows a Poisson distribution
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Counts are not negative
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Values are whole numbers (no fractions)
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  id: totrans-404
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The dataset used here to demonstrate Poisson regression comes from A. Colin
    Cameron and Per Johansson, "*Count Data Regression Using Series Expansion: With
    Applications*", Journal of Applied Econometrics, Vol. 12, No. 3, 1997, pp. 203-224.'
  id: totrans-405
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'The following table succinctly describes the variables:'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.19: Variables and its description from an Australian Health Survey
    dataset'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_19.jpg)'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.19: Variables and its description from an Australian Health Survey
    dataset'
  id: totrans-409
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Note
  id: totrans-410
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The blog [http://www.econ.uiuc.edu/~econ508/Stata/e-ta16_Stata.html](http://www.econ.uiuc.edu/~econ508/Stata/e-ta16_Stata.html)
    demonstrates the usage of the dataset.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 60: Performing Poisson Regression'
  id: totrans-412
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will perform Poisson regression on the dataset.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
- en: 'Carry out Poisson regression load the library `foreign` to read `dta` data:'
  id: totrans-415
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE72]'
  id: totrans-416
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Using the `read.data` function from the `foreign` library to read the Australian
    health survey dataset:'
  id: totrans-417
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE73]'
  id: totrans-418
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'Fit a generalized linear model using the `glm()` function with Poisson regression
    as the value in the family parameter:'
  id: totrans-419
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE74]'
  id: totrans-420
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Print the summary of the model:'
  id: totrans-421
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE75]'
  id: totrans-422
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'The output is as follows:'
  id: totrans-423
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE76]'
  id: totrans-424
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Load the `ggplot2` library:'
  id: totrans-425
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE77]'
  id: totrans-426
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'Combine the actual values of `NONDOCCO` and Poisson regression-fitted values
    of `NONDOCCO`:'
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE78]'
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'Name the columns:'
  id: totrans-429
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE79]'
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'Plot the actual versus predicted values of the `NONDOCCO` target variable:'
  id: totrans-431
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE80]'
  id: totrans-432
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'The output plot is as follows:'
  id: totrans-433
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.20: Comparing actual and predicted values of NONDOCCO'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_20.jpg)'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.20: Comparing actual and predicted values of NONDOCCO'
  id: totrans-436
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Given the value of the residual deviance statistic of 5052.5 with 5178 degree
    of freedom, the p-value is zero and the *5052.5/5178 = 0.975* is less than 1,
    so the model does to a certain level. We can also check overdispersion (presence
    of greater variability in a dataset than would be expected based on a given statistical
    model). Overdispersion is computed by dividing `sample_variance` with `sample_mean`.
    Let's examine the following exercise.
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 61: Computing Overdispersion'
  id: totrans-438
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will perform computing overdispersion on the dataset.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
- en: 'First, let''s find the sample mean using the following command:'
  id: totrans-441
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE81]'
  id: totrans-442
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'The output is as follows:'
  id: totrans-443
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE82]'
  id: totrans-444
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'Now, use the following command for finding the sample variance:'
  id: totrans-445
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE83]'
  id: totrans-446
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'The output is as follows:'
  id: totrans-447
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE84]'
  id: totrans-448
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'Similarly, overdispersion can be computed using the following command:'
  id: totrans-449
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE85]'
  id: totrans-450
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'The output is as follows:'
  id: totrans-451
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE86]'
  id: totrans-452
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE86]'
- en: So, even if we try adding predictor variables to model fit, overdispersion starts
    to go down. In our example, the dispersion is well within limits.
  id: totrans-453
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, let''s calculate the dispersion using the following command:'
  id: totrans-454
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE87]'
  id: totrans-455
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'The output is as follows:'
  id: totrans-456
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE88]'
  id: totrans-457
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE88]'
- en: However, in cases where dispersion is over the limit, a higher order Poisson
    regression is a suitable solution. Keeping the scope of this book in mind, we
    will not delve into such model in detail here. Interested readers could read more
    on Baseline Density Poisson (**Poisson Polynomial of order p** (**PPp**) models).
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
- en: Cox Proportional-Hazards Regression Model
  id: totrans-459
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The basis for the Cox regression models comes from the survival analysis, a
    set of statistical methods helpful in investigating the time it takes for an event
    to occur. Some examples are as follows:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
- en: Time until a lead is converted to sales
  id: totrans-461
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time until a product failure from the start of usage
  id: totrans-462
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time after the start of the insurance policy until death
  id: totrans-463
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time after diagnosing until death
  id: totrans-464
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time until a warranty is claimed for a product
  id: totrans-465
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time from customer registration
  id: totrans-466
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'All these examples are some of the use cases of survival analysis. In most
    of the survival analysis, there are three wide-spread methods used for carrying
    out such time-to-event analysis:'
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
- en: Kaplan-Meier survival curves for analysis of different groups
  id: totrans-468
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The logrank test for comparing two or more survival curves
  id: totrans-469
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cox proportional hazards regression to describe the effect of variables on survival
  id: totrans-470
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keeping in mind the scope of this chapter and book, we will focus only on the
    Cox proportional hazards regression. The fundamental idea is that the first two
    methods only help in performing univariate analysis, in other words, you can understand
    the effect of only one factor on the time-to-event, whereas Cox regression helps
    in assessing the effect of multiple factors on the survival time. Also, Cox regression
    works equally good with both categorical and numeric factors, while the first
    two methods only work with categorical factors.
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
- en: 'The Cox model is expressed by the hazard function denoted by `h(t)`, which
    represents in the medical research, where its predominately used, the risk of
    dying at time `t`:'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/C12624_04_64.jpg)'
  id: totrans-473
  prefs: []
  type: TYPE_IMG
- en: 'Some observations from this equation are as follows:'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
- en: '`t` denotes the survival time.'
  id: totrans-475
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`h(t)` represents the hazard function determined by the `p` covariates ![](img/C12624_04_65.png).
    Covariates is the term used for describing predictor variables in survival analysis.'
  id: totrans-476
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The coefficients ![](img/C12624_04_66.png) suggest the impact of covariates.
  id: totrans-477
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The term ![](img/C12624_04_67.png) is called the baseline hazard at time t.
    If all the coefficients are zero ![](img/C12624_04_68.png), ![](img/C12624_04_69.png)
    becomes the value of the hazard function.
  id: totrans-478
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This function looks somewhat relatable to logistic regression (uses an exponential
    term), which will be discussed in detail in *Chapter 5*, *Classification*. We
    have logically split all the supervised learning algorithms discussed in this
    book into `yes/no`, `1/0`) but disregards the timing of events.
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
- en: 'As you may have observed from the hazard function, survival models comprise
    of:'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
- en: A continuous variable demonstrative of the time to event
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A binary variable illustrative of the status whether event happened or not
  id: totrans-482
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: NCCTG Lung Cancer Data
  id: totrans-483
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**NCCTG Lung Cancer Data** from survival in patients with advanced lung cancer
    is from the *North Central Cancer Treatment Group*. The data is a collection of
    few metadata, such as which institution collected it, age of the patient, sex,
    and so on. The performance scores in this dataset rates how well the patient can
    perform the daily activities. The most important variable in any survival analysis
    dataset is the *knowledge* about the **time-to-event**, for example, time until
    death.'
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
- en: Survival analysis is usually defined as a set of methods for examining data
    where the outcome variable is the time till the incidence of an event of interest.
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.21: Variables and its descriptions of North Central Cancer Treatment
    Group'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
- en: '](img/C12624_04_21.jpg)'
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 4.21: Variables and its descriptions of North Central Cancer Treatment
    Group'
  id: totrans-488
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: In the next exercise, we will learn how to create the survival object using
    the method `Surv` from the `survival` package. Note that in the summary of the
    dataset after adding the survival object, two additional variables `SurvObject.time`
    and `SurvObject.status` are created, which stores the information about time-to-event
    (time until death), which then becomes the dependent variable for the **Cox Proportional-Hazards
    Regression Model**.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
- en: Observations are **censored** when there is a scarce number of indications around
    a patient's survival time. Popularly, the most prevalent form is right censoring.
    Let's assume that we are following a study for 20 weeks. A patient not going through
    the event of interest during the study can be called as right censored. The person's
    survival time is at least the duration of the study; in this case, 20 weeks.
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
- en: 'Exercise 62: Exploring the NCCTG Lung Cancer Data Using Cox-Regression'
  id: totrans-491
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this exercise, we will explore the NCCTG Lung Cancer Data using Cox-Regression.
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to complete the exercise:'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
- en: 'Import the `survival` library:'
  id: totrans-494
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE89]'
  id: totrans-495
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Import the Lung Cancer Data:'
  id: totrans-496
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE90]'
  id: totrans-497
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'Print the dataset using the `head` function:'
  id: totrans-498
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE91]'
  id: totrans-499
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'The output is as follows:'
  id: totrans-500
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE92]'
  id: totrans-501
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'Lung Cancer Data where `status == 2` represents death:'
  id: totrans-502
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE93]'
  id: totrans-503
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'Find the Cox Proportional Hazards Regression model:'
  id: totrans-504
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE94]'
  id: totrans-505
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'The output is as follows:'
  id: totrans-506
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE95]'
  id: totrans-507
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE95]'
- en: This exercise demonstrates the Cox proportional hazards regression model using
    the survival library.
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-509
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, we discussed linear regression in more detail after a brief
    introduction in the previous chapter. Certainly, the discussion on linear regression
    led to a series of diagnostics that gave directions to discussing other type of
    regression algorithms. Quantile, polynomial, ridge, LASSO, and elastic net, all
    of these are derived from linear regression, with the differences coming from
    the fact that there are some limitations in linear regression that each of these
    algorithms helped overcome. Poisson and Cox proportional hazards regression model
    came out as a special case of regression algorithms that work with count and time-to-event
    dependent variables, respectively, unlike the others that work with any quantitative
    dependent variable.
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will explore the second most commonly applied machine
    learning algorithm and solve problems associated with it. You will also learn
    more about classification in detail. *Chapter 5*, *Classification*, similar to
    this chapter, is designed to cover classification algorithms ranging from **Decision
    Trees** to **Deep Neural Network** in detail.
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
