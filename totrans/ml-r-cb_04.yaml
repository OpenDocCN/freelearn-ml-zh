- en: Chapter 4. Understanding Regression Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第4章 理解回归分析
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍以下食谱：
- en: Fitting a linear regression model with lm
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用lm函数拟合线性回归模型
- en: Summarizing linear model fits
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总结线性模型拟合结果
- en: Using linear regression to predict unknown values
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用线性回归预测未知值
- en: Generating a diagnostic plot of a fitted model
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成拟合模型的诊断图
- en: Fitting a polynomial regression model with lm
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用lm函数拟合多项式回归模型
- en: Fitting a robust linear regression model with rlm
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用rlm函数拟合稳健线性回归模型
- en: Studying a case of linear regression on SLID data
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 研究SLID数据上的线性回归案例
- en: Applying the Gaussian model for generalized linear regression
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用高斯模型进行广义线性回归
- en: Applying the Poisson model for generalized linear regression
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用泊松模型进行广义线性回归
- en: Applying the Binomial model for generalized linear regression
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用二项式模型进行广义线性回归
- en: Fitting a generalized additive model to data
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将广义加性模型拟合到数据中
- en: Visualizing a generalized additive model
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化广义加性模型
- en: Diagnosing a generalized additive model
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 诊断广义加性模型
- en: Introduction
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: Regression is a supervised learning method, which is employed to model and analyze
    the relationship between a dependent (response) variable and one or more independent
    (predictor) variables. One can use regression to build a prediction model, which
    can first be used to find the best fitted model with minimum squared errors of
    the fitted values. The fitted model can then be further applied to data for continuous
    value predictions.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 回归是一种监督学习方法，用于建模和分析一个因变量（响应变量）与一个或多个自变量（预测变量）之间的关系。可以使用回归来构建预测模型，首先用于找到具有最小拟合值平方误差的最佳拟合模型。然后可以将拟合模型进一步应用于数据进行连续值预测。
- en: There are many types of regression. If there is only one predictor variable,
    and the relationship between the response variable and independent variable is
    linear, we can apply a linear model. However, if there is more than one predictor
    variable, a multiple linear regression method should be used. When the relationship
    is nonlinear, one can use a nonlinear model to model the relationship between
    the predictor and response variables.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多种类的回归。如果只有一个预测变量，响应变量和独立变量之间的关系是线性的，我们可以应用线性模型。然而，如果有多个预测变量，应使用多重线性回归方法。当关系是非线性的，可以使用非线性模型来模拟预测变量和响应变量之间的关系。
- en: In this chapter, we introduce how to fit a linear model into data with the `lm`
    function. Next, for distribution in other than the normal Gaussian model (for
    example, Poisson or Binomial), we use the `glm` function with an appropriate link
    function correspondent to the data distribution. Finally, we cover how to fit
    a generalized additive model into data using the `gam` function.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍如何使用`lm`函数将线性模型拟合到数据中。接下来，对于非正态高斯模型（例如泊松或二项式）的分布，我们使用带有适当对应数据分布的链接函数的`glm`函数。最后，我们介绍如何使用`gam`函数将广义加性模型拟合到数据中。
- en: Fitting a linear regression model with lm
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用lm函数拟合线性回归模型
- en: The simplest model in regression is linear regression, which is best used when
    there is only one predictor variable, and the relationship between the response
    variable and the independent variable is linear. In R, we can fit a linear model
    to data with the `lm` function.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 回归中最简单的模型是线性回归，当只有一个预测变量，响应变量和独立变量之间的关系是线性的时，最适合使用。在R中，我们可以使用`lm`函数将线性模型拟合到数据中。
- en: Getting ready
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We need to prepare data with one predictor and response variable, and with a
    linear relationship between the two variables.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要准备一个预测变量和一个响应变量，以及两个变量之间的线性关系的数据。
- en: How to do it...
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Perform the following steps to perform linear regression with `lm`:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以使用`lm`进行线性回归：
- en: 'You should install the `car` package and load its library:'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该安装`car`包并加载其库：
- en: '[PRE0]'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'From the package, you can load the `Quartet` dataset:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从包中，您可以加载`Quartet`数据集：
- en: '[PRE1]'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You can use the `str` function to display the structure of the `Quartet` dataset:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以使用`str`函数来显示`Quartet`数据集的结构：
- en: '[PRE2]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Draw a scatter plot of the x and y variables with `plot`, and append a fitted
    line through the `lm` and `abline` function:'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`plot`函数绘制x和y变量的散点图，并通过`lm`和`abline`函数添加拟合线：
- en: '[PRE3]'
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![How to do it...](img/00078.jpeg)'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00078.jpeg)'
- en: A simple regression plot fitted by lm
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用lm拟合的简单回归图
- en: 'To view the fit model, execute the following:'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看拟合模型，执行以下操作：
- en: '[PRE4]'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: How it works...
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The regression model has the `response ~ terms` form, where `response` is the
    response vector, and `terms` is a series of terms that specifies a predictor.
    We can illustrate a simple regression model in the formula *y=α+βx*, where *α*
    is the intercept while the slope, *β*, describes the change in *y* when *x* changes.
    By using the least squares method, we can estimate ![How it works...](img/00079.jpeg)
    and ![How it works...](img/00080.jpeg) (where ![How it works...](img/00081.jpeg)
    indicates the mean value of *y* and ![How it works...](img/00082.jpeg) denotes
    the mean value of *x*).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 回归模型具有`response ~ terms`形式，其中`response`是响应向量，`terms`是一系列指定预测器的项。我们可以用一个简单的回归模型公式*y=α+βx*来表示，其中*α*是截距，而斜率*β*描述了*x*变化时*y*的变化。通过使用最小二乘法，我们可以估计![如何工作...](img/00079.jpeg)和![如何工作...](img/00080.jpeg)（其中![如何工作...](img/00081.jpeg)表示*y*的平均值，![如何工作...](img/00082.jpeg)表示*x*的平均值）。
- en: To perform linear regression, we first prepare the data that has a linear relationship
    between the predictor variable and response variable. In this example, we load
    Anscombe's quartet dataset from the package car. Within the dataset, the *x* and
    *y1* variables have a linear relationship, and we prepare a scatter plot of these
    variables. To generate the regression line, we use the lm function to generate
    a model of the two variables. Further, we use `abline` to plot a regression line
    on the plot. As per the previous screenshot, the regression line illustrates the
    linear relationship of *x* and *y1* variables. We can see that the coefficient
    of the fitted model shows the intercept equals 3.0001 and coefficient equals 0.5001\.
    As a result, we can use the intercept and coefficient to infer the response value.
    For example, we can infer the response value when *x* at 3 is equal to *4.5103
    (3 * 0.5001 + 3.0001)*.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行线性回归，我们首先准备具有预测变量和响应变量之间线性关系的资料。在这个例子中，我们从car包中加载了Anscombe的四重奏数据集。在数据集中，*x*和*y1*变量之间存在线性关系，我们为这些变量准备了一个散点图。为了生成回归线，我们使用lm函数生成两个变量的模型。进一步，我们使用`abline`在图上绘制回归线。根据前面的截图，回归线说明了*x*和*y1*变量的线性关系。我们可以看到，拟合模型的系数显示了截距等于3.0001，系数等于0.5001。因此，我们可以使用截距和系数来推断响应值。例如，我们可以推断当*x*等于3时的响应值等于4.5103（3
    * 0.5001 + 3.0001）。
- en: There's more...
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Besides the `lm` function, you can also use the `lsfit` function to perform
    simple linear regression. For example:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 除了`lm`函数外，您还可以使用`lsfit`函数执行简单线性回归。例如：
- en: '[PRE5]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![There''s more...](img/00083.jpeg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/00083.jpeg)'
- en: A simple regression fitted by the lsfit function.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 使用lsfit函数拟合的简单回归。
- en: Summarizing linear model fits
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结线性模型拟合
- en: The `summary` function can be used to obtain the formatted coefficient, standard
    errors, degree of freedom, and other summarized information of a fitted model.
    This recipe introduces how to obtain overall information on a model through the
    use of the `summary` function.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '`summary`函数可以用来获取拟合模型的格式化系数、标准误差、自由度和其他总结信息。本食谱介绍了如何通过使用`summary`函数来获取模型的整体信息。'
- en: Getting ready
  id: totrans-47
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You need to have completed the previous recipe by computing the linear model
    of the *x* and *y1* variables from the quartet, and have the fitted model assigned
    to the `lmfit` variable.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要完成之前的食谱，通过从四重奏中计算*x*和*y1*变量的线性模型，并将拟合模型分配给`lmfit`变量。
- en: How to do it...
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Perform the following step to summarize linear model fits:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以总结线性模型拟合：
- en: 'Compute a detailed summary of the fitted model:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算拟合模型的详细总结：
- en: '[PRE6]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: How it works...
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作...
- en: The `summary` function is a generic function used to produce summary statistics.
    In this case, it computes and returns a list of the summary statistics of the
    fitted linear model. Here, it will output information such as residuals, coefficient
    standard error R-squared, f-statistic, and a degree of freedom. In the `Call`
    section, the function called to generate the fitted model is displayed. In the
    `Residuals` section, it provides a quick summary (min, 1Q, median, 3Q, max) of
    the distribution.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '`summary`函数是一个通用函数，用于生成总结统计量。在这种情况下，它计算并返回拟合线性模型的总结统计量列表。这里，它将输出诸如残差、系数标准误差、R平方、f统计量和自由度等信息。在`Call`部分，显示了用于生成拟合模型的函数。在`Residuals`部分，它提供了分布的快速总结（最小值、1Q、中位数、3Q、最大值）。'
- en: In the `Coefficients` section, each coefficient is a Gaussian random variable.
    Within this section, `Estimate` represents the mean distribution of the variable;
    `Std.Error` displays the standard error of the variable; the `t` value is `Estimate`
    divided by `Std.Error` and the `p` value indicates the probability of getting
    a value larger than the `t` value. In this sample, the `p` value of both intercepts
    (0.002573) and x (0.00217) have a 95 percent level of confidence.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `系数` 部分，每个系数都是一个高斯随机变量。在此部分中，`估计值` 代表变量的均值分布；`标准误差` 显示变量的标准误差；`t` 值是 `估计值`
    除以 `标准误差`，而 `p` 值表示得到大于 `t` 值的概率。在此样本中，截距（0.002573）和 `x`（0.00217）的 `p` 值都有 95%
    的置信水平。
- en: Residual standard error outputs the standard deviation of residuals, while the
    degree of freedom indicates the differences between the observation in training
    samples and the number used in the model. Multiple R-squared is obtained by dividing
    the sum of squares. One can use R-squared to measure how close the data is to
    fit into the regression line. Mostly, the higher the R-squared, the better the
    model fits your data. However, it does not necessarily indicate whether the regression
    model is adequate. This means you might get a good model with a low R-squared
    or you can have a bad model with a high R-squared. Since multiple R-squared ignore
    a degree of freedom, the calculated score is biased. To make the calculation fair,
    an adjusted R-squared (0.6295) uses an unbiased estimate, and will be slightly
    less than multiple R-squared (0.6665). F-statistic is retrieved by performing
    an f-test on the model. A `p` value equal to 0.00217 (< 0.05) rejects the null
    hypothesis (no linear correlation between variables) and indicates that the observed
    `F` is greater than the critical `F` value. In other words, the result shows that
    there is a significant positive linear correlation between the variables.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 残差标准误差输出残差的方差，而自由度表示训练样本中的观测值与模型中使用的数量之间的差异。多重判定系数是通过除以平方和得到的。一个人可以使用判定系数来衡量数据与回归线拟合的接近程度。通常，判定系数越高，模型与数据的拟合度越好。然而，这并不一定意味着回归模型是充分的。这意味着您可能得到一个低判定系数的好模型，或者您可能得到一个高判定系数的差模型。由于多重判定系数忽略了自由度，计算出的分数是有偏的。为了使计算公平，调整判定系数（0.6295）使用无偏估计，并将略低于多重判定系数（0.6665）。F
    统计量是通过在模型上执行 f 检验得到的。一个等于 0.00217（< 0.05）的 `p` 值拒绝零假设（变量之间没有线性相关性）并表明观察到的 `F`
    值大于临界 `F` 值。换句话说，结果表明变量之间存在显著的线性正相关。
- en: See also
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关阅读
- en: 'For more information on the parameters used for obtaining a summary of the
    fitted model, you can use the `help` function or `?` to view the help page:'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要获取拟合模型参数的更多信息，您可以使用 `help` 函数或 `?` 来查看帮助页面：
- en: '[PRE7]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Alternatively, you can use the following functions to display the properties
    of the model:'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 或者，您可以使用以下函数来显示模型的属性：
- en: '[PRE8]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Using linear regression to predict unknown values
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用线性回归预测未知值
- en: With a fitted regression model, we can apply the model to predict unknown values.
    For regression models, we can express the precision of prediction with a prediction
    interval and a confidence interval. In the following recipe, we introduce how
    to predict unknown values under these two measurements.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 使用拟合的回归模型，我们可以将模型应用于预测未知值。对于回归模型，我们可以使用预测区间和置信区间来表示预测的精度。在下面的配方中，我们介绍如何在两种测量下预测未知值。
- en: Getting ready
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You need to have completed the previous recipe by computing the linear model
    of the x and y1 variables from the `quartet` dataset.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要完成上一个配方，通过从 `quartet` 数据集中计算 `x` 和 `y1` 变量的线性模型来完成。
- en: How to do it...
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to predict values with linear regression:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 按以下步骤使用线性回归预测值：
- en: 'Fit a linear model with the `x` and `y1` variables:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `x` 和 `y1` 变量拟合线性模型：
- en: '[PRE9]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Assign values to be predicted into `newdata`:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将要预测的值分配到 `newdata`：
- en: '[PRE10]'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Compute the prediction result using the confidence interval with `level` set
    as `0.95`:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用置信水平设置为 `0.95` 的置信区间来计算预测结果：
- en: '[PRE11]'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Compute the prediction result using this prediction interval:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用此预测区间来计算预测结果：
- en: '[PRE12]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: How it works...
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: We first build a linear fitted model with `x` and `y1` variables. Next, we assign
    values to be predicted into a data frame, `newdata`. It is important to note that
    the generated model is in the form of `y1 ~ x`.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先使用 `x` 和 `y1` 变量构建一个线性拟合模型。接下来，我们将要预测的值分配到一个数据框 `newdata` 中。重要的是要注意，生成的模型形式为
    `y1 ~ x`。
- en: Next, we compute the prediction result using a confidence interval by specifying
    `confidence` in the argument interval. From the output of row 1, we get fitted
    `y1` of the `x=3` input, which equals to `4.500364`, and a 95 percent confidence
    interval (set 0.95 in the `level` argument) of the `y1` mean for `x=3` is between
    `2.691375` and `6.309352`. In addition to this, row 2 and 3 give the prediction
    result of `y1` with an input of `x=6` and `x=15`.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过在`interval`参数中指定`confidence`来使用置信区间计算预测结果。从第1行的输出中，我们得到`x=3`输入的拟合`y1`等于`4.500364`，以及`x=3`的`y1`均值的95%置信区间（在`level`参数中设置为0.95）介于`2.691375`和`6.309352`之间。此外，第2行和第3行给出了`x=6`和`x=15`输入的`y1`预测结果。
- en: Next, we compute the prediction result using a prediction interval by specifying
    `prediction` in the argument interval. From the output of row 1, we can see fitted
    `y1` of the `x=3` input equals to `4.500364`, and a 95 percent prediction interval
    of `y1` for `x=3` is between `1.169022` and `7.831705`. Row 2 and 3 output the
    prediction result of `y1` with an input of `x=6` and `x=15`.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过在`interval`参数中指定`prediction`来使用预测区间计算预测结果。从第1行的输出中，我们可以看到`x=3`输入的拟合`y1`等于`4.500364`，以及`x=3`的`y1`的95%预测区间介于`1.169022`和`7.831705`之间。第2行和第3行输出了`x=6`和`x=15`输入的`y1`预测结果。
- en: See also
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考以下内容
- en: For those who are interested in the differences between prediction intervals
    and confidence intervals, you can refer to the Wikipedia entry *contrast with
    confidence intervals* at [http://en.wikipedia.org/wiki/Prediction_interval#Contrast_with_confidence_intervals](http://en.wikipedia.org/wiki/Prediction_interval#Contrast_with_confidence_intervals).
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于对预测区间和置信区间之间的差异感兴趣的人，您可以参考维基百科条目*与置信区间的对比*，网址为[http://en.wikipedia.org/wiki/Prediction_interval#Contrast_with_confidence_intervals](http://en.wikipedia.org/wiki/Prediction_interval#Contrast_with_confidence_intervals)。
- en: Generating a diagnostic plot of a fitted model
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 生成拟合模型的诊断图
- en: Diagnostics are methods to evaluate assumptions of the regression, which can
    be used to determine whether a fitted model adequately represents the data. In
    the following recipe, we introduce how to diagnose a regression model through
    the use of a diagnostic plot.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 诊断是评估回归假设的方法，可用于确定拟合模型是否充分代表数据。在以下菜谱中，我们介绍如何通过使用诊断图来诊断回归模型。
- en: Getting ready
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You need to have completed the previous recipe by computing a linear model of
    the x and y1 variables from the quartet, and have the model assigned to the `lmfit`
    variable.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要通过从四元组中计算x和y1变量的线性模型来完成前面的菜谱，并将模型分配给`lmfit`变量。
- en: How to do it...
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following step to generate a diagnostic plot of the fitted model:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以生成拟合模型的诊断图：
- en: 'Plot the diagnostic plot of the regression model:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制回归模型的诊断图：
- en: '[PRE13]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![How to do it...](img/00084.jpeg)'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00084.jpeg)'
- en: Diagnostic plots of the regression model
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 回归模型的诊断图
- en: How it works...
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'The plot function generates four diagnostic plots of a regression model:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 绘图函数生成回归模型的四个诊断图：
- en: The upper-left plot shows residuals versus fitted values. Within the plot, residuals
    represent the vertical distance from a point to the regression line. If all points
    fall exactly on the regression line, all residuals will fall exactly on the dotted
    gray line. The red line within the plot is a smooth curve with regard to residuals,
    and if all the dots fall exactly on the regression line, the position of the red
    line should exactly match the dotted gray line.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 左上角的图显示了残差与拟合值之间的关系。在图中，残差代表一个点到回归线的垂直距离。如果所有点都正好落在回归线上，所有残差都将正好落在虚线灰线上。图中的红色线是关于残差的光滑曲线，如果所有点都正好落在回归线上，红色线的位置应该正好与虚线灰线相匹配。
- en: The upper-right shows the normal of residuals. This plot verifies the assumption
    that residuals were normally distributed. Thus, if the residuals were normally
    distributed, they should lie exactly on the gray dash line.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 右上角显示了残差的正态分布。此图验证了残差正态分布的假设。因此，如果残差是正态分布的，它们应该正好位于灰色虚线上。
- en: The **Scale-Location** plot on the bottom-left is used to measure the square
    root of the standardized residuals against the fitted value. Therefore, if all
    dots lie on the regression line, the value of *y* should be close to zero. Since
    it is assumed that the variance of residuals does not change the distribution
    substantially, if the assumption is correct, the red line should be relatively
    flat.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 左下角的**尺度-位置**图用于测量标准化残差的平方根与拟合值之间的关系。因此，如果所有点都位于回归线上，则`y`的值应该接近零。由于假设残差的方差不会显著改变分布，如果假设正确，红色线应该相对平坦。
- en: The bottom-right plot shows standardized residuals versus leverage. The leverage
    is a measurement of how each data point influences the regression. It is a measurement
    of the distance from the centroid of regression and level of isolation (measured
    by whether it has neighbors). Also, you can find the contour of Cook's distance,
    which is affected by high leverage and large residuals. You can use this to measure
    how regression would change if a single point is deleted. The red line is smooth
    with regard to standardized residuals. For a perfect fit regression, the red line
    should be close to the dashed line with no points over 0.5 in Cook's distance.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 右下角的图显示了标准化残差与杠杆作用的关系。杠杆作用是衡量每个数据点如何影响回归的度量。它是回归质心距离和隔离程度的度量（通过是否有邻居来衡量）。此外，您还可以找到受高杠杆和大量残差影响的Cook距离的轮廓。您可以使用此方法来衡量如果删除一个点，回归将如何改变。红色线在标准化残差方面很平滑。对于完美的拟合回归，红色线应该接近虚线，Cook距离没有超过0.5的点。
- en: There's more...
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To see more of the diagnostic plot function, you can use the `help` function
    to access further information:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看更多的诊断图功能，可以使用`help`函数获取更多信息：
- en: '[PRE14]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'In order to discover whether there are points with large Cook''s distance,
    one can use the `cooks.distance` function to compute the Cook''s distance of each
    point, and analyze the distribution of distance through visualization:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 为了发现是否存在具有大Cook距离的点，可以使用`cooks.distance`函数计算每个点的Cook距离，并通过可视化分析距离的分布：
- en: '[PRE15]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![There''s more...](img/00085.jpeg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/00085.jpeg)'
- en: A plot of Cook's distance
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: Cook距离图
- en: In this case, where the point on index 3 shows greater Cook's distance than
    other points, one can investigate whether this point might be an outlier.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，如果索引为3的点显示的Cook距离大于其他点，可以调查这个点是否可能是异常值。
- en: Fitting a polynomial regression model with lm
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用lm拟合多项式回归模型
- en: Some predictor variables and response variables may have a non-linear relationship,
    and their relationship can be modeled as an *nth* order polynomial. In this recipe,
    we introduce how to deal with polynomial regression using the `lm` and `poly`
    functions.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 一些预测变量和响应变量可能存在非线性关系，它们的关系可以建模为`n`次多项式。在这个菜谱中，我们将介绍如何使用`lm`和`poly`函数处理多项式回归。
- en: Getting ready
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Prepare the dataset that includes a relationship between the predictor and response
    variable that can be modeled as an *nth* order polynomial. In this recipe, we
    will continue to use the `Quartet` dataset from the `car` package.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 准备包含可以建模为`n`次多项式的预测变量和响应变量之间关系的数据库。在这个菜谱中，我们将继续使用`car`包中的`Quartet`数据库。
- en: How to do it...
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to fit the polynomial regression model with `lm`:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以使用`lm`拟合多项式回归模型：
- en: 'First, we make a scatter plot of the `x` and `y2` variables:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们绘制`x`和`y2`变量的散点图：
- en: '[PRE16]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![How to do it...](img/00086.jpeg)'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00086.jpeg)'
- en: Scatter plot of variables x and y2
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 变量x和y2的散点图
- en: 'You can apply the `poly` function by specifying `2` in the argument:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以通过指定参数中的`2`来应用`poly`函数：
- en: '[PRE17]'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![How to do it...](img/00087.jpeg)'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00087.jpeg)'
- en: A quardratic fit example of the regression plot of variables x and y2
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 变量x和y2的回归图的一个二次拟合示例
- en: How it works
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理
- en: We can illustrate the second order polynomial regression model in formula, ![How
    it works](img/00088.jpeg), where *α* is the intercept while *β*, illustrates regression
    coefficients.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在公式![工作原理](img/00088.jpeg)中说明二次多项式回归模型，其中*α*是截距，而*β*表示回归系数。
- en: In the preceding screenshot (step 1), the scatter plot of the `x` and `y2` variables
    does not fit in a linear relationship, but shows a concave downward curve (or
    convex upward) with the turning point at x=11\. In order to model the nonlinear
    relationship, we apply the `poly` function with an argument of 2 to fit the independent
    `x` variable and the dependent `y2` variable. The red line in the screenshot shows
    that the model perfectly fits the data.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图（步骤1）中，`x`和`y2`变量的散点图不呈线性关系，而是显示一个向下凹的曲线（或向上凸）的形状，转折点在x=11。为了建模非线性关系，我们使用带有2作为参数的`poly`函数来拟合独立的`x`变量和依赖的`y2`变量。截图中的红线显示模型完美地拟合了数据。
- en: There's more...
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多...
- en: 'You can also fit a second order polynomial model with an independent variable
    equal to the formula of the combined first order `x` variable and the second order
    `x` variable:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用一个独立变量等于一阶`x`变量和二阶`x`变量公式的二阶多项式模型：
- en: '[PRE18]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Fitting a robust linear regression model with rlm
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用rlm拟合稳健线性回归模型
- en: An outlier in the dataset will move the regression line away from the mainstream.
    Apart from removing it, we can apply a robust linear regression to fit datasets
    containing outliers. In this recipe, we introduce how to apply `rlm` to perform
    robust linear regression to datasets containing outliers.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集中的异常值会将回归线从主流移动开去。除了移除它之外，我们还可以对包含异常值的数据集应用稳健线性回归。在本配方中，我们介绍了如何将`rlm`应用于对包含异常值的数据集进行稳健线性回归。
- en: Getting ready
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Prepare the dataset that contains an outlier that may move the regression line
    away from the mainstream. Here, we use the `Quartet` dataset loaded from the previous
    recipe.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 准备一个可能将回归线从主流移动开去的异常值数据集。在这里，我们使用从先前配方中加载的`Quartet`数据集。
- en: How to do it...
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to fit the robust linear regression model with
    `rlm`:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤使用`rlm`拟合稳健线性回归模型：
- en: 'Generate a scatter plot of the `x` variable against `y3`:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成`x`变量对`y3`的散点图：
- en: '[PRE19]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![How to do it...](img/00089.jpeg)'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00089.jpeg)'
- en: Scatter plot of variables x and y3
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 变量x和y3的散点图
- en: 'Next, you should import the `MASS` library first. Then, you can apply the `rlm`
    function to fit the model, and visualize the fitted line with the `abline` function:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您应该首先导入`MASS`库。然后，您可以使用`rlm`函数来拟合模型，并使用`abline`函数可视化拟合的线：
- en: '[PRE20]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![How to do it...](img/00090.jpeg)'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00090.jpeg)'
- en: Robust linear regression to variables x and y3
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对变量x和y3的稳健线性回归
- en: How it works
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理
- en: As per the preceding screenshot (step 1), you may encounter datasets that include
    outliers away from the mainstream. To remove the effect of an outlier, we demonstrate
    how to apply a robust linear regression (`rlm`) to fit the data. In the second
    screenshot (step 2), the robust regression line ignores the outlier and matches
    the mainstream.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 根据前面的截图（步骤1），您可能会遇到包含远离主流的异常值的数据集。为了消除异常值的影响，我们展示了如何应用稳健线性回归（`rlm`）来拟合数据。在第二个截图（步骤2）中，稳健回归线忽略了异常值并匹配了主流。
- en: There's more...
  id: totrans-142
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多...
- en: 'To see the effect of how an outlier can move the regression line away from
    the mainstream, you may replace the `rlm` function used in this recipe to `lm`,
    and replot the graph:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 为了看到异常值如何将回归线从主流移动开去，您可以将此配方中使用的`rlm`函数替换为`lm`，并重新绘制图形：
- en: '[PRE21]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![There''s more...](img/00091.jpeg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![更多...](img/00091.jpeg)'
- en: Linear regression on variables x and y3
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 变量x和y3的线性回归
- en: It is obvious that outlier (x=13) moves the regression line away from the mainstream.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，异常值（x=13）将回归线从主流移动开去。
- en: Studying a case of linear regression on SLID data
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 研究SLID数据上的线性回归案例
- en: To summarize the contents of the previous section, we explore more complex data
    with linear regression. In this recipe, we demonstrate how to apply linear regression
    to analyze the **Survey of Labor and Income Dynamics** (**SLID**) dataset.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 为了总结上一节的内容，我们使用线性回归探索更复杂的数据。在本配方中，我们展示了如何将线性回归应用于分析**劳动与收入动态调查**（**SLID**）数据集。
- en: Getting ready
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Check whether the `car` library is installed and loaded, as it is required to
    access thedataset SLID.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 检查是否已安装和加载`car`库，因为它需要访问SLID数据集。
- en: How to do it...
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Follow these steps to perform linear regression on SLID data:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤在SLID数据上执行线性回归：
- en: 'You can use the `str` function to get an overview of the data:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以使用`str`函数来获取数据的概览：
- en: '[PRE22]'
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'First, we visualize the variable wages against language, age, education, and
    sex:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将变量工资与语言、年龄、教育和性别可视化：
- en: '[PRE23]'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![How to do it...](img/00092.jpeg)'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00092.jpeg)'
- en: Plot of wages against multiple combinations
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 工资与多种组合的绘图
- en: 'Then, we can use `lm` to fit the model:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们可以使用`lm`来拟合模型：
- en: '[PRE24]'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'You can examine the summary of the fitted model through the `summary` function:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以通过`summary`函数检查拟合模型的摘要：
- en: '[PRE25]'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Drop the `language` attribute, and refit the model with the `lm` function:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除`language`属性，并使用`lm`函数重新拟合模型：
- en: '[PRE26]'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'We can then draw a diagnostic plot of `lmfit`:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们可以绘制`lmfit`的诊断图：
- en: '[PRE27]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![How to do it...](img/00093.jpeg)'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00093.jpeg)'
- en: Diagnostic plot of fitted model
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 拟合模型的诊断图
- en: 'Next, we take the log of wages and replot the diagnostic plot:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们对工资取对数并重新绘制诊断图：
- en: '[PRE28]'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![How to do it...](img/00094.jpeg)'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00094.jpeg)'
- en: Diagnostic plot of adjusted fitted model
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 调整后拟合模型的诊断图
- en: 'Next, you can diagnose the multi-colinearity of the regression model using
    the `vif` function:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您可以使用`vif`函数诊断回归模型的多重共线性：
- en: '[PRE29]'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Then, you can install and load the `lmtest` package and diagnose the heteroscedasticity
    of the regression model with the `bptest` function:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，您可以安装并加载`lmtest`包，并使用`bptest`函数诊断回归模型的异方差性：
- en: '[PRE30]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Finally, you can install and load the `rms` package. Then, you can correct
    standard errors with `robcov`:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，您可以安装并加载`rms`包。然后，您可以使用`robcov`来纠正标准误差：
- en: '[PRE31]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: How it works...
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: This recipe demonstrates how to conduct linear regression analysis on the SLID
    dataset. First, we load the SLID data and display its structure through the use
    of the `str` function. From the structure of the data, we know that there are
    four independent variables that will affect the wages of the dependent variable.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 本菜谱演示了如何在SLID数据集上执行线性回归分析。首先，我们加载SLID数据并通过使用`str`函数显示其结构。从数据结构中，我们知道有四个独立变量将影响因变量工资。
- en: Next, we explore the relationship of each independent variable to the dependent
    variable, `wages`, through visualization; the visualization result is shown in
    the preceding screenshot (step 2). In the upper-left section of this screenshot,
    you can find the box plot of three different languages against wages; the correlation
    between the languages and wages is not obvious. The upper-right section of the
    screenshot shows that the age appears to have a positive relationship with the
    dependent variable, `wages`. In the bottom-left of the screenshot, it is shown
    that education also appears to have a positive relationship with wages. Finally,
    the box plot in the bottom-right section of the screenshot shows that the wages
    of males are slightly higher than females.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过可视化探索每个独立变量与因变量`wages`之间的关系；可视化结果如图所示（步骤2）。在此截图的左上角，您可以找到三种不同语言与工资的箱线图；语言与工资之间的相关性不明显。截图右上角显示，年龄似乎与因变量`wages`呈正相关。在截图的左下角，显示教育似乎也与工资呈正相关。最后，截图右下角的箱线图显示，男性的工资略高于女性。
- en: Next, we fit all the attributes except for `wages` to the model as predictor
    variables. By summarizing the model, it is shown that education, age, and sex
    show a significance (*p-value < 0.05*). As a result, we drop the insignificant
    `language` attribute (which has a p-value greater than 0.05) and fit the three
    independent variables (education, sex, and age) with regard to the dependent variable
    (`wages`) in the linear model. This accordingly raises the f-statistic from 336.8
    to 565.3.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将除了`wages`以外的所有属性拟合到模型中作为预测变量。通过总结模型，可以看出教育、年龄和性别具有显著性（*p-value < 0.05*）。因此，我们删除了不显著的`language`属性（其p值大于0.05），并在线性模型中将三个独立变量（教育、性别和年龄）与因变量（`wages`）拟合。这相应地将f统计量从336.8提高到565.3。
- en: Next, we generate the diagnostic plot of the fitted model. Within the diagnostic
    plot, all the four plots indicate that the regression model follows the regression
    assumption. However, from residuals versus fitted and scale-location plot, residuals
    of smaller fitted values are biased toward the regression model. Since wages range
    over several orders of magnitude, to induce the symmetry, we apply a log transformation
    to wages and refit the data into a regression model. The red line of residuals
    versus fitted values plot and the Scale-Location plot are now closer to the gray
    dashed line.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们生成拟合模型的诊断图。在诊断图中，所有四个图都表明回归模型遵循回归假设。然而，从残差与拟合值和尺度-位置图中可以看出，较小拟合值的残差偏向回归模型。由于工资跨越几个数量级，为了诱导对称性，我们对工资应用对数变换，并将数据重新拟合到回归模型中。现在，残差与拟合值图和尺度-位置图的红线与灰色虚线更接近。
- en: Next, we would like to test whether multi-colinearity exists in the model. Multi-colinearity
    takes place when a predictor is highly correlated with others. If multi-colinearity
    exists in the model, you might see some variables have a high R-squared value
    but are shown as variables insignificant. To detect multi-colinearity, we can
    calculate the variance inflation and generalized variance inflation factors for
    linear and generalized linear models with the `vif` function. If multi-colinearity
    exists, we should find predictors with the square root of variance inflation factor
    above 2\. Then, we may remove redundant predictors or use a principal component
    analysis to transform predictors to a smaller set of uncorrelated components.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们想测试模型中是否存在多重共线性。当预测变量与其他变量高度相关时，就会发生多重共线性。如果模型中存在多重共线性，你可能会看到一些变量具有高的R-squared值，但显示为不显著的变量。为了检测多重共线性，我们可以使用`vif`函数计算线性模型和广义线性模型的方差膨胀因子和广义方差膨胀因子。如果存在多重共线性，我们应该找到方差膨胀因子平方根大于2的预测变量。然后，我们可以移除冗余预测变量或使用主成分分析将预测变量转换为较小的一组不相关成分。
- en: Finally, we would like to test whether **heteroscedasticity** exists in the
    model. Before discussing the definition of heteroscedasticity, we first have to
    know that in classic assumptions, the ordinary regression model assumes that the
    variance of the error is constant or homogeneous across observations. On the contrary,
    heteroscedasticity means that the variance is unequal across observations. As
    a result, heteroscedasticity may be biased toward the standard errors of our estimates
    and, therefore, mislead the testing of the hypothes. To detect and test heteroscedasticity,
    we can perform the **Breusch-Pagan** test for heteroscedasticity with the `bptest`
    function within the `lmtest` package. In this case, the p-value shows 2.206e-06
    (<0.5), which rejects the null hypothesis of homoscedasticity (no heteroscedasticity).
    Here, it implies that the standard errors of the parameter estimates are incorrect.
    However, we can use robust standard errors to correct the standard error (do not
    remove the heteroscedasticity) and increase the significance of truly significant
    parameters with `robcov` from the `rms` package. However, since it only takes
    the fitted model from the `rms` series as an input, we have to fit the ordinary
    least squares model beforehand.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们想测试模型中是否存在**异方差性**。在讨论异方差性的定义之前，我们首先要知道，在经典假设中，普通回归模型假设误差的方差在观测值之间是恒定的或同质的。相反，异方差性意味着方差在观测值之间是不等的。因此，异方差性可能会偏向我们估计的标准误差，从而误导假设的检验。为了检测和测试异方差性，我们可以在`lmtest`包中的`bptest`函数执行异方差性的**Breusch-Pagan**检验。在这种情况下，p值显示为2.206e-06（<0.5），这拒绝了同方差性的零假设（没有异方差性）。在这里，它意味着参数估计的标准误差是不正确的。然而，我们可以使用`rms`包中的`robcov`来使用稳健标准误差纠正标准误差（不消除异方差性）并提高真正显著参数的显著性。然而，由于它只接受`rms`系列中的拟合模型作为输入，我们必须先拟合普通最小二乘模型。
- en: See also
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考信息
- en: 'For more information about the SLID dataset, you can use the `help` function
    to view the related documentation:'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如需了解更多关于SLID数据集的信息，您可以使用`help`函数查看相关文档：
- en: '[PRE32]'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Applying the Gaussian model for generalized linear regression
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用高斯模型进行广义线性回归
- en: '**Generalized linear model** (**GLM**) is a generalization of linear regression,
    which can include a link function to make a linear prediction. As a default setting,
    the family object for `glm` is Gaussian, which makes the `glm` function perform
    exactly the same as `lm`. In this recipe, we first demonstrate how to fit the
    model into the data using the `glm` function, and then show that `glm` with a
    Gaussian model performs exactly the same as `lm`.'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Check whether the `car` library is installed and loaded as we require the SLID
    dataset from this package.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following steps to fit a generalized linear regression model with
    the Gaussian model:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: 'Fit the independent variables, `age`, `sex`, and `education`, and dependent
    variable wages to `glm`:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Fit the independent variables, `age`, `sex`, and `education`, and the dependent
    variable wages to `lm`:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE34]'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Use `anova` to compare the two fitted models:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE35]'
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: How it works...
  id: totrans-202
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `glm` function fits a model to the data in a similar fashion to the `lm`
    function. The only difference is that you can specify a different link function
    in the parameter, `family` (you may use `?family` in the console to find different
    types of link functions). In this recipe, we first input the independent variables,
    `age`, `sex`, and `education`, and the dependent `wages` variable to the `glm`
    function, and assign the built model to `lmfit1`. You can use the built model
    for further prediction.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: Next, to determine whether `glm` with a Gaussian model is exactly the same as
    `lm`, we fit the independent variables, `age`, `sex`, and `education`, and the
    dependent variable, `wages`, to the `lm` model. By applying the `summary` function
    to the two different models, it reveals that the residuals and coefficients of
    the two output summaries are exactly the same.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we further compare the two fitted models with the `anova` function.
    The result of the `anova` function shows that the two models are similar, with
    the same **residual degrees of freedom** (**Res.DF**) and **residual sum of squares**
    (**RSS Df**).
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: See also
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For a comparison of generalized linear models with linear models, you can refer
    to *Venables, W. N., & Ripley, B. D. (2002). Modern applied statistics with S.
    Springer*.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Applying the Poisson model for generalized linear regression
  id: totrans-208
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Generalized linear models allow response variables that have error distribution
    models other than a normal distribution (Gaussian). In this recipe, we demonstrate
    how to apply Poisson as a family object within `glm` with regard to count data.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The prerequisite of this task is to prepare the count data, with all the input
    data values as integers.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following steps to fit the generalized linear regression model
    with the Poisson model:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: 'Load the `warpbreaks` data, and use `head` to view the first few lines:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE36]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'We apply Poisson as a family object for the independent variable, `tension`,
    and the dependent variable, `breaks`:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE37]'
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: How it works...
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Under the assumption of a Poisson distribution, the count data can be fitted
    to a log-linear model. In this recipe, we first loaded a sample count data from
    the `warpbreaks` dataset, which contained data regarding the number of warp breaks
    per loom. Next, we applied the `glm` function with breaks as a dependent variable,
    `tension` as an independent variable, and Poisson as a family object. Finally,
    we viewed the fitted log-linear model with the summary function.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: See also
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To understand more on how a Poisson model is related to count data, you can
    refer to *Cameron, A. C., & Trivedi, P. K. (2013). Regression analysis of count
    data (No. 53). Cambridge university press.*
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Applying the Binomial model for generalized linear regression
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For a binary dependent variable, one may apply a binomial model as the family
    object in the `glm` function.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-224
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The prerequisite of this task is to prepare a binary dependent variable. Here,
    we use the `vs` variable (V engine or straight engine) as the dependent variable.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-226
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following steps to fit a generalized linear regression model with
    the Binomial model:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we examine the first six elements of `vs` within `mtcars`:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE38]'
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'We apply the `glm` function with `binomial` as the family object:'
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE39]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: How it works...
  id: totrans-232
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Within the binary data, each observation of the response value is coded as either
    `0` or `1`. Fitting into the regression model of the binary data requires a binomial
    distribution function. In this example, we first load the binary dependent variable,
    `vs`, from the `mtcars` dataset. The `vs` is suitable for the binomial model as
    it contains binary data. Next, we fit the model into the binary data using the
    `glm` function by specifying `binomial` as the family object. Last, by referring
    to the summary, we can obtain the description of the fitted model.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: See also
  id: totrans-234
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'If you specify the family object in parameters only, you will use the default
    link to fit the model. However, to use an alternative link function, you can add
    a link argument. For example:'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE40]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'If you would like to know how many alternative links you can use, please refer
    to the family document via the help function:'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE41]'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Fitting a generalized additive model to data
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Generalized additive model** (**GAM**), which is used to fit generalized
    additive models, can be viewed as a semiparametric extension of GLM. While GLM
    holds the assumption that there is a linear relationship between dependent and
    independent variables, GAM fits the model on account of the local behavior of
    data. As a result, GAM has the ability to deal with highly nonlinear relationships
    between dependent and independent variables. In the following recipe, we introduce
    how to fit regression using a generalized additive model.'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We need to prepare a data frame containing variables, where one of the variables
    is a response variable and the others may be predictor variables.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-243
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following steps to fit a generalized additive model into data:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: 'First, load the `mgcv` package, which contains the `gam` function:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE42]'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Then, install the `MASS` package and load the `Boston` dataset:'
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE43]'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Fit the regression using `gam`:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE44]'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Get the summary information of the fitted model:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE45]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: How it works
  id: totrans-253
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: GAM is designed to maximize the prediction of a dependent variable, `y`, from
    various distributions by estimating the nonparametric functions of the predictors
    that link to the dependent variable through a link function. The notion of GAM
    is ![How it works](img/00095.jpeg), where an exponential family, *E*, is specified
    for *y*, along with the `g` link function; `f` denotes the link function of predictors.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: The `gam` function is contained in the `mgcv` package, so, install this package
    first and load it into an R session. Next, load the Boston dataset (*Housing Values
    in the Suburbs of Boston*) from the `MASS` package. From the dataset, we use `dis`
    (the weighted mean of the distance to five Boston employment centers) as the dependent
    variable, and `nox` (nitrogen oxide concentration) as the independent variable,
    and then input them into the `gam` function to generate a fitted model.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: Similar to `glm`, `gam` allows users to summarize the `gam` fit. From the summary,
    one can find the parametric parameter, significance of smoothed terms, and other
    useful information.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
- en: See also
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Apart from `gam`, the `mgcv` package provides another generalized additive
    model, `bam`, for large datasets. The `bam` package is very similar to `gam`,
    but uses less memory and is relatively more efficient. Please use the `help` function
    for more information on this model:'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE46]'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'For more information about generalized additive models in R, please refer to
    *Wood, S. (2006). Generalized additive models: an introduction with R. CRC press*.'
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Visualizing a generalized additive model
  id: totrans-261
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this recipe, we demonstrate how to add a `gam` fitted regression line to
    a scatter plot. In addition, we visualize the gam fit using the `plot` function.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-263
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Complete the previous recipe by assigning a `gam` fitted model to the `fit`
    variable.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following steps to visualize the generalized additive model:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
- en: 'Generate a scatter plot using the `nox` and `dis` variables:'
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE47]'
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '![How to do it...](img/00096.jpeg)'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Scatter plot of variable nox against dis
  id: totrans-270
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Add the regression to the scatter plot:'
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE48]'
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '![How to do it...](img/00097.jpeg)'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Fitted regression of gam on a scatter plot
  id: totrans-274
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Alternatively, you can plot the fitted model using the `plot` function:'
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE49]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '![How to do it...](img/00098.jpeg)'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Plot of fitted gam
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-279
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To visualize the fitted regression, we first generate a scatter plot using the
    `dis` and `nox` variables. Then, we generate the sequence of *x*-axis, and respond
    *y* through the use of the `predict` function on the fitted model, `fit`. Finally,
    we use the `lines` function to add the regression line to the scatter plot.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
- en: Besides using the lines to add fitted regression lines on the scatter plot,
    `gam` has a `plot` function to visualize the fitted regression lines containing
    the confidence region. To shade the confidence region, we assign `shade = TRUE`
    within the function.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: There's more...
  id: totrans-282
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The `vis.gam` function is used to produce perspective or contour plot views
    of the `gam` model predictions. It is helpful to observe how response variables
    interact with two predictor variables. The following is an example of a contour
    plot on the `Boston` dataset:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '![There''s more...](img/00099.jpeg)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
- en: A sample contour plot produced by vis.gam
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
- en: Diagnosing a generalized additive model
  id: totrans-287
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: GAM also provides diagnostic information about the fitting procedure and results
    of the generalized additive model. In this recipe, we demonstrate how to plot
    diagnostic plots through the `gam.check` function.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-289
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Ensure that the previous recipe is completed with the `gam` fitted model assigned
    to the `fit` variable.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Perform the following step to diagnose the generalized additive model:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
- en: 'Generate the diagnostic plot using `gam.check` on the fitted model:'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE51]'
  id: totrans-294
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '![How to do it...](img/00100.jpeg)'
  id: totrans-295
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Diagnostic plot of fitted gam
  id: totrans-296
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-297
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `gam.check` function first produces the smoothing parameter estimation convergence
    information. In this example, the smoothing parameter, **GCV/UBRE** (**Generalized
    Cross Validation/ Unbiased Risk Estimator**) score converges after seven iterations.
    The mean absolute gradient of the GCV/UBRE function at the minimum is 8.79622e-06
    and the estimated rank is `10`. The dimension check is to test whether the basis
    dimension for a smooth function is adequate. From this example, the low p-value
    indicates that the k is set too low. One may adjust the dimension choice for smooth
    by specifying the argument, k, by fitting `gam` to the data.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
- en: In addition to providing information regarding smoothing parameter estimation
    convergence, the function returns four diagnostic plots. The upper-left section
    of the plot in the screenshot shows a **quantile-comparison** plot. This plot
    is useful to identify outliers and heavy tails. The upper-right section of the
    plot shows residuals versus linear predictors, which are useful in finding nonconstant
    error variances. The bottom-left section of the plot shows a histogram of the
    residuals, which is helpful in detecting non-normality. The bottom-right section
    shows response versus the fitted value.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
- en: There's more...
  id: totrans-300
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You can access the `help` function for more information on `gam.check`. In
    particular, this includes a detailed illustration of smoothing parameter estimation
    convergence and four returned plots:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'In addition, more information for `choose.k` can be accessed by the following
    command:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]'
  id: totrans-304
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
