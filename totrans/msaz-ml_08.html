<html><head></head><body><div class="chapter" title="Chapter&#xA0;8.&#xA0;Clustering"><div class="titlepage"><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Clustering</h1></div></div></div><p>Birds of a feather flock together—clustering is all about this. It's an unsupervised learning where the class or label is not known. So, you get a dataset and then with the algorithm, you divide and group the instances into different clusters with an objective of keeping all the similar ones together.</p><p>Clustering has many different application areas, such as customer segmentation, social network analysis, computational biology, and many more.</p><p>In this chapter, you will start with understanding the <span class="strong"><strong>K-means clustering</strong></span> algorithm and then, you will learn how to build a model using this in ML Studio.</p><div class="section" title="Understanding the K-means clustering algorithm"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec50"/>Understanding the K-means clustering algorithm</h1></div></div></div><p>The K-means <a id="id320" class="indexterm"/>clustering algorithm is the most popular clustering algorithm. It is simple and powerful. As the name suggests, the algorithm creates K clusters out of the dataset where <span class="emphasis"><em>K</em></span> is a number you decide. For simplicity, let's consider a dataset with two features and let's plot them on a two dimensional space as one feature on <span class="emphasis"><em>x</em></span> axis and the other on <span class="emphasis"><em>y</em></span> axis. Again, note that as clustering is an unsupervised learning problem, no label, class, or dependent variable is required.</p><p>With the K-means algorithm, K centroids are determined for K clusters. All the points in a cluster are closest to its centroid than to any other centroids.</p><p>Consider <span class="emphasis"><em>K =3</em></span>, where there are 3 clusters and hence 3 centroids, as you can find in the following figure. So by intuition, take any point and calculate its distance from the three centroids. The point will belong to the cluster whose centroid is the nearest.</p><p>For a point, let <span class="emphasis"><em>d1</em></span> be the distance from Centroid 1, <span class="emphasis"><em>d2</em></span> be the distance from Centroid 2, and <span class="emphasis"><em>d3</em></span> be the distance from Centroid 3.</p><p>If <span class="emphasis"><em>d2 &lt; d1</em></span> and <span class="emphasis"><em>d2 &lt; d3</em></span>, then the point closest to centroid 2 belongs to the cluster 2. Let's take a look at the <a id="id321" class="indexterm"/>following diagram:</p><div class="mediaobject"><img src="graphics/0792EN_08_01.jpg" alt="Understanding the K-means clustering algorithm"/></div></div></div>
<div class="section" title="Creating a K-means clustering model using ML Studio"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec51"/>Creating a K-means clustering model using ML Studio</h1></div></div></div><p>Now, it's time <a id="id322" class="indexterm"/>for you to build a clustering model <a id="id323" class="indexterm"/>by yourself. ML Studio comes with two modules specific for K-means clustering.</p><p>The URL <a class="ulink" href="http://www.biz.uiowa.edu/faculty/jledolter/DataMining/protein.csv">http://www.biz.uiowa.edu/faculty/jledolter/DataMining/protein.csv</a> contains a dataset in CSV format.</p><p>It contains the protein intakes of 9 different food sources from 25 European countries. The first few <a id="id324" class="indexterm"/>instances in the dataset are <a id="id325" class="indexterm"/>listed as follows:</p><div class="mediaobject"><img src="graphics/0792EN_08_02.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Let's build a clustering model to group the dataset into three clusters based on the protein intakes of different countries from a variety of sources.</p><p>Create a new experiment and drag the <span class="strong"><strong>Reader</strong></span> module under the <span class="strong"><strong>Data Input and Output</strong></span> section in the modules palette to the left of the canvas. On the properties pane to the right, choose <span class="strong"><strong>Data Source</strong></span> as <span class="strong"><strong>Web URL via HTTP</strong></span>, <span class="strong"><strong>Data format</strong></span> as <span class="strong"><strong>CSV</strong></span>, and tick the checkbox for <span class="strong"><strong>CSV or TSV has header row</strong></span>. Also, on the URL textbox, add the previously mentioned URL to the CSV file.</p><div class="mediaobject"><img src="graphics/0792EN_08_03.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Drag the <span class="strong"><strong>K-Means Clustering</strong></span> module to the canvas. This module is for the algorithm. As you need three clusters for your dataset, set the <span class="strong"><strong>Number of Centroids</strong></span> option to <span class="strong"><strong>3</strong></span> in the properties <a id="id326" class="indexterm"/>pane and leave the others with their <a id="id327" class="indexterm"/>default parameters, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_08_04.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Drag the <span class="strong"><strong>Train Clustering Model</strong></span> module to the canvas and make a connection, as shown in the following screenshot. For the <span class="strong"><strong>Country</strong></span> column in the dataset, your target is to make the algorithm work based on the protein intakes. So, exclude the column and include everything else.</p><div class="mediaobject"><img src="graphics/0792EN_08_05.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Drag the <span class="strong"><strong>Assign to Clusters</strong></span> module to the canvas and make a connection, as shown in the following screenshot. Exclude the <span class="strong"><strong>Country</strong></span> column and include everything else.</p><div class="mediaobject"><img src="graphics/0792EN_08_06.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Now, drag a <a id="id328" class="indexterm"/>
<span class="strong"><strong>Project Columns</strong></span> module and connect <a id="id329" class="indexterm"/>the output of the <span class="strong"><strong>Assign to Clusters</strong></span> module to its input. Select <span class="strong"><strong>All columns</strong></span> by clicking on the <span class="strong"><strong>Launch column selector</strong></span> option in the properties pane for the module, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_08_08.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>Run the experiment <a id="id330" class="indexterm"/>and right-click on the <a id="id331" class="indexterm"/>output port of the <span class="strong"><strong>Project Columns </strong></span>module and visualize the output with the clusters assigned as follows:</p><div class="mediaobject"><img src="graphics/0792EN_08_07.jpg" alt="Creating a K-means clustering model using ML Studio"/></div><p>The output table has the rightmost <span class="strong"><strong>Assignments</strong></span> column that contains the cluster (number) assigned to each cluster. As you can see, we've found that different countries fall into one of the <a id="id332" class="indexterm"/>three clusters based on the protein <a id="id333" class="indexterm"/>intakes, for example, <span class="strong"><strong>Czechoslovakia</strong></span> belongs to cluster 2 and <span class="strong"><strong>France</strong></span> to cluster 1.</p><p>Here, you've found the clusters for the same training data. However, after training, you can find the clusters for new datasets as well.</p></div>
<div class="section" title="Do it yourself"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec52"/>Do it yourself</h1></div></div></div><p>There is a sample dataset under the <span class="strong"><strong>Saved Datasets</strong></span> option in ML Studio called <span class="strong"><strong>Iris Two Class Data</strong></span>. Use this to build a <span class="strong"><strong>K-Means Clustering</strong></span> model with <span class="emphasis"><em>K (Number of Centroids)  = 2</em></span>.</p><p>This is not a test, but did you notice that all the instances of one class fall in the same cluster? Don't be confused between the cluster number as <span class="emphasis"><em>0</em></span> and <span class="emphasis"><em>1</em></span> because it is just a number and it won't harm even if you read the cluster 0 as 1 and <span class="emphasis"><em>1</em></span> as <span class="emphasis"><em>0</em></span>.</p></div>
<div class="section" title="Clustering versus classification"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec53"/>Clustering versus classification</h1></div></div></div><p>It might be confusing for beginners to distinguish between a clustering problem and a classification problem. Classification is fundamentally different from clustering. Classification is a <a id="id334" class="indexterm"/>supervised learning problem where your class or <a id="id335" class="indexterm"/>target variable is known to train a dataset. The algorithm is trained to look at the examples (features and class or target variables) and then you score and test it with a test dataset.</p><p>Clustering, being an unsupervised learning, it works on a dataset with no label or class variable. Also, you don't perform scoring and testing with a test dataset. So, you just apply your algorithm to your data and group them into a different cluster, say 1, 2 and 3, which were not known before.</p><p>So, to put it simply, if you have a dataset and a class/label or target variable as categorical variable and you have to predict the target variable for a new dataset based on the given dataset, it's a classification problem. If you are just given a dataset with no label or target variable and you just have to group them into <span class="emphasis"><em>n</em></span> clusters, then it's a clustering case.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec54"/>Summary</h1></div></div></div><p>After a quick overview of the unsupervised learning, you proceeded to understand clustering and the K-means clustering algorithm. Then, you built a clustering model using ML Studio and learned about three modules for K-means clustering.</p><p>In the next chapter, you will explore the Recommender System and learn to build a simple model for the same.</p></div></body></html>