<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><div id="_idContainer066">
			<h1 id="_idParaDest-28" class="chapter-number"><a id="_idTextAnchor028"/>2</h1>
			<h1 id="_idParaDest-29"><a id="_idTextAnchor029"/>Predicting from Command Prompt and PowerShell</h1>
			<p>Web APIs<a id="_idIndexMarker142"/> are the most common way to communicate with <strong class="bold">ML</strong> services. However, there are many reasons why you might not be able to use <em class="italic">external</em> web APIs. For example, compliance and regulatory requirements may prevent you from sending data outside your firm, or there might not be a suitable ML service for your use case. Even for <em class="italic">internally</em> developed ML models, there are reasons to not use web APIs as the communication method. An example is to run models directly on the Digital Worker API as this doesn’t require additional web <span class="No-Break">server infrastructure.</span></p>
			<p>This <a id="_idIndexMarker143"/>chapter shows you some different ways that an ML model can be run <em class="italic">locally</em> through <strong class="bold">BP</strong>. We’ll go <a id="_idIndexMarker144"/>through examples of how this can be<a id="_idIndexMarker145"/> done using <strong class="bold">Windows Command Prompt</strong> (<strong class="bold">WCP</strong>) and <span class="No-Break"><strong class="bold">PowerShell</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">PS</strong></span><span class="No-Break">).</span></p>
			<p>During my research<a id="_idIndexMarker146"/> on <strong class="bold">IA</strong>, I tried to discover what underlying technologies, libraries, and ML algorithms were being used. <em class="italic">Python</em> was the only programming language that was being used in production (outside of the built-in C# and VB.NET used in <strong class="bold">RPA</strong>), despite <a id="_idIndexMarker147"/>R and Julia being popular languages used to teach ML in schools. In the final example of this chapter, we’ll be calling a Python script <span class="No-Break">in BP.</span></p>
			<p>In this chapter, we’ll cover the following <span class="No-Break">main topics:</span></p>
			<ul>
				<li><span class="No-Break">Command-line basics</span></li>
				<li>Predicting from the command line using the <strong class="bold">Object Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span></li>
				<li>Getting prediction results back <span class="No-Break">into BP</span></li>
				<li>Timing out <span class="No-Break">long-running predictions</span></li>
				<li><strong class="bold">DX VBOs</strong> – <strong class="bold">Utility  PowerShell</strong> and <strong class="bold">Script </strong><span class="No-Break"><strong class="bold">Execution VBO</strong></span></li>
			</ul>
			<h1 id="_idParaDest-30"><a id="_idTextAnchor030"/>Technical requirements</h1>
			<p>Before we get started, please ensure that the following requirements <span class="No-Break">are met:</span></p>
			<ul>
				<li>Download and import the <strong class="bold">Utility - Powershell</strong> asset from DX:  <a href="https://digitalexchange.blueprism.com/dx/entry/9648/solution/utility---powershell"><span class="No-Break">https://digitalexchange.blueprism.com/dx/entry/9648/solution/utility---powershell</span></a></li>
				<li>Download and import the <strong class="bold">Script Execution VBO</strong> asset from <span class="No-Break">DX: </span><a href="https://digitalexchange.blueprism.com/dx/entry/3439/solution/blue-prism---script-execution-vbo-2"><span class="No-Break">https://digitalexchange.blueprism.com/dx/entry/3439/solution/blue-prism---script-execution-vbo-2</span></a></li>
				<li>Install Python version <span class="No-Break">3+: </span><a href="https://www.python.org/downloads"><span class="No-Break">https://www.python.org/downloads</span></a></li>
				<li>Download and import the examples for this chapter from GitHub, which are contained in a single <span class="No-Break">Release: </span><a href="https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/tree/main/ch2"><span class="No-Break">https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/tree/main/ch2</span></a></li>
			</ul>
			<h1 id="_idParaDest-31"><a id="_idTextAnchor031"/>Command-line basics</h1>
			<p>When making a prediction on the <a id="_idIndexMarker148"/>Digital Worker machine, you’ll need to invoke the command line, unless you’re able to interact with it programmatically through a <em class="italic">Code Stage</em> (the topic of the next chapter) or through a graphical interface. BP is able to start standalone programs or scripts through both WCP <span class="No-Break">and PS.</span></p>
			<p>WCP can be launched by running the <em class="italic">Command Prompt</em> application, or <strong class="source-inline">cmd.exe</strong> from the Windows <strong class="bold">Start</strong> menu. It can be started as the current user that’s logged in to Windows, or an administrator user, by right-clicking Command Prompt and choosing <strong class="bold">Run </strong><span class="No-Break"><strong class="bold">as administrator</strong></span><span class="No-Break">.</span></p>
			<p>PS can be started by running the PS application, or <strong class="source-inline">powershell.exe</strong>/<strong class="source-inline">pwsh.exe</strong> from the Windows <strong class="bold">Start</strong> menu. <strong class="source-inline">pwsh.exe</strong> is the executable for PS Core, which is the newer, cross-platform version of PS (v6 and above) that must be installed manually as it doesn’t come installed on Windows by default. <strong class="source-inline">powershell.exe</strong> is the legacy version (v5.1 and under), which does come pre-installed <span class="No-Break">with Windows.</span></p>
			<p>For IA purposes, there aren’t really any strong arguments for choosing WCP over PS, or the other way around. WCP is overall simpler with less functionality, whereas PS is more complex and more fully featured. However, these details are internal to the command-line scripts themselves, which will likely be provided to you by the developers of the ML solution. BP can mostly treat these scripts as <span class="No-Break">black boxes.</span></p>
			<p>When predicting locally, you’ll likely be required to deploy the ML model through a standalone executable, a <a id="_idIndexMarker149"/>batch script, a PS script, or by running the source code (most commonly <span class="No-Break">Python) directly.</span></p>
			<p>Next, let’s<a id="_idIndexMarker150"/> look at <a id="_idIndexMarker151"/>three concepts that are important to connecting<a id="_idIndexMarker152"/> command-line programs to BP. These are <strong class="bold">output streams</strong>, <strong class="bold">output redirection</strong>, and <span class="No-Break"><strong class="bold">blocking execution</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor032"/>Output streams</h2>
			<p>Programs <a id="_idIndexMarker153"/>that are executed from WCP and PS can output text to two different streams. The first stream is<a id="_idIndexMarker154"/> called <strong class="bold">Standard Out</strong> (<strong class="bold">STDOUT</strong>), which is where regular messages that are printed out to the console window go. The second stream, <strong class="bold">Standard Error</strong> (<strong class="bold">STDERR</strong>), is the output stream specifically used for error messages that are<a id="_idIndexMarker155"/> sent to the screen. In practice, whether <strong class="source-inline">STDERR</strong> is used depends on the authors of the script. Sometimes, developers will decide to print error messages to <strong class="source-inline">STDOUT</strong> instead of <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">STDERR</strong></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">PS has more output streams available, such as for warning and debug messages, but STDOUT and STDERR are by far the most <span class="No-Break">commonly used.</span></p>
			<p>For example, let’s open <strong class="source-inline">cmd.exe</strong> and type the following (without the <strong class="source-inline">&gt;</strong> <span class="No-Break">character):</span></p>
			<pre class="console">
&gt; echo "Hello Blue Prism"</pre>			<p>We will see <strong class="source-inline">"Hello Blue Prism"</strong> printed back onto the screen <span class="No-Break">through STDOUT:</span></p>
			<div>
				<div id="_idContainer043" class="IMG---Figure">
					<img src="image/B18416_02_1.jpg" alt="Figure 2.1 – Output that is displayed in the command-line window is STDOUT" width="853" height="252"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Output that is displayed in the command-line window is STDOUT</p>
			<p>Let’s try a <a id="_idIndexMarker156"/>different <a id="_idIndexMarker157"/>command that we know will generate an error. Let’s print out the contents of a <span class="No-Break">non-existent file:</span></p>
			<pre class="console">
&gt; type "C:\Users\Public\non existent file.txt"</pre>			<p>This gives a <strong class="source-inline">The system cannot find the file specified.</strong> <span class="No-Break">error message:</span></p>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="image/B18416_02_2.jpg" alt="Figure 2.2 – Is this message STDOUT or STDERR?" width="1086" height="199"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Is this message STDOUT or STDERR?</p>
			<p>The intention of the text displayed is to show an error, but was it written to the STDOUT stream or STDERR? We<a id="_idIndexMarker158"/> can’t tell based on the printed words shown in the window, but we can figure this out by <strong class="bold">redirecting</strong> STDOUT and STDERR <span class="No-Break">into files.</span></p>
			<h2 id="_idParaDest-33"><a id="_idTextAnchor033"/>Output redirection</h2>
			<p>Both <a id="_idIndexMarker159"/>STDOUT and<a id="_idIndexMarker160"/> STDERR can <a id="_idIndexMarker161"/>be redirected to one another, and written out to files as well. <em class="italic">This is a primary way to capture command-line output into BP</em>. This is done in part by using the redirection, or the “greater-than” character (<strong class="source-inline">&gt;</strong>)  in WCP and PS. The most common way you’ll see this being used in BP is to redirect STDOUT into a file so that it can be read<a id="_idIndexMarker162"/> using the <strong class="bold">File - </strong><span class="No-Break"><strong class="bold">Management</strong></span><span class="No-Break"> VBO.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">The <strong class="source-inline">&gt;</strong> character redirects and overwrites any previous content, whereas <strong class="source-inline">&gt;&gt;</strong> redirection appends content. We’ll use <strong class="source-inline">&gt;</strong> much more often than <strong class="source-inline">&gt;&gt;</strong> for the purpose of getting STDOUT and <a id="_idIndexMarker163"/>STDERR into BP since appending requires more development logic to differentiate previous content from <span class="No-Break">current content.</span></p>
			<p>Let’s redirect <a id="_idIndexMarker164"/>STDOUT from one of the previous commands into a file and print out the contents of that file <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">cmd.exe</strong></span><span class="No-Break">:</span></p>
			<pre class="console">
&gt; echo "Hello Blue Prism" &gt; "C:\Users\Public\ch 2 echo.txt"
&gt; type "C:\Users\Public\ch 2 echo.txt"</pre>			<p>The first command no longer prints <strong class="source-inline">"Hello Blue Prism"</strong> into the console window. The output was redirected into a file. Text is only printed after the second command, which does not have <span class="No-Break">any redirection:</span></p>
			<div>
				<div id="_idContainer045" class="IMG---Figure">
					<img src="image/B18416_02_3.jpg" alt="Figure 2.3 – Redirecting STDOUT to a file" width="1326" height="250"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Redirecting STDOUT to a file</p>
			<p>Let’s try printing <a id="_idIndexMarker165"/>the contents of the non-existent file again, except this time, we’ll redirect STDOUT to a file. Then, we’ll print the output of the <span class="No-Break">redirected file:</span></p>
			<pre class="console">
&gt; type "C:\Users\Public\non existent file.txt" &gt; "C:\Users\Public\ch 2 redirect.txt"
&gt; type "C:\Users\Public\ch 2 redirect.txt"</pre>			<p>You’ll see that the error text is printed to the screen, unlike our previous example. Why wasn’t this redirected? It’s because the <strong class="source-inline">The system cannot find the file specified.</strong> message is not from STDOUT, so redirecting STDOUT has <span class="No-Break">no effect:</span></p>
			<div>
				<div id="_idContainer046" class="IMG---Figure">
					<img src="image/B18416_02_4.jpg" alt="Figure 2.4 – Redirecting STDOUT did not capture the message" width="1617" height="361"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Redirecting STDOUT did not capture the message</p>
			<p>Since the message wasn’t<a id="_idIndexMarker166"/> STDOUT, we can reasonably guess that it was STDERR. STDERR can be redirected <a id="_idIndexMarker167"/>using <strong class="source-inline">2&gt;</strong> instead of <strong class="source-inline">&gt;</strong> (which is for STDOUT). Let’s try <span class="No-Break">redirecting STDERR:</span></p>
			<pre class="console">
&gt; type "C:\Users\Public\non existent file.txt" 2&gt; "C:\Users\Public\ch 2 redirect stderr.txt"
&gt; type "C:\Users\Public\ch 2 redirect stderr.txt"</pre>			<p>We now see that <a id="_idIndexMarker168"/>the first command prints nothing to the screen, whereas the second does. This confirms that the <strong class="source-inline">The system cannot find the file specified.</strong> message is written to STDERR and <span class="No-Break">not STDOUT:</span></p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="image/B18416_02_5.jpg" alt="Figure 2.5 – Redirecting STDERR captures the message" width="1650" height="336"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – Redirecting STDERR captures the message</p>
			<p>So far, we’ve only seen examples of redirecting one of the STDOUT or STDERR streams, but not both. There are two ways of redirecting both streams. The first choice is to combine both STDOUT and STDERR into one stream and redirect that single stream into a <em class="italic">single file</em>. The second choice is to redirect both streams into <span class="No-Break"><em class="italic">separate files</em></span><span class="No-Break">.</span></p>
			<p>Let’s look at how to do both of these, this time using PS instead of WCP. Luckily, all of the redirection commands that we’ve seen are interchangeable between WCP and PS. Using PS also has the small benefit of changing STDERR messages to a red-colored font so that they are immediately recognizable. Open <strong class="source-inline">powershell.exe</strong> and enter <span class="No-Break">the following:</span></p>
			<pre class="console">
&gt; &amp;{echo "Blue Prism";Write-Error "IA"}</pre>			<p>This is actually two commands separated by a semicolon. The first <strong class="source-inline">echo</strong> command writes to <a id="_idIndexMarker169"/>STDOUT, whereas the second <strong class="source-inline">Write-Error</strong> command writes to STDERR. The surrounding <strong class="source-inline">&amp;{…}</strong> characters mean to execute it as a single scriptblock <span class="No-Break">in PS.</span></p>
			<p>Running this produces the following output. We see the STDOUT message, <strong class="source-inline">Blue Prism</strong>, and the <a id="_idIndexMarker170"/>STDERR message (in red) on the PS <span class="No-Break">console screen:</span></p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="image/B18416_02_6.jpg" alt="Figure 2.6 – The red text is STDERR, whereas the normal-colored text is STDOUT" width="1380" height="363"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – The red text is STDERR, whereas the normal-colored text is STDOUT</p>
			<p>Next, let’s combine <a id="_idIndexMarker171"/>STDERR into the STDOUT stream, redirect that into a <em class="italic">single file</em>, and print out the contents of <span class="No-Break">that file:</span></p>
			<pre class="console">
&gt; &amp;{echo "Blue Prism";Write-Error "IA"} &gt; "C:\Users\Public\ch2 redirect both.txt" 2&gt;&amp;1
&gt; type "C:\Users\Public\ch2 redirect both.txt"</pre>			<p>After the first <strong class="source-inline">&gt;</strong> instance, we<a id="_idIndexMarker172"/> specify the file path that STDOUT should be redirected to. <strong class="source-inline">2&gt;&amp;1</strong> means that we want to redirect STDERR into the STDOUT stream. When printing out the file, we see that both the STDOUT and STDERR messages <span class="No-Break">are present:</span></p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="image/B18416_02_7.jpg" alt="Figure 2.7 – Redirecting both STDOUT and STDERR into a single file" width="1554" height="406"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Redirecting both STDOUT and STDERR into a single file</p>
			<p>Next, let’s redirect <a id="_idIndexMarker173"/>STDERR and STDOUT into <span class="No-Break"><em class="italic">separate files</em></span><span class="No-Break">.</span></p>
			<pre class="console">
&gt; &amp;{echo "Blue Prism";Write-Error "IA"} &gt; "C:\Users\Public\ch2 redirect stdout2.txt" 2&gt; "C:\Users\Public\ch2 redirect stderr2.txt"
&gt; type "C:\Users\Public\ch2 redirect stdout2.txt"
&gt; type "C:\Users\Public\ch2 redirect stderr2.txt"</pre>			<p>Again, <strong class="source-inline">&gt;</strong> let us specify the path we want<a id="_idIndexMarker174"/> STDOUT redirected to. Following <strong class="source-inline">2&gt;</strong> is where we want<a id="_idIndexMarker175"/> STDERR redirected to. When the files are printed out, only the content from their corresponding stream <span class="No-Break">is shown:</span></p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="image/B18416_02_8.jpg" alt="Figure 2.8 – Redirecting STDOUT and STDERR to different files" width="1368" height="520"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Redirecting STDOUT and STDERR to different files</p>
			<p>Given the choice between combining streams and redirecting them into a single file versus redirecting <a id="_idIndexMarker176"/>STDOUT and STDERR into separate files, it makes much more sense to do the <em class="italic">latter</em>. This allows us to isolate error messages from non-error messages. It’s also the reason why we prefer to overwrite previous output (<strong class="source-inline">&gt;</strong>) versus append (<strong class="source-inline">&gt;&gt;</strong>). Appending requires us to add more logic, to split the output from the latest command run from <span class="No-Break">previous ones.</span></p>
			<p>We’ve now covered the different ways of redirecting output from the command line into files. This makes it easy for us to receive the output of command-line-based ML programs into BP. Next, let’s look at the final topic of this <em class="italic">Command-line basics</em> section, blocking versus <span class="No-Break">non-blocking execution.</span></p>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor034"/>Blocking versus non-blocking execution</h2>
			<p>When <a id="_idIndexMarker177"/>BP starts a command-line program, the <a id="_idIndexMarker178"/>execution in BP can either <strong class="bold">block</strong> or <strong class="bold">not block</strong>. If the execution blocks, BP will wait until the program exits before moving on to the <span class="No-Break">next Stage:</span></p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="image/B18416_02_9.jpg" alt="Figure 2.9 – BP waits for a blocking program to complete" width="806" height="229"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – BP waits for a blocking program to complete</p>
			<p>If the script doesn’t block, it will continue to run in the background while BP progresses. BP won’t know when the script actually completes, unless it can explicitly wait and check for an external condition, such as the presence of a file written <span class="No-Break">to disk:</span></p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="image/B18416_02_10.jpg" alt="Figure 2.10 – BP continues to run while a non-blocking program executes" width="831" height="265"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – BP continues to run while a non-blocking program executes</p>
			<p>As a BP developer, it’s crucial to decide whether you want the triggered program to run in a blocking or non-blocking manner. In almost every case, we prefer BP to wait for a script to finish, even when a non-blocking script is running. This makes the development and debugging of the process simpler. The different ways of achieving this will be discussed later in <span class="No-Break">this chapter.</span></p>
			<p>The<a id="_idIndexMarker179"/> concept of <em class="italic">blocking versus non-blocking</em> is similar<a id="_idIndexMarker180"/> to the <em class="italic">synchronous versus asynchronous</em> discussion that we had for web APIs. Web API calls have a built-in concept of timing out. If an API request takes too long in BP, it will eventually be terminated, with an exception being thrown. Similarly, we also need to think about how to <strong class="bold">time out</strong> a program that is triggered from the command line, if it takes too long to run. We’ll see an example of how this can be done later in <span class="No-Break">this chapter.</span></p>
			<p>In this section, we looked at the fundamentals of the command line as it relates to BP. First was the concept of output streams. STDOUT<a id="_idIndexMarker181"/> is used to show regular output to the console<a id="_idIndexMarker182"/> screen and STDERR is used to show error messages. Next, we discussed how these two streams can be redirected into files, in both WCP and PS, using the <strong class="source-inline">&gt;</strong> redirection operator. Redirection allows us to capture the output of command-line programs <span class="No-Break">in BP.</span></p>
			<p>Then, we looked at the difference between blocking and non-blocking scripts, and stated that we’d prefer to pause BP execution until the script completes for predictability reasons. Finally, we introduced the concept of timeouts, in order to stop a command-line process from running for <span class="No-Break">too long.</span></p>
			<p>In the next section, we’ll be answering the following questions, <span class="No-Break">using examples:</span></p>
			<ol>
				<li>Which VBO and Action should I use to trigger <span class="No-Break">the prediction?</span></li>
				<li>How can I get the predicted results back <span class="No-Break">into BP?</span></li>
				<li>How can I stop a script that is running for <span class="No-Break">too long?</span></li>
			</ol>
			<h1 id="_idParaDest-35"><a id="_idTextAnchor035"/>Predicting from the command line using Utility – Environment</h1>
			<p>The <strong class="bold">Utility - Environment</strong> VBO, found<a id="_idIndexMarker183"/> in the VBO sub-folder where BP is installed, has three Actions that can be used to launch command-line scripts and <a id="_idIndexMarker184"/>external programs: <strong class="bold">Start Process</strong>, <strong class="bold">Start Process Read Stderr and Stdout</strong>, and <strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span><span class="No-Break">.</span></p>
			<p>Regardless of which Action you use, you will have to fill in at minimum two different input parameters in BP. One input parameter specifies <em class="italic">what program you want to run</em>, and another<a id="_idIndexMarker185"/> input parameter specifies <em class="italic">additional arguments to </em><span class="No-Break"><em class="italic">that program</em></span><span class="No-Break">.</span></p>
			<p>Let’s see two different ways of running a simple batch script, using the <strong class="bold">Start Process</strong> and <strong class="bold">Run Process Until </strong><span class="No-Break"><strong class="bold">Ended</strong></span><span class="No-Break"> Actions.</span></p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor036"/>Example 1 – Running a program using the Start Process</h2>
			<p>Let’s<a id="_idIndexMarker186"/> run a batch file that takes in two numbers<a id="_idIndexMarker187"/> as parameters from BP. To make setting up the example simpler, the batch file contents are saved to disk at the beginning of the Process. This batch file itself is responsible for writing two input parameters into an output file, <strong class="source-inline">C:\Users\Public\ch2_ex1_output.txt</strong>, so that we don’t need to do any redirection. At the end of the Process, we delete the batch file that was created. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Open the <strong class="bold">Example 1 – Running a program using Start Process</strong> BP Process in the <strong class="source-inline">Ch2</strong> Group, in <span class="No-Break">Process Studio.</span></li>
				<li>Open the <strong class="bold">Utility  Environment::Start Process</strong> Action, in the orange Block. See that we’re providing the path of the batch file as the <strong class="bold">Application</strong> Input Parameter, and two Data Items, separated by a space, as the <span class="No-Break"><strong class="bold">Arguments</strong></span><span class="No-Break"> Value:</span></li>
			</ol>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="image/B18416_02_11.jpg" alt="Figure 2.11 – Passing in the script path as the Application and the two parameters separated by a space as the Arguments" width="1199" height="567"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Passing in the script path as the Application and the two parameters separated by a space as the Arguments</p>
			<ol>
				<li value="3">Run the example once by pressing the <strong class="bold">Go</strong> button <span class="No-Break">or </span><span class="No-Break"><em class="italic">F5</em></span><span class="No-Break">.</span></li>
				<li>Verify that the batch script ran correctly by verifying the contents of the output text file, <strong class="source-inline">C:\Users\Public\ch2_ex1_output.txt</strong>. It should contain the text <strong class="source-inline">1234</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">5</strong></span><span class="No-Break">:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer054" class="IMG---Figure">
					<img src="image/B18416_02_12.jpg" alt="Figure 2.12 – The expected output file" width="759" height="329"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – The expected output file</p>
			<p>We’ve finished the most<a id="_idIndexMarker188"/> basic example of running a batch file and <a id="_idIndexMarker189"/>retrieving its output. Since the batch file itself wrote data into files, we didn’t have to do any redirection ourselves. Notice that there is a <strong class="bold">Sleep 1 second</strong> Action in our process diagram. This is needed because the <strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span></p>
			<p><strong class="bold">::Start Process</strong> Action is <em class="italic">non-blocking</em>. If the sleep Action isn’t there, it’s possible for the batch file to be deleted before it’s even <span class="No-Break">finished executing!</span></p>
			<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/>Example 2 - Running a program using Run Process Until Ended</h2>
			<p>Now, let’s <a id="_idIndexMarker190"/>modify the previous example, to get rid <a id="_idIndexMarker191"/>of the potentially unreliable 1-second sleep, and make the script <em class="italic">block</em>. This time, our output file will be saved <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">C:\Users\Public\ch2_ex2_output.txt</strong></span><span class="No-Break">:</span></p>
			<ol>
				<li>Open the <strong class="bold">Example 2 – Running a program using Run Process Until Ended</strong> BP Process in <span class="No-Break">Process Studio.</span></li>
				<li>Open the <strong class="bold">Utility  - Environment::Run Process Until Ended</strong> Action, in the orange Block. Note that the <strong class="bold">Arguments</strong> and <strong class="bold">Application</strong> inputs are identical to <em class="italic">Example 1</em>. The difference is that the Action has changed from <strong class="bold">Start Process</strong> to <strong class="bold">Run Process Until Ended</strong>. Also, see that the <strong class="bold">Timeout</strong> input is blank. When blank, the default is <span class="No-Break">10 seconds:</span></li>
			</ol>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="image/B18416_02_13.jpg" alt="Figure 2.13 – This Action is configured identically to Example 1" width="1007" height="790"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – This Action is configured identically to Example 1</p>
			<ol>
				<li value="3">Verify that the sleep Stage has been removed from the <span class="No-Break">Process diagram.</span></li>
				<li>Run the example once by pressing the <strong class="bold">Go</strong> button <span class="No-Break">or F5.</span></li>
				<li>Verify<a id="_idIndexMarker192"/> that the script was correctly run <a id="_idIndexMarker193"/>by opening Windows File Explorer and seeing that the <strong class="source-inline">C:\Users\Public\ch2_ex2_output.txt</strong> file contains the text <strong class="source-inline">abcd</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">e</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>We’ve switched the Action from <strong class="bold">Start Process</strong> in <em class="italic">Example 1</em> to <strong class="bold">Run Process Until Ended</strong> in <em class="italic">Example 2</em>. In <em class="italic">Example 1</em> using <strong class="bold">Start Process</strong>, BP executes both the Process steps and the batch script in a non-blocking manner. With <strong class="bold">Run Process Until Ended</strong> in <em class="italic">Example 2</em>, BP waits for a maximum of 10 seconds for the script to complete, before continuing with the Process steps. Despite preferring blocking execution most of the time, there might be situations where non-blocking <span class="No-Break">is desired.</span></p>
			<p>There’s still a third Action in <strong class="bold">Utility - Environment</strong> that <a id="_idIndexMarker194"/>we haven’t seen an example of yet: <strong class="bold">Start Process Read Stderr and Stdout</strong>. As you can guess by the name, this Action allows us to directly capture the two output streams, STDOUT, and STDERR, as Data Items in BP. Next, we will discuss the different ways of capturing output from command-line scripts back <span class="No-Break">into BP.</span></p>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor038"/>Getting prediction results back into BP</h1>
			<p>ML <a id="_idIndexMarker195"/>programs started from the command line will likely provide output in one of two ways: either by <em class="italic">printing the prediction output to the screen</em> or <em class="italic">writing the results to a file</em>. There are, of course, other options, such as sending the result to a separate system for you to retrieve, but those are outside the scope of this chapter. <em class="italic">Table 2.1</em> lists the most common ways of getting ML prediction output, and which Objects/Actions you can use to read it back <span class="No-Break">into BP:</span></p>
			<table id="table001-2" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Prediction </strong><span class="No-Break"><strong class="bold">Output Method</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Input Method </strong><span class="No-Break"><strong class="bold">into BP</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Object </strong><span class="No-Break"><strong class="bold">to Use</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Action</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style" rowspan="3">
							<p>Written <span class="No-Break">to screen</span></p>
						</td>
						<td class="No-Table-Style" rowspan="3">
							<p>Use VBO Action that directly reads <span class="No-Break">screen output</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Start Process Read Stderr </strong><span class="No-Break"><strong class="bold">and Stdout</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">PowerShell</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Run Script</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Script </strong><span class="No-Break"><strong class="bold">Execution VBO</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Execute Script</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style" rowspan="2">
							<p>Written <span class="No-Break">to screen</span></p>
						</td>
						<td class="No-Table-Style" rowspan="2">
							<p>Redirect to a file and read <span class="No-Break">the file</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment </strong></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Start Process</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment </strong></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style" rowspan="2">
							<p>Written <span class="No-Break">to file</span></p>
						</td>
						<td class="No-Table-Style" rowspan="2">
							<p>Read <span class="No-Break">the file</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility – </strong><span class="No-Break"><strong class="bold">Environment</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Start Process</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment </strong></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 2.1 – The different ways of reading prediction outputs back into BP</p>
			<p>If the<a id="_idIndexMarker196"/> prediction is printed to the console screen, there are two ways to get the result back into BP. The first, and simplest way is to <strong class="bold">use a VBO Action that directly captures output</strong> as Data Items in BP. The second way is to <strong class="bold">redirect</strong> the printed output into a file and then read the file into BP. Let’s look at an example of the <span class="No-Break">first case.</span></p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/>Example 3 – Saving STDOUT and STDERR as Data Items</h2>
			<p>In <a id="_idIndexMarker197"/>this example, we’ll build a Process<a id="_idIndexMarker198"/> from scratch that uses the <strong class="bold">Start Process Read Stderr and Stdout</strong> Action <a id="_idIndexMarker199"/>from the <strong class="bold">Utility - Environment</strong> VBO. This Action allows us to directly save STDERR and STDOUT as Data Items. A completed version of this example is available in this chapter’s Release for <span class="No-Break">your reference.</span></p>
			<p>This example also shows off the special syntax needed to run <em class="italic">internal commands</em> of Command Prompt from BP, in case you ever need to do so in the future. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Create a new Process named <strong class="bold">Example 3</strong> in the <em class="italic">Ch2</em> Group. Open it in <span class="No-Break">Process Studio.</span></li>
				<li>Add an <em class="italic">Action</em> Stage to the diagram. Choose <strong class="bold">Utility - Environment</strong> as the <em class="italic">Business Object</em> and <strong class="bold">Start Process Read Stderr and Stdout</strong> as <span class="No-Break">the </span><span class="No-Break"><em class="italic">Action</em></span><span class="No-Break">.</span></li>
				<li>Set the <strong class="bold">Process Name</strong> Input as <strong class="source-inline">"cmd.exe"</strong> (including the double quotation marks) and the <strong class="bold">Arguments</strong> Input as <strong class="source-inline">"/c dir"</strong>. The <strong class="source-inline">dir</strong> command lists out all of the files and directories inside of the BP installation folder. The BP installation folder is where the <strong class="source-inline">cmd.exe</strong> Command Prompt will be started from when we’re inside Process Studio. <strong class="source-inline">/c</strong> means terminate <strong class="source-inline">cmd.exe</strong> after the <strong class="source-inline">dir</strong> command is <span class="No-Break">finished executing.</span></li>
			</ol>
			<p class="callout-heading">Important note</p>
			<p class="callout">In order to run <em class="italic">internal commands</em> from WCP <a id="_idIndexMarker200"/>using the <strong class="bold">Utility - Environment</strong> VBO, such as <strong class="source-inline">dir</strong>, <strong class="source-inline">echo</strong>, <strong class="source-inline">copy</strong>, and so on, we need to put <strong class="source-inline">cmd.exe</strong> as the <em class="italic">Process name</em> and the command we want to run inside of WCP as <span class="No-Break">the </span><span class="No-Break"><em class="italic">Arguments</em></span><span class="No-Break">.</span></p>
			<ol>
				<li value="4">Click <a id="_idIndexMarker201"/>on the Action’s <strong class="bold">Outputs</strong> tab, and <a id="_idIndexMarker202"/>create <strong class="source-inline">Standard Output</strong> and <strong class="source-inline">Standard Error</strong> <span class="No-Break">Data Items.</span></li>
				<li>Link the Action between the Start and End Stages. The completed Process should look like <span class="No-Break">the following:</span></li>
			</ol>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="image/B18416_02_14.jpg" alt="Figure 2.14 – The completed test Process for Example 3" width="1617" height="685"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – The completed test Process for Example 3</p>
			<ol>
				<li value="6">Run the Process from Process Studio. The <strong class="source-inline">Standard Output</strong> Data Item will have content, whereas the <strong class="source-inline">Standard Error</strong> Data Item will stay empty. This is because the <strong class="source-inline">dir</strong> command succeeds with <span class="No-Break">no errors:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer057" class="IMG---Figure">
					<img src="image/B18416_02_15.jpg" alt="Figure 2.15 – Standard Output is populated" width="407" height="288"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Standard Output is populated</p>
			<ol>
				<li value="7">Modify the Action’s <strong class="bold">Arguments</strong> Input to <strong class="source-inline">"/c dir *.xyz"</strong>. This change means that we want to list all of the files with the <strong class="source-inline">.xyz</strong> file extension, which shouldn’t exist in the BP <span class="No-Break">installation folder.</span></li>
				<li>Run the test Process again. Both <strong class="source-inline">Standard Output</strong> and <strong class="source-inline">Standard Error</strong> Data <a id="_idIndexMarker203"/>Items should be populated, as <a id="_idIndexMarker204"/>there is <span class="No-Break">an error:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer058" class="IMG---Figure">
					<img src="image/B18416_02_16.jpg" alt="Figure 2.16 – Both Standard Output and Standard Error are populated" width="422" height="283"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – Both Standard Output and Standard Error are populated</p>
			<p>Notice that the actual console window did not pop up when running <em class="italic">Example 3</em>, yet we were able to capture the data that was printed to the console’s screen. Assuming that the ML prediction prints its output to the screen, a second way of capturing this data is to redirect the STDOUT and STDERR streams into files that can be read by BP. Let’s see how this can be done in the <span class="No-Break">next example.</span></p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/>Example 4 – Redirecting an internal command (dir) to files</h2>
			<p>We’ve already used the <strong class="bold">Run Process Until Ended</strong> Action from the <strong class="bold">Utility - Environment</strong> VBO, in <em class="italic">Example 2</em>. This Action doesn’t let us capture the STDOUT and<a id="_idIndexMarker205"/> STDERR directly <a id="_idIndexMarker206"/>as Data Items; however, the batch script itself in <em class="italic">Example 2</em> created a file that can be<a id="_idIndexMarker207"/> read back <span class="No-Break">into BP.</span></p>
			<p>In this example, we’ll create a new Process using this Object and Action again, except the batch script will print output to STDOUT and STDERR. We’ll need to redirect the STDOUT and STDERR streams to files so that they can be read into BP. A completed version of this example is available in this chapter’s Release for your reference. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Create <a id="_idIndexMarker208"/>a new Process named <strong class="bold">Example 4</strong>, in <a id="_idIndexMarker209"/>the <em class="italic">Ch2</em> Group. Open it in <span class="No-Break">Process Studio.</span></li>
				<li>Create two Data Items with a <strong class="source-inline">Text</strong> Data Type. These are the file paths where our redirected outputs will be saved. Set them up <span class="No-Break">as follows:</span></li>
			</ol>
			<table id="table002-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Data </strong><span class="No-Break"><strong class="bold">Item Name</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Initial Value</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Stdout File</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">C:\Users\Public\ch2_ex4_stdout.txt</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Stderr File</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">C:\Users\Public\ch4_ex4_stderr.txt</strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 2.2 – Configuring two Data Items to hold our file paths</p>
			<ol>
				<li>Add an <em class="italic">Action</em> Stage to the <a id="_idIndexMarker210"/>diagram. Choose Utility - Environment as the <em class="italic">Business Object</em> and <strong class="bold">Run Process Until Ended</strong> as the <em class="italic">Action</em>. Set the <strong class="bold">Application</strong> Input as <strong class="source-inline">"cmd.exe"</strong> (including the double quotation marks) and the <strong class="bold">Arguments</strong> Input as <strong class="source-inline">"/c dir *.xyz &gt; " &amp; Chr(34) &amp; [Stdout File] &amp; Chr(34) &amp; " 2&gt;" &amp; Chr(34) &amp; [Stderr File] &amp; </strong><span class="No-Break"><strong class="source-inline">Chr(34)</strong></span><span class="No-Break">.</span><p class="list-inset">The <strong class="bold">Arguments</strong> Input is the important part to understand here. The first part, <strong class="source-inline">"/c dir *.xyz</strong>, tries to list out a file that does not exist. The next part, <strong class="source-inline"> &gt; " &amp; Chr(34) &amp; [Stdout File] &amp; Chr(34)</strong>, redirects STDOUT to the file that we’ve defined. The <strong class="source-inline">&gt;</strong> character, as you know, means redirect. The <strong class="source-inline">Chr(34)</strong> instances are used to put double quotations around the file path, in case there are spaces. The last part, <strong class="source-inline">" 2&gt;" &amp; Chr(34) &amp; [Stderr File] &amp; Chr(34)</strong>, redirects STDERR to a <span class="No-Break">different file.</span></p></li>
				<li>Link the Action between the Start and End Stages. The completed Process should look like <span class="No-Break">the following:</span></li>
			</ol>
			<div>
				<div id="_idContainer059" class="IMG---Figure">
					<img src="image/B18416_02_17.jpg" alt="Figure 2.17 – The completed test Process for Example 4" width="1650" height="532"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – The completed test Process for Example 4</p>
			<ol>
				<li value="3">Run the Process in <span class="No-Break">Process Studio.</span></li>
				<li>Check the <strong class="source-inline">C:\Users\Public</strong> folder, and verify that the two output files have been created, <span class="No-Break">from redirection.</span></li>
			</ol>
			<p>In this example, we <a id="_idIndexMarker211"/>redirected the STDOUT and STDERR <a id="_idIndexMarker212"/>streams of a command internal to WCP, <strong class="source-inline">dir</strong>, to two separate files. Since the command is internal, we had to put <strong class="source-inline">"cmd.exe"</strong> as the <strong class="bold">Application</strong> Input. To perform the redirection, we simply added the necessary redirection syntax at the end of the <strong class="bold">Arguments</strong> Input. To actually get the output into BP, we would read the files that <span class="No-Break">were created.</span></p>
			<p>So far, we’ve covered all three of the Actions in <strong class="bold">Utility - Environment</strong> that allow us to start external programs from the command line. We’ve seen how they differ in terms of blocking and capturing output. This is summarized in the <span class="No-Break">following table:</span></p>
			<table id="table003-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Action</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Does </strong><span class="No-Break"><strong class="bold">it Block?</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Output </strong><span class="No-Break"><strong class="bold">Saving Method</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Is There </strong><span class="No-Break"><strong class="bold">Timeout Functionality?</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Start Process</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">No</span></p>
						</td>
						<td class="No-Table-Style">
							<p>None. Must use redirection and read the files <span class="No-Break">in BP.</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">No</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Run Process Until </strong><span class="No-Break"><strong class="bold">Ended</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Yes</span></p>
						</td>
						<td class="No-Table-Style">
							<p>None. Must use redirection and read the files <span class="No-Break">in BP.</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Yes</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Start Process Read Stderr </strong><span class="No-Break"><strong class="bold">and Stdout</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Yes</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Outputs are saved as <span class="No-Break">Data Items.</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">No</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 2.3 – A summary of the three Actions used to start command-line programs</p>
			<p>The last<a id="_idIndexMarker213"/> column of the table, <em class="italic">Is There Timeout Functionality?</em>, is the topic of the next section. This refers to whether there’s a built-in<a id="_idIndexMarker214"/> method to stop the external program from running if it’s taking <span class="No-Break">too long.</span></p>
			<h1 id="_idParaDest-41"><a id="_idTextAnchor041"/>Timing out long-running predictions</h1>
			<p>If the <a id="_idIndexMarker215"/>command-line script encounters a problem, it might hang and stall the BP Process forever if it’s blocking. Only one of the Actions has built-in functionality to time out a script that is running for too long: <strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">It’s possible to add timeout functionality to any command-line script or program by wrapping it in other scripts and using the <strong class="source-inline">start</strong>, <strong class="source-inline">timeout</strong>, and <strong class="source-inline">taskkill</strong> commands. However, these methods are more complex compared to just using <strong class="bold">Run Process Until Ended</strong> <span class="No-Break">plus redirection.</span></p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor042"/>Example 5 – PS script timeout</h2>
			<p>Let’s look at a more realistic ML <a id="_idIndexMarker216"/>example. Here, we have a PS script that calls an algorithm to predict whether a customer will cancel a retail store’s membership plan. Inputs are passed in from BP to the PS script, and then to the mock ML program. The mock ML program returns confidence scores for two labels: <strong class="source-inline">churn</strong> and <span class="No-Break"><strong class="source-inline">no churn</strong></span><span class="No-Break">.</span></p>
			<p>In this example, we have a collection of eight customers, along with some of their defining characteristics, such as age, job category, days since the last transaction, and average purchase size in dollars. Our Process will loop through all of the customers, call the PS script, and read the predicted confidence score of the <span class="No-Break"><em class="italic">churn</em></span><span class="No-Break"> label.</span></p>
			<p>The goal of <a id="_idIndexMarker217"/>this example is to examine and run this PS script and see how we can time it out if it takes <span class="No-Break">too long.</span></p>
			<ol>
				<li>Open <strong class="bold">Example 5 – PowerShell Script Timeout</strong> BP Process in the <em class="italic">Ch2</em> Group. We will look at the important <span class="No-Break">details together.</span></li>
				<li>Open the <strong class="bold">Utility - PowerShell::Run Process Until Ended</strong> Action, in the orange Block. Notice that we’ve set the <strong class="bold">Application</strong> Input to <strong class="source-inline">powershell.exe</strong>. Trying to put the PS script path into the <strong class="bold">Application</strong> Input won’t actually execute the script, but instead open the file using the default application, which is usually Notepad. The <strong class="bold">Arguments</strong> Input should look familiar to you as it contains the PS script parameters and the redirection file path. Also, note that the <strong class="bold">Timeout</strong> Input is empty, meaning that the script can run for at most <span class="No-Break">10 seconds.</span></li>
				<li>Run the example once by pressing <strong class="bold">Play to Go</strong>. You’ll see that the PS window will pop up while the script is running and <span class="No-Break">close afterward.</span></li>
				<li>Open the <strong class="bold">Current Values</strong> tab of the <strong class="source-inline">Predictions</strong> Collection and see that it contains the confidence scores of the <span class="No-Break">eight customers:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer060" class="IMG---Figure">
					<img src="image/B18416_02_18.jpg" alt="Figure 2.18 – The confidence scores of the successful predictions" width="941" height="973"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – The confidence scores of the successful predictions</p>
			<ol>
				<li value="5">Open the <strong class="bold">Utility - PowerShell::Run Process Until Ended</strong> Action, in the orange Block, and put <strong class="source-inline">MakeTimeSpan(0, 0, 0, 3)</strong> into the <strong class="bold">Timeout</strong> Input. The <a id="_idIndexMarker218"/>maximum time we allow the script to run is now <span class="No-Break">3 seconds:</span></li>
			</ol>
			<div>
				<div id="_idContainer061" class="IMG---Figure">
					<img src="image/B18416_02_19.jpg" alt="Figure 2.19 – Adding MakeTimeSpan(0, 0, 0, 3) to the Timeout input" width="1244" height="690"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Adding MakeTimeSpan(0, 0, 0, 3) to the Timeout input</p>
			<ol>
				<li value="6">Reset, and then run the example again. While the PS window is open, you should see an exception shown on screen, confirming that the timeout <span class="No-Break">is working:</span></li>
			</ol>
			<div>
				<div id="_idContainer062" class="IMG---Figure">
					<img src="image/B18416_02_20.jpg" alt="Figure 2.20 – The PS script has timed out" width="1033" height="561"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.20 – The PS script has timed out</p>
			<p><strong class="bold">Run Process Until Ended</strong> is the only Action that blocks and has timeout functionality. While it doesn’t have the ability to automatically read STDOUT and STDERR into Data Items, we can get around that using redirection. Because of this, <strong class="bold">Run Process Until Ended</strong> is the <strong class="bold">preferred Action to use for IA</strong>, assuming that you don’t want to custom-build a new Action or use <span class="No-Break">third-party VBOs.</span></p>
			<p>The other two Actions for triggering command-line processes are more situational. The <strong class="bold">Start Process Read Stderr and Stdout</strong> Action can be used if the command-line program that you’re starting has built-in methods to time out itself or whichever underlying processes <span class="No-Break">it creates.</span></p>
			<p>You may also encounter cases where there isn’t a good estimate for an appropriate timeout value. For example, if you’re predicting in batches, where some batches can take seconds while others can take hours, it makes sense to use the non-blocking <strong class="bold">Start Process</strong> Action<a id="_idIndexMarker219"/> and to check that the predictions are complete through some <span class="No-Break">other method.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Deployed ML models are not <em class="italic">build once, run forever</em>. As with all software, they should be updated and redeployed; for instance, to update the model with more training data, to tune model parameters differently, to apply security fixes to libraries used, and so on. Since the ML model can change independently of the BP solution, the timeout value should be changed outside of the Process or Object diagram as well. I’d recommend storing the timeout as <em class="italic">Environment Variables</em> in a <span class="No-Break">real solution.</span></p>
			<p>Now that we’ve covered the three Actions of the in-built <strong class="bold">Utility - Environment</strong> VBO, let’s look at two other VBOs that can be used to start command-line programs. Both are available for download <span class="No-Break">on DX.</span></p>
			<h1 id="_idParaDest-43"><a id="_idTextAnchor043"/>DX VBOs – Utility - PowerShell and Script Execution VBO</h1>
			<p>There are <a id="_idIndexMarker220"/>two notable assets available on DX that can be used to call command-line programs. They offer simplified interfaces to trigger programs, and other nice-to-have features that may make you want to choose them<a id="_idIndexMarker221"/> over <strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor044"/>Utility – PowerShell</h2>
			<p>This first VBO is <a id="_idIndexMarker222"/>specifically for<a id="_idIndexMarker223"/> PS, and it contains two Actions, <strong class="bold">Run Script</strong> and <strong class="bold">Run Script with PowerShell Core</strong>. PS Core is the latest version of PS; however, it’s not 100% backward compatible with older versions of PS. Older PS scripts might not run correctly under PS Core. PS Core is also not installed by default on most Windows versions. To <a id="_idIndexMarker224"/>avoid <a id="_idIndexMarker225"/>compatibility issues, we will be using the <strong class="bold">Run Script</strong> Action in the <span class="No-Break">next example.</span></p>
			<h3>Example 6 – Utility – PowerShell Run Script</h3>
			<p>Let’s revisit <em class="italic">Example 5</em>, where we triggered <a id="_idIndexMarker226"/>a PS script that gave us a prediction for user churn. This time, we’ll use the DX <span class="No-Break">VBO instead:</span></p>
			<ol>
				<li>Open the <strong class="bold">Example 6 – Utility  PowerShell Run Script</strong> BP Process in the <em class="italic">Ch2</em> Group. This example has already been built for you, but we’ll look at the important <span class="No-Break">details together.</span></li>
				<li>Open the <strong class="bold">Utility  PowerShell::Run Script</strong> Action, in the orange Block. Notice that the <strong class="bold">Parameters</strong> Input to the PS script must be entered in a specific format, <strong class="source-inline">parameter_name=parameter_value</strong>. Multiple parameters should be separated by commas. Also, notice that this Action directly saves the output streams as Data Items, so redirection <span class="No-Break">isn’t needed.</span></li>
				<li>Run the example once in Process Studio. Unlike running the PS script in <em class="italic">Example 5</em>, you won’t notice any PS windows <span class="No-Break">pop up!</span></li>
				<li>Verify that the <strong class="source-inline">Predictions</strong> Collection contains the confidence scores of the eight customers for <em class="italic">churn</em> and <em class="italic">no churn</em>. These should be the same as in <span class="No-Break"><em class="italic">Figure 2</em></span><span class="No-Break"><em class="italic">.18</em></span><span class="No-Break">.</span></li>
			</ol>
			<p>With the <strong class="bold">Run Script</strong> Action of this DX VBO, you gain the benefit of not needing output redirection and not seeing a pop-up window over using the Actions in <strong class="bold">Utility - Environment</strong>, which<a id="_idIndexMarker227"/> might be important for your use case. However, there’s also no built-in timeout functionality (although there is in <strong class="bold">Run Script with PowerShell Core</strong>). If you have the ability to install PS Core, I would recommend doing so that you can use the Action with <span class="No-Break">timeout functionality.</span></p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor045"/>Script Execution VBO</h2>
			<p>The <a id="_idIndexMarker228"/>second asset available on DX is<a id="_idIndexMarker229"/> the <strong class="bold">Script Execution VBO</strong>. Two Objects are included in this Release. The first, <strong class="bold">Script Execution VBO</strong>, is implemented in C#, and the<a id="_idIndexMarker230"/> second, <strong class="bold">Script Execution VBO  Visual Basic</strong>, is implemented in VB. There’s no functional difference between the two, so we’ll use the C# version in our next example. Each VBO contains only one Action, <span class="No-Break"><strong class="bold">Execute Script</strong></span><span class="No-Break">.</span></p>
			<p>One superficial reason why you might want to use this VBO is that your BP Action Inputs will look cleaner. As you’ll have noticed, adding redirection and full file paths, surrounding them with double quotation characters, <strong class="source-inline">Chr(34)</strong>, and so on, can make for messy, and hard-to-understand input arguments to the Action. This VBO minimizes this somewhat as it provides separate input parameters for the script engine, the script path, and the script name. A more practical reason for using this is that it starts external programs using desirable defaults, such as blocking, not popping up a command window, and capturing output into Data Items. However, it lacks <span class="No-Break">timeout functionality.</span></p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor046"/>Example 7 – Calling a Python program</h2>
			<p>Let’s call a Python<a id="_idIndexMarker231"/> script that predicts the selling price of a house based on square footage, number of bedrooms, number of bathrooms, previous selling price, and age in years. Since this is a <em class="italic">regression</em> problem, the Python script returns a numerical prediction, as opposed to labels and confidence scores. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Open the <strong class="bold">Example 7 – Script Execution VBO Calling a Python Script</strong> BP Process in the <em class="italic">Ch2</em> Group. This example has already been built for you, but we’ll look at the important <span class="No-Break">details together.</span></li>
				<li>Open the command line, <strong class="source-inline">cmd.exe</strong>, and find the location of your Python executable. This might be named <strong class="source-inline">py.exe</strong> or <strong class="source-inline">python.exe</strong>. In WCP, type the following (or substitute <strong class="source-inline">py.exe</strong> with <strong class="source-inline">python.exe</strong> if you don’t find <span class="No-Break">a result):</span><pre class="source-code">
<strong class="bold">&gt; where py.exe</strong></pre><p class="list-inset">Ensure that the path that is returned from WCP matches the location of the <strong class="source-inline">Python Executable Full Path</strong> Data Item in the <span class="No-Break">red block:</span></p></li>			</ol>
			<div>
				<div id="_idContainer063" class="IMG---Figure">
					<img src="image/B18416_02_21.jpg" alt="Figure 2.21 – Making the Python Executable Full Path Data Item match your Python location" width="1153" height="303"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.21 – Making the Python Executable Full Path Data Item match your Python location</p>
			<ol>
				<li value="3">Open the <strong class="bold">Script Execution VBO::Execute Script</strong> Action, in the orange Block. Notice<a id="_idIndexMarker232"/> that it looks relatively cleaner, due to the separation of inputs, and that redirection <span class="No-Break">isn’t needed:</span></li>
			</ol>
			<div>
				<div id="_idContainer064" class="IMG---Figure">
					<img src="image/B18416_02_22.jpg" alt="Figure 2.22 – The input parameters are nicely separated" width="1281" height="542"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.22 – The input parameters are nicely separated</p>
			<ol>
				<li value="4">Run the Process once in Process Studio. Notice that the Action <em class="italic">blocks</em> and doesn’t pop up <span class="No-Break">any windows.</span></li>
				<li>Verify that the values predicted from Python are saved as <span class="No-Break">Data Items:</span></li>
			</ol>
			<div>
				<div id="_idContainer065" class="IMG---Figure">
					<img src="image/B18416_02_23.jpg" alt="Figure 2.23 – The predicted property price" width="735" height="457"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.23 – The predicted property price</p>
			<p>We’ve now <a id="_idIndexMarker233"/>covered seven examples of how to start command-line programs in this chapter. Each example was designed to show something different in <span class="No-Break">terms of:</span></p>
			<ul>
				<li>The type of script that <span class="No-Break">is run</span></li>
				<li>Which VBO and Action <span class="No-Break">are used</span></li>
				<li>How output is read back <span class="No-Break">into BP</span></li>
				<li>Whether the Action blocks or does <span class="No-Break">not block</span></li>
				<li>Whether the Action allows <span class="No-Break">for timeout</span></li>
			</ul>
			<p>A table that summarizes all of the examples is <span class="No-Break">shown next:</span></p>
			<table id="table004-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Example</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Script Type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Call </strong><span class="No-Break"><strong class="bold">Script VBO/Action</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Read </strong><span class="No-Break"><strong class="bold">Output Method</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Blocking?</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Timeout?</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>1</p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">bat</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span><span class="No-Break">/</span>
<span class="No-Break"><strong class="bold">Start Process</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>The script writes output to <span class="No-Break">a file</span></p>
						</td>
						<td class="No-Table-Style">
							<p>N</p>
						</td>
						<td class="No-Table-Style">
							<p>N</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>2</p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">bat</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - </strong><span class="No-Break"><strong class="bold">Environment</strong></span><span class="No-Break">/</span>
<strong class="bold">Run Process Until </strong><span class="No-Break"><strong class="bold">Ended</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>The script writes output to <span class="No-Break">a file</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>N (although leaving the parameter blank means <span class="No-Break">10 seconds)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>3</p>
						</td>
						<td class="No-Table-Style">
							<p>Internal command (<span class="No-Break"><strong class="source-inline">dir</strong></span><span class="No-Break">)</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment</strong>/<strong class="bold">Start Process Read Stderr </strong><span class="No-Break"><strong class="bold">and Stdout</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>VBO Action saves output as <span class="No-Break">Data Items</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>N</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>4</p>
						</td>
						<td class="No-Table-Style">
							<p>Internal command (<span class="No-Break"><strong class="source-inline">dir</strong></span><span class="No-Break">)</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment</strong>/<strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Redirection <span class="No-Break">into files</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>N (although leaving the parameter blank means <span class="No-Break">10 seconds)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>5</p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">ps1</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - Environment</strong>/<strong class="bold">Run Process </strong><span class="No-Break"><strong class="bold">Until Ended</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Redirection <span class="No-Break">into files</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>6</p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">ps1</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Utility - PowerShell</strong>/ <span class="No-Break"><strong class="bold">Run Script</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>VBO Action saves output as <span class="No-Break">Data Items</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>N (although the PS Core Action <span class="No-Break">has timeout)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>7</p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">py</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Script Execution </strong><span class="No-Break"><strong class="bold">VBO</strong></span><span class="No-Break">/</span><span class="No-Break"><strong class="bold">Execute Script</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>VBO Action saves output as <span class="No-Break">Data Items</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Y</p>
						</td>
						<td class="No-Table-Style">
							<p>N</p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 2.4 – A summary of how all of the examples differ</p>
			<h1 id="_idParaDest-47"><a id="_idTextAnchor047"/>Summary</h1>
			<p>You may be required to connect BP to ML through an executable, a batch script, a PS script, or to directly execute source code. This chapter covered three important concepts that underlie running programs through the command line in BP. The first is the concept of <em class="italic">output streams</em>. STDOUT is used for displaying regular output to the command-line window, and STDERR is used for displaying errors. The second concept is <em class="italic">redirection</em>, which allows us to capture STDOUT and STDERR into files so that they can be read back into BP. The third concept is <em class="italic">blocking versus non-blocking</em> execution. BP will wait for blocking programs to complete before proceeding with further automation steps. Process logic is simpler to understand if we can trigger external programs to run in a <span class="No-Break">blocking manner.</span></p>
			<p>We also covered three VBOs: one built into BP and two from DX. The built-in VBO, <strong class="bold">Utility - Environment</strong>, has three Actions that can be used, but <strong class="bold">Run Process Until Ended</strong> is preferred as it’s the only Action that can natively time out long-running scripts. The other two Actions have more niche use cases. <strong class="bold">Start Process</strong> can be used if blocking is not desired, and <strong class="bold">Start Process Read Stderr and Stdout</strong> can be used if the script knows how to time <span class="No-Break">itself out.</span></p>
			<p>The <strong class="bold">Utility - PowerShell</strong> DX asset can be used specifically with PS scripts. It’s able to execute scripts without showing the PS window on the screen, and the <strong class="bold">Run Script with PowerShell Core</strong> Action also has timeout capability. <strong class="bold">Script Execution VBO</strong> is more oriented to starting programs with complicated executable input parameters, such as those <span class="No-Break">from Python.</span></p>
			<p>In <em class="italic">Chapters 1</em> and <em class="italic">2</em>, we covered how to connect BP to ML through web APIs and the command-line interface. In the next chapter, we’ll look at the third way of connecting BP to ML, which is through <span class="No-Break">Code Stages.</span></p>
		</div>
	</div>
</div>
</body></html>