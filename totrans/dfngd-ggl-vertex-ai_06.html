<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><div id="_idContainer075">
			<h1 id="_idParaDest-80" class="chapter-number"><a id="_idTextAnchor079"/>6</h1>
			<h1 id="_idParaDest-81"><a id="_idTextAnchor080"/>Low-Code Options for Building ML Models</h1>
			<p><strong class="bold">BigQuery Machine Learning</strong>, often abbreviated as <strong class="bold">BQML</strong>, is a tool offered as part of Google Cloud that seamlessly merges the worlds of data warehousing and ML. Designed to bridge the gap between data analysts and ML models, BQML empowers individuals to build, evaluate, and predict with ML models directly within the confines of BigQuery, without the need to move data or master a <span class="No-Break">new toolset.</span></p>
			<p>This integration not only simplifies the process of model creation but also presents an intuitive transition for those familiar with SQL. With just a few statements, you can go from data analysis to <span class="No-Break">predictive insights.</span></p>
			<p>In this chapter, we will go over the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>What <span class="No-Break">is BQML?</span></li>
				<li>Using BQML for <span class="No-Break">feature transformations</span></li>
				<li>Building ML models <span class="No-Break">with BQML</span></li>
				<li>Doing inference <span class="No-Break">with BQML</span></li>
			</ul>
			<h1 id="_idParaDest-82"><a id="_idTextAnchor081"/>What is BQML?</h1>
			<p>BQML is a <a id="_idIndexMarker267"/>powerful, built-in ML service provided by Google Cloud that allows users to create, train, and deploy ML models using familiar SQL queries. BQML is designed to simplify the process of building and deploying ML models for those who may not have a strong background in data science or programming. In this chapter, we will explore the key features and capabilities of BQML and how you can use it to leverage the power of Google Cloud AI for <span class="No-Break">your projects.</span></p>
			<p>BQML provides a seamless way to integrate ML into your data analytics workflows without requiring a deep understanding of ML concepts or programming languages. With BQML, you can do <span class="No-Break">the following:</span></p>
			<ul>
				<li>Create and train ML models using <span class="No-Break">SQL queries</span></li>
				<li>Make predictions using <span class="No-Break">trained models</span></li>
				<li>Evaluate the performance of <span class="No-Break">your models</span></li>
				<li>Perform feature transformation and <span class="No-Break">hyperparameter tuning</span></li>
				<li>Understand model explanations <span class="No-Break">and weights</span></li>
				<li>Export and <span class="No-Break">import models</span></li>
			</ul>
			<p>Utilizing BQML <a id="_idIndexMarker268"/>offers <span class="No-Break">numerous advantages:</span></p>
			<ul>
				<li>BQML eliminates the need to load data into local memory, thereby addressing the constraint posed by <span class="No-Break">sizable datasets</span></li>
				<li>BQML streamlines the ML process by handling standard tasks such as dividing data into train and test sets, selecting and adjusting learning rates, and choosing an <span class="No-Break">optimization approach</span></li>
				<li>With automatic versioning of BQML models, tracking alterations and reverting to earlier versions when needed <span class="No-Break">becomes effortless</span></li>
				<li>When serving predictions, BQML models can be seamlessly integrated with <span class="No-Break">Vertex AI</span></li>
			</ul>
			<p>There are <a id="_idIndexMarker269"/>also a few limitations to <span class="No-Break">using BQML:</span></p>
			<ul>
				<li><strong class="bold">Limited model types</strong>: BQML supports a restricted set of ML models, such as linear regression, logistic regression, k-means clustering, matrix factorization, and others. It may not meet the requirements of projects that necessitate advanced or <span class="No-Break">specialized models.</span></li>
				<li><strong class="bold">Customizability</strong>: BQML’s automated approach to ML means that there is limited scope for customization. Users might not be able to fine-tune models or experiment with different model architectures as they could with other <span class="No-Break">ML frameworks.</span></li>
				<li><strong class="bold">Scalability</strong>: Although BQML is designed for handling large datasets, it may not scale as <a id="_idIndexMarker270"/>effectively as other distributed ML frameworks when working with extremely large datasets or <span class="No-Break">complex models.</span></li>
				<li><strong class="bold">Limited support for deep learning</strong>: BQML does not support training for deep learning models for unstructured data, which may be essential for certain use cases such as image recognition, natural language processing, or speech recognition. However, it does provide options to import pre-trained TensorFlow, TensorFlow Lite, and ONNX models trained on image data. Once imported into BigQuery, you can use the <strong class="source-inline">ML.PREDICT</strong> function to make predictions based on images. BQML now also supports adding <strong class="bold">remote models</strong> as API endpoints, which opens up the possibility of adding any model hosted on Vertex AI endpoints or adding other cloud-based ML services such as Vision API to support additional <span class="No-Break">use cases.</span></li>
				<li><strong class="bold">Feature engineering</strong>: BQML might not be the best option for extensive feature engineering as it focuses more on simplifying the ML process. Users may need to perform feature engineering outside of BQML for advanced feature engineering tasks. We will discuss the limitations in more detail in the <em class="italic">Feature engineering</em> section of <span class="No-Break">this chapter.</span></li>
				<li><strong class="bold">External data sources</strong>: BQML works primarily with Google BigQuery data, limiting its flexibility in terms of data sources. If you want to use data from different sources or formats, you might need to import it into <span class="No-Break">BigQuery first.</span></li>
				<li><strong class="bold">Model portability</strong>: BQML models are tightly integrated with Google Cloud. Exporting models for use outside of the Google ecosystem may be challenging and might require <span class="No-Break">additional work.</span></li>
			</ul>
			<p>Now let’s look at how you can start using BigQuery for <span class="No-Break">ML solutions.</span></p>
			<h1 id="_idParaDest-83"><a id="_idTextAnchor082"/>Getting started with BigQuery</h1>
			<p>Google BigQuery is a serverless, fully managed data warehouse that enables super-fast SQL queries <a id="_idIndexMarker271"/>using the processing power of Google’s infrastructure. Since BigQuery is not part of Vertex AI, we won’t be covering the features of the tool in depth in this book, but here’s a quick guide on getting started. This should be enough information to help you follow along with the exercises later in <span class="No-Break">this chapter:</span></p>
			<ol>
				<li><strong class="bold">Set up a Google Cloud project</strong>: Before you can use BigQuery, you’ll need to set up a <strong class="bold">Google Cloud Platform</strong> (<strong class="bold">GCP</strong>) project. Head over to the Google Cloud <a id="_idIndexMarker272"/>console and create a new project. If you’ve never used GCP before, you might need to create an account and set up <span class="No-Break">billing information.</span></li>
				<li><strong class="bold">Enable the BigQuery API</strong>: Within your GCP project, navigate to the <strong class="bold">API &amp; Services</strong> section and enable the <span class="No-Break">BigQuery API.</span></li>
				<li><strong class="bold">Access the BigQuery console</strong>: Once the API has been enabled, you can access the BigQuery console either via the GCP dashboard or directly through the BigQuery console <span class="No-Break">link (</span><a href="https://console.cloud.google.com/bigquery"><span class="No-Break">https://console.cloud.google.com/bigquery</span></a><span class="No-Break">).</span></li>
				<li><strong class="bold">Create a dataset</strong>: Datasets are containers for tables, views, and other data objects in BigQuery. To create one, click on the vertical ellipsis next to your GCP project name in the BigQuery console, select <strong class="bold">Create Dataset</strong>, and fill in the dataset’s name. Then, click <span class="No-Break"><strong class="bold">Create Dataset</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">Load data</strong>: BigQuery supports various data formats, including CSV, JSON, and others. You can load data into BigQuery from Google Cloud Storage, send data directly with an API request, or manually upload files. To load data, navigate to your dataset in the BigQuery console on the left, click <strong class="bold">Create Table</strong>, and follow <span class="No-Break">the prompts.</span></li>
				<li><strong class="bold">Run SQL queries</strong>: With data loaded into BigQuery, you can then run SQL queries. Use the query editor in the BigQuery console to start analyzing your data <span class="No-Break">using SQL.</span></li>
			</ol>
			<p>Now, let’s look at <a id="_idIndexMarker273"/>how you can use BigQuery’s native functions to do large-scale feature/data transformations to prepare training data for the <span class="No-Break">ML models.</span></p>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor083"/>Using BQML for feature transformations</h1>
			<p>Two <a id="_idIndexMarker274"/>types of feature preprocessing are supported <span class="No-Break">by BQML:</span></p>
			<ul>
				<li><strong class="bold">Automatic preprocessing</strong>: During <a id="_idIndexMarker275"/>training, BQML carries out automatic preprocessing. For further details, please carries out automatic preprocessing like missing data imputation, one-hot encoding, and timestamp transformation <span class="No-Break">and encoding</span><span class="No-Break">.</span></li>
				<li><strong class="bold">Manual preprocessing</strong>: You can use the <strong class="source-inline">TRANSFORM</strong> clause provided by BQML <a id="_idIndexMarker276"/>to define customized preprocessing using manual preprocessing functions. These functions can also be utilized outside the <span class="No-Break"><strong class="source-inline">TRANSFORM</strong></span><span class="No-Break"> clause.</span></li>
			</ul>
			<p>While <a id="_idIndexMarker277"/>BQML does support some feature engineering tasks, it has certain limitations compared to more flexible and feature-rich <span class="No-Break">ML frameworks:</span></p>
			<ul>
				<li><strong class="bold">Limited preprocessing functions</strong>: BQML provides a basic set of SQL functions for data preprocessing, such as scaling and encoding. However, it may <a id="_idIndexMarker278"/>lack some advanced preprocessing techniques or specialized functions available in other ML <a id="_idIndexMarker279"/>libraries such as <strong class="bold">scikit-learn</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="bold">TensorFlow</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">No automated feature selection</strong>: BQML does not offer automated feature selection methods to identify the most important variables in your dataset. You must manually select and engineer features based on your domain knowledge and intuition, or use external tools for <span class="No-Break">feature selection.</span></li>
				<li><strong class="bold">Complex feature transformations</strong>: BQML’s SQL-based approach may not be well suited for certain complex feature transformations that involve non-linear combinations, rolling windows, or sequential patterns in the data. In such cases, you may need to preprocess your data using other tools or programming languages before <span class="No-Break">using BQML.</span></li>
				<li><strong class="bold">Custom feature generation</strong>: BQML lacks the flexibility to create custom features, such as domain-specific functions or transformations, as easily as you can with <a id="_idIndexMarker280"/>more versatile ML libraries. You might need to implement these custom features outside of BQML, which could be cumbersome and <span class="No-Break">less efficient.</span></li>
				<li><strong class="bold">Feature engineering pipelines</strong>: BQML does not provide a built-in mechanism to create and manage reusable feature engineering pipelines. In contrast, other ML frameworks offer functionality to build modular and maintainable pipelines, streamlining the process of applying the same transformations to training and validation datasets or during <span class="No-Break">model deployment.</span></li>
			</ul>
			<p>While BQML simplifies the ML process, it may not be the best choice for projects that require extensive or advanced feature engineering. In such cases, you may need to preprocess your data using external tools or libraries and then import the transformed data into BigQuery for further analysis <span class="No-Break">with BQML.</span></p>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor084"/>Manual preprocessing</h2>
			<p>BQML provides <a id="_idIndexMarker281"/>a variety of <a id="_idIndexMarker282"/>manual preprocessing functions that can be utilized with the <strong class="source-inline">CREATE MODEL</strong> syntax to preprocess your data before training. These functions can also be used outside the <strong class="source-inline">TRANSFORM</strong> clause. These preprocessing functions can be scalar, operating on a single row, or analytic, operating on all rows and outputting results based on statistics collected across all rows. When ML analytic functions are used inside the <strong class="source-inline">TRANSFORM</strong> clause during training, the same statistics are automatically applied to the input <span class="No-Break">in prediction.</span></p>
			<p>The following table lists all the supported data preprocessing functions <span class="No-Break">in BigQuery:</span></p>
			<table id="table001-4" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Function Name</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.BUCKETIZE</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Bucketizes a numerical expression into user-defined categories based on provided <span class="No-Break">split points</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.POLYNOMIAL_EXPAND</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Generates polynomial combinations of a given set of numerical features up to a <span class="No-Break">specified degree</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.FEATURE_CROSS</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Generates feature crosses of categorical features up to a <span class="No-Break">specified degree</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.NGRAMS</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Extracts n-grams from an array of tokens, based on a given range of <span class="No-Break"><em class="italic">n</em></span><span class="No-Break"> values</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.QUANTILE_BUCKETIZE</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Bucketizes a numerical expression into quantile-based categories based on <span class="No-Break">several buckets</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.HASH_BUCKETIZE</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Bucketizes a string expression into a fixed number of <span class="No-Break">hash-based buckets</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.MIN_MAX_SCALER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Scales a numerical expression to the range [0, 1] capped with <strong class="source-inline">MIN</strong> and <strong class="source-inline">MAX</strong> across <span class="No-Break">all rows</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.STANDARD_SCALER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Standardizes a <span class="No-Break">numerical expression</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.MAX_ABS_SCALER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Scales a numerical expression to the range [-1, 1] by dividing through the largest maximum <span class="No-Break">absolute value</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.ROBUST_SCALER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Scales a numerical expression using statistics that are robust <span class="No-Break">to outliers</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.NORMALIZER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Normalizes an array expression to have a unit norm using the <span class="No-Break">given p-norm</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.IMPUTER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Replaces <strong class="source-inline">NULL</strong> in an expression using a specified value (for example, mean, median, or <span class="No-Break">most frequent)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.ONE_HOT_ENCODER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Encodes a string expression using a one-hot <span class="No-Break">encoding scheme</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ML.LABEL_ENCODER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Encodes a string expression to an <strong class="source-inline">INT64</strong> in <strong class="source-inline">[</strong><span class="No-Break"><strong class="source-inline">0, n_categories]</strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 6.1 – Data transformation functions</p>
			<p>Here is a <a id="_idIndexMarker283"/>list of all the functions with their inputs and outputs, as well <a id="_idIndexMarker284"/>as an example <span class="No-Break">for each:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">ML.BUCKETIZE</strong></span><p class="list-inset">Bucketizes a numerical expression into user-defined categories based on provided <span class="No-Break">split points.</span></p><p class="list-inset"><span class="No-Break">Input:</span></p><ul><li><strong class="source-inline">numerical_expression</strong>: Numerical expression <span class="No-Break">to bucketize.</span></li><li><strong class="source-inline">array_split_points</strong>: Sorted numerical array with <span class="No-Break">split points.</span></li><li><strong class="source-inline">exclude_boundaries</strong> (optional): If <strong class="source-inline">TRUE</strong>, the two boundaries are removed from <strong class="source-inline">array_split_points</strong>. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">FALSE</strong></span><span class="No-Break">.</span></li></ul><p class="list-inset"><span class="No-Break">Output:</span></p><p class="list-inset"><strong class="source-inline">STRING</strong> is the name of the buckets into which the <strong class="source-inline">numerical_expression</strong> field <span class="No-Break">is split.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 21 AS age UNION ALL
SELECT 33 AS age UNION ALL
SELECT 45 AS age UNION ALL SELECT 59 AS age UNION ALL
SELECT 66 AS age )
SELECT age, ML.BUCKETIZE(age, [18, 35, 50, 65]) AS age_bucket
FROM dataset;</pre><p class="list-inset">Submitting <a id="_idIndexMarker285"/>this query in BigQuery should generate the <span class="No-Break">following output:</span></p><pre class="source-code">age  age_bucket
21  bin_2
33  bin_2
45  bin_3
59  bin_4
bin_5</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.FEATURE_CROSS</strong></span><p class="list-inset">This <a id="_idIndexMarker286"/>generates feature crosses of categorical features up to a <span class="No-Break">specified degree:</span></p><pre class="source-code">
Input: array_expression, degree
Output: ARRAY&lt;STRUCT&lt;name STRING, value FLOAT64&gt;&gt;</pre><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">WITH dataset AS (
SELECT "dog" AS animal, "brown" AS color UNION ALL
SELECT "cat" AS animal, "black" AS color UNION ALL
SELECT "bird" AS animal, "yellow" AS color UNION ALL
SELECT "fish" AS animal, "orange" AS color)
SELECT animal, color, ML.FEATURE_CROSS(STRUCT(animal, color)) AS animal_color
FROM dataset;</pre><p class="list-inset">Submitting this query in BigQuery should generate the <span class="No-Break">following output:</span></p></li>			</ul>
			<table id="table002" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">animal</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">animal_color</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">dog</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">brown</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">dog_brown</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">cat</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">black</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">cat_black</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">bird</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">yellow</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">bird_yellow</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">fish</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">orange</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">fish_orange</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Figure">Table 6.2 – BigQuery Query Output</p>
			<p class="list-inset">Note that the <strong class="source-inline">ML.FEATURE_CROSS</strong> function can be used to create a cross of multiple <a id="_idIndexMarker287"/>columns if you include more columns in the <span class="No-Break"><strong class="source-inline">ARRAY</strong></span><span class="No-Break"> argument.</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">ML.NGRAMS</strong></span><p class="list-inset">This <a id="_idIndexMarker288"/>extracts n-grams from an array of tokens, based on a given range of <span class="No-Break"><em class="italic">n</em></span><span class="No-Break"> values.</span></p><p class="list-inset"><span class="No-Break">Input:</span></p><ul><li><strong class="source-inline">array_input</strong>: <strong class="source-inline">ARRAY</strong> of <strong class="source-inline">STRING</strong>. The strings are the tokens to be merged. </li><li><strong class="source-inline">range</strong>: <strong class="source-inline">ARRAY</strong> of two <strong class="source-inline">INT64</strong> elements or a single <strong class="source-inline">INT64</strong>. These two sorted <strong class="source-inline">INT64</strong> elements in the <strong class="source-inline">ARRAY</strong> input are the range of n-gram sizes to return. A single <strong class="source-inline">INT64</strong> is equivalent to the range of [<span class="No-Break">x, x].</span></li><li><strong class="source-inline">separator</strong>: Optional <strong class="source-inline">STRING</strong>. <strong class="source-inline">separator</strong> connects two adjacent tokens in the output. The default value <span class="No-Break">is whitespace.</span></li></ul><p class="list-inset">Output: <strong class="source-inline">ARRAY</strong> <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">STRING</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT "apple" AS fruit, "cherry" AS fruit2,"pear" AS fruit3 UNION ALL
SELECT "banana" AS fruit, "banana" AS fruit2,"melon" AS fruit3 UNION ALL
SELECT "cherry" AS fruit, "cherry" AS fruit2, "pineapple" AS fruit3)
SELECT fruit,fruit2,fruit3, ML.NGRAMS([fruit,fruit2,fruit3], [2]) AS fruit_ngrams
FROM dataset;</pre><p class="list-inset">Submitting <a id="_idIndexMarker289"/>this query in <a id="_idIndexMarker290"/>BigQuery should generate the <span class="No-Break">following output:</span></p></li>			</ul>
			<table id="table003" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">fruit</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">fruit2</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">fruit3</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">fruit_ngrams</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">apple</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">cherry</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">pear</span></p>
						</td>
						<td class="No-Table-Style">
							<p>[apple cherry, <span class="No-Break">cherry pear]</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">banana</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">banana</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">melon</span></p>
						</td>
						<td class="No-Table-Style">
							<p>[banana banana, <span class="No-Break">banana melon]</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">cherry</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">cherry</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">pineapple</span></p>
						</td>
						<td class="No-Table-Style">
							<p>[cherry cherry, <span class="No-Break">cherry pineapple]</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Figure">Table 6.3 – Output from BigQuery </p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">ML.QUANTILE_BUCKETIZE</strong></span><p class="list-inset">This bucketizes a numerical expression into quantile-based categories based on <span class="No-Break">several buckets.</span></p><p class="list-inset"><span class="No-Break">Input:</span></p><ul><li><strong class="source-inline">numerical_expression</strong>: Numerical expression <span class="No-Break">to bucketize</span></li><li><strong class="source-inline">num_buckets</strong>: <strong class="source-inline">INT64</strong>. The number of buckets to split <span class="No-Break"><strong class="source-inline">numerical_expression</strong></span><span class="No-Break"> into</span></li></ul><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">STRING</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an <a id="_idIndexMarker291"/>example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 21 AS age UNION ALL
SELECT 33 AS age UNION ALL
SELECT 45 AS age UNION ALL
SELECT 59 AS age UNION ALL
SELECT 66 AS age)
SELECT age, ML.QUANTILE_BUCKETIZE(age, 4) OVER() AS age_bucket
FROM dataset
ORDER BY age;</pre><p class="list-inset">In this <a id="_idIndexMarker292"/>example, we create a virtual table dataset with five rows of age data. Then, we use the <strong class="source-inline">ML.QUANTILE_BUCKETIZE</strong> function to bucketize the <strong class="source-inline">age</strong> column into four quantile buckets. The resulting <strong class="source-inline">age_bucket</strong> column shows which quantile bucket each row of the dataset <span class="No-Break">belongs to.</span></p><p class="list-inset">Here’s <span class="No-Break">the output:</span></p><pre class="source-code">age  age_bucket
21  bin_1
33  bin_2
45  bin_3
59  bin_4
66  bin_4</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.HASH_BUCKETIZE</strong></span><p class="list-inset">This bucketizes <a id="_idIndexMarker293"/>a string expression into a fixed number of <span class="No-Break">hash-based buckets.</span></p><p class="list-inset"><span class="No-Break">Input:</span></p><ul><li><strong class="source-inline">string_expression</strong>: <strong class="source-inline">STRING</strong>. The string expression <span class="No-Break">to bucketize.</span></li><li><strong class="source-inline">hash_bucket_size</strong>: <strong class="source-inline">INT64</strong>. The number of buckets. Expected <strong class="source-inline">hash_bucket_size &gt;= 0</strong>. If <strong class="source-inline">hash_bucket_size = 0</strong>, the function <a id="_idIndexMarker294"/>only hashes the string without bucketizing the <span class="No-Break">hashed value.</span></li></ul><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">INT64</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT "horse" AS animal UNION ALL
SELECT "cat" AS animal UNION ALL
SELECT "dog" AS animal UNION ALL
SELECT "fish" AS animal)
SELECT animal, ML.HASH_BUCKETIZE(animal, 2) AS animal_bucket FROM dataset;</pre><p class="list-inset">In this example, we create a virtual table dataset with four rows of data. Then, we use the <strong class="source-inline">ML.HASH_BUCKETIZE</strong> function to hash the <strong class="source-inline">animal</strong> column into two buckets. The resulting <strong class="source-inline">animal_bucket</strong> column shows which hash bucket each row of the dataset <span class="No-Break">belongs to.</span></p><p class="list-inset">Note that the <strong class="source-inline">ML.HASH_BUCKETIZE</strong> function can be used to hash the values of a column into a different number of buckets by specifying a different value for the <span class="No-Break">second argument.</span></p><p class="list-inset">Here’s <span class="No-Break">the output:</span></p><pre class="source-code">animal  animal_bucket
horse    1
cat    0
dog    0
fish  0</pre><p class="list-inset">In <a id="_idIndexMarker295"/>this example, we create <a id="_idIndexMarker296"/>a virtual table dataset with four rows of data. Then, we use the <strong class="source-inline">ML.HASH_BUCKETIZE</strong> function to hash the animal column into two buckets. The resulting <strong class="source-inline">animal_bucket</strong> column shows which hash bucket each row of the dataset <span class="No-Break">belongs to.</span></p></li>				<li><span class="No-Break"><strong class="source-inline">ML.MIN_MAX_SCALER</strong></span><p class="list-inset">Scales a numerical expression to the range [0, 1] capped with <strong class="source-inline">MIN</strong> and <strong class="source-inline">MAX</strong> across <span class="No-Break">all rows.</span></p><p class="list-inset">Input: <strong class="source-inline">numerical_expression</strong>. Numerical expression <span class="No-Break">to scale.</span></p><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">DOUBLE</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 10 AS age UNION ALL
SELECT 20 AS age UNION ALL
SELECT 30 AS age UNION ALL
SELECT 40 AS age UNION ALL
SELECT 50 AS age)
SELECT age, ML.MIN_MAX_SCALER(age) Over() AS scaled_age
FROM dataset;</pre><p class="list-inset">In this example, we create a virtual table dataset with five rows of age data. Then, we <a id="_idIndexMarker297"/>use the <strong class="source-inline">ML.MIN_MAX_SCALER</strong> function to scale the <strong class="source-inline">age</strong> column to a range of 0 to 1. Note that the <strong class="source-inline">ML.MIN_MAX_SCALER</strong> function can be used to scale the values of a <a id="_idIndexMarker298"/>column to a different range by specifying different values for the <strong class="source-inline">MIN</strong> and <span class="No-Break"><strong class="source-inline">MAX</strong></span><span class="No-Break"> arguments.</span></p><p class="list-inset">Here’s <span class="No-Break">the output:</span></p><pre class="source-code">age  scaled_age
50  1.0
20  0.25
40  0.75
10  0.0
30  0.5</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.STANDARD_SCALER</strong></span><p class="list-inset">This function standardizes a <span class="No-Break">numerical expression.</span></p><p class="list-inset">Input: <strong class="source-inline">numerical_expression</strong>. Numerical expression <span class="No-Break">to scale.</span></p><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">DOUBLE</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 10 AS age UNION ALL
SELECT 20 AS age UNION ALL
SELECT 30 AS age UNION ALL
SELECT 40 AS age UNION ALL
SELECT 50 AS age)
SELECT age, ML.STANDARD_SCALER(age) OVER() AS scaled_age
FROM dataset;</pre><p class="list-inset">In this example, we create a virtual table dataset with five rows of age data. Then, we <a id="_idIndexMarker299"/>use the <strong class="source-inline">ML.STANDARD_SCALER</strong> function to standardize the <strong class="source-inline">age</strong> column to have a mean of 0 and a standard deviation of 1. The resulting <strong class="source-inline">scaled_age</strong> column shows <a id="_idIndexMarker300"/>the standardized values of the <span class="No-Break"><strong class="source-inline">age</strong></span><span class="No-Break"> column.</span></p><p class="list-inset">Here’s <span class="No-Break">the output:</span></p><pre class="source-code">age  scaled_age
40  0.63245553203367588
10  -1.2649110640673518
50  1.2649110640673518
20  -0.63245553203367588
30     0.0</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.MAX_ABS_SCALER</strong></span><p class="list-inset">This function scales a numerical expression to the range [-1, 1] by dividing through the largest maximum <span class="No-Break">absolute value.</span></p><p class="list-inset"><span class="No-Break">Input: </span><span class="No-Break"><strong class="source-inline">numerical_expression</strong></span><span class="No-Break">.</span></p><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">DOUBLE</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT -10 AS age UNION ALL
SELECT 20 AS age UNION ALL
SELECT -30 AS age UNION ALL
SELECT 40 AS age UNION ALL
SELECT -50 AS age)
SELECT age, ML.MAX_ABS_SCALER(age)
OVER() AS scaled_age
FROM dataset;</pre><p class="list-inset">In <a id="_idIndexMarker301"/>this example, we create <a id="_idIndexMarker302"/>a virtual table dataset with five rows of age data. Then, we use the <strong class="source-inline">ML.MAX_ABS_SCALER</strong> function to scale the <strong class="source-inline">age</strong> column so that the absolute values of the largest magnitude element in the column are scaled to 1. The resulting <strong class="source-inline">scaled_age</strong> column shows the scaled values of the <span class="No-Break"><strong class="source-inline">age</strong></span><span class="No-Break"> column.</span></p><p class="list-inset">Here’s <span class="No-Break">the output:</span></p><pre class="source-code">age    scaled_age
-10    -0.2
-50    -1.0
20    0.4
40    0.8
-30    -0.6</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.NORMALIZER</strong></span><p class="list-inset">This function normalizes <strong class="source-inline">array_expression</strong> to have a unit norm using the <span class="No-Break">given p-norm.</span></p><p class="list-inset">Input: <span class="No-Break"><strong class="source-inline">array_expression, p</strong></span><span class="No-Break">.</span></p><p class="list-inset"><span class="No-Break">Output: </span><span class="No-Break"><strong class="source-inline">ARRAY&lt;DOUBLE&gt;</strong></span><span class="No-Break">.</span></p><p class="list-inset">Here’s <a id="_idIndexMarker303"/>an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 1 AS x, 2 AS y UNION ALL
SELECT 3 AS x, 4 AS y UNION ALL
SELECT 5 AS x, 6 AS y UNION ALL
SELECT 7 AS x, 8 AS y UNION ALL
SELECT 9 AS x, 10 AS y)
SELECT x, y, ML.NORMALIZER([x, y], 1) AS norm_xy
FROM dataset;</pre><p class="list-inset">Here’s <a id="_idIndexMarker304"/><span class="No-Break">the output:</span></p><pre class="source-code">x  y  norm_xy
1  2  "[0.4472135954999579,0.8944271909999158]"
3  4  "[0.6,0.8]"
5  6  "[0.6401843996644799,0.7682212795973758]"
7  8  "[0.658504607868518,0.75257669470687782]"
9  10  "[0.6689647316224497,0.7432941462471663]"</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.IMPUTER</strong></span><p class="list-inset">This function replaces <strong class="source-inline">NULL</strong> in an expression using a specified value (for example, mean, median, or <span class="No-Break">most frequent).</span></p><p class="list-inset">Input: <span class="No-Break"><strong class="source-inline">expression, strategy</strong></span><span class="No-Break">.</span></p><p class="list-inset">Output: <strong class="source-inline">DOUBLE</strong> for numerical expression. <strong class="source-inline">STRING</strong> for <span class="No-Break"><strong class="source-inline">STRING</strong></span><span class="No-Break"> expression.</span></p><p class="list-inset">Here’s <a id="_idIndexMarker305"/>an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH dataset AS (
SELECT 10 AS age, 20 AS height UNION ALL
SELECT 20 AS age, 30 AS height UNION ALL
SELECT 30 AS age, 40 AS height UNION ALL
SELECT 40 AS age, 50 AS height UNION ALL
SELECT 50 AS age, NULL AS height)
SELECT age, height, ML.IMPUTER(height,"median") OVER() AS imputed_height FROM dataset;</pre><p class="list-inset">Here’s <a id="_idIndexMarker306"/><span class="No-Break">the output:</span></p><pre class="source-code">age  height  imputed_height
20    30    30.0
10    20    20.0
40    50    50.0
50    null    30.0
30    40    40.0</pre></li>				<li><span class="No-Break"><strong class="source-inline">ML.ONE_HOT_ENCODER</strong></span><p class="list-inset">This function encodes <strong class="source-inline">string_expression</strong> using a one-hot <span class="No-Break">encoding scheme.</span></p><p class="list-inset"><span class="No-Break">Inputs:</span></p><ul><li><strong class="source-inline">string_expression</strong>: The <strong class="source-inline">STRING</strong> expression to <span class="No-Break">be encoded.</span></li><li><strong class="source-inline">drop</strong> (optional): This determines which category to drop during encoding. The default value is <strong class="source-inline">none</strong>, which means all categories <span class="No-Break">are retained.</span></li><li><strong class="source-inline">top_k</strong> (optional): <strong class="source-inline">INT64</strong>. This limits the encoding vocabulary to the <strong class="source-inline">top_k</strong> frequent categories. The default value is 32,000, and the max supported value is 1 million to avoid suffering from <span class="No-Break">high dimensionality.</span></li><li><strong class="source-inline">frequency_threshold</strong> (optional): <strong class="source-inline">INT64</strong>. It limits the encoding vocabulary <a id="_idIndexMarker307"/>to categories <a id="_idIndexMarker308"/>whose frequency is <strong class="source-inline">&gt;= frequency_threshold</strong>. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">5</strong></span><span class="No-Break">.</span></li></ul><p class="list-inset">Output: It is an array of <strong class="source-inline">STRUCT</strong> that contains the encoded values, where <strong class="source-inline">index</strong> is the index of the encoded value and <strong class="source-inline">value</strong> is the value of the <span class="No-Break">encoded value.</span></p><p class="list-inset">Here's an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH
  input_data AS (
    SELECT 'red' AS color UNION ALL
    SELECT 'blue' AS color UNION ALL
    SELECT 'green' AS color UNION ALL
    SELECT 'green' AS color UNION ALL
    SELECT 'purple' AS color),
  vocab AS (
    SELECT color, COUNT(*) AS frequency
    FROM input_data
    GROUP BY color)
SELECT color,
  ML.ONE_HOT_ENCODER(color) OVER()  AS encoding
FROM input_data</pre><p class="list-inset">The preceding query results in the <span class="No-Break">following output:</span></p></li>			</ul>
			<table id="table004" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">encoding.index</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">encoding.value</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">green</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">1.0</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">red</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">1.0</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">purple</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">1.0</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">blue</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">1.0</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">green</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">1.0</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Figure">Table 6.4: Output from the previous query</p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">ML.LABEL_ENCODER</strong></span><p class="list-inset">This <a id="_idIndexMarker309"/>function converts string values into <strong class="source-inline">INT64</strong> numbers within a designated range. The function <a id="_idIndexMarker310"/>organizes the encoding terms in alphabetical order, and any category not found in this vocabulary will be represented as <strong class="source-inline">0</strong>. When utilized in the <strong class="source-inline">TRANSFORM</strong> clause, the vocabulary and categories omitted during the training process are seamlessly applied <span class="No-Break">during prediction.</span></p><p class="list-inset"><span class="No-Break">Inputs:</span></p><ul><li><strong class="source-inline">string_expression</strong>: The <strong class="source-inline">STRING</strong> expression to <span class="No-Break">be encoded.</span></li><li><strong class="source-inline">top_k</strong>: Optional <strong class="source-inline">INT64</strong>. This limits the encoding vocabulary to the <strong class="source-inline">top_k</strong> frequent categories. The default value is 32,000, and the max supported value is <span class="No-Break">1 million.</span></li><li><strong class="source-inline">frequency_threshold</strong>: Optional <strong class="source-inline">INT64</strong>. This limits the encoding vocabulary to categories whose frequency is <strong class="source-inline">&gt;= frequency_threshold</strong>. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">5</strong></span><span class="No-Break">.</span></li></ul><p class="list-inset">Output: <strong class="source-inline">INT64</strong>. This is the encoded value of the string expression in the <span class="No-Break">specified range.</span></p><p class="list-inset">Here’s an example <span class="No-Break">SQL statement:</span></p><pre class="source-code">
WITH data AS (
  SELECT 'apple' AS fruit UNION ALL
  SELECT 'banana' UNION ALL
  SELECT 'orange' UNION ALL
  SELECT 'apple' UNION ALL
  SELECT 'pear' UNION ALL
  SELECT 'kiwi' UNION ALL
  SELECT 'banana')
SELECT fruit, ML.LABEL_ENCODER(fruit, 2,2) OVER() AS encoded_fruit FROM data</pre><p class="list-inset">The <a id="_idIndexMarker311"/>preceding <a id="_idIndexMarker312"/>query results in the <span class="No-Break">following output:</span></p></li>			</ul>
			<table id="table005" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">fruit</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">encoded_fruit</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">orange</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">pear</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">banana</span></p>
						</td>
						<td class="No-Table-Style">
							<p>2</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">apple</span></p>
						</td>
						<td class="No-Table-Style">
							<p>1</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">kiwi</span></p>
						</td>
						<td class="No-Table-Style">
							<p>0</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">apple</span></p>
						</td>
						<td class="No-Table-Style">
							<p>1</p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">banana</span></p>
						</td>
						<td class="No-Table-Style">
							<p>2</p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Figure">Table 6.5: Output from the previous query</p>
			<p>Now let’s look at the different type of ML models you can build <span class="No-Break">with BQML.</span></p>
			<h1 id="_idParaDest-86"><a id="_idTextAnchor085"/>Building ML models with BQML</h1>
			<p>BQML <a id="_idIndexMarker313"/>supports model training for several <a id="_idIndexMarker314"/>different use cases. The key model categories that are currently supported are supervised learning models, unsupervised learning models, time series models, imported models, and <span class="No-Break">remote models.</span></p>
			<p>The following <a id="_idIndexMarker315"/>table showcases some <a id="_idIndexMarker316"/>of the key ML model types that are supported <span class="No-Break">within BigQuery:</span></p>
			<table id="table006" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Model Type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Model Types</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Manually Defined </strong><span class="No-Break"><strong class="bold">Feature Preprocessing</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Hyperparameter Tuning </strong><span class="No-Break"><strong class="bold">in BQML</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Linear and <span class="No-Break">logistic regression</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Deep <span class="No-Break">neural networks</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Wide-and-deep</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Boosted trees</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Random forest</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Supervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">AutoML tables</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Not supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Automated</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Unsupervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">k-means</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Unsupervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Matrix factorization</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Not supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Unsupervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">PCA</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Not supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Unsupervised</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Autoencoder</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Not supported</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Time series</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ARIMA_PLUS</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Only <span class="No-Break">automatic preprocessing</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
							<p><strong class="source-inline">(</strong><span class="No-Break"><strong class="source-inline">auto.ARIMA4)*</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Time series</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ARIMA_PLUS_XREG</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Only <span class="No-Break">automatic preprocessing</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Supported</span></p>
							<p><strong class="source-inline">(</strong><span class="No-Break"><strong class="source-inline">auto.ARIMA4)*</strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 6.6 – Supported capabilities for key ML models</p>
			<p>There are two other important model creation options available in BigQuery to help you utilize ML models built outside BigQuery – imported models and <span class="No-Break">remote models.</span></p>
			<p>BQML allows you to import models that have been trained outside BigQuery so that they can be used for inference <span class="No-Break">within BigQuery.</span></p>
			<p>The following model frameworks are supported <span class="No-Break">for importing:</span></p>
			<ul>
				<li><span class="No-Break">TensorFlow</span></li>
				<li><span class="No-Break">TensorFlow Lite</span></li>
				<li><span class="No-Break">ONNX</span></li>
				<li><span class="No-Break">XGBoost</span></li>
			</ul>
			<p>BQML <a id="_idIndexMarker317"/>allows you to register existing <a id="_idIndexMarker318"/>Vertex AI endpoints as a remote model. Once registered in BigQuery, you can send a prediction request to the Vertex AI endpoint from within BigQuery <span class="No-Break">for inference.</span></p>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor086"/>Creating BQML models</h1>
			<p>The BigQuery function that’s used to initiate model creation is aptly called <strong class="source-inline">CREATE</strong>. In this section, we’ll look <a id="_idIndexMarker319"/>at the options available to a user when they’re creating different types of BQML models using the <strong class="source-inline">CREATE</strong> function. You don’t necessarily need to read through the details of every single model at the moment. This should be used more as a reference, <span class="No-Break">as needed.</span></p>
			<h3>Linear or logistic regression models</h3>
			<p>The following <a id="_idIndexMarker320"/>is the syntax for creating regression <a id="_idIndexMarker321"/>models, along with the different <a id="_idIndexMarker322"/>required and optional arguments you need to provide <a id="_idIndexMarker323"/>as part of <span class="No-Break">the query:</span></p>
			<pre class="source-code">
{CREATE OR REPLACE MODEL} model_name
[OPTIONS(MODEL_TYPE = { 'LINEAR_REG' | 'LOGISTIC_REG' },
    INPUT_LABEL_COLS = string_array,
    OPTIMIZE_STRATEGY = { 'AUTO_STRATEGY'  },
    L1_REG = float64_value,
    L2_REG = float64_value,
    MAX_ITERATIONS = int64_value,
    LEARN_RATE_STRATEGY = { 'LINE_SEARCH' | 'CONSTANT' },
    LEARN_RATE = float64_value,
    EARLY_STOP = { TRUE },
    MIN_REL_PROGRESS = float64_value,
    DATA_SPLIT_METHOD = { 'AUTO_SPLIT'},
    DATA_SPLIT_EVAL_FRACTION = float64_value,
    DATA_SPLIT_COL = string_value,
    LS_INIT_LEARN_RATE = float64_value,
    WARM_START = { FALSE },
    AUTO_CLASS_WEIGHTS = { TRUE  },
    CLASS_WEIGHTS = struct_array,
    ENABLE_GLOBAL_EXPLAIN = { FALSE },
    CALCULATE_P_VALUES = { FALSE },
    FIT_INTERCEPT = { FALSE },
    CATEGORY_ENCODING_METHOD = { 'ONE_HOT_ENCODING`, 'DUMMY_ENCODING' })];</pre>			<p>The key <a id="_idIndexMarker324"/>options that can be specified in the <strong class="source-inline">CREATE MODEL</strong> statement are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="source-inline">MODEL_TYPE</strong>: Specifies the required model type (for example, linear or <span class="No-Break">logistic regression).</span></li>
				<li><strong class="source-inline">INPUT_LABEL_COLS</strong>: Defines the label column names in the <span class="No-Break">training data.</span></li>
				<li><strong class="source-inline">OPTIMIZE_STRATEGY</strong>: Selects the approach for training linear <span class="No-Break">regression models:</span><ul><li><strong class="source-inline">AUTO_STRATEGY</strong>: Chooses the training approach based on <span class="No-Break">several conditions:</span><ul><li>The <strong class="source-inline">batch_gradient_descent</strong> strategy is employed if either <strong class="source-inline">l1_reg</strong> or <strong class="source-inline">warm_start</strong> <span class="No-Break">is specified</span></li><li><strong class="source-inline">batch_gradient_descent</strong> is also used if the overall cardinality of training features <span class="No-Break">surpasses 10,000</span></li><li>When overfitting may be an issue, specifically when the number of training samples is less than 10 times the total cardinality, <strong class="source-inline">batch_gradient_descent</strong> <span class="No-Break">is chosen</span></li></ul></li><li>For all other scenarios, the <strong class="source-inline">NORMAL_EQUATION</strong> strategy <span class="No-Break">is implemented</span></li><li><strong class="source-inline">BATCH_GRADIENT_DESCENT</strong>: Engages the batch gradient descent method for <a id="_idIndexMarker325"/>model training, optimizing the loss function through the use of the <span class="No-Break">gradient function.</span></li><li><strong class="source-inline">NORMAL_EQUATION</strong>: Derives the least square solution for the linear regression issue using an analytical formula. The use of the <strong class="source-inline">NORMAL_EQUATION</strong> strategy is not permissible in the <span class="No-Break">following situations:</span><ul><li><strong class="source-inline">l1_reg</strong> <span class="No-Break">is defined</span></li><li><strong class="source-inline">warm_start</strong> <span class="No-Break">is defined</span></li><li>The total cardinality of training features <span class="No-Break">exceeds 10,000</span></li></ul></li></ul></li>
				<li><strong class="source-inline">L1_REG</strong>: Sets the amount of L1 <span class="No-Break">regularization applied.</span></li>
				<li><strong class="source-inline">L2_REG</strong>: Sets the amount of L2 <span class="No-Break">regularization applied.</span></li>
				<li><strong class="source-inline">MAX_ITERATIONS</strong>: Determines the maximum number of training iterations <span class="No-Break">or steps.</span></li>
				<li><strong class="source-inline">LEARN_RATE_STRATEGY</strong>: Selects the strategy for specifying the learning rate <span class="No-Break">during training.</span></li>
				<li><strong class="source-inline">LEARN_RATE</strong>: Defines the learning rate for <span class="No-Break">gradient descent.</span></li>
				<li><strong class="source-inline">EARLY_STOP</strong>: Indicates whether training should stop after the first iteration with minimal <a id="_idIndexMarker326"/>relative <span class="No-Break">loss improvement.</span></li>
				<li><strong class="source-inline">MIN_REL_PROGRESS</strong>: Sets the minimum relative loss improvement to <span class="No-Break">continue training.</span></li>
				<li><strong class="source-inline">DATA_SPLIT_METHOD</strong>: Chooses the method for splitting input data into training and evaluation sets. The options here are <strong class="source-inline">'AUTO_SPLIT'</strong>, <strong class="source-inline">'RANDOM'</strong>, <strong class="source-inline">'CUSTOM'</strong>, <strong class="source-inline">'SEQ'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'NO_SPLIT'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">DATA_SPLIT_EVAL_FRACTION</strong>: Specifies the fraction of data used for evaluation with <strong class="source-inline">'RANDOM'</strong> and <strong class="source-inline">'</strong><span class="No-Break"><strong class="source-inline">SEQ'</strong></span><span class="No-Break"> splits.</span></li>
				<li><strong class="source-inline">DATA_SPLIT_COL</strong>: Identifies the column used to split <span class="No-Break">the data.</span></li>
				<li><strong class="source-inline">LS_INIT_LEARN_RATE</strong>: Sets the initial learning rate for the <strong class="source-inline">'</strong><span class="No-Break"><strong class="source-inline">LINE_SEARCH'</strong></span><span class="No-Break"> strategy.</span></li>
				<li><strong class="source-inline">WARM_START</strong>: Retrains a model with new training data, new model options, <span class="No-Break">or both.</span></li>
				<li><strong class="source-inline">AUTO_CLASS_WEIGHTS</strong>: Balances class labels using weights for each class in inverse proportion to the frequency of <span class="No-Break">that class.</span></li>
				<li><strong class="source-inline">CLASS_WEIGHTS</strong>: Defines the weights to use for each <span class="No-Break">class label.</span></li>
				<li><strong class="source-inline">ENABLE_GLOBAL_EXPLAIN</strong>: Computes global explanations using Explainable AI for global feature <span class="No-Break">importance evaluation.</span></li>
				<li><strong class="source-inline">CALCULATE_P_VALUES</strong>: Computes p-values and standard errors <span class="No-Break">during training.</span></li>
				<li><strong class="source-inline">FIT_INTERCEPT</strong>: Fits <a id="_idIndexMarker327"/>an intercept to the model <span class="No-Break">during training.</span></li>
				<li><strong class="source-inline">CATEGORY_ENCODING_METHOD</strong>: Specifies the encoding method to use on <span class="No-Break">non-numeric features.</span></li>
			</ul>
			<h3>Creating deep neural network models and wide-and-deep models</h3>
			<p>Here’s <a id="_idIndexMarker328"/>the syntax for creating <a id="_idIndexMarker329"/>deep learning models, along with the <a id="_idIndexMarker330"/>different required and optional arguments you <a id="_idIndexMarker331"/>need to provide as part of <span class="No-Break">the query:</span></p>
			<pre class="source-code">
 {CREATE OR REPLACE MODEL} model_name
[OPTIONS(MODEL_TYPE= {'DNN_CLASSIFIER'},
         ACTIVATION_FN = { 'RELU' },
         AUTO_CLASS_WEIGHTS = { TRUE | FALSE },
         BATCH_SIZE = int64_value,
         CLASS_WEIGHTS = struct_array,
         DROPOUT = float64_value,
         EARLY_STOP = { TRUE | FALSE },
         HIDDEN_UNITS = int_array,
         L1_REG = float64_value,
         L2_REG = float64_value,
         LEARN_RATE = float64_value,
         INPUT_LABEL_COLS = string_array,
         MAX_ITERATIONS = int64_value,
         MIN_REL_PROGRESS = float64_value,
         OPTIMIZE<a id="_idTextAnchor087"/>R={'ADAGRAD'},
         WARM_START = { FALSE },
         DATA_SPLIT_METHOD={'AUTO_SPLIT'},
         DATA_SPLIT_EVAL_FRACTION = float64_value,
         DATA_SPLIT_COL = string_value,
         ENABLE_GLOBAL_EXPLAIN = { FALSE },
         INTEGRATED_GRADIENTS_NUM_STEPS = int64_value,
         TF_VERSION = { '2.8.0' })];</pre>			<p>The <a id="_idIndexMarker332"/>following options can be specified <a id="_idIndexMarker333"/>as part of the model <span class="No-Break">creation request:</span></p>
			<ul>
				<li><strong class="source-inline">model_name</strong>: The name <a id="_idIndexMarker334"/>of the BQML model <a id="_idIndexMarker335"/>you’re creating <span class="No-Break">or replacing.</span></li>
				<li><strong class="source-inline">model_type</strong>: Specifies the type of model, either <strong class="source-inline">'DNN_CLASSIFIER'</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">'DNN_REGRESSOR'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">activation_fn</strong>: For DNN model types, this specifies the activation function of the neural network. The options are <strong class="source-inline">'RELU'</strong>, <strong class="source-inline">'RELU6'</strong>, <strong class="source-inline">'CRELU'</strong>, <strong class="source-inline">'ELU'</strong>, <strong class="source-inline">'SELU'</strong>, <strong class="source-inline">'SIGMOID'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'TANH'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">auto_class_weights</strong>: Specifies whether to balance class labels using weights for each class in inverse proportion to the frequency of that class. Use only with the <span class="No-Break"><strong class="source-inline">DNN_CLASSIFIER</strong></span><span class="No-Break"> model.</span></li>
				<li><strong class="source-inline">batch_size</strong>: For DNN model types, this specifies the mini-batch size of samples that are fed to the <span class="No-Break">neural network.</span></li>
				<li><strong class="source-inline">class_weights</strong>: The weights to use for each class label. This option cannot be specified if <strong class="source-inline">AUTO_CLASS_WEIGHTS</strong> <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">TRUE</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">data_split_method</strong>: The method to split input data into training and evaluation sets. The options are <strong class="source-inline">'AUTO_SPLIT'</strong>, <strong class="source-inline">'RANDOM'</strong>,  <strong class="source-inline">'CUSTOM'</strong>, <strong class="source-inline">'SEQ'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'NO_SPLIT'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">data_split_eval_fraction</strong>: Used with <strong class="source-inline">'RANDOM'</strong> and <strong class="source-inline">'SEQ'</strong> splits. It specifies <a id="_idIndexMarker336"/>the fraction of the <a id="_idIndexMarker337"/>data used <span class="No-Break">for evaluation.</span></li>
				<li><strong class="source-inline">data_split_col</strong>: Identifies the column used to split <span class="No-Break">the data.</span></li>
				<li><strong class="source-inline">dropout</strong>: For DNN <a id="_idIndexMarker338"/>model types, this specifies <a id="_idIndexMarker339"/>the dropout rate of units in the <span class="No-Break">neural network.</span></li>
				<li><strong class="source-inline">early_stop</strong>: Whether training should stop after the first iteration in which the relative loss improvement is less than the value specified <span class="No-Break">for </span><span class="No-Break"><strong class="source-inline">MIN_REL_PROGRESS</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">enable_global_explain</strong>: Specifies whether to compute global explanations using Explainable AI to evaluate global feature importance to <span class="No-Break">the model.</span></li>
				<li><strong class="source-inline">hidden_units</strong>: For DNN model types, this specifies the hidden layers of the <span class="No-Break">neural network.</span></li>
				<li><strong class="source-inline">input_label_cols</strong>: The label column name(s) in the <span class="No-Break">training data.</span></li>
				<li><strong class="source-inline">integrated_gradients_num_steps</strong>: Specifies the number of steps to sample between the example being explained and its baseline for approximating the integral in integrated gradients <span class="No-Break">attribution methods.</span></li>
				<li><strong class="source-inline">l1_reg</strong>: The L1 regularization strength of <span class="No-Break">the optimizer.</span></li>
				<li><strong class="source-inline">l2_reg</strong>: The L2 regularization strength of <span class="No-Break">the optimizer.</span></li>
				<li><strong class="source-inline">learn_rate</strong>: The initial learning rate <span class="No-Break">for training.</span></li>
				<li><strong class="source-inline">max_iterations</strong>: The maximum number of <span class="No-Break">training iterations.</span></li>
				<li><strong class="source-inline">optimizer</strong>: For DNN model types, this specifies the optimizer for training the model. The <a id="_idIndexMarker340"/>options are <strong class="source-inline">'ADAGRAD'</strong>, <strong class="source-inline">'ADAM'</strong>, <strong class="source-inline">'FTRL'</strong>, <strong class="source-inline">'RMSPROP'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'SGD'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">warm_start</strong>: Whether <a id="_idIndexMarker341"/>to retrain a <a id="_idIndexMarker342"/>model with new training <a id="_idIndexMarker343"/>data, new model options, <span class="No-Break">or both.</span></li>
				<li><strong class="source-inline">tf_version</strong>: Specifies the TensorFlow version for <span class="No-Break">model training.</span></li>
			</ul>
			<h3>Creating boosted tree and random forest models</h3>
			<p>Here’s the <a id="_idIndexMarker344"/>syntax for creating boosted tree and random <a id="_idIndexMarker345"/>forest models, along with different required <a id="_idIndexMarker346"/>and optional arguments you <a id="_idIndexMarker347"/>need to provide as part of <span class="No-Break">the query:</span></p>
			<pre class="source-code">
{CREATE OR REPLACE MODEL} model_name
[OPTIONS(MODEL_TYPE = { 'BOOSTED_TREE_CLASSIFIER' },
         BOOSTER_TYPE = {'GBTREE' },
         NUM_PARALLEL_TREE = int64_value,
         DART_NORMALIZE_TYPE = {'TREE' },
         TREE_METHOD={'AUTO' },
         MIN_TREE_CHILD_WEIGHT = int64_value,
         COLSAMPLE_BYTREE = float64_value,
         COLSAMPLE_BYLEVEL = float64_value,
         COLSAMPLE_BYNODE = float64_value,
         MIN_SPLIT_LOSS = float64_value,
         MAX_TREE_DEPTH = int64_value,
         SUBSAMPLE = float64_value,
         AUTO_CLASS_WEIGHTS = { TRUE },
         CLASS_WEIGHTS = struct_array,
         INSTANCE_WEIGHT_COL = string_value,
         L1_REG = float64_value,
         L2_REG = float64_value,
         EARLY_STOP = { TRUE },
         LEARN_RATE = float64_value,
         INPUT_LABEL_COLS = string_array,
         MAX_ITERATIONS = int64_value,
         MIN_REL_PROGRESS = float64_value,
         DATA_SPLIT_METHOD = {'AUTO_SPLIT'},
         DATA_SPLIT_EVAL_FRACTION = float64_value,
         DATA_SPLIT_COL = string_value,
         ENABLE_GLOBAL_EXPLAIN = { TRUE},
         XGBOOST_VERSION = {'1.1'})];</pre>			<p>Here <a id="_idIndexMarker348"/>are the <a id="_idIndexMarker349"/>options <a id="_idIndexMarker350"/>that can be specified as part of <a id="_idIndexMarker351"/>the model <span class="No-Break">creation request:</span></p>
			<ul>
				<li><strong class="source-inline">MODEL_TYPE</strong>: Specifies whether the model is a boosted tree classifier, boosted tree regressor, random forest classifier, or random forest regressor. The options are <strong class="source-inline">'BOOSTED_TREE_CLASSIFIER'</strong>, <strong class="source-inline">'BOOSTED_TREE_REGRESSOR'</strong>, <strong class="source-inline">'RANDOM_FOREST_CLASSIFIER'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'RANDOM_FOREST_REGRESSOR'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">BOOSTER_TYPE</strong> (applicable only for <strong class="source-inline">Boosted_Tree_Models</strong>): Specifies the type <a id="_idIndexMarker352"/>of booster used for the boosted tree model. <strong class="bold">GBTREE</strong> stands for <strong class="bold">Gradient Boosting Tree</strong> and <strong class="bold">DART</strong> stands for <a id="_idIndexMarker353"/><strong class="bold">Dropouts meet</strong> <strong class="bold">Multiple Additive </strong><span class="No-Break"><strong class="bold">Regression Trees</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">NUM_PARALLEL_TREE</strong>: Specifies the number of parallel trees to grow. Larger numbers can lead to improved performance but can also increase training time and <span class="No-Break">memory usage.</span></li>
				<li><strong class="source-inline">DART_NORMALIZE_TYPE</strong> (applicable only for <strong class="source-inline">Boosted_Tree_Models</strong>): Specifies the <a id="_idIndexMarker354"/>normalization method used for the <strong class="bold">DART</strong> booster. <strong class="source-inline">'TREE'</strong> means normalization by the number of dropped trees in the boosting process and <strong class="source-inline">'FOREST'</strong> means normalization by the total number of trees in <span class="No-Break">the forest.</span></li>
				<li><strong class="source-inline">TREE_METHOD</strong>: Specifies the method used to construct each decision tree in the ensemble. <strong class="source-inline">'AUTO'</strong> means that the algorithm will choose the best method based <a id="_idIndexMarker355"/>on the data, <strong class="source-inline">'EXACT'</strong> means exact greedy algorithm, <strong class="source-inline">'APPROX'</strong> means approximate greedy <a id="_idIndexMarker356"/>algorithm, and <strong class="source-inline">'HIST'</strong> means <span class="No-Break">histogram-based algorithm.</span></li>
				<li><strong class="source-inline">MIN_TREE_CHILD_WEIGHT</strong>: Specifies the minimum sum of instance weights required <a id="_idIndexMarker357"/>in a child node of a tree. If the sum is below <a id="_idIndexMarker358"/>this value, the node will not <span class="No-Break">be split.</span></li>
				<li><strong class="source-inline">COLSAMPLE_BYTREE</strong>: Specifies the fraction of columns to be randomly sampled for <span class="No-Break">each tree.</span></li>
				<li><strong class="source-inline">COLSAMPLE_BYLEVEL</strong>: Specifies the fraction of columns to be randomly sampled for each level of <span class="No-Break">a tree.</span></li>
				<li><strong class="source-inline">COLSAMPLE_BYNODE</strong>: Specifies the fraction of columns to be randomly sampled for each split node of <span class="No-Break">a tree.</span></li>
				<li><strong class="source-inline">MIN_SPLIT_LOSS</strong>: Specifies the minimum loss reduction required to split <span class="No-Break">a node.</span></li>
				<li><strong class="source-inline">MAX_TREE_DEPTH</strong>: Specifies the maximum depth of <span class="No-Break">each tree.</span></li>
				<li><strong class="source-inline">SUBSAMPLE</strong>: Specifies the fraction of training instances to be randomly sampled for <span class="No-Break">each tree.</span></li>
				<li><strong class="source-inline">AUTO_CLASS_WEIGHTS</strong>: If set to <strong class="source-inline">TRUE</strong>, the algorithm will automatically determine the weights to be assigned to each class based on <span class="No-Break">the data.</span></li>
				<li><strong class="source-inline">CLASS_WEIGHTS</strong>: Specifies the weight to be assigned to each class. This can be used <a id="_idIndexMarker359"/>to balance the data if the <a id="_idIndexMarker360"/>classes <span class="No-Break">are imbalanced.</span></li>
				<li><strong class="source-inline">INSTANCE_WEIGHT_COL</strong>: Specifies the name of the column containing the <span class="No-Break">instance weights.</span></li>
				<li><strong class="source-inline">L1_REG</strong>: Specifies <a id="_idIndexMarker361"/>the L1 <span class="No-Break">regularization parameter.</span></li>
				<li><strong class="source-inline">L2_REG</strong>: Specifies <a id="_idIndexMarker362"/>the L2 <span class="No-Break">regularization parameter.</span></li>
				<li><strong class="source-inline">EARLY_STOP</strong>: If set to <strong class="source-inline">TRUE</strong>, the training process will stop early if the performance improvement falls below a certain threshold. The options are <strong class="source-inline">TRUE</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">FALSE</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">LEARN_RATE</strong> (applicable only for <strong class="source-inline">Boosted_Tree_Models</strong>): Specifies the learning rate, which controls the step size at each iteration of the <span class="No-Break">boosting process.</span></li>
				<li><strong class="source-inline">INPUT_LABEL_COLS</strong>: Specifies the names of the columns containing the input features and <span class="No-Break">the label.</span></li>
				<li><strong class="source-inline">MAX_ITERATIONS</strong> (applicable only for <strong class="source-inline">Boosted_Tree_Models</strong>): Specifies the maximum number of boosting iterations <span class="No-Break">to perform.</span></li>
				<li><strong class="source-inline">MIN_REL_PROGRESS</strong>: Specifies the minimum relative progress required to continue the <span class="No-Break">training process.</span></li>
				<li><strong class="source-inline">DATA_SPLIT_METHOD</strong>: Specifies the method used to split the data into training and validation sets. <strong class="source-inline">'AUTO_SPLIT'</strong> means that the algorithm will automatically split the data, <strong class="source-inline">'RANDOM'</strong> means random splitting, <strong class="source-inline">'CUSTOM'</strong> means <a id="_idIndexMarker363"/>user-defined splitting, <strong class="source-inline">'SEQ'</strong> means <a id="_idIndexMarker364"/>sequential splitting, and <strong class="source-inline">'NO_SPLIT'</strong> means no splitting (use all data <span class="No-Break">for training).</span></li>
				<li><strong class="source-inline">DATA_SPLIT_EVAL_FRACTION</strong>: Specifies the fraction of the data to be used for <a id="_idIndexMarker365"/>validation when splitting <span class="No-Break">the data.</span></li>
				<li><strong class="source-inline">DATA_SPLIT_COL</strong>: Specifies <a id="_idIndexMarker366"/>the name of the column used to split <span class="No-Break">the data.</span></li>
				<li><strong class="source-inline">ENABLE_GLOBAL_EXPLAIN</strong>: If set to <strong class="source-inline">TRUE</strong>, the algorithm will compute global feature importance scores. The options are <strong class="source-inline">TRUE</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">FALSE</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">XGBOOST_VERSION</strong>: Specifies the version of XGBoost to <span class="No-Break">be used.</span></li>
			</ul>
			<h3>Importing models</h3>
			<p>BQML also allows you to import deep learning models trained outside BigQuery. This is an extremely <a id="_idIndexMarker367"/>useful feature because it gives you the flexibility to train models using a more custom setup outside BigQuery and yet be able to use BigQuery’s compute infrastructure <span class="No-Break">for inference.</span></p>
			<p>Here is how you can use the <span class="No-Break">import feature:</span></p>
			<pre class="source-code">
{CREATE OR REPLACE MODEL} model_name
[OPTIONS(MODEL_TYPE = {'TENSORFLOW'} ,
MODEL_PATH = string_value)]</pre>			<p>Here are the available options as part of the <span class="No-Break">import feature:</span></p>
			<ul>
				<li><strong class="source-inline">MODEL_TYPE</strong>: Specifies whether the model is TensorFlow, TensorFlow Lite, or an ONNX model. The options are <strong class="source-inline">'TENSORFLOW'</strong>, <strong class="source-inline">'ONNX'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'TENSORFLOW_LITE'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">MODEL_PATH</strong>: Provides the Cloud Storage URI of the model to import <span class="No-Break">into BQML.</span></li>
			</ul>
			<h3>k-means models</h3>
			<p>Here’s the <a id="_idIndexMarker368"/>syntax for creating k-means models, along with different <a id="_idIndexMarker369"/>required and optional arguments you need to provide as part of <span class="No-Break">the query:</span></p>
			<pre class="source-code">
{CREATE OR REPLACE MODEL} model_name
[OPTIONS(MODEL_TYPE = { 'KMEANS' },
    NUM_CLUSTERS = int64_value,
    KMEANS_INIT_METHOD = { 'RANDOM' },
    KMEANS_INIT_COL = string_value,
    DISTANCE_TYPE = { 'EUCLIDEAN' | 'COSINE' },
    STANDARDIZE_FEATURES = { TRUE  },
    MAX_ITERATIONS = int64_value,
    EARLY_STOP = { TRUE  },
    MIN_REL_PROGRESS = float64_value,
    WARM_START = {  FALSE })];</pre>			<p>Let’s look at the options that can be specified as part of the model <span class="No-Break">creation query:</span></p>
			<ul>
				<li><strong class="source-inline">MODEL_TYPE</strong>: Specifies the type of model. This option <span class="No-Break">is required.</span></li>
				<li><strong class="source-inline">NUM_CLUSTERS</strong> (optional): For a k-means model, this specifies the number of clusters to identify in the input data. The default value is <strong class="source-inline">log10(n)</strong>, where <strong class="source-inline">n</strong> is the number of <span class="No-Break">training examples.</span></li>
				<li><strong class="source-inline">KMEANS_INIT_METHOD</strong> (optional): For a k-means model, this specifies the method of initializing the clusters. The default value is <strong class="source-inline">'RANDOM'</strong>. The options are <strong class="source-inline">'RANDOM'</strong>,  <strong class="source-inline">'KMEANS++'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'CUSTOM'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">KMEANS_INIT_COL</strong> (optional): For a k-means model, this identifies the column that will be used to initialize the centroids. This option can only be specified when <strong class="source-inline">KMEANS_INIT_METHOD</strong> has a value of <strong class="source-inline">CUSTOM</strong>. The corresponding column must be of the <strong class="source-inline">BOOL</strong> type, and the <strong class="source-inline">NUM_CLUSTERS</strong> model option must be present in the query and its value must equal the total number of <strong class="source-inline">TRUE</strong> rows in this column. BQML cannot use this column as a feature and excludes it from <span class="No-Break">features automatically.</span></li>
				<li><strong class="source-inline">DISTANCE_TYPE</strong> (optional): For a k-means model, this specifies the type of metric to compute the distance between two points. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">'EUCLIDEAN'</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">STANDARDIZE_FEATURES</strong> (optional): For a k-means model, this specifies whether to <a id="_idIndexMarker370"/>standardize numerical features. The <a id="_idIndexMarker371"/>default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">TRUE</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">MAX_ITERATIONS</strong> (optional): The maximum number of training iterations or steps. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">20</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">EARLY_STOP</strong> (optional): Whether training should stop after the first iteration in which the relative loss improvement is less than the value specified for <strong class="source-inline">MIN_REL_PROGRESS</strong>. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">TRUE</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">MIN_REL_PROGRESS</strong> (optional): The minimum relative loss improvement that is necessary to continue training when <strong class="source-inline">EARLY_STOP</strong> is set to <strong class="source-inline">TRUE</strong>. For example, a value of 0.01 specifies that each iteration must reduce the loss by 1% for training to continue. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">0.01</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">WARM_START</strong> (optional): Whether to retrain a model with new training data, new model options, or both. Unless explicitly overridden, the initial options used to train the model are used for the warm start run. The value of <strong class="source-inline">MODEL_TYPE</strong> and the training data schema must remain constant in a warm start model’s retraining. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">FALSE</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>Now let’s look at the support BQML offers for <span class="No-Break">hyperparameter tuning.</span></p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor088"/>Hyperparameter tuning with BQML</h1>
			<p>BQML allows <a id="_idIndexMarker372"/>you to fine-tune hyperparameters when building ML models through the use of <strong class="source-inline">CREATE MODEL</strong> statements. This process, known as hyperparameter tuning, is a commonly employed <a id="_idIndexMarker373"/>method for enhancing model accuracy by finding the ideal set <span class="No-Break">of hyperparameters.</span></p>
			<p>Here’s an example BigQuery <span class="No-Break">SQL statement:</span></p>
			<pre class="source-code">
{CREATE OR REPLACE MODEL} model_name
OPTIONS(Existing Training Options,
   NUM_TRIALS = int64_value, [, MAX_PARALLEL_TRIALS = int64_value ]
   [, HPARAM_TUNING_ALGORITHM = { 'VIZIER_DEFAULT' | 'RANDOM_SEARCH' | 'GRID_SEARCH' } ]
   [, hyperparameter={HPARAM_RANGE(min, max) | HPARAM_CANDIDATES([candidates]) }... ]
   [, HPARAM_TUNING_OBJECTIVES = { 'R2_SCORE' | 'ROC_AUC' | ... } ]
   [, DATA_SPLIT_METHOD = { 'AUTO_SPLIT' | 'RANDOM' | 'CUSTOM' | 'SEQ' | 'NO_SPLIT' } ]
   [, DATA_SPLIT_COL = string_value ]
   [, DATA_SPLIT_EVAL_FRACTION = float64_value ]
   [, DATA_SPLIT_TEST_FRACTION = float64_value ]
) AS query_statement</pre>			<p>Let’s look at the options that can be specified as part of the model <span class="No-Break">creation query:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">NUM_TRIALS</strong></span><ul><li>Description: This determines the maximum number of submodels to train. Tuning will cease after training <strong class="source-inline">num_trials</strong> submodels or upon search space exhaustion. The maximum value <span class="No-Break">is 100.</span></li><li>Arguments: <strong class="source-inline">int64_value</strong> must be an <strong class="source-inline">INT64</strong> value ranging from 1 <span class="No-Break">to 100.</span></li></ul></li>
			</ul>
			<p class="callout-heading">Note</p>
			<p class="callout">It is suggested to use at least (<strong class="source-inline">num_hyperparameters</strong> * 10) trials for <span class="No-Break">model tuning.3</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">MAX_PARALLEL_TRIALS</strong></span><ul><li>Description: This represents the maximum number of trials to run concurrently. The default value is 1, while the maximum value <span class="No-Break">is 5.</span></li><li>Arguments: <strong class="source-inline">int64_value</strong> must be an <strong class="source-inline">INT64</strong> value ranging from 1 <span class="No-Break">to 5.</span></li></ul></li>
			</ul>
			<p class="callout-heading">Note</p>
			<p class="callout">A larger <strong class="source-inline">max_parallel_trials</strong> value can speed up hyperparameter tuning, but it <a id="_idIndexMarker374"/>may compromise the final <a id="_idIndexMarker375"/>model’s quality for the <strong class="source-inline">VIZIER_DEFAULT</strong> tuning algorithm as parallel trials cannot benefit from concurrent <span class="No-Break">training results.</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">HPARAM_TUNING_ALGORITHM</strong></span><ul><li>Description: This determines the algorithm for hyperparameter tuning and supports the <span class="No-Break">following values:</span><ul><li><strong class="source-inline">VIZIER_DEFAULT</strong> (default and recommended): Uses the default Vertex AI Vizier algorithm, which combines advanced search algorithms such as Bayesian optimization with Gaussian processes and employs transfer learning to utilize previously <span class="No-Break">tuned models.</span></li><li><strong class="source-inline">RANDOM_SEARCH</strong>: Employs random search to explore the <span class="No-Break">search space.</span></li><li><strong class="source-inline">GRID_SEARCH</strong>: Utilizes grid search to explore the search space. This is only available when every hyperparameter’s search space <span class="No-Break">is discrete.</span></li></ul></li></ul></li>
				<li><span class="No-Break"><strong class="source-inline">HYPERPARAMETER</strong></span><p class="list-inset">Syntax: <strong class="source-inline">hyperparameter={HPARAM_RANGE(min, max) | </strong><span class="No-Break"><strong class="source-inline">HPARAM_CANDIDATES([candidates]) }...</strong></span></p><p class="list-inset">This <a id="_idIndexMarker376"/>parameter configures a hyperparameter’s search space. Refer to the hyperparameters and objectives for <a id="_idIndexMarker377"/>each model type to find out which tunable hyperparameters <span class="No-Break">are supported:</span></p><ul><li><strong class="source-inline">HPARAM_RANGE(min, max)</strong>: Specifies the continuous search space for a hyperparameter – for example, <strong class="source-inline">learn_rate</strong> = <span class="No-Break"><strong class="source-inline">HPARAM_RANGE</strong></span><span class="No-Break"><strong class="source-inline">(0.0001, 1.0)</strong></span></li><li><strong class="source-inline">HPARAM_CANDIDATES([candidates])</strong>: Specifies a hyperparameter with discrete values – for example, <strong class="source-inline">OPTIMIZER=HPARAM_CANDIDATES(</strong>[‘<strong class="source-inline">adagrad</strong>’, ‘<span class="No-Break"><strong class="source-inline">sgd</strong></span><span class="No-Break">’, ‘</span><span class="No-Break"><strong class="source-inline">ftrl</strong></span><span class="No-Break">’]</span><span class="No-Break"><strong class="source-inline">)</strong></span></li></ul></li>
				<li><span class="No-Break"><strong class="source-inline">HPARAM_TUNING_OBJECTIVES</strong></span><p class="list-inset">This parameter specifies objective metrics for the model. The candidates are a subset of model evaluation metrics. Only one objective is supported currently. Refer to <em class="italic">Table 6.7</em>, which shows each model type, to see the supported hyperparameters and <span class="No-Break">tuning objectives.</span></p></li>
			</ul>
			<table id="table007" class="No-Table-Style">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Model Type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Hyperparameter Objectives</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Hyperparameter</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">LINEAR_REG</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score (default)</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l1_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">LOGISTIC_REG</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">recall</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">accuracy</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">f1_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">roc_auc (default)</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l1_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">KMEANS</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">davies_bouldin_index</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">num_clusters</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">MATRIX_</strong></span></p>
							<p><strong class="source-inline">FACTORIZATION (</strong><span class="No-Break"><strong class="source-inline">implicit/explicit)</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><strong class="source-inline">mean_average_precision (</strong><span class="No-Break"><strong class="source-inline">explicit model)</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error (implicit/explicit)</strong></span></li>
								<li class="Table-Bullet-style"><strong class="source-inline">normalized_discounted_cumulative_gain (</strong><span class="No-Break"><strong class="source-inline">explicit model)</strong></span></li>
								<li class="Table-Bullet-style"><strong class="source-inline">average_rank (</strong><span class="No-Break"><strong class="source-inline">explicit model)</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">num_factors</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
								<li class="Table-Bullet-style"><strong class="source-inline">wals_alpha(implicit </strong><span class="No-Break"><strong class="source-inline">model only)</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">DNN_CLASSIFIER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">recall</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">accuracy</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">f1_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">roc_auc (default)</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style" rowspan="2">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">batch_size</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">dropout</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">hidden_units</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">learn_rate</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">optimizer</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l1_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">activation_fn</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">DNN_REGRESSOR</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score (default)</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">BOOSTED_TREE_</strong></span></p>
							<p><span class="No-Break"><strong class="source-inline">CLASSIFIER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">recall</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">accuracy</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">f1_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">roc_auc (default)</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style" rowspan="2">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">learn_rate</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l1_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">dropout</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">max_tree_depth</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">subsample</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">min_split_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">num_parallel_tree</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">min_tree_child_weight</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bytree</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bylevel</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bynode</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">booster_type</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">dart_normalize_type</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">tree_method</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">BOOSTED_TREE_</strong></span></p>
							<p><span class="No-Break"><strong class="source-inline">REGRESSOR</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score (default)</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">RANDOM_FOREST_</strong></span></p>
							<p><span class="No-Break"><strong class="source-inline">CLASSIFIER</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">recall</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">accuracy</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">f1_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">roc_auc (default)</strong></span></li>
							</ul>
						</td>
						<td class="No-Table-Style" rowspan="2">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l1_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">l2_reg</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">max_tree_depth</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">subsample</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">min_split_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">num_parallel_tree</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">min_tree_child_weight</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bytree</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bylevel</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">colsample_bynode</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">tree_method</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">RANDOM_FOREST_</strong></span></p>
							<p><span class="No-Break"><strong class="source-inline">REGRESSOR</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score (default)</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 6.7 – Supported hyperparameter objectives by model type</p>
			<p><a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-hyperparameter-tuning"><span class="No-Break">https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-hyperparameter-tuning</span></a></p>
			<p>Now let’s <a id="_idIndexMarker378"/>look at BQML features that you can use when <a id="_idIndexMarker379"/>trying to evaluate <span class="No-Break">ML models.</span></p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor089"/>Evaluating trained models</h1>
			<p>Once the BQML <a id="_idIndexMarker380"/>model has been trained, you will want to evaluate the key performance statistics, depending on the type of model. You can do so by using the <strong class="source-inline">ML.EVALUATE</strong> function, as <span class="No-Break">shown here:</span></p>
			<pre class="source-code">
ML.EVALUATE(MODEL model_name
           [, {TABLE table_name <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-evaluate">| (query_statem</a>ent)}]
           [, STRUCT&lt;threshold FLOAT64,
                  <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-evaluate">   perform_aggregat</a>ion BOOL,
                     horizon INT64,
                  <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-evaluate">   confidence_le</a>vel FLOAT64&gt; settings]))])</pre>			<p>Let’s look <a id="_idIndexMarker381"/>at the options you can specify as part of the <span class="No-Break">evaluation query:</span></p>
			<ul>
				<li><strong class="source-inline">model_name</strong>: The name of the model <span class="No-Break">being evaluated</span></li>
				<li><strong class="source-inline">table_name</strong> (optional): The name of the table containing the <span class="No-Break">evaluation data</span></li>
				<li><strong class="source-inline">query_statement</strong> (optional): The query used to generate the <span class="No-Break">evaluation data</span></li>
				<li><strong class="source-inline">threshold</strong> (optional): A custom threshold value for binary-class classification models that’s used <span class="No-Break">during evaluation</span></li>
				<li><strong class="source-inline">perform_aggregation</strong> (optional): A Boolean value that identifies the level of evaluation for <span class="No-Break">forecasting accuracy</span></li>
				<li><strong class="source-inline">horizon</strong> (optional): The number of forecasted time points against which evaluation metrics <span class="No-Break">are computed</span></li>
				<li><strong class="source-inline">confidence_level</strong> (optional): The percentage of future values that fall within the <span class="No-Break">prediction interval</span></li>
			</ul>
			<p>The output <a id="_idIndexMarker382"/>of the <strong class="source-inline">ML.Evaluate</strong> function depends on the type of model <span class="No-Break">being evaluated:</span></p>
			<table id="table008" class="No-Table-Style">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Model Type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Returned Fields</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Regression models</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Classification models</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">recall</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">accuracy</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">f1_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_loss</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">roc_auc</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">k-means model</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">Davies-Bouldin index</strong></span></li>
								<li class="Table-Bullet-style"><strong class="source-inline">Mean </strong><span class="No-Break"><strong class="source-inline">squared distance</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Matrix factorization model with <span class="No-Break">implicit feedback</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_average_precision</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">normalized_discounted_cumulative_gain</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">average_rank</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Matrix factorization model with <span class="No-Break">explicit feedback</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">median_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">r2_score</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">explained_variance</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">PCA model</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">total_explained_variance_ratio</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Time series <strong class="source-inline">ARIMA_PLUS</strong> or <strong class="source-inline">ARIMA_PLUS_XREG</strong> model with input data and perform_aggregation = <span class="No-Break">false</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><strong class="source-inline">time_series_id_col </strong><span class="No-Break"><strong class="source-inline">or time_series_id_cols</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">time_series_timestamp_col</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">time_series_data_col</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">forecasted_time_series_data_col</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">lower_bound</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">upper_bound</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">absolute_percentage_error</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Time series <strong class="source-inline">ARIMA_PLUS</strong> or <strong class="source-inline">ARIMA_PLUS_XREG</strong> model with input data and perform_aggregation = <span class="No-Break">true</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><strong class="source-inline">time_series_id_col </strong><span class="No-Break"><strong class="source-inline">or time_series_id_cols</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">root_mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_percentage_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">symmetric_mean_absolute_percentage_error</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Time series <strong class="source-inline">ARIMA_PLUS</strong> model without <span class="No-Break">input data</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><strong class="source-inline">time_series_id_col </strong><span class="No-Break"><strong class="source-inline">or time_series_id_cols</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">non_seasonal_p</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">non_seasonal_d</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">non_seasonal_q</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">has_drift</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">log_likelihood</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">AIC</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">variance</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">seasonal_periods</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">has_holiday_effect</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">has_spikes_and_dips</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">has_step_change</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Autoencoder model</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_absolute_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_error</strong></span></li>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">mean_squared_log_error</strong></span></li>
							</ul>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Remote model</span></p>
						</td>
						<td class="No-Table-Style">
							<ul>
								<li class="Table-Bullet-style"><span class="No-Break"><strong class="source-inline">remote_eval_metrics</strong></span></li>
							</ul>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 6.8 – ML.Evaluate Output</p>
			<p>In the next <a id="_idIndexMarker383"/>section we look at how you can use your BQML models <span class="No-Break">for inference.</span></p>
			<h1 id="_idParaDest-90"><a id="_idTextAnchor090"/>Doing inference with BQML</h1>
			<p>In supervised ML, the ultimate goal is to use a trained model to make predictions <a id="_idIndexMarker384"/>on new data. BQML provides the <strong class="source-inline">ML.PREDICT</strong> function for this purpose. Using this function, you can easily predict outcomes by supplying new data to a trained model. The <strong class="source-inline">ML.PREDICT</strong> function can be used during model creation, after model creation, or after a failure, so long as at least one iteration has been completed. The function returns a table with the same number of rows as the input table, and it includes all columns from the input table and all output columns from the model, with the output column names prefixed <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">predicted_</strong></span><span class="No-Break">.</span></p>
			<pre class="source-code">
ML.PREDICT(MODEL model_name,
          {TABLE table_name |<a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-predict"> (query_stateme</a>nt)}
          [, STRUCT&lt;threshold FLOAT64,
        <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-predict">  keep_original_colum</a>ns BOOL&gt; settings)])</pre>			<p>The output <a id="_idIndexMarker385"/>fields that are included in the response of the <strong class="source-inline">ML.PREDICT</strong> function depends on the type of model <span class="No-Break">being used:</span></p>
			<table id="table009" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Model Type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Output Columns</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Linear regression</span></p>
							<p>Boosted <span class="No-Break">tree regressor</span></p>
							<p>Random <span class="No-Break">forest regressor</span></p>
							<p><span class="No-Break">DNN regressor</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">predicted_&lt;label_column_name&gt;</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p>Binary <span class="No-Break">logistic regression</span></p>
							<p>Boosted <span class="No-Break">tree classifier</span></p>
							<p>Random <span class="No-Break">forest classifier</span></p>
							<p><span class="No-Break">DNN classifier</span></p>
							<p>Multiclass <span class="No-Break">logistic regression</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">predicted_&lt;label_column_name&gt;, </strong><span class="No-Break"><strong class="source-inline">predicted_&lt;label_column_name&gt;_probs</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">k-means</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">centroid_id, nearest_centroids_distance</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">PCA</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">principal_component_&lt;index&gt;,</strong></span></p>
							<p>input columns (if keep_original_columns is set <span class="No-Break">to true)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Autoencoder</span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">latent_col_&lt;index&gt;,</strong></span></p>
							<p><span class="No-Break">input columns</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">TensorFlow Lite</span></p>
						</td>
						<td class="No-Table-Style">
							<p>The output of the TensorFlow Lite model’s <span class="No-Break">predict method</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">Remote models</span></p>
						</td>
						<td class="No-Table-Style">
							<p>The output columns containing all Vertex AI endpoint output fields, and a remote_model_status field containing status messages from the Vertex <span class="No-Break">AI endpoint</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">ONNX models</span></p>
						</td>
						<td class="No-Table-Style">
							<p>The output of the ONNX model’s <span class="No-Break">predict method</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break">XGBoost models</span></p>
						</td>
						<td class="No-Table-Style">
							<p>The output of the XGBoost model’s <span class="No-Break">predict method</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 6.9 – ML.Predict Output</p>
			<p>Now let’s work through a hands-on exercise where we use BQML to train an ML model and use it for <span class="No-Break">generating predictions.</span></p>
			<h1 id="_idParaDest-91"><a id="_idTextAnchor091"/>User exercise</h1>
			<p>Refer to the notebook in <a href="B17792_06.xhtml#_idTextAnchor079"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Low-Code Options for Building ML Models</em>, in this book’s GitHub <a id="_idIndexMarker386"/>repository for a hands-on exercise around training a BQML model. In this exercise, you will use one of the public datasets available in BigQuery to train a model to predict the likelihood of a customer defaulting on their loan <span class="No-Break">next month.</span></p>
			<h1 id="_idParaDest-92"><a id="_idTextAnchor092"/>Summary</h1>
			<p>BQML is a powerful tool for data scientists and analysts who want to train ML models with ease while using a low-code option to build and deploy models in GCP. With BQML, users can leverage the power of BigQuery to quickly and easily create models without needing to write <span class="No-Break">complex code.</span></p>
			<p>In this chapter, we explored the features and benefits of BQML. We saw how it provides a simple and intuitive interface for training models using SQL queries. We also explored some of the key features of BQML, including the ability to perform data preprocessing and feature engineering directly within BigQuery, as well as the ability to evaluate model performance through native <span class="No-Break">evaluation functions.</span></p>
			<p>One of the key advantages of BQML is its integration with BigQuery, which makes it easy to scale and manage large datasets. This makes it a great option for companies and organizations that are dealing with massive amounts of data and need to quickly build and <span class="No-Break">deploy models.</span></p>
			<p>Another advantage of BQML is its support for a wide range of ML models, including linear regression, logistic regression, k-means clustering, and more. This makes it a versatile tool that can be used for a variety of use cases, from predicting customer churn to clustering data <span class="No-Break">for analysis.</span></p>
			<p>We also discussed some of the limitations of BQML. For example, while it provides a low-code option for building and deploying models, it may not be suitable for more complex use cases that require custom models or extensive feature engineering. Additionally, while BQML provides a range of metrics for evaluating model performance, users may need to do additional analysis to fully understand the effectiveness of <span class="No-Break">their models.</span></p>
			<p>Despite these limitations, BQML is a powerful tool for data scientists and analysts who want to quickly and easily build and deploy ML models. Its integration with BigQuery and other GCP services makes it a great option for companies and organizations that need to work with large amounts of data, while its support for a wide range of models and metrics makes it a versatile tool for a variety of <span class="No-Break">use cases.</span></p>
			<p>Overall, BQML is a valuable addition to the suite of ML tools available in GCP. Its low-code interface, integration with BigQuery, and support for a wide range of models make it a great option for data scientists and analysts who want to focus on their data and insights, rather than complex code and infrastructure. With BQML, users can quickly and easily build and deploy models, enabling them to extract valuable insights from their data and make <span class="No-Break">data-driven decisions.</span></p>
			<p>In the next chapter, we will look at how to train fully custom TensorFlow deep learning models on Vertex AI using its serverless training features. This chapter will also do a deep dive into building the model using TensorFlow, packaging it for submission to Vertex AI, monitoring the training progress, and evaluating the <span class="No-Break">trained model.</span></p>
		</div>
	</div>
</div>
</body></html>