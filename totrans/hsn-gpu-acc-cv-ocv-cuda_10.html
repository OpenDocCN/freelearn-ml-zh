<html><head></head><body><div><div><h1 class="header-title">Getting Started with PyCUDA</h1>
                
            
            
                
<p class="mce-root">We have seen how we can accelerate various applications using OpenCV and CUDA. We have used C or C++ as a programming language. Nowadays, Python is very popular in many domains, so it will be very useful if we can accelerate Python applications using CUDA. Python provides a PyCUDA module that does exactly that. </p>
<p class="mce-root">It uses the Nvidia CUDA toolkit which, in turn, requires an Nvidia graphics card installed on the computer. This chapter will give an introduction to the Python language and the PyCUDA module, in particular. It will discuss the installation procedure for the PyCUDA module on the Windows and Linux operating systems. Though the chapter requires some familiarity with the Python language, newcomers will also be able to follow most of the procedures.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>Introduction to the Python Programming Language</li>
<li>Introduction to the PyCUDA module</li>
<li>Installation of PyCUDA on Windows</li>
<li>Installation of PyCUDA on Ubuntu</li>
</ul>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>This chapter requires a good understanding of the Python programming language. It also requires any computer or laptop with an Nvidia GPU on board. The PyCUDA installation file for Windows used in this chapter can be downloaded from the following GitHub link: <a href="https://github.com/PacktPublishing/Hands-On-GPU-Accelerated-Computer-Vision-with-OpenCV-and-CUDA">https://github.com/PacktPublishing/Hands-On-GPU-Accelerated-Computer-Vision-with-OpenCV-and-CUDA</a>. </p>
<p class="mce-root"/>
<p> </p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Introduction to Python programming language</h1>
                
            
            
                
<p>Python is continuously gaining popularity as it can be used in many fields with a wide range of applications. It is a high-level programming language that helps in expressing complex systems with a few lines of code. The Python syntax is easy to learn and more readable than other languages such as C++ and Java, which makes it easy to learn for novice programmers.</p>
<p>Python is a lightweight scripting language that can be easily used in embedded applications. Moreover, it is an interpreted language that requires an interpreter rather than a compiler, as is case for other programming languages. This allows the programmer to execute code line by line. It requires a Python interpreter that can be easily installed on all operating systems. Since Python is open source, a large community chooses to work with it. They have developed a wide range of libraries and made it open source, and hence it can be easily used in applications without any cost.</p>
<p>Python can be used in various domains such as data science, machine learning, deep learning, data analytics, image processing, computer vision, data mining, and web development. It has ready-to-use modules for almost all of the OS mentioned domains, which help in the rapid development of applications. OpenCV library, which was explained earlier in this book, also has a Python interface. Thus, it can be easily integrated with Python code for computer vision applications. Python has libraries for machine learning and deep learning that can be used for computer vision applications along with OpenCV.</p>
<p>One disadvantage of an interpreted language like Python is that it is much slower than compiled languages like C or C++. Python has a feature whereby it can integrate C or C++ code within a Python script. This allows you to write computationally intensive code in C or C++ with a Python wrapper. </p>
<p class="mce-root"/>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Introduction to the PyCUDA module</h1>
                
            
            
                
<p>In the last section, we saw many advantages of using the Python programming language. It is also mentioned that Python is much slower than C or C++. So, it will be beneficial if it can leverage the parallel processing capability of a GPU. Python provides a PyCUDA wrapper that can utilize the parallel computing capability of a GPU by using the Nvidia CUDA API. Python also has a <kbd>PyOpenCL</kbd> module that can be used for parallel computation on any GPU.</p>
<p>Then, one question you might ask is why you have to use PyCUDA, which is specific to Nvidia GPUs. There are many advantages of using PyCUDA over other similar modules; the following are the reasons:</p>
<ul>
<li>It provides an easy interface with CUDA API for Python developers and has good documentation, which make it easy to learn.  </li>
<li>The full power of CUDA API provided by Nvidia can be used within Python code using the PyCUDA module.</li>
<li>The base layer of PyCUDA is written in C++, which makes it faster. </li>
<li>It has a higher level of abstraction, which makes it easy to use compared to the Nvidia C-based runtime API.</li>
<li>It has a very efficient memory management mechanism with object cleanup tied to the lifetime of the objects. This feature helps it to write correct code, without memory leak or crashing.</li>
<li>The errors within the CUDA code can also be handled by Python exceptions, which helps with the error-handling mechanism in the code.</li>
</ul>
<p>This section described the advantage of using PyCUDA for the acceleration of Python applications. In the next section, we will see the procedure to install PyCUDA on Windows and Ubuntu operating systems. </p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p class="mceNonEditable"/>
<p class="mceNonEditable"/>
<p class="mceNonEditable"/>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Installing PyCUDA on Windows</h1>
                
            
            
                
<p>This section will describe the steps to install PyCUDA on a Windows operating system. Windows 10 is used for the demonstration, but the procedure will work on any recent Windows versions. The steps are described below:</p>
<ol>
<li>If you have not installed CUDA toolkit, as described in the first chapter, then download the latest CUDA toolkit from <a href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a>. It will ask for your operating system, CPU architecture, and whether to install using the internet or to download the entire installer first. As can be seen from the following screenshot, we have chosen Windows 10 with the local installer. You can choose values according to your settings:</li>
</ol>
<div><img class="alignnone size-full wp-image-657 image-border" src="img/ae642ac8-6b1a-4f9b-9532-8fbe1e3cb864.png" style="" width="848" height="617"/></div>
<ol start="2">
<li>Install the CUDA toolkit by double-clicking on the downloaded installer and follow the on-screen prompts.</li>
</ol>
<p> </p>
<ol start="3">
<li>Install the latest Visual Studio edition, which has a visual C++ version. We are using Visual Studio 2017 community edition, which is free to use. The path for visual C++ should be added to the path environment variable. The environment variable can be accessed by right-clicking on My Computer (This PC) | Properties |Advanced System Settings | Environment Variables | System variables. Add the path for the bin folder of the visual C++ installation and CUDA toolkit installation in the path environment variable, as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-658 image-border" src="img/a70049af-9585-4a38-8118-9a140b897611.png" style="" width="521" height="495"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="4">
<li>Anaconda distribution will be used as a Python interpreter so it can be downloaded from the site: <a href="https://www.anaconda.com/download/">https://www.anaconda.com/download/</a>. We are using Anaconda 5.2 with the Python 3.6 version, as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-659 image-border" src="img/42406870-55a4-4387-828f-335d04cca10a.png" style="" width="876" height="433"/></div>
<ol start="5">
<li>Install Anaconda by double-clicking on the downloaded installer and following the on-screen prompts. Make sure you check the checkbox for adding the installation path to the path environment variable.</li>
<li>Download the latest PyCUDA binary according to your system settings from the following link: <a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#pycuda">https://www.lfd.uci.edu/~gohlke/Pythonlibs/#pycuda</a>. We are using CUDA 9.2148 and Python 3.6, so the PyCUDA version is chosen accordingly, as the following shows:</li>
</ol>
<div><img class="alignnone size-full wp-image-660 image-border" src="img/30cf9414-6c74-4169-afec-83990c47786d.png" style="" width="400" height="371"/></div>
<ol start="7">
<li>Open Command Prompt, go to the folder where the PyCUDA binary is downloaded and execute the command as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-661 image-border" src="img/472e61cf-6ce4-4c7e-9c99-5e40b9498d48.png" style="" width="1216" height="518"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p style="padding-left: 60px">The command will complete the installation of PyCUDA in the Python distribution.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Steps to check PyCUDA installation</h1>
                
            
            
                
<p>The following steps are to be followed to check whether PyCUDA has been installed correctly or not:</p>
<ol>
<li>Open Spyder, which is a Python IDE, that comes with Anaconda installations. You can open it by writing <kbd>Spyder</kbd> in the start menu.</li>
<li>In Spyder IDE, type <kbd>import pycuda</kbd> on the IPython console as shown in the following screenshot. If no error is reported, then PyCUDA is installed correctly.</li>
</ol>
<div><img class="alignnone size-full wp-image-662 image-border" src="img/9892c652-ffaf-47d0-8b22-3f4074e9660b.png" style="" width="300" height="162"/></div>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Installing PyCUDA on Ubuntu</h1>
                
            
            
                
<p>This section will describe the steps to install PyCUDA on Linux operating systems. Ubuntu is used for demonstration but the procedure will work on any recent Linux distribution. The steps are described below:</p>
<ol>
<li>If you have not installed the CUDA toolkit, as described in the first chapter, then download the latest CUDA toolkit from <a href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a>. It will ask for your operating system, CPU architecture, and whether to install using the internet or to download the entire installer first. As can be seen from the following screenshot, we have chosen Ubuntu with the runfile (local) installer. You can choose values according to your settings:</li>
</ol>
<div><img class="alignnone size-full wp-image-663 image-border" src="img/c9df1b5b-84b8-4232-9b4f-efb0443e53bd.png" style="" width="847" height="618"/></div>
<ol start="2">
<li>Run the <strong>sudo sh cuda_9.2.148_396.37_linux.run</strong> command on Command Prompt to install the CUDA toolkit. </li>
</ol>
<p> </p>
<ol start="3">
<li>Anaconda distribution will be used as a Python interpreter so it can be downloaded and installed from the site: <a href="https://www.anaconda.com/download/">https://www.anaconda.com/download/</a>. We are using Anaconda 5.2 with the Python 3.6 version, as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-664 image-border" src="img/325eb07d-faf7-490a-9d6e-04376debb772.png" style="" width="879" height="447"/></div>
<ol start="4">
<li>After installing Anaconda, execute the following command on the Terminal, as shown in the following screenshot to install PyCUDA:</li>
</ol>
<div><img class="alignnone size-full wp-image-665 image-border" src="img/e65a3086-c320-425d-9b02-72ddde1d3fbc.png" style="" width="740" height="651"/></div>
<p style="padding-left: 60px">The command will complete the installation of PyCUDA in the Python distribution.</p>
<p class="mce-root"/>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Steps to check the PyCUDA installation</h1>
                
            
            
                
<p>The following steps are to be followed to check whether PyCUDA has been installed correctly or not:</p>
<ul>
<li>Open Spyder, which is the Python IDE that comes with the Anaconda installation. You can open it by writing <kbd>Spyder</kbd> in the Terminal.</li>
<li>In Spyder IDE, type <kbd>import pycuda</kbd> on the IPython console as shown in the following screenshot. If no error is reported then PyCUDA is installed correctly.</li>
</ul>
<div><img class="alignnone size-full wp-image-666 image-border" src="img/a27e743a-edf4-4077-bd34-a07581ff11bb.png" style="" width="306" height="162"/></div>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Summary</h1>
                
            
            
                
<p>To summarize, this chapter gave an introduction to the Python programming language and how it is used in various domains for a vast range of applications. It is lightweight but slow compared to the C or C++ languages. So, if it can leverage the advantages of the parallel computing capability of the GPU then it will be very useful. PyCUDA is a Python wrapper that allows the Python code to take advantage of Nvidia CUDA APIs. The advantage of PyCUDA over other parallel processing modules available in Python is explained in detail. PyCUDA uses an Nvidia CUDA runtime API and Python interpreter. Anaconda, which is a famous Python distribution, comes with many useful Python libraries and IDEs installed, along with the CUDA toolkit. The detailed steps to install PyCUDA on Windows and Ubuntu operating systems are discussed in this chapter.</p>
<p>We will see how to use PyCUDA to accelerate Python applications in detail in the next two chapters.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Questions</h1>
                
            
            
                
<ol>
<li>What are the advantages of Python over programming languages like C or  C++?</li>
<li>What is the difference between compiled type languages and interpreted languages?</li>
<li>State true or false: Python is faster than C or C++.</li>
<li>What is the advantage of PyOpenCL over PyCUDA?</li>
<li>State true or false: Python allows the use of C or C++ code within Python script.</li>
</ol>


            

            
        
    </div></div></body></html>