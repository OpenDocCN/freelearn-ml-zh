<html><head></head><body>
<div id="_idContainer137">
<h1 class="chapter-number" id="_idParaDest-49"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-50"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.2.1">Training Machine Learning Models in AMLS</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Training </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Machine Learning</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">ML</span></strong><span class="koboSpan" id="kobo.7.1">) models in </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Azure Machine Learning </span></strong><span class="koboSpan" id="kobo.9.1">(</span><strong class="bold"><span class="koboSpan" id="kobo.10.1">AML</span></strong><span class="koboSpan" id="kobo.11.1">) is key to enabling your data science workload. </span><span class="koboSpan" id="kobo.11.2">Typically, during the model creation process, data is split into test and training datasets. </span><span class="koboSpan" id="kobo.11.3">Models are then built with the training data and evaluated using the test dataset. </span><span class="koboSpan" id="kobo.11.4">During this process, many algorithms are selected and used to answer the question: what model will provide the best results on an unseen dataset? </span><span class="koboSpan" id="kobo.11.5">AML has the capability to log metrics, taking snapshots of the code that produced a given model performance to enable answering this question. </span><span class="koboSpan" id="kobo.11.6">AML comes with a variety of accelerating capacities. </span><span class="koboSpan" id="kobo.11.7">During this chapter, we will focus on the creation of experiments to train models and on the basic functionality of AML experiments to unlock using compute instances, compute clusters, and </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">registered datasets.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">Model training can be established through the AML Python SDK or the designer for a low-code experience. </span><span class="koboSpan" id="kobo.13.2">During the model training process, different compute resources can be used to accomplish this task. </span><span class="koboSpan" id="kobo.13.3">In this chapter, we will explore using compute instances for basic model training and compute clusters for a repeatable training environment, as well as through the designer for a </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">low-code experience.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">In this chapter, we will learn how to use datasets to build ML models with AML compute </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">and datasets.</span></span></p>
<p><span class="koboSpan" id="kobo.17.1">We will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.19.1">Training code-free models with </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">the Designer</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Training on a </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">compute instance</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Training on a </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">compute cluster</span></span></li>
</ul>
<h1 id="_idParaDest-51"><a id="_idTextAnchor055"/><span class="koboSpan" id="kobo.25.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.26.1">Refer to </span><a href="B18003_01.xhtml#_idTextAnchor020"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.27.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.28.1">, </span><em class="italic"><span class="koboSpan" id="kobo.29.1">Introducing the Azure Machine Learning Service</span></em><span class="koboSpan" id="kobo.30.1">, to create the environment workspace </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">to use.</span></span></p>
<p><span class="koboSpan" id="kobo.32.1">The following are the prerequisites for </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.34.1">Have access to </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">the internet.</span></span></li>
<li><span class="koboSpan" id="kobo.36.1">Have a web browser, preferably Google Chrome or Microsoft </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">Edge Chromium.</span></span></li>
<li><span class="koboSpan" id="kobo.38.1">To access the Azure Machine Learning Service workspace, please go to this address: </span><a href="https://ml.azure.com"><span class="koboSpan" id="kobo.39.1">https://ml.azure.com</span></a><span class="koboSpan" id="kobo.40.1">. </span><span class="koboSpan" id="kobo.40.2">Select the workspace from the </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">drop-down list.</span></span></li>
</ul>
<h1 id="_idParaDest-52"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.42.1">Training code-free models with the designer</span></h1>
<p><span class="koboSpan" id="kobo.43.1">In this section, let’s see what options are available for code-free modeling using the </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">designer</span></strong><span class="koboSpan" id="kobo.45.1">. </span><span class="koboSpan" id="kobo.45.2">The Designer</span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.46.1"> enables data scientists to create models </span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.47.1">without the need to write code. </span><span class="koboSpan" id="kobo.47.2">It makes it easy for any data scientist to build and compare models. </span><span class="koboSpan" id="kobo.47.3">Within the designer, the development environment is a graphical user interface that allows right-clicking to change the settings for a given step. </span><span class="koboSpan" id="kobo.47.4">The interface allows not only the development of the model but also one-click deployment to deploy to various styles of APIs, including real-time or batch endpoints, which are REST APIs that can be consumed by other business applications or </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">downstream applications.</span></span></p>
<p><span class="koboSpan" id="kobo.49.1">For example, drag a task to connect to a data source and configure the properties to connect to the data source. </span><span class="koboSpan" id="kobo.49.2">These properties include the dataset name and connection string parameters, including the username </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">and password.</span></span></p>
<h2 id="_idParaDest-53"><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.51.1">Creating a dataset using the user interface</span></h2>
<p><span class="koboSpan" id="kobo.52.1">Let’s go through the</span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.53.1"> steps to create a dataset using the </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">user interface:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.55.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">to </span></span><a href="https://ml.azure.com"><span class="No-Break"><span class="koboSpan" id="kobo.57.1">https://ml.azure.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.58.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.59.1">Select your </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">workspace name.</span></span></li>
<li><span class="koboSpan" id="kobo.61.1">On the left side of the workspace, select </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Designer</span></strong><span class="koboSpan" id="kobo.63.1">, as seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer075">
<span class="koboSpan" id="kobo.65.1"><img alt="Figure 3.1 – Designer icon " src="image/B18003_03_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.66.1">Figure 3.1 – Designer icon</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.67.1">Once you are on the </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">Designer</span></strong><span class="koboSpan" id="kobo.69.1"> screen, you’ll see that the screen is divided into two parts. </span><span class="koboSpan" id="kobo.69.2">The top part shows some examples or samples available for anyone to test. </span><span class="koboSpan" id="kobo.69.3">All samples use open source datasets, so anyone can test, develop, and learn from them. </span><span class="koboSpan" id="kobo.69.4">The bottom parts show the experiments you created, and if you click on an experiment, the graph will be shown in the canvas to </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">the right.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.71.1">The designer experience is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<span class="koboSpan" id="kobo.73.1"><img alt="Figure 3.2 – Designer experience " src="image/B18003_03_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.74.1">Figure 3.2 – Designer experience</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.75.1">Before creating </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.76.1">an experiment, make sure a compute cluster is created, as shown in </span><a href="B18003_01.xhtml#_idTextAnchor020"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.77.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.78.1">, </span><em class="italic"><span class="koboSpan" id="kobo.79.1">Introducing the Azure Machine Learning Service</span></em><span class="koboSpan" id="kobo.80.1">, or you can also find it in this chapter where we show how to create a cluster for </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">remote jobs.</span></span></li>
<li><span class="koboSpan" id="kobo.82.1">Click the </span><strong class="bold"><span class="koboSpan" id="kobo.83.1">+</span></strong><span class="koboSpan" id="kobo.84.1"> button to create a </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">new experiment:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer077">
<span class="koboSpan" id="kobo.86.1"><img alt="Figure 3.3 – Create a new designer experiment " src="image/B18003_03_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.87.1">Figure 3.3 – Create a new designer experiment</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.88.1">Clicking </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">Create a new pipeline</span></strong><span class="koboSpan" id="kobo.90.1"> will </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.91.1">take you to the designer canvas. </span><span class="koboSpan" id="kobo.91.2">First and foremost, we give the experiment a name. </span><span class="koboSpan" id="kobo.91.3">I have provided </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">Classificationsample1</span></strong><span class="koboSpan" id="kobo.93.1"> as the name. </span><span class="koboSpan" id="kobo.93.2">Now, we also have to provide a compute target. </span><span class="koboSpan" id="kobo.93.3">From the dropdown, select </span><strong class="bold"><span class="koboSpan" id="kobo.94.1">Compute cluster</span></strong><span class="koboSpan" id="kobo.95.1"> and then select the cluster that you have created. </span><span class="koboSpan" id="kobo.95.2">The cluster can be CPU-based </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">or GPU-based.</span></span></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.97.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.98.1">A compute cluster</span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.99.1"> provides a way to scale compute across multiple VMs to scale horizontally. </span><span class="koboSpan" id="kobo.99.2">Select CPU or GPU based on the use case. </span><span class="koboSpan" id="kobo.99.3">For example, most tabular datasets with less-than-TB size can use CPU-based clusters. </span><span class="koboSpan" id="kobo.99.4">For vision-based workloads, please choose </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">GPU clusters.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.101.1">Select the default data store, which usually would be the Azure Machine Learning service’s underlying data store. </span><span class="koboSpan" id="kobo.101.2">Select </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">workspaceblobstore</span></strong><span class="koboSpan" id="kobo.103.1"> as your choice and provide experiment details in the </span><strong class="bold"><span class="koboSpan" id="kobo.104.1">Draft details</span></strong><span class="koboSpan" id="kobo.105.1"> section. </span><span class="koboSpan" id="kobo.105.2">Then, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">X</span></strong><span class="koboSpan" id="kobo.107.1"> icon on the right side to see the </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">entire canvas:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer078">
<span class="koboSpan" id="kobo.109.1"><img alt="Figure 3.4 – Create a new designer experiment canvas " src="image/B18003_03_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.110.1">Figure 3.4 – Create a new designer experiment canvas</span></p>
<p><span class="koboSpan" id="kobo.111.1">Note, from </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.112.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.113.1">.4</span></em><span class="koboSpan" id="kobo.114.1">, that </span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.115.1">on the left side you have the menu options. </span><span class="koboSpan" id="kobo.115.2">This is where we have all the tasks that can be dragged and dropped onto the canvas to build a model. </span><span class="koboSpan" id="kobo.115.3">The menu is categorized for different operations, such as datasets, data input and output, data transformation, and ML algorithms. </span><span class="koboSpan" id="kobo.115.4">Consider reading the product documentation online for each task and its properties </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">and functionalities.</span></span></p>
<p><span class="koboSpan" id="kobo.117.1">Let’s build a model. </span><span class="koboSpan" id="kobo.117.2">The first thing you are going to bring is the dataset that you have it registered from </span><a href="B18003_02.xhtml#_idTextAnchor038"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.118.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.119.1">, </span><em class="italic"><span class="koboSpan" id="kobo.120.1">Working with Data in AMLS</span></em><span class="koboSpan" id="kobo.121.1">. </span><span class="koboSpan" id="kobo.121.2">In the left menu, expand </span><strong class="bold"><span class="koboSpan" id="kobo.122.1">Datasets</span></strong><span class="koboSpan" id="kobo.123.1">, select the one to use, and drag and drop it to </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">the canvas.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.125.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.126.1">In this chapter, I am going to walk you through a basic ML </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">modeling step.</span></span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.128.1">For this</span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.129.1"> chapter, I have created a Titanic open source data sample and configured as a dataset. </span><span class="koboSpan" id="kobo.129.2">Here is how it looks when you drag and drop it on the canvas. </span><span class="koboSpan" id="kobo.129.3">Right-click on the dataset and the property sheet will show on the right side of the screen. </span><span class="koboSpan" id="kobo.129.4">Select </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Output</span></strong><span class="koboSpan" id="kobo.131.1"> and view the dataset sample rows. </span><span class="koboSpan" id="kobo.131.2">An option to view the data profile will also </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">be provided:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer079">
<span class="koboSpan" id="kobo.133.1"><img alt="Figure 3.5 – Dataset on canvas " src="image/B18003_03_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.134.1">Figure 3.5 – Dataset on canvas</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.135.1">Now, in the search box of the left menu, type </span><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">Select Columns in Dataset</span></strong><span class="koboSpan" id="kobo.137.1"> and drag and drop it on the canvas, then connect the previous dataset to </span><strong class="bold"><span class="koboSpan" id="kobo.138.1">Select Columns in Dataset</span></strong><span class="koboSpan" id="kobo.139.1">. </span><span class="koboSpan" id="kobo.139.2">Now, click </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">Select Columns in Dataset</span></strong><span class="koboSpan" id="kobo.141.1">, go to </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Select columns</span></strong><span class="koboSpan" id="kobo.143.1">, and select the </span><strong class="bold"><span class="koboSpan" id="kobo.144.1">Edit columns</span></strong><span class="koboSpan" id="kobo.145.1"> to use for modeling. </span><span class="koboSpan" id="kobo.145.2">This task allows us to choose which columns we </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">can use:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer080">
<span class="koboSpan" id="kobo.147.1"><img alt="Figure 3.6 – Select Columns in Dataset " src="image/B18003_03_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.148.1"> Figure 3.6 – Select Columns in Dataset</span></p>
<p><span class="koboSpan" id="kobo.149.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.150.1">Edit Columns</span></strong><span class="koboSpan" id="kobo.151.1"> section, choose the columns we need. </span><span class="koboSpan" id="kobo.151.2">There are options to select all </span><a id="_idIndexMarker214"/><span class="koboSpan" id="kobo.152.1">columns, all features, or all labels or choose by name. </span><span class="koboSpan" id="kobo.152.2">For the preceding sample, we chose to select by column name and selected columns from </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">the list.</span></span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.154.1">The next transformation is going to be for cleaning data. </span><span class="koboSpan" id="kobo.154.2">This is a common task to perform to get rid of unwanted rows that have no values, null values, and so on. </span><span class="koboSpan" id="kobo.154.3">Type </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">Clean Missing Data</span></strong><span class="koboSpan" id="kobo.156.1"> in the search box and drop it on the canvas, then connect it to the previous task, in this case, </span><strong class="bold"><span class="koboSpan" id="kobo.157.1">Select Columns </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.158.1">in Dataset</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer081">
<span class="koboSpan" id="kobo.160.1"><img alt="Figure 3.7 – Clean Missing Data " src="image/B18003_03_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.161.1">Figure 3.7 – Clean Missing Data</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.162.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">Edit column</span></strong><span class="koboSpan" id="kobo.164.1"> and</span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.165.1"> select the columns or features to clean. </span><span class="koboSpan" id="kobo.165.2">Feature or column selection can be either by rule or by name. </span><span class="koboSpan" id="kobo.165.3">When you click on the text box, a list will pop up, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.166.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.167.1">.8</span></em><span class="koboSpan" id="kobo.168.1">. </span><span class="koboSpan" id="kobo.168.2">Select the columns or features you need to model. </span><span class="koboSpan" id="kobo.168.3">In this example, select all </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">the columns:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer082">
<span class="koboSpan" id="kobo.170.1"><img alt="Figure 3.8 – Edit column " src="image/B18003_03_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.171.1">Figure 3.8 – Edit column</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.172.1">Now that we </span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.173.1">have done some feature engineering, it’s time to split the data for training and testing. </span><span class="koboSpan" id="kobo.173.2">It’s a very common practice during ML to split the dataset into training and testing. </span><span class="koboSpan" id="kobo.173.3">Usually, the split is 70% training and 30% testing. </span><span class="koboSpan" id="kobo.173.4">Type </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">Split Data</span></strong><span class="koboSpan" id="kobo.175.1"> in the search box and drag and drop it on the canvas to connect it to the previous task. </span><span class="koboSpan" id="kobo.175.2">The property sheet will show up on the right. </span><span class="koboSpan" id="kobo.175.3">For </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">Splitting mode</span></strong><span class="koboSpan" id="kobo.177.1">, select </span><strong class="bold"><span class="koboSpan" id="kobo.178.1">Split Rows</span></strong><span class="koboSpan" id="kobo.179.1">. </span><span class="koboSpan" id="kobo.179.2">For </span><strong class="bold"><span class="koboSpan" id="kobo.180.1">Fraction of rows in the first output dataset</span></strong><span class="koboSpan" id="kobo.181.1">, type in </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">0.7</span></strong><span class="koboSpan" id="kobo.183.1">. </span><span class="koboSpan" id="kobo.183.2">This setting allows us to split the dataset into 70% for training and the remaining 30% for the </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">test dataset.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.185.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.186.1">Split Data</span></strong><span class="koboSpan" id="kobo.187.1"> activity enables you to choose the split, whether the split should be randomized, the seed used for splitting, and whether the split should be stratified, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer083">
<span class="koboSpan" id="kobo.189.1"><img alt="Figure 3.9 – Split Data " src="image/B18003_03_009.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.190.1">Figure 3.9 – Split Data</span></p>
<ol>
<li value="14"><span class="koboSpan" id="kobo.191.1">After </span><strong class="bold"><span class="koboSpan" id="kobo.192.1">Split Data</span></strong><span class="koboSpan" id="kobo.193.1">, we </span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.194.1">need to add the ML algorithm to use for modeling. </span><span class="koboSpan" id="kobo.194.2">In the search box of the menu, type in </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">Two-Class Boosted Decision Tree</span></strong><span class="koboSpan" id="kobo.196.1"> and drag and drop it onto the canvas. </span><span class="koboSpan" id="kobo.196.2">Since this is a simple survived ML task, we are choosing two-class boosted decision tree. </span><span class="koboSpan" id="kobo.196.3">You can select another two-class algorithm as needed. </span><span class="koboSpan" id="kobo.196.4">Once the algorithm is selected, we need to configure its parameters. </span><span class="koboSpan" id="kobo.196.5">Typically, you can leave most as the default values, as these parameters are chosen based on statistics of various model runs. </span><span class="koboSpan" id="kobo.196.6">You should ensure that you set your random seed as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.197.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.198.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.200.1">The following</span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.201.1"> screenshot showcases the parameters to set for </span><strong class="bold"><span class="koboSpan" id="kobo.202.1">Two-Class Boosted </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.203.1">Decision Tree</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer084">
<span class="koboSpan" id="kobo.205.1"><img alt="Figure 3.10 – Two-Class Boosted Decision Tree " src="image/B18003_03_010.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.206.1">Figure 3.10 – Two-Class Boosted Decision Tree</span></p>
<ol>
<li value="15"><span class="koboSpan" id="kobo.207.1">Now, on the left menu, in the search box, type in </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">Train Model</span></strong><span class="koboSpan" id="kobo.209.1"> and drop it onto the canvas. </span><span class="koboSpan" id="kobo.209.2">For </span><strong class="bold"><span class="koboSpan" id="kobo.210.1">Train Model</span></strong><span class="koboSpan" id="kobo.211.1">, we need to connect to two inputs, which are one from the model output and the other from the first output of </span><strong class="bold"><span class="koboSpan" id="kobo.212.1">Split Data</span></strong><span class="koboSpan" id="kobo.213.1">. </span><span class="koboSpan" id="kobo.213.2">Make sure the algorithm and training data are connected. </span><span class="koboSpan" id="kobo.213.3">Then, select </span><strong class="bold"><span class="koboSpan" id="kobo.214.1">Train Model</span></strong><span class="koboSpan" id="kobo.215.1"> and the label column </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">to predict.</span></span></li>
<li><span class="koboSpan" id="kobo.217.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">Edit Column</span></strong><span class="koboSpan" id="kobo.219.1"> and then set </span><strong class="bold"><span class="koboSpan" id="kobo.220.1">Label column</span></strong><span class="koboSpan" id="kobo.221.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.222.1">Survived</span></strong><span class="koboSpan" id="kobo.223.1">. </span><strong class="bold"><span class="koboSpan" id="kobo.224.1">Model explanations</span></strong><span class="koboSpan" id="kobo.225.1"> is a feature that allows us to enable </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">model expandability:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer085">
<span class="koboSpan" id="kobo.227.1"><img alt="Figure 3.11 – Train Model " src="image/B18003_03_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.228.1">Figure 3.11 – Train Model</span></p>
<ol>
<li value="17"><span class="koboSpan" id="kobo.229.1">Now, you can score</span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.230.1"> the model. </span><span class="koboSpan" id="kobo.230.2">Go to the left menu and in the search box, type in </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">Score Model</span></strong><span class="koboSpan" id="kobo.232.1"> and drag and drop it onto the canvas. </span><strong class="bold"><span class="koboSpan" id="kobo.233.1">Score Model</span></strong><span class="koboSpan" id="kobo.234.1"> must be connected to two outputs. </span><span class="koboSpan" id="kobo.234.2">The first input should be connected to the output of </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">Train Model</span></strong><span class="koboSpan" id="kobo.236.1"> and the second input has to be connected to </span><strong class="bold"><span class="koboSpan" id="kobo.237.1">Split Data</span></strong><span class="koboSpan" id="kobo.238.1">’s second output. </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">Score Model</span></strong><span class="koboSpan" id="kobo.240.1"> takes the training output model and then consumes the test dataset to score the </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">test dataset:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer086">
<span class="koboSpan" id="kobo.242.1"><img alt="Figure 3.12 – Score Model " src="image/B18003_03_012.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.243.1">Figure 3.12 – Score Model</span></p>
<ol>
<li value="18"><span class="koboSpan" id="kobo.244.1">Now, the last</span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.245.1"> step here is adding the </span><strong class="bold"><span class="koboSpan" id="kobo.246.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.247.1"> output and getting the model accuracy scores. </span><span class="koboSpan" id="kobo.247.2">For this, from the left menu, drag and drop </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.249.1"> onto the canvas. </span><span class="koboSpan" id="kobo.249.2">For </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.251.1">, the first input should be connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">Score Model</span></strong><span class="koboSpan" id="kobo.253.1"> output. </span><span class="koboSpan" id="kobo.253.2">There are no settings for </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">this task:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer087">
<span class="koboSpan" id="kobo.255.1"><img alt="Figure 3.13 – Evaluate Model " src="image/B18003_03_013.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.256.1">Figure 3.13 – Evaluate Model</span></p>
<ol>
<li value="19"><span class="koboSpan" id="kobo.257.1">Now, click </span><strong class="bold"><span class="koboSpan" id="kobo.258.1">Save</span></strong><span class="koboSpan" id="kobo.259.1"> on the </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.260.1">canvas. </span><span class="koboSpan" id="kobo.260.2">We have now completed our development of the model. </span><span class="koboSpan" id="kobo.260.3">In the upper-right corner, you will see a button </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">for </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.262.1">Submit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer088">
<span class="koboSpan" id="kobo.264.1"><img alt="Figure 3.14 – Submit experiment " src="image/B18003_03_014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.265.1">Figure 3.14 – Submit experiment</span></p>
<ol>
<li value="20"><span class="koboSpan" id="kobo.266.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.267.1">Submit</span></strong><span class="koboSpan" id="kobo.268.1"> and provide a name for </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">the experiment:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer089">
<span class="koboSpan" id="kobo.270.1"><img alt="Figure 3.15 – New experiment " src="image/B18003_03_015.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.271.1">Figure 3.15 – New experiment</span></p>
<ol>
<li value="21"><span class="koboSpan" id="kobo.272.1">Then, click </span><strong class="bold"><span class="koboSpan" id="kobo.273.1">Submit</span></strong><span class="koboSpan" id="kobo.274.1">. </span><span class="koboSpan" id="kobo.274.2">The system </span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.275.1">will take some time to start the compute cluster and then run the experiment. </span><span class="koboSpan" id="kobo.275.2">Provide the experiment name as </span><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">Classificationsample1</span></strong><span class="koboSpan" id="kobo.277.1">. </span><span class="koboSpan" id="kobo.277.2">Provide a job description for the experiment, which is optional. </span><span class="koboSpan" id="kobo.277.3">Leave </span><strong class="bold"><span class="koboSpan" id="kobo.278.1">Compute target</span></strong><span class="koboSpan" id="kobo.279.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.280.1">Default</span></strong><span class="koboSpan" id="kobo.281.1"> as we selected at the beginning of the experiment. </span><span class="koboSpan" id="kobo.281.2">Wait for the experiment to complete. </span><span class="koboSpan" id="kobo.281.3">Once the experiment is started, you should see the </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer090">
<span class="koboSpan" id="kobo.283.1"><img alt="Figure 3.16 – Experiment status " src="image/B18003_03_016.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.284.1">Figure 3.16 – Experiment status</span></p>
<p><span class="koboSpan" id="kobo.285.1">Optionally, you can also see the run</span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.286.1"> details by clicking on </span><strong class="bold"><span class="koboSpan" id="kobo.287.1">Jobs</span></strong><span class="koboSpan" id="kobo.288.1">, and then for </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">Classificationsample1</span></strong><span class="koboSpan" id="kobo.290.1">, click on its </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">latest job.</span></span></p>
<ol>
<li value="22"><span class="koboSpan" id="kobo.292.1">Once the experiment is completed, you should see all the tasks in green, as per the </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer091">
<span class="koboSpan" id="kobo.294.1"><img alt="Figure 3.17 – Experiment completed " src="image/B18003_03_017.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.295.1">Figure 3.17 – Experiment completed</span></p>
<p><span class="koboSpan" id="kobo.296.1">By clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.297.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.298.1"> task, we </span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.299.1">can review the results of the </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.301.1"> task. </span><span class="koboSpan" id="kobo.301.2">In our case, I am only</span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.302.1"> going to show </span><strong class="bold"><span class="koboSpan" id="kobo.303.1">Evaluate Model</span></strong><span class="koboSpan" id="kobo.304.1"> to see the confusion </span><a id="_idIndexMarker226"/><span class="koboSpan" id="kobo.305.1">matrix and the </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">Receiver Operating Characteristic</span></strong><span class="koboSpan" id="kobo.307.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.308.1">ROC</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">) curve:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer092">
<span class="koboSpan" id="kobo.310.1"><img alt="Figure 3.18 – ROC curve " src="image/B18003_03_018.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.311.1">Figure 3.18 – ROC curve</span></p>
<p><span class="koboSpan" id="kobo.312.1">In addition to </span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.313.1">reviewing the ROC curve, we can also review the </span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.314.1">confusion matrix, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer093">
<span class="koboSpan" id="kobo.316.1"><img alt="Figure 3.19 – Confusion matrix " src="image/B18003_03_019.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.317.1">Figure 3.19 – Confusion matrix</span></p>
<p><span class="koboSpan" id="kobo.318.1">In this section, we saw how to train a model using the Designer in AMLS. </span><span class="koboSpan" id="kobo.318.2">Using the Designer, we can train the model using the drag-and-drop interface, as well as carrying out feature engineering to provide an improved model. </span><span class="koboSpan" id="kobo.318.3">As a follow-up, take a look at each task in the </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">user interface.</span></span></p>
<p><span class="koboSpan" id="kobo.320.1">In the next section, you will learn how to train a model by writing Python code and running it on a </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">compute instance.</span></span></p>
<h1 id="_idParaDest-54"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.322.1">Training on a compute instance</span></h1>
<p><span class="koboSpan" id="kobo.323.1">You can </span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.324.1">train a model on a compute instance or</span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.325.1"> on a compute cluster. </span><span class="koboSpan" id="kobo.325.2">In this section, we will use our existing compute instance before continuing with training on a </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">compute cluster.</span></span></p>
<p><span class="koboSpan" id="kobo.327.1">To begin working with a compute instance, we will need to turn on the compute instance that was created in </span><a href="B18003_01.xhtml#_idTextAnchor020"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.328.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.329.1">, </span><em class="italic"><span class="koboSpan" id="kobo.330.1">Introducing the Azure Machine </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.331.1">Learning Service</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.333.1">Follow these steps to train a model on a compute instance </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">within AMLS:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.335.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">to </span></span><a href="https://ml.azure.com"><span class="No-Break"><span class="koboSpan" id="kobo.337.1">https://ml.azure.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.338.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.339.1">Select your </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">workspace name.</span></span></li>
<li><span class="koboSpan" id="kobo.341.1">On the left side of the workspace, </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.343.1">Compute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer094">
<span class="koboSpan" id="kobo.345.1"><img alt="Figure 3.20 – Compute instance icon " src="image/B18003_03_020.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.346.1">Figure 3.20 – Compute instance icon</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.347.1">On</span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.348.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.349.1">Compute</span></strong><span class="koboSpan" id="kobo.350.1"> screen, select your </span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.351.1">compute instance and </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.353.1">Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer095">
<span class="koboSpan" id="kobo.355.1"><img alt="Figure 3.21 – Start compute " src="image/B18003_03_021.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.356.1">Figure 3.21 – Start compute</span></p>
<p><span class="koboSpan" id="kobo.357.1">Your compute instance will change from </span><strong class="bold"><span class="koboSpan" id="kobo.358.1">Stopped</span></strong><span class="koboSpan" id="kobo.359.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.360.1">Starting</span></strong><span class="koboSpan" id="kobo.361.1"> status. </span><span class="koboSpan" id="kobo.361.2">Once the compute instance moves from </span><strong class="bold"><span class="koboSpan" id="kobo.362.1">Starting</span></strong><span class="koboSpan" id="kobo.363.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">Running</span></strong><span class="koboSpan" id="kobo.365.1"> status, it is ready </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">for use.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.367.1">Click on the Terminal blue hyperlink </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">under applications.</span></span></li>
<li><span class="koboSpan" id="kobo.369.1">This will open the terminal on your compute instance. </span><span class="koboSpan" id="kobo.369.2">Note your user will be included in the directory path. </span><span class="koboSpan" id="kobo.369.3">Type the following into the terminal to clone the sample notebooks into your working </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">directory: </span></span><a href="https://github.com/PacktPublishing/Azure-Machine-Learning-Engineering.git"><span class="No-Break"><span class="koboSpan" id="kobo.371.1">https://github.com/PacktPublishing/Azure-Machine-Learning-Engineering.git</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.372.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.373.1">Clicking on</span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.374.1"> the refresh icon shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.375.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.376.1">.22</span></em><span class="koboSpan" id="kobo.377.1"> will </span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.378.1">display the repository in your </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">working directory:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer096">
<span class="koboSpan" id="kobo.380.1"><img alt="Figure 3.22 – Refresh " src="image/B18003_03_022.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.381.1">Figure 3.22 – Refresh</span></p>
<p><span class="koboSpan" id="kobo.382.1">After clicking the refresh icon within AML, the cloned repository will be displayed in your working directory, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer097">
<span class="koboSpan" id="kobo.384.1"><img alt="Figure 3.23 – Azure-Machine-Learning-Engineering " src="image/B18003_03_023.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.385.1">Figure 3.23 – Azure-Machine-Learning-Engineering</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.386.1">Clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.387.1">train-on-compute-instance.ipynb</span></strong><span class="koboSpan" id="kobo.388.1"> notebook will bring up </span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">the notebook.</span></span></li>
<li><span class="koboSpan" id="kobo.390.1">The code snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.391.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.392.1">.24</span></em><span class="koboSpan" id="kobo.393.1"> enables you to connect to the Azure ML workspace in your </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">compute instance:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer098">
<span class="koboSpan" id="kobo.395.1"><img alt="Figure 3.24 – Connecting to the workspace " src="image/B18003_03_024.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.396.1">Figure 3.24 – Connecting to the workspace</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.397.1">The code </span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.398.1">snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.399.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.400.1">.25</span></em><span class="koboSpan" id="kobo.401.1"> uses</span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.402.1"> pandas to read in the dataset that is located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">my_data</span></strong><span class="koboSpan" id="kobo.404.1"> folder and then </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">view it:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer099">
<span class="koboSpan" id="kobo.406.1"><img alt="Figure 3.25 – Data exploration: Reading in the dataset and viewing the data " src="image/B18003_03_025.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.407.1">Figure 3.25 – Data exploration: Reading in the dataset and viewing the data</span></p>
<p><span class="koboSpan" id="kobo.408.1">The </span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.409.1">next cell checks to see what columns have</span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.410.1"> null data have so that we can cleanse </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">the dataset:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer100">
<span class="koboSpan" id="kobo.412.1"><img alt="Figure 3.26 – Data exploration: View null values in the dataset " src="image/B18003_03_026.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.413.1">Figure 3.26 – Data exploration: View null values in the dataset</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.414.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.415.1">Age</span></strong><span class="koboSpan" id="kobo.416.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.417.1">Cabin</span></strong><span class="koboSpan" id="kobo.418.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.419.1">Embarked</span></strong><span class="koboSpan" id="kobo.420.1"> columns in the dataset will require cleansing. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.421.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.422.1">.27</span></em><span class="koboSpan" id="kobo.423.1"> shows</span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.424.1"> populating the </span><strong class="bold"><span class="koboSpan" id="kobo.425.1">Age</span></strong><span class="koboSpan" id="kobo.426.1"> column with the </span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.427.1">median value for a given </span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">Pclass</span></strong><span class="koboSpan" id="kobo.429.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">Sex</span></strong><span class="koboSpan" id="kobo.431.1"> when the value </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">null</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer101">
<span class="koboSpan" id="kobo.435.1"><img alt="Figure 3.27 – Data cleansing: Populating the Age column’s null values with the medians for Pclass and Sex " src="image/B18003_03_027.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.436.1">Figure 3.27 – Data cleansing: Populating the Age column’s null values with the medians for Pclass and Sex</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.437.1">For </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">Cabin</span></strong><span class="koboSpan" id="kobo.439.1">, we can use the first character and treat it as a categorical variable during model creation to represent the location in the ship. </span><span class="koboSpan" id="kobo.439.2">If the value is </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">null</span></strong><span class="koboSpan" id="kobo.441.1">, we will replace it with </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">X</span></strong><span class="koboSpan" id="kobo.443.1">, representing an unknown </span><strong class="source-inline"><span class="koboSpan" id="kobo.444.1">Cabin</span></strong><span class="koboSpan" id="kobo.445.1"> type, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.446.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.447.1">.28</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer102">
<span class="koboSpan" id="kobo.449.1"><img alt="Figure 3.28 – Feature engineering: Populating the Loc column " src="image/B18003_03_028.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.450.1">Figure 3.28 – Feature engineering: Populating the Loc column</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.451.1">We will drop the </span><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">Cabin</span></strong><span class="koboSpan" id="kobo.453.1"> column, given we have retrieved the useful information from it, and also remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">Ticket</span></strong><span class="koboSpan" id="kobo.455.1"> column, as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">Loc</span></strong><span class="koboSpan" id="kobo.457.1"> column will now represent the location within the ship, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.458.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.459.1">.29</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer103">
<span class="koboSpan" id="kobo.461.1"><img alt="Figure 3.29 – Data cleansing: Dropping unnecessary columns " src="image/B18003_03_029.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.462.1">Figure 3.29 – Data cleansing: Dropping unnecessary columns</span></p>
<ol>
<li value="14"><span class="koboSpan" id="kobo.463.1">Continuing with feature engineering, we will create a column called </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">GroupSize</span></strong><span class="koboSpan" id="kobo.465.1">, as groups of passengers that were family members may have had a greater chance at survival by </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">working together:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer104">
<span class="koboSpan" id="kobo.467.1"><img alt="Figure 3.30 – Feature engineering: Group size " src="image/B18003_03_030.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.468.1">Figure 3.30 – Feature engineering: Group size</span></p>
<ol>
<li value="15"><span class="koboSpan" id="kobo.469.1">Given the </span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.470.1">values for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">'Embarked'</span></strong><span class="koboSpan" id="kobo.472.1"> column are limited, and we only have two rows with null values, we will arbitrarily set</span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.473.1"> them to the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.474.1">'S'</span></strong><span class="koboSpan" id="kobo.475.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.476.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.477.1">.31</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer105">
<span class="koboSpan" id="kobo.479.1"><img alt="Figure 3.31 – Data cleansing: Populating null value with a default value " src="image/B18003_03_031.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.480.1">Figure 3.31 – Data cleansing: Populating null value with a default value</span></p>
<p><span class="koboSpan" id="kobo.481.1">As shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.482.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.483.1">.32</span></em><span class="koboSpan" id="kobo.484.1">, we will drop the columns that we won’t be using during the </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">training process:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer106">
<span class="koboSpan" id="kobo.486.1"><img alt="Figure 3.32 – Data cleansing: Dropping columns not needed for model training " src="image/B18003_03_032.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.487.1">Figure 3.32 – Data cleansing: Dropping columns not needed for model training</span></p>
<ol>
<li value="16"><span class="koboSpan" id="kobo.488.1">We will create </span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.489.1">a folder to hold our training data, as </span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.490.1">shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.491.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.492.1">.33</span></em><span class="koboSpan" id="kobo.493.1">. </span><span class="koboSpan" id="kobo.493.2">This is not required but will keep our </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">directories clear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer107">
<span class="koboSpan" id="kobo.495.1"><img alt="Figure 3.34 – View the clean_training_data folder in the directory" src="image/B18003_03_033.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.496.1">Figure 3.33 – Folder creation</span></p>
<p><span class="koboSpan" id="kobo.497.1">The directory can be seen on the left pane in the </span><em class="italic"><span class="koboSpan" id="kobo.498.1">Notebooks</span></em><span class="koboSpan" id="kobo.499.1"> section after clicking on the refresh button, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.500.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.501.1">.34</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.502.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer108">
<span class="koboSpan" id="kobo.503.1"><img alt="" src="image/B18003_03_034.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.504.1">Figure 3.34 – View the clean_training_data folder in the directory</span></p>
<ol>
<li value="17"><span class="koboSpan" id="kobo.505.1">With the </span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.506.1">newly created directory, we can save </span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.507.1">the dataset to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">clean_training_data</span></strong><span class="koboSpan" id="kobo.509.1"> directory, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.510.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.511.1">.35</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer109">
<span class="koboSpan" id="kobo.513.1"><img alt="Figure 3.35 – Saving the engineered dataset " src="image/B18003_03_035.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.514.1">Figure 3.35 – Saving the engineered dataset</span></p>
<ol>
<li value="18"><span class="koboSpan" id="kobo.515.1">We will begin with importing the needed libraries to create a logistic regression model, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.516.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.517.1">.36</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer110">
<span class="koboSpan" id="kobo.519.1"><img alt="Figure 3.36 – Import libraries " src="image/B18003_03_036.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.520.1">Figure 3.36 – Import libraries</span></p>
<p><span class="koboSpan" id="kobo.521.1">After </span><a id="_idIndexMarker247"/><span class="koboSpan" id="kobo.522.1">importing the libraries required for </span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.523.1">our experiment, we will focus on the main method, which will be called as the code is executed on the </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">compute instance:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer111">
<span class="koboSpan" id="kobo.525.1"><img alt="Figure 3.37 – Main module of the experiment " src="image/B18003_03_037.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.526.1">Figure 3.37 – Main module of the experiment</span></p>
<p><span class="koboSpan" id="kobo.527.1">Using</span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.528.1"> MLflow, which is an open source ML </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.529.1">framework to manage an end-to-end ML life cycle and is fully integrated with AMLS, we will create an experiment named </span><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">'titanic_local_compute'</span></strong><span class="koboSpan" id="kobo.531.1">, which can be seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.532.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.533.1">.37</span></em><span class="koboSpan" id="kobo.534.1"> inside the main method. </span><span class="koboSpan" id="kobo.534.2">If it does not exist the first time the notebook is run, it will be created in the AML workspace. </span><span class="koboSpan" id="kobo.534.3">This experiment can be viewed on the </span><strong class="bold"><span class="koboSpan" id="kobo.535.1">Jobs</span></strong><span class="koboSpan" id="kobo.536.1"> tab. </span><span class="koboSpan" id="kobo.536.2">Next, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">mlflow.start_run()</span></strong><span class="koboSpan" id="kobo.538.1"> method, which will begin a new run within the experiment. </span><span class="koboSpan" id="kobo.538.2">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">mlflow.sklearn.autolog()</span></strong><span class="koboSpan" id="kobo.540.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">mlflow.log_metric()</span></strong><span class="koboSpan" id="kobo.542.1"> methods, we can log parameters and ML metrics for the </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">current run.</span></span></p>
<p><span class="koboSpan" id="kobo.544.1">Next, we will discuss the </span><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">model_train</span></strong><span class="koboSpan" id="kobo.546.1"> function, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.547.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.548.1">.38</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.549.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer112">
<span class="koboSpan" id="kobo.550.1"><img alt="Figure 3.38 – Model _train " src="image/B18003_03_038.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.551.1">Figure 3.38 – Model _train</span></p>
<p><span class="koboSpan" id="kobo.552.1">A logistic regression model is </span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.553.1">created in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">model_train</span></strong><span class="koboSpan" id="kobo.555.1"> function, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.556.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.557.1">.38</span></em><span class="koboSpan" id="kobo.558.1">. </span><span class="koboSpan" id="kobo.558.2">The inputs and the response </span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.559.1">variable are separated and a train-test split is applied using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">sklearn</span></strong><span class="koboSpan" id="kobo.561.1"> library. </span><span class="koboSpan" id="kobo.561.2">The model is fitted and the AUC and accuracy are printed as outputs in the notebook, but also leveraging the MLflow framework, they are logged to the experiment as output. </span><span class="koboSpan" id="kobo.561.3">In addition to logging key metrics and parameters as part of an experiment, figures associated with these metrics will be automatically logged using MLflow, which we will look at later in </span><span class="No-Break"><span class="koboSpan" id="kobo.562.1">this section.</span></span></p>
<p><span class="koboSpan" id="kobo.563.1">Given the training has been handled, we also want to include a preprocessor pipeline to handle data transformation as part of our pipeline, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.564.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer113">
<span class="koboSpan" id="kobo.565.1"><img alt="Figure 3.39 – Preprocessor " src="image/B18003_03_039.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.566.1">Figure 3.39 – Preprocessor</span></p>
<ol>
<li value="19"><span class="koboSpan" id="kobo.567.1">We </span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.568.1">have incorporated a preprocessor</span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.569.1"> pipeline to handle data transformation, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.570.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.571.1">.39</span></em><span class="koboSpan" id="kobo.572.1">. </span><span class="koboSpan" id="kobo.572.2">Creating a pipeline for data transformation ensures that when we score unseen data, the same transformations that were applied to our training dataset will be applied to the testing data, and to the new data the model hasn’t seen before. </span><span class="koboSpan" id="kobo.572.3">This enables model deployment to use the same transformations in a deployed model when we get to </span><span class="No-Break"><span class="koboSpan" id="kobo.573.1">that step.</span></span></li>
<li><span class="koboSpan" id="kobo.574.1">Within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">model_train</span></strong><span class="koboSpan" id="kobo.576.1"> method, after plotting the ROC curve, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">confusion_Matrix()</span></strong><span class="koboSpan" id="kobo.578.1"> method to calculate the confusion matrix for the run of the experiment, which will also be logged automatically within AML, as shown later in </span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">the section.</span></span></li>
<li><span class="koboSpan" id="kobo.580.1">This experiment was run directly on the AML compute instance as cells are executed in the notebook. </span><span class="koboSpan" id="kobo.580.2">Print statements and </span><strong class="source-inline"><span class="koboSpan" id="kobo.581.1">plt.show</span></strong><span class="koboSpan" id="kobo.582.1"> provide output directly in the notebook, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.583.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.584.1">.40</span></em><span class="koboSpan" id="kobo.585.1">, but the Azure Machine Learning service has also captured this information within an experiment run, so when a notebook is cleared out, key metrics for model evaluation are </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">not lost:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer114">
<span class="koboSpan" id="kobo.587.1"><img alt="Figure 3.40 – Notebook output " src="image/B18003_03_040.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.588.1">Figure 3.40 – Notebook output</span></p>
<ol>
<li value="22"><span class="koboSpan" id="kobo.589.1">On the</span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.590.1"> left pane, by clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.591.1">Jobs</span></strong><span class="koboSpan" id="kobo.592.1"> icon, we </span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.593.1">can see </span><strong class="bold"><span class="koboSpan" id="kobo.594.1">titanic_local_compute</span></strong><span class="koboSpan" id="kobo.595.1"> under </span><strong class="bold"><span class="koboSpan" id="kobo.596.1">Experiment</span></strong><span class="koboSpan" id="kobo.597.1"> as a blue hyperlink. </span><span class="koboSpan" id="kobo.597.2">By clicking on this experiment, we can drill into an overview of the different runs of our experiment, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.598.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.599.1">.41</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer115">
<span class="koboSpan" id="kobo.601.1"><img alt="Figure 3.41 – Experiment run output " src="image/B18003_03_041.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.602.1">Figure 3.41 – Experiment run output</span></p>
<ol>
<li value="23"><span class="koboSpan" id="kobo.603.1">Clicking</span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.604.1"> on the display name of a given run </span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.605.1">in the experiment provides details regarding the experiment run, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.606.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.607.1">.42</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer116">
<span class="koboSpan" id="kobo.609.1"><img alt="Figure 3.42 – Run details " src="image/B18003_03_042.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.610.1">Figure 3.42 – Run details</span></p>
<ol>
<li value="24"><span class="koboSpan" id="kobo.611.1">By clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.612.1">Metrics</span></strong><span class="koboSpan" id="kobo.613.1"> tab, we can see our </span><strong class="bold"><span class="koboSpan" id="kobo.614.1">AUC</span></strong><span class="koboSpan" id="kobo.615.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.616.1">Accuracy</span></strong><span class="koboSpan" id="kobo.617.1"> values, as logged for the run of the experiment in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.618.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.619.1">.43</span></em><span class="koboSpan" id="kobo.620.1">. </span><span class="koboSpan" id="kobo.620.2">This enables a data scientist to easily compare</span><a id="_idIndexMarker259"/><span class="koboSpan" id="kobo.621.1"> models to understand how </span><a id="_idIndexMarker260"/><span class="koboSpan" id="kobo.622.1">changes to the model impact performance, accelerating </span><span class="No-Break"><span class="koboSpan" id="kobo.623.1">model development:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer117">
<span class="koboSpan" id="kobo.624.1"><img alt="Figure 3.43 – Run metrics " src="image/B18003_03_043.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.625.1">Figure 3.43 – Run metrics</span></p>
<ol>
<li value="25"><span class="koboSpan" id="kobo.626.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.627.1">Images</span></strong><span class="koboSpan" id="kobo.628.1"> tab </span><a id="_idIndexMarker261"/><span class="koboSpan" id="kobo.629.1">captures the figures associated with</span><a id="_idIndexMarker262"/><span class="koboSpan" id="kobo.630.1"> model metrics, such as the ROC curve, precision-recall curve, and confusion matrix, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.631.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.632.1">.44</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.633.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer118">
<span class="koboSpan" id="kobo.634.1"><img alt="Figure 3.44 – Images tab " src="image/B18003_03_044.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.635.1">Figure 3.44 – Images tab</span></p>
<p><span class="koboSpan" id="kobo.636.1">This section</span><a id="_idIndexMarker263"/><span class="koboSpan" id="kobo.637.1"> showed how to train a model using an AML compute instance. </span><span class="koboSpan" id="kobo.637.2">The objective is to show how we</span><a id="_idIndexMarker264"/><span class="koboSpan" id="kobo.638.1"> can train a model using a code-first approach with common open source libraries to tackle the task of data engineering, feature selection, and </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">model development.</span></span></p>
<p><span class="koboSpan" id="kobo.640.1">In the next section, we will use a compute cluster to train </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">a model.</span></span></p>
<h1 id="_idParaDest-55"><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.642.1">Training on a compute cluster</span></h1>
<p><span class="koboSpan" id="kobo.643.1">In the previous </span><a id="_idIndexMarker265"/><span class="koboSpan" id="kobo.644.1">section, we showed how to train your model </span><a id="_idIndexMarker266"/><span class="koboSpan" id="kobo.645.1">on a compute instance. </span><span class="koboSpan" id="kobo.645.2">In this section, we will show you how to submit your training job to a compute cluster when the training job needs to scale out. </span><span class="koboSpan" id="kobo.645.3">AML has made it extremely easy to run your training code on various compute targets without the need to change the training script. </span><span class="koboSpan" id="kobo.645.4">You need to create an AML pipeline that handles the data processing, the model training, and registering the trained model, as explained in </span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">this section.</span></span></p>
<p><span class="koboSpan" id="kobo.647.1">The following are the steps to train your model on a </span><span class="No-Break"><span class="koboSpan" id="kobo.648.1">compute cluster:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.649.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.650.1">to </span></span><a href="https://ml.azure.com"><span class="No-Break"><span class="koboSpan" id="kobo.651.1">https://ml.azure.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.652.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.653.1">Select your </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">workspace name.</span></span></li>
<li><span class="koboSpan" id="kobo.655.1">On the left side of the workspace user interface, </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.657.1">Compute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer119">
<span class="koboSpan" id="kobo.659.1"><img alt="Figure 3.45 – Compute icon " src="image/B18003_03_045.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.660.1">Figure 3.45 – Compute icon</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.661.1">On the </span><strong class="bold"><span class="koboSpan" id="kobo.662.1">Compute</span></strong><span class="koboSpan" id="kobo.663.1"> screen, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.664.1">Compute clusters</span></strong><span class="koboSpan" id="kobo.665.1"> tab and then click on </span><strong class="bold"><span class="koboSpan" id="kobo.666.1">+ New</span></strong><span class="koboSpan" id="kobo.667.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.668.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.669.1">.46</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.670.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer120">
<span class="koboSpan" id="kobo.671.1"><img alt="Figure 3.46 – Creating a new compute cluster " src="image/B18003_03_046.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.672.1">Figure 3.46 – Creating a new compute cluster</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.673.1">The </span><a id="_idIndexMarker267"/><span class="koboSpan" id="kobo.674.1">next few screens allow you to create and</span><a id="_idIndexMarker268"/><span class="koboSpan" id="kobo.675.1"> configure a compute cluster based on your need. </span><span class="koboSpan" id="kobo.675.2">Once done, click on </span><strong class="bold"><span class="koboSpan" id="kobo.676.1">Create</span></strong><span class="koboSpan" id="kobo.677.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.678.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.679.1">.47</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.680.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.681.1"><img alt="Figure 3.47 – Configuring a compute cluster " src="image/B18003_03_047.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.682.1">Figure 3.47 – Configuring a compute cluster</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.683.1">After a</span><a id="_idIndexMarker269"/><span class="koboSpan" id="kobo.684.1"> few seconds, your new compute </span><a id="_idIndexMarker270"/><span class="koboSpan" id="kobo.685.1">cluster will be running, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.686.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.687.1">.48</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.689.1"><img alt="Figure 3.48 – List of compute clusters " src="image/B18003_03_048.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.690.1">Figure 3.48 – List of compute clusters</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.691.1">Go to your working directory, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.692.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.693.1">.49</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.695.1"><img alt="Figure 3.49 – Working directory " src="image/B18003_03_049.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.696.1">Figure 3.49 – Working directory</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.697.1">Clicking</span><a id="_idIndexMarker271"/><span class="koboSpan" id="kobo.698.1"> on </span><strong class="bold"><span class="koboSpan" id="kobo.699.1">train-on-compute-cluster.ipynb</span></strong><span class="koboSpan" id="kobo.700.1"> will </span><a id="_idIndexMarker272"/><span class="koboSpan" id="kobo.701.1">bring up the notebook, which is very similar to the notebook in the previous section. </span><span class="koboSpan" id="kobo.701.2">We will not repeat all the steps here again and will only go through the steps needed to run the training on the remote cluster that you have just created. </span><span class="koboSpan" id="kobo.701.3">To learn more about AML pipelines and submitting remote jobs, please refer </span><span class="No-Break"><span class="koboSpan" id="kobo.702.1">to </span></span><a href="https://github.com/Azure/azureml-examples"><span class="No-Break"><span class="koboSpan" id="kobo.703.1">https://github.com/Azure/azureml-examples</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.704.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.705.1">The code snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.706.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.707.1">.50</span></em><span class="koboSpan" id="kobo.708.1"> is used to create an object to access your </span><span class="No-Break"><span class="koboSpan" id="kobo.709.1">AML workspace:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.710.1"><img alt="Figure 3.50 – Working directory " src="image/B18003_03_050.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.711.1">Figure 3.50 – Working directory</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.712.1">Next, we</span><a id="_idIndexMarker273"/><span class="koboSpan" id="kobo.713.1"> will create an AML </span><a id="_idIndexMarker274"/><span class="koboSpan" id="kobo.714.1">environment, which is an encapsulated Python environment where different steps of an ML pipeline, such as the training step, happen. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.715.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.716.1">.51</span></em><span class="koboSpan" id="kobo.717.1"> shows how to create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.718.1">conda</span></strong><span class="koboSpan" id="kobo.719.1"> environment for your jobs, using a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.720.1">conda</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">.</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">yaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.723.1"> file:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.724.1"><img alt="Figure 3.51 – conda environment " src="image/B18003_03_051.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.725.1">Figure 3.51 – conda environment</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.726.1">The </span><a id="_idIndexMarker275"/><span class="koboSpan" id="kobo.727.1">preceding </span><strong class="source-inline"><span class="koboSpan" id="kobo.728.1">.yaml</span></strong><span class="koboSpan" id="kobo.729.1"> specification file contains </span><a id="_idIndexMarker276"/><span class="koboSpan" id="kobo.730.1">Python packages, which are used in the pipeline. </span><span class="koboSpan" id="kobo.730.2">You can then use this .</span><strong class="source-inline"><span class="koboSpan" id="kobo.731.1">yaml</span></strong><span class="koboSpan" id="kobo.732.1"> file to create and register this custom environment in your AML workspace, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.733.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.734.1">.52</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.736.1"><img alt="Figure 3.52 – Creating and registering a custom environment in AML " src="image/B18003_03_052.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.737.1">Figure 3.52 – Creating and registering a custom environment in AML</span></p>
<p><span class="koboSpan" id="kobo.738.1">To create an AML component, you need to write a Python script to implement the ML task. </span><span class="koboSpan" id="kobo.738.2">This script can take input data and input parameters, which are used within the code, and output the results (for example, a transformed dataset or a trained model) to a persistent place, such as a mounted folder. </span><span class="koboSpan" id="kobo.738.3">An output of an ML component can be used as an input to the next step in the pipeline via its ML component’s input. </span><span class="koboSpan" id="kobo.738.4">Once you have the Python script, you can create the component either programmatically or using a .</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">yaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.740.1"> definition.</span></span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.741.1">Next, we need to write a Python script for the data processing step of the pipeline, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.742.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.743.1">.53</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.745.1"><img alt="Figure 3.53 – Python script for the data preparation step of the pipeline " src="image/B18003_03_053.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.746.1">Figure 3.53 – Python script for the data preparation step of the pipeline</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.747.1">Now</span><a id="_idIndexMarker277"/><span class="koboSpan" id="kobo.748.1"> that we have a script to perform the</span><a id="_idIndexMarker278"/><span class="koboSpan" id="kobo.749.1"> data processing task, we can create an AML component from it using the programmatic definition. </span><span class="koboSpan" id="kobo.749.2">To create an ML component, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">command</span></strong><span class="koboSpan" id="kobo.751.1"> class to specify the inputs and outputs of the Python script, the source code directory of the script, the command line to run the script, and the Python environment where this job will run, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.752.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.753.1">.54</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.755.1"><img alt="Figure 3.54 – Creating a data processing component using the command class " src="image/B18003_03_054.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.756.1">Figure 3.54 – Creating a data processing component using the command class</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.757.1">Next, we </span><a id="_idIndexMarker279"/><span class="koboSpan" id="kobo.758.1">need to write a Python script for the</span><a id="_idIndexMarker280"/><span class="koboSpan" id="kobo.759.1"> model training step of the pipeline and then create an AML component from it. </span><span class="koboSpan" id="kobo.759.2">Please refer to our GitHub to use the Python code for the model training. </span><span class="koboSpan" id="kobo.759.3">To create an AML component from it, we will be using the .</span><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">yaml</span></strong><span class="koboSpan" id="kobo.761.1"> definition this time, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.762.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.763.1">.55</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.764.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer129">
<span class="koboSpan" id="kobo.765.1"><img alt="Figure 3.55 – Creating a model training component using the yaml definition " src="image/B18003_03_055.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.766.1">Figure 3.55 – Creating a model training component using the yaml definition</span></p>
<ol>
<li value="14"><span class="koboSpan" id="kobo.767.1">We can </span><a id="_idIndexMarker281"/><span class="koboSpan" id="kobo.768.1">load the training component from the .</span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">yaml</span></strong><span class="koboSpan" id="kobo.770.1"> file and</span><a id="_idIndexMarker282"/><span class="koboSpan" id="kobo.771.1"> then register it to the workspace using the code snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.772.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.773.1">.56</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer130">
<span class="koboSpan" id="kobo.775.1"><img alt="Figure 3.56 – Loading and registering the model training component " src="image/B18003_03_056.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.776.1">Figure 3.56 – Loading and registering the model training component</span></p>
<ol>
<li value="15"><span class="koboSpan" id="kobo.777.1">Now that both the data processing and model training components have been created, we can start coding the pipeline definition, which will be called in a later step. </span><span class="koboSpan" id="kobo.777.2">We </span><a id="_idIndexMarker283"/><span class="koboSpan" id="kobo.778.1">will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">@dsl.pipeline</span></strong><span class="koboSpan" id="kobo.780.1"> decorator</span><a id="_idIndexMarker284"/><span class="koboSpan" id="kobo.781.1"> to tell the SDK that we are defining an AML pipeline, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.782.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.783.1">.57</span></em><span class="koboSpan" id="kobo.784.1">. </span><span class="koboSpan" id="kobo.784.2">As you can see, the compute target is specified here, which is our compute cluster that we created earlier in </span><span class="No-Break"><span class="koboSpan" id="kobo.785.1">this section:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer131">
<span class="koboSpan" id="kobo.786.1"><img alt="Figure 3.57 – Defining an AML pipeline using the @dsl.pipeline decorator " src="image/B18003_03_057.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.787.1">Figure 3.57 – Defining an AML pipeline using the @dsl.pipeline decorator</span></p>
<ol>
<li value="16"><span class="koboSpan" id="kobo.788.1">Now that we </span><a id="_idIndexMarker285"/><span class="koboSpan" id="kobo.789.1">have defined our pipeline, let’s instantiate</span><a id="_idIndexMarker286"/><span class="koboSpan" id="kobo.790.1"> it by passing our dataset, the split rate, and the name for the trained model, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.791.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.792.1">.58</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.793.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer132">
<span class="koboSpan" id="kobo.794.1"><img alt="Figure 3.58 – Instantiating the pipeline by passing data and parameters " src="image/B18003_03_058.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.795.1">Figure 3.58 – Instantiating the pipeline by passing data and parameters</span></p>
<ol>
<li value="17"><span class="koboSpan" id="kobo.796.1">Now that we </span><a id="_idIndexMarker287"/><span class="koboSpan" id="kobo.797.1">have instantiated the pipeline object, we can</span><a id="_idIndexMarker288"/><span class="koboSpan" id="kobo.798.1"> submit the job to run in AML, which uses the compute cluster to run the steps within the pipeline, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.799.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.800.1">.59</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.801.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer133">
<span class="koboSpan" id="kobo.802.1"><img alt="Figure 3.59 – Submitting a pipeline job to run in AML " src="image/B18003_03_059.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.803.1">Figure 3.59 – Submitting a pipeline job to run in AML</span></p>
<ol>
<li value="18"><span class="koboSpan" id="kobo.804.1">To see the </span><a id="_idIndexMarker289"/><span class="koboSpan" id="kobo.805.1">pipeline progress and details about each</span><a id="_idIndexMarker290"/><span class="koboSpan" id="kobo.806.1"> step of the pipeline, you can either click on the link shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.807.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.808.1">.61</span></em><span class="koboSpan" id="kobo.809.1"> or click on the </span><strong class="bold"><span class="koboSpan" id="kobo.810.1">Jobs</span></strong><span class="koboSpan" id="kobo.811.1"> tab, which will show you a list of experiments, including </span><strong class="bold"><span class="koboSpan" id="kobo.812.1">titanic_remote_cluster</span></strong><span class="koboSpan" id="kobo.813.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.814.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.815.1">.60</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer134">
<span class="koboSpan" id="kobo.817.1"><img alt="Figure 3.60 – Submitting a pipeline job to run in AML " src="image/B18003_03_060.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.818.1">Figure 3.60 – Submitting a pipeline job to run in AML</span></p>
<ol>
<li value="19"><span class="koboSpan" id="kobo.819.1">Go ahead and click on the </span><strong class="bold"><span class="koboSpan" id="kobo.820.1">titanic_remote_cluster</span></strong><span class="koboSpan" id="kobo.821.1"> experiment to see a list of all the runs associated with this pipeline job. </span><span class="koboSpan" id="kobo.821.2">You should only see one run for this job, which we just ran in the notebook. </span><span class="koboSpan" id="kobo.821.3">Clicking on that will take you to a screen with a graphical representation of the pipeline, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.822.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.823.1">.61</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.824.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer135">
<span class="koboSpan" id="kobo.825.1"><img alt="Figure 3.61 – Graphical view of an AML pipeline " src="image/B18003_03_061.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.826.1">Figure 3.61 – Graphical view of an AML pipeline</span></p>
<ol>
<li value="20"><span class="koboSpan" id="kobo.827.1">Go ahead and</span><a id="_idIndexMarker291"/><span class="koboSpan" id="kobo.828.1"> click on different steps of the pipeline to see</span><a id="_idIndexMarker292"/><span class="koboSpan" id="kobo.829.1"> detailed information regarding each step. </span><span class="koboSpan" id="kobo.829.2">For instance, by clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.830.1">Train Titanic Survival Model</span></strong><span class="koboSpan" id="kobo.831.1"> step, you can see model metrics such as accuracy, precision, and recall, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.832.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.833.1">.62</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.834.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer136">
<span class="koboSpan" id="kobo.835.1"><img alt="Figure 3.62 – Detailed view of pipeline steps " src="image/B18003_03_062.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.836.1">Figure 3.62 – Detailed view of pipeline steps</span></p>
<p><span class="koboSpan" id="kobo.837.1">You have </span><a id="_idIndexMarker293"/><span class="koboSpan" id="kobo.838.1">successfully trained a model and reviewed the metrics</span><a id="_idIndexMarker294"/><span class="koboSpan" id="kobo.839.1"> within your AML workspace using an AML compute cluster. </span><span class="koboSpan" id="kobo.839.2">Now, let’s review </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">the chapter.</span></span></p>
<h1 id="_idParaDest-56"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.841.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.842.1">We have covered a lot of topics in this chapter. </span><span class="koboSpan" id="kobo.842.2">We have shown you how to train an ML model using the AML Designer, which requires no coding. </span><span class="koboSpan" id="kobo.842.3">It is a great fit for citizen data scientists or advanced data scientists who would like to explore different algorithms quickly and evaluate their performance without having to write a lot of code to do so. </span><span class="koboSpan" id="kobo.842.4">Next, you learned how to train an ML model through the AML Python SDK, running on both a compute instance and a compute cluster for more compute-intensive </span><span class="No-Break"><span class="koboSpan" id="kobo.843.1">ML jobs.</span></span></p>
<p><span class="koboSpan" id="kobo.844.1">In the next chapter, you will learn how to tune hyperparameters for your ML models using </span><span class="No-Break"><span class="koboSpan" id="kobo.845.1">AML HyperDrive.</span></span></p>
</div>
</body></html>