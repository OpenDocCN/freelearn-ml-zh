["```py\n > install.packages(\"gdata\")\n > install.packages(\"evir\")\n > library(gdata)\n > library(evir)\n\n```", "```py\n> StormDamageData <- read.xls(\"d:/publicdatamay2007.xls\", sheet = 1)\n\n```", "```py\n> head(StormDamageData)\n\n```", "```py\n> tail(StormDamageData)\n\n```", "```py\n> dim(StormDamageData)\n\n```", "```py\n > ChangeFormat <- function(x){\n x = as.character(x)\n for(i in 1:10){x=sub(\",\",\"\",as.character(x))}\n return(as.numeric(x)) }\n\n```", "```py\n> base <- StormDamageData[,1:4]\n\n```", "```py\n> base$Base.Economic.Damage <- Vectorize(ChangeFormat)(StormDamageData$Base.Economic.Damage)\n\n```", "```py\n> base$Normalized.PL05 <- Vectorize(ChangeFormat)(StormDamageData$Normalized.PL05)\n\n```", "```py\n> base$Normalized.CL05 <- Vectorize(ChangeFormat)(StormDamageData$Normalized.CL05)\n\n```", "```py\n> head(base)\n\n```", "```py\n> plot(base$Normalized.PL05/1e9, type=\"h\", ylim=c(0,155), main = \"207 Hurricanes, Normalized Costs: 1900 - 2005\", xlab = \"Index of Loss\", ylab = \"Normalized Costs\", col = \"red\")\n\n```", "```py\n> TestBase <- table(base$Year)\n\n```", "```py\n> TestBase\n\n```", "```py\n> years <- as.numeric(names(TestBase))\n\n```", "```py\n> years\n\n```", "```py\n> frequency <- as.numeric(TestBase)\n\n```", "```py\n> frequency\n\n```", "```py\n> years0frequency <- (1900:2005)[which(!(1900:2005)%in%years)]\n\n```", "```py\n> years0frequency\n\n```", "```py\n> StormDamageData <- data.frame(years=c(years, years0frequency), frequency=c(frequency, rep(0,length(years0frequency))))\n\n```", "```py\n> head(StormDamageData) \n\n```", "```py\n> plot(years, frequency, type=\"h\", main = \"Frequency of Hurricanes: 1900 - 2005\", xlab = \"Time (Years)\", ylab = \"Annual Frequency\", col = \"red\")\n\n```", "```py\n> mean(StormDamageData$frequency)\n\n```", "```py\n> LinearTrend <- glm(frequency~years, data = StormDamageData, family=poisson(link=\"identity\"), start=lm(frequency~years, data = StormDamageData)$coefficients)\n\n```", "```py\n> LinearTrend\n\n```", "```py\n> ExpTrend <- glm(frequency~years, data=StormDamageData, family = poisson(link=\"log\"))\n\n```", "```py\n> ExpTrend\n\n```", "```py\n> plot(years, frequency, type='h', ylim=c(0,6), main = \"No. of Major Hurricanes Predicted for 2014\", xlim=c(1900,2020))\n\n```", "```py\n> cpred1 <- predict(ExpTrend, newdata = data.frame(years=1890:2030), type=\"response\")\n\n```", "```py\n> cpred1\n\n```", "```py\n> lines(1890:2030,cpred1,col=\"blue\")\n\n```", "```py\n> cpred0 <- predict(LinearTrend, newdata=data.frame(years=1890:2030), type=\"response\")\n\n```", "```py\n> cpred0\n\n```", "```py\n> lines(1890:2030, cpred0, col=\"red\"))\n\n```", "```py\n> abline(h = mean(StormDamageData$frequency), col=\"black\")\n\n```", "```py\n> predictions <- cbind(constant = mean(StormDamageData$frequency), linear = cpred0[126], exponential=cpred1[126])\n\n```", "```py\n> predictions\n\n```", "```py\n> points(rep((1890:2030)[126],3), predictions, col=c(\"black\",\"red\",\"blue\"), pch=19)\n\n```", "```py\n> hill(base$Normalized.PL05)\n\n```", "```py\n> threshold <- .5\n\n```", "```py\n > gpd.PL <- gpd(base$Normalized.PL05/1e9/20, threshold)$par.ests\n\n```", "```py\n> mean(base$Normalized.CL05/1e9/20> .5)\n\n```", "```py\n > ExpectedValue <- function(yinf,ysup,xi,beta){\n + as.numeric(integrate(function(x) (x-yinf) * dgpd(x,xi,mu=threshold,beta),\n + lower=yinf,upper=ysup)$value +\n + (1-pgpd(ysup,xi,mu=threshold,beta))*(ysup-yinf))\n + }\n\n```", "```py\n> predictions[1]\n\n```", "```py\n> mean(base$Normalized.PL05/1e9/20>.5)\n\n```", "```py\n> ExpectedValue(2,6,gpd.PL[1],gpd.PL[2])*1e3\n\n```", "```py\n> predictions[1] * mean(base$Normalized.PL05/1e9/20> .5) * ExpectedValue(2, 6, gpd.PL[1], gpd.PL[2]) * 1e3\n\n```"]