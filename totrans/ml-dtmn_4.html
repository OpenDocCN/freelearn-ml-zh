<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Improving Individual Models</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we will see how we can improve different models, and we will see how to modify model options. We will also learn how to use different models and see how we can remove noise by removing predictors that are not really needed for predictions. You will also understand how to prepare additional data for the models, and we will see how we can add additional fields. Finally, you see how how oversampling and undersampling different categories of an outcome variable can make it more likely that the model that you end up using actually better understands the data.</p>
<p>The following are the topics that will be covered in this chapter, and these are the ways in which models can be improved:</p>
<ul>
<li>Modifying model options</li>
<li>Using different models</li>
<li>Removing noise</li>
<li>Doing additional data preparation</li>
<li>Balancing data (oversampling/undersampling)</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Modifying model options</h1>
                </header>
            
            <article>
                
<p>Modifying model options to improve the model is one of the straightforward ways to improve a model. We will see how we can do this with the help of an example:</p>
<ol>
<li>We will create an <span class="packt_screen">SVM</span> model just as we did in the second chapter:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-589 image-border" src="assets/5df9f40a-f416-4358-a497-5ded25fa0549.png" style="width:106.75em;height:81.83em;"/></p>
<ol start="2">
<li>Click on <span class="packt_screen">Status</span>, go to the <span class="packt_screen">Expert</span> tab, and select <span class="packt_screen">Expert</span> under <span class="packt_screen">Mode</span>. As we have seen in <a href="f4f20b86-4417-4c0c-a8b2-d0be16f28e20.xhtml">Chapter 2</a>, <em>Getting Started with Machine Learning</em>, whenever we are using <span class="packt_screen">SVM</span> models, we need to modify their settings. Change the <span class="packt_screen">Regularization parameter</span> to <span class="packt_screen">5</span>. And, in the <span class="packt_screen">Kernel type</span>, select <span class="packt_screen">Polynomial</span>. Then, click on <span class="packt_screen">Run</span>.</li>
</ol>
<ol start="3">
<li>You will see a model created. Now, let's do our next step of analyzing the model. Connect your generated model to an <span class="packt_screen">Analysis</span> node from the <span class="packt_screen">Output</span> palette. Open the <span class="packt_screen">Analysis</span> node, and select the <span class="packt_screen">Coincidence matrices</span> (for the symbolic targets option) and click on <span class="packt_screen">Run</span>. This will be the result that will be acquired:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-687 image-border" src="assets/ca69616e-309c-453d-b08a-0ba3c5710a08.png" style="width:33.00em;height:28.67em;"/></p>
<p class="CDPAlignLeft CDPAlign">The results clearly show that the model isn't consistent as there is a huge difference between the accuracy percentage of the training and the testing dataset. But, what we can see is the testing percentage is better than the testing percentage that we acquired for the linear model in <a href="f4f20b86-4417-4c0c-a8b2-d0be16f28e20.xhtml">Chapter 2</a>, <em>Getting Started with Machine Learning</em>, around 73%. Hence, maybe the polynomial model can do a better job but not with the current model as it is capitalizing on chance.</p>
<p>Now that we have a potentially better model, we can go ahead and modify the settings of this model. You can go to the <span class="packt_screen">SVM</span> model status, and in the <span class="packt_screen">Expert</span> tab, you can see that the <span class="packt_screen">Degree</span> is set to <span class="packt_screen">3</span>. There is a chance that this cubic function may be proving a bit complex for the data that we have. Let's use a quadratic function instead. Change the <span class="packt_screen">Degree</span> to <span class="packt_screen">2</span> and click <span class="packt_screen">Run</span>.</p>
<p>Again, run the analysis just like we have always done, and you will find these results:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-688 image-border" src="assets/8554ba26-20aa-4c56-b168-1b0242cb7c29.png" style="width:32.92em;height:29.00em;"/></p>
<p>As you can see, the accuracy percentages of both the datasets are within a difference of 5%. Hence, we can say that the model is consistent. Moreover, we can also see that the overall accuracy for the testing dataset has improved.</p>
<p>This is how we improved an existing model by modifying its options to provide better results with higher overall accuracy and consistency.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a different model to improve results</h1>
                </header>
            
            <article>
                
<p>In the previous section, we saw how we can improve a result acquired from the model by modifying its options. Now, we will see how to improve the results by changing the model itself.</p>
<p>Every model looks at the data differently. They have their own algorithms. These algorithms provide us with different perspectives to look at the data. Sometimes, just changing the perception of looking at the data can give us improved results. The different algorithms capitalize on unique aspects of data. Let's see how we can do this with the help of an example:</p>
<ol>
<li>Bring your data, and partition it into training and testing datasets.</li>
<li>Connect the <span class="packt_screen">Partition</span> node to a <span class="packt_screen">Neural Net</span> node from the <span class="packt_screen">Modeling</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-689 image-border" src="assets/75253761-59fd-422c-aea4-a4e03a8f3af5.png" style="width:90.50em;height:47.75em;"/></p>
<ol start="3">
<li>Click on the <span class="packt_screen">Neural Net</span> node and go to the <span class="packt_screen">Build Options</span> tab. In this, go the <span class="packt_screen">Advanced</span> option and just change the <span class="packt_screen">Random seed</span> to <kbd>5000</kbd>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-690 image-border" src="assets/4fd2e68f-7287-4803-b3a1-63fb082eb2b6.png" style="width:42.42em;height:36.08em;"/></p>
<ol start="4">
<li class="CDPAlignLeft CDPAlign">The reason that we are keeping the seed as <kbd>5000</kbd> is because we have acquired a better result using <kbd>5000</kbd> as the seed, as you may can recall from <a href="f4f20b86-4417-4c0c-a8b2-d0be16f28e20.xhtml">Chapter 2</a>, <em>Getting Started with Machine Learning</em><span>,</span> where we have demonstrated a neural network.</li>
</ol>
<ol start="5">
<li>Click on <span class="packt_screen">Run</span>.</li>
<li>Once again, you will have to analyze the model that is built. For this, recall the steps that we have followed until now. Go to the <span class="packt_screen">Output</span> palette, and connect the generated model node to the <span class="packt_screen">Analysis</span> node. Run the <span class="packt_screen">Analysis</span> node with the checked <span class="packt_screen">Coincidence</span> <span class="packt_screen">matrices</span>. The following will be the results acquired:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-691 image-border" src="assets/df18ccd7-5fd4-43f7-aa7b-38a7f0f902a2.png" style="width:33.33em;height:28.33em;"/></p>
<ol start="7">
<li>You can see that we are at an overall accuracy of around 80%, and how each of the predictions have performed. The overall accuracy is similar to what we have achieved when we used the <span class="packt_screen">SVM</span> model. Hence, we can say that the <span class="packt_screen">SVM</span> and <span class="packt_screen">Neural Net</span> models are doing equally well for this dataset. Let's see how we can improve these results a little more.</li>
<li>We will use a decision tree in this example. For adding a decision tree node, select the <span class="packt_screen">Partition</span> node, and connect it to the <span class="packt_screen">C5.0</span> node from the <span class="packt_screen">Modeling</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-692 image-border" src="assets/bbfe92f1-947f-4b21-b98e-186e5cd9d482.png" style="width:90.50em;height:47.75em;"/></p>
<p style="padding-left: 60px">The <span class="packt_screen">C5.0</span> model is a decision tree model that looks at the data from a very different perspective.</p>
<p class="mce-root"/>
<ol start="9">
<li>Click on the <span class="packt_screen">C5.0</span> model node to build a <strong>C5.0</strong> model and run it:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-695 image-border" src="assets/a23483f3-5ab3-4967-8189-0ba7a4c1e610.png" style="width:66.58em;height:34.92em;"/></p>
<ol start="10">
<li>Now, connect the <span class="packt_screen">C5.0</span> model node to the <span class="packt_screen">Neural Net</span> generated model node.</li>
</ol>
<ol start="11">
<li>Connect the <span class="packt_screen">C5.0</span> generated model to the <span class="packt_screen">Analysis</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-696 image-border" src="assets/e1bebf80-9c06-4a40-8a34-4cca560fee36.png" style="width:48.25em;height:25.42em;"/></p>
<p style="padding-left: 60px">This will enable us to compare the results very easily.</p>
<ol start="12">
<li>Run the <span class="packt_screen">Analysis</span> node. The following will be the results acquired:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-305 image-border" src="assets/0156d7c3-821b-41a3-b8bb-33478e428957.png" style="width:32.50em;height:36.50em;"/></p>
<p style="padding-left: 60px">As you can see, the overall accuracy for the testing dataset with the <span class="packt_screen">C5.0</span> model is 85%. This is much better than what we had acquired with just the <span class="packt_screen">Neural Net</span> model. We can certainly improve on this by making some modifications to the <span class="packt_screen">C5.0</span> model, which I'll leave up to you as a homework exercise.</p>
<p>So, we saw how the <span class="packt_screen">C5.0</span> model slightly improved the results, and has done a good job in overall accuracy and with each of the predictions both for the training and testing dataset. This was just an example on another approach to improve the performance of a model. We will now see how removing noise from the data can give us much better results.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Removing noise to improve models</h1>
                </header>
            
            <article>
                
<p>Let's focus on how noise can affect the results. Noise is nothing but missing data, outliers, or too many predictors that try to confuse the model with unnecessary predictions.</p>
<div class="packt_infobox">Decision tree models don't have noise because of too many predictors, as by default, they eliminate the predictors that they don't use for predictions as opposed to other statistical and machine learning models.</div>
<p>Having too many predictors in a model causes the following problems:</p>
<ul>
<li>Additional noise in the data that affects the overall accuracy of the model</li>
<li>The model becomes much more complex than it should be</li>
<li>If new data is to be added for new predictions, we need to collect data even for the variables that are not important and are not really required for the predictions, because our model uses them up to a certain extent.</li>
</ul>
<p>If these kinds of predictors are cleared and eliminated from the model, this could simplify the understanding of the model and, potentially, it will give better results as well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to remove noise</h1>
                </header>
            
            <article>
                
<p>Let's understand with the help of an example. Follow these steps:</p>
<ol>
<li>Partition your data into a training and testing dataset.</li>
<li>Connect your <span class="packt_screen">Partition</span> node to a <span class="packt_screen">Neural Net</span> model from the <span class="packt_screen">Modeling</span> palette.</li>
<li>Select the model and, just like we have always done, go to the <span class="packt_screen">Build Options</span> tab, then to the <span class="packt_screen">Advanced</span> options, and change the <span class="packt_screen">Random seed</span> to <kbd>5000</kbd> (because that has given us the best results so far). Click on <span class="packt_screen">Run</span>.</li>
<li>We have seen the accuracy of this model before. Refer to the list of top 10 predictors for different random seeds that we acquired and stored in a table while demonstrating <span class="packt_screen">Neural Net</span> in <a href="f4f20b86-4417-4c0c-a8b2-d0be16f28e20.xhtml">Chapter 2</a>, <em>Getting Started with Machine Learning</em>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-697 image-border" src="assets/6e878a7d-ac7e-449f-9a20-3c5b75b0fbf4.png" style="width:42.00em;height:17.83em;"/></p>
<p style="padding-left: 60px">We will now remove the variables, which haven't appeared in any of the models or have appeared in just a few.</p>
<ol start="5">
<li>For removing variables, we will create another version of this <span class="packt_screen">Neural Net</span> model. Connect the <span class="packt_screen">Partition</span> node to another <span class="packt_screen">Neural Net</span> model from the <span class="packt_screen">Modeling</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-698 image-border" src="assets/4251f35a-c0c2-40f3-b57d-f1ae18201be8.png" style="width:90.58em;height:47.67em;"/></p>
<ol start="6">
<li>Edit the new <span class="packt_screen">Neural Net</span> model: Here, in the <span class="packt_screen">Fields</span> tab, we will remove the <span class="packt_screen">Predictors</span> that didn't appear in the top 10 list of any model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-700 image-border" src="assets/3b731e5b-ff81-4d04-b837-297657a1df6a.png" style="width:38.67em;height:40.58em;"/></p>
<p style="padding-left: 60px">You just have to click the predictor from the <span class="packt_screen">Inputs</span> list and click on the arrow pointing towards the left-side box. You can also restore them if needed using the same method. These are the variables that didn't appear in the top 10 list of any model.</p>
<ol start="7">
<li>We will also remove the variables that appeared just once or twice in the lists:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-699 image-border" src="assets/0f8917ea-9fa6-4c73-9d7a-83d1088e724e.png" style="width:39.17em;height:41.25em;"/></p>
<ol start="8">
<li>Go to the <span class="packt_screen">Advanced</span> options in the <span class="packt_screen">Build Options</span> tab and change the <span class="packt_screen">Random seed</span> to <kbd>5000.</kbd> Then click on <span class="packt_screen">Run</span>.</li>
<li>Connect the first <span class="packt_screen">Neural Net</span> model to the second <span class="packt_screen">Neural Net</span> model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-701 image-border" src="assets/e168247f-90d3-4dc4-83c0-ef782b8cd18b.png" style="width:62.25em;height:37.58em;"/></p>
<ol start="10">
<li class="CDPAlignLeft CDPAlign">Connect the second <span class="packt_screen">Neural Net</span> model to the <span class="packt_screen">Analysis</span> node from the <span class="packt_screen">Output</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-702 image-border" src="assets/bb652aff-a9e8-46bb-9409-b42ebf681a07.png" style="width:78.83em;height:47.92em;"/></p>
<ol start="11">
<li>Run the <span class="packt_screen">Analysis</span> node, just like we have always done. The following will be the comparative analysis of the two models:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-313 image-border" src="assets/ddd7e56b-0830-4cf5-b040-e33ca0dc02f4.png" style="width:30.92em;height:34.33em;"/></p>
<p style="padding-left: 60px">As you can see, the overall accuracy for the testing and training dataset of the second model is slightly better than the first model. Hence, we got a 2% improvement in predictability just by removing some unnecessary predictors. If we see the job of the model in predicting for each of the individual categories, the model with noise removed has done well in that too.</p>
<p>Hence, we have explored another way to improve the results acquired from a model. We saw how removing noise, and reducing the number of variables or predictors by eliminating the unnecessary ones, can give us better results. Let's move on to see another method to improve accuracy. We will see how preparing the data to some extent can give us better results.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Doing additional data preparation</h1>
                </header>
            
            <article>
                
<p>In this section, we will see how additional preparation done on the data can allow us to extract an extra piece of information.</p>
<p>Until now, we have improved our model by modifying its options, using a different model, changing the perspective of looking at data, and removing noise. Sometimes though, these techniques will just slightly improve the model; but if you could go back to the data preparation phase and look for extra bits that can be pulled from the data that can give better results, this can really go a long way in improving accuracy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Preparing the data</h1>
                </header>
            
            <article>
                
<p>Follow these steps to prepare the data in the data preparation stage:</p>
<ol>
<li>Get your data and partition it.</li>
<li>Run a <span class="packt_screen">Neural Net</span> model again, with a <span class="packt_screen">Random seed</span> of <kbd>5000</kbd>. We will get an accuracy of around 80%.</li>
<li>We will now create a new model and add one additional predictor. If you go back to the list of top ten predictors list, we will find predictors such as the number of speakers and TVs that customers purchased. Hence, it makes sense to have a predictor that shows the total number of items purchased.</li>
</ol>
<ol start="4">
<li>Go to the <span class="packt_screen">Field Ops</span> palette and connect the <span class="packt_screen">Partition</span> node to a <span class="packt_screen">Derive</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-703 image-border" src="assets/e4bbdd4e-1820-4afb-91b6-036ef9b63b36.png" style="width:90.58em;height:47.92em;"/></p>
<p style="padding-left: 60px">A <span class="packt_screen">Derive</span> node allows us to create additional variables.</p>
<ol start="5">
<li>Edit the <span class="packt_screen">Derive</span> node. Set the <span class="packt_screen">Derive field</span> as <kbd>Total Items</kbd> and click on the expression builder button, which is on the right of the <span class="packt_screen">Formula</span> field, and we will create an expression by selecting the predictors of interest and clicking on the plus button:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-704 image-border" src="assets/98a8ca4d-86d7-41b9-b4d7-6bc7a20ae433.png" style="width:42.42em;height:29.92em;"/></p>
<p style="padding-left: 60px">This means that <kbd>Total Items</kbd> includes <span class="packt_screen">Stereos</span>, <span class="packt_screen">TVs</span>, and <span class="packt_screen">Speakers</span>. You will get an expression in the <span class="packt_screen">Formula</span> field, like this:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-706 image-border" src="assets/15f8b8bf-8e7a-4d06-a0ff-5a47982557d8.png" style="width:31.83em;height:29.50em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">This is the expression that will be used for <kbd>Total Items</kbd>. Click on <span class="packt_screen">OK</span>.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="6">
<li>The variable that we just created needs to be instantiated so that the model is able to use it; for this, connect the <span class="packt_screen">Total Items</span> node to the <span class="packt_screen">Type</span> node from the <span class="packt_screen">Field Ops</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-707 image-border" src="assets/2d96befb-9d04-40ec-8d39-b527c5e644c8.png" style="width:90.75em;height:47.58em;"/></p>
<ol start="7">
<li>Edit the <span class="packt_screen">Type</span> node. Click on the <span class="packt_screen">Read Values</span> button to read the new variable:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-708 image-border" src="assets/411fecf1-2216-4a4a-9834-c3690eb8255f.png" style="width:35.50em;height:24.50em;"/></p>
<p style="padding-left: 60px">As you can see, the <span class="packt_screen">Total Items</span> predictor is now read, and that it will be counted as an <span class="packt_screen">Input</span> predictor in this model. Click on <span class="packt_screen">OK.</span></p>
<ol start="8">
<li>Connect the <span class="packt_screen">Type</span> node to a <span class="packt_screen">Neural Net</span> model from the <span class="packt_screen">Modeling</span> palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-709 image-border" src="assets/8b81bf1a-ad4f-444d-a4ff-04029669859c.png" style="width:90.67em;height:47.42em;"/></p>
<ol start="9">
<li>Run the <span class="packt_screen">Neural Net</span> model with <span class="packt_screen">Random seed</span> set to <kbd>5000</kbd>.</li>
</ol>
<ol start="10">
<li>Take a look at the model results by clicking on the newly generated model. You can see that the <span class="packt_screen">Total Items</span> has acquired its place in the top ten predictors in <span class="packt_screen">Predictor Importance</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-710 image-border" src="assets/3817cc99-fd3a-4d12-a4e3-0b5e7f86cdbb.png" style="width:84.75em;height:50.83em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">Close the window.</p>
<ol start="11">
<li>We will now connect the first generated model to the second model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-711 image-border" src="assets/e5599821-c246-4666-ae5e-48dc8a0e9ca3.png" style="width:67.50em;height:40.75em;"/></p>
<ol start="12">
<li>Add an <span class="packt_screen">Analysis</span> node to the first <span class="packt_screen">Neural Net</span> model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-712 image-border" src="assets/485ecf60-b958-48f0-b325-f7d0139299a5.png" style="width:77.50em;height:46.67em;"/></p>
<ol start="13">
<li class="CDPAlignLeft CDPAlign">Run the <span class="packt_screen">Analysis</span> node, as always. You should get the following results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-713 image-border" src="assets/39ca2cea-7c35-4900-bba7-4fa8123c2a97.png" style="width:33.67em;height:37.50em;"/></p>
<p class="CDPAlignLeft CDPAlign">Notice that the accuracy that we have has slightly improved. We just added a variable to an existing model. Hence, we get an idea of how our results can be affected when we do additional preparation on the data before running the model.</p>
<p>Speaking of how <span class="packt_screen">Total Items</span> has helped the model, you can see the job it has done for predicting current customers. We have actually done a better job in predicting the current customer field. Hence, this shows that the new variables that we chose to add may not necessarily improve the accuracy of the overall model, but can certainly improve the accuracy of one or more predicted categories. You can decide which category is more important for your requirements and select a new variable accordingly. We will now move on to see how sampling can help us provide better results.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Balancing data</h1>
                </header>
            
            <article>
                
<p>In this section, we will see how we can oversample or undersample different aspects of the outcome variable to improve our accuracy. We will change our dataset to see this. Refer to the <kbd>Loan</kbd> dataset provided with the GitHub link of this book.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The need for balancing data</h1>
                </header>
            
            <article>
                
<p>To demonstrate this, we will use a different dataset. Select the <span class="packt_screen">Var. File</span> node on the canvas. Navigate to where the file is located by clicking the triple dots beside the file field. Then select the <kbd>Loan</kbd> dataset:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-714 image-border" src="assets/c7cf695c-f156-44e5-b18d-0be27afcdc9c.png" style="width:33.58em;height:36.83em;"/></p>
<p>Go to the <span class="packt_screen">Types</span> tab and change the <span class="packt_screen">Loan</span> predictor's <span class="packt_screen">Role</span> to <span class="packt_screen">T</span><span class="packt_screen">arget</span>. This is the variable that we will predict:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-329 image-border" src="assets/997d3766-6a5c-4628-a83c-e348b8d32a48.png" style="width:36.00em;height:39.75em;"/></p>
<p class="CDPAlignLeft CDPAlign">Click on <span class="packt_screen">Read Values</span>. Then, click on <span class="packt_screen">OK</span>. In this example, we are predicting whether or not people have a loan.</p>
<p class="CDPAlignLeft CDPAlign">Let's see the distribution of our loan variable; go to the <span class="packt_screen">Graphs</span> palette and connect our source node, <span class="packt_screen">Loan</span>, to a <span class="packt_screen">Distribution</span> node:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-715 image-border" src="assets/12c1e1d3-6e9b-4bd8-851e-d1d49887c575.png" style="width:78.92em;height:47.83em;"/></p>
<p class="CDPAlignLeft CDPAlign">Click on the <span class="packt_screen">Distribution</span> node. Then click on the arrow next to the field box to select our predictor, for which we need to see the distribution, in our case, <span class="packt_screen">loan</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-716 image-border" src="assets/2deb58f3-850b-4b01-921d-a1110f5ad231.png" style="width:30.92em;height:25.33em;"/></p>
<p class="CDPAlignLeft CDPAlign">Then, click on <span class="packt_screen">Run</span>. You will see the following distribution:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-718 image-border" src="assets/ffadf281-bcfb-44ee-9f38-18992d4b1072.png" style="width:39.17em;height:18.08em;"/></p>
<p class="CDPAlignLeft CDPAlign">Notice that 86% of the people in this dataset have a loan, and 13% don't have a loan. In such a case, predicting the group of people having no loan can be a little difficult because the distribution is very uneven. Hence, in such a situation, we need to balance the data. This means making it a little more similar similar in terms of the category size of each group. This balancing of data is also known as oversampling or undersampling.</p>
<p>Let's take a little more of an extreme example. Let's say that we're trying to predict fraud, and that the distribution of the dataset is that 99% of the cases are perfectly legitimate and only 1% of the cases are fraudulent. Now, if we build a model with that type of distribution, what will often happen is that the model is going to predict that all cases aren't fraudulent. The overall accuracy of such a model will be 99%, because 99% of the time it's right, but what we really care about is predicting those few fraudulent cases. If we're always predicting that we have a good case, then you know the model itself is not really that useful, even though its overall accuracy is 99%. Hence, sometimes the overall accuracy of the model is not that useful. What we really care more about is the accuracy of predicting each individual category.</p>
<p>What happens with situations like the fraud detection example is, because one group is so over-represented, or technically the other group, or the smaller group, is under-represented, the model doesn't really learn the patterns or the characteristics that are going on for the smaller group, and that's why we sometimes need to oversample or undersample.</p>
<p>Let's come back to our example and try and see what we can do with it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Implementing balance in data</h1>
                </header>
            
            <article>
                
<p>Let's first build a model to predict the loan and see what we find:</p>
<ol>
<li>Go to the <span class="packt_screen">Field Ops</span> palette and connect the <span class="packt_screen">Loan</span> node to a <span class="packt_screen">Partition</span> node.</li>
<li>Connect the <span class="packt_screen">Neural Net</span> model to the <span class="packt_screen">Partition</span> node from the <span class="packt_screen">Modeling</span> palette, and run the <span class="packt_screen">Neural Net</span> model with defaults:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-719 image-border" src="assets/aa6246f9-abcb-475b-851f-1944ce0b9ce5.png" style="width:90.67em;height:47.58em;"/></p>
<ol start="3">
<li>Go to the <span class="packt_screen">Output</span> palette and connect the newly generated node to the <span class="packt_screen">Analysis</span> node. Run the <span class="packt_screen">Analysis</span> node with the <span class="packt_screen">Coincidence matrices</span> checked, and you will get the following results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-720 image-border" src="assets/ba16f041-ca0f-4a0b-9f32-ebc41e04ee97.png" style="width:30.17em;height:25.50em;"/></p>
<p class="CDPAlignLeft CDPAlign">As you can see, the overall accuracy of the model is around 93%, and the model is quite consistent. Let's see how well the model has predicted each one of the categories. We are certainly predicting the <span class="packt_screen">Yes</span> group pretty well. However, we are not doing so well with the <span class="packt_screen">No</span> group. We can try to improve the way we predict our <span class="packt_screen">No</span> group.</p>
<p>The results acquired bring us to a stage where we will have to oversample the <strong>No</strong> group. Or undersample the <strong>Yes</strong> group.</p>
<p>For oversampling, we will first need to partition the dataset into a training and testing dataset. One thing to remember here is when we are oversampling a dataset, we do not need to have equal oversampling on the training as well as the testing dataset. In fact, what we need is to assess the testing dataset on the original distribution, because with oversampling we run the risk of performing well on the training dataset but not on the testing dataset. To avoid this, we will first have to separate our data. Hence, we will first oversample the training dataset data, then build a model on it, and then apply it to the testing dataset:</p>
<ol>
<li>Go to the <span class="packt_screen">Record Ops</span> palette, and connect the <span class="packt_screen">Partition</span> node to the <span class="packt_screen">Select</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-721 image-border" src="assets/c540cd83-60ab-4ecd-8f78-b3cdbe1f437b.png" style="width:79.83em;height:47.83em;"/></p>
<ol start="2">
<li>Select the <span class="packt_screen">Select</span> node. Here we will select only the people that are in the training dataset. We will perform our data manipulations, then oversample or undersample our data and get the results. For doing this, click on the expression builder. Then, select the <span class="packt_screen">Partition</span> variable:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-722 image-border" src="assets/660c1692-3a94-4f46-a63b-4bc525ef556f.png" style="width:39.25em;height:27.75em;"/></p>
<p style="padding-left: 60px">Click on the <strong><span class="packt_screen">=</span></strong> sign, and then click on the <span class="packt_screen">field values</span> button:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-723 image-border" src="assets/7e3bb5a8-6db6-4091-b19f-67a29ec3a660.png" style="width:39.00em;height:27.67em;"/></p>
<p class="CDPAlignCenter CDPAlign"/>
<p style="padding-left: 60px">Then, select the <span class="packt_screen">Training</span> dataset and click on <span class="packt_screen">OK</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-724 image-border" src="assets/28c04fbc-d9e0-4e18-8304-fa59eb964160.png" style="width:40.67em;height:28.00em;"/></p>
<p style="padding-left: 60px">A dialogue box will open. Click <span class="packt_screen">OK</span> on that too.</p>
<p class="mce-root"/>
<ol start="3">
<li>Connect another <span class="packt_screen">Select</span> node to the existing <span class="packt_screen">Select</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-727 image-border" src="assets/e46787d5-ec29-4070-913d-ec07251891e1.png" style="width:79.00em;height:48.00em;"/></p>
<p style="padding-left: 60px">In this <span class="packt_screen">Select</span> node, we will keep people with a value of <span class="packt_screen">No</span>; for this, go to the expression builder and select the <span class="packt_screen">loan</span> variable, click on the <span class="packt_screen">=</span> sign, and then click on the field values button and select <span class="packt_screen">No</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-728 image-border" src="assets/32af08b7-2893-47e4-acf7-e5c412441b45.png" style="width:40.75em;height:27.83em;"/></p>
<ol start="4">
<li>We will add another <span class="packt_screen">Select</span> node connected to the first <span class="packt_screen">Select</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-729 image-border" src="assets/93b6c218-d985-4a99-9e89-32b917349cca.png" style="width:78.75em;height:47.92em;"/></p>
<p style="padding-left: 60px">Click on the expression builder. Select the <span class="packt_screen">loan</span> variable, and click on the <span class="packt_screen">=</span> sign. Click on the field values button and select the <span class="packt_screen">Yes</span> value. Click on <span class="packt_screen">OK</span>. So, now we have selected all people with a loan. This is a larger group of people, which is over-represented. This brings us to the stage where we select only one-third of the dataset.</p>
<ol start="5">
<li>Go to the <span class="packt_screen">Record Ops</span> palette and connect the <span class="packt_screen">Sample</span> node to the <span class="packt_screen">Select</span> node of the <span class="packt_screen">Yes</span> group:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-730 image-border" src="assets/b0380f14-be87-418d-9334-dcdcf9742366.png" style="width:78.83em;height:47.83em;"/></p>
<ol start="6">
<li>Edit the <span class="packt_screen">Sample</span> node. Select R<span class="packt_screen">andom%</span> to randomly select the values, and set the value to <span class="packt_screen">33%</span>. Also, check the <span class="packt_screen">Repeatable partition assignment</span>. This will allow us to select the same people every time we create a model for this selection. Click on <span class="packt_screen">OK</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-731 image-border" src="assets/7a0be76c-898a-455e-8913-a0cbae412d99.png" style="width:30.08em;height:28.50em;"/></p>
<ol start="7">
<li>We will have to combine this separate data and bring it back together. For this, connect the <span class="packt_screen">Select</span> node that has all people with the value set as <span class="packt_screen">No</span> to the <span class="packt_screen">Append</span> node. Then right-click on the <span class="packt_screen">Sample</span> node and select connect to connect it to the <span class="packt_screen">Append</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-732 image-border" src="assets/37bcd7c9-5889-451a-b764-e49cce86c5c9.png" style="width:78.92em;height:48.00em;"/></p>
<ol start="8">
<li>Click on the <span class="packt_screen">Append</span> node and select <span class="packt_screen">All datasets</span>, then click on <span class="packt_screen">OK</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-733 image-border" src="assets/0fcd1a05-80c1-4005-99cc-9ccead12a53a.png" style="width:25.33em;height:23.50em;"/></p>
<p class="mce-root"/>
<ol start="9">
<li>Let's check how the distribution of the <span class="packt_screen">Loan</span> field looks now after sampling. For this, go to the <span class="packt_screen">Graphs</span> palette and connect the <span class="packt_screen">Append</span> node to the <span class="packt_screen">Distribution</span> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-734 image-border" src="assets/499396cf-81a2-409e-8233-fd29ec77aee0.png" style="width:79.33em;height:47.75em;"/></p>
<ol start="10">
<li class="CDPAlignLeft CDPAlign">Click on the <span class="packt_screen">Distribution</span> node, go to the <span class="packt_screen">Field</span> box, and select <span class="packt_screen">loan</span> just as we did before. Then click on <span class="packt_screen">Run</span>. Here is the distribution that we have acquired after sampling:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b6f718b4-972c-4b13-8261-875316efd736.png" style="width:32.92em;height:15.75em;"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="CDPAlignLeft CDPAlign">You can see that the <span class="packt_screen">No</span> group constitutes about one-third of the sample. </p>
<p>Hence, by undersampling the <span class="packt_screen">Yes</span> node, we were able to see the difference from 13%.</p>
<p>Let's see oversampling:</p>
<ol>
<li>Let's now connect the Append node to the Type node from the Field Ops palette. Here, we won't be using the partition field. Hence, go to the Types node and change the Partition's role to None.</li>
<li>We will again build our model by going to the modeling palette. And connect the Type node to a neural net model. And run this setup on the defaults.</li>
<li>Now, connect your first generated model to the newly generated model, and connect both of them to the Analysis node. Let's see our results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-840 image-border" src="assets/4b578ba2-2d91-42ba-b105-0637a652776e.png" style="width:33.33em;height:37.33em;"/></p>
<p>You can see how well we are predicting the No group now! Our model has performed pretty well in predicting the accuracies of the individual models. Hence, we ended up balancing the data, obviously it is at expense of errors in the yes group. But the No group was our matter of concern as it was under-represented. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary </h1>
                </header>
            
            <article>
                
<p>This chapter taught us how to modify the various options that are available for enhancing the model. We also learned how to add additional fields and remove noise from these models. Lastly, we sampled the data available, which helped us to understand the model better.</p>
<p class="mce-root">In the next chapter, we are going to learn how to combine models and improve them even further.</p>


            </article>

            
        </section>
    </body></html>