<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;3.&#xA0;R and Statistics"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03" class="calibre1"/>Chapter 3. R and Statistics</h1></div></div></div><p class="calibre7">In this chapter, we will cover the following topics:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Understanding data sampling in R</li><li class="listitem">Operating a probability distribution in R</li><li class="listitem">Working with univariate descriptive statistics in R</li><li class="listitem">Performing correlations and multivariate analysis</li><li class="listitem">Operating linear regression and a multivariate analysis</li><li class="listitem">Conducting an exact binomial test</li><li class="listitem">Performing student's t-test</li><li class="listitem">Performing the Kolmogorov-Smirnov test</li><li class="listitem">Understanding the Wilcoxon Rank Sum and Signed Rank test</li><li class="listitem">Working with Pearson's Chi-squared test</li><li class="listitem">Conducting a one-way ANOVA</li><li class="listitem">Performing a two-way ANOVA</li></ul></div></div>

<div class="book" title="Chapter&#xA0;3.&#xA0;R and Statistics">
<div class="book" title="Introduction"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch03lvl1sec27" class="calibre1"/>Introduction</h1></div></div></div><p class="calibre7">The R language, as the descendent of the statistics language, S, has become the preferred computing language in the field of statistics. Moreover, due to its status as an active contributor in the field, if a new statistical method is discovered, it is very likely that this method will first be implemented in the R language. As such, a large quantity of statistical methods can be fulfilled by applying the R language.</p><p class="calibre7">To apply statistical methods in R, the user can categorize the method of implementation into descriptive statistics and inferential statistics:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Descriptive statistics</strong></span>: These <a id="id249" class="calibre1"/>are used to summarize<a id="id250" class="calibre1"/> the characteristics of the data. The user can use mean and standard deviation to describe<a id="id251" class="calibre1"/> numerical data, and use frequency and <a id="id252" class="calibre1"/>percentages to describe categorical data.</li><li class="listitem"><span class="strong"><strong class="calibre2">Inferential statistics</strong></span>: Based on the pattern within a sample data, the user can infer the <a id="id253" class="calibre1"/>characteristics of the population. The<a id="id254" class="calibre1"/> methods related to inferential statistics are for hypothesis testing, data estimation, data correlation, and relationship modeling. Inference can be further extended to forecasting, prediction, and estimation of unobserved values either in or associated with the population being studied.</li></ul></div><p class="calibre7">In the following recipe, we will discuss examples of data sampling, probability distribution, univariate descriptive statistics, correlations and multivariate analysis, linear regression and multivariate analysis, Exact Binomial Test, student's t-test, Kolmogorov-Smirnov test, Wilcoxon Rank Sum and Signed Rank test, Pearson's Chi-squared Test, One-way ANOVA, and Two-way ANOVA.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Understanding data sampling in R"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec28" class="calibre1"/>Understanding data sampling in R</h1></div></div></div><p class="calibre7">Sampling is a method to select a subset of data from a statistical population, which can use the characteristics of the population to estimate the whole population. The following recipe will <a id="id255" class="calibre1"/>demonstrate how to generate samples in R.</p></div>

<div class="book" title="Understanding data sampling in R">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec77" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Make sure that you have an R working environment for the following recipe.</p></div></div>

<div class="book" title="Understanding data sampling in R">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec78" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps to understand data sampling in R:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">In order to generate random samples of a given population, the user can simply use the <code class="email">sample</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sample(1:10)</strong></span>
</pre></div></li><li class="listitem" value="2">To specify the number of items returned, the user can set the assigned value to the <code class="email">size</code> argument:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sample(1:10, size = 5)</strong></span>
</pre></div></li><li class="listitem" value="3">Moreover, the sample can also generate Bernoulli trials by specifying <code class="email">replace = TRUE</code> (default is <code class="email">FALSE</code>):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sample(c(0,1), 10, replace = TRUE)</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Understanding data sampling in R">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec79" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">As we saw in<a id="id256" class="calibre1"/> the preceding demonstration, the <code class="email">sample</code> function can generate random samples from a specified population. The returned number from records can be designated by the user simply by specifying the argument of <code class="email">size</code>. Assigning the <code class="email">replace</code> argument to <code class="email">TRUE</code>, you can generate Bernoulli trials (a population with <code class="email">0</code> and <code class="email">1</code> only).</p></div></div>

<div class="book" title="Understanding data sampling in R">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec80" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">In R, the default package provides another sample method, <code class="email">sample.int</code>, where both n and size must be supplied as integers:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sample.int(20, 12)</strong></span>
</pre></div></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Operating a probability distribution in R"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec29" class="calibre1"/>Operating a probability distribution in R</h1></div></div></div><p class="calibre7">Probability <a id="id257" class="calibre1"/>distribution and statistics analysis are closely related to each other. For statistics analysis, analysts make predictions based on a certain population, which is mostly under a probability distribution. Therefore, if you find that the data selected for prediction does not follow the exact assumed probability distribution in experiment design, the upcoming results can be refuted. In other words, probability provides the justification for statistics. The following examples will demonstrate how <a id="id258" class="calibre1"/>to generate probability distribution in R.</p></div>

<div class="book" title="Operating a probability distribution in R">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec81" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Since most distribution functions originate from the <code class="email">stats</code> package, make sure the library <code class="email">stats</code> are loaded.</p></div></div>

<div class="book" title="Operating a probability distribution in R">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec82" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">For a normal distribution, the user can use <code class="email">dnorm</code>, which will return the height of a normal curve at <code class="email">0</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; dnorm(0)</strong></span>
<span class="strong"><strong class="calibre2">[1] 0.3989423</strong></span>
</pre></div></li><li class="listitem" value="2">Then, the user can change the mean and the standard deviation in the argument:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; dnorm(0,mean=3,sd=5)</strong></span>
<span class="strong"><strong class="calibre2">[1] 0.06664492</strong></span>
</pre></div></li><li class="listitem" value="3">Next, plot the graph of a normal distribution with the <code class="email">curve</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; curve(dnorm,-3,3)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00049.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Standard normal distribution</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4">In <a id="id259" class="calibre1"/>contrast to <code class="email">dnorm</code>, which returns the height of a normal curve, the <code class="email">pnorm</code> function can return the area under a given value:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; pnorm(1.5)</strong></span>
<span class="strong"><strong class="calibre2">[1] 0.9331928</strong></span>
</pre></div></li><li class="listitem" value="5">Alternatively, to get the area above a certain value, you can specify the option, <code class="email">lower.tail</code>, to <code class="email">FALSE</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; pnorm(1.5, lower.tail=FALSE)</strong></span>
<span class="strong"><strong class="calibre2">[1] 0.0668072</strong></span>
</pre></div></li><li class="listitem" value="6">To plot the graph of <code class="email">pnorm</code>, the user can employ a <code class="email">curve</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; curve(pnorm(x), -3,3)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00050.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Cumulative density function (pnorm)</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="7">To <a id="id260" class="calibre1"/>calculate the quantiles for a specific distribution, you can use <code class="email">qnorm</code>. The function, <code class="email">qnorm,</code> can be treated as the inverse of <code class="email">pnorm</code>, which returns the Z-score of a given probability:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; qnorm(0.5)</strong></span>
<span class="strong"><strong class="calibre2">[1] 0</strong></span>
<span class="strong"><strong class="calibre2">&gt; qnorm(pnorm(0))</strong></span>
<span class="strong"><strong class="calibre2">[1] 0</strong></span>
</pre></div></li><li class="listitem" value="8">To generate random numbers from a normal distribution, one can use the <code class="email">rnorm</code> function and specify the number of generated numbers. Also, one can define optional arguments, such as the mean and standard deviation:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; set.seed(50)</strong></span>
<span class="strong"><strong class="calibre2">&gt; x = rnorm(100,mean=3,sd=5)</strong></span>
<span class="strong"><strong class="calibre2">&gt; hist(x)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00051.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Histogram of a normal distribution</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="9">To<a id="id261" class="calibre1"/> calculate the uniform distribution, the <code class="email">runif</code> function generates random numbers from a uniform distribution. The user can specify the range of the generated numbers by specifying variables, such as the minimum and maximum. For the following example, the user generates 100 random variables from <code class="email">0</code> to <code class="email">5</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; set.seed(50)</strong></span>
<span class="strong"><strong class="calibre2">&gt; y = runif(100,0,5)</strong></span>
<span class="strong"><strong class="calibre2">&gt; hist(y)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00052.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Histogram of a uniform distribution</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="10">Lastly, if you would like to test the normality of the data, the most widely used test<a id="id262" class="calibre1"/> for this is the Shapiro-Wilks test. Here, we demonstrate how to perform a test of normality on both samples from the normal and uniform distributions, respectively:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; shapiro.test(x)</strong></span>

<span class="strong"><strong class="calibre2">  Shapiro-Wilk normality test</strong></span>

<span class="strong"><strong class="calibre2">data:  x </strong></span>
<span class="strong"><strong class="calibre2">W = 0.9938, p-value = 0.9319</strong></span>
<span class="strong"><strong class="calibre2">&gt; shapiro.test(y)</strong></span>

<span class="strong"><strong class="calibre2">  Shapiro-Wilk normality test</strong></span>

<span class="strong"><strong class="calibre2">data:  y </strong></span>
<span class="strong"><strong class="calibre2">W = 0.9563, p-value = 0.002221</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Operating a probability distribution in R">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec83" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In this recipe, we first introduce <code class="email">dnorm</code>, a probability density function, which returns the height of a normal curve. With a single input specified, the input value is called a standard score or a z-score. Without any other arguments specified, it is assumed that the normal distribution is in use with a mean of zero and a standard deviation of one. We then introduce three ways to draw standard and normal distributions.</p><p class="calibre7">After this, we introduce <code class="email">pnorm</code>, a cumulative density function. The function, <code class="email">pnorm</code>, can generate the area under a given value. In addition to this, <code class="email">pnorm</code> can be also used to calculate the p-value from a normal distribution. One can get the p-value by subtracting 1 from the number, or assigning True to the option, <code class="email">lower.tail</code>. Similarly, one can use the <code class="email">plot</code> function to plot the cumulative density.</p><p class="calibre7">In contrast to <code class="email">pnorm</code>, <code class="email">qnorm</code> returns the z-score of a given probability. Therefore, the example shows that the application of a <code class="email">qnorm</code> function to a <code class="email">pnorm</code> function will produce the exact input value.</p><p class="calibre7">Next, we show you how to use the <code class="email">rnrom</code> function to generate random samples from a normal distribution, and the <code class="email">runif</code> function to generate random samples from the uniform distribution. In the function, <code class="email">rnorm</code>, one has to specify the number of generated numbers and we may also add optional augments, such as the mean and standard deviation. Then, by using the <code class="email">hist</code> function, one should be able to find a bell-curve in figure 3. On the other hand, for the <code class="email">runif</code> function, with the minimum and maximum specifications, one can get a list <a id="id263" class="calibre1"/>of sample numbers between the two. However, we can still use the <code class="email">hist</code> function to plot the samples. It is clear that the output figure (shown in the preceding figure) is not in a bell-shape, which indicates that the sample does not come from the normal distribution.</p><p class="calibre7">Finally, we demonstrate how to test data normality with the Shapiro-Wilks test. Here, we conduct the normality test on both the normal and uniform distribution samples, respectively. In both outputs, one can find the p-value in each test result. The p-value shows the changes, which show that the sample comes from a normal distribution. If the p-value is higher than 0.05, we can conclude that the sample comes from a normal distribution. On the other hand, if the value is lower than 0.05, we conclude that the sample does not come from a normal distribution.</p></div></div>

<div class="book" title="Operating a probability distribution in R">
<div class="book" title="There's more..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec84" class="calibre1"/>There's more...</h2></div></div></div><p class="calibre7">Besides the normal distribution, you can obtain a t distribution, binomial distribution, and Chi-squared distribution by using the built-in functions of R. You can use the <code class="email">help</code> function to access further information about this:</p><div class="book"><ul class="itemizedlist"><li class="listitem">For a t distribution:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; help(TDist)</strong></span>
</pre></div></li><li class="listitem">For a binomial distribution:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt;help(Binomial)</strong></span>
</pre></div></li><li class="listitem">For the Chi-squared distribution:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt;help(Chisquare)</strong></span>
</pre></div></li></ul></div><p class="calibre7">To learn more about the distributions in the package, the user can access the <code class="email">help</code> function with the keyword <code class="email">distributions</code> to find all related documentation on this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; help(distributions)</strong></span>
</pre></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Working with univariate descriptive statistics in R"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec30" class="calibre1"/>Working with univariate descriptive statistics in R</h1></div></div></div><p class="calibre7">Univariate <a id="id264" class="calibre1"/>descriptive statistics describes a <a id="id265" class="calibre1"/>single variable for unit analysis, which is also the simplest form of quantitative analysis. In this recipe, we introduce some basic functions used to describe a single variable.</p></div>

<div class="book" title="Working with univariate descriptive statistics in R">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec85" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">We need to apply descriptive statistics to a sample data. Here, we use the built-in <code class="email">mtcars</code> data as our <a id="id266" class="calibre1"/>example.</p></div></div>

<div class="book" title="Working with univariate descriptive statistics in R">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec86" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, load the <code class="email">mtcars</code> data into a data frame with a variable named <code class="email">mtcars</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; data(mtcars)</strong></span>
</pre></div></li><li class="listitem" value="2">To<a id="id267" class="calibre1"/> obtain the vector range, the <code class="email">range</code> function will return the lower and upper bound of the vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; range(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 10.4 33.9</strong></span>
</pre></div></li><li class="listitem" value="3">Compute the length of the variable:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; length(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 32</strong></span>
</pre></div></li><li class="listitem" value="4">Obtain the mean of mpg:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mean(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 20.09062</strong></span>
</pre></div></li><li class="listitem" value="5"> Obtain the median of the input vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; median(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 19.2</strong></span>
</pre></div></li><li class="listitem" value="6">To obtain the standard deviation of the input vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sd(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 6.026948</strong></span>
</pre></div></li><li class="listitem" value="7">To obtain the variance of the input vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; var(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 36.3241</strong></span>
</pre></div></li><li class="listitem" value="8">The variance can also be computed with the square of standard deviation:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; sd(mtcars$mpg) ^ 2</strong></span>
<span class="strong"><strong class="calibre2">[1] 36.3241</strong></span>
</pre></div></li><li class="listitem" value="9">To <a id="id268" class="calibre1"/>obtain the <span class="strong"><strong class="calibre2">Interquartile Range</strong></span> (<span class="strong"><strong class="calibre2">IQR</strong></span>):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; IQR(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 7.375</strong></span>
</pre></div></li><li class="listitem" value="10">To obtain the quantile:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; quantile(mtcars$mpg,0.67)</strong></span>
<span class="strong"><strong class="calibre2"> 67% </strong></span>
<span class="strong"><strong class="calibre2">21.4</strong></span>
</pre></div></li><li class="listitem" value="11">To obtain the maximum of the input vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; max(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 33.9</strong></span>
</pre></div></li><li class="listitem" value="12">To<a id="id269" class="calibre1"/> obtain the minima<a id="id270" class="calibre1"/> of the input vector:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; min(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">[1] 10.4</strong></span>
</pre></div></li><li class="listitem" value="13">To obtain a vector with elements that are the cumulative maxima:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; cummax(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2"> [1] 21.0 21.0 22.8 22.8 22.8 22.8 22.8 24.4 24.4 24.4 24.4 24.4 24.4 24.4 24.4 24.4</strong></span>
<span class="strong"><strong class="calibre2">[17] 24.4 32.4 32.4 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9</strong></span>
</pre></div></li><li class="listitem" value="14">To obtain a vector with elements that are the cumulative minima:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; cummin(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2"> [1] 21.0 21.0 21.0 21.0 18.7 18.1 14.3 14.3 14.3 14.3 14.3 14.3 14.3 14.3 10.4 10.4</strong></span>
<span class="strong"><strong class="calibre2">[17] 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4</strong></span>
</pre></div></li><li class="listitem" value="15">To summarize the dataset, you can apply the <code class="email">summary</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; summary(mtcars)</strong></span>
</pre></div></li><li class="listitem" value="16">To obtain a frequency count of the categorical data, take <code class="email">cyl</code> of <code class="email">mtcars</code> as an example:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; table(mtcars$cyl)</strong></span>

<span class="strong"><strong class="calibre2"> 4  6  8</strong></span>
<span class="strong"><strong class="calibre2">11  7 14</strong></span>
</pre></div></li><li class="listitem" value="17">To obtain a frequency count of numerical data, you can use a stem plot to outline the data shape; <code class="email">stem</code> produces a stem-and-leaf plot of the given values:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; stem(mtcars$mpg)</strong></span>

<span class="strong"><strong class="calibre2">  The decimal point is at the |</strong></span>

<span class="strong"><strong class="calibre2">  10 | 44</strong></span>
<span class="strong"><strong class="calibre2">  12 | 3</strong></span>
<span class="strong"><strong class="calibre2">  14 | 3702258</strong></span>
<span class="strong"><strong class="calibre2">  16 | 438</strong></span>
<span class="strong"><strong class="calibre2">  18 | 17227</strong></span>
<span class="strong"><strong class="calibre2">  20 | 00445</strong></span>
<span class="strong"><strong class="calibre2">  22 | 88</strong></span>
<span class="strong"><strong class="calibre2">  24 | 4</strong></span>
<span class="strong"><strong class="calibre2">  26 | 03</strong></span>
<span class="strong"><strong class="calibre2">  28 | </strong></span>
<span class="strong"><strong class="calibre2">  30 | 44</strong></span>
<span class="strong"><strong class="calibre2">  32 | 49</strong></span>
</pre></div></li><li class="listitem" value="18">You <a id="id271" class="calibre1"/>can use a histogram<a id="id272" class="calibre1"/> of ggplot to plot the same stem-and-leaf figure:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; library(ggplot2)</strong></span>
<span class="strong"><strong class="calibre2">&gt; qplot(mtcars$mpg, binwidth=2)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00053.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Histogram of mpg of mtcars</p></div></div><p class="calibre13"> </p></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Working with univariate descriptive statistics in R">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec87" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">Univariate descriptive statistics generate the frequency distribution of datasets. Moreover, they can be used to identify the obvious patterns in the data and the characteristics of the variates to provide<a id="id273" class="calibre1"/> a better understanding<a id="id274" class="calibre1"/> of the data from a holistic viewpoint. Additionally, they can provide information about the central tendency and descriptors of the skewness of individual cases. Therefore, it is common to see that univariate analysis is conducted at the beginning of the data exploration process.</p><p class="calibre7">To begin the exploration of data, we first load the dataset, <code class="email">mtcars</code>, to an R session. From the data, we apply <code class="email">range</code>, <code class="email">length</code>, <code class="email">mean</code>, <code class="email">median</code>, <code class="email">sd</code>, <code class="email">var</code>, <code class="email">IQR</code>, <code class="email">quantile</code>, <code class="email">min</code>, <code class="email">max</code>, <code class="email">cumin</code>, and <code class="email">cumax</code> to obtain the descriptive statistic of the attribute, <code class="email">mpg</code>. Then, we use the <code class="email">summary</code> function to obtain summary information about <code class="email">mtcars</code>.</p><p class="calibre7">Next, we obtain a frequency count of the categorical data (<code class="email">cyl</code>). To obtain a frequency count of the numerical data, we use a stem plot to outline the data shape. Lastly, we use a histogram with the <code class="email">binwidth</code> argument in <code class="email">2</code> to generate a plot similar to the stem-and-leaf plot.</p></div></div>

<div class="book" title="Working with univariate descriptive statistics in R">
<div class="book" title="There's more..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec88" class="calibre1"/>There's more...</h2></div></div></div><p class="calibre7">One common scenario in univariate descriptive statistics is to find the mode of a vector. In R, there is no built-in function to help the user obtain the mode of the data. However, one can implement the mode function by using the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mode = function(x) {</strong></span>
<span class="strong"><strong class="calibre2">+ temp = table(x)</strong></span>
<span class="strong"><strong class="calibre2">+ names(temp)[temp == max(temp)]</strong></span>
<span class="strong"><strong class="calibre2">+ }</strong></span>
</pre></div><p class="calibre7">By applying the <code class="email">mode</code> function on the vector, <code class="email">mtcars$mpg</code>, you can find the most frequently occurring numeric value or category of a given vector:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; x = c(1,2,3,3,3,4,4,5,5,5,6)</strong></span>
<span class="strong"><strong class="calibre2">&gt; mode(x)</strong></span>
<span class="strong"><strong class="calibre2">[1] "3" "5"</strong></span>
</pre></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Performing correlations and multivariate analysis"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec31" class="calibre1"/>Performing correlations and multivariate analysis</h1></div></div></div><p class="calibre7">To analyze the relationship of more than two variables, you would need to conduct multivariate <a id="id275" class="calibre1"/>descriptive statistics, which allows the comparison<a id="id276" class="calibre1"/> of factors. Additionally, it prevents the effect of a single variable from distorting the analysis. In this recipe, we will discuss how to conduct multivariate descriptive statistics using a correlation and covariance matrix.</p></div>

<div class="book" title="Performing correlations and multivariate analysis">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec89" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session.</p></div></div>

<div class="book" title="Performing correlations and multivariate analysis">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec90" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform <a id="id277" class="calibre1"/>the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Here, you<a id="id278" class="calibre1"/> can get the covariance matrix by inputting the first three variables in <code class="email">mtcars</code> to the <code class="email">cov</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; cov(mtcars[1:3])</strong></span>
<span class="strong"><strong class="calibre2">             mpg        cyl       disp</strong></span>
<span class="strong"><strong class="calibre2">mpg    36.324103  -9.172379  -633.0972</strong></span>
<span class="strong"><strong class="calibre2">cyl    -9.172379   3.189516   199.6603</strong></span>
<span class="strong"><strong class="calibre2">disp -633.097208 199.660282 15360.7998</strong></span>
</pre></div></li><li class="listitem" value="2">To obtain a correlation matrix of the dataset, we input the first three variables of <code class="email">mtcars</code> to the <code class="email">cor</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; cor(mtcars[1:3])</strong></span>
<span class="strong"><strong class="calibre2">            mpg        cyl       disp</strong></span>
<span class="strong"><strong class="calibre2">mpg   1.0000000 -0.8521620 -0.8475514</strong></span>
<span class="strong"><strong class="calibre2">cyl  -0.8521620  1.0000000  0.9020329</strong></span>
<span class="strong"><strong class="calibre2">disp -0.8475514  0.9020329  1.0000000</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Performing correlations and multivariate analysis">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec91" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In this recipe, we have demonstrated how to apply correlation and covariance to discover the relationship between multiple variables.</p><p class="calibre7">First, we compute a covariance matrix of the first three <code class="email">mtcars</code> variables. Covariance can measure how variables are linearly related. Thus, a positive covariance (for example, <code class="email">cyl</code> versus <code class="email">mpg</code>) indicates that the two variables are positively linearly related. On the other hand, a negative covariance (for example, <code class="email">mpg</code> versus <code class="email">disp</code>) indicates the two variables are negatively linearly related. However, due to the variance of different datasets, the covariance score of these datasets is not comparable. As a result, if you would like to compare the strength of the linear relation between two variables in a different dataset, you should use the normalized score, that is, the correlation coefficient instead of covariance.</p><p class="calibre7">Next, we apply a <code class="email">cor</code> function to obtain a correlation coefficient matrix of three variables within the <code class="email">mtcars</code> dataset. In the correlation coefficient matrix, the numeric element of the matrix indicates the strength of the relationship between the two variables. If the correlation coefficient of a variable against itself scores <code class="email">1</code>, the variable has a positive relationship against itself. The <code class="email">cyl</code> and <code class="email">mpg</code> variables have a correlation coefficient of -0.85, which <a id="id279" class="calibre1"/>means they have a strong, negative relationship. On<a id="id280" class="calibre1"/> the other hand, the <code class="email">disp</code> and <code class="email">cyl</code> variables score 0.90, which may indicate that they have a strong, positive relationship.</p></div></div>

<div class="book" title="Performing correlations and multivariate analysis">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec92" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">You can use <code class="email">ggplot</code> to plot the heatmap of the correlation coefficient matrix:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; library(reshape2)</strong></span>
<span class="strong"><strong class="calibre2">&gt; qplot(x=Var1, y=Var2, data=melt(cor(mtcars[1:3])), fill=value, geom="tile")</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00054.jpeg" alt="See also" class="calibre9"/><div class="caption"><p class="calibre12">The correlation coefficient matrix heatmap</p></div></div><p class="calibre13"> </p></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Operating linear regression and multivariate analysis"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec32" class="calibre1"/>Operating linear regression and multivariate analysis</h1></div></div></div><p class="calibre7">Linear <a id="id281" class="calibre1"/>regression is a method to <a id="id282" class="calibre1"/>assess the association between dependent and independent variables. In this recipe, we will cover how to conduct linear regression for multivariate analysis.</p></div>

<div class="book" title="Operating linear regression and multivariate analysis">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec93" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure<a id="id283" class="calibre1"/> that <code class="email">mtcars</code> has already been loaded into a data frame within an R session.</p></div></div>

<div class="book" title="Operating linear regression and multivariate analysis">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec94" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform<a id="id284" class="calibre1"/> the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">To fit variables into a linear model, you can use the <code class="email">lm</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; lmfit = lm(mtcars$mpg ~ mtcars$cyl)</strong></span>
<span class="strong"><strong class="calibre2">&gt; lmfit</strong></span>

<span class="strong"><strong class="calibre2">Call:</strong></span>
<span class="strong"><strong class="calibre2">lm(formula = mtcars$mpg ~ mtcars$cyl)</strong></span>

<span class="strong"><strong class="calibre2">Coefficients:</strong></span>
<span class="strong"><strong class="calibre2">(Intercept)   mtcars$cyl  </strong></span>
<span class="strong"><strong class="calibre2">     37.885       -2.876 </strong></span>
</pre></div></li><li class="listitem" value="2">To get detailed information on the fitted model, you can use the <code class="email">summary</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; summary(lmfit)</strong></span>

<span class="strong"><strong class="calibre2">Call:</strong></span>
<span class="strong"><strong class="calibre2">lm(formula = mtcars$mpg ~ mtcars$cyl)</strong></span>

<span class="strong"><strong class="calibre2">Residuals:</strong></span>
<span class="strong"><strong class="calibre2">    Min      1Q  Median      3Q     Max </strong></span>
<span class="strong"><strong class="calibre2">-4.9814 -2.1185  0.2217  1.0717  7.5186 </strong></span>

<span class="strong"><strong class="calibre2">Coefficients:</strong></span>
<span class="strong"><strong class="calibre2">            Estimate Std. Error t value Pr(&gt;|t|)    </strong></span>
<span class="strong"><strong class="calibre2">(Intercept)  37.8846     2.0738   18.27  &lt; 2e-16 ***</strong></span>
<span class="strong"><strong class="calibre2">mtcars$cyl   -2.8758     0.3224   -8.92 6.11e-10 ***</strong></span>
<span class="strong"><strong class="calibre2">---</strong></span>
<span class="strong"><strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong></span>

<span class="strong"><strong class="calibre2">Residual standard error: 3.206 on 30 degrees of freedom</strong></span>
<span class="strong"><strong class="calibre2">Multiple R-squared:  0.7262,  Adjusted R-squared:  0.7171 </strong></span>
<span class="strong"><strong class="calibre2">F-statistic: 79.56 on 1 and 30 DF,  p-value: 6.113e-10</strong></span>
</pre></div></li><li class="listitem" value="3">To<a id="id285" class="calibre1"/> create an analysis<a id="id286" class="calibre1"/> of a variance table, one can employ the <code class="email">anova</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; anova(lmfit)</strong></span>
<span class="strong"><strong class="calibre2">Analysis of Variance Table</strong></span>

<span class="strong"><strong class="calibre2">Response: mtcars$mpg</strong></span>
<span class="strong"><strong class="calibre2">           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </strong></span>
<span class="strong"><strong class="calibre2">mtcars$cyl  1 817.71  817.71  79.561 6.113e-10 ***</strong></span>
<span class="strong"><strong class="calibre2">Residuals  30 308.33   10.28                      </strong></span>
<span class="strong"><strong class="calibre2">---</strong></span>
<span class="strong"><strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong></span>
</pre></div></li><li class="listitem" value="4">To plot the regression line on a scatter plot of two variables, you first plot <code class="email">cyl</code> against <code class="email">mpg</code> in it, then use the <code class="email">abline</code> function to add a regression line on the plot:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; lmfit = lm(mtcars$mpg ~ mtcars$cyl)</strong></span>
<span class="strong"><strong class="calibre2">&gt; plot(mtcars$cyl, mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">&gt; abline(lmfit)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00055.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The regression plot of cyl against mpg</p></div></div><p class="calibre13"> </p></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Operating linear regression and multivariate analysis">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec95" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In this recipe, we apply the linear model function, <code class="email">lm</code>, which builds a linear fitted model of two variables and returns the formula and coefficient. Next, we apply the <code class="email">summary</code> function to<a id="id287" class="calibre1"/> retrieve the detailed <a id="id288" class="calibre1"/>information (including F-statistic and P-value) of the model. The purpose of F-statistic is to test the statistical significance of the model. It produces an F-value, which is the ratio of the model mean square to the error mean square. Thus, a large F-value indicates that more of the total variability is accounted for by the regression model. Then, we can use the F-value to support or reject the null hypothesis that all of the regression coefficients are equal to zero. In other words, the null hypothesis is rejected if the F-value is large and shows that the regression model has a predictive capability. On the other hand, P-values of each attribute test the null hypothesis that the coefficient is equal to zero (no effect on the response variable). In other words, a low p-value can reject a null hypothesis and indicates that a change in the predictor's value is related to the value of the response variable.</p><p class="calibre7">Next, we apply the <code class="email">anova</code> function on the fitted model to determine the variance. The function outputs the sum of squares, which stands for the variability of the model's predicted value. Further, to visualize the linear relationship between two variables, the <code class="email">abline</code> function can add a regression line on a scatter plot of <code class="email">mpg</code> against <code class="email">cyl</code>. From the preceding figure, it is obvious that the <code class="email">mpg</code> and <code class="email">cyl</code> variables are negatively related.</p></div></div>

<div class="book" title="Operating linear regression and multivariate analysis">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec96" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">For more information on how to perform linear and nonlinear regression analysis, please refer to the <a class="calibre1" title="Chapter 4. Understanding Regression Analysis" href="part0046_split_000.html#page">Chapter 4</a>, <span class="strong"><em class="calibre8">Understanding Regression Analysis</em></span></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Conducting an exact binomial test"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec33" class="calibre1"/>Conducting an exact binomial test</h1></div></div></div><p class="calibre7">While making decisions, it is important to know whether the decision error can be controlled or <a id="id289" class="calibre1"/>measured. In other words, we would like to prove that the hypothesis formed is unlikely to have occurred by chance, and is statistically significant. In hypothesis testing, there are two kinds of hypotheses: null hypothesis and alternative hypothesis (or research hypothesis). The purpose of hypothesis testing is to validate whether the experiment results are significant. However, to validate whether the alternative hypothesis is acceptable, it is deemed to be true if the null hypothesis is rejected.</p><p class="calibre7">In the following recipes, we will discuss some common statistical testing methods. First, we will cover how to conduct an exact binomial test in R.</p></div>

<div class="book" title="Conducting an exact binomial test">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec97" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Since the <code class="email">binom.test</code> function  originates from the <code class="email">stats</code> package, make sure the <code class="email">stats</code> library <a id="id290" class="calibre1"/>is loaded.</p></div></div>

<div class="book" title="Conducting an exact binomial test">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec98" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following step:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Assume there is a game where a gambler can win by rolling the number-six-on a dice. As part of the rules, gamblers can bring their own dice. If a gambler tried to cheat in a game, he would use a loaded dice to increase his chance of winning. Therefore, if we observe that the gambler won 92 out of 315 games, we could determine whether the dice was fair by conducting an exact binomial test:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; binom.test(x=92, n=315, p=1/6)</strong></span>

<span class="strong"><strong class="calibre2">  Exact binomial test</strong></span>

<span class="strong"><strong class="calibre2">data:  92 and 315</strong></span>
<span class="strong"><strong class="calibre2">number of successes = 92, number of trials = 315, p-value = 3.458e-08</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: true probability of success is not equal to 0.1666667</strong></span>
<span class="strong"><strong class="calibre2">95 percent confidence interval:</strong></span>
<span class="strong"><strong class="calibre2"> 0.2424273 0.3456598</strong></span>
<span class="strong"><strong class="calibre2">sample estimates:</strong></span>
<span class="strong"><strong class="calibre2">probability of success </strong></span>
<span class="strong"><strong class="calibre2">             0.2920635 </strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Conducting an exact binomial test">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec99" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">A binomial test uses the binomial distribution to find out whether the true success rate is likely to be <span class="strong"><em class="calibre8">P</em></span> for <span class="strong"><em class="calibre8">n</em></span> trials with the binary outcome. The formula of the probability, <span class="strong"><em class="calibre8">P</em></span>, can be defined in following equation:</p><div class="mediaobject"><img src="../images/00056.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Here, <span class="strong"><em class="calibre8">X</em></span> denotes the random variables, counting the number of outcomes of the interest; <span class="strong"><em class="calibre8">n</em></span> denotes the number of trials; <span class="strong"><em class="calibre8">k</em></span> indicates the number of successes; <span class="strong"><em class="calibre8">p</em></span> indicates the probability of <a id="id291" class="calibre1"/>success; and <span class="strong"><em class="calibre8">q</em></span> denotes the probability of failure.</p><p class="calibre7">After we have computed the probability, <span class="strong"><em class="calibre8">P</em></span>, we can then perform a sign test to determine whether the success probability is similar to what we expected. If the probability is not equal to what we expected, we can reject the null hypothesis.</p><p class="calibre7">By definition, the null hypothesis is a skeptical perspective or a statement about the population parameter that will be tested. The null hypothesis is denoted by H0. An alternative hypothesis is represented by a range of population values, which are not included in the null hypothesis. The alternative hypothesis is denoted by H1. In this case, the null and alternative hypothesis, respectively, are illustrated as:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">H0 (null hypothesis)</strong></span>: The <a id="id292" class="calibre1"/>true probability of<a id="id293" class="calibre1"/> success is equal to what we expected</li><li class="listitem"><span class="strong"><strong class="calibre2">H1 (alternative hypothesis)</strong></span>: The true probability of success is not equal to what <a id="id294" class="calibre1"/>we expected</li></ul></div><p class="calibre7">In this example, we<a id="id295" class="calibre1"/> demonstrate how to use a binomial test to determine the number of times the dice is rolled, the frequency of rolling the number six, and the probability of rolling a six from an unbiased dice. The result of the t-test shows that the p-value = 3.458e-08 (lower than 0.05). For significance, at the five percent level, the null hypothesis (the dice is unbiased) is rejected as too many sixes were rolled (the probability of success = 0.2920635).</p></div></div>

<div class="book" title="Conducting an exact binomial test">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec100" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">To read more about the usage of the exact binomial test, please use the <code class="email">help</code> function to view related documentation on this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ?binom.test</strong></span>
</pre></div></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Performing student's t-test"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec34" class="calibre1"/>Performing student's t-test</h1></div></div></div><p class="calibre7">A one sample t-test <a id="id296" class="calibre1"/>enables us to test whether two means are significantly different; a two sample t-test allows us to test whether the means of two independent groups are different. In this recipe, we will discuss how to conduct one sample t-test and two sample t-tests using R.</p></div>

<div class="book" title="Performing student's t-test">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec101" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. As the <code class="email">t.test</code> function<a id="id297" class="calibre1"/> originates from the <code class="email">stats</code> package, make sure the library, <code class="email">stats</code>, is loaded.</p></div></div>

<div class="book" title="Performing student's t-test">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec102" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we visualize the attribute, <code class="email">mpg</code>, against <code class="email">am</code> using a boxplot:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg, mtcars$mpg[mtcars$am==0], ylab = "mpg", names=c("overall","automobile"))</strong></span>
<span class="strong"><strong class="calibre2">&gt; abline(h=mean(mtcars$mpg),lwd=2, col="red")</strong></span>
<span class="strong"><strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00057.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The boxplot of mpg of the overall population and automobiles</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">We then perform a statistical procedure to validate whether the average <code class="email">mpg</code> of automobiles is lower than the average of the overall <code class="email">mpg</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mpg.mu = mean(mtcars$mpg)</strong></span>
<span class="strong"><strong class="calibre2">&gt; mpg_am = mtcars$mpg[mtcars$am == 0]</strong></span>
<span class="strong"><strong class="calibre2">&gt; t.test(mpg_am,mu = mpg.mu)</strong></span>

<span class="strong"><strong class="calibre2">  One Sample t-test</strong></span>

<span class="strong"><strong class="calibre2">data:  mpg_am</strong></span>
<span class="strong"><strong class="calibre2">t = -3.3462, df = 18, p-value = 0.003595</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: true mean is not equal to 20.09062</strong></span>
<span class="strong"><strong class="calibre2">95 percent confidence interval:</strong></span>
<span class="strong"><strong class="calibre2"> 15.29946 18.99528</strong></span>
<span class="strong"><strong class="calibre2">sample estimates:</strong></span>
<span class="strong"><strong class="calibre2">mean of x </strong></span>
<span class="strong"><strong class="calibre2"> 17.14737 </strong></span>
</pre></div></li><li class="listitem" value="3">We begin <a id="id298" class="calibre1"/>visualizing the data by plotting a boxplot:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt;boxplot(mtcars$mpg~mtcars$am,ylab='mpg',names=c('automatic','manual'))</strong></span>
<span class="strong"><strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")</strong></span>
<span class="strong"><strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==1]),lwd=2, col="red")</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00058.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The boxplot of mpg of automatic and manual transmission cars</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4">The preceding figure reveals that the mean mpg of automatic transmission cars is lower than the average mpg of manual transmission vehicles:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; t.test(mtcars$mpg~mtcars$am)</strong></span>

<span class="strong"><strong class="calibre2">  Welch Two Sample t-test</strong></span>

<span class="strong"><strong class="calibre2">data:  mtcars$mpg by mtcars$am</strong></span>
<span class="strong"><strong class="calibre2">t = -3.7671, df = 18.332, p-value = 0.001374</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: true difference in means is not equal to 0</strong></span>
<span class="strong"><strong class="calibre2">95 percent confidence interval:</strong></span>
<span class="strong"><strong class="calibre2"> -11.280194  -3.209684</strong></span>
<span class="strong"><strong class="calibre2">sample estimates:</strong></span>
<span class="strong"><strong class="calibre2">mean in group 0 mean in group 1 </strong></span>
<span class="strong"><strong class="calibre2">       17.14737        24.39231 </strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Performing student's t-test">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec103" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">Student's t-test <a id="id299" class="calibre1"/>is where the test statistic follows a normal distribution (the student's t distribution) if the null hypothesis is true. It can be used to determine <a id="id300" class="calibre1"/>whether there is a difference between two independent datasets. Student's t-test is best used with the problems associated with an inference based on small samples.</p><p class="calibre7">In this recipe, we discuss one sample student's t-test and two sample student's t-tests. In the one sample student's t-test, a research question often asked is, "Is the mean of the population different from the null hypothesis?" Thus, in order to test whether the average mpg of automobiles is lower than the overall average mpg, we first use a boxplot to view the differences between populations without making any assumptions. From the preceding figure, it is clear that the mean of mpg of automobiles (the blue line) is lower than the average mpg (red line) of the overall population. Then, we apply one sample t-test; the low p-value of 0.003595 (&lt; 0.05) suggests that we should reject the null hypothesis that the mean mpg for automobiles is less than the average mpg of the overall population.</p><p class="calibre7">As a one sample t-test enables us to test whether two means are significantly different, a two sample t-test allows us to test whether the means of two independent groups are different. Similar to a one sample t-test, we first use a boxplot to see the differences between populations and then apply a two-sample t-test. The test results shows the p-value = 0.01374 (p&lt; 0.05). In other words, the test provides evidence that rejects the null hypothesis, which shows the mean mpg of cars with automatic transmission differs from the cars with <a id="id301" class="calibre1"/>manual transmission.</p></div></div>

<div class="book" title="Performing student's t-test">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec104" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">To read more about the usage of student's t-test, please use the <code class="email">help</code> function to view related documents:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ?t.test</strong></span>
</pre></div></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Performing the Kolmogorov-Smirnov test"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec35" class="calibre1"/>Performing the Kolmogorov-Smirnov test</h1></div></div></div><p class="calibre7">A one-sample Kolmogorov-Smirnov test is used to compare a sample with a reference probability. A two-sample Kolmogorov-Smirnov test compares the cumulative distributions <a id="id302" class="calibre1"/>of two datasets. In this recipe, we will demonstrate how to perform the Kolmogorov-Smirnov test with R.</p></div>

<div class="book" title="Performing the Kolmogorov-Smirnov test">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec105" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. As the <code class="email">ks.test</code> function is originated from the <code class="email">stats</code> package, make sure the <code class="email">stats</code> library is loaded.</p></div></div>

<div class="book" title="Performing the Kolmogorov-Smirnov test">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec106" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Validate whether the dataset, x (generated with the <code class="email">rnorm</code> function), is distributed normally with a one-sample Kolmogorov-Smirnov test:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; x = rnorm(50)</strong></span>
<span class="strong"><strong class="calibre2">&gt; ks.test(x,"pnorm")</strong></span>

<span class="strong"><strong class="calibre2">  One-sample Kolmogorov-Smirnov test</strong></span>

<span class="strong"><strong class="calibre2">data:  x</strong></span>
<span class="strong"><strong class="calibre2">D = 0.1698, p-value = 0.0994</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: two-sided</strong></span>
</pre></div></li><li class="listitem" value="2">Next, you can generate uniformly distributed sample data:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; set.seed(3)</strong></span>
<span class="strong"><strong class="calibre2">&gt; x = runif(n=20, min=0, max=20)</strong></span>

<span class="strong"><strong class="calibre2">&gt; y = runif(n=20, min=0, max=20)</strong></span>
</pre></div></li><li class="listitem" value="3">We <a id="id303" class="calibre1"/>first plot <code class="email">ecdf</code> of two generated data samples:  <div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; plot(ecdf(x), do.points = FALSE, verticals=T, xlim=c(0, 20))</strong></span>
<span class="strong"><strong class="calibre2">&gt; lines(ecdf(y), lty=3, do.points = FALSE, verticals=T)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00059.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The ecdf plot of two generated data samples</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4">Finally, we apply a two-sample Kolmogorov-Smirnov test on two groups of data:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ks.test(x,y)</strong></span>

<span class="strong"><strong class="calibre2">  Two-sample Kolmogorov-Smirnov test</strong></span>

<span class="strong"><strong class="calibre2">data:  x and y</strong></span>
<span class="strong"><strong class="calibre2">D = 0.3, p-value = 0.3356</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: two-sided</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Performing the Kolmogorov-Smirnov test">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec107" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">The <span class="strong"><strong class="calibre2">Kolmogorov-Smirnov test</strong></span> (<span class="strong"><strong class="calibre2">K-S test</strong></span>) is a nonparametric and statistical test, used for the equality<a id="id304" class="calibre1"/> of continuous probability distributions. It can be used to compare a sample with a reference probability distribution (a one sample K-S test), or it can directly compare two samples (a two sample K-S test). The test is based on the empirical distribution function (ECDF). Let <span class="strong"><img src="../images/00060.jpeg" alt="How it works..." class="calibre24"/></span> be a random sample of size, n; the empirical distribution function, <span class="strong"><img src="../images/00061.jpeg" alt="How it works..." class="calibre24"/></span>, is defined as:</p><div class="mediaobject"><img src="../images/00062.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Here, <span class="strong"><img src="../images/00063.jpeg" alt="How it works..." class="calibre24"/></span> is the indicator function. If <span class="strong"><img src="../images/00064.jpeg" alt="How it works..." class="calibre24"/></span>, the function equals to 1. Otherwise, the function<a id="id305" class="calibre1"/> equals to 0.</p><p class="calibre7">The Kolmogorov-Smirnov statistic (D) is based on the greatest (where supx denotes the supremum) vertical difference between F(x) and Fn(x). It is defined as:</p><div class="mediaobject"><img src="../images/00065.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">H<sub class="calibre25">0</sub> is the sample follows the specified distribution. H<sub class="calibre25">1</sub> is the sample does not follow the specified distribution.</p><p class="calibre7">If Dn is greater than the critical value obtained from a table, then we reject H<sub class="calibre25">0</sub> at the level of significance α.</p><p class="calibre7">We first test whether a random number generated from a normal distribution is normally distributed. At the 5 percent significance level, the p-value of 0.0994 indicates that the input is normally distributed.</p><p class="calibre7">Then, we plot an empirical cumulative distribution function (<code class="email">ecdf</code>) plot to show how a two-sample test calculates the maximum distance D (showing 0.3), and apply the two-sample Kolmogorov-Smirnov test to discover whether the two input datasets possibly come from the same distribution.</p><p class="calibre7">The p-value is above 0.05, which does not reject the null hypothesis. In other words, it means the two datasets are possibly from the same distribution.</p></div></div>

<div class="book" title="Performing the Kolmogorov-Smirnov test">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec108" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">To read more <a id="id306" class="calibre1"/>about the usage of the Kolmogorov-Smirnov test, please use the <code class="email">help</code> function to view related documents:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ?ks.test</strong></span>
</pre></div></li><li class="listitem">As for the definition of an empirical cumulative distribution function, please refer to the help page of <code class="email">ecdf</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ?ecdf</strong></span>
</pre></div></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Understanding the Wilcoxon Rank Sum and Signed Rank test"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec36" class="calibre1"/>Understanding the Wilcoxon Rank Sum and Signed Rank test</h1></div></div></div><p class="calibre7">The Wilcoxon Rank Sum and Signed Rank test (or Mann-Whitney-Wilcoxon) is a nonparametric<a id="id307" class="calibre1"/> test of the null hypothesis, which shows that the <a id="id308" class="calibre1"/>population distribution of two different <a id="id309" class="calibre1"/>groups are identical without<a id="id310" class="calibre1"/> assuming that the two groups are normally distributed. This recipe will show how to conduct the Wilcoxon Rank Sum and Signed Rank test in R.</p></div>

<div class="book" title="Understanding the Wilcoxon Rank Sum and Signed Rank test">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec109" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. As the <code class="email">wilcox.test</code> function is originated from the <code class="email">stats</code> package, make sure the library, <code class="email">stats</code>, is loaded.</p></div></div>

<div class="book" title="Understanding the Wilcoxon Rank Sum and Signed Rank test">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec110" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">We first plot the data of <code class="email">mtcars</code> with the <code class="email">boxplot</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$am,ylab='mpg',names=c('automatic','manual'))</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00066.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The boxplot of mpg of automatic cars and manual transmission cars</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">Next, we <a id="id311" class="calibre1"/>still perform a Wilcoxon<a id="id312" class="calibre1"/> Rank Sum test to validate whether the distribution of automatic transmission cars is identical to that of manual transmission cars:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; wilcox.test(mpg ~ am, data=mtcars)</strong></span>

<span class="strong"><strong class="calibre2">  Wilcoxon rank sum test with continuity correction</strong></span>

<span class="strong"><strong class="calibre2">data:  mpg by am</strong></span>
<span class="strong"><strong class="calibre2">W = 42, p-value = 0.001871</strong></span>
<span class="strong"><strong class="calibre2">alternative hypothesis: true location shift is not equal to 0</strong></span>

<span class="strong"><strong class="calibre2">Warning message:</strong></span>
<span class="strong"><strong class="calibre2">In wilcox.test.default(x = c(21.4, 18.7, 18.1, 14.3, 24.4, 22.8,  :</strong></span>
<span class="strong"><strong class="calibre2">  cannot compute exact p-value with ties</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Understanding the Wilcoxon Rank Sum and Signed Rank test">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec111" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In this recipe, we discuss a nonparametric test method, the Wilcoxon Rank Sum test (also known as the Mann-Whitney U-test). For student's t-test, it is assumed that the differences between the two samples are normally distributed (and it also works best when the two samples are normally distributed). However, when the normality assumption is uncertain, one can adopt the Wilcoxon Rank Sum Test to test a hypothesis.</p><p class="calibre7">Here, we used a <a id="id313" class="calibre1"/>Wilcoxon Rank Sum test to determine <a id="id314" class="calibre1"/>whether the mpg of automatic and manual transmission cars in the dataset, <code class="email">mtcars</code>, is distributed identically. From the test result, we see that the p-value = 0.001871 (&lt; 0.05) rejects the null hypothesis, and also reveals that the distribution of mpg in automatic and manual transmission cars is not identical. When performing this test, you may receive the warning message, "cannot compute exact p-value with ties", which indicates that there are duplicate values within the dataset. The warning message will be cleared once the duplicate values are removed.</p></div></div>

<div class="book" title="Understanding the Wilcoxon Rank Sum and Signed Rank test">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec112" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">To read more about the usage of the Wilcoxon Rank Sum and Signed Rank Test, please use the <code class="email">help</code> function to view the concerned documents:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ? wilcox.test</strong></span>
</pre></div></li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Working with Pearson's Chi-squared test"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec37" class="calibre1"/>Working with Pearson's Chi-squared test</h1></div></div></div><p class="calibre7">In this recipe, we<a id="id315" class="calibre1"/> introduce Pearson's Chi-squared test, which is used to examine whether the distributions of categorical variables of two groups <a id="id316" class="calibre1"/>differ. We will discuss how to conduct Pearson's Chi-squared Test in R.</p></div>

<div class="book" title="Working with Pearson's Chi-squared test">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec113" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. Since the <code class="email">chisq.test</code> function is originated from the <code class="email">stats?</code> package, make sure the library, <code class="email">stats,</code> is loaded.</p></div></div>

<div class="book" title="Working with Pearson's Chi-squared test">
<div class="book" title="How to do it"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec114" class="calibre1"/>How to do it</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">To make the counting table, we first use the contingency table built with the inputs of the transmission type and number of forward gears:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ftable = table(mtcars$am, mtcars$gear)</strong></span>
<span class="strong"><strong class="calibre2">&gt; ftable</strong></span>
<span class="strong"><strong class="calibre2">   </strong></span>
<span class="strong"><strong class="calibre2">     3  4  5</strong></span>
<span class="strong"><strong class="calibre2">  0 15  4  0</strong></span>
<span class="strong"><strong class="calibre2">  1  0  8  5</strong></span>
</pre></div></li><li class="listitem" value="2">We<a id="id317" class="calibre1"/> then plot the mosaic plot of the contingency table:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mosaicplot(ftable, main="Number of Forward Gears Within Automatic and Manual Cars", color = TRUE)</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00067.jpeg" alt="How to do it" class="calibre9"/><div class="caption"><p class="calibre12">Number of forward gears in automatic and manual cars</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="3">Next, we perform the Pearson's Chi-squared test on the contingency table to test whether the numbers of gears in automatic and manual transmission cars is the same:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; chisq.test(ftable)</strong></span>

<span class="strong"><strong class="calibre2">  Pearson's Chi-squared test</strong></span>

<span class="strong"><strong class="calibre2">data:  ftable</strong></span>
<span class="strong"><strong class="calibre2">X-squared = 20.9447, df = 2, p-value = 2.831e-05</strong></span>

<span class="strong"><strong class="calibre2">Warning message:</strong></span>
<span class="strong"><strong class="calibre2">In chisq.test(ftable) : Chi-squared approximation may be incorrect</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Working with Pearson's Chi-squared test">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec115" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">Pearson's Chi-squared test is a statistical test used to discover whether there is a relationship between two <a id="id318" class="calibre1"/>categorical variables.  It is best used for unpaired data from large samples. If you would like to conduct Pearson's Chi-squared test, you need to make sure that the input samples satisfy two assumptions: firstly, the two input variables should be categorical. Secondly, the variable should include two or more independent groups.</p><p class="calibre7">In Pearson's Chi-squared test, the assumption is that we have two variables, A and B; we can illustrate the null and alternative hypothesis in the following statements:</p><div class="book"><ul class="itemizedlist"><li class="listitem">H<sub class="calibre25">0</sub>: Variable A and variable B are independent</li><li class="listitem">H<sub class="calibre25">1</sub>: Variable A and variable B are not independent</li></ul></div><p class="calibre7">To test whether the null hypothesis is correct or incorrect, the Chi-squared test takes these steps.</p><p class="calibre7">It calculates the Chi-squared test statistic, <span class="strong"><img src="../images/00068.jpeg" alt="How it works..." class="calibre24"/></span>:</p><div class="mediaobject"><img src="../images/00069.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Here, r is the number of rows in the contingency table, c is the number of columns in the contingency table, O<sub class="calibre25">i,j</sub> is the observed frequency count, E<sub class="calibre25">i,j</sub> is the expected frequency count.</p><p class="calibre7">It determines the degrees of freedom, <code class="email">df</code>, of that statistic. The degree of freedom is equal to:</p><div class="mediaobject"><img src="../images/00070.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Here, r is the number of levels for one variable, and c is the number of levels for another variable.</p><p class="calibre7">It compares <span class="strong"><img src="../images/00071.jpeg" alt="How it works..." class="calibre24"/></span> to the critical value from the Chi-squared distribution with the degrees of freedom.</p><p class="calibre7">In this recipe, we use a contingency table and mosaic plot to illustrate the differences in count numbers. It is obvious that the number of forward gears is less in automatic transmission cars than in manual transmission cars.</p><p class="calibre7">Then, we <a id="id319" class="calibre1"/>perform the Pearson's Chi-squared test on the contingency table to determine whether the gears in automatic and manual transmission cars are the same. The output, p-value  = 2.831e-05 (&lt; 0.05), refutes the null hypothesis and shows the number of forward gears is different in automatic and manual transmission cars. However, the output message contains a warning message that Chi-squared approximation may be incorrect, which is because the number of samples in the contingency table is less than five.</p></div></div>

<div class="book" title="Working with Pearson's Chi-squared test">
<div class="book" title="There's more..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec116" class="calibre1"/>There's more...</h2></div></div></div><p class="calibre7">To read more about the usage of the Pearson's Chi-squared test, please use the <code class="email">help</code> function to view the related documents:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ? chisq.test</strong></span>
</pre></div><p class="calibre7">Besides some common hypothesis testing methods mentioned in previous examples, there are other hypothesis methods provided by R:</p><div class="book"><ul class="itemizedlist"><li class="listitem">The <a id="id320" class="calibre1"/>Proportional test (<code class="email">prop.test</code>): It is<a id="id321" class="calibre1"/> used to test whether the proportions in different groups are the same</li><li class="listitem">The <a id="id322" class="calibre1"/>Z-test (<code class="email">simple.z.test</code> in the UsingR package): It<a id="id323" class="calibre1"/> compares the sample mean with the population mean and standard deviation</li><li class="listitem">The <a id="id324" class="calibre1"/>Bartlett Test (<code class="email">bartlett.test</code>): It is <a id="id325" class="calibre1"/>used to test whether the variance of different groups is the same</li><li class="listitem">The <a id="id326" class="calibre1"/>Kruskal-Wallis Rank Sum Test (<code class="email">kruskal.test</code>): It is used to test whether the distribution of different<a id="id327" class="calibre1"/> groups is identical without assuming that they are normally distributed</li><li class="listitem">The <a id="id328" class="calibre1"/>Shapiro-Wilk test (<code class="email">shapiro.test</code>): It is <a id="id329" class="calibre1"/>used test for normality</li></ul></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Conducting a one-way ANOVA"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec38" class="calibre1"/>Conducting a one-way ANOVA</h1></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre2">Analysis of </strong></span>
<a id="id330" class="calibre1"/>
<span class="strong"><strong class="calibre2">variance</strong></span> (<span class="strong"><strong class="calibre2">ANOVA</strong></span>) investigates <a id="id331" class="calibre1"/>the relationship between categorical independent variables and continuous dependent variables. It can be used to test whether the means of several groups are equal. If there is only one categorical variable as an independent variable, you can perform a one-way ANOVA. On the <a id="id332" class="calibre1"/>other hand, if there are more than two <a id="id333" class="calibre1"/>categorical variables, you should perform a two-way ANOVA. In this recipe, we discuss how to conduct a one-way ANOVA with R.</p></div>

<div class="book" title="Conducting a one-way ANOVA">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec117" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. Since the <code class="email">oneway.test</code> and <code class="email">TukeyHSD</code> functions originated from the <code class="email">stats</code> package, make sure the library, <code class="email">stats</code>, is loaded.</p></div></div>

<div class="book" title="Conducting a one-way ANOVA">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec118" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">We begin exploring by visualizing the data with a boxplot:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg~factor(mtcars$gear),xlab='gear',ylab='mpg')</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00072.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Comparison of mpg of different numbers of forward gears</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">Next, we conduct a one-way ANOVA to examine whether the mean of <code class="email">mpg</code> changes with different numbers of forward gears. We use the function, <code class="email">oneway.test</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; oneway.test(mtcars$mpg~factor(mtcars$gear))</strong></span>

<span class="strong"><strong class="calibre2">  One-way analysis of means (not assuming equal variances)</strong></span>

<span class="strong"><strong class="calibre2">data:  mtcars$mpg and factor(mtcars$gear)</strong></span>
<span class="strong"><strong class="calibre2">F = 11.2848, num df = 2.000, denom df = 9.508, p-value = 0.003085</strong></span>
</pre></div></li><li class="listitem" value="3">In addition<a id="id334" class="calibre1"/> to <code class="email">oneway.test</code>, a standard <a id="id335" class="calibre1"/>function, <code class="email">aov</code>, is used for the ANOVA analysis:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mtcars.aov = aov(mtcars$mpg ~ as.factor(mtcars$gear))</strong></span>
<span class="strong"><strong class="calibre2">&gt; summary(mtcars.aov)</strong></span>
<span class="strong"><strong class="calibre2">                       Df Sum Sq Mean Sq F value   Pr(&gt;F)    </strong></span>
<span class="strong"><strong class="calibre2">as.factor(mtcars$gear)  2  483.2  241.62    10.9 0.000295 ***</strong></span>
<span class="strong"><strong class="calibre2">Residuals              29  642.8   22.17                     </strong></span>
<span class="strong"><strong class="calibre2">---</strong></span>
<span class="strong"><strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong></span>
</pre></div></li><li class="listitem" value="4">The model generated by the <code class="email">aov</code> function can also generate a summary as a fitted table:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; model.tables(mtcars.aov, "means")</strong></span>
<span class="strong"><strong class="calibre2">Tables of means</strong></span>
<span class="strong"><strong class="calibre2">Grand mean</strong></span>
<span class="strong"><strong class="calibre2">         </strong></span>
<span class="strong"><strong class="calibre2">20.09062 </strong></span>

<span class="strong"><strong class="calibre2"> as.factor(mtcars$gear) </strong></span>
<span class="strong"><strong class="calibre2">        3     4     5</strong></span>
<span class="strong"><strong class="calibre2">    16.11 24.53 21.38</strong></span>
<span class="strong"><strong class="calibre2">rep 15.00 12.00  5.00</strong></span>
</pre></div></li><li class="listitem" value="5">For the <code class="email">aov</code> model, one can use <code class="email">TukeyHSD</code> for a post hoc comparison test:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mtcars_posthoc =TukeyHSD(mtcars.aov)</strong></span>
<span class="strong"><strong class="calibre2">&gt; mtcars_posthoc</strong></span>
<span class="strong"><strong class="calibre2">  Tukey multiple comparisons of means</strong></span>
<span class="strong"><strong class="calibre2">    95% family-wise confidence level</strong></span>

<span class="strong"><strong class="calibre2">Fit: aov(formula = mtcars$mpg ~ as.factor(mtcars$gear))</strong></span>

<span class="strong"><strong class="calibre2">$`as.factor(mtcars$gear)`</strong></span>
<span class="strong"><strong class="calibre2">         diff        lwr       upr     p adj</strong></span>
<span class="strong"><strong class="calibre2">4-3  8.426667  3.9234704 12.929863 0.0002088</strong></span>
<span class="strong"><strong class="calibre2">5-3  5.273333 -0.7309284 11.277595 0.0937176</strong></span>
<span class="strong"><strong class="calibre2">5-4 -3.153333 -9.3423846  3.035718 0.4295874</strong></span>
</pre></div></li><li class="listitem" value="6">Further, we <a id="id336" class="calibre1"/>can visualize the differences <a id="id337" class="calibre1"/>in mean level with a <code class="email">plot</code> function:<div class="mediaobject"><img src="../images/00073.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The Tukey mean-difference plot of groups with different numbers of gears</p></div></div><p class="calibre13"> </p></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Conducting a one-way ANOVA">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec119" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In order to understand whether cars with a different number of forward gears have different means in mpg, we first plot the boxplot of mpg by the numbers of forward gears. This offers a simple indication if cars with a different number of forward gears have different means of mpg. We then perform the most basic form of ANOVA, a one-way ANOVA, to test whether the populations have different means.</p><p class="calibre7">In R, there are two functions to perform the ANOVA test: <code class="email">oneway.test</code> and <code class="email">aov</code>. The advantage of <code class="email">oneway.test</code> is that the function applies a Welch correction to address the nonhomogeneity of a variance. However, it does not provide as much information as <code class="email">aov</code>, and it does not offer a post hoc test. Next, we perform <code class="email">oneway.test</code> and <code class="email">aov</code> on the independent variable, <code class="email">gear</code>, with regard to the dependent variable, <code class="email">mpg</code>. Both test results show a small p-value, which rejects the null hypothesis that the mean between cars with a different number of forward gears have the same <code class="email">mpg</code> mean.</p><p class="calibre7">As the results of ANOVA only suggest that there is a significant difference in the means within overall populations, you may not know which two populations differ in terms of their mean. Therefore, we apply the <code class="email">TukeyHSD</code> post hoc comparison test on our ANOVA model. The<a id="id338" class="calibre1"/> result shows that cars with four forward gears<a id="id339" class="calibre1"/> and cars with three gears have the largest difference, as their confidence interval is the furthest to the right within the plot.</p></div></div>

<div class="book" title="Conducting a one-way ANOVA">
<div class="book" title="There's more..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec120" class="calibre1"/>There's more...</h2></div></div></div><p class="calibre7">ANOVA relies on an F-distribution as the basis of all probability distribution. An F score is obtained by dividing the between-group variance by the in-group variance. If the overall F test was significant, you can conduct a post hoc test (or multiple comparison tests) to measure the differences between groups. The most commonly used post hoc tests are Scheffé's method, the Tukey-Kramer method, and the Bonferroni correction.</p><p class="calibre7">In order to interpret the output of ANOVA, you need to have a basic understanding of certain terms, including the degrees of freedom, the sum of square total, the sum of square groups, the sum of square errors, the mean square errors, and the F statistic. If you require more information about these terms, you may refer to <span class="strong"><em class="calibre8">Using multivariate statistics</em></span> (Fidell, L. S., &amp; Tabachnick, B. G. (2006)<span class="strong"><em class="calibre8"> Boston: Allyn &amp; Bacon</em></span>.), or <a id="id340" class="calibre1"/>refer to the Wikipedia entry of Analysis of variance (<a class="calibre1" href="http://en.wikipedia.org/wiki/Analysis_of_variance#cite_ref-31">http://en.wikipedia.org/wiki/Analysis_of_variance#cite_ref-31</a>).</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Performing a two-way ANOVA"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec39" class="calibre1"/>Performing a two-way ANOVA</h1></div></div></div><p class="calibre7">A two-way <a id="id341" class="calibre1"/>ANOVA can be viewed as the extension <a id="id342" class="calibre1"/>of a one-way ANOVA, for the analysis covers more than two categorical variables rather than one. In this recipe, we will discuss how to conduct a two-way ANOVA in R.</p></div>

<div class="book" title="Performing a two-way ANOVA">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec121" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre7">Ensure that <code class="email">mtcars</code> has already been loaded into a data frame within an R session. Since the <code class="email">twoway.test</code>, <code class="email">TukeyHSD</code> and <code class="email">interaction.plot</code> functions are originated from the <code class="email">stats</code> package, make sure the library, <code class="email">stats</code>, is loaded.</p></div></div>

<div class="book" title="Performing a two-way ANOVA">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec122" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">Perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First<a id="id343" class="calibre1"/> we plot the two boxplots<a id="id344" class="calibre1"/> of factor gears in regard to mpg, with the plot separated from the transmission type:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; par(mfrow=c(1,2))</strong></span>
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$gear,subset=(mtcars$am==0),xlab='gear', ylab = "mpg",main='automatic')</strong></span>
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$gear,subset=(mtcars$am==1),xlab='gear', ylab = "mpg", main='manual')</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00074.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The boxplots of mpg by the gear group and the transmission type</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">Also, you may produce a boxplot of mpg by the number of forward gears <code class="email">*</code> transmission type, with the use of the <code class="email">*</code> operation in the <code class="email">boxplot</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; boxplot(mtcars$mpg~factor(mtcars$gear)* factor(mtcars$am),xlab='gear * transmission', ylab = "mpg",main='Boxplot of mpg by gear * transmission')</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00075.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The boxplot of mpg by the gear * transmission type</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="3">Next, we <a id="id345" class="calibre1"/>use an interaction plot to <a id="id346" class="calibre1"/>characterize the relationship between variables:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; interaction.plot(mtcars$gear, mtcars$am, mtcars$mpg, type="b", col=c(1:3),leg.bty="o", leg.bg="beige", lwd=2, pch=c(18,24,22), xlab="Number of Gears", ylab="Mean Miles Per Gallon", main="Interaction Plot")</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00076.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">Interaction between the transmission type and the number of gears with the main effects, mpg</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4">We <a id="id347" class="calibre1"/>then perform a two-way <a id="id348" class="calibre1"/>ANOVA on mpg with a combination of the gear and transmission-type factors:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; mpg_anova2 = aov(mtcars$mpg~factor(mtcars$gear)*factor(mtcars$am))</strong></span>
<span class="strong"><strong class="calibre2">&gt; summary(mpg_anova2) </strong></span>
<span class="strong"><strong class="calibre2">                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    </strong></span>
<span class="strong"><strong class="calibre2">factor(mtcars$gear)  2  483.2  241.62  11.869 0.000185 ***</strong></span>
<span class="strong"><strong class="calibre2">factor(mtcars$am)    1   72.8   72.80   3.576 0.069001 .  </strong></span>
<span class="strong"><strong class="calibre2">Residuals           28  570.0   20.36                     </strong></span>
<span class="strong"><strong class="calibre2">---</strong></span>
<span class="strong"><strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong></span>
</pre></div></li><li class="listitem" value="5">Similar to a one-way ANOVA, we can perform a post hoc comparison test to see the results of the two-way ANOVA model:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; TukeyHSD(mpg_anova2)</strong></span>
<span class="strong"><strong class="calibre2">  Tukey multiple comparisons of means</strong></span>
<span class="strong"><strong class="calibre2">    95% family-wise confidence level</strong></span>

<span class="strong"><strong class="calibre2">Fit: aov(formula = mtcars$mpg ~ factor(mtcars$gear) * factor(mtcars$am))</strong></span>

<span class="strong"><strong class="calibre2">$`factor(mtcars$gear)`</strong></span>
<span class="strong"><strong class="calibre2">         diff        lwr       upr     p adj</strong></span>
<span class="strong"><strong class="calibre2">4-3  8.426667  4.1028616 12.750472 0.0001301</strong></span>
<span class="strong"><strong class="calibre2">5-3  5.273333 -0.4917401 11.038407 0.0779791</strong></span>
<span class="strong"><strong class="calibre2">5-4 -3.153333 -9.0958350  2.789168 0.3999532</strong></span>

<span class="strong"><strong class="calibre2">$`factor(mtcars$am)`</strong></span>
<span class="strong"><strong class="calibre2">        diff       lwr     upr     p adj</strong></span>
<span class="strong"><strong class="calibre2">1-0 1.805128 -1.521483 5.13174 0.2757926</strong></span>
</pre></div></li><li class="listitem" value="6">We <a id="id349" class="calibre1"/>then visualize the differences<a id="id350" class="calibre1"/> in mean levels with the <code class="email">plot</code> function:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; par(mfrow=c(1,2))</strong></span>
<span class="strong"><strong class="calibre2">&gt; plot(TukeyHSD(mpg_anova2))</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00077.jpeg" alt="How to do it..." class="calibre9"/><div class="caption"><p class="calibre12">The comparison plot of differences in mean levels by the transmission type and the number of gears</p></div></div><p class="calibre13"> </p></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Performing a two-way ANOVA">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec123" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre7">In this recipe, we perform a two-way ANOVA to examine the influences of the independent variables, <code class="email">gear</code> and <code class="email">am</code>, on the dependent variable, <code class="email">mpg</code>. In the first step, we use a boxplot to examine the mean of mpg by the number of gears and the transmission type. Secondly, we apply an interaction plot to visualize the change in mpg through the different<a id="id351" class="calibre1"/> numbers of gears with lines separated <a id="id352" class="calibre1"/>by the transmission type.</p><p class="calibre7">The resulting plot shows that the number of gears does have an effect on the mean of mpg, but does not show a positive relationship either. Thirdly, we perform a two-way ANOVA with the <code class="email">aov</code> function. The output shows that the p-value of the <code class="email">gear</code> factor rejects the null hypothesis, while the factor, <code class="email">transmission type</code>, does not reject the null hypothesis. In other words, cars with different numbers of gears are more likely to have different means of mpg. Finally, in order to examine which two populations have the largest differences, we perform a post hoc analysis, which reveals that cars with four gears and three gears, respectively, have the largest difference in terms of the mean, mpg.</p></div></div>

<div class="book" title="Performing a two-way ANOVA">
<div class="book" title="See also"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec124" class="calibre1"/>See also</h2></div></div></div><div class="book"><ul class="itemizedlist"><li class="listitem">For multivariate analysis of variances, the function, <code class="email">manova</code>, can be used to examine the effect of multiple independent variables on multiple dependent variables. Further information about MANOVA is included within the <code class="email">help</code> function in R:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&gt; ?MANOVA</strong></span>
</pre></div></li></ul></div></div></div></body></html>