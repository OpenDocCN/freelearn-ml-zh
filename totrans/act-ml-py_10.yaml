- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Utilizing Tools and Packages for Active ML
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用主动机器学习的工具和包
- en: In this chapter, we will discuss a range of Python libraries, frameworks, and
    tools commonly used in active ML. These resources are instrumental to implementing
    a variety of active ML techniques. The content of this chapter is structured to
    be informative and useful for individuals at different levels of expertise, from
    beginners to experienced programmers. The aim is to provide a solid understanding
    of the tools we will cover in order to effectively incorporate active ML techniques
    into your projects.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论一系列在主动机器学习中常用的 Python 库、框架和工具。这些资源对于实现各种主动机器学习技术至关重要。本章的内容旨在为不同水平的专家提供信息丰富且实用的内容，从初学者到经验丰富的程序员。目标是提供对我们将要涵盖的工具的坚实基础理解，以便有效地将主动机器学习技术融入您的项目中。
- en: Throughout this chapter, the focus will be on understanding Python packages
    for active ML. We will use the popular Python libraries `scikit-learn` and `modAL`.
    You’ll learn about their functionalities and how they can be applied to active
    ML scenarios. We will also explore a range of active ML tools. In addition to
    the tools covered in previous sections of the book, this chapter will introduce
    some additional active ML tools. Each tool will be presented with an overview
    of its features and potential applications, helping you to understand how they
    fit into different active ML contexts.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，重点将放在理解主动机器学习的 Python 包上。我们将使用流行的 Python 库`scikit-learn`和`modAL`。您将了解它们的特性以及它们如何应用于主动机器学习场景。我们还将探索一系列主动机器学习工具。除了本书前几节中涵盖的工具外，本章还将介绍一些额外的主动机器学习工具。每个工具都将提供其特性和潜在应用的概述，帮助您了解它们如何适应不同的主动机器学习环境。
- en: 'In this chapter, we will discuss the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Mastering Python packages for enhanced active ML
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 掌握用于增强主动机器学习的 Python 包
- en: Getting familiar with the active ML tools
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 熟悉主动机器学习工具
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'For the exercises in this chapter, you will need to install these packages:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章的练习，您需要安装以下包：
- en: '[PRE0]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'And you will need the following imports:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 您将需要以下导入：
- en: '[PRE1]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Mastering Python packages for enhanced active ML
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 掌握用于增强主动机器学习的 Python 包
- en: 'This section offers a comprehensive overview of two popular Python packages
    known for their capabilities in facilitating active ML: `scikit-learn`, a versatile
    and user-friendly library, is foundational in the ML community for its extensive
    array of traditional ML tools. On the other hand, `modAL`, specifically designed
    for active ML, builds upon `scikit-learn`’s robust framework to introduce more
    dynamic, data-efficient learning techniques. Together, these packages represent
    a powerful toolkit for anyone looking to leverage the strengths of active ML methodologies.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本节提供了两个广受欢迎的 Python 包的全面概述，这些包以其在促进主动机器学习方面的能力而闻名：`scikit-learn`，一个功能丰富且用户友好的库，在机器学习社区中是基础性的，因为它拥有广泛的传统机器学习工具。另一方面，专门为主动机器学习设计的`modAL`，建立在`scikit-learn`的强大框架之上，引入了更动态、数据高效的机器学习技术。这两个包共同代表了一个强大的工具包，供那些希望利用主动机器学习方法优势的人使用。
- en: scikit-learn
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: scikit-learn
- en: While not exclusively for active ML, **scikit-learn** ([https://scikit-learn.org/stable/index.html](https://scikit-learn.org/stable/index.html))
    is a foundational package in Python’s machine learning ecosystem. It offers a
    broad range of algorithms and tools that are often used in conjunction with active
    ML packages – a vast collection of algorithms for classification, regression,
    clustering, and dimensionality reduction. It also provides tools for model evaluation
    and data preprocessing.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然不是专门为主动机器学习设计的，但**scikit-learn**（[https://scikit-learn.org/stable/index.html](https://scikit-learn.org/stable/index.html)）是
    Python 机器学习生态系统中的基础包。它提供了一系列算法和工具，这些工具通常与主动机器学习包一起使用——一个用于分类、回归、聚类和降维的算法集合。它还提供了模型评估和数据预处理的工具。
- en: '`scikit-learn` is typically used as a base for model development and is often
    integrated with active ML packages for model training and evaluation.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '`scikit-learn`通常用作模型开发的基础，并且经常与主动机器学习包集成以进行模型训练和评估。'
- en: For instance, `scikit-learn` can be used to perform customer segmentation in
    marketing by clustering customers based on purchasing behavior, demographics,
    and engagement metrics. K-means clustering, a popular algorithm in `scikit-learn`,
    helps in identifying distinct customer groups for targeted marketing campaigns.
    Active ML can be incorporated by iteratively refining the clustering model. For
    instance, marketing analysts can label ambiguous cases where the clustering algorithm
    is uncertain, improving the model’s accuracy over time.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，`scikit-learn`可以通过根据购买行为、人口统计和参与度指标对客户进行聚类，在营销中执行客户细分。`scikit-learn`中流行的K-means聚类算法有助于识别用于针对性营销活动的不同客户群体。通过迭代改进聚类模型，可以结合活跃机器学习。例如，营销分析师可以对聚类算法不确定的模糊案例进行标记，随着时间的推移提高模型的准确性。
- en: Let’s illustrate this with a simulated example.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用一个模拟示例来说明这一点。
- en: 'First, we perform the initial clustering with `KMeans`. We start by defining
    some mock customer data (age, annual income):'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用`KMeans`进行初始聚类。我们首先定义一些模拟客户数据（年龄，年收入）：
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Then we use `KMeans` for clustering:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们使用`KMeans`进行聚类：
- en: '[PRE3]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'And we predict the cluster for each customer:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们预测每个客户的聚类：
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We have segmented our customers into two clusters based on age and annual income.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经根据年龄和年收入将客户分为两个聚类。
- en: 'Next, we set up the active ML section. Let’s assume that we have a larger,
    unlabeled dataset of customer features called `X_unlabeled`. In the context of
    our customer segmentation scenario using `KMeans`, unlabeled data would consist
    of customer records with the same features we used for clustering (in our case,
    age and annual income), but without any assigned cluster labels. This data is
    what we’ll use to apply and refine our clustering and classification models in
    an active ML framework:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们设置活跃机器学习部分。假设我们有一个更大的、未标记的客户特征数据集`X_unlabeled`。在我们的客户细分场景中使用`KMeans`时，未标记数据将包括具有与我们用于聚类的相同特征（在我们的案例中是年龄和年收入）的客户记录，但没有分配的聚类标签。这些数据是我们将在活跃机器学习框架中应用和改进聚类和分类模型的数据：
- en: '[PRE5]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We need a model (a classifier) to make predictions on this unlabeled data.
    Let’s use a simple classifier called `LogisticRegression` for illustration. We
    initialize this classifier and use the clusters as labels to train it on our initial
    dataset (`X`):'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要一个模型（一个分类器）来对这个未标记的数据进行预测。为了说明，让我们使用一个简单的分类器`LogisticRegression`。我们初始化这个分类器，并使用聚类作为标签，在我们的初始数据集（`X`）上对其进行训练：
- en: '[PRE6]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Then we implement the active ML loop. In each iteration, the classifier predicts
    labels for the unlabeled data. First, we need to create a `obtain_labels` placeholder
    function where we obtain the true labels for the selected data points. In a real-world
    scenario, this function would involve a process to acquire the actual labels,
    such as conducting surveys or expert analysis. Since we’re creating a simulated
    example, we design this function to randomly assign labels based on some assumed
    logic:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们实现活跃机器学习循环。在每次迭代中，分类器对未标记数据进行标签预测。首先，我们需要创建一个`obtain_labels`占位符函数，用于获取所选数据点的真实标签。在实际场景中，此函数将涉及获取实际标签的过程，例如进行调查或专家分析。由于我们正在创建一个模拟示例，我们设计这个函数以基于某些假设逻辑随机分配标签：
- en: '[PRE7]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'For our active ML loop, we need to choose how many iterations we want to go
    through and how many samples will be labeled in each iteration:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的活跃机器学习循环，我们需要选择我们想要进行的迭代次数以及每次迭代中要标记的样本数量：
- en: '[PRE8]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We can now create our active ML loop that will do the following:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以创建我们的活跃机器学习循环，它将执行以下操作：
- en: Select instances for which the classifier is least confident.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择分类器最不自信的实例。
- en: Obtain true labels for these instances (in practice, this might involve manual
    labeling or additional data collection).
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取这些实例的真实标签（在实际操作中，这可能涉及手动标记或额外数据收集）。
- en: Update the classifier with these new labels.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用这些新标签更新分类器。
- en: Periodically update the `KMeans` model with the newly labeled data to refine
    the customer segments.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定期使用新标记的数据更新`KMeans`模型，以细化客户细分。
- en: 'The following is a code snippet that helps us to achieve this:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个代码片段，帮助我们实现这一点：
- en: '[PRE9]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The preceding code returns the following:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码返回以下结果：
- en: '[PRE10]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Our active ML loop iterates a specified number of times, each time selecting
    the least confident predictions made by the classifier, obtaining labels for these
    instances, and then updating the classifier and `KMeans` model with the new data.
    Remember, the `obtain_labels` function is a simplification. In a real application,
    obtaining labels would involve an oracle manually labeling the samples as we described
    in [*Chapter 3*](B21789_03.xhtml#_idTextAnchor040), *Managing the Human in* *the
    Loop*.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的活动机器学习循环迭代指定次数，每次选择分类器做出的最不自信的预测，为这些实例获取标签，然后使用新数据更新分类器和`KMeans`模型。记住，`obtain_labels`函数是一种简化。在实际应用中，获取标签将涉及一个预言者手动标记样本，正如我们在[*第3章*](B21789_03.xhtml#_idTextAnchor040)中描述的，*在循环中管理人类*。
- en: modAL
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: modAL
- en: '`scikit-learn`. It allows for easy integration of active learning strategies
    into existing ML workflows. It provides various active ML strategies such as uncertainty
    sampling and query by committee. It also supports custom query strategies and
    easy integration with `scikit-learn` models.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '`scikit-learn`。它允许轻松地将活动学习策略集成到现有的机器学习工作流程中。它提供了各种活动机器学习策略，如不确定性采样和委员会查询。它还支持自定义查询策略，并易于与`scikit-learn`模型集成。'
- en: For example, it is ideal for tasks such as image classification and regression
    where active ML can efficiently select informative samples for annotation.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，它非常适合图像分类和回归等任务，在这些任务中，活动机器学习可以有效地选择用于注释的信息性样本。
- en: Let’s take a look at an example where we classify images from the popular `torchvision`
    datasets. Given the large volume of images, active ML can help prioritize which
    images should be labeled manually. We will use the `modAL` framework’s uncertainty
    sampling query strategy. It will be able to identify the most informative images
    (those where the classifier is most uncertain) and query them for labeling.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一个例子，其中我们使用流行的`torchvision`数据集对图像进行分类。鉴于图像的大量，活动机器学习可以帮助优先考虑哪些图像应该手动标记。我们将使用`modAL`框架的不确定性采样查询策略。它将能够识别最有信息量的图像（分类器最不确定的图像）并对其进行标记查询。
- en: 'We implement a `load_images` function to read images from the dataset directory,
    then we convert them to grayscale and flatten the images for training. Indeed,
    we need to transform the image data into a format compatible with `RandomForest`,
    so each image, which is a 2D array, is *flattened* into a 1D array. This means
    converting the image into a long vector of pixel values. For our grayscale images
    of size 32x32 pixels, the flattened form will be a vector of 1,024 elements (32x32):'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们实现了一个`load_images`函数来从数据集目录中读取图像，然后我们将它们转换为灰度图并展平图像以进行训练。实际上，我们需要将图像数据转换为与`RandomForest`兼容的格式，因此每个图像（一个二维数组）被*展平*成一个一维数组。这意味着将图像转换成一个像素值的长时间向量。对于我们的32x32像素的灰度图像，展平形式将是一个包含1,024个元素的向量（32x32）：
- en: '[PRE11]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Next, for our example, we split the dataset into initial labeled data with
    the images stored in `X_initial` and the labels stored in `y_initial` and unlabeled
    data as `X_unlabeled`:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，为了我们的示例，我们将数据集分为初始标记数据（图像存储在`X_initial`中，标签存储在`y_initial`中）和未标记数据（`X_unlabeled`）：
- en: '[PRE12]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: We are starting our example with 12,500 labeled images and 37,500 unlabeled
    images.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我们以12,500个标记图像和37,500个未标记图像开始我们的示例。
- en: 'Then we initialize the `modAL` active learner:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们初始化`modAL`活动学习器：
- en: '[PRE13]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Finally, we simulate the querying of the labels with the following five-iteration
    loop:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们使用以下五次迭代循环模拟标签的查询：
- en: '[PRE14]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The preceding loop returns the following:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的循环返回以下内容：
- en: '[PRE15]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The loop represents five iterations of active ML. In each iteration, the model
    queries the dataset to label new instances. The learner queries the `X_unlabeled`
    training data and returns the `query_idx` index and `query_instance` instance
    of the sample it is most uncertain about. Then, the learner is taught using the
    instance it queried. In a real-world scenario, this step would involve obtaining
    the label for the queried instance from an oracle (such as a human annotator).
    However, in this simulated example, the label is directly taken from the `y_all`
    dataset.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 循环代表五次活动机器学习迭代。在每次迭代中，模型查询数据集以标记新实例。学习者查询`X_unlabeled`训练数据，并返回它最不确定的样本的`query_idx`索引和`query_instance`实例。然后，使用查询的实例对学习者进行教学。在现实世界场景中，这一步将涉及从预言者（如人类注释员）那里获取查询实例的标签。然而，在这个模拟示例中，标签直接从`y_all`数据集中获取。
- en: This example illustrates the process of active ML using `modAL`, where the model
    actively queries specific instances to learn from, rather than passively learning
    from a static dataset.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子说明了使用 `modAL` 进行主动机器学习的过程，其中模型主动查询特定的实例进行学习，而不是从静态数据集中被动学习。
- en: '`modAL` is a great Python package that allows us to implement complex active
    ML methods easily. For example, let’s create a use case of active ML using the
    `modAL` package, specifically focusing on **committee-based** algorithms. In this
    example, we’ll use a committee of classifiers to query the most informative samples
    from an unlabeled dataset. As a reminder, we defined the *query-by-committee approaches*
    in [*Chapter 2*](B21789_02.xhtml#_idTextAnchor027)*, Designing Query* *Strategy
    Frameworks*.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`modAL` 是一个优秀的 Python 包，它允许我们轻松实现复杂的主动机器学习方法。例如，让我们使用 `modAL` 包创建一个主动机器学习的用例，特别关注
    **基于委员会** 的算法。在这个例子中，我们将使用一个分类器委员会从未标记数据集中查询最有信息量的样本。作为提醒，我们在 [*第 2 章*](B21789_02.xhtml#_idTextAnchor027)*，设计查询策略框架*
    中定义了 *委员会查询方法*。'
- en: 'For this example, let’s use the Iris dataset (*Fisher, R. A.. (1988). Iris.
    UCI Machine Learning Repository*. [https://doi.org/10.24432/C56C76](https://doi.org/10.24432/C56C76)),
    a common choice for classification tasks. The Iris dataset is a classic dataset
    in machine learning and statistics, often used for demonstrating classification
    algorithms. The dataset contains 150 samples of iris flowers. Each sample has
    four features: sepal length, sepal width, petal length, and petal width. These
    features are measurements in centimeters of the respective parts of the iris plant.
    There are three species (classes) of iris plants in the dataset: Iris setosa,
    Iris virginica, and Iris versicolor. Each class has 50 samples, making the dataset
    evenly balanced among the three classes. The typical task with the Iris dataset
    is a multiclass classification problem. The goal is to predict the species of
    an iris plant based on measurements of its sepals and petals.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，让我们使用 Iris 数据集（*Fisher, R. A.. (1988). Iris. UCI Machine Learning Repository*
    [https://doi.org/10.24432/C56C76](https://doi.org/10.24432/C56C76)），这是分类任务中常用的选择。Iris
    数据集是机器学习和统计学中的一个经典数据集，常用于演示分类算法。该数据集包含 150 个鸢尾花样本。每个样本有四个特征：花瓣长度、花瓣宽度、花萼长度和花萼宽度。这些特征是鸢尾花植物相应部分的厘米测量值。数据集中有三种（类别）鸢尾花植物：Iris
    setosa、Iris virginica 和 Iris versicolor。每个类别有 50 个样本，使得数据集在三个类别之间均衡。使用 Iris 数据集的典型任务是多类分类问题。目标是根据花萼和花瓣的测量值预测鸢尾花植物的物种。
- en: We will use a committee of K-Nearest Neighbors classifiers. The committee will
    use the **query-by-committee (QBC) strategy** to select data points about which
    it has the most disagreement.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一个 K-Nearest Neighbors 分类器委员会。该委员会将使用 **委员会查询（QBC）策略** 来选择意见分歧最大的数据点。
- en: 'We start by loading the Iris dataset (from the datasets available with `scikit-learn`)
    and creating an initial small labeled dataset and a larger unlabeled dataset:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先加载 Iris 数据集（来自 `scikit-learn` 提供的数据集），并创建一个初始的小型标记数据集和一个较大的未标记数据集：
- en: '[PRE16]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We initialize twenty `ActiveLearner` instances, each with a `RandomForestClassifier`,
    and combine them into a `Committee`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们初始化了二十个 `ActiveLearner` 实例，每个实例都使用一个 `RandomForestClassifier`，并将它们组合成一个 `Committee`：
- en: '[PRE17]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The active ML loop uses the `vote_entropy_sampling` strategy to select the sample
    about which the committee members disagree the most.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 主动机器学习循环使用 `vote_entropy_sampling` 策略来选择委员会成员意见分歧最大的样本。
- en: 'Here is how our active ML loop looks like for five iterations:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是我们的主动机器学习循环在五次迭代中的样子：
- en: '[PRE18]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The `query` method of the `Committee` object is used to select the most informative
    sample from the unlabeled `X_unlabeled` dataset. The committee, consisting of
    multiple learners, uses its internal query strategy, `vote_entropy_sampling`,
    to determine which instance in `X_unlabeled` it finds most valuable for learning.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '`Committee` 对象的 `query` 方法用于从未标记的 `X_unlabeled` 数据集中选择最有信息量的样本。该委员会由多个学习者组成，使用其内部的查询策略
    `vote_entropy_sampling` 来确定在 `X_unlabeled` 中它认为对学习最有价值的实例。'
- en: 'The selected sample in each iteration is used to teach (retrain) all the committee’s
    learners. After each query, the performance of the committee is evaluated:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 每次迭代中选择的样本用于教导（重新训练）所有委员会的学习者。每次查询后，评估委员会的性能：
- en: '[PRE19]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This example demonstrates how to use a committee of learners with `modAL` to
    actively improve model performance by querying the most informative samples. The
    committee’s diverse opinions help in selecting samples that are more informative
    for learning, thus improving the overall model more efficiently. We observe in
    our output, for example, that the committee score improved from 0.96 to 0.973.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子演示了如何使用`modAL`中的学习者委员会通过查询最有信息量的样本来主动提高模型性能。委员会的多样化意见有助于选择对学习更有信息量的样本，从而更有效地提高整体模型。例如，我们在输出中观察到，委员会的分数从0.96提高到0.973。
- en: In active ML, especially when using a committee-based approach as in the preceding
    example, the expectation is generally that the performance of the model (or in
    this case, the committee of models) will improve over the iterations. This improvement
    is expected because the committee is being trained on increasingly informative
    samples, which are selected based on the committee’s uncertainty or disagreement.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在主动机器学习中，特别是在使用如前例所示的基于委员会的方法时，通常期望模型的性能（或在这种情况下，模型的委员会）会随着迭代而提高。这种改进是预期的，因为委员会正在被训练以越来越有信息量的样本，这些样本是根据委员会的不确定性或分歧选择的。
- en: 'However, a few points are worth noting:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，有几个要点值得注意：
- en: '**Incremental improvement**: The increase in performance might not be linear
    or consistent across all iterations. In some iterations, the model may improve
    significantly, while in others, the improvement might be minimal or even stagnant.
    We can see this in our example, where the committee score went from 0.96 to 0.94,
    and then back up to 0.973.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**增量改进**：性能的提高可能不是线性的或在整个迭代过程中都是一致的。在某些迭代中，模型可能显著改进，而在其他迭代中，改进可能很小甚至停滞。我们可以从我们的例子中看到这一点，其中委员会的分数从0.96降至0.94，然后又回升到0.973。'
- en: '**Depends on data and model**: The rate and consistency of improvement depend
    on the nature of the data and the effectiveness of the learning algorithm. For
    some datasets or configurations, the improvement might be rapid and consistent,
    while for others, it might be slower or less predictable.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**取决于数据和模型**：改进的速度和一致性取决于数据的性质和学习算法的有效性。对于某些数据集或配置，改进可能快速且一致，而对于其他数据集，改进可能较慢或不可预测。'
- en: '**Diminishing returns**: As the most informative samples are added to the training
    set, the remaining unlabeled samples may become less informative, leading to diminishing
    returns in terms of performance improvement in later iterations.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**递减回报**：随着最有信息量的样本被添加到训练集中，剩余的无标签样本可能变得不那么有信息量，导致在后续迭代中性能改进的递减回报。'
- en: '`modAL` function uses the accuracy by default) is a measure of how well the
    committee’s combined prediction aligns with the true labels. As the committee
    is exposed to more representative samples of the data, its predictions should
    become more accurate.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`modAL`函数默认使用准确率（accuracy）作为衡量委员会综合预测与真实标签一致性的指标。随着委员会接触到更多数据的有代表性样本，其预测应该变得更加准确。'
- en: '**Evaluation method**: The method of evaluating the committee’s performance
    can also affect perceived improvements. If the evaluation is done on a static
    test set, the improvements may be more evident. However, if the evaluation is
    on the training set (including newly added samples), the improvements might be
    less pronounced due to increasing complexity or variance in the data.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**评估方法**：评估委员会表现的方法也可能影响感知到的改进。如果评估是在静态测试集上进行的，改进可能更为明显。然而，如果评估是在训练集上进行的（包括新添加的样本），由于数据复杂性的增加或方差的变化，改进可能不那么明显。'
- en: In summary, while an increase in the committee’s performance score over a number
    of iterations is a common expectation in active ML, the actual pattern of improvement
    can vary based on various factors. Regular monitoring and adjustments might be
    necessary to ensure the active ML process is yielding the desired results, as
    we saw in [*Chapter 6*](B21789_06.xhtml#_idTextAnchor078), *Evaluating and* *Enhancing
    Efficiency*.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，虽然在一个迭代周期内委员会性能分数的增加在主动机器学习中是一个常见的期望，但实际的改进模式可能因各种因素而异。定期监控和调整可能有必要，以确保主动机器学习过程产生预期的结果，正如我们在[*第6章*](B21789_06.xhtml#_idTextAnchor078)，*评估和*
    *提高效率*中看到的。
- en: The choice of the right Python package for active ML depends on the specific
    requirements of the task at hand, including the type of data, the ML model being
    used, and the desired active learning strategy. Integrating these packages effectively
    can lead to more efficient data labeling, faster model convergence, and overall
    better performance of ML models.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 选择合适的Python包进行主动机器学习取决于手头任务的特定要求，包括数据类型、所使用的机器学习模型和期望的主动学习策略。有效地整合这些包可以提高数据标注的效率、加快模型收敛速度，并整体提高机器学习模型的表现。
- en: Next, we will explore tools that can be easily used to perform active ML on
    unlabeled data such as Encord Active, Lightly, Cleanlab, Voxel51, and UBIAI.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨可以轻松用于对未标记数据进行主动机器学习的工具，如Encord Active、Lightly、Cleanlab、Voxel51和UBIAI。
- en: Getting familiar with the active ML tools
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 熟悉主动机器学习工具
- en: 'Throughout this book, we’ve introduced and discussed several key active ML
    tools and labeling platforms, including Lightly, Encord, LabelBox, Snorkel AI,
    Prodigy, `modAL`, and Roboflow. To further enhance your understanding and assist
    you in selecting the most suitable tool for your specific project needs, let’s
    revisit these tools with expanded insights and introduce a few additional ones:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在整本书中，我们介绍了讨论了几个关键的主动机器学习工具和标注平台，包括Lightly、Encord、LabelBox、Snorkel AI、Prodigy、`modAL`和Roboflow。为了进一步加深你的理解并帮助你选择最适合你特定项目需求的最合适的工具，让我们带着更深入的见解重新审视这些工具，并介绍一些额外的工具：
- en: '`scikit-learn`. It stands out for its extensive range of query strategies,
    which can be tailored to various active ML scenarios. Whether you are dealing
    with classification, regression, or clustering tasks, `modAL` provides a robust
    and intuitive interface for implementing active learning workflows.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`scikit-learn`。它因其广泛的查询策略而脱颖而出，这些策略可以根据不同的主动机器学习场景进行定制。无论你是在处理分类、回归还是聚类任务，`modAL`都提供了一个强大且直观的界面，用于实现主动学习工作流程。'
- en: '**Label** **Studio** ([https://docs.humansignal.com/guide/active_learning.     html?__hstc=90244869.a32555b92661e36e5f4b3b8a0f2cc99a.170621 0819596.1706210819596.1706210819596.1&__hssc=90244869.2.1706     210819596&__hsfp=3755259113&_gl=1*1i1r2ib*_ga*MTE1NzM0NDQ4Ny 4xNzA2MjEwODE5*_ga_NQELN45JRH*MTcwNjIxMDgxOS4xLjEuMTcwNj     IxMDgzNC4wLjAuMA](https://docs.humansignal.com/guide/active_learning.html?__hstc=90244869.a32555b92661e36e5f4b3b8a0f2cc99a.1706210819596.1706210819596.1706210819596.1&__hssc=90244869.2.1706210819596&__hsfp=3755259113&_gl=1*1i1r2ib*_ga*MTE1NzM0NDQ4Ny4xNzA2MjEwODE5*_ga_NQELN45JRH*MTcwNjIxMDgxOS4xLjEuMTcwNjIxMDgzNC4wLjAuMA)):
    An open source, multi-type data labeling tool, Label Studio excels in its adaptability
    to different forms of data, including text, images, and audio. It allows for the
    integration of ML models into the labeling process, thereby enhancing labeling
    efficiency through active ML. Its flexibility extends to customizable labeling
    interfaces, making it suitable for a broad range of applications in data annotation.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Label Studio** ([https://docs.humansignal.com/guide/active_learning.html?__hstc=90244869.a32555b92661e36e5f4b3b8a0f2cc99a.1706210819596.1706210819596.1706210819596.1&__hssc=90244869.2.1706210819596&__hsfp=3755259113&_gl=1*1i1r2ib*_ga*MTE1NzM0NDQ4Ny4xNzA2MjEwODE5*_ga_NQELN45JRH*MTcwNjIxMDgxOS4xLjEuMTcwNjIxMDgzNC4wLjAuMA](https://docs.humansignal.com/guide/active_learning.html?__hstc=90244869.a32555b92661e36e5f4b3b8a0f2cc99a.1706210819596.1706210819596.1706210819596.1&__hssc=90244869.2.1706210819596&__hsfp=3755259113&_gl=1*1i1r2ib*_ga*MTE1NzM0NDQ4Ny4xNzA2MjEwODE5*_ga_NQELN45JRH*MTcwNjIxMDgxOS4xLjEuMTcwNjIxMDgzNC4wLjAuMA)):
    一个开源的多类型数据标注工具，Label Studio在适应不同形式的数据方面表现出色，包括文本、图像和音频。它允许将机器学习模型集成到标注过程中，从而通过主动机器学习提高标注效率。其灵活性扩展到可定制的标注界面，使其适用于数据标注的广泛应用。'
- en: '**Prodigy** ([https://prodi.gy/](https://prodi.gy/)): Prodigy offers a unique
    blend of active ML and human-in-the-loop approaches. It’s a highly efficient annotation
    tool, particularly for refining training data for NLP models. Its real-time feedback
    loop allows for rapid iteration and model improvement, making it an ideal choice
    for projects that require quick adaptation and precision in data annotation.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Prodigy** ([https://prodi.gy/](https://prodi.gy/))：Prodigy提供了一种独特的主动机器学习和人机交互方法的结合。它是一个高效的标注工具，尤其适用于精炼NLP模型的训练数据。它的实时反馈循环允许快速迭代和模型改进，使其成为需要快速适应和精确数据标注的项目的一个理想选择。'
- en: '**Lightly**([https://www.lightly.ai/](https://www.lightly.ai/)): Specializing
    in image datasets, Lightly uses active ML to identify the most representative
    and diverse set of images for training. This ensures that models are trained on
    a balanced and varied dataset, leading to improved generalization and performance.
    Lightly is particularly useful for projects where data is abundant but labeling
    resources are limited.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Lightly**([https://www.lightly.ai/](https://www.lightly.ai/)): 专注于图像数据集，Lightly使用主动机器学习来识别训练中最具代表性和多样化的图像集。这确保了模型在平衡和多样化的数据集上训练，从而提高了泛化能力和性能。Lightly对于数据丰富但标注资源有限的项目特别有用。'
- en: '**Encord Active** ([https://encord.com/active](https://encord.com/active)):
    Focused on active ML for image and video data, Encord Active is integrated within
    a comprehensive labeling platform. It streamlines the labeling process by identifying
    and prioritizing the most informative samples, thereby enhancing efficiency and
    reducing the manual annotation workload. This platform is particularly beneficial
    for large-scale computer vision projects.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Encord Active** ([https://encord.com/active](https://encord.com/active)):
    Encord Active专注于图像和视频数据的主动机器学习，集成在一个全面的标注平台中。它通过识别和优先处理最有信息量的样本来简化标注流程，从而提高效率并减少人工标注的工作量。这个平台对于大规模计算机视觉项目特别有益。'
- en: '**Cleanlab** ([https://cleanlab.ai/](https://cleanlab.ai/)): Cleanlab stands
    out for its ability to detect, quantify, and rectify label errors in datasets.
    This capability is invaluable for active ML, where the quality of the labeled
    data directly impacts model performance. It offers a systematic approach to ensuring
    data integrity, which is crucial for training robust and reliable models.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cleanlab** ([https://cleanlab.ai/](https://cleanlab.ai/)): Cleanlab以其在数据集中检测、量化并纠正标签错误的能力而脱颖而出。这种能力对于主动机器学习至关重要，因为标注数据的质量直接影响模型性能。它提供了一种确保数据完整性的系统方法，这对于训练稳健和可靠的模型至关重要。'
- en: '**Voxel51** ([https://voxel51.com/blog/supercharge-your-annotation-workflow-with-active-learning](https://voxel51.com/blog/supercharge-your-annotation-workflow-with-active-learning)):
    With a focus on video and image data, Voxel51 provides an active ML platform that
    prioritizes the most informative data for labeling. This enhances the annotation
    workflow, making it more efficient and effective. The platform is particularly
    adept at handling complex, large-scale video datasets, offering powerful tools
    for video analytics and ML'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Voxel51** ([https://voxel51.com/blog/supercharge-your-annotation-workflow-with-active-learning](https://voxel51.com/blog/supercharge-your-annotation-workflow-with-active-learning)):
    专注于视频和图像数据，Voxel51提供了一个优先处理标注最有信息量数据的主动机器学习平台。这增强了标注工作流程，使其更加高效和有效。该平台特别擅长处理复杂的大型视频数据集，提供强大的视频分析和机器学习工具。'
- en: '**UBIAI** ([https://ubiai.tools/active-learning-2](https://ubiai.tools/active-learning-2)):
    UBIAI is a tool that specializes in text annotation and supports active ML. It
    simplifies the process of training and deploying NLP models by streamlining the
    annotation workflow. Its active ML capabilities ensure that the most informative
    text samples are prioritized for annotation, thus improving model accuracy with
    fewer labeled examples.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**UBIAI** ([https://ubiai.tools/active-learning-2](https://ubiai.tools/active-learning-2)):
    UBIAI是一个专注于文本标注并支持主动机器学习的工具。它通过简化标注工作流程来简化训练和部署NLP模型的过程。其主动机器学习能力确保最有信息量的文本样本被优先标注，从而在更少的标注示例中提高模型准确性。'
- en: '**Snorkel AI** ([https://snorkel.ai](https://snorkel.ai)): Renowned for its
    novel approach to creating, modeling, and managing training data, Snorkel AI uses
    a technique called weak supervision. This method combines various labeling sources
    to reduce the dependency on large labeled datasets, complementing active ML strategies
    to create efficient training data pipelines.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Snorkel AI** ([https://snorkel.ai](https://snorkel.ai)): 以其创建、建模和管理训练数据的创新方法而闻名，Snorkel
    AI使用一种称为弱监督的技术。这种方法结合了各种标注来源，以减少对大量标注数据集的依赖，补充主动机器学习策略以创建高效的训练数据管道。'
- en: '**Deepchecks** ([https://deepchecks.com/importance-of-active-learning-in-machine-learning](https://deepchecks.com/importance-of-active-learning-in-machine-learning)):
    Deepchecks offers a comprehensive suite of validation checks that are essential
    in an active ML context. These checks ensure the quality and diversity of datasets
    and models, thereby facilitating the development of more accurate and robust ML
    systems. It’s an essential tool for maintaining data integrity and model reliability
    throughout the ML lifecycle.'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Deepchecks** ([https://deepchecks.com/importance-of-active-learning-in-machine-learning](https://deepchecks.com/importance-of-active-learning-in-machine-learning)):
    Deepchecks提供了一套在主动机器学习环境中至关重要的验证检查。这些检查确保了数据集和模型的质量和多样性，从而促进了更准确、更稳健的机器学习系统的开发。它是维护数据完整性和模型可靠性在整个机器学习生命周期中的必备工具。'
- en: '**LabelBox** ([https://labelbox.com/guides/the-guide-to-getting-started-with-active-learning](https://labelbox.com/guides/the-guide-to-getting-started-with-active-learning)):
    As a comprehensive data labeling platform, LabelBox excels in managing the entire
    data labeling process. It provides a suite of tools for creating, managing, and
    iterating on labeled data, applicable to a wide range of data types such as images,
    videos, and text. Its support for active learning methodologies further enhances
    the efficiency of the labeling process, making it an ideal choice for large-scale
    ML projects.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**LabelBox** ([https://labelbox.com/guides/the-guide-to-getting-started-with-active-learning](https://labelbox.com/guides/the-guide-to-getting-started-with-active-learning)):
    作为一款全面的数据标注平台，LabelBox在管理整个数据标注流程方面表现出色。它提供了一套创建、管理和迭代标注数据的工具，适用于各种数据类型，如图像、视频和文本。其对主动学习方法的支撑进一步提高了标注过程的效率，使其成为大规模机器学习项目的理想选择。'
- en: '**Roboflow** ([https://docs.roboflow.com/api-reference/active-learning](https://docs.roboflow.com/api-reference/active-learning)):
    Designed for computer vision projects, Roboflow streamlines the process of preparing
    image data. It is especially valuable for tasks involving image recognition and
    object detection. Roboflow’s focus on easing the preparation, annotation, and
    management of image data makes it a key resource for teams and individuals working
    in the field of computer vision.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Roboflow** ([https://docs.roboflow.com/api-reference/active-learning](https://docs.roboflow.com/api-reference/active-learning)):
    专为计算机视觉项目设计，Roboflow简化了图像数据准备的过程。它对于涉及图像识别和目标检测的任务尤其有价值。Roboflow专注于简化图像数据准备、标注和管理，使其成为计算机视觉领域团队和个人不可或缺的资源。'
- en: Each tool in this extended list brings unique capabilities to the table, addressing
    specific challenges in ML projects. From image and video annotation to text processing
    and data integrity checks, these tools provide the necessary functionalities to
    enhance project efficiency and efficacy through active ML strategies.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 此扩展列表中的每个工具都为机器学习项目带来了独特的功能，解决了特定挑战。从图像和视频标注到文本处理和数据完整性检查，这些工具提供了通过主动机器学习策略提高项目效率和效果所必需的功能。
- en: Summary
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter has provided a comprehensive exploration of the various Python
    libraries, frameworks, and tools essential for active ML. By navigating through
    the intricacies of popular libraries such as `scikit-learn` and `modAL`, we have
    explored their capabilities and how they can be effectively applied in active
    ML scenarios. Additionally, this chapter has expanded your toolkit by introducing
    a range of other active ML tools, each with its own unique features and potential
    applications.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 本章全面探讨了各种对主动机器学习至关重要的Python库、框架和工具。通过深入了解流行的库如`scikit-learn`和`modAL`的复杂性，我们探讨了它们的性能以及如何在主动机器学习场景中有效地应用。此外，本章还通过介绍一系列其他主动机器学习工具，每个工具都有其独特的特性和潜在应用，扩展了您的工具箱。
- en: Whether you are a beginner taking your first steps in active ML or an experienced
    programmer seeking to refine your skills, this chapter aimed to equip you with
    a solid foundation in the tools and techniques of active ML. The knowledge gained
    here is not just theoretical; it is a practical guide to help you master Python
    packages for enhanced active ML and to familiarize yourself with a broad spectrum
    of active ML tools. This understanding will enable you to select and apply the
    most appropriate tools for your specific ML projects, enhancing the efficiency
    and effectiveness of your models.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 不论你是刚开始在主动机器学习领域迈出第一步的新手，还是寻求提升技能的经验丰富的程序员，本章旨在为你提供主动机器学习工具和技术的坚实基础。在这里获得的知识不仅仅是理论性的；它是一份实用指南，帮助你掌握增强主动机器学习的Python包，并熟悉广泛的主动机器学习工具。这种理解将使你能够为特定的机器学习项目选择并应用最合适的工具，从而提高模型的高效性和有效性。
- en: Congratulations! You have reached the end of the book. But remember you have
    just started your journey in the world of active ML. As you move forward in your
    ML journey, remember that the field of active ML is continually evolving. Staying
    informed about new developments, tools, and techniques will be key to maintaining
    a cutting-edge approach in your work. The tools and concepts covered in this chapter
    provide a strong basis for further exploration and innovation in the exciting
    and dynamic field of active ML.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你已经到达了本书的结尾。但请记住，你只是在主动机器学习的世界中开始了你的旅程。随着你在机器学习旅程中不断前进，请记住，主动机器学习的领域正在不断演变。了解新的发展、工具和技术将是保持你在工作中保持前沿方法的关键。本章涵盖的工具和概念为在令人兴奋且动态的主动机器学习领域中进一步探索和创新提供了坚实的基础。
