<html><head></head><body>
		<div id="_idContainer012">
			<h1 id="_idParaDest-16"><em class="italic"><a id="_idTextAnchor015"/>Chapter 1</em>: Opportunities and Challenges </h1>
			<p><strong class="bold">Machine Learning</strong> (<strong class="bold">ML</strong>) and data science are winning a popularity contest of sorts, as witnessed by their headline coverage in the popular and professional press and by expanding job openings across the technology landscape. Students typically learn ML techniques using their own computers on relatively small datasets. Those who enter the field often find themselves in the much different setting of a large company buzzing with workers performing specialized job roles, while collaborating with others scattered across the nation or world. Both data science students and data science workers have a few key things in common – they are in an exciting and growing field that businesses deem ever more critical to their future, and the data they thrive on is becoming exponentially more abundant and diverse.</p>
			<p>There are huge opportunities for ML in enterprises because the transformational impacts of ML on businesses, customers, patients, and so on are diverse, widespread, lucrative, and life-changing. A backdrop of urgency exists as well from competitors who are all attempting the same thing. Enterprises are thus incented to invest in significant ML transformations and to supply the necessary data, tooling, production systems, and people to journey toward ML success. But challenges loom large as well, and these challenges commonly revolve around scale. The challenges of scale take on many forms inherent to ML at an enterprise level.</p>
			<p>In this chapter, we will define and explore the challenge of ML at scale by covering the following main topics: </p>
			<ul>
				<li>ML at scale </li>
				<li>The ML life cycle and three challenge areas for ML at scale</li>
				<li>H2O.ai's answer to these challenges</li>
			</ul>
			<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>ML at scale</h1>
			<p>This book is <a id="_idIndexMarker000"/>about implementing ML at scale and how to use H2O.ai technology to succeed in doing so. What specifically do we mean by ML at scale? We can see three contexts and challenges of scale during the ML life cycle – building models from large datasets, deploying these models in enterprise production environments, and executing the full range of ML activities within the complexities of enterprise processes and stakeholders. This is summarized in the following figure: </p>
			<p class="figure-caption"> </p>
			<div>
				<div id="_idContainer006" class="IMG---Figure">
					<img src="image/B16721_01_01.jpg" alt="Figure 1.1 – The challenges of ML at scale&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.1 – The challenges of ML at scale</p>
			<p>Let's drill down further<a id="_idIndexMarker001"/> on these challenges. Before doing so, we will oversee a generic conception of the ML life cycle, which will be useful as a reference throughout the book.</p>
			<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>The ML life cycle and three challenge areas for ML at scale</h1>
			<p>The ML life cycle is a<a id="_idIndexMarker002"/> process that data scientists and <a id="_idIndexMarker003"/>enterprise stakeholders follow to build ML models and put them into production environments, where they make predictions and achieve value. In this section, we will define a simplified ML life cycle and elaborate on two broad areas that present special challenges for ML at scale.</p>
			<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/>A simplified ML life cycle</h2>
			<p>We will use the<a id="_idIndexMarker004"/> following ML life cycle representation. The goal is to achieve a simplified depiction that we can all recognize as central to ML while avoiding attempts at a canonical definition. Let's use it as our working framework for discussion:</p>
			<div>
				<div id="_idContainer007" class="IMG---Figure">
					<img src="image/B16721_01_02.jpg" alt="Figure 1.2 – A simplified ML life cycle&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.2 – A simplified ML life cycle</p>
			<p>The following is a brief articulation.</p>
			<h3>Model building</h3>
			<p>Model building is a <a id="_idIndexMarker005"/>highly iterative process with frequent and unpredictable feedback loops along the way toward building a predictive model that is worthy of deploying in a business context. The steps can be summarized as follows:</p>
			<ul>
				<li><strong class="bold">Data ingestion</strong>: Data is<a id="_idIndexMarker006"/> pulled from sources or a storage layer in the model building environment. There is often significant work onward from here in finding and accessing potentially useful data sources and transforming the data into a useable form. Typically, this is done as part of a larger data pipeline and architecture.</li>
				<li><strong class="bold">Data exploration</strong>: Data is explored to understand its qualities (for example, data profiling, correlation analysis, outlier detection, and data visualization).</li>
				<li><strong class="bold">Data manipulation</strong>: Data is cleaned (for example, the imputation of missing data, the reduction of categorical features, and normalization) and new features are engineered. </li>
				<li><strong class="bold">Model training</strong>: An ML algorithm, scoring metric, and validation method are selected, and the model is tuned across a range of hyperparameters and tested against a test dataset.</li>
				<li><strong class="bold">Model evaluation and explainability</strong>: A fit of the model is diagnosed for performance metrics, overfitting, and other diagnostics; model explainability is used to validate against domain knowledge, to explain the model decisions at individual and global levels, and to guard against institutional risks such as unfair bias against demographic groups. </li>
				<li><strong class="bold">Model deployment</strong>: The model is deployed as a scoring artifact to a software system and live scoring is made.</li>
				<li><strong class="bold">Model monitoring</strong>: The model is monitored to detect whether the data fed into it changes over time compared to the distribution of data it was trained on. This is called data drift and usually leads to the decreased predictive power of the model. This usually triggers the need to retrain the model with a more current dataset and then redeploy the updated model. The model may also be monitored for other patterns, such as whether it is biasing decisions against a particular demographic group and whether malicious attacks are being made to try to cause the model to malfunction.</li>
			</ul>
			<p>As mentioned, a <a id="_idIndexMarker007"/>key property in the workflow is the unknown number and sequence of iteration pathways taken between these steps before a model is deployed or before the project is deemed unsuccessful in reaching that stage.</p>
			<h2 id="_idParaDest-20"><a id="_idTextAnchor019"/>The model building challenge – state-of-the-art models at scale</h2>
			<p>Let's, for now, define a <a id="_idIndexMarker008"/>large dataset as any dataset that exceeds your ability to build ML models on your laptop or local workstation. It may be too large because your libraries simply crash or because they take an unreasonable amount of time to complete. This may occur during model training or during data ingestion, exploration, and manipulation.</p>
			<p>We can see four separate challenges of building ML models from large data volumes, with each contributing to a larger problem in general that we call the <em class="italic">friction of iteration</em>. This is represented in the following diagram:</p>
			<div>
				<div id="_idContainer008" class="IMG---Figure">
					<img src="image/B16721_01_03.jpg" alt="Figure 1.3 – The challenge of model building with large data volumes&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.3 – The challenge of model building with large data volumes</p>
			<p>Let's elaborate on this.</p>
			<h3>Challenge one – data size and location</h3>
			<p>Enterprises collect <a id="_idIndexMarker009"/>and store vast amounts of diverse data and that is a boon to the data scientist looking to build accurate models. These datasets are either stored across many systems or centralized in a common <a id="_idIndexMarker010"/>storage layer (data lake) such as the <strong class="bold">Hadoop Distributed File System</strong> (<strong class="bold">HDFS</strong>) or <strong class="bold">AWS S3</strong>. Architecting and making data <a id="_idIndexMarker011"/>available to internal consumers is a major effort and challenge for an enterprise. However, the data scientist starting the ML life cycle with large datasets typically cannot move that data, once it becomes accessible, to a local environment due to either security reasons or high volume of data.. The consequence is that the data scientist must either do one of the following: </p>
			<ul>
				<li>Move operations on the data (in other words, move the compute) to the data itself.</li>
				<li>Move data to a high-compute environment that they are authorized to use.</li>
			</ul>
			<h3>Challenge two – data size and data manipulation</h3>
			<p>Manipulating data <a id="_idIndexMarker012"/>can be compute-intensive, and attempting to do so against insufficient resources either will cause the compute to fail (for example, the script, library, or tool will crash) or take an unreasonably long amount of time. Who wants to wait 10 hours to join and filter table data when it can be done in 10 minutes? What you might consider an unreasonable amount of time is obviously relative to the dataset size; terabytes of data will always take longer to process than a few megabytes. Regardless, the speed of your data processing is critical to reducing the sum time of your iterations.</p>
			<h3>Challenge three – data size and data exploration</h3>
			<p>Challenges of data <a id="_idIndexMarker013"/>size during data exploration are identical to those during data manipulation. The data may be so large that your processing crashes or takes an unreasonable amount of time to complete while exploring models.</p>
			<h3>Challenge four – data size and model training</h3>
			<p>ML algorithms<a id="_idIndexMarker014"/> are extremely <em class="italic">compute-intensive</em> because they step through each record of a dataset and perform complex calculations each time, and then iterate these calculations against the dataset repeatedly to optimize toward a training metric and thus learn a predictive mathematical pattern among the noise. Our compute environment is particularly pressured during model training.</p>
			<p>Up until now, we have been discussing dataset size in relative terms; that is, large data volumes are those that cause operations on them to either fail or take a long time to complete in a given compute environment. </p>
			<p>In absolute terms, data scientists often explore the largest dataset possible to understand it and then <strong class="bold">sample</strong> it for model training. Others always try to use the largest dataset for model training. However, accurate models can be built from 10 GB or less of sampled or unsampled data.</p>
			<p>The key to proper use of sampling is that you have followed appropriate statistical and theoretical practices, and not that you are forced to do so because your ML processing will crash or take a long time to complete due to large data volumes. The latter is a bad practice that produces inferior models and H2O.ai overcomes this by allowing model building with<a id="_idIndexMarker015"/> massive data volumes.</p>
			<p>There are also cases when data sampling may not lead to an acceptable model. In other words, the data scientist may need hundreds of gigabytes or a terabyte or more of data to build a valuable model. These are cases when the following applies:</p>
			<ul>
				<li>The data scientist does not trust the sampling to produce the best model and feels that each small gain in lift warrants the use of the full dataset.</li>
				<li>The data scientist does not want to segment the data into separate datasets and thus separate model building exercises, or the larger stakeholder group wants a single model in production that predicts against all segments versus many that each predicts against a single segment.</li>
				<li>The data is highly dimensional, sparse, or both. In this case, a large number of records are needed to reduce variance and overfitting to a training dataset.  This type of dataset is typical for anomaly detection, recommendation engines, predictive maintenance, security threat detection, personalized medicine, and so on. It is worth noting that the future will bring us more and more data, and thus highly dimensional and sparse datasets will become more common.</li>
				<li>The data is extremely imbalanced. The target variable is very rare in the dataset and a massive dataset is needed to avoid underfitting, overfitting, or weighting the target variable from these infrequent records.</li>
				<li>The data is highly volatile. Each subset of data that is collected is unrepresentative of the others and thus sampling or cross-validation folds may not be representative. Time series<a id="_idIndexMarker016"/> forecasting may be particularly sensitive to this problem, especially when forecast categories are highly granular (for example, yearly, monthly, daily, and hourly) against a single validation dataset.</li>
			</ul>
			<h3>The friction of iteration</h3>
			<p>Model building <a id="_idIndexMarker017"/>is a highly iterative process and anything that slows it down we call the friction of iteration. These causes can be due to the challenges of working with large data volumes, as previously discussed. They can also arise from simple workflow patterns such as switching among systems between each iteration or launching new environments to work on an iteration. </p>
			<p>Any slowness during a single iteration may seem acceptable but when multiplied across the seemingly endless iterations from the project beginning to failure or success, the cost in time from this friction becomes significant, and reducing friction can be valuable. As we will see in the next section, slow model building delays the main goal of ML in an enterprise – achieving business value.</p>
			<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/>The business challenge – getting your models into enterprise production systems</h2>
			<p>The bare truth <a id="_idIndexMarker018"/>about ML initiatives is that they do not really achieve value until they are deployed to a live scoring environment. Models must meet evaluation criteria and be put into production to be deemed successful. Until that happens, from a business standpoint, little is achieved. This may seem a bit harsh, but it is typically how success is defined in data science initiatives. The following diagram maps this thinking onto the ML life cycle:</p>
			<p class="figure-caption"> </p>
			<div>
				<div id="_idContainer009" class="IMG---Figure">
					<img src="image/B16721_01_04.jpg" alt="Figure 1.4 – The ML life cycle value chain&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.4 – The ML life cycle value chain</p>
			<p>The friction of iteration from this view is thus a cost. Time taken to iterate through model building is<a id="_idIndexMarker019"/> time taken from getting business results. In other words, lower friction translates to less time to build and deploy a model to achieve business value, and more time to work on other problems and thus more models per quarter or year.</p>
			<p>From the same point of view, <strong class="bold">time to</strong> <strong class="bold">deploy a model</strong> is viewed as a cost for similar reasons. The model deployment step may seem like a simple one-step sequence of transitioning the model to DevOps, but typically it is not. Anything that makes a model easier and more repeatable to deploy, document, and govern helps businesses achieve value sooner. </p>
			<p>Let's now continue expanding on a larger landscape of enterprise stakeholders that data scientists must work with to build models that ultimately achieve business value.</p>
			<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/>The navigation challenge – navigating the enterprise stakeholder landscape</h2>
			<p>The data scientist<a id="_idIndexMarker020"/> in any enterprise does not work in isolation. There are multiple stakeholders who become involved directly in the ML life cycle or, more broadly, in the business cycle of initiating and consuming ML projects. Who might some of these stakeholders be? At a bare minimum, they include the business stakeholder who funded the ML project, the administrator providing the data scientist with permissions and capabilities, the DevOps or engineering team members who are responsible for model deployment and the infrastructure supporting it, perhaps marketing or sales associates whose functions are impacted directly by the model, and any other representatives of the internal or external consumers of the model. In more heavily regulated industries such as banking, insurance, or pharmaceuticals, these might include representatives or offices of various audit and risk functions – data risk, code risk, model risk, legal risk, reputational risk, compliance, external regulators, and so on. The following figure shows a general view:</p>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="image/B16721_01_05.jpg" alt="Figure 1.5 – Data scientists working with enterprise stakeholders and processes &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.5 – Data scientists working with enterprise stakeholders and processes </p>
			<p>Stakeholder interaction is thus complex. What leads to this complexity? Obviously, the specialization and siloing of job functions make things complex, and this is further amplified by the scale of the enterprise. A larger dynamic of creating repeatable processes and minimizing risk contributes as well. Explaining this complexity is the task of a different book, but its reality in the enterprise is inescapable. To a data scientist, the ability to recognize, influence, negotiate with, deliver to, and ultimately build trust with these various stakeholders is imperative to successful ML solutions at scale. </p>
			<p>Now that we have understood the ML life cycle and the challenges inherent in its successful <a id="_idIndexMarker021"/>execution at scale, it is time for a brief introduction to how H2O.ai solves these challenges. </p>
			<h1 id="_idParaDest-23"><a id="_idTextAnchor022"/>H2O.ai's answer to these challenges</h1>
			<p>H2O.ai provides<a id="_idIndexMarker022"/> software<a id="_idIndexMarker023"/> to build ML models at scale and overcome the challenges of doing so – model building at scale, model deployment at scale, and dealing with enterprise stakeholders' concerns and inherent friction along the way. These components are described in brief in the following diagram: </p>
			<div>
				<div id="_idContainer011" class="IMG---Figure">
					<img src="image/B16721_01_06.jpg" alt="Figure 1.6 – H2O ML at scale&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.6 – H2O ML at scale</p>
			<p>Subsequent chapters of this book elaborate on how these components are used to build and deploy state-of-the-art models within the complexities of the enterprise environment.</p>
			<p>Let's try to <a id="_idIndexMarker024"/>understand <a id="_idIndexMarker025"/>these components at first glance:</p>
			<ul>
				<li><strong class="bold">H2O Core</strong>: This is open<a id="_idIndexMarker026"/> source software that distributes state-of-the-art ML algorithms and data manipulations over a specified number of servers on Kubernetes, Hadoop, or Spark environments. Data is partitioned in memory across the designated number of servers and ML algorithm computation is run in parallel using it.</li>
			</ul>
			<p>This architecture creates horizontal scalability of model building to hundreds of gigabytes or terabytes of data and generally fast processing times at lower data volumes. Data scientists work with familiar IDEs, languages, and algorithms and are abstracted away from the underlying architecture. Thus, for example, a data scientist can run an XGBoost model in Python from a Jupyter notebook against 500 GB of data in Hadoop, similar to doing so with data loaded into their laptop.</p>
			<p>H2O Core is often<a id="_idIndexMarker027"/> referred to as <strong class="bold">H2O Open Source</strong> and comes in two<a id="_idIndexMarker028"/> forms, <strong class="bold">H2O-3</strong> and <strong class="bold">Sparkling Water</strong>, which we will elaborate on in<a id="_idIndexMarker029"/> subsequent chapters. H2O Core can be run as a scaled-down sandbox on a single server or laptop.</p>
			<ul>
				<li><strong class="bold">H2O Enterprise Steam</strong>: This is a web UI or API for data scientists to self-provision and manage their individual H2O Core environments. Self-provisioning includes auto-calculation of horizontal scaling based on user inputs that describe the data. Enterprise Steam is also used by administrators to manage users, including defining boundaries for their resource consumption, and to configure H2O Core integration against Hadoop, Spark, or Kubernetes.</li>
				<li><strong class="bold">H2O MOJO</strong>: This is an easy-to-deploy scoring artifact exportable from models built from H2O Core. MOJOs are low latency (typically &lt; 100 ms or faster) Java binaries that can <a id="_idIndexMarker030"/>run on any <strong class="bold">Java Virtual Machine (JVM)</strong> and thus serve predictions on diverse software systems, such as REST <a id="_idIndexMarker031"/>servers, database clients, Amazon SageMaker, Kafka queues, Spark <a id="_idIndexMarker032"/>pipelines, Hive <strong class="bold">user-defined functions (UDFs)</strong>, and <strong class="bold">Internet of Things (IoT)</strong> devices.</li>
				<li><strong class="bold">APIs</strong>: Each component has a rich set of APIs so that you can automate workflows, including <strong class="bold">continuous integration and continuous delivery (CI/CD)</strong> and <a id="_idIndexMarker033"/>retraining pipelines.</li>
			</ul>
			<p>The focus of this book is on building and deploying state-of-the-art models at scale using H2O Core with help from Enterprise Steam and deploying those models as MOJOs within <a id="_idIndexMarker034"/>the <a id="_idIndexMarker035"/>complexities of enterprise environments.</p>
			<p class="callout-heading">H2O at Scale and H2O AI Cloud</p>
			<p class="callout">We refer <a id="_idIndexMarker036"/>to <strong class="bold">H2O at scale</strong> in this book as H2O Enterprise Steam, H2O Core, and H2O Mojo because it addresses the ML at scale challenges described earlier in this chapter, especially through the distributed ML scalability that H2O Core provides for model building.</p>
			<p class="callout">Note that H2O.ai offers a larger end-to-end ML platform <a id="_idIndexMarker037"/>called the <strong class="bold">H2O AI Cloud</strong>. The H2O AI Cloud integrates a hyper-advanced AutoML tool (called <strong class="bold">H2O Driverless AI</strong>) and<a id="_idIndexMarker038"/> other model building engines, an MLOps scoring, monitoring, and governance<a id="_idIndexMarker039"/> environment (called <strong class="bold">H2O MLOps</strong>), and a low-code software <a id="_idIndexMarker040"/>development kit, or SDK (called <strong class="bold">H2O Wave</strong>) with H2O API hooks to build AI applications that publish to the <strong class="bold">App Store</strong>. It also<a id="_idIndexMarker041"/> integrates H2O at scale as defined in this book.</p>
			<p class="callout">H2O at scale can be deployed as standalone or as part of the H2O AI Cloud. As a standalone implementation, Enterprise Steam is not in fact required, but for reasons elaborated on later in this book, Enterprise Steam is deemed essential for enterprise implementations.</p>
			<p class="callout">The majority of this book is focused on H2O at scale. The last part of the book will extend our understanding to the H2O AI Cloud and how H2O at scale components can leverage this larger integrated platform and vice versa.</p>
			<h1 id="_idParaDest-24"><a id="_idTextAnchor023"/>Summary</h1>
			<p>In this chapter, we have set the stage for understanding and implementing ML at scale using H2O.ai technology. We have defined multiple forms of scale in an enterprise setting and articulated the challenges to ML from model building, model deployment, and enterprise stakeholder perspectives. We have anchored these challenges ultimately to the end goal of ML – providing business value. Finally, we briefly introduced H2O at scale components used by enterprises to overcome these challenges and achieve business value. </p>
			<p>In the next chapter, we'll start to understand these components in greater technical detail so that we can start writing code and doing data science.</p>
		</div>
	</body></html>