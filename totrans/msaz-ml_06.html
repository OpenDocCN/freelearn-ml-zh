<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Regression Models"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Regression Models</h1></div></div></div><p>Finally we are going to start with the machine learning algorithms. You learned earlier that primarily, there are two kinds of supervised machine learning algorithms and regression is one of them. Before you start with different regression algorithms and techniques available with ML Studio, we will try to know more about regression analysis and why it is used.</p><div class="section" title="Understanding regression algorithms"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec32"/>Understanding regression algorithms</h1></div></div></div><p>Consider that you <a id="id188" class="indexterm"/>live in a locality and you've got the following dataset that has all the transactions of different properties sold in the area along with the property details. Let's take a look at the following table:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Property Type</p>
</th><th style="text-align: left" valign="bottom">
<p>Area (Sq feet)</p>
</th><th style="text-align: left" valign="bottom">
<p>Price ($)</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>D</p>
</td><td style="text-align: left" valign="top">
<p>2000</p>
</td><td style="text-align: left" valign="top">
<p>500,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>T</p>
</td><td style="text-align: left" valign="top">
<p>1500</p>
</td><td style="text-align: left" valign="top">
<p>200,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>F</p>
</td><td style="text-align: left" valign="top">
<p>1400</p>
</td><td style="text-align: left" valign="top">
<p>300,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>T</p>
</td><td style="text-align: left" valign="top">
<p>1000</p>
</td><td style="text-align: left" valign="top">
<p>100,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>F</p>
</td><td style="text-align: left" valign="top">
<p>2000</p>
</td><td style="text-align: left" valign="top">
<p>450,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>S</p>
</td><td style="text-align: left" valign="top">
<p>1800</p>
</td><td style="text-align: left" valign="top">
<p>350,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>D</p>
</td><td style="text-align: left" valign="top">
<p>2500</p>
</td><td style="text-align: left" valign="top">
<p>700,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>F</p>
</td><td style="text-align: left" valign="top">
<p>1500</p>
</td><td style="text-align: left" valign="top">
<p>350,000</p>
</td></tr></tbody></table></div><p>Here, <span class="strong"><strong>D</strong></span> means detached, <span class="strong"><strong>S</strong></span> means semi detached, <span class="strong"><strong>T</strong></span> means terraced, and <span class="strong"><strong>F</strong></span> means flats/maisonettes.</p><p>Now, a flat is going to be available on the market of the size; 1,800 square feet. You need to predict the price at which it will be sold. This is a regression problem because you need to predict a number for the target variable. Here, the property price is the target variable and the <span class="strong"><strong>Property Type</strong></span> and <span class="strong"><strong>Area</strong></span> are the two features or dependent variables. A target variable in machine learning is also known as a label.</p><p>You need to come up with a model that will take the value for the Property Type and Area and output the price. Consider the model as a mathematical function <span class="emphasis"><em>f(Property Type, Area) = Predicted Price</em></span>.</p><p>The actual price at which <a id="id189" class="indexterm"/>the property will be sold may or may not be the same as the predicted price. The difference between the actual price and the predicted price is the error. While building a prediction model, you should try to minimize the error so that the predicted value can be as close to the actual value as possible.</p><p>Extending the preceding example, you have supposedly built a model and predicted the value for a 1800 square feet flat using the following formula:</p><p>f(F, 1800) = $400,000</p><p>So, $400,000 is the predicted value, and consider that $410,000 is the actual value at which the property was sold. Then, the error would be <span class="emphasis"><em>Error = $410,000 - $400,000 = $10,000</em></span>.</p></div></div>
<div class="section" title="Train, score, and evaluate"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec33"/>Train, score, and evaluate</h1></div></div></div><p>Before <a id="id190" class="indexterm"/>making the prediction, you need to train an algorithm with the <a id="id191" class="indexterm"/>example data or training dataset where the target value or the <a id="id192" class="indexterm"/>label is known. After training the model, you can make a prediction with the trained model.</p><div class="mediaobject"><img src="graphics/0792EN_06_15.jpg" alt="Train, score, and evaluate"/></div><p>Continuing with the preceding illustration, the trained model may be considered as the mathematical function <code class="literal">f</code> to make a prediction.</p><p>Usually, when you have to build a model from a given dataset, you split the dataset into two sets and use one as a training dataset and the other as a test dataset. After the model is trained with the training data, you use the test dataset to see how the model is performing, that is, how many errors it has.</p><p>After the model is <a id="id193" class="indexterm"/>trained, you can use the test data to make a prediction or to score. In scoring, the feature values are used and then the target value is predicted. At this point, you are not sure how your model is performing. You need to evaluate it to find out its performance. During evaluation, you take the scored value and the actual value, which is known as you have split your dataset into train and test.</p><p>Continuing with the previous illustration, while scoring, you find out that the predicted price of a 1800 square feet flat will be $400,000 and during evaluation, you discover that there is an error of $10,000.</p><p>Overall, during experimentation you can follow the given steps:</p><div class="mediaobject"><img src="graphics/0792EN_06_16.jpg" alt="Train, score, and evaluate"/></div><p>ML Studio provides <a id="id194" class="indexterm"/>different statistics to measure error and performance of your regression model. It also comes with a set of algorithms to experiment with your dataset.</p><div class="section" title="The test and train dataset"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec42"/>The test and train dataset</h2></div></div></div><p>Usually, you train an <a id="id195" class="indexterm"/>algorithm with your <span class="strong"><strong>Train</strong></span> dataset and validate or test your model with a test dataset. In practice, most of the time, you are given one dataset. So, you may <a id="id196" class="indexterm"/>need to split the given dataset into two and use one as a train and the other as test. Usually, the training set consists of bigger parts and the test set consists of smaller parts, say 70-30 or 80-20. Ideally, while splitting the original dataset, it is split randomly. The <span class="strong"><strong>Split</strong></span> module in ML Studio solves the purpose well.</p></div><div class="section" title="Evaluating"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec43"/>Evaluating</h2></div></div></div><p>Consider the previous <a id="id197" class="indexterm"/>illustration of the dataset (refer to table 6.1) as a train <a id="id198" class="indexterm"/>dataset and the following as a test dataset:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Property type</p>
</th><th style="text-align: left" valign="bottom">
<p>Area (Sq feet)</p>
</th><th style="text-align: left" valign="bottom">
<p>Actual Price ($)</p>
</th><th style="text-align: left" valign="bottom">
<p>Predicted price ($)</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>F</p>
</td><td style="text-align: left" valign="top">
<p>1800</p>
</td><td style="text-align: left" valign="top">
<p>400,000</p>
</td><td style="text-align: left" valign="top">
<p>410,000</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>T</p>
</td><td style="text-align: left" valign="top">
<p>1700</p>
</td><td style="text-align: left" valign="top">
<p>220,000</p>
</td><td style="text-align: left" valign="top">
<p>210,000</p>
</td></tr></tbody></table></div><p>Consider the actual price and predicted/scored price for the first row as <span class="emphasis"><em>y1</em></span> and <span class="emphasis"><em>f1</em></span>, respectively. So, in the preceding table, we can make out that <span class="emphasis"><em>y1 = 400,000</em></span> and <span class="emphasis"><em>f1 = 410,000</em></span>.</p><p>Similarly, we can make <a id="id199" class="indexterm"/>out for the second row that<span class="emphasis"><em> y2 = 220,000</em></span> and <span class="emphasis"><em>f2 = 210,000</em></span>.</p><p>ML Studio provides the <a id="id200" class="indexterm"/>following statistics to measure how a model is performing.</p><div class="section" title="The mean absolute error"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec22"/>The mean absolute error</h3></div></div></div><p>
<span class="strong"><strong>The mean absolute error</strong></span> (<span class="strong"><strong>MAE</strong></span>) is a quantity used to measure how close forecasts or predictions are to the <a id="id201" class="indexterm"/>eventual outcomes. It is calculated as the average of the absolute difference between the actual values and the predicted values. Let's take a look at the following figure:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<div class="mediaobject"><img src="graphics/0792EN_06_17.jpg" alt="The mean absolute error"/></div>
<p>Here <span class="inlinemediaobject"><img src="graphics/0792EN_06_18.jpg" alt="The mean absolute error"/></span> is the prediction and <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The mean absolute error"/></span> is the true value.</p>
</td></tr></tbody></table></div><p>It has the same unit as the original data and it can only be compared between models whose errors are measured in the same units.</p></div><div class="section" title="The root mean squared error"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec23"/>The root mean squared error</h3></div></div></div><p>
<span class="strong"><strong>The root mean </strong></span><a id="id202" class="indexterm"/>
<span class="strong"><strong>squared error</strong></span> (<span class="strong"><strong>RMSE</strong></span>) is calculated by taking the square root of the average of the square of all the errors (which is the difference between the predicted and actual value). Let's take a look at the following figure:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<div class="mediaobject"><img src="graphics/0792EN_06_20.jpg" alt="The root mean squared error"/></div>
<p>Here, <span class="inlinemediaobject"><img src="graphics/0792EN_06_18.jpg" alt="The root mean squared error"/></span> is the prediction and <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The root mean squared error"/></span> is the true value</p>
</td></tr></tbody></table></div><p>It can only be compared between models whose errors are measured in the same units.</p></div><div class="section" title="The relative absolute error"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec24"/>The relative absolute error</h3></div></div></div><p>
<span class="strong"><strong>The relative absolute </strong></span><a id="id203" class="indexterm"/>
<span class="strong"><strong>error</strong></span> (<span class="strong"><strong>RAE</strong></span>) is the average of the absolute error relative to the average of the absolute difference of the mean of the actual value and actual values. Let's take a look at the following figure:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<div class="mediaobject"><img src="graphics/0792EN_06_21.jpg" alt="The relative absolute error"/></div>
<p>Here <span class="inlinemediaobject"><img src="graphics/0792EN_06_18.jpg" alt="The relative absolute error"/></span> is the prediction, <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The relative absolute error"/></span> is the actual or the true value and <span class="inlinemediaobject"><img src="graphics/0792EN_06_22.jpg" alt="The relative absolute error"/></span> is the mean of <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The relative absolute error"/></span>.</p>
</td></tr></tbody></table></div><p>It can be compared between models whose errors are measured in different units.</p></div><div class="section" title="The relative squared error"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec25"/>The relative squared error</h3></div></div></div><p>
<span class="strong"><strong>The relative </strong></span><a id="id204" class="indexterm"/>
<span class="strong"><strong>squared error</strong></span> (<span class="strong"><strong>RSE</strong></span>) is the average of the squared difference of the predicted value and the actual value relative to the average of the squared difference, average of the actual value and actual values.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<div class="mediaobject"><img src="graphics/0792EN_06_23.jpg" alt="The relative squared error"/></div>
<p>Here <span class="inlinemediaobject"><img src="graphics/0792EN_06_18.jpg" alt="The relative squared error"/></span> is the prediction, <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The relative squared error"/></span> is the true value, and <span class="inlinemediaobject"><img src="graphics/0792EN_06_22.jpg" alt="The relative squared error"/></span> is the mean of <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The relative squared error"/></span>.</p>
</td></tr></tbody></table></div><p>It can be compared <a id="id205" class="indexterm"/>between models whose errors are measured in different units.</p></div><div class="section" title="The coefficient of determination"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec26"/>The coefficient of determination</h3></div></div></div><p>The coefficient <a id="id206" class="indexterm"/>of determination <span class="emphasis"><em>R2</em></span> summarizes the explanatory power of the regression model. If the regression model is perfect, though not practical, <span class="emphasis"><em>R2</em></span> is 1.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<div class="mediaobject"><img src="graphics/0792EN_06_24.jpg" alt="The coefficient of determination"/></div>
<p>Here <span class="inlinemediaobject"><img src="graphics/0792EN_06_18.jpg" alt="The coefficient of determination"/></span> is the prediction, <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The coefficient of determination"/></span> is the true value, and <span class="inlinemediaobject"><img src="graphics/0792EN_06_22.jpg" alt="The coefficient of determination"/></span> is the mean of <span class="inlinemediaobject"><img src="graphics/0792EN_06_19.jpg" alt="The coefficient of determination"/></span>
</p>
</td></tr></tbody></table></div><p>The coefficient of determination can also be interpreted as the percent of the data that fits in the model. For example, if <span class="emphasis"><em>R2 = 0.7950</em></span>, then 79 percent of the total variation in <span class="emphasis"><em>y</em></span> can be explained by the linear relationship between features and <span class="emphasis"><em>y</em></span>, the response variable (or the target variable).</p><p>So, for your model, the closer <span class="emphasis"><em>R2</em></span> is to 1, the better it is. For all other the error statistics, the less the value, the better it is.</p></div></div></div>
<div class="section" title="Linear regression"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec34"/>Linear regression</h1></div></div></div><p>
<span class="strong"><strong>Linear regression</strong></span> is <a id="id207" class="indexterm"/>one of the regression algorithms available in ML Studio. It tries to fit a line to the dataset. It is a popular algorithm and probably the oldest regression algorithm. We will use it to train the model to make prediction for one of the sample datasets available: automobile price data (Raw). This dataset is about automobiles distinguished by their make and model and other features. It also includes price. More <a id="id208" class="indexterm"/>information on the dataset can be found at <a class="ulink" href="https://archive.ics.uci.edu/ml/datasets/Automobile">https://archive.ics.uci.edu/ml/datasets/Automobile</a>.</p><p>We will use price as a label or the target variable here. So, given the automobile features, you need to predict the price of the automobile.</p><p>Go to ML Studio and create a new experiment. Then, expand <span class="strong"><strong>Saved Datasets</strong></span> in the modules palette to the left of the screen. Drag the <span class="strong"><strong>Automobile price data (Raw)</strong></span> module to the canvas.</p><p>Then, expand <span class="strong"><strong>Data Transformation</strong></span> and then <span class="strong"><strong>Sample and Split</strong></span> in the modules palette and drag the <span class="strong"><strong>Split</strong></span> module to the canvas. Set the <span class="strong"><strong>Fraction of rows</strong></span> parameter in the first output dataset to <span class="strong"><strong>0.8</strong></span> and leave the others to their default values. You are splitting the dataset so that 80 percent of the data will be used to train and the other 20 percent will be used for test.</p><p>After you are ready with your train and test data, drag the <span class="strong"><strong>Train</strong></span> module to canvas. Type <code class="literal">train</code> in the search box in the modules palette to the left of the screen and when the <span class="strong"><strong>Train</strong></span> module appears, drag it to the canvas. Then, join the first output of the <span class="strong"><strong>Split</strong></span> module to the second input of the <span class="strong"><strong>Train</strong></span> module. Now, you need to select the column of the dataset that will be your target variable, or for which you will train a model to make a prediction. In our case, <span class="emphasis"><em>price</em></span> is the target variable or label for which you are going to make a prediction.</p><p>Select the <span class="strong"><strong>Train</strong></span> module by clicking on it, expand the properties pane to the right of the screen, and click on the <span class="strong"><strong>Launch column selector</strong></span> option.</p><div class="mediaobject"><img src="graphics/0792EN_06_01.jpg" alt="Linear regression"/></div><p>Then, the pop up to select a column will appear. Type <code class="literal">price</code> in the textbox to the right of the screen and click on the <a id="id209" class="indexterm"/>tickbox to select the column.</p><div class="mediaobject"><img src="graphics/0792EN_06_02.jpg" alt="Linear regression"/></div><p>Likewise, drag the <span class="strong"><strong>Linear Regression</strong></span> module to the canvas. Type <code class="literal">linear</code> in the search box in the modules palette to the left of the screen and when the module appears, drag it to the canvas.</p><p>Then, select the <span class="strong"><strong>Linear Regression</strong></span> module and leave the property values at default. Use <span class="strong"><strong>0</strong></span> for the <span class="strong"><strong>Random number seed</strong></span> option. The <span class="strong"><strong>Random number seed</strong></span> option is used to generate a random number that is used for reproducible results.</p><p>Now, join the output of the <span class="strong"><strong>Linear Regression</strong></span> module to the first input port of the <span class="strong"><strong>Train</strong></span> module. It should look like something similar to the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_06_03.jpg" alt="Linear regression"/></div><p>Next, drag the <span class="strong"><strong>Score Model</strong></span> and the <span class="strong"><strong>Evaluate Model</strong></span> modules to the canvas.</p><p>The <span class="strong"><strong>Score Model</strong></span> will generate the predicted price value for the test dataset using the trained algorithm. So, it takes two inputs: first, the trained model and second, the test dataset. It generates the scored dataset that contains the predicted values. The <span class="strong"><strong>Evaluate Model</strong></span> takes a scored <a id="id210" class="indexterm"/>dataset and generates an evaluation matrix. It can also take two scored datasets so that you can compare two models side by side.</p><p>Connect the output of the <span class="strong"><strong>Train Model</strong></span> to the first input of the <span class="strong"><strong>Score Model</strong></span> and the second output of the <span class="strong"><strong>Split</strong></span> module to the second input. Then, connect the output of the <span class="strong"><strong>Score Model</strong></span> to the first input of the <span class="strong"><strong>Evaluate Model</strong></span>.</p><p>The complete model may look as follows. Now, click on the <span class="strong"><strong>Run</strong></span> button to run the experiment.</p><div class="mediaobject"><img src="graphics/0792EN_06_04.jpg" alt="Linear regression"/></div><p>After the run is complete <a id="id211" class="indexterm"/>and you see the green tick mark on all the module boxes, you can see the evaluation matrix to find out how your model is performing. To do so, right-click on the output of the <span class="strong"><strong>Evaluate Model</strong></span> and select the <span class="strong"><strong>Visualize</strong></span> option by clicking on it.</p><div class="mediaobject"><img src="graphics/0792EN_06_05.jpg" alt="Linear regression"/></div><p>The following popup displays the <span class="strong"><strong>Evaluation Results</strong></span> graph, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_06_06.jpg" alt="Linear regression"/></div><p>As you can see, <span class="strong"><strong>Coefficient of </strong></span><a id="id212" class="indexterm"/>
<span class="strong"><strong>Determination</strong></span> is <span class="strong"><strong>0.941703</strong></span>, which is decent and the model seems to be performing well.</p><p>If you had noticed, you have trained this linear regression model using the Ordinary Least Squared method. You could also have used the Online Gradient Descent with proper parameters, such as the learning rate and number of epochs (iterations). While working with a large dataset, this method can be quite useful as it scales very well. However, working with a few thousand data points in a dataset's Ordinary Least Squared method might be the choice for you as it is simple and easy to train (with a few parameters to choose from).</p><p>To keep it simple, in the preceding and following illustrations in this chapter, we have started modeling without initial <a id="id213" class="indexterm"/>data preparation, such as removing missing values or choosing the right set of columns or features. In practice, you should always do initial data preparation before training with a dataset. Again, some algorithms require data to be in the proper format to generate the desired result.</p></div>
<div class="section" title="Optimizing parameters for a learner &#x2013; the sweep parameters module"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec35"/>Optimizing parameters for a learner – the sweep parameters module</h1></div></div></div><p>To successfully <a id="id214" class="indexterm"/>train a model, you need to come up with the <a id="id215" class="indexterm"/>right set of property values for an algorithm. Most of the time, doing this is not an easy task. First, you need to have a clear understanding of the algorithm and the mathematics behind it. Second, you have to run an experiment many times, trying out many combinations of parameters for an algorithm. At times, this can be very time consuming and daunting.</p><p>For example, in the same preceding example, what should be the right value for L2 regularization weight? It is used to reduce overfitting of the model. A model overfits when it performs well on a training dataset, but performs badly on any new dataset. By reducing overfitting, you generalize the model. However, the problem here is that you have to manually adjust this L2 regularization weight, which can be done by trying different values, running the experiment many times, and evaluating its performance in each run.</p><p>ML Studio comes with a sweet solution to this in the form of the <span class="strong"><strong>Sweep Parameters</strong></span> module. Instead of a <span class="strong"><strong>Train Model</strong></span> module, you can use the <span class="strong"><strong>Train Model</strong></span> module to generate a trained model optimized with the right set of parameters or property values. The following screenshot describes its inputs and outputs:</p><div class="mediaobject"><img src="graphics/0792EN_06_07.jpg" alt="Optimizing parameters for a learner – the sweep parameters module"/></div><p>You need to specify a parameter sweeping mode as a parameter of this module. You have two options to specify the parameter of sweeping mode, they are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Entire grid</strong></span>: This option is useful for cases where you don't know what the best parameter settings might be and want to try many parameters. It loops over a grid predefined by the system to try different combinations and identify the best learner.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Random Sweep</strong></span>: Alternatively, you can choose this option and specify the maximum number <a id="id216" class="indexterm"/>of runs that you want the <a id="id217" class="indexterm"/>module to execute. It will randomly select parameter values over a range of a limited number of sample runs. This option is suggested when you want to increase the model's performance using the metrics of your choice and conserve computing resources.</li></ul></div><p>You also need to choose a target or label column along with specifying a value for metric to measure the performance of regression, which can be one of the five evaluation matrices, for example, the root mean squared error. While working on a regression problem, you may ignore the parameter setting for classification.</p><div class="section" title="The decision forest regression"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec44"/>The decision forest regression</h2></div></div></div><p>Decision forest, or random forest as it is widely known, is a very popular algorithm. Internally, it constructs <a id="id218" class="indexterm"/>many decision trees and then ensembles them as a forest. Each decision tree generates a prediction and in the forest, the predicted values of each tree is averaged out. It works well even in the case of noisy data.</p><p>However, to train a decision forest, you need to set the right parameters, for example, the number of decision trees. We will now train a decision forest and optimize its parameters with the <span class="strong"><strong>Sweep Parameters</strong></span> module.</p><p>As in the previous case, create a new experiment and give a name to it. Then, do the same steps and expand <span class="strong"><strong>Saved Datasets</strong></span> in the modules palette to the left of the screen. Drag the <span class="strong"><strong>Automobile price data (Raw)</strong></span> module to the canvas.</p><p>Then, expand <span class="strong"><strong>Data Transformation</strong></span> and <span class="strong"><strong>Sample and Split</strong></span> in the modules palette and drag the <span class="strong"><strong>Split</strong></span> module to the canvas. Set the <span class="strong"><strong>Fraction</strong></span> parameter of the rows in the first output dataset to <span class="strong"><strong>0.8</strong></span> and leave the others to their default values. You are splitting the dataset so that 80 percent of the data will be used for train and the other 20 percent will be used as test.</p><p>Type <code class="literal">Sweep</code> in the search box in the modules palette to the left of the screen and when the <span class="strong"><strong>Sweep Parameters</strong></span> module appears, drag it to the canvas. Then, join the first output of the <span class="strong"><strong>Split</strong></span> module to the second input of the <span class="strong"><strong>Sweep Parameters</strong></span> module and join the second output of the <span class="strong"><strong>Split</strong></span> module to the third input of the <span class="strong"><strong>Sweep Parameters</strong></span> module.</p><p>Now, you need to set the column of the dataset that is your target or label column for which you will train a model to do a prediction. In our case, <span class="strong"><strong>price</strong></span> is the target variable or label for which you are going to make a prediction. Also, set the sweeping mode to <span class="strong"><strong>Entire grid</strong></span> and <span class="strong"><strong>Metric for measuring performance for regression</strong></span> to <span class="strong"><strong>Coefficient of determination</strong></span>.</p><div class="mediaobject"><img src="graphics/0792EN_06_08.jpg" alt="The decision forest regression"/></div><p>Likewise, drag the <span class="strong"><strong>Decision Forest Regression</strong></span> module to the canvas. Type <code class="literal">Decision Forest</code> in the search box in the modules palette to the left of the screen and when the module appears, drag <a id="id219" class="indexterm"/>it to the canvas. Set the <span class="strong"><strong>Resampling method</strong></span> property to <span class="strong"><strong>Bagging</strong></span> and leave the rest with their default values, as you can see in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_06_09.jpg" alt="The decision forest regression"/></div><p>Then, connect the only output of the <span class="strong"><strong>Decision Forest Regression</strong></span> module to the first input of the <span class="strong"><strong>Sweep Parameters</strong></span> module.</p><p>Next, drag the <span class="strong"><strong>Score Model</strong></span> and <span class="strong"><strong>Evaluate Model</strong></span> to the canvas. Connect the second output of the <span class="strong"><strong>Sweep Parameters</strong></span> module to the first input of the <span class="strong"><strong>Score Model</strong></span> and connect the second output of the <span class="strong"><strong>Split</strong></span> module to the second input of the <span class="strong"><strong>Score Model</strong></span>. Then, connect the <a id="id220" class="indexterm"/>output of the <span class="strong"><strong>Score Model</strong></span> to the first input of the <span class="strong"><strong>Evaluate Model</strong></span>.</p><div class="mediaobject"><img src="graphics/0792EN_06_10.jpg" alt="The decision forest regression"/></div><p>Now, run the experiment and after completion, visualize the output of the <span class="strong"><strong>Evaluate Model</strong></span> to know the performance of the model.</p><p>If you are interested to know about the optimum parameters for the <span class="strong"><strong>Decision Forest Regression</strong></span> module obtained by the <span class="strong"><strong>Sweep Parameters</strong></span> module, then right-click on the<span class="strong"><strong> Sweep Parameter</strong></span> module's output port and click on <span class="strong"><strong>Visualize</strong></span>. In the preceding case, it looked as follows:</p><div class="mediaobject"><img src="graphics/0792EN_06_11.jpg" alt="The decision forest regression"/></div></div></div>
<div class="section" title="The train neural network regression &#x2013; do it yourself"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec36"/>The train neural network regression – do it yourself</h1></div></div></div><p>Neural network is a kind <a id="id221" class="indexterm"/>of machine learning algorithm inspired by the computational models of a human brain. For regression, ML Studio comes with the Neural Network Regression module. You can train this using the Sweep Parameters module. First, try to train it without the Sweep Parameters module (with the Train module) with default parameters for Neural Network Regression and then train it with the Sweep Parameters module. Note the improvement in performance of the model.</p></div>
<div class="section" title="Comparing models with the evaluate model"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec37"/>Comparing models with the evaluate model</h1></div></div></div><p>With the <span class="strong"><strong>Evaluate </strong></span><a id="id222" class="indexterm"/>
<span class="strong"><strong>Model</strong></span>, you can also compare two models side by <a id="id223" class="indexterm"/>side in the same experiment. The two input ports of the module can take the output from the two Score modules and generate the evaluation matrix to compare the output from the two inputs that the module accepts. As shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_06_12.jpg" alt="Comparing models with the evaluate model"/></div><div class="section" title="Comparing models – the neural network and boosted decision tree"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec45"/>Comparing models – the neural network and boosted decision tree</h2></div></div></div><p>The <a id="id224" class="indexterm"/>
<span class="strong"><strong>Boosted Decision Tree Regression</strong></span> module is another regression algorithm that comes with ML Studio. It is an ensemble model like decision forest, but is a bit different.</p><p>Here, we will use<a id="id225" class="indexterm"/> both the <span class="strong"><strong>Boosted Decision Tree Regression</strong></span> and <span class="strong"><strong>Neural Network Regression</strong></span> modules in the same experiment and compare both using the <span class="strong"><strong>Evaluate Model</strong></span>. We will use the <span class="strong"><strong>Sweep Parameters</strong></span> module in both cases, to train the algorithm.</p><p>Create a new experiment and drag the same sample dataset—the <span class="strong"><strong>Automobile price data (Raw)</strong></span> module. Then, use the two algorithms with the same training dataset (80 percent) and also score using the other 20 percent. The constructed model may look like the following:</p><div class="mediaobject"><img src="graphics/0792EN_06_13.jpg" alt="Comparing models – the neural network and boosted decision tree"/></div><p>While the <a id="id226" class="indexterm"/>connections are straight-forward and intuitive, the connection for the <span class="strong"><strong>Sweep Parameters</strong></span> module for both the cases might be confusing. Note that the inputs with the red circles are coming from the same output of the <span class="strong"><strong>Split</strong></span> module also marked with a red circle. So, the two <span class="strong"><strong>Sweep Parameters</strong></span> <a id="id227" class="indexterm"/>modules accept the same training data, but different algorithms to train with. Also, note the input ports marked with the blue circle coming from the same output port of the <span class="strong"><strong>Split</strong></span> module also marked with a blue circle.</p><p>After you run the experiment successfully, all the boxes will have a green tick mark. Then, right-click on the output port of the <span class="strong"><strong>Evaluate Model</strong></span> to find the comparison metrics for both the algorithms. Let's take a look at the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_06_14.jpg" alt="Comparing models – the neural network and boosted decision tree"/></div><p>The first row in the preceding screenshot shows the metrics for the model connected to the first input of the <span class="strong"><strong>Evaluate Model</strong></span> and in this case, it shows the <span class="strong"><strong>Neural Network Regression</strong></span> module and the second row for the second model: the <span class="strong"><strong>Boosted Decision Tree Regression</strong></span> module. You know that for better performing models, error values should be as less as possible and the coefficient of determination should be as close as possible to 1, which means that the higher it is the better. As you will find, the Boosted Decision Tree outperforms the Neural Network for this dataset on every evaluation statistic, for example, the <span class="strong"><strong>Coefficient of Determination</strong></span> is <span class="strong"><strong>0.963765</strong></span> versus <span class="strong"><strong>0.444975</strong></span>. Similarly, the relative absolute error is much less for the Boosted Decision Tree as compared to <a id="id228" class="indexterm"/>others. If you have to choose between <a id="id229" class="indexterm"/>these two models, then in this case, you will naturally choose the Boosted Decision Tree. Because we have not set a random number seed, your results (figures) may be slightly different; however, overall, it doesn't make any difference.</p><p>Here, you compared only two models. In practice, you can and should compare as many models as possible on the same problem to find out the best performing model among them.</p></div></div>
<div class="section" title="Other regression algorithms"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec38"/>Other regression algorithms</h1></div></div></div><p>Azure ML comes with a bunch of popular regression algorithms. This section briefly describes other algorithms available (at the time of writing of this book) that we have not discussed so far:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Bayesian Linear Regression Model</strong></span>: This model uses Bayesian Inference <a id="id230" class="indexterm"/>for <a id="id231" class="indexterm"/>regression. This may not be difficult to train as long as you get the regularization parameter right, which may fit a value such as 0.1, 0.2, and so on.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Ordinal Regression Model</strong></span>: You use this when you have to train a model for a <a id="id232" class="indexterm"/>dataset in which the <a id="id233" class="indexterm"/>labels or target values have a natural ordering or ranking among them.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Poisson Regression</strong></span>: It is a special type of regression analysis. It is typically used for <a id="id234" class="indexterm"/>model counts, for example, modeling the number of cold and flu cases associated with airplane flights <a id="id235" class="indexterm"/>or estimating the number of calls related to an event or promotion and so on.</li></ul></div></div>
<div class="section" title="No free lunch"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec39"/>No free lunch</h1></div></div></div><p>The <span class="emphasis"><em>No Free Lunch</em></span> <a id="id236" class="indexterm"/>theorem is related to machine learning and it popularly states the limitation of any machine learning model. As per the theorem, there is no model that fits the best for every problem. So, one model that fits well for one problem in a domain may not hold good for another. So in practice ,whenever you are solving a problem, you need to try out different models and experiment with your dataset to choose the best one. This is especially true for supervised learning; you use the <span class="strong"><strong>Evaluate Model</strong></span> module in ML Studio to assess the predictive accuracies of multiple models of varying complexity to find the best model. A model that works well could also be trained by multiple algorithms, for example, linear regression in ML Studio can be trained by Ordinary Least Square or Online Gradient Descent.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec40"/>Summary</h1></div></div></div><p>You started the chapter by understanding predictive analysis with regression and explored the concepts of training, testing, and evaluating a regression model. You then proceeded to carry on building experiments with different regression models, such as linear regression, decision forest, neural network, and boosted decision trees inside ML Studio. You learned how to score and evaluate a model after training. You also learned how to optimize different parameters for a learning algorithm with the Sweep Parameters module. The No Free Lunch theorem teaches us not to rely on any particular algorithm for every kind of problem, so in ML Studio you should train and evaluate the performance of different models before finalizing a single one.</p><p>In the next chapter, you will explore another kind of unsupervised learning called classification and you will explore the different algorithms available with ML Studio.</p></div></body></html>