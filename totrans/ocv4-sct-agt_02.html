<html><head></head><body>
        

                            
                    <h1 class="header-title">Preparing for the Mission</h1>
                
            
            
                
<p>"Q: I've been saying for years, sir, that our special equipment is obsolete. And now, computer analysis reveals an entirely new approach: miniaturization."<br/>
                                                                                    – On Her Majesty's Secret Service (1969)</p>
<p>James Bond is not a pedestrian. He cruises in a submarine car; he straps on a rocket belt; and, oh, how he skis, how he skis! He always has the latest stuff, and he is never afraid to put a dent in it, much to the dismay of Q, the engineer.</p>
<p>As software developers in the 2010s, we have witnessed an explosion of the adoption of new platforms. Under one family's roof, we might find a mix of Windows, Mac, iOS, and Android devices. Mom and Dad's workplaces provide different platforms. The kids have three game consoles, or five, if you count the mobile versions. The toddler has a LeapFrog learning tablet. Smart glasses are becoming more affordable.</p>
<p>We must not be afraid to try new platforms and consider new ways to combine them. After all, our users do.</p>
<p>This book embraces multiplatform development. It presents weird and wonderful applications that we can deploy in unexpected places. It uses several of the computer's senses, but especially computer vision, to breathe new life into the humdrum, heterogeneous clutter of devices that surrounds us.</p>
<p>Before Agent 007 runs amok with the gadgets, he is obligated to listen to Q's briefing. This chapter will performs Q's role. It is the setup chapter.</p>
<p>By the end of this chapter, you will have obtained all the tools to develop OpenCV applications in Python for Windows, Mac, or Linux, and in Java for Android. You will also be the proud new user of a Raspberry Pi single-board computer. (This additional hardware is optional.) You will even know a bit about Unity, a game engine into which we can integrate OpenCV. Specifically, this chapter will cover the following approaches to setting up a development environment:</p>
<ul>
<li>Setting up Python and OpenCV on Windows. Optionally, this will include configuring and building OpenCV from a source with CMake and Visual Studio.</li>
<li>Setting up Python and OpenCV on Mac. This will include using either MacPorts or Homebrew as a package manager.</li>
<li>Setting up Python and OpenCV on Debian Jessie or one of its derivatives, such as Raspbian, Ubuntu, or Linux Mint. This will include using the <strong>Advanced Package Tool</strong> (<strong>APT</strong>) package manager. Optionally, it will also include configuring and building OpenCV from a source with CMake and GCC.</li>
<li>Setting up Python and OpenCV on Fedora or one of its derivatives, such as <strong>Red Hat Enterprise Linux</strong> (<strong>RHEL</strong>) or CentOS. This will include using the yum package manager.</li>
<li>Setting up Python and OpenCV on openSUSE. This will include using the yum package manager.</li>
<li>Setting up Android Studio and OpenCV's Android libraries on Windows, Mac, or Linux.</li>
<li>Setting up Unity and OpenCV on Windows or Mac.</li>
<li>Setting up a Raspberry Pi.</li>
</ul>
<p>If you find yourself a bit daunted by the extent of this setup chapter, be reassured that not all of the tools are required, and no single project uses all of them in combination. Although Q and I live for the big event of setting up multiple technologies at once, you can just skim this chapter and refer back to it later when the tools become useful, one by one, in our projects.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>This is the setup chapter. There are no particular software prerequisites at the outset; we will set up everything as we go along.</p>
<p>Basic instructions for running Python code are covered in <a href="c44b1aaa-fe12-4054-85fb-37d584f15d3b.xhtml">Appendix C</a>, <em>Running with Snakes (or, First Steps with Python)</em>. After we set up a Python environment with OpenCV, you may want to refer to this appendix so that you know how to minimally test the environment.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a development machine</h1>
                
            
            
                
<p>We can develop our OpenCV applications on a desktop, a notebook, or even the humble Raspberry Pi (covered later, in the <em>Setting up a Raspberry Pi</em> section). Most of our apps have a memory footprint of less than 128 MB, so they can still run (albeit slowly) on old or low-powered machines. To save time, develop on your fastest machine first and test on slower machines later.</p>
<p>This book assumes that you have one of the following operating systems on your development machine:</p>
<ul>
<li>Windows 7 SP 1, or a later version.</li>
<li>Mac OS 10.7 (Lion), or a later version.</li>
<li>Debian Jessie, a later version, or a derivative such as the following:
<ul>
<li>Raspbian 2015-09-25, or a later version</li>
</ul>
<ul>
<li>Ubuntu 14.04, or a later version</li>
<li>Linux Mint 17, or a later version</li>
</ul>
</li>
<li>Fedora 28, a later version, or a derivative such as the following:
<ul>
<li>RHEL 8, or a later version</li>
<li>CentOS 8, or a later version</li>
</ul>
</li>
<li>openSUSE Leap 42.3, openSUSE Leap 15.0, or a later version; openSUSE Tumbleweed, or a derivative.</li>
</ul>
<p>Other Unix-like systems might also work, but they will not be covered in this book.</p>
<p>You should have a USB webcam and any necessary drivers. Most webcams come with instructions for installing drivers on Windows and Mac. Linux distributions typically include the <strong>USB Video Class</strong> (<strong>UVC</strong>) Linux driver, which supports many webcams, listed at <a href="http://www.ideasonboard.org/uvc/#devices">http://www.ideasonboard.org/uvc/#devices</a>.</p>
<p>We are going to set up the following components:</p>
<ul>
<li>On Mac, a third-party package manager to help us install libraries and their dependencies; we will use either MacPorts or Homebrew.</li>
<li>A Python development environment—at the time of writing this book, OpenCV supports Python 2.7, 3.4, 3.5, 3.6, and 3.7. The Python code in this book supports all of these versions. As part of the Python development environment, we will use Python's package manager, pip.</li>
<li>Popular Python libraries, such as NumPy (for numeric functions), SciPy (for numeric and scientific functions), Requests (for web requests), and wxPython (for cross-platform GUIs).</li>
<li>PyInstaller, a cross-platform tool for bundling Python scripts, libraries, and data as redistributable apps, such that user machines do not require installations of Python, OpenCV, and other libraries. For this book's purposes, building redistributables of Python projects is an optional topic. We will cover the basics in <a href="4ec4e82a-b63d-4fc1-bf3b-47c653c25a79.xhtml">Chapter 2</a>,<em> Searching for Luxury Accommodations Worldwide,</em> but you might need to do your own testing and debugging, as PyInstaller (like other Python bundling tools) does not show entirely consistent behavior across operating systems, Python versions, and library versions. It is not well supported on Raspberry Pi or other ARM devices.</li>
<li>Optionally, we can use a C++ development environment to enable us to build OpenCV from a source. On Windows, we use Visual Studio 2015 or later. On Mac, we use Xcode. On Linux, we use GCC, which comes as standard.</li>
<li>A build of OpenCV and <kbd>opencv_contrib</kbd> (a set of extra OpenCV modules) with Python support, plus optimizations for certain desktop hardware. At the time of writing this book, OpenCV 4.0.x is the latest stable branch, and our instructions are tailored for this branch. However, generally, the code in this book also works with the previous stable branch, OpenCV 3.4.x, which is more widely available from package managers for users who prefer a prepackaged build.</li>
<li>Another build of OpenCV with Java support, plus optimizations for certain Android hardware. At the time of writing, OpenCV 4.0.1 is the most recent release.</li>
<li>An Android development environment, including Android Studio and Android SDK.</li>
<li>On 64-bit Windows or Mac, a three-dimensional game engine called <strong>Unity</strong>.</li>
</ul>
<p>Android Studio has a big memory footprint. Even if you want to use Raspberry Pi for developing desktop and Pi apps, use something with more RAM for developing Android apps.</p>
<p>Let's break this setup down into three sets of platform dependent steps for a Python and OpenCV environment, plus a set of platform independent steps for an Android Studio and OpenCV environment, and another set of platform independent steps for a Unity and OpenCV environment.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Python and OpenCV on Windows</h1>
                
            
            
                
<p>On Windows, we have the option of setting up a 32-bit development environment (to make apps that are compatible with both 32-bit and 64-bit Windows) or a 64-bit development environment (to make optimized apps that are only compatible with 64-bit Windows). OpenCV is available in 32-bit and 64-bit versions.</p>
<p>We also have a choice of either using binary installers or compiling OpenCV from source. For our Windows apps in this book, the binary installers provide everything we need. However, we also discuss the option of compiling from source because it enables us to configure additional features, which may be relevant to your future work or to our projects in other books.</p>
<p>Regardless of our approach to obtaining OpenCV, we need a general-purpose Python development environment. We will set up this environment using a binary installer. The installers for Python are available from <a href="http://www.python.org/getit/">http://www.python.org/getit/</a>. Download and run the latest revision of Python 3.7, in either the 32-bit variant or the 64-bit variant.</p>
<p>To make Python scripts run using our new Python 3.7 installation by default, let's edit the system's Path variable and append <kbd>;C:\Python3.7</kbd> (assuming Python 3.7 is installed in the default location). Remove any previous Python paths, such as <kbd>;C:\Python2.7</kbd>. Log out and log back in (or reboot).</p>
<p class="mce-root">Python comes with a package manager called <kbd>pip</kbd>, which simplifies the task of installing Python modules and their dependencies. Open Command Prompt and run the following command to install <kbd>numpy</kbd>, <kbd>scipy</kbd>, <kbd>requests</kbd>, <kbd>wxPython</kbd>, and <kbd>pyinstaller</kbd>:</p>
<pre class="mce-root"><strong>&gt;</strong> <strong>pip install --user numpy scipy requests wxPython pyinstaller</strong></pre>
<p>Now, we have a choice. We can either install the binaries of <kbd>OpenCV</kbd> and <kbd>opencv_contrib</kbd> as a prebuilt Python module, or we can build this module from source. To install a prebuilt module, simply run the following command:</p>
<pre><strong>&gt;</strong> <strong>pip install --user opencv-contrib-python</strong></pre>
<p>Alternatively, to build <kbd>OpenCV</kbd> and <kbd>opencv_contrib</kbd> from source, follow the instructions in the section <em>Building OpenCV on Windows with CMake and Visual Studio</em>, as follow.</p>
<p>After either installing a prebuilt <kbd>OpenCV</kbd> and <kbd>opencv_contrib</kbd> module or building it from source, we will have everything we need to develop OpenCV applications for Windows. To develop for Android, we need to set up Android Studio as described in the section <em>Setting up Android Studio</em>, <em>and OpenCV</em>, later in this chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Building OpenCV on Windows with CMake and Visual Studio</h1>
                
            
            
                
<p>To compile OpenCV from source, we need a general purpose C++ development environment. As our C++ development environment, we will use Visual Studio 2015 or later. Use any installation media you may have purchased, or go to the downloads page at <a href="https://visualstudio.microsoft.com/downloads/">https://visualstudio.microsoft.com/downloads/</a>. Download and run the installer for one of the following:</p>
<ul>
<li>Visual Studio Community 2017, which is free</li>
<li>Any of the paid Visual Studio 2017 versions, which have 30-day free trials</li>
</ul>
<p>If the installer lists optional C++ components, we should opt to install them all. After the installer runs to completion, reboot.</p>
<p>OpenCV uses a set of build tools called <strong>CMake</strong>, which we must install. Optionally, we may install several third-party libraries in order to enable extra features in OpenCV. As an example, let's install Intel <strong>Thread Building Blocks</strong> (<strong>TBB</strong>), which OpenCV can leverage in order to optimize some functions for multicore CPUs. After installing TBB, we will configure and build OpenCV. Lastly, we will ensure that our C++ and Python environments can find our build of OpenCV.</p>
<p>Here are the detailed steps:</p>
<ol>
<li>Download and install the latest stable version of CMake from <a href="https://cmake.org/download/">https://cmake.org/download/</a>. CMake 3 or a newer version is required. Even if we are using 64-bit libraries and compilers, 32-bit CMake is compatible. When the installer asks about modifying PATH, select either Add CMake to the system PATH for all users or Add CMake to the system PATH for current user.</li>
<li>If your system uses a proxy server to access the internet, define two environment variables, <kbd>HTTP_PROXY</kbd> and <kbd>HTTPS_PROXY</kbd>, with values equal to the proxy server's URL, such as <kbd>http://myproxy.com:8080</kbd>. This ensures that CMake can use the proxy server to download some additional dependencies for OpenCV. (If in doubt, do not define these environment variables; you are probably not using a proxy server.)</li>
</ol>
<ol start="3">
<li>Download the OpenCV Win pack from <a href="https://opencv.org/releases.html">http://opencv.org/releases.html</a>. (Choose the latest version.) The downloaded file may have an <kbd>.exe</kbd> extension, but actually, it is a self-extracting ZIP. Double-click on the file and, when prompted, enter any destination folder, which we will refer to as <kbd>&lt;opencv_unzip_destination&gt;</kbd>. A subfolder, <kbd>&lt;opencv_unzip_destination&gt;/opencv</kbd>, will be created.</li>
<li>Download <kbd>opencv_contrib</kbd> as a ZIP from <a href="https://github.com/opencv/opencv_contrib/releases">https://github.com/opencv/opencv_contrib/releases</a>. (Choose the latest version.) Unzip it to any destination folder, which we will refer to as <kbd>&lt;opencv_contrib_unzip_destination&gt;</kbd>.</li>
<li>Download the latest stable version of TBB from <a href="https://www.threadingbuildingblocks.org/download">https://www.threadingbuildingblocks.org/download</a>. It includes both 32-bit and 64-bit binaries. Unzip it to any destination, which we will refer to as <kbd>&lt;tbb_unzip_destination&gt;</kbd>.</li>
<li>Open Command Prompt. Create a folder to store our build:</li>
</ol>
<pre style="padding-left: 60px"><strong>&gt;</strong> <strong>mkdir &lt;build_folder&gt;</strong></pre>
<p style="padding-left: 60px">Change directories to the newly created build folder:</p>
<pre style="padding-left: 60px"><strong>&gt;</strong> <strong>cd &lt;build_folder&gt;</strong></pre>
<ol start="7">
<li>Having set up our dependencies, we can now configure OpenCV's build system. To understand all the configuration options, we can read the code in <kbd>&lt;opencv_unzip_destination&gt;/opencv/sources/CMakeLists.txt</kbd>. However, as an example, we will just use the options for a release build that includes Python bindings and multiprocessing through TBB:</li>
</ol>
<ul>
<li style="padding-left: 60px">To create a 32-bit project for Visual Studio 2017, run the following command (but replace the angle brackets and their contents with the actual paths):</li>
</ul>
<pre style="padding-left: 90px"><strong>&gt;</strong> <strong>CALL &lt;tbb_unzip_destination&gt;\bin\tbbvars.bat ia32 vs2017</strong><br/><strong>&gt;</strong> <strong>cmake -DCMAKE_BUILD_TYPE=RELEASE DWITH_OPENGL=ON -DWITH_TBB=ON <br/>-DOPENCV_SKIP_PYTHON_LOADER=ON <br/>-DPYTHON3_LIBRARY=C:/Python37/libs/python37.lib <br/>-DPYTHON3_INCLUDE_DIR=C:/Python37/include -DOPENCV_EXTRA_MODULES_PATH="&lt;opencv_contrib_unzip_destination&gt;/modules" -G "Visual Studio 15 2017" "&lt;opencv_unzip_destination&gt;/opencv/sources"</strong></pre>
<ul>
<li style="padding-left: 60px">Alternatively, to create a 64-bit project for Visual Studio 2017, run the following command (but replace the angle brackets and their contents with the actual paths):</li>
</ul>
<pre style="padding-left: 90px"><strong>&gt;</strong> <strong>CALL &lt;tbb_unzip_destination&gt;\bin\tbbvars.bat intel64 vs2017</strong><br/><strong>&gt;</strong> <strong>cmake -DCMAKE_BUILD_TYPE=RELEASE DWITH_OPENGL=ON -DWITH_TBB=ON <br/>-DOPENCV_SKIP_PYTHON_LOADER=ON <br/>-DPYTHON3_LIBRARY=C:/Python37/libs/python37.lib <br/>-DPYTHON3_INCLUDE_DIR=C:/Python37/include -DOPENCV_EXTRA_MODULES_PATH="&lt;opencv_contrib_unzip_destination&gt;/modules" -G "Visual Studio 15 2017 Win64" "&lt;opencv_unzip_destination&gt;/opencv/sources"</strong></pre>
<ul>
<li style="padding-left: 60px">CMake will produce a report on the dependencies that it did or did not find. OpenCV has many optional dependencies, so do not panic (yet) about missing dependencies. However, if the build does not finish successfully, try installing missing dependencies. (Many are available as prebuilt binaries.) Then, repeat this step.</li>
</ul>
<ol start="8">
<li>Now that our build system is configured, we can compile OpenCV. Open <kbd>&lt;build_folder&gt;/OpenCV.sln</kbd> in Visual Studio. Select the Release configuration and build the solution. (You may get errors if you select another build configuration besides Release, because most Python installations do not include debug libraries.)</li>
<li>We should ensure that our Python installation does not already include some other version of OpenCV. Find and delete any OpenCV files in your Python <kbd>DLLs</kbd> folder and your Python <kbd>site-packages</kbd> folder. For example, the paths to these files might match the <kbd>C:\Python37\DLLs\opencv_*.dll</kbd>, <kbd>C:\Python37\Lib\site-packages\opencv</kbd>, and <kbd>C:\Python37\Lib\site-packages\cv2.pyd</kbd> patterns.</li>
</ol>
<ol start="10">
<li>Finally, we need to install OpenCV to a location where Python and other processes can find it. To do this, right-click on the OpenCV solution's INSTALL project (in the Solution Explorer pane of Visual Studio) and build it. When this build finishes, quit Visual Studio. Edit the system's <kbd>Path</kbd> variable and append <kbd>;&lt;build_folder&gt;\install\x86\vc15\bin</kbd> (for a 32-bit build) or <kbd>;&lt;build_folder&gt;\install\x64\vc15\bin</kbd> (for a 64-bit build), which is the location where the OpenCV DLL files are located. Also, append <kbd>;&lt;tbb_unzip_destination&gt;\lib\ia32\vc14</kbd> (32-bit) or <kbd>;&lt;tbb_unzip_ destination&gt;\lib\intel64\vc14</kbd>(64-bit), which is the location where the TBB DLL files are located. Log out and log back in (or reboot). The OpenCV Python module is located at a path such as <kbd>C:\Python37\Lib\site-packages\cv2.pyd</kbd>. Python will find it there, so you do not need to take any further steps.</li>
</ol>
<div><p>If you are using Visual Studio 2015, replace <kbd>vs2017</kbd> with <kbd>vs2015</kbd> , replace <kbd>Visual Studio 15 2017</kbd> with <kbd>Visual Studio 14 2015</kbd>, and replace <kbd>vc15</kbd> with <kbd>vc14</kbd>. However, for TBB, note that the folder named <kbd>vc14</kbd> contains the DLL files that work for both Visual Studio 2015 and Visual Studio 2017.</p>
</div>
<p>You might want to look at the code samples in <kbd>&lt;opencv_unzip_destination&gt;/opencv/sources/samples/python</kbd>.</p>
<p>At this point, we have everything we need to develop OpenCV applications for Windows. To also develop for Android, we need to set up Android Studio, as described in the <em>Setting up Android Studio and OpenCV</em> section, later in this chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Python and OpenCV on Mac</h1>
                
            
            
                
<p>Mac comes with Python preinstalled. However, the preinstalled Python has been customized by Apple for the system's internal needs. Normally, we should not install any libraries on top of Apple's Python. If we do, our libraries might break during system updates, or worse, they might conflict with preinstalled libraries that the system requires. Instead, we should install standard Python 3.7 and then install our libraries on top of it.</p>
<p>For Mac, there are several possible approaches to obtaining standard Python 3.7 and Python-compatible libraries, such as OpenCV. All approaches ultimately require some components to be compiled from source, using Xcode developer tools. However, depending on the approach we choose, the task of building these components is automated for us by third-party tools in various ways.</p>
<p>Let's begin by setting up Xcode and the Xcode command-line tools, which give us a complete C++ development environment:</p>
<ol>
<li>Download and install Xcode from the Mac App Store or <a href="https://developer.apple.com/xcode/">https://developer.apple.com/xcode/</a>. If the installer provides an option to install command-line tools, select it.</li>
<li>Open Xcode. If a license agreement is presented, accept it.</li>
<li>If command-line tools were not already installed, we must install them now. Go to Xcode | Preferences | <strong>Downloads</strong> and click on the Install button next to command-line tools. Wait for the installation to finish. Then, quit Xcode. Alternatively, if you do not find an option to install command-line tools from inside Xcode, open the Terminal and run the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>xcode-select install </strong></pre>
<p>Now, we will look at ways to automate our builds using MacPorts or Homebrew. These two tools are package managers, which help us resolve dependencies and separate our development libraries from the system libraries.</p>
<p class="TipwithoutheadingPACKT">Generally, I recommend MacPorts. Compared to Homebrew, MacPorts offers more patches and configuration options for OpenCV. On the other hand, Homebrew offers more timely updates for OpenCV. At the time of writing, Homebrew offers a package for OpenCV 4.0.1, but MacPorts is still lagging at OpenCV 3.4.3. Homebrew and MacPorts can coexist with the Python package manager, pip, and we can use pip to get OpenCV 4.0.1, even though MacPorts does not package this version yet. Normally, MacPorts and Homebrew should not be installed on the same machine.</p>
<p>Our installation methods for Mac do not give us the OpenCV sample projects. To get these, download the latest source code archive from <a href="https://opencv.org/releases.html">https://opencv.org/releases.html</a> and unzip it to any location. Find the samples in <kbd>&lt;opencv_unzip_destination&gt;/samples/python</kbd>.</p>
<p>Now, depending on your preference, let's proceed to either the <em>Mac with MacPorts</em> section or the <em>Mac with Homebrew</em> section.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Mac with MacPorts</h1>
                
            
            
                
<p>MacPorts provides Terminal commands that automate the process of downloading, compiling, and installing various pieces of <strong>open source software</strong> (<strong>OSS</strong>). MacPorts also installs dependencies, as needed. For each piece of software, the dependencies and build recipe are defined in a configuration file called a <strong>Portfile</strong>. A MacPorts repository is a collection of Portfiles.</p>
<p>Starting from a system where Xcode and its command-line tools are already set up, the following steps will give us an OpenCV installation through MacPorts:</p>
<ol>
<li>Download and install MacPorts from <a href="http://www.macports.org/install.php">http://www.macports.org/install.php</a>.</li>
<li>Open the Terminal and run the following command to update MacPorts:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>sudo port selfupdate </strong></pre>
<p style="padding-left: 60px">When prompted, enter your password.</p>
<ol start="3">
<li>Run the following commands to install Python 3.7, pip, NumPy, SciPy, and Requests:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>sudo port install python37</strong><br/><strong>$</strong> <strong>sudo port install py37-pip</strong><br/><strong>$</strong> <strong>sudo port install py37-numpy</strong><br/><strong>$</strong> <strong>sudo port install py37-scipy</strong><br/><strong>$</strong> <strong>sudo port install py37-requests</strong></pre>
<ol start="4">
<li>The Python installation executable is named python3.7. To link the default python executable to python3.7, and to link the default pip executable to this Python pip installation, let's also run the following:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>sudo port install python_select</strong><br/><strong>$</strong> <strong>sudo port select python python37</strong><br/><strong>$</strong> <strong>sudo port install pip_select</strong><br/><strong>$</strong> <strong>sudo port select pip pip37</strong></pre>
<ol start="5">
<li>At the time of writing, MacPorts only has packages for relatively old versions of wxPython and PyInstaller. Let's use the following <kbd>pip</kbd> command to install more recent versions:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$ pip install --user wxPython pyinstaller</strong></pre>
<ol start="6">
<li>To check whether MacPorts has an OpenCV 4 package, run <kbd>$ port list opencv</kbd>. At the time of writing, this produces the following output:</li>
</ol>
<pre style="padding-left: 60px"><strong>opencv                         @3.4.3          graphics/opencv</strong></pre>
<ul>
<li style="padding-left: 60px">Here, <kbd>@3.4.3</kbd> means that OpenCV 3.4.3 is the latest available package from MacPorts. However, if your output shows <kbd>@4.0.0</kbd> or a more recent version, you can use MacPorts to configure, build, and install OpenCV 4, by running a command such as the following:</li>
</ul>
<pre style="padding-left: 120px"><strong>$</strong> <strong>sudo port install opencv +avx2 +contrib +opencl +python37</strong></pre>
<ul>
<li style="padding-left: 60px">By adding <kbd>+avx2 +contrib +opencl +python37</kbd> to the command, we are specifying that we want the <kbd>opencv</kbd> variant (build configuration) with AVX2 CPU optimizations, <kbd>opencv_contrib</kbd> extra modules, OpenCL GPU optimizations, and Python 3.7 bindings. To see the full list of available variants before installing, we can enter the following:</li>
</ul>
<pre style="color: black;padding-left: 120px"><strong>$</strong> <strong>port variants opencv </strong></pre>
<ul>
<li style="padding-left: 60px">Depending on our customization needs, we can add other variants to the <kbd>install</kbd> command.</li>
<li style="padding-left: 60px">On the other hand, if the output from <kbd>$ port list opencv</kbd> showed that MacPorts does not have an OpenCV 4 package yet, we can instead install OpenCV 4 and the <kbd>opencv_contrib</kbd> extra modules with pip, by running the following command:</li>
</ul>
<pre style="padding-left: 120px"><strong>$</strong> <strong>pip install --user opencv-contrib-python</strong></pre>
<p style="color: black">Now, we have everything we need to develop OpenCV applications for Mac. To also develop for Android, we need to set up Android Studio, as we will describe in the following <em>Android Studio</em> section<em>.</em></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Mac with Homebrew</h1>
                
            
            
                
<p style="color: black">Like MacPorts, Homebrew is a package manager that provides Terminal commands to automate the process of downloading, compiling, and installing various pieces of open source software.</p>
<p style="color: black">Starting from a system where Xcode and its command-line tools are already set up, the following steps will give us an OpenCV installation through Homebrew:</p>
<ol>
<li>Open Terminal and run the following command to install Homebrew:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</strong>"</pre>
<ol start="2">
<li>Unlike MacPorts, Homebrew does not automatically put its executables in <kbd>PATH</kbd>. To do so, create or edit the <kbd>~/.profile</kbd> file and add this line at the top:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>export PATH=/usr/local/bin:/usr/local/sbin:$PATH</strong></pre>
<ul>
<li style="padding-left: 60px">Save the file and run this command to refresh <kbd>PATH</kbd>:</li>
</ul>
<pre style="color: black;padding-left: 120px"><strong>$</strong> <strong>source ~/.profile</strong></pre>
<ul>
<li style="padding-left: 60px">Note that executables installed by Homebrew now take precedence over executables installed by the system.</li>
</ul>
<ol start="3">
<li>For Homebrew's self-diagnostic report, run:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>brew doctor</strong></pre>
<p style="padding-left: 60px">Follow any troubleshooting advice it gives.</p>
<ol start="4">
<li>Now, update Homebrew:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>brew update</strong></pre>
<ol start="5">
<li>Run the following command to install Python 3.7:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>brew install python</strong></pre>
<ol start="6">
<li>Now, we can use Homebrew to install OpenCV and its dependencies, including NumPy. Run the following command:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>brew install opencv --with-contrib</strong></pre>
<ol start="7">
<li class="packt_nosymbol">Similarly, run the following command to install SciPy:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>pip install --user scipy</strong></pre>
<ol start="8">
<li>At the time of writing, Homebrew does not have packages for <kbd>requests</kbd> and <kbd>pyinstaller</kbd>, and its <kbd>wxPython</kbd> package is a relatively old version, so instead, we will use <kbd>pip</kbd> to install these modules. Run the following command:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>pip install --user requests wxPython pyinstaller</strong></pre>
<p style="color: black">Now, we have everything we need to develop OpenCV applications for Mac. To also develop for Android, we need to set up <strong>Tegra Android Development Pack</strong> (<strong>TADP</strong>), as described in the following <em>Tegra Android Development Pack</em> section.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Python and OpenCV on Debian Jessie and its derivatives, including Raspbian, Ubuntu, and Linux Mint</h1>
                
            
            
                
<p>For information on setting up the Raspbian operating system, see the <em>Setting up a Raspberry Pi</em> section, later in this chapter.</p>
<p>On Debian Jessie, Raspbian, Ubuntu, Linux Mint, and their derivatives, the python executable is Python 2.7, which comes preinstalled. We can use the system package manager, apt, to install NumPy, SciPy, and Requests from the standard repository. To update the apt package index and install the packages, run the following commands in Terminal:</p>
<pre class="mce-root"><strong>$</strong> <strong>sudo apt-get update</strong><br/><strong>$</strong> <strong>sudo apt-get install python-numpy python-scipy python-requests</strong></pre>
<p>The standard repository's latest packaged version of wxPython varies, depending on the operating system. On Ubuntu 14.04 and its derivatives, including Linux Mint 17, the latest packaged version is wxPython 2.8. Install it by running the following command:</p>
<pre><strong>$</strong> <strong>sudo apt-get install python-wxgtk2.8</strong></pre>
<p>On Ubuntu 18.04 and newer versions, as well as derivatives such as Linux Mint 19, the latest packaged version is wxPython 4.0. Install it by running the following command:</p>
<pre>$ <strong>sudo apt-get install python-wxgtk4.0</strong></pre>
<p>On most other systems in the Debian Jessie family, wxPython 3.0 is the latest packaged version. Install it by running the following command:</p>
<pre>$ <strong>sudo apt-get install python-wxgtk3.0</strong></pre>
<p>The standard repository does not offer a PyInstaller package. Instead, let's use Python's own package manager, <kbd>pip</kbd>, to obtain PyInstaller. First, to ensure that <kbd>pip</kbd> is installed, run the following command:</p>
<pre style="color: black">$ <strong>sudo apt-get install python-pip</strong></pre>
<p>Now, install PyInstaller by running the following command:</p>
<pre style="color: black">$ <strong>pip install --user pyinstaller</strong></pre>
<p style="color: black">The standard repository contains a <kbd>python-opencv</kbd> package, but it is an old version (3.2.0 or older, depending on the operating system) and it is missing the <kbd>opencv_contrib</kbd> modules, so it lacks some of the functionality used in this book. Thus, we have a choice of either using <kbd>pip</kbd> to obtain OpenCV 4 with the <kbd>opencv_contrib</kbd> modules, or building the same from source. To install a prebuilt version of OpenCV 4 and <kbd>opencv_contrib</kbd> with <kbd>pip</kbd>, run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>pip install --user opencv-contrib-python</strong></pre>
<p>If you prefer to use the <kbd>python3</kbd> executable, which is Python 3.4 or a newer version (depending on the operating system), modify all the <kbd>apt-get</kbd> commands in the preceding instructions to use package names like <kbd>python3-numpy</kbd>, instead of names like <kbd>python-numpy</kbd>. Similarly, replace the <kbd>pip</kbd> commands with the <kbd>pip3</kbd> commands.</p>
<p>Alternatively, to build <kbd>OpenCV</kbd> and <kbd>opencv_contrib</kbd> from source, follow the instructions in the following <em>Building OpenCV on Debian Jessie and its derivates with CMake and GCC</em> section.</p>
<p style="color: black">After either installing a prebuilt <kbd>OpenCV</kbd> and <kbd>opencv_contrib</kbd> module or building it from source, we will have everything we need to develop OpenCV applications for Debian Jessie or a derivative. To also develop for Android, we need to set up Android Studio, as described in the <em>Setting up Android Studio and OpenCV</em> section, later in this chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Building OpenCV on Debian Jessie and its derivatives with CMake and GCC</h1>
                
            
            
                
<p>To compile OpenCV from source, we need a general-purpose C++ development environment. On Linux, the standard C++ development environment includes the g++ compiler and the Make build system, which defines build instructions in a file format known as <strong>Makefile</strong>.</p>
<p class="mce-root">OpenCV uses a set of build tools called <strong>CMake</strong>, which automates the use of Make, g++, and other tools. CMake 3 or a newer version is required, and we must install it. Also, we will install several third-party libraries. Some of these are required for standard OpenCV features, while others are optional dependencies that enable extra features.</p>
<p class="mce-root">As an example, let's install the following optional dependencies:</p>
<ul>
<li>
<p><kbd>libdc1394</kbd>: This is a library to programmatically control IEEE 1394 (FireWire) cameras, which are quite common in industrial use. OpenCV can leverage this library to capture photos or video from some of these cameras.</p>
</li>
<li><kbd>libgphoto2</kbd>: This is a library to programmatically control photo cameras through a wired or wireless connection. The <kbd>libgphoto2</kbd> library supports a large number of cameras from Canon, Fuji, Leica, Nikon, Olympus, Panasonic, Sony, and other manufacturers. OpenCV can leverage this library to capture photos or video from some of these cameras.</li>
</ul>
<p class="mce-root">After installing dependencies, we will configure, build, and install <kbd>OpenCV</kbd>. Here are the detailed steps:</p>
<ol>
<li>On Ubuntu 14.04 and its derivatives, including Linux Mint 17, the <kbd>cmake</kbd> package in the standard repository is CMake 2, which is too old for our purposes. We need to ensure that the <kbd>cmake</kbd> package is not installed, and then we need to install the <kbd>cmake3</kbd> package, as well as other essential development and packaging tools. To accomplish this, run the following commands:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>sudo apt-get remove cmake</strong><br/><strong>$</strong> <strong>sudo apt-get install build-essential cmake3 pkg-config</strong></pre>
<p style="padding-left: 60px">On more recent versions of Ubuntu and its derivatives, and on Debian Jessie, the <kbd>cmake3</kbd> package does not exist; rather, the <kbd>cmake</kbd> package is CMake 3. Install it, as well as other essential development and packaging tools, by running the following command:</p>
<pre style="padding-left: 60px"><strong>$</strong> <strong>sudo apt-get install build-essential cmake pkg-config</strong></pre>
<ol start="2">
<li>If your system uses a proxy server to access the internet, define two environment variables, <kbd>HTTP_PROXY</kbd> and <kbd>HTTPS_PROXY</kbd>, with values equal to the proxy server URL, such as <kbd>http://myproxy.com:8080</kbd>. This ensures that CMake can use the proxy server to download some additional dependencies for OpenCV. (If in doubt, do <em>not</em> define these environment variables; you are probably <em>not</em> using a proxy server.)</li>
</ol>
<ol start="3">
<li>Run the following command to install OpenCV's dependencies for Python bindings and for video capture from <strong>Video4Linux</strong> (<strong>V4L</strong>)-compatible cameras, including most webcams:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>sudo apt-get install python-dev libv4l-dev</strong></pre>
<p>If you prefer to use Python 3, replace <kbd>python-dev</kbd> with <kbd>python3-dev</kbd> in the preceding command.</p>
<ol start="4">
<li>Run the following command to install optional OpenCV dependencies:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>sudo apt-get install libdc1394-22-dev libgphoto2-dev</strong></pre>
<p class="mce-root"/>
<ol start="5">
<li>Download the OpenCV source's ZIP from <a href="https://opencv.org/releases.html">http://opencv.org/releases.html</a>. (Choose the latest version.) Unzip it to any destination folder, which we will refer to as <kbd>&lt;opencv_unzip_destination&gt;</kbd>. </li>
<li>Download <kbd>opencv_contrib</kbd> as a ZIP from <a href="https://github.com/opencv/opencv_contrib/releases">https://github.com/opencv/opencv_contrib/releases</a>. (Choose the latest version.) Unzip it to any destination folder, which we will refer to as <kbd>&lt;opencv_contrib_unzip_destination&gt;</kbd>.</li>
<li>Open Command Prompt. Create a folder to store our build:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>mkdir &lt;build_folder&gt;</strong></pre>
<p style="padding-left: 60px">Change the directory to the newly created build folder:</p>
<pre style="padding-left: 60px"><strong>$</strong> <strong>cd &lt;build_folder&gt;</strong></pre>
<ol start="8">
<li>Having set up our dependencies, we can now configure OpenCV's build system. To understand all the configuration options, we can read the code in <kbd>&lt;opencv_unzip_destination&gt;/opencv/sources/CMakeLists.txt</kbd>. However, as an example, we will just use the options for a release build that includes Python bindings, support for OpenGL interoperability, and support for extra camera types and video types. To create Makefiles for OpenCV with Python 2.7 bindings, run the following command (but replace the angle brackets and their contents with the actual paths):</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>cmake -D CMAKE_BUILD_TYPE=RELEASE -D BUILD_EXAMPLES=ON -D WITH_1394=ON <br/>-D WITH_GPHOTO2=ON -D BUILD_opencv_python2=ON <br/>-D PYTHON2_EXECUTABLE=/usr/bin/python2.7 <br/>-D PYTHON_LIBRARY2=/usr/lib/python2.7/config-x86_64-linux-gnu/libpython2.7.so -D PYTHON_INCLUDE_DIR2=/usr/include/python2.7 -D BUILD_opencv_python3=OFF <br/>-D OPENCV_EXTRA_MODULES_PATH=&lt;opencv_contrib_unzip_destination&gt;/modules &lt;opencv_unzip_destination&gt;</strong><br/><br/></pre>
<p style="padding-left: 60px">Alternatively, to create Makefiles for OpenCV with bindings for Python 3, run the following command (but replace the angle brackets and their contents with the actual paths, and replace <kbd>3.6</kbd> with your actual Python 3 version, if it is not 3.6):</p>
<pre style="padding-left: 60px">$ cmake -D CMAKE_BUILD_TYPE=RELEASE -D BUILD_EXAMPLES=ON -D WITH_1394=ON -D WITH_GPHOTO2=ON -D BUILD_opencv_python2=<strong>OFF</strong> <br/>-D BUILD_opencv_python3=<strong>ON</strong> <strong>-D PYTHON3_EXECUTABLE=/usr/bin/python3.6 </strong><strong>-D PYTHON3_INCLUDE_DIR=/usr/include/python3.6 <br/></strong><strong>-D PYTHON3_LIBRARY=/usr/lib/python3.6/config-3.6m-x86_64-linux-gnu/libpython3.6.so</strong> -D OPENCV_EXTRA_MODULES_PATH=&lt;opencv_contrib_unzip_destination&gt; &lt;opencv_unzip_destination&gt;</pre>
<ol start="9">
<li>Run the following commands to build and install OpenCV in the manner specified by the Makefiles:</li>
</ol>
<pre style="padding-left: 60px"><strong>$</strong> <strong>make -j8</strong><br/><strong>$</strong> <strong>sudo make install</strong></pre>
<p>At this point, we have everything we need to develop OpenCV applications for Debian Jessie or a derivative. To also develop for Android, we need to set up Android Studio, as described in the <em>Setting up Android Studio and OpenCV</em> section, later in this chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Python and OpenCV on Fedora and its derivatives, including RHEL and CentOS</h1>
                
            
            
                
<p>On Fedora, RHEL, and CentOS, the <kbd>python</kbd> executable is Python 2.7, which comes preinstalled. We can use the system package manager, yum, to install NumPy, SciPy, Requests, and wxPython from the standard repository. To do this, open Terminal and run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo yum install numpy scipy python-requests wxPython</strong></pre>
<p>The standard repository does not offer a PyInstaller package. Instead, let's use Python's own package manager, <kbd>pip</kbd>, to obtain PyInstaller. First, to ensure that <kbd>pip</kbd> is installed, run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo yum install python-pip</strong></pre>
<p>Now, install PyInstaller by running the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>pip install --user pyinstaller</strong></pre>
<p style="color: black">The standard repository contains an <kbd>opencv</kbd> package, which includes the <kbd>opencv_contrib</kbd> modules and Python bindings, but it is an old version (3.4.4 or older, depending on the operating system). Thus, we want to use <kbd>pip</kbd> to obtain OpenCV 4 with the <kbd>opencv_contrib</kbd> modules. Run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>pip install --user opencv-contrib-python</strong></pre>
<p>If you prefer to use the <kbd>python3</kbd> executable, which is Python 3.6 or 3.7 (depending on the operating system), replace the preceding <kbd>pip</kbd> commands with the <kbd>pip3</kbd> commands. You do not need to modify the <kbd>yum</kbd> commands, as the relevant packages, such as <kbd>numpy</kbd>, include sub-packages for both Python 2 and Python 3.</p>
<p style="color: black">Now, we have everything we need to develop OpenCV applications for Fedora or a derivative. To also develop for Android, we need to set up Android Studio, as described in the following <em>Setting up Android Studio and OpenCV</em> section.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Python and OpenCV on openSUSE and its derivatives</h1>
                
            
            
                
<p style="color: black">On openSUSE, the <kbd>python</kbd> executable is Python 2.7, which comes preinstalled. We can use the system package manager, yum, to install NumPy, SciPy, Requests, and wxPython from the standard repository. To do this, open Terminal and run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo yum install python-numpy python-scipy python-requests python-wxWidgets</strong></pre>
<p>Although openSUSE and Fedora both use the yum package manager, they use different standard repositories with different package names.</p>
<p>The standard repository does not offer a PyInstaller package. Instead, let's use Python's own package manager, <kbd>pip</kbd>, to obtain PyInstaller. First, to ensure that pip is installed, run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo yum install python-pip</strong></pre>
<p>Now, install PyInstaller by running the following command:</p>
<pre><strong>$</strong> <strong>pip install --user pyinstaller</strong></pre>
<p>The standard repository contains a <kbd>python2-opencv</kbd> package (and a <kbd>python3-opencv</kbd> package for Python 3), but it is an old version of OpenCV (3.4.3 or older, depending on the operating system). Thus, we want to use pip to obtain OpenCV 4 with the <kbd>opencv_contrib</kbd> modules. Run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>pip install --user opencv-contrib-python</strong></pre>
<p>If you prefer to use the <kbd>python3</kbd> executable, which is Python 3.4, 3.6, or 3.7 (depending on the operating system), replace the preceding <kbd>pip</kbd> commands with the <kbd>pip3</kbd> commands. You do not need to modify the <kbd>yum</kbd> commands, as the relevant packages, such as <kbd>python-numpy</kbd>, include sub-packages for both Python 2 and Python 3.</p>
<p style="color: black">Now, we have everything we need to develop OpenCV applications for openSUSE or a derivative. Next, we need to follow the cross-platform steps for setting up an Android development environment.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Android Studio and OpenCV</h1>
                
            
            
                
<p style="color: black">Android Studio is Google's official <strong>integrated development environment</strong> (<strong>IDE</strong>) for Android app development. Since its first stable release in 2014, Android Studio has grown in popularity and has replaced Eclipse as the IDE of choice for Android developers. Although some of the OpenCV documentation still contains outdated tutorials on Android development in Eclipse, nowadays, the OpenCV Android library and Android sample projects are primarily intended for use with Android Studio, instead.</p>
<p>Google provides a good cross-platform tutorial on Android Studio installation at <a href="https://developer.android.com/studio/install">https://developer.android.com/studio/install</a>. Follow the part of the tutorial that is relevant to your operating system.</p>
<p>Download the latest version of the OpenCV Android pack from <a href="https://opencv.org/releases.html">https://opencv.org/releases.html</a>. Unzip it to any destination, which we will refer to as <kbd>&lt;opencv_android_pack_unzip_destination&gt;</kbd>. This has two subfolders:</p>
<ul>
<li><kbd>&lt;opencv_android_pack_unzip_destination&gt;/sdk</kbd> contains the <kbd>OpenCV4Android</kbd> SDK. This consists of Java and C++ libraries, as well as build instructions, which we can import into Android Studio projects.</li>
<li><kbd>&lt;opencv_android_pack_unzip_destination&gt;/samples</kbd> contains sample projects that can be built in Android Studio. Unfortunately, as of OpenCV 4.0.1, these samples are outdated. On Android 6.0 and newer versions, the samples fail to access the camera, because they do not request user permission at runtime in the required manner.</li>
</ul>
<p>At this point, we have obtained the core components of our development environment for the OpenCV Android apps. Next, let's look at Unity, a game engine that can deploy to Android and other platforms.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up Unity and OpenCV</h1>
                
            
            
                
<p style="color: black">Unity (<a href="https://unity3d.com">https://unity3d.com</a>) is a three-dimensional game engine that supports development on 64-bit Windows or Mac, and deployment to many platforms, including Windows, Mac, Linux, iOS, Android, WebGL, and several game consoles. For one of our projects, we will use Unity along with a plugin called <strong>OpenCV for Unity</strong>, which is developed by Enox Software (<a href="http://enoxsoftware.com/">http://enoxsoftware.com/</a>.)  The main programming language for Unity projects is C#, and OpenCV for Unity provides a C# API that is modeled on the OpenCV Java API for Android.</p>
<p style="color: black">Unity has three license plans, Personal, Plus, and Pro, which all support the plugin that we want to use. The different editions are for different sizes of companies, as described in the licensing information at <a href="https://store.unity.com">https://store.unity.com</a>. The Personal license is free. The Plus and Pro licenses have subscription costs. If you are not already a Unity subscriber, you may want to wait and purchase a subscription when you are ready to start working on our Unity project in <a href="5c9b90d0-e860-4d65-8af2-9d6537a2e0c7.xhtml">Chapter 6</a><em>, Creating a Physics Simulation Based on a Pen and Paper Sketch</em>. Once you are ready, obtain your license from <a href="https://store.unity.com">https://store.unity.com</a> and download Unity Hub from <a href="https://unity3d.com/get-unity/download">https://unity3d.com/get-unity/download</a>. Unity Hub is an application to manage your Unity licenses and installations. Use it to set up Unity on your system. You can purchase OpenCV for Unity from the Unity Asset Store at <a href="https://assetstore.unity.com/packages/tools/integration/opencv-for-unity-21088">https://assetstore.unity.com/packages/tools/integration/opencv-for-unity-21088</a>, but we will cover details about obtaining the plugin in <a href="5c9b90d0-e860-4d65-8af2-9d6537a2e0c7.xhtml"/><a href="5c9b90d0-e860-4d65-8af2-9d6537a2e0c7.xhtml"/><a href="5c9b90d0-e860-4d65-8af2-9d6537a2e0c7.xhtml">Chapter 6</a>, <em>Creating a Physics Simulation Based on a Pen and Paper Sketch,</em> when we set up a Unity project.</p>
<p style="color: black">Even before installing Unity, we can get inspiration from the demos at <a href="https://unity3d.com/unity/demos">https://unity3d.com/unity/demos/</a>. These demos include videos, articles about the development process, and in some cases, playable games that you can download for various platforms. They also include source code and art assets that you can open in Unity. After installing Unity, we can learn from these and other demo projects. Take a look at the resources available for download at <a href="https://unity3d.com/learn/resources/downloads">https://unity3d.com/learn/resources/downloads</a>. Also, check out the tutorials, videos, and documentation at <a href="https://unity3d.com/learn">https://unity3d.com/learn</a>.</p>
<p style="color: black">As you can see, there are a lot of official resources for Unity beginners, so I will let you explore these on your own for now.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a Raspberry Pi</h1>
                
            
            
                
<p style="color: black">Raspberry Pi is a <strong>single-board computer</strong> (<strong>SBC</strong>) with a low cost and low power consumption. It can be used as a desktop, a server, or an embedded system that controls other electronics. The Pi comes in several models. Currently, the flagship is Model 3 B+, which costs about $35. Compared to other models, it offers a faster CPU, more memory, and a faster Ethernet port, so it is a good candidate for computer vision experiments that rely on either local computing resources or the cloud. However, other models are also usable for computer vision projects.</p>
<p style="color: black">Several operating systems are available for Raspberry Pi. We will use Raspbian, which is a port of Debian Stretch (a major Linux distribution) to ARM.</p>
<p style="color: black">Download the latest Raspbian disk image from <a href="http://downloads.raspberrypi.org/raspbian_latest">http://downloads.raspberrypi.org/raspbian_latest</a>. You do not need to unzip the downloaded file. At the time of writing, the ZIP is called <kbd>2018-11-13-raspbian-stretch.zip</kbd> . Since your filenames may differ, we will refer to the file as <kbd>&lt;raspbian_zip&gt;</kbd>.</p>
<p style="color: black">The <kbd>&lt;raspbian_zip&gt;</kbd> file contains a disk image, which we need to burn to an SD card with a capacity of at least 4 GB. (Note that 8 GB or larger is preferable, to allow plenty of room for OpenCV and our projects.) Any existing data on the card will be lost in the process. To burn the card, let's use a cross-platform, open source application called <strong>Etcher</strong>. Download it from <a href="https://www.balena.io/etcher/">https://www.balena.io/etcher/</a> and set it up. (An installer is available for Windows or Mac. Alternatively, a portable application is available for Windows, Mac, or Linux). Insert an SD card and open Etcher. You should see the following window:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0e98fffc-eb6f-4f9e-84a7-9d71319ccb52.png" style="width:50.50em;height:20.58em;"/></p>
<p>Etcher's user interface is so self-explanatory that even James Bond might struggle to find a double meaning in it. Click on the Select image button and select <kbd>&lt;raspbian_zip&gt;</kbd>. Click on the Select drive button and select your SD drive. Click on the Flash! button to burn the image to the SD card. Wait for the burning process to finish. Quit Etcher and eject the card.</p>
<p>Now, let's turn our attention to the Raspberry Pi hardware. Ensure that the Raspberry Pi micro-USB power cable is disconnected. Connect an HDMI monitor or TV, USB keyboard, USB mouse, and (optionally) Ethernet cable. Then, insert the SD card firmly into the slot on the bottom of the Pi. Connect the Pi power cable. The Pi should start booting from the SD card. During this first bootup, the filesystem expands to fill the entire SD card. When the Raspbian desktop appears for the first time, the system displays a series of setup dialogs. Follow the instructions in the dialogs in order to set your login password, and select an appropriate locale, time zone, and keyboard. Raspbian defaults to a UK keyboard layout, which will cause problems if you have a US or other keyboard. If you have an internet connection, you can also use the setup dialogs to perform a system update.</p>
<p>Once the setup is complete, take some time to admire the Raspbian desktop wallpaper and explore the system's infinite horizons, as I am doing in the following photograph:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/45d96998-7f4e-46bc-836b-cb87a6e5bad7.png" style="width:41.08em;height:32.83em;"/></p>
<p style="color: black">In its heart (or in its seeds), Raspbian is just Debian Linux with an LXDE desktop and some special developer tools. If you are familiar with Debian or derivatives such as Ubuntu, you should feel right at home. Otherwise, you might want to explore the documentation and guides for beginners that are posted on the Raspberry Pi website, at <a href="https://www.raspberrypi.org/help/">https://www.raspberrypi.org/help/</a>.</p>
<p style="color: black">Now, as an exercise, let's share our Raspbian desktop through <strong>Virtual Network Computing</strong> (<strong>VNC</strong>) so that we can control it from a Windows, Mac, or Linux machine.</p>
<p style="color: black">On the Pi, we need to first determine our local network address, which we will refer to as <kbd>&lt;pi_ip_address&gt;</kbd>. Open LXTerminal and run the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>ifconfig</strong></pre>
<p style="color: black">The output should include a line beginning with something like <kbd>inet addr:192.168.1.93</kbd>, although the numbers will probably differ. In this example, <kbd>&lt;pi_ip_address&gt;</kbd> is <kbd>192.168.1.93</kbd>.</p>
<p style="color: black">Now, we need to install a VNC server on the Pi by running the following command:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo apt-get install tightvncserver</strong></pre>
<p style="color: black">To start the server, run this command:</p>
<pre style="color: black"><strong>$</strong> <strong>tightvncserver </strong></pre>
<p style="color: black">When prompted, enter a password, which other users must enter when connecting to this VNC server. Later, if you want to change the password, run this command:</p>
<pre style="color: black"><strong>$ vncpasswd</strong></pre>
<p>Unless the Pi (or the Ethernet socket to which it is connected) has a static IP address, the address may change whenever we reboot. Thus, upon reboot, we would need to run <kbd>ifconfig</kbd> again to determine the new address. Also, after rebooting, we need to run <kbd>tightvncserver</kbd> to relaunch the VNC server. For instructions on making the Pi's IP address static and automatically running <kbd>tightvncserver</kbd> upon boot, see Neil Black's online Raspberry Pi Beginner Guide, at <a href="http://www.neil-black.co.uk/raspberrypi/raspberry-pi-beginners-guide/">http://www.neil-black.co.uk/raspberrypi/raspberry-pi-beginners-guide/</a>.</p>
<p style="color: black">Now, on another machine on the same local network, we can access the Pi's desktop through a VNC client. The steps are platform dependent, as follows:</p>
<ol>
<li>On Windows, download VNC Viewer from <a href="https://www.realvnc.com/download/">https://www.realvnc.com/download/</a>. Unzip it to any destination and run the executable file (such as <kbd>VNC-Server-6.4.0-Windows.exe</kbd>), which is inside the unzipped folder. Enter <kbd>vnc://&lt;pi_ip_address&gt;:5901</kbd> in the VNC server field and click on the Connect button. When prompted, enter the VNC password that you created earlier.</li>
<li>On Mac, open Safari and enter <kbd>vnc://&lt;pi_ip_address&gt;:5901</kbd> in the address bar. A window, Connect to Shared Computer, should appear. Click on the Connect button. When prompted, enter the VNC password that you created earlier.</li>
</ol>
<ol start="3">
<li>Ubuntu normally comes with a VNC client called <strong>Vinagre</strong>. However, if we do not already have Vinagre, we can install it on Ubuntu or any Debian-based system by running the following command in Terminal:</li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>$</strong> <strong>sudo apt-get install vinagre</strong></pre>
<p style="padding-left: 60px">Open Vinagre (it might be listed as <strong>Remote Desktop Viewer</strong> in the system's applications menu or launcher). Click on the <strong>Connect</strong> button in the toolbar. Enter <kbd>vnc://&lt;pi_ip_address&gt;:5901</kbd> in the Host: field. Click on the <strong>Connect</strong> button in the lower-right corner.</p>
<p style="color: black">Now you know how to prepare and serve Pi.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up the Raspberry Pi camera module</h1>
                
            
            
                
<p style="color: black">Raspbian supports most USB webcams out of the box. Also, it supports the following <strong>Camera Serial Interface</strong> (<strong>CSI</strong>) cameras, which offer faster transfer speeds:</p>
<ul>
<li><strong>Raspberry Pi camera module</strong>: A $25 RGB camera</li>
<li><strong>Pi NoIR</strong>: A $30 variant of the same camera, with the <strong>infrared radiation</strong> (<strong>IR</strong>) block filter removed so that it is sensitive to not only visible light, but also the nearest-to-visible part of the infrared spectrum, <strong>near infrared</strong> (<strong>NIR</strong>)</li>
</ul>
<p style="color: black">Compared to a USB webcam, the camera module or NoIR improves our chances of achieving high enough frame rates for interactive computer vision on the Pi. For this reason, I recommend these Pi-specific CSI cameras. However, in accordance with the low price, they have poor color rendition, mediocre auto-exposure, and fixed focus.</p>
<p style="color: black">If in doubt, choose the camera module over the NoIR, because depending on the subject and lighting, NIR may interfere with vision, rather than aid it.</p>
<p style="color: black">See the official tutorial at <a href="http://www.raspberrypi.org/help/camera-module-setup/">http://www.raspberrypi.org/help/camera-module-setup/</a> for details about setting up either the camera module or the NoIR. Once the hardware is set up, you need to configure Raspbian to use the camera. From the Raspbian launch menu, select Preferences | Raspbian Pi Configuration, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/d161b6dc-23d8-455a-a293-e74d6d76d347.png" style="width:25.33em;height:22.08em;"/></p>
<p>The Raspberry Pi Configuration window should appear. Go to the Interfaces tab and select Camera: Enable, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/83a7cd41-0969-4608-824a-6986591521b0.png" style="width:26.83em;height:23.17em;"/></p>
<p>Click on OK and, when prompted, reboot the system.</p>
<p style="color: black">At the time of writing, the camera module and NoIR do not work out of the box with OpenCV. We need to load a kernel module that adds support for the cameras through the <strong>Video for Linux 2</strong> (<strong>V4L2</strong>) drivers. To do this for a single session, run the following command in Terminal:</p>
<pre style="color: black"><strong>$</strong> <strong>sudo modprobe bcm2835-v4l2</strong></pre>
<p style="color: black">Alternatively, to always load the kernel module upon bootup, run the following command, which appends the module to the <kbd>/etc/modules</kbd> file:</p>
<pre style="color: black"><strong>$</strong> <strong>echo "bcm2835-v4l2" | sudo tee -a /etc/modules</strong></pre>
<p>Future versions of Raspbian (later than version 2018-11-13) might be preconfigured to use this kernel module. You can edit <kbd>/etc/modules</kbd> to check whether <kbd>bcm2835-v4l2</kbd> is already listed there.</p>
<p style="color: black">Reboot the system again so that the kernel module is loaded. Now, we can use the <kbd>Camera</kbd> module or the NoIR with any camera software that supports V4L2 drivers, including OpenCV.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Finding OpenCV documentation, help, and updates</h1>
                
            
            
                
<p style="color: black">OpenCV's documentation is online, at <a href="https://docs.opencv.org/master/">https://docs.opencv.org/master/</a>. The documentation includes a combined API reference for the latest OpenCV C++ API and its latest Python API (which is based on the C++ API). The latest Java API documentation is online, at <a href="http://docs.opencv.org/master/javadoc/">http://docs.opencv.org/master/javadoc/</a>.</p>
<p style="color: black">If the documentation seems to leave your questions unanswered, try reaching out to the OpenCV community instead. The following sites are good venues for questions, answers, and shared experience:</p>
<ul>
<li>The official OpenCV forum, at <a href="http://answers.opencv.org/questions/">http://answers.opencv.org/questions/</a></li>
<li>The PyImageSearch site, where Adrian Rosebrock teaches computer vision and machine learning, at <a href="https://www.pyimagesearch.com/">https://www.pyimagesearch.com/</a></li>
<li>The support site for my OpenCV books, at <a href="http://nummist.com/opencv/">http://nummist.com/opencv/</a></li>
</ul>
<p style="color: black">Finally, if you are an advanced user who wants to try new features, bug-fixes, and sample scripts from the latest (unstable) OpenCV source code, have a look at the project's repository at <a href="https://github.com/opencv/opencv/">https://github.com/opencv/opencv/</a>, as well as the repository for the <kbd>opencv_contrib</kbd> modules at <a href="https://github.com/opencv/opencv_contrib/">https://github.com/opencv/opencv_contrib/</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Alternatives to Raspberry Pi</h1>
                
            
            
                
<p style="color: black">Besides Raspberry Pi, many other low-cost SBCs are suitable for running a desktop Linux distribution and OpenCV applications. The Raspberry Pi 3 models offer a quad-core ARMv8 processor and 1 GB RAM. However, some of the competing SBCs offer octa-core ARM processors and 2 GB RAM and can run more complex computer vision algorithms in real time. Moreover, unlike any current model of Pi, some of the competitors offer a USB 3 interface, which supports a wide range of high-resolution or high-speed cameras. These advantages tend to come with a higher price tag and higher power consumption. Here are some examples:</p>
<ul>
<li>Odroid XU4 (<a href="https://www.hardkernel.com/shop/odroid-xu4-special-price/">https://www.hardkernel.com/shop/odroid-xu4-special-price/</a>): An octa-core SBC with 2 GB RAM and a USB 3 interface. It can run Ubuntu and other Linux distributions. At the time of writing, it is available from Odroid at a promotional price of $49.</li>
<li>Banana Pi M3 (<a href="http://www.banana-pi.org/m3.html">http://www.banana-pi.org/m3.html</a>): An octa-core SBC with 2 GB RAM and a SATA interface for fast storage devices. It is compatible with many Raspberry Pi accessories and can run Ubuntu, Raspbian, and other Linux distributions. It typically costs around $75, if ordered factory-direct.</li>
<li>Orange Pi 3 (<a href="http://www.orangepi.org/Orange%20Pi%203/">http://www.orangepi.org/Orange%20Pi%203/</a>): A quad-core SBC with 2 GB RAM and a USB 3 interface. It can run Ubuntu and other Linux distributions. It typically costs around $40, if ordered factory-direct.</li>
</ul>
<p style="color: black">If you would like to share your experience with using SBCs in computer vision projects, please write to me at <a href="mailto:josephhowse@nummist.com">josephhowse@nummist.com</a>. I will post the community's wisdom to <a href="http://nummist.com/opencv/">http://nummist.com/opencv/</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p style="color: black"><em>This was all a setup!</em> I hear you gasp. Yes, but we did it for good reason. Now, we have a diverse set of development tools that will enable us to explore OpenCV in many contexts. Besides, it never hurts to learn some things about a lot of application frameworks and to have them all set up, in case someone asks us to do a project in a hurry.</p>
<p style="color: black">Remember, James Bond has encyclopedic knowledge. In a highly symbolic conversation about rare and deadly fish, he goes toe-to-toe with Karl Stromberg, the diabolical oceanographer (<em>The Spy Who Loved Me</em>, 1977). Although we never see Bond studying the fish books, he must do it as bedtime reading after the camera cuts out.</p>
<p style="color: black">The moral is, be prepared. Next, we will use OpenCV, along with several of the Python libraries and tools that we have installed, to build a GUI application that finds and classifies images on the web.</p>


            

            
        
    </body></html>