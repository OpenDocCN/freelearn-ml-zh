<html><head></head><body>
  <div class="calibre1" id="_idContainer217">
    <h1 class="chapternumber">21</h1>
    <h1 class="chaptertitle" id="_idParaDest-466">Agents in Software Development</h1>
    <h1 class="heading" id="_idParaDest-467">Introduction</h1>
    <p class="normal">This chapter will introduce you to the concept of agents in software development. We’ll cover what agents are, how they work, and how you can use them in your projects. We’ll also cover some of the most popular agents’ frameworks and how you can get started with them.</p>
    <p class="normal1">Let’s introduce the problems that agents can solve. The general idea is to have a program that can act on your behalf. Examples of this could be automating tasks, making decisions, and interacting with other agents and humans. Programs like these can save you time and make your life easier or your business more efficient.</p>
    <p class="normal1">In this chapter, we will do the following:</p>
    <ul class="calibre15">
      <li class="bulletlist">Introduce the concept of agents in software development.</li>
      <li class="bulletlist1">Explain what agents are and how they work.</li>
      <li class="bulletlist1">Discuss the different types of agents and how they can be used.</li>
    </ul>
    <h1 class="heading" id="_idParaDest-468">What are agents?</h1>
    <p class="normal">As mentioned previously, agents <a id="_idIndexMarker969" class="calibre3"/>are programs that can act on your behalf. They can perform tasks, make decisions, and interact with other agents and humans. Agents can be used in a wide range of applications.</p>
    <p class="normal1">Several things make a program an agent program versus just a program:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Agent programs</strong><strong class="screentext"><a id="_idIndexMarker970" class="calibre3"/></strong><strong class="screentext"> have a clear goal</strong>: For instance, take a thermostat keeping the temperature at 25 degrees and taking appropriate actions to keep it there, or an agent managing finances and trying to maximize your profit.</li>
      <li class="bulletlist1"><strong class="screentext">Autonomous</strong>: An<a id="_idIndexMarker971" class="calibre3"/> agent makes necessary decisions to ensure it meets a goal as defined previously. For a finance agent, that could mean buying and selling stocks when they meet a specific trigger condition.</li>
      <li class="bulletlist1"><strong class="screentext">Has sensors</strong>: Sensors are either physical or <a id="_idIndexMarker972" class="calibre3"/>could be an API in software, something that enables an agent to understand “what the world is like.” For a thermostat, a sensor is a temperature indicator, but for a finance agent, a sensor can be an API toward the stock market that enables the agents to decide their goals.</li>
    </ul>
    <h2 class="heading1" id="_idParaDest-469">How do agents work?</h2>
    <p class="normal">Agents work by receiving<a id="_idIndexMarker973" class="calibre3"/> input, processing it, and producing output. They can be programmed to perform specific tasks, make decisions, and interact with other agents and humans. Agents can also learn from their interactions and improve their performance over time.</p>
    <figure class="mediaobject"><img alt="" src="../Images/B21232_21_01.png" class="calibre19"/></figure>
    <p class="packt_figref">Figure 21.1: Process for simple agent: keyword, recognize, perform task</p>
    <h1 class="heading" id="_idParaDest-470">Simpler agents versus agents using AI</h1>
    <p class="normal">Agents are not a new thing. They have been around for a long time. What’s new is that agents are now being powered by AI. Let’s compare the two:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Simpler agents</strong>: Traditional <a id="_idIndexMarker974" class="calibre3"/>agents are programmed to perform specific tasks and make decisions based on predefined rules and logic. </li>
      <li class="bulletlist1"><strong class="screentext">Agents using AI</strong>: Agents powered by AI can<a id="_idIndexMarker975" class="calibre3"/> perform more complex tasks and make more intelligent decisions. They can understand natural language, learn from their interactions, and improve their performance over time.</li>
    </ul>
    <h1 class="heading" id="_idParaDest-471">Simpler agents</h1>
    <p class="normal">Simpler agents, as mentioned<a id="_idIndexMarker976" class="calibre3"/> in the previous sections, are limited in that they are made for specific tasks. Interacting with them is usually also limited – you either use keywords or the way you can express yourself is limited.</p>
    <p class="normal1">An example of a simple agent is a chatbot. Such <a id="_idIndexMarker977" class="calibre3"/>chatbots are programmed to understand a limited set of keywords and phrases. </p>
    <p class="normal1">For example, “Tell me more about your products,” or “What’s your return policy?”. Any attempts at conversation outside of these keywords and phrases will result in the chatbot not understanding the user.</p>
    <h2 class="heading1" id="_idParaDest-472">A simple agent is not a great conversationalist</h2>
    <p class="normal">When you have a<a id="_idIndexMarker978" class="calibre3"/> conversation with a human, you expect them to know a few topics well and at least to be able to talk about other topics. For a simpler agent, we might end up in the following conversation:</p>
    <ul class="calibre15">
      <li class="bulletlist">User: “Tell me about your products.”</li>
      <li class="bulletlist1">Agent: “We have a wide range of products, including electronics, clothing, and accessories. Please indicate your interest.”</li>
      <li class="bulletlist1">User: “I’m interested in clothes, something fitting the current weather.”</li>
      <li class="bulletlist1">Agent: “I can advise on <strong class="screentext">clothes</strong> for sure, but I don’t know the <strong class="screentext">current weather</strong>.”</li>
    </ul>
    <p class="normal1">There are two interesting things we can observe here:</p>
    <ul class="calibre15">
      <li class="bulletlist">The conversation feels short, and the important information is either at the end of a sentence or just before a comma, which indicates that simpler parsing is used to extract the important information.</li>
      <li class="bulletlist1">It doesn’t handle non-product information like weather, which could help filter down the response.</li>
    </ul>
    <h2 class="heading1" id="_idParaDest-473">Improved conversation with tool calling and large language models (LLMs)</h2>
    <p class="normal">An LLM is an<a id="_idIndexMarker979" class="calibre3"/> improvement in that it’s good at sounding more natural, but also that it can parse out and recognize intent from fluent text. You can also provide the LLM with additional knowledge thanks to something called tool calling, where you tell the LLM about various capabilities like the clothes API, weather API, and so on, which can handle the conversation better, and resemble a conversation with a human. Let’s take that same conversation<a id="_idIndexMarker980" class="calibre3"/> with an LLM and highlight the difference:</p>
    <ul class="calibre15">
      <li class="bulletlist">User: “What are your products?”</li>
      <li class="bulletlist1">Agent: “We have a wide range of products, including electronics, clothing, and accessories.”</li>
      <li class="bulletlist1">User: “Great, I’m interested in clothes, something fitting the current weather. What can you recommend?”</li>
      <li class="bulletlist1">Agent: “Can you tell me your location so I can advise you better on clothes?”</li>
      <li class="bulletlist1">User: “Sure, I’m based in Phoenix, Arizona.”</li>
      <li class="bulletlist1">Agent: “I see it’s currently 90F in Phoenix at the moment. Might I suggest these shorts?”</li>
    </ul>
    <p class="normal1">The reason this conversation fared better is that this LLM expresses itself more naturally thanks to the tool calling that called its weather API with Phoenix as input and then proceeded to call the clothes API with the weather response as a filter.</p>
    <h2 class="heading1" id="_idParaDest-474">The anatomy of a conversational agent</h2>
    <p class="normal">A conversational agent <a id="_idIndexMarker981" class="calibre3"/>typically consists of the following components:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Input</strong>: The input to the agent, typically in the form of natural language. It should be said this can be a lot of different spoken languages, not just English, which you have had to hardcode in the past.</li>
      <li class="bulletlist1"><strong class="screentext">Processing</strong>: The processing of the input, typically using <strong class="screentext">natural language processing</strong> (<strong class="screentext">NLP</strong>) techniques.</li>
      <li class="bulletlist1"><strong class="screentext">Delegation</strong>: The delegation of the input to the appropriate component of the agent. The component it’s delegated to can be an agent for a specific task, for example, to book a flight or to answer a question.</li>
    </ul>
    <figure class="mediaobject"><img alt="" src="../Images/B21232_21_02.png" class="calibre19"/></figure>
    <p class="packt_figref">Figure 21.2: Conversational agents process steps</p>
    <p class="normal1">The preceding diagram <a id="_idIndexMarker982" class="calibre3"/>indicates a loop where you go from input to processing to delegation to result, so why is there a loop? An agent doesn’t have the concept of an end; it sits there and waits for the user to provide input and reacts to it. As mentioned earlier in this chapter, an agent works toward a goal, and if the goal is to manage finances, it’s a continuous job. </p>
    <h2 class="heading1" id="_idParaDest-475">More on tool calling in LLMs</h2>
    <p class="normal">We’ve mentioned tool calling <a id="_idIndexMarker983" class="calibre3"/>previously<a id="_idIndexMarker984" class="calibre3"/> in this chapter but let’s try to show how it works to add capabilities to the LLM.</p>
    <p class="normal1">The LLM only knows what it has been trained on, and for things it hasn’t been trained on, it will, in many cases, try to provide you with an answer that isn’t always correct as it makes it up; this is known as a hallucination. To improve areas where you want the LLM to provide more accurate responses, you can present it with a tool. The process of providing a tool consists of the following components:</p>
    <ul class="calibre15">
      <li class="bulletlist">A JSON description of a function</li>
      <li class="bulletlist1">A description of the function so the LLM knows when this function should be called</li>
    </ul>
    <p class="normal1">Once you’ve provided the preceding components, let’s say you provide a function capable of fetching the weather; the LLM can now use its built-in features to semantically interpret all the following<a id="_idIndexMarker985" class="calibre3"/> inputs to mean that the <a id="_idIndexMarker986" class="calibre3"/>user wants to know about the weather:</p>
    <ul class="calibre15">
      <li class="bulletlist">“What’s the weather like today in Salt Lake City?”</li>
      <li class="bulletlist1">“What’s the temperature in San Francisco?”</li>
      <li class="bulletlist1">“Is it going to rain in New York tomorrow?”</li>
      <li class="bulletlist1">“What’s the weather like in London?”</li>
      <li class="bulletlist1">“Is it warm outside?”</li>
    </ul>
    <h2 class="heading1" id="_idParaDest-476">Adding capabilities to GPT using tools</h2>
    <p class="normal">How it works is that you<a id="_idIndexMarker987" class="calibre3"/> provide a function specification in a JSON format. This JSON function format is a schema the GPT model understands. The GPT model will essentially do two things for you:</p>
    <ul class="calibre15">
      <li class="bulletlist">Extract parameters from the prompt.</li>
      <li class="bulletlist1">Determine whether to call a function and which function to call, as you can tell it about more than one function. </li>
    </ul>
    <p class="normal1">As a developer, you need to then actively call the function if the LLM thinks it should be called.</p>
    <p class="normal1">Your function format follows this schema:</p>
    <pre class="programlisting"><code class="hljs-code"><span>{</span>
        <span class="hljs-attr">"type"</span><span>:</span> <span class="hljs-string">"function"</span><span>,</span>
        <span class="hljs-attr">"function"</span><span>:</span> <span>{</span>
            <span class="hljs-attr">"name"</span><span>:</span> <span class="hljs-string">"get_current_weather"</span><span>,</span>
            <span class="hljs-attr">"description"</span><span>:</span> <span class="hljs-string">"Get the current weather"</span><span>,</span>
            <span class="hljs-attr">"parameters"</span><span>:</span> <span>{</span>
                <span class="hljs-attr">"type"</span><span>:</span> <span class="hljs-string">"object"</span><span>,</span>
                <span class="hljs-attr">"properties"</span><span>:</span> <span>{</span>
                    <span class="hljs-attr">"location"</span><span>:</span> <span>{</span>
                        <span class="hljs-attr">"type"</span><span>:</span> <span class="hljs-string">"string"</span><span>,</span>
                        <span class="hljs-attr">"description"</span><span>:</span> <span class="hljs-string">"The city and state, e.g. San Francisco, CA"</span><span>,</span>
                    <span>},</span>
                    <span class="hljs-attr">"format"</span><span>:</span> <span>{</span>
                        <span class="hljs-attr">"type"</span><span>:</span> <span class="hljs-string">"string"</span><span>,</span>
                        <span class="hljs-attr">"enum"</span><span>:</span> <span>[</span><span class="hljs-string">"celsius"</span><span>,</span> <span class="hljs-string">"fahrenheit"</span><span>],</span>
                        <span class="hljs-attr">"description"</span><span>:</span> <span class="hljs-string">"The temperature unit to use. Infer this from the users location."</span><span>,</span>
                    <span>},</span>
                <span>},</span>
                <span class="hljs-attr">"required"</span><span>:</span> <span>[</span><span class="hljs-string">"location"</span><span>,</span> <span class="hljs-string">"format"</span><span>],</span>
            <span>},</span>
        <span>}</span>
    <span>}</span>
</code></pre>
    <p class="normal1">In the preceding <a id="_idIndexMarker988" class="calibre3"/>JSON schema, there are a few things you’re telling the GPT model:</p>
    <ul class="calibre15">
      <li class="bulletlist">There’s a function called <code class="inlinecode">get_current_weather</code>.</li>
      <li class="bulletlist1">The description is <code class="inlinecode">"Get the current weather"</code>.</li>
      <li class="bulletlist1">The function takes two parameters, <code class="inlinecode">location</code> and <code class="inlinecode">format</code>.</li>
      <li class="bulletlist1">There’s also a description of the parameters, their types, and allowed values.</li>
    </ul>
    <p class="normal1">Let’s describe how this would work in practice, given the following prompt:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">“What’s the weather like today in Salt Lake City?”</p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">Here’s what the GPT model can extract from the prompt:</p>
    <ul class="calibre15">
      <li class="bulletlist">Location: Salt Lake City.</li>
      <li class="bulletlist1">Format: This is not provided, but the GPT can infer this from the user’s location.</li>
      <li class="bulletlist1">Function to call: <code class="inlinecode">get_current_weather</code>.</li>
    </ul>
    <p class="normal1">What you need to do as a developer is to call the function indicated with the extracted parameter values. The following is code that could be used to connect to the GPT model, where a function description is provided, and parse the response:</p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-built_in">open</span>
<span class="hljs-keyword">def</span> <span class="hljs-meta">get_current_weather</span>(<span>location, </span><span class="hljs-built_in">format</span>):
    <span class="hljs-comment"># Call weather API</span>
    response = requests.get(<span class="hljs-string">f"https://api.weather.com/v3/wx/forecast/daily/5day?location=</span><span class="hljs-name">{location}</span><span class="hljs-string">&amp;format=</span><span class="hljs-name">{</span><span class="hljs-built_in">format</span><span class="hljs-name">}</span>
<span class="hljs-string">    return response.json()</span>
<span class="hljs-string"># Call the GPT model</span>
<span class="hljs-string">tool = </span><span class="hljs-name">{</span>
<span class="hljs-name">        </span><span class="hljs-string">"type"</span><span class="hljs-name">: </span><span class="hljs-string">"function"</span><span class="hljs-name">,</span>
<span class="hljs-name">        </span><span class="hljs-string">"</span><span class="hljs-string">function"</span><span class="hljs-name">: {</span>
<span class="hljs-name">            </span><span class="hljs-string">"name"</span><span class="hljs-name">: </span><span class="hljs-string">"get_current_weather"</span><span class="hljs-name">,</span>
<span class="hljs-name">            </span><span class="hljs-string">"description"</span><span class="hljs-name">: </span><span class="hljs-string">"Get the current weather"</span><span class="hljs-name">,</span>
<span class="hljs-name">            </span><span class="hljs-string">"parameters"</span><span class="hljs-name">: {</span>
<span class="hljs-name">                </span><span class="hljs-string">"type"</span><span class="hljs-name">: </span><span class="hljs-string">"object"</span><span class="hljs-name">,</span>
<span class="hljs-name">                </span><span class="hljs-string">"properties"</span><span class="hljs-name">: {</span>
<span class="hljs-name">                    </span><span class="hljs-string">"location"</span><span class="hljs-name">: {</span>
<span class="hljs-name">                        </span><span class="hljs-string">"</span><span class="hljs-string">type"</span><span class="hljs-name">: </span><span class="hljs-string">"string"</span><span class="hljs-name">,</span>
<span class="hljs-name">                        </span><span class="hljs-string">"description"</span><span class="hljs-name">: </span><span class="hljs-string">"The city and state, e.g. San Francisco, </span>
<span class="hljs-string">CA"</span><span class="hljs-name">,</span>
<span class="hljs-name">                    }</span><span class="hljs-string">,</span>
<span class="hljs-string">                    "</span><span class="hljs-built_in">format</span><span class="hljs-string">": {</span>
<span class="hljs-string">                        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>string<span class="hljs-string">",</span>
<span class="hljs-string">                        "</span>enum<span class="hljs-string">": ["</span>celsius<span class="hljs-string">", "</span>fahrenheit<span class="hljs-string">"</span><span class="hljs-string">],</span>
<span class="hljs-string">                        "</span>description<span class="hljs-string">": "</span>The temperature unit to use. Infer this <span class="hljs-keyword">from</span> the users location.<span class="hljs-string">",</span>
<span class="hljs-string">                    },</span>
<span class="hljs-string">                },</span>
<span class="hljs-string">                "</span>required<span class="hljs-string">": ["</span>location<span class="hljs-string">", "</span><span class="hljs-built_in">format</span><span class="hljs-string">"],</span>
<span class="hljs-string">            },</span>
<span class="hljs-string">        }</span>
<span class="hljs-string">    }</span>
<span class="hljs-string">prompt = "</span>What<span class="hljs-string">'s the weather like today in Salt Lake City?"</span>
<span class="hljs-string">response = openai.Completion.create(</span>
<span class="hljs-string">  model="text-davinci-003",</span>
<span class="hljs-string">  prompt=prompt,</span>
<span class="hljs-string">  max_tokens=150,</span>
<span class="hljs-string">  tools= [tool]</span>
<span class="hljs-string">)</span>
<span class="hljs-string"># Parse the response</span>
<span class="hljs-string">function_response = response.choices[0].function_response # here we learn what function to call</span>
<span class="hljs-string">location = function_response.parameters.location # extracting parameter value for location</span>
<span class="hljs-string">format = function_response.parameters.format # extracting parameter value for format</span>
<span class="hljs-string">weather = get_current_weather(location, format) # here we get the response from the API</span>
</code></pre>
    <p class="normal1">This is probably the<a id="_idIndexMarker989" class="calibre3"/> most basic example of how you can create a conversational agent using GPT. </p>
    <p class="normal1">However, we expect a bit more from an advanced agent. What if we want to do something more complex, like booking a flight, hotel, car, and restaurant? </p>
    <h1 class="heading" id="_idParaDest-477">Advanced conversations</h1>
    <p class="normal">It’s easy to think you can just add more<a id="_idIndexMarker990" class="calibre3"/> functions to the GPT model and that might work for a time. However, as the conversation becomes more complex, the GPT model needs to remember the context of the conversation and keep track of the state of the conversation.</p>
    <p class="normal1">For more advanced conversations, it quickly becomes more complex.</p>
    <p class="normal1">Imagine going into a travel agent’s office and the following back-and-forth conversation taking place between two humans:</p>
    <p class="normal1"><em class="italic">User: “I want to go on a vacation.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure.”</em></p>
    <p class="normal1"><em class="italic">User: “I want to go to a warm place.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, tell me more about what you’re looking for.”</em></p>
    <p class="normal1"><em class="italic">User: “I want somewhere with a beach.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, any more details?”</em></p>
    <p class="normal1"><em class="italic">User: “I want there to be at least 25 degrees.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, any more details?”</em></p>
    <p class="normal1"><em class="italic">User: “No, that’s it.”</em></p>
    <p class="normal1"><em class="italic">Agent: “I found three places that match your criteria. Can I present them to you?”</em></p>
    <p class="normal1"><em class="italic">User: “Yes, please.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Here are the three places. Which one do you want to know more about?”</em></p>
    <p class="normal1"><em class="italic">User: “I want the first one.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Here’s more information about the first place.”</em></p>
    <p class="normal1"><em class="italic">User: “Cool, can you book a hotel and flight for the first place?”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, I’ll get that done for you.”</em></p>
    <p class="normal1"><em class="italic">Agent: “I’ve booked the hotel and flight for you.”</em></p>
    <p class="normal1"><em class="italic">User: “Thanks, ooh, I need to rent a car as well.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, any specific car you’re looking for?”</em></p>
    <p class="normal1"><em class="italic">User: “Not really; my budget is $100 per day.”</em></p>
    <p class="normal1"><em class="italic">Agent: “I found five cars that match your criteria. Can I present them to you?”</em></p>
    <p class="normal1"><em class="italic">User: “Yes, please. I want the fifth one.”</em></p>
    <p class="normal1"><em class="italic">Agent: “I’ve booked the car for you.”</em></p>
    <p class="normal1"><em class="italic">Agent: “You’re all set for your vacation.”</em></p>
    <p class="normal1"><em class="italic">User: “Thanks, but wait, I need help booking a restaurant for the first night.”</em></p>
    <p class="normal1">At this point, it stands clear that this conversation can go on for quite a while. The agent needs to remember the context of the conversation and keep track of the state. </p>
    <p class="normal1">There are also many different tasks that the agent needs to delegate to other agents or services, like booking a hotel, flight, car, and restaurant, and the weather API, sightseeing API, and more.</p>
    <p class="normal1">The point is that there’s more<a id="_idIndexMarker991" class="calibre3"/> to an agent than just understanding the initial prompt and delegating the task to another agent or service. You need to think of this conversation as a state machine and an orchestration of different agents and services.</p>
    <h2 class="heading1" id="_idParaDest-478">Modeling advanced conversations</h2>
    <p class="normal">We mentioned that a more advanced conversation <a id="_idIndexMarker992" class="calibre3"/>involves remembering both context and state. Let’s inspect a subset of the example conversation and see how the state changes:</p>
    <p class="normal1"><em class="italic">User: “I want to go on a vacation.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure.”</em></p>
    <p class="normal1">At this point, the agent hasn’t remembered anything more than the user’s intention, which is to go on vacation. It’s just acknowledged the user’s prompt.</p>
    <p class="normal1"><em class="italic">User: “I want to go to a warm place.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, tell me more about what you’re looking for.”</em></p>
    <p class="normal1">Now things are getting interesting. The agent has remembered “warm” as a piece of criteria and needs to translate “warm” into a temperature range it can use to filter out places that are too cold. </p>
    <p class="normal1"><em class="italic">User: “I want somewhere with a beach.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, any more details?”</em></p>
    <p class="normal1">This is another step forward; the agent has remembered “beach” as an additional piece of criteria to use when filtering out places.</p>
    <p class="normal1"><em class="italic">User: “I want it to be at least 25 degrees.”</em></p>
    <p class="normal1">An additional criterion, “25 degrees,” has been added. Let’s see the earlier piece of criteria, “warm,” which was defined as 20–40 Celsius – this adjusts the range to 25–40 Celsius.</p>
    <p class="normal1"><em class="italic">Agent: “Sure, any more details?”</em></p>
    <p class="normal1"><em class="italic">User: “No, that’s it.”</em></p>
    <p class="normal1">At this point, the <a id="_idIndexMarker993" class="calibre3"/>agent recognizes that the user has no more criteria to add, and a search/decision can take place with the filters of “warm,” “beach,” and “25–40 Celsius.” Now, an API is called to get a list of places and the agent can present the list to the user for selection.</p>
    <p class="normal1"><em class="italic">Agent: “I found three places that match your criteria. Can I present them to you?”</em></p>
    <p class="normal1">What’s important to add is that not only are criteria remembered for this specific trip retrieval but they need to be remembered for the next steps as well unless the user changes the criteria.</p>
    <p class="normal1">Hopefully, you can see from the preceding example that the state is built up slowly, and the agent needs to remember the context of the conversation.</p>
    <p class="normal1">It can be helpful to think of a more advanced conversation as consisting of the following steps:</p>
    <ol class="calibre16">
      <li class="bulletlist1" value="1"><strong class="screentext">Input</strong>: The input to the agent, typically in the form of natural language.</li>
      <li class="bulletlist1"><strong class="screentext">Processing</strong>: The processing of the input, typically using NLP techniques.</li>
      <li class="bulletlist1"><strong class="screentext">Determine the next step</strong>: The agent needs to determine the next step in the conversation based on the input and the current state of the conversation. Answers here can be to ask for more information, present a list of options, book something, and so on.</li>
      <li class="bulletlist1"><strong class="screentext">End conversation or continue (ask for user input)</strong>: The agent needs to determine <a id="_idIndexMarker994" class="calibre3"/>whether the conversation should end or continue. If it should continue, it needs to ask for user input. </li>
    </ol>
    <h2 class="heading1" id="_idParaDest-479">Pseudo code for advanced conversations</h2>
    <p class="normal">The agent might have a <a id="_idIndexMarker995" class="calibre3"/>few different states, for example:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Ask for a task</strong>: This would typically be asked when the conversation starts or when a task has been performed and a user selection has been done.</li>
      <li class="bulletlist1"><strong class="screentext">Ask the user for more information on a task:</strong> This would typically be asked before a task is performed to ensure the agent has all the information it needs.</li>
      <li class="bulletlist1"><strong class="screentext">Present a list of options to the user</strong>: This would typically be asked after a task has been performed to present the user with things to choose from.</li>
      <li class="bulletlist1"><strong class="screentext">Perform a task:</strong> Here, the agent would perform a task, like booking a hotel, flight, car, or restaurant.</li>
      <li class="bulletlist1"><strong class="screentext">End the conversation:</strong> The agent moves to this state when the conversation is over, and the user has somehow indicated that the conversation is over.</li>
    </ul>
    <p class="normal1">This is how this might look in pseudo code:</p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># enum</span>
<span class="hljs-keyword">class</span> <span class="hljs-meta">State</span>(<span class="hljs-meta">Enum</span>):
    ASK_FOR_TASK = <span class="hljs-attr">1</span>
    ASK_FOR_MORE_INFORMATION = <span class="hljs-attr">2</span>
    PRESENT_TASK_RESULT = <span class="hljs-attr">3</span>
    PERFORM_TASK = <span class="hljs-attr">4</span>
    END_CONVERSATION = <span class="hljs-attr">5</span>
<span class="hljs-comment"># initial state</span>
state = State.ASK_FOR_TASK
<span class="hljs-keyword">def</span> <span class="hljs-meta">ask_for_task</span>():
    <span class="hljs-comment"># ask the user for a task</span>
    <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">def</span> <span class="hljs-meta">ask_for_more_information</span>(<span>task</span>):
    <span class="hljs-comment"># store filter criteria</span>
    <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">def</span> <span class="hljs-meta">present_task_result</span>(<span>task</span>):
    <span class="hljs-comment"># presents the result so the user can choose</span>
    <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">def</span> <span class="hljs-meta">perform_task</span>(<span>task</span>):
    <span class="hljs-comment"># Perform a task</span>
    <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">def</span> <span class="hljs-meta">end_conversation</span>():
    <span class="hljs-comment"># End the conversation</span>
    <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">while</span> state != State.END_CONVERSATION:
    <span class="hljs-keyword">if</span> state == State.ASK_FOR_TASK:
        <span class="hljs-comment"># Ask for a task</span>
        task = ask_for_task()
        state = State.ASK_FOR_MORE_INFORMATION
    <span class="hljs-keyword">elif</span> state == State.ASK_FOR_MORE_INFORMATION:
        <span class="hljs-comment"># Ask the user for more information on a task</span>
        task = ask_for_more_information(task)
        state = State.PERFORM_TASK
    <span class="hljs-keyword">elif</span> state == State.PRESENT_TASK_RESULT:
        <span class="hljs-comment"># Present a list of options to the user</span>
        task = present_task_result(task)
        state = State.ASK_FOR_MORE_INFORMATION
    <span class="hljs-keyword">elif</span> state == State.PERFORM_TASK:
        <span class="hljs-comment"># Perform a task</span>
        perform_task(task)
        state = State.PRESENT_TASK_RESULT
    <span class="hljs-keyword">elif</span> state == State.END_CONVERSATION:
        <span class="hljs-comment"># End the conversation</span>
        end_conversation() 
</code></pre>
    <p class="normal1">The preceding code is a decent starting point for a more advanced conversation. However, we should remember that humans are not always predictable, and the agent needs to be able to handle the unexpected. For example, humans can change their minds or add new criteria at any point.</p>
    <h1 class="heading" id="_idParaDest-480">Autonomous agents</h1>
    <p class="normal">Autonomous agents<a id="_idIndexMarker996" class="calibre3"/> are agents that can act on their own without human intervention. They can perform tasks, make decisions, and interact with other agents and humans without human input. Autonomous agents can be used in a wide range of applications, from self-driving cars to virtual assistants.</p>
    <p class="normal1">Examples of autonomous agents include the following:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Self-driving cars</strong>: Self-driving cars <a id="_idIndexMarker997" class="calibre3"/>are autonomous agents that <a id="_idIndexMarker998" class="calibre3"/>can drive themselves without human intervention. They can navigate roads, avoid obstacles, and make decisions based on their surroundings.</li>
      <li class="bulletlist1"><strong class="screentext">Virtual assistants</strong>: Virtual assistants<a id="_idIndexMarker999" class="calibre3"/> are autonomous agents that can perform tasks, make decisions, and interact with humans without human input. They can understand natural language, learn from their interactions, and improve their performance over time. Imagine an example of this where you have a financial agent; you might have given it a high-level goal to manage your finances and ensure an 8% value increase per year. You might have given this agent the go-ahead to buy and sell stocks under a certain value but to consultant you on larger purchases and sales over a certain limit. </li>
    </ul>
    <p class="normal1">We are likely to see a rise in both conversational agents as well as autonomous agents in the future. There are a lot of interesting areas where these agents can be used, from customer service to healthcare, finance, and transportation. Imagine having an autonomous agent that can help you with your taxes, book a vacation, or help you with your health while knowing your medical history, your preferences, and more.</p>
    <h1 class="heading" id="_idParaDest-481">Assignment</h1>
    <p class="normal">Given the following conversation, deduce which type of agent is likely involved in the conversation and how would you model the conversation:</p>
    <p class="normal1"><em class="italic">User: “I want to bake a cake.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, what type of cake are you looking to bake?”</em></p>
    <p class="normal1"><em class="italic">User: “I want to make a chocolate cake.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, do you have a recipe in mind?”</em></p>
    <p class="normal1"><em class="italic">User: “No, can you help me find a recipe?”</em></p>
    <p class="normal1"><em class="italic">Agent: “Sure, anything I should know in terms of allergies or preferences?”</em></p>
    <p class="normal1"><em class="italic">User: “I’m allergic to nuts and I prefer a recipe that’s easy to make. Oh, I also want to make a cake that’s vegan.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Got it! I found three recipes that match your criteria. Can I present them?”</em></p>
    <p class="normal1"><em class="italic">User: “Yes, please.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Here are the three recipes. Which one do you want?”</em></p>
    <p class="normal1"><em class="italic">User: “I want number 2.”</em></p>
    <p class="normal1"><em class="italic">Agent: “Is that all?”</em></p>
    <p class="normal1"><em class="italic">User: “No, do I need to buy the ingredients? Also, can you help me set the oven temperature?”</em></p>
    <p class="normal1"><em class="italic">Agent: “Yes, looks like you’re missing a few ingredients. I can help you place an order for the ingredients. I can also help you set the oven temperature. When do you need it set?”</em></p>
    <p class="normal1"><em class="italic">User: “Yes, place the order, and let’s set the oven as soon as the order arrives.”</em></p>
    <p class="normal1"><em class="italic">Agent: “I’ve placed the order and am waiting for the delivery. I’ll set the oven temperature as it arrives.”</em></p>
    <p class="normal1"><em class="italic">User: “Thanks.”</em></p>
    <p class="normal1"><em class="italic">Agent: “You’re welcome, that’s it?”</em></p>
    <p class="normal1"><em class="italic">User: “Yes.”</em></p>
    <h1 class="heading" id="_idParaDest-482">Challenge</h1>
    <p class="normal">Can you think of a problem that can be solved using agents? How would you use agents to solve this problem? What type of agents would you use?</p>
    <h1 class="heading" id="_idParaDest-483">Quiz</h1>
    <p class="normal">Q: What’s tool calling in LLMs?</p>
    <ol class="calibre16">
      <li class="bulletlist1" value="1">It’s when the LLM calls a built-in tool to provide a response.</li>
      <li class="bulletlist1">It’s when you let the LLM know of a new capability by providing it with a function description in JSON and a semantic description that indicates when this function should be called. </li>
      <li class="bulletlist1">It’s when you use functions to fine-tune the LLM.</li>
    </ol>
    <h1 class="heading" id="_idParaDest-484">Summary</h1>
    <p class="normal">In this chapter, we introduced the concept of agents in software development. We explained what agents are and how they work. We discussed the different types of agents and how they can be used. We hope that you now have a glimpse of the future to see where LLMs like GPT are heading and how your future is about to change. </p>
    <h1 class="heading" id="_idParaDest-485">References</h1>
    <p class="normal">It’s worth checking out some resources on agents if you’re curious:</p>
    <ul class="calibre15">
      <li class="bulletlist">Autogen: <a href="https://github.com/microsoft/autogen" class="calibre3"><span class="calibre3">https://github.com/microsoft/autogen</span></a></li>
      <li class="bulletlist1">Semantic Kernel: <a href="https://learn.microsoft.com/en-us/semantic-kernel/overview/" class="calibre3"><span class="calibre3">https://learn.microsoft.com/en-us/semantic-kernel/overview/</span></a></li>
      <li class="bulletlist1">Join our Discord: <a href="https://discord.gg/pAbnFJrkgZ" class="calibre3"><span class="calibre3">https://discord.gg/pAbnFJrkgZ</span></a></li>
    </ul>
    <h1 class="heading" id="_idParaDest-486">Join our community on Discord </h1>
    <p class="normal">Join our community’s Discord space for discussions with the author and other readers: </p>
    <p class="normal1"><a href="https://packt.link/aicode" class="calibre3"><span class="calibre3">https://packt.link/aicode</span></a></p>
    <p class="normal1"><span class="calibre3"><img alt="" src="../Images/QR_Code510410532445718281.png" class="calibre4"/></span></p>
  </div>
</body></html>