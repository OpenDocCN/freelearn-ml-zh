<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch015.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="14" id="chapter-7-vqe-variational-quantum-eigensolver">
<h1 class="H1---Chapter chapterHead" data-number="14"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 7</span></span><br/>
<span id="x1-1190007"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">VQE: Variational Quantum Eigensolver</span></span></h1>
<div class="flushright">
<p><em><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">From so simple a beginning endless forms most beautiful and most</span></em> <em><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">wonderful have been, and are being, evolved.</span></em><br/><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">
— Charles Darwin</span></p>
</div>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">In the previous chapters of this part of the book, we have studied how quantum algorithms can help us solve combinatorial optimization problems, but there are many other important types of optimization problems out there! </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">This chapter will broaden the scope of our optimization methods to cover more general settings, including applications in fields such as chemistry and physics.</span></p>
<p><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">We will achieve this by studying the famous </span><strong><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Variational Quantum</span></strong> <strong><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">Eigensolver</span></strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">VQE</span></strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">) algorithm, which can be </span><span id="dx1-119001"/><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">seen as a generalization of the Quantum Approximate Optimization Algorithm that we studied back in </span><em><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.18.2" xmlns="http://www.w3.org/1999/xhtml">Actually, it would be more precise to say that we can see QAOA as a particular case of VQE; in fact, VQE was introduced earlier than QAOA in a now famous paper by Peruzzo et al. </span><span class="cite"><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xperuzzo2014variational"><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">76</span></a><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">We shall begin by expanding our knowledge of Hamiltonians and by better understanding how to estimate their expectation values with quantum computers. </span><span class="koboSpan" id="kobo.23.2" xmlns="http://www.w3.org/1999/xhtml">That will allow us to define VQE in all its glory and to appreciate both the simplicity of its formulation and its wide applicability for finding the ground state of different types of Hamiltonians.</span></p>
<p><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">We will then show how to use VQE with both Qiskit and PennyLane using examples from the field of chemistry. </span><span class="koboSpan" id="kobo.24.2" xmlns="http://www.w3.org/1999/xhtml">We will also show how to study the influence of errors on the algorithm by running simulations of noisy quantum computers, and we will even discuss some techniques to mitigate the adverse effect of readout errors.</span></p>
<p><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">After reading this chapter, you will know both the theoretical foundations of VQE and how to use it in a wide variety of practical situations, on simulators and on actual quantum computers.</span></p>
<p><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">The topics that we will cover in this chapter are as follows:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians, observables, and their expectation values</span></p></li>
<li><p><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">Introducing the Variational Quantum Eigensolver</span></p></li>
<li><p><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with Qiskit</span></p></li>
<li><p><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with PennyLane</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">We have quite a lot to learn and, in fact, endless forms most beautiful to discover. </span><span class="koboSpan" id="kobo.31.2" xmlns="http://www.w3.org/1999/xhtml">So, let’s not waste time and get started right away!</span></p>
<section class="level2 sectionHead" data-number="14.1" id="hamiltonians-observables-and-their-expectation-values">
<h1 class="sectionHead" data-number="14.1"><span class="titlemark"><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">7.1 </span></span> <span id="x1-1200007.1"><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians, observables, and their expectation values</span></span></h1>
<p><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">So far, we’ve found in </span><span id="dx1-120001"/><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians a way to encode combinatorial optimization problems. </span><span class="koboSpan" id="kobo.35.2" xmlns="http://www.w3.org/1999/xhtml">As you surely remember, in these optimization problems, we start with a function </span><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml"> that assigns real numbers to binary strings of a certain length </span><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">, and we seek to find a binary string </span><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml"> with minimum cost </span><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.43.2" xmlns="http://www.w3.org/1999/xhtml">In order to do that with quantum algorithms, we define a Hamiltonian </span><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{f}" class="math inline" src="../media/file933.png" style="vertical-align:middle" title="H_{f}"/></span><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml"> such that</span></p>
<p><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{f}\left| x \right\rangle = f(x)" class="math display" src="../media/file934.png" style="vertical-align:middle" title="\left\langle x \right|H_{f}\left| x \right\rangle = f(x)"/></span></p>
<p><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">holds for every binary string </span><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml"> of length </span><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.51.2" xmlns="http://www.w3.org/1999/xhtml">Then, we can solve our original problem by finding a ground state of </span><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{f}" class="math inline" src="../media/file933.png" style="vertical-align:middle" title="H_{f}"/></span><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"> (that is, a state </span><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"> such that the expectation value </span><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{f}\left| \psi \right\rangle" class="math inline" src="../media/file935.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{f}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml"> is minimum).</span></p>
<p><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">This was just a very quick summary of </span><em><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">Working with</span></em> <em><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">Quadratic Unconstrained Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.64.2" xmlns="http://www.w3.org/1999/xhtml">When you read that chapter, you may have noticed that the Hamiltonian associated to </span><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml"> has an additional, very remarkable property. </span><span class="koboSpan" id="kobo.66.2" xmlns="http://www.w3.org/1999/xhtml">We have mentioned this a couple of times already, but it is worth remembering that, for every computational basis state </span><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that</span></p>
<p><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{f}\left| x \right\rangle = f(x)\left| x \right\rangle." class="math display" src="../media/file936.png" style="vertical-align:middle" title="H_{f}\left| x \right\rangle = f(x)\left| x \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">This means that each </span><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml"> is an eigenvector of </span><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{f}" class="math inline" src="../media/file933.png" style="vertical-align:middle" title="H_{f}"/></span><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml"> with associated eigenvalue </span><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"> (if you do not remember what eigenvectors and eigenvalues are, check </span><em><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch025.xhtml#x1-226000B"><em><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">B</span></em></a><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">, for all the relevant definitions and concepts). </span><span id="dx1-120002"/><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">In fact, this is easy to see because we have always used Hamiltonians that are sums of tensor products of </span><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> matrices, which are clearly diagonal. </span><span class="koboSpan" id="kobo.84.2" xmlns="http://www.w3.org/1999/xhtml">But tensor products of diagonal matrices are diagonal matrices themselves, and sums of diagonal matrices are still diagonal. </span><span class="koboSpan" id="kobo.84.3" xmlns="http://www.w3.org/1999/xhtml">Thus, since these Hamiltonians are diagonal, the computational basis states are their eigenvectors.</span></p>
<p><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">What is more, if we have a state </span><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">, we can always write it as a linear combination of the computational basis states. </span><span class="koboSpan" id="kobo.87.2" xmlns="http://www.w3.org/1999/xhtml">In fact, it holds that</span></p>
<p><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = \sum\limits_{x}\alpha_{x}\left| x \right\rangle," class="math display" src="../media/file937.png" style="vertical-align:middle" title="\left| \psi \right\rangle = \sum\limits_{x}\alpha_{x}\left| x \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">where the sum is over all the computational basis states </span><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\alpha_{x} = \left\langle x \middle| \psi \right\rangle" class="math inline" src="../media/file938.png" style="vertical-align:middle" title="\alpha_{x} = \left\langle x \middle| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.93.2" xmlns="http://www.w3.org/1999/xhtml">This is easy to check, because</span></p>
<p><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \middle| \psi \right\rangle = \left\langle x \right|\sum\limits_{y}\alpha_{y}\left| y \right\rangle = \sum\limits_{y}\alpha_{y}\left\langle x \middle| y \right\rangle = \alpha_{x}." class="math display" src="../media/file939.png" style="vertical-align:middle" title="\left\langle x \middle| \psi \right\rangle = \left\langle x \right|\sum\limits_{y}\alpha_{y}\left| y \right\rangle = \sum\limits_{y}\alpha_{y}\left\langle x \middle| y \right\rangle = \alpha_{x}."/></span></p>
<p><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">The last identity follows from the fact that </span><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \middle| y \right\rangle" class="math inline" src="../media/file940.png" style="vertical-align:middle" title="\left\langle x \middle| y \right\rangle"/></span><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = y" class="math inline" src="../media/file941.png" style="vertical-align:middle" title="x = y"/></span><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise (remember that the computational basis is an orthonormal basis).</span></p>
<p><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">Then, the expectation value of </span><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{f}" class="math inline" src="../media/file933.png" style="vertical-align:middle" title="H_{f}"/></span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"> in the state </span><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml"> can be computed as</span></p>
<p><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlr} {\left\langle \psi \right|H_{f}\left| \psi \right\rangle = \sum\limits_{y}\alpha_{y}^{\ast}\left\langle y \right|H_{f}\sum\limits_{x}\alpha_{x}\left| x \right\rangle = \sum\limits_{x,y}\alpha_{y}^{\ast}\alpha_{x}\left\langle y \right|H_{f}\left| x \right\rangle = \sum\limits_{x,y}\alpha_{y}^{\ast}\alpha_{x}f(x)\left\langle y \middle| x \right\rangle} &amp; \qquad &amp; \\ {= \sum\limits_{x}\alpha_{x}^{\ast}\alpha_{x}f(x) = \sum\limits_{x}\left| \alpha_{x} \right|^{2}f(x).} &amp; \qquad &amp; \\ \end{array}" class="math display" src="../media/file942.png" style="vertical-align:middle" title="\begin{array}{rlr} {\left\langle \psi \right|H_{f}\left| \psi \right\rangle = \sum\limits_{y}\alpha_{y}^{\ast}\left\langle y \right|H_{f}\sum\limits_{x}\alpha_{x}\left| x \right\rangle = \sum\limits_{x,y}\alpha_{y}^{\ast}\alpha_{x}\left\langle y \right|H_{f}\left| x \right\rangle = \sum\limits_{x,y}\alpha_{y}^{\ast}\alpha_{x}f(x)\left\langle y \middle| x \right\rangle} &amp; \qquad &amp; \\ {= \sum\limits_{x}\alpha_{x}^{\ast}\alpha_{x}f(x) = \sum\limits_{x}\left| \alpha_{x} \right|^{2}f(x).} &amp; \qquad &amp; \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">Moreover, we know that </span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \alpha_{x} \right|^{2} = \left| \left\langle x \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file943.png" style="vertical-align:middle" title="\left| \alpha_{x} \right|^{2} = \left| \left\langle x \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"> is the probability of obtaining </span><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"> when measuring </span><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml"> in the computational basis; in this way, the expectation value matches the statistical expected value of the measurement. </span><span class="koboSpan" id="kobo.116.2" xmlns="http://www.w3.org/1999/xhtml">As you surely remember, this is exactly the fact that we used back in </span><em><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate</span></em> <em><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">Optimization Algorithm</span></em><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">, to estimate the value of the cost function when running QAOA circuits in a quantum computer.</span></p>
<p><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">These properties may seem dependent on the particular form of the </span><span id="dx1-120003"/><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians that we have been using. </span><span class="koboSpan" id="kobo.124.2" xmlns="http://www.w3.org/1999/xhtml">But, in fact, they are very general results, and we will use them extensively in our study of the VQE algorithm. </span><span class="koboSpan" id="kobo.124.3" xmlns="http://www.w3.org/1999/xhtml">But before we get to that, we will need to introduce the general notion of ”observable”, which is precisely the topic of the next subsection.</span></p>
<section class="level3 subsectionHead" data-number="14.1.1" id="observables">
<h2 class="subsectionHead" data-number="14.1.1"><span class="titlemark"><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">7.1.1 </span></span> <span id="x1-1210007.1.1"><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">Observables</span></span></h2>
<p><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Up until this point, we have only </span><span id="dx1-121001"/><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">considered measurements in the computational basis. </span><span class="koboSpan" id="kobo.128.2" xmlns="http://www.w3.org/1999/xhtml">This has worked well enough for our purposes, but, in doing so, we’ve ignored some details about how measurements are truly understood and described in quantum mechanics. </span><span class="koboSpan" id="kobo.128.3" xmlns="http://www.w3.org/1999/xhtml">We are now going to fill that gap.</span></p>
<p><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">We encourage you to go slowly through this section. </span><span class="koboSpan" id="kobo.129.2" xmlns="http://www.w3.org/1999/xhtml">Take your time and maybe prepare yourself a good cup of your favourite hot beverage. </span><span class="koboSpan" id="kobo.129.3" xmlns="http://www.w3.org/1999/xhtml">The ideas presented here may seem a little bit strange at first, but you will soon realize that they fit nicely with what we have been doing so far.</span></p>
<p><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">In quantum mechanics, any physical </span><span id="dx1-121002"/><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">magnitude that you can measure — also known as a </span><strong><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">(physical) observable</span></strong><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml"> — is </span><span id="dx1-121003"/><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">represented by a Hermitian operator. </span><span class="koboSpan" id="kobo.134.2" xmlns="http://www.w3.org/1999/xhtml">In case you don’t remember, these are linear operators </span><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"> that are equal to their adjoints (their conjugate transposes), that is, they satisfy </span><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A^{\dagger} = A" class="math inline" src="../media/file944.png" style="vertical-align:middle" title="A^{\dagger} = A"/></span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-127">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">You may remember how in </span><em><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic</span></em> <em><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">Unconstrained Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">, we worked extensively with Hamiltonians. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">These, in general, are Hermitian operators that are, indeed, associated with an observable magnitude. </span><span class="koboSpan" id="kobo.147.3" xmlns="http://www.w3.org/1999/xhtml">That magnitude is none other than the energy of the system!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">The nice thing about </span><span id="dx1-121004"/><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">Hermitian operators is that, for them, one can always find an orthonormal basis of eigenvectors with real eigenvalues (please, check </span><em><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch025.xhtml#x1-226000B"><em><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">B</span></em></a><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml">Basic Linear Algebra</span></em><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">, if you need to review these notions). </span><span class="koboSpan" id="kobo.154.2" xmlns="http://www.w3.org/1999/xhtml">This means that there exist real numbers </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 1,\ldots,l" class="math inline" src="../media/file946.png" style="vertical-align:middle" title="j = 1,\ldots,l"/></span><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">, all of them different, and states </span><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file947.png" style="vertical-align:middle" title="\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 1,\ldots,l" class="math inline" src="../media/file946.png" style="vertical-align:middle" title="j = 1,\ldots,l"/></span><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k = 1,\ldots,r_{j}" class="math inline" src="../media/file948.png" style="vertical-align:middle" title="k = 1,\ldots,r_{j}"/></span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">, such that the states </span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file949.png" style="vertical-align:middle" title="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml"> form an orthonormal basis and</span></p>
<p><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle," class="math display" src="../media/file950.png" style="vertical-align:middle" title="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">for every </span><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 1,\ldots,l" class="math inline" src="../media/file946.png" style="vertical-align:middle" title="j = 1,\ldots,l"/></span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"> and for every </span><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k = 1,\ldots,r_{j}" class="math inline" src="../media/file948.png" style="vertical-align:middle" title="k = 1,\ldots,r_{j}"/></span><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">Here, we are considering the possibility of having several eigenvectors </span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file947.png" style="vertical-align:middle" title="\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml"> associated with the same eigenvalue </span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">, hence the use of the superindices </span><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k = 1,\ldots,r_{j}" class="math inline" src="../media/file948.png" style="vertical-align:middle" title="k = 1,\ldots,r_{j}"/></span><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="r_{j}" class="math inline" src="../media/file951.png" style="vertical-align:middle" title="r_{j}"/></span><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"> is the number of eigenvectors associated with the </span><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}^{k}" class="math inline" src="../media/file952.png" style="vertical-align:middle" title="\lambda_{j}^{k}"/></span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"> eigenvalue. </span><span class="koboSpan" id="kobo.183.2" xmlns="http://www.w3.org/1999/xhtml">If all the eigenvalues are different (a quite common case), then we will have </span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="r_{j} = 1" class="math inline" src="../media/file953.png" style="vertical-align:middle" title="r_{j} = 1"/></span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"> for every </span><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml"> and we can simply drop the </span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"> superindices.</span></p>
<p><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">What is the connection of these Hermitian operators with physical measurements? </span><span class="koboSpan" id="kobo.190.2" xmlns="http://www.w3.org/1999/xhtml">Let’s consider an observable represented by a Hermitian operator </span><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">, and also an orthonormal basis of eigenvectors </span><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file949.png" style="vertical-align:middle" title="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file954.png" style="vertical-align:middle" title="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.196.2" xmlns="http://www.w3.org/1999/xhtml">This representation must be chosen to take the following into account:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">The possible outcomes of the measurement of the observable must be represented by the different eigenvalues </span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span></p></li>
<li><p><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">The probability that a state </span><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"> will, upon measurement, yield </span><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml"> must be </span><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file955.png" style="vertical-align:middle" title="{\sum}_{k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">All of this is axiomatic. </span><span class="koboSpan" id="kobo.205.2" xmlns="http://www.w3.org/1999/xhtml">It is a fact of life that any physical observable can be represented by a Hermitian operator in such a way that those are </span><span id="dx1-121005"/><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">requirements are satisfied. </span><span class="koboSpan" id="kobo.206.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, it is a postulate of quantum mechanics that if the measurement returns the result associated to an eigenvalue </span><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">, the state of the system will then become the normalized projection of </span><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"> onto the space of eigenvectors with eigenvalue </span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.212.2" xmlns="http://www.w3.org/1999/xhtml">This means that if we measure a state in a superposition such as</span></p>
<p><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{j,k}\alpha_{j}^{k}\left| \lambda_{j}^{k} \right\rangle" class="math display" src="../media/file956.png" style="vertical-align:middle" title="\sum\limits_{j,k}\alpha_{j}^{k}\left| \lambda_{j}^{k} \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">and we obtain </span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"> as the result, then the new state will be</span></p>
<p><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{\sum\limits_{k}\alpha_{j}^{k}\left| \lambda_{j}^{k} \right\rangle}{\sqrt{\sum\limits_{k}\left| \alpha_{j}^{k} \right|^{2}}}." class="math display" src="../media/file957.png" style="vertical-align:middle" title="\frac{\sum\limits_{k}\alpha_{j}^{k}\left| \lambda_{j}^{k} \right\rangle}{\sqrt{\sum\limits_{k}\left| \alpha_{j}^{k} \right|^{2}}}."/></span></p>
<p><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">This is what we call the </span><em><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">collapse</span></em><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml"> of the original state and it is exactly the same phenomenon that we considered when studied measurements in the computational basis back in </span><em><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch008.xhtml#x1-180001"><em><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">1</span></em></a><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">Foundations of Quantum</span></em> <em><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml">Computing</span></em><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">The word ”observable” is often used for both physical observables and for any Hermitian operators that represent them. </span><span class="koboSpan" id="kobo.227.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we may refer to a Hermitian operator itself as an observable. </span><span class="koboSpan" id="kobo.227.3" xmlns="http://www.w3.org/1999/xhtml">To avoid confusions, we will usually not omit the ”physical” adjective when referring to physical observables.</span></p>
<p><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">As a simple example, whenever we measure in the computational basis, we are indeed measuring some physical observable, and this physical observable can, of course, be represented by a Hermitian operator. </span><span class="koboSpan" id="kobo.228.2" xmlns="http://www.w3.org/1999/xhtml">This is, in a certain sense, the simplest observable in quantum computing and it is natural that it arises as a particular case of this, more general theory of quantum measurements.</span></p>
<p><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-121006"/><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">coordinated matrix of this measurement operator with respect to the computational basis could be the diagonal matrix</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 0 &amp; &amp; &amp; \\ &amp; 1 &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; {2^{n} - 1} \\ \end{pmatrix}." class="math display" src="../media/file958.png" style="vertical-align:middle" title="\begin{pmatrix} 0 &amp; &amp; &amp; \\  &amp; 1 &amp; &amp; \\  &amp; &amp; \ddots &amp; \\  &amp; &amp; &amp; {2^{n} - 1} \\ \end{pmatrix}."/></span></td>
</tr>
</tbody>
</table>
<div class="tcolorbox questionx" id="tcolobox-128">
<span id="x1-121008x7.1.1"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.1</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">Prove that, indeed, the previous matrix is the coordinate matrix on the computational basis of a Hermitian operator that represents a measurement in the computational basis.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">When we measure a single qubit in the computational basis, the coordinate matrix with respect to the computational basis of the associated Hermitian operator could well be either of</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N = \begin{pmatrix} 0 &amp; 0 \\ 0 &amp; 1 \\ \end{pmatrix},\qquad Z = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}." class="math display" src="../media/file959.png" style="vertical-align:middle" title="N = \begin{pmatrix} 0 &amp; 0 \\ 0 &amp; 1 \\ \end{pmatrix},\qquad Z = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">Yes, that last matrix was the unmistakable Pauli </span><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml"> matrix. </span><span class="koboSpan" id="kobo.238.2" xmlns="http://www.w3.org/1999/xhtml">Both of these operators represent the same observable; they only differ in the eigenvalues that they associate to the distinct possible outcomes. </span><span class="koboSpan" id="kobo.238.3" xmlns="http://www.w3.org/1999/xhtml">The first operator associates the eigenvalues </span><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"> to the qubit’s value being </span><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml"> respectively, while the second observable associates the eigenvalues </span><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml"> to these outcomes.</span></p>
<div class="tcolorbox important" id="tcolobox-129">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">Measurements in quantum mechanics are represented by Hermitian operators, which we refer to as observables. </span><span class="koboSpan" id="kobo.252.2" xmlns="http://www.w3.org/1999/xhtml">One possible operator corresponding to measuring a qubit in the computational basis can be the Pauli </span><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml"> matrix.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know what an </span><span id="dx1-121009"/><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">observable is, we can study what its </span><strong><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">expectation</span></strong> <strong><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">value</span></strong><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"> is and how it can be computed. </span><span class="koboSpan" id="kobo.259.2" xmlns="http://www.w3.org/1999/xhtml">The expectation value of any </span><span id="dx1-121010"/><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">observable under a state </span><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml"> can be defined as</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j}," class="math display" src="../media/file960.png" style="vertical-align:middle" title="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j},"/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">which is a natural definition that agrees with the statistical expected value of the results obtained when we measure </span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> according to </span><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.268.2" xmlns="http://www.w3.org/1999/xhtml">As intuitive as this expression may be, we can further simplify it as follows:</span></p>
<p><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\langle A\rangle}_{\psi} &amp; {= \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} = \sum\limits_{j,k}\left\langle \psi \middle| \lambda_{j}^{k} \right\rangle\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\lambda_{j} = \sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left\langle \psi \middle| \lambda_{j}^{k} \right\rangle\lambda_{j}\qquad} &amp; &amp; \qquad \\ &amp; {= \sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left\langle \psi \right|A\left| \lambda_{j}^{k} \right\rangle = \left\langle \psi \right|A\sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left| \lambda_{j}^{k} \right\rangle = \left\langle \psi \right|A\left| \psi \right\rangle.\qquad} &amp; &amp; \qquad \\ &amp; \qquad &amp; &amp; \\ \end{array}" class="math display" src="../media/file961.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\langle A\rangle}_{\psi} &amp; {= \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} = \sum\limits_{j,k}\left\langle \psi \middle| \lambda_{j}^{k} \right\rangle\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\lambda_{j} = \sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left\langle \psi \middle| \lambda_{j}^{k} \right\rangle\lambda_{j}\qquad} &amp; &amp; \qquad \\  &amp; {= \sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left\langle \psi \right|A\left| \lambda_{j}^{k} \right\rangle = \left\langle \psi \right|A\sum\limits_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left| \lambda_{j}^{k} \right\rangle = \left\langle \psi \right|A\left| \psi \right\rangle.\qquad} &amp; &amp; \qquad \\  &amp; \qquad &amp; &amp; \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we have used the fact that </span><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file954.png" style="vertical-align:middle" title="A\left| \lambda_{j}^{k} \right\rangle = \lambda_{j}\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = {\sum}_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file962.png" style="vertical-align:middle" title="\left| \psi \right\rangle = {\sum}_{j,k}\left\langle \lambda_{j}^{k} \middle| \psi \right\rangle\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.274.2" xmlns="http://www.w3.org/1999/xhtml">This latter identity follows from the fact that </span><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file949.png" style="vertical-align:middle" title="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml"> is an orthonormal basis and, in fact, it can be proved in exactly the same way we did for the computational basis at the beginning of this section.</span></p>
<p><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">This expression for the expectation value agrees with our previous work in </span><em><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained Binary Optimization</span></em> <em><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml">Problems</span></em><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox important" id="tcolobox-130">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">The expectation value of any Hermitian operator (observable) </span><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml"> is given by</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} = \left\langle \psi \right|A\left| \psi \right\rangle." class="math display" src="../media/file963.png" style="vertical-align:middle" title="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} = \left\langle \psi \right|A\left| \psi \right\rangle."/></span></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, from the very definition of the expectation value of an observable, we can easily derive the variational principle. </span><span class="koboSpan" id="kobo.289.2" xmlns="http://www.w3.org/1999/xhtml">This principle states, as you may recall from </span><em><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained Binary</span></em> <em><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">Optimization Problems</span></em><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">, that the smallest expectation value of an observable </span><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml"> is always achieved at an eigenvector of that observable. </span><span class="koboSpan" id="kobo.297.2" xmlns="http://www.w3.org/1999/xhtml">To prove it, suppose that </span><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{0}" class="math inline" src="../media/file964.png" style="vertical-align:middle" title="\lambda_{0}"/></span><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml"> is minimal among all the eigenvalues of </span><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.301.2" xmlns="http://www.w3.org/1999/xhtml">Then, for any state </span><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\psi" class="math inline" src="../media/file965.png" style="vertical-align:middle" title="\psi"/></span><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"> it holds that</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} \geq \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{0} = \lambda_{0}," class="math display" src="../media/file966.png" style="vertical-align:middle" title="{\langle A\rangle}_{\psi} = \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j} \geq \sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{0} = \lambda_{0},"/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">where the last equality follows from the fact that </span><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2} = 1" class="math inline" src="../media/file967.png" style="vertical-align:middle" title="{\sum}_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2} = 1"/></span><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">, since the sum of the probabilities of all the outcomes must add up to </span><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">If we now take any eigenvector </span><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{0}^{k} \right\rangle" class="math inline" src="../media/file968.png" style="vertical-align:middle" title="\left| \lambda_{0}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml"> associated to </span><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{0}" class="math inline" src="../media/file964.png" style="vertical-align:middle" title="\lambda_{0}"/></span><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">, its expectation value will be</span></p>
<p><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \lambda_{0}^{k} \right|A\left| \lambda_{0}^{k} \right\rangle = \lambda_{0}\left\langle \lambda_{0}^{k} \middle| \lambda_{0}^{k} \right\rangle = \lambda_{0}," class="math display" src="../media/file969.png" style="vertical-align:middle" title="\left\langle \lambda_{0}^{k} \right|A\left| \lambda_{0}^{k} \right\rangle = \lambda_{0}\left\langle \lambda_{0}^{k} \middle| \lambda_{0}^{k} \right\rangle = \lambda_{0},"/></span></p>
<p><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">proving that the </span><span id="dx1-121011"/><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">minimum expectation value is indeed achieved at an eigenvector of </span><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.319.2" xmlns="http://www.w3.org/1999/xhtml">Obviously, if there were several orthogonal eigenvectors associated to </span><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{0}" class="math inline" src="../media/file964.png" style="vertical-align:middle" title="\lambda_{0}"/></span><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">, any normalized linear combination of them would also be a ground state of </span><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">In this subsection, we have studied the mathematical expression for the expectation of any observable. </span><span class="koboSpan" id="kobo.324.2" xmlns="http://www.w3.org/1999/xhtml">But we don’t yet know how to estimate these expectation values with quantum computers. </span><span class="koboSpan" id="kobo.324.3" xmlns="http://www.w3.org/1999/xhtml">How could we do that? </span><span class="koboSpan" id="kobo.324.4" xmlns="http://www.w3.org/1999/xhtml">Just keep reading, because we will be exploring it in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.1.2" id="estimating-the-expectation-values-of-observables">
<h2 class="subsectionHead" data-number="14.1.2"><span class="titlemark"><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml">7.1.2 </span></span> <span id="x1-1220007.1.2"><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">Estimating the expectation values of observables</span></span></h2>
<p><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">In the context of the VQE algorithm, we will need to estimate the </span><span id="dx1-122001"/><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">expectation value of a general observable </span><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.330.2" xmlns="http://www.w3.org/1999/xhtml">That is, we will no </span><span id="dx1-122002"/><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">longer assume that </span><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> is diagonal, as we have done in all the previous chapters. </span><span class="koboSpan" id="kobo.333.2" xmlns="http://www.w3.org/1999/xhtml">For this reason, we will need to develop a new method for estimating the expectation value </span><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|A\left| \psi \right\rangle" class="math inline" src="../media/file970.png" style="vertical-align:middle" title="\left\langle \psi \right|A\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">We know that, for a given state </span><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">, the expectation value of </span><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml"> can be computed by</span></p>
<p><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j}." class="math display" src="../media/file971.png" style="vertical-align:middle" title="\sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j}."/></span></p>
<p><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">Thus, if we knew the eigenvalues </span><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"> and the eigenvectors </span><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file949.png" style="vertical-align:middle" title="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">, we could try to compute </span><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml"> and, hence, the expectation value of </span><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.352.2" xmlns="http://www.w3.org/1999/xhtml">However, this is information that we usually don’t know. </span><span class="koboSpan" id="kobo.352.3" xmlns="http://www.w3.org/1999/xhtml">In fact, the purpose of VQE is, precisely, finding certain eigenvalues and </span><span id="dx1-122003"/><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">eigenvectors of a Hamiltonian! </span><span class="koboSpan" id="kobo.353.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, the number of eigenvectors grows exponentially with the number of qubits of our system, so, even if we knew them, computing </span><span id="dx1-122004"/><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">expectation values in this way might be very computationally expensive.</span></p>
<p><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">Thus, we need to take an indirect route. </span><span class="koboSpan" id="kobo.355.2" xmlns="http://www.w3.org/1999/xhtml">For this, we will use the fact that we can always express an observable </span><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"> on </span><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml"> qubits as a linear combination of tensor products of Pauli matrices (see, for example, </span><em><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 7</span></em><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> on the famous lecture notes by John Preskill </span><span class="cite"><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xpreskill1998lecture"><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">77</span></a><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.365.2" xmlns="http://www.w3.org/1999/xhtml">Actually, </span><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"> will be, in most cases, given to us in such a form, in the same way that the Hamiltonians of our combinatorial optimization problems were always expressed as sums of tensor products of </span><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"> matrices.</span></p>
<p><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">So, consider, for example, that we are given an observable</span></p>
<p><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A = \frac{1}{2}Z \otimes I \otimes X - 3I \otimes Y \otimes Y + 2Z \otimes X \otimes Z." class="math display" src="../media/file973.png" style="vertical-align:middle" title="A = \frac{1}{2}Z \otimes I \otimes X - 3I \otimes Y \otimes Y + 2Z \otimes X \otimes Z."/></span></p>
<p><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, thanks to linearity,</span></p>
<p><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle \psi \right|A\left| \psi \right\rangle} &amp; {= \left\langle \psi \right|\left( {\frac{1}{2}Z \otimes I \otimes X - 3I \otimes Y \otimes Y + 2Z \otimes X \otimes Z} \right)\left| \psi \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {= \left\langle \psi \right|\left( {\frac{1}{2}\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle - 3\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle + 2\left( {Z \otimes X \otimes Z} \right)\left| \psi \right\rangle} \right)\qquad} &amp; &amp; \qquad \\ &amp; {= \frac{1}{2}\left\langle \psi \right|\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle - 3\left\langle \psi \right|\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle + 2\left\langle \psi \right|\left( {Z \otimes X \otimes Z} \right)\left| \psi \right\rangle.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file974.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle \psi \right|A\left| \psi \right\rangle} &amp; {= \left\langle \psi \right|\left( {\frac{1}{2}Z \otimes I \otimes X - 3I \otimes Y \otimes Y + 2Z \otimes X \otimes Z} \right)\left| \psi \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {= \left\langle \psi \right|\left( {\frac{1}{2}\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle - 3\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle + 2\left( {Z \otimes X \otimes Z} \right)\left| \psi \right\rangle} \right)\qquad} &amp; &amp; \qquad \\  &amp; {= \frac{1}{2}\left\langle \psi \right|\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle - 3\left\langle \psi \right|\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle + 2\left\langle \psi \right|\left( {Z \otimes X \otimes Z} \right)\left| \psi \right\rangle.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">Then, in order to compute the expectation value of </span><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">, we can compute the expectation values of </span><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes Y \otimes Y" class="math inline" src="../media/file976.png" style="vertical-align:middle" title="I \otimes Y \otimes Y"/></span><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml"> and combine their results. </span><span class="koboSpan" id="kobo.382.2" xmlns="http://www.w3.org/1999/xhtml">But wait a minute! </span><span class="koboSpan" id="kobo.382.3" xmlns="http://www.w3.org/1999/xhtml">Isn’t that even more complicated? </span><span class="koboSpan" id="kobo.382.4" xmlns="http://www.w3.org/1999/xhtml">After all, we would need to compute three expectation values instead of just one, right?</span></p>
<p><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml">The key </span><span id="dx1-122005"/><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">observation here lies in the fact that, while we may not know the eigenvalues and eigenvectors of </span><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml"> in advance, we can very easily obtain those of </span><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml"> or any other tensor product of Pauli matrices. </span><span class="koboSpan" id="kobo.388.2" xmlns="http://www.w3.org/1999/xhtml">It is so easy, in fact, that you will now learn how to do it yourself in the </span><span id="dx1-122006"/><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">following two exercises.</span></p>
<div class="tcolorbox questionx" id="tcolobox-131">
<span id="x1-122008x7.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.2</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">Suppose that </span><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j} \right\rangle" class="math inline" src="../media/file978.png" style="vertical-align:middle" title="\left| \lambda_{j} \right\rangle"/></span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"> is an eigenvector of </span><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{j}" class="math inline" src="../media/file979.png" style="vertical-align:middle" title="A_{j}"/></span><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml"> with associated eigenvalue </span><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 1,\ldots,n" class="math inline" src="../media/file980.png" style="vertical-align:middle" title="j = 1,\ldots,n"/></span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.399.2" xmlns="http://www.w3.org/1999/xhtml">Prove that </span><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle \otimes \cdots \otimes \left| \lambda_{n} \right\rangle" class="math inline" src="../media/file981.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle \otimes \cdots \otimes \left| \lambda_{n} \right\rangle"/></span><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml"> is an eigenvector of </span><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{1} \otimes \cdots \otimes A_{n}" class="math inline" src="../media/file982.png" style="vertical-align:middle" title="A_{1} \otimes \cdots \otimes A_{n}"/></span><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml"> with associated eigenvalue </span><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{1} \cdot \ldots \cdot \lambda_{n}" class="math inline" src="../media/file983.png" style="vertical-align:middle" title="\lambda_{1} \cdot \ldots \cdot \lambda_{n}"/></span><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<div class="tcolorbox questionx" id="tcolobox-132">
<span id="x1-122018x7.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.3</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">Prove that:</span></p>
<ol>
<li><div id="x1-122011x1">
<p><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">The eigenvectors of </span><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
</div></li>
<li><div id="x1-122013x2">
<p><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">The eigenvectors of </span><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| + \right\rangle" class="math inline" src="../media/file61.png" style="vertical-align:middle" title="\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| - \right\rangle" class="math inline" src="../media/file63.png" style="vertical-align:middle" title="\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
</div></li>
<li><div id="x1-122015x3">
<p><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">The eigenvectors of </span><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y" class="math inline" src="../media/file11.png" style="vertical-align:middle" title="Y"/></span><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file984.png" style="vertical-align:middle" title="\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file985.png" style="vertical-align:middle" title="\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml"> (with associated eigenvalue </span><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
</div></li>
<li><div id="x1-122017x4">
<p><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">Any non-null state is an eigenvector of </span><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"> with associated eigenvalue </span><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div></li>
</ol>
</div>
</div>
<p><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">Using the results in these exercises, we can readily deduce that </span><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file986.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| - \right\rangle\left| 1 \right\rangle" class="math inline" src="../media/file987.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| - \right\rangle\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| + \right\rangle\left| 1 \right\rangle" class="math inline" src="../media/file988.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| + \right\rangle\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| - \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file989.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| - \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml"> are eigenvectors of </span><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml"> with eigenvalue </span><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| + \right\rangle\left| 1 \right\rangle" class="math inline" src="../media/file990.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| + \right\rangle\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| - \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file991.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| - \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| + \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file992.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| + \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle" class="math inline" src="../media/file993.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml"> are eigenvectors of </span><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"> with eigenvalue </span><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.470.2" xmlns="http://www.w3.org/1999/xhtml">All these states together form an orthonormal basis of eigenvectors of </span><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">, as you can easily check if you compute their inner products.</span></p>
<div class="tcolorbox questionx" id="tcolobox-133">
<span id="x1-122020x7.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.4</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">Find orthonormal bases of eigenvectors for </span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes Y \otimes Y" class="math inline" src="../media/file976.png" style="vertical-align:middle" title="I \otimes Y \otimes Y"/></span><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.478.2" xmlns="http://www.w3.org/1999/xhtml">Compute their associated eigenvalues.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">So, now we know how to obtain the eigenvalues and eigenvectors of any tensor product of Pauli matrices. </span><span class="koboSpan" id="kobo.479.2" xmlns="http://www.w3.org/1999/xhtml">How can we use this to </span><span id="dx1-122021"/><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml">estimate their </span><span id="dx1-122022"/><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">expectation values? </span><span class="koboSpan" id="kobo.481.2" xmlns="http://www.w3.org/1999/xhtml">Remember that, given a Hermitian matrix </span><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml">, we can compute </span><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|A\left| \psi \right\rangle" class="math inline" src="../media/file970.png" style="vertical-align:middle" title="\left\langle \psi \right|A\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml"> by</span></p>
<p><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j}," class="math display" src="../media/file994.png" style="vertical-align:middle" title="\sum\limits_{j,k}\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}\lambda_{j},"/></span></p>
<p><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">where the eigenvalues of </span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{j}" class="math inline" src="../media/file945.png" style="vertical-align:middle" title="\lambda_{j}"/></span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml"> and the associated eigenvectors are </span><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file949.png" style="vertical-align:middle" title="{\{\left| \lambda_{j}^{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.493.2" xmlns="http://www.w3.org/1999/xhtml">In our case, we only have two eigenvalues: </span><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.497.2" xmlns="http://www.w3.org/1999/xhtml">So, if we are able to estimate the values </span><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">, we will have all the ingredients needed to ”cook” our expectation values.</span></p>
<p><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml">A priori, trying to get the values </span><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml"> out of a quantum computer can seem like a difficult task. </span><span class="koboSpan" id="kobo.502.2" xmlns="http://www.w3.org/1999/xhtml">For example, you may wonder whether it will be necessary to perform some weird fancy measurements on our quantum device in order to get these probabilities! </span><span class="koboSpan" id="kobo.502.3" xmlns="http://www.w3.org/1999/xhtml">Well, it turns out that we can easily estimate them on any quantum computer using ordinary measurements in the computational basis and a bunch of quantum gates. </span><span class="koboSpan" id="kobo.502.4" xmlns="http://www.w3.org/1999/xhtml">So, don’t worry. </span><span class="koboSpan" id="kobo.502.5" xmlns="http://www.w3.org/1999/xhtml">If you’ve just bought yourself a flashy quantum computer, there’s no need for a hardware upgrade just yet.</span></p>
<p><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">In any case, how can we actually estimate these </span><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml"> values with the tools that we have? </span><span class="koboSpan" id="kobo.505.2" xmlns="http://www.w3.org/1999/xhtml">Let’s first work with an example.</span></p>
<p><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">Let’s consider the observable </span><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.508.2" xmlns="http://www.w3.org/1999/xhtml">We have previously in this section obtained its eigenvectors, so let’s focus on one of them: </span><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file986.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.510.2" xmlns="http://www.w3.org/1999/xhtml">If we wanted to compute </span><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2}" class="math inline" src="../media/file995.png" style="vertical-align:middle" title="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2}"/></span><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml"> is a certain 3-qubit state, we could just notice that</span></p>
<p><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle = \left( {I \otimes H \otimes I} \right)\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle" class="math display" src="../media/file996.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle = \left( {I \otimes H \otimes I} \right)\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">and hence</span></p>
<p><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} &amp; {= \left( {\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle} \right)^{\dagger} = \left( {\left( {I \otimes H \otimes I} \right)\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle} \right)^{\dagger} = \left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right)^{\dagger}\qquad} &amp; &amp; \qquad \\ &amp; {= \left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right),\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file997.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} &amp; {= \left( {\left| 0 \right\rangle\left| + \right\rangle\left| 0 \right\rangle} \right)^{\dagger} = \left( {\left( {I \otimes H \otimes I} \right)\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle} \right)^{\dagger} = \left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right)^{\dagger}\qquad} &amp; &amp; \qquad \\  &amp; {= \left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right),\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">where we have used the fact that </span><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml"> are self-adjoint, and hence so is </span><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes H \otimes I" class="math inline" src="../media/file998.png" style="vertical-align:middle" title="I \otimes H \otimes I"/></span><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.524.2" xmlns="http://www.w3.org/1999/xhtml">Keep in mind, however, that we will still write daggers throughout this example whenever we mean to </span><span id="dx1-122023"/><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">consider the adjoint of </span><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes H \otimes I" class="math inline" src="../media/file998.png" style="vertical-align:middle" title="I \otimes H \otimes I"/></span><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml"> — even if it still represents the same operator.</span></p>
<p><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">From this, it follows directly that</span></p>
<p><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2} = \left| {\left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle} \right|^{2}." class="math display" src="../media/file999.png" style="vertical-align:middle" title="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2} = \left| {\left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|\left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle} \right|^{2}."/></span></p>
<p><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml">But for any state </span><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \varphi \right\rangle" class="math inline" src="../media/file44.png" style="vertical-align:middle" title="\left| \varphi \right\rangle"/></span><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">, we know that </span><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left( {\left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|} \right)\left| \varphi \right\rangle} \right|^{2}" class="math inline" src="../media/file1000.png" style="vertical-align:middle" title="\left| {\left( {\left\langle 0 \right|\left\langle 0 \right|\left\langle 0 \right|} \right)\left| \varphi \right\rangle} \right|^{2}"/></span><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml"> is the probability of obtaining </span><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file1001.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml"> when measuring it in the computational basis. </span><span class="koboSpan" id="kobo.536.2" xmlns="http://www.w3.org/1999/xhtml">As a consequence, we can estimate the value </span><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2}" class="math inline" src="../media/file995.png" style="vertical-align:middle" title="\left| {\left( {\left\langle 0 \right|\left\langle + \right|\left\langle 0 \right|} \right)\left| \psi \right\rangle} \right|^{2}"/></span><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml"> by repeatedly preparing the state </span><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( {I \otimes H \otimes I} \right)\left| \psi \right\rangle = \left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle" class="math inline" src="../media/file1002.png" style="vertical-align:middle" title="\left( {I \otimes H \otimes I} \right)\left| \psi \right\rangle = \left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml">, measuring it in the computational basis, and then </span><span id="dx1-122024"/><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">computing the relative frequency of </span><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file1001.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 0 \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml">And this is not the only eigenvector for which this works. </span><span class="koboSpan" id="kobo.544.2" xmlns="http://www.w3.org/1999/xhtml">It turns out that for each and every eigenvector </span><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1003.png" style="vertical-align:middle" title="\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml">, there is a unique state in the computational basis </span><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{C} \right\rangle" class="math inline" src="../media/file1004.png" style="vertical-align:middle" title="\left| \lambda_{C} \right\rangle"/></span><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml"> such that</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{A} \right\rangle = (I \otimes H \otimes I)\left| \lambda_{C} \right\rangle." class="math display" src="../media/file1005.png" style="vertical-align:middle" title="\left| \lambda_{A} \right\rangle = (I \otimes H \otimes I)\left| \lambda_{C} \right\rangle."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">Actually, the correspondence is bijective: for every state in the computational basis </span><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{C} \right\rangle" class="math inline" src="../media/file1004.png" style="vertical-align:middle" title="\left| \lambda_{C} \right\rangle"/></span><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">, there is also a unique eigenvector </span><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1003.png" style="vertical-align:middle" title="\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{C} \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1006.png" style="vertical-align:middle" title="\left| \lambda_{C} \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">, where we have used the fact that, for unitary operators, </span><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U^{\dagger} = U^{- 1}" class="math inline" src="../media/file1007.png" style="vertical-align:middle" title="U^{\dagger} = U^{- 1}"/></span><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.562.2" xmlns="http://www.w3.org/1999/xhtml">For example,</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle = \left( {I \otimes H \otimes I} \right)\left| 1 \right\rangle\left| 1 \right\rangle\left| 1 \right\rangle,\qquad\left| 1 \right\rangle\left| 1 \right\rangle\left| 1 \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle." class="math display" src="../media/file1008.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle = \left( {I \otimes H \otimes I} \right)\left| 1 \right\rangle\left| 1 \right\rangle\left| 1 \right\rangle,\qquad\left| 1 \right\rangle\left| 1 \right\rangle\left| 1 \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| 1 \right\rangle\left| - \right\rangle\left| 1 \right\rangle."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">This is the reason why we call </span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes H \otimes I" class="math inline" src="../media/file998.png" style="vertical-align:middle" title="I \otimes H \otimes I"/></span><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml"> the </span><strong><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">change of basis operator</span></strong><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml"> between the computational basis and the </span><span id="dx1-122025"/><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">basis of eigenvectors of </span><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">In this way, if we want to estimate the probabilities </span><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"> when the states </span><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file947.png" style="vertical-align:middle" title="\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml"> happen to be the eigenvectors of </span><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">, we just need to prepare </span><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle" class="math inline" src="../media/file1009.png" style="vertical-align:middle" title="\left( {I \otimes H \otimes I} \right)^{\dagger}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml"> and measure it in the computational basis. </span><span class="koboSpan" id="kobo.580.2" xmlns="http://www.w3.org/1999/xhtml">Then, given any eigenvector </span><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1003.png" style="vertical-align:middle" title="\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">, the probability </span><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file1010.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml"> can be estimated by the relative frequency of the measurement outcome associated to the eigenstate </span><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{C} \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1006.png" style="vertical-align:middle" title="\left| \lambda_{C} \right\rangle = {(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml"> in the computational basis. </span><span class="koboSpan" id="kobo.588.2" xmlns="http://www.w3.org/1999/xhtml">That’s because</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \lambda_{C} \right|\left( {{(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle} \right) = \left\langle \lambda_{A} \right|\left( {(I \otimes H \otimes I){(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle} \right) = \left\langle \lambda_{A} \middle| \psi \right\rangle," class="math display" src="../media/file1011.png" style="vertical-align:middle" title="\left\langle \lambda_{C} \right|\left( {{(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle} \right) = \left\langle \lambda_{A} \right|\left( {(I \otimes H \otimes I){(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle} \right) = \left\langle \lambda_{A} \middle| \psi \right\rangle,"/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">where we have used the fact that, for any operator </span><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="L" class="math inline" src="../media/file1012.png" style="vertical-align:middle" title="L"/></span><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml"> and any states </span><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \alpha \right\rangle" class="math inline" src="../media/file1013.png" style="vertical-align:middle" title="\left| \alpha \right\rangle"/></span><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \beta \right\rangle" class="math inline" src="../media/file1014.png" style="vertical-align:middle" title="\left| \beta \right\rangle"/></span><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">, if </span><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \beta \right\rangle = L\left| \alpha \right\rangle" class="math inline" src="../media/file1015.png" style="vertical-align:middle" title="\left| \beta \right\rangle = L\left| \alpha \right\rangle"/></span><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \beta \right| = \left\langle \alpha \right|L^{\dagger}" class="math inline" src="../media/file1016.png" style="vertical-align:middle" title="\left\langle \beta \right| = \left\langle \alpha \right|L^{\dagger}"/></span><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="L^{\dagger \dagger} = L" class="math inline" src="../media/file1017.png" style="vertical-align:middle" title="L^{\dagger \dagger} = L"/></span><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">As a final note, in this example, when we set out to </span><span id="dx1-122026"/><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml">compute the probabilities </span><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file1010.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">, we don’t have to run </span><span id="dx1-122027"/><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml">executions for each of the probabilities individually: we can compute them all simultaneously. </span><span class="koboSpan" id="kobo.607.2" xmlns="http://www.w3.org/1999/xhtml">All we have to do is measure </span><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle" class="math inline" src="../media/file1018.png" style="vertical-align:middle" title="{(I \otimes H \otimes I)}^{\dagger}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml"> in the computational basis a bunch of times and then retrieve the relative frequency of every outcome. </span><span class="koboSpan" id="kobo.609.2" xmlns="http://www.w3.org/1999/xhtml">This works because </span><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(I \otimes H \otimes I)}^{\dagger}" class="math inline" src="../media/file1019.png" style="vertical-align:middle" title="{(I \otimes H \otimes I)}^{\dagger}"/></span><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml"> transforms all the eigenvectors of </span><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml"> into the states of the computational basis. </span><span class="koboSpan" id="kobo.613.2" xmlns="http://www.w3.org/1999/xhtml">Then, the probability </span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file1010.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{A} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml"> will be the relative frequency of the outcome, in the computational basis, associated to </span><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle" class="math inline" src="../media/file1020.png" style="vertical-align:middle" title="{(I \otimes H \otimes I)}^{\dagger}\left| \lambda_{A} \right\rangle"/></span><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.617.2" xmlns="http://www.w3.org/1999/xhtml">Of course, the higher the number of preparations and measurements, the more accurate our estimates will be.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-134">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml">Notice the similarity of this kind of procedure with the standard measurement in the computational basis. </span><span class="koboSpan" id="kobo.620.2" xmlns="http://www.w3.org/1999/xhtml">When we measure </span><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml"> in the computational basis, we have probability </span><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle x \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file1021.png" style="vertical-align:middle" title="\left| \left\langle x \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml"> of obtaining the outcome associated to </span><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.626.2" xmlns="http://www.w3.org/1999/xhtml">If we were measuring an observable that had all the </span><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file947.png" style="vertical-align:middle" title="\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml"> as eigenvectors with a distinct eigenvalue for each of them — this is an observable that’s able to distinguish all the eigenvectors in the basis — we would have probability </span><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file972.png" style="vertical-align:middle" title="\left| \left\langle \lambda_{j}^{k} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml"> of getting the outcome associated to </span><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j}^{k} \right\rangle" class="math inline" src="../media/file947.png" style="vertical-align:middle" title="\left| \lambda_{j}^{k} \right\rangle"/></span><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml">This is why we refer to the process of changing basis and, then, measuring in the computational basis, as performing a </span><strong><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml">measurement</span></strong> <strong><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml">in the eigenvector basis</span></strong> <span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\{\left| \lambda_{j}^{k} \right\rangle\}" class="math inline" src="../media/file1022.png" style="vertical-align:middle" title="\{\left| \lambda_{j}^{k} \right\rangle\}"/></span> <strong><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml">of</span></strong> <span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.639.2" xmlns="http://www.w3.org/1999/xhtml">It is exactly the same as if we had an observable that’s able to measure and distinguish all the eigenvectors of </span><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml">But wait, there’s more! </span><span class="koboSpan" id="kobo.642.2" xmlns="http://www.w3.org/1999/xhtml">Our being able to change bases in this case is by no means a happy coincidence. </span><span class="koboSpan" id="kobo.642.3" xmlns="http://www.w3.org/1999/xhtml">It turns out that for every tensor product of Pauli matrices </span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml">, there is a simple change of basis matrix that </span><span id="dx1-122028"/><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml">defines a perfect correspondence between the states in the computational basis and the eigenvectors of </span><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.647.2" xmlns="http://www.w3.org/1999/xhtml">Again, this can be readily verified, and we invite you to do it in the following two exercises.</span></p>
<div class="tcolorbox questionx" id="tcolobox-135">
<span id="x1-122030x7.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.5</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml">Since the computational basis is an eigenvector basis of </span><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">, a change of basis operator of </span><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml"> can be the identity </span><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.655.2" xmlns="http://www.w3.org/1999/xhtml">Check that, in order to change from the computational basis to the basis of eigenvectors of the </span><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">, you can use the Hadamard matrix </span><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">, and that to change to the basis of eigenvectors of </span><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y" class="math inline" src="../media/file11.png" style="vertical-align:middle" title="Y"/></span><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml"> you can use </span><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SH" class="math inline" src="../media/file1023.png" style="vertical-align:middle" title="SH"/></span><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<div class="tcolorbox questionx" id="tcolobox-136">
<span id="x1-122032x7.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.6</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">Prove that if </span><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{1}" class="math inline" src="../media/file175.png" style="vertical-align:middle" title="U_{1}"/></span><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{2}" class="math inline" src="../media/file176.png" style="vertical-align:middle" title="U_{2}"/></span><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml"> are the respective change of basis operators from the computational basis to the eigenvector basis of two observables </span><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{1}" class="math inline" src="../media/file1024.png" style="vertical-align:middle" title="A_{1}"/></span><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{2}" class="math inline" src="../media/file1025.png" style="vertical-align:middle" title="A_{2}"/></span><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{1} \otimes U_{2}" class="math inline" src="../media/file179.png" style="vertical-align:middle" title="U_{1} \otimes U_{2}"/></span><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml"> is the change of basis operator from the computational basis to the eigenvector basis of </span><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{1} \otimes A_{2}" class="math inline" src="../media/file1026.png" style="vertical-align:middle" title="A_{1} \otimes A_{2}"/></span><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml">Putting everything together, we can easily deduce that, for instance, </span><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes I \otimes H" class="math inline" src="../media/file1027.png" style="vertical-align:middle" title="I \otimes I \otimes H"/></span><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"> takes the eigenvectors of </span><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml"> to the computational basis and that </span><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes {(SH)}^{\dagger} \otimes {(SH)}^{\dagger}" class="math inline" src="../media/file1028.png" style="vertical-align:middle" title="I \otimes {(SH)}^{\dagger} \otimes {(SH)}^{\dagger}"/></span><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml"> takes the eigenvectors of </span><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes Y \otimes Y" class="math inline" src="../media/file976.png" style="vertical-align:middle" title="I \otimes Y \otimes Y"/></span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"> to states in the computational basis as well.</span></p>
<p><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml">Therefore, in order to estimate the </span><span id="dx1-122033"/><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml">expectation value </span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle" class="math inline" src="../media/file1029.png" style="vertical-align:middle" title="\left\langle \psi \right|\left( {Z \otimes I \otimes X} \right)\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml">, we can use whatever circuit we need to prepare </span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml"> followed by </span><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(I \otimes I \otimes H)}^{\dagger} = I \otimes I \otimes H" class="math inline" src="../media/file1030.png" style="vertical-align:middle" title="{(I \otimes I \otimes H)}^{\dagger} = I \otimes I \otimes H"/></span><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">, then measure in the computational basis, and then get the probabilities as we have just discussed. </span><span class="koboSpan" id="kobo.694.2" xmlns="http://www.w3.org/1999/xhtml">In a similar way, to estimate </span><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle" class="math inline" src="../media/file1031.png" style="vertical-align:middle" title="\left\langle \psi \right|\left( {I \otimes Y \otimes Y} \right)\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml">, we will first prepare </span><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml">, then apply </span><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes HS^{\dagger} \otimes HS^{\dagger}" class="math inline" src="../media/file1032.png" style="vertical-align:middle" title="I \otimes HS^{\dagger} \otimes HS^{\dagger}"/></span><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml"> and, finally, measure in the computational basis.</span></p>
<p><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">Notice, by the way, how </span><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml"> are self-adjoint, so, when we took their adjoints, there was no observable (no pun intended) effect. </span><span class="koboSpan" id="kobo.705.2" xmlns="http://www.w3.org/1999/xhtml">That’s not the case with </span><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SH" class="math inline" src="../media/file1023.png" style="vertical-align:middle" title="SH"/></span><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">, because </span><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(SH)}^{\dagger} = H^{\dagger}S^{\dagger} = HS^{\dagger}" class="math inline" src="../media/file1033.png" style="vertical-align:middle" title="{(SH)}^{\dagger} = H^{\dagger}S^{\dagger} = HS^{\dagger}"/></span><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-137">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">For any Hermitian operator </span><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">, there is always a unitary transformation that takes any basis of eigenvectors of </span><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml"> to the computational basis, and vice versa. </span><span class="koboSpan" id="kobo.716.2" xmlns="http://www.w3.org/1999/xhtml">However, this transformation could very well be difficult to implement. </span><span class="koboSpan" id="kobo.716.3" xmlns="http://www.w3.org/1999/xhtml">In the case where </span><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml"> is a tensor product of Pauli matrices we have just proved that we can always obtain the transformation as the tensor product of very simple one-qubit operations.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">Finally, after we have estimated the expectation value of every Pauli term in our observable (in our case, </span><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes Y \otimes Y" class="math inline" src="../media/file976.png" style="vertical-align:middle" title="I \otimes Y \otimes Y"/></span><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes X \otimes Z" class="math inline" src="../media/file977.png" style="vertical-align:middle" title="Z \otimes X \otimes Z"/></span><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml">) we can multiply them by the corresponding coefficients in the linear </span><span id="dx1-122034"/><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">combination and add everything together to get the final result. </span><span class="koboSpan" id="kobo.726.2" xmlns="http://www.w3.org/1999/xhtml">And we are done!</span></p>
<p><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">Now you know how to estimate the </span><span id="dx1-122035"/><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">expectation value of an observable by measuring in different bases. </span><span class="koboSpan" id="kobo.728.2" xmlns="http://www.w3.org/1999/xhtml">You can proudly say, as the famous internet meme goes, ”All your base are belong to us.” </span><span class="koboSpan" id="kobo.728.3" xmlns="http://www.w3.org/1999/xhtml">And, in fact, this was the last technical element that we needed in order to introduce VQE, something we will immediately do in the next section.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="14.2" id="introducing-vqe">
<h1 class="sectionHead" data-number="14.2"><span class="titlemark"><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">7.2</span></span> <span id="x1-1230007.2"><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">Introducing VQE</span></span></h1>
<p><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">The goal of the </span><strong><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">Variational Quantum Eigensolver</span></strong><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">VQE</span></strong><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">) is to find a </span><span id="dx1-123001"/><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml">ground state of a given Hamiltonian </span><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.738.2" xmlns="http://www.w3.org/1999/xhtml">This Hamiltonian can describe, for instance, the energy of a certain physical or chemical process, and we will use some such examples in the following two sections, which will cover how to execute VQE with Qiskit and PennyLane. </span><span class="koboSpan" id="kobo.738.3" xmlns="http://www.w3.org/1999/xhtml">For the moment, however, we will keep everything abstract and focus on finding a state </span><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{1}\left| \psi \right\rangle" class="math inline" src="../media/file703.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{1}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml"> is minimum. </span><span class="koboSpan" id="kobo.742.2" xmlns="http://www.w3.org/1999/xhtml">Note that in this section, we will be using </span><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml"> to refer to the Hamiltonian so that it does not get confused with the Hadamard matrix that we will also be using in our computations.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-138">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">VQE is by no means the only quantum algorithm that has been proposed to find the ground states of Hamiltonians. </span><span class="koboSpan" id="kobo.747.2" xmlns="http://www.w3.org/1999/xhtml">Some very promising options use a quantum subroutine </span><span id="dx1-123002"/><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml">known as </span><strong><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">Quantum</span></strong> <strong><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml">Phase Estimation</span></strong><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml">QPE</span></strong><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">) (see, for instance, the excellent surveys by McArdle et al. </span><span class="cite"><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xmcardle2020quantum"><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">66</span></a><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml"> and by Cao et al. </span><span class="cite"><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xcao2019quantum"><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml">22</span></a><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.761.2" xmlns="http://www.w3.org/1999/xhtml">The main disadvantage of these approaches is that QPE uses the Quantum Fourier Transform that we studied in </span><em><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch014.xhtml#x1-1060006"><em><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml">6</span></em></a><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml">GAS: Grover Adaptative Search</span></em><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">, and, thus, requires quantum computers that are resilient to noise. </span><span class="koboSpan" id="kobo.766.2" xmlns="http://www.w3.org/1999/xhtml">An experimental demonstration of these limitations (and of the relative robustness of VQE) can be found, for instance, in the paper by O’Malley et al. </span><span class="cite"><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xo2016scalable"><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">70</span></a><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.770.2" xmlns="http://www.w3.org/1999/xhtml">For this reason, we will focus mainly on VQE and its applications, which seem to obtain better results with the NISQ computers that are available today.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">The general </span><span id="dx1-123003"/><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">structure of VQE is very similar to that of QAOA, which you surely remember from </span><em><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization</span></em> <em><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">Algorithm</span></em><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml">: we prepare a parameterized quantum state, we measure it, we estimate its energy, and we change the parameters in order to minimize it; then, we repeat this process several times until some stopping criteria are met. </span><span class="koboSpan" id="kobo.778.2" xmlns="http://www.w3.org/1999/xhtml">The preparation and measurement of the state are done on the quantum computer, while the energy estimation and parameter minimization are handled by a classical computer.</span></p>
<p><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">The parametrized circuit, usually </span><span id="dx1-123004"/><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml">called </span><strong><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">variational form</span></strong><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">ansatz</span></strong><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml">, is </span><span id="dx1-123005"/><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">usually chosen taking into account information from the problem domain. </span><span class="koboSpan" id="kobo.785.2" xmlns="http://www.w3.org/1999/xhtml">For instance, you could consider ansatzes that parametrize typical solutions to the kind of problem under study. </span><span class="koboSpan" id="kobo.785.3" xmlns="http://www.w3.org/1999/xhtml">We will show some examples of this in the last two sections of this same chapter. </span><span class="koboSpan" id="kobo.785.4" xmlns="http://www.w3.org/1999/xhtml">In any case, the ansatz is selected in advance and it is usually easy to implement on a quantum circuit.</span></p>
<div class="tcolorbox important" id="tcolobox-139">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">In many applications, we can distinguish two parts in the creation of the parameterized state: the preparation of an initial state </span><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">, that does not depend on any parameters, and then the variational form </span><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta)" class="math inline" src="../media/file1034.png" style="vertical-align:middle" title="V(\theta)"/></span><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml"> itself, that obviously depends on </span><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.793.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if we have </span><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle = U\left| 0 \right\rangle" class="math inline" src="../media/file1035.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle = U\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml">, for some unitary transformation </span><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U" class="math inline" src="../media/file51.png" style="vertical-align:middle" title="U"/></span><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml"> implemented with some quantum gates, the ansatz gives us the state </span><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta)U\left| 0 \right\rangle" class="math inline" src="../media/file1036.png" style="vertical-align:middle" title="V(\theta)U\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.799.2" xmlns="http://www.w3.org/1999/xhtml">Notice, however, that we can always consider the whole operation </span><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta)U" class="math inline" src="../media/file1037.png" style="vertical-align:middle" title="V(\theta)U"/></span><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml"> as the ansatz and require the initial state to be </span><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.803.2" xmlns="http://www.w3.org/1999/xhtml">To simplify our notation, this is what we will usually do, although we will explicitly distinguish between initial state and ansatz in some practical examples that we will consider later in the chapter.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">Algorithm </span><a href="#x1-123008r1"><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml">7.1</span></a><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml"> gives the </span><span id="dx1-123006"/><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml">pseudocode for VQE. </span><span class="koboSpan" id="kobo.807.2" xmlns="http://www.w3.org/1999/xhtml">Notice the similarities with Algorithm </span><a href="ch013.xhtml#x1-97007r1"><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">5.1</span></a><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml"> from </span><em><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization</span></em> <em><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml">Algorithm</span></em><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span id="x1-123007r2"/></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-123008r1"/> <strong><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">Algorithm 7.1</span></strong><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml"> (VQE)</span><strong><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml">.</span></strong> </span><span id="x1-123009"/></p>
<div class="algorithmic">
<span class="label-5.475pt"> <strong><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml">Require:</span></strong> </span> <span class="algorithmic"> <span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml"> given as a linear combination of tensor products of Pauli matrices </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml"> Choose a variational form (ansatz) </span><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta)" class="math inline" src="../media/file1034.png" style="vertical-align:middle" title="V(\theta)"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml"> Choose a starting set of values for </span><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"> <strong><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">while</span></strong><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml"> the stopping criteria are not met </span><strong><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml">do</span></strong> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"> Prepare the state </span><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1038.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml">    </span><span id="textcolor3"><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\vartriangleright" class="math inline" src="../media/file655.png" style="vertical-align:middle" title="\vartriangleright"/></span> <em><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml">This</span></em> <em><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">is done on the quantum computer!</span></em></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml"> From the measurements of </span><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1039.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle"/></span><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml"> in different bases, estimate </span><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1040.png" style="vertical-align:middle" title="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml"> Update </span><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml"> according to the minimization algorithm </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml"> - </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml"> Prepare the state </span><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1038.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">    </span><span id="textcolor4"><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\vartriangleright" class="math inline" src="../media/file655.png" style="vertical-align:middle" title="\vartriangleright"/></span> <em><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml">This</span></em> <em><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml">is done on the quantum computer!</span></em></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml"> From the measurements of </span><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1039.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle"/></span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml"> in different bases, estimate </span><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1040.png" style="vertical-align:middle" title="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle"/></span> </span>
</div>
</div>
<p><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">Let’s remark on a couple of things about this pseudocode. </span><span class="koboSpan" id="kobo.853.2" xmlns="http://www.w3.org/1999/xhtml">Notice that we require that </span><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml"> be given as a linear combination of tensor products of Pauli matrices; this is so that we can use the techniques that we introduced in the previous section to estimate </span><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{1}\left| \psi \right\rangle" class="math inline" src="../media/file703.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{1}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.857.2" xmlns="http://www.w3.org/1999/xhtml">Of course, the more terms we have in the linear combination, the bigger the number of bases in which we may need to perform measurements. </span><span class="koboSpan" id="kobo.857.3" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, in some cases, we may group several measurements together. </span><span class="koboSpan" id="kobo.857.4" xmlns="http://www.w3.org/1999/xhtml">For example, if we have terms such as </span><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes X \otimes I \otimes X" class="math inline" src="../media/file1041.png" style="vertical-align:middle" title="I \otimes X \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes I \otimes X \otimes X" class="math inline" src="../media/file1042.png" style="vertical-align:middle" title="I \otimes I \otimes X \otimes X"/></span><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes I \otimes X \otimes X" class="math inline" src="../media/file1042.png" style="vertical-align:middle" title="I \otimes I \otimes X \otimes X"/></span><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml">, we can use </span><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes H \otimes H \otimes H" class="math inline" src="../media/file1043.png" style="vertical-align:middle" title="I \otimes H \otimes H \otimes H"/></span><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml"> as our change of basis matrix (be careful! </span><span class="koboSpan" id="kobo.865.2" xmlns="http://www.w3.org/1999/xhtml">This </span><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml"> is the Hadamard matrix, not the Hamiltonian!) because it works for the three terms at the same time — keep in mind that any orthonormal basis is an eigenvector basis for </span><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml">, not just </span><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\{\left| 0 \right\rangle,\left| 1 \right\rangle\}" class="math inline" src="../media/file1044.png" style="vertical-align:middle" title="\{\left| 0 \right\rangle,\left| 1 \right\rangle\}"/></span><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.871.2" xmlns="http://www.w3.org/1999/xhtml">Obviously, another hyperparameter that will impact the execution time of VQE is the number of times that we measure </span><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml"> in each basis. </span><span class="koboSpan" id="kobo.873.2" xmlns="http://www.w3.org/1999/xhtml">The higher this number, the more precise the estimation, but also the higher the time needed to estimate </span><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{1}\left| \psi \right\rangle" class="math inline" src="../media/file703.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{1}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml">Notice also that the </span><span id="dx1-123010"/><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml">pseudocode of Algorithm </span><a href="#x1-123008r1"><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">7.1</span></a><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml"> concludes by estimating </span><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1040.png" style="vertical-align:middle" title="\left\langle {\psi(\theta)} \right|H_{1}\left| {\psi(\theta)} \right\rangle"/></span><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml"> for the last state </span><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle" class="math inline" src="../media/file1039.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle"/></span><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml"> found by the minimization algorithm. </span><span class="koboSpan" id="kobo.883.2" xmlns="http://www.w3.org/1999/xhtml">This is a quite common use case, for instance, if we want to determine the ground state energy for a particular system. </span><span class="koboSpan" id="kobo.883.3" xmlns="http://www.w3.org/1999/xhtml">However, you are not restricted to just that. </span><span class="koboSpan" id="kobo.883.4" xmlns="http://www.w3.org/1999/xhtml">At the end of the VQE execution, you also know the </span><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta_{0}" class="math inline" src="../media/file1045.png" style="vertical-align:middle" title="\theta_{0}"/></span><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml"> parameters that were used to build the ground state, and you could use them to reconstruct </span><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta_{0})} \right\rangle = V(\theta_{0})\left| 0 \right\rangle" class="math inline" src="../media/file1046.png" style="vertical-align:middle" title="\left| {\psi(\theta_{0})} \right\rangle = V(\theta_{0})\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.887.2" xmlns="http://www.w3.org/1999/xhtml">This state could then be used for other purposes, such as being sent into another quantum algorithm.</span></p>
<p><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">In fact, in the next subsection, we are going to explore one of such uses: the computation of additional </span><strong><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml">eigenstates</span></strong><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml"> (another name for our old friends, the eigenvectors) of Hamiltonians. </span><span class="koboSpan" id="kobo.890.2" xmlns="http://www.w3.org/1999/xhtml">You should be excited!</span></p>
<section class="level3 subsectionHead" data-number="14.2.1" id="getting-excited-with-vqe">
<h2 class="subsectionHead" data-number="14.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">7.2.1 </span></span> <span id="x1-1240007.2.1"><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">Getting excited with VQE</span></span></h2>
<p><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">As we have just explained, VQE is used to </span><span id="dx1-124001"/><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml">search for a </span><span id="dx1-124002"/><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml">ground state of a given Hamiltonian </span><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.897.2" xmlns="http://www.w3.org/1999/xhtml">However, with a small modification, we can also use it to find </span><strong><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">excited</span></strong> <strong><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">states</span></strong><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">: eigenstates with higher energies. </span><span class="koboSpan" id="kobo.900.2" xmlns="http://www.w3.org/1999/xhtml">Let’s explain how to achieve this.</span></p>
<p><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">Suppose that you have been given a Hamiltonian </span><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml"> and you have used VQE to find a ground state </span><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle = V(\theta_{0})\left| 0 \right\rangle" class="math inline" src="../media/file1047.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle = V(\theta_{0})\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml"> with energy </span><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{0}" class="math inline" src="../media/file964.png" style="vertical-align:middle" title="\lambda_{0}"/></span><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.907.2" xmlns="http://www.w3.org/1999/xhtml">Then, we may consider the modified Hamiltonian</span></p>
<p><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime} = H + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|," class="math display" src="../media/file1048.png" style="vertical-align:middle" title="H^{\prime} = H + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|,"/></span></p>
<p><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C" class="math inline" src="../media/file234.png" style="vertical-align:middle" title="C"/></span><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml"> is a positive real number.</span></p>
<p><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">Before we move on to detailing why </span><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml"> can enable us to find excited states, let’s explain what the term </span><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|" class="math inline" src="../media/file1050.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|"/></span><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml"> in that expression means. </span><span class="koboSpan" id="kobo.916.2" xmlns="http://www.w3.org/1999/xhtml">First of all, notice that this term represents a square matrix: it is the product of a column vector (</span><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml">) and a row vector (</span><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi_{0} \right|" class="math inline" src="../media/file1051.png" style="vertical-align:middle" title="\left\langle \psi_{0} \right|"/></span><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">) of the same length. </span><span class="koboSpan" id="kobo.920.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, it is a Hermitian matrix, because</span></p>
<p><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( {\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|} \right)^{\dagger} = \left\langle \psi_{0} \right|^{\dagger}\left| \psi_{0} \right\rangle^{\dagger} = \left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|." class="math display" src="../media/file1052.png" style="vertical-align:middle" title="\left( {\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|} \right)^{\dagger} = \left\langle \psi_{0} \right|^{\dagger}\left| \psi_{0} \right\rangle^{\dagger} = \left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|."/></span></p>
<p><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">Then, </span><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml"> is the sum of two Hermitian </span><span id="dx1-124003"/><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml">matrices and is, therefore, also Hermitian. </span><span class="koboSpan" id="kobo.925.2" xmlns="http://www.w3.org/1999/xhtml">And what is its expectation value? </span><span class="koboSpan" id="kobo.925.3" xmlns="http://www.w3.org/1999/xhtml">If we have a generic quantum state </span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">, then</span></p>
<p><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H^{\prime}\left| \psi \right\rangle = \left\langle \psi \right|H\left| \psi \right\rangle + C\left\langle \psi \middle| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \psi \right\rangle = \left\langle \psi \right|H\left| \psi \right\rangle + C\left| \left\langle \psi_{0} \middle| \psi \right\rangle \right|^{2}." class="math display" src="../media/file1053.png" style="vertical-align:middle" title="\left\langle \psi \right|H^{\prime}\left| \psi \right\rangle = \left\langle \psi \right|H\left| \psi \right\rangle + C\left\langle \psi \middle| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \psi \right\rangle = \left\langle \psi \right|H\left| \psi \right\rangle + C\left| \left\langle \psi_{0} \middle| \psi \right\rangle \right|^{2}."/></span></p>
<p><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml">That is, the </span><span id="dx1-124004"/><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">expectation value of </span><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml"> in a state </span><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml"> is the expectation value of </span><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml"> plus a non-negative value that quantifies the overlap of </span><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.940.2" xmlns="http://www.w3.org/1999/xhtml">Hence we have two extreme cases for </span><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C\left| \left\langle \psi_{0} \middle| \psi \right\rangle \right|^{2}" class="math inline" src="../media/file1054.png" style="vertical-align:middle" title="C\left| \left\langle \psi_{0} \middle| \psi \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.942.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = \left| \psi_{0} \right\rangle" class="math inline" src="../media/file1055.png" style="vertical-align:middle" title="\left| \psi \right\rangle = \left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">, this term will be </span><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C" class="math inline" src="../media/file234.png" style="vertical-align:middle" title="C"/></span><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.946.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml"> are orthogonal, the term will be </span><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">Thus, if we make </span><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C" class="math inline" src="../media/file234.png" style="vertical-align:middle" title="C"/></span><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml"> big enough, </span><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml"> will no longer be a ground state of </span><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.959.2" xmlns="http://www.w3.org/1999/xhtml">Let’s prove this is in a more formal way. </span><span class="koboSpan" id="kobo.959.3" xmlns="http://www.w3.org/1999/xhtml">To this end, let </span><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{0} \leq \lambda_{1} \leq \ldots \leq \lambda_{n}" class="math inline" src="../media/file1056.png" style="vertical-align:middle" title="\lambda_{0} \leq \lambda_{1} \leq \ldots \leq \lambda_{n}"/></span><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml"> be the eigenvalues of </span><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml"> associated to each eigenvector in an orthonormal eigenvector basis </span><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\{\left| \lambda_{j} \right\rangle\}" class="math inline" src="../media/file1057.png" style="vertical-align:middle" title="\{\left| \lambda_{j} \right\rangle\}"/></span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"> (since different eigenvectors may have the same eigenvalue, some of the energies may be repeated). </span><span class="koboSpan" id="kobo.965.2" xmlns="http://www.w3.org/1999/xhtml">As </span><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml"> is, by hypothesis, a ground state, we shall assume that </span><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{0} \right\rangle = \left| \psi_{0} \right\rangle" class="math inline" src="../media/file1058.png" style="vertical-align:middle" title="\left| \lambda_{0} \right\rangle = \left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.969.2" xmlns="http://www.w3.org/1999/xhtml">The states </span><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\{\left| \lambda_{j} \right\rangle\}" class="math inline" src="../media/file1057.png" style="vertical-align:middle" title="\{\left| \lambda_{j} \right\rangle\}"/></span><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"> are also eigenvectors of </span><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml"> because, on the one hand, if </span><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j \neq 0" class="math inline" src="../media/file1059.png" style="vertical-align:middle" title="j \neq 0"/></span><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">,</span></p>
<p><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}\left| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle + C\left| \lambda_{0} \right\rangle\left\langle \lambda_{0} \middle| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle = \lambda_{j}\left| \lambda_{j} \right\rangle," class="math display" src="../media/file1060.png" style="vertical-align:middle" title="H^{\prime}\left| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle + C\left| \lambda_{0} \right\rangle\left\langle \lambda_{0} \middle| \lambda_{j} \right\rangle = H\left| \lambda_{j} \right\rangle = \lambda_{j}\left| \lambda_{j} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">since </span><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{0} \right\rangle" class="math inline" src="../media/file1061.png" style="vertical-align:middle" title="\left| \lambda_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{j} \right\rangle" class="math inline" src="../media/file978.png" style="vertical-align:middle" title="\left| \lambda_{j} \right\rangle"/></span><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml"> are orthogonal. </span><span class="koboSpan" id="kobo.981.2" xmlns="http://www.w3.org/1999/xhtml">On the other hand,</span></p>
<p><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}\left| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \lambda_{0} \right\rangle\left\langle \lambda_{0} \middle| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \lambda_{0} \right\rangle = (\lambda_{0} + C)\left| \lambda_{0} \right\rangle." class="math display" src="../media/file1062.png" style="vertical-align:middle" title="H^{\prime}\left| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \lambda_{0} \right\rangle\left\langle \lambda_{0} \middle| \lambda_{0} \right\rangle = H\left| \lambda_{0} \right\rangle + C\left| \lambda_{0} \right\rangle = (\lambda_{0} + C)\left| \lambda_{0} \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml">Thus, it follows that </span><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \lambda_{j} \right|H^{\prime}\left| \lambda_{j} \right\rangle = \lambda_{j}" class="math inline" src="../media/file1063.png" style="vertical-align:middle" title="\left\langle \lambda_{j} \right|H^{\prime}\left| \lambda_{j} \right\rangle = \lambda_{j}"/></span><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml"> when </span><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j \neq 0" class="math inline" src="../media/file1059.png" style="vertical-align:middle" title="j \neq 0"/></span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \lambda_{0} \right|H^{\prime}\left| \lambda_{0} \right\rangle = C + \lambda_{0}" class="math inline" src="../media/file1064.png" style="vertical-align:middle" title="\left\langle \lambda_{0} \right|H^{\prime}\left| \lambda_{0} \right\rangle = C + \lambda_{0}"/></span><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.989.2" xmlns="http://www.w3.org/1999/xhtml">Hence, if </span><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C &gt; \lambda_{1} - \lambda_{0}" class="math inline" src="../media/file1065.png" style="vertical-align:middle" title="C &gt; \lambda_{1} - \lambda_{0}"/></span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle = \left| \lambda_{0} \right\rangle" class="math inline" src="../media/file1066.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle = \left| \lambda_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml"> will no longer be a ground state of </span><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml">, because the energy of </span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"> will be lower than that of </span><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.999.2" xmlns="http://www.w3.org/1999/xhtml">Thanks to the variational principle, we know that the minimum energy is attained at an eigenvector of </span><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml">, so </span><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml"> must be a ground state of </span><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">We can then use VQE to search for a ground state of </span><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml"> and obtain the state </span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">, as we intended.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-140">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">Notice that it could be the case that </span><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{1} = \lambda_{0}" class="math inline" src="../media/file1068.png" style="vertical-align:middle" title="\lambda_{1} = \lambda_{0}"/></span><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1015.2" xmlns="http://www.w3.org/1999/xhtml">In that situation, </span><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml"> would be another ground state of </span><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1019.2" xmlns="http://www.w3.org/1999/xhtml">Otherwise, it will be the first excited state of </span><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">You may have also noticed that, even if the ground state is unique, the first excited eigenstate may not be so. </span><span class="koboSpan" id="kobo.1022.2" xmlns="http://www.w3.org/1999/xhtml">This happens if and only if </span><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{2} \right\rangle" class="math inline" src="../media/file1069.png" style="vertical-align:middle" title="\left| \lambda_{2} \right\rangle"/></span><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml"> (and possibly other states in the basis) has the same energy as </span><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">, (that is, </span><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lambda_{2} = \lambda_{1}" class="math inline" src="../media/file1070.png" style="vertical-align:middle" title="\lambda_{2} = \lambda_{1}"/></span><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1028.2" xmlns="http://www.w3.org/1999/xhtml">In that case, any normalized linear combination of those eigenvectors will be a ground state of </span><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\prime}" class="math inline" src="../media/file1049.png" style="vertical-align:middle" title="H^{\prime}"/></span><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1030.2" xmlns="http://www.w3.org/1999/xhtml">Any of them will serve our purposes equally well.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">Of course, once you obtain </span><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{1} \right\rangle" class="math inline" src="../media/file1067.png" style="vertical-align:middle" title="\left| \lambda_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml">, you can consider </span><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{''} = H^{\prime} + C^{\prime}\left| \lambda_{1} \right\rangle\left\langle \lambda_{1} \right|" class="math inline" src="../media/file1071.png" style="vertical-align:middle" title="H^{''} = H^{\prime} + C^{\prime}\left| \lambda_{1} \right\rangle\left\langle \lambda_{1} \right|"/></span><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml"> and use VQE to search for </span><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \lambda_{2} \right\rangle" class="math inline" src="../media/file1069.png" style="vertical-align:middle" title="\left| \lambda_{2} \right\rangle"/></span><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">, and so on and so forth. </span><span class="koboSpan" id="kobo.1037.2" xmlns="http://www.w3.org/1999/xhtml">Keep in mind that, in this process, we would have to pick the constants </span><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C,C^{\prime},\ldots" class="math inline" src="../media/file1072.png" style="vertical-align:middle" title="C,C^{\prime},\ldots"/></span><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml"> properly — just to make sure that none of the eigenstates that we already know becomes a ground state again!</span></p>
<p><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">With this, our problem of finding eigenvectors of increasing energy is solved. </span><span class="koboSpan" id="kobo.1040.2" xmlns="http://www.w3.org/1999/xhtml">Or is it?</span></p>
<p><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">There is just one little </span><span id="dx1-124005"/><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">implementation detail that might be bothering you. </span><span class="koboSpan" id="kobo.1042.2" xmlns="http://www.w3.org/1999/xhtml">In the previous section, we discussed how to estimate the </span><span id="dx1-124006"/><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">expectation value of a Hamiltonian under the assumption that it was given as a sum of tensor products of Pauli matrices. </span><span class="koboSpan" id="kobo.1043.2" xmlns="http://www.w3.org/1999/xhtml">However, the </span><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|" class="math inline" src="../media/file1050.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|"/></span><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml"> term is not of that form. </span><span class="koboSpan" id="kobo.1045.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we know </span><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml"> only as the result of applying VQE, so it is very likely that we will not know </span><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml"> explicitly; instead, we will have nothing more than some parameters </span><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta_{0}" class="math inline" src="../media/file1045.png" style="vertical-align:middle" title="\theta_{0}"/></span><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta_{0})\left| 0 \right\rangle = \left| \psi_{0} \right\rangle" class="math inline" src="../media/file1073.png" style="vertical-align:middle" title="V(\theta_{0})\left| 0 \right\rangle = \left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1053.2" xmlns="http://www.w3.org/1999/xhtml">This, nonetheless, is enough to compute the expectation values that we need.</span></p>
<p><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml">Let’s step back a little bit and take a look at what we need to compute. </span><span class="koboSpan" id="kobo.1054.2" xmlns="http://www.w3.org/1999/xhtml">At a given moment in the application of VQE, we have some parameters </span><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml"> and we want to estimate the expectation value of </span><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|" class="math inline" src="../media/file1050.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle\left\langle \psi_{0} \right|"/></span><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml"> with respect to </span><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1038.png" style="vertical-align:middle" title="\left| {\psi(\theta)} \right\rangle = V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1060.2" xmlns="http://www.w3.org/1999/xhtml">This quantity is</span></p>
<p><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi(\theta) \middle| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \psi(\theta) \right\rangle = \left| \left\langle \psi_{0} \middle| \psi(\theta) \right\rangle \right|^{2} = \left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}." class="math display" src="../media/file1074.png" style="vertical-align:middle" title="\left\langle \psi(\theta) \middle| \psi_{0} \right\rangle\left\langle \psi_{0} \middle| \psi(\theta) \right\rangle = \left| \left\langle \psi_{0} \middle| \psi(\theta) \right\rangle \right|^{2} = \left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}."/></span></p>
<p><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml">But this is just the probability of obtaining </span><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"> as the outcome of measuring </span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1075.png" style="vertical-align:middle" title="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml"> in the computational basis! </span><span class="koboSpan" id="kobo.1066.2" xmlns="http://www.w3.org/1999/xhtml">This is something that we can easily estimate because we can prepare </span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1075.png" style="vertical-align:middle" title="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml"> by first applying our ansatz </span><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V" class="math inline" src="../media/file379.png" style="vertical-align:middle" title="V"/></span><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml">, using </span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml"> as the parameters, to </span><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml">, and then applying the inverse of our ansatz, with parameters </span><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta_{0}" class="math inline" src="../media/file1045.png" style="vertical-align:middle" title="\theta_{0}"/></span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml">, to the resulting state. </span><span class="koboSpan" id="kobo.1076.2" xmlns="http://www.w3.org/1999/xhtml">We will repeat this process several times, always measuring the resulting state </span><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle" class="math inline" src="../media/file1075.png" style="vertical-align:middle" title="V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml"> in the </span><span id="dx1-124007"/><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml">computational basis and </span><span id="dx1-124008"/><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml">computing the relative frequency of the outcome </span><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1082.2" xmlns="http://www.w3.org/1999/xhtml">This is illustrated in </span><em><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure7.1"><em><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml">7.1</span></em></a><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 7.1: Circuit to compute \left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}." src="../media/file1077.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure7.1"><strong><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml">Figure 7.1</span></strong><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml">Circuit to compute </span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}" class="math inline" src="../media/file1076.png" style="vertical-align:middle" title="\left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}"/></span><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml">.</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml">The only thing that may, at first, seem difficult with this method is to obtain the circuit for </span><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V{(\theta_{0})}^{\dagger}" class="math inline" src="../media/file1078.png" style="vertical-align:middle" title="V{(\theta_{0})}^{\dagger}"/></span><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1094.2" xmlns="http://www.w3.org/1999/xhtml">However, this is fairly easy. </span><span class="koboSpan" id="kobo.1094.3" xmlns="http://www.w3.org/1999/xhtml">You just need to remember that every unitary gate is reversible. </span><span class="koboSpan" id="kobo.1094.4" xmlns="http://www.w3.org/1999/xhtml">Thus, you can take the circuit for </span><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta)" class="math inline" src="../media/file1034.png" style="vertical-align:middle" title="V(\theta)"/></span><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml"> and read the gates from right to left, reversing each one of them. </span><span class="koboSpan" id="kobo.1096.2" xmlns="http://www.w3.org/1999/xhtml">As a simple example, if </span><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta_{0} = (a,b)" class="math inline" src="../media/file1079.png" style="vertical-align:middle" title="\theta_{0} = (a,b)"/></span><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V(\theta_{0}) = XR_{Z}(a)R_{X}(b)S" class="math inline" src="../media/file1080.png" style="vertical-align:middle" title="V(\theta_{0}) = XR_{Z}(a)R_{X}(b)S"/></span><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V{(\theta_{0})}^{\dagger} = S^{\dagger}R_{X}( - b)R_{Z}( - a)X" class="math inline" src="../media/file1081.png" style="vertical-align:middle" title="V{(\theta_{0})}^{\dagger} = S^{\dagger}R_{X}( - b)R_{Z}( - a)X"/></span><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">Do not forget about this technique for estimating </span><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}" class="math inline" src="../media/file1076.png" style="vertical-align:middle" title="\left| {\left\langle 0 \right|V{(\theta_{0})}^{\dagger}V(\theta)\left| 0 \right\rangle} \right|^{2}"/></span><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml"> because we will be using it again in </span><em><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch018.xhtml#x1-1600009"><em><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml">9</span></em></a><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Support Vector</span></em> <em><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml">Machines</span></em><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml">, in a completely different context.</span></p>
<p><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">This concludes our theoretical study of VQE. </span><span class="koboSpan" id="kobo.1112.2" xmlns="http://www.w3.org/1999/xhtml">In the next section, we will learn how to use this algorithm with Qiskit.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="14.3" id="using-vqe-with-qiskit">
<h1 class="sectionHead" data-number="14.3"><span class="titlemark"><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml">7.3 </span></span> <span id="x1-1250007.3"><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with Qiskit</span></span></h1>
<p><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we will show how we can use </span><span id="dx1-125001"/><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml">Qiskit to run VQE on both simulators and actual quantum hardware. </span><span class="koboSpan" id="kobo.1116.2" xmlns="http://www.w3.org/1999/xhtml">To do that, we will use a problem taken from quantum chemistry: determining the energy of the </span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{2}" class="math inline" src="../media/file1082.png" style="vertical-align:middle" title="H_{2}"/></span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml"> or dihydrogen molecule. </span><span class="koboSpan" id="kobo.1118.2" xmlns="http://www.w3.org/1999/xhtml">Our first subsection is devoted to defining this problem.</span></p>
<section class="level3 subsectionHead" data-number="14.3.1" id="defining-a-molecular-problem-in-qiskit">
<h2 class="subsectionHead" data-number="14.3.1"><span class="titlemark"><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml">7.3.1 </span></span> <span id="x1-1260007.3.1"><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml">Defining a molecular problem in Qiskit</span></span></h2>
<p><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml">To illustrate how we can use VQE with Qiskit, we will </span><span id="dx1-126001"/><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">consider a simple quantum chemistry problem. </span><span class="koboSpan" id="kobo.1122.2" xmlns="http://www.w3.org/1999/xhtml">We will imagine that we have two atoms of hydrogen forming an </span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{2}" class="math inline" src="../media/file1082.png" style="vertical-align:middle" title="H_{2}"/></span><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml"> molecule and that we want to </span><span id="dx1-126002"/><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml">compute its ground state and its energy. </span><span class="koboSpan" id="kobo.1125.2" xmlns="http://www.w3.org/1999/xhtml">For that, we need to obtain the Hamiltonian of the system, which is a little bit different from the kind of Hamiltonian that we are used to. </span><span class="koboSpan" id="kobo.1125.3" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-126003"/><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians that we have considered so far are called </span><strong><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml">qubit</span></strong> <strong><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonians</span></strong><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">, while the one that we need to describe the energy of the </span><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{2}" class="math inline" src="../media/file1082.png" style="vertical-align:middle" title="H_{2}"/></span><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml"> molecule is called a </span><strong><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml">fermionic Hamiltonian</span></strong><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml"> — the name </span><span id="dx1-126004"/><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml">comes from the fact that it involves fermions, that is, particles such as electrons, protons, and neutrons.</span></p>
<p><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">We do not need to go into all the details of the computation of this type of Hamiltonian (if you are curious, you can refer to </span><em><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></em><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"> in the book by Sharkey and Chancé </span><span class="cite"><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsharkey2022quantum"><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml">86</span></a><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml">), because all the necessary methods are provided in the Qiskit Nature package. </span><span class="koboSpan" id="kobo.1141.2" xmlns="http://www.w3.org/1999/xhtml">What is more, no quantum computer is involved in the process; it is all computed and estimated classically.</span></p>
<p><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml">To obtain the fermionic Hamiltonian for the dihydrogen molecule with Qiskit, we need to install the Qiskit Nature package as well as the pyscf library, which is used for the computational chemistry calculations (please, refer to </span><em><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml">, for the installation procedure and note that we will be using version 0.4.5 of the package).</span></p>
<p><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can execute the following instructions:</span></p>
<p><span id="x1-126005"/></p>
<pre class="lstlisting" id="listing-155"><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.drivers import Molecule 
 
from qiskit_nature.drivers.second_quantization import \ 
 
    ElectronicStructureMoleculeDriver, ElectronicStructureDriverType 
 
from qiskit_nature.problems.second_quantization import \ 
 
    ElectronicStructureProblem 
 
 
 
mol = Molecule(geometry=[[’H’, [0., 0., -0.37]], 
 
                        [’H’, [0., 0., 0.37]]]) 
 
driver = ElectronicStructureMoleculeDriver(mol, basis=’sto3g’, 
 
        driver_type=ElectronicStructureDriverType.PYSCF) 
 
problem = ElectronicStructureProblem(driver) 
 
secqop = problem.second_q_ops() 
 
print(secqop[0])
</span></pre>
<p><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml">Here, we are defining a </span><span id="dx1-126019"/><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml">molecule consisting of two hydrogen atoms located at coordinates </span><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,0, - 0.37)" class="math inline" src="../media/file1083.png" style="vertical-align:middle" title="(0,0, - 0.37)"/></span><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,0,0.37)" class="math inline" src="../media/file1084.png" style="vertical-align:middle" title="(0,0,0.37)"/></span><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml"> (measured in angstroms), which is close to an equilibrium state for this molecule. </span><span class="koboSpan" id="kobo.1155.2" xmlns="http://www.w3.org/1999/xhtml">We are using the </span><span id="dx1-126020"/><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">default parameters, such as, for instance, establishing that the molecule is not charged. </span><span class="koboSpan" id="kobo.1156.2" xmlns="http://www.w3.org/1999/xhtml">Then, we define an electronic structure problem; that is, we ask the pyscf library, through the Qiskit interface, to compute the fermionic Hamiltonian that takes into account the different possible configurations for the electrons of the two hydrogen atoms. </span><span class="koboSpan" id="kobo.1156.3" xmlns="http://www.w3.org/1999/xhtml">This is done with </span><span id="dx1-126021"/><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml">something called </span><strong><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml">second</span></strong> <strong><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml">quantization</span></strong><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml"> (hence the name </span><code><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">second_q_ops</span></code><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"> for the method that we use).</span></p>
<p><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml">When we run this piece of code, we obtain the following output:</span></p>
<pre class="lstlisting" id="listing-156"><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml">

Fermionic Operator 
 
register length=4, number terms=36 
 
  -1.2533097866459775 * ( +_0 -_0 ) 
 
+ -0.47506884877217725 * ( +_1 -_1 ) 
 
+ -1.2533097866459775 * ( +_2 -_2 ) 
 
+ -0.47506884877217725 * ( +_3 -_3 ) 
 
+ -0.3373779634072241 * ( +_0 +_0 -_0 -_0 ) 
 
+ -0.0 ...
</span></pre>
<p><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">This is a truncated view of the fermionic Hamiltonian, involving </span><span id="dx1-126030"/><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml">something called </span><strong><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml">creation</span></strong><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><strong><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml">annihilation</span></strong> <span id="dx1-126031"/><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml">operators that describe how electrons move from one orbital to another (more details can be found in </span><em><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></em><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml"> of the book by Sharkey and Chancé </span><span class="cite"><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsharkey2022quantum"><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml">86</span></a><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
<p><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml">That is all very nice, but we can’t yet use it on our shiny quantum computers. </span><span class="koboSpan" id="kobo.1177.2" xmlns="http://www.w3.org/1999/xhtml">For that, we need to transform the </span><span id="dx1-126032"/><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">fermionic Hamiltonian into a qubit Hamiltonian, involving Pauli gates. </span><span class="koboSpan" id="kobo.1178.2" xmlns="http://www.w3.org/1999/xhtml">There are </span><span id="dx1-126033"/><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">several ways to do this. </span><span class="koboSpan" id="kobo.1179.2" xmlns="http://www.w3.org/1999/xhtml">One of the most </span><span id="dx1-126034"/><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml">popular ones is the </span><strong><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">Jordan-Wigner</span></strong><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml"> transformation (again, see the book by Sharkey and Chancé </span><span class="cite"><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsharkey2022quantum"><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">86</span></a><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml"> for a thorough explanation), that we can use in Qiskit with the following instructions:</span></p>
<pre class="lstlisting" id="listing-157"><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.converters.second_quantization import QubitConverter 
 
from qiskit_nature.mappers.second_quantization import JordanWignerMapper 
 
 
 
qconverter = QubitConverter(JordanWignerMapper()) 
 
qhamiltonian = qconverter.convert(secqop[0]) 
 
print("Qubit Hamiltonian") 
 
print(qhamiltonian)
</span></pre>
<p><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml">Upon running this code, we will obtain the following output:</span></p>
<pre class="lstlisting" id="listing-158"><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml">

Qubit Hamiltonian 
 
-0.8121706072487122 * IIII 
 
+ 0.17141282644776915 * IIIZ 
 
- 0.22343153690813483 * IIZI 
 
+ 0.17141282644776915 * IZII 
 
- 0.22343153690813483 * ZIII 
 
+ 0.12062523483390415 * IIZZ 
 
+ 0.16868898170361205 * IZIZ 
 
+ 0.04530261550379923 * YYYY 
 
+ 0.04530261550379923 * XXYY 
 
+ 0.04530261550379923 * YYXX 
 
+ 0.04530261550379923 * XXXX 
 
+ 0.16592785033770338 * ZIIZ 
 
+ 0.16592785033770338 * IZZI 
 
+ 0.1744128761226159 * ZIZI 
 
+ 0.12062523483390415 * ZZII
</span></pre>
<p><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml">Now we are back on </span><span id="dx1-126058"/><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml">known territory once again! </span><span class="koboSpan" id="kobo.1191.2" xmlns="http://www.w3.org/1999/xhtml">This is, indeed, one of the Hamiltonians that we </span><span id="dx1-126059"/><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml">have come to know and love. </span><span class="koboSpan" id="kobo.1192.2" xmlns="http://www.w3.org/1999/xhtml">In fact, this is a Hamiltonian on </span><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, involving tensor products of </span><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y" class="math inline" src="../media/file11.png" style="vertical-align:middle" title="Y"/></span><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml"> gates, as the ones appearing in terms such as </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml">0.17141282644776915</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">*</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml">IIIZ</span></code></span></span><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml">0.04530261550379923</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml">*</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml">XXYY</span></code></span></span><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml">What is more important to us: this is the kind of Hamiltonian to which we can apply the VQE algorithm in order to obtain its ground state. </span><span class="koboSpan" id="kobo.1211.2" xmlns="http://www.w3.org/1999/xhtml">And, without further ado, that is exactly what we will be doing in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.2" id="using-vqe-with-hamiltonians">
<h2 class="subsectionHead" data-number="14.3.2"><span class="titlemark"><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml">7.3.2 </span></span> <span id="x1-1270007.3.2"><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with Hamiltonians</span></span></h2>
<p><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have a qubit </span><span id="dx1-127001"/><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian describing our electronic problem, let’s see how we can use VQE with Qiskit to find its ground state. </span><span class="koboSpan" id="kobo.1215.2" xmlns="http://www.w3.org/1999/xhtml">Remember that, to use VQE, we first need to choose an ansatz. </span><span class="koboSpan" id="kobo.1215.3" xmlns="http://www.w3.org/1999/xhtml">To start with, we will use something simple. </span><span class="koboSpan" id="kobo.1215.4" xmlns="http://www.w3.org/1999/xhtml">We will select one of the variational forms provided by Qiskit: the </span><code><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">EfficientSU2</span></code><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml"> form. </span><span class="koboSpan" id="kobo.1217.2" xmlns="http://www.w3.org/1999/xhtml">We can define it and draw its circuit for </span><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml"> qubits with the following instructions (remember that you need to install the pylatexenc library to draw with the </span><span class="lstinline"><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml">mpl</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span></span><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml"> option; please, refer to </span><em><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml">):</span></p>
<pre class="lstlisting" id="listing-159"><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.circuit.library import EfficientSU2 
 
 
 
ansatz = EfficientSU2(num_qubits=4, reps=1, entanglement="linear", 
 
    insert_barriers = True) 
 
ansatz.decompose().draw("mpl")
</span></pre>
<p><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml">Here, we have specified that we are using the variational form on </span><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, that we only use one repetition (that is, a single layer of CNOT gates) and that the entanglement that we want to use is linear: this means that each qubit is entangled with a CNOT gate to the following one. </span><span class="koboSpan" id="kobo.1232.2" xmlns="http://www.w3.org/1999/xhtml">After running this piece of code, we will obtain the image depicted in </span><em><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure7.2"><em><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml">7.2</span></em></a><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1235.2" xmlns="http://www.w3.org/1999/xhtml">As you can see, we are using </span><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Y}" class="math inline" src="../media/file119.png" style="vertical-align:middle" title="R_{Y}"/></span><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml"> gates, together with entangling gates (CNOT gates, in this case). </span><span class="koboSpan" id="kobo.1239.2" xmlns="http://www.w3.org/1999/xhtml">In total, we have 16 different tunable parameters, represented by </span><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta\lbrack 0\rbrack,\ldots,\theta\lbrack 15\rbrack" class="math inline" src="../media/file1085.png" style="vertical-align:middle" title="\theta\lbrack 0\rbrack,\ldots,\theta\lbrack 15\rbrack"/></span><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml"> in the figure. </span><span class="koboSpan" id="kobo.1241.2" xmlns="http://www.w3.org/1999/xhtml">We will discuss more variational forms, similar to this one, in </span><em><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">Chapters</span></em> <em/> <a href="ch018.xhtml#x1-1600009"><em><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml">9</span></em></a><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><em/> <a href="ch019.xhtml#x1-18100010"><em><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml">10</span></em></a><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1246.2" xmlns="http://www.w3.org/1999/xhtml">For now, it is enough to notice that this is a circuit that we can easily implement in current </span><span id="dx1-127007"/><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml">quantum hardware (because it only involves simple one and two-qubit gates), but that allows us to create somewhat complicated quantum states, with entanglement among all the qubits.</span></p>
<figure>
<span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 7.2: The EfficientSU2 variational form on 4 qubits." src="../media/file1086.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure7.2"><strong><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml">Figure 7.2</span></strong><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml">The EfficientSU2 variational form on 4 qubits.</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml">Once we have selected our ansatz, we can define a VQE instance. </span><span class="koboSpan" id="kobo.1252.2" xmlns="http://www.w3.org/1999/xhtml">In order to do that, we can use the following instructions:</span></p>
<pre class="lstlisting" id="listing-160"><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.algorithms import VQE 
 
from qiskit import Aer 
 
from qiskit.utils import QuantumInstance, algorithm_globals 
 
import numpy as np 
 
from qiskit.algorithms.optimizers import COBYLA 
 
 
 
seed = 1234 
 
np.random.seed(seed) 
 
algorithm_globals.random_seed = seed 
 
 
 
optimizer = COBYLA() 
 
 
 
initial_point = np.random.random(ansatz.num_parameters) 
 
quantum_instance = QuantumInstance(backend = 
 
    Aer.get_backend(’aer_simulator_statevector’)) 
 
 
 
vqe = VQE(ansatz=ansatz, optimizer=optimizer, 
 
    initial_point=initial_point, 
 
    quantum_instance=quantum_instance)
</span></pre>
<p><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml">After the </span><span id="dx1-127029"/><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml">necessary imports, we set a seed for reproducibility. </span><span class="koboSpan" id="kobo.1255.2" xmlns="http://www.w3.org/1999/xhtml">Then, we selected COBYLA as our classical optimizer; that is, the algorithm in charge of varying the parameters in order to find those that achieve the minimum energy. </span><span class="koboSpan" id="kobo.1255.3" xmlns="http://www.w3.org/1999/xhtml">We also set some random initial values for our parameters and we declared a </span><code><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml"> that encapsulates a state vector simulator. </span><span class="koboSpan" id="kobo.1257.2" xmlns="http://www.w3.org/1999/xhtml">Finally, we declared our VQE instance with the ansatz, optimizer, initial values, and quantum instance options.</span></p>
<p><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">Running the VQE is now very easy. </span><span class="koboSpan" id="kobo.1258.2" xmlns="http://www.w3.org/1999/xhtml">We only need to execute the following instructions:</span></p>
<pre class="lstlisting" id="listing-161"><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml">

result = vqe.compute_minimum_eigenvalue(qhamiltonian) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml">After a few seconds, we obtain the following output:</span></p>
<p><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml">@empty</span></p>
<pre class="lstlisting" id="listing-162"><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operator_eigenvalues’: None, 
 
    ’cost_function_evals’: 888, 
 
    ’eigenstate’: array([ 1.55163279e-09+7.04522580e-10j, 
 
        1.17994431e-06+6.29389934e-07j, 
 
       -6.87287902e-05-1.19175176e-04j,  9.01607105e-09+1.75153048e-10j, 
 
        3.17070261e-06-2.71251777e-05j, -9.23514532e-01-3.66685696e-01j, 
 
       -6.50833666e-07-1.04178617e-06j, -6.40877389e-06-1.04499914e-05j, 
 
       -1.33988128e-06+3.63309921e-07j,  1.08441415e-05+7.61755332e-08j, 
 
        1.04578392e-01+4.15432635e-02j, -5.85921512e-06+4.47076415e-06j, 
 
       -1.01179799e-09+1.85616927e-09j,  5.57085679e-05+5.29593190e-05j, 
 
        1.47630244e-07+4.00357904e-08j,  1.51330159e-10+9.41869390e-10j]), 
 
    ’eigenvalue’: (-1.8523881417094914+0j), 
 
    ’optimal_circuit’: None, 
 
    ’optimal_parameters’: { 
 
        ParameterVectorElement(@$\theta$@[7]): -0.10263498379273155, 
 
        ParameterVectorElement(@$\theta$@[6]): -0.13154223054201972, 
 
        ParameterVectorElement(@$\theta$@[8]): 3.1416468430294864, 
 
        ParameterVectorElement(@$\theta$@[13]): 0.6426987629297032, 
 
        ParameterVectorElement(@$\theta$@[9]): 2.4674114077579344e-05, 
 
        ParameterVectorElement(@$\theta$@[14]): -0.11387081297526412, 
 
        ParameterVectorElement(@$\theta$@[15]): 2.525254909939928, 
 
        ParameterVectorElement(@$\theta$@[12]): 1.8446272942674344, 
 
        ParameterVectorElement(@$\theta$@[11]): -0.0011789455587669483, 
 
        ParameterVectorElement(@$\theta$@[10]): 2.7179451047891577e-06, 
 
        ParameterVectorElement(@$\theta$@[3]): 3.1403232388683655, 
 
        ParameterVectorElement(@$\theta$@[1]): 9.061128731357842e-06, 
 
        ParameterVectorElement(@$\theta$@[2]): 3.141570826032646, 
 
        ParameterVectorElement(@$\theta$@[0]): -0.22553325325129397, 
 
        ParameterVectorElement(@$\theta$@[5]): 2.1513214842441912, 
 
        ParameterVectorElement(@$\theta$@[4]): 1.7045601611970793}, 
 
    ’optimal_point’: array([-2.25533253e-01,  9.06112873e-06, 
 
        3.14157083e+00,  3.14032324e+00, 
 
        1.70456016e+00,  2.15132148e+00, -1.31542231e-01, -1.02634984e-01, 
 
        3.14164684e+00,  2.46741141e-05,  2.71794510e-06, -1.17894556e-03, 
 
        1.84462729e+00,  6.42698763e-01, -1.13870813e-01,  2.52525491e+00]), 
 
    ’optimal_value’: -1.8523881417094914, 
 
    ’optimizer_evals’: None, 
 
    ’optimizer_result’: None, 
 
    ’optimizer_time’: 3.0011892318725586}
</span></pre>
<p><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">This may seem like a lot of </span><span id="dx1-127071"/><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">information but, in fact, some data is presented several times in different ways and, all in all, the format is quite similar to what we are used to from our experience using QAOA in Qiskit back in </span><em><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1269.2" xmlns="http://www.w3.org/1999/xhtml">As you can see, we have obtained the optimal values for the circuit parameters, the state that is generated with those parameters (the </span><span class="lstinline"><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml">eigenstate</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span></span><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml"> field) and what we were looking for: the energy of that state, which happens to be about </span><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1.8524" class="math inline" src="../media/file1087.png" style="vertical-align:middle" title="- 1.8524"/></span><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml"> hartrees (the unit of energy commonly used in molecular orbital calculations). </span><span class="koboSpan" id="kobo.1275.2" xmlns="http://www.w3.org/1999/xhtml">This means that…we have solved our problem! </span><span class="koboSpan" id="kobo.1275.3" xmlns="http://www.w3.org/1999/xhtml">Or have we? </span><span class="koboSpan" id="kobo.1275.4" xmlns="http://www.w3.org/1999/xhtml">How can we be sure that the value that we have obtained is correct?</span></p>
<p><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the Hamiltonian that we are using is quite small (only </span><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml"> qubits), so we can check our result using a classical solver that finds the exact ground state. </span><span class="koboSpan" id="kobo.1278.2" xmlns="http://www.w3.org/1999/xhtml">We will use </span><code><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">NumPyMinimumEigensolver</span></code><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml">, just as we did with the combinatorial optimization problems that we considered back in </span><em><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1285.2" xmlns="http://www.w3.org/1999/xhtml">For that, we can run the following piece of code:</span></p>
<pre class="lstlisting" id="listing-163"><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.algorithms.minimum_eigensolvers import \ 
 
    NumPyMinimumEigensolver 
 
solver = NumPyMinimumEigensolver() 
 
result = solver.compute_minimum_eigenvalue(qhamiltonian) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml">The output of these instructions is the following:</span></p>
<pre class="lstlisting" id="listing-164"><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operators_evaluated’: None, 
 
    ’eigenstate’: Statevector([-1.53666363e-17-4.93701060e-20j, 
 
             -4.57234900e-16-4.65250782e-16j, 
 
              1.25565337e-17-2.11612780e-17j, 
 
              4.73690908e-16-1.33060132e-16j, 
 
              1.52564317e-16-1.40021223e-16j, 
 
             -6.67316913e-01-7.36221442e-01j, 
 
             -1.62999711e-16-2.24584031e-16j, 
 
             -8.42710421e-17+6.43081213e-17j, 
 
             -7.98957973e-17-1.35250844e-17j, 
 
              1.90408979e-16+3.25517112e-16j, 
 
              7.55826341e-02+8.33870007e-02j, 
 
             -3.56170534e-17+9.82948865e-17j, 
 
             -4.51619835e-16+1.70721750e-16j, 
 
              1.91645940e-17-1.45775129e-16j, 
 
             -4.79331105e-17+5.57184037e-17j, 
 
             -3.62080563e-17+4.86380668e-17j], 
 
            dims=(2, 2, 2, 2)), 
 
    ’eigenvalue’: -1.852388173569583}
</span></pre>
<p><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">This is </span><span id="dx1-127096"/><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml">certainly more concise than the VQE output, but the final energy is almost equal to the one we had obtained previously. </span><span class="koboSpan" id="kobo.1290.2" xmlns="http://www.w3.org/1999/xhtml">Now we can really say it: we did it! </span><span class="koboSpan" id="kobo.1290.3" xmlns="http://www.w3.org/1999/xhtml">We have successfully solved a molecular problem with VQE!</span></p>
<p><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">Of course, we can use VQE with any type of Hamiltonian, not just with the ones that come from quantum chemistry problems. </span><span class="koboSpan" id="kobo.1291.2" xmlns="http://www.w3.org/1999/xhtml">We can even use it with Hamiltonians for combinatorial optimization problems, as we did back in </span><em><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1296.2" xmlns="http://www.w3.org/1999/xhtml">With what we already know, this is easy…so easy that we entrust it to you as an exercise.</span></p>
<div class="tcolorbox questionx" id="tcolobox-141">
<span id="x1-127098x7.3.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.7</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml">Use Qiskit’s VQE implementation to solve the Max-Cut problem for a graph of </span><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml"> vertices in which the connections are </span><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,1),(1,2),(2,3),(3,4)" class="math inline" src="../media/file1088.png" style="vertical-align:middle" title="(0,1),(1,2),(2,3),(3,4)"/></span><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(4,0)" class="math inline" src="../media/file1089.png" style="vertical-align:middle" title="(4,0)"/></span><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">Once we know how to find the ground state of a Hamiltonian with VQE, why not be a little more ambitious? </span><span class="koboSpan" id="kobo.1305.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will also be looking for excited states!</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.3" id="finding-excited-states-with-qiskit">
<h2 class="subsectionHead" data-number="14.3.3"><span class="titlemark"><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml">7.3.3 </span></span> <span id="x1-1280007.3.3"><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">Finding excited states with Qiskit</span></span></h2>
<p><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml">Back in </span><em><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-1240007.2.1"><em><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml">7.2.1</span></em></a><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml">, we </span><span id="dx1-128001"/><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">learned how to use VQE iteratively to find not only the ground state of a Hamiltonian, but also states of higher energy that we call excited states. </span><span class="koboSpan" id="kobo.1312.2" xmlns="http://www.w3.org/1999/xhtml">The algorithm that we studied is </span><span id="dx1-128002"/><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml">sometimes called </span><strong><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">Variational</span></strong> <strong><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Deflation</span></strong><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml"> (this was the name used by Higgot, Wang, and Brierley when they introduced it </span><span class="cite"><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xhiggott2019variational"><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml">53</span></a><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">) or </span><strong><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml">VQD</span></strong><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml">, and it is implemented by Qiskit in the </span><code><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">VQD</span></code><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></p>
<p><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">Using VQD in Qiskit is almost the same as using VQE. </span><span class="koboSpan" id="kobo.1325.2" xmlns="http://www.w3.org/1999/xhtml">The only difference is that we need to specify how many eigenstates we want to obtain (of course, if we only request </span><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml"> this will be </span><em><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">exactly</span></em><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml"> like applying VQE). </span><span class="koboSpan" id="kobo.1329.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if we want to obtain two eigenstates (the ground state and the first excited state) in our molecular problem, we can use the following instructions:</span></p>
<pre class="lstlisting" id="listing-165"><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.algorithms import VQD 
 
vqd = VQD(ansatz=ansatz, 
 
    optimizer=optimizer, 
 
    initial_point=initial_point, 
 
    quantum_instance=quantum_instance, 
 
    k = 2) 
 
result = vqd.compute_eigenvalues(qhamiltonian) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml">k</span></code><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml"> parameter is the one that we use to specify the number of eigenstates. </span><span class="koboSpan" id="kobo.1333.2" xmlns="http://www.w3.org/1999/xhtml">Upon running these instructions, we obtain the following output (we have omitted part of it for brevity):</span></p>
<p><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml">@empty</span></p>
<pre class="lstlisting" id="listing-166"><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operator_eigenvalues’: None, 
 
    ’cost_function_evals’: array([ 888, 1000]), 
 
    ’eigenstates’: ListOp([VectorStateFn(Statevector( 
 
            [ 1.55163279e-09+7.04522580e-10j, 
 
              1.17994431e-06+6.29389934e-07j, 
 
              ... 
 
              </span><span class="koboSpan" id="kobo.1335.2" xmlns="http://www.w3.org/1999/xhtml">1.51330159e-10+9.41869390e-10j], 
 
            dims=(2, 2, 2, 2)), coeff=1.0, 
 
            is_measurement=False), 
 
            VectorStateFn(Statevector( 
 
            [-5.01605162e-02+4.38928908e-02j, 
 
             -7.31117975e-01-3.69461649e-02j, 
 
             -6.34876999e-03-5.19845422e-03j, 
 
             ... 
 
             </span><span class="koboSpan" id="kobo.1335.3" xmlns="http://www.w3.org/1999/xhtml">-4.10301081e-02+2.77415065e-02j], 
 
            dims=(2, 2, 2, 2)), coeff=1.0, 
 
            is_measurement=False)], coeff=1.0, 
 
            abelian=False), 
 
    ’eigenvalues’: array([-1.85238814-1.11e-16j, -1.19536442+0.00e+00j]), 
 
    ’optimal_circuit’: None, 
 
    ’optimal_parameters’: [ 
 
    {   ParameterVectorElement(@$\theta$@[0]): -0.22553325325129397, 
 
        ParameterVectorElement(@$\theta$@[1]): 9.061128731357842e-06, 
 
        ... 
 
        </span><span class="koboSpan" id="kobo.1335.4" xmlns="http://www.w3.org/1999/xhtml">ParameterVectorElement(@$\theta$@[15]): 2.525254909939928}, 
 
    {   ParameterVectorElement(@$\theta$@[0]): 0.012174657752649348, 
 
        ParameterVectorElement(@$\theta$@[1]): -0.056812096977499754, 
 
        ... 
 
        </span><span class="koboSpan" id="kobo.1335.5" xmlns="http://www.w3.org/1999/xhtml">ParameterVectorElement(@$\theta$@[15]): 1.522408417522795}], 
 
    ’optimal_point’: 
 
    array([[-2.25533253e-01,  9.06112873e-06,  3.14157083e+00, 
 
         3.14032324e+00,  1.70456016e+00,  2.15132148e+00, 
 
         ... 
 
         </span><span class="koboSpan" id="kobo.1335.6" xmlns="http://www.w3.org/1999/xhtml">2.52525491e+00], 
 
       [ 1.21746578e-02, -5.68120970e-02,  1.31641034e+00, 
 
         4.59223490e-01,  7.25749716e-01,  9.54546607e-02, 
 
         ... 
 
         </span><span class="koboSpan" id="kobo.1335.7" xmlns="http://www.w3.org/1999/xhtml">1.52240842e+00]]), 
 
    ’optimal_value’: array([-1.85238814, -1.1952203 ]), 
 
    ’optimizer_evals’: None, 
 
    ’optimizer_result’: None, 
 
    ’optimizer_time’: array([ 2.32541203, 53.26829457])}
</span></pre>
<p><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, this </span><span id="dx1-128053"/><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml">output is structured like that of the VQE execution. </span><span class="koboSpan" id="kobo.1337.2" xmlns="http://www.w3.org/1999/xhtml">However, in this case, we get two entries in each field, one for each of the eigenstates that we requested.</span></p>
<p><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">So far, we have learned how to use both VQE and VQD with Hamiltonians that may have come from any source. </span><span class="koboSpan" id="kobo.1338.2" xmlns="http://www.w3.org/1999/xhtml">However, the use case of finding ground states of molecular Hamiltonians is so important that Qiskit provides special methods for dealing with them in particular. </span><span class="koboSpan" id="kobo.1338.3" xmlns="http://www.w3.org/1999/xhtml">We will learn how in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.4" id="using-vqe-with-molecular-problems">
<h2 class="subsectionHead" data-number="14.3.4"><span class="titlemark"><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml">7.3.4 </span></span> <span id="x1-1290007.3.4"><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with molecular problems</span></span></h2>
<p><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml">In addition to using VQE to find </span><span id="dx1-129001"/><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml">ground states of any given Hamiltonian, we can use it directly with molecular problems that we define with the help of the Qiskit Nature utilities. </span><span class="koboSpan" id="kobo.1342.2" xmlns="http://www.w3.org/1999/xhtml">For instance, we can use a VQE instance to solve the electronic problem that we defined in the previous subsection. </span><span class="koboSpan" id="kobo.1342.3" xmlns="http://www.w3.org/1999/xhtml">To do that, we only need to run the following instructions:</span></p>
<pre class="lstlisting" id="listing-167"><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.algorithms import GroundStateEigensolver 
 
 
 
solver = GroundStateEigensolver(qconverter, vqe) 
 
result = solver.solve(problem) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, we have defined a </span><code><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml">GroundStateEigensolver</span></code><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml"> object that we then use to solve our problem. </span><span class="koboSpan" id="kobo.1346.2" xmlns="http://www.w3.org/1999/xhtml">This object, in turn, uses two objects that we had defined previously — </span><code><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml">qconverter</span></code><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">, which is used to transform the fermionic Hamiltonian into a qubit Hamiltonian, and the instance of VQE that we used two </span><span id="dx1-129007"/><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">subsections ago. </span><span class="koboSpan" id="kobo.1349.2" xmlns="http://www.w3.org/1999/xhtml">When we run these instructions, we get the following output:</span></p>
<pre class="lstlisting" id="listing-168"><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.852388141709 
 
  - computed part:      -1.852388141709 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.137283802628 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 2.000 S: 0.000 S^2: 0.000 M: 0.000 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  0.00001495] 
 
    - computed part:      [0.0  0.0  0.00001495] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  -0.00001495]  Total: 0.00001495 
 
                 (debye): [0.0  0.0  -0.000038]  Total: 0.000038
</span></pre>
<p><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml">The information that we get in this case is at a higher level of abstraction than the one we obtained before. </span><span class="koboSpan" id="kobo.1351.2" xmlns="http://www.w3.org/1999/xhtml">For instance, we get data about the number of particles, dipole moments, and so on (don’t worry if you do not understand these concepts; they are meant to make sense to chemists and physicists that work with this kind of problem). </span><span class="koboSpan" id="kobo.1351.3" xmlns="http://www.w3.org/1999/xhtml">However, the numerical result of the electronic ground state energy is the same that we obtained with our previous application of VQE. </span><span class="koboSpan" id="kobo.1351.4" xmlns="http://www.w3.org/1999/xhtml">The difference is that now, we are providing the solver not only with the Hamiltonian, but with the whole problem, and it can use that information to reconstruct the meaning of the calculations in physical terms. </span><span class="koboSpan" id="kobo.1351.5" xmlns="http://www.w3.org/1999/xhtml">For instance, we now get some bonus </span><span id="dx1-129028"/><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">information such as the </span><strong><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml">total ground state</span></strong> <strong><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></strong><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml">, which is the sum of the energy due to the </span><span id="dx1-129029"/><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml">electronic structure (the one that we had computed previously) and the energy due to nuclear repulsion.</span></p>
<p><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">This type of output is much more legible. </span><span class="koboSpan" id="kobo.1357.2" xmlns="http://www.w3.org/1999/xhtml">That’s why we will use this solver for the rest of this section.</span></p>
<p><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml">As an additional example of how to use VQE to solve molecular problems, we are now going to consider a different, more elaborate ansatz. </span><span class="koboSpan" id="kobo.1358.2" xmlns="http://www.w3.org/1999/xhtml">Earlier in this chapter, we mentioned how, when selecting the variational form and initial state to be used with VQE, it could prove useful to take into account information from the problem domain. </span><span class="koboSpan" id="kobo.1358.3" xmlns="http://www.w3.org/1999/xhtml">This is the case of the </span><strong><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml">Unitary Coupled-Cluster</span></strong> <strong><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml">Singles and Doubles</span></strong><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">UCCSD</span></strong><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml"> ansatz, which is widely used for molecular computations (see the survey by McArdle et al. </span><span class="cite"><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xmcardle2020quantum"><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml">66</span></a><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml"> for more details).</span></p>
<p><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">In Qiskit, we can use the </span><span id="dx1-129030"/><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">UCSSD ansatz with the following instructions:</span></p>
<pre class="lstlisting" id="listing-169"><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.algorithms import VQEUCCFactory 
 
 
 
vqeuccf = VQEUCCFactory(quantum_instance = quantum_instance)
</span></pre>
<p><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">VQEUCCFactory</span></code><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml"> class creates a whole VQE instance, with the UCSSD ansatz as the default variational form. </span><span class="koboSpan" id="kobo.1373.2" xmlns="http://www.w3.org/1999/xhtml">Here, we are using the </span><code><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml">quantum_instance</span></code><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml"> object that we had defined previously. </span><span class="koboSpan" id="kobo.1375.2" xmlns="http://www.w3.org/1999/xhtml">We can visualize the circuit for the ansatz created by </span><code><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">VQEUCCFactory</span></code><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml"> with the following instruction:</span></p>
<pre class="lstlisting" id="listing-170"><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">

vqeuccf.get_solver(problem, qconverter).ansatz.decompose().draw("mpl")
</span></pre>
<p><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we are calling the </span><code><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">get_solver</span></code><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml"> method, to which we pass the </span><code><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml">problem</span></code><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml"> object defined previously to provide the information about the Hamiltonian involved in the computation. </span><span class="koboSpan" id="kobo.1383.2" xmlns="http://www.w3.org/1999/xhtml">Then, we access the ansatz circuit through the </span><code><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml">ansatz</span></code><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml"> attribute and we proceed to draw it. </span><span class="koboSpan" id="kobo.1385.2" xmlns="http://www.w3.org/1999/xhtml">Upon running this instruction, we obtain the circuit depicted in </span><em><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure7.3"><em><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml">7.3</span></em></a><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1388.2" xmlns="http://www.w3.org/1999/xhtml">As you can see, the ansatz involves exponential functions of tensor products of Pauli matrices. </span><span class="koboSpan" id="kobo.1388.3" xmlns="http://www.w3.org/1999/xhtml">There are also two </span><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml"> gates at the beginning of the circuit that set the initial state to which the variational form is later applied. </span><span class="koboSpan" id="kobo.1390.2" xmlns="http://www.w3.org/1999/xhtml">In this case, the state is called the </span><strong><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">Hartree-Fock</span></strong><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml"> state, again a </span><span id="dx1-129035"/><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml">widely used option when solving molecular problems with quantum computers — and the </span><span id="dx1-129036"/><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml">default value with </span><code><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml">VQEUCCFactory</span></code><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 7.3: UCCSD ansatz for our problem" src="../media/file1090.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure7.3"><strong><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml">Figure 7.3</span></strong><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml">UCCSD ansatz for our problem</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml">Now, we can easily use VQE to solve our </span><span id="dx1-129039"/><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">problem with the selected ansatz by running the following piece of code:</span></p>
<pre class="lstlisting" id="listing-171"><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">

solver = GroundStateEigensolver(qconverter, vqeuccf) 
 
result = solver.solve(problem) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml">This will give us the following output:</span></p>
<pre class="lstlisting" id="listing-172"><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.852388173513 
 
  - computed part:      -1.852388173513 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.137283834432 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 2.000 S: 0.000 S^2: 0.000 M: 0.000 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  -0.00000013] 
 
    - computed part:      [0.0  0.0  -0.00000013] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  0.00000013]  Total: 0.00000013 
 
                 (debye): [0.0  0.0  0.00000033]  Total: 0.00000033
</span></pre>
<p><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml">This result is very </span><span id="dx1-129063"/><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml">similar to the one that we obtained with the </span><code><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml">EfficientSU2</span></code><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml"> ansatz.</span></p>
<div class="tcolorbox questionx" id="tcolobox-142">
<span id="x1-129066x7.3.4"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.8</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml">Write code to use VQE with the UCCSD ansatz to compute the total ground state energy for two atoms of hydrogen that are at distances ranging from </span><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.2" class="math inline" src="../media/file1091.png" style="vertical-align:middle" title="0.2"/></span><span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2.0" class="math inline" src="../media/file1092.png" style="vertical-align:middle" title="2.0"/></span><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml"> angstroms, in steps of </span><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.01" class="math inline" src="../media/file1093.png" style="vertical-align:middle" title="0.01"/></span><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml"> angstroms. </span><span class="koboSpan" id="kobo.1417.2" xmlns="http://www.w3.org/1999/xhtml">Plot the energy against the distance. </span><span class="koboSpan" id="kobo.1417.3" xmlns="http://www.w3.org/1999/xhtml">This kind of plot is sometimes </span><span id="dx1-129065"/><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml">known as the </span><strong><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml">dissociation profile</span></strong><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml"> of the molecule. </span><em><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml">Hint:</span></em><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml"> when running VQE on a molecular problem, you can access the total ground state energy through the </span><code><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml">total_energies</span></code><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml"> attribute of the result object.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know how to use VQE in different ways with simulators, we could try to run the algorithm on actual quantum computers. </span><span class="koboSpan" id="kobo.1425.2" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, before doing that, we will learn how to incorporate noise to our quantum simulator.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.5" id="simulations-with-noise">
<h2 class="subsectionHead" data-number="14.3.5"><span class="titlemark"><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml">7.3.5 </span></span> <span id="x1-1300007.3.5"><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml">Simulations with noise</span></span></h2>
<p><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml">Going from a perfect, classical </span><span id="dx1-130001"/><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml">simulation of an algorithm to an execution on an actual quantum device can, sometimes, be too big a step. </span><span class="koboSpan" id="kobo.1429.2" xmlns="http://www.w3.org/1999/xhtml">As we have mentioned in many occasions, current quantum computers suffer from the effect of different types of noise, including readout errors, imperfections in gate implementation, and decoherence, the loss of quantum properties of our states if the circuits are too deep.</span></p>
<p><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml">For this reason, it is usually a good idea to perform a simulation of our algorithm under the effects of noise before going to the actual quantum device. </span><span class="koboSpan" id="kobo.1430.2" xmlns="http://www.w3.org/1999/xhtml">In this way, we can study the </span><span id="dx1-130002"/><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml">performance of our algorithms in a controlled environment, and calibrate and adjust some of their parameters before running them on a quantum computer. </span><span class="koboSpan" id="kobo.1431.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if we observe that the results differ much from ideal simulation, we could decide to reduce the depth of our circuits by using a simpler ansatz.</span></p>
<p><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">There are several ways of conducting noisy simulations with Qiskit. </span><span class="koboSpan" id="kobo.1432.2" xmlns="http://www.w3.org/1999/xhtml">Here, we will show how to use one that is both easy and very useful. </span><span class="koboSpan" id="kobo.1432.3" xmlns="http://www.w3.org/1999/xhtml">We will create a simulator that mimics the behaviour of a real device, including the noise it is affected by. </span><span class="koboSpan" id="kobo.1432.4" xmlns="http://www.w3.org/1999/xhtml">We can do this with the help of the </span><code><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml">AerSimulator</span></code><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml"> class in the following way:</span></p>
<pre class="lstlisting" id="listing-173"><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.providers.aer import AerSimulator 
 
from qiskit import IBMQ 
 
 
 
provider = IBMQ.load_account() 
 
backend = provider.get_backend(’ibmq_manila’) 
 
quantum_instance = QuantumInstance( 
 
    backend = AerSimulator.from_backend(backend), 
 
    seed_simulator=seed, seed_transpiler = seed, shots = 1024)
</span></pre>
<p><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we need to load an IBM account in order to access the calibration of a real device (</span><code><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml">ibmq_manila</span></code><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml">, in our example). </span><span class="koboSpan" id="kobo.1438.2" xmlns="http://www.w3.org/1999/xhtml">This calibration is updated periodically to stay real to the state of the quantum computer and includes, among other things, information about readout errors, gate errors, and coherence times. </span><span class="koboSpan" id="kobo.1438.3" xmlns="http://www.w3.org/1999/xhtml">Of course, this data will change from time to time, but we have decided to include seeds for our </span><code><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml"> object to make the result reproducible given the same calibration data. </span><span class="koboSpan" id="kobo.1440.2" xmlns="http://www.w3.org/1999/xhtml">Notice that we are now specifying the number of shots, because we are not using state vector simulation anymore.</span></p>
<p><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml">Now, we can run the VQE algorithm exactly as before:</span></p>
<pre class="lstlisting" id="listing-174"><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml">

vqe = VQE( 
 
    ansatz=ansatz, 
 
    optimizer=optimizer, 
 
    initial_point=initial_point, 
 
    quantum_instance=quantum_instance 
 
) 
 
 
 
solver = GroundStateEigensolver(qconverter, vqe) 
 
result = solver.solve(problem) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml">When we ran this code, we </span><span id="dx1-130021"/><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml">obtained the following output (your results may be different, depending on the device calibration):</span></p>
<pre class="lstlisting" id="listing-175"><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.763282965888 
 
  - computed part:      -1.763282965888 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.048178626807 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 1.978 S: 0.080 S^2: 0.086 M: 0.001 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  0.04634607] 
 
    - computed part:      [0.0  0.0  0.04634607] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  -0.04634607]  Total: 0.04634607 
 
                 (debye): [0.0  0.0  -0.11779994]  Total: 0.11779994
</span></pre>
<p><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml">Observe how the effect of noise has affected the performance of the algorithm and degraded it, giving a result for the total ground state energy that is not that close to the correct one.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-143">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml">An alternative way of mimicking the behavior of real quantum computers is using objects of the </span><code><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">FakeProvider</span></code><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml"> class. </span><span class="koboSpan" id="kobo.1451.2" xmlns="http://www.w3.org/1999/xhtml">The difference is that they use snapshots of past calibrations of the devices instead of the latest ones. </span><span class="koboSpan" id="kobo.1451.3" xmlns="http://www.w3.org/1999/xhtml">You can find more details at </span><a class="url" href="https://qiskit.org/documentation/apidoc/providers_fake_provider.html"><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml">https://qiskit.org/documentation/apidoc/providers_fake_provider.html</span></a><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml">
Additionally, you can create custom noise models that include the different noise types implemented in the </span><code><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml">qiskit_aer</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span>
<code><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml">noise</span></code><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml"> package. </span><span class="koboSpan" id="kobo.1458.2" xmlns="http://www.w3.org/1999/xhtml">Check the documentation at </span><a class="url" href="https://qiskit.org/documentation/apidoc/aer_noise.html"><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml">https://qiskit.org/documentation/apidoc/aer_noise.html</span></a><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml"> for further explanation.
</span></div>
</div>
<p><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml">A way to try of </span><span id="dx1-130042"/><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml">reducing the adverse effects of noise in our </span><span id="dx1-130043"/><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml">computations is using </span><strong><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml">readout error mitigation</span></strong><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml"> methods. </span><span class="koboSpan" id="kobo.1465.2" xmlns="http://www.w3.org/1999/xhtml">The idea behind the particular method that we are going to use is very simple. </span><span class="koboSpan" id="kobo.1465.3" xmlns="http://www.w3.org/1999/xhtml">Imagine that we know that, when the state of our qubit is </span><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml">, there is a certain percentage of times it in which we obtain the incorrect value </span><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1469.1" xmlns="http://www.w3.org/1999/xhtml"> when we measure it. </span><span class="koboSpan" id="kobo.1469.2" xmlns="http://www.w3.org/1999/xhtml">Then, we can take into account this information to correct the measurement results that we have obtained.</span></p>
<p><span class="koboSpan" id="kobo.1470.1" xmlns="http://www.w3.org/1999/xhtml">In Qiskit, using readout error mitigation is very easy. </span><span class="koboSpan" id="kobo.1470.2" xmlns="http://www.w3.org/1999/xhtml">We only need to create our Quantum Instance object in the following way:</span></p>
<pre class="lstlisting" id="listing-176"><span class="koboSpan" id="kobo.1471.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.utils.mitigation import CompleteMeasFitter 
 
 
 
quantum_instance = QuantumInstance( 
 
    backend = AerSimulator.from_backend(backend), 
 
    measurement_error_mitigation_cls=CompleteMeasFitter, 
 
    seed_simulator=seed, seed_transpiler = seed, shots = 1024)
</span></pre>
<p><span class="koboSpan" id="kobo.1472.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can run VQE as usual, using this new </span><code><span class="koboSpan" id="kobo.1473.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1474.1" xmlns="http://www.w3.org/1999/xhtml"> variable. </span><span class="koboSpan" id="kobo.1474.2" xmlns="http://www.w3.org/1999/xhtml">In our case, that led to the following result (again, yours will likely differ because of the device calibration):</span></p>
<pre class="lstlisting" id="listing-177"><span class="koboSpan" id="kobo.1475.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.827326686753 
 
  - computed part:      -1.827326686753 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.112222347671 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 1.991 S: -0.000 S^2: -0.000 M: -0.006 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  -0.05906852] 
 
    - computed part:      [0.0  0.0  -0.05906852] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  0.05906852]  Total: 0.05906852 
 
                 (debye): [0.0  0.0  0.15013718]  Total: 0.15013718
</span></pre>
<p><span class="koboSpan" id="kobo.1476.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, our </span><span id="dx1-130070"/><span class="koboSpan" id="kobo.1477.1" xmlns="http://www.w3.org/1999/xhtml">current result — compared with our previous simulation with noise and no error mitigation — is now much closer to the real ground state energy (although you have surely noticed that there is still room for improvement).</span></p>
<p><span class="koboSpan" id="kobo.1478.1" xmlns="http://www.w3.org/1999/xhtml">In order to run this kind of error mitigation, we need to know the probability of measuring </span><span class="koboSpan" id="kobo.1479.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1480.1" xmlns="http://www.w3.org/1999/xhtml"> when we actually have </span><span class="koboSpan" id="kobo.1481.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.1482.1" xmlns="http://www.w3.org/1999/xhtml"> for every pair of binary strings </span><span class="koboSpan" id="kobo.1483.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1484.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1485.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1486.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1486.2" xmlns="http://www.w3.org/1999/xhtml">Of course, estimating these values is computationally very expensive, because the number of strings grows exponentially with the number of qubits. </span><span class="koboSpan" id="kobo.1486.3" xmlns="http://www.w3.org/1999/xhtml">Alternatively, we could assume that the readout errors are local and estimate instead the probability of obtaining an incorrect result for each individual qubit only. </span><span class="koboSpan" id="kobo.1486.4" xmlns="http://www.w3.org/1999/xhtml">In Qiskit, you choose to take this approach by replacing </span><code><span class="koboSpan" id="kobo.1487.1" xmlns="http://www.w3.org/1999/xhtml">CompleteMeasFitter</span></code><span class="koboSpan" id="kobo.1488.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><code><span class="koboSpan" id="kobo.1489.1" xmlns="http://www.w3.org/1999/xhtml">TensoredMeasFitter</span></code><span class="koboSpan" id="kobo.1490.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1490.2" xmlns="http://www.w3.org/1999/xhtml">However, at the time of writing, not all backends support this possibility, so you’d better be careful if you decide to use it.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-144">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1491.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1492.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1493.1" xmlns="http://www.w3.org/1999/xhtml">There is much more to say about trying to mitigate the effects of noise in quantum computations. </span><span class="koboSpan" id="kobo.1493.2" xmlns="http://www.w3.org/1999/xhtml">Unfortunately, studying error mitigation further would make this chapter much, much longer (and it is already fairly long!). </span><span class="koboSpan" id="kobo.1493.3" xmlns="http://www.w3.org/1999/xhtml">Should you be interested in this topic, we can recommend that you check the paper by Bravyi et al. </span><span class="cite"><span class="koboSpan" id="kobo.1494.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xbravyi2021mitigating"><span class="koboSpan" id="kobo.1495.1" xmlns="http://www.w3.org/1999/xhtml">21</span></a><span class="koboSpan" id="kobo.1496.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1497.1" xmlns="http://www.w3.org/1999/xhtml"> to learn more about measurement error mitigation and the papers by Temme et al. </span><span class="cite"><span class="koboSpan" id="kobo.1498.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xtemme2017error"><span class="koboSpan" id="kobo.1499.1" xmlns="http://www.w3.org/1999/xhtml">94</span></a><span class="koboSpan" id="kobo.1500.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1501.1" xmlns="http://www.w3.org/1999/xhtml"> and by Endo et al. </span><span class="cite"><span class="koboSpan" id="kobo.1502.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xendo2021hybrid"><span class="koboSpan" id="kobo.1503.1" xmlns="http://www.w3.org/1999/xhtml">35</span></a><span class="koboSpan" id="kobo.1504.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1505.1" xmlns="http://www.w3.org/1999/xhtml"> to learn more about how to mitigate errors in general, including the ones causes by imperfect gate implementation. </span><span class="koboSpan" id="kobo.1505.2" xmlns="http://www.w3.org/1999/xhtml">You may also want to take a look at Mitiq, a very easy-to-use software package for error mitigation that is compatible with Qiskit and other quantum computing libraries </span><span class="cite"><span class="koboSpan" id="kobo.1506.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xlarose2022mitiq"><span class="koboSpan" id="kobo.1507.1" xmlns="http://www.w3.org/1999/xhtml">63</span></a><span class="koboSpan" id="kobo.1508.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1509.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1510.1" xmlns="http://www.w3.org/1999/xhtml">The techniques that we have </span><span id="dx1-130071"/><span class="koboSpan" id="kobo.1511.1" xmlns="http://www.w3.org/1999/xhtml">introduced to simulate noisy devices and to mitigate readout errors are not only applicable to the VQE algorithm. </span><span class="koboSpan" id="kobo.1511.2" xmlns="http://www.w3.org/1999/xhtml">In fact, noisy simulation can be used when running any circuit, because we can just use a </span><code><span class="koboSpan" id="kobo.1512.1" xmlns="http://www.w3.org/1999/xhtml">backend</span></code><span class="koboSpan" id="kobo.1513.1" xmlns="http://www.w3.org/1999/xhtml"> object created with the </span><code><span class="koboSpan" id="kobo.1514.1" xmlns="http://www.w3.org/1999/xhtml">AerSimulator</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1515.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1516.1" xmlns="http://www.w3.org/1999/xhtml">from_backend</span></code><span class="koboSpan" id="kobo.1517.1" xmlns="http://www.w3.org/1999/xhtml"> function and a real quantum computer.</span></p>
<p><span class="koboSpan" id="kobo.1518.1" xmlns="http://www.w3.org/1999/xhtml">Moreover, readout error mitigation can be used with any algorithm that uses an object of the class </span><code><span class="koboSpan" id="kobo.1519.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1520.1" xmlns="http://www.w3.org/1999/xhtml"> to run circuits. </span><span class="koboSpan" id="kobo.1520.2" xmlns="http://www.w3.org/1999/xhtml">This includes QAOA and GAS, which we studied in </span><em><span class="koboSpan" id="kobo.1521.1" xmlns="http://www.w3.org/1999/xhtml">Chapters</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1522.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1523.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><em/> <a href="ch014.xhtml#x1-1060006"><em><span class="koboSpan" id="kobo.1524.1" xmlns="http://www.w3.org/1999/xhtml">6</span></em></a><span class="koboSpan" id="kobo.1525.1" xmlns="http://www.w3.org/1999/xhtml">, respectively, as well as the QSVMs, the QNNs and the QGANs that we will study in </span><em><span class="koboSpan" id="kobo.1526.1" xmlns="http://www.w3.org/1999/xhtml">Chapters</span></em> <em/> <a href="ch018.xhtml#x1-1600009"><em><span class="koboSpan" id="kobo.1527.1" xmlns="http://www.w3.org/1999/xhtml">9</span></em></a><span class="koboSpan" id="kobo.1528.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em/> <a href="ch019.xhtml#x1-18100010"><em><span class="koboSpan" id="kobo.1529.1" xmlns="http://www.w3.org/1999/xhtml">10</span></em></a><span class="koboSpan" id="kobo.1530.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em/> <a href="ch020.xhtml#x1-19500011"><em><span class="koboSpan" id="kobo.1531.1" xmlns="http://www.w3.org/1999/xhtml">11</span></em></a><span class="koboSpan" id="kobo.1532.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><em/> <a href="ch021.xhtml#x1-21200012"><em><span class="koboSpan" id="kobo.1533.1" xmlns="http://www.w3.org/1999/xhtml">12</span></em></a><span class="koboSpan" id="kobo.1534.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1535.1" xmlns="http://www.w3.org/1999/xhtml">But the possibilities don’t end there. </span><span class="koboSpan" id="kobo.1535.2" xmlns="http://www.w3.org/1999/xhtml">In fact, every </span><code><span class="koboSpan" id="kobo.1536.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1537.1" xmlns="http://www.w3.org/1999/xhtml"> object provides an </span><code><span class="koboSpan" id="kobo.1538.1" xmlns="http://www.w3.org/1999/xhtml">execute</span></code><span class="koboSpan" id="kobo.1539.1" xmlns="http://www.w3.org/1999/xhtml"> method that receives quantum circuits and executes them. </span><span class="koboSpan" id="kobo.1539.2" xmlns="http://www.w3.org/1999/xhtml">So, you can create a </span><code><span class="koboSpan" id="kobo.1540.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1541.1" xmlns="http://www.w3.org/1999/xhtml"> with a noisy backend and the </span><code><span class="koboSpan" id="kobo.1542.1" xmlns="http://www.w3.org/1999/xhtml">measurement_error_mitigation_cls</span></code><span class="koboSpan" id="kobo.1543.1" xmlns="http://www.w3.org/1999/xhtml"> argument, and then invoke </span><code><span class="koboSpan" id="kobo.1544.1" xmlns="http://www.w3.org/1999/xhtml">execute</span></code><span class="koboSpan" id="kobo.1545.1" xmlns="http://www.w3.org/1999/xhtml"> to obtain results with error mitigation.</span></p>
<div class="tcolorbox questionx" id="tcolobox-145">
<span id="x1-130073x7.3.5"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1546.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.9</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1547.1" xmlns="http://www.w3.org/1999/xhtml">Create a noisy backend from a real quantum computer. </span><span class="koboSpan" id="kobo.1547.2" xmlns="http://www.w3.org/1999/xhtml">Then, use it to run a simple two-qubit circuit consisting of a Hadamard gate on the first qubit, a CNOT gate with control on the first qubit and target in the second, and a final measurement of both qubits. </span><span class="koboSpan" id="kobo.1547.3" xmlns="http://www.w3.org/1999/xhtml">Compare the results to those of ideal simulation. </span><span class="koboSpan" id="kobo.1547.4" xmlns="http://www.w3.org/1999/xhtml">Then, create a </span><code><span class="koboSpan" id="kobo.1548.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1549.1" xmlns="http://www.w3.org/1999/xhtml"> from your backend and using readout error mitigation. </span><span class="koboSpan" id="kobo.1549.2" xmlns="http://www.w3.org/1999/xhtml">Run the circuit with it. </span><span class="koboSpan" id="kobo.1549.3" xmlns="http://www.w3.org/1999/xhtml">Compare the results to what you obtained before.</span></p>
</div>
</div>
<div class="tcolorbox questionx" id="tcolobox-146">
<span id="x1-130075x7.3.5"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1550.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 7.10</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1551.1" xmlns="http://www.w3.org/1999/xhtml">Run QAOA with a simple Hamiltonian on a noisy simulator with and without readout error mitigation. </span><span class="koboSpan" id="kobo.1551.2" xmlns="http://www.w3.org/1999/xhtml">Compare the results.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1552.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know how to run </span><span id="dx1-130076"/><span class="koboSpan" id="kobo.1553.1" xmlns="http://www.w3.org/1999/xhtml">simulations with noise, we are ready for the next big step: let’s run VQE on actual quantum devices.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.6" id="running-vqe-on-quantum-computers">
<h2 class="subsectionHead" data-number="14.3.6"><span class="titlemark"><span class="koboSpan" id="kobo.1554.1" xmlns="http://www.w3.org/1999/xhtml">7.3.6 </span></span> <span id="x1-1310007.3.6"><span class="koboSpan" id="kobo.1555.1" xmlns="http://www.w3.org/1999/xhtml">Running VQE on quantum computers</span></span></h2>
<p><span class="koboSpan" id="kobo.1556.1" xmlns="http://www.w3.org/1999/xhtml">By now, you surely have </span><span id="dx1-131001"/><span class="koboSpan" id="kobo.1557.1" xmlns="http://www.w3.org/1999/xhtml">guessed what we are going to say about running VQE on quantum devices. </span><span class="koboSpan" id="kobo.1557.2" xmlns="http://www.w3.org/1999/xhtml">If you were thinking that we could just use a real backend when creating our </span><code><span class="koboSpan" id="kobo.1558.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1559.1" xmlns="http://www.w3.org/1999/xhtml"> object, but that it would involve waiting multiple queues and that there must be a better way, you were completely spot on. </span><span class="koboSpan" id="kobo.1559.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we can use Runtime to send our VQE jobs to IBM’s quantum computers, waiting only in one execution queue. </span><span class="koboSpan" id="kobo.1559.3" xmlns="http://www.w3.org/1999/xhtml">The way in which we can use VQE with Runtime is very similar to what we showed in </span><em><span class="koboSpan" id="kobo.1560.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch013.xhtml#x1-1020005.2.1"><em><span class="koboSpan" id="kobo.1561.1" xmlns="http://www.w3.org/1999/xhtml">5.2.1</span></em></a><span class="koboSpan" id="kobo.1562.1" xmlns="http://www.w3.org/1999/xhtml"> for QAOA. </span><span class="koboSpan" id="kobo.1562.2" xmlns="http://www.w3.org/1999/xhtml">We can use the </span><code><span class="koboSpan" id="kobo.1563.1" xmlns="http://www.w3.org/1999/xhtml">VQEClient</span></code><span class="koboSpan" id="kobo.1564.1" xmlns="http://www.w3.org/1999/xhtml"> as follows:</span></p>
<pre class="lstlisting" id="listing-178"><span class="koboSpan" id="kobo.1565.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.runtime import VQEClient 
 
backend = provider.get_backend(’ibmq_manila’) 
 
 
 
vqe = VQEClient( 
 
    ansatz=ansatz, 
 
    provider=provider, 
 
    backend=backend, 
 
    shots=1024, 
 
    initial_point = initial_point, 
 
    measurement_error_mitigation=False 
 
) 
 
 
 
solver = GroundStateEigensolver(qconverter, vqe) 
 
result = solver.solve(problem) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1566.1" xmlns="http://www.w3.org/1999/xhtml">This is completely analogous to how we run VQE on local simulators, but now we are sending the task to the real </span><span id="dx1-131017"/><span class="koboSpan" id="kobo.1567.1" xmlns="http://www.w3.org/1999/xhtml">quantum device called </span><code><span class="koboSpan" id="kobo.1568.1" xmlns="http://www.w3.org/1999/xhtml">ibmq_manila</span></code><span class="koboSpan" id="kobo.1569.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1569.2" xmlns="http://www.w3.org/1999/xhtml">Notice that we have specified the number of shots and that we have opted to use the default optimizer since we haven’t provided a value for the optimizer argument. </span><span class="koboSpan" id="kobo.1569.3" xmlns="http://www.w3.org/1999/xhtml">The default optimizer for this algorithm is SPSA.</span></p>
<p><span class="koboSpan" id="kobo.1570.1" xmlns="http://www.w3.org/1999/xhtml">The results that we obtained (after waiting some time in the queue) were the following:</span></p>
<pre class="lstlisting" id="listing-179"><span class="koboSpan" id="kobo.1571.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.745062049527 
 
  - computed part:      -1.745062049527 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.029957710446 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 1.988 S: 0.131 S^2: 0.149 M: -0.005 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  0.01726618] 
 
    - computed part:      [0.0  0.0  0.01726618] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  -0.01726618]  Total: 0.01726618 
 
                 (debye): [0.0  0.0  -0.04388625]  Total: 0.04388625
</span></pre>
<p><span class="koboSpan" id="kobo.1572.1" xmlns="http://www.w3.org/1999/xhtml">We can </span><span id="dx1-131038"/><span class="koboSpan" id="kobo.1573.1" xmlns="http://www.w3.org/1999/xhtml">observe again the effect of noise in this execution. </span><span class="koboSpan" id="kobo.1573.2" xmlns="http://www.w3.org/1999/xhtml">Of course, we can try to reduce it by setting </span><code><span class="koboSpan" id="kobo.1574.1" xmlns="http://www.w3.org/1999/xhtml">measurement_error_mitigation</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1575.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><code><span class="koboSpan" id="kobo.1576.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.1577.1" xmlns="http://www.w3.org/1999/xhtml"> and running the same code again. </span><span class="koboSpan" id="kobo.1577.2" xmlns="http://www.w3.org/1999/xhtml">When we did that, we obtained the following output:</span></p>
<pre class="lstlisting" id="listing-180"><span class="koboSpan" id="kobo.1578.1" xmlns="http://www.w3.org/1999/xhtml">

=== GROUND STATE ENERGY === 
 
 
 
* Electronic ground state energy (Hartree): -1.830922842008 
 
  - computed part:      -1.830922842008 
 
~ Nuclear repulsion energy (Hartree): 0.715104339081 
 
&gt; Total ground state energy (Hartree): -1.115818502927 
 
 
 
=== MEASURED OBSERVABLES === 
 
 
 
  0:  # Particles: 2.020 S: 0.035 S^2: 0.036 M: 0.010 
 
 
 
=== DIPOLE MOMENTS === 
 
 
 
~ Nuclear dipole moment (a.u.): [0.0  0.0  0.0] 
 
 
 
  0: 
 
  * Electronic dipole moment (a.u.): [0.0  0.0  -0.00999621] 
 
    - computed part:      [0.0  0.0  -0.00999621] 
 
  &gt; Dipole moment (a.u.): [0.0  0.0  0.00999621]  Total: 0.00999621 
 
                 (debye): [0.0  0.0  0.02540783]  Total: 0.02540783
</span></pre>
<p><span class="koboSpan" id="kobo.1579.1" xmlns="http://www.w3.org/1999/xhtml">That is a little bit better, right?</span></p>
<p><span class="koboSpan" id="kobo.1580.1" xmlns="http://www.w3.org/1999/xhtml">With this, we have covered </span><span id="dx1-131059"/><span class="koboSpan" id="kobo.1581.1" xmlns="http://www.w3.org/1999/xhtml">everything we wanted to tell you about how to run VQE with Qiskit…or almost everything. </span><span class="koboSpan" id="kobo.1581.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will show you some new features that are being added to Qiskit and that can change the way in which algorithms such as VQE are used.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.3.7" id="the-shape-of-things-to-come-the-future-of-qiskit">
<h2 class="subsectionHead" data-number="14.3.7"><span class="titlemark"><span class="koboSpan" id="kobo.1582.1" xmlns="http://www.w3.org/1999/xhtml">7.3.7 </span></span> <span id="x1-1320007.3.7"><span class="koboSpan" id="kobo.1583.1" xmlns="http://www.w3.org/1999/xhtml">The shape of things to come: the future of Qiskit</span></span></h2>
<p><span class="koboSpan" id="kobo.1584.1" xmlns="http://www.w3.org/1999/xhtml">Quantum computing software libraries are in constant evolution and </span><span id="dx1-132001"/><span class="koboSpan" id="kobo.1585.1" xmlns="http://www.w3.org/1999/xhtml">Qiskit is no exception to this rule. </span><span class="koboSpan" id="kobo.1585.2" xmlns="http://www.w3.org/1999/xhtml">Although everything that we have studied in this section is the main way of running VQE with the latest version of Qiskit (which is 0.39.2 at the time of writing this book), a new way of executing the algorithm is also being introduced and it will likely become the default one in the not-so-distant future.</span></p>
<p><span class="koboSpan" id="kobo.1586.1" xmlns="http://www.w3.org/1999/xhtml">This new way of doing things involves some modifications, the most important of which is replacing the use of </span><code><span class="koboSpan" id="kobo.1587.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1588.1" xmlns="http://www.w3.org/1999/xhtml"> objects with </span><code><span class="koboSpan" id="kobo.1589.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1590.1" xmlns="http://www.w3.org/1999/xhtml"> variables. </span><span class="koboSpan" id="kobo.1590.2" xmlns="http://www.w3.org/1999/xhtml">An </span><code><span class="koboSpan" id="kobo.1591.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1592.1" xmlns="http://www.w3.org/1999/xhtml"> is an object that is capable running a parametrized circuit to obtain a quantum state and then estimate (who would have guessed?) the expectation value of some observable on that state. </span><span class="koboSpan" id="kobo.1592.2" xmlns="http://www.w3.org/1999/xhtml">Of course, this is exactly what we need in order to be able to run VQE, as you surely remember from </span><em><span class="koboSpan" id="kobo.1593.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-1230007.2"><em><span class="koboSpan" id="kobo.1594.1" xmlns="http://www.w3.org/1999/xhtml">7.2</span></em></a><span class="koboSpan" id="kobo.1595.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1596.1" xmlns="http://www.w3.org/1999/xhtml">Let’s see an example of how this would work. </span><span class="koboSpan" id="kobo.1596.2" xmlns="http://www.w3.org/1999/xhtml">The following code is a possible way of running VQE to solve the same molecular problem that we have been considering throughout this section with the new implementations that are being introduced in Qiskit:</span></p>
<pre class="lstlisting" id="listing-181"><span class="koboSpan" id="kobo.1597.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.algorithms.minimum_eigensolvers import VQE 
 
from qiskit.primitives import Estimator 
 
 
 
estimator= Estimator() 
 
 
 
vqe = VQE( 
 
    ansatz=ansatz, 
 
    optimizer=optimizer, 
 
    initial_point=initial_point, 
 
    estimator=estimator 
 
) 
 
 
 
result = vqe.compute_minimum_eigenvalue(qhamiltonian) 
 
 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1598.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we are importing </span><code><span class="koboSpan" id="kobo.1599.1" xmlns="http://www.w3.org/1999/xhtml">VQE</span></code><span class="koboSpan" id="kobo.1600.1" xmlns="http://www.w3.org/1999/xhtml"> from </span><code><span class="koboSpan" id="kobo.1601.1" xmlns="http://www.w3.org/1999/xhtml">qiskit</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1602.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1603.1" xmlns="http://www.w3.org/1999/xhtml">algorithms</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1604.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1605.1" xmlns="http://www.w3.org/1999/xhtml">minimum_eigensolvers</span></code><span class="koboSpan" id="kobo.1606.1" xmlns="http://www.w3.org/1999/xhtml">, not from </span><code><span class="koboSpan" id="kobo.1607.1" xmlns="http://www.w3.org/1999/xhtml">qiskit</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1608.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1609.1" xmlns="http://www.w3.org/1999/xhtml">algorithms</span></code><span class="koboSpan" id="kobo.1610.1" xmlns="http://www.w3.org/1999/xhtml"> as before. </span><span class="koboSpan" id="kobo.1610.2" xmlns="http://www.w3.org/1999/xhtml">Also notice how the </span><code><span class="koboSpan" id="kobo.1611.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1612.1" xmlns="http://www.w3.org/1999/xhtml"> object has replaced the </span><code><span class="koboSpan" id="kobo.1613.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1614.1" xmlns="http://www.w3.org/1999/xhtml"> one that we used to use.</span></p>
<p><span class="koboSpan" id="kobo.1615.1" xmlns="http://www.w3.org/1999/xhtml">Running these </span><span id="dx1-132017"/><span class="koboSpan" id="kobo.1616.1" xmlns="http://www.w3.org/1999/xhtml">instructions will give an output like the following one (shortened here for brevity):</span></p>
<p><span class="koboSpan" id="kobo.1617.1" xmlns="http://www.w3.org/1999/xhtml">@empty</span></p>
<pre class="lstlisting" id="listing-182"><span class="koboSpan" id="kobo.1618.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operators_evaluated’: None, 
 
    ’cost_function_evals’: 1000, 
 
    ’eigenvalue’: -1.8523881060316512, 
 
    ’optimal_circuit’: 
 
    &lt;qiskit.circuit.library.n_local.efficient_su2.EfficientSU2 
 
    object at 0x7f92367aac90&gt;, 
 
    ’optimal_parameters’: { 
 
        ParameterVectorElement(@$\theta$@[10]): -5.6469331359894016e-05, 
 
        ParameterVectorElement(@$\theta$@[7]): -0.07317113283182797, 
 
        ... 
 
        </span><span class="koboSpan" id="kobo.1618.2" xmlns="http://www.w3.org/1999/xhtml">ParameterVectorElement(@$\theta$@[15]): 2.5406547025358206}, 
 
    ’optimal_point’: array( 
 
        [-2.25566150e-01, -3.48673819e-05, 3.14159358e+00,  3.13967948e+00, 
 
        1.74766932e+00,  2.19381131e+00, -1.17362733e-01, -7.31711328e-02, 
 
        3.14163959e+00, -5.24406909e-05, -5.64693314e-05, -1.86976530e-03, 
 
        1.95315840e+00,  6.62795965e-01, -1.43666055e-01,  2.54065470e+00]), 
 
    ’optimal_value’: -1.8523881060316512, 
 
    ’optimizer_evals’: None, 
 
    ’optimizer_result’: 
 
    &lt;qiskit.algorithms.optimizers.optimizer.OptimizerResult 
 
    object at 0x7f9240af82d0&gt;, 
 
    ’optimizer_time’: 6.93215799331665}
</span></pre>
<p><span class="koboSpan" id="kobo.1619.1" xmlns="http://www.w3.org/1999/xhtml">This should sound familiar because it is the same kind of result that we obtained when using the current VQE implementation directly on a Hamiltonian.</span></p>
<p><span class="koboSpan" id="kobo.1620.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, things are not </span><span id="dx1-132040"/><span class="koboSpan" id="kobo.1621.1" xmlns="http://www.w3.org/1999/xhtml">going to change a lot in this new version. </span><span class="koboSpan" id="kobo.1621.2" xmlns="http://www.w3.org/1999/xhtml">The main novelty is the use of </span><code><span class="koboSpan" id="kobo.1622.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1623.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.1623.2" xmlns="http://www.w3.org/1999/xhtml">So, how do they work? </span><span class="koboSpan" id="kobo.1623.3" xmlns="http://www.w3.org/1999/xhtml">Well, it depends. </span><span class="koboSpan" id="kobo.1623.4" xmlns="http://www.w3.org/1999/xhtml">For instance, the one that we have imported from </span><code><span class="koboSpan" id="kobo.1624.1" xmlns="http://www.w3.org/1999/xhtml">qiskit</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1625.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1626.1" xmlns="http://www.w3.org/1999/xhtml">primitives</span></code><span class="koboSpan" id="kobo.1627.1" xmlns="http://www.w3.org/1999/xhtml"> uses a state vector simulator to obtain a quantum state from a circuit. </span><span class="koboSpan" id="kobo.1627.2" xmlns="http://www.w3.org/1999/xhtml">Then, it computes its expectation value by calling the </span><code><span class="koboSpan" id="kobo.1628.1" xmlns="http://www.w3.org/1999/xhtml">expectation_value</span></code><span class="koboSpan" id="kobo.1629.1" xmlns="http://www.w3.org/1999/xhtml"> method, as we did back in </span><em><span class="koboSpan" id="kobo.1630.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-660003.2.2"><em><span class="koboSpan" id="kobo.1631.1" xmlns="http://www.w3.org/1999/xhtml">3.2.2</span></em></a><span class="koboSpan" id="kobo.1632.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1632.2" xmlns="http://www.w3.org/1999/xhtml">However, the </span><code><span class="koboSpan" id="kobo.1633.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1634.1" xmlns="http://www.w3.org/1999/xhtml"> class implemented in </span><code><span class="koboSpan" id="kobo.1635.1" xmlns="http://www.w3.org/1999/xhtml">qiskit_aer</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1636.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1637.1" xmlns="http://www.w3.org/1999/xhtml">primitives</span></code><span class="koboSpan" id="kobo.1638.1" xmlns="http://www.w3.org/1999/xhtml"> uses the method that we explained in </span><em><span class="koboSpan" id="kobo.1639.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-1220007.1.2"><em><span class="koboSpan" id="kobo.1640.1" xmlns="http://www.w3.org/1999/xhtml">7.1.2</span></em></a><span class="koboSpan" id="kobo.1641.1" xmlns="http://www.w3.org/1999/xhtml"> by appending additional gates to the parametrized circuit in order to perform measurements in different bases.</span></p>
<p><span class="koboSpan" id="kobo.1642.1" xmlns="http://www.w3.org/1999/xhtml">Unfortunately, at the time of writing this book, some of the features that we have covered in this section, such as noisy simulation and error mitigation, are still not completely supported by the new version of the algorithms. </span><span class="koboSpan" id="kobo.1642.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, some of the </span><code><span class="koboSpan" id="kobo.1643.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1644.1" xmlns="http://www.w3.org/1999/xhtml"> classes are not fully compatible with the new VQE implementation yet.</span></p>
<p><span class="koboSpan" id="kobo.1645.1" xmlns="http://www.w3.org/1999/xhtml">However, Qiskit changes rapidly, so maybe, in the future, you can fully reproduce our code with </span><code><span class="koboSpan" id="kobo.1646.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1647.1" xmlns="http://www.w3.org/1999/xhtml"> objects instead of </span><code><span class="koboSpan" id="kobo.1648.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1649.1" xmlns="http://www.w3.org/1999/xhtml"> ones by the time you will be reading these lines. </span><span class="koboSpan" id="kobo.1649.2" xmlns="http://www.w3.org/1999/xhtml">Time will tell!</span></p>
<div class="tcolorbox important" id="tcolobox-147">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1650.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1651.1" xmlns="http://www.w3.org/1999/xhtml">The changes that we have described in this subsection are expected to also affect other algorithms implemented in Qiskit, such as VQD or QAOA. </span><span class="koboSpan" id="kobo.1651.2" xmlns="http://www.w3.org/1999/xhtml">In the case of QAOA, instead of </span><code><span class="koboSpan" id="kobo.1652.1" xmlns="http://www.w3.org/1999/xhtml">Estimator</span></code><span class="koboSpan" id="kobo.1653.1" xmlns="http://www.w3.org/1999/xhtml"> objects, you will need to use </span><code><span class="koboSpan" id="kobo.1654.1" xmlns="http://www.w3.org/1999/xhtml">Sampler</span></code><span class="koboSpan" id="kobo.1655.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.1655.2" xmlns="http://www.w3.org/1999/xhtml">As you can imagine, they will let you obtain samples from parametrized circuits, which can later be used by QAOA to estimate the value of the cost function.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1656.1" xmlns="http://www.w3.org/1999/xhtml">And now, we promise, this is really all we </span><span id="dx1-132041"/><span class="koboSpan" id="kobo.1657.1" xmlns="http://www.w3.org/1999/xhtml">wanted to tell you about running VQE with Qiskit. </span><span class="koboSpan" id="kobo.1657.2" xmlns="http://www.w3.org/1999/xhtml">Our next stop is PennyLane.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="14.4" id="using-vqe-with-pennylane">
<h1 class="sectionHead" data-number="14.4"><span class="titlemark"><span class="koboSpan" id="kobo.1658.1" xmlns="http://www.w3.org/1999/xhtml">7.4 </span></span> <span id="x1-1330007.4"><span class="koboSpan" id="kobo.1659.1" xmlns="http://www.w3.org/1999/xhtml">Using VQE with PennyLane</span></span></h1>
<p><span class="koboSpan" id="kobo.1660.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we will </span><span id="dx1-133001"/><span class="koboSpan" id="kobo.1661.1" xmlns="http://www.w3.org/1999/xhtml">illustrate how to run VQE with PennyLane. </span><span class="koboSpan" id="kobo.1661.2" xmlns="http://www.w3.org/1999/xhtml">The problem that we will work with will be, again, finding the ground state of the dihydrogen molecule. </span><span class="koboSpan" id="kobo.1661.3" xmlns="http://www.w3.org/1999/xhtml">This is a task we are already familiar with and, moreover, this will allow us to compare our results with those that we obtained with Qiskit in the previous section. </span><span class="koboSpan" id="kobo.1661.4" xmlns="http://www.w3.org/1999/xhtml">So, without further ado, let’s start by showing how to define the problem in PennyLane.</span></p>
<section class="level3 subsectionHead" data-number="14.4.1" id="defining-a-molecular-problem-in-pennylane">
<h2 class="subsectionHead" data-number="14.4.1"><span class="titlemark"><span class="koboSpan" id="kobo.1662.1" xmlns="http://www.w3.org/1999/xhtml">7.4.1 </span></span> <span id="x1-1340007.4.1"><span class="koboSpan" id="kobo.1663.1" xmlns="http://www.w3.org/1999/xhtml">Defining a molecular problem in PennyLane</span></span></h2>
<p><span class="koboSpan" id="kobo.1664.1" xmlns="http://www.w3.org/1999/xhtml">As with Qiskit, PennyLane </span><span id="dx1-134001"/><span class="koboSpan" id="kobo.1665.1" xmlns="http://www.w3.org/1999/xhtml">provides methods to work with quantum chemistry problems. </span><span class="koboSpan" id="kobo.1665.2" xmlns="http://www.w3.org/1999/xhtml">To study the </span><span class="koboSpan" id="kobo.1666.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{2}" class="math inline" src="../media/file1082.png" style="vertical-align:middle" title="H_{2}"/></span><span class="koboSpan" id="kobo.1667.1" xmlns="http://www.w3.org/1999/xhtml"> molecule, we can use the following instructions:</span></p>
<p><span id="x1-134002"/></p>
<pre class="lstlisting" id="listing-183"><span class="koboSpan" id="kobo.1668.1" xmlns="http://www.w3.org/1999/xhtml">

import pennylane as qml 
 
from pennylane import numpy as np 
 
 
 
seed = 1234 
 
np.random.seed(seed) 
 
 
 
symbols = ["H", "H"] 
 
coordinates = np.array([0.0, 0.0, -0.6991986158, 0.0, 0.0, 0.6991986158]) 
 
 
 
H, qubits = qml.qchem.molecular_hamiltonian(symbols, coordinates) 
 
print("Qubit Hamiltonian: ") 
 
print(H)
</span></pre>
<p><span class="koboSpan" id="kobo.1669.1" xmlns="http://www.w3.org/1999/xhtml">You may be thinking that there is something fishy here. </span><span class="koboSpan" id="kobo.1669.2" xmlns="http://www.w3.org/1999/xhtml">When we defined this same molecule in Qiskit, we used coordinates </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1670.1" xmlns="http://www.w3.org/1999/xhtml">[0.,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1671.1" xmlns="http://www.w3.org/1999/xhtml">0.,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1672.1" xmlns="http://www.w3.org/1999/xhtml">-0.37],[0.,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1673.1" xmlns="http://www.w3.org/1999/xhtml">0.,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1674.1" xmlns="http://www.w3.org/1999/xhtml">0.37]</span></code></span></span><span class="koboSpan" id="kobo.1675.1" xmlns="http://www.w3.org/1999/xhtml">, which seem different from the ones that we are using now. </span><span class="koboSpan" id="kobo.1675.2" xmlns="http://www.w3.org/1999/xhtml">The explanation for this change is that, while Qiskit uses angstroms to measure atomic distances, PennyLane expects the values to be in atomic units. </span><span class="koboSpan" id="kobo.1675.3" xmlns="http://www.w3.org/1999/xhtml">An angstrom is worth </span><span class="koboSpan" id="kobo.1676.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1.8897259886" class="math inline" src="../media/file1094.png" style="vertical-align:middle" title="1.8897259886"/></span><span class="koboSpan" id="kobo.1677.1" xmlns="http://www.w3.org/1999/xhtml"> atomic units, hence the difference.</span></p>
<p><span class="koboSpan" id="kobo.1678.1" xmlns="http://www.w3.org/1999/xhtml">We can now obtain the qubit </span><span id="dx1-134015"/><span class="koboSpan" id="kobo.1679.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian that we need to use with VQE by running the following piece of code:</span></p>
<pre class="lstlisting" id="listing-184"><span class="koboSpan" id="kobo.1680.1" xmlns="http://www.w3.org/1999/xhtml">

H, qubits = qml.qchem.molecular_hamiltonian(symbols, coordinates) 
 
print("Qubit Hamiltonian: ") 
 
print(H)
</span></pre>
<p><span class="koboSpan" id="kobo.1681.1" xmlns="http://www.w3.org/1999/xhtml">The output that we obtain is the following:</span></p>
<pre class="lstlisting" id="listing-185"><span class="koboSpan" id="kobo.1682.1" xmlns="http://www.w3.org/1999/xhtml">

Qubit Hamiltonian: 
 
  (-0.22343155727095726) [Z2] 
 
+ (-0.22343155727095726) [Z3] 
 
+ (-0.09706620778626623) [I0] 
 
+ (0.17141283498167342) [Z1] 
 
+ (0.1714128349816736) [Z0] 
 
+ (0.12062523781179485) [Z0 Z2] 
 
+ (0.12062523781179485) [Z1 Z3] 
 
+ (0.16592785242008765) [Z0 Z3] 
 
+ (0.16592785242008765) [Z1 Z2] 
 
+ (0.16868898461469894) [Z0 Z1] 
 
+ (0.17441287780052514) [Z2 Z3] 
 
+ (-0.04530261460829278) [Y0 Y1 X2 X3] 
 
+ (-0.04530261460829278) [X0 X1 Y2 Y3] 
 
+ (0.04530261460829278) [Y0 X1 X2 Y3] 
 
+ (0.04530261460829278) [X0 Y1 Y2 X3]
</span></pre>
<p><span class="koboSpan" id="kobo.1683.1" xmlns="http://www.w3.org/1999/xhtml">If you compare this Hamiltonian to the one that we obtained with Qiskit for the same problem you will notice that they are very different. </span><span class="koboSpan" id="kobo.1683.2" xmlns="http://www.w3.org/1999/xhtml">But don’t panic yet. </span><span class="koboSpan" id="kobo.1683.3" xmlns="http://www.w3.org/1999/xhtml">While Qiskit gave us the Hamiltonian for the </span><span id="dx1-134035"/><span class="koboSpan" id="kobo.1684.1" xmlns="http://www.w3.org/1999/xhtml">electronic structure of the molecule, PennyLane is accounting for the total energy, including nuclear repulsion. </span><span class="koboSpan" id="kobo.1684.2" xmlns="http://www.w3.org/1999/xhtml">We will run the algorithm in a moment and, trust us, we will see how everything adds up.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.4.2" id="implementing-and-running-vqe">
<h2 class="subsectionHead" data-number="14.4.2"><span class="titlemark"><span class="koboSpan" id="kobo.1685.1" xmlns="http://www.w3.org/1999/xhtml">7.4.2 </span></span> <span id="x1-1350007.4.2"><span class="koboSpan" id="kobo.1686.1" xmlns="http://www.w3.org/1999/xhtml">Implementing and running VQE</span></span></h2>
<p><span class="koboSpan" id="kobo.1687.1" xmlns="http://www.w3.org/1999/xhtml">Before using VQE, we need to </span><span id="dx1-135001"/><span class="koboSpan" id="kobo.1688.1" xmlns="http://www.w3.org/1999/xhtml">decide what variational form we are going to use as the ansatz. </span><span class="koboSpan" id="kobo.1688.2" xmlns="http://www.w3.org/1999/xhtml">To keep things simple, we will stick with the </span><code><span class="koboSpan" id="kobo.1689.1" xmlns="http://www.w3.org/1999/xhtml">EfficientSU2</span></code><span class="koboSpan" id="kobo.1690.1" xmlns="http://www.w3.org/1999/xhtml"> that we used in the previous section.</span></p>
<p><span class="koboSpan" id="kobo.1691.1" xmlns="http://www.w3.org/1999/xhtml">This variational form is not included in PennyLane at the time of writing this book, but we can easily implement it with the following code:</span></p>
<pre class="lstlisting" id="listing-186"><span class="koboSpan" id="kobo.1692.1" xmlns="http://www.w3.org/1999/xhtml">

nqubits = 4 
 
def EfficientSU2(theta): 
 
    for i in range(nqubits): 
 
        qml.RY(theta[i], wires = i) 
 
        qml.RZ(theta[i+nqubits], wires = i) 
 
    for i in range(nqubits-1): 
 
        qml.CNOT(wires = [i, i + 1]) 
 
    for i in range(nqubits): 
 
        qml.RY(theta[i+2*nqubits], wires = i) 
 
        qml.RZ(theta[i+3*nqubits], wires = i)
</span></pre>
<p><span class="koboSpan" id="kobo.1693.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we have fixed the number of repetitions to </span><span class="koboSpan" id="kobo.1694.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1695.1" xmlns="http://www.w3.org/1999/xhtml">, which was the case that we were using with Qiskit in the previous section.</span></p>
<p><span class="koboSpan" id="kobo.1696.1" xmlns="http://www.w3.org/1999/xhtml">Now that we </span><span id="dx1-135012"/><span class="koboSpan" id="kobo.1697.1" xmlns="http://www.w3.org/1999/xhtml">have our variational form, we can use it to implement the VQE algorithm in PennyLane. </span><span class="koboSpan" id="kobo.1697.2" xmlns="http://www.w3.org/1999/xhtml">To do that, we will define the energy function, which we compile as a quantum node because it needs to be evaluated on a device capable of running quantum circuits. </span><span class="koboSpan" id="kobo.1697.3" xmlns="http://www.w3.org/1999/xhtml">We can do that with the following instructions:</span></p>
<pre class="lstlisting" id="listing-187"><span class="koboSpan" id="kobo.1698.1" xmlns="http://www.w3.org/1999/xhtml">

dev = qml.device("lightning.qubit", wires=qubits) 
 
@qml.qnode(dev) 
 
def energy(param): 
 
    EfficientSU2(param) 
 
    return qml.expval(H)
</span></pre>
<p><span class="koboSpan" id="kobo.1699.1" xmlns="http://www.w3.org/1999/xhtml">Notice how we have used the </span><code><span class="koboSpan" id="kobo.1700.1" xmlns="http://www.w3.org/1999/xhtml">EfficientSU2</span></code><span class="koboSpan" id="kobo.1701.1" xmlns="http://www.w3.org/1999/xhtml"> ansatz followed by an evaluation of the expectation value of our Hamiltonian (by using the </span><code><span class="koboSpan" id="kobo.1702.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1703.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1704.1" xmlns="http://www.w3.org/1999/xhtml">expval</span></code><span class="koboSpan" id="kobo.1705.1" xmlns="http://www.w3.org/1999/xhtml"> function that we introduced in </span><em><span class="koboSpan" id="kobo.1706.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1707.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1708.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1709.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate</span></em> <em><span class="koboSpan" id="kobo.1710.1" xmlns="http://www.w3.org/1999/xhtml">Optimization Algorithm</span></em><span class="koboSpan" id="kobo.1711.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1711.2" xmlns="http://www.w3.org/1999/xhtml">Now, to execute VQE, we only need to select some initial values for the ansatz parameters and use a minimizer to find their optimal values. </span><span class="koboSpan" id="kobo.1711.3" xmlns="http://www.w3.org/1999/xhtml">We can achieve that with the following piece of code:</span></p>
<pre class="lstlisting" id="listing-188"><span class="koboSpan" id="kobo.1712.1" xmlns="http://www.w3.org/1999/xhtml">

from scipy.optimize import minimize 
 
 
 
theta = np.array(np.random.random(4*nqubits), requires_grad=True) 
 
result = minimize(energy, x0=theta) 
 
 
 
print("Optimal parameters", result.x) 
 
print("Energy", result.fun)
</span></pre>
<p><span class="koboSpan" id="kobo.1713.1" xmlns="http://www.w3.org/1999/xhtml">We have imported the </span><code><span class="koboSpan" id="kobo.1714.1" xmlns="http://www.w3.org/1999/xhtml">minimize</span></code><span class="koboSpan" id="kobo.1715.1" xmlns="http://www.w3.org/1999/xhtml"> function from the </span><code><span class="koboSpan" id="kobo.1716.1" xmlns="http://www.w3.org/1999/xhtml">scipy</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1717.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1718.1" xmlns="http://www.w3.org/1999/xhtml">optimize</span></code><span class="koboSpan" id="kobo.1719.1" xmlns="http://www.w3.org/1999/xhtml"> package (scipy is a powerful and very </span><span id="dx1-135025"/><span class="koboSpan" id="kobo.1720.1" xmlns="http://www.w3.org/1999/xhtml">popular Python library for scientific computing). </span><span class="koboSpan" id="kobo.1720.2" xmlns="http://www.w3.org/1999/xhtml">We have chosen at random some initial values for the variational form parameters. </span><span class="koboSpan" id="kobo.1720.3" xmlns="http://www.w3.org/1999/xhtml">We have used </span><code><span class="koboSpan" id="kobo.1721.1" xmlns="http://www.w3.org/1999/xhtml">requires_grad</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1722.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><code><span class="koboSpan" id="kobo.1723.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.1724.1" xmlns="http://www.w3.org/1999/xhtml"> to allow the minimizer to compute gradients in order to optimize the parameters (we will have much more to say about this in </span><em><span class="koboSpan" id="kobo.1725.1" xmlns="http://www.w3.org/1999/xhtml">Part</span></em> <em/> <a href="ch016.xhtml#x1-138000III"><em><span class="koboSpan" id="kobo.1726.1" xmlns="http://www.w3.org/1999/xhtml">III</span></em></a><span class="koboSpan" id="kobo.1727.1" xmlns="http://www.w3.org/1999/xhtml"> of the book). </span><span class="koboSpan" id="kobo.1727.2" xmlns="http://www.w3.org/1999/xhtml">Then, we have minimized the </span><code><span class="koboSpan" id="kobo.1728.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></code><span class="koboSpan" id="kobo.1729.1" xmlns="http://www.w3.org/1999/xhtml"> function using the default parameters of the </span><code><span class="koboSpan" id="kobo.1730.1" xmlns="http://www.w3.org/1999/xhtml">minimize</span></code><span class="koboSpan" id="kobo.1731.1" xmlns="http://www.w3.org/1999/xhtml"> method. </span><span class="koboSpan" id="kobo.1731.2" xmlns="http://www.w3.org/1999/xhtml">Notice how the </span><code><span class="koboSpan" id="kobo.1732.1" xmlns="http://www.w3.org/1999/xhtml">x0</span></code><span class="koboSpan" id="kobo.1733.1" xmlns="http://www.w3.org/1999/xhtml"> argument is used to specify the initial values.</span></p>
<p><span class="koboSpan" id="kobo.1734.1" xmlns="http://www.w3.org/1999/xhtml">The result we obtain upon running this code is the following:</span></p>
<pre class="lstlisting" id="listing-189"><span class="koboSpan" id="kobo.1735.1" xmlns="http://www.w3.org/1999/xhtml">

Optimal parameters 
 
[ 2.25573385e-01  3.14158133e+00  1.91103424e-07 -1.88149577e-06 
 
 -2.71613763e-03 -7.94107899e-01  4.52510610e-01  6.17686238e-01 
 
  3.14158772e+00  6.28319382e+00  3.14158403e+00  3.14160984e+00 
 
  2.21495304e-01  5.01302639e-01  6.51839333e-01  7.36625551e-02] 
 
Energy -1.137283835001276
</span></pre>
<p><span class="koboSpan" id="kobo.1736.1" xmlns="http://www.w3.org/1999/xhtml">This includes the </span><span id="dx1-135032"/><span class="koboSpan" id="kobo.1737.1" xmlns="http://www.w3.org/1999/xhtml">optimal values found by the optimizer (the </span><code><span class="koboSpan" id="kobo.1738.1" xmlns="http://www.w3.org/1999/xhtml">x</span></code><span class="koboSpan" id="kobo.1739.1" xmlns="http://www.w3.org/1999/xhtml"> field) as well as the minimum energy. </span><span class="koboSpan" id="kobo.1739.2" xmlns="http://www.w3.org/1999/xhtml">As you can check, this fits nicely with the results that we have obtained with Qiskit for the total molecular energy.</span></p>
<p><span class="koboSpan" id="kobo.1740.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know how to run VQE on a simulator with PennyLane, we will turn to the task of executing the algorithm on actual quantum computers.</span></p>
</section>
<section class="level3 subsectionHead" data-number="14.4.3" id="running-vqe-on-real-quantum-devices">
<h2 class="subsectionHead" data-number="14.4.3"><span class="titlemark"><span class="koboSpan" id="kobo.1741.1" xmlns="http://www.w3.org/1999/xhtml">7.4.3 </span></span> <span id="x1-1360007.4.3"><span class="koboSpan" id="kobo.1742.1" xmlns="http://www.w3.org/1999/xhtml">Running VQE on real quantum devices</span></span></h2>
<p><span class="koboSpan" id="kobo.1743.1" xmlns="http://www.w3.org/1999/xhtml">You may </span><span id="dx1-136001"/><span class="koboSpan" id="kobo.1744.1" xmlns="http://www.w3.org/1999/xhtml">remember that, back in </span><em><span class="koboSpan" id="kobo.1745.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch013.xhtml#x1-1040005.3"><em><span class="koboSpan" id="kobo.1746.1" xmlns="http://www.w3.org/1999/xhtml">5.3</span></em></a><span class="koboSpan" id="kobo.1747.1" xmlns="http://www.w3.org/1999/xhtml">, we mentioned that there is a PennyLane Runtime client that can be used to run VQE programs. </span><span class="koboSpan" id="kobo.1747.2" xmlns="http://www.w3.org/1999/xhtml">This is exactly what we need now, so it is the perfect moment to learn how to use it.</span></p>
<p><span class="koboSpan" id="kobo.1748.1" xmlns="http://www.w3.org/1999/xhtml">In fact, using this Runtime implementation is very easy, because it is quite similar to the one we used with Qiskit. </span><span class="koboSpan" id="kobo.1748.2" xmlns="http://www.w3.org/1999/xhtml">First, we need be sure that we have </span><code><span class="koboSpan" id="kobo.1749.1" xmlns="http://www.w3.org/1999/xhtml">pennylane_qiskit</span></code><span class="koboSpan" id="kobo.1750.1" xmlns="http://www.w3.org/1999/xhtml"> installed and our IBM Quantum account enabled (see </span><em><span class="koboSpan" id="kobo.1751.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.1752.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.1753.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1754.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.1755.1" xmlns="http://www.w3.org/1999/xhtml">, for directions). </span><span class="koboSpan" id="kobo.1755.2" xmlns="http://www.w3.org/1999/xhtml">Then, we can run the following instructions:</span></p>
<pre class="lstlisting" id="listing-190"><span class="koboSpan" id="kobo.1756.1" xmlns="http://www.w3.org/1999/xhtml">

from pennylane_qiskit import upload_vqe_runner, vqe_runner 
 
 
 
program_id = upload_vqe_runner(hub="ibm-q", group="open", project="main") 
 
 
 
job = vqe_runner( 
 
    program_id=program_id, 
 
    backend="ibm_oslo", 
 
    hamiltonian=H, 
 
    ansatz=EfficientSU2, 
 
    x0=np.array(np.random.random(4*nqubits)), 
 
    shots=1024, 
 
    optimizer="SPSA", 
 
    kwargs={"hub": "ibm-q", "group": "open", "project": "main"} 
 
) 
 
print(job.result())
</span></pre>
<p><span class="koboSpan" id="kobo.1757.1" xmlns="http://www.w3.org/1999/xhtml">The code is </span><span id="dx1-136017"/><span class="koboSpan" id="kobo.1758.1" xmlns="http://www.w3.org/1999/xhtml">pretty much self-explanatory: we are just selecting the options for our VQE execution, including the device to run the circuits which, in this case, happens to be </span><code><span class="koboSpan" id="kobo.1759.1" xmlns="http://www.w3.org/1999/xhtml">ibm_oslo</span></code><span class="koboSpan" id="kobo.1760.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1760.2" xmlns="http://www.w3.org/1999/xhtml">After waiting for the job to finish running, we will obtain an output similar the following:</span></p>
<pre class="lstlisting" id="listing-191"><span class="koboSpan" id="kobo.1761.1" xmlns="http://www.w3.org/1999/xhtml">

     fun: -1.0125211856761642 
 
 message: ’Optimization terminated successfully.’ 
 
    </span><span class="koboSpan" id="kobo.1761.2" xmlns="http://www.w3.org/1999/xhtml">nfev: 300 
 
     nit: 100 
 
 success: True 
 
       x: array([-0.02558326,  0.50137847,  1.49781722,  2.83016638, 
 
       1.50688742, -0.00830098,  1.56006908, -0.01401641, -0.08208851, 
 
       2.71490414, 1.39380584,  1.30662208,  1.5691855 ,  1.34979806, 
 
       1.50345895, 0.39946571])
</span></pre>
<p><span class="koboSpan" id="kobo.1762.1" xmlns="http://www.w3.org/1999/xhtml">You may be wondering if we can also use error mitigation to try to improve our results. </span><span class="koboSpan" id="kobo.1762.2" xmlns="http://www.w3.org/1999/xhtml">The answer is yes, of course. </span><span class="koboSpan" id="kobo.1762.3" xmlns="http://www.w3.org/1999/xhtml">In fact, it is straightforward to set up, because we only need to include the additional parameter </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1763.1" xmlns="http://www.w3.org/1999/xhtml">use_measurement_mitigation</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1764.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1765.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code></span></span><span class="koboSpan" id="kobo.1766.1" xmlns="http://www.w3.org/1999/xhtml"> when creating the </span><code><span class="koboSpan" id="kobo.1767.1" xmlns="http://www.w3.org/1999/xhtml">vqe_runner</span></code><span class="koboSpan" id="kobo.1768.1" xmlns="http://www.w3.org/1999/xhtml"> object. </span><span class="koboSpan" id="kobo.1768.2" xmlns="http://www.w3.org/1999/xhtml">Running with this option will give you a result similar to the following one, which is closer to the real optimal value:</span></p>
<pre class="lstlisting" id="listing-192"><span class="koboSpan" id="kobo.1769.1" xmlns="http://www.w3.org/1999/xhtml">

     fun: -1.0835711819668128 
 
 message: ’Optimization terminated successfully.’ 
 
    </span><span class="koboSpan" id="kobo.1769.2" xmlns="http://www.w3.org/1999/xhtml">nfev: 300 
 
     nit: 100 
 
 success: True 
 
       x: array([-0.06213913,  2.62825807,  2.85476345, -0.2260965, 
 
       -0.07639407, -1.51018602,  1.73431192, -0.07301669, -0.16907148, 
 
       2.60134032, 3.29831133, -0.2912491 ,  0.33893055,  1.90085806, 
 
       1.7206114 , -1.49009082])
</span></pre>
<p><span class="koboSpan" id="kobo.1770.1" xmlns="http://www.w3.org/1999/xhtml">With this, we </span><span id="dx1-136036"/><span class="koboSpan" id="kobo.1771.1" xmlns="http://www.w3.org/1999/xhtml">conclude our study of VQE and, in fact, we conclude the part of the book devoted to optimization problems. </span><span class="koboSpan" id="kobo.1771.2" xmlns="http://www.w3.org/1999/xhtml">Starting with the next chapter, we will dive into the fascinating world of quantum machine learning. </span><span class="koboSpan" id="kobo.1771.3" xmlns="http://www.w3.org/1999/xhtml">Hang tight and prepare for the ride!</span></p>
</section>
</section>
<section class="level2 likesectionHead" data-number="14.5" id="summary-6">
<h1 class="likesectionHead" data-number="14.5"><span id="x1-1370007.4.3"><span class="koboSpan" id="kobo.1772.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></span></h1>
<p><span id="Q1-1-188"/></p>
<p><span class="koboSpan" id="kobo.1773.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we have studied Hamiltonians and observables in detail. </span><span class="koboSpan" id="kobo.1773.2" xmlns="http://www.w3.org/1999/xhtml">In particular, we have learned how to derive mathematical expressions for their expectation values and how to estimate these quantities using quantum computers.</span></p>
<p><span class="koboSpan" id="kobo.1774.1" xmlns="http://www.w3.org/1999/xhtml">Then, we studied the VQE algorithm and how it can be used to find ground states of general Hamiltonians. </span><span class="koboSpan" id="kobo.1774.2" xmlns="http://www.w3.org/1999/xhtml">We also described a modification of VQE called VQD that can also be used to compute excited states and not just states of minimum energy.</span></p>
<p><span class="koboSpan" id="kobo.1775.1" xmlns="http://www.w3.org/1999/xhtml">Then, we moved to practical matters and learned how to use Qiskit to run VQE and VQD. </span><span class="koboSpan" id="kobo.1775.2" xmlns="http://www.w3.org/1999/xhtml">We illustrated this with a very interesting problem: that of finding the ground state of a simple molecule. </span><span class="koboSpan" id="kobo.1775.3" xmlns="http://www.w3.org/1999/xhtml">We then introduced methods to simulate the behavior of quantum algorithms when there is noise and how to reduce the adverse effect of readout errors with some mitigation techniques. </span><span class="koboSpan" id="kobo.1775.4" xmlns="http://www.w3.org/1999/xhtml">We also studied how to run VQE problems on actual quantum computers with IBM runtime.</span></p>
<p><span class="koboSpan" id="kobo.1776.1" xmlns="http://www.w3.org/1999/xhtml">After that, we also learned how to implement and run VQE on PennyLane, again solving a molecular structure problem. </span><span class="koboSpan" id="kobo.1776.2" xmlns="http://www.w3.org/1999/xhtml">We even studied how to use Runtime from PennyLane to send VQE instances to real quantum computers.</span></p>
<p><span class="koboSpan" id="kobo.1777.1" xmlns="http://www.w3.org/1999/xhtml">After reading this chapter, you are now able to understand all the mathematical details behind the VQE algorithm. </span><span class="koboSpan" id="kobo.1777.2" xmlns="http://www.w3.org/1999/xhtml">You also know how to run it on different types of problems with both Qiskit and PennyLane. </span><span class="koboSpan" id="kobo.1777.3" xmlns="http://www.w3.org/1999/xhtml">Moreover, you now can run noisy simulations of all the algorithms that we have studied (and of any other quantum algorithm that you may learn in the future) as well as perform readout error mitigation on simulated and actual quantum devices.</span></p>
<p><span class="koboSpan" id="kobo.1778.1" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we will start studying the second big topic of the book: quantum machine learning. </span><span class="koboSpan" id="kobo.1778.2" xmlns="http://www.w3.org/1999/xhtml">Prepare to learn how (quantum) machines learn!</span></p>
</section>
</section>
</body>
</html>
