<html><head></head><body><div id="sbo-rt-content"><div class="preface" title="Preface"><div class="titlepage"><div><div><h1 class="title"><a id="pref05"/>Preface</h1></div></div></div><p>This book is about machine learning, the functional approach to programming with Scala being the focus, and big data with Spark being the target. When I was offered to write the book about nine months ago, my first reaction was that, while each of the mentioned subjects have been thoroughly investigated and written about, I've definitely taken part in enough discussions to know that combining any pair of them presents challenges, not to mention combining all three of them in one book. The challenge piqued my interest, and the result is this book. Not every chapter is as smooth as I wished it to be, but in the world where technology makes huge strides every day, this is probably expected. I do have a real job and writing is only one way to express my ideas.</p><p>Let's start with machine learning. Machine learning went through a head-spinning transformation; it was an offspring of AI and statistics somewhere in the 1990s and later gave birth to data science in or slightly before 2010. There are many definitions of data science, but the most popular one is probably from Josh Wills, with whom I had the privilege to work at Cloudera, which is depicted in <span class="emphasis"><em>Figure 1</em></span>. While the details may be argued about, the truth is that data science is always on the intersection of a few disciplines, and a data scientist is not necessarily is an expert on any one of them. Arguably, the first data scientists worked at Facebook, according to Jeff Hammerbacher, who was also one of the Cloudera founders and an early Facebook employee. Facebook needed interdisciplinary skills to extract value from huge amounts of social data at the time. While I call myself a big data scientist, for the purposes of this book, I'd like to use the term machine learning or ML to keep the focus, as I am mixing too much already here.</p><p>One other aspect of ML that came about recently and is actively discussed is that the quantity of data beats the sophistication of the models. One can see this in this book in the example of some Spark MLlib implementations, and word2vec for NLP in particular. Speedier ML models that can respond to new environments faster also often beat the more complex models that take hours to build. Thus, ML and big data make a good match.</p><p>Last but not least is the emergence of microservices. I spent a great deal of time on the topic of machine and application communication in this book, and Scala with the Akka actors model comes very naturally here.</p><p>Functional programming, at least for a good portion of practical programmers, is more about the style of programming than a programming language itself. While Java 8 started having lambda expressions and streams, which came out of functional programming, one can still write in a functional style without these mechanisms or even write a Java-style code in Scala. The two big ideas that brought Scala to prominence in the big data world are lazy evaluation, which greatly simplifies data processing in a multi-threaded or distributed world, and immutability. Scala has two different libraries for collections: one is mutable and another is immutable. While the distinction is subtle from the application user point of view, immutability greatly increases the options from a compiler perspective, and lazy evaluation cannot be a better match for big data, where REPL postpones most of the number crunching towards later stages of the pipeline, increasing interactivity.</p><div class="mediaobject"><img src="Images/B04935_00_01.jpg" alt="Preface" width="768" height="447"/><div class="caption"><p>Figure 1: One of the possible definitions of a data scientist</p></div></div><p>Finally, big data. Big data has definitely occupied the headlines for a couple of years now, and a big reason for this is that the amount of data produced by machines today greatly surpasses anything that a human cannot even produce, but even comprehend, without using the computers. The social network companies, such as Facebook, Google, Twitter, and so on, have demonstrated that enough information can be extracted from these blobs of data to justify the tools specifically targeted towards processing big data, such as Hadoop, MapReduce, and Spark.</p><p>We will touch on what Hadoop does later in the book, but originally, it was a Band-Aid on top of commodity hardware to be able to deal with a vast amount of information, which the traditional relational DBs at the time were not equipped to handle (or were able, but at a prohibitive price). While big data is probably too big a subject for me to handle in this book, Spark is the focus and is another implementation of Hadoop MapReduce that removes a few inefficiencies of having to deal with persisting data on disk. Spark is a bit more expensive as it consumes more memory in general and the hardware has to be more reliable, but it is more interactive. Furthermore, Spark works on top of Scala—other languages such as Java and Python too—but Scala is the primary API language, and it found certain synergies in how it expresses data pipelines in Scala.</p><div class="section" title="What this book covers"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec02"/>What this book covers</h1></div></div></div><p>
<a class="link" href="ch01.xhtml" title="Chapter 1. Exploratory Data Analysis">Chapter 1</a>, <span class="emphasis"><em>Exploratory Data Analysis, </em></span>covers how<span class="emphasis"><em> </em></span>every data analyst begins with an exploratory data analysis. There is nothing new here, except that the new tools allow you to look into larger datasets—possibly spread across multiple computers, as easily as if they were just on a local machine. This, of course, does not prevent you from running the pipeline on a single machine, but even then, the laptop I am writing this on has four cores and about 1,377 threads running at the same time. Spark and Scala (parallel collections) allow you to transparently use this entire dowry, sometimes without explicitly specifying the parallelism. Modern servers may have up to 128 hyper-threads available to the OS. This chapter will show you how to start with the new tools, maybe by exploring your old datasets.</p><p>
<a class="link" href="ch02.xhtml" title="Chapter 2. Data Pipelines and Modeling">Chapter 2</a>, <span class="emphasis"><em>Data Pipelines and Modeling</em></span>, explains that while data-driven processes existed long before Scala/Spark, the new age demonstrated the emergence of a fully data-driven enterprise where the business is optimized by the feedback from multiple data-generating machines. Big data requires new techniques and architectures to accommodate the new decision making process. Borrowing from a number of academic fields, this chapter proceeds to describe a generic architecture of a data-driven business, where most of the workers' task is monitoring and tuning the data pipelines (or enjoying the enormous revenue per worker that these enterprises can command).</p><p>
<a class="link" href="ch03.xhtml" title="Chapter 3. Working with Spark and MLlib">Chapter 3</a>, <span class="emphasis"><em>Working with Spark and MLlib</em></span>, focuses on the internal architecture of Spark, which we mentioned earlier as a replacement for and/or complement to Hadoop MapReduce. We will specifically stop on a few ML algorithms, which are grouped under the MLlib tag. While this is still a developing topic and many of the algorithms are being moved using a different package now, we will provide a few examples of how to run standard ML algorithms in the <code class="literal">org.apache.spark.mllib</code> package. We will also explain the modes that Spark can be run under and touch on Spark performance tuning.</p><p>
<a class="link" href="ch04.xhtml" title="Chapter 4. Supervised and Unsupervised Learning">Chapter 4</a>, <span class="emphasis"><em>Supervised and Unsupervised Learning</em></span>, explains that while Spark MLlib may be a moving target, general ML principles have been solidly established. Supervised/unsupervised learning is a classical division of ML algorithms that work on row-oriented data—most of the data, really. This chapter is a classic part of any ML book, but we spiced it up a bit to make it more Scala/Spark-oriented.</p><p>
<a class="link" href="ch05.xhtml" title="Chapter 5. Regression and Classification">Chapter 5</a>, <span class="emphasis"><em>Regression and Classification</em></span>, introduces regression and classification, which is another classic subdivision of the ML algorithms, even if it has been shown that classification can be used to regress, and regression to classify, still these are the two classes that use different techniques, precision metrics, and ways to regularize the models. This chapter will take a practical approach while showing you practical examples of regression and classification analysis</p><p>
<a class="link" href="ch06.xhtml" title="Chapter 6. Working with Unstructured Data">Chapter 6</a>, <span class="emphasis"><em>Working with Unstructured Data,</em></span> covers how one of the new features that social data brought with them and brought traditional DBs to their knees is nested and unstructured data. Working with unstructured data requires new techniques and formats, and this chapter is dedicated to the ways to present, store, and evolve these types of data. Scala becomes a big winner here, as it has a natural way to deal with complex data structures in the data pipelines.</p><p>
<a class="link" href="ch07.xhtml" title="Chapter 7. Working with Graph Algorithms">Chapter 7</a>, <span class="emphasis"><em>Working with Graph Algorithms</em></span>, explains how graphs present another challenge to the traditional row-oriented DBs. Lately, there has been a resurgence of graph DBs. We will cover two different libraries in this chapter: one is Scala-graph from Assembla, which is a convenient tool to represent and reason with graphs, and the other is Spark's graph class with a few graph algorithms implemented on top of it.</p><p>
<a class="link" href="ch08.xhtml" title="Chapter 8. Integrating Scala with R and Python">Chapter 8</a>, <span class="emphasis"><em>Integrating Scala with R and Python</em></span>, covers how even though Scala is cool, many people are just too cautious to leave their old libraries behind. In this chapter, I will show how to transparently refer to the legacy code written in R and Python, a request I hear too often. In short, there are too mechanisms: one is using Unix pipelines and another way is to launch R or Python in JVM.</p><p>
<a class="link" href="ch09.xhtml" title="Chapter 9. NLP in Scala">Chapter 9</a>, <span class="emphasis"><em>NLP in Scala</em></span>, focuses on how natural language processing has deal with human-computer interaction and computer's understanding of our often-substandard ways to communicate. I will focus on a few tools that Scala specifically provide for NLP, topic association, and dealing with large amounts of textual information (Spark).</p><p>
<a class="link" href="ch10.xhtml" title="Chapter 10. Advanced Model Monitoring">Chapter 10</a>, <span class="emphasis"><em>Advanced Model Monitoring</em></span>, introduces how developing data pipelines usually means that someone is going to use and debug them. Monitoring is extremely important not only for the end user data pipeline, but also for the developer or designer who is looking for the ways to either optimize the execution or further the design. We cover the standard tools for monitoring systems and distributed clusters of machines as well as how to design a service that has enough hooks to look into its functioning without attaching a debugger. I will also touch on the new emerging field of statistical model monitoring.</p></div></div></div>



  
<div id="sbo-rt-content"><div class="section" title="What you need for this book"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec03"/>What you need for this book</h1></div></div></div><p>This book is based on open source software. First, it's Java. One can download Java from Oracle's Java Download page. You have to accept the license and choose an appropriate image for your platform. Don't use OpenJDK—it has a few problems with Hadoop/Spark.</p><p>Second, Scala. If you are using Mac, I recommend installing Homebrew:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>$ ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</strong></span>
</pre></div><p>Multiple open source packages will also be available to you. To install Scala, run <code class="literal">brew install scala</code>. Installation on a Linux platform requires downloading an appropriate Debian or RPM package from the <a class="ulink" href="http://www.scala-lang.org/download/">http://www.scala-lang.org/download/</a> site. We will use the latest version at the time, that is, 2.11.7.</p><p>Spark distributions can be downloaded from <a class="ulink" href="http://spark.apache.org/downloads.html">http://spark.apache.org/downloads.html</a>. We use pre-build for Hadoop 2.6 and later image. As it's Java, you need to just unzip the package and start using the scripts from the <code class="literal">bin</code> subdirectory.</p><p>R and Python packages are available at <a class="ulink" href="http://cran.r-project.org/bin">http://cran.r-project.org/bin</a> and <code class="literal">http://python.org/ftp/python/$PYTHON_VERSION/Python-$PYTHON_VERSION.tar.xz</code> sites respectively. The text has specific instruction on how to configure them. Although our use of the packages should be version agnostic, I used R version 3.2.3 and Python version 2.7.11 in this book.</p></div></div>



  
<div id="sbo-rt-content"><div class="section" title="Who this book is for"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec04"/>Who this book is for</h1></div></div></div><p>Professional and emerging data scientists who want to sharpen their skills and see practical examples of working with big data: a data analyst who wants to effectively extract actionable information from large amounts of data and an aspiring statistician who is willing to get beyond the existing boundaries and become a data scientist.</p><p>The book style is pretty much hands-on, I don't delve into mathematical proofs or validations, with a few exceptions, and there are more in-depth texts that I recommend throughout the book. However, I will try my best to provide code samples and tricks that you can start using for the standard techniques and libraries as soon as possible.</p></div></div>



  
<div id="sbo-rt-content"><div class="section" title="Conventions"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec05"/>Conventions</h1></div></div></div><p>In this book, you will find a number of text styles that distinguish between different kinds of information. Here are some examples of these styles and an explanation of their meaning.</p><p>Code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles are shown as follows: "We can include other contexts through the use of the <code class="literal">include</code> directive."</p><p>A block of code is set as follows:</p><div class="informalexample"><pre class="programlisting">import scala.util.hashing.MurmurHash3._

val markLow = 0
val markHigh = 4096
val seed = 12345

def consistentFilter(s: String): Boolean = {
  val hash = stringHash(s.split(" ")(0), seed) &gt;&gt;&gt; 16
  hash &gt;= markLow &amp;&amp; hash &lt; markHigh
}

val w = new java.io.FileWriter(new java.io.File("out.txt"))
val lines = io.Source.fromFile("chapter01/data/iris/in.txt").getLines
lines.filter(consistentFilter).foreach { s =&gt;
     w.write(s + Properties.lineSeparator)
}</pre></div><p>Any command-line input or output is written as follows:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>akozlov@Alexanders-MacBook-Pro]$ scala</strong></span>
<span class="strong"><strong>Welcome to Scala version 2.11.7 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_40).</strong></span>
<span class="strong"><strong>Type in expressions to have them evaluated.</strong></span>
<span class="strong"><strong>Type :help for more information.</strong></span>

<span class="strong"><strong>scala&gt; import scala.util.Random</strong></span>
<span class="strong"><strong>import scala.util.Random</strong></span>
</pre></div><p>
<span class="strong"><strong>New terms</strong></span> and <span class="strong"><strong>important words</strong></span> are shown in bold. Words that you see on the screen, for example, in menus or dialog boxes, appear in the text like this: "Run all cells at once by navigating to <span class="strong"><strong>Cell</strong></span> | <span class="strong"><strong>Run All</strong></span>."</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note01"/>Note</h3><p>Warnings or important notes appear in a box like this.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip01"/>Tip</h3><p>Tips and tricks appear like this.</p></div></div></div></div>



  
<div id="sbo-rt-content"><div class="section" title="Reader feedback"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec06"/>Reader feedback</h1></div></div></div><p>Feedback from our readers is always welcome. Let us know what you think about this book—what you liked or disliked. Reader feedback is important for us as it helps us develop titles that you will really get the most out of.</p><p>To send us general feedback, simply e-mail <code class="email">&lt;<a class="email" href="mailto:feedback@packtpub.com">feedback@packtpub.com</a>&gt;</code>, and mention the book's title in the subject of your message.</p><p>If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, see our author guide at <a class="ulink" href="http://www.packtpub.com/authors">www.packtpub.com/authors</a>.</p></div></div>



  
<div id="sbo-rt-content"><div class="section" title="Customer support"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec07"/>Customer support</h1></div></div></div><p>Now that you are the proud owner of a Packt book, we have a number of things to help you to get the most from your purchase.</p><div class="section" title="Downloading the example code"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec02"/>Downloading the example code</h2></div></div></div><p>You can download the example code files for this book from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p><p>You can download the code files by following these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in or register to our website using your e-mail address and password.</li><li class="listitem">Hover the mouse pointer on the <span class="strong"><strong>SUPPORT</strong></span> tab at the top.</li><li class="listitem">Click on <span class="strong"><strong>Code Downloads &amp; Errata</strong></span>.</li><li class="listitem">Enter the name of the book in the <span class="strong"><strong>Search</strong></span> box.</li><li class="listitem">Select the book for which you're looking to download the code files.</li><li class="listitem">Choose from the drop-down menu where you purchased this book from.</li><li class="listitem">Click on <span class="strong"><strong>Code Download</strong></span>.</li></ol></div><p>Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">WinRAR / 7-Zip for Windows</li><li class="listitem" style="list-style-type: disc">Zipeg / iZip / UnRarX for Mac</li><li class="listitem" style="list-style-type: disc">7-Zip / PeaZip for Linux</li></ul></div><p>The code bundle for the book is also hosted on GitHub at <a class="ulink" href="https://github.com/PacktPublishing/Mastering-Scala-Machine-Learning">https://github.com/PacktPublishing/Mastering-Scala-Machine-Learning</a>. We also have other code bundles from our rich catalog of books and videos available at. <a class="ulink" href="https://github.com/PacktPublishing/">https://github.com/PacktPublishing/</a> Check them out!</p></div><div class="section" title="Downloading the color images of this book"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec03"/>Downloading the color images of this book</h2></div></div></div><p>We also provide you with a PDF file that has color images of the screenshots/diagrams used in this book. The color images will help you better understand the changes in the output. You can download this file from <a class="ulink" href="https://www.packtpub.com/sites/default/files/downloads/MasteringScalaMachineLearning_ColorImages.pdf">https://www.packtpub.com/sites/default/files/downloads/MasteringScalaMachineLearning_ColorImages.pdf</a>.</p></div><div class="section" title="Errata"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec04"/>Errata</h2></div></div></div><p>Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you find a mistake in one of our books—maybe a mistake in the text or the code—we would be grateful if you could report this to us. By doing so, you can save other readers from frustration and help us improve subsequent versions of this book. If you find any errata, please report them by visiting <a class="ulink" href="http://www.packtpub.com/submit-errata">http://www.packtpub.com/submit-errata</a>, selecting your book, clicking on the <span class="strong"><strong>Errata Submission Form</strong></span> link, and entering the details of your errata. Once your errata are verified, your submission will be accepted and the errata will be uploaded to our website or added to any list of existing errata under the Errata section of that title.</p><p>To view the previously submitted errata, go to <a class="ulink" href="https://www.packtpub.com/books/content/support">https://www.packtpub.com/books/content/support</a> and enter the name of the book in the search field. The required information will appear under the <span class="strong"><strong>Errata</strong></span> section.</p></div><div class="section" title="Piracy"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec05"/>Piracy</h2></div></div></div><p>Piracy of copyrighted material on the Internet is an ongoing problem across all media. At Packt, we take the protection of our copyright and licenses very seriously. If you come across any illegal copies of our works in any form on the Internet, please provide us with the location address or website name immediately so that we can pursue a remedy.</p><p>Please contact us at <code class="email">&lt;<a class="email" href="mailto:copyright@packtpub.com">copyright@packtpub.com</a>&gt;</code> with a link to the suspected pirated material.</p><p>We appreciate your help in protecting our authors and our ability to bring you valuable content.</p></div><div class="section" title="Questions"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec06"/>Questions</h2></div></div></div><p>If you have a problem with any aspect of this book, you can contact us at <code class="email">&lt;<a class="email" href="mailto:questions@packtpub.com">questions@packtpub.com</a>&gt;</code>, and we will do our best to address the problem.</p></div></div></div>



  </body></html>