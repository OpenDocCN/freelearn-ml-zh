<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Getting Started with Machine Learning</h1>
                </header>
            
            <article>
                
<p>In the last chapter, we saw what machine learning predictive models are and formed a basic understanding of how they work. In this chapter, we will demonstrate the working of neural net models and move on to another type of model, the (<strong>Support Vector Machines</strong>)<br/>
<strong>SVMs </strong>model.</p>
<p>The following are the topics that will be covered in this chapter:</p>
<ul>
<li>Demonstrating a neural network</li>
<li>Support Vector Machines</li>
<li>Demonstrating SVMs</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Demonstrating a neural network</h1>
                </header>
            
            <article>
                
<p>Let's jump to a hands-on example of neural networks. The software that we are using is the SPSS Modeler, provided by IBM. But feel free to use any data-mining software package.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Running a neural network model</h1>
                </header>
            
            <article>
                
<p>In order to run our first neural network, we will have to bring in the data that we will be using, if you are using IBM SPSS Modeler you can follow these steps:</p>
<ol>
<li>Get the data using the <strong>Var. File</strong> node, and bring it up to the canvas:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-631 image-border" src="assets/12e7de96-8016-4b88-a24e-812d2d542a76.png" style="width:102.00em;height:69.67em;"/></p>
<ol start="2">
<li class="CDPAlignLeft CDPAlign">Attach the dataset to the source node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-482 image-border" src="assets/9cd347ff-f70c-4e83-8a7c-cf342f6f015e.png" style="width:37.08em;height:40.50em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">Click on the triple dot box on the right side of file box and navigate to your data; we are using <kbd>Electronics_Data</kbd> here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-632 image-border" src="assets/d2804182-e81c-4e77-953e-b35725d99f87.png" style="width:50.50em;height:28.33em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">Click <strong>Open</strong>.</p>
<ol start="3">
<li class="CDPAlignLeft CDPAlign">Go on to the <strong>Types</strong> tab to check whether the data was read correctly:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-484 image-border" src="assets/532eed80-0100-4e2d-828d-69070f850889.png" style="width:36.50em;height:39.33em;"/></p>
<p style="padding-left: 60px">Click on the <strong>Read Values</strong> button; click <strong>OK</strong> on the prompt that pops up next, and you will see this:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-635 image-border" src="assets/06c0e854-2a0a-4cac-956d-9ca895f8105f.png" style="width:36.75em;height:39.58em;"/></p>
<p style="padding-left: 60px">It looks like the data was read correctly.</p>
<ol start="4">
<li class="CDPAlignLeft CDPAlign">We will not use the first variable, <strong>ID</strong>,<strong> </strong>and hence we will set its measurement to <strong>Typeless</strong>:</li>
</ol>
<p> </p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-47 image-border" src="assets/1259a997-e195-4b9c-bcc7-aa01ce0a7820.png" style="font-size: 1em;width:36.58em;height:40.50em;"/></p>
<ol start="5">
<li class="CDPAlignLeft CDPAlign">Let's now specify our <strong>Status </strong><span>target variable </span>and set its <strong>Role</strong> to <strong>Target</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-48 image-border" src="assets/93571dba-6986-445a-a17b-ab899590c0a2.png" style="width:37.67em;height:41.75em;"/></p>
<p style="padding-left: 60px">Now Modeler knows that the <strong>Status</strong> is the variable that it will be predicting. It will use the other fields to predict the outcome variable.</p>
<ol start="6">
<li class="CDPAlignLeft CDPAlign">Take a look at the data that you have added; for this, go to the <strong>Output</strong> palette at the bottom of the canvas:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-636 image-border" src="assets/2e132e68-e93f-4a22-9e30-838f426dba1f.png" style="width:106.58em;height:73.58em;"/></p>
<p style="padding-left: 60px">Connect the source node, <kbd>Electronics_Data</kbd>, to the Output Table node:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-637 image-border" src="assets/0ee2ccc8-d43c-4ba1-86c7-7367e39c333c.png" style="width:92.50em;height:65.17em;"/></p>
<p class="mce-root"/>
<ol start="7">
<li class="CDPAlignLeft CDPAlign">Run the stream by clicking the <strong>Run Selection</strong> (pentagon icon) button, beside the Play icon, located above the canvas:</li>
</ol>
<p style="padding-left: 60px">You will see the following data:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-639 image-border" src="assets/2de35d3b-9714-43fa-8cb1-cbbbc24a9176.png" style="width:44.83em;height:30.58em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">Hence, we have a table with <strong>19 fields and 5,003 records</strong>, and this means that we have 17 predictors in this dataset if we eliminate the target field and the ID field that we aren't using. We are going to predict the status field to check whether we have lost or retained a customer, based on the amount of items people have purchased, the total revenue, whether they have used discounts, the way in which they paid for the goods, the location, and other additional customer characteristics. Close this window to move ahead.</p>
<ol start="8">
<li class="CDPAlignLeft CDPAlign">Before moving on to building any model, make sure to split your dataset into a <kbd>Training</kbd> and <kbd>Testing</kbd> dataset just to replicate your results and to verify the consistency in the model that we are building. For doing this, go to the <strong>Field Ops</strong> panel and connect the source node to the <strong>Partition</strong> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-640 image-border" src="assets/1b44e65f-adbb-4617-9d46-05e2625b7c23.png" style="width:56.83em;height:35.67em;"/></p>
<p style="padding-left: 60px">This <strong>Partition</strong> node will create two versions of the dataset:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-641 image-border" src="assets/e980a232-e2a4-4d3c-8d09-a5a3af7f6a49.png" style="width:45.08em;height:35.75em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">Hence, <kbd>50</kbd> of the data will be training and the other <kbd>50</kbd> of the dataset will be testing the dataset, respectively. Click <strong>OK</strong>.</p>
<p class="mce-root"/>
<ol start="9">
<li class="CDPAlignLeft CDPAlign">We will now build our model. For this, go on to the <strong>Modeling</strong> panel and connect the <strong>Partition</strong> node to the <strong>Neural Net</strong> model by clicking once on both of them:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-642 image-border" src="assets/4c61c34d-4b80-46aa-9f59-b4304214336f.png" style="width:88.92em;height:50.83em;"/></p>
<p style="padding-left: 60px">Hence, you can see that <strong>Status</strong>, the variable to be predicted by the neural network, is already captured and a neural network will be built for it.</p>
<ol start="10">
<li class="CDPAlignLeft CDPAlign"> Click on the <strong>Neural Net</strong> stat node to see the details of the neural network:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-643 image-border" src="assets/8345d326-bc52-4701-9c20-cce71b8e5c44.png" style="width:38.33em;height:39.50em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">You can see that there is a target variable, and our 17 <strong>Predictors</strong> are specified by the neural network. The <strong>Predictors</strong> can be of any field type: continuous, categorical, or any other type. You can also decide to not include some of these <strong>Predictors</strong>.</p>
<ol start="11">
<li class="CDPAlignLeft CDPAlign">Click on the <strong>Build Options</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-644 image-border" src="assets/9dd99758-9922-4ff6-a7a5-9b10f138ef2f.png" style="width:37.33em;height:33.58em;"/></p>
<ol start="12">
<li class="CDPAlignLeft CDPAlign"> These questions are to know what you want to do with the model, whether you want to build a new model or continue training an existing one. You can select any objective here; we will be creating a standard model for our example, and we will discuss other options in later chapters.</li>
</ol>
<ol start="13">
<li class="CDPAlignLeft CDPAlign">You can see the type of model that you wish to build by clicking on the <strong>Basics</strong> tab under <strong>Build Options</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-645 image-border" src="assets/d627489c-744b-4582-b4cd-fb670069abdb.png" style="width:54.25em;height:35.00em;"/></p>
<p style="padding-left: 60px">As you can see, we have two options, the <strong>Multilayer Perceptron (MLP)</strong> model, which we saw in this chapter earlier, and the <strong>Radial Basis Function (RBF)</strong> model. R<span>BF</span>s are preferred when you have things such as clustered predictors, but for our example the multilayer perceptron model is the best choice. The Hidden layers option allows you specify the number of Hidden layers you need in your model. Currently, we will select <strong>Automatically compute number of units</strong>. Hence, the model will automatically compute the number of hidden layers for us.</p>
<ol start="14">
<li class="CDPAlignLeft CDPAlign">Go on to the <strong>Shopping Rules</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-646 image-border" src="assets/8a3b22c9-cb90-4a2b-8940-84aa0de8c770.png" style="width:35.42em;height:27.92em;"/></p>
<p style="padding-left: 60px">Our model will run through many iterations and it will stop when it's no longer improving; however, it can stop for other reasons as well. For example, it can stop after a certain amount of time has passed and the default, as you can see in the screenshot, is set to <kbd>15</kbd> minutes, but you can change this. You could also have the model stop after it's gone through a certain number of iterations, or you could tell the model to stop once it's reached a certain level of accuracy. Hence, these are some other ways in which you can stop running the model.</p>
<ol start="15">
<li class="CDPAlignLeft CDPAlign">Click on the <strong>Ensembles</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-648 image-border" src="assets/c2e04487-ea0e-4bde-9a01-e982a92c0050.png" style="width:39.00em;height:29.50em;"/></p>
<p style="padding-left: 60px">This option enables us to build multiple versions of a model; let's keep this at the default values.</p>
<ol start="16">
<li class="CDPAlignLeft CDPAlign">Go on to the <strong>Advanced</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-647 image-border" src="assets/b3d0bf86-3b5a-48e5-8460-6fa00ba71686.png" style="width:34.50em;height:27.58em;"/></p>
<p style="padding-left: 60px">We know that neural nets <span>will eventually learn the patterns in the data if you let them run for long enough. This can be an undesirable feature because we don't want to capitalize on chance, therefore we want hold some data back, and we can set the value of data to hold for each iteration using this option—in this case, of the training dataset is <kbd>30.0</kbd> is held back from the training dataset in every iteration.</span></p>
<p style="padding-left: 60px"><span>Regarding the random seed, as we know, we will be running our model multiple times (the that we find the global solution and not get stuck on a sub-optimal solution), and we can generate the random seed. Each time you click on the Generate button, you will get a different random seed (or starting point).<br/></span></p>
<p style="padding-left: 60px"/>
<p style="padding-left: 60px"><span> </span><span>Also, neural nets do not run with missing values; they need complete data, and you can select what needs to be done with the missing values using the <strong>Advanced</strong> tab <strong>Missing values in Predictors</strong> option:</span></p>
<ul>
<li style="list-style-type: none">
<ul>
<li><strong>Delete listwise</strong><span>: If there is missing information on any one of the variables, that whole case will be eliminated from the model.</span></li>
<li><strong>Impute missing values</strong><span>: In this case, there are missing values, these will be replaced by the model defaults so you won't have any control over what Modeler does with them. </span><span>Hence, my suggestion is to replace the missing values even before you start building a model.</span></li>
</ul>
</li>
</ul>
<ol start="17">
<li>Go to the <strong>Model Options</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-62 image-border" src="assets/f16fd42f-6aa3-44e7-963e-8765dec261c2.png" style="width:36.17em;height:37.83em;"/></span></p>
<p style="padding-left: 60px">The model is automatically going to give you or calculate the predictor importance. It'll let you know which fields are the most important in the model. In terms of what the model is going to provide, it's going to provide a prediction, and it's also going to provide a confidence in that prediction score. Typically, you should see the probability of a predicted value; that's the most useful.</p>
<p style="padding-left: 60px">You can also ask instead to get the increase in probability from the category that was predicted from the next-most-likely outcome. You can get predicted probabilities for the categorical targets for all the different categories if you like, as well.</p>
<p style="padding-left: 60px">The propensity scores end up being extremely useful, and we'll discuss them later.</p>
<ol start="18">
<li>Click on <strong>Run</strong> <span>to</span> <span>run the model. Now t</span>he model has been built:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-649 image-border" src="assets/262594be-f964-4948-b5b2-f75c0cd660cd.png" style="width:39.00em;height:27.33em;"/></p>
<p class="CDPAlignLeft CDPAlign">Let's see what we have found.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Interpreting results</h1>
                </header>
            
            <article>
                
<p class="mce-root">To see the results, click on the <strong>Status</strong> generated model that was added automatically after the model was built. </p>
<p>The following observations are required for the testing dataset. Let's understand them in detail:</p>
<ol>
<li>You will see a <strong>Model Summary</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-650 image-border" src="assets/a7d9e613-c434-4d7e-8848-055abe5eedbc.png" style="width:42.42em;height:37.17em;"/></p>
<p class="mce-root"/>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px"><span>You can see what our target is; we know that we ran a multilayer perceptron model and then it gives you the information as to why the model stopped, and you can see that it stopped because the error cannot be further decreased. Basically, this means that the model was not improving anymore and </span><span>we have one hidden layer and that hidden layer has seven neurons. We can also see that on the training dataset the overall accuracy was about <strong>79%</strong>.<br/></span></p>
<ol start="2">
<li>Click on the next tab on the right side, the <strong>Predictor Importance</strong> tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-651 image-border" src="assets/2bf865bc-81a4-4a3a-98dc-12824b0113e2.png" style="width:46.33em;height:40.67em;"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p style="padding-left: 60px">This gives you information on predictor importance. Hence, you can observe which predictors are the most important and contribute largely to the predictions. This is showing the most important predictors. In our case, the <strong>Speakers</strong> <span>predictor </span>tops the list. To see the importance of more predictors, you can just drag the scale down toward the left. </p>
<ol start="3">
<li><strong>Classification for Status </strong>is our next observation:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-652 image-border" src="assets/4edfc538-96d7-40ed-b6db-7a7ae5e0d034.png" style="width:47.17em;height:41.17em;"/></p>
<p class="mce-root"/>
<p style="padding-left: 60px">Here, we can see that how accurately we're predicting each one of the two groups in the training dataset; notice the overall percent correctly predicted. You can even switch to the cell-counts view form the <strong>Style</strong> tab at the bottom.</p>
<ol start="4">
<li>Let's go down a little further and click on the<span> </span>next tab:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-499 image-border" src="assets/2562f170-3aa6-4a33-bd08-7d3ffebad538.png" style="width:45.00em;height:41.42em;"/></p>
<p style="padding-left: 60px">This is showing us the actual neural net model. We are predicting the variable status; we had one hidden layer, and that hidden layer had seven neurons, and this is what we can see here. You can see the connections from each one of the predictors to the neurons in the hidden layer.</p>
<p style="padding-left: 60px"><span>You can also switch the <strong>Style</strong> from <strong>Effects</strong> to <strong>Coefficients</strong>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-653 image-border" src="assets/111fa051-8e9e-41c8-a1a5-122de468bfc4.png" style="width:52.58em;height:48.17em;"/></p>
<p style="padding-left: 60px">The thicker the line, the more important the predictor is in that equation, and you can even see the coefficients.</p>
<ol start="5">
<li>Click the final icon to get this information:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-654 image-border" src="assets/6d271bc8-456c-4e81-be3b-c8bfef4ef586.png" style="width:47.50em;height:43.33em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">This just gives us information in terms of which field was our target and which ones are our predictors.</p>
<p style="padding-left: 60px">Close the window, and now we will see information about our training dataset. To do this, connect the model that we have to the <strong>Table</strong> icon:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-502 image-border" src="assets/7ef1c7ba-b8b0-4988-a473-64aa73f4a78f.png" style="width:67.67em;height:52.75em;"/></p>
<p style="padding-left: 60px">And you can run the Table node:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-657 image-border" src="assets/64661ed0-dfa9-48fe-b6fc-4acfee1cee29.png" style="width:60.75em;height:41.33em;"/></p>
<p>Here, you will have the two new fields, <strong>$N-Status</strong>, the prediction field, and <strong>$NC-Status</strong>, the confidence in that prediction. Here, we have the data for the training as well as the testing dataset.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Analyzing the accuracy of the model</h1>
                </header>
            
            <article>
                
<p>Let's analyze the accuracy of the model:</p>
<ol>
<li>In order to check the accuracy of the overall model, go to the <strong>Output</strong> palette and connect your model to the <strong>Analysis</strong> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-658 image-border" src="assets/3a0be592-d179-4525-8f3e-fdb7548d2232.png" style="width:106.00em;height:69.92em;"/></p>
<ol start="2">
<li>Click on the <strong>An</strong><strong>alysis</strong> node and check the <strong>Coincidence matrices (for symbolic targets)</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-659 image-border" src="assets/3e13b0a0-93f7-4443-adbb-473f407e7196.png" style="width:32.92em;height:36.92em;"/></p>
<p style="padding-left: 60px">The <strong>Coincidence matrices (for symbolic targets)</strong> is checked to give us additional information in terms of the breakdown of how accurate the model was. </p>
<ol start="3">
<li>On clicking <strong>Run</strong>, you can see the overall accuracy in the training and testing dataset:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-661 image-border" src="assets/7f5ae29c-afe6-4b87-82f6-7aa85d3f8adb.png" style="width:33.67em;height:26.75em;"/></p>
<p>Remember we have seen the same accuracy result previously when we saw the model summary, around 79%. There is a slight drop in the accuracy of the testing dataset when compared to the training dataset, but it shouldn't matter much. The difference between the accuracy of both the datasets can be anywhere within 5% for the model to be reliable enough.</p>
<p>Hence, our training and testing data is pretty similar, and this means that we have built a consistent and reliable model that we can trust!</p>
<p>If you look at the <strong>Confidence Matrix for $N-Status</strong> part of the analysis, you can see that in the training dataset, we correctly predicted <strong>790</strong> people that are <strong>Churned</strong> and <strong>1,146</strong> people that are current customers. In the testing dataset, we correctly predicted <strong>745</strong> people who are <strong>Churned</strong>, and <strong>1,231</strong> people who are current customers.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Model performance on testing partition</h1>
                </header>
            
            <article>
                
<p>Since we will running a Neural Net model multiple times, it is a good idea to create a couple of tables that show what was found:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-662 image-border" src="assets/e87496ed-bddf-4a4b-bd8e-5ab6a9dc266a.png" style="width:28.50em;height:2.67em;"/></p>
<p>You can also create a table of the top 10 predictors that are based on the seed that you used in the model:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-663 image-border" src="assets/9487f71f-b03c-4fb5-84b1-34d0b050193a.png" style="width:9.08em;height:14.92em;"/></p>
<p class="mce-root">To evaluate the performance of your model, you can rerun the model in the same way as we have done until now multiple times and check the accuracy of the model each time you run it. You can even run it with a different seed and a different starting point. Therefore, the results obtained will be slightly different but fairly similar. As you know, we rerun the model multiple times to find the best possible solution.</p>
<p>To check the consistency in the results, you can keep expanding your model performance table in this manner each time you rerun the model:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-664 image-border" src="assets/de529e94-4429-4fbb-8bf1-f6768178338f.png" style="width:25.75em;height:7.42em;"/></p>
<p>Out of these models, you can choose the model that makes the most sense. For example, as you can see, the last entry with the seed of 5000 has the highest overall accuracy. It also has the highest number of accuracy in predicting churned customers. But it has the lowest accuracy in predicting the current customers. Hence, you can identify which solution is the most important for you and choose your best model accordingly.</p>
<p>The top 10 predictors for every rerun will also change with slight changes in the results. You can document the top 10 predictors each time you run the model and expand the top 10 predictors table that you created earlier:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-627 image-border" src="assets/c712f3c3-6aa1-4248-a4b3-5585480e7b9f.png" style="width:43.33em;height:14.58em;"/></p>
<p>As you can see, many predictors continue to be the most important, such as the premier predictor, whereas there are some predictors that appear only once or twice—for example, the <strong>Number employees</strong> predictor. These kinds of tables with a list of top 10 predictors can also help you to select the model that you need. You can also use this information to create a new version of a model where you don't want to use the predictors that you used initially but want to use only the predictors that either appear as the most common predictors in terms of the top ten or any predictor that appeared in the top ten.</p>
<p>Because we are already reducing the number of predictors, this would not only simplify the understanding of the model but also, ultimately, would end up creating a simpler model than in some cases, and this can actually be more accurate because you're getting rid of the extra noise that some of those other predictors might bring in. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Support Vector Machines</h1>
                </header>
            
            <article>
                
<p><strong>Support Vector Machines </strong>(<strong>SVMs</strong>) models were built to predict categorical and continuous outcomes and are especially good when you have many predictors. They were developed for difficult predicting situations where linear models were unable to separate the categories of the outcome field. <span>They too work like black boxes, hiding their complex work in predicting results. Let's get an insight into how SVMs work.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with Support Vector Machines</h1>
                </header>
            
            <article>
                
<p>Suppose, for example, there is a kind of data that cannot be separated using a single line as shown in this diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-665 image-border" src="assets/e346474e-c64a-418f-90a0-1627031e37fe.png" style="width:21.75em;height:16.42em;"/></p>
<p>Consider these shapes to be different types of data. As you can see, we won't be able to separate a cluster of data by just drawing a single line between them. But the same job of differentiating can be done easily if a complex curve, such as a circle, is drawn instead of a line, just as in the diagram.</p>
<p>The main task of an SVM is to transform original data from this complex space to another space where the function that separates the data points is much simpler. This task is known as the <strong>kernel transformation</strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Kernel transformation</h1>
                </header>
            
            <article>
                
<p>The <strong>kernel function</strong> is a mathematical function that transforms the data. The reason why it's called an <strong>SVM</strong> is that the vectors form the boundaries between different groups of data, as shown in this diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-666 image-border" src="assets/ff159c75-3537-4b39-946d-71e10bf54976.png" style="width:21.58em;height:16.33em;"/></p>
<p>Hence, we have placed circles below and the squares above, and the boundaries are the vectors. These vector boundaries are separating the two groups. Vectors are the cases that act like boundaries between groups.</p>
<p>Hence, at this point, we can have several solutions:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-667 image-border" src="assets/e79c6d30-37ee-4360-8550-06d2ea8b8289.png" style="width:21.17em;height:16.00em;"/></p>
<p>This shows that we no longer need a circle or complex curves to separate the groups of data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">But what is the best solution?</h1>
                </header>
            
            <article>
                
<p>We ultimately need to find the best solution. The best solution will be the one that will maximize the separation between the groups while balancing the trade-off of potentially overfitting the function on new data. This new data includes a weight factor or a regularization factor that adds a penalty to the function to maximize the margin between the vectors while minimizing the error, as shown in the following diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-668 image-border" src="assets/b03c20aa-d4e3-4339-b14a-8c1cf6e0c782.png" style="width:24.75em;height:18.75em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Types of kernel functions</h1>
                </header>
            
            <article>
                
<p>In <strong>SPSS Modeler</strong>, there are four different types of kernel functions:</p>
<ul>
<li><strong>Linear</strong>: A simple function that works well with few nonlinear relationships</li>
<li><strong>Polynomial</strong>: A more complex function that works well with some nonlinear relationships</li>
<li><strong>RBF (Radial Basis Function)</strong>: Similar to an RNN neural network that works well with nonlinear relationships</li>
<li><strong>Sigmoid</strong>: Similar to a two-layer neural network that works well with nonlinear relationships</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Demonstrating SVMs</h1>
                </header>
            
            <article>
                
<p>In this section, we will run an SVM model and see how it works.</p>
<p>First of all, get your dataset just the way you did for neural networks, partition the dataset into a training and testing dataset, and create a scenario such as this:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-669 image-border" src="assets/b74f1a49-9340-4bc8-ba4b-79a31b864424.png" style="width:51.42em;height:31.00em;"/></p>
<p>Let's see how to run SVMs:</p>
<ol>
<li>Go to the <strong>Modeling</strong> palette and connect the partition node to <strong>SVM</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-670 image-border" src="assets/745cb57d-3b91-4c9d-be9d-b3d023c729b6.png" style="width:56.00em;height:37.17em;"/></p>
<ol start="2">
<li>Go to the <strong>Expert</strong> tab and select the <strong>Expert</strong> option in <strong>Mode</strong>. Remember, whenever you run an <strong>SVM</strong> model, you must always run it in <strong>Expert</strong> mode because this is a model that requires constant changes on the default values based on the status of your model. The <strong>Expert</strong> mode will enable us to change the values easily when required:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-218 image-border" src="assets/de507e6a-245e-4529-bdb2-e7ef597d2704.png" style="width:36.50em;height:29.17em;"/></p>
<p style="padding-left: 60px">Let's discuss these options in detail:</p>
<ul>
<li style="list-style-type: none">
<ul>
<li>You can tick the <strong>Append all probabilities</strong> box when you have categorical outcomes. But, for now, let's keep it on default.</li>
<li>The stopping criteria can also be changed, though you don't need to modify it that often.</li>
<li>The regularization parameter is set to <kbd>10</kbd> by default, and you can select any values from <kbd>2</kbd> to <kbd>10</kbd>. The higher the value of the regularization parameter, the more overfitting is done on your model and it is more likely to get better results on the training dataset, but on the testing dataset, the results could drop off. Hence, let's change the regularization parameter value to <kbd>5</kbd>, because it is a middle value that will give us a consistent model that works well for both the training as well as the testing dataset. And if you get a consistent model at value <kbd>5</kbd>, you can increase this to <kbd>7</kbd>, to overfit the model just a little better, to get slightly better results. If you don't get consistent results at a value set to <kbd>5</kbd>, then we can reduce this to <kbd>3</kbd> or so to try to overfit less. Hence, we will need to modify the regularization parameter based on our results.</li>
<li>The regression precision parameter or epsilon is a pretty low value that is meant for errors. We want our errors to be lower than the value that is set in this field. This parameter only works when there is a continuous outcome field, which is not the case for our dataset.</li>
<li>There are four types of kernel transformations that we have seen; linear is the simplest one, and we will start off with it. We can first test the model with a linear transformation, and if it does well, we can increase the complexity by selecting any other kind of transformation.</li>
</ul>
</li>
</ul>
<p style="padding-left: 60px">Here is a summary of the values that we have selected for the <strong>Expert</strong> tab:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/54e27845-827c-45e3-ac63-6777689f6adf.png" style="width:32.42em;height:27.33em;"/></p>
<ol start="3">
<li class="CDPAlignLeft CDPAlign">Click on the <strong>Analyze</strong> tab. Let's see what this tab includes:</li>
</ol>
<ul>
<li style="list-style-type: none">
<ul>
<li class="CDPAlignLeft CDPAlign">We can calculate the propensity scores for this model; we will talk about this in later chapters.</li>
<li class="CDPAlignLeft CDPAlign">The predictor importance can also be calculated. Here, for SVMs, this is not checked by default. The reason being that SVMs take a fairly long time to build the model if you select this option to calculate the predictor importance. You will run this model multiple times and change a lot of the parameters in the meantime. And finally when you find your best solution, or your ideal model, you will rerun the model, and that will be the time when you can check the option of calculating predictor importance. This will save a lot of time.</li>
</ul>
</li>
</ul>
<ol start="4">
<li>Click on <strong>Run</strong>. You will see a model built like this:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-672 image-border" src="assets/9af08443-8017-417e-937b-1caec8688866.png" style="width:106.92em;height:56.17em;"/></p>
<ol start="5">
<li class="CDPAlignLeft CDPAlign">Now, connect the generated model to the table to see the results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-673 image-border" src="assets/baab8f4d-b79a-4ccb-a25a-ce30d5a4edfb.png" style="width:106.58em;height:56.08em;"/></p>
<p class="mce-root"/>
<ol start="6">
<li>Click on <strong>Table</strong> and then click <strong>Run</strong>. If you scroll to the end, you will find predictions under <strong>$S-Status</strong> and <strong>$SP-Status</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-674 image-border" src="assets/59c06026-fa7e-455e-952b-e83ee8a79ebd.png" style="width:55.58em;height:37.83em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">You can also see that we have got results for both the training and testing datasets, even though the model was built on the testing dataset.</p>
<ol start="7">
<li>You can now close the table's window, and click on the model, <strong>Status</strong>, to check the summary and model settings. Click on <strong>OK</strong>.</li>
</ol>
<p>The model is currently like a black box. We don't know how we got the results and how it predicted the values. Let's find out.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Interpreting the results</h1>
                </header>
            
            <article>
                
<p>Just as we did with the neural nets model, we will check the accuracy of the model that we have built. For this, select <strong>Status</strong> and go to the <strong>Output</strong> palette and select <strong>Analyze</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-675 image-border" src="assets/27dd6ef2-3b19-49c0-ae31-371b2982c0a6.png" style="width:55.75em;height:38.75em;"/></p>
<p class="mce-root"/>
<p>Click on <strong>Analysis</strong>, and as we have done before for the neural nets, click on <strong>Coincidence matrices (for symbolic targets)</strong> and click on <strong>Run</strong>; you will get this:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-676 image-border" src="assets/0872da9a-0377-41d2-a31c-244f0b091d70.png" style="width:36.92em;height:30.33em;"/></p>
<p>Hence, we have a very consistent model, currently!</p>
<p>Again, let's document the results in a table such as this one:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-677 image-border" src="assets/982a2560-30ea-40b4-9d6e-9a21303682b0.png" style="width:38.25em;height:2.83em;"/></p>
<p>As you can see, in addition to the table made for neural nets, we have a type of model that we have used and even the regularization parameter value with which this was obtained. We have got a very consistent model, using the kernel transformation type as linear and the regularization parameter value set to <strong>5</strong>. But this also means that we can try with a slightly better value of the regularization parameter and see whether we can get a better solution. Let's move on to finding a better solution.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Trying additional solutions</h1>
                </header>
            
            <article>
                
<p>Go back to the <strong>SVM</strong> model, <strong>Status</strong>, and click on the <strong>Expert</strong> tab. You can change the regularization parameter to something higher, as the model was consistent at <kbd>5</kbd>; consider this an exercise. But, instead, we will change the <strong>Kernel type</strong> for our next run to the most complex <strong>Sigmoid</strong> type. It is not recommended to change the <strong>Bias</strong> value. But you can change <span><strong>Gamma</strong> </span>for better results, and you can experiment on those values later. For now, we will keep them on default, and click on <strong>Run</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-515 image-border" src="assets/3dc04c94-1591-4578-a094-ba78f1aff532.png" style="width:36.42em;height:30.42em;"/></p>
<p>Click on the <strong>Analyze</strong> tab, and then click on <strong>Run</strong>. Here is our result:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-678 image-border" src="assets/49d9a7a6-c3f3-469a-9a1b-3f8f6d47bee5.png" style="width:35.67em;height:29.67em;"/></p>
<p>The model is consistent, but as you can see, the accuracy percentage is significantly lower than what we found in our linear model. Hence, this model has not done a better job compared to what the linear model did. This means that the Sigmoid type didn't work well.</p>
<p>This brings us to the conclusion that the best type of kernel transformation suited for our dataset is the most simple, linear transformation. Because the data is also not really that complex either. But, you must rerun the model multiple times to verify your results.</p>
<p>Here is my analysis from the models that I ran:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-679 image-border" src="assets/bfa784d9-3657-49f2-bf82-b78310c8b1cd.png" style="width:34.33em;height:6.42em;"/></p>
<p>You can now see which type of kernel transformation worked in which manner with each of the predictors. You can select predictors that are important to you and select that as the best model. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we saw how to work with neural network models. Then we moved on to cover SVM models and demonstrated how SVM works. We have seen how to work with different types of kernel transformations.</p>
<p>In the next chapter, we will look at machine learning models in more detail.</p>


            </article>

            
        </section>
    </body></html>