<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">R Fundamentals for Machine Learning</h1>
                </header>
            
            <article>
                
<p>You're probably used to hearing words such as big data, machine learning, and artificial intelligence in the news. It's amazing how many new applications of these terms appear every day. Recommender systems such as the ones used by Amazon, Netflix, search engines, stock market analysis, or even for speech recognition are only a few examples. Different new algorithms and new techniques emerge every year, and many of them are based on previous approaches or combine different existing algorithms. At the same time, there are more and more tutorials and courses focused on teaching them. </p>
<p>Many courses have a number of common limitations such as solving <em>toy</em> problems or focusing all of their attention on algorithms. These limitations could mean that you obtain an incorrect understanding of the data modeling approach. Thus, the modeling process entails important steps before, as business and data understanding, and data preparation. Without these previous steps, it isn't guaranteed that the model will be applied without flaws in the future. Furthermore, model development does not finish after finding an appropriate algorithm. The performance evaluation of the model, its interpretability, and the model's deployment are also very relevant and the culmination of the modeling process.</p>
<p>In this book, we will learn how to develop different predictive models. The applications or examples included in this book have been based on the financial sector, and will also try to create a theoretical framework that helps you understand the causes of the financial crisis, which had a dramatic impact on countries around the world. </p>
<p>All of the algorithms and techniques that are used in this book will be applied using the R language. Nowadays, R is one of the major languages for data science. There is an enormous debate about which language is better, R or Python. Both languages have many strengths and some weakness as well.</p>
<p>In my experience, R is more powerful for the analysis of financial data. I've found many R libraries that specialize in this field, but not so many in Python. Nevertheless, credit risk and financial information is very much related to the treatment of time series, which, at least in my opinion, performs better in Python. The use of recurrent or <strong>Long Short-Term Memory</strong> (<strong>LSTM</strong>) networks are better implemented in Python as well. However, R provides more powerful libraries for data visualization and interactive style. It is recommended that you use both R and Python interchangeably, depending on your project. Good resources on machine learning with Python are available at Packt, some of which are listed here for your convenience:</p>
<ul>
<li><em>Python Machine Learning – Second Edition,</em> <a href="https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition"/><a href="https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition">https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition<br/></a></li>
<li><em>Hands-On Data Science and Python Machine Learning,</em> <a href="https://www.packtpub.com/big-data-and-business-intelligence/hands-data-science-and-python-machine-learning">https://www.packtpub.com/big-data-and-business-intelligence/hands-data-science-and-python-machine-learning</a></li>
<li><em>Python Machine Learning By Example</em>, <a href="https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-example">https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-example</a></li>
</ul>
<p class="mce-root">In this chapter, let's revive your knowledge on machine learning and get you started with coding using R.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>R and RStudio installation</li>
<li>Some basics commands</li>
<li>Objects, special cases, and basic operators in R</li>
<li>Controlling code flow</li>
<li>All about R packages</li>
<li>Taking further steps</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R and RStudio installation</h1>
                </header>
            
            <article>
                
<p>Let's first start with installing R. It is totally free and can be downloaded from <a href="https://cloud.r-project.org/">https://cloud.r-project.org/</a><span>. </span>Installing R is an easy task. </p>
<p>Let's look at the steps to install R on a Windows PC. For installing it on other operating systems, the steps are straightforward and are available at the same <a href="https://cloud.r-project.org/">https://cloud.r-project.org/</a> link.</p>
<p>Let's start by installing R on a Windows system:</p>
<ol>
<li>Visit <a href="https://cloud.r-project.org/">https://cloud.r-project.org/</a>.<a href="https://cloud.r-project.org/"/></li>
<li>Look for <span class="packt_screen">Download and Install R</span> and select your operating system. We are installing for Windows, so select the Windows link.</li>
<li>Go to <span class="packt_screen">Subdirectories</span> and click on <span class="packt_screen">base</span>.</li>
<li>You will be redirected to a page that shows download R <em>X</em>.<em>X</em>.<em>X</em> for Windows. At the time of writing this book, <span class="packt_screen">Download R 3.5.2 for Windows</span> is the version that you need to click on.</li>
<li>Save and run the .<span><span>exe</span></span> file.</li>
<li>You can now select the setup language to install R.</li>
<li>A setup wizard will open and you can go on clicking <span class="packt_screen">Next</span> until you reach <span class="packt_screen">Select Destination Location</span>.</li>
<li>Select your preferred location and click <span class="packt_screen">Next</span>.</li>
<li>Click the <span class="packt_screen">Next</span> button several more times until R starts to install.</li>
<li>After the installation is complete, R will notify you with the message <span class="packt_screen">Completing the R for Windows 3.5.2 Setup Wizard</span>. You can now click on <span class="packt_screen">Finish</span>.</li>
<li>You can find the R shortcut on your desktop and double-click on it to start R.</li>
<li>Like any other application, in case you can't find R on your desktop, you can go to the Start button, <span class="packt_screen">All Programs</span>, and look for R and start it.</li>
<li>You will get a screen similar to what's shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-675 image-border" src="assets/8d96dd67-16c3-456d-8c66-dde0e17c4fb6.png" style=""/></div>
<p>This is the R Command Prompt, waiting for input.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Things to know about R</h1>
                </header>
            
            <article>
                
<p>Before moving on to typing in commands, you must know that R is a case-sensitive and interpreted language. </p>
<p>You can choose between manually entering commands and running a set of commands from the source file as per your will. R provides a lot of built-in functions that give most functionalities to the user. As a user, you can even create user-created functions.</p>
<p>You can even create and manipulate objects. You might know that objects are anything that can have an assigned value. An interactive session will require all objects to be present in the memory while the execution process is running, whereas the functions can be placed in the packages that have a reference in the current program and can be accessed as and when needed.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using RStudio</h1>
                </header>
            
            <article>
                
<p>Alongside using R, it is recommended to use RStudio. RStudio is an <strong>integrated development environment</strong> (<strong>IDE</strong>) that, like any other IDE, enhances your interaction with R.</p>
<p>RStudio provides you with a very well-organized interface that can clearly represent graphs, data tables, R code, and output simultaneously.</p>
<p>Moreover, to import and export files in different formats into R without having to write code, R offers an import wizard like feature.</p>
<p>Having seen the standard R GUI interface, you will see the similarities with RStudio, but the difference is that RStudio is very intuitive and user-friendly compared to the R GUI. You will have many options to choose from the menu, and you can even customize the GUI according to your requirements. RStudio for desktop is available at <a href="https://www.rstudio.com/products/rstudio/download/#download">https://www.rstudio.com/products/rstudio/download/#download</a>.<a href="https://www.rstudio.com/products/rstudio/download/#download"/></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">RStudio installation </h1>
                </header>
            
            <article>
                
<p>The installation steps are very similar to the installation of R, so it isn't necessary to describe the detailed steps.</p>
<p>The first time you open RStudio, you will see three different windows. You can enable a fourth window by going to <span class="packt_screen">File</span>, <span class="packt_screen">New File</span>, and selecting <span class="packt_screen">R Script</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-676 image-border" src="assets/5b657076-3e88-4477-afa2-09e52050580a.png" style=""/></div>
<p>On the upper-left side window, scripts can be written and then saved and executed. The window that follows, on the left, represents the <span class="packt_screen">Console</span>, where codes in R can directly be executed.</p>
<p>The upper-right window allows for the visualization of variables and objects that have been defined in the workspace. Furthermore, it is possible to see the history of commands that were previously executed. Finally, the bottom-right window displays the working directory.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Some basic commands</h1>
                </header>
            
            <article>
                
<p>Here a list of useful commands to start with R and RStudio:</p>
<ul>
<li><kbd>help.start()</kbd>: Starts the HTML version of R documentation</li>
<li><kbd>help(command)</kbd>/<kbd>??command</kbd>/<kbd>help.search(command)</kbd>: Displays the help related to a specific command</li>
<li><kbd>demo()</kbd>: A user-friendly interface that runs some demonstrations of R scripts</li>
<li><kbd>library(help=package)</kbd>: Lists functions and datasets in a package</li>
<li><kbd>getwd()</kbd>: Prints the directory that is currently active and working</li>
<li><kbd>ls()</kbd>: Lists the objects that are used in the current session</li>
<li><kbd>setwd(mydirectory)</kbd>: Changes the working directory to <kbd>mydirectory</kbd></li>
<li><kbd>options()</kbd>: Displays current settings in the options</li>
<li><kbd>options(digits=5)</kbd>: You can print the specified digit as output</li>
<li><kbd>history()</kbd>: Displays previous commands until the limit of 25</li>
<li><kbd>history(max.show=Inf)</kbd>: Displays all commands, irrespective of the limit</li>
<li><kbd>savehistory(file=“myfile”)</kbd>: Saves the history (default file is a <kbd>.Rhistory</kbd> file)</li>
<li><kbd>loadhistory(file=“myfile”)</kbd>: Recalls your command history</li>
<li><kbd>save.image()</kbd>: Saves the current workspace to the <kbd>.RData</kbd> file that's present in that particular working directory</li>
<li><kbd>save(object list,file=“myfile.RData”)</kbd>: Saves objects into a specified file</li>
<li><kbd>load(“myfile.RData”)</kbd>: Loads a specific object from a specified file</li>
<li><kbd>q()</kbd>: This will quit R for you with a prompt to save the current workspace</li>
<li><kbd>library(package)</kbd>: Loads a library that's specific to a project</li>
<li><kbd>install.package(package)</kbd>: Downloads and installs packages from CRAN-like repositories or even from local files</li>
<li><kbd>rm(object1, object2…)</kbd>: Removes objects</li>
</ul>
<p>To execute a command in RStudio, it should be written in the console, and then you must press <em>Enter</em>.</p>
<p>In RStudio, it is possible to create interactive documents by combining lines of code and plain text. R Notebooks will be helpful in interacting with R directly, and so we can have a publishing-quality document produced as output when we use it.</p>
<p>To create a new notebook in RStudio, go to <span class="packt_screen">File</span>, <span class="packt_screen">New File</span>, and <span class="packt_screen">R Notebook</span>. The default notebook will open, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-677 image-border" src="assets/6c776b49-1538-4fcc-813e-5060fea742d9.png" style=""/></div>
<p>This notebook is a plain text file that has the <kbd>.rmd</kbd> extension. A file contains three types of content:</p>
<ul>
<li>An (optional) YAML header <span>surrounded by <span class="packt_screen">---</span> lines</span></li>
<li>R code chunks surrounded by <span class="packt_screen">```r</span></li>
<li>Text mixed with simple text formatting</li>
</ul>
<p>R code chunks allow for the execution of code and display the results in the same notebook. To execute a chunk, click the run button within the chunk or place the cursor inside it and press <em>Ctrl</em> + <em>Shift</em> + <em>Enter</em>. If you wish to insert a chunk button on the toolbar, press <em>Ctrl</em> + <em>Alt</em> + <em>I</em>.</p>
<p>While saving the current notebook, a code and output file in HTML format will be generated and will be saved with the notebook. To see what the HTML file looks like, you can either click the <span class="packt_screen">Preview</span> button or you can use the shortcut <em>Ctrl</em> + <em>Shift</em> + <em>K</em>. You can find and download all the code of this book as a R Notebook, where you can execute all the code without writing it directly.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Objects, special cases, and basic operators in R</h1>
                </header>
            
            <article>
                
<p>By now, you will have figured out that R is an object-oriented language. All our variables, data, and functions will be stored in the active memory of the computer as <strong>objects</strong>. These objects can be modified using different operators or functions. An object in R has two attributes, namely, mode and length.</p>
<p>Mode includes the basic type of elements and has four options:</p>
<ul>
<li><strong>Numeric</strong>: These are decimal numbers</li>
<li><strong>Character</strong>: R<span>epresents sequences of string values</span></li>
<li><strong>Complex</strong>: Combination of real and imaginary numbers, for example, <em>x+ai</em></li>
<li><strong>Logical</strong>: Either true (<kbd>1</kbd>) or false (<kbd>0</kbd>)</li>
</ul>
<p>Length means the number of elements in an object.</p>
<p>In most cases, we need not care whether or not the elements of a numerical object are integers, reals, or even complexes. Calculations will be carried out internally as numbers of double precision, real, or complex, depending on the case. To work with complex numbers, we must indicate explicitly the complex part.</p>
<p>In case an element or value is unavailable, we assign <kbd>NA</kbd>, a special value. Usually, operations with <kbd>NA</kbd> elements result in <kbd>NA</kbd> unless we are using some functions that can treat missing values in some way or omit them. Sometimes, calculations can lead to answers with a positive or negative infinite value (represented by R as <kbd>Inf</kbd> or <kbd>-Inf</kbd>, respectively). On the other hand, certain calculations lead to expressions that are not numbers represented by R as <strong>NaN</strong> (short for <strong>not a number</strong>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with objects</h1>
                </header>
            
            <article>
                
<p>You can create an object using the <kbd>&lt;-</kbd> operator:</p>
<pre>n&lt;-10<br/>n<br/>## [1] 10</pre>
<p>In the preceding code, an object called <kbd>n</kbd> is created. A value of <kbd>10</kbd> has been assigned to this object. The assignment can also be made using the <kbd>assign()</kbd> function, although this isn't very common.</p>
<p class="mce-root"/>
<p>Once the object has been created, it is possible to perform operations on it, like in any other programming language:</p>
<pre>n+5<br/>## [1] 15</pre>
<p>These are some examples of basic operations.</p>
<p>Let's create our variables:</p>
<pre>x&lt;-4<br/>y&lt;-3</pre>
<p>Now, we can carry out some basic operations:</p>
<ul>
<li>Sum of variables:</li>
</ul>
<pre style="padding-left: 60px">x + y<br/>## [1] 7</pre>
<ul>
<li>Subtraction of variables:</li>
</ul>
<pre style="padding-left: 60px">x - y<br/>## [1] 1</pre>
<ul>
<li>Multiplication of variables:</li>
</ul>
<pre style="padding-left: 60px">x * y<br/>## [1] 12</pre>
<ul>
<li>Division of variables:</li>
</ul>
<pre style="padding-left: 60px">x / y<br/>## [1] 1.333333</pre>
<ul>
<li>Power of variables:</li>
</ul>
<pre style="padding-left: 60px">x ** y<br/>## [1] 64</pre>
<p>Likewise in R, there are defined constants that are widely used, such as the following ones:</p>
<ul>
<li>The <kbd>pi</kbd> (<img src="assets/1c55b6c3-6e8a-4301-8712-eeb3045f364c.png" style="width:0.75em;height:0.83em;"/>) number :</li>
</ul>
<pre style="padding-left: 60px">x * pi<br/>## [1] 12.56637</pre>
<ul>
<li>Exponential function:</li>
</ul>
<pre style="padding-left: 60px">exp(y)<br/>## [1] 20.08554</pre>
<p>There are also functions for working with numbers, such as the following:</p>
<ul>
<li>Sign (positive or negative of a number):</li>
</ul>
<pre style="padding-left: 60px">sign(y)<br/>## [1] 1</pre>
<ul>
<li>Finding the maximum value:</li>
</ul>
<pre style="padding-left: 60px">max(x,y)<br/>## [1] 4</pre>
<ul>
<li>Finding the minimum value:</li>
</ul>
<pre style="padding-left: 60px">min(x,y)<br/>## [1] 3</pre>
<ul>
<li>Factorial of a number:</li>
</ul>
<pre style="padding-left: 60px">factorial(y)<br/>## [1] 6</pre>
<ul>
<li>Square root function:</li>
</ul>
<pre style="padding-left: 60px">sqrt(y)<br/>## [1] 1.732051</pre>
<p>It is also possible to assign the result of previous operations to another object. For example, the sum of variables <kbd>x</kbd> and <kbd>y</kbd> is assigned to an object named <kbd>z</kbd>:</p>
<pre>z &lt;- x + y<br/>z<br/>## [1] 7</pre>
<p>As shown previously, these functions apply if the variables are numbers, but there are also other operators to work with strings:</p>
<pre>x &gt; y<br/>## [1] TRUE<br/>x + y != 8<br/>## [1] TRUE</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The main logical operators are summarized in the following table:</p>
<table border="1" style="border-collapse: collapse;width: 59.6556%">
<tbody>
<tr>
<td class="CDPAlignLeft CDPAlign" style="width: 10%"><strong>Operator</strong></td>
<td class="CDPAlignLeft CDPAlign" style="width: 10%"><strong>Description</strong></td>
</tr>
<tr>
<td style="width: 10%">&lt;</td>
<td style="width: 10%">Less than</td>
</tr>
<tr>
<td style="width: 10%">&lt;=</td>
<td style="width: 10%">Less than or equal to</td>
</tr>
<tr>
<td style="width: 10%">&gt;</td>
<td style="width: 10%">Greater than</td>
</tr>
<tr>
<td style="width: 10%">&gt;= </td>
<td style="width: 10%">Greater than or equal to</td>
</tr>
<tr>
<td style="width: 10%">==</td>
<td style="width: 10%">Equal to</td>
</tr>
<tr>
<td style="width: 10%">!=</td>
<td style="width: 10%">Not equal to</td>
</tr>
<tr>
<td style="width: 10%">!x</td>
<td style="width: 10%">Not <em>x</em></td>
</tr>
<tr>
<td style="width: 10%">x</td>
<td style="width: 10%"><em>y</em></td>
</tr>
<tr>
<td style="width: 10%">x &amp; y</td>
<td style="width: 10%"><em>x</em> and <em>y</em></td>
</tr>
<tr>
<td style="width: 10%">isTRUE(x)</td>
<td style="width: 10%">Test if <em>x</em> is TRUE</td>
</tr>
</tbody>
</table>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with vectors</h1>
                </header>
            
            <article>
                
<p class="mce-root">A <strong>vector</strong> is one of the basic data structures in R. It contains only similar elements, like strings and numbers, and it can have data types such as logical, double, integer, complex, character, or raw. Let's see how vectors work.</p>
<p class="mce-root">Let's create some vectors by using <kbd>c()</kbd>:</p>
<pre>a&lt;-c(1,3,5,8)<br/>a<br/>## [1] 1 3 5 8</pre>
<p>On mixing different objects with vector elements, there is a transformation of the elements so that they belong to the same class:</p>
<pre>y &lt;- c(1,3)<br/>class(y)<br/>## [1] "numeric"</pre>
<p>When we apply commands and functions to a vector variable, they are also applied to every element in the vector:</p>
<pre>y &lt;- c(1,5,1)<br/>y + 3<br/>## [1] 4 8 4</pre>
<p>You can use the <kbd>:</kbd> operator if you wish to create a vector of consecutive numbers:</p>
<pre>c(1:10)<br/>##  [1]  1  2  3  4  5  6  7  8  9 10</pre>
<p>Do you need to create more complex vectors? Then use the <kbd>seq()</kbd> function. You can create vectors as complex as number of points in an interval or even to find out the step size that we might need in machine learning:</p>
<pre>seq(1, 5, by=0.1)<br/>##  [1] 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6<br/>## [18] 2.7 2.8 2.9 3.0 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2 4.3<br/>## [35] 4.4 4.5 4.6 4.7 4.8 4.9 5.0<br/>seq(1, 5, length.out=22)<br/>##  [1] 1.000000 1.190476 1.380952 1.571429 1.761905 1.952381 2.142857<br/>##  [8] 2.333333 2.523810 2.714286 2.904762 3.095238 3.285714 3.476190<br/>## [15] 3.666667 3.857143 4.047619 4.238095 4.428571 4.619048 4.809524<br/>## [22] 5.000000</pre>
<p>The <kbd>rep()</kbd> function is used to repeat the value of <em>x</em>, <em>n</em> number of times:</p>
<pre>rep(3,20)<br/>##  [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Vector indexing</h1>
                </header>
            
            <article>
                
<p>Elements of a vector can be arranged in several haphazard ways, which can make it difficult to access them when needed. Hence, indexing makes it easier to access the elements.</p>
<p>You can have any type of index vectors, from logical, integer, and character.</p>
<p>Vector of integers starting from 1 can be used to specify elements in a vector, and it is also possible to use negative values.</p>
<p>Let's see some examples of indexing:</p>
<ul>
<li>Returns the <em>n</em>th element of <em>x</em>:</li>
</ul>
<pre style="padding-left: 60px">x &lt;- c(9,8,1,5)</pre>
<ul>
<li>Returns all <em>x</em> values except the <em>n</em>th element:</li>
</ul>
<pre style="padding-left: 60px">x[-3]<br/>## [1] 9 8 5</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<ul>
<li>Returns values between <em>a</em> and <em>b</em>:</li>
</ul>
<pre style="padding-left: 60px">x[1:2]<br/>## [1] 9 8</pre>
<ul>
<li>Returns items that are greater than <em>a</em> and less than <em>b</em>:</li>
</ul>
<pre style="padding-left: 60px">x[x&gt;0 &amp; x&lt;4]<br/>## [1] 1</pre>
<p>Moreover, you can even use a logical vector. In this case, either <kbd>TRUE</kbd> or <kbd>FALSE</kbd> will be returned if an element is present at that position:</p>
<pre>x[c(TRUE, FALSE, FALSE, TRUE)]<br/>## [1] 9 5</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions on vectors</h1>
                </header>
            
            <article>
                
<p>In addition to the functions and operators that we've seen for numerical values, there are some specific functions for vectors, such as the following:</p>
<ul>
<li>Sum of the elements present in a vector:</li>
</ul>
<pre style="padding-left: 60px">sum(x)<br/>## [1] 23</pre>
<ul>
<li>Product of elements in a vector:</li>
</ul>
<pre style="padding-left: 60px">prod(x)<br/>## [1] 360</pre>
<ul>
<li>Length of a vector:</li>
</ul>
<pre style="padding-left: 60px">length(x)<br/>## [1] 4</pre>
<ul>
<li>Modifying a vector using the <kbd>&lt;-</kbd> operator:</li>
</ul>
<pre style="padding-left: 60px">x<br/>## [1] 9 8 1 5<br/>x[1]&lt;-22<br/>x<br/>## [1] 22 8 1 5</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Factor</h1>
                </header>
            
            <article>
                
<p>A vector of strings of a character is known as a <strong>factor</strong>. It is used to represent categorical data, and may also include the different levels of the categorical variable. Factors are created with the <kbd>factor</kbd> command:</p>
<pre>r&lt;-c(1,4,7,9,8,1)<br/>r&lt;-factor(r)<br/>r<br/>## [1] 1 4 7 9 8 1<br/>## Levels: 1 4 7 8 9</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Factor levels</h1>
                </header>
            
            <article>
                
<p><strong>Levels</strong> are possible values that a variable can take. Suppose the original value of 1 is repeated; it will appear only once in the levels.</p>
<p>Factors can either be numeric or character variables, but levels of a factor can only be characters.</p>
<p>Let's run the <kbd>level</kbd> command:</p>
<pre>levels(r)<br/>## [1] "1" "4" "7" "8" "9"</pre>
<p>As you can see, <kbd>1</kbd>, <kbd>4</kbd>, <kbd>7</kbd>, <kbd>8</kbd>, and <kbd>9</kbd> are the possible levels that the level <kbd>r</kbd> can have.</p>
<p>The <kbd>exclude</kbd> <span><span>parameter</span></span> allows you to exclude levels of a custom factor:</p>
<pre>factor(r, exclude=4)<br/>## [1] 1    &lt;NA&gt; 7    9    8    1  <br/>## Levels: 1 7 8 9</pre>
<p>Finally, let's find out if our factor values are ordered or unordered:</p>
<pre>a&lt;- c(1,2,7,7,1,2,2,7,1,7)<br/>a&lt;- factor(a, levels=c(1,2,7), ordered=TRUE)<br/>a<br/>##  [1] 1 2 7 7 1 2 2 7 1 7<br/>## Levels: 1 &lt; 2 &lt; 7</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Strings</h1>
                </header>
            
            <article>
                
<p>Any value that is written in single or double quotes will be considered a <strong>string</strong>:</p>
<pre>c&lt;-"This is our first string"<br/>c<br/>## [1] "This is our first string"<br/>class(c)<br/>## [1] "character"</pre>
<div class="packt_infobox">When I say single quotes are allowed, please know that even if you specify the string in single quotes, R will always store them as double quotes.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">String functions</h1>
                </header>
            
            <article>
                
<p>Let's see how we can transform or convert strings using R.</p>
<p>The most relevant string examples are as follows:</p>
<ul>
<li>To know the number of characters in a string:</li>
</ul>
<pre style="padding-left: 60px">nchar(c)<br/>## [1] 24</pre>
<ul>
<li>To return the substring of <em>x</em>, originating at a particular character in <em>x</em>:</li>
</ul>
<pre style="padding-left: 60px">substring(c,4)<br/>## [1] "s is our first string"</pre>
<ul>
<li>To return the substring of <em>x</em> originating at one character located at <em>n</em> and ending at another character located at a place, <em>m</em>:</li>
</ul>
<pre style="padding-left: 60px">substring(c,1,4)<br/>## [1] "This"</pre>
<ul>
<li>To divide the string <em>x</em> into a list of sub chains using the delimiter as a separator:</li>
</ul>
<pre style="padding-left: 60px">strsplit(c, " ")<br/>## [[1]]<br/>## [1] "This"   "is"     "our"    "first"  "string"</pre>
<p class="mce-root"/>
<ul>
<li>To check if the given pattern is in the string, and in that case returns true (or <kbd>1</kbd>):</li>
</ul>
<pre style="padding-left: 60px">grep("our", c)<br/>## [1] 1<br/>grep("book", c)<br/>## integer(0)</pre>
<ul>
<li>To look for the first occurrence of a pattern in a string:</li>
</ul>
<pre style="padding-left: 60px">regexpr("our", c)<br/>## [1] 9<br/>## attr(,"match.length")<br/>## [1] 3<br/>## attr(,"index.type")<br/>## [1] "chars"<br/>## attr(,"useBytes")<br/>## [1] TRUE</pre>
<ul>
<li>To convert the string into lowercase:</li>
</ul>
<pre style="padding-left: 60px">tolower(c)<br/>## [1] "this is our first string"</pre>
<ul>
<li>To convert the string into capital letters:</li>
</ul>
<pre style="padding-left: 60px">toupper(c)<br/>## [1] "THIS IS OUR FIRST STRING"</pre>
<ul>
<li>To replace the first occurrence of the pattern by the given value with a string:</li>
</ul>
<pre style="padding-left: 60px">sub("our", "my", c)<br/>## [1] "This is my first string"</pre>
<ul>
<li>To replace the occurrences of the pattern with the given value with a string:</li>
</ul>
<pre style="padding-left: 60px">gsub("our", "my", c)<br/>## [1] "This is my first string"</pre>
<ul>
<li>To return the string as elements of the given array, separated by the given separator using <kbd>paste(string,array, sep=“Separator”)</kbd>:</li>
</ul>
<pre style="padding-left: 60px">paste(c,"My book",sep=" : ")<br/>## [1] "This is our first string : My book"</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Matrices</h1>
                </header>
            
            <article>
                
<p>You might know that a standard matrix has a two-dimensional, rectangular layout. Matrices in R are no different than a standard matrix.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Representing matrices</h1>
                </header>
            
            <article>
                
<p>To represent a matrix of <em>n</em> elements with <em>r</em> rows and <em>c</em> columns, the <kbd>matrix</kbd> command is used:</p>
<pre>m&lt;-matrix(c(1,2,3,4,5,6), nrow=2, ncol=3)<br/>m<br/>##  [,1] [,2] [,3]<br/>## [1,]    1    3    5<br/>## [2,]    2    4    6</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating matrices</h1>
                </header>
            
            <article>
                
<p>A matrix can be created by rows instead of by columns, which is done by using the <kbd>byrow</kbd> parameter, as follows:</p>
<pre>m&lt;-matrix(c(1,2,3,4,5,6), nrow=2, ncol=3,byrow=TRUE)<br/>m<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    2    3<br/>## [2,]    4    5    6</pre>
<p>With the <kbd>dimnames</kbd> parameter, column names can be added to the matrix:</p>
<pre>m&lt;-matrix(c(1,2,3,4,5,6), nrow=2, ncol=3,byrow=TRUE,dimnames=list(c('Obs1', 'Obs2'), c('col1', 'Col2','Col3')))<br/>m<br/>##      col1 Col2 Col3<br/>## Obs1    1    2    3<br/>## Obs2    4    5    6</pre>
<p>There are three more alternatives to creating matrices:</p>
<pre>rbind(1:3,4:6,10:12)<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    2    3<br/>## [2,]    4    5    6<br/>## [3,]   10   11   12<br/>cbind(1:3,4:6,10:12)<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    4   10<br/>## [2,]    2    5   11<br/>## [3,]    3    6   12<br/>m&lt;-array(c(1,2,3,4,5,6), dim=c(2,3))<br/>m<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    3    5<br/>## [2,]    2    4    6</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing elements in a matrix</h1>
                </header>
            
            <article>
                
<p>You can access the elements in a matrix in a similar way to how you accessed elements of a vector using indexing. However, the elements here would be the index number of rows and columns. </p>
<p>Here a some examples of accessing elements:</p>
<ul>
<li>If you want to access the element at a second column and first row:</li>
</ul>
<pre style="padding-left: 60px">m&lt;-array(c(1,2,3,4,5,6), dim=c(2,3))<br/>m<br/>## [,1] [,2] [,3]<br/>## [1,] 1 3 5<br/>## [2,] 2 4 6<br/>m[1,2]<br/>## [1] 3</pre>
<ul>
<li>Similarly, accessing the element at the second column and second row:</li>
</ul>
<pre style="padding-left: 60px">m[2,2]<br/>## [1] 4</pre>
<ul>
<li>Accessing the elements in only the second row:</li>
</ul>
<pre style="padding-left: 60px">m[2,]<br/>## [1] 2 4 6</pre>
<ul>
<li>Accessing only the first column:</li>
</ul>
<pre style="padding-left: 60px">m[,1]<br/>## [1] 1 2</pre>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Matrix functions</h1>
                </header>
            
            <article>
                
<p>Furthermore, there are specific functions for matrices:</p>
<ul>
<li>The following function extracts the diagonal as a vector:</li>
</ul>
<pre style="padding-left: 60px">m&lt;-matrix(c(1,2,3,4,5,6,7,8,9), nrow=3, ncol=3)<br/>m<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    4    7<br/>## [2,]    2    5    8<br/>## [3,]    3    6    9<br/>diag(m)<br/>## [1] 1 5 9</pre>
<ul>
<li>Returns the dimensions of a matrix:</li>
</ul>
<pre style="padding-left: 60px">dim(m)<br/>## [1] 3 3</pre>
<ul>
<li>Returns the sum of columns of a matrix:</li>
</ul>
<pre style="padding-left: 60px">colSums(m)<br/>## [1]  6 15 24</pre>
<ul>
<li>Returns the sum of rows of a matrix:</li>
</ul>
<pre style="padding-left: 60px">rowSums(m)<br/> ## [1] 12 15 18</pre>
<ul>
<li>The transpose of a matrix can be obtained using the following code:</li>
</ul>
<pre style="padding-left: 60px">t(m)<br/>##      [,1] [,2] [,3]<br/>## [1,]    1    2    3<br/>## [2,]    4    5    6<br/>## [3,]    7    8    9</pre>
<ul>
<li>Returns the determinant of a matrix:</li>
</ul>
<pre style="padding-left: 60px">det(m)<br/>## [1] 0</pre>
<ul>
<li>The auto-values and auto-vectors of a matrix are obtained using the following code:</li>
</ul>
<pre style="padding-left: 60px">eigen(m)<br/>## eigen() decomposition<br/>## $values<br/>## [1]  1.611684e+01 -1.116844e+00 -5.700691e-16<br/>##<br/>## $vectors<br/>##            [,1]       [,2]       [,3]<br/>## [1,] -0.4645473 -0.8829060  0.4082483<br/>## [2,] -0.5707955 -0.2395204 -0.8164966<br/>## [3,] -0.6770438  0.4038651  0.4082483</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Lists</h1>
                </header>
            
            <article>
                
<p>If objects are arranged in an orderly manner, which makes them components, they are known as <strong>lists</strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating lists</h1>
                </header>
            
            <article>
                
<p>We can create a list using <kbd>list()</kbd> or by concatenating other lists:</p>
<pre>x&lt;- list(1:4,"book",TRUE, 1+4i)<br/>x<br/>## [[1]]<br/>## [1] 1 2 3 4<br/>##<br/>## [[2]]<br/>## [1] "book"<br/>##<br/>## [[3]]<br/>## [1] TRUE<br/>##<br/>## [[4]]<br/>## [1] 1+4i</pre>
<p>Components will always be referred to by their referring numbers as they are ordered and numbered.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing components and elements in a list</h1>
                </header>
            
            <article>
                
<p>To access each component in a list, a double bracket should be used:</p>
<pre>x[[1]]<br/>## [1] 1 2 3 4</pre>
<p>However, it is possible to access each element of a list as well:</p>
<pre>x[[1]][2:4]<br/>## [1] 2 3 4</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data frames</h1>
                </header>
            
            <article>
                
<p>Data frames are special lists that can also store tabular values. However, there is a constraint on the length of elements in the lists: they all have to be of a similar length. You can consider every element in the list as columns, and their lengths can be considered as rows.</p>
<p>Just like lists, a data frame can have objects belonging to different classes in a column; this was not allowed in matrices.</p>
<p>Let's quickly create a data frame using the <kbd>data.frame()</kbd> function:</p>
<pre>a &lt;- c(1, 3, 5)<br/>b &lt;- c("red", "yellow", "blue")<br/>c &lt;- c(TRUE, FALSE, TRUE)<br/>df &lt;- data.frame(a, b, c) <br/>df<br/>##   a      b     c<br/>##   1    red  TRUE<br/>##   3 yellow FALSE<br/>##   5   blue  TRUE</pre>
<p>You can see the headers of a table as <kbd>a</kbd>, <kbd>b</kbd>, and <kbd>c</kbd>; they are the column names. Every line of the table represents a row, starting with the name of each row.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing elements in data frames</h1>
                </header>
            
            <article>
                
<p>It is possible to access each cell in the table.</p>
<p class="mce-root"/>
<p>To do this, you should specify the coordinates of the desired cell. Coordinates begin within the position of the row and end with the position of the column:</p>
<pre>df[2,1]<br/>## [1] 3</pre>
<p>We can even use the row and column names instead of numeric values:</p>
<pre>df[,"a"]<br/>## [1] 1 3 5</pre>
<p>Some packages contain datasets that can be loaded to the workspace, for example, the <kbd>iris</kbd> dataset:</p>
<pre>data(iris)</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions of data frames</h1>
                </header>
            
            <article>
                
<p>Some functions can be used on data frames:</p>
<ul>
<li>To find out the number of columns in a data frame:</li>
</ul>
<pre style="padding-left: 60px">ncol(iris)<br/>## [1] 5</pre>
<ul>
<li>To obtain the number of rows:</li>
</ul>
<pre style="padding-left: 60px">nrow(iris)<br/>## [1] 150</pre>
<ul>
<li>To print the first <kbd>10</kbd> rows of data:</li>
</ul>
<pre style="padding-left: 60px">head(iris,10)<br/>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species<br/>## 1           5.1         3.5          1.4         0.2  setosa<br/>## 2           4.9         3.0          1.4         0.2  setosa<br/>## 3           4.7         3.2          1.3         0.2  setosa<br/>## 4           4.6         3.1          1.5         0.2  setosa<br/>## 5           5.0         3.6          1.4         0.2  setosa<br/>## 6           5.4         3.9          1.7         0.4  setosa<br/>## 7           4.6         3.4          1.4         0.3  setosa<br/>## 8           5.0         3.4          1.5         0.2  setosa<br/>## 9           4.4         2.9          1.4         0.2  setosa<br/>## 10          4.9         3.1          1.5         0.1  setosa</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<ul>
<li>Print the last <kbd>5</kbd> rows of the <kbd>iris</kbd> dataset:</li>
</ul>
<pre style="padding-left: 60px">tail(iris,5)<br/>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species<br/>## 146          6.7         3.0          5.2         2.3 virginica<br/>## 147          6.3         2.5          5.0         1.9 virginica<br/>## 148          6.5         3.0          5.2         2.0 virginica<br/>## 149          6.2         3.4          5.4         2.3 virginica<br/>## 150          5.9         3.0          5.1         1.8 virginica</pre>
<ul>
<li>Finally, general information of the entire dataset is obtained using <kbd>str()</kbd>:</li>
</ul>
<pre style="padding-left: 60px">str(iris)<br/>## 'data.frame':    150 obs. of  5 variables:<br/>##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...<br/>##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...<br/>##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...<br/>##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...<br/>##  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</pre>
<p>Although there are a lot of operations to work with data frames, such as merging, combining, or slicing, we won't go any deeper for now. We will be using data frames in further chapters, and shall cover more operations later.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing or exporting data</h1>
                </header>
            
            <article>
                
<p>In R, there are several functions for reading and writing data from many sources and formats. Importing data into R is quite simple.</p>
<p>The most common files to import into R are Excel or text files. Nevertheless, in R, it is also possible to read files in SPSS, SYSTAT, or SAS formats, among others.</p>
<p>In the case of Stata and SYSTAT files, I would recommend the use of the <kbd>foreign</kbd> package.</p>
<p>Let's install and load the <kbd>foreign</kbd> package:</p>
<pre>install.packages("foreign")<br/>library(foreign)</pre>
<p><span>We can use the  </span><kbd>Hmisc</kbd><span> </span>package for SPSS, and SAS for ease and functionality:</p>
<pre>install.packages("Hmisc")<br/>library(Hmisc)</pre>
<p>Let's see some<span> </span>examples<span> </span>of importing data:</p>
<ul>
<li>Import a comma delimited text file. The first rows will have the variable names, and the comma is used as a separator:</li>
</ul>
<pre style="padding-left: 60px">mydata&lt;-read.table("c:/mydata.csv", header=TRUE,sep=",", row.names="id")</pre>
<ul>
<li>To read an Excel file, you can either simply export it to a comma delimited file and then import it or use the<span> </span><kbd>xlsx</kbd><span> </span>package. Make sure that the first row comprises column names that are nothing but variables.</li>
<li>Let's read an Excel worksheet from a workbook, <kbd>myexcel.xlsx</kbd>:</li>
</ul>
<pre style="padding-left: 60px">library(xlsx)<br/>mydata&lt;-read.xlsx("c:/myexcel.xlsx", 1)</pre>
<ul>
<li>Now, we will read a concrete Excel sheet in an Excel file:</li>
</ul>
<pre style="padding-left: 60px">mydata&lt;-read.xlsx("c:/myexcel.xlsx", sheetName= "mysheet")</pre>
<ul>
<li>Reading from the <kbd>systat</kbd> format:</li>
</ul>
<pre style="padding-left: 60px">library(foreign)<br/>mydata&lt;-read.systat("c:/mydata.dta")</pre>
<ul>
<li>Reading from the SPSS format:
<ol start="1">
<li>First, the file should be saved from SPSS in a transport format:</li>
</ol>
</li>
</ul>
<pre style="padding-left: 120px">getfile=’c:/mydata.sav’ exportoutfile=’c:/mydata.por’</pre>
<ul>
<li style="list-style-type: none">
<ol start="2">
<li>Then, the file can be imported into R with the <kbd>Hmisc</kbd> package:</li>
</ol>
</li>
</ul>
<pre style="padding-left: 120px">library(Hmisc)<br/>mydata&lt;-spss.get("c:/mydata.por", use.value.labels=TRUE)</pre>
<ul>
<li>To import a file from SAS, again, the dataset should be converted in SAS:</li>
</ul>
<pre style="padding-left: 60px">libname out xport ‘c:/mydata.xpt’; data out.mydata; set sasuser.mydata; run;<br/>library(Hmisc)<br/>mydata&lt;-sasxport.get("c:/mydata.xpt")</pre>
<ul>
<li>Reading from the Stata format:</li>
</ul>
<pre style="padding-left: 60px">library(foreign)<br/>mydata&lt;-read.dta("c:/mydata.dta")</pre>
<p class="mce-root"/>
<p>Hence, we have seen how easy it is to read data from different file formats. Let's see how simple exporting data is.</p>
<p>There are analogous functions to export data from R to other formats. For SAS, SPSS, and Stata, the<span> </span><kbd>foreign</kbd><span> </span>package can be used. For Excel, you will need the<span> </span><kbd>xlsx</kbd><span> </span>package.</p>
<p>Here are a few exporting examples:</p>
<ul>
<li>We can export data to a tab delimited text file like this:</li>
</ul>
<pre style="padding-left: 60px">write.table(mydata, "c:/mydata.txt", sep="\t")</pre>
<ul>
<li>We can export to an Excel spreadsheet like this:</li>
</ul>
<pre style="padding-left: 60px">library(xlsx)<br/>write.xlsx(mydata, "c:/mydata.xlsx")</pre>
<ul>
<li><span>We can export to</span> SPSS like this:</li>
</ul>
<pre style="padding-left: 60px">library(foreign)<br/>write.foreign(mydata, "c:/mydata.txt", "c:/mydata.sps",   package="SPSS")</pre>
<ul>
<li><span>We can export to</span> SAS like this:</li>
</ul>
<pre style="padding-left: 60px">library(foreign)<br/>write.foreign(mydata, "c:/mydata.txt", "c:/mydata.sas",   package="SAS")</pre>
<ul>
<li><span>We can export to</span><span> </span>Stata like this:</li>
</ul>
<pre style="padding-left: 60px">library(foreign)<br/>write.dta(mydata, "c:/mydata.dta")</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with functions</h1>
                </header>
            
            <article>
                
<p>Functions are the core of R, and they are useful to structure and modularize code. We have already seen some functions in the preceding section. These functions can be considered built-in functions that are available on the basis of R or where we install some packages.</p>
<p>On the other hand, we can define and create our own functions based on different operations and computations we want to perform on the data. We will create functions in R using the<span> </span><kbd>function()</kbd><span> </span>directive, and these functions will be stored as objects in R.</p>
<p>Here is what the structure of a function in R looks like:</p>
<pre>myfunction &lt;- function(arg1, arg2, … )<br/>{<br/>statements<br/>return(object)<br/>}</pre>
<p>The objects specified under a function as local to that function and the resulting objects can have any data type. We can even pass these functions as arguments for other functions.</p>
<p>Functions in R support nesting, which means that we can define a function within a function and the code will work just fine.</p>
<p>The resulting value of a function is known as the last expression evaluated on execution.</p>
<p>Once a function is defined, we can use that function using its name and passing the required arguments.</p>
<p>Let's create a function named<span> </span><kbd>squaredNum</kbd><span>, </span>which calculates the square value of a number:</p>
<pre>squaredNum&lt;-function(number)<br/> {<br/>   a&lt;-number^2<br/>   return(a)<br/> }</pre>
<p>Now, we can calculate the square of any number using the function that we just created:</p>
<pre>squaredNum(425)<br/> ## [1] 180625</pre>
<p>As we move on in this book, we will see how important such user-defined functions are.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Controlling code flow</h1>
                </header>
            
            <article>
                
<p>R has a set of control structures that organize the flow of execution of a program, depending on the conditions of the environment. Here are the most important ones:</p>
<ul>
<li><kbd>If</kbd>/<kbd>else</kbd>: This can test a condition and execute it accordingly</li>
<li><kbd>for</kbd>: Executes a loop that repeats for a certain number of times, as defined in the code</li>
<li><kbd>while</kbd>: This evaluates a condition and executes only until the condition is true</li>
<li><kbd>repeat</kbd>: Executes a loop an infinite number of times</li>
<li><kbd>break</kbd>: Used to interrupt the execution of a loop</li>
<li><kbd>next</kbd>:  Used to jump through similar iterations to decrease the number of iterations and time taken to get the output from the loop</li>
<li><kbd>return</kbd>: Abandons a function</li>
</ul>
<p>The structure of <kbd>if else</kbd> is as <kbd>if (test_expression) { statement }</kbd>.</p>
<p>Here, if the <kbd>test_expression</kbd><span> </span>returns true, the <kbd>statement</kbd> will execute; otherwise, it won't.</p>
<p> An additional <kbd>else</kbd> condition can be added like <kbd>if (test_expression) { statement1 } else { statement2 }</kbd>.</p>
<p>In this case, the<span> </span><kbd>else</kbd><span> </span>condition is executed only if<span> </span><kbd>test_expression</kbd><span> </span>returns false.</p>
<p>Let's see how this works. We will evaluate an <kbd>if</kbd><span> </span>expression like so:</p>
<pre>x&lt;-4<br/>y&lt;-3<br/>if (x &gt;3) {<br/> y &lt;- 10<br/>} else {<br/>  y&lt;- 0<br/>}</pre>
<p>Since <kbd>x</kbd> takes a value higher than <kbd>3</kbd>, then the <kbd>y</kbd> value should be modified to take a value of <kbd>10</kbd>:</p>
<pre>print(y)<br/>## [1] 10</pre>
<p>If there are more than two<span> </span><kbd>if</kbd><span> </span>statements, the<span> </span><kbd>else</kbd><span> </span>expression is transformed into <kbd>else if</kbd> like this <kbd>if ( test_expression1) { statement1 } else if ( test_expression2) { statement2 } else if ( test_expression3) { statement3 } else { statement4 }</kbd>.</p>
<p>The<span> </span><kbd>for</kbd> command takes an iterator variable and assigns its successive values of a sequence or vector. It is usually used to iterate on the elements of an object, such as vector lists.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>An easy example is as follows, where the <kbd>i</kbd> variable takes different values from <kbd>1</kbd> to <kbd>10</kbd> and prints them. Then, the loop finishes:</p>
<pre>for (i in 1:10){<br/> print(i)<br/>}<br/>## [1] 1<br/>## [1] 2<br/>## [1] 3<br/>## [1] 4<br/>## [1] 5<br/>## [1] 6<br/>## [1] 7<br/>## [1] 8<br/>## [1] 9<br/>## [1] 10</pre>
<p>Additionally, loops can be nested in the same code:</p>
<pre>x&lt;- matrix(1:6,2,3)<br/><br/>for (i in seq_len(nrow(x))){<br/>  for (j in seq_len(ncol(x))){<br/>     print(x[i,j])}<br/>}<br/>## [1] 1<br/>## [1] 3<br/>## [1] 5<br/>## [1] 2<br/>## [1] 4<br/>## [1] 6</pre>
<p>The<span> </span><kbd>while</kbd><span> </span>command is used to create loops until a specific condition is met. Let's look at an example:</p>
<pre>x &lt;- 1<br/> <br/> while (x &gt;= 1 &amp; x &lt; 20){<br/>  print(x)<br/>  x = x+1<br/>  }<br/>## [1] 1<br/>## [1] 2<br/>## [1] 3<br/>## [1] 4<br/>## [1] 5<br/>## [1] 6<br/>## [1] 7<br/>## [1] 8<br/>## [1] 9<br/>## [1] 10<br/>## [1] 11<br/>## [1] 12<br/>## [1] 13<br/>## [1] 14<br/>## [1] 15<br/>## [1] 16<br/>## [1] 17<br/>## [1] 18<br/>## [1] 19</pre>
<p>Here, values of <kbd>x</kbd> are printed, while <kbd>x</kbd> takes higher values than <kbd>1</kbd> and less than <kbd>20</kbd>. While loops start by testing the value of a condition, if true, the body of the loop is executed. After it has been executed, it will test the condition again, and keep on testing it until the result is false.</p>
<p>The<span> </span><kbd>repeat</kbd><span> </span>and<span> </span><kbd>break</kbd><span> </span>commands are related. The<span> </span><kbd>repeat</kbd><span> command </span>starts an infinite loop, so the only way out of it is through the<span> </span><kbd>break</kbd><span> </span>instruction:</p>
<pre>x &lt;- 1<br/>repeat{<br/>  print(x)<br/>  x = x+1<br/>  if (x == 6){<br/>     break<br/>     }<br/>  }<br/>## [1] 1<br/>## [1] 2<br/>## [1] 3<br/>## [1] 4<br/>## [1] 5</pre>
<p>We can use the <kbd>break</kbd> statement inside for and while loops to stop the iterations of the loop and control the flow.</p>
<p>Finally,<span> the </span><kbd>next</kbd><span> </span>command can be used to skip some iterations without getting them terminated. When the R parser reads <kbd>next</kbd>, it terminates the current iteration and moves on to another new iteration.</p>
<p>Let's look at an example of<span> </span><kbd>next</kbd><span>, </span>where 20 iterations are skipped:</p>
<pre>for (i in 1:15){<br/>      if (i &lt;= 5){<br/>      next      <br/>      } else { print(i)<br/>} }<br/>## [1] 6<br/>## [1] 7<br/>## [1] 8<br/>## [1] 9<br/>## [1] 10<br/>## [1] 11<br/>## [1] 12<br/>## [1] 13<br/>## [1] 14<br/>## [1] 15</pre>
<p>Before we start the next chapters of this book, it is recommended to practice these codes. Take your time and think about the code and how to use it. In the upcoming chapters, you will see a lot of code and new functions. Don't be concerned if you don't understand all of them. It is more important to have an understanding of the entire process to develop a predictive model and all the things you can do with R.</p>
<p>I have tried to make all of the code accessible, and it is possible to replicate all the tables and results provided in this book. Just enjoy understanding the process and reuse all the code you need in your own applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">All about R packages</h1>
                </header>
            
            <article>
                
<p><span>Packages in R are a collection of functions and datasets that are developed by the community. </span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing packages</h1>
                </header>
            
            <article>
                
<p>Although R contains several functions in its basic installation, we will need to install additional packages to add new R functionalities. For example, with R it is possible to visualize data using the<span> </span><kbd>plot</kbd><span> </span>function. Nevertheless, we could install the <kbd>ggplot2</kbd><span> package </span>to obtain more pretty plots.</p>
<p>A package mainly includes R code (not always just R code), documentation with explanations about the package and functions inside it, examples, and even datasets.</p>
<p>Packages are placed on different repositories where you can install them.</p>
<p>Two of the most popular repositories for R packages are as follows:</p>
<ul>
<li><strong>CRAN</strong>: The official repository, maintained by the R community around the world. All of the packages that are published on this repository should meet quality standards.</li>
<li><strong>GitHub</strong>: This repository is not specific for R packages, but many of the packages have open source projects located in them. Unlike CRAN, there is no review process when a package is published.</li>
</ul>
<p>To install a package from CRAN, use the <kbd>install.packages()</kbd> command. For example, the<span> </span><kbd>ggplot2</kbd><span> </span>package can be installed using the following command:</p>
<pre><strong>install.packages("ggplot2")</strong></pre>
<p>To install packages from repositories other than CRAN, I would recommend using the <kbd>devtools</kbd> package:</p>
<pre><strong>install.packages("devtools")</strong></pre>
<p>This package simplifies the process of installing packages from different repositories. With this package, some functions are available, depending on the repository you want to download a package from.</p>
<p>For example, use <kbd>install_cran</kbd> to download a package from CRAN or <kbd>install_github()</kbd> to download it from GitHub.</p>
<p>After the package has been downloaded and installed, we'll load it into our current R session using the<span> </span><kbd>library</kbd><span> </span>function. It is important to load packages so that we can use these new functions in our R session:</p>
<pre>library(ggplot2)</pre>
<p>The<span> </span><kbd>require</kbd><span> </span>function can be used to load a package. The only difference between<span> </span><kbd>require</kbd><span> </span>and<span> </span><kbd>library</kbd><span> </span>is that, in case the specific package is not found,<span> </span><kbd>library</kbd><span> </span>will show an error, but<span> </span><kbd>require</kbd><span> </span>will continue the execution of code without showing any error.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Necessary packages</h1>
                </header>
            
            <article>
                
<p>To run all the code that's presented in this book, you need to install some of the packages we have mentioned. Specifically, you need to install the following packages (alphabetically ordered):</p>
<ul>
<li><kbd>Amelia</kbd>: Package for missing data visualization and imputation.</li>
<li><kbd>Boruta</kbd>: Implements a feature selection algorithm for finding relevant variables.</li>
<li><kbd>caret</kbd>: This package (short for <strong>classification and regression training</strong>) implements several machine learning algorithms for building predictive models.</li>
<li><kbd>caTools</kbd>: Contains several basic utility functions, including predictive metrics or functions to split samples.</li>
<li><kbd>choroplethr</kbd>/<kbd>choroplethrMaps</kbd>: Creates maps in R.</li>
<li><kbd>corrplot</kbd>: Calculates correlation among variables and displays them graphically.</li>
<li><kbd>DataExplorer</kbd>: Includes different functions for data exploration process.</li>
<li><kbd>dplyr</kbd>: Package for data manipulation.</li>
<li><kbd>fBasics</kbd>: Includes techniques of explorative data analysis.</li>
<li><kbd>funModeling</kbd>: Functions for data cleaning, importance variable analysis, and model performance.</li>
<li><kbd>ggfortify</kbd>: Functions for data visualization tools for statistical analysis.</li>
<li><kbd>ggplot2</kbd>: System for declaratively creating graphics.</li>
<li><kbd>glmnet</kbd>: A package oriented toward Lasso and elastic-net regularized regression models.</li>
<li><kbd>googleVis</kbd>: R interface to Google Charts.</li>
<li><kbd>h2o</kbd>: A package that includes fast and scalable algorithms, including gradient boosting, random forest, and deep learning.</li>
<li><kbd>h2oEnsemble</kbd>: Provides functionality to create ensembles from the base learning algorithms that are accessible via the <kbd>h2o</kbd> package.</li>
<li><kbd>Hmisc</kbd>: Contains many functions that are useful for data analysis and also for importing files from different formats.</li>
<li><kbd>kohonen</kbd>: Facilitates the creation and visualization of self-organizing maps.</li>
<li><kbd>lattice</kbd>: A package to create powerful graphs.</li>
<li><kbd>lubridate</kbd>: Incorporates functions to work with dates in an easy way.</li>
<li><kbd>MASS</kbd>: Contains several statistical functions.</li>
<li><kbd>plotrix</kbd>: This has many plots, labeling, axis, and color scaling functions.</li>
<li><kbd>plyr</kbd>: This contains tools that can split, apply, and combine data.</li>
<li><kbd>randomForest</kbd>: Algorithms for random forests for classification and regression.</li>
<li><kbd>rattle</kbd>: This provides a GUI for different R packages that can aid in data mining.</li>
<li><kbd>readr</kbd>: Provides a fast and friendly way to read files from <kbd>.csv</kbd>, <kbd>.tsv</kbd>, or <kbd>.fwf</kbd> files.</li>
<li><kbd>readtext</kbd>: Functions to import and handle plain and formatted text files.</li>
<li><kbd>recipes</kbd>: Useful package for data manipulation and analysis.</li>
<li><kbd>rpart</kbd>: Implements classification and regression trees.</li>
<li><kbd>rpart.plot</kbd>: The easiest way to plot a tree that's created using<span> the </span><kbd>rpart</kbd><span> </span>package.</li>
<li><kbd>Rtsne</kbd>: Implementation of <strong>t-distributed Stochastic Neighbor Embedding</strong> (<strong>t-SNE</strong>).</li>
<li><kbd>RWeka</kbd>: RWeka has many algorithms for data mining and also tools that can pre-process and classify data. It provides an easy interface to perform operations like regression, clustering, association, and visualization.</li>
<li><kbd>rworldmap</kbd>: Enables mapping of country-level and gridded user datasets.</li>
<li><kbd>scales</kbd>: This provides methods that can automatically detect breaks, determine labels for axes, and legends. It does the work of mapping.</li>
<li><kbd>smbinning</kbd>: A set of functions to build scoring models.</li>
<li><kbd>SnowballC</kbd>: This can easily implement the very famous Porter's word stemming algorithm that collapses words into root nodes and compares the vocabulary.</li>
<li><kbd>sqldf</kbd>: Functions to manipulate R data frames using SQL.</li>
<li><kbd>tibbletime</kbd>: Useful functions to work with time series.</li>
<li><kbd>tidyquant</kbd>: A package focused on retrieving, manipulating, and scaling financial data analysis in the easiest way possible.</li>
<li><kbd>tidyr</kbd>: Includes functions for data frame manipulations.</li>
<li><kbd>tidyverse</kbd>: This is one package that contains packages for manipulating the data, exploring, and visualizing.</li>
<li><kbd>tm</kbd>: Package for text mining in R.</li>
<li><kbd>VIM</kbd>: Using this package, missing packages can be visualized.</li>
<li><kbd>wbstats</kbd>: This gives you access to data and statistics from the World Bank API.</li>
<li><kbd>WDI</kbd>: Search, extract, and format data from the World Bank's <strong>World Development Indicators</strong> (<strong>WDI</strong>).</li>
<li><kbd>wordcloud</kbd>: This package gives you the powerful functions that can help you in creating pretty word clouds. It can also help in visualizing the differences and similarities between two documents. </li>
</ul>
<p>Once these packages have been installed, we can start working with all the code that's contained in the following chapters.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Taking further steps</h1>
                </header>
            
            <article>
                
<p>We will be using the US bankruptcy problem statement to help you understand machine learning processes in depth and also to give you hands-on experience in dealing with and solving real-world problems. All the following chapters will describe each step in detail.</p>
<p class="mce-root">The objective of the following chapters is to describe all the steps and alternatives to develop a model based on machine learning techniques.</p>
<p class="mce-root">We will see several steps, starting from the extraction of the information and the generation of new variables up to the validation of the model. As we will see, in each step of the development, some alternatives or multiple steps are possible. In most of the cases, the best alternative will be the one that gives a better predictive model, but sometimes other alternatives will be chosen owing to some restrictions that are imposed by the future use of the model or the kind of problem we want to solve.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Background on the financial crisis</h1>
                </header>
            
            <article>
                
<p>In this book, we will solve two different problems related to the financial crisis:<span> </span>the bankruptcy of the US banks and the assessment of the solvency of the European countries. Why have I chosen such a specific problem for this book? Well, the first reason is my concern about the financial crisis and my aim to try to avoid future crises. On the other hand, it is an interesting problem because a high amount of data is available, making it a very appropriate problem to understand machine learning techniques.</p>
<p>Most of the chapters in this book will cover the development of a predictive model to detect the failures of banks. To solve this problem, we will use a large dataset that collects some of the more typical problems you can find when dealing with different algorithms. For example, a high amount of observations and variables and an unbalanced sample means one of the categories in the classification model is much larger than the other.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Some of the steps we will see during the following chapters are as follows:</p>
<ul>
<li>Data collection</li>
<li>Features generation</li>
<li>Descriptive analysis</li>
<li>Treatment of missing information</li>
<li>Univariate analysis</li>
<li>Multivariate analysis</li>
<li>Model selection</li>
</ul>
<p>The last chapter will focus on the development of models to detect economic imbalances in the European countries, while covering some basic text mining and clustering techniques.</p>
<p>Although this book is technical, one of the most important aspects of each big data and machine learning solution is understanding the problem that we need to solve.</p>
<p><span>By the end of this book, you will see that just knowing algorithms is not enough to develop models. There are many important steps that you will need to follow before jumping into running algorithms. </span><span>If you pay attention to these preliminary steps, you are more likely to get good results.</span></p>
<p>In this sense, and because I'm passionate about economic theory, you can find a summary about the causes of the problems that we will solve in this book, from an economic point of view, in the repository where the code for this book is located. Specifically, the causes of the financial crisis and the contagion and transformation to a sovereign crisis are described. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this opening chapter, we established the purpose of this book. <span>Now that you are clear on the basics of R and its concepts, </span>we will move on to develop two main predictive models. We will cover all the necessary steps: data collection, data analysis, and feature selection, and different algorithms will be described in a practical manner. </p>
<p><span>In the next chapter, we will start solving programming and collect the necessary data to start modeling development.</span></p>


            </article>

            
        </section>
    </body></html>