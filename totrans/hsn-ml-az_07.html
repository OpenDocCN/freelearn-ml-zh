<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Machine Learning Server</h1>
                </header>
            
            <article>
                
<p class="mce-root">Microsoft <span>ML Server and its capabilities in SQL Server and HDInsight</span> are the subject of this chapter. In addition, the chapter will provide a walk-through on ML Server's use in order to demonstrate optimal situations in which to use it and how to deploy a solution with it.</p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Classified algorithms are supervised learning algorithms, which means that they make predictions based on a set of examples. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Often, it is useful to use data to predict a category, and this is known as classification. Take, for example, Andrew Ng's work on the classification of YouTube content as a cat video, or a video of something that is not a cat. As in the famous work by Andrew Ng, when there are only two choices, it is called <strong>two-class</strong> or  ...</span></p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">What is Microsoft ML Server?</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Microsoft ML Server brings machine learning and artificial intelligence to your data. It makes it possible for you to have data underlying intelligence apps in an enterprise environment that provides the opportunities of open source, with the security and reliance of Microsoft software. Microsoft ML Server offers an enterprise-ready platform for cleaning, modelling, and analyzing data at scale. It allows organizations to become insight-driven, allowing you to analyze data in SQL, as well as offering full enterprise support for Python and R.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">ML Server meets the needs of everyone involved in analyzing data, from business users to data engineers and data scientists. With SQL, Python, and R, businesses can be assured of having the opportunity to analyze their data using the most commonly-known and adopted languages in the world, offering businesses the opportunity to have data-based innovation. With Microsoft ML Server, the availability of R, SQL, and Python amalgamates the best of the open source and proprietary worlds together to bring true data science.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Microsoft ML Server used to be known as Microsoft R Server. In continuation of this effort to democratize data, R support is built on a legacy of previous versions of Microsoft R Server, and Revolution R Enterprise products. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">With the advent of Microsoft ML Server, significant machine learning and AI capabilities enhancements are made in every release. Python support was added in the <span>most recent </span>release. ML Server supports the full data science life cycle of your Python-based analytics.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Additionally, ML Server enables operationalization support so that you can deploy your models to a scalable grid for both batch and real-time scoring. This means that you can go through the machine learning process, and then set your model for use by everyone in the organization. This is the true democratization of data for everyone!</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">What problems does Microsoft ML Server solve? </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Microsoft ML Server can help solve many different, real-life business problems. It can take care of data in an end-to-end process. For example, it can clean and preprocess larger sets of data so that downstream systems can work with the data in order to produce insights. There are different examples for which HDInsight is useful, such as: </span></p>
<ul>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Sentiment analysis</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Website traffic patterns</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Weather correlation effects</span></span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Sales analysis</span></span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Customer analysis</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><strong>Internet of Things <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lparen">(IoT)</span></strong> projects</span><span> </span></li>
</ul>
<p>Next, we will look at getting started with Microsoft ML Server.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to get started with Microsoft ML Server</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">To get started with Microsoft ML Server, it is recommended that the</span> Microsoft <span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><strong>Data Science Virtual Machine</strong></span> (<strong>DSVM</strong>) <span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">is used. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The DSVM</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">is a specially-built custom virtual machine that is hosted on Microsoft's Azure cloud. It is designed specifically for data science, and for giving learners a jump start in learning this new technology. It has Microsoft ML Server pre-installed and preconfigured so you can get started right away with data science projects.</span></p>
<p><span>You can use languages such as R and Python to do your data analytics right on the Microsoft DSVM. It is great for prototyping, and is a useful learning tool so that learners are set up for success early in the process.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring the DSVM</h1>
                </header>
            
            <article>
                
<p>The wizard that creates the Microsoft DSVM needs to be configured. The options are listed as follows:</p>
<ul>
<li class="mce-root"><strong>Name</strong>:<em> </em>Give the DSVM a name.</li>
<li class="mce-root"><strong>VM disk type</strong>: Choose SSD or HDD. </li>
<li class="mce-root"><strong>Username</strong>: <span>Specify the admin account ID to sign in.</span></li>
<li class="mce-root"><strong>Password</strong>:<span> </span>Specify the admin account password.</li>
<li class="mce-root"><strong>Subscription</strong>:<span> </span>If you have more than one subscription, select the one on which the machine is to be created and billed.</li>
<li class="mce-root"><strong>Resource group</strong>:<span> </span>You can create a new resource group or use an existing group.</li>
<li class="mce-root"><strong>Location</strong>:<span> </span><span>Select the data center that is most appropriate. For the fastest network access, it is the data center that has most of your data or is closest to your actual location.</span></li>
<li class="mce-root"><strong>Size</strong>:<span> </span><span><span>Select one of the server types that meets your functional requirements and cost constraints. For more choices of VM sizes, select <span class="packt_screen">View All</span>.</span></span></li>
<li class="mce-root"><strong>Settings</strong>:
<ul>
<li class="mce-root">Use managed disks. Choose<span> </span><span class="packt_screen">Managed</span><span> </span><span>if you want Azure to manage the disks for the VM. If not, you need to specify a new or existing storage account.</span></li>
<li class="mce-root">Other parameters. You can use the default values. If you want to use non-default values, hover over the informational link for help on the specific fields.</li>
<li class="mce-root">Once the settings have been configured, the next step is to check and verify that all the information you entered is correct. Then, select<span> </span><span class="packt_screen">Create</span><span> </span><span>and the DSVM will be set up in Azure.</span></li>
</ul>
</li>
</ul>
<p>Now that the DSVM is set up, let's look at the opportunities to use Python in Microsoft ML Server.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Machine learning with Python</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Python has a lot of machine learning functionality. One of the most commonly used machine learning libraries in Python is the scikit-learn library. It is used for creating, training, and evaluating models. In this hands-on book, the Python scikit-learn library is used in the code to train and evaluate the model. </span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting started with Python</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Python is a popular programming language that is rapidly gaining worldwide acceptance. Python has many strengths; it is reliable, flexible, easy to learn and use, and is free to use on all operating systems. It has been widely adopted among the open source community, and is supported by a strong developer community. Python has many free libraries for you to download and use in your data science work. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Python meets developers where they are; it supports all different types of development, including web applications, iterative development, web services, desktop apps, scripting, scientific, and mathematical computing. Python is used by businesses as well as many universities, scientists, casual developers, and professional developers alike. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Throughout this chapter, the Python coding will be completed using Microsoft Visual Studio, which incorporates a powerful Python IDE on Windows. Visual Studio provides open source support for the Python language through the Python development and data science workloads</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lparen">(Visual</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Studio 2017) and the free <strong>Python Tools for Visual Studio</strong></span> (<strong>PTVS</strong>) <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lparen">(Visual</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Studio 2015 and earlier).</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Using the DSVM, we can clean, model, analyze, and visualize our data and develop models using Microsoft ML Server with Python. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">For Python, there are many common development studios. Since the chapter will use R and Python, we will use Visual Studio Community edition because it has both R and Python IDEs in place. For the hands-on part of the chapter, the DSVM already has the </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lparen">PTVS</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">extension and R extensions pre-installed, so there is no need for us to take time to install and configure these additional items.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Set up your Python environment in Visual Studio</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Visual Studio needs to be configured so that it is using Python with Microsoft ML Server. This is the first step, and it only needs to be conducted once.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In Visual Studio, select the</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class="packt_screen">View</span></span><span> |</span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class="packt_screen">Other Windows</span></span><span> | </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class="packt_screen">Python Environments</span></span><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">menu command.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">We are going to create a <kbd>cookiecutter</kbd> Python project. To do this, firstly, we need to install <kbd>cookiecutter</kbd>. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Open Command Prompt, and type in the following command:</span></p>
<pre><strong><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">easy_install --user cookiecutter</span></strong></pre>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Then, we can proceed to use the <kbd>cookiecutter</kbd> functionality in Visual Studio to get off to a great start with Python and Visual Studio. </span></p>
<p class="mce-root"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In this exercise, the code will come from a Microsoft repository, which is stored on GitHub.</span></p>
<ol>
<li class="mce-root"><span>In Visual Studio, choose <span class="packt_screen">File</span> | ...</span></li></ol></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Writing your own code with Python in Microsoft ML Server</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In the last section, there was an end-to-end example that demonstrated the ability to use machine learning with Python in Microsoft ML Server. In this hands-on walk-through, there will be an exploration of writing Python code from scratch using Microsoft ML Server.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Walk-through: reading data in and out in Microsoft ML Server</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In this hands-on walk-through, the same</span> Iris dataset will be used to provide further examples using a familiar dataset. The purpose of the code is to show one of the in-built datasets, and read it out to the Python output screen. </p>
<p>In this walk-through, we will read data in and out of Microsoft ML Server. Initially, t<span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">he code imports the</span> Iris dataset from the scikit-learn library. The initial code will print out the data in the Iris dataset. The data is assigned to the <kbd>df</kbd> <span>variable </span>, which is set to a dataframe.</p>
<p>Here is the sequence of steps, in summary, of how we will proceed at a high level:</p>
<ul class="listtype-bullet listindent1 list-bullet1">
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">It imports the</span> Iris dataset from the scikit-learn library</li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The Pandas library is imported, ...</span></li></ul></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Introducing regression with Python in Microsoft ML Server</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In this example, the</span> Iris dataset is used again, since it is already available as part of the Python installation. In this segment of Python code, the Python Seaborn library is used to produce charts and graphs. Seaborn is a Python package that allows us to produce interesting results that can help our machine learning work.</p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In this next demo, the code will be changed in order to produce more charts, and save them to the Git repository on the DSVM. </span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">At a high level, the code uses the</span> Iris dataset, and produces charts based on the data. In the last plot, the linear regression line is added for clarity.</p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The chart shows the relationship between the length of the sepal, and the length of the petals, in three species of Iris. The data is grouped by color, and it is clear to see that the linear regression line fits through each of the three species.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In the simplest invocation, the Seaborn <kbd>lmplot</kbd> function draws a scatterplot of two variables, <kbd>x</kbd> and <kbd>y</kbd>, and then fits the regression model <kbd>y</kbd> ~ </span><kbd>x</kbd><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">. It plots the resulting regression line and a 95% confidence interval for that regression. In the example here, it has been conducted for each of the species.</span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The code is commented at a low level <span><span>as follows:</span></span></span></p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The first step is to load the</span> Iris dataset:</p>
<pre style="padding-left: 30px"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">iris = sns.load_dataset("iris")</span></pre>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Then, the colour scheme is set:</span></p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">colours = ['#066082', '#b12acf', '#808080']</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">This code will generate a</span> joint plot using the Iris dataset:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_pairplot = sns.pairplot(iris, hue='species', size=2.5,palette=colours)</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The next step is to save the output to an i</span>mage, and then produce a plot:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_pairplot.savefig("Packtpairplotoutput.png")<br/></span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">print("Produced Pairplot Image")</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">This code will generate a</span> <kbd>jointplot</kbd> using the Iris dataset:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_jointplot = sns.jointplot(x="sepal_length", y="petal_length", data=iris);</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Next, we save the output to an i</span>mage:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_jointplot.savefig("Packtjointplotoutput.png")</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Then, we feed back success to the user:</span></p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">print("Produced Jointplot Image")</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">This code will generate a linear regression plot using the</span> Iris dataset:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_lmplot = sns.lmplot(x='sepal_length', # X-axis name </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">y='petal_length', # Y-axis name</span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"> data=iris, </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">fit_reg=True, </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">hue='species', # one colour per iris species</span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"> scatter_kws={"s":100},</span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"> size=8, </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">palette=colours)</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The output is then saved to an i</span>mage:</p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sns_lmplot.savefig('PacktLinearRegression.jpeg', bbox_inches='tight')</span></pre>
<p> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Then, we feed back success to the user via the console:</span></p>
<pre><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">print("Produced Linear Regression Image")</span></pre>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">When the script is executed, the i</span>mage <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">files can be found in the Visual Studio repository folder. This is an example of where the images might be found in a repository folder:</span><span> </span><kbd>C:\Users\myusername\source\repos\Python Packt Example\Python Packt Example</kbd><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">More data visualization charts in Python and the Microsoft Machine Learning service</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The code will also produce two more charts: a</span> pairplot and a jointplot.</p>
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">A</span><span> </span>pairplot<span> </span><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">sets out to plot pairwise relationships in a dataset.</span> <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The</span> pairplot <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">takes variables such as petal width, petal length,</span> sepal width, and sepal length, and correlates them with one another. The output is generated very quickly using Python in Microsoft ML Server. The visualization allows the patterns in the data to be seen very quickly. For example, there is an interesting relationship between petal length and petal width, which can be viewed from the lower row of the pairplot.</p>
<p><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">In Seaborn, a</span> jointplot <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">draws a plot of two variables with bivariate and univariate graphs. This is produced ...</span></p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Regression code walk-through with Python and Microsoft ML Server</h1>
                </header>
            
            <article>
                
<p><span class="author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span><span>We will change the file by commenting </span></span>out the existing Python code, and we can add our new code to the same file. It is important to know how to comment out code, so that the code is readable and maintainable:</span></p>
<ol class="listtype-number listindent1 list-number1" start="1">
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Comment out the existing Python code by inserting a hash sign,</span><span> </span><kbd><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lsquo">#</span></kbd><span> , </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">at the start of each line.</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The code should appear as follows:</span></li>
</ol>
<pre style="padding-left: 60px"> # from sklearn import datasets<br/># import pandas as pd<br/># iris = datasets.load_iris()<br/># df = pd.DataFrame(iris.data, columns=iris.feature_names)</pre>
<ol class="listtype-number listindent1 list-number1" start="3">
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Copy the code given previously into the file. The file should appear as illustrated in the next screenshot, which only shows some of the code for the purposes of clarity:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1021 image-border" src="Images/4a401afd-a789-4a25-ad40-30876180d563.png" style="width:39.58em;height:21.50em;" width="1031" height="559"/></p>
<ol class="listtype-number listindent1 list-number1" start="4">
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">To run the code, click on the</span> file <span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">in <span class="packt_screen">Solution Explorer</span> so that it is highlighted.</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Click the <span class="packt_screen">Start</span> button.</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">The code will execute, and the Python interpreter will appear. Here is an example:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><span class="gallery author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z"><span class="gallery-wrapper"><img src="/library/view/hands-on-machine-learning/9781789131956/assets/fdbf294d-5796-4119-8c87-c1c50e3117ce.PNG" style="width:28.00em;height:7.75em;" width="570" height="158"/></span></span></div>
<ol class="listtype-number listindent1 list-number1" start="7">
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Once the code finishes execution, press any key to continue, as instructed.</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Search for the repository folder on the DSVM to look for the images produced by the Python code. If you are unclear about the repository location, search for</span><span> </span><kbd><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z h-lsquo">*.png</span></kbd><span> </span><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">and you will find the completed files.</span></li>
<li><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qovw8oz76zz80zz67zz75zz81zxb5z69zz72zl88z122zz69zoz76zz66zz90z3pz81zz68zuz65zxz68zz77z">Save your work by going to <span class="packt_screen">File</span> | <span class="packt_screen">Save All</span> in the Visual Studio menu bar.</span></li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Analyzing results in machine learning models</h1>
                </header>
            
            <article>
                
<p><span>No data has meaning apart from in its context. Machine learning is the way forward to understand data, but it needs to be interpreted as well. At a very high level, this process can be depicted as follows:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1025 image-border" src="Images/15e94601-4495-4120-b45d-af731d44b66e.png" style="width:20.75em;height:9.50em;" width="933" height="342"/></p>
<p>Data needs to be understood;<span><span> data goes through an </span></span>analysis process. <span>There can be trade-offs between accuracy and performance. Sometimes it is better to select an algorithm that is less accurate in order to have better performance. Another advantage of choosing more approximate methods is that they naturally tend to avoid overfitting. </span></p>
<p>There is no one single best method for interpreting statistics ...</p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Measuring the fit of the model</h1>
                </header>
            
            <article>
                
<p>How well do the model's predictions actually match the observed data? It is crucial to understand the extent to which the predicted response value for a given observation is close to the actual response value for that observation.</p>
<p>In regression, the most common measure is the <strong>mean squared error</strong> (<strong>MSE</strong>), which is the average squared difference between the estimated values and the actual value that is estimated. If the MSE is small, then the predicted responses are very close to the true responses. If the MSE is large, then the predicted and true responses differ substantially. This is the first step in showing that the model is not a good fit.</p>
<p>Note that the analysis focuses on the MSE test data, not the MSE for the training data. The most interesting results use test data that the model has not seen previously, and this is where we focus our analysis on MSE results.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Cross validation</h1>
                </header>
            
            <article>
                
<p>As we test and train our model, the MSE can vary widely across different sets of data. For this reason, cross-validation is important in order to understand the true results. Cross validation seeks to show how the model works in practice. The question is: Will our model <span>generalize to an independent dataset?</span></p>
<p>To conduct cross validation, the model is continually trained and then it is given a series of test sets of data. C<span>ross validation combines the measures of fitness and averages them in order to derive model prediction performance.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Variance and bias</h1>
                </header>
            
            <article>
                
<p>What do we mean by the variance and bias of the results? Variance refers to the amount by which the predicted values would change if it was estimated using a different set of training data. Throughout the training process, different training datasets will result in different predictions, but it is hoped that the predictions will not vary too much between training sets.</p>
<p>Bias refers to the error that is introduced by simplifying a real-life problem to a dataset. By simplifying data into a simpler model, bias may be introduced. When we look at the complexities of real life, this is a common issue that needs to be understood and taken into account when interpreting results.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we have investigated Visual Studio for Python and run through some interesting walk-throughs. We have learned about the modelling process using the <strong>Team Data Science Process </strong><span>(<strong>TDSP</strong>)</span><span>. As part of this process, we have looked at modeling and analyzing our results, as well as conducting data visualization to evangelize our work.</span></p>


            </article>

            
        </section>
    </div>



  </body></html>