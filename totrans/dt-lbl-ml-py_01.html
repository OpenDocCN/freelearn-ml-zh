<html><head></head><body>
<div id="_idContainer047">
<h1 class="chapter-number" id="_idParaDest-16"><a id="_idTextAnchor015"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/><span class="koboSpan" id="kobo.2.1">Exploring Data for Machine Learning</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Imagine embarking on a journey through an expansive ocean of data, where within this vastness are untold stories, patterns, and insights waiting to be discovered. </span><span class="koboSpan" id="kobo.3.2">Welcome to the world of data exploration</span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.4.1"> in </span><strong class="bold"><span class="koboSpan" id="kobo.5.1">machine learning</span></strong><span class="koboSpan" id="kobo.6.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.7.1">ML</span></strong><span class="koboSpan" id="kobo.8.1">). </span><span class="koboSpan" id="kobo.8.2">In this chapter, I </span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.9.1">encourage you to put on your analytical lenses as we embark on a thrilling quest. </span><span class="koboSpan" id="kobo.9.2">Here, we will delve deep into the heart of your data, armed with powerful techniques and heuristics, to uncover its secrets. </span><span class="koboSpan" id="kobo.9.3">As you embark on this adventure, you will discover that beneath the surface of raw numbers and statistics, there exists a treasure trove of patterns that, once revealed, can transform your data into a valuable asset. </span><span class="koboSpan" id="kobo.9.4">The journey begins </span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.10.1">with </span><strong class="bold"><span class="koboSpan" id="kobo.11.1">exploratory data analysis</span></strong><span class="koboSpan" id="kobo.12.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.13.1">EDA</span></strong><span class="koboSpan" id="kobo.14.1">), a crucial phase where we unravel the mysteries of data, laying the foundation for automated labeling and, ultimately, building smarter and more accurate ML models. </span><span class="koboSpan" id="kobo.14.2">In this age of </span><strong class="bold"><span class="koboSpan" id="kobo.15.1">generative AI</span></strong><span class="koboSpan" id="kobo.16.1">, the preparation </span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.17.1">of quality training data is </span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.18.1">essential to the fine-tuning of domain-specific </span><strong class="bold"><span class="koboSpan" id="kobo.19.1">large language models (LLMs)</span></strong><span class="koboSpan" id="kobo.20.1">. </span><span class="koboSpan" id="kobo.20.2">Fine-tuning involves the curation of additional domain-specific labeled data for training publicly available LLMs. </span><span class="koboSpan" id="kobo.20.3">So, fasten your seatbelts for a</span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.21.1"> captivating voyage into the art and science of data exploration for </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.22.1">data labeling</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.24.1">First, let’s start with the question: What is</span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.25.1"> data exploration? </span><span class="koboSpan" id="kobo.25.2">It is the initial phase of data analysis, where raw data is examined, visualized, and summarized to uncover patterns, trends, and insights. </span><span class="koboSpan" id="kobo.25.3">It serves as a crucial step in understanding the nature of the data before applying advanced analytics or </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">ML techniques.</span></span></p>
<p><span class="koboSpan" id="kobo.27.1">In this chapter, we will explore tabular data using various libraries and packages in Python, including Pandas, NumPy, and Seaborn. </span><span class="koboSpan" id="kobo.27.2">We will also plot different bar charts and histograms to visualize data to find the relationships between various features, which is useful for labeling data. </span><span class="koboSpan" id="kobo.27.3">We will be exploring the </span><em class="italic"><span class="koboSpan" id="kobo.28.1">Income</span></em><span class="koboSpan" id="kobo.29.1"> dataset located in this book’s GitHub repository (a link for which is located in the </span><em class="italic"><span class="koboSpan" id="kobo.30.1">Technical requirements</span></em><span class="koboSpan" id="kobo.31.1"> section). </span><span class="koboSpan" id="kobo.31.2">A good understanding of the data is necessary in order to define business rules, identify matching patterns, and, subsequently, label the data using Python </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">labeling functions.</span></span></p>
<p><span class="koboSpan" id="kobo.33.1">By the end of this chapter, we will be able to generate summary statistics for the given dataset. </span><span class="koboSpan" id="kobo.33.2">We will derive aggregates of the features for each target group. </span><span class="koboSpan" id="kobo.33.3">We will also learn how to perform univariate and bivariate analyses of the features in the given dataset. </span><span class="koboSpan" id="kobo.33.4">We will create a report using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.34.1">ydata-profiling</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.35.1"> library.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">We’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.38.1">EDA and </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">data labeling</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">Summary statistics and data aggregates </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">with Pandas</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Data visualization with Seaborn for univariate and </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">bivariate analysis</span></span></li>
<li><span class="koboSpan" id="kobo.44.1">Profiling data using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.45.1">ydata-profiling</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.46.1"> library</span></span></li>
<li><span class="koboSpan" id="kobo.47.1">Unlocking insights from data with OpenAI </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">and LangChain</span></span></li>
</ul>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/><span class="koboSpan" id="kobo.49.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.50.1">One of the following Python IDE and software tools needs to be installed before running the notebook in </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">this chapter:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Anaconda Navigator</span></strong><span class="koboSpan" id="kobo.53.1">: Download </span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.54.1">and inst</span><a id="_idTextAnchor018"/><span class="koboSpan" id="kobo.55.1">all the open source Anaconda Navigator from the </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">following URL:</span></span><p class="list-inset"><a href="https://docs.anaconda.com/navigator/install/#system-requirements"><span class="No-Break"><span class="koboSpan" id="kobo.57.1">https://docs.anaconda.com/navigator/install/#system-requirements</span></span></a></p></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.58.1">Jupyter Notebook</span></strong><span class="koboSpan" id="kobo.59.1">: Download </span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.60.1">and install </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">Jupyter Notebook:</span></span><p class="list-inset"><a href="https://jupyter.org/install"><span class="No-Break"><span class="koboSpan" id="kobo.62.1">https://jupyter.org/install</span></span></a></p></li>
<li><span class="koboSpan" id="kobo.63.1">We can also use</span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.64.1"> open source, online Python editors </span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.65.1">such as </span><strong class="bold"><span class="koboSpan" id="kobo.66.1">Google Colab</span></strong><span class="koboSpan" id="kobo.67.1"> (</span><a href="https://colab.research.google.com/"><span class="koboSpan" id="kobo.68.1">https://colab.research.google.com/</span></a><span class="koboSpan" id="kobo.69.1">) or </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.70.1">Replit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.71.1"> (</span></span><a href="https://replit.com/"><span class="No-Break"><span class="koboSpan" id="kobo.72.1">https://replit.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.73.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.74.1">The Python source code and the entire notebook created in this chapter are available in this book’s </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">GitHub repository:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Data-Labeling-in-Machine-Learning-with-Python"><span class="No-Break"><span class="koboSpan" id="kobo.76.1">https://github.com/PacktPublishing/Data-Labeling-in-Machine-Learning-with-Python</span></span></a></p>
<p><span class="koboSpan" id="kobo.77.1">You also need to create an Azure account and add an OpenAI resource for working with generative AI. </span><span class="koboSpan" id="kobo.77.2">To sign up for a free Azure subscription, visit </span><a href="https://azure.microsoft.com/free"><span class="koboSpan" id="kobo.78.1">https://azure.microsoft.com/free</span></a><span class="koboSpan" id="kobo.79.1">. </span><span class="koboSpan" id="kobo.79.2">To request access to the Azure OpenAI service, </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">visit </span></span><a href="https://aka.ms/oaiapply"><span class="No-Break"><span class="koboSpan" id="kobo.81.1">https://aka.ms/oaiapply</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.82.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">Once you have provisioned the Azure OpenAI service, deploy the LLM model – either GPT-3.5-Turbo or GPT 4.0 – from Azure OpenAI Studio. </span><span class="koboSpan" id="kobo.83.2">Then copy the keys for OpenAI from OpenAI Studio and set up the following </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">environment variables:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.85.1">
os.environ['AZURE_OPENAI_KEY'] = 'your_api_key'
os.environ['AZURE_OPENAI_ENDPOINT") ='your_azure_openai_endpoint'</span></pre> <p><span class="koboSpan" id="kobo.86.1">Your endpoint should look like </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">this: </span></span><a href="https://YOUR_RESOURCE_NAME.openai.azure.com/"><span class="No-Break"><span class="koboSpan" id="kobo.88.1">https://YOUR_RESOURCE_NAME.openai.azure.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.89.1">.</span></span></p>
<h1 id="_idParaDest-19"><a id="_idTextAnchor019"/><span class="koboSpan" id="kobo.90.1">EDA and data labeling</span></h1>
<p><span class="koboSpan" id="kobo.91.1">In this section, we will gain an understanding of what</span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.92.1"> EDA is. </span><span class="koboSpan" id="kobo.92.2">We will see why we need to perform it and discuss its advantages. </span><span class="koboSpan" id="kobo.92.3">We will also look at the life cycle of an ML project and learn about the role of data labeling in </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">this cycle.</span></span></p>
<p><span class="koboSpan" id="kobo.94.1">EDA</span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.95.1"> comprises </span><strong class="bold"><span class="koboSpan" id="kobo.96.1">data discovery</span></strong><span class="koboSpan" id="kobo.97.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">data collection</span></strong><span class="koboSpan" id="kobo.99.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">data cleaning</span></strong><span class="koboSpan" id="kobo.101.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">data exploration</span></strong><span class="koboSpan" id="kobo.103.1">. </span><span class="koboSpan" id="kobo.103.2">These steps are part of </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.104.1">any machine learning project. </span><span class="koboSpan" id="kobo.104.2">The </span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.105.1">data exploration step includes tasks such as data visualization, summary </span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.106.1">statistics, correlation analysis, and data distribution analysis. </span><span class="koboSpan" id="kobo.106.2">We will dive deep into these steps in the </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">upcoming sections.</span></span></p>
<p><span class="koboSpan" id="kobo.108.1">Here are some real-world examples</span><a id="_idIndexMarker016"/> <span class="No-Break"><span class="koboSpan" id="kobo.109.1">of EDA:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.110.1">Customer churn analysis</span></strong><span class="koboSpan" id="kobo.111.1">: Suppose </span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.112.1">you work for a telecommunications company and you want to understand why customers are churning (canceling their subscriptions); in this case, conducting EDA on customer churn data can provide </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">valuable insights.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.114.1">Income data analysis</span></strong><span class="koboSpan" id="kobo.115.1">: EDA on </span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.116.1">the </span><em class="italic"><span class="koboSpan" id="kobo.117.1">Income</span></em><span class="koboSpan" id="kobo.118.1"> dataset with predictive features such as education, employment status, and marital status helps to predict whether the salary of a person is greater </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">than $50K.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.120.1">EDA is a </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.121.1">critical process for any ML or data science project, and it allows us to understand the data and gain some valuable insights into the data domain </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">and business.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">In this chapter, we will use various Python libraries, such as Pandas, and call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">describe</span></strong><span class="koboSpan" id="kobo.125.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">info</span></strong><span class="koboSpan" id="kobo.127.1"> functions on Pandas to generate data summaries. </span><span class="koboSpan" id="kobo.127.2">We will discover anomalies in the data and any outliers in the given dataset. </span><span class="koboSpan" id="kobo.127.3">We will also figure out various data types and any missing values in the data. </span><span class="koboSpan" id="kobo.127.4">We will understand whether any data type conversions are required, such as converting </span><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">string</span></strong><span class="koboSpan" id="kobo.129.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">float</span></strong><span class="koboSpan" id="kobo.131.1">, for performing further analysis. </span><span class="koboSpan" id="kobo.131.2">We will also analyze the data formats and see whether any transformations are required to standardize them, such as the date format. </span><span class="koboSpan" id="kobo.131.3">We will analyze the counts of different labels and understand whether the dataset is balanced or imbalanced. </span><span class="koboSpan" id="kobo.131.4">We will understand the relationships between various features in the data and calculate the correlations </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">between features.</span></span></p>
<p><span class="koboSpan" id="kobo.133.1">To summarize, we will understand the patterns in the given dataset and also identify the relationships between various features in the data samples. </span><span class="koboSpan" id="kobo.133.2">Finally, we will come up with a strategy and domain rules for data cleaning and transformation. </span><span class="koboSpan" id="kobo.133.3">This helps us to predict labels for </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">unlabeled data.</span></span></p>
<p><span class="koboSpan" id="kobo.135.1">We will plot various data</span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.136.1"> visualizations using Python </span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.137.1">libraries such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">seaborn</span></strong><span class="koboSpan" id="kobo.139.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.140.1">matplotlib</span></strong><span class="koboSpan" id="kobo.141.1">. </span><span class="koboSpan" id="kobo.141.2">We will create bar charts, histograms, heatmaps, and various charts to visualize the importance of features in the dataset and how they depend on </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">each other.</span></span></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.143.1">Understanding the ML project life cycle</span></h1>
<p><span class="koboSpan" id="kobo.144.1">The</span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.145.1"> following are the major steps in an </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">ML project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer007">
<span class="koboSpan" id="kobo.147.1"><img alt="Figure 1.1 – ML project life cycle diagram" src="image/B18944_01_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.148.1">Figure 1.1 – ML project life cycle diagram</span></p>
<p><span class="koboSpan" id="kobo.149.1">Let’s look at them </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">in detail.</span></span></p>
<h2 id="_idParaDest-21"><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.151.1">Defining the business problem</span></h2>
<p><span class="koboSpan" id="kobo.152.1">The first step in every ML </span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.153.1">project is to understand the </span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.154.1">business problem and define clear goals that can be measured at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">the project.</span></span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.156.1">Data discovery and data collection</span></h2>
<p><span class="koboSpan" id="kobo.157.1">In this step, you identify and gather potential data sources that may be relevant to your project’s objectives. </span><span class="koboSpan" id="kobo.157.2">This involves finding datasets, databases, APIs, or any other sources that may contain the data needed for your analysis </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">and modeling.</span></span></p>
<p><span class="koboSpan" id="kobo.159.1">The goal of </span><strong class="bold"><span class="koboSpan" id="kobo.160.1">data discovery</span></strong><span class="koboSpan" id="kobo.161.1"> is to </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.162.1">understand the landscape of</span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.163.1"> available data and assess its quality, relevance, and </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">potential limitations.</span></span></p>
<p><span class="koboSpan" id="kobo.165.1">Data discovery can also involve discussions with domain experts and stakeholders to identify what data is essential for solving business problems or achieving the </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">project’s goals.</span></span></p>
<p><span class="koboSpan" id="kobo.167.1">After identifying </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.168.1">various sources for data, data engineers will develop data pipelines to extract and load the data to the</span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.169.1"> target data lake and perform some data preprocessing tasks such as data cleaning, de-duplication, and making data readily available to ML engineers and data scientists for </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">further processing.</span></span></p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.171.1">Data exploration</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.172.1">Data exploration</span></strong><span class="koboSpan" id="kobo.173.1"> follows </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.174.1">data discovery and is primarily focused on</span><a id="_idIndexMarker030"/><span class="koboSpan" id="kobo.175.1"> understanding the data, gaining insights, and identifying patterns </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">or anomalies.</span></span></p>
<p><span class="koboSpan" id="kobo.177.1">During data exploration, you may perform basic statistical analysis, create data visualizations, and conduct initial observations to understand the </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">data’s characteristics.</span></span></p>
<p><span class="koboSpan" id="kobo.179.1">Data exploration can also involve identifying missing values, outliers, and potential data quality issues, but it typically does not involve making systematic changes to </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">the data.</span></span></p>
<p><span class="koboSpan" id="kobo.181.1">During data exploration, you assess the available labeled data and determine whether it’s sufficient for your ML task. </span><span class="koboSpan" id="kobo.181.2">If you find that the labeled data is small and insufficient for model training, you may</span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.182.1"> identify the need for additional </span><a id="_idIndexMarker032"/><span class="No-Break"><span class="koboSpan" id="kobo.183.1">labeled data.</span></span></p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.184.1">Data labeling</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.185.1">Data labeling</span></strong><span class="koboSpan" id="kobo.186.1"> involves </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.187.1">acquiring or</span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.188.1"> generating more labeled examples to supplement your training dataset. </span><span class="koboSpan" id="kobo.188.2">You may need to manually label additional data points or use programming techniques such as data augmentation to expand your </span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.189.1">labeled dataset. </span><span class="koboSpan" id="kobo.189.2">The process of assigning labels to data samples is called </span><strong class="bold"><span class="koboSpan" id="kobo.190.1">data annotation</span></strong><span class="koboSpan" id="kobo.191.1"> or </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">data labeling.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">Most of the time, it is too expensive or time-consuming to outsource the manual data labeling task. </span><span class="koboSpan" id="kobo.193.2">Also, data is often not allowed to be shared with external third-party organizations due to data privacy. </span><span class="koboSpan" id="kobo.193.3">So, automating the data labeling process with an in-house development team using Python helps to label the data quickly and at an </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">affordable cost.</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">Most of the data science books available on the market are lacking information about this important step. </span><span class="koboSpan" id="kobo.195.2">So, this book aims to address the various methods to programmatically label data using Python as well as the annotation tools available on </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">the market.</span></span></p>
<p><span class="koboSpan" id="kobo.197.1">After obtaining a sufficient amount of labeled data, you proceed with traditional data preprocessing tasks, such as handling missing values, encoding features, scaling, and </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">feature engineering.</span></span></p>
<h2 id="_idParaDest-25"><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.199.1">Model training</span></h2>
<p><span class="koboSpan" id="kobo.200.1">Once the data is </span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.201.1">adequately </span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.202.1">prepared, then that dataset is fed into the model by ML engineers to train </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">the model.</span></span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor026"/><span class="koboSpan" id="kobo.204.1">Model evaluation</span></h2>
<p><span class="koboSpan" id="kobo.205.1">After the model is</span><a id="_idIndexMarker038"/><span class="koboSpan" id="kobo.206.1"> trained, the next step </span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.207.1">is to evaluate the model on a validation dataset to see how good the model is and avoid bias </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">and overfitting.</span></span></p>
<p><span class="koboSpan" id="kobo.209.1">You can evaluate the model’s performance using various metrics and techniques and iterate on the model-building process </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">as needed.</span></span></p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/><span class="koboSpan" id="kobo.211.1">Model deployment</span></h2>
<p><span class="koboSpan" id="kobo.212.1">Finally, you</span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.213.1"> deploy your </span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.214.1">model into production and monitor for continuous improvement</span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.215.1"> using </span><strong class="bold"><span class="koboSpan" id="kobo.216.1">ML Operations</span></strong><span class="koboSpan" id="kobo.217.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.218.1">MLOps</span></strong><span class="koboSpan" id="kobo.219.1">). </span><span class="koboSpan" id="kobo.219.2">MLOps aims to streamline the process of taking ML models to production and maintaining and </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">monitoring them.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">In this book, we will focus on data labeling. </span><span class="koboSpan" id="kobo.221.2">In a real-world project, the datasets that sources provide us with for analytics and ML are not clean and not labeled. </span><span class="koboSpan" id="kobo.221.3">So, we need to explore unlabeled data to understand correlations and patterns and help us define the rules for data labeling using Python labeling functions. </span><span class="koboSpan" id="kobo.221.4">Data exploration helps us to understand the level of cleaning and transformation required before starting data labeling and </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">model training.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">This is where Python helps us to explore and perform a quick analysis of raw data using various libraries (such as Pandas, Seaborn, and ydata-profiling libraries), otherwise known </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">as EDA.</span></span></p>
<h1 id="_idParaDest-28"><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.225.1">Introducing Pandas DataFrames</span></h1>
<p><span class="koboSpan" id="kobo.226.1">Pandas</span><a id="_idIndexMarker043"/><span class="koboSpan" id="kobo.227.1"> is an open source library used for data analysis and manipulation. </span><span class="koboSpan" id="kobo.227.2">It provides various functions for data wrangling, cleaning, and merging operations. </span><span class="koboSpan" id="kobo.227.3">Let us see how to explore data using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">pandas</span></strong><span class="koboSpan" id="kobo.229.1"> library. </span><span class="koboSpan" id="kobo.229.2">For this, we will use the </span><em class="italic"><span class="koboSpan" id="kobo.230.1">Income</span></em><span class="koboSpan" id="kobo.231.1"> dataset located on GitHub and explore it to find the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">following insights:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.233.1">How many unique values are there for age, education, and profession in the </span><em class="italic"><span class="koboSpan" id="kobo.234.1">Income</span></em><span class="koboSpan" id="kobo.235.1"> dataset? </span><span class="koboSpan" id="kobo.235.2">What are the observations for each </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">unique age?</span></span></li>
<li><span class="koboSpan" id="kobo.237.1">Summary statistics such as mean value and quantile values for each feature. </span><span class="koboSpan" id="kobo.237.2">What is the average age of the adult for the income range &gt; $</span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">50K?</span></span></li>
<li><span class="koboSpan" id="kobo.239.1">How is income dependent on independent variables such as age, education, and profession using </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">bivariate analysis?</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.241.1">Let us first read the data into a DataFrame using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">pandas</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.243.1"> library.</span></span></p>
<p><span class="koboSpan" id="kobo.244.1">A DataFrame</span><a id="_idIndexMarker044"/><span class="koboSpan" id="kobo.245.1"> is a structure that represents two-dimensional data with columns and rows, and it is similar to a SQL table. </span><span class="koboSpan" id="kobo.245.2">To get started, ensure that you create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">requirements.txt</span></strong><span class="koboSpan" id="kobo.247.1"> file and add the required Python libraries </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer008">
<span class="koboSpan" id="kobo.249.1"><img alt="Figure 1.2 – Contents of the requirements.txt file" src="image/B18944_01_02..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.250.1">Figure 1.2 – Contents of the requirements.txt file</span></p>
<p><span class="koboSpan" id="kobo.251.1">Next, run</span><a id="_idIndexMarker045"/><span class="koboSpan" id="kobo.252.1"> the following command from your Python notebook cell to install the libraries added in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">requirements.txt</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.254.1"> file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.255.1">
%pip install -r requirements.txt</span></pre> <p><span class="koboSpan" id="kobo.256.1">Now, let’s import the required Python libraries using the following </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">import</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.258.1"> statements:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.259.1">
# import libraries for loading dataset
import pandas as pd
import numpy as np
# import libraries for plotting
import matplotlib.pyplot as plt
import seaborn as sns
from matplotlib import rcParams
%matplotlib inline
plt.style.use('dark_background')
# ignore warnings
import warnings
warnings.filterwarnings('ignore')</span></pre> <p><span class="koboSpan" id="kobo.260.1">Next, in the following code snippet, we are reading the </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">adult_income.csv</span></strong><span class="koboSpan" id="kobo.262.1"> file and writing to the </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">DataFrame (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">df</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.266.1">
# loading the dataset
df = pd.read_csv("&lt;your file path&gt;/adult_income.csv", encoding='latin-1)'</span></pre> <p><span class="koboSpan" id="kobo.267.1">Now the data is loaded </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">df</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.271.1">Let us see the size of the DataFrame using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.273.1">
df.shape</span></pre> <p><span class="koboSpan" id="kobo.274.1">We will see the </span><a id="_idIndexMarker046"/><span class="koboSpan" id="kobo.275.1">shape of the DataFrame as </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">a result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer009">
<span class="koboSpan" id="kobo.277.1"><img alt="Figure 1.3 – Shape of the DataFrame" src="image/B18944_01_03..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.278.1">Figure 1.3 – Shape of the DataFrame</span></p>
<p><span class="koboSpan" id="kobo.279.1">So, we can see that there are 32,561 observations (rows) and 15 features (columns) in </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">the dataset.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Let us print the 15 column names in </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">the dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.283.1">
df.columns</span></pre> <p><span class="koboSpan" id="kobo.284.1">We get the </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">following result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer010">
<span class="koboSpan" id="kobo.286.1"><img alt="Figure 1.4 – The names of the columns in our dataset" src="image/B18944_01_04..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.287.1">Figure 1.4 – The names of the columns in our dataset</span></p>
<p><span class="koboSpan" id="kobo.288.1">Now, let’s see the first five rows of the data in the dataset with the </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.290.1">
df.head()</span></pre> <p><span class="koboSpan" id="kobo.291.1">We can see the output in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.292.1">Figure 1</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.293.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer011">
<span class="koboSpan" id="kobo.295.1"><img alt="Figure 1.5 – The first five rows of data" src="image/B18944_01_05..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.296.1">Figure 1.5 – The first five rows of data</span></p>
<p><span class="koboSpan" id="kobo.297.1">Let’s see the last five rows of the dataset using </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">tail</span></strong><span class="koboSpan" id="kobo.299.1">, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">following figure:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.301.1">
df.tail()</span></pre> <p><span class="koboSpan" id="kobo.302.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">following output.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer012">
<span class="koboSpan" id="kobo.304.1"><img alt="Figure 1.6 – The last five rows of data" src="image/B18944_01_06..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.305.1">Figure 1.6 – The last five rows of data</span></p>
<p><span class="koboSpan" id="kobo.306.1">As we can see, </span><strong class="source-inline"><span class="koboSpan" id="kobo.307.1">education</span></strong><span class="koboSpan" id="kobo.308.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">education.num</span></strong><span class="koboSpan" id="kobo.310.1"> are redundant columns, as </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">education.num </span></strong><span class="koboSpan" id="kobo.312.1">is just the ordinal representation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">education</span></strong><span class="koboSpan" id="kobo.314.1"> column. </span><span class="koboSpan" id="kobo.314.2">So, we will remove</span><a id="_idIndexMarker047"/><span class="koboSpan" id="kobo.315.1"> the redundant </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">education.num</span></strong><span class="koboSpan" id="kobo.317.1"> column from the dataset as one column is enough for model training. </span><span class="koboSpan" id="kobo.317.2">We will also drop the </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">race</span></strong><span class="koboSpan" id="kobo.319.1"> column from the dataset using the following code snippet as we will not use </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">it here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.321.1">
# As we observe education and education.num both are the same , so we can drop one of the columns
df.drop(['education.num'], axis = 1, inplace = True)
df.drop(['race'], axis = 1, inplace = True)</span></pre> <p><span class="koboSpan" id="kobo.322.1">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">axis = 1</span></strong><span class="koboSpan" id="kobo.324.1"> refers to the columns axis, which means that you are specifying that you want to drop a column. </span><span class="koboSpan" id="kobo.324.2">In this case, you are dropping the columns labeled </span><strong class="source-inline"><span class="koboSpan" id="kobo.325.1">education.num</span></strong><span class="koboSpan" id="kobo.326.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">race</span></strong><span class="koboSpan" id="kobo.328.1"> from </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">the DataFrame.</span></span></p>
<p><span class="koboSpan" id="kobo.330.1">Now, let’s print the columns using </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">info()</span></strong><span class="koboSpan" id="kobo.332.1"> to make sure the </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">race</span></strong><span class="koboSpan" id="kobo.334.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">education.num</span></strong><span class="koboSpan" id="kobo.336.1"> columns are dropped from </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">the DataFrame:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.338.1">
df.info()</span></pre> <p><span class="koboSpan" id="kobo.339.1">We will see the </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer013">
<span class="koboSpan" id="kobo.341.1"><img alt="Figure 1.7 – Columns in the DataFrame" src="image/B18944_01_07..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.342.1">Figure 1.7 – Columns in the DataFrame</span></p>
<p><span class="koboSpan" id="kobo.343.1">We can see in the</span><a id="_idIndexMarker048"/><span class="koboSpan" id="kobo.344.1"> preceding data there are now only 13 columns as we deleted 2 of them from the previous total of </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">15 columns.</span></span></p>
<p><span class="koboSpan" id="kobo.346.1">In this section, we have seen what a Pandas DataFrame is and loaded a CSV dataset into one. </span><span class="koboSpan" id="kobo.346.2">We also saw the various columns in the DataFrame and their data types. </span><span class="koboSpan" id="kobo.346.3">In the following section, we will generate the summary statistics for the important features </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">using Pandas.</span></span></p>
<h1 id="_idParaDest-29"><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.348.1">Summary statistics and data aggregates</span></h1>
<p><span class="koboSpan" id="kobo.349.1">In this section, we will derive the summary statistics</span><a id="_idIndexMarker049"/><span class="koboSpan" id="kobo.350.1"> for </span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">numerical columns.</span></span></p>
<p><span class="koboSpan" id="kobo.352.1">Before generating summary statistics, we will identify the categorical columns and numerical columns in the dataset. </span><span class="koboSpan" id="kobo.352.2">Then, we will calculate the summary statistics for all </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">numerical columns.</span></span></p>
<p><span class="koboSpan" id="kobo.354.1">We will also calculate the mean value of each numerical column for the target class. </span><span class="koboSpan" id="kobo.354.2">Summary statistics are useful to gain insights about each feature’s mean values and their effect on the target </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">label class.</span></span></p>
<p><span class="koboSpan" id="kobo.356.1">Let’s print the </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">categorical</span></strong><span class="koboSpan" id="kobo.358.1"> columns using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.360.1">
#categorical column
catogrical_column = [column for column in df.columns if df[column].
</span><span class="koboSpan" id="kobo.360.2">dtypes=='object']
print(catogrical_column)</span></pre> <p><span class="koboSpan" id="kobo.361.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">following result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer014">
<span class="koboSpan" id="kobo.363.1"><img alt="Figure 1.8 – Categorical columns" src="image/B18944_01_08..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.364.1">Figure 1.8 – Categorical columns</span></p>
<p><span class="koboSpan" id="kobo.365.1">Now, let’s print the </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">numerical</span></strong><span class="koboSpan" id="kobo.367.1"> columns using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.369.1">
#numerical_column
numerical_column = [column for column in df.columns if df[column].dtypes !='object']
print(numerical_column)</span></pre> <p><span class="koboSpan" id="kobo.370.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer015">
<span class="koboSpan" id="kobo.372.1"><img alt="Figure 1.9 – Numerical columns" src="image/B18944_01_09..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.373.1">Figure 1.9 – Numerical columns</span></p>
<h2 id="_idParaDest-30"><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.374.1">Summary statistics</span></h2>
<p><span class="koboSpan" id="kobo.375.1">Now, let’s generate </span><a id="_idIndexMarker050"/><span class="koboSpan" id="kobo.376.1">summary statistics (i.e., mean, standard deviation, minimum value, maximum value, and lower (25%), middle (50%), and higher (75%) percentiles) using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.378.1">
df.describe().T</span></pre> <p><span class="koboSpan" id="kobo.379.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">following results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer016">
<span class="koboSpan" id="kobo.381.1"><img alt="Figure 1.10 – Summary statistics" src="image/B18944_01_10..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.382.1">Figure 1.10 – Summary statistics</span></p>
<p><span class="koboSpan" id="kobo.383.1">As shown in the results, the mean value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">age</span></strong><span class="koboSpan" id="kobo.385.1"> is 38.5 years, the minimum age is 17 years, and the maximum age is 90 years in the dataset. </span><span class="koboSpan" id="kobo.385.2">As we have only five numerical columns in the dataset, we can only see five rows in this summary </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">statistics table.</span></span></p>
<h2 id="_idParaDest-31"><a id="_idTextAnchor031"/><span class="koboSpan" id="kobo.387.1">Data aggregates of the feature for each target class</span></h2>
<p><span class="koboSpan" id="kobo.388.1">Now, let’s calculate the</span><a id="_idIndexMarker051"/><span class="koboSpan" id="kobo.389.1"> average age of the people for each income group range using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.391.1">
df.groupby("income")["age"].mean()</span></pre> <p><span class="koboSpan" id="kobo.392.1">We will see the </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer017">
<span class="koboSpan" id="kobo.394.1"><img alt="Figure 1.11 – Average age by income group" src="image/B18944_01_11..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.395.1">Figure 1.11 – Average age by income group</span></p>
<p><span class="koboSpan" id="kobo.396.1">As shown in the results, we have used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">groupby</span></strong><span class="koboSpan" id="kobo.398.1"> clause on the target variable and calculated the mean of the age in each group. </span><span class="koboSpan" id="kobo.398.2">The mean age is 36.78 for people with an income group of less than or equal to $50K. </span><span class="koboSpan" id="kobo.398.3">Similarly, the mean age is 44.2 for the income group greater </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">than $50K.</span></span></p>
<p><span class="koboSpan" id="kobo.400.1">Now, let’s </span><a id="_idIndexMarker052"/><span class="koboSpan" id="kobo.401.1">calculate the average hours per week of the people for each income group range using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.403.1">
df.groupby("income")["hours.per.week"]. </span><span class="koboSpan" id="kobo.403.2">mean()</span></pre> <p><span class="koboSpan" id="kobo.404.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer018">
<span class="koboSpan" id="kobo.406.1"><img alt="Figure 1.12 – Average hours per week by income group" src="image/B18944_01_12..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.407.1">Figure 1.12 – Average hours per week by income group</span></p>
<p><span class="koboSpan" id="kobo.408.1">As shown in the results, the average hours per week for the income group =&lt; $50K is 38.8 hours. </span><span class="koboSpan" id="kobo.408.2">Similarly, the average hours per week for the income group &gt; $50K is </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">45.47 hours.</span></span></p>
<p><span class="koboSpan" id="kobo.410.1">Alternatively, we can write a generic reusable function for calculating</span><a id="_idIndexMarker053"/><span class="koboSpan" id="kobo.411.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.412.1">mean</span></strong><span class="koboSpan" id="kobo.413.1"> of any </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">numerical</span></strong><span class="koboSpan" id="kobo.415.1"> column group by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">categorical</span></strong><span class="koboSpan" id="kobo.417.1"> column </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.419.1">
def get_groupby_stats(categorical, numerical):
    groupby_df = df[[categorical, numerical]].groupby(categorical). 
</span><span class="koboSpan" id="kobo.419.2">        mean().dropna()
    print(groupby_df.head)</span></pre> <p><span class="koboSpan" id="kobo.420.1">If we want to get aggregations of multiple columns for each target income group, then we can calculate aggregations </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.422.1">
columns_to_show = ["age", "hours.per.week"]
df.groupby(["income"])[columns_to_show].agg(['mean', 'std', 'max', 'min'])</span></pre> <p><span class="koboSpan" id="kobo.423.1">We get the </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">following results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer019">
<span class="koboSpan" id="kobo.425.1"><img alt="Figure 1.13 – Aggregations for multiple columns" src="image/B18944_01_13..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.426.1">Figure 1.13 – Aggregations for multiple columns</span></p>
<p><span class="koboSpan" id="kobo.427.1">As shown</span><a id="_idIndexMarker054"/><span class="koboSpan" id="kobo.428.1"> in the results, we have calculated the summary statistics for age and hours per week for each </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">income group.</span></span></p>
<p><span class="koboSpan" id="kobo.430.1">We learned how to calculate the aggregate values of features for the target group using reusable functions. </span><span class="koboSpan" id="kobo.430.2">This aggregate value gives us a correlation of those features for the target </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">label value.</span></span></p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.432.1">Creating visualizations using Seaborn for univariate and bivariate analysis</span></h1>
<p><span class="koboSpan" id="kobo.433.1">In this section, we are going to explore each variable separately. </span><span class="koboSpan" id="kobo.433.2">We are going to summarize the data for each feature and analyze the pattern present </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">in it.</span></span></p>
<p><span class="koboSpan" id="kobo.435.1">Univariate analysis</span><a id="_idIndexMarker055"/><span class="koboSpan" id="kobo.436.1"> is an analysis using individual features. </span><span class="koboSpan" id="kobo.436.2">We will also perform a bivariate analysis</span><a id="_idIndexMarker056"/><span class="koboSpan" id="kobo.437.1"> later in </span><span class="No-Break"><span class="koboSpan" id="kobo.438.1">this section.</span></span></p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.439.1">Univariate analysis</span></h2>
<p><span class="koboSpan" id="kobo.440.1">Now, let us do a univariate analysis</span><a id="_idIndexMarker057"/><span class="koboSpan" id="kobo.441.1"> for the age, education, work class, hours per week, and </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">occupation features.</span></span></p>
<p><span class="koboSpan" id="kobo.443.1">First, let’s get the counts of unique values for each column using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.445.1">
df.nunique()</span></pre> <div>
<div class="IMG---Figure" id="_idContainer020">
<span class="koboSpan" id="kobo.446.1"><img alt="Figure 1.14 – Unique values for each column" src="image/B18944_01_14..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.447.1">Figure 1.14 – Unique values for each column</span></p>
<p><span class="koboSpan" id="kobo.448.1">As shown in the results, there</span><a id="_idIndexMarker058"/><span class="koboSpan" id="kobo.449.1"> are 73 unique values for </span><strong class="source-inline"><span class="koboSpan" id="kobo.450.1">age</span></strong><span class="koboSpan" id="kobo.451.1">, 9 unique values for </span><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">workclass</span></strong><span class="koboSpan" id="kobo.453.1">, 16 unique values for </span><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">education</span></strong><span class="koboSpan" id="kobo.455.1">, 15 unique values for </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">occupation</span></strong><span class="koboSpan" id="kobo.457.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.459.1">Now, let us see the unique values count for </span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">age</span></strong><span class="koboSpan" id="kobo.461.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">the DataFrame:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.463.1">
df["age"].value_counts()</span></pre> <p><span class="koboSpan" id="kobo.464.1">The result is </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer021">
<span class="koboSpan" id="kobo.466.1"><img alt="Figure 1.15 – Value counts for age" src="image/B18944_01_15..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.467.1">Figure 1.15 – Value counts for age</span></p>
<p><span class="koboSpan" id="kobo.468.1">We can see in the </span><a id="_idIndexMarker059"/><span class="koboSpan" id="kobo.469.1">results that there are 898 observations (rows) with the age of 36. </span><span class="koboSpan" id="kobo.469.2">Similarly, there are 6 observations with the age </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">of 83.</span></span></p>
<h3><span class="koboSpan" id="kobo.471.1">Histogram of age</span></h3>
<p><span class="koboSpan" id="kobo.472.1">Histograms are used to</span><a id="_idIndexMarker060"/><span class="koboSpan" id="kobo.473.1"> visualize the distribution of continuous data. </span><span class="koboSpan" id="kobo.473.2">Continuous data is data that can take on any value within a range (e.g., age, height, weight, </span><span class="No-Break"><span class="koboSpan" id="kobo.474.1">temperature, etc.).</span></span></p>
<p><span class="koboSpan" id="kobo.475.1">Let us plot a histogram using Seaborn to see the distribution of </span><strong class="source-inline"><span class="koboSpan" id="kobo.476.1">age</span></strong><span class="koboSpan" id="kobo.477.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">the dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.479.1">
#univariate analysis
sns.histplot(data=df['age'],kde=True)</span></pre> <p><span class="koboSpan" id="kobo.480.1">We get the </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">following results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer022">
<span class="koboSpan" id="kobo.482.1"><img alt="Figure 1.16 – The histogram of age" src="image/B18944_01_16..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.483.1">Figure 1.16 – The histogram of age</span></p>
<p><span class="koboSpan" id="kobo.484.1">As we can see</span><a id="_idIndexMarker061"/><span class="koboSpan" id="kobo.485.1"> in the age histogram, there are many people in the age range of 23 to 45 in the given observations in </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">the dataset.</span></span></p>
<h3><span class="koboSpan" id="kobo.487.1">Bar plot of education</span></h3>
<p><span class="koboSpan" id="kobo.488.1">Now, let us check the </span><a id="_idIndexMarker062"/><span class="koboSpan" id="kobo.489.1">distribution of </span><strong class="source-inline"><span class="koboSpan" id="kobo.490.1">education</span></strong><span class="koboSpan" id="kobo.491.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">given dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.493.1">
df['education'].value_counts()
Let us plot the bar chart for education.
</span><span class="koboSpan" id="kobo.493.2">colors = ["white","red", "green", "blue", "orange", "yellow", "purple"]
df.education.value_counts().plot.bar(color=colors,legend=True)</span></pre> <div>
<div class="IMG---Figure" id="_idContainer023">
<span class="koboSpan" id="kobo.494.1"><img alt="Figure 1.17 – The bar chart of education" src="image/B18944_01_17..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.495.1">Figure 1.17 – The bar chart of education</span></p>
<p><span class="koboSpan" id="kobo.496.1">As we </span><a id="_idIndexMarker063"/><span class="koboSpan" id="kobo.497.1">see, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">HS.grad</span></strong><span class="koboSpan" id="kobo.499.1"> count is higher than that for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">Bachelors</span></strong><span class="koboSpan" id="kobo.501.1"> degree holders. </span><span class="koboSpan" id="kobo.501.2">Similarly, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">Masters</span></strong><span class="koboSpan" id="kobo.503.1"> degree holders count is lower than the </span><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">Bachelors</span></strong><span class="koboSpan" id="kobo.505.1"> degree </span><span class="No-Break"><span class="koboSpan" id="kobo.506.1">holders count.</span></span></p>
<h3><span class="koboSpan" id="kobo.507.1">Bar chart of workclass</span></h3>
<p><span class="koboSpan" id="kobo.508.1">Now, let’s see the</span><a id="_idIndexMarker064"/><span class="koboSpan" id="kobo.509.1"> distribution of </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">workclass</span></strong><span class="koboSpan" id="kobo.511.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">the dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.513.1">
df['workclass'].value_counts()</span></pre> <p><span class="koboSpan" id="kobo.514.1">Let’s plot the bar chart to visualize the distribution of different values </span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">workclass</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer024">
<span class="koboSpan" id="kobo.518.1"><img alt="Figure 1.18 – Bar chart of workclass" src="image/B18944_01_18..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.519.1">Figure 1.18 – Bar chart of workclass</span></p>
<p><span class="koboSpan" id="kobo.520.1">As shown in </span><a id="_idIndexMarker065"/><span class="koboSpan" id="kobo.521.1">the </span><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">workclass</span></strong><span class="koboSpan" id="kobo.523.1"> bar chart, there are more private employees than </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">other kinds.</span></span></p>
<h3><span class="koboSpan" id="kobo.525.1">Bar chart of income</span></h3>
<p><span class="koboSpan" id="kobo.526.1">Let’s see the </span><a id="_idIndexMarker066"/><span class="koboSpan" id="kobo.527.1">unique value for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">income</span></strong><span class="koboSpan" id="kobo.529.1"> target variable and see the distribution </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">income</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.533.1">
df['income'].value_counts()</span></pre> <p><span class="koboSpan" id="kobo.534.1">The result is </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer025">
<span class="koboSpan" id="kobo.536.1"><img alt="Figure 1.19 – Distribution of income" src="image/B18944_01_19..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.537.1">Figure 1.19 – Distribution of income</span></p>
<p><span class="koboSpan" id="kobo.538.1">As shown in the results, there are 24,720 observations with an income greater than $50K and 7,841 observations with an income of less than $50K. </span><span class="koboSpan" id="kobo.538.2">In the real world, more people have an income greater than $50K and a small portion of people have less than $50K income, assuming the income is in US dollars and for 1 year. </span><span class="koboSpan" id="kobo.538.3">As this ratio closely reflects the real-world </span><a id="_idIndexMarker067"/><span class="koboSpan" id="kobo.539.1">scenario, we do not need to balance the minority class dataset using </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">synthetic data.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer026">
<span class="koboSpan" id="kobo.541.1"><img alt="Figure 1.20 – Bar chart of income" src="image/B18944_01_20..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.542.1">Figure 1.20 – Bar chart of income</span></p>
<p><span class="koboSpan" id="kobo.543.1">In this section, we have seen the size of the data, column names, and data types, and the first and last five rows of the dataset. </span><span class="koboSpan" id="kobo.543.2">We also dropped some unnecessary columns. </span><span class="koboSpan" id="kobo.543.3">We performed univariate analysis to see the unique value counts and plotted the bar charts and histograms to understand the distribution of values for </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">important columns.</span></span></p>
<h2 id="_idParaDest-34"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.545.1">Bivariate analysis</span></h2>
<p><span class="koboSpan" id="kobo.546.1">Let’s do a bivariate analysis</span><a id="_idIndexMarker068"/><span class="koboSpan" id="kobo.547.1"> of age and income to find the relationship between them. </span><span class="koboSpan" id="kobo.547.2">Bivariate analysis is the analysis of two variables to find the relationship between them. </span><span class="koboSpan" id="kobo.547.3">We will plot a histogram using the Python Seaborn library to visualize the relationship between </span><strong class="source-inline"><span class="koboSpan" id="kobo.548.1">age</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.549.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.550.1">income</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.552.1">
#Bivariate analysis of age and income
sns.histplot(data=df,kde=True,x='age',hue='income')</span></pre> <p><span class="koboSpan" id="kobo.553.1">The plot is </span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer027">
<span class="koboSpan" id="kobo.555.1"><img alt="Figure 1.21 – Histogram of age with income" src="image/B18944_01_21..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.556.1">Figure 1.21 – Histogram of age with income</span></p>
<p><span class="koboSpan" id="kobo.557.1">From the preceding histogram, we can see that income is greater than $50K for the age group between 30 and 60. </span><span class="koboSpan" id="kobo.557.2">Similarly, for the age group less than 30, income is less </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">than $50K.</span></span></p>
<p><span class="koboSpan" id="kobo.559.1">Now let’s plot the histogram to do a bivariate analysis of </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">education</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.561.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">income</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.564.1">
#Bivariate Analysis of  education and Income
sns.histplot(data=df,y='education', hue='income',multiple="dodge");</span></pre> <p><span class="koboSpan" id="kobo.565.1">Here is </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">the plot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer028">
<span class="koboSpan" id="kobo.567.1"><img alt="Figure 1.22 – Histogram of education with income" src="image/B18944_01_22..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.568.1">Figure 1.22 – Histogram of education with income</span></p>
<p><span class="koboSpan" id="kobo.569.1">From the preceding histogram, we</span><a id="_idIndexMarker069"/><span class="koboSpan" id="kobo.570.1"> can see that income is greater than $50K for the majority of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.571.1">Masters</span></strong><span class="koboSpan" id="kobo.572.1"> education adults. </span><span class="koboSpan" id="kobo.572.2">On the other hand, income is less than $50K for the majority of </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">HS-grad adults</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.575.1">Now, let’s plot the histogram to do a bivariate analysis of </span><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">workclass</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.577.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">income</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.580.1">
#Bivariate Analysis of work class and Income
sns.histplot(data=df,y='workclass', hue='income',multiple="dodge");</span></pre> <p><span class="koboSpan" id="kobo.581.1">We get the </span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">following plot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer029">
<span class="koboSpan" id="kobo.583.1"><img alt="Figure 1.23 – Histogram of workclass and income" src="image/B18944_01_23..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.584.1">Figure 1.23 – Histogram of workclass and income</span></p>
<p><span class="koboSpan" id="kobo.585.1">From the preceding</span><a id="_idIndexMarker070"/><span class="koboSpan" id="kobo.586.1"> histogram, we can see that income is greater than $50K for </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">Self-emp-inc</span></strong><span class="koboSpan" id="kobo.588.1"> adults. </span><span class="koboSpan" id="kobo.588.2">On the other hand, income is less than $50K for the majority of </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">Private</span></strong><span class="koboSpan" id="kobo.590.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">Self-emp-not-inc</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.592.1"> employees.</span></span></p>
<p><span class="koboSpan" id="kobo.593.1">Now let’s plot the histogram to do a bivariate analysis of </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">sex</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.595.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">income</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.598.1">
#Bivariate Analysis of  Sex and Income
sns.histplot(data=df,y='sex', hue='income',multiple="dodge");</span></pre> <div>
<div class="IMG---Figure" id="_idContainer030">
<span class="koboSpan" id="kobo.599.1"><img alt="Figure 1.24 – Histogram of sex and income" src="image/B18944_01_24..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.600.1">Figure 1.24 – Histogram of sex and income</span></p>
<p><span class="koboSpan" id="kobo.601.1">From the preceding</span><a id="_idIndexMarker071"/><span class="koboSpan" id="kobo.602.1"> histogram, we can see that income is more than $50K for male adults and less than $50K for most </span><span class="No-Break"><span class="koboSpan" id="kobo.603.1">female employees.</span></span></p>
<p><span class="koboSpan" id="kobo.604.1">In this section, we have learned how to analyze data using Seaborn </span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">visualization libraries.</span></span></p>
<p><span class="koboSpan" id="kobo.606.1">Alternatively, we can explore data using the ydata-profiling library with a few lines </span><span class="No-Break"><span class="koboSpan" id="kobo.607.1">of code.</span></span></p>
<h1 id="_idParaDest-35"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.608.1">Profiling data using the ydata-profiling library</span></h1>
<p><span class="koboSpan" id="kobo.609.1">In this section, let us</span><a id="_idIndexMarker072"/><span class="koboSpan" id="kobo.610.1"> explore the dataset and generate a profiling report with </span><a id="_idIndexMarker073"/><span class="koboSpan" id="kobo.611.1">various statistics using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">ydata-profiling</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.613.1">library (</span></span><a href="https://docs.profiling.ydata.ai/4.5/"><span class="No-Break"><span class="koboSpan" id="kobo.614.1">https://docs.profiling.ydata.ai/4.5/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.615.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.616.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">ydata-profiling</span></strong><span class="koboSpan" id="kobo.618.1"> library is a Python library for easy EDA, profiling, and </span><span class="No-Break"><span class="koboSpan" id="kobo.619.1">report generation.</span></span></p>
<p><span class="koboSpan" id="kobo.620.1">Let us see how to </span><a id="_idIndexMarker074"/><span class="koboSpan" id="kobo.621.1">use </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">ydata-profiling</span></strong><span class="koboSpan" id="kobo.623.1"> for fast </span><a id="_idIndexMarker075"/><span class="koboSpan" id="kobo.624.1">and </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">efficient EDA:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.626.1">Install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">ydata-profiling</span></strong><span class="koboSpan" id="kobo.628.1"> library using </span><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">pip</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.630.1">as follows:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.631.1">pip install ydata-profiling</span></strong></pre></li> <li><span class="koboSpan" id="kobo.632.1">First, let us import the Pandas profiling library </span><span class="No-Break"><span class="koboSpan" id="kobo.633.1">as follows:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.634.1">from ydata_profiling import ProfileReport</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.635.1">Then, we can use Pandas profiling to </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">generate reports.</span></span></p></li> <li><span class="koboSpan" id="kobo.637.1">Now, we will read the </span><em class="italic"><span class="koboSpan" id="kobo.638.1">Income</span></em><span class="koboSpan" id="kobo.639.1"> dataset into the </span><span class="No-Break"><span class="koboSpan" id="kobo.640.1">Pandas DataFrame:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.641.1">df=pd.read_csv('adult.csv',na_values=-999)</span></strong></pre></li> <li><span class="koboSpan" id="kobo.642.1">Let us run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.643.1">upgrade</span></strong><span class="koboSpan" id="kobo.644.1"> command to make sure we have the latest </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">profiling library:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.646.1">%pip install ydata-profiling --upgrade</span></strong></pre></li> <li><span class="koboSpan" id="kobo.647.1">Now let us run the following commands to generate the </span><span class="No-Break"><span class="koboSpan" id="kobo.648.1">profiling report:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.649.1">report = ProfileReport(df)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.650.1">report</span></strong></pre></li> </ol>
<p><span class="koboSpan" id="kobo.651.1">We can also generate the report using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.652.1">profile_report()</span></strong><span class="koboSpan" id="kobo.653.1"> function on the </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">Pandas DataFrame.</span></span></p>
<p><span class="koboSpan" id="kobo.655.1">After running the preceding cell, all the data loaded in </span><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">df</span></strong><span class="koboSpan" id="kobo.657.1"> will be analyzed and the report will be generated. </span><span class="koboSpan" id="kobo.657.2">The time taken to generate the report depends on the size of </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">the dataset.</span></span></p>
<p><span class="koboSpan" id="kobo.659.1">The output of the preceding cell is a report with sections. </span><span class="koboSpan" id="kobo.659.2">Let us understand the report that </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">is generated.</span></span></p>
<p><span class="koboSpan" id="kobo.661.1">The generated profiling report contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">following sections:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.663.1">Overview</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.664.1">Variables</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.665.1">Interactions</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.666.1">Correlations</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.667.1">Missing values</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.668.1">Sample</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.669.1">Duplicate rows</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.670.1">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.671.1">Overview</span></strong><span class="koboSpan" id="kobo.672.1"> section in the report, there are </span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">three tabs:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.674.1">Overview</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.675.1">Alerts</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.676.1">Reproduction</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.677.1">As shown in the</span><a id="_idIndexMarker076"/><span class="koboSpan" id="kobo.678.1"> following figure, the </span><strong class="bold"><span class="koboSpan" id="kobo.679.1">Overview</span></strong><span class="koboSpan" id="kobo.680.1"> tab shows statistical </span><a id="_idIndexMarker077"/><span class="koboSpan" id="kobo.681.1">information about the dataset – that is, the number of columns (number of variables) in the dataset; the number of rows (number of observations), duplicate rows, and missing cells; the percentage of duplicate rows and missing cells; and the number of </span><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">Numeric</span></strong><span class="koboSpan" id="kobo.683.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.684.1">Categorical</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.685.1"> variables:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer031">
<span class="koboSpan" id="kobo.686.1"><img alt="Figure 1.25 – Statistics of the dataset" src="image/B18944_01_25..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.687.1">Figure 1.25 – Statistics of the dataset</span></p>
<p><span class="koboSpan" id="kobo.688.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.689.1">Alerts</span></strong><span class="koboSpan" id="kobo.690.1"> tab </span><a id="_idIndexMarker078"/><span class="koboSpan" id="kobo.691.1">under </span><strong class="bold"><span class="koboSpan" id="kobo.692.1">Overview</span></strong><span class="koboSpan" id="kobo.693.1"> shows all the variables that </span><a id="_idIndexMarker079"/><span class="koboSpan" id="kobo.694.1">are highly correlated with each other and the number of cells that have zero values, </span><span class="No-Break"><span class="koboSpan" id="kobo.695.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<span class="koboSpan" id="kobo.696.1"><img alt="Figure 1.26 – Alerts" src="image/B18944_01_26..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.697.1">Figure 1.26 – Alerts</span></p>
<p><span class="koboSpan" id="kobo.698.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.699.1">Reproduction </span></strong><span class="koboSpan" id="kobo.700.1">tab </span><a id="_idIndexMarker080"/><span class="koboSpan" id="kobo.701.1">under </span><strong class="bold"><span class="koboSpan" id="kobo.702.1">Overview</span></strong><span class="koboSpan" id="kobo.703.1"> shows the </span><a id="_idIndexMarker081"/><span class="koboSpan" id="kobo.704.1">duration it took for the analysis to generate this report, </span><span class="No-Break"><span class="koboSpan" id="kobo.705.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<span class="koboSpan" id="kobo.706.1"><img alt="Figure 1.27 – Reproduction" src="image/B18944_01_27..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.707.1">Figure 1.27 – Reproduction</span></p>
<h2 id="_idParaDest-36"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.708.1">Variables section</span></h2>
<p><span class="koboSpan" id="kobo.709.1">Let us </span><a id="_idIndexMarker082"/><span class="koboSpan" id="kobo.710.1">walk through the </span><strong class="bold"><span class="koboSpan" id="kobo.711.1">Variables</span></strong><span class="koboSpan" id="kobo.712.1"> section in </span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">the report.</span></span></p>
<p><span class="koboSpan" id="kobo.714.1">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.715.1">Variables</span></strong><span class="koboSpan" id="kobo.716.1"> section, we can select any variable in the dataset under the dropdown and see the statistical information about the dataset, such as the number of unique values for that variable, missing values for that variable, the size of that variable, and </span><span class="No-Break"><span class="koboSpan" id="kobo.717.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.718.1">In the following figure, we selected the </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">age</span></strong><span class="koboSpan" id="kobo.720.1"> variable in the dropdown and can see the statistics about </span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">that variable:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<span class="koboSpan" id="kobo.722.1"><img alt="Figure 1.28 – Variables" src="image/B18944_01_28..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.723.1">Figure 1.28 – Variables</span></p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.724.1">Interactions section</span></h2>
<p><span class="koboSpan" id="kobo.725.1">As shown in the following figure, this</span><a id="_idIndexMarker083"/><span class="koboSpan" id="kobo.726.1"> report also contains the </span><strong class="bold"><span class="koboSpan" id="kobo.727.1">Interactions</span></strong><span class="koboSpan" id="kobo.728.1"> plot to show how one variable relates to </span><span class="No-Break"><span class="koboSpan" id="kobo.729.1">another variable:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<span class="koboSpan" id="kobo.730.1"><img alt="Figure 1.29 – Interactions" src="image/B18944_01_29..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.731.1">Figure 1.29 – Interactions</span></p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.732.1">Correlations</span></h2>
<p><span class="koboSpan" id="kobo.733.1">Now, let's see</span><a id="_idIndexMarker084"/><span class="koboSpan" id="kobo.734.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.735.1">Correlations</span></strong><span class="koboSpan" id="kobo.736.1"> section in the report; we can see the correlation between various variables in </span><strong class="bold"><span class="koboSpan" id="kobo.737.1">Heatmap</span></strong><span class="koboSpan" id="kobo.738.1">. </span><span class="koboSpan" id="kobo.738.2">Also, we can see various correlation coefficients in the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.739.1">Table</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.740.1"> form.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<span class="koboSpan" id="kobo.741.1"><img alt="Figure 1.30 ﻿– Correlations" src="image/B18944_01_30..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.742.1">Figure 1.30 – Correlations</span></p>
<p><span class="koboSpan" id="kobo.743.1">Heatmaps use </span><a id="_idIndexMarker085"/><span class="koboSpan" id="kobo.744.1">color intensity to represent values. </span><span class="koboSpan" id="kobo.744.2">The colors typically range from cool to warm hues, with cool colors (e.g., blue or green) indicating low values and warm colors (e.g., red or orange) indicating high values. </span><span class="koboSpan" id="kobo.744.3">Rows and columns of the matrix are represented on both the </span><em class="italic"><span class="koboSpan" id="kobo.745.1">x</span></em><span class="koboSpan" id="kobo.746.1"> axis and </span><em class="italic"><span class="koboSpan" id="kobo.747.1">y</span></em><span class="koboSpan" id="kobo.748.1"> axis of the heatmap. </span><span class="koboSpan" id="kobo.748.2">Each cell at the intersection of a row and column represents a specific value in </span><span class="No-Break"><span class="koboSpan" id="kobo.749.1">the data.</span></span></p>
<p><span class="koboSpan" id="kobo.750.1">The color intensity of each cell corresponds to the magnitude of the value it represents. </span><span class="koboSpan" id="kobo.750.2">Darker colors indicate higher values, while lighter colors represent </span><span class="No-Break"><span class="koboSpan" id="kobo.751.1">lower values.</span></span></p>
<p><span class="koboSpan" id="kobo.752.1">As we can see in the preceding figure, the intersection cell between income and hours per week shows a high-intensity blue color, which indicates there is a high correlation between income and hours per week. </span><span class="koboSpan" id="kobo.752.2">Similarly, the intersection cell between income and capital gain shows a high-intensity blue color, indicating a high correlation between those </span><span class="No-Break"><span class="koboSpan" id="kobo.753.1">two features.</span></span></p>
<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.754.1">Missing values</span></h2>
<p><span class="koboSpan" id="kobo.755.1">This section of the</span><a id="_idIndexMarker086"/><span class="koboSpan" id="kobo.756.1"> report shows the counts of total values present within the data and provides a good understanding of whether there are any </span><span class="No-Break"><span class="koboSpan" id="kobo.757.1">missing values.</span></span></p>
<p><span class="koboSpan" id="kobo.758.1">Under </span><strong class="bold"><span class="koboSpan" id="kobo.759.1">Missing values</span></strong><span class="koboSpan" id="kobo.760.1">, we can see </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">two tabs:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.762.1">The </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.763.1">Count</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.764.1"> plot</span></span></li>
<li><span class="koboSpan" id="kobo.765.1">The </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.766.1">Matrix</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.767.1"> plot</span></span></li>
</ul>
<h3><span class="koboSpan" id="kobo.768.1">Count plot</span></h3>
<p><span class="koboSpan" id="kobo.769.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.770.1">Figure 1</span></em></span><em class="italic"><span class="koboSpan" id="kobo.771.1">.31</span></em><span class="koboSpan" id="kobo.772.1">, the shows that all variables have a count of 32,561, which is the count of rows (observations) in the dataset. </span><span class="koboSpan" id="kobo.772.2">That indicates that there are no missing values in </span><span class="No-Break"><span class="koboSpan" id="kobo.773.1">the dataset.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.774.1"><img alt="Figure 1.31 – Missing values count" src="image/B18944_01_31..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.775.1">Figure 1.31 – Missing values count</span></p>
<h3><span class="koboSpan" id="kobo.776.1">Matrix plot</span></h3>
<p><span class="koboSpan" id="kobo.777.1">The</span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.778.1"> following </span><strong class="bold"><span class="koboSpan" id="kobo.779.1">Matrix</span></strong><span class="koboSpan" id="kobo.780.1"> plot indicates where the missing values are (if there are any missing values in </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">the dataset):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer038">
<span class="koboSpan" id="kobo.782.1"><img alt="Figure 1.32 – Missing values matrix" src="image/B18944_01_32..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.783.1">Figure 1.32 – Missing values matrix</span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.784.1">Sample data</span></h2>
<p><span class="koboSpan" id="kobo.785.1">This </span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.786.1">section shows the sample data for the first 10 rows and the last 10 rows in </span><span class="No-Break"><span class="koboSpan" id="kobo.787.1">the dataset.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.788.1"><img alt="Figure 1.33 – Sample data" src="image/B18944_01_33..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.789.1">Figure 1.33 – Sample data</span></p>
<p><span class="koboSpan" id="kobo.790.1">This section</span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.791.1"> shows the most frequently occurring rows and the number of duplicates in </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">the dataset.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer040">
<span class="koboSpan" id="kobo.793.1"><img alt="Figure 1.34 – Duplicate rows" src="image/B18944_01_34..jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.794.1">Figure 1.34 – Duplicate rows</span></p>
<p><span class="koboSpan" id="kobo.795.1">We have seen how to analyze the data using Pandas and then how to visualize the data by plotting various plots such as bar charts and histograms using sns, seaborn, and pandas-ydata-profiling. </span><span class="koboSpan" id="kobo.795.2">Next, let us see how to perform data analysis using OpenAI LLM and the LangChain Pandas Dataframe agent by asking questions with </span><span class="No-Break"><span class="koboSpan" id="kobo.796.1">natural language.</span></span></p>
<h1 id="_idParaDest-41"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.797.1">Unlocking insights from data with OpenAI and LangChain</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.798.1">Artificial intelligence</span></strong><span class="koboSpan" id="kobo.799.1"> is transforming how people analyze and interpret data. </span><span class="koboSpan" id="kobo.799.2">Exciting </span><strong class="bold"><span class="koboSpan" id="kobo.800.1">generative AI</span></strong><span class="koboSpan" id="kobo.801.1"> systems allow anyone to have natural conversations with their data, even if they have no coding or data science expertise. </span><span class="koboSpan" id="kobo.801.2">This democratization of data promises to uncover insights and patterns that may have previously </span><span class="No-Break"><span class="koboSpan" id="kobo.802.1">remained hidden.</span></span></p>
<p><span class="koboSpan" id="kobo.803.1">One pioneering system in this space is </span><strong class="bold"><span class="koboSpan" id="kobo.804.1">LangChain</span></strong><span class="koboSpan" id="kobo.805.1">’s </span><strong class="bold"><span class="koboSpan" id="kobo.806.1">Pandas DataFrame agent</span></strong><span class="koboSpan" id="kobo.807.1">, which leverages the power of </span><strong class="bold"><span class="koboSpan" id="kobo.808.1">large language models</span></strong><span class="koboSpan" id="kobo.809.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.810.1">LLMs</span></strong><span class="koboSpan" id="kobo.811.1">) such as </span><strong class="bold"><span class="koboSpan" id="kobo.812.1">Azure OpenAI</span></strong><span class="koboSpan" id="kobo.813.1">’s </span><strong class="bold"><span class="koboSpan" id="kobo.814.1">GPT-4</span></strong><span class="koboSpan" id="kobo.815.1">. </span><span class="koboSpan" id="kobo.815.2">LLMs are AI systems trained on massive text datasets, allowing them to generate human-like text. </span><span class="koboSpan" id="kobo.815.3">LangChain provides a framework to connect LLMs with external </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">data sources.</span></span></p>
<p><span class="koboSpan" id="kobo.817.1">By simply describing in plain English what you want to know about your data stored in a Pandas DataFrame, this agent can automatically respond in </span><span class="No-Break"><span class="koboSpan" id="kobo.818.1">natural language.</span></span></p>
<p><span class="koboSpan" id="kobo.819.1">The user experience feels like magic. </span><span class="koboSpan" id="kobo.819.2">You upload a CSV dataset and ask a question by typing or speaking. </span><span class="koboSpan" id="kobo.819.3">For example, </span><em class="italic"><span class="koboSpan" id="kobo.820.1">“What were the top 3 best-selling products last year?”</span></em><span class="koboSpan" id="kobo.821.1"> The agent interprets your intent and writes and runs Pandas and Python code to load the data, analyze it, and formulate a response...all within seconds. </span><span class="koboSpan" id="kobo.821.2">The barrier between human language and data </span><span class="No-Break"><span class="koboSpan" id="kobo.822.1">analysis dissolves.</span></span></p>
<p><span class="koboSpan" id="kobo.823.1">Under the hood, the LLM generates Python code based on your question, which gets passed to the LangChain agent for execution. </span><span class="koboSpan" id="kobo.823.2">The agent handles running the code against your DataFrame, capturing any output or errors, and iterating if necessary to refine the analysis until an accurate human-readable answer </span><span class="No-Break"><span class="koboSpan" id="kobo.824.1">is reached.</span></span></p>
<p><span class="koboSpan" id="kobo.825.1">By collaborating, the agent and LLM remove the need to worry about syntax, APIs, parameters, or debugging data analysis code. </span><span class="koboSpan" id="kobo.825.2">The system understands what you want to know and makes it happen automatically through the magic of </span><span class="No-Break"><span class="koboSpan" id="kobo.826.1">generative AI.</span></span></p>
<p><span class="koboSpan" id="kobo.827.1">This natural language interface to data analysis opens game-changing potential. </span><span class="koboSpan" id="kobo.827.2">Subject-matter experts without programming skills can independently extract insights from data in their field. </span><span class="koboSpan" id="kobo.827.3">Data-driven decisions can happen faster. </span><span class="koboSpan" id="kobo.827.4">Exploratory analysis and ideation are simpler. </span><span class="koboSpan" id="kobo.827.5">The future where analytics is available to all AI assistants </span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">has arrived.</span></span></p>
<p><span class="koboSpan" id="kobo.829.1">Let’s see how the agent works behind the scenes to send </span><span class="No-Break"><span class="koboSpan" id="kobo.830.1">a response.</span></span></p>
<p><span class="koboSpan" id="kobo.831.1">When a user sends a query to the LangChain </span><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">create_pandas_dataframe_agent</span></strong><span class="koboSpan" id="kobo.833.1"> agent and LLM, the following steps are performed behind </span><span class="No-Break"><span class="koboSpan" id="kobo.834.1">the scenes:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.835.1">The user’s query is received by the </span><span class="No-Break"><span class="koboSpan" id="kobo.836.1">LangChain agent.</span></span></li>
<li><span class="koboSpan" id="kobo.837.1">The agent interprets the user’s query and analyzes </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">its intention.</span></span></li>
<li><span class="koboSpan" id="kobo.839.1">The agent then generates the necessary commands to perform the first step of the analysis. </span><span class="koboSpan" id="kobo.839.2">For example, it could generate an SQL query that is sent to the tool that the agent knows will execute </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">SQL queries.</span></span></li>
<li><span class="koboSpan" id="kobo.841.1">The agent analyzes the response it receives from the tool and determines whether it is what the user wants. </span><span class="koboSpan" id="kobo.841.2">If it is, the agent returns the answer; if not, the agent analyzes what the next step should be and </span><span class="No-Break"><span class="koboSpan" id="kobo.842.1">iterates again.</span></span></li>
<li><span class="koboSpan" id="kobo.843.1">The agent keeps generating commands for the tools it can control until it obtains the response the user is looking for. </span><span class="koboSpan" id="kobo.843.2">It is even capable of interpreting execution errors that occur and generating the corrected command. </span><span class="koboSpan" id="kobo.843.3">The agent iterates until it satisfies the user’s question or reaches the limit we </span><span class="No-Break"><span class="koboSpan" id="kobo.844.1">have set.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.845.1">We can represent this with the </span><span class="No-Break"><span class="koboSpan" id="kobo.846.1">following diagram:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<span class="koboSpan" id="kobo.847.1"><img alt="Figure 1.35 – LangChain Pandas agent flow for Data analysis" src="image/B18944_01_35.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.848.1">Figure 1.35 – LangChain Pandas agent flow for Data analysis</span></p>
<p><span class="koboSpan" id="kobo.849.1">Let’s see how to perform data analysis and find insights about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.850.1">income</span></strong><span class="koboSpan" id="kobo.851.1"> dataset using the LangChain </span><strong class="source-inline"><span class="koboSpan" id="kobo.852.1">create_pandas_dataframe_agent</span></strong><span class="koboSpan" id="kobo.853.1"> agent </span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">and LLM.</span></span></p>
<p><span class="koboSpan" id="kobo.855.1">The key steps are importing the necessary LangChain modules, loading data into a DataFrame, instantiating an LLM, and creating the DataFrame agent by passing the required objects. </span><span class="koboSpan" id="kobo.855.2">The agent can now analyze the data through natural </span><span class="No-Break"><span class="koboSpan" id="kobo.856.1">language queries.</span></span></p>
<p><span class="koboSpan" id="kobo.857.1">First, let’s install the required libraries. </span><span class="koboSpan" id="kobo.857.2">To install the LangChain library, open your Python notebook and type </span><span class="No-Break"><span class="koboSpan" id="kobo.858.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.859.1">
    %pip install langchain
    %pip install langchain_experimental</span></pre> <p><span class="koboSpan" id="kobo.860.1">This installs the </span><strong class="source-inline"><span class="koboSpan" id="kobo.861.1">langchain</span></strong><span class="koboSpan" id="kobo.862.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.863.1">langchain_experimental</span></strong><span class="koboSpan" id="kobo.864.1"> packages so you can import the </span><span class="No-Break"><span class="koboSpan" id="kobo.865.1">necessary modules.</span></span></p>
<p><span class="koboSpan" id="kobo.866.1">Let’s import </span><strong class="source-inline"><span class="koboSpan" id="kobo.867.1">AzureChatOpenAI</span></strong><span class="koboSpan" id="kobo.868.1">, the Pandas DataFrame agent, and other </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">required libraries:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.870.1">
from langchain.chat_models import AzureChatOpenAI
from langchain_experimental.agents import create_pandas_dataframe_agent
import os
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import openai</span></pre> <p><span class="koboSpan" id="kobo.871.1">Let’s configure the OpenAI endpoint and keys. </span><span class="koboSpan" id="kobo.871.2">Your OpenAI endpoint and key values are available in the Azure </span><span class="No-Break"><span class="koboSpan" id="kobo.872.1">OpenAI portal:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.873.1">
openai.api_type = "azure"
openai.api_base = "your_endpoint"
openai.api_version = "2023-09-15-preview"
openai.api_key = "your_key"
# We are assuming that you have all model deployments on the same Azure OpenAI service resource above.  If not, you can change these settings below to point to different resources.
</span><span class="koboSpan" id="kobo.873.2">gpt4_endpoint = openai.api_base # Your endpoint will look something like this: https://YOUR_AOAI_RESOURCE_NAME.openai.azure.com/
gpt4_api_key = openai.api_key # Your key will look something like this: 00000000000000000000000000000000
gpt4_deployment_name="your model deployment name"</span></pre> <p><span class="koboSpan" id="kobo.874.1">Let’s load CSV data into </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">Pandas DataFrame.</span></span></p>
<p><span class="koboSpan" id="kobo.876.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.877.1">adult.csv</span></strong><span class="koboSpan" id="kobo.878.1"> dataset is the dataset that we want to analyze and we have placed this CSV file in the same folder where we are running this </span><span class="No-Break"><span class="koboSpan" id="kobo.879.1">Python code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.880.1">
df = pd.read_csv("adult.csv")</span></pre> <p><span class="koboSpan" id="kobo.881.1">Let’s instantiate the </span><span class="No-Break"><span class="koboSpan" id="kobo.882.1">GPT-4 LLM.</span></span></p>
<p><span class="koboSpan" id="kobo.883.1">Assuming, you have deployed the GPT-4 model in Azure OpenAI Studio as per the </span><em class="italic"><span class="koboSpan" id="kobo.884.1">Technical requirements</span></em><span class="koboSpan" id="kobo.885.1"> section, here, we are passing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.886.1">gpt4</span></strong><span class="koboSpan" id="kobo.887.1"> endpoint, key, and deployment name to create the instance of GPT-4 </span><span class="No-Break"><span class="koboSpan" id="kobo.888.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.889.1">
gpt4 = AzureChatOpenAI(
    openai_api_base=gpt4_endpoint,
    openai_api_version="2023-03-15-preview",
    deployment_name=gpt4_deployment_name,
    openai_api_key=gpt4_api_key,
    openai_api_type = openai.api_type,
)</span></pre> <p><span class="koboSpan" id="kobo.890.1">Setting the temperature to </span><strong class="source-inline"><span class="koboSpan" id="kobo.891.1">0.0</span></strong><span class="koboSpan" id="kobo.892.1"> has the model return the most </span><span class="No-Break"><span class="koboSpan" id="kobo.893.1">accurate outputs.</span></span></p>
<p><span class="koboSpan" id="kobo.894.1">Let’s create a Pandas DataFrame agent. </span><span class="koboSpan" id="kobo.894.2">To create the Pandas DataFrame agent, we need to pass the </span><strong class="source-inline"><span class="koboSpan" id="kobo.895.1">gpt4</span></strong><span class="koboSpan" id="kobo.896.1"> model instance and </span><span class="No-Break"><span class="koboSpan" id="kobo.897.1">the DataFrame:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.898.1">
    agent = create_pandas_dataframe_agent(gpt4, df, verbose=True)</span></pre> <p><span class="koboSpan" id="kobo.899.1">Pass the </span><strong class="source-inline"><span class="koboSpan" id="kobo.900.1">gpt4</span></strong><span class="koboSpan" id="kobo.901.1"> LLM instance and the DataFrame, and set </span><strong class="source-inline"><span class="koboSpan" id="kobo.902.1">verbose</span></strong><span class="koboSpan" id="kobo.903.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.904.1">True</span></strong><span class="koboSpan" id="kobo.905.1"> to see the output. </span><span class="koboSpan" id="kobo.905.2">Finally, let’s ask a question and run </span><span class="No-Break"><span class="koboSpan" id="kobo.906.1">the agent.</span></span></p>
<p><span class="koboSpan" id="kobo.907.1">As illustrated in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.908.1">Figure 1</span></em></span><em class="italic"><span class="koboSpan" id="kobo.909.1">.36</span></em><span class="koboSpan" id="kobo.910.1">, when we ask the following questions to the LangChain agent in the Python notebook, the question is passed to the LLM. </span><span class="koboSpan" id="kobo.910.2">The LLM generates Python code for this query and sends it back to the agent. </span><span class="koboSpan" id="kobo.910.3">The agent then executes this code in the Python environment with the CSV file, obtains a response, and the LLM converts that response to natural language before sending it back to the agent and </span><span class="No-Break"><span class="koboSpan" id="kobo.911.1">the user:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.912.1">
agent("how many rows and how many columns are there?")</span></pre> <p><span class="No-Break"><span class="koboSpan" id="kobo.913.1">Output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer042">
<span class="koboSpan" id="kobo.914.1"><img alt="Figure 1.36 – Agent response for row and column count" src="image/B18944_01_36.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.915.1">Figure 1.36 – Agent response for row and column count</span></p>
<p><span class="koboSpan" id="kobo.916.1">We try the </span><span class="No-Break"><span class="koboSpan" id="kobo.917.1">next question:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.918.1">
agent("sample first 5 records and display?")</span></pre> <p><span class="koboSpan" id="kobo.919.1">Here’s </span><span class="No-Break"><span class="koboSpan" id="kobo.920.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer043">
<span class="koboSpan" id="kobo.921.1"><img alt="Figure 1.37 – agent response for first five records" src="image/B18944_01_37.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.922.1">Figure 1.37 – agent response for first five records</span></p>
<p><span class="koboSpan" id="kobo.923.1">This way, the LangChain Pandas DataFrame agent facilitates interaction with the DataFrame by interpreting natural language queries, generating corresponding Python code, and presenting the results in a </span><span class="No-Break"><span class="koboSpan" id="kobo.924.1">human-readable format.</span></span></p>
<p><span class="koboSpan" id="kobo.925.1">You can try these questions and see the responses from </span><span class="No-Break"><span class="koboSpan" id="kobo.926.1">the agent:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.927.1">query = "calculate the average age of the people for each income </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.928.1">group ?"</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.929.1">query ="provide summary statistics for </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.930.1">this dataset"</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.931.1">query = "provide count of unique values for </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.932.1">each column"</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.933.1">query = "draw the histogram of </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.934.1">the age"</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.935.1">Next, let’s try the following query to plot the </span><span class="No-Break"><span class="koboSpan" id="kobo.936.1">bar chart:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.937.1">
query = "draw the bar chart  for the column education"
results = agent(query)</span></pre> <p><span class="koboSpan" id="kobo.938.1">The Langchain agent responded with a bar chart that shows the counts for different education levels, </span><span class="No-Break"><span class="koboSpan" id="kobo.939.1">as follows.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer044">
<span class="koboSpan" id="kobo.940.1"><img alt="Figure 1.38 – Agent response for bar chart" src="image/B18944_01_38.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.941.1">Figure 1.38 – Agent response for bar chart</span></p>
<p><span class="koboSpan" id="kobo.942.1">The plot of the following query shows a comparison of income for different education levels – master’s and HS-GRAD. </span><span class="koboSpan" id="kobo.942.2">And we can see the income is less than $5,000 for </span><strong class="source-inline"><span class="koboSpan" id="kobo.943.1">education.num</span></strong><span class="koboSpan" id="kobo.944.1"> 8 to 10 when compared to </span><span class="No-Break"><span class="koboSpan" id="kobo.945.1">higher education:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.946.1">
query = "Compare the income of those have Masters with those have HS-grad using KDE plot"
results = agent(query)</span></pre> <p><span class="koboSpan" id="kobo.947.1">Here’s </span><span class="No-Break"><span class="koboSpan" id="kobo.948.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<span class="koboSpan" id="kobo.949.1"><img alt="Figure 1.39 – Agent response for comparison of income" src="image/B18944_01_39.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.950.1">Figure 1.39 – Agent response for comparison of income</span></p>
<p><span class="koboSpan" id="kobo.951.1">Next, let’s try the following query to find any outliers in </span><span class="No-Break"><span class="koboSpan" id="kobo.952.1">the data:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.953.1">
query = "Are there  any outliers in terms of age. </span><span class="koboSpan" id="kobo.953.2">Find out using Box plot."
</span><span class="koboSpan" id="kobo.953.3">results = agent(query)</span></pre> <p><span class="koboSpan" id="kobo.954.1">This plot shows outliers in age greater than </span><span class="No-Break"><span class="koboSpan" id="kobo.955.1">80 years.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<span class="koboSpan" id="kobo.956.1"><img alt="Figure 1.40 – Agent response for outliers" src="image/B18944_01_40.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.957.1">Figure 1.40 – Agent response for outliers</span></p>
<p><span class="koboSpan" id="kobo.958.1">We have seen how to perform data analysis and find insights about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.959.1">income</span></strong><span class="koboSpan" id="kobo.960.1"> dataset using natural language with the power of LangChain and </span><span class="No-Break"><span class="koboSpan" id="kobo.961.1">OpenAI LLMs.</span></span></p>
<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.962.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.963.1">In this chapter, we have learned how to use Pandas and matplotlib to analyze a dataset and understand the data and correlations between various features. </span><span class="koboSpan" id="kobo.963.2">This understanding of data and patterns in the data is required to build the rules for labeling raw data before using it for training ML models and </span><span class="No-Break"><span class="koboSpan" id="kobo.964.1">fine-tuning LLMs.</span></span></p>
<p><span class="koboSpan" id="kobo.965.1">We also went through various examples for aggregating columns and categorical values using </span><strong class="source-inline"><span class="koboSpan" id="kobo.966.1">groupby</span></strong><span class="koboSpan" id="kobo.967.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.968.1">mean</span></strong><span class="koboSpan" id="kobo.969.1">. </span><span class="koboSpan" id="kobo.969.2">Then, we created reusable functions so that those functions can be reused simply by calling and passing column names to get aggregates of one or </span><span class="No-Break"><span class="koboSpan" id="kobo.970.1">more columns.</span></span></p>
<p><span class="koboSpan" id="kobo.971.1">Finally, we saw a fast and easy exploration of data using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.972.1">ydata-profiling</span></strong><span class="koboSpan" id="kobo.973.1"> library with simple one-line Python code. </span><span class="koboSpan" id="kobo.973.2">Using this library, we need not remember many Pandas functions. </span><span class="koboSpan" id="kobo.973.3">We can simply call one line of code to perform a detailed analysis of data. </span><span class="koboSpan" id="kobo.973.4">We can create detailed reports of statistics for each variable with missing values, correlations, interactions, and </span><span class="No-Break"><span class="koboSpan" id="kobo.974.1">duplicate rows.</span></span></p>
<p><span class="koboSpan" id="kobo.975.1">Once we get a good sense of our data using EDA, we will be able to build the rules for creating labels for </span><span class="No-Break"><span class="koboSpan" id="kobo.976.1">the dataset.</span></span></p>
<p><span class="koboSpan" id="kobo.977.1">In the next chapter, we will see how to build these rules using Python libraries such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.978.1">snorkel</span></strong><span class="koboSpan" id="kobo.979.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.980.1">compose</span></strong><span class="koboSpan" id="kobo.981.1"> to label an unlabeled dataset. </span><span class="koboSpan" id="kobo.981.2">We will also explore other methods, such as pseudo-labeling and K-means clustering, for </span><span class="No-Break"><span class="koboSpan" id="kobo.982.1">data labeling.</span></span></p>
</div>
</body></html>