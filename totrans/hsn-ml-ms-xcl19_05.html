<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Importing Data into Excel from Different Data Sources</h1>
                </header>
            
            <article>
                
<p>Serious data analysis and machine learning cannot be done by using hand-typed data. Data sources come in different flavors and sizes, and Excel can handle many of them. This chapter deals with how to import data from different sources, which is the first step of any analysis.</p>
<p>Get &amp; Transform (known as <strong>Power Query</strong> in Excel versions before 2016) is a powerful tool that you can use to load data from different sources and transform it. These transformations are necessary so that you have a clean data sample that you can then use to train and test any machine learning model.</p>
<p><span>If you are running Excel 2010 SP1 or Excel 2013</span>, you need to download and install Power Query. Refer link <a href="https://www.microsoft.com/en-us/download/details.aspx?id=39379">https://www.microsoft.com/en-us/download/details.aspx?id=39379</a> for instructions on how to install it.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Importing data from a text file</li>
<li>Importing data from another Excel workbook</li>
<li><span>Importing data from a web page</span></li>
<li><span>Importing data from Facebook</span></li>
<li>Importing data from a JSON file</li>
<li>Importing data from a database</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>You will need to download the <kbd>homes.csv</kbd>, <kbd>homes.txt</kbd>, <kbd>titanic.xls</kbd>, and <kbd>azure_text_analytics.json</kbd> files from this book's GitHub repository at <a href="https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03">https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from a text file</h1>
                </header>
            
            <article>
                
<p>The more commonly used data text file is <strong>comma-separated values</strong> (<strong>CSV</strong>). As the name suggests, values are written to the file in rows and, for each row, a comma separates the values belonging to each column. Open a new workbook and follow these steps:</p>
<ol>
<li>Click on <span class="packt_screen">Data.</span></li>
<li>Navigate to <em><span class="packt_screen">Get Data</span></em> | <em><span class="packt_screen">From File</span></em> | <em><span class="packt_screen">From Text/CSV</span></em>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/eb58bb3b-d5b6-4c78-b103-029ef1de0c6d.png" style="width:50.33em;height:21.08em;"/></p>
<ol start="3">
<li>Navigate to the file's location and open the <kbd>homes.csv</kbd> file.</li>
</ol>
<ol start="4">
<li>A window will pop up, showing you a preview of the file's contents, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/edb7f2e3-2a95-4597-95d5-c45faa205359.png" style="width:52.00em;height:25.00em;"/></p>
<p style="padding-left: 60px">We can see that Excel correctly identifies the different columns by using the right delimiter (comma). It also tries to detect the data types automatically. There is a small problem, though. This file is not pure CSV, and has an extra line at the beginning, showing us where it was downloaded from originally. This is good for giving credit to the original author, but it confuses the loading process a bit. Fortunately, this situation has already been taken into account. To solve this issue, c<span>lick on</span> <span class="packt_screen">Edit</span>.</p>
<ol start="5">
<li>A window will pop up, containing many options to deal with these file format differences:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b1afec1d-0bd1-4d9b-96ed-9c227c325305.png" style="width:51.83em;height:26.83em;"/></p>
<ol start="6">
<li>Navigate to <em><span class="packt_screen">Remove Rows</span></em> | <em><span class="packt_screen">Remove Top Rows.</span></em></li>
<li>You will see the option to specify how many rows you want to skip. In this file, we need to skip <kbd>2</kbd> rows, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8c5578ea-90b1-41bd-a4aa-2c3ccc70518a.png" style="width:37.17em;height:13.42em;"/></p>
<p style="padding-left: 60px">After removing the rows, we keep only the data of interest. You will notice that the file headers haven't been used as column names yet, which would be ideal. To correct this, c<span>lick on</span> <span class="packt_screen">Use First Row as Headers</span>.</p>
<ol start="8">
<li>The result of this is shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d449e040-48f3-4695-9631-a81a67694a77.png" style="width:55.67em;height:28.67em;"/></p>
<p>Note that a list of the steps have been applied to the input data, to the right of the table. This allows you to undo any of your actions and is useful to keep track of what you have done, especially if you make more complicated transformations, like the ones we will show you in the next chapter.</p>
<p>The process is almost ready, except for the data type of each column. Originally, it was set automatically to text, since the first two rows, that we skipped later, were evaluated as not containing numerical data. There are two types of columns: <kbd>Acres</kbd> shows decimal numbers, while the rest show integer or whole numbers. To define the data type correctly, perform the following steps:</p>
<ol>
<li>Select <kbd>Acres</kbd>.</li>
<li>Navigate to <span class="packt_screen">Data Type</span> in the <span class="packt_screen">Transform</span> menu.</li>
<li>Change the type to <span class="packt_screen">Decimal Number.</span></li>
<li>Select the rest of the columns and change the type to <span class="packt_screen">Whole Number</span> to fix the other columns.</li>
</ol>
<ol start="5">
<li>Finally, click on <span class="packt_screen">Close &amp; Load</span><span>. You will see the following data table:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/131c346e-4fa7-4e7e-975b-e64425ec56e6.png"/></p>
<p>This table looks like any Excel table, except that we can always double-click on the query (called <kbd>homes</kbd>) and perform more transformations or even undo the ones we've already made.</p>
<p>If the file is not a CSV file but just a text file that's using a different separator, we can still load it using a similar procedure. We just repeat the steps we used for importing the CSV file:</p>
<ol>
<li>Click on <span class="packt_screen">Data</span>.</li>
<li>Navigate to <em><span class="packt_screen">Get Data</span></em> | <em><span class="packt_screen">From File</span></em> | <em><span class="packt_screen">From Text/CSV</span></em>.</li>
<li>Navigate to the file's location and open <kbd>homes.txt</kbd>. You will see the following preview:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5b5137bb-b29e-4760-b079-5ba582fcf643.png" style="width:37.75em;height:18.33em;"/></p>
<p style="padding-left: 60px">In this case, there are no extra lines at the beginning, but we can see that Excel fails to identify the column delimiter, which is the <kbd>|</kbd> character. To fix this, s<span>elect</span> <span class="packt_screen">Custom</span> <span>from the drop-down menu.</span></p>
<ol start="4">
<li>Type <span><kbd>|</kbd>.</span></li>
<li>The result is that the data is now correctly separated into columns. The columns are automatically labeled using the file header and the data types are guessed correctly, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/11f958ce-f023-41e2-bfcd-a88d99942510.png" style="width:52.17em;height:25.00em;"/></p>
<p>The final result is a table that is identical to the one we loaded from <kbd>homes.csv</kbd>, but that took less steps to obtain since the file structure was simpler.</p>
<p>In this section, we have learned how to import a text file into Excel, which is the simplest case. Let's continue with some more complex examples.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from another Excel workbook</h1>
                </header>
            
            <article>
                
<p>Why would <span><span>we</span></span> import data from an Excel workbook if we can just open it? The main reason is to take advantage of the transformations we can do using Get &amp; Transform. We will show this by using a file containing real data from the Titanic passengers, which is often used to test machine learning classification models and predict whether a given passenger survived the tragedy or not.</p>
<p>Let's follow some simple steps to load and transform the data. While in a new workbook, follow these steps:</p>
<ol>
<li><span>Click on</span> <span class="packt_screen">Data.</span></li>
<li><span>Navigate to</span> <span class="packt_screen">Get Data</span> | <span class="packt_screen">From File</span> | <span class="packt_screen">From Workbook</span>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/823c4c39-81d8-4aeb-83ac-3f3bb56182fd.png" style="width:55.75em;height:23.42em;"/></p>
<p style="padding-left: 60px">The preview window is slightly different to the one we see when opening a CSV file, as you can see in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/7c7c2b86-db46-4c7b-b4e0-555415581841.png" style="width:52.50em;height:41.92em;"/></p>
<p style="padding-left: 60px">In the left part of the preview, you can see a folder named <kbd>titanic.xls</kbd>, which represents the file, and below that the worksheets contained within. <kbd>Dictionary</kbd> is just a short description of the variables; the data is contained in the <kbd>Passenger data</kbd> sheet.</p>
<p style="padding-left: 60px"><span>When this item is selected, we will see a table containing the data. We can click on</span> <span class="packt_screen">Load</span> <span>and put the data in our worksheet, but first we will try one of the transformations that we will discuss in detail in the next chapter. To do this, c</span><span>lick on</span> <span class="packt_screen">Edit</span> <span>and get to the</span> <span class="packt_screen">Query Editor</span><span>, as shown in the following screenshot:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/2c4884bc-84a0-4af0-a556-672540e337a1.png"/></p>
<p style="padding-left: 60px">The columns are identified correctly and the names that are taken from the column names are placed in the input file. You can see that one of the columns, <kbd>cabin</kbd>, contains missing values, identified as <kbd>null</kbd>. This means that, for those passengers, there is no information about which cabin in the ship they where occupying. Some machine learning models do not accept empty values, so we need to fix this by s<span>electing the column, as shown in the preceding screenshot.</span></p>
<ol start="3">
<li>Click on <span class="packt_screen">Replace Values</span> in the <span class="packt_screen">Transform</span> menu.</li>
<li>You will get a pop-up dialog where you can tell Excel to replace <kbd>null</kbd> with <kbd>Unknown</kbd>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1879af25-7f8b-4071-9fa1-1b0655d203fe.png" style="width:28.67em;height:15.75em;"/></p>
<p style="padding-left: 60px">The result is what you can see in the following screenshot, where all <kbd>null</kbd> values are replaced with <kbd>Unknown</kbd>. This is both more elegant and easier to manage by machine learning models:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/42f58f44-a39c-4bd1-9b1d-0e8c7ac28ace.png"/></p>
<p>Many different transformations can be performed on the data using the <span class="packt_screen">Query Editor</span>. We will show other examples in the next chapter. You should try to test different options as well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from a web page</h1>
                </header>
            
            <article>
                
<p>If a web page contains data in tabular form, then Excel is able to import these tables automatically. As an example, we will import a table from the Wikipedia page about Excel. Here's how we will go about it:</p>
<ol>
<li><span>C</span>lick on <span class="packt_screen">Data</span> and then navigate to <span class="packt_screen">Get Data</span> | <span class="packt_screen">From Other Sources</span> | <span class="packt_screen">From Web</span>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/a8546c95-ea93-49a9-9b78-7f8c86841c2e.png" style="width:54.25em;height:30.50em;"/></p>
<ol start="2">
<li>In the dialog that pops up, we type in the URL of the mentioned web page and click <span class="packt_screen">OK</span>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/fa49887f-3868-48f3-8a26-7e5caaffcd9e.png" style="width:34.08em;height:12.42em;"/></p>
<ol start="3">
<li>Now, we will be able to see a list of available tables. Pick the one showing Excel's release history. A table preview is shown to the right, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d11c8a9b-5c72-4f76-9fd2-bb5e3cf972c1.png" style="width:49.83em;height:36.67em;"/></p>
<ol start="4">
<li>As we did before, we can just load the data or edit it, transforming the values according to our needs. The final result is an Excel table.</li>
</ol>
<div class="packt_tip">We also have the choice of changing to web view and seeing the target web page as we would in Internet Explorer, which can help us to identify which information is useful for our analysis.</div>
<p class="mce-root">We have seen how easy it is to import data from a web page. Now, let's explore importing data from one of the most popular websites: Facebook.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from Facebook</h1>
                </header>
            
            <article>
                
<p>It is possible to import data directly from a Facebook profile or page. If we want to, for example, register the dates and times when a new post appears, we could follow these steps:</p>
<ol>
<li>Click on <span class="packt_screen">Data.</span></li>
<li>Navigate to <span class="packt_screen">Get Data</span> | <span class="packt_screen">From Online Services</span> | <span class="packt_screen">From Facebook</span>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/dcbf16e2-ab85-4435-8142-547ee88c99cb.png" style="width:57.17em;height:31.42em;"/></p>
<p class="mce-root"/>
<ol start="3">
<li>You need to specify the user or page name, which is the last part of the page URL. As an example, I will use my own Facebook page, which is the default option. The first time you connect, you will have to log in with your username and password (to connect to Facebook from Excel, you need a Facebook profile). The following dialog will appear:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/30b7fa98-99c8-4c6f-a581-31ba568150b3.png" style="width:20.92em;height:12.00em;"/></p>
<ol start="4">
<li>We will choose to get information about <span class="packt_screen">Posts</span>. After clicking <span class="packt_screen">OK</span>, we get the following screen (I will only show it partially, to protect my privacy):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/723918d7-1940-431d-ad0b-930db25a8ecd.png" style="width:42.67em;height:30.67em;"/></p>
<ol start="5">
<li>As we can see, the date and times of the posts are concatenated in a single column. To split this column, click on <span class="packt_screen">Edit</span>.</li>
<li>Select the column and then <span class="packt_screen">Split Column</span> in the <span class="packt_screen">Query Editor</span>.</li>
<li>In the dialog, specify that you want to split the column by the character, <kbd>T</kbd>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b2a33581-9206-489b-87c4-12f9edba3b8e.png" style="width:31.92em;height:21.92em;"/></p>
<ol start="8">
<li>As a result, you get two new columns, one for the date and another one for the time, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1b4af768-9c3d-4f2d-8b51-03a2f512aca6.png" style="width:53.58em;height:35.83em;"/></p>
<p class="CDPAlignCenter CDPAlign"/>
<p>You have successfully extracted information from your Facebook page, which you can now use to analyze how often you are publishing, what type of content you are publishing, and other useful insights. This is especially useful if you are looking at a commercial profile, where you might want to adapt the content to improve the marketing of your service or product.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from a JSON file</h1>
                </header>
            
            <article>
                
<p>JSON is a standard format for sharing data, since it uses text fields that can be read by a human being. It is used by most web applications for data input and output.</p>
<p>In our example, we will use the Azure Text Analytics API. Given a sentence, this service can identify the text sentiment and the language and extract keywords, among other things.</p>
<p>The input sentence is <kbd>I had a wonderful trip to Seattle and enjoyed seeing the Space Needle!</kbd>. The API correctly identifies the language as English, extracts the main keywords, and tells us that the sentiment is positive (assigning a value larger than 0.5). All of this information is given in JSON format on the right-hand side of the window, and is available in the file we are going to import. The following screenshot has been extracted from the Azure Text Analytics demonstration page:</p>
<p> </p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/62330292-4aed-4309-94d4-69cf7a29cb13.png" style="width:55.33em;height:23.58em;"/></p>
<p>To load the input JSON file, follow these steps:</p>
<ol>
<li>Click on <span class="packt_screen">Data.</span></li>
<li>Navigate to <em><span class="packt_screen">Get Data</span></em> | <em><span class="packt_screen">From File</span></em> | <em><span class="packt_screen">From JSON</span></em>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/cd85bd52-fee7-46cc-a88d-7991b2ec5a90.png"/></p>
<ol start="3">
<li>You will get a preview showing the main fields in the JSON structure, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/12e4f670-3066-4ce2-b3ca-877c6da637b3.png" style="width:48.83em;height:18.42em;"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="4">
<li>Click on <span class="packt_screen">Into Table</span> to convert the entries into regular Excel tables, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/039be9fd-10b2-48c6-a988-6912ef3f4608.png" style="width:19.75em;height:9.00em;"/></p>
<p>The <kbd>Value</kbd> column is a special table column that contains nested values. To navigate to the desired variable, we need to click on the <img src="assets/02042345-fbc1-4ccc-971d-2912235403f2.png"/> symbol and repeat this operation in the columns that will successively appear. By doing, this we can, for example, get to the sentiment value, which is 0.97. Once there are no more columns to expand, we can load the data and create a regular Excel table that contains all of the values in the JSON structure, which will be used for further analysis.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing data from a database</h1>
                </header>
            
            <article>
                
<p>There are many different databases available, and Excel can connect to most of them. The connection procedure is similar for all of them. We are going to use one as an example: the MS SQL Server Express database, which is free and can be downloaded on any computer. It has some limitations, but it is extremely useful for learning and testing with small amounts of data. Assuming there is a local database in your computer, perform the following steps to connect the database:</p>
<ol>
<li>Click on <span class="packt_screen">Data.</span></li>
<li>Navigate to <em><span class="packt_screen">Get Data | From Database | From SQL Server Database</span></em>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/984d7e11-49d0-4cba-ae96-7cf41159c81a.png" style="width:56.17em;height:31.58em;"/></p>
<ol start="3">
<li>The pop-up dialog will request the name of the database server. In this case, it is the local computer name and the SQL Express Server. Optionally, we can add the database name, but if we leave it blank, we will be able to see a list of all databases in the server. These details are shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/552c58be-81fd-4ff1-ac85-99df76bca9f1.png" style="width:27.08em;height:13.50em;"/></p>
<ol start="4">
<li>Connect to the database using your credentials. It could be that you can log in with your Windows username and password (as shown in the following screenshot) or that you have a special username and password pair for the database:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/7c35f6ce-7c2c-41ab-8b23-2de04e5d0101.png" style="width:47.67em;height:22.58em;"/></p>
<ol start="5">
<li>If the connection is successful, you will see a list of all databases on the server and the tables contained in each database.</li>
</ol>
<ol start="6">
<li>Select one of the tables and get the usual preview, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0c3086a3-00d1-4225-b4ce-1257026ac26e.png" style="width:49.33em;height:39.17em;"/></p>
<div class="packt_tip">As in the previous cases, you can choose between editing the data or loading it. The final result will always be an Excel table.</div>
<p>Now, you know how to connect your Excel sheet to a database, which is the most commonly used way of storing data. Now that we have the data, the next step is to prepare it for analysis. This will be shown in detail in the next chapter.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we described different methods of inputting information into an Excel spreadsheet, going beyond what can be done by hand-typing data. A variety of file types, web data sources, and databases can be analyzed from within Excel by using Power Query and Query Editor to extract, transform, and load data. I encourage you to explore other data sources, since the loading procedure is very similar.</p>
<p>So far, we have seen some very simple data transformations being applied to the data before it was loaded. In the next chapter, we will discuss more advanced techniques for cleansing data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>Which characters can be used as separators in a text file?</li>
<li>Why is it so important to pre-process the data before loading it?</li>
<li>What is the difference between opening an Excel file and importing it?</li>
<li>What type of information can be imported from a web page?</li>
<li>JSON is one of the structured formats that's used to exchange information. What other formats exist?</li>
<li>Do some online research to understand the advantages of using databases over individual data files.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<ul>
<li><em>Power Query Documentation</em>: <a href="https://docs.microsoft.com/en-us/power-query/">https://docs.microsoft.com/en-us/power-query/</a></li>
<li><em>Introduction to the Query Editor (Power Query)</em>: <a href="https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9">https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9</a></li>
<li><em>Introducing JSON</em>: <a href="https://www.json.org/">https://www.json.org/</a></li>
</ul>


            </article>

            
        </section>
    </body></html>