<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><div id="_idContainer160">
			<h1 id="_idParaDest-74" class="chapter-number"><a id="_idTextAnchor075"/>5</h1>
			<h1 id="_idParaDest-75"><a id="_idTextAnchor076"/>IA Process and Work Queue Designs for HITL</h1>
			<p>The primary difference between RPA and IA lies in the <em class="italic">certainty of outcomes</em> and <em class="italic">risk</em>. In some cases, people implement so-called “IA” that doesn’t incur any risk. A Chatbot interface that classifies human input, which further triggers traditional RPA to run, falls into this category. While there’s ML in the chatbot portion, the risk is contained and resolved before RPA even begins. For these types of IA Processes, you really only need to know how to interface with the ML part (see <em class="italic">Chapters 1</em>, <em class="italic">2</em>, and <em class="italic">3</em>), and this chapter can <span class="No-Break">be omitted.</span></p>
			<p>For IA cases that <em class="italic">do </em>change the risk profile, by creating non-deterministic process outcomes, you’re hopefully convinced that designing an IA process to accommodate HITL should be standard practice, even if the team decides to keep HITL turned off. There could be an update to the prediction model, regulatory changes, new business requirements, and so on that will lead to enabling HITL <span class="No-Break">reviews again.</span></p>
			<p>The number of Processes and the number of Work Queues are two fundamental design decisions that an IA Solution Designer must make. Almost all of the other design elements, such as whether to use Tags, Statuses, Deferrals, and so on depend on these two decisions. This chapter discusses when to choose <em class="italic">one versus multiple Processes</em> and <em class="italic">one versus multiple Work Queues</em> when implementing IA in BP. It’s important to keep in mind that this discussion focuses specifically on IA – meaning a design that enables ML prediction and HITL review afterward. Other use-case-specific design topics involving Work Queues, such as parent-child Queues, won’t <span class="No-Break">be presented.</span></p>
			<p>More specifically, we will be looking at the pros and cons of <span class="No-Break">the following:</span></p>
			<ul>
				<li>Single BP Process, single Work <span class="No-Break">Queue designs</span></li>
				<li>Multiple BP Process, single Work <span class="No-Break">Queue designs</span></li>
				<li>Multiple BP Processes, multiple Work <span class="No-Break">Queue designs</span></li>
			</ul>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor077"/>Technical requirements</h1>
			<p>Download and import the three <strong class="source-inline">.bprelease</strong> files in the <strong class="source-inline">ch5</strong> folder on <span class="No-Break">GitHub: </span><a href="https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/tree/main/ch5"><span class="No-Break">https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/tree/main/ch5</span></a></p>
			<p>The GitHub folder also has an Excel file that will be saved as part of <em class="italic">Example 1</em> of <span class="No-Break">this chapter.</span></p>
			<h1 id="_idParaDest-77"><a id="_idTextAnchor078"/>Single-Process, single-Work Queue designs</h1>
			<p>If there’s <a id="_idIndexMarker356"/>such a thing as a <em class="italic">default</em> solution design, it would be a <em class="italic">single</em> BP Process and a <em class="italic">single</em> Work Queue created from the <em class="italic">Blue Prism Process Template</em>. As we saw in the examples in <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, this <em class="italic">simple</em> design can absolutely be used <span class="No-Break">for IA.</span></p>
			<p>In this section, we’ll discuss the two main IA solution designs that involve a <em class="italic">single</em> Process and a <em class="italic">single</em> Work Queue, including their pros, cons, and when you might <span class="No-Break">choose them.</span></p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor079"/>Asynchronous (non-blocking) reviews</h2>
			<p>In an <strong class="bold">asynchronous review</strong> design, the <a id="_idIndexMarker357"/>BP Process <em class="italic">doesn’t wait</em> for the current Item to be reviewed so that it can <a id="_idIndexMarker358"/>continue processing. Instead, the Process suspends work on the current Item that needs HITL review and moves on to the next one. This is probably how most IA Processes should be designed since reviewers usually can’t predict when an Item needs review or how long it will take before the Item is <span class="No-Break">actually reviewed.</span></p>
			<p>All three of the examples from <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a> were designed to operate asynchronously. Statuses determine when an Item is pending review, and Deferrals prevent Items from being selected by <strong class="bold">Get Next Item</strong> <span class="No-Break">too quickly.</span></p>
			<p>Let’s evaluate this <em class="italic">asynchronous review</em> design from the perspective of <strong class="bold">functionality</strong>, <strong class="bold">maintainability</strong> (in terms of how easy it will be to modify in the future), and <strong class="bold">operability</strong>. We’ll be using these three criteria to evaluate all of the designs in <span class="No-Break">this chapter.</span></p>
			<h3>Functionality</h3>
			<p>This design allows for <a id="_idIndexMarker359"/>Work Queue Items to be indefinitely Deferred until they are reviewed by a human. Items that aren’t Deferred can continue <span class="No-Break">automated processing.</span></p>
			<p>The Process continually switches between two distinct cycles of operation. The first cycle is creating review data and checking for completed HITL reviews. The next is picking up an Item for traditional <span class="No-Break">RPA processing.</span></p>
			<h3>Maintainability</h3>
			<p>In terms of maintainability, all of the logic, both business and IA-related, is contained in a <em class="italic">single</em> BP<a id="_idIndexMarker360"/> Process. This isn’t clearly good nor bad, as some people consider it easier to maintain than a multi-Process solution. My view is that having too much in a single Process – in our case, the business logic, the ML calling code, and the HITL logic – makes the solution less maintainable. Containing everything in a single Process prevents multiple developers from editing it at once, which is undesirable if there’s lots of <span class="No-Break">logic there.</span></p>
			<h3>Operability</h3>
			<p>The Controller needs to <a id="_idIndexMarker361"/>know how to check Item Statuses in order to find out which Items haven’t been reviewed yet. They need to know exactly which Statuses exist so that they can edit the Statuses manually in the Control Room. This is how they can force an Item to continue automated processing, even if it’s flagged for review. There will always be added operational complexity when moving from RPA to IA, regardless of the specific Process and Work Queue design <span class="No-Break">that’s chosen.</span></p>
			<p>Controllers also need to find out whether Items that are waiting for review are stuck in limbo. There’s a chance that the data shared between the Digital Worker and the reviewer, whether it be an Excel file in a shared folder, a database record, or a web interface, is incorrectly generated or <span class="No-Break">accidentally deleted.</span></p>
			<h3>Pros</h3>
			<p>An <a id="_idIndexMarker362"/>advantage of the asynchronous review design is that everything is contained in one Process, making the Session usage (license consumption) easy to predict. The scheduling is also simple to manage. This benefits companies that need to carefully control how their licenses are used. Statistics about a case’s Total Work Time are also<a id="_idIndexMarker363"/> clear from the Control Room since we only have a single <span class="No-Break">Work Queue.</span></p>
			<h3>Cons</h3>
			<p>One<a id="_idIndexMarker364"/> downside of this design is that Work Queue Items can’t be picked up for work immediately after it’s reviewed (assuming that it’s desirable to do so). It always has to wait for the Deferral time to pass before it can be picked up by <strong class="bold">Get </strong><span class="No-Break"><strong class="bold">Next Item</strong></span><span class="No-Break">.</span></p>
			<p>Another downside of this design is that checking for reviewed predictions so that their Statuses can be updated should probably occur outside of the Process Template’s Work Block. In the following figure, we see that the Process checks for completed human reviews right before a new Item is <span class="No-Break">worked on:</span></p>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer124" class="IMG---Figure">
					<img src="image/B18416_05_1.jpg" alt="Figure 5.1 – Checking for a reviewed prediction should only happen in between Items" width="1019" height="599"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – Checking for a reviewed prediction should only happen in between Items</p>
			<p>This is required because the logic that checks for completed reviews is unrelated to the case-specific logic of the Item that’s locked by <strong class="bold">Get Next Item</strong>. We don’t want an Exception that occurs in the review-checking logic to cause an Item that’s being worked on to be an Exception as well. The compromise that’s made by placing checking logic outside the Work Block is that the Process can Terminate if an Exception happens there. A <em class="italic">two</em>-Process design can decouple the review-checking logic from the actual business process logic, mitigating <span class="No-Break">this issue.</span></p>
			<p>Another<a id="_idIndexMarker365"/> concern with this design lies in the amount of time spent performing the review checking versus actually processing a case. They’re two relatively independent activities that need to run within the same Session. Depending on actual conditions, you might spend so much time in the review-checking logic that it <em class="italic">negatively impacts the throughput of working cases</em>. Imagine that checking for completed reviews requires logging in to a custom website. If this website is slow or requires lots of navigation between pages, the gap between picking up cases using <strong class="bold">Get Next Item</strong> due to checking for completed reviews can become <span class="No-Break">very large.</span></p>
			<p>A full example of this one-Process, one-Work Queue, asynchronous design can be found in <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <span class="No-Break"><em class="italic">Example 3</em></span><span class="No-Break">.</span></p>
			<p>Now that we’ve discussed the merits and demerits of the asynchronous review design, let’s look at a different <em class="italic">single</em>-Process, <em class="italic">single</em>-Work Queue design for <span class="No-Break"><em class="italic">synchronous</em></span><span class="No-Break"> reviews.</span></p>
			<h2 id="_idParaDest-79"><a id="_idTextAnchor080"/>Synchronous (blocking) reviews</h2>
			<p>If we have <strong class="bold">SLA requirements</strong> that require manual review to complete in a short timeframe, we should consider <a id="_idIndexMarker366"/>a <strong class="bold">synchronous review</strong> <a id="_idIndexMarker367"/>design. In this design, the Process blocks and waits for the Work Queue Item's review to be completed <span class="No-Break">before progressing.</span></p>
			<h3>Functionality</h3>
			<p>In a synchronous review <a id="_idIndexMarker368"/>Process, we must complete the current Item, including waiting for HITL review, before moving on to other Items. This is often desired when IA is backing a real-time customer interaction. Recall that there’s a real IA use case where ML is used to help verify pharmaceutical prescriptions. Depending on the setting where this is used – such as a pharmacy, a doctor’s office, or a hospital – the customer’s expectation of receiving their medication can be considered “real-time,” and as low as a <span class="No-Break">few minutes.</span></p>
			<p>Under a synchronous review design, the BP Process enters a polling loop that blocks and continually checks to see whether the prediction has been reviewed. If the review is completed within the SLA period, automated processing continues. If the ML review doesn’t complete within the SLA period, the case is marked as <span class="No-Break">an Exception.</span></p>
			<h3>Maintainability</h3>
			<p>Similar to the asynchronous <a id="_idIndexMarker369"/>design, everything is contained within a <em class="italic">single</em> Process, which to most developers could be considered maintainable. The logic to implement a polling loop is simpler than the logic for the asynchronous design and easy for even new developers <span class="No-Break">to grasp.</span></p>
			<h3>Operability</h3>
			<p>Control Room operations are<a id="_idIndexMarker370"/> straightforward compared to the asynchronous design – Items that aren’t reviewed within the time limit are marked as an Exception. Controllers don’t really need to do anything different from <span class="No-Break">non-IA solutions.</span></p>
			<h3>Pros</h3>
			<p>There aren’t many advantages <a id="_idIndexMarker371"/>to this design besides the overall simplicity of the solution. It’s easy to understand, modify the polling logic, schedule and predict the license usage. The strongest reason to choose this design is to enable <span class="No-Break">real-time reviews.</span></p>
			<h3>Cons</h3>
			<p>The most significant downside <a id="_idIndexMarker372"/>of this design is <em class="italic">significantly lowered case throughput</em>, which is a trade-off to meeting individual case SLAs. If there’s also a high volume of cases, more BP sessions need to be concurrently running, resulting in more licenses being used. Time is inevitably wasted in the polling loop, and this waste increases as the SLA period <span class="No-Break">is longer.</span></p>
			<p>Let’s look at an example of this single-Process, single-Work Queue-blocking design for a hospital setting. At a high level, we will be going through the following <span class="No-Break">four steps:</span></p>
			<ol>
				<li>Examine the contents of the example’s Release file and import <span class="No-Break">additional dependencies.</span></li>
				<li>Understand the logic to create <strong class="source-inline">.html</strong> review files <span class="No-Break">with images.</span></li>
				<li>Examine the polling logic used to achieve <span class="No-Break">synchronous reviews.</span></li>
				<li>Run the <a id="_idIndexMarker373"/>example to see the result in the <span class="No-Break">Control Room.</span></li>
			</ol>
			<h3>Example 1 – polling for reviewed predictions</h3>
			<p>In this example, we’ll <a id="_idIndexMarker374"/>use the prescription medication <a id="_idIndexMarker375"/>scenario that was described earlier. Imagine that we’re working on a project for a private hospital where roughly 200 patients are processed per day. Each of these patients is expected to need medication from the hospital pharmacy. To shorten the time spent waiting and improve patient satisfaction at the pharmacy, the hospital is looking to use image-based ML to automatically <em class="italic">count the number of pills</em> for their most commonly <span class="No-Break">prescribed medications.</span></p>
			<p>The ML team has already built a model for multiple types of medication and determined the thresholds where they want human intervention for manual review. To meet the goals of the project (reduce the time spent waiting by patients), we’ve decided on a blocking process design where the Digital Worker waits for, at most, <em class="italic">two minutes</em> for a prediction to be reviewed. A small team of trained remote workers will be responsible for performing manual review using a simple web interface. The web interface is chosen as the reviewers need to look at an image of <span class="No-Break">the medication.</span></p>
			<p>The Digital Worker will save <strong class="source-inline">.html</strong> files to a network share folder. One <strong class="source-inline">.html</strong> file contains the image of the prescription medication and a drop-down list for the reviewer to choose the amount of medication shown in the image. The <strong class="source-inline">.html</strong> filename will contain the Item ID. The concept of batch size isn’t relevant to this case as we don’t want to review multiple predictions in a single <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">html</strong></span><span class="No-Break"> file.</span></p>
			<p>Our first step is to verify the contents of the <strong class="source-inline">.bprelease</strong> file and import some additional files needed for <span class="No-Break">this example.</span></p>
			<h4>Verify the Release contents and import dependencies</h4>
			<p>Here, we’ll <a id="_idIndexMarker376"/>examine the <strong class="source-inline">.bprelease</strong> file contents and import a third-party asset from the DX. Then, we’ll <a id="_idIndexMarker377"/>download an Excel file containing the thresholds for human review and ensure that it’s saved to the <span class="No-Break">correct location:</span></p>
			<ol>
				<li>Verify that <em class="italic">one</em> Process, <em class="italic">one</em> Work Queue, and <em class="italic">four</em> Environment Variables have <span class="No-Break">been imported:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer125" class="IMG---Figure">
					<img src="image/B18416_05_2.jpg" alt="Figure 5.2 – The Release contents of Example 1" width="362" height="267"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – The Release contents of Example 1</p>
			<ol>
				<li value="2">Download and Import the <strong class="bold">Utility – File Manipulation </strong>asset from the DX at <a href="https://digitalexchange.blueprism.com/dx/entry/9648/solution/utility---file-manipulation">https://digitalexchange.blueprism.com/dx/entry/9648/solution/utility---file-manipulation</a>. This is used to convert image files into Base64 format so that they can be <a id="_idIndexMarker378"/>embedded <a id="_idIndexMarker379"/>into the <strong class="source-inline">.html</strong> files. Note that this step has been completed if you’ve gone through <em class="italic">Example 3, GCP Cloud Vision batch OCR processing</em> section of<em class="italic"> </em><a href="B18416_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>. Ignore this step if <strong class="bold">Utility – File Manipulation</strong> has already <span class="No-Break">been imported.</span></li>
				<li>Download the Excel file from <a href="https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/blob/main/ch5/Ch5%20Example%201%20Thresholds.xlsx">https://github.com/PacktPublishing/Intelligent-Automation-with-Blue-Prism/blob/main/ch5/Ch5%20Example%201%20Thresholds.xlsx</a>. This contains the thresholds for triggering the review of different <span class="No-Break">medication types.</span></li>
				<li>Copy the Excel file into the path specified by the Environment Variable named <strong class="bold">Ch5 Example 1 Thresholds Excel File Full Path</strong>. By default, it’s set to <strong class="source-inline">C:/Users/Public/Ch5 Example </strong><span class="No-Break"><strong class="source-inline">1 Thresholds.xlsx</strong></span><span class="No-Break">.</span></li>
				<li>Open the<a id="_idIndexMarker380"/> Excel file. This <a id="_idIndexMarker381"/>file stores the thresholds for the different types of medication (if we have more medication types, we can add more rows to <span class="No-Break">the spreadsheet):</span></li>
			</ol>
			<div>
				<div id="_idContainer126" class="IMG---Figure">
					<img src="image/B18416_05_3.jpg" alt="Figure 5.3 – The threshold configuration Excel file" width="198" height="292"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – The threshold configuration Excel file</p>
			<ol>
				<li value="6">Locate the Environment Variable named <strong class="bold">Ch5 Example 1 Completed Review Folder Path</strong> under <strong class="bold">System</strong> | <strong class="bold">Processes</strong> | <strong class="bold">Environment Variables</strong>. Change <strong class="bold">Value</strong> so that it matches the default download folder of your default web browser. Do not put a trailing slash at <span class="No-Break">the end.</span><p class="list-inset">We need this because we’re using static <strong class="source-inline">.html</strong> files as the interface to review predictions. After the reviewer has reviewed a prediction, they’re expected to press a button named <strong class="bold">Submit Reviewed Prediction</strong>, which either triggers the browser’s file download dialog to pop up or automatically downloads a file onto your PC. The behavior depends on how your browser is <span class="No-Break">set up.</span></p></li>
			</ol>
			<div>
				<div id="_idContainer127" class="IMG---Figure">
					<img src="image/B18416_05_4.jpg" alt="Figure 5.4 – The static .html review interface" width="516" height="518"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – The static .html review interface</p>
			<p>Under more <a id="_idIndexMarker382"/>realistic conditions, we <a id="_idIndexMarker383"/>wouldn’t use static <strong class="source-inline">.html</strong> files. We’d have a web server serving the review web pages, where pressing the <strong class="bold">Submit</strong> button would automatically copy the necessary file to a shared location. This would remove the need for the user to download a file altogether. However, setting up a web server is outside the scope of this book and unnecessary to illustrate the concepts of a synchronous <span class="No-Break">review design.</span></p>
			<p>Next, let’s look at the Process diagram. Most of the Process is structured identically to <em class="italic">Example 2 – Thresholding</em> from <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>. Only the important differences will be <span class="No-Break">highlighted here.</span></p>
			<h4>Examine the .html file creation logic</h4>
			<p>An important part of the <a id="_idIndexMarker384"/>solution lies in how we implement the data-sharing interface between the Digital Worker and the reviewer. Since images are part of the review data, we’ve chosen a web browser and HTML form as the review interface. Let’s see how this can <span class="No-Break">be achieved:</span></p>
			<ol>
				<li>Open <strong class="bold">Example 1 – Polling for Reviewed Predictions</strong> in the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>Locate and open the <strong class="source-inline">03b Write Image to HTML Template</strong> Page. This Page is executed after we know that a prediction needs <span class="No-Break">manual review.</span></li>
				<li>Look at the first three Action Stages after Start. The first Action writes the image of the medication into a file. The second Action reads the image content back into BP as a Base64 string. The third Action deletes the image file created by Action 1. The purpose is to convert the image into Base64 encoding so that it can be embedded directly into the <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">html</strong></span><span class="No-Break"> file.</span></li>
				<li>Look at <a id="_idIndexMarker385"/>the <em class="italic">Multi Calc</em> Stage. Here, the Base64 image string is replaced with a <strong class="source-inline">Text</strong> Data Item, which contains an HTML template for the select list, a <strong class="bold">Submit</strong> button, and a placeholder for the image. Finally, this HTML template <strong class="source-inline">Text</strong> Data Item is saved as a <strong class="source-inline">.html</strong> file, with the Item ID as the filename, into the path specified by the <strong class="bold">Ch5 Example 1 To Review Folder Path</strong> <span class="No-Break">Environment Variable:</span></li>
			</ol>
			<p class="IMG---Figure">  </p>
			<div>
				<div id="_idContainer128" class="IMG---Figure">
					<img src="image/B18416_05_5.jpg" alt="Figure 5.5 – Embed the image as Base64 into the HTML file" width="476" height="855"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – Embed the image as Base64 into the HTML file</p>
			<ol>
				<li value="5">Open<a id="_idIndexMarker386"/> the <strong class="bold">HTML Template</strong> Data Item and look at the Initial Value. Notice that it uses a <strong class="source-inline">.js</strong> file stored on a CDN, meaning that this example <em class="italic">requires an Internet connection </em><span class="No-Break"><em class="italic">to run</em></span><span class="No-Break">.</span></li>
				<li>Examine the following JavaScript, which is part of the <strong class="bold">HTML Template</strong> Data Item. When the <strong class="bold">Submit</strong> button is pressed in the HTML form, JavaScript is triggered, showing the file download dialog. This file download dialog defaults to naming the filename as the current Item’s ID, and it stores the reviewed prediction value as the <span class="No-Break">file content:</span><pre class="source-code">
document.getElementById('saveFile').addEventListener('click', function(e) {
var text = document.getElementById("reviewed").value;
      var filename = document.title + ".txt";
      var file = new File([text], filename, 
     {type: "text/plain;charset=utf-8"});
      saveAs(file);
});</pre></li>			</ol>
			<p>We should now understand how the Digital Worker exchanges data with the reviewer. BP creates a <strong class="source-inline">.html</strong> file named after the current Item ID into the path specified by the <strong class="bold">Ch5 Example 1 To Review Folder Path</strong> <span class="No-Break">Environment Variable.</span></p>
			<p>The reviewer monitors this folder manually and opens any <strong class="source-inline">.html</strong> files that appear in their default web browser. The <strong class="source-inline">.html</strong> file contains the image of the medication, a drop-down list for the reviewer to select the correct amount of medication, and a button to submit the form. The <strong class="bold">Submit</strong> button triggers a <strong class="bold">Save as</strong> dialog to open through JavaScript, with the Item ID set as the default filename. The <strong class="bold">Save as</strong> dialog’s folder should<a id="_idIndexMarker387"/> be set to the path specified by the <strong class="bold">Ch5 Example 1 Completed Review Folder Path</strong> Environment Variable. After saving, a <strong class="source-inline">.txt</strong> file is written to disk, which contains the drop-down list value (the human-reviewed amount of medication) <span class="No-Break">as content.</span></p>
			<h4>Examine the polling logic</h4>
			<p>Let’s now examine the <a id="_idIndexMarker388"/>two major parts that make the polling logic work. The first part is a wait loop that throws an Exception if the maximum wait time is surpassed; the second part is the cleanup of the <strong class="source-inline">.html</strong> and <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">txt</strong></span><span class="No-Break"> files:</span></p>
			<ol>
				<li>Go to <strong class="source-inline">Main Page</strong>. See that inside the Work Block, we’ve added a new Page named <strong class="source-inline">Wait for Reviewed Predictions</strong>. This Page contains the logic that stalls execution by polling for the reviewed prediction if a review <span class="No-Break">is required:</span></li>
			</ol>
			<p class="IMG---Figure">  </p>
			<div>
				<div id="_idContainer129" class="IMG---Figure">
					<img src="image/B18416_05_6.jpg" alt="Figure 5.6 – The Wait for Reviewed Predictions Page contains the polling logic" width="1382" height="1256"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – The Wait for Reviewed Predictions Page contains the polling logic</p>
			<ol>
				<li value="2">Open the <strong class="source-inline">Wait for Reviewed </strong><span class="No-Break"><strong class="source-inline">Predictions</strong></span><span class="No-Break"> Page.</span></li>
				<li>Locate the <a id="_idIndexMarker389"/>Block named <strong class="bold">Polling Loop</strong>, right after <strong class="bold">Start</strong>. The Stages inside this Block contain the polling logic. We check the <strong class="bold">Ch5 Example 1 Completed Review Folder Path</strong> Environment Variable (containing your browser’s default download location) for the presence of a <strong class="source-inline">.txt</strong> file named with the current Item ID. This is the same <strong class="source-inline">.txt</strong> file that’s saved by pressing the <strong class="bold">Submit</strong> button on the <strong class="source-inline">.html</strong> review file. If an exact file isn’t found, we continue to poll until the maximum timeout value specified in the <strong class="bold">Ch5 Example 1 Max Timeout Seconds</strong> Environment Variable is reached. An Exception is thrown if the file isn’t detected within the maximum <span class="No-Break">allowed timeout:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer130" class="IMG---Figure">
					<img src="image/B18416_05_7.jpg" alt="Figure 5.7 – The polling logic" width="795" height="546"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – The polling logic</p>
			<ol>
				<li value="4">Look at the<a id="_idIndexMarker390"/> six Stages that immediately follow the <strong class="bold">Polling Loop </strong>Block. If a <strong class="source-inline">.txt</strong> file named after the current Item ID is found, the Work Queue Status is updated. The revised prediction is read back into BP, and the <strong class="source-inline">.txt</strong> file <span class="No-Break">is deleted:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer131" class="IMG---Figure">
					<img src="image/B18416_05_8.jpg" alt="Figure 5.8 – Read the revised prediction and delete the .txt file" width="399" height="721"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Read the revised prediction and delete the .txt file</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Updating the Status is not crucial to the correct functioning of this single-work queue polling design. It’s kept here to skip steps on the <strong class="source-inline">Main Page</strong> in case the Item is retried after an Exception or Stop. However, updating the Status is crucial to the asynchronous review design. There, the Status is used to repeatedly defer the Item until it has <span class="No-Break">been reviewed.</span></p>
			<ol>
				<li value="5">Locate<a id="_idIndexMarker391"/> the <strong class="bold">Delete HTML file </strong>Block, which is connected to End. The <strong class="source-inline">.html</strong> file is deleted as the final step on this Page. It’s safe to delete the <strong class="source-inline">.html</strong> file even if it’s still loaded in the reviewer’s browser due to how modern <span class="No-Break">browsers work:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer132" class="IMG---Figure">
					<img src="image/B18416_05_9.jpg" alt="Figure 5.9 – Delete the .html file" width="567" height="310"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – Delete the .html file</p>
			<h4>Run the Process</h4>
			<p>This Process <a id="_idIndexMarker392"/>loads 10 randomly generated Items into the Work Queue named <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 1 Queue</em>. Due to random creation, this Process might need to be run multiple times before an image is selected for manual review. On average, there should be four Items that need manual review for every Session run. The ML algorithm is not real – it’s a placeholder, based on <span class="No-Break">random numbers.</span></p>
			<p>We will run the polling Process and let two minutes pass. This should cause the first Item to be marked as an Exception since the review didn’t complete within the timeout period. Then, we will manually review all subsequent Items within their two-minute limit. This should result in all of the other Items being marked <span class="No-Break">as Completed:</span></p>
			<ol>
				<li>Go to the Control Room, locate the <em class="italic">Ch5</em> Group, and start the Process named <strong class="bold">Example 1 – Polling for Reviewed Predictions</strong>.  <em class="italic">Do not wait for the Session </em><span class="No-Break"><em class="italic">to complete</em></span><span class="No-Break">.</span></li>
				<li>Open the folder that has been configured for the <strong class="bold">Ch5 Example 1 To Review Folder Path</strong> Environment Variable in Windows <span class="No-Break">File Explorer.</span></li>
				<li>Wait for a <strong class="source-inline">.html</strong> file to appear. Once a file appears, the reviewer has 120 seconds before this Item is marked as <span class="No-Break">an Exception:</span></li>
			</ol>
			<div>
				<div id="_idContainer133" class="IMG---Figure">
					<img src="image/B18416_05_10.jpg" alt="Figure 5.10 – An .html file appears in the To Review Folder Path" width="914" height="183"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – An .html file appears in the To Review Folder Path</p>
			<ol>
				<li value="4">Wait 120 seconds for the Item to expire and open the Work Queue named <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 1 Queue</em>. See that there is one Item marked as an Exception. Note that the Item Key displayed in the Control Room is not the same as the Item ID (filename of the <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">html</strong></span><span class="No-Break"> file):</span></li>
			</ol>
			<div>
				<div id="_idContainer134" class="IMG---Figure">
					<img src="image/B18416_05_11.jpg" alt="Figure 5.11 – The Item is marked as an Exception once the maximum wait time is surpassed" width="532" height="95"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – The Item is marked as an Exception once the maximum wait time is surpassed</p>
			<ol>
				<li value="5">Return<a id="_idIndexMarker393"/> to Windows File Explorer and wait for another <strong class="source-inline">.html</strong> file to appear. Open the file as soon as possible in your web browser. Review the prediction by choosing the amount of medication and clicking on the <strong class="bold">Submit Reviewed </strong><span class="No-Break"><strong class="bold">Prediction</strong></span><span class="No-Break"> button:</span></li>
			</ol>
			<div>
				<div id="_idContainer135" class="IMG---Figure">
					<img src="image/B18416_05_12.jpg" alt="Figure 5.12 – Perform human review and submit" width="499" height="521"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – Perform human review and submit</p>
			<ol>
				<li value="6">If<a id="_idIndexMarker394"/> the <strong class="bold">Save as</strong> dialog appears, ensure that the folder matches the value of the <strong class="bold">Ch5 Example 1 Completed Review Folder Path</strong> Environment Variable. Save the file without renaming it. The <strong class="bold">Save as</strong> dialog might not appear if you have your browser set to automatically <span class="No-Break">download files.</span></li>
				<li>Repeat <em class="italic">steps 5</em> and <em class="italic">6</em>, reviewing any <strong class="source-inline">.html</strong> files that appear, until the Session has <span class="No-Break">finished executing.</span></li>
				<li>Once the Session run is complete, open the <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 1 Queue</em> Work Queue and see that all Items have been marked as <strong class="bold">Completed</strong> except <span class="No-Break">for one:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer136" class="IMG---Figure">
					<img src="image/B18416_05_13.jpg" alt="Figure 5.13 – All Items except for one are completed" width="534" height="306"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – All Items except for one are completed</p>
			<p>In this example, we saw how a <em class="italic">single</em> Process and <em class="italic">single</em> Work Queue, together with a polling loop, can fulfill the IA use case where real-time HITL review is needed. We also devised a method to review images by writing them into <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">html</strong></span><span class="No-Break"> files.</span></p>
			<p>Next, let’s move the discussion from <em class="italic">single</em>-Process designs and look at <span class="No-Break"><em class="italic">multi-Process</em></span><span class="No-Break"> ones.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">While you can design a <em class="italic">single</em> BP Process with <em class="italic">multiple</em> Work Queues, there aren’t any clear reasons to do so for IA. As a general design rule, avoid having multiple Work Queues for a single BP Process. It’s difficult to follow the Process flow when there are multiple Work Queues that can be the source of an Item that’s worked on, reducing maintainability. An exception to this is if the additional Work Queues aren’t a source of Items to be worked on, such as for Parent/Child Work Queue designs where only Item Statuses, Tags, or Data <span class="No-Break">are updated.</span></p>
			<h1 id="_idParaDest-80"><a id="_idTextAnchor081"/>Multiple-Process, single-Work Queue designs</h1>
			<p>Under the <a id="_idIndexMarker395"/>context of IA, there are three broad reasons why you might want to have multiple BP Processes working on only a <em class="italic">single</em> Work Queue. The first is to <em class="italic">keep distinct pieces of logic separate</em>. We will see an example of this later in the section, which has one BP Process primarily for the business logic and other Processes to house logic specific to the ML portions of the solution design. Keeping these separate makes future modifications to the business logic easier <span class="No-Break">to manage.</span></p>
			<p>The next reason is closely related to the first one. We can separate a solution into different Processes to <em class="italic">promote reusability</em>. As you can imagine, the logic to implement random sampling, thresholding, notifying reviewers that predictions are ready for review, and so on, are potentially interchangeable across multiple IA Processes, and could be implemented as their <span class="No-Break">own Process.</span></p>
			<p>The third reason is to enable different sections of the overall process to <em class="italic">scale differently</em>. Imagine that we’re putting a new IA process into production and that the random sampling percentage is set to 100%, to force human review of every ML prediction during hypercare. If there’s a BP Process dedicated specifically to checking for reviewed predictions, we can run it on more Digital Workers to prevent bottlenecks during this time. Once we’re happy with the accuracy and performance of the ML model, the random sampling percentage and the number of Sessions that the review-checking Process needs can <span class="No-Break">be lowered.</span></p>
			<p>In the next section, we will discuss a <em class="italic">multiple</em>-Process, <em class="italic">single</em>-Queue IA design where the logic for manual reviews is split into its own Process. This section also contains <span class="No-Break">an example.</span></p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor082"/>Independent manual review logic</h2>
			<p>The review-checking <a id="_idIndexMarker396"/>logic that we’ve previously<a id="_idIndexMarker397"/> seen can be put in a separate Process, decoupling it from the business logic. The following figure shows how this can be set up at a <span class="No-Break">high level.</span></p>
			<div>
				<div id="_idContainer137" class="IMG---Figure">
					<img src="image/B18416_05_14.jpg" alt="Figure 5.14 – A two-Process, single-Queue design" width="766" height="170"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – A two-Process, single-Queue design</p>
			<p><em class="italic">Process 1</em> in the diagram performs all the business logic steps, including making the ML prediction. <em class="italic">Process 2</em> uses the <em class="italic">same </em>Work Queue as Process 1 and is only responsible for the logic related to HITL review – transferring data to the reviewers and checking for completed <a id="_idIndexMarker398"/>reviews. Its main purpose is to update the Work Queue Item Status so that Process 1 can continue<a id="_idIndexMarker399"/> automated processing on an Item after it has <span class="No-Break">been reviewed.</span></p>
			<h3>Functionality</h3>
			<p>The main function of this <a id="_idIndexMarker400"/>design is to allow Process 1 to spend <em class="italic">all</em> of its time executing business logic as opposed to IA solution logic (writing share data and checking for reviewed predictions). It allows for <em class="italic">independent scaling</em> of the two activities. For instance, you could dedicate multiple Sessions to run Process 1 while only having one Session run Process 2, or the other way around, depending on your <span class="No-Break">actual need.</span></p>
			<h3>Maintainability</h3>
			<p>By moving from one Process to<a id="_idIndexMarker401"/> two, each Process overall becomes simpler to maintain. But the overall complexity of the solution increases, as developers need to understand how both Processes affect the execution flow of an Item. As the IA team gains experience and documentation practices improve, this complexity is <span class="No-Break">significantly reduced.</span></p>
			<h3>Operability</h3>
			<p>The <em class="italic">single</em>-Process, <em class="italic">single</em>-Queue <a id="_idIndexMarker402"/>example checks to see whether a review is completed by looping through the contents of a <em class="italic">completed folder</em>. This completed folder could instead be an API call, a database, or some other system. Files or records in the “completed location” <em class="italic">must </em>contain a reference to the <em class="italic">Item ID</em> somewhere. BP must be able to lock the Item based on the Item ID to update its Status so that it can continue automated processing <span class="No-Break">as required.</span></p>
			<p>Having the Item ID directly exposed to reviewers is fragile from an <em class="italic">operations</em> standpoint. Someone could accidentally (or deliberately) modify the Item ID. This could result in a permanently stuck Work Queue Item that can no longer be reviewed, or updating the Status of a different Item than <span class="No-Break">was intended.</span></p>
			<p>The alternative to looping through a data transfer location is to loop through the Work Queue for Items that are pending review. Unfortunately, <strong class="bold">Get Next Item</strong> can’t filter based on Status. We can, however, filter Work Queues based on <em class="italic">Tags</em>, which we’ll implement in an example shortly. We’ll also need to store a reference to the file path or third-party system ID as Work Queue Data so that the Item ID doesn’t need to be exposed to <span class="No-Break">the reviewer.</span></p>
			<p>Also, since we plan on looping through every Item that’s pending review, we can ensure that the review data is persisted correctly and recreate it if it isn’t. This isn’t possible in our previous design since we’re only looping through the contents of the completed folder, and not the full set of everything that needs to <span class="No-Break">be reviewed.</span></p>
			<p class="callout-heading">Discussion</p>
			<p class="callout">You might be wondering whether we could have added Tags to our <em class="italic">single</em>-Process, <em class="italic">single</em>-Work Queue example to prevent exposing the Item ID to reviewers. While it would work technically, in practice, it takes too much time away from actually working the Items according to business logic. Recall that the review-checking logic in our previous example was positioned outside of the Main Page’s Work Block. If the number of Items pending review is high or if checking to see whether a pending Item has been reviewed takes more than a few seconds, we can end up spending significant amounts of time just doing <span class="No-Break">this checking.</span></p>
			<h3>Pros</h3>
			<p>In the <em class="italic">single</em>-Process, <em class="italic">single</em>-Queue design, review checking is performed <em class="italic">outside</em> the Work Block of <a id="_idIndexMarker403"/>the Process Template. Exceptions that <a id="_idIndexMarker404"/>occur outside the Work Block potentially result in Terminations. With a two-Process design, review logic can be placed into its own Work Block. Exceptions that occur no longer lead to immediate Termination. This makes this design well-suited for scenarios where checking for a completed review has complex logic, such as logging into a <span class="No-Break">web interface.</span></p>
			<p>While some might consider this solution as more difficult to maintain, as there are two Processes instead of just one, I’d argue that it’s now easier to maintain the primary Process that contains the business logic, since much of the IA solution logic has been moved out. It’s the business logic that’s more apt to change over the lifetime of an IA solution. Moving to a two-Process design also enables reuse and <span class="No-Break">targeted scaling.</span></p>
			<h3>Cons</h3>
			<p>The <a id="_idIndexMarker405"/>main downside of this <em class="italic">two</em>-process, <em class="italic">single</em>-Work Queue design over the single-Process one is that the number of Sessions used to get a working solution is, at minimum, two. The scheduling also becomes <span class="No-Break">more complex.</span></p>
			<p>Looping through every Item that’s marked for human review, regardless of whether it has been reviewed, unnecessarily adds to the Total Work Time of that Item. A negative consequence of this two Process, single-Queue design is that the case duration statistics will be higher than the <span class="No-Break">single-Process design.</span></p>
			<p>Another downside is caused by moving the logic that persists prediction data so that it can be shared with the reviewer in the new Process. Since we’re offloading that task to a different Process, we’re effectively no longer saving review data immediately after an ML prediction is made. We may need <em class="italic">frequent Session runs of Process 2</em> to ensure that review data is created in a <span class="No-Break">timely manner.</span></p>
			<p>Next, let’s look at an implementation of this single-Work Queue, two-Process design in an example. At a high level, we will be going through <span class="No-Break">five steps:</span></p>
			<ol>
				<li>Verify the contents of <span class="No-Break">the Release.</span></li>
				<li>Confirm that the HITL review logic has been moved out of <span class="No-Break">Process 1.</span></li>
				<li>Understand the functionality that has been moved into <span class="No-Break">Process 2.</span></li>
				<li>Run Process 1 and see the results in the <span class="No-Break">Control Room.</span></li>
				<li>Run Process 2 and<a id="_idIndexMarker406"/> see the results in the <span class="No-Break">Control Room.</span></li>
			</ol>
			<h3>Example 2 – independent manual review logic</h3>
			<p>Suppose that we’re deploying <a id="_idIndexMarker407"/>the customer churn example from <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">Example 3</em> into production for the first time. During our hypercare period, we want to review every single ML prediction. Based on the case volume, the hypercare period, and the overall seasonality of retail shopping, we want to revise our original <em class="italic">single</em>-Process design and split out the review logic so that it can be scaled independently and started on multiple Sessions. We will still keep a <em class="italic">single</em> <span class="No-Break">Work Queue.</span></p>
			<p>The Release<a id="_idIndexMarker408"/> has already been developed. Let’s examine how the review logic has been split into a separate Process, and execute it to get an idea of how it can be scaled and <span class="No-Break">maintained independently.</span></p>
			<h4>Verify the Release contents</h4>
			<p>This <a id="_idIndexMarker409"/>Release’s contents are similar to those of <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">Example 3</em>, except that there’s an <span class="No-Break">additional Process:</span></p>
			<ol>
				<li>Verify that <em class="italic">two Processes</em>, one Work Queue, and five Environment Variables have been imported (descriptions of the Environment Variables can be found in <a href="B18416_04.xhtml#_idTextAnchor062"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <span class="No-Break"><em class="italic">Example 3</em></span><span class="No-Break">):</span><div id="_idContainer138" class="IMG---Figure"><img src="image/B18416_05_15.jpg" alt="" role="presentation" width="353" height="311"/></div></li>
			</ol>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">
Figure 5.15 – The Release contents for Example 2</p>
			<ol>
				<li value="2">Verify <a id="_idIndexMarker410"/>that the <strong class="bold">Ch5 Example 2 Random Sampling Target</strong> Environment Variable is set to <strong class="bold">100.0</strong>, meaning that all ML predictions will be reviewed as required by the <span class="No-Break">hypercare period.</span></li>
			</ol>
			<h4>Verify that the primary Process no longer has review-related logic</h4>
			<p>Let’s ensure<a id="_idIndexMarker411"/> that the Process containing the main business logic no longer has logic related to creating Excel files and updating <span class="No-Break">Item Statuses:</span></p>
			<ol>
				<li>Open the Process named <strong class="bold">Example 2A – Random Sampling </strong>in the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>On the <strong class="source-inline">Main Page</strong>, see that there’s no Page to check for reviewed predictions before the <strong class="bold">Get Next Item</strong> Stages; this logic has been removed from <span class="No-Break">this Process:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer139" class="IMG---Figure">
					<img src="image/B18416_05_16.jpg" alt="Figure 5.16 – There are no Pages to check for reviewed predictions" width="889" height="643"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16 – There are no Pages to check for reviewed predictions</p>
			<ol>
				<li value="3">Open <a id="_idIndexMarker412"/>any of the <strong class="bold">Get Next Item</strong> Actions on the <strong class="source-inline">Main Page</strong>. See that a Tag Filter has been added to <em class="italic">not</em> select any Items with the <strong class="bold">Manual Review </strong><span class="No-Break"><strong class="bold">Required</strong></span><span class="No-Break"> Tag.</span></li>
				<li>See that the Work Queue name on the <strong class="source-inline">Main Page</strong> is set to <span class="No-Break"><strong class="bold">Chapter 5</strong></span><strong class="bold"> Example </strong><span class="No-Break"><strong class="bold">2 Queue</strong></span><span class="No-Break">:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer140" class="IMG---Figure">
					<img src="image/B18416_05_17.jpg" alt="Figure 5.17 – Take note of the Queue name" width="460" height="160"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17 – Take note of the Queue name</p>
			<ol>
				<li value="5">Open the Page named <strong class="source-inline">Update Status and Tag for Manual Review</strong>. See that there’s no longer any logic to write Excel files to disk. Also, see that we’re setting the Tag for Items requiring HITL review to <strong class="bold">Manual </strong><span class="No-Break"><strong class="bold">Review Required</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>We’ve finished verifying that the primary Process contains no logic related to HITL reviews. Next, let’s look at the second Process of this design, which contains the IA logic related to writing review data to disk and checking for <span class="No-Break">completed reviews.</span></p>
			<h4>Examine the Process that checks for reviewed predictions</h4>
			<p>This second<a id="_idIndexMarker413"/> Process is developed using the standard BP Process Template. We’ll see that all of the logic regarding HITL reviews has been moved to this <span class="No-Break">new Process:</span></p>
			<ol>
				<li>Open <strong class="bold">Example 2B – Manual Review Logic</strong> Process under the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>See that the Queue Name on the <strong class="source-inline">Main Page</strong> is also set to <span class="No-Break"><strong class="bold">Chapter 5</strong></span><strong class="bold"> Example 2 Queue</strong>, matching the Work Queue in <strong class="bold">Example 2A – Random Sampling </strong>Process. Both Processes work from the <span class="No-Break">same Queue.</span></li>
				<li>Open any of the <strong class="bold">Get Next Item</strong> Actions on the <strong class="source-inline">Main Page</strong>. See that there’s a Tag Filter that selects Items tagged with <strong class="bold">Manual </strong><span class="No-Break"><strong class="bold">Review Required</strong></span><span class="No-Break">.</span></li>
				<li>Look at the Work Block on the <strong class="source-inline">Main Page</strong>. There are two steps. First, review data is written to the share folders. Next, we check to see whether the Item has been moved to the <em class="italic">completed</em> folder, indicating that it has been reviewed. Putting these in the Work Block allows us to gracefully recover from Exceptions and retry Items from the <span class="No-Break">Control Room:</span></li>
			</ol>
			<div>
				<div id="_idContainer141" class="IMG---Figure">
					<img src="image/B18416_05_18.jpg" alt="Figure 5.18 – The two steps related to review logic are in the Work Block" width="688" height="458"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.18 – The two steps related to review logic are in the Work Block</p>
			<ol>
				<li value="5">Open the <strong class="source-inline">02 Check for Reviewed </strong><span class="No-Break"><strong class="source-inline">Predictions</strong></span><span class="No-Break"> Page.</span></li>
				<li>Locate<a id="_idIndexMarker414"/> the <em class="italic">Update Item</em> Block. See that we’re Updating the Status and removing the Tag when an Item is reviewed. The remaining logic on this Page is related to shared folder <span class="No-Break">file management:</span></li>
			</ol>
			<div>
				<div id="_idContainer142" class="IMG---Figure">
					<img src="image/B18416_05_19.jpg" alt="Figure 5.19 – Update the Item’s Status and Tag" width="273" height="438"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.19 – Update the Item’s Status and Tag</p>
			<p>So far, we’ve seen that Process 1 no longer contains HITL review logic and that both Processes share the same Work Queue. Process 2 removes the <strong class="bold">Manual Review Required</strong> Tag to inform Process 1 that an Item has been reviewed. The Status update is to enable the <em class="italic">Choice</em> Stage on the <strong class="source-inline">Main Page</strong> to skip steps in case of <span class="No-Break">Item retries.</span></p>
			<h4>Run the primary Process</h4>
			<p>Let’s run the main<a id="_idIndexMarker415"/> Process and examine the Work Queue. This Process randomly generates 13 Items to populate the Work Queue and performs ML predictions. We should see that all Items will stop processing, pending <span class="No-Break">human review:</span></p>
			<ol>
				<li>Locate the <em class="italic">Ch5</em> folder and run <strong class="bold">Example 2A – Random Sampling </strong>in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the contents of the <span class="No-Break"><strong class="bold">Chapter 5</strong></span><strong class="bold"> Example 2 Queue</strong>. See that all 13 Items have the <strong class="bold">Manual Review Required</strong> Status and Tag since our random sampling rate is set <span class="No-Break">to 100%:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer143" class="IMG---Figure">
					<img src="image/B18416_05_20.jpg" alt="Figure 5.20 – All Items have the Manual Review Required Status" width="511" height="166"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.20 – All Items have the Manual Review Required Status</p>
			<ol>
				<li value="3">Open Windows File Explorer and navigate to the folder defined in the <strong class="bold">Ch5 Example 2 To Review Folder Path</strong> Environment Variable. Check that there are no Excel files in this folder. This is because the logic to write review files to disk has been moved to Process 2, which hasn’t been <span class="No-Break">run yet.</span></li>
			</ol>
			<h4>Run the HITL review-checking logic Process</h4>
			<p>The second Process <a id="_idIndexMarker416"/>writes review data to the shared folder and checks for completed reviews. This should be run <em class="italic">concurrently</em> with the previous Process. However, we’ll be running the Processes sequentially for the benefit of readers using the trial edition of BP. Here, we’ll be reviewing eight of the thirteen predictions before running the second <span class="No-Break">Process again:</span></p>
			<ol>
				<li>Locate the <em class="italic">Ch5</em> Group and run the <strong class="bold">Example 2B – Manual Review Logic </strong>Process in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>Open Windows File Explorer and navigate to the folder defined in the <strong class="bold">Ch5 Example 2 To Review Folder Path</strong> Environment Variable. Check that there are three Excel files in this folder. Two of the Excel files should have five items needing review (according to the batch size) and one file should have three, totaling 13. Notice that Item ID is no longer a column in <span class="No-Break">the file.</span></li>
				<li>Cut and paste one of the files with five predictions and the file that has three predictions into the folder defined in the <strong class="bold">Ch5 Example 2 Completed Review Folder Path</strong> Environment Variable. This simulates what a reviewer does after completing the review of two Excel files, totaling <span class="No-Break">eight predictions.</span></li>
				<li>Run <strong class="bold">Example 2B – Manual Review Logic </strong>in the Control Room again. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>Look at <span class="No-Break"><strong class="bold">Chapter 5</strong></span><strong class="bold"> Example 2 Queue </strong>Work Queue to see that eight of the Item’s Statuses are set to <strong class="bold">Manual Review Complete</strong> and have <span class="No-Break">been untagged:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer144" class="IMG---Figure">
					<img src="image/B18416_05_21.jpg" alt="Figure 5.21 – Eight Items have updated their Status and removed their Tag" width="535" height="371"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.21 – Eight Items have updated their Status and removed their Tag</p>
			<ol>
				<li value="6">Open <a id="_idIndexMarker417"/>Windows File Explorer and navigate to the folder defined in the <strong class="bold">Ch5 Example 2 Completed Review Folder Path</strong> Environment Variable. Verify that there are no longer any Excel files in <span class="No-Break">this folder.</span></li>
			</ol>
			<p>At this point, eight of the Items have been untagged, meaning that they can be picked up by Process 1’s <strong class="bold">Get Next </strong><span class="No-Break"><strong class="bold">Item</strong></span><span class="No-Break"> Action.</span></p>
			<h4>Run the primary Process again</h4>
			<p>We will<a id="_idIndexMarker418"/> rerun the primary Process and pretend that it never stopped. While 13 new Work Queue Items will be created, we’re more interested in seeing that the 8 Items from the previous run are marked <span class="No-Break">as </span><span class="No-Break"><strong class="bold">Completed</strong></span><span class="No-Break">:</span></p>
			<ol>
				<li>Run <strong class="bold">Example 2A – Random Sampling </strong>in the Control Room again. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the contents of <span class="No-Break"><strong class="bold">Chapter 5</strong></span><strong class="bold"> Example 2 Queue</strong>. See that 8 of the 26 Items are marked <span class="No-Break">as </span><span class="No-Break"><strong class="bold">Completed</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>In this example, we saw how the review-checking logic can be separated into its own Process, independent from the main business logic. This has a number of benefits, namely promoting reusability and allowing for the independent scaling of the business logic versus the review-checking logic. The overall robustness of the data transfer design is also improved by removing the need to expose the Item ID to reviewers, and by locating the review-checking logic inside of an <span class="No-Break">Exception-handling Block.</span></p>
			<p>Now, let’s move on from <em class="italic">multiple</em>-Process, <em class="italic">single</em>-Work Queue designs, and explore why we might want to use <em class="italic">multiple</em> Processes and <em class="italic">multiple</em> Work Queues <span class="No-Break">in IA.</span></p>
			<h1 id="_idParaDest-82"><a id="_idTextAnchor083"/>Multiple-process, multiple-work queue designs</h1>
			<p>Adding<a id="_idIndexMarker419"/> new Process(es) and Work Queue(s) is a great way to <em class="italic">add ML to an existing BP solution</em>, as much of the original design and Process diagram can stay the same. While adding more Work Queues leads to an overall more complex design, they can add some nuanced improvements to our solution, especially around auditing, making them worthy <span class="No-Break">of consideration.</span></p>
			<p>Let’s look at the pros and cons of a <em class="italic">two-Process</em>, <em class="italic">two-Queue</em> IA solution design, where the Work Queue Items that need human review are saved to a separate <span class="No-Break">Work Queue.</span></p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor084"/>Fully independent manual reviews</h2>
			<p>One of the<a id="_idIndexMarker420"/> downsides<a id="_idIndexMarker421"/> of the <em class="italic">two-Process</em>, <em class="italic">single</em>-Work Queue design is that the case duration statistics end up higher due to the repeated checking of each Item. If we instead push all Items that need review into a <em class="italic">new Work Queue</em>, we can separate the time spent processing the business logic from the time that is spent on <span class="No-Break">review checking.</span></p>
			<p>This <em class="italic">two</em> Queue design is shown in the following figure. The first Process performs the business logic, including making ML predictions. If an Item requires manual review, <em class="italic">only data that is relevant to the review</em> is pushed into Work Queue 2. Process 2 saves review data in the review interface and checks to see whether the review is completed. If a review is complete, it updates the Item Status in Work Queue 1 so that automated processing <span class="No-Break">can continue:</span></p>
			<div>
				<div id="_idContainer145" class="IMG---Figure">
					<img src="image/B18416_05_22.jpg" alt="Figure 5.22 – A two-Process, two-Work Queue design" width="923" height="231"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.22 – A two-Process, two-Work Queue design</p>
			<h3>Functionality</h3>
			<p>The<a id="_idIndexMarker422"/> functionality of this design is identical to the multiple-Process, single-Queue design. We can dedicate <em class="italic">all</em> of Process 1’s time to executing business logic, and we can have <em class="italic">independent scaling</em> of the two Processes. Adding a new Work Queue doesn’t affect <span class="No-Break">the functionality.</span></p>
			<h3>Maintainability</h3>
			<p>This design<a id="_idIndexMarker423"/> actually improves maintainability compared to the two-Process, single-Queue one. The addition of the Work Queue leads to an even cleaner separation between the business logic and the HITL <span class="No-Break">review logic.</span></p>
			<h3>Operability</h3>
			<p>The addition <a id="_idIndexMarker424"/>of a new Work Queue most directly impacts how we operate the IA solution. Although being able to isolate the time spent performing business logic versus the time spent in manual review logic is useful, the reporting and Control Room operations can become more complex. If you want a view of how long an Item takes to complete, including the review logic time, the case durations of the two Queues need to be added together in your reporting. This should really only be a one-off change to the automated reporting that’s put into place, though. The Controller also needs to navigate between two Work Queues, while remembering the <em class="italic">Item Key</em>, to get a full picture of what’s happening with an Item, which is an <span class="No-Break">operational inconvenience.</span></p>
			<h3>Pros</h3>
			<p>The<a id="_idIndexMarker425"/> main benefit of this design, something that will become increasingly important in the future, is that the second Work Queue enables <em class="italic">simpler HITL auditing</em>. Since we only push the minimum amount of data needed to perform the human review, the Session Logs or Work Queue data of Process 2 can be readily exported without exposing unnecessary data. We should strongly consider implementing this Process design if we need to frequently answer <span class="No-Break">the following:</span></p>
			<ul>
				<li>What were the original inputs to the <span class="No-Break">ML prediction?</span></li>
				<li>Who performed <span class="No-Break">the review?</span></li>
				<li>What was the revised label <span class="No-Break">and why?</span></li>
			</ul>
			<p>While they might not seem relevant now, these are precisely the types of questions that regulators and courts of law will ask whether an ML prediction causes harm or damage to a user <span class="No-Break">or customer.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If the Windows filesystem is used as the data-sharing method, you must explicitly enable folder or file-based auditing. This will generate security events that allow you to find out which user has modified a file (reviewed <span class="No-Break">a prediction).</span></p>
			<p>The isolated Work Queue or Session Log data that contains only what has been human-reviewed can be readily <em class="italic">fed back to the data scientists</em> who developed the algorithm. If we didn’t have this clean source of corrected data, we would need to generate it by filtering the Session Logs programmatically and removing any extraneous data. The main benefits of this design are simplified HITL auditing and enabling data feedback to the ML <span class="No-Break">model developers.</span></p>
			<p>Finally, this type of design is well-suited to turning existing RPA Processes into IA ones as the existing RPA design can largely <span class="No-Break">remain unchanged.</span></p>
			<h3>Cons</h3>
			<p>Most of <a id="_idIndexMarker426"/>the negatives are the operational inconveniences discussed earlier. Items must now be tracked across multiple Work Queues and reporting becomes <span class="No-Break">more complex.</span></p>
			<p>Now that we’ve discussed a <em class="italic">two</em>-Process, <em class="italic">two</em>-Work Queue design, let’s go one step further and separate out the ML prediction logic <span class="No-Break">as well.</span></p>
			<h2 id="_idParaDest-84"><a id="_idTextAnchor085"/>Separating ML predictions and manual reviews into their own Processes and Work Queues</h2>
			<p>If we need to <a id="_idIndexMarker427"/>expand the simplified auditing to <em class="italic">encompass all ML predictions</em>, we can move the ML <a id="_idIndexMarker428"/>algorithm calling steps and data into their own Process and Work Queue. This leads to a <em class="italic">three</em>-Process, <em class="italic">three</em>-Work Queue design, as shown in the <span class="No-Break">following figure:</span></p>
			<div>
				<div id="_idContainer146" class="IMG---Figure">
					<img src="image/B18416_05_23.jpg" alt="Figure 5.23 – A three-Process, three-Work Queue design" width="1029" height="336"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.23 – A three-Process, three-Work Queue design</p>
			<p>Our first Process and Work Queue contain standard business logic. All ML predictions that need to be made are added to Work Queue 2, which is worked by Process 2. Process 2 executes the ML algorithm, generates the prediction, and decides whether human review is necessary. If human review isn’t needed, the Item’s Status is updated in Work Queue 1 so that automated processing continues. If human review is needed, the Item gets pushed into Work Queue 3. Process 3 creates the data needed for HITL review and updates the Item Status in Queue 1 when the review <span class="No-Break">is completed.</span></p>
			<h3>Functionality, maintainability, and operability</h3>
			<p>These <a id="_idIndexMarker429"/>are largely the same as the <a id="_idIndexMarker430"/>two-Process, two-Work <span class="No-Break">Queue </span><span class="No-Break"><a id="_idIndexMarker431"/></span><span class="No-Break">design.</span></p>
			<h3>Pros</h3>
			<p>The <a id="_idIndexMarker432"/>benefits are largely the same as the <em class="italic">two</em>-Process, <em class="italic">two</em>-Work Queue design, except that we gain additional <em class="italic">audit options for all ML predictions</em> that <span class="No-Break">are made.</span></p>
			<h3>Cons</h3>
			<p>This <a id="_idIndexMarker433"/>design suffers from the same problems as the <em class="italic">two</em>-Process, <em class="italic">two</em>-Work Queue design. Depending on business needs, the reporting can be more complicated if we need to add the execution times of multiple Work Queues together. The Controller will have an even harder time keeping track of what’s happening to a case across three different <span class="No-Break">Work Queues.</span></p>
			<p>Next, let’s look at an implementation of this <em class="italic">three</em>-Process, <em class="italic">three</em>-Work Queue design through <span class="No-Break">an example.</span></p>
			<h3>Example 3 – full separation</h3>
			<p>In this <a id="_idIndexMarker434"/>example (based on a real-life IA case), we’re automating a national utility’s customer claims process. 5,000 <a id="_idIndexMarker435"/>claims are processed per month. The current non-automated process requires human judgment and there are 25 possible resolutions to a <span class="No-Break">customer’s claim.</span></p>
			<p>This national utility has developed an ML recommendation system that displays the top three resolution suggestions and their confidence scores. Manual review is triggered when the confidence scores of the top two recommendations are within 5% of each other. This is a more complex form of <em class="italic">thresholding</em> where there’s a dependency between the <span class="No-Break">predicted labels.</span></p>
			<p>Cases are reviewed through a web interface containing the three recommendations, their confidence levels, the relevant case data, and customer data. Since the solution is for a national utility, the IA team wants to stay ahead of regulations and implement a solution design that facilitates the auditing of all ML predictions and <span class="No-Break">human reviews.</span></p>
			<p>The goal of this example is to illustrate the logic needed to get this three-Process, three-Work Queue design working. At a high level, we will go through the following <span class="No-Break">11 steps:</span></p>
			<ol>
				<li>Verify the Release contents and configure an <span class="No-Break">Environment Variable.</span></li>
				<li>Examine Process 1’s (business logic) <span class="No-Break"><strong class="source-inline">Main Page</strong></span><span class="No-Break">.</span></li>
				<li>See how data is pushed into the ML Queue (<span class="No-Break">Queue 2).</span></li>
				<li>Examine Process 2’s (ML prediction) <span class="No-Break"><strong class="source-inline">Main Page</strong></span><span class="No-Break">.</span></li>
				<li>Examine Process 3’s (HITL review) <span class="No-Break"><strong class="source-inline">Main Page</strong></span><span class="No-Break">.</span></li>
				<li>Run Process 1 and see the result in the <span class="No-Break">Control Room.</span></li>
				<li>Run Process 2 and see the result in the <span class="No-Break">Control Room.</span></li>
				<li>Run Process 3 and see the result in the <span class="No-Break">Control Room.</span></li>
				<li>Review <span class="No-Break">one prediction.</span></li>
				<li>Run Process 3 again and see the result in the <span class="No-Break">Control Room.</span></li>
				<li>Run <a id="_idIndexMarker436"/>Process 1 again<a id="_idIndexMarker437"/> and see the result in the <span class="No-Break">Control Room.</span></li>
			</ol>
			<h4>Verify the Release contents and configure an Environment Variable</h4>
			<p>Let’s get <a id="_idIndexMarker438"/>familiar with <strong class="source-inline">.bprelease</strong> and configure one<a id="_idIndexMarker439"/> <span class="No-Break">Environment Variable:</span></p>
			<ol>
				<li>Verify that <em class="italic">three</em> Processes, <em class="italic">three</em> Work Queues, and <em class="italic">three</em> Environment Variables have <span class="No-Break">been imported:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer147" class="IMG---Figure">
					<img src="image/B18416_05_24.jpg" alt="Figure 5.24 – The Release contents for Example 3" width="358" height="335"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.24 – The Release contents for Example 3</p>
			<ol>
				<li value="2">Open the<a id="_idIndexMarker440"/> Environment Variable named <strong class="bold">Ch5 Example 3 Completed Review Folder Path</strong>. Change the value so that it matches the default download folder of your web browser. Do not put a trailing slash at the end of the <span class="No-Break">folder name.</span></li>
			</ol>
			<h4>Examine Process 1’s Main Page</h4>
			<p>Next, let’s <a id="_idIndexMarker441"/>look at the first Process, which contains the primary business logic. This is close to what an RPA Process would look like without any IA components added. We’ll highlight the areas that make this solution <span class="No-Break">design function:</span></p>
			<ol>
				<li>Open <strong class="bold">Example 3A – IA Business Logic</strong> in the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>Open <a id="_idIndexMarker442"/>any of the <strong class="bold">Get Next Item</strong> Actions on the <strong class="source-inline">Main Page</strong>. See that a <strong class="bold">Tag Filter</strong> has been added to not select Items with the <strong class="bold">Waiting ML Prediction</strong> or <strong class="bold">Manual Review </strong><span class="No-Break"><strong class="bold">Required</strong></span><span class="No-Break"> Tags:</span></li>
			</ol>
			<div>
				<div id="_idContainer148" class="IMG---Figure">
					<img src="image/B18416_05_25.jpg" alt="Figure 5.25 – Get Next Item filters on two Tags" width="574" height="329"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.25 – Get Next Item filters on two Tags</p>
			<ol>
				<li value="3">Look at<a id="_idIndexMarker443"/> the <em class="italic">Work</em> Block. There’s a Page named <strong class="source-inline">03 Push to Queue 2</strong> that’s responsible for connecting this Process to Process 2, which performs all ML predictions. All execution paths lead to this Page, meaning that all Items will eventually be pushed to Queue 2 for <span class="No-Break">ML prediction:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer149" class="IMG---Figure">
					<img src="image/B18416_05_26.jpg" alt="Figure 5.26 – The 03 Push to Queue 2 Page" width="925" height="483"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.26 – The 03 Push to Queue 2 Page</p>
			<ol>
				<li value="4">See<a id="_idIndexMarker444"/> that there’s an <strong class="source-inline">Unlock Item</strong> Page following <strong class="source-inline">03 Push to </strong><span class="No-Break"><strong class="source-inline">Queue 2</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>Here, we saw that Tag Filters were used in <strong class="bold">Get Next Item</strong> so that Items that require manual review or ML prediction are <span class="No-Break">not selected.</span></p>
			<p>Next, let’s look at what happens on the <strong class="source-inline">03 Push to Queue </strong><span class="No-Break"><strong class="source-inline">2</strong></span><span class="No-Break"> Page.</span></p>
			<h4>Pushing Items into the ML Work Queue</h4>
			<p>The <strong class="source-inline">03 Push to Queue 2</strong> Page adds a new Item in Work Queue 2, <strong class="bold">Tags</strong> the current<a id="_idIndexMarker445"/> Item, and adds a reference to the newly created Item in Work Queue 2 to the current <span class="No-Break">Item’s Data:</span></p>
			<ol>
				<li>Open the <strong class="source-inline">03 Push to Queue </strong><span class="No-Break"><strong class="source-inline">2</strong></span><span class="No-Break"> Page.</span></li>
				<li>Look at the first three Actions that are connected to Start. The first Action copies the existing Item Data into a new Collection, omitting any Data that’s irrelevant to the ML prediction. The second Action adds the current Item ID of Work Queue 1 into this new Collection. The third Action adds this new Collection to Work <span class="No-Break">Queue 2:</span></li>
			</ol>
			<div>
				<div id="_idContainer150" class="IMG---Figure">
					<img src="image/B18416_05_27.jpg" alt="Figure 5.27 – The first three Actions of the 03 Push to Queue 2 Page" width="495" height="332"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.27 – The first three Actions of the 03 Push to Queue 2 Page</p>
			<ol>
				<li value="3">Open the next Action named <strong class="bold">Work Queues::Tag Item</strong>. See that we add the <strong class="bold">Waiting ML Prediction</strong> Tag to the current Item, which prevents it from being picked up in this Process using <strong class="bold">Get Next Item</strong>. This Tag will be removed in <span class="No-Break">Process 2.</span></li>
			</ol>
			<p>Process 1 is <a id="_idIndexMarker446"/>relatively straightforward. Only a few changes have been made to the standard Process Template, namely adding <em class="italic">Tag Filters</em> to <strong class="bold">Get Next Item</strong>, adding a new Page to push Items into Work Queue 2, and unlocking the <span class="No-Break">current Item.</span></p>
			<p>Next, let’s look at the ML prediction <span class="No-Break">Process itself.</span></p>
			<h4>Examine Process 2’s Main Page</h4>
			<p>Let’s quickly<a id="_idIndexMarker447"/> look at Process 2’s <strong class="source-inline">Main</strong> <strong class="source-inline">Page</strong> to understand the logic that’s happening at a high level. This Process is responsible for running the ML prediction and checking to see whether HITL review is required <span class="No-Break">through thresholding:</span></p>
			<ol>
				<li>Open <strong class="bold">Example 3B – ML Prediction</strong> in the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>Look at the first two Pages in the <em class="italic">Work</em> Block on the <strong class="source-inline">Main Page</strong>. <strong class="source-inline">01 ML Prediction</strong> triggers the ML prediction and persists the predicted results into the current Item Data. <strong class="source-inline">02 Check for Manual Review</strong> contains the logic that checks the <em class="italic">threshold</em> between the two recommended resolutions with the highest Confidence Scores. These first two Pages have similar logic to what we’ve seen in <span class="No-Break">previous examples:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer151" class="IMG---Figure">
					<img src="image/B18416_05_28.jpg" alt="Figure 5.28 – The first two Pages in the Work Block of Process 2" width="411" height="567"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.28 – The first two Pages in the Work Block of Process 2</p>
			<ol>
				<li value="3">Look at the <strong class="source-inline">03a Update Queue 1 Item</strong> Page. It is run when HITL review is not needed. In this Page, we try to lock the equivalent Item in Work Queue 1, update its Status, and remove the Tag. This allows Process 1 to continue processing <span class="No-Break">this Item.</span></li>
				<li>Look at<a id="_idIndexMarker448"/> the <strong class="source-inline">03b Push to Queue 3</strong> Page. It is run when HITL review is needed. This Page contains the logic needed to create an Item for Queue 3. It’s largely the same as what was done in Process 1 to push an Item into Work <span class="No-Break">Queue 2.</span></li>
			</ol>
			<h4>Examine Process 3’s Main Page</h4>
			<p>Finally, let’s take a<a id="_idIndexMarker449"/> high-level look at our third Process, which is responsible for saving the <strong class="source-inline">.html</strong> files for the reviewers, as well as checking for <span class="No-Break">completed reviews:</span></p>
			<ol>
				<li>Open <strong class="bold">Example 3C – Manual Review Logic</strong> in the <em class="italic">Ch5</em> Group in the <span class="No-Break">Process Studio.</span></li>
				<li>See that the <em class="italic">Work</em> Block on the <strong class="source-inline">Main Page</strong> only has two Pages. There’s no Choice Stage and Status checking to skip steps because we want to be able to recreate the <strong class="source-inline">.html</strong> files if <span class="No-Break">they’re missing:</span></li>
			</ol>
			<p class="IMG---Figure">  </p>
			<div>
				<div id="_idContainer152" class="IMG---Figure">
					<img src="image/B18416_05_29.jpg" alt="Figure 5.29 – Two Pages in the Work Block of Process 3" width="681" height="643"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.29 – Two Pages in the Work Block of Process 3</p>
			<ol>
				<li value="3">Look at the <strong class="source-inline">01 Write Shared Review Data</strong> Page. It writes the input data to the ML algorithm and the three predictions into a .html file using Find/replace. Once the file is saved to the shared location specified by the <strong class="bold">Ch5 Example 3 To Review Folder Path</strong> Environment Variable, this file path is saved into the current Item’s Data. This allows us to check to<a id="_idIndexMarker450"/> see whether the file is missing and recreate it <span class="No-Break">if necessary.</span></li>
				<li>Look at the <strong class="source-inline">02 Check for Reviewed Predictions</strong> Page. It checks to see whether a <strong class="source-inline">.txt</strong> file is present in the location specified by the <strong class="bold">Ch5 Example 3 Completed Review Folder Path</strong> Environment Variable. If yes, we try to lock the equivalent Item in Work Queue 1, update its Status, and remove the Tag. This allows Process 1 to continue processing this Item after it’s retrieved using <strong class="bold">Get </strong><span class="No-Break"><strong class="bold">Next Item</strong></span><span class="No-Break">.</span></li>
				<li>Look at the two Pages that follow the <em class="italic">Item Review Complete?</em> Decision Stage. Depending on whether the Item was manually reviewed, we either defer the Item or mark it <span class="No-Break">as</span><span class="No-Break"><a id="_idIndexMarker451"/></span><span class="No-Break"> Completed.</span></li>
			</ol>
			<p>After examining the three Processes of this solution, we should notice that nothing here is really new compared to the earlier examples in this chapter. However, we’ve structured the solution such that the three different concerns – the business logic, the ML prediction logic, and the HITL review logic – stay <span class="No-Break">relatively independent.</span></p>
			<p>Communication between Work Queues happens by persisting the Item ID of other Queues into our Item Data. This allows us to lock and update Item Tags and Statuses of Process 1, containing the main <span class="No-Break">business flow.</span></p>
			<p>Now, let’s run the <span class="No-Break">example Process.</span></p>
			<h4>Run the primary Process</h4>
			<p>We need to <a id="_idIndexMarker452"/>run three Processes in the Control Room to complete our example. The primary Process that we’ll run next randomly generates 10 items to populate the Work Queue. After populating, each item should have the Status and Tags set so that we’re waiting for an ML prediction before we <span class="No-Break">can continue:</span></p>
			<ol>
				<li>Run <strong class="bold">Example 3A – IA Business Logic</strong> in the <em class="italic">Ch5</em> Group in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 1</em> under <strong class="bold">Queue Management</strong>. See that all 10 Items have the <strong class="bold">Waiting ML </strong><span class="No-Break"><strong class="bold">Prediction</strong></span><span class="No-Break"> Tag:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer153" class="IMG---Figure">
					<img src="image/B18416_05_30.jpg" alt="Figure 5.30 – All Items in Queue 1 are waiting for ML prediction" width="475" height="299"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.30 – All Items in Queue 1 are waiting for ML prediction</p>
			<ol>
				<li value="3">View the contents of <span class="No-Break"><strong class="source-inline">Chapter 5</strong></span><strong class="source-inline"> Example 3 Queue 2</strong> under <strong class="bold">Queue Management</strong>. There should be 10 Items in this Queue, with the same Item Keys <a id="_idIndexMarker453"/>that are in <span class="No-Break">Queue 1.</span></li>
			</ol>
			<p>The Items are now waiting for Process 2 <span class="No-Break">to run.</span></p>
			<h4>Run the ML Process</h4>
			<p>The second <a id="_idIndexMarker454"/>Process that we need to run generates the ML prediction and determines which Items require HITL review. Work Queues 1, 2, and 3 are modified by <span class="No-Break">this Process:</span></p>
			<ol>
				<li>Run <strong class="bold">Example 3B – ML Prediction</strong> in the <em class="italic">Ch5</em> Group in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 2</em> under <strong class="bold">Queue Management</strong>. See that all 10 Items have completed their <span class="No-Break">ML prediction:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer154" class="IMG---Figure">
					<img src="image/B18416_05_31.jpg" alt="Figure 5.31 – All Items in Queue 2 have finished their ML prediction" width="243" height="301"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.31 – All Items in Queue 2 have finished their ML prediction</p>
			<ol>
				<li value="3">View the<a id="_idIndexMarker455"/> contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 1</em> under <strong class="bold">Queue Management</strong>. See that some of the Items require HITL review. Note that this is truly random. If you don’t see any Items that need review, please run Process 1 and Process 2 again. Count the number of Items that need review. In the following figure, <span class="No-Break">it’s two:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer155" class="IMG---Figure">
					<img src="image/B18416_05_32.jpg" alt="Figure 5.32 – Some Items in Queue 1 should require manual review" width="498" height="303"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.32 – Some Items in Queue 1 should require manual review</p>
			<ol>
				<li value="4">View the contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 3</em> under <strong class="bold">Queue Management</strong>. There should be the same number of Items in this queue as was counted in <em class="italic">step 3</em> (two). You<a id="_idIndexMarker456"/> can compare the two Queues based on Item Key <span class="No-Break">as well:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer156" class="IMG---Figure">
					<img src="image/B18416_05_33.jpg" alt="Figure 5.33 – Items needing manual review in Queue 1 should also be in Queue 3" width="123" height="118"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.33 – Items needing manual review in Queue 1 should also be in Queue 3</p>
			<h4>Run the HITL review Process</h4>
			<p>Now, let’s run<a id="_idIndexMarker457"/> the final Process. This Process generates review data and checks to see whether a review is complete. If so, it updates the Item in Work Queue 1 so that it can continue <span class="No-Break">automated processing:</span></p>
			<ol>
				<li>Run <strong class="bold">Example 3C – Manual Review Logic </strong>in the <em class="italic">Ch5</em> Group in the Control Room. Wait for the Session to complete. This Process will have looped through all Items needing review, created their review files, and checked to see whether the review <span class="No-Break">was complete.</span></li>
				<li>Open the folder defined by the <strong class="bold">Ch5 Example 3 To Review Folder Path</strong> Environment Variable in Windows Explorer. The number of <strong class="source-inline">.html</strong> files in the folder should be the same as the number of Items in <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 1</em> (two in <span class="No-Break">this case).</span></li>
			</ol>
			<h4>Manually review one file</h4>
			<p>Let’s review one<a id="_idIndexMarker458"/> prediction by opening one of the review files and submitting the web form. This web form will attempt to save a <strong class="source-inline">.txt</strong> file to the location specified by the <strong class="bold">Ch5 Example 3 Completed Review Folder Path</strong> <span class="No-Break">Environment Variable:</span></p>
			<ol>
				<li>Choose one of the <strong class="source-inline">.html</strong> files and open it in your <span class="No-Break">web browser.</span></li>
				<li>Scroll to the<a id="_idIndexMarker459"/> bottom of the web page, select a random Resolution from the drop-down list, and press the <strong class="bold">Submit Reviewed </strong><span class="No-Break"><strong class="bold">Prediction</strong></span><span class="No-Break"> button:</span></li>
			</ol>
			<div>
				<div id="_idContainer157" class="IMG---Figure">
					<img src="image/B18416_05_34.jpg" alt="Figure 5.34 – Manually review the Item" width="992" height="935"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.34 – Manually review the Item</p>
			<ol>
				<li value="3">Save the file if the <strong class="bold">Save as</strong> dialog appears. Ensure that the folder that you save the file to matches the value of the <strong class="bold">Ch5 Example 3 Completed Review Folder Path</strong> Environment Variable. Do not rename the file. The <strong class="bold">Save as</strong> dialog might <a id="_idIndexMarker460"/>not appear if your browser is set to automatically <span class="No-Break">download files.</span></li>
			</ol>
			<h4>Run the HITL review Process again</h4>
			<p>Now that we’ve reviewed a prediction, we can run the third Process again (this will find that there’s a matching .txt file for one of the Items, and update that Item in Work Queue 1 by removing the Tag so that it can be picked up by Process 1’s Get <span class="No-Break">Next Item):</span></p>
			<ol>
				<li>Run <strong class="bold">Example 3C – Manual Review Logic</strong> in the <em class="italic">Ch5</em> Group in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the <a id="_idIndexMarker461"/>contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 3</em> under <strong class="bold">Queue Management</strong>. One of the Items should be marked <span class="No-Break">as </span><span class="No-Break"><strong class="bold">Completed</strong></span><span class="No-Break">:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer158" class="IMG---Figure">
					<img src="image/B18416_05_35.jpg" alt="Figure 5.35 – One Item has been marked as Completed in Queue 3" width="207" height="117"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.35 – One Item has been marked as Completed in Queue 3</p>
			<ol>
				<li value="3">View the contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 1</em> under <strong class="bold">Queue Management</strong>. The Item with the same Item Key should have a <strong class="bold">Manual Review Complete</strong> Status and <span class="No-Break">no Tag:</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer159" class="IMG---Figure">
					<img src="image/B18416_05_36.jpg" alt="Figure 5.36 – The same Item in Queue 1 should have an updated Status and no Tag" width="485" height="299"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.36 – The same Item in Queue 1 should have an updated Status and no Tag</p>
			<h4>Run the primary Process again</h4>
			<p>The last step in this example is to run the primary Process again (note that 10 new Items will be added to Queue 1 and Queue 2; we expect all of the Items from the previous Session run to complete except for those marked as <strong class="bold">Manual </strong><span class="No-Break"><strong class="bold">Review Required</strong></span><span class="No-Break">):.</span></p>
			<ol>
				<li>Run<a id="_idIndexMarker462"/> <strong class="bold">Example 3A – IA Business Logic </strong>in the <em class="italic">Ch5</em> Group in the Control Room. Wait for the Session <span class="No-Break">to complete.</span></li>
				<li>View the contents of <a href="B18416_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a><em class="italic"> Example 3 Queue 1</em> under <strong class="bold">Queue Management</strong>. See that all of the Items that were added in the original Session run are marked as <strong class="bold">Completed</strong>, except for<a id="_idIndexMarker463"/> the ones tagged with <strong class="bold">Manual </strong><span class="No-Break"><strong class="bold">Review Required</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>We’ve completed <em class="italic">Example 3</em>. In this example, we went through a <em class="italic">three</em>-Process, <em class="italic">three</em>-Work Queue design that separates ML logic and HITL review logic into their own Process and Work Queue. Inter-process communication is handled by Tag Filters, Statuses, and keeping references to the equivalent Item IDs in <span class="No-Break">other Queues.</span></p>
			<p>The main benefits of this type of design are simplified auditability and the separate scaling of different IA concerns. We won’t go through the motions of exporting the Session Logs, but it’s straightforward to see that we can selectively export just the ML or HITL review logs in case a customer (or regulatory body) complains about the resolution chosen for <span class="No-Break">their claim.</span></p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor086"/>Design comparison</h1>
			<p>We’ve covered five different IA designs that varied in terms of their number of Processes and Work Queues. Let’s review the designs to understand why we might want to choose one design over another. Keep in mind that none of the designs are better or worse than others. It’s about how appropriate it is for your use case, the skill level of developers, and the overall maturity of the <span class="No-Break">IA initiative.</span></p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor087"/>Design 1 – asynchronous reviews (one Process, one Work Queue)</h2>
			<p>This self-contained <a id="_idIndexMarker464"/>design allows for human review to be delayed forever. The Process alternates through cycles of doing work on an Item and checking for reviewed predictions. The checking of completed reviews is done by querying the data share location as opposed to looping through each Item that’s <span class="No-Break">pending review.</span></p>
			<p>Since everything is in a single Process and Work Queue, it’s well suited for scenarios where the number of concurrent Sessions available is limited or the work volume is low. Control Room management overhead is also low. Maintaining/updating the single Process can be considered simpler for newer <span class="No-Break">development teams.</span></p>
			<p>This design is <a id="_idIndexMarker465"/>less suitable if checking for a reviewed prediction takes a long time to execute or is prone to throw Exceptions. This is because the checking logic is located outside of the main <span class="No-Break">Work Block.</span></p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor088"/>Design 2 – synchronous (polling) reviews (one Process, one Work Queue)</h2>
			<p>This design should be used <a id="_idIndexMarker466"/>when we need to stop and wait for HITL review to complete when HITL is required. If a human review isn’t performed within the time limit, the Item is marked as an Exception. Since each Item pauses and waits for human review, the overall case throughput of this design is the lowest. Otherwise, it has similar pros/cons to the <span class="No-Break">asynchronous design.</span></p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor089"/>Design 3 – independent HITL review logic (two Processes, one Work Queue)</h2>
			<p>This design splits the<a id="_idIndexMarker467"/> HITL review logic into a separate Process while keeping the same Work Queue. The main benefit of this design is that the business logic and review checking can be scaled independently in terms of Session runs. The maintainability in my opinion is <span class="No-Break">also improved.</span></p>
			<p>This design loops through all Work Queue Items that need human review instead of looping at the data share interface. This allows review records to be recreated if they’re missing. This also increases the Total Work Time of an individual case, making the statistics <span class="No-Break">look worse.</span></p>
			<p>Since there are two BP Processes, we need a minimum of two Sessions to run this solution. If the Session runs for the review logic Process are infrequent, the data share records won’t be created in a timely manner, even if the reviewers are available to do their work. Items that have finished human review also depend on frequent runs of the review-checking Process so that the Item can have its Status updated and picked up for continued <span class="No-Break">automated processing.</span></p>
			<p>Finally, the <a id="_idIndexMarker468"/>scheduling is more complex when compared to single-Process solutions, although this shouldn’t be an issue for <span class="No-Break">experienced Controllers.</span></p>
			<h2 id="_idParaDest-89"><a id="_idTextAnchor090"/>Design 4 – fully independent HITL reviews (two Processes, two Work Queues)</h2>
			<p>Building on <a id="_idIndexMarker469"/>Design 3, we can further separate the manual review portion by pushing Items that need human review into a separate Work Queue. This allows us to isolate case statistics, separating the time spent performing review logic (saving the data to be shared with reviewers and checking for completed reviews) from the time spent performing business logic. The trade-off that’s made when isolating these statistics is that we might want an end-to-end view of the time spent on a case. This requires adding the case times from two Work Queues together. Operationally, adding another Work Queue makes tracking cases in the Control Room more difficult for <span class="No-Break">the Controller.</span></p>
			<p>Most notably, adding a new Work Queue increases the auditability of what was reviewed and allows for this data to be more easily fed back to data science teams so that the ML algorithm can be improved. This design is also a good way to extend an existing RPA process, by adding ML. Besides these points, this design has similar pros and cons to <span class="No-Break">Design 3.</span></p>
			<h2 id="_idParaDest-90"><a id="_idTextAnchor091"/>Design 5 – full separation (three Processes, three Work Queues)</h2>
			<p>Our final design builds on<a id="_idIndexMarker470"/> Design 4. It places all the ML logic (making the prediction and checking whether HITL review is necessary) into a new Process and data into a separate Work Queue. As a result, we gain a simple way to audit all ML predictions. Besides this, we have similar pros and cons to Designs 3 <span class="No-Break">and 4.</span></p>
			<h1 id="_idParaDest-91"><a id="_idTextAnchor092"/>Summary</h1>
			<p>In this chapter, we explored five IA designs that differed in terms of the number of BP Processes and Work Queues. Deciding on the number of Processes and Work Queues is extremely important for both IA and general RPA design as it affects almost every aspect of the remaining solution. This includes the potential scalability, case reporting statistics, maintainability, logging, auditability, scheduling, and other Control <span class="No-Break">Room operations.</span></p>
			<p>Two IA designs were presented containing a single Process and a single Work Queue. One design was for synchronous reviews and the other for asynchronous reviews. In our third design, we split off the logic used to handle HITL reviews into its own Process, leading to a two-Process, single-Work Queue design. This allows for increased reusability and the separate scaling of business logic versus HITL review logic. For the fourth design, we added a new Work Queue to store all the Items that need manual review. This provides a simpler audit trail into which predictions were corrected by a human. It also allows us to more easily feed back these corrected predictions to the ML team. Finally, our fifth design further split off all of the ML calling logic into its own Work Queue and Process, enhancing scalability and simplifying the auditing of all <span class="No-Break">ML predictions.</span></p>
			<p>In the next chapter, we’ll discuss some smaller design elements that supplement the larger Process/Work Queue structure that was chosen based on the learnings of this chapter. These elements, such as Environment Variables, Session Variables, and Credentials, can improve the overall IA solution management <span class="No-Break">and operations.</span></p>
		</div>
	</div>
</div>
</body></html>