["```py\nprofiles_df[\"joined\"] = profiles_df[\"Metadata\"].apply(lambda x: x.split(\" · \")[0])\nprofiles_df[\"last_seen\"] = profiles_df[\"Metadata\"].apply(lambda x: x.split(\" · \")[1])\ndef extract_last_seen(last_seen):\n    \"\"\"\n    Extract and return when user was last time seen\n    Args:\n        last_seen: the text showing when user was last time seen\n    Returns:\n        number of days from when the user was last time seen\n    \"\"\"\n    multiplier = 1\n    last_seen = re.sub(\"last seen \", \"\", last_seen)\n    if last_seen == \"in the past day\":\n        return 0\n    last_seen = re.sub(\" ago\", \"\", last_seen)\n    quantity, metric = last_seen.split(\" \")\n    if quantity == \"a\":\n        quantity = 1\nelse:\n        quantity = int(quantity)\n    if metric == \"year\" or metric == \"years\":\n        multiplier = 356\nelif metric == \"month\" or metric == \"months\":\n        multiplier = 30\nreturn quantity * multiplier\nprofiles_df[\"tenure\"] = profiles_df[\"joined\"].apply(lambda x: extract_tenure(x))\nprofiles_df[\"last_seen_days\"] = profiles_df[\"last_seen\"].apply(lambda x: extract_last_seen(x)) \n```", "```py\nChapter 4 to define a CircleMarker with a popup:\n```", "```py\nfor _, r in coffee_df.iterrows():\n    folium.CircleMarker(location=[r['Latitude'], r['Longitude']],\n                        fill=True,\n                        color=color_list[2],\n                        fill_color=color_list[2],\n                        weight=0.5,\n                        radius=4,\n                        popup=\"<strong>Store Name</strong>: <font color='red'>{}</font><br><strong>Ownership Type</strong>:{}<br>\\\n                        <strong>Street Address</strong>: {}\".format(r['Store Name'], r['Ownership Type'],r['Street Address'])).add_to(m) \n```", "```py\ndef popup_html(row):\n    store_icon = \"https://upload.wikimedia.org/wikipedia/en/3/35/Starbucks_Coffee_Logo.svg\"\n    name = row['Store Name']\n    brand = row['Brand']\n    store_number = row['Store Number']\n    ownership_type = row['Ownership Type']\n    address = row['Street Address']\n    city = row['City']\n    postcode = row['Postcode']\n    left_col_color = \"#00704A\"\n    right_col_color = \"#ADDC30\"\n\n    html = \"\"\"<!DOCTYPE html>\n    <html>\n    <head>\n    <center><img src=\\\"\"\"\" + store_icon + \"\"\"\\\" alt=\"logo\" width=100 \n=100 ></center>\n\n    <h4 style=\"margin-bottom:10\"; width=\"200px\">{}</h4>\"\"\".format(name) + \"\"\" \n```", "```py\n </head>\n<table style=\"height: 126px; width: 350px;\">\n<tbody>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">Brand</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(brand) + \"\"\"\n    </tr>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">Store Number</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(store_number) + \"\"\"\n    </tr>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">Ownership Type</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(ownership_type) + \"\"\"\n    </tr>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">Street Address</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(address) + \"\"\"\n    </tr>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">City</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(city) + \"\"\"\n    </tr>\n<tr>\n<td style=\"background-color: \"\"\"+ left_col_color +\"\"\";\"><span style=\"color: #ffffff;\">Postcode</span></td>\n<td style=\"width: 150px;background-color: \"\"\"+ right_col_color +\"\"\";\">{}</td>\"\"\".format(postcode) + \"\"\"\n    </tr>\n</tbody>\n</table>\n</html>\n    \"\"\"\n    return html \n```", "```py\nfor _, r in coffee_df.iterrows():\n    html = popup_html(r)\n    popup = folium.Popup(folium.Html(html, script=True), max_width=500)\n    folium.CircleMarker(location=[r['Latitude'], r['Longitude']],\n                        fill=True,\n                        color=color_list[2],\n                        fill_color=color_list[2],\n                        weight=0.5,\n                        radius=4,\n                        popup = popup).add_to(m) \n```"]