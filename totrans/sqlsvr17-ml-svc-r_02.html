<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Overview of Microsoft Machine Learning Server and SQL Server</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we will look into the reasons why Microsoft decided to add the R language to SQL Server 2016 and what burdens this integration has overcome. We will cover the following topics in this chapter:</p>
<ul class="calibre7">
<li class="calibre8">Addressing analytical barriers and R limitations</li>
<li class="calibre8">The Microsoft R Server platform</li>
<li class="calibre8">The Microsoft R Services architecture</li>
<li class="calibre8">Exploring computational contexts</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Analytical barriers</h1>
                
            
            <article>
                
<p class="calibre2">Many companies encounter barriers when trying to analyse their data. These barriers are usually knowledge scarcity (not all departments have the knowledge to analyse the data) and data dispersity (usually data arrives from different sources).</p>
<p class="calibre2">Enterprises divide responsibilities according to the roles or functions of the employees. Such division of work has a positive effect, especially when an enterprise is large. Usually, small to mid-sized enterprises adopt such roles as well, but they are normally granulated on a higher level due to a smaller number of employees.</p>
<p class="calibre2">With rapid market changes, the emergence of new technologies, and the need for faster adaptation, many experts have noticed many of the following barriers:</p>
<ul class="calibre7">
<li class="calibre8">Data scarcity and data dispersity</li>
<li class="calibre8">Complex (and many times outdated) architecture</li>
<li class="calibre8">Lack of knowledge</li>
<li class="calibre8">Low productivity</li>
<li class="calibre8">Slow adaptation to market changes (long time to market)</li>
</ul>
<p class="calibre2">Many enterprises are facing at least one (if not more) of these barriers and Microsoft has addressed these barriers by opening the R language to SQL Server. Embracing an open source language and open source technology, it broadens the pool of knowledge, enabling the enterprises to use community knowledge and community solutions, as well as opening and democratizing analytics. Rather than suffering and waiting on data scientists and specialists with the subject-matter academic knowledge, now this pool of knowledge can be easily shared and many of the data munging and data engineering tasks can be offloaded to other roles and people. This offload process also bridges the traditional gap between IT and statisticians that resulted in low and slow productivity in the past. This gap in knowledge and skills can now be overcome by mixing different roles and tasks using R in SQL Server (meaning that data wranglers or data stewards can have R code at their perusal that would help them in getting data insight, without actually needing to understand the complexity of the statistics). There are no surprises for understanding or knowing different platforms, now, as many IT people can use the R language provided by statisticians and data scientists. Also, data scientists can start learning skills and languages that one finds in IT.</p>
<p class="calibre2">Such interconnected and shared knowledge between two or more different departments of people will also increase productivity. When productivity is increased, statistical and predictive models can be deployed faster, changed, or adapted to consumer and market changes and enabled for data engineers, wranglers, and analysts. This certainly is the way for an enterprise to improve the innovation path and maximize the potential of open source, and broaden the sandbox of experiments using different methods and models.</p>
<p class="calibre2">The last step in addressing these barriers is addressing the issues of data scarcity and complex infrastructure. The rule is that the bigger the enterprise, the higher the likelihood that the infrastructure will be complex. With complex infrastructure, we can understand that data resides on different layers or different granularity, on different platforms, on different vendors, and on different silos, making data analysis an additional step further from realization. With an introduction to R, this complexity can be overridden with simpler data connectors, an easier way to extract the data.</p>
<p class="calibre2">As the R language is becoming more and more popular and important in the field of analytics, it can be ready for enterprises on different scales and can be designed to anticipate beyond vendors, regardless of whether you have your solution on-premises or in the cloud. The need for data movement also decreases because of the ability to access and read data directly from any hybrid system and extract only what is needed. All barriers that are present in enterprises can now be addressed faster with less bureaucracy, better integration, and less effort.</p>
<p class="calibre2">Another important aspect of embracing open source language, with which many big enterprises are still struggling, is the general providence of open source solutions. This aspect shall not be overlooked and must be taken into consideration. Microsoft took the R language on-board with several steps:</p>
<ol class="calibre14">
<li value="1" class="calibre8">Being on board in the R Consortium, which is responsible for supporting the R Foundation and key organizations working tightly on developing, distributing, and maintaining R engine and supporting R-related infrastructure projects. One of the projects was the RHub project (lead by <em class="calibre12">Gabor Csardi</em>) that delivered a service for developing, testing, and validating R packages.</li>
<li value="2" class="calibre8">Creating an MRAN repository of R packages under the CC license and making CRAN packages to Microsoft R engine distribution available and compatible with R distributions.</li>
<li value="3" class="calibre8">Making Intel <strong class="calibre1">MKL</strong> (<strong class="calibre1">Math Kernel Library</strong>) computational functions to improve the performance of the R statistical computation, available out of the box when you download the R engine from the MRAN repository. <strong class="calibre1">Basic Linear Algebra Subprograms</strong> (<strong class="calibre1">BLAS</strong>) and <strong class="calibre1">Linear Algebra Package</strong> (<strong class="calibre1">LAPACK</strong>) are a family of functions for linear algebra that is enhanced for parallel computations. Such functions are matrix factorization, Cholesky matrix decomposition, vector and matrix additions, scalar multiplications, and so on.</li>
<li value="4" class="calibre8">Rewriting many R functions from Fortran to C++ language to improve the performances.</li>
</ol>
<p class="calibre2">We can quickly support the theory of the MKL computational functions, when we compare the R engine distribution available on the CRAN and R engine distribution available on MRAN. As we have already seen, BLAS and LAPACK are vector or matrix superseded, so we will compare (benchmark) the computations on a matrix between two R engine distributions.</p>
<p class="calibre2">The comparison is made on CRAN R 3.3.0 and MRAN R Open 3.3.0, with the following code:</p>
<pre class="calibre19"># Matrix creation 
set.seed (2908) 
M &lt;- 20000 
n &lt;- 100 
Mat &lt;- matrix (runif (M*n),M,n) 
 
 
# Matrix multiply 
system.time ( 
  Mat_MM &lt;- Mat%*% t(Mat), gcFirst=TRUE 
)[1] 
 
# Matrix multiply with crossprod 
system.time ( 
  Mat_CP &lt;- crossprod(Mat), gcFirst=TRUE 
)[1] </pre>
<p class="calibre2">The following are the results with the following time (in seconds):</p>
<table class="table">
<tbody class="calibre20">
<tr class="calibre21">
<td class="calibre22">
<p class="calibre2"><strong class="calibre1">Time (seconds)</strong></p>
</td>
<td class="calibre22">
<p class="calibre2"><strong class="calibre1">CRAN 3.3.2</strong></p>
</td>
<td class="calibre22">
<p class="calibre2"><strong class="calibre1">MRAN 3.3.2</strong></p>
</td>
</tr>
<tr class="calibre21">
<td class="calibre22">
<p class="calibre2">MM</p>
</td>
<td class="calibre22">
<p class="calibre2">26,69</p>
</td>
<td class="calibre22">
<p class="calibre2">2,75</p>
</td>
</tr>
<tr class="calibre21">
<td class="calibre22">
<p class="calibre2">CP</p>
</td>
<td class="calibre22">
<p class="calibre2">0,19</p>
</td>
<td class="calibre22">
<p class="calibre2">0,01</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2">Â </p>
<p class="calibre2">In the following figure, you can see the difference in performance between CRAN and MRAN R engine:</p>
<div class="packt_figure"><img src="../images/00006.gif" class="calibre23"/></div>
<div class="cdpaligncenter">Figure 1</div>
<p class="calibre2">The graph shows a simple linear algebra that uses matrices or vectors and performs faster for a factor of 10 (tested on my local client-Inter I7, 4 CPU, 20 GB RAM). Note that, when you run this test on your local machine, you should observe the RAM and disk storage consumption; you will see that the MRAN operation is very lightweight in comparison to the CRAN operation when it comes to the RAM consumption.</p>
<p class="calibre2">When you download the MRAN distribution of R Open, note that there will be additional information on MKL multithreaded performance functions available:</p>
<div class="packt_figure"><img src="../images/00007.jpeg" class="calibre24"/></div>
<div class="cdpaligncenter">Figure 2: Source: <a href="https://mran.microsoft.com/download/" class="calibre4">https://mran.microsoft.com/download/</a></div>
<p class="calibre2">Many more steps were taken that would reassure consumers, developers, wranglers, and managers from bigger enterprises that the R language is here to stay. Microsoft promised that, besides this provision, there is also support for general governance and if the company decides, it can also receive R support on an enterprise level.</p>
<p class="calibre2">Furthermore, to support the idea of using open source R language, one must understand the general architecture of R. The R engine is written by the core group of roughly 20 people with access to the source code of the R engine (even though only six are working on day-to-day R development). This group of people not only maintains the code, but they themselves are also contributors, bug fixers, and developers. So, the R engine is open source, which means that it is free software (under a GNU license), but the engine is not maintained that openly. On the other hand, R libraries (or packages) are mostly community-driven contributions, which mean that people in the community are free to develop and create a variety of functions to support statistical calculations, visualizations, working with datasets, and many other aspects.</p>
<p class="calibre2">In the months following the release of SQL Server 2016 (from summer 2016 onward), Microsoft also changed what is available in different editions of SQL Server. If you visit the SQL Server 2016 editions overview at <span><a href="https://www.microsoft.com/en-us/sql-server/sql-server-2016-editions" class="calibre10">https://www.microsoft.com/en-us/sql-server/sql-server-2016-editions</a></span>, you can see that under advanced analytics, basic R integration is available in all editions of SQL Server 2016, and advanced R Integration (with full parallelism of ScaleR functions in <kbd class="calibre11">RevoScaleR</kbd> package) is available only in the Enterprise and Developer editions.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Microsoft Machine learning R Server platform</h1>
                
            
            <article>
                
<p class="calibre2">We have already touched on the concept of R Open and R for enterprise environment briefly. Microsoft Machine Learning R Server is an enterprise server that delivers high dimensional and large datasets that can be processed in parallel, and the workload can be distributed across nodes. R Server can process these parallel and distributed workloads on Windows, Linux servers, or HDFS systems, such as Hadoop, Spark, Teradata, and HD Insight. R Server can achieve parallel and distributed workloads using Microsoft R packages designed to do just that. The <kbd class="calibre11">RevoScaleR</kbd> package will give the ability to do highly parallel and distributed computations, statistical analysis, and predictive analytics, as well as machine learning and deep learning.</p>
<p class="calibre2">With the acquisition of the company Revolution Analytics, Microsoft rebranded their two main products, Revolution R Open and Revolution R Enterprise, to Microsoft R Open and Microsoft R Server and Microsoft SQL Server R Services. In addition to these two flavors, they also added Microsoft R Client as an additional standalone product:</p>
<div class="packt_figure"><img class="aligncenter1" src="../images/00008.jpeg"/></div>
<div class="cdpaligncenter">Figure 3</div>
<p class="calibre2">Based on different flavors and enterprise ecosystems, companies can choose the type of usage they will need (community, or non-commercial, and commercial) and, based on their business needs and where they want their analytical server to be set up, they can choose what suits them the most. In the commercial version, a standalone machine learning R Server (or simply R server) is available, as well as in-database machine learning services (or SQL Server R services).</p>
<p class="calibre2">In the version of SQL Server 2017, Microsoft R Server has been changed to Machine Learning Server (both in-database and as a standalone; the rebranding from in-database R Services to Machine Learning R Services was introduced in the CTP version of SQL Server VNext that later changed to SQL Server 2017). In <em class="calibre12">Figure 4</em>, one can see the naming available when installing SQL Server 2016 (left-print screen) and the names that will be available in SQL Server 2017 (right-print screen):</p>
<div class="packt_figure"><img class="aligncenter2" src="../images/00009.jpeg"/></div>
<div class="cdpaligncenter">Figure 4</div>
<p class="calibre2">The reason given for the change in the naming was the fact that Microsoft introduced Python in SQL Server 2017. Python is a powerful statistical, analytical, and machine learning language, and therefore, the name was unified. The R-part of the Machine Learning Server will not change internally, but it will gain useful additional packages and improved functions, as follows:</p>
<pre class="calibre19">serialize/unserialize -&gt; rxSerializeModel/rxUnserializeModel 
InstallPackages -&gt; rxInstallPackages 
Histogram -&gt; rxHistogram </pre>
<p class="calibre2">All these functions have been rewritten either for working on large datasets in parallel and distributed workloads, or to support R and SQL Server work.</p>
<p class="calibre2">In the Microsoft R platform, the following products are available:</p>
<ul class="calibre7">
<li class="calibre8">Microsoft Machine Learning R Server</li>
<li class="calibre8">Microsoft R Client</li>
<li class="calibre8">Microsoft R Open</li>
<li class="calibre8">R Tools for Visual Studio</li>
</ul>
<p class="calibre2">Product description has been summarized based on Microsoft Docs descriptions and based on an article published on SQLServerCentral in September of 2016 ( <a href="http://www.sqlservercentral.com/articles/Microsoft/145393/" class="calibre10">http://www.sqlservercentral.com/articles/Microsoft/145393/</a>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Microsoft R Open (MRO)</h1>
                
            
            <article>
                
<p class="calibre2">Microsoft R Open is an open source R distribution that is 100% free and generally available. Microsoft has enhanced this R Open distribution with an additional high-performance multi-threaded feature of <strong class="calibre1">Math Kernel Library</strong> (<strong class="calibre1">MKL</strong>) that is optimized for vector and matrix-based mathematical and statistical computations; otherwise, this distribution is fully compatible with legacy R objects and R code.</p>
<p class="calibre2">R Open is also compatible with the CRAN repository, GitHub packages, or any other repository, making MRO widely usable. On the other hand, R Open has some limitations. It is memory bound, which means that it can only handle the datasets that will fit into the memory (client) available. Proprietary ScaleR functions (available in the <kbd class="calibre11">RevoScaleR</kbd> package) will not be available under R Open and it will run on all SQL Server 2017 editions, except on Express or Express with Tools, whereas Microsoft R Client/Server will run only on the Enterprise or Developer editions of SQL Server 2017.</p>
<p class="calibre2">Microsoft R Client is the same R distribution as Microsoft R Open and it is built on top of 100% open source R version. Microsoft R Client is the first version from the Microsoft family of R versions that introduces the <kbd class="calibre11">RevoScaleR</kbd> package (ScaleR functions). A data wrangler, data scientist, or data engineer (or any other profile) who installs this version will have the ability to use the parallelization and multi-threaded computing, as well as the use of proprietary functions from ScaleR.</p>
<p class="calibre2">There are some limitations to the R Client version. The memory will be limited to a local client machine with the same limitations as Microsoft R Openâdata must fit into the local memory in order to be computed. The ScaleR functions will be installed alongside this version, but the processing will be limited to only two threads simultaneously (regardless of the technical specifications of the client machine) and to the local disk and CPU speed. Otherwise, any legacy R packages or R code will be compatible.</p>
<p class="calibre2">Microsoft R Client also brings the possibility to change the computational environment, which means that the computational load can be pushed to Microsoft R Server or SQL Server R Services and any HDFS system to achieve maximum performance. Building the ecosystem with many R Clients and one (or a few) R Servers will give a high-performance analytical environment without having the need for Microsoft R Server being installed locally. It is compatible with the following flavors of R Server: Microsoft R server for Linux, Microsoft R Server for Teradata DB, Microsoft R Server for Hadoop, Microsoft R HDInsight, and both versions of Microsoft R Server-Standalone and SQL Server R Services.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Microsoft Machine Learning R Server</h1>
                
            
            <article>
                
<p class="calibre2">Microsoft R Server is a standalone server version of the R engine, built on top of the R open source platform but modified to suit the needs of the enterprise environment and heavy usage of analytical purposes, from statistical analysis and data mining to machine learning and any big data tasks.</p>
<p class="calibre2">It is fully compatible with CRAN/MRAN/GitHub repositories and any R legacy code. The ScaleR functions and algorithms available in the <kbd class="calibre11">RevoScaleR</kbd> package are capable of parallel and multi-threated data processing with no limitations known to R Open or R Client. Computations are prepared for large datasetsâin most cases, datasets that easily exceed the server memory size. This can be done due to a special external data frame format that enables multi-threaded computations and enables R-based applications that can perform parallel computations and deployable solutions across multi-platforms with the help of ConnectR and DeployR. Disk scalability is also available with Microsoft R Server.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Microsoft SQL Server Machine Learning R Services</h1>
                
            
            <article>
                
<p class="calibre2">The in-database flavor of R Open distribution is available as Machine Learning R Services for Microsoft SQL Server, and covers all the ScaleR algorithms that are available in the <kbd class="calibre11">RevoScaleR</kbd> package.</p>
<p class="calibre2">The memory and disk, in this case, will be managed by your installation of SQL Server, and the R execution is done using the <kbd class="calibre11">SQL Server Trusted Launchpad</kbd> service that governs the communication between SQL Server and R engine.</p>
<p class="calibre2">Also, users can connect to R Services using R Client but the <kbd class="calibre11">DeployR</kbd> and <kbd class="calibre11">ConnectR</kbd> functions will be limited.</p>
<p class="calibre2">Microsoft SQL Server R Services is an in-database version for SQL Server 2016 and onwards, and this will be the main focus of this book. These in-database services can be installed when a new instance of SQL Server is installed. <em class="calibre12">Figure 4</em> shows that R in-database service (or machine learning services (in-database) as a part of SQL Server 2017) are installed as an instance feature, and when ticking this feature, the R service (or the Python service) will be installed. One must also understand that Microsoft R Server is a standalone component that is not installed when R Services are installed. One must explicitly put a tick next to <span>R Server (Machine Learning Server)</span> under shared services. However, R services (in-database) will not install R Server.</p>
<p class="calibre2">R Services (in-database) is a standalone source of R language and R programming with full stack and capabilities of SQL Server, including the tools and technologies for governance, security, reliability, and performance. In SSMS, one can invoke and call R functions making R analysis or predictions using transact SQL with an R script. This can be achieved using a system external procedure: <kbd class="calibre11">sp_execute_external_script</kbd>.</p>
<p class="calibre2">The ScaleR libraries that are a part of the R Service (in-database) installation allow data scientists, developers, or database administrators to securely execute an R script from a SQL Server computer or on Microsoft R Server. By defining the computational context, a user can choose where to push the computations and load, either to stay in-database R runtime or use the ScaleR library to enhance connectivity and parallelism and push the load to Microsoft R Server.</p>
<p class="calibre2">To close the circle, with the installation of client R that comes available as a standalone and separate installer, you can develop your R code and deploy the solution to R Services or to Microsoft R Server running on Windows or Linux.</p>
<p class="calibre2">Figure 5 depicts how data scientists or data analysts can push the load from client/workstation to a cloud-based solution, a virtual machine, an R Server, or R services (in-database). From a client's perspective, one can also easily choose a hybrid solution, especially when the need for data integration and data consolidation between different systems is needed. This concept will most certainly give the enterprise an immediate boost and lift in performance, as well as faster and better solutions adaptation almost instantly:</p>
<div class="packt_figure"><img src="../images/00010.jpeg" class="calibre25"/></div>
<div class="cdpaligncenter">Figure 5</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">R Tools for Visual Studio (RTVS)</h1>
                
            
            <article>
                
<p class="calibre2">RTVS is a Microsoft free version (distributed under a GNU license) of IDE for writing, validating, and running an R code within Visual Studio. RTVS is supported on the Community, Professional, and Enterprise editions of Visual Studio 2015 and Visual Studio 2017.</p>
<p class="calibre2">R Tools (<a href="https://www.visualstudio.com/vs/rtvs/" class="calibre10"><span>https://www.visualstudio.com/vs/rtvs/</span></a>) will help developers, analysts, and data scientists to operate and perform statistical computations, visualizations, and data management. R Tools bring graphical interface to R Engine, workspace for rich editing, interactive windows, variable and visuals explorer, help, IntelliSense, and much more. It also binds local and remote workspaces (on-premises or in the cloud), so that data analysts can switch between computational environments very easily.</p>
<p class="calibre2">The view of workspaces in RTVS is made simple and graphical for a user to switch between different R environments:</p>
<div class="packt_figure"><img class="aligncenter3" src="../images/00011.jpeg"/></div>
<div class="cdpaligncenter">Figure 6</div>
<p class="calibre2">It resembles the famous and powerful RStudio (<a href="http://www.rstudio.com" class="calibre10">www.rstudio.com</a>), but still offers all the necessities that community and time brought into the development of RStudio, Emacs, Vim, Eclipse, or others. Microsoft has also addressed the community with questionnaires to ask what the users of RTVS are still missing. They can contribute and add their wishes at <a href="https://www.surveymonkey.com/r/RTVS1" class="calibre10"><span>https://www.surveymonkey.com/r/RTVS1</span></a>.</p>
<p class="calibre2">RTVS was announced and released (as a beta version) in early 2016 but only got version 1 in 2017.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Microsoft Machine Learning R Services architecture</h1>
                
            
            <article>
                
<p class="calibre2">The architecture of R Server covers many components needed in order for the communication between R IDE or SQL Server and R engine to work properly.</p>
<p class="calibre2">Several components are involved in order to properly execute Transact SQL, R script, and return all the results back to T-SQL:</p>
<div class="packt_figure"><img class="aligncenter4" src="../images/00012.jpeg"/></div>
<div class="cdpaligncenter">Figure 7</div>
<p class="calibre2">Launchpad is a new service in SQL Server 2016 that supports execution of external scripts using the external stored procedure from SQL Server. However, in SQL Server 2017, the Python launcher has also been introduced, making Launchpad generally available to the second non-SQL Server language. The idea behind Launchpad is that since the infrastructure is already prepared, the SQL Server should, in the future, support other languages as well, such as JavaScript and C++, opening this service not only to predictive analytics and machine learning, but also to other standalone languages.</p>
<p class="calibre2">The Launchpad service (service name: <kbd class="calibre11">MSSQLLaunchpad</kbd>) is dependent on the SQL Server service (service name: <kbd class="calibre11">MSSQLSERVER</kbd>), which means that, when restarting or stopping a SQL Server service, the Launchpad service will be restarted or stopped also.</p>
<p class="calibre2">In addition, the R language has also brought two additional services: R Terminal service (abbreviated as RTerm) and BxlServer, which use SQL Satellite, an additional extension to SQL server that communicates between external runtime (correlating to the Launchpad service) and SQL Server; both can be found as processes.</p>
<p class="calibre2">For easier understanding of these correlations, let's start a simple PowerShell script to see all the components of <kbd class="calibre11">Launchpad</kbd> and <kbd class="calibre11">BxlServer</kbd>:</p>
<pre class="calibre19"><strong class="calibre1">Get-Process -Name Launchpad | Select-Object * </strong>
<strong class="calibre1">Get-Process -Name BxlServer | Select-Object *</strong>  </pre>
<p class="calibre2">Additionally, with a simple T-SQL code, we can include the R script:</p>
<pre class="calibre19">EXEC sp_execute_external_script 
    @language = N'R' 
   ,@script = N'library(RevoScaleR) 
OutputDataSet &lt;- data.frame(rxInstalledPackages())' </pre>
<p class="calibre2">Additionally, observe the Process Explorer and Launchpad Process:</p>
<div class="packt_figure"><img class="aligncenter5" src="../images/00013.jpeg"/></div>
<div class="cdpaligncenter">Figure 8</div>
<p class="calibre2">It is obvious how communication creates the entire circle from SQL Server to R and back.</p>
<p class="calibre2">Furthermore, the Command Line also reveals that the Launchpad process uses the <kbd class="calibre11">RLauncher.dll</kbd> library and launches <kbd class="calibre11">sqlsatelitelaunch</kbd> using <kbd class="calibre11">sqlsatellite.dll</kbd>:</p>
<pre class="calibre19"><strong class="calibre1">CommandLine: "C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\bin\launchpad.exe" -launcher RLauncher.dll -pipename sqlsatellitelaunch -timeout 600000 -logPath "C:\Program Files\Microsoft  SQL Server\MSSQL14.MSSQLSERVER\MSSQL\LOG\ExtensibilityLog" -workingDir "C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\ExtensibilityData" -satelliteDllPath</strong></pre>
<pre class="calibre19"><strong class="calibre1">"C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqlsatellite.dll"   </strong></pre>
<p class="calibre2">Many more configurations will tell you where and how communication in this architecture is set up. Opening the <kbd class="calibre11">RLauncher.config</kbd> file will show you the following configuration:</p>
<div class="packt_figure"><img class="aligncenter6" src="../images/00014.gif"/></div>
<div class="cdpaligncenter">Figure 9</div>
<p class="calibre2">Additionally, by changing the <kbd class="calibre11">TRACE_LEVEL</kbd> parameter, it can also reveal potential logs, showing same path and communication between the systems, as the <kbd class="calibre11">RevoScaleR</kbd> log also shows information on each worker session:</p>
<pre class="calibre19">library(RevoScaleR); sessionDirectory &lt;- 'C:\\PROGRA~1\\MICROS~3\\MSSQL1~1.MSS\\MSSQL\\EXTENS~1\\MSSQLSERVER01\\0FEB1004-867F-4AB6-B9CC-E1C824596645';sessionId &lt;- '0FEB1004-867F-4AB6-B9CC-E1C824596645';scriptFile &lt;- file.path(sessionDirectory, paste(sessionId, '.R', sep=''));rxIgnoreCallResult &lt;- .Call('RxSqlSessionStart', list(sessionDirectory=sessionDirectory, sessionId=sessionId, waitTime=-1));source(scriptFile) </pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">R Limitations</h1>
                
            
            <article>
                
<p class="calibre2">Community blogs and forums, as well as package authors and contributors, are debating over the long list of R limitations the language has. Many are murky and some are based solemnly on a particular group of user experience, but the following limitations can be agreed upon:</p>
<ul class="calibre7">
<li class="calibre8">Performance issues</li>
<li class="calibre8">Memory limitations</li>
<li class="calibre8">Security aspects</li>
<li class="calibre8">Language syntax</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Performance issues</h1>
                
            
            <article>
                
<p class="calibre2">Over 40% of the R code is predominantly written in C, and a little bit over 20% still in Fortran (the rest in C++, Java, and R), making some common computational tasks very costly. Microsoft (and, before, Revolution analytics) did rewrite some of the most frequently used functions from old Fortran to C/C++ in order to address performance issues.</p>
<p class="calibre2">Many package authors did very similar things. For example, Matt Dowleâthe main author of the <kbd class="calibre11">data.table</kbd> R packageâdid several language performance lift-ups to speed up most common data wrangling steps.</p>
<p class="calibre2">When comparing similar operations on the same dataset using different packages, such as <kbd class="calibre11">dplyr</kbd>, <kbd class="calibre11">plyr</kbd>, <kbd class="calibre11">data.table</kbd>, and <kbd class="calibre11">sqldf</kbd>, one can see the difference in the time performance with the same results.</p>
<p class="calibre2">The following R sample shows roughly a 80 MiB big object with a simple grouping function of how much difference there is in the computation time. Packages <kbd class="calibre11">dpylr</kbd> and data.table stand out and have performance gain over 25x times better in comparison to <kbd class="calibre11">plyr</kbd> and <kbd class="calibre11">sqldf</kbd>. <kbd class="calibre11">data.table</kbd>, especially, is extremely efficient and this is mainly due to Matt's extreme impetus to optimize the code of the <kbd class="calibre11">data.table</kbd> package in order to gain performance:</p>
<pre class="calibre19">set.seed(6546) 
nobs &lt;- 1e+07 
df &lt;- data.frame("group" = as.factor(sample(1:1e+05, nobs, replace = TRUE)), "variable" = rpois(nobs, 100)) 
 
# Calculate mean of variable within each group using plyr - ddply  
library(plyr) 
system.time(grpmean &lt;- ddply( 
  df,  
  .(group),  
  summarize,  
  grpmean = mean(variable))) 
 
 
# Calcualte mean of variable within each group using dplyr 
detach("package:plyr", unload=TRUE) 
library(dplyr) 
 
system.time( 
  grpmean2 &lt;- df %&gt;%  
              group_by(group) %&gt;% 
              summarise(group_mean = mean(variable))) 
 
# Calcualte mean of variable within each group using data.table 
library(data.table) 
system.time( 
  grpmean3 &lt;- data.table(df)[ 
    #i 
    ,mean(variable)    
    ,by=(group)] ) 
 
# Calcualte mean of variable within each group using sqldf 
library(sqldf) 
system.time(grpmean4 &lt;- sqldf("SELECT avg(variable), [group] from df GROUP BY [group]")) </pre>
<p class="calibre2">The Microsoft <kbd class="calibre11">RevoScaleR</kbd> package, on the other hand, is optimized as well and can supersede all of these packages in terms of performance and large datasets. This is just to prove how Microsoft has made R ready for large datasets to address the performance issues.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Memory limitations</h1>
                
            
            <article>
                
<p class="calibre2">R is memory bound. This literally means that the dataset must fit into the client's RAM. From the previous example, if someone is going to run a simple algebraic operation, some matrix computation, or any kind of distance-based algorithm (that is heavy on computation), the R system would be limited to what would fit into the RAM. No spill to disk or any kind of temporary object is available, unless the user loads a package that allows otherwise.</p>
<p class="calibre2">Again, Microsoft has a solution with the <kbd class="calibre11">RevoScaleR</kbd> package that covers this limitation. With the introduction of the <strong class="calibre1">eXternal Data Frame</strong> (<strong class="calibre1">XDF</strong>) format, the package is able to store any size of the dataset (there is no recorder upper limit) in this format that is persisted on the disk, with conversion from a binary, blob, CSV, or any other format to XDF format. This limitation is made possible in Microsoft Machine Learning R Server or Machine Learning R Services.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security aspects</h1>
                
            
            <article>
                
<p class="calibre2">The evolution of the R language as a GNU distribution has been evolving over the past couple of decades as a client-based solution and, even before the dawn of the internet, all datasets have been securely stored on one's machine. With the spread of data over the internet, cloud services, and connected systems, as well as more and more present hybrid solution systems, the security aspect of reading, writing, analyzing, and storing data has never been a question. However, in the past ten years, more and more systems have been emerging, enterprise needs have changed, people roles have changedâbut the core R engine and IDE has not yet taken a step in this direction. From this aspect, it seems as if R wants to remain a university developed and driven software. With R integration into SQL Server, Microsoft has addressed these issues and has not only created database roles, but also added services that make the connection to R and all computations securely, diminishing the possibilities of security vulnerabilities.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Language syntax</h1>
                
            
            <article>
                
<p class="calibre2">R language is very flexible and allows a user to change the S4 methods and S3 objects, generic objects, and all of the user-defined objects and variables. As the R Language is still not an object-orientated language, it is a question of debate if this is true or not (because currently, R understands only three object-orientated systems) because both S3 and S4 objects are OO orientated structures.</p>
<p class="calibre2">R Syntax might be easy to learn, but it is also easy to develop some doubts. The following are a couple of syntax disagreements in the R community:</p>
<ul class="calibre7">
<li class="calibre8">Several different R packages give users the same functionalities (data wrangling, data analysis, data predictions). As previously displayed, when comparing the performances of these packages for data-wrangling purposes with usage, users will see which package performs better or which package suit their needs better. Idiosyncratic syntax with confusing structures is also a part of the package and can be used in many different ways.</li>
<li class="calibre8">There are multiple ways to do the same thing (declaring a variable, constructing a class, handling data, and predicting with the same algorithm).</li>
<li class="calibre8">Missing conventions, namespaces, and package inter-dependencies.</li>
<li class="calibre8">Somewhat challenging error messages with lacking documentation/help.</li>
<li class="calibre8">Case sensitivity.</li>
</ul>
<p class="calibre2">It is cumbersome to list all of the issues, but one can quickly get an idea of how the language evolved, but still is embraced by the community more and more; R as a language is perceived as the most popular to date.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">This chapter has given an overview on the ecosystem of the new R Service and the family of R Engine products offered by Microsoft.</p>
<p class="calibre2">When thinking about R and SQL Server, one must keep in mind what the needs in the enterprise will be and how the infrastructure will be prepared in order to leverage the maximum performance from powerful <kbd class="calibre11">RevoScaleR</kbd> packages.</p>
<p class="calibre2">In the next chapter, we will see how to use these ScaleR computational functions to deliver better performance results, and how to set up your ecosystem.</p>


            </article>

            
        </section>
    </body></html>