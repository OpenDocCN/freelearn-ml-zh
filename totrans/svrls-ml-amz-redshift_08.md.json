["```py\nCREATE model model_name\nFROM (Select_statement)\nFUNCTION  function_name\nIAM_ROLE default\nAUTO OFF\nMODEL_TYPE KMEANS\nPREPROCESSORS (StandardScaler', 'MinMax', 'NumericPassthrough')\nHYPERPARAMETERS DEFAULT EXCEPT (K '2')\nSETTINGS (S3_BUCKET 'bucket name');\n```", "```py\n    create schema chapter8_kmeans_clustering;\n    ```", "```py\n    create table chapter8_kmeans_clustering.housing_prices (\n    ```", "```py\n        longitude decimal(10,2),\n    ```", "```py\n        latitude decimal(10,2),\n    ```", "```py\n        housing_median_age integer,\n    ```", "```py\n        total_rooms integer,\n    ```", "```py\n        total_bedrooms integer,\n    ```", "```py\n        population integer,\n    ```", "```py\n        households integer,\n    ```", "```py\n        median_income decimal(10,6),\n    ```", "```py\n        median_house_value integer,\n    ```", "```py\n        ocean_proximity character varying (50)\n    ```", "```py\n    )\n    ```", "```py\n    diststyle auto;\n    ```", "```py\n    copy chapter8_kmeans_clustering.housing_prices from 's3://packt-serverless-ml-redshift/chapter08/kmeans/housing_prices.csv'\n    ```", "```py\n    iam_role default format as csv delimiter ',' quote '\"' ignoreheader 1 region as 'eu-west-1';\n    ```", "```py\n    select * from chapter8_kmeans_clustering.housing_prices\n    ```", "```py\n    limit 10;\n    ```", "```py\ncreate model chapter8_kmeans_clustering.housing_segments_k2\nfrom(select\n            median_income,\n            latitude,\n            longitude\nfrom chapter8_kmeans_clustering.housing_prices)\nfunction  get_housing_segment_k2\niam_role default\nauto off\nmodel_type kmeans\npreprocessors '[\n      {\n        \"columnset\": [ \"median_income\", \"latitude\",\"longitude\" ],\n        \"transformers\": [ \"standardscaler\" ]\n      }\n    ]'\nhyperparameters default except (k '2')\nsettings (s3_bucket '<your s3 bucket>');\n```", "```py\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k2;\n```", "```py\n  select chapter8_kmeans_clustering.get_housing_segment_k2 (median_income, latitude, longitude) as cluster, count(*) as count from FROM chapter8_kmeans_clustering.housing_prices group byGROUP BY 1 order byORDER BY 1;\n```", "```py\nCREATE model chapter8_kmeans_clustering.housing_segments_k3\nFROM(Select\n            median_income,\n            latitude,\n            longitude\nFrom chapter8_kmeans_clustering.housing_prices)\nFUNCTION  get_housing_segment_k3\nIAM_ROLE default\nAUTO OFF\nMODEL_TYPE KMEANS\nPREPROCESSORS '[\n      {\n        \"ColumnSet\": [ \"median_income\", \"latitude\",\"longitude\" ],\n        \"Transformers\": [ \"StandardScaler\" ]\n      }\n    ]'\nHYPERPARAMETERS DEFAULT EXCEPT (K '3')\nSETTINGS (S3_BUCKET '<your s3 bucket>');\n```", "```py\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k2;\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k3;\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k4;\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k5;\nSHOW MODEL chapter8_kmeans_clustering.housing_segments_k6;\n```", "```py\nSelect 2 as K, 1.088200  as MSD\nUnion\nSelect 3 as K,  0.775993 as MSD\nUnion\nSelect 4 as K,  0.532355 as MSD\nUnion\nSelect 5 as K,  0.437294 as MSD\nUnion\nSelect 6 as K,  0.373781 as MSD;\n```", "```py\nselect chapter8_kmeans_clustering.get_housing_segment_k3 (median_income, latitude, longitude) as cluster, count(*) as count from chapter8_kmeans_clustering.housing_prices group by 1 order by 1;\n```", "```py\nselect avg(median_house_value) as avg_median_house_value,\nchapter8_kmeans_clustering\n.get_housing_segment_k3(median_income, latitude, longitude) as cluster\nfrom chapter8_kmeans_clustering\n.housing_prices\ngroup by 2\norder by 1;\n```", "```py\nselect avg(median_income) as median_income,\nchapter8_kmeans_clustering.get_housing_segment_k3(\n    median_income, latitude, longitude) as cluster\nfrom chapter8_kmeans_clustering.housing_prices\ngroup by 2\norder by 1;\n```"]