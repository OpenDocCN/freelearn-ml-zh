<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer241">&#13;
			<h1 id="_idParaDest-272" class="chapter-number"><a id="_idTextAnchor279"/>13</h1>&#13;
			<h1 id="_idParaDest-273"><a id="_idTextAnchor280"/>Logistic Regression in R</h1>&#13;
			<p>In this chapter, we will introduce logistic regression, covering its theoretical construct, connection with linear regression, and practical implementation. As it is an important classification model that is widely used in areas where interpretability matters, such as credit risk modeling, we will focus on its modeling process in different contexts, along with extensions such as adding regularization to the loss function and predicting more than <span class="No-Break">two classes.</span></p>&#13;
			<p>By the end of this chapter, you will understand the fundamentals of the logistic regression model and its comparison with linear regression, including extended concepts such as the <strong class="source-inline">sigmoid</strong> function, odds ratio, and <strong class="bold">cross-entropy loss</strong> (<strong class="bold">CEL</strong>). You will also have grasped the commonly used evaluation metrics in the classification setting, as well as enhancements that deal with imbalanced datasets and multiple classes in the <span class="No-Break">target variable.</span></p>&#13;
			<p>In this chapter, we will cover <span class="No-Break">the following:</span></p>&#13;
			<ul>&#13;
				<li>Introducing <span class="No-Break">logistic regression</span></li>&#13;
				<li>Comparing logistic regression with <span class="No-Break">linear regression</span></li>&#13;
				<li>More on log odds and <span class="No-Break">odds ratio</span></li>&#13;
				<li>Introducing the <span class="No-Break">cross-entropy loss</span></li>&#13;
				<li>Evaluating a logistic <span class="No-Break">regression model</span></li>&#13;
				<li>Dealing with an <span class="No-Break">imbalanced dataset</span></li>&#13;
				<li>Penalized <span class="No-Break">logistic regression</span></li>&#13;
				<li>Extending to <span class="No-Break">multi-class classification</span></li>&#13;
			</ul>&#13;
			<h1 id="_idParaDest-274"><a id="_idTextAnchor281"/>Technical requirements</h1>&#13;
			<p>To run the code in this chapter, you will need to have the latest versions of the <span class="No-Break">following packages:</span></p>&#13;
			<ul>&#13;
				<li><strong class="source-inline">caret</strong> – <span class="No-Break">6.0.94</span></li>&#13;
				<li><strong class="source-inline">tibble</strong> – <span class="No-Break">3.2.1</span></li>&#13;
				<li><strong class="source-inline">dplyr</strong> – <span class="No-Break">1.0.10</span></li>&#13;
				<li><strong class="source-inline">pROC</strong> – <span class="No-Break">1.18.2</span></li>&#13;
				<li><strong class="source-inline">nnet</strong> – <span class="No-Break">7.3.18</span></li>&#13;
				<li><strong class="source-inline">glmnet</strong> – <span class="No-Break">4.1.7</span></li>&#13;
			</ul>&#13;
			<p>The versions mentioned along with the packages in the preceding list are the latest ones while I am writing <span class="No-Break">this book.</span></p>&#13;
			<p>All the code and data for this chapter is available <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_13/working.R"><span class="No-Break">https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_13/working.R</span></a><span class="No-Break">.</span></p>&#13;
			<h1 id="_idParaDest-275"><a id="_idTextAnchor282"/>Introducing logistic regression</h1>&#13;
			<p>Logistic regression <a id="_idIndexMarker1216"/>is a binary classification model. It is still a linear model, but now the output is constrained to be a binary variable, taking the value of <strong class="source-inline">0</strong> or <strong class="source-inline">1</strong>, instead of modeling a continuous outcome as in the case of linear regression. In other words, we will observe and model the outcome <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> or <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>. For example, in the case of credit risk modeling, <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span> refers to a non-default loan application, while <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> indicates a <span class="No-Break">default loan.</span></p>&#13;
			<p>However, instead of directly predicting the binary outcome, the logistic regression model predicts the probability of <span class="_-----MathTools-_Math_Variable">y</span> taking a specific value, such as <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span>. The probability of assuming the other category is <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span>, since the total probability should always sum to <strong class="source-inline">1</strong>. The final prediction would be the winner of the two, taking the value of <strong class="source-inline">1</strong> if <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">&gt;</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span>, and <strong class="source-inline">0</strong> otherwise. In the credit risk example, <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span> would be interpreted as the probability of a <span class="No-Break">loan defaulting.</span></p>&#13;
			<p>In<a id="_idIndexMarker1217"/> logistic regression, the term <em class="italic">logistic</em> is related to <em class="italic">logit</em>, which refers to the log odds. The odds are another way to describe the probability; instead of specifying the individual <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span> and <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span>, it refers to the ratio of <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span> to <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span>. Thus the log odds are calculated via <span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span>. Therefore, we can simply use the term <em class="italic">odds</em> to describe the probability of an event happening (<span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>) over the probability of it not occurring (<span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break">).</span></p>&#13;
			<p>First, let us look at how the logistic regression model transforms a continuous output (as in linear regression) into a probability score, which is a number bounded between <strong class="source-inline">0</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>&#13;
			<h2 id="_idParaDest-276"><a id="_idTextAnchor283"/>Understanding the sigmoid function</h2>&#13;
			<p>The<a id="_idIndexMarker1218"/> <strong class="source-inline">sigmoid</strong> function is the key ingredient that maps <a id="_idIndexMarker1219"/>any continuous number (from negative infinity to positive infinity) to a probability. Also known as the logistic function, the <strong class="source-inline">sigmoid</strong> function is characterized by an S-shaped curve, taking any real number as input and mapping it into a score between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>, which happens to be the range of a valid <span class="No-Break">probability score.</span></p>&#13;
			<p>The standard <strong class="source-inline">sigmoid</strong> function takes the <span class="No-Break">following form:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">f</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p>Note that this is a nonlinear function. That is, the input values will get disproportionate scaling when going through the transformation using this function. It is also a continuous function (thus differentiable) and monotone (<span class="_-----MathTools-_Math_Variable">f</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Variable">)</span> will increase as <span class="_-----MathTools-_Math_Variable">x</span> increases), thus enjoying high popularity as the go-to activation function to be used at the last layer of a typical neural network model for binary <span class="No-Break">classification tasks.</span></p>&#13;
			<p>Let us try to visualize this function. In the following code snippet, we use <strong class="source-inline">seq(-10, 10, by = 0.1)</strong> to create a sequence of equally spaced numbers from -10 to 10, with a step size of <strong class="source-inline">0.1</strong>. For each number, we calculate the corresponding output using the <strong class="source-inline">sigmoid</strong> function. Here, we directly pass all the numbers of the function, which then calculates all the output in a parallel mode called vectorization. Here, vectorization refers to the<a id="_idIndexMarker1220"/> process of applying an operation to an entire vector simultaneously instead of looping over each element one by one as in a <strong class="source-inline">for</strong> loop. Finally, we plot the function to show the <a id="_idIndexMarker1221"/>characteristic S-shaped curve of the <strong class="source-inline">sigmoid</strong> function and add the gridlines using the <span class="No-Break"><strong class="source-inline">grid()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<pre class="source-code">&#13;
# Create a range of equally spaced numbers between -10 and 10&#13;
x = seq(-10, 10, by = 0.1)&#13;
# Calculate the output value for each number using sigmoid function&#13;
sigmoid = 1 / (1 + exp(-x))&#13;
# Plot the sigmoid function&#13;
plot(x, sigmoid, type = "l", lwd = 2,&#13;
     main = "Sigmoid Function",&#13;
     xlab = "x",&#13;
     ylab = "f(x)",&#13;
     col = "red")&#13;
# Add grid lines&#13;
grid()</pre>			<p>Running the preceding code generates the output shown in <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.1</em>. The plot shows a different level of steepness across the whole domain, where the function is more sensitive in the middle region and becomes more saturated at the <span class="No-Break">two extremes.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer226" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_001.jpg" alt="Figure 13.1 – Visualizing the sigmoid function" width="871" height="581"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.1 – Visualizing the sigmoid function</p>&#13;
			<p>Now that we understand the <strong class="source-inline">sigmoid</strong> function, let us look <a id="_idIndexMarker1222"/>at the mathematical construct of the logistic <span class="No-Break">regression model.</span></p>&#13;
			<h2 id="_idParaDest-277"><a id="_idTextAnchor284"/>Grokking the logistic regression model</h2>&#13;
			<p>The logistic regression model<a id="_idIndexMarker1223"/> is essentially a linear regression model generalized to the setting where the dependent outcome variable is binary. In other words, it is a linear regression model that models the log odds of the probability of <span class="No-Break">an event.</span></p>&#13;
			<p>To see this, let us first recall the following linear regression model, where we use a total of <span class="_-----MathTools-_Math_Variable">p</span> features to model the target output <span class="No-Break">variable, </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span><span class="No-Break">:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">x</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span></p>&#13;
			<p>Here, <span class="_-----MathTools-_Math_Variable">z</span> is interpreted as the log odds, or logit, of the event of <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>. We are interested in estimating the parameters from <span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span> to <span class="No-Break"><span class="_-----MathTools-_Math_Variable">β</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span><span class="No-Break">.</span></p>&#13;
			<p>Now, we know that the <span class="_-----MathTools-_Math_Variable">z</span> variable is unbounded, meaning it can vary from negative infinity to positive infinity. We need a way to bound this output and convert it into a probability score valued between 0 and 1. This is achieved via an additional transformation using the <strong class="source-inline">sigmoid</strong> function, which happens to satisfy all our needs. Mathematically, we have <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p>Plugging in the definition of <span class="_-----MathTools-_Math_Variable">z</span> gives the full logistic <span class="No-Break">regression model:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">_____________</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p>Here, <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span> refers to the probability of having a success of <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> (this is a general statement), and correspondingly, <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span> indicates the probability of having <span class="No-Break">a failure.</span></p>&#13;
			<p>Note that we can equivalently express the model as <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">x</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span></p>&#13;
			<p>Here, the term <span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Function_v-normal"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span> stands for the <span class="No-Break">log odds.</span></p>&#13;
			<p>A <a id="_idIndexMarker1224"/>key change here is the introduction of the <strong class="source-inline">sigmoid</strong> function. This makes the relationship between the predictors and the resulting probability no longer linear, but sigmoidal instead. To observe the subtlety here, we can look at the different regions of the <strong class="source-inline">sigmoid</strong> function across the domain. For example, when looking at the region around 0, a small change in the input would result in a relatively large change in the resulting probability output. However, the same change in the input will cause a very small change in the output when located on the two extreme sides of the function. Also, as the input becomes more extreme, either toward the negative or positive side, the resulting probability will gradually approach 0 or 1. <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.2</em> recaps the characteristics of the logistic <span class="No-Break">regression model.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer227" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_002.jpg" alt="Figure 13.2 – Summarizing the logistic regression model" width="1562" height="784"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.2 – Summarizing the logistic regression model</p>&#13;
			<p>Note that a<a id="_idIndexMarker1225"/> logistic regression model shares similar assumptions with the linear regression model. Specifically, it assumes that the observations are independent of each other, and the target outcome follows a Bernoulli distribution parameterized by <span class="_-----MathTools-_Math_Variable">p</span> – that is, <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator_Extended">∼</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">B</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">u</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">)</span>. Given this, we do not assume a linear regression between the output variable and the input predicts; instead, we use the logistic link function to transform and introduce nonlinearity to the <span class="No-Break">input variables.</span></p>&#13;
			<p>The following section further compares logistic regression with <span class="No-Break">linear regression.</span></p>&#13;
			<h1 id="_idParaDest-278"><a id="_idTextAnchor285"/>Comparing logistic regression with linear regression</h1>&#13;
			<p>In this section, we<a id="_idIndexMarker1226"/> will focus on a binary credit classification task using the <em class="italic">German Credit</em> dataset, which contains 1,000 observations and 20 columns. Each observation denotes a customer who had a loan application from the bank and is labeled as either good or bad in terms of credit risk. The dataset is available in the <strong class="source-inline">caret</strong> package <span class="No-Break">in R.</span></p>&#13;
			<p>For our study, we will attempt to predict the target binary variable, <strong class="source-inline">Class</strong>, based on <strong class="source-inline">Duration</strong>, and compare the difference in the prediction outcome between linear regression and logistic regression. We specifically choose one predictor only so that we can visualize and compare the decision boundaries of the resultant model in a <span class="No-Break">two-dimensional plot.</span></p>&#13;
			<h3>Exercise 13.1 – comparing linear regression with logistic regression</h3>&#13;
			<p>In this exercise, we<a id="_idIndexMarker1227"/> will demonstrate the advantage of using a logistic regression model in producing a probabilistic output compared to the unbounded output using a linear <span class="No-Break">regression model:</span></p>&#13;
			<ol>&#13;
				<li>Load the <em class="italic">German Credit</em> dataset from the <strong class="source-inline">caret</strong> package. Convert the target variable (<strong class="source-inline">Class</strong>) <span class="No-Break">to numeric:</span><pre class="source-code">&#13;
# install the caret package if you haven't done so&#13;
install.packages("caret")&#13;
# load the caret package&#13;
library(caret)&#13;
# load the German Credit dataset&#13;
data(GermanCredit)&#13;
GermanCredit$Class_num = ifelse(GermanCredit$Class == "Bad", 1, 0)</pre><p class="list-inset">Here, we create a new target variable called <strong class="source-inline">Class_num</strong> to map the original <strong class="source-inline">Class</strong> variable to <strong class="source-inline">1</strong> if it takes on the value of <strong class="source-inline">"Bad"</strong>, and <strong class="source-inline">0</strong> otherwise. This is necessary as both linear regression and logistic regression models cannot accept a string-based variable as the target (<span class="No-Break">or predictor).</span></p></li>				<li>Build a linear regression model to regress <strong class="source-inline">Class_num</strong> <span class="No-Break">against </span><span class="No-Break"><strong class="source-inline">Duration</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
lm_model = lm(Class_num ~ Duration, data=GermanCredit)&#13;
coefs = coefficients(lm_model)&#13;
intercept = coefs[1]&#13;
slope = coefs[2]</pre><p class="list-inset">Here, we use the <strong class="source-inline">lm()</strong> function to build the linear regression model and <strong class="source-inline">coefficients()</strong> to extract the model coefficients, including the intercept <span class="No-Break">and slope.</span></p></li>				<li>Visualize the prediction and <span class="No-Break">the target:</span><pre class="source-code">&#13;
ggplot(GermanCredit,&#13;
       aes(Duration, Class_num)) +&#13;
  geom_point() +&#13;
  geom_abline(intercept=intercept, slope=slope) +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">Here, we plot the observed target variable as a scatter plot and use the <strong class="source-inline">geom_abline()</strong> function to plot the model as a straight line based on the estimated slope <span class="No-Break">and intercept.</span></p><p class="list-inset">Running the<a id="_idIndexMarker1228"/> preceding code generates <span class="No-Break"><em class="italic">Figure 13</em></span><span class="No-Break"><em class="italic">.3</em></span><span class="No-Break">.</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer228" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_003.jpg" alt="Figure 13.3 – Visualizing the linear regression model" width="1322" height="962"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.3 – Visualizing the linear regression model</p>&#13;
			<p class="list-inset">Since all target values are <strong class="source-inline">0</strong> or <strong class="source-inline">1</strong>, we can think of the predictions as probabilities valued between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>. However, as we zoom out, the problem of having an unbounded probability would surface, as shown in the <span class="No-Break">following steps.</span></p>&#13;
			<ol>&#13;
				<li value="4">Re-plot <a id="_idIndexMarker1229"/>the graph by zooming out to a wide domain of <strong class="source-inline">(-30, 120)</strong> for the <em class="italic">x</em> axis and <strong class="source-inline">(-0.5, 1.5)</strong> for the <span class="No-Break"><em class="italic">y</em></span><span class="No-Break"> axis:</span><pre class="source-code">&#13;
ggplot(GermanCredit,&#13;
       aes(Duration, Class_num)) +&#13;
  geom_point() +&#13;
  geom_abline(intercept=intercept, slope=slope) +&#13;
  xlim(-30, 120) +&#13;
  ylim(-0.5, 1.5) +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">Here, we enlarged the range of possible values for the <em class="italic">x</em> axis and <em class="italic">y</em> axis using the <strong class="source-inline">xlim()</strong> and <span class="No-Break"><strong class="source-inline">ylim()</strong></span><span class="No-Break"> functions.</span></p><p class="list-inset">Running the preceding code generates the output shown in <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.4</em>, which shows that the predicted values are outside the range of <strong class="source-inline">[0,1]</strong> when the value of <strong class="source-inline">Duration</strong> becomes more extreme, a situation called extrapolation beyond the observed range of values. This means that the predicted probabilities would be smaller than 0 or bigger than 1, which is obviously an invalid output. This calls for a generalized linear regression model called logistic regression, where the response will follow a logistic, S-shaped curve based on the transformation of the <span class="No-Break"><strong class="source-inline">sigmoid</strong></span><span class="No-Break"> function.</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer229" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_004.jpg" alt="Figure 13.4 – Visualizing the linear regression model with extended range" width="1550" height="1133"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.4 – Visualizing the linear regression model with extended range</p>&#13;
			<ol>&#13;
				<li value="5">Build a<a id="_idIndexMarker1230"/> logistic regression model using the <span class="No-Break"><strong class="source-inline">glm()</strong></span><span class="No-Break"> function:</span><pre class="source-code">&#13;
glm_model = glm(Class_num ~ Duration, data=GermanCredit, family=binomial)&#13;
&gt;&gt;&gt; glm_model&#13;
Call:  glm(formula = Class_num ~ Duration, family = binomial, data = GermanCredit)&#13;
Coefficients:&#13;
(Intercept)     Duration&#13;
   -1.66635      0.03754&#13;
Degrees of Freedom: 999 Total (i.e. Null);  998 Residual&#13;
Null Deviance:     1222&#13;
Residual Deviance: 1177   AIC: 1181</pre><p class="list-inset">The result shows the estimated intercept and slope, along with the residual deviance, a measure of goodness of fit for the logistic <span class="No-Break">regression model.</span></p></li>				<li>Plot the<a id="_idIndexMarker1231"/> estimated logistic curve on the <span class="No-Break">previous plot:</span><pre class="source-code">&#13;
ggplot(GermanCredit,&#13;
       aes(Duration, Class_num)) +&#13;
  geom_point() +&#13;
  geom_abline(intercept=intercept, slope=slope) +&#13;
  geom_smooth(&#13;
    method = "glm",&#13;
    se = FALSE,&#13;
    method.args = list(family=binomial)&#13;
  ) +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">Running the preceding code will generate the output shown in <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.5</em>, which suggests a slight deviation between the linear regression line and the logistic <span class="No-Break">regression curve.</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer230" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_005.jpg" alt="Figure 13.5 – Visualizing the logistic regression curve" width="1588" height="1151"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.5 – Visualizing the logistic regression curve</p>&#13;
			<p class="list-inset">Again, we <a id="_idIndexMarker1232"/>can zoom out the figure and focus on the difference when going beyond the observed range of possible values in <span class="No-Break">the dataset.</span></p>&#13;
			<ol>&#13;
				<li value="7">Plot the logistic curve within a wider range of values beyond the <span class="No-Break">observed range:</span><pre class="source-code">&#13;
# Get coefficients from logistic model&#13;
intercept_glm = coef(glm_model)[1]&#13;
slope_glm = coef(glm_model)[2]&#13;
# Generate sequence of x-values&#13;
x_values = seq(from = min(GermanCredit$Duration) - 150,&#13;
                to = max(GermanCredit$Duration) + 150,&#13;
                by = 0.1)&#13;
# Compute probabilities using logistic function&#13;
y_values = 1 / (1 + exp(-(intercept_glm + slope_glm * x_values)))&#13;
# Data frame for plot&#13;
plot_df = data.frame(x = x_values, y = y_values)&#13;
# Plot&#13;
ggplot() +&#13;
  geom_point(data = GermanCredit, aes(Duration, Class_num)) +&#13;
  geom_abline(intercept=intercept, slope=slope) +&#13;
  geom_line(data = plot_df, aes(x, y), color = "blue") +&#13;
  theme_minimal() +&#13;
  xlim(-30, 120) +&#13;
  ylim(-0.5, 1.5) +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">Here, we <a id="_idIndexMarker1233"/>first extract the coefficients for the logistic regression model, followed by generating a sequence of values for the input and the corresponding output using the <strong class="source-inline">sigmoid</strong> function transformation. Lastly, we plot the logistic curve together with the linear fit in the same plot with the <span class="No-Break">observed data.</span></p><p class="list-inset">Running the preceding code generates the output shown in <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.6</em>, which shows that the logistic regression curve gets gradually saturated as the input value<a id="_idIndexMarker1234"/> becomes more extreme. In addition, all values are now bounded in the range of <strong class="source-inline">[0,1]</strong>, making it a valid candidate for interpretation as probabilities instead of an <span class="No-Break">unbounded value.</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer231" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_006.jpg" alt="Figure 13.6 – Visualizing the logistic regression model with extended range" width="1416" height="1096"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.6 – Visualizing the logistic regression model with extended range</p>&#13;
			<p>The next section looks at how to make predictions using a logistic <span class="No-Break">regression model.</span></p>&#13;
			<h2 id="_idParaDest-279"><a id="_idTextAnchor286"/>Making predictions using the logistic regression model</h2>&#13;
			<p>As <a id="_idIndexMarker1235"/>discussed in the previous section, the direct predictions from a logistic regression model take the form of probabilities <a id="_idIndexMarker1236"/>valued between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>. To convert them into binary predictions, we could take the most probable prediction by rounding the probability using a threshold of <strong class="source-inline">0.5</strong>. For example, if the predicted probability is <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.8</span>, the rounding operation will lead to a final binary prediction of <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>. On the other hand, if <span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.3</span>, rounding will result in <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break">.</span></p>&#13;
			<p>Let us go through the following exercise to understand how to perform predictions using the logistic <span class="No-Break">regression model.</span></p>&#13;
			<h3>Exercise 13.2 – performing predictions using the logistic regression model</h3>&#13;
			<p>We have <a id="_idIndexMarker1237"/>seen how to perform <a id="_idIndexMarker1238"/>predictions using the explicit sigmoid transformation after extracting the slope and intercept of the logistic regression model. In this exercise, we will explore a more convenient approach using the <span class="No-Break"><strong class="source-inline">predict()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<ol>&#13;
				<li>Generate a sequence of <strong class="source-inline">Duration</strong> values ranging from <strong class="source-inline">5</strong> to <strong class="source-inline">80</strong> with a step size of <strong class="source-inline">2</strong> and predict the corresponding probabilities for the sequence using the <strong class="source-inline">predict()</strong> function based on the previous logistic <span class="No-Break">regression model:</span><pre class="source-code">&#13;
library(tibble)&#13;
library(dplyr)&#13;
# making predictions&#13;
pred_df = tibble(&#13;
  Duration = seq(5, 80, 2)&#13;
)&#13;
pred_df = pred_df %&gt;%&#13;
  mutate(&#13;
    pred_prob = predict(glm_model, pred_df, type="response")&#13;
  )</pre><p class="list-inset">Here, we use the <strong class="source-inline">seq()</strong> function to create the equally spaced vector and store it in a <strong class="source-inline">tibble</strong> object called <strong class="source-inline">pred_df</strong>. We then use <strong class="source-inline">predict()</strong> to predict the corresponding probabilities by <span class="No-Break">specifying </span><span class="No-Break"><strong class="source-inline">type="response"</strong></span><span class="No-Break">.</span></p></li>				<li>Visualize<a id="_idIndexMarker1239"/> the predicted probabilities together with the <span class="No-Break">raw data:</span><pre class="source-code">&#13;
ggplot() +&#13;
  geom_point(data = GermanCredit, aes(Duration, Class_num)) +&#13;
  geom_point(data = pred_df, aes(Duration, pred_prob) , color="blue") +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">The<a id="_idIndexMarker1240"/> preceding code will generate the <span class="No-Break">following output:</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer232" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_007.jpg" alt="Figure 13.7 – Visualizing the predicted probabilities" width="726" height="550"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.7 – Visualizing the predicted probabilities</p>&#13;
			<ol>&#13;
				<li value="3">Convert the probabilities to binary outcomes using the <span class="No-Break"><strong class="source-inline">round()</strong></span><span class="No-Break"> function:</span><pre class="source-code">&#13;
# getting the most likely outcome&#13;
pred_df = pred_df %&gt;%&#13;
  mutate(&#13;
    most_likely_outcome = round(pred_prob)&#13;
  )</pre><p class="list-inset">Here, we <a id="_idIndexMarker1241"/>round the predicted probabilities using a default threshold <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">0.5</strong></span><span class="No-Break">.</span></p></li>				<li>Add<a id="_idIndexMarker1242"/> the binary outcomes as green points to the <span class="No-Break">previous graph:</span><pre class="source-code">&#13;
ggplot() +&#13;
  geom_point(data = GermanCredit, aes(Duration, Class_num)) +&#13;
  geom_point(data = pred_df, aes(Duration, pred_prob) , color="blue") +&#13;
  geom_point(data = pred_df, aes(Duration, most_likely_outcome) , color="green") +&#13;
  theme(axis.title.x = element_text(size = 18),&#13;
        axis.title.y = element_text(size = 18))</pre><p class="list-inset">Running the preceding code generates the following output, which suggests that all predicted probabilities above <strong class="source-inline">0.5</strong> are converted to <strong class="source-inline">1</strong>, and those below <strong class="source-inline">0.5</strong> are converted <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">0</strong></span><span class="No-Break">.</span></p></li>			</ol>&#13;
			<div>&#13;
				<div id="_idContainer233" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_008.jpg" alt="Figure 13.8 – Visualizing the predicted binary outcomes" width="1019" height="765"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.8 – Visualizing the predicted binary outcomes</p>&#13;
			<p>The<a id="_idIndexMarker1243"/> next section discusses the <a id="_idIndexMarker1244"/>log <span class="No-Break">odds further.</span></p>&#13;
			<h1 id="_idParaDest-280"><a id="_idTextAnchor287"/>More on log odds and odds ratio</h1>&#13;
			<p>Recall that the odds refer to<a id="_idIndexMarker1245"/> the ratio of the probability of an event<a id="_idIndexMarker1246"/> happening over <span class="No-Break">its complement:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">b</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">b</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">f</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">h</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable">   </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">_______________________</span><span class="_-----MathTools-_Math_Base">   </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">b</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">b</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">f</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">v</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">h</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p>Here, the probability is calculated <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span></p>&#13;
			<p>Plugging in the definition of <span class="_-----MathTools-_Math_Variable">p</span> and <span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span> gives us <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">e</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span></p>&#13;
			<p>Instead of directly working with the odds, we often use the log odds or logit. This term is typically modeled as a linear combination of predictors in a logistic regression model via <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">P</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">x</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span></p>&#13;
			<p>Here, we<a id="_idIndexMarker1247"/> can interpret each coefficient <span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">j</span> as the expected change in <a id="_idIndexMarker1248"/>the log odds for a one-unit increase in the j<span class="superscript">th</span> predictor <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">j</span>, while keeping all other predictors constant. This equation essentially says that the log odds of the target value <span class="_-----MathTools-_Math_Variable">y</span> being <strong class="source-inline">1</strong> is linearly related to the <span class="No-Break">input variables.</span></p>&#13;
			<p>Now suppose <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> is a binary input variable, making <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> = 1 or 0. We can calculate the odds of <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">1</span></span></p>&#13;
			<p>This measures the chance of an event for <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>, over the chance of a non-event. Similarly, we can calculate the odds of <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span> <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span></p>&#13;
			<p>This measures the chance of an event for <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span> over the chance of <span class="No-Break">a non-event.</span></p>&#13;
			<p>We can then calculate the odds ratio of <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span>, which is the ratio of the odds <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> to the odds of <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break">:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Symbol">*</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">__________</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Symbol">*</span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">β</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">i</span></span></p>&#13;
			<p>Here, <span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> measures the quantified impact of the binary input variable, <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span>, on the odds of the outcome <span class="_-----MathTools-_Math_Variable">y</span> being <strong class="source-inline">1</strong>, while all other input variables remain unchanged. This gives us a way to measure the impact of any predictor in a logistic regression model, covering both categorical and numerical <span class="No-Break">input variables.</span></p>&#13;
			<p>For categorical input variables, we may use gender (<strong class="source-inline">0</strong> for male and <strong class="source-inline">1</strong> for female) to predict whether insurance is purchased (<strong class="source-inline">1</strong> for yes and <strong class="source-inline">0</strong> for no). We set the base categorical as <strong class="source-inline">0</strong> for male. If the estimated coefficient <span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.2</span> for gender, its odds ratio is calculated as <span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.2</span> <span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1.22</span>. Therefore, the odds of female customers purchasing the insurance is 1.22 times the odds of their male counterparts purchasing the insurance, assuming all other variables <span class="No-Break">remain unchanged.</span></p>&#13;
			<p>For numerical input variables, we<a id="_idIndexMarker1249"/> may use age to predict whether insurance is purchased. There is no need to set the base category in this case. If the estimated coefficient <span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.3</span>, the corresponding odds ratio is calculated as <span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1.35</span>. This means that the odds of a client purchasing is 1.35 times the odds of similar people who are one year younger, assuming <span class="No-Break"><em class="italic">ceteris paribus</em></span><span class="No-Break">.</span></p>&#13;
			<p>Note that we <a id="_idIndexMarker1250"/>can calculate the log odds using the predicted probabilities, as shown in the following <span class="No-Break">code snippet:</span></p>&#13;
			<pre class="source-code">&#13;
# calculate log odds using predicted probabilities&#13;
pred_df = pred_df %&gt;%&#13;
  mutate(&#13;
    log_odds = log(pred_prob / (1 - pred_prob))&#13;
  )</pre>			<p>The next section introduces more on the loss function of the logistic <span class="No-Break">regression model.</span></p>&#13;
			<h1 id="_idParaDest-281"><a id="_idTextAnchor288"/>Introducing the cross-entropy loss</h1>&#13;
			<p>The <a id="_idIndexMarker1251"/>binary CEL, also called<a id="_idIndexMarker1252"/> the <strong class="bold">log loss</strong>, is often used as the cost function in logistic regression. This is the loss that the logistic regression model will attempt to minimize by moving the parameters. This function takes the predicted probabilities and the corresponding targets as the input and outputs a scalar score, indicating the goodness of fit. For a single observation with a target of <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> and predicted probability of <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span>, the loss is calculated <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">i</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">)</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p>Summing up all<a id="_idIndexMarker1253"/> individual losses gives the total <span class="No-Break">binary CEL:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">i</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">)</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p>The binary CEL function is a suitable choice for binary classification <a id="_idIndexMarker1254"/>problems because it heavily penalizes confident but incorrect predictions. For example, as <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> approaches <em class="italic">0</em> or <em class="italic">1</em>, the resulting CEL will go to infinity if the prediction is incorrect. This property thus encourages the learning process to output probabilities that are close to the true probabilities of <span class="No-Break">the targets.</span></p>&#13;
			<p>More generally, we <a id="_idIndexMarker1255"/>use the CEL to model a classification problem with two or more classes in the target variable. For the <span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> observation, <em class="italic">x</em><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span>, the classification function would produce a probability output, denoted as <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">f</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Base"> </span><em class="italic">x</em><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">;</span><span class="_-----MathTools-_Math_Base"> </span><em class="italic">w</em><span class="_-----MathTools-_Math_Base">)</span>, to indicate the likelihood of belonging to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class. When we have a classification task with a total of <span class="_-----MathTools-_Math_Variable">C</span> classes, the CEL for <em class="italic">x</em><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> is defined as <span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">(</span><em class="italic">w</em><span class="_-----MathTools-_Math_Variable_v-bold">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">C</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">g</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base">)</span>, which essentially sums across all classes. Again, <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> if the target label for the <span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> observation belongs to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class, and <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break"> otherwise.</span></p>&#13;
			<p>The summation means that the class-wise evaluation (i.e., the term <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">g</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base">)</span>) is performed for all classes and summed together to produce the total cost for the <span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> observation. For each observation, there are a total of <span class="_-----MathTools-_Math_Variable">C</span> predictions corresponding to the respective probability of belonging to each class. The CEL thus aggregates the matrix of predicted probabilities by summing them into a single number. In addition, the result is negated to produce a positive number, since <span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">g</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base">)</span> is negative if <span class="_-----MathTools-_Math_Variable">x</span> is a probability between <strong class="source-inline">0</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>&#13;
			<p>Note that the target label in the CEL calculation needs to be one-hot encoded. This means that a single categorical label is converted into an array of binary numbers that contains <strong class="source-inline">1</strong> for the class label and <strong class="source-inline">0</strong> otherwise. For example, for a digit image on number <strong class="source-inline">8</strong>, instead of passing the original class as the target output, the resulting one-hot-encoded target <strong class="source-inline">[0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</strong> would be used, where the 8<span class="superscript">th</span> position is activated (i.e., hot) and the rest disabled. The target array would also have the same length as the probability output array, whose elements correspond to each of <span class="No-Break">the classes.</span></p>&#13;
			<p>Intuitively, we would hope for the predicted probability for the correct class to be close to <strong class="source-inline">1</strong> and for the incorrect class to be <strong class="source-inline">0</strong>. That is, the loss should increase as the predicted probabilities diverge from the actual class label. The CEL is designed to follow this intuition. Specifically, we can look at the following four scenarios for the <span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">t</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">h</span></span><span class="No-Break"> observation:</span></p>&#13;
			<ul>&#13;
				<li>When the target label belongs to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class (i.e., <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>) and the predicted probability for the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class is very strong (i.e., <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>), the cost should <span class="No-Break">be low.</span></li>&#13;
				<li>When the target label belongs to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class (i.e., <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>) and the predicted probability for the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class is very weak (i.e., <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>), the cost should <span class="No-Break">be high.</span></li>&#13;
				<li>When the target label does not belong to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class (i.e., <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>) and the predicted probability for the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class is very strong (i.e., <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>), the cost should <span class="No-Break">be high.</span></li>&#13;
				<li>When the target label does not belong to the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class (i.e., <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>) and the predicted probability for the <span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">t</span><span class="_-----MathTools-_Math_Variable">h</span> class is very weak (i.e., <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>), the cost should <span class="No-Break">be low.</span></li>&#13;
			</ul>&#13;
			<p>To <a id="_idIndexMarker1256"/>calculate the CEL, we first calculate the weighted sum between the vector of binary labels and the vector of predicted probabilities <a id="_idIndexMarker1257"/>across all classes for each observation. The results of all observations are added together, followed by a minus sign to reverse the cost to a positive number. The CEL is designed to match the intuition for the cost: the cost would be low when the prediction and the target closely match, and high otherwise. In other words, to calculate the total cost, we would simply sum individual costs, leading to <span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold">w</span><span class="_-----MathTools-_Math_Variable_v-bold">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">C</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">g</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Variable">k</span><span class="_-----MathTools-_Math_Base">)</span>. <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.9</em> summarizes the preceding discussion on <span class="No-Break">the CEL.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer234" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_009.jpg" alt="Figure 13.9 – Illustrating the CEL" width="1617" height="858"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.9 – Illustrating the CEL</p>&#13;
			<p>Note that the last two scenarios do not contribute at all to the loss calculation since the target value is equal to <a id="_idIndexMarker1258"/>0; any value multiplied by 0 becomes 0. Also, observe that the predicted probabilities of a specific observation for these two classes need to add up to 1, making it sufficient to only focus on the predicted probability of one class (mostly <span class="No-Break">class </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">).</span></p>&#13;
			<p>The next section introduces how to evaluate a logistic <span class="No-Break">regression model.</span></p>&#13;
			<h1 id="_idParaDest-282"><a id="_idTextAnchor289"/>Evaluating a logistic regression model</h1>&#13;
			<p>There <a id="_idIndexMarker1259"/>are multiple metrics we can use to evaluate a logistic regression model. These are the metrics we use to determine the goodness of fit (over the test set), which needs to be differentiated from the CEL we use to train the model (over the <span class="No-Break">training set).</span></p>&#13;
			<p>The following list <a id="_idIndexMarker1260"/>provides the commonly <span class="No-Break">used metrics:</span></p>&#13;
			<ul>&#13;
				<li><strong class="bold">Accuracy rate</strong>: This is<a id="_idIndexMarker1261"/> the<a id="_idIndexMarker1262"/> proportion of the number of correctly predicted observations made by the model out of the count of all observations. Since a correct prediction can be either a true positive or a true negative, the accuracy is calculated by summing up the true positives and true negatives and dividing the total number <span class="No-Break">of observations.</span></li>&#13;
				<li><strong class="bold">Error rate</strong>: This<a id="_idIndexMarker1263"/> is the<a id="_idIndexMarker1264"/> proportion of incorrectly predicted observations made by the model over the total observations. An incorrect prediction can be a false positive or a false negative. It is calculated as <em class="italic">1 - accuracy rate</em>; that is, the error rate is the complement of the accuracy rate. In other words, it is calculated as <em class="italic">(false positives + false negatives) / </em><span class="No-Break"><em class="italic">total observations</em></span><span class="No-Break">.</span></li>&#13;
				<li><strong class="bold">Precision</strong>: Precision<a id="_idIndexMarker1265"/> is the <a id="_idIndexMarker1266"/>proportion of correct positive predictions among all positive predictions. This measure essentially tells us out of all predicted positive instances, how many of them are correct. Thus it indicates the<a id="_idIndexMarker1267"/> model’s accuracy in <a id="_idIndexMarker1268"/>predicting positive observations and is calculated as <em class="italic">true positives / (true positives + false positives)</em>. In the denominator, we note that among all positive instances, some are true positives and the rest are <span class="No-Break">false positives.</span></li>&#13;
				<li><strong class="bold">Recall</strong>: Recall <a id="_idIndexMarker1269"/>refers to the<a id="_idIndexMarker1270"/> proportion of actual positive instances that the model correctly predicts. Also called sensitivity<a id="_idIndexMarker1271"/> or <strong class="bold">true positive rate</strong> (<strong class="bold">TPR</strong>), the recall measures the model’s ability to detect positive observations. It is calculated as <em class="italic">true positives / (true positives + false negatives)</em>, where the formula differs in the denominator compared <span class="No-Break">with precision.</span></li>&#13;
				<li><strong class="bold">Specificity</strong>: Also<a id="_idIndexMarker1272"/> called <strong class="bold">true negative rate</strong> (<strong class="bold">TNR</strong>), specificity <a id="_idIndexMarker1273"/>measures the proportion of actual negative<a id="_idIndexMarker1274"/> instances correctly predicted by the model. This is the opposite of sensitivity, which focuses on the model’s ability to capture the true positives. In other words, specificity measures the model’s ability to identify negative instances or non-events correctly. It is calculated as <em class="italic">true negatives / (true negatives + </em><span class="No-Break"><em class="italic">false positives)</em></span><span class="No-Break">.</span></li>&#13;
				<li><strong class="bold">Area under the curve</strong> (<strong class="bold">AUC</strong>): The <a id="_idIndexMarker1275"/>AUC<a id="_idIndexMarker1276"/> is directly determined <a id="_idIndexMarker1277"/>by the <strong class="bold">receiver operating characteristic</strong> (<strong class="bold">ROC</strong>) curve, which plots the TPR (sensitivity) against the false positive rate (<em class="italic">1 - specificity</em>) at different thresholds for binary classification. As the name suggests, AUC measures the area under the ROC curve in the form of a proportion valued between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>, indicating the degree of separability between two classes. A perfect model with 100% correct predictions has an AUC of <strong class="source-inline">1</strong>, while a model with completely wrong predictions has an AUC of <strong class="source-inline">0</strong>. A model that performs random guesses (choosing <strong class="source-inline">0</strong> or <strong class="source-inline">1</strong> with 50% probability) corresponds to an AUC of <strong class="source-inline">0.5</strong>, suggesting no class <span class="No-Break">separation capacity.</span></li>&#13;
			</ul>&#13;
			<p>Note that <a id="_idIndexMarker1278"/>we would exercise the principle of parsimony upon assessing two models with equally good evaluation metrics. The principle of parsimony says that if two competing models provide a similar level of fit to the data, the one with fewer input variables should be picked, thus preferring simplicity over complexity. The underlying assumption is that the most accurate model is not necessarily the <span class="No-Break">best model.</span></p>&#13;
			<p><span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.10</em> describes the process of laying out the confusion matrix that captures the prediction results in different scenarios, along with the details on calculating the aforementioned <span class="No-Break">evaluation metrics.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer235" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_010.jpg" alt="Figure 13.10 – Illustrating the confusion matrix and common evaluation metrics for binary classification tasks" width="1521" height="806"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.10 – Illustrating the confusion matrix and common evaluation metrics for binary classification tasks</p>&#13;
			<p>Note that we<a id="_idIndexMarker1279"/> will only be able to calculate these metrics after selecting a threshold to cut off predicted probabilities. Specifically, an observation with a predicted probability greater than the cutoff threshold will be classified as positive, and <span class="No-Break">negative otherwise.</span></p>&#13;
			<p>Precision and recall usually have an inverse relationship with respect to the adjustment of the classification threshold. Reviewing both precision and recall is useful for cases where there is a huge imbalance in the target variable’s values. As precision and recall are two related but different metrics, which should we <span class="No-Break">optimize for?</span></p>&#13;
			<p>To answer this question, we need to assess the relative impact of making a false negative prediction. This is measured by the false negative rate, which is the opposite (or complement) of recall. As <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.11</em> suggests, failing to spot a spam email is less risky than missing a fraudulent transaction or a positive cancer patient. We should aim to optimize for precision (so that the model’s predictions are more precise and targeted) for the first case and recall (so that we minimize the chance of missing a potentially positive case) for the <span class="No-Break">second case.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer236" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_011.jpg" alt="Figure 13.11 – Three cases with different impacts of having a false negative prediction" width="980" height="342"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.11 – Three cases with different impacts of having a false negative prediction</p>&#13;
			<p>As for<a id="_idIndexMarker1280"/> the AUC, or area under the ROC curve, there is no need to select a specific threshold as it is calculated by evaluating a sequence of thresholds from <strong class="source-inline">0</strong> to <strong class="source-inline">1</strong>. The ROC curve plots the sensitivity on the <em class="italic">y</em> axis and <em class="italic">1 - specificity</em> on the <em class="italic">x</em> axis. This also corresponds to plotting TPR versus 1-TNR, or TPR versus FPR. As the classification threshold goes up, FPR goes down, leading to a leftward movement of <span class="No-Break">the curve.</span></p>&#13;
			<p>A perfect binary classifier has an AUC score of <strong class="source-inline">1</strong>. This means that FPR, or <em class="italic">1 – specificity</em>, is <strong class="source-inline">0</strong>. That is, there is no false positive, and all negative cases are not predicted as positive. In addition, the sensitivity, or TPR, is <strong class="source-inline">1</strong>, meaning all positive cases are predicted as <span class="No-Break">positive correctly.</span></p>&#13;
			<p><span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.12</em> illustrates three different AUC curves. The topmost curve (in green) corresponds to a better model due to the highest AUC. Both models, represented by the green and red curves, perform better than random guessing, as indicated by the straight off-diagonal line <span class="No-Break">in blue.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer237" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_012.jpg" alt="Figure 13.12 – Illustrating three different AUC curves" width="952" height="792"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.12 – Illustrating three different AUC curves</p>&#13;
			<p>Continuing<a id="_idIndexMarker1281"/> the previous exercise, we can now calculate the corresponding evaluation metrics. First, we use the trained logistic regression model to score all observations in the training set and obtain the corresponding probabilities using the <strong class="source-inline">predict()</strong> function and setting <strong class="source-inline">type="response"</strong>, as shown in the following code snippet. Note that we need to pass in a DataFrame with the corresponding feature names as input to <span class="No-Break">the model:</span></p>&#13;
			<pre class="source-code">&#13;
# Create new data frame with all durations&#13;
new_data = data.frame(Duration = GermanCredit$Duration)&#13;
# Calculate predicted classes based on predicted probabilities&#13;
predicted_probs = predict(glm_model, new_data, type="response")</pre>			<p>Next, we set a single cutoff threshold (<strong class="source-inline">0.5</strong>, in this case) to convert the predicted probabilities into the corresponding binary outcomes using the <span class="No-Break"><strong class="source-inline">ifelse()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<pre class="source-code">&#13;
# Convert to binary outcomes&#13;
predicted_classes = ifelse(predicted_probs &gt; 0.5, 1, 0)</pre>			<p>With the binary outcomes and true target labels, we can obtain the confusion matrix <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code">&#13;
# Create confusion matrix&#13;
conf_matrix = table(predicted = predicted_classes, actual = GermanCredit$Class_num)&#13;
&gt;&gt;&gt; conf_matrix&#13;
         actual&#13;
predicted   0   1&#13;
        0 670 260&#13;
        1  30  40</pre>			<p>Here, the<a id="_idIndexMarker1282"/> confusion matrix provides a breakdown of the correct and incorrect classifications from the model. Within the confusion matrix, the top-left cell means true negatives, the top-right cell means false positives, the bottom-left cell means false negatives, and the bottom-right cell means <span class="No-Break">true positives.</span></p>&#13;
			<p>Based on the confusion matrix, we can calculate the evaluation metrics <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code">&#13;
# Accuracy&#13;
accuracy = sum(diag(conf_matrix)) / sum(conf_matrix)&#13;
&gt;&gt;&gt; print(paste("Accuracy: ", accuracy))&#13;
"Accuracy:  0.71"&#13;
# Error rate&#13;
error_rate = 1 - accuracy&#13;
&gt;&gt;&gt; print(paste("Error rate: ", error_rate))&#13;
"Error rate:  0.29"&#13;
# Precision&#13;
precision = conf_matrix[2,2] / sum(conf_matrix[2,])&#13;
print(paste("Precision: ", precision))&#13;
"Precision:  0.571428571428571"&#13;
# Recall / Sensitivity&#13;
recall = conf_matrix[2,2] / sum(conf_matrix[,2])&#13;
print(paste("Recall: ", recall))&#13;
&gt;&gt;&gt; "Recall:  0.133333333333333"&#13;
# Specificity&#13;
specificity = conf_matrix[1,1] / sum(conf_matrix[,1])&#13;
print(paste("Specificity: ", specificity))&#13;
&gt;&gt;&gt; "Specificity:  0.957142857142857"</pre>			<p>Here, we<a id="_idIndexMarker1283"/> extract the corresponding items of the confusion matrix and plug in the definitions of different evaluation metrics to complete <span class="No-Break">the calculations.</span></p>&#13;
			<p>We can also calculate the AUC, starting with calculating the ROC curve using the <span class="No-Break"><strong class="source-inline">pROC</strong></span><span class="No-Break"> package:</span></p>&#13;
			<pre class="source-code">&#13;
library(pROC)&#13;
# Calculate ROC curve&#13;
roc_obj = roc(GermanCredit$Class_num, predicted_probs)&#13;
# Plot ROC curve&#13;
&gt;&gt;&gt; plot(roc_obj)</pre>			<p>Running the code generates <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.13</em>, which suggests that the model is doing marginally better than <span class="No-Break">random guessing.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer238" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_013.jpg" alt="Figure 13.13 – Visualizing the ROC curve" width="677" height="630"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.13 – Visualizing the ROC curve</p>&#13;
			<p>To <a id="_idIndexMarker1284"/>calculate the AUC, we can call the <span class="No-Break"><strong class="source-inline">auc()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<pre class="source-code">&#13;
# Calculate AUC&#13;
auc = auc(roc_obj)&#13;
&gt;&gt;&gt; print(paste(«AUC: «, auc))&#13;
«AUC:  0.628592857142857»</pre>			<p>Note that when we have no preference for precision or recall, we can use the F1 score, defined <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable_v-normal">F</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">s</span><span class="_-----MathTools-_Math_Variable_v-normal">c</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">r</span><span class="_-----MathTools-_Math_Variable_v-normal">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-normal">P</span><span class="_-----MathTools-_Math_Variable_v-normal">r</span><span class="_-----MathTools-_Math_Variable_v-normal">e</span><span class="_-----MathTools-_Math_Variable_v-normal">c</span><span class="_-----MathTools-_Math_Variable_v-normal">i</span><span class="_-----MathTools-_Math_Variable_v-normal">s</span><span class="_-----MathTools-_Math_Variable_v-normal">i</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">n</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">×</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">R</span><span class="_-----MathTools-_Math_Variable_v-normal">e</span><span class="_-----MathTools-_Math_Variable_v-normal">c</span><span class="_-----MathTools-_Math_Variable_v-normal">a</span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base">______________</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Variable_v-normal">P</span><span class="_-----MathTools-_Math_Variable_v-normal">r</span><span class="_-----MathTools-_Math_Variable_v-normal">e</span><span class="_-----MathTools-_Math_Variable_v-normal">c</span><span class="_-----MathTools-_Math_Variable_v-normal">i</span><span class="_-----MathTools-_Math_Variable_v-normal">s</span><span class="_-----MathTools-_Math_Variable_v-normal">i</span><span class="_-----MathTools-_Math_Variable_v-normal">o</span><span class="_-----MathTools-_Math_Variable_v-normal">n</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-normal">R</span><span class="_-----MathTools-_Math_Variable_v-normal">e</span><span class="_-----MathTools-_Math_Variable_v-normal">c</span><span class="_-----MathTools-_Math_Variable_v-normal">a</span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal">l</span><span class="_-----MathTools-_Math_Variable_v-normal"> </span></p>&#13;
			<p>The next section discusses a challenging modeling situation when we have an imbalanced dataset to <span class="No-Break">begin with.</span></p>&#13;
			<h1 id="_idParaDest-283"><a id="_idTextAnchor290"/>Dealing with an imbalanced dataset</h1>&#13;
			<p>When<a id="_idIndexMarker1285"/> building a logistic regression model using a dataset whose target is a binary outcome, it could be the case that the target values are not equally distributed. This means that we would observe more non-events (<span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>) than events (<span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>), as is often the case in applications such as fraudulent transactions in banks, spam/phishing emails for corporate employees, identification of diseases such as cancer, and natural disasters such as earthquakes. In these situations, the classification performance may be dominated by the <span class="No-Break">majority class.</span></p>&#13;
			<p>Such domination can result in misleadingly high accuracy scores, which correspond to poor predictive performance. To see this, suppose we are developing a default prediction model using a dataset that consists of 1,000 observations, where only 10 (or 1%) of them are default cases. A naive model would simply predict every observation as non-default, resulting in a <span class="No-Break">99% accuracy.</span></p>&#13;
			<p>When we encounter an imbalanced dataset, we are often more interested in the minority class, which represents the outcome to be detected in a classification problem. Since the signal on the minority class is relatively weak, we would need to rely on good modeling techniques to recognize a good pattern so that the signal can be <span class="No-Break">correctly detected.</span></p>&#13;
			<p>There are multiple techniques we can use to address the challenge of an imbalanced dataset. We will introduce a popular approach called data resampling, which requires oversampling and/or undersampling of the original dataset to make the overall distribution less imbalanced. Resampling includes oversampling the minority class, undersampling the majority class, or using a combination of them, as represented by <strong class="bold">Synthetic Minority Oversampling TEchnique (SMOTE)</strong>. However, such a remedy does not<a id="_idIndexMarker1286"/> come without risk. Here, oversampling may lead to overfitting due to more samples being added to the original dataset, while undersampling may result in loss of information due to some majority observations being removed from the <span class="No-Break">original dataset.</span></p>&#13;
			<p><span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.14</em> illustrates the process of oversampling the minority class (the left panel) and undersampling the majority class (the right panel). Note that once the model is built based on the balanced dataset, we would still need to calibrate it on a new test set so that it performs well on a new real dataset <span class="No-Break">as well.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer239" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_014.jpg" alt="Figure 13.14 – Illustrating the process of oversampling the minority and undersampling the majority" width="1586" height="570"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.14 – Illustrating the process of oversampling the minority and undersampling the majority</p>&#13;
			<p>Let us go<a id="_idIndexMarker1287"/> through an exercise to understand how to perform undersampling or oversampling in a logistic <span class="No-Break">regression setting.</span></p>&#13;
			<h3>Exercise 13.3 – performing undersampling and oversampling</h3>&#13;
			<p>In this exercise, we <a id="_idIndexMarker1288"/>will create two artificial datasets based on <a id="_idIndexMarker1289"/>undersampling and oversampling. We will then assess the performance of the resulting logistic regression model using the <span class="No-Break">confusion matrix:</span></p>&#13;
			<ol>&#13;
				<li>Divide the raw dataset into training (70%) and test (<span class="No-Break">30%) sets:</span><pre class="source-code">&#13;
set.seed(2)&#13;
index = sample(1:nrow(GermanCredit), nrow(GermanCredit)*0.7)&#13;
train = GermanCredit[index, ]&#13;
test = GermanCredit[-index, ]</pre><p class="list-inset">Here, we randomly sample a set of indexes used to select observations for the training set and allocate the rest to the <span class="No-Break">test set.</span></p></li>				<li>Check the class ratio in the <span class="No-Break">training set:</span><pre class="source-code">&#13;
&gt;&gt;&gt; table(train$Class_num)&#13;
  0   1&#13;
504 196</pre><p class="list-inset">The result shows that the majority (class <strong class="source-inline">0</strong>) is more than twice the size of the minority (<span class="No-Break">class </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">).</span></p></li>				<li>Separate <a id="_idIndexMarker1290"/>the training set into a majority set and a minority set based on the <span class="No-Break">class label:</span><pre class="source-code">&#13;
# separate the minority and majority classes&#13;
table(train$Class_num)&#13;
minority_data = train[train$Class_num == 1,]&#13;
majority_data = train[train$Class_num == 0,]</pre><p class="list-inset">We will then<a id="_idIndexMarker1291"/> use these two datasets to perform undersampling <span class="No-Break">and oversampling.</span></p></li>				<li>Undersample the majority class and combine the undersampled majority class with the minority class. Check the resulting <span class="No-Break">class ratio:</span><pre class="source-code">&#13;
# undersample the majority class&#13;
undersampled_majority = majority_data[sample(1:nrow(majority_data), nrow(minority_data)),]&#13;
# combine undersampled majority class and minority class&#13;
undersampled_data = rbind(minority_data, undersampled_majority)&#13;
&gt;&gt;&gt; table(undersampled_data$Class_num)&#13;
  0   1&#13;
196 196</pre><p class="list-inset">The class ratio is balanced now. Let us perform oversampling for the <span class="No-Break">minority class.</span></p></li>				<li>Oversample <a id="_idIndexMarker1292"/>the minority class and combine the oversampled <a id="_idIndexMarker1293"/>minority class with the majority class. Check the resulting <span class="No-Break">class ratio:</span><pre class="source-code">&#13;
# oversample the minority class&#13;
oversampled_minority = minority_data[sample(1:nrow(minority_data), nrow(majority_data), replace = TRUE),]&#13;
# combine majority class and oversampled minority class&#13;
oversampled_data = rbind(majority_data, oversampled_minority)&#13;
&gt;&gt;&gt; table(oversampled_data$Class_num)&#13;
  0   1&#13;
504 504</pre></li>				<li>Fit logistic regression models on both the undersampled and <span class="No-Break">oversampled datasets:</span><pre class="source-code">&#13;
# fit logistic regression models on undersampled and oversampled data&#13;
undersampled_model = glm(Class_num ~ Duration, family = binomial(link = 'logit'), data = undersampled_data)&#13;
oversampled_model = glm(Class_num ~ Duration, family = binomial(link = 'logit'), data = oversampled_data)</pre></li>				<li>Obtain the predicted probabilities on the <span class="No-Break">test set:</span><pre class="source-code">&#13;
# get the predicted probabilities on the test set&#13;
undersampled_pred = predict(undersampled_model, newdata = test, type = "response")&#13;
oversampled_pred = predict(oversampled_model, newdata = test, type = "response")</pre></li>				<li>Apply a <a id="_idIndexMarker1294"/>threshold of <strong class="source-inline">0.5</strong> to convert the probabilities into <span class="No-Break">binary classes:</span><pre class="source-code">&#13;
# apply threshold to convert the probabilities into binary classes&#13;
undersampled_pred_class = ifelse(undersampled_pred &gt; 0.5, 1, 0)&#13;
oversampled_pred_class = ifelse(oversampled_pred &gt; 0.5, 1, 0)</pre></li>				<li>Calculate the<a id="_idIndexMarker1295"/> <span class="No-Break">confusion matrix:</span><pre class="source-code">&#13;
# calculate the confusion matrix&#13;
undersampled_cm = table(predicted = undersampled_pred_class, actual = test$Class_num)&#13;
oversampled_cm = table(predicted = oversampled_pred_class, actual = test$Class_num)&#13;
&gt;&gt;&gt; undersampled_cm&#13;
         actual&#13;
predicted   0   1&#13;
        0 117  59&#13;
        1  79  45&#13;
&gt;&gt;&gt; oversampled_cm&#13;
         actual&#13;
predicted   0   1&#13;
        0 115  59&#13;
        1  81  45</pre><p class="list-inset">The result shows that both models deliver a similar performance using the undersampled or oversampled training dataset. Again, we would use another validation <a id="_idIndexMarker1296"/>dataset, which can be taken from the original<a id="_idIndexMarker1297"/> training set, to calibrate the model parameters further so that it performs better on the <span class="No-Break">test set.</span></p></li>			</ol>&#13;
			<p>It turns out that we can also add a lasso or ridge penalty in a logistic regression model, as discussed in the <span class="No-Break">next section.</span></p>&#13;
			<h1 id="_idParaDest-284"><a id="_idTextAnchor291"/>Penalized logistic regression</h1>&#13;
			<p>As the<a id="_idIndexMarker1298"/> name suggests, a penalized logistic regression model includes an additional penalty term in the loss function of the usual logistic regression model. Recall that a standard logistic regression model seeks to minimize the negative log-likelihood function (or equivalently, maximize the log-likelihood function), defined <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">N</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Function_v-normal">log</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">p</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">i</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">)</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p>Here, <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">)</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base">)</span> is the predicted probability for input <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Base">)</span>, <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">i</span> is the corresponding target label, and <span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">…</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">}</span> are model parameters to be estimated. Note that we now express the loss as a function of the coefficient vector as it is directly determined by the set of parameters used in <span class="No-Break">the model.</span></p>&#13;
			<p>Since the penalty term aims to shrink the magnitude of the estimated coefficients, we would add it to the loss function so that the penalty terms will be relatively small (subject to a tuning hyperparameter, <span class="_-----MathTools-_Math_Variable">λ</span>). For the case of ridge penalty, we would add up the squared coefficients, resulting in the following penalized negative <span class="No-Break">log-likelihood function:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">r</span><span class="_-----MathTools-_Math_Variable">i</span><span class="_-----MathTools-_Math_Variable">d</span><span class="_-----MathTools-_Math_Variable">g</span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">λ</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">|</span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">λ</span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">j</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Variable">β</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">j</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">2</span></span></p>&#13;
			<p>Correspondingly, the penalized negative log-likelihood function using the lasso regularization term takes the <span class="No-Break">following form:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">l</span><span class="_-----MathTools-_Math_Variable">a</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">s</span><span class="_-----MathTools-_Math_Variable">o</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">λ</span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">Q</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Symbol_Extended">𝜷</span><span class="_-----MathTools-_Math_Symbol_Extended">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">λ</span><span class="_-----MathTools-_Math_Base">∑</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">j</span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Variable"> </span><span class="_-----MathTools-_Math_Base">|</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">β</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">j</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">|</span></span></p>&#13;
			<p>In both cases, the penalty term has the potential effect of shrinking the magnitude of the coefficients toward 0 relative to the original maximum likelihood estimates. This can help to prevent overfitting by controlling the complexity of the model estimation process. The tuning hyperparameter, λ, controls the amount of shrinkage. In particular, a larger λ adds more weight to the penalty term and thus leads to more shrinkage effect, while a smaller λ puts less weight on the overall magnitude of the <span class="No-Break">estimated coefficients.</span></p>&#13;
			<p>Let us illustrate the <a id="_idIndexMarker1299"/>process of development of penalized logistic regression models. The task can be achieved using the <strong class="source-inline">glmnet</strong> package, which supports both lasso and ridge penalties. In the following code snippet, we use the first nine columns as predictors to model the <span class="No-Break">binary outcome:</span></p>&#13;
			<pre class="source-code">&#13;
# Create a matrix of predictors and a response vector&#13;
# For glmnet, we need to provide our data as matrices/vectors&#13;
X = GermanCredit[1:nrow(GermanCredit), 1:9]&#13;
y = GermanCredit$Class_num&#13;
# Define an alpha value: 0 for ridge, 1 for lasso, between 0 and 1 for elastic net&#13;
alpha_value = 1 # for lasso&#13;
# Run the glmnet model&#13;
fit = glmnet(X, y, family = "binomial", alpha = alpha_value)</pre>			<p>Here, we set <strong class="source-inline">alpha=1</strong> to enable the lasso penalty. Setting <strong class="source-inline">alpha=0</strong> enables the ridge penalty, and setting alpha between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong> corresponds to the elastic <span class="No-Break">net penalty.</span></p>&#13;
			<p>Note that this procedure would evaluate a sequence of values for the <span class="_-----MathTools-_Math_Variable">λ</span> hyperparameter, giving us an idea of the level of impact on the resulting coefficients based on the penalty. In particular, we can plot out the coefficient paths, as shown in the following, indicating the resulting coefficients for different values <span class="No-Break">of </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">λ</span></span><span class="No-Break">:</span></p>&#13;
			<pre class="source-code">&#13;
# plot coefficient paths&#13;
&gt;&gt;&gt; plot(fit, xvar = "lambda", label = TRUE)</pre>			<p>Running the code generates <span class="No-Break"><em class="italic">Figure 13</em></span><em class="italic">.15</em>, which suggests that more parameters shrink <a id="_idIndexMarker1300"/>to 0 when <span class="_-----MathTools-_Math_Variable">λ</span> <span class="No-Break">gets big.</span></p>&#13;
			<div>&#13;
				<div id="_idContainer240" class="IMG---Figure">&#13;
					<img src="Images/B18680_13_015.jpg" alt="Figure 13.15 – Visualizing the coefficient paths using lasso penalized logistic regression" width="998" height="737"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.15 – Visualizing the coefficient paths using lasso penalized logistic regression</p>&#13;
			<p>The next section discusses a more general setting: the multinomial logistic regression, a model class for <span class="No-Break">multi-class classification.</span></p>&#13;
			<h1 id="_idParaDest-285"><a id="_idTextAnchor292"/>Extending to multi-class classification</h1>&#13;
			<p>Many problems <a id="_idIndexMarker1301"/>feature more than two classes. For example, the <strong class="bold">Standard and Poor's </strong>(<strong class="bold">S&amp;P</strong>) bond rating includes multiple classes, such as <strong class="source-inline">AAA</strong>, <strong class="source-inline">AA</strong>, <strong class="source-inline">A</strong>, and more like these. Corporate client accounts in a bank are categorized into good credit, past due, overdue, doubtful, or loss. Such settings require the multinomial logistic regression model, which is a generalization of the binomial logistic regression model in the multi-class classification context. Essentially, the target variable, <span class="_-----MathTools-_Math_Variable">y</span>, can take more than two possible discrete outcomes and allows for more than two <span class="No-Break">categorical values.</span></p>&#13;
			<p>Assume that the target variable can take on three values, giving <span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator_Extended">∈</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Number">0,1</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">}</span>. Let us choose class <strong class="source-inline">0</strong> as the pivot value or the baseline. We will model the odds of the probabilities of the other categories (classes <strong class="source-inline">1</strong> and <strong class="source-inline">2</strong>) relative to this baseline. In other words, we have <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">1</span></span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable">z</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">2</span></span></p>&#13;
			<p>Therefore, the<a id="_idIndexMarker1302"/> relative ratio of the predicted probabilities for each class is <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">:</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">:</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">:</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">:</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span></p>&#13;
			<p>We know <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span></p>&#13;
			<p>So we have <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p><span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">e</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p>Again, one of the main assumptions in a multinomial logistic regression model is that the log odds consist of a linear combination of the predictor variables. This is the same assumption as in binary logistic regression. The corresponding interpretation of the coefficients in a multinomial logistic regression will also change slightly. In particular, each coefficient now represents the change in the log odds of the corresponding category relative to the baseline category for a one-unit change in the corresponding predictor variable, while holding all other <span class="No-Break">predictors constant.</span></p>&#13;
			<p>We can rely on the <strong class="source-inline">multinom()</strong> function from the <strong class="source-inline">nnet</strong> package to create a multinomial logistic regression model. In the following code snippet, we use the previous <strong class="source-inline">mtcars</strong> dataset and convert the <strong class="source-inline">gear</strong> variable into a factor, which will serve as the <span class="No-Break">target variable:</span></p>&#13;
			<pre class="source-code">&#13;
library(nnet)&#13;
# convert gear to factor&#13;
mtcars$gear = as.factor(mtcars$gear)&#13;
&gt;&gt;&gt; table(mtcars$gear)&#13;
3  4  5&#13;
15 12  5</pre>			<p>The<a id="_idIndexMarker1303"/> frequency count shows a total of three categories in the variable. Next, we use <strong class="source-inline">mpg</strong>, <strong class="source-inline">hp</strong>, and <strong class="source-inline">disp</strong> to predict <strong class="source-inline">gear</strong> in a multinomial logistic <span class="No-Break">regression model:</span></p>&#13;
			<pre class="source-code">&#13;
# fit the model&#13;
multinom_model = multinom(gear ~ mpg + hp + disp, data = mtcars)&#13;
# weights:  15 (8 variable)&#13;
initial  value 35.155593&#13;
iter  10 value 10.945783&#13;
iter  20 value 9.011992&#13;
iter  30 value 8.827997&#13;
iter  40 value 8.805003&#13;
iter  50 value 8.759821&#13;
iter  60 value 8.742738&#13;
iter  70 value 8.737492&#13;
iter  80 value 8.736569&#13;
final  value 8.735812&#13;
converged</pre>			<p>The output message suggests that we have a total of eight variables in the model. This makes sense since we have four variables (<strong class="source-inline">intercept</strong>, <strong class="source-inline">mpg</strong>, <strong class="source-inline">hp</strong>, and <strong class="source-inline">disp</strong>) to model the difference between four-gear and three-gear cars in one submodel, and another four variables to model the difference between five-gear and three-gear cars in <span class="No-Break">another submodel.</span></p>&#13;
			<p>Let us view the summary of <span class="No-Break">the model:</span></p>&#13;
			<pre class="source-code">&#13;
# view summary of the model&#13;
&gt;&gt;&gt; summary(multinom_model)&#13;
Call:&#13;
multinom(formula = gear ~ mpg + hp + disp, data = mtcars)&#13;
Coefficients:&#13;
  (Intercept)       mpg         hp        disp&#13;
4   0.3892548 0.2707320 0.02227133 -0.04428756&#13;
5 -17.6837050 0.6115097 0.15511207 -0.08815984&#13;
Std. Errors:&#13;
  (Intercept)       mpg         hp       disp&#13;
4    17.30456 0.5917790 0.05813736 0.02735148&#13;
5    15.46373 0.5754793 0.08651377 0.06060359&#13;
Residual Deviance: 17.47162&#13;
AIC: 33.47162</pre>			<p>As expected, the<a id="_idIndexMarker1304"/> summary includes two sets of coefficients for the two submodels (indexed by <strong class="source-inline">4</strong> and <span class="No-Break"><strong class="source-inline">5</strong></span><span class="No-Break">, respectively).</span></p>&#13;
			<p>Lastly, let us make predictions using the multinomial logistic regression model and calculate the <span class="No-Break">confusion matrix:</span></p>&#13;
			<pre class="source-code">&#13;
# make prediction&#13;
predicted_gears = predict(multinom_model, newdata = mtcars)&#13;
# view the confusion matrix&#13;
&gt;&gt;&gt; table(Predicted = predicted_gears, Actual = mtcars$gear)&#13;
         Actual&#13;
Predicted  3  4  5&#13;
        3 14  0  0&#13;
        4  1 12  1&#13;
        5  0  0  4</pre>			<p>The<a id="_idIndexMarker1305"/> result suggests a decent classification performance with only <span class="No-Break">two misclassifications.</span></p>&#13;
			<h1 id="_idParaDest-286"><a id="_idTextAnchor293"/>Summary</h1>&#13;
			<p>In this chapter, we delved into the world of logistic regression, its theoretical underpinnings, and its practical applications. We started by exploring the fundamental construct of logistic regression and its comparison with linear regression. We then introduced the concept of the sigmoid transformation, a crucial element in logistic regression, which ensures the output of our model is bounded between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>. This section helped us better understand the advantages of logistic regression for binary <span class="No-Break">classification tasks.</span></p>&#13;
			<p>Next, we delved into the concept of log odds and odds ratio, two critical components of the logistic regression model. Understanding these allowed us to comprehend the real-world implications of the model’s predictions and to interpret its parameters effectively. The chapter then introduced the CEL, the cost function used in logistic regression. Specifically, we discussed how this loss function ensures our model learns to predict accurate probabilities for the <span class="No-Break">binary classes.</span></p>&#13;
			<p>When it comes to evaluating a logistic regression, we learned about various metrics, including accuracy, error rate, precision, recall, sensitivity, specificity, and AUC. This understanding will allow us to assess the performance of our logistic regression <span class="No-Break">model accurately.</span></p>&#13;
			<p>An important discussion revolved around the handling of imbalanced datasets, a common scenario in real-world data. We understood the effects of data imbalance on our model and learned about strategies, such as resampling techniques, to handle such situations effectively. Further, we discussed penalized logistic regression where we incorporate L1 (lasso) or L2 (ridge) regularization into our logistic regression model. This penalization technique helps us prevent overfitting by keeping the magnitude of the model weights small and creating simpler models when dealing with <span class="No-Break">high-dimensional data.</span></p>&#13;
			<p>Finally, we touched upon multinomial logistic regression, an extension of logistic regression used for multi-class classification problems. This part provided insight into handling situations where the target variable consists of more than <span class="No-Break">two classes.</span></p>&#13;
			<p>At the end of this chapter, we gained an extensive understanding of logistic regression, its implementation, and its nuances. This knowledge lays the groundwork for diving deeper into more complex classification methods <span class="No-Break">and strategies.</span></p>&#13;
			<p>In the next chapter, we will cover Bayesian statistics, another major branch of <span class="No-Break">statistical modeling.</span></p>&#13;
		</div>&#13;
	</div></body></html>