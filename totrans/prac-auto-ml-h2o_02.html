<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer067">
<h1 class="chapter-number" id="_idParaDest-33"><a id="_idTextAnchor038"/>2</h1>
<h1 id="_idParaDest-34"><a id="_idTextAnchor039"/>Working with H2O Flow (H2O’s Web UI)</h1>
<p><strong class="bold">Machine Learning</strong> (<strong class="bold">ML</strong>) is more than just code. It involves<a id="_idIndexMarker101"/> tons of observations from different perspectives. As powerful as actual coding is, a lot of information gets hidden away behind the Terminal on which you code. Humans have always understood pictures more easily than words. Similarly, as complex as ML is, it can be very easy and fun<a id="_idIndexMarker102"/> to implement with the help of interactive <strong class="bold">User Interfaces</strong> (<strong class="bold">UIs</strong>). Working with a colorful UI over the dull black and white pixelated Terminal is always a plus when learning about difficult topics.</p>
<p><strong class="bold">H2O Flow</strong> is a web-based UI developed by the H2O.ai team. This<a id="_idIndexMarker103"/> interface works on the same backend that we learned about in <a href="B17298_01.xhtml#_idTextAnchor017"><em class="italic">Chapter 1</em></a>, <em class="italic">Understanding H2O AutoML Basics</em>. It is simply a web UI wrapped over the main H2O library, which passes inputs and triggers functions on the backend server and reads the results by displaying them back to the user.</p>
<p>In this chapter, we will learn how to work with H2O Flow. We will perform all the typical steps of the ML pipeline, which we learned about in the <em class="italic">Understanding AutoML and H2O AutoML</em> section of <a href="B17298_01.xhtml#_idTextAnchor017"><em class="italic">Chapter 1</em></a>, <em class="italic">Understanding H2O AutoML Basics</em>, from reading datasets to making predictions using the trained models. Also, we will explore a few metrics and model details to help us ease into more advanced topics later. This chapter is hands-on, and we will learn about the various parts of H2O Flow as we create our ML pipeline.</p>
<p>By the end of this chapter, you will be able to navigate and use the various features of H2O Flow. Additionally, you will be able to train your ML models and use them for predictions without needing to write a single line of code using H2O Flow. </p>
<p>In this chapter, we are going to cover the following topics:</p>
<ul>
<li>Understanding the basics of H2O Flow</li>
<li>Working with data functions in H2O Flow</li>
<li>Working with model training functions in H2O Flow</li>
<li>Working with prediction functions in H2O Flow</li>
</ul>
<h1 id="_idParaDest-35"><a id="_idTextAnchor040"/>Technical requirements</h1>
<p>You will require the following:</p>
<ul>
<li>A decent web browser (Chrome, Firefox, or Edge), the latest version of your preferred web browser.</li>
</ul>
<h1 id="_idParaDest-36"><a id="_idTextAnchor041"/>Understanding the basics of H2O Flow</h1>
<p>H2O Flow is an open source web interface<a id="_idIndexMarker104"/> that helps users execute code, plot graphs, and display<a id="_idIndexMarker105"/> dataframes on a single page called a <strong class="bold">Flow notebook</strong> or just <strong class="bold">Flow</strong>.</p>
<p>Users of Jupyter notebooks will find H2O Flow very similar. You write your executable code in cells, and the output of the code is displayed below it when you execute the cell. Then, the cursor moves on to the next cell. The best thing about a Flow is that it can be easily saved, exported, and imported between various users. This helps a lot of data scientists share results among various stakeholders, as they just need to save the execution results and share the flow.</p>
<p>In the following sub-sections, we will gain an understanding of the basics of H2O Flow. Let’s begin our journey with H2O Flow by, first, downloading it to our system.</p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor042"/>Downloading and launching H2O Flow</h2>
<p>In order to run H2O Flow, you will <a id="_idIndexMarker106"/>need to first download<a id="_idIndexMarker107"/> the H2O Flow <strong class="bold">Java Archive</strong> (<strong class="bold">JAR</strong>) file onto your system, and then run<a id="_idIndexMarker108"/> the JAR file once it has been downloaded.</p>
<p>You can download and launch H2O Flow using the following steps:</p>
<ol>
<li>You can download<a id="_idIndexMarker109"/> H2O Flow at <a href="https://h2o-release.s3.amazonaws.com/h2o/master/latest.xhtml">https://h2o-release.s3.amazonaws.com/h2o/master/latest.xhtml</a>.</li>
<li>Once the ZIP file has been downloaded, open a Terminal and run the following commands in the folder where you downloaded the ZIP file:<p class="source-code"><strong class="bold">unzip {name_of_the_h2o_zip_file}</strong></p></li>
<li>To run H2O Flow, run the following command inside the folder of your recently unzipped <strong class="source-inline">h2o</strong> file:<p class="source-code"><strong class="bold">java -jar h2o.jar</strong></p></li>
</ol>
<p>This will start an H2O Web UI on <a href="http://localhost:54321">http://localhost:54321</a>. </p>
<p>Now that we have downloaded<a id="_idIndexMarker110"/> and launched H2O Flow, let’s briefly explore it to get<a id="_idIndexMarker111"/> an understanding of what functionalities it has to offer.</p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor043"/>Exploring H2O Flow</h2>
<p>H2O Flow is a very feature-intensive<a id="_idIndexMarker112"/> application. It has almost all the features you will need to create your ML pipeline. Considering the various steps involved in an ML pipeline, H2O Flow provides plenty of functionality for all of these steps. This can be overwhelming for a lot of people. Therefore, it is worthwhile exploring the application and focusing on specific parts of the application one at a time.</p>
<p>In the following sections, we will learn about all of these parts in detail; however, some functions might be too complex to understand at this stage. We will understand them better in the upcoming chapters. For the time being, we will focus on getting an overview of how we can use H2O Flow to create our ML pipeline.</p>
<p>So, let’s begin with the exploration by, first, launching H2O Flow and opening your web browser at the <a href="http://localhost:54321">http://localhost:54321</a> URL.</p>
<p>The following screenshot shows you the main page of the H2O Flow UI: </p>
<div>
<div class="IMG---Figure" id="_idContainer019">
<img alt="Figure 2.1 – The main page of the H2O Flow UI " height="913" src="image/B17298_02_001.jpg" width="1634"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – The main page of the H2O Flow UI</p>
<p>Don’t be alarmed if you see something<a id="_idIndexMarker113"/> slightly different. This might be because the version you installed might be different from the one shown in this book. Nevertheless, the basic setup of the UI should be similar. As you can see, there are plenty of interactive options to choose from. This can be a little overwhelming at first, so let’s take it piece by piece.</p>
<p>At the very top of the web page, there are various ML object operations, each with its own drop-down list of functions. They are as follows:</p>
<ul>
<li><strong class="bold">Flow</strong>: This section contains all operations related to the Flow notebook.</li>
<li><strong class="bold">Cell</strong>: This section contains all operations related to the individual cells in the notebook.</li>
<li><strong class="bold">Data</strong>: This section contains all operations related to data manipulations.</li>
<li><strong class="bold">Model</strong>: This section contains all operations related to model training and algorithms.</li>
<li><strong class="bold">Score</strong>: This section contains all operations related to scoring and making predictions.</li>
<li><strong class="bold">Admin</strong>: This section contains all administrative operations such as downloading logs.</li>
<li><strong class="bold">Help</strong>: This section contains all links to H2O documentation for additional details.</li>
</ul>
<p>We will go through<a id="_idIndexMarker114"/> them in greater detail, step by step, once we start creating our ML pipeline later.</p>
<p>The following screenshot shows you the various ML function operations of the H2O Flow UI:</p>
<div>
<div class="IMG---Figure" id="_idContainer020">
<img alt="Figure 2.2 – The ML object operation toolbar " height="83" src="image/B17298_02_002.jpg" width="1337"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – The ML object operation toolbar</p>
<p>Following this, we have the <strong class="bold">Flow Name</strong> and <strong class="bold">Flow Toolbar</strong> settings. By default, the flow name will be <strong class="bold">Untitled Flow</strong>. The flow name helps identify the whole flow in general so that you do not mix the different experiments. The <strong class="bold">Flow Toolbar</strong> section is a simple toolbar that helps you with basic operations such as editing and managing the cells in your flow. </p>
<p>The following screenshot shows you the flow toolbar that is present on the main page:</p>
<div>
<div class="IMG---Figure" id="_idContainer021">
<img alt="Figure 2.3 – The Flow Name and flow toolbar sections " height="138" src="image/B17298_02_003.jpg" width="1149"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – The Flow Name and flow toolbar sections</p>
<p><strong class="bold">Cells</strong> are lines of code executions that you can<a id="_idIndexMarker115"/> perform one by one. They can also be used to make comments, headings, and even Markdown text.</p>
<p>The tools are listed as follows. We will start from left to right:</p>
<ul>
<li><strong class="bold">New</strong>: This creates a new Flow notebook.</li>
<li><strong class="bold">Open</strong>: This opens an existing Flow notebook that is stored in your system.</li>
<li><strong class="bold">Save</strong>: This saves your current flow.</li>
<li><strong class="bold">Insert Cell</strong>: This inserts a cell below.</li>
<li><strong class="bold">Move up</strong>: This moves the currently highlighted cell up over the above cell.</li>
<li><strong class="bold">Move down</strong>: This moves the currently highlighted cell to below the cell under it.</li>
<li><strong class="bold">Cut</strong>: This cuts the cell and stores it on the clipboard.</li>
<li><strong class="bold">Copy</strong>: This copies the currently highlighted cell.</li>
<li><strong class="bold">Paste</strong>: This pastes the previously copied cell below the currently highlighted cell.</li>
<li><strong class="bold">Clear Cell</strong>: This clears the output of the cell if there is any.</li>
<li><strong class="bold">Delete Cell</strong>: This deletes the cell entirely.</li>
<li><strong class="bold">Run and Select below</strong>: This runs the currently highlighted cell and stops at the cell below.</li>
<li><strong class="bold">Run</strong>: This runs the currently highlighted cell.</li>
<li><strong class="bold">Run all</strong>: This runs all the cells from top to bottom one by one.</li>
<li><strong class="bold">Assist me</strong>: This executes an assist command that helps you by showing links to basic ML commands.</li>
</ul>
<p>On the right-hand side of your flow<a id="_idIndexMarker116"/> are additional support options to help you manage your workflow. You have <strong class="bold">OUTLINE</strong>, <strong class="bold">FLOW</strong>, <strong class="bold">CLIPS</strong>, and <strong class="bold">HELP</strong>. Each option has its own column with functional details.</p>
<p>The following screenshot shows you the various support options of the H2O Flow UI:</p>
<div>
<div class="IMG---Figure" id="_idContainer022">
<img alt="Figure 2.4 – Support options " height="57" src="image/B17298_02_004.jpg" width="571"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Support options</p>
<p>The <strong class="bold">OUTLINE</strong> column shows you a list of all the executions you performed. Looking at the outline helps you to quickly check whether all the steps you performed when creating your ML pipeline were in the correct sequence, whether there were any duplicates, or whether any incorrect steps were made.</p>
<p>The following screenshot shows you the <strong class="bold">OUTLINE</strong> support option section:</p>
<div>
<div class="IMG---Figure" id="_idContainer023">
<img alt="Figure 2.5 – OUTLINE " height="160" src="image/B17298_02_005.jpg" width="409"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – OUTLINE</p>
<p>The <strong class="bold">FLOW</strong> column shows<a id="_idIndexMarker117"/> you all your previously saved flows. At the moment, you won’t have any, but once you do save a flow, it will show up here with a quick link to open it. Please note that only one Flow notebook can be opened at a time on the H2O Flow page. If you want to work on multiple flows simultaneously, you can do so by opening another tab and opening the Flow notebook there.</p>
<p>The following screenshot shows you the <strong class="bold">FLOWS</strong> support option section: </p>
<div>
<div class="IMG---Figure" id="_idContainer024">
<img alt="Figure 2.6 – Saved flows " height="256" src="image/B17298_02_006.jpg" width="359"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – Saved flows</p>
<p>The <strong class="bold">CLIPS</strong> column is your clipboard. If there is any code to be executed that you will be running multiple times in your flow, then you can write it once and save it to your clipboard by selecting the paper clip icon on the right-hand side of your cell. Then, you can paste that cell whenever you need it again without needing to search for it in your flow. The clipboard also stores a set number of trash cells.</p>
<p>The following screenshot shows you the <strong class="bold">CLIPS</strong> support option section: </p>
<div>
<div class="IMG---Figure" id="_idContainer025">
<img alt="Figure 2.7 – Clipboard " height="711" src="image/B17298_02_007.jpg" width="359"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Clipboard</p>
<p>The <strong class="bold">HELP</strong> column shows you various<a id="_idIndexMarker118"/> resources to help the user use H2O Flow. This involves QuickStart videos, example flows, general usage examples, and links to the official documentation. Feel free to explore these to gain an understanding of how you can use H2O Flow.</p>
<p>The following screenshot shows you the <strong class="bold">Help</strong> support option section:</p>
<div>
<div class="IMG---Figure" id="_idContainer026">
<img alt="Figure 2.8 – The Help section " height="704" src="image/B17298_02_008.jpg" width="314"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – The Help section</p>
<p>Back to the top of the page, let’s explore<a id="_idIndexMarker119"/> the first two drop-down lists. They are simple enough to understand.</p>
<p>The following screenshot shows you the first drop-down list of operations, that is, the Flow object operations:</p>
<div>
<div class="IMG---Figure" id="_idContainer027">
<img alt="Figure 2.9 – The Flow functions drop-down list " height="637" src="image/B17298_02_009.jpg" width="362"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – The Flow functions drop-down list</p>
<p>The <strong class="bold">Flow</strong> drop-down list of operations has basic functionality in terms of the Flow notebook in general. You can create<a id="_idIndexMarker120"/> a new flow, open an existing one, save, copy, run all of the cells in the flow, clear the outputs, and download flows. Downloading flows is very useful, as you can easily transfer your ML work from the flows to other systems.</p>
<p>On the right-hand side is the <strong class="bold">Cell</strong> object operation drop-down list (as shown in <em class="italic">Figure 2.10</em>). This drop-down list is also simple to understand. It has basic functionality to manipulate the various cells in the flow. Usually, it targets the highlighted cell in the Flow notebook. You can change the highlighted cell by just clicking on it:</p>
<div>
<div class="IMG---Figure" id="_idContainer028">
<img alt="Figure 2.10 – The Cell functions drop-down list " height="534" src="image/B17298_02_010.jpg" width="239"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – The Cell functions drop-down list</p>
<p>We will explore the other options as we start working on our ML pipeline.</p>
<p>In this section, we understood what H2O Flow is, how to download it, and how to launch it locally. Additionally, we explored <a id="_idIndexMarker121"/>the various parts of the H2O Flow UI and the various functionalities it has to offer. Now that we are familiar with our environment, let’s dive in deeper and create our ML pipeline. We will start with the very first part of the pipeline, that is, hand<a id="_idTextAnchor044"/><a id="_idTextAnchor045"/>ling data.</p>
<h1 id="_idParaDest-39"><a id="_idTextAnchor046"/>Working with data functions in H2O Flow</h1>
<p>An ML pipeline always<a id="_idIndexMarker122"/> starts with data. The amount of data you collect and the quality<a id="_idIndexMarker123"/> of that data play a very crucial role when training models of the highest quality. If one part of the data has no relationship with another part of the data, or if there is a lot of noisy data that does not contribute to the said relationship, the quality of the model will degrade accordingly. Therefore, before training any models, often, we perform several processes on the data before sending it to model training. H2O Flow provides interfaces for all of these processes in its <strong class="bold">Data</strong> operation drop-down list.</p>
<p>We will understand the various data operations and what the output looks like in a step-by-step process as we build our ML pipeline using H2O Flow.</p>
<p>So, let’s begin creating our ML pipeline by, first, importing a dataset.</p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor047"/>Importing the dataset</h2>
<p>The dataset we will be working<a id="_idIndexMarker124"/> with in this chapter will be the <strong class="source-inline">Heart Failure Prediction</strong> dataset. You can find the details of the Heart Failure Prediction dataset at <a href="https://www.kaggle.com/fedesoriano/heart-failure-prediction">https://www.kaggle.com/fedesoriano/heart-failure-prediction</a>.</p>
<p>This is a dataset that contains certain health information about individuals with cholesterol, maximum heart rate, chest pain, and other attributes that are important indicators of whether a person is likely to experience heart failure or not. </p>
<p>Let’s understand the contents of the dataset:</p>
<ul>
<li><strong class="bold">Age</strong>: The age of the patient in years</li>
<li><strong class="bold">Sex</strong>: The sex of the patient; M for male and F for female</li>
<li><strong class="bold">ChestPainType</strong>: <ul><li>The types are listed as follows:<ul><li><strong class="bold">TA</strong>: Typical Angina</li><li><strong class="bold">ATA</strong>: Atypical Angina</li><li><strong class="bold">NAP</strong>: Non-Anginal Pain </li><li><strong class="bold">ASY</strong>: Asymptomatic</li></ul></li></ul></li>
<li><strong class="bold">RestingBP</strong>: Resting blood pressure in [mm Hg]</li>
<li><strong class="bold">Cholesterol</strong>: Serum cholesterol in [mm/dl]</li>
<li><strong class="bold">FastingBS</strong>: Fasting blood sugar, where it is 1 if FastingBS is greater than 120 mg/dl, else it is 0</li>
<li><strong class="bold">RestingECG</strong>: Resting electrocardiogram results<ul><li>The types are listed as follows:<ul><li><strong class="bold">Normal</strong>: Normal</li><li><strong class="bold">ST</strong>: Having ST-T wave abnormality</li><li><strong class="bold">LVH</strong>: Showing probable or definite left ventricular hypertrophy by Estes’ criteria</li></ul></li></ul></li>
<li><strong class="bold">MaxHR</strong>: The maximum heart rate achieved value, lying between 60 and 202</li>
<li><strong class="bold">ExerciseAngina</strong>: Exercise-induced angina; Y for yes, and N for no</li>
<li><strong class="bold">Oldpeak</strong>: ST (Numeric value measured in depression)</li>
<li><strong class="bold">ST_Slope</strong>: The slope of the peak exercise ST segment <ul><li>The types are as follows:<ul><li><strong class="bold">Up</strong>: Sloping upward</li><li><strong class="bold">Flat</strong>: Flat</li><li><strong class="bold">Down</strong>: Sloping downward</li></ul></li></ul></li>
<li><strong class="bold">HeartDisease</strong>: The output class, where 1 indicates heart disease and 0 indicates no heart disease</li>
</ul>
<p>We will train a model that tries<a id="_idIndexMarker125"/> to predict whether a person with certain attributes has the potential to face heart failure or not by using this dataset. Perform the following steps:</p>
<ol>
<li value="1">First, let’s start by importing this dataset using H2O Flow.</li>
<li>On the topmost part of the web UI, you can see the <strong class="bold">Data</strong> object operations drop-down list. </li>
<li>Click on it, and the web UI should display an output that looks like the following screenshot:</li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer029">
<img alt="Figure 2.11 – The Data object drop-down list " height="448" src="image/B17298_02_011.jpg" width="347"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – The Data object drop-down list</p>
<p>The drop-down list shows<a id="_idIndexMarker126"/> you a list of all the various operations that you can perform, along with those that are related to the data you will be working with.</p>
<p>The functions are listed as follows:</p>
<ul>
<li><strong class="bold">Import Files</strong>: This operation imports files stored in your system. They can be any readable files edited in <strong class="bold">Comma-Separated Values</strong> (<strong class="bold">CSV</strong>) format or Excel format.</li>
<li><strong class="bold">Import SQL Table</strong>: This operation lets you import the data stored in your<strong class="bold"> Structured Query Language</strong> (<strong class="bold">SQL</strong>) table if you are using an SQL database<a id="_idIndexMarker127"/> to store any tabular data. When you click on it, you will be prompted to input the <strong class="bold">Connection URL</strong> value to your SQL database, along with its credentials, the <strong class="bold">Table</strong> name, the <strong class="bold">Columns</strong> name, and an option to select <strong class="bold">Fetch mode</strong>, which could be <strong class="bold">DISTRIBUTED</strong> or <strong class="bold">SINGLE</strong>, as shown in the following screenshot:</li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer030">
<img alt="Figure 2.12 – Import SQL Table " height="354" src="image/B17298_02_012.jpg" width="763"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – Import SQL Table</p>
<ul>
<li><strong class="bold">Upload File</strong>: This operation uploads a single file<a id="_idIndexMarker128"/> from your system and parses it immediately.</li>
<li><strong class="bold">Split Frame</strong>: This operation splits the dataframe that has already been imported and parsed by H2O Flow into multiple frames, which you can use for multiple experiments.</li>
<li><strong class="bold">Merge Frames</strong>: This operation merges multiple frames into one. When you click on it, you will be prompted to select the right and left frames and their respective columns. Additionally, you have the flexibility to select which rows from which frame to include in the merge, as shown in the following screenshot: </li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer031">
<img alt="Figure 2.13 – Merge Frames " height="372" src="image/B17298_02_013.jpg" width="476"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Merge Frames</p>
<ul>
<li><strong class="bold">List frames</strong>: This operation lists all the frames that are currently imported and parsed by H2O. This helps if you want to run your pipeline on different datasets that were previously imported or stitched by you.</li>
<li><strong class="bold">Impute</strong>: Imputation is the process of replacing a missing value in the dataset with an average value such that it does not introduce any bias with a minimized value, a maximized value, or even an empty value. This operation lets you replace these values in your frame depending on your preference.</li>
</ul>
<p>So, first, let’s import the <strong class="source-inline">Heart Failure Prediction</strong> dataset. </p>
<p>Perform<a id="_idIndexMarker129"/> the following steps:</p>
<ol>
<li value="1">Click on the <strong class="bold">Data</strong> operation drop-down list.</li>
<li>Click on <strong class="bold">Import Files…</strong>. You should see an operation executed on a cell in your flow, as shown in the following screenshot:</li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer032">
<img alt="Figure 2.14 – Import Files " height="220" src="image/B17298_02_014.jpg" width="536"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Import Files</p>
<p>You can also directly run the same command by typing <strong class="source-inline">importFiles</strong> into a cell and pressing <em class="italic">Shift</em> + <em class="italic">Enter</em> instead of using the drop-down list.</p>
<ol>
<li value="3">In the search bar, add the location of the folder in which you have downloaded the dataset. </li>
<li>Click on the search button on the extreme right-hand side. This will show you all the files in the folder, and you can select which ones to import.</li>
<li>Select the <strong class="source-inline">heart.csv</strong> dataset, as shown in the following screenshot:</li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer033">
<img alt="Figure 2.15 – Importing files with inputs " height="313" src="image/B17298_02_015.jpg" width="850"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Importing files with inputs</p>
<ol>
<li value="6">Once you have selected the file, click on the <strong class="bold">Import</strong> button. H2O will then import the dataset and show you an output, as follows:</li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer034">
<img alt="Figure 2.16 – The imported files  " height="196" src="image/B17298_02_016.jpg" width="1000"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – The imported files </p>
<p>Congratulations! You have now successfully<a id="_idIndexMarker130"/> imported your dataset into H2O Flow. The next step is to parse it into a logical format. Let’s understand what parsing and is how we can do it in H2O Flow.</p>
<h2 id="_idParaDest-41"><a id="_idTextAnchor048"/>Parsing the dataset</h2>
<p><strong class="bold">Parsing</strong> is the process of analyzing the string of information<a id="_idIndexMarker131"/> in a dataset and loading it into a logical<a id="_idIndexMarker132"/> format, in this case, a <strong class="bold">hex</strong> file. A hex file is a file whose<a id="_idIndexMarker133"/> contents are stored in a hexadecimal format. H2O uses this file type internally for dataframe manipulations and maintains the metadata of the dataset. </p>
<p>Let’s parse the newly imported dataset by executing the following steps:</p>
<ol>
<li value="1">Click on the <strong class="bold">Parse these files…</strong> button after importing the dataset, as shown in <em class="italic">Figure 2.16</em>. </li>
</ol>
<p>The following screenshot shows the output you should expect: </p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<img alt="Figure 2.17 – The dataset parsing inputs " height="443" src="image/B17298_02_017.jpg" width="1245"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – The dataset parsing inputs</p>
<ol>
<li value="2">Then, you will be prompted to input the <strong class="bold">PARSE CONFIFUGRATION</strong> settings to parse the dataset. H2O <a id="_idIndexMarker134"/>will read the dataset using these configurations and create a <strong class="source-inline">hex</strong> file. During parsing, you have the following configurations to select from:<ul><li><strong class="bold">Sources</strong>: This configuration denotes the source of the dataset you will be parsing.</li><li><strong class="bold">ID</strong>: This configuration indicates the ID of the dataset. You can change the ID of the hex file that will be created.</li><li><strong class="bold">Parser</strong>: This configuration sets the parser to use for parsing your dataset. You will be using different parsers to parse different types of datasets. For example, if you are parsing a Parquet file, then you will need to select the Parquet file parser. In our case, we are parsing a CSV file; hence, select the <strong class="bold">CSV</strong> parser. You can set it to <strong class="bold">AUTO</strong> too, and H2O will self-identify which parser will be needed to parse the specified file.</li><li><strong class="bold">Separator</strong>: This configuration is used to specify the separator that separates the values in the dataset. Let’s leave it at the default value, <strong class="bold">,:’004’</strong>, which is a very commonly found CSV separator value.</li><li><strong class="bold">Escape Character</strong>: This configuration is used to specify the escape character that is used in the dataset. Let’s leave it at the default value.</li><li><strong class="bold">Column Headers</strong>: This configuration is used to specify whether the first row of the dataset contains column names or not. H2O will use this information to handle the first<a id="_idIndexMarker135"/> row to either use it as column information or autogenerate column names and use the first row as data values. Additionally, you can set the value to <strong class="bold">Auto</strong> to let H2O self-identify whether the first row of the dataset contains column names or not. Our dataset has the first row as column names, so let’s select <strong class="bold">First row contains column names</strong>. </li><li><strong class="bold">Options</strong>: This configuration contains additional operations as follows:<ul><li><strong class="bold">Enable single quotes as a field quotation character</strong>: This option enables single quotes as a field quotation character.</li><li><strong class="bold">Delete on done</strong>: This option deletes the imported dataset once it has been successfully parsed. Let’s tick mark this option, as we won’t be needing the imported dataset once we successfully parse it.</li></ul></li></ul></li>
<li>Below the <strong class="bold">PARSE CONFIGURATION</strong> section, you have the <strong class="bold">Edit Column names and Types</strong> section (see <em class="italic">Figure 2.18</em>). Before parsing the dataset, H2O reads the dataset and shows you a brief summary of the column names and the types of information they extracted. This gives you the option of editing your column names and types in case it has interpreted something incorrectly or if you wish to change the column names to something different.</li>
</ol>
<p>The following screenshot shows you the column names and the option to edit their type when parsing the dataset:</p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<img alt="Figure 2.18 – Editing the column types " height="479" src="image/B17298_02_018.jpg" width="1238"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – Editing the column types</p>
<p>Now, let’s briefly understand<a id="_idIndexMarker136"/> the types of the columns, as shown in the preceding screenshot: </p>
<p>They can be listed as follows:</p>
<ul>
<li><strong class="bold">Numeric</strong>: This indicates that the values in the column are numbers. </li>
<li><strong class="bold">Enum</strong>: This indicates that the values in the column are <strong class="bold">Enumerated Types</strong> (<strong class="bold">Enums</strong>). Enums are a certain set of named<a id="_idIndexMarker137"/> values that are non-numeric and finite in nature.</li>
<li><strong class="bold">Time</strong>: This indicates that the values in the column are datetime data type values.</li>
<li><strong class="bold">UUID</strong>: This indicates that<a id="_idIndexMarker138"/> the values in the column are <strong class="bold">Universally Unique Identifiers</strong> (<strong class="bold">UUIDs</strong>).</li>
<li><strong class="bold">String</strong>: This indicates that the values in the column are string values.</li>
<li><strong class="bold">Invalid</strong>: This indicates that the values in the column are invalid, which means that there are some issues with the values in the column.</li>
<li><strong class="bold">Unknown</strong>: This indicates that the values in the column are unknown, which means that the column contains no values.</li>
</ul>
<p>During training, H2O treats the columns of the dataframe differently depending on their type. Sometimes, it misinterprets<a id="_idIndexMarker139"/> the values of the columns and assigns an incorrect column type to a column. Take a look at the columns of the datasets and their corresponding types. You might notice that after importing the dataset, the type of our <strong class="bold">HeartDisease</strong> output column is <strong class="bold">Numeric</strong>. H2O read the 1 and 0 and assumed its type was Numeric. But it is, in fact, an <strong class="bold">Enum</strong> value, as 1 indicates heart disease, and 0 indicates no heart disease. There is no numerical value in between. We always need to be careful when parsing datasets. We need to ensure that H2O interprets the dataset correctly before we start training models on it. H2O Flow provides an easy way to correct this before parsing. </p>
<p>Next, let’s correct the column types:</p>
<ol>
<li value="1">Select the drop-down list next to the <strong class="bold">HeartDisease</strong> column name and set it to <strong class="bold">Enum</strong>.</li>
<li>Similarly, <strong class="bold">FastingBS</strong> will be set as <strong class="bold">Numeric</strong>, but it is, in fact, an <strong class="bold">Enum</strong> value based on its description. So, let’s set it to <strong class="bold">Enum</strong>.</li>
<li>Now that we have corrected the column types and have selected the correct parsing configurations, let’s parse the dataset. Click on the <strong class="bold">Parse</strong> button at the bottom of the output.</li>
</ol>
<p>The following screenshot shows you the output after parsing:</p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<img alt="Figure 2.19 – Parsing the output " height="640" src="image/B17298_02_019.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Parsing the output</p>
<p>Now, let’s observe the output<a id="_idIndexMarker140"/> we got from the preceding screenshot:</p>
<ul>
<li><strong class="bold">Run Time</strong>: This output shows you the runtime since H2O started to parse the dataset.</li>
<li><strong class="bold">Remaining Time</strong>: This output shows you the expected remaining time it will take H2O to finish parsing the dataset.</li>
<li><strong class="bold">Type</strong>: This output shows you the parsed file’s type.</li>
<li><strong class="bold">Key</strong>: This output shows you a link to the hex file, which has been generated after successfully parsing.</li>
<li><strong class="bold">Description</strong>: This output shows you the operation currently being performed.</li>
<li><strong class="bold">Status</strong>: This output shows you the current status of the operation.</li>
<li><strong class="bold">Progress</strong>: This output shows you the progress bar of the operation.</li>
<li><strong class="bold">Action</strong>: This output is a button that shows you the hex file that has been generated after successfully parsing the dataset.</li>
</ul>
<p>Congratulations! You have successfully parsed your dataset and have generated the hex file. The hex file is commonly termed a <strong class="bold">dataframe</strong>. Now that we have a dataframe generated, let’s see the various metadata<a id="_idIndexMarker141"/> and operations available to us to be perform<a id="_idTextAnchor049"/>ed on the dataframe. </p>
<h2 id="_idParaDest-42"><a id="_idTextAnchor050"/>Observing the dataframe</h2>
<p>The dataframe is the primary data object<a id="_idIndexMarker142"/> on which H2O can perform several data operations. Additionally, H2O provides detailed insights and statistics on the contents of the dataframe. These insights are especially helpful when working with very large dataframes, as it is very difficult to identify whether there are any missing or zeros in any of the columns where data rows can span from thousands to millions.</p>
<p>So, let’s observe the dataframe we just parsed and explore its features. You can view the dataframe by performing either of the following actions from the parsing output that we saw in <em class="italic">Figure 2.19</em>:</p>
<ul>
<li>Click on the <strong class="source-inline">heart.hex</strong> hyperlink in the <strong class="bold">Key</strong> row.</li>
<li>Click on the <strong class="bold">View Data</strong> button in the <strong class="bold">Actions</strong> row.</li>
</ul>
<p>The following screenshot shows you the output of the previously mentioned actions:</p>
<div>
<div class="IMG---Figure" id="_idContainer038">
<img alt="Figure 2.20 – Viewing a dataframe " height="574" src="image/B17298_02_020.jpg" width="873"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.20 – Viewing a dataframe</p>
<p>The output displays a summary of the dataframe. Before exploring the various operations in the <strong class="bold">Actions</strong> section, first, let’s explore<a id="_idIndexMarker143"/> the metadata of the dataframe that is shown below it.</p>
<p>The metadata consists of the following:</p>
<ul>
<li><strong class="bold">Rows</strong>: Displays the number of rows in the dataset</li>
<li><strong class="bold">Columns</strong>: Displays the number of columns in the dataset</li>
<li><strong class="bold">Compressed Size</strong>: Displays the total compressed size of the dataframe</li>
</ul>
<p>Below the metadata, you have the <strong class="bold">COLUMN SUMMARIES</strong> section. Here, you can see statistics about the contents of the dataframe split across the columns.</p>
<p>The summary contains the following information:</p>
<ul>
<li><strong class="bold">label</strong>: This column shows the name of the columns of the dataframe.</li>
<li><strong class="bold">type</strong>: This column shows the type of the column.</li>
<li><strong class="bold">Missing</strong>: This column shows the number of missing values in that column.</li>
<li><strong class="bold">Zeros</strong>: This column shows the number of zeros in the column.</li>
<li><strong class="bold">+Inf</strong>: This column shows the number of positive infinity values.</li>
<li><strong class="bold">-Inf</strong>: This column shows the number of negative infinity values.</li>
<li><strong class="bold">min</strong>: This column shows the minimum value in the column.</li>
<li><strong class="bold">max</strong>: This shows the maximum value in the column.</li>
<li><strong class="bold">sigma</strong>: This column shows the variability in the values of the column.</li>
<li><strong class="bold">cardinality</strong>: This column shows the number of unique values in the column.</li>
<li><strong class="bold">Actions</strong>: This column shows certain actions that you can perform on the columns of the dataframe. These actions mostly consist of converting the columns into different types. It is useful in correcting the column types if they were read incorrectly by H2O after parsing.</li>
</ul>
<p>You might be wondering why you are seeing plenty of values<a id="_idIndexMarker144"/> in the <strong class="bold">Zeros</strong> columns for columns such as <strong class="bold">Sex</strong> and <strong class="bold">RestingECG</strong>. This is because of <strong class="bold">encoding</strong>. When parsing enum columns, H2O encodes enums and strings into numerical values starting from 0 to 1, then 2, and so on and<a id="_idIndexMarker145"/> so forth. You can also control this encoding process<a id="_idIndexMarker146"/> by selecting which encoding<a id="_idIndexMarker147"/> process you want, for example, <strong class="bold">Label encoding</strong> or <strong class="bold">One-hot encoding</strong>. We will discuss encoding in greater detail in <a href="B17298_05.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Understanding AutoML Algorithms</em>.</p>
<p>After the <strong class="bold">COLUMN SUMMARIES</strong> section, you will see the <strong class="bold">CHUNK COMPRESSION SUMMARY</strong> section, as shown in the following screenshot:</p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<img alt="Figure 2.21 – The dataset’s CHUNK COMPRESSION SUMMARY section " height="187" src="image/B17298_02_021.jpg" width="844"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.21 – The dataset’s CHUNK COMPRESSION SUMMARY section</p>
<p>When working with very large datasets, it can take a very long time to read and write data from the datasets if done in a traditional manner. Therefore, systems such as Hadoop File System, Spark, and more are often used as they perform read and write in a distributed manner, which is faster than the traditional contiguous manner. <strong class="bold">Chunking</strong> is a process <a id="_idIndexMarker148"/>where distributed file systems such as Hadoop split the dataset into chunks and flatten them before writing to disk. H2O handles all of this internally so that users do not need to worry about managing distributed read or write. The <strong class="bold">CHUNK COMPRESSION SUMMARY</strong> section just gives additional information about the chunk distribution.</p>
<p>Underneath <strong class="bold">CHUNK COMPRESSION SUMMARY</strong> is the <strong class="bold">FRAME DISTRIBUTION SUMMARY</strong> section, as shown in the following screenshot:</p>
<div>
<div class="IMG---Figure" id="_idContainer040">
<img alt="Figure 2.22 – The dataset’s Frame Distribution Summary section " height="228" src="image/B17298_02_022.jpg" width="848"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.22 – The dataset’s Frame Distribution Summary section</p>
<p>The <strong class="bold">FRAME DISTRIBUTION SUMMARY</strong> section gives statistical information about the dataframe in general. If you have<a id="_idIndexMarker149"/> imported multiple files and parsed them into a single dataframe, then the frame distribution summary will calculate the total size, the mean size, the minimum size, the maximum size, the number of chunks per dataset, and more.</p>
<p>Looking back at the dataframe from <em class="italic">Figure 2.20</em>, you can see that the column names are highlighted as links. Let’s click on the last column, <strong class="bold">HeartDisease</strong>. </p>
<p>The following screenshot will show you a column summary of the <strong class="bold">HeartDisease</strong> column:</p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<img alt="Figure 2.23 – Column summary " height="396" src="image/B17298_02_023.jpg" width="565"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.23 – Column summary</p>
<p>The <strong class="bold">Column Summary</strong> gives you more details about individual<a id="_idIndexMarker150"/> columns in the dataset based on their type. </p>
<p>For enums such as <strong class="bold">HeartDisease</strong>, it shows you the details of the column as follows:</p>
<ul>
<li><strong class="bold">Characteristics</strong>: This graph shows you the percentage distribution of zero and nonzero values. </li>
<li><strong class="bold">Domain</strong>: This graph shows you the domain of the column, that is, the number of times a value has been repeated over the total number of rows. </li>
</ul>
<p>You will see more details when<a id="_idIndexMarker151"/> you hover your mouse over the graphs. Feel free to explore all the columns and try to understand their features.</p>
<p>Returning to the dataframe from <em class="italic">Figure 2.20</em>, let’s now look at the <strong class="bold">Actions</strong> section. This includes certain actions that are available to be performed on the dataframe. </p>
<p>Those actions include the following:</p>
<ul>
<li><strong class="bold">View Data</strong>: This action displays the data in the dataframe.</li>
<li><strong class="bold">Split</strong>: This action splits the dataframe into the specified parts in the specified ratio.</li>
<li><strong class="bold">Build Model</strong>: This action starts building a model on this dataframe.</li>
<li><strong class="bold">Run AutoML</strong>: This action triggers AutoML on the dataframe.</li>
<li><strong class="bold">Predict</strong>: This action uses the dataframe to predict on an already trained model and gets results.</li>
<li><strong class="bold">Download</strong>: This action downloads the dataframe to the system.</li>
<li><strong class="bold">Export</strong>: This action exports the dataframe to a specified path in the system.</li>
</ul>
<p>As much as we are excited to trigger AutoML, let’s continue our exploration of the various dataframe features. </p>
<p>Now, let’s see the dataframe and its actual data contents. To do this, click on the <strong class="bold">View Data</strong> button in the <strong class="bold">Actions</strong> section.</p>
<p>The following screenshot shows you the output of the <strong class="bold">View Data</strong> button:</p>
<div>
<div class="IMG---Figure" id="_idContainer042">
<img alt="Figure 2.24 – The dataframe’s content view " height="660" src="image/B17298_02_024.jpg" width="932"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.24 – The dataframe’s content view</p>
<p>This function shows the actual contents<a id="_idIndexMarker152"/> of the dataset. You can scroll down to see all of the contents of the dataframe. If you have run any operations on the dataframe, then you will be able to view the changes in the content of the dataframe using this operation.</p>
<p>Now that you have explored and understood the various dataframe operations and metadata of the dataframe, let’s investigate<a id="_idIndexMarker153"/> another interesting dataframe operation called <strong class="bold">Split</strong>.</p>
<h2 id="_idParaDest-43"><a id="_idTextAnchor051"/>Splitting a dataframe</h2>
<p>Before we send a dataframe for model training, we need a sample<a id="_idIndexMarker154"/> dataframe with predicted values. This sample can be used to validate whether the model is making a correct prediction or not and measure the accuracy and performance of the model. We can do this by reserving a small part of the dataframe to be used later for validation. This is where split functionality comes into the picture.</p>
<p><strong class="bold">Split</strong>, as the name suggests, splits the dataset into parts that we can later use for different operations. Splitting of dataset takes ratios into account. H2O creates multiple dataframes based on the number of splits you want to make and the ratio of the distribution of data. </p>
<p>To split the dataframe, click<a id="_idIndexMarker155"/> on the <strong class="bold">Split</strong> operation<a id="_idIndexMarker156"/> button in the <strong class="bold">Actions</strong> section.</p>
<p>The following screenshot shows you the output of clicking on the <strong class="bold">Split</strong> button:</p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer043">
<img alt="Figure 2.25 – Splitting a dataframe " height="398" src="image/B17298_02_025.jpg" width="779"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.25 – Splitting a dataframe</p>
<p>In the preceding output, you will be prompted to input the splitting configurations, which are listed as follows:</p>
<ul>
<li><strong class="bold">Frame</strong>: This configuration lets you select the frame that you want to split.</li>
<li><strong class="bold">Splits</strong>: This configuration lets you select the number of splits that you want to make and the ratio of the distribution of data you want among them. Additionally, you can set the key names for the splits. For our walk-through, let’s split the dataframe into three dataframes:<ul><li><strong class="source-inline">training_dataframe</strong> with a ratio of 0.70</li><li><strong class="source-inline">validation_dataframe</strong> with a ratio of 0.20</li><li><strong class="source-inline">testing_dataframe</strong> with a ratio of 0.10</li></ul></li>
<li><strong class="bold">Seed</strong>: This configuration lets you select the randomization point. Split does not split the dataframe linearly. It splits the rows of the dataframe randomly. This is a good thing, as it equally distributes the data between the split dataframes, thus removing any bias that might be present in the sequence of the dataset rows. For our walk-through, let’s set the seed value to 5.</li>
</ul>
<p>Once you have made<a id="_idIndexMarker157"/> these changes, click on the <strong class="bold">Create</strong> button. This will generate three dataframes: <strong class="bold">training_dataframe</strong>, <strong class="bold">validation_dataframe</strong>, and <strong class="bold">testing_dataframe</strong>. These three frames will be stored in H2O’s local repository and can be available for other experiments, too. </p>
<p>The following diagram shows you the output of the <strong class="bold">Create</strong> operation:</p>
<div>
<div class="IMG---Figure" id="_idContainer044">
<img alt="Figure 2.26 – Split dataset results " height="218" src="image/B17298_02_026.jpg" width="980"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.26 – Split dataset results</p>
<p>All three of the dataframes are independent dataframes and have the same set of features and options as you saw for the original dataset in <em class="italic">Figure 2.20</em>. Splitting does not delete the original dataframe. It creates new dataframes and copies the data from the original dataframe and distributes them among the dataframes based on the selected ratios.</p>
<p>Now that we have the training frame, the validation frame, and the testing frame ready, we are ready for the next step of the model training pipeline, that is, model training.</p>
<p>So, to recap, in this section, you understood the various <a id="_idIndexMarker158"/>data operations we can perform on the dataset available in H2O Flow such as importing, parsing, reading the parsed dataframe, and splitting it.</p>
<p>In the next section, we will focus on model training and using H2O AutoML to train models on the dataframes we created in this heading.</p>
<h1 id="_idParaDest-44"><a id="_idTextAnchor052"/>Working with model training functions in H2O Flow</h1>
<p>Once your dataset is ready, the next<a id="_idIndexMarker159"/> step of the model training pipeline<a id="_idIndexMarker160"/> is the actual training part. The training of models can get very complex as there are a lot of configurations that decide how the model will be trained on the dataset. This is true even for AutoML where the majority of the hyperparameter tuning is done behind the scenes. Not only are there right and wrong ways of training a model for a specific type of data, but some of the configuration values can also affect the performance of the model. Therefore, it is important to understand the various configuration parameters that H2O has to offer when training a model using AutoML. In this section, we will focus on understanding what these parameters are and what they do when it comes to model training.</p>
<p>We will understand how to train a model using AutoML, step by step, using the dataframes we created previously.</p>
<p>Note that there are plenty of things in this section that will be too complex to understand at this stage. We will explore some of them in future chapters. For the time being, we will only focus on features we can understand right now, as the goal of this chapter is to understand H2O Flow and how to use AutoML to train models using H2O Flow.</p>
<p>In the following sub-sections, we will gain an understanding of the model training operations, starting with an understanding of the AutoML training configuration parameters.</p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor053"/>Understanding the AutoML parameters in H2O Flow</h2>
<p>H2O AutoML is extremely configurable<a id="_idIndexMarker161"/> in terms of how you want to train<a id="_idIndexMarker162"/> your models. Despite using the same AutoML technology, often, every industry will have certain preferences or inclinations regarding how it wants to train its models based on their requirements. So, even though AutoML is automating most of the ML processes, a degree of control and flexibility is still needed in terms of how AutoML trains its models. H2O provides extensive configuration capabilities for its AutoML feature. Let’s explore them as we train our model.</p>
<p>There are two ways that you can trigger<a id="_idIndexMarker163"/> AutoML on a dataset. They are listed as follows:</p>
<ul>
<li>By clicking on the <strong class="bold">Run AutoML</strong> button in the <strong class="bold">Actions</strong> section of your dataframe output, as shown in <em class="italic">Figure 2.20</em>.</li>
<li>By selecting <strong class="bold">Run AutoML</strong> in the drop-down menu of the <strong class="bold">Model</strong> section, on the topmost part of the web UI, as shown in <em class="italic">Figure 2.27</em>.</li>
</ul>
<p>Let’s go with the second option so that we can explore the <strong class="bold">Model</strong> operations section at the top of the web UI page. When you click on the <strong class="bold">Model</strong> section, you should see the drop-down list, as shown in the following screenshot:</p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<img alt="Figure 2.27 – The Model functions drop-down list " height="783" src="image/B17298_02_027.jpg" width="358"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.27 – The Model functions drop-down list</p>
<p>The preceding drop-down list categorizes the model operations into three types, as follows:</p>
<ul>
<li><strong class="bold">Run AutoML</strong>: This operation starts the AutoML process<a id="_idIndexMarker164"/> by prompting the user to input configuration values to train models using AutoML.</li>
<li><strong class="bold">Run Specific Models</strong>: This operation starts model training<a id="_idIndexMarker165"/> on specific ML algorithms that you wish to use; for example, deep learning, K-means clustering, random forest, and more. Each ML algorithm comes with its own set of parameters that you must specify to start training models.</li>
<li><strong class="bold">Model Management options</strong>: These operations are basic operations<a id="_idIndexMarker166"/> that are used to manage the various models you might have trained over a period of time.<ul><li>The operations are listed as follows:<ul><li><strong class="bold">Import MOJO Model</strong>: This operation imports H2O <strong class="bold">Model Object, Optimized</strong> (<strong class="bold">MOJO</strong>) models previously <a id="_idIndexMarker167"/>trained by another H2O service and exported to the system in the form of a MOJO.</li><li><strong class="bold">List All Models</strong>: This operation lists all the models trained by your H2O service. This includes those trained by other Flow notebooks.</li><li><strong class="bold">List Grid Search Results</strong>: Grid search is a technique that is used to find the best hyperparameters when training a model to get the best and most accurate performance out of it. This operation lists all the grid search results from the model training.</li><li><strong class="bold">Import Model</strong>: This operation imports model objects into H2O.</li><li><strong class="bold">Export Model</strong>: This operation exports model objects to the system either as a binary file or as a MOJO.</li></ul></li></ul></li>
</ul>
<p>Now, let’s use AutoML to train our model on our dataset. </p>
<p>Click on <strong class="bold">Run AutoML</strong>. As shown in <em class="italic">Figure 2.27</em>, you should see an output prompting you to input a wide variety of configuration parameters to run AutoML. There are tons of options to configure your AutoML training. These can greatly affect your model training performance and the quality of the models that eventually get trained. The parameters are classified into three categories. Let’s explore them, one by one, categorically and input the values to suit our model training requirements starting with the basic parameters.</p>
<h3>Basic parameters</h3>
<p>Basic parameters are parameters<a id="_idIndexMarker168"/> that focus on the basic inputs needed for all model training operations. These are common among all the ML algorithms and are self-explanatory.</p>
<p>The following screenshot shows you the basic parameter values you need to input to configure AutoML:</p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<img alt="Figure 2.28 – The basic parameters of AutoML " height="444" src="image/B17298_02_028.jpg" width="1167"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.28 – The basic parameters of AutoML</p>
<p>The basic parameters are listed as follows:</p>
<ul>
<li><strong class="bold">training_frame</strong>: This configuration sets the dataframe to be used for training the model and is mandatory. In our case, our <strong class="source-inline">training_frame</strong> parameter is the <strong class="source-inline">training_dataframe.hex</strong> file that we created in the <em class="italic">Working with data functions in H2O Flow</em> section.</li>
<li><strong class="bold">response_column</strong>: This configuration sets the response column of the dataframe that is to be predicted. This is a mandatory parameter. In our case, our response column is the <strong class="source-inline">HeartDisease</strong> column.</li>
<li><strong class="bold">validation_frame</strong>: This configuration sets the dataframe to be used for validation of the model during training. In our case, our validation frame is the <strong class="source-inline">validation_dataframe.hex</strong> file we created in the previous section.</li>
<li><strong class="bold">blending_frame</strong>: This configuration sets the dataframe that should be used to train the stacked ensemble<a id="_idIndexMarker169"/> models. For the time being, we can ignore this as we won’t be exploring stacked ensemble very much in this chapter. We will explore stacked ensemble models in more detail in <a href="B17298_05.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Understanding AutoML Algorithms</em>, so let’s leave this blank.</li>
<li><strong class="bold">leaderboard_frame</strong>: This configuration sets the ID of the dataframe, which will be used to calculate the performance metrics of the trained models, and it will use the results to rank them on the leaderboard. If a leaderboard frame has not been specified, then AutoML will use cross-validation metrics to rank the models. Even if cross-validation is turned off by setting <strong class="source-inline">nfolds</strong> to 0, then AutoML will generate a leaderboard from the training frame.</li>
<li><strong class="bold">project_name</strong>: This configuration sets the name of your project. AutoML will group all of the results from multiple runs into a single leaderboard under this project name. If you leave this value blank, H2O will autogenerate a random name for the project on its own.</li>
<li><strong class="bold">distribution</strong>: This configuration is used to specify the type of distribution function to be used by ML algorithms. Algorithms that support the specified type of distribution function will use it, while others will use their default value. We will learn more about distribution functions in <a href="B17298_05.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Understanding AutoML Algorithms</em>.</li>
</ul>
<p>Now that you understood what the basic parameters of AutoML are, let’s gain an understanding of the advanced parameters.</p>
<h3>Advanced parameters</h3>
<p>Advanced parameters provide additional<a id="_idIndexMarker170"/> configurations for training models using AutoML. These parameters have certain default values set to them and, therefore, are not mandatory. However, they do provide additional configurations that change the behavior of AutoML when training models. </p>
<p>The following screenshots show<a id="_idIndexMarker171"/> you the first part of the advanced parameters for AutoML:</p>
<div>
<div class="IMG---Figure" id="_idContainer047">
<img alt="Figure 2.29 – AutoML advanced parameters, part 1 " height="638" src="image/B17298_02_029.jpg" width="1155"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.29 – AutoML advanced parameters, part 1</p>
<p>Immediately below this will be the second part of the advanced parameters. Scroll down to see the remaining parameters, as shown in the following screenshot:</p>
<div>
<div class="IMG---Figure" id="_idContainer048">
<img alt="Figure 2.30 – AutoML advanced parameters, part 2 " height="623" src="image/B17298_02_030.jpg" width="1181"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.30 – AutoML advanced parameters, part 2</p>
<p>Let’s explore the parameters <a id="_idIndexMarker172"/>one by one. The advanced parameters are listed as follows:</p>
<ul>
<li><strong class="bold">fold_column</strong>: This parameter uses the column values as a basis to create its folds in N-Fold cross-validation. We will learn more about cross-validation in the upcoming chapters.</li>
<li><strong class="bold">weights_column</strong>: This parameter gives weight to a column in the training frame or, put simply, gives preference to a column. We will explore weights in model training in greater detail in later chapters.</li>
<li><strong class="bold">ignored_columns</strong>: This parameter lets you select the columns from the training frame that you wish to ignore when training models. We won’t be ignoring any columns for our experiment, so we will leave all the columns unchecked.</li>
<li><strong class="bold">sort_metrics</strong>: This parameter selects the metric that will be used to sort and rank the models trained by AutoML. Selecting <strong class="bold">AUTO</strong> will use the <strong class="bold">AUC</strong> metrics for binary classification, <strong class="bold">mean_per_class_error</strong> for multinomial classification, and <strong class="bold">deviance</strong> for regression. For simplicity’s sake, let’s set <strong class="bold">Mean Squared Error</strong> (<strong class="bold">MSE</strong>) as the sorting metric since it is easier<a id="_idIndexMarker173"/> to understand. We will explore metrics in greater detail in <a href="B17298_06.xhtml#_idTextAnchor129"><em class="italic">Chapter 6</em></a>, <em class="italic">Understanding H2O AutoML Leaderboard and Other Performance Metrics</em>.</li>
<li><strong class="bold">nfolds</strong>: This parameter selects the number of cross-validation folds created for cross-validation. Cross-validation<a id="_idIndexMarker174"/> generates stacked ensemble models. For the moment, we will set this value to <strong class="source-inline">0</strong> to prevent the creation of stacked ensemble models. We will explore stacked ensemble models and cross-validation further in the upcoming chapters.</li>
<li><strong class="bold">Balance_classes</strong>: In model training, it is always best to train models on datasets that have output classes with an equal distribution of values. This mitigates any biases that might arise from an unequal distribution of values. This parameter balances the output classes to be of equal numbers. In our case, the output class is the <strong class="bold">Heart Disease</strong> column. As we saw in the column summary of the <strong class="bold">Heart Disease</strong> column, in the distribution section, we had around 410 values as 0 and 508 values as 1 (<em class="italic">see Figure 2.23</em>). So, ideally, we need to balance out the classes before training a model. However, to keep things simple for the moment, we will skip the balancing of the classes and focus on understanding the basics. We will explore class balancing further in the upcoming chapters.</li>
<li><strong class="bold">exclude_algos</strong>: This parameter excludes certain algorithms from the AutoML training. For our experiment, we want to consider all the algorithms, so let’s leave the value empty.</li>
<li><strong class="bold">exploitation_ratio</strong>: This is an experimental option that sets the exploitation versus exploration ratio when training a model. We will discuss this in greater detail in the upcoming chapters. Let’s keep the default value of <strong class="source-inline">-1</strong> as it is.</li>
<li><strong class="bold">monotone_constraints</strong>: In some cases, where there is a very strong prior belief that the relationship between features has some quality, constraints can be used to improve the predictive performance of the model. This parameter helps set these constraints. We will discuss this more in the upcoming chapters. Let’s leave this value empty.</li>
<li><strong class="bold">seed</strong>: This parameter sets the seed<a id="_idIndexMarker175"/> value for randomization, which is useful for reproducing results. Let’s set this to <strong class="source-inline">5</strong>.</li>
<li><strong class="bold">max_models</strong>: This parameter sets the maximum number of models to be trained by H2O AutoML. We will set this to <strong class="source-inline">10</strong>, else model training can take a long time.</li>
<li><strong class="bold">max_runtime_secs</strong>: This parameter sets the maximum time that H20 should spend training a single model. Usually, the larger the size of the dataset, the more time it takes for a model to train. Setting a very small runtime for model training will not give AutoML the time it needs to train models. Since our dataset is not very big, we will let AutoML take its time training the models, which shouldn’t be that long.</li>
<li><strong class="bold">max_runtime_sec_per_model</strong>: This parameter sets the maximum time AutoML should spend on training an individual model. Model training won’t take too long. So, let’s ignore this.</li>
<li><strong class="bold">stopping_round</strong>: This tells AutoML to stop training models after the stopping metric doesn’t improve much over the number of rounds. We want to train all the models, so we will set this value to <strong class="source-inline">0</strong> to disable it.</li>
<li><strong class="bold">stopping_metrics</strong>: This metric is used for early stopping. Since stopping is disabled, we will ignore this.</li>
<li><strong class="bold">stopping_tolerance</strong>: This refers to the relative tolerance of improvement on progressive model training expected below which AutoML should stop training models. Since stopping is disabled, we will ignore this.</li>
</ul>
<p>Now that you have understood what the basic parameters of AutoML are, let’s check the expert parameters.</p>
<h3>Expert parameters</h3>
<p>Expert parameters are parameters<a id="_idIndexMarker176"/> that provide additional options that supplement the AutoML training results with additional features that help in further experimentation. These parameters are dependent on the configuration you already selected in the <em class="italic">Advanced parameters</em> section.</p>
<p>The following screenshot shows you the expert parameter options that are available for our current walk-through:</p>
<div>
<div class="IMG---Figure" id="_idContainer049">
<img alt="Figure 2.31 – AutoML expert parameters " height="271" src="image/B17298_02_031.jpg" width="999"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.31 – AutoML expert parameters</p>
<p>The expert parameters are listed as follows:</p>
<ul>
<li><strong class="bold">keep_cross_validation_predictions</strong>: If cross-validation is enabled for training, then H2O provides the option of saving those prediction values.</li>
<li><strong class="bold">keep_cross_validation_models</strong>: If cross-validation is enabled for training, then H2O provides the option of saving the models trained for the same.</li>
<li><strong class="bold">keep_cross_validation_fold_assignments</strong>: If cross-validation is enabled for training, then H2O provides the option of saving the folds used in model training for the different cross-validations.</li>
<li><strong class="bold">export_checkpoint_dir</strong>: This is the directory path where H2O will store the generated models.</li>
</ul>
<p>More expert options become available depending on what you select in the basic and advanced parameters. For the time being, we can disable all the expert parameters as we won’t be focusing much on them in this walk-through.</p>
<p>Once you have set all of the parameter values, the only thing left now is to trigger the AutoML model training.</p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor054"/>Training and understanding models using AutoML in H2O Flow</h2>
<p>Model training is one of the most complex<a id="_idIndexMarker177"/> and important parts of the ML pipeline. Model training is the process of mapping a mathematical<a id="_idIndexMarker178"/> approximation by learning the relationship between features<a id="_idIndexMarker179"/> and the expected output, all while trying to minimize loss. There are various ways you can do this. The method by which a system<a id="_idIndexMarker180"/> performs this task is known as an ML algorithm. AutoML trains models<a id="_idIndexMarker181"/> using various ML algorithms and compares their performance with each other to find the one that has the least error metric value as per the ML problem. </p>
<p>First, let’s gain an understanding of how we can train a model using AutoML in H2O Flow. </p>
<h3>Training models using AutoML in H2O Flow</h3>
<p>You need to make careful<a id="_idIndexMarker182"/> considerations when setting the parameter values for training<a id="_idIndexMarker183"/> models using AutoML. Once you have selected the correct inputs, you can then trigger the AutoML model training.</p>
<p>You can do this by clicking on the <strong class="bold">Build Models</strong> button at the end of your <strong class="bold">Run AutoML</strong> output. </p>
<p>The following screenshot shows you the AutoML training job progress:</p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer050">
<img alt="Figure 2.32 – The AutoML training is finished " height="474" src="image/B17298_02_032.jpg" width="1346"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.32 – The AutoML training is finished</p>
<p>It should take some time to train the models. The results<a id="_idIndexMarker184"/> of the model training are stored on a <strong class="bold">Leaderboard</strong>. The value of the <strong class="bold">Key</strong> section is a link to the leaderboard (see <em class="italic">Figure 2.32</em>).</p>
<p>You can view the leaderboard<a id="_idIndexMarker185"/> in one of two ways. They are listed as<a id="_idIndexMarker186"/> follows:</p>
<ul>
<li>Click on the leaderboard link in the<strong class="bold"> Key</strong> section of the AutoML training job output.</li>
<li>Click on the <strong class="bold">View</strong> button of the AutoML training job output.</li>
</ul>
<p>In the following screenshot, you can see what a <strong class="bold">Leaderboard</strong> looks like:</p>
<div>
<div class="IMG---Figure" id="_idContainer051">
<img alt="Figure 2.33 – AutoML Leaderboard " height="532" src="image/B17298_02_033.jpg" width="1259"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.33 – AutoML Leaderboard</p>
<p>If you followed the same steps, as shown in the previous examples, then you should see the same output, albeit with slightly different IDs for the models as it is randomly generated.The leaderboard shows you all the models that AutoML has trained and ranks them from best to worst based on the <strong class="bold">sorting metric</strong>. A sorting metric is a statistical measurement<a id="_idIndexMarker187"/> of the quality of a model, which is used to compare the performance of different models. Additionally, the leaderboard has links to all the individual model details. You can click on any of them to get more information about the individual models. If AutoML is in progress and currently training models, then you can also view the progress of the training in real time by clicking on the <strong class="bold">Monitor Live</strong> button.</p>
<p>Now that you have understood how to train a model using AutoML, let’s dive deep into the ML model details and try to understand its various characteristics.</p>
<h3>Understanding ML models</h3>
<p>An ML model can be described as an object<a id="_idIndexMarker188"/> that contains a mathematical equation that can identify patterns for a given set of features and predict a potential outcome. These ML models form the central component of all ML pipelines, as the entire ML pipeline aims to create and use these models for predictions. Therefore, it is important to understand the various details of a trained ML model in order to justify whether the predictions that it is making are accurate or not and to what degree they are accurate.</p>
<p>Let’s click on the best model on the leaderboard to understand more of its details. You should see the following output:</p>
<div>
<div class="IMG---Figure" id="_idContainer052">
<img alt="Figure 2.34 – Model information " height="209" src="image/B17298_02_034.jpg" width="1179"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.34 – Model information</p>
<p>As you can see, H2O provides a very in-depth view of the model details. All the details are categorized inside their own sub-sections. There is a lot of information here, and as such, it can be overwhelming. For the moment, we will only focus on the important parts.</p>
<p>Let’s glance through the important and easy-to-understand details one by one:</p>
<ul>
<li><strong class="bold">Model ID</strong>: This is the ID of the model.</li>
<li><strong class="bold">Algorithm</strong>: This indicates the algorithm used to train the model.</li>
<li><strong class="bold">Actions</strong>: Once the model has been trained, you can perform the following actions on it:<ul><li><strong class="bold">Refresh</strong>: This refreshes the model in memory.</li><li><strong class="bold">Predict</strong>: This lets you start making predictions on this model.</li><li><strong class="bold">Download POJO</strong>: This downloads<a id="_idIndexMarker189"/> the model in <strong class="bold">Plain Old Java Object</strong> (<strong class="bold">POJO</strong>) format.</li><li><strong class="bold">Download Model Deployment Package</strong>: This downloads the model in MOJO format.</li><li><strong class="bold">Export</strong>: This exports the model as either a file or MOJO to the system.</li><li><strong class="bold">Inspect</strong>: H2O goes into inspect mode, where it inspects the model object, retrieving detailed information about its schemas and sub-schemas.</li><li><strong class="bold">Delete</strong>: This deletes the model.</li><li><strong class="bold">Download Gen Model</strong>: This downloads the generated model JAR file.</li></ul></li>
</ul>
<p>Then, you have a set of sub-sections<a id="_idIndexMarker190"/> explaining more about the model’s metadata and performance. These sub-sections vary slightly for different models, as some models might need to show some additional metadata for explainability purposes.</p>
<p>As you can see, a lot of the details seem very complex in nature and they are rightfully so. This is because they involve a bit of data science knowledge. Don’t worry; we will explore all of them in the upcoming chapters. </p>
<p>Let’s go through the easier sub-sections so that we can understand the various metadata of the ML models:</p>
<ul>
<li><strong class="bold">Model Parameters</strong>: The model parameters<a id="_idIndexMarker191"/> are nothing but the input parameters we passed to AutoML, along with some inputs AutoML decided to use to train the model. You can choose to view either all of the parameters or only the modified ones by clicking on the <strong class="bold">Show all parameters</strong> or <strong class="bold">Show modified parameters</strong> buttons. The description of the parameters is shown next to every parameter.</li>
<li><strong class="bold">Variable Importances</strong>: Variable importances denote the importance of the variable<a id="_idIndexMarker192"/> when it comes to making predictions. Variables with the most importance are the ones the ML model relies most on when making predictions. Any changes to variables of high importance can drastically affect the model prediction.</li>
</ul>
<p>The following screenshot shows you the scaled importance of various features from the dataframe that we used to train models:</p>
<div>
<div class="IMG---Figure" id="_idContainer053">
<img alt="Figure 2.35 – Variable importances " height="477" src="image/B17298_02_035.jpg" width="951"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.35 – Variable importances</p>
<ul>
<li><strong class="bold">Output</strong>: The output sub-section denotes<a id="_idIndexMarker193"/> the basic output value of the AutoML training. The majority of the details that are shown are for cross-validation results.</li>
</ul>
<p>The output values are listed as follows:</p>
<ul>
<li><strong class="bold">model_category</strong>: This value indicates the category of the model that denotes what kind of prediction it performs. Binomial indicates that it performs binomial classification, which means it predicts whether the value is either <strong class="bold">1</strong> or <strong class="bold">0</strong>. In our case, <strong class="bold">1</strong> indicates that the person is likely to face a heart condition, and <strong class="bold">0</strong> indicates that the person is not likely to face a heart condition.</li>
<li><strong class="bold">start_time</strong>: This value indicates the epoch time at which it started the model training.</li>
<li><strong class="bold">end_time</strong>: This value indicates the epoch time at which it ended the model training.</li>
<li><strong class="bold">run time</strong>: This value indicates the epoch total time it took to finish training the model.</li>
<li><strong class="bold">default_threshold</strong>: This is the default threshold value over which the model will consider all predictions as <strong class="bold">1</strong>. Similarly, any value predicted below the default threshold will be <strong class="bold">0</strong>.</li>
</ul>
<p>The following screenshot shows<a id="_idIndexMarker194"/> you the output sub-section of the model details: </p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer054">
<img alt="Figure 2.36 – Output of the model information " height="461" src="image/B17298_02_036.jpg" width="610"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.36 – Output of the model information</p>
<ul>
<li><strong class="bold">Column_Types</strong>: This sub-section gives you a brief look<a id="_idIndexMarker195"/> at the column types of the columns in the dataframe. The values are in the same sequence as the sequence of the columns in the training dataframe.</li>
</ul>
<p>The following screenshot shows you the <strong class="bold">column_types</strong> metrics of the model details: </p>
<div>
<div class="IMG---Figure" id="_idContainer055">
<img alt="Figure 2.37 – Column types " height="549" src="image/B17298_02_037.jpg" width="275"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.37 – Column types</p>
<ul>
<li><strong class="bold">Output - Training_Metrics</strong>: This sub-section shows you the metrics<a id="_idIndexMarker196"/> of the model when the training dataset is used for predictions. We will learn about the various metrics of ML in future chapters.</li>
</ul>
<p>The following screenshot shows you the training metrics of the model details: </p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer056">
<img alt="Figure 2.38 – The model output’s training metrics " height="590" src="image/B17298_02_038.jpg" width="744"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.38 – The model output’s training metrics</p>
<ul>
<li><strong class="bold">Output - Validation_Metrics</strong>: Similar to the previous sub-section, this sub-section shows you the metrics<a id="_idIndexMarker197"/> of the model when the validation dataset is used for predictions. </li>
</ul>
<p>The following screenshot shows you the training metrics of the model details: </p>
<div>
<div class="IMG---Figure" id="_idContainer057">
<img alt="Figure 2.39 – The model output’s validation metrics " height="751" src="image/B17298_02_039.jpg" width="701"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.39 – The model output’s validation metrics</p>
<p>Now that we have understood the various parts of the model details, let’s see how we can perform predictions on this newly trained model.</p>
<h1 id="_idParaDest-47"><a id="_idTextAnchor055"/>Working with prediction functions in H2O Flow</h1>
<p>Now that you finally have a trained<a id="_idIndexMarker198"/> model, we can perform<a id="_idIndexMarker199"/> predictions on it. Predictions on trained models are straightforward. You just need to load the model and pass in your dataset, which contains the data on which you want to make predictions. H2O will use the loaded model and make predictions for all the values in the dataset. Let’s use the <strong class="source-inline">prediction_dataframe.hex</strong> dataframe that we created previously to make predictions on.</p>
<p>We will gain an understanding of the prediction operations in the following sub-sections, starting with gaining an understanding of how to make predictions.</p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor056"/>Making predictions using H2O Flow</h2>
<p>First, let’s start by<a id="_idIndexMarker200"/> exploring the <strong class="bold">Score</strong> operation’s drop-down list in the topmost part of the web UI.</p>
<p>You will see a list of scoring operations, as follows:</p>
<div>
<div class="IMG---Figure" id="_idContainer058">
<img alt="Figure 2.40 – The Score functions drop-down menu " height="291" src="image/B17298_02_040.jpg" width="1204"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.40 – The Score functions drop-down menu</p>
<p>The preceding drop-down menu shows you a list of all the various scoring operations that you can perform.</p>
<p>The functions are listed as follows:</p>
<ul>
<li><strong class="bold">Predict</strong>: This makes predictions using trained models.</li>
<li><strong class="bold">Partial Dependency Plots</strong>: These show you a graphical representation of the effects of a variable on the predictions. In other words, they show you how changing certain variables in the data used for prediction affects the prediction response.</li>
<li><strong class="bold">List all Predictions</strong>: This function lists all the predictions that were made.</li>
</ul>
<p>There are two ways you can start making predictions in H2O Flow. They are listed as follows:</p>
<ul>
<li>Use the <strong class="bold">Predict</strong> function from the <strong class="bold">Score</strong> operation’s drop-down menu.</li>
<li>Click on the <strong class="bold">Predict</strong> button in the <strong class="bold">Actions</strong> section of a model, as shown in <em class="italic">Figure 2.34</em>.</li>
</ul>
<p>Both methods will give the same output, as shown in the following screenshot:</p>
<div>
<div class="IMG---Figure" id="_idContainer059">
<img alt="Figure 2.41 – Prediction " height="460" src="image/B17298_02_041.jpg" width="717"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.41 – Prediction</p>
<p>Clicking on the ML<a id="_idIndexMarker201"/> model’s <strong class="bold">Predict</strong> action button will set the <strong class="bold">Model</strong> parameter to the respective model ID. However, when clicking on the <strong class="bold">Predict</strong> operation button in the <strong class="bold">Scores</strong> operation drop-down list, you get the option to select any model.</p>
<p>The <strong class="bold">Predict</strong> operation will prompt you for the following parameters:</p>
<ul>
<li><strong class="bold">Name</strong>: You can name the prediction result for easier identification. This is especially handy if you are experimenting with different prediction requests and need a quick referral to a specific prediction result of your interest.</li>
<li><strong class="bold">Model</strong>: This is the ID of the model you wish to use<a id="_idIndexMarker202"/> to make the prediction. Since we selected the <strong class="bold">Predict</strong> action of our <strong class="bold">Gradient Boosting Machine</strong> (<strong class="bold">GBM</strong>) model, this will be non-editable.</li>
<li><strong class="bold">Frame</strong>: This is the dataframe that you want to use to make predictions on. So, let’s select the <strong class="bold">prediction_dataset.hex</strong> file.</li>
<li><strong class="bold">Compute Leaf Node Assignment</strong>: This returns the leaf placements of the row in all the trees of the model for every row in the dataframe used to make the prediction. For our walk-through, we won’t need this, and as such, we can leave it unchecked.</li>
</ul>
<p>Once you have selected the appropriate parameter values, the only thing left to do is to click on the <strong class="bold">Predict</strong> button to make your predictions.</p>
<p>The following screenshot shows you the output of the <strong class="bold">Predict</strong> operation:</p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer060">
<img alt="Figure 2.42 – The Prediction output " height="356" src="image/B17298_02_042.jpg" width="1157"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.42 – The Prediction output</p>
<p>Congratulations! You have finally<a id="_idIndexMarker203"/> managed to make a prediction on a model trained by AutoML. Let’s move on to the next section, where we will explore and understand the prediction results that we just got.</p>
<h2 id="_idParaDest-49"><a id="_idTextAnchor057"/>Understanding the prediction results</h2>
<p>Prediction is the final stage<a id="_idIndexMarker204"/> of the ML pipeline. It is the part that brings the actual value to all the efforts put into creating the ML pipeline. Making predictions is easy; however, it is important to understand what the actual predicted value is and what it represents against the input values.</p>
<p>The prediction result gives you detailed information on not only the predicted values but also metric information and certain metadata, as shown in <em class="italic">Figure 2.42</em>.</p>
<p>The following screenshot shows you the prediction output sub-section of your prediction results:</p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<img alt="Figure 2.43 – The prediction results " height="626" src="image/B17298_02_043.jpg" width="690"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.43 – The prediction results</p>
<p>This is similar to the <strong class="bold">output - validation and training metrics</strong> of the model details that we saw in <em class="italic">Figure 2.38</em> and <em class="italic">Figure 2.39</em>.</p>
<p>Inside this sub-section, you have the prediction<a id="_idIndexMarker205"/> frame link next to the predictions key. Clicking on it shows you the frame summary of your prediction values. Let’s do that so that we can get a good look at the prediction values.</p>
<p>The following screenshot shows you the prediction summary details in the form of a dataframe:</p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<img alt="Figure 2.44 – The prediction dataframe " height="385" src="image/B17298_02_044.jpg" width="987"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.44 – The prediction dataframe</p>
<p>H2O stores prediction results as dataframes, too. Therefore, they have the same features that we discussed in the <em class="italic">Working with Data Functions in H2O Flow</em> section.</p>
<p>The <strong class="bold">COLUMN SUMMARIES</strong> section indicates<a id="_idIndexMarker206"/> the three columns in the prediction dataframe. They are listed as follows:</p>
<ul>
<li><strong class="bold">Predict</strong>: This column is of the enum type and indicates the prediction value for the input rows in the prediction dataframe.</li>
<li><strong class="bold">P0</strong>: This column indicates the probability that the predicted value is 0.</li>
<li><strong class="bold">P1</strong>: This column indicates the probability that the predicted value is 1.</li>
</ul>
<p>Let’s view the data to better understand its contents. You can view the content of the dataframe by clicking on the <strong class="bold">View Data</strong> button in the <strong class="bold">Actions</strong> section of the prediction dataframe output, as shown in <em class="italic">Figure 2.44</em>.</p>
<p>The following screenshot shows you the expected output when viewing the prediction data: </p>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer063">
<img alt="Figure 2.45 – The content of the prediction dataframe " height="588" src="image/B17298_02_045.jpg" width="527"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.45 – The content of the prediction dataframe</p>
<p>Let’s return to the <strong class="bold">Prediction</strong> sub-section of the prediction<a id="_idIndexMarker207"/> output, as shown in <em class="italic">Figure 2.43</em>. Let’s combine the prediction results with the dataframe we used as input for the predictions. You can do this by clicking on the <strong class="bold">Combine predictions with frame</strong> button.</p>
<p>The following screenshot shows you the output of that operation:</p>
<div>
<div class="IMG---Figure" id="_idContainer064">
<img alt="Figure 2.46 – The Combine predictions with frame result " height="194" src="image/B17298_02_046.jpg" width="1065"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.46 – The Combine predictions with frame result</p>
<p>Clicking on the <strong class="bold">View Frame</strong> button shows you the combined frame, which is also a dataframe. Let’s click on the <strong class="bold">View Frame</strong> button to view the contents of the frame.</p>
<p>The following screenshot shows you the output of the <strong class="bold">View Frame</strong> operation from the frames’ combined output:</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> </p>
<div>
<div class="IMG---Figure" id="_idContainer065">
<img alt="Figure 2.47 – The dataframe used for prediction combined with prediction results " height="272" src="image/B17298_02_047.jpg" width="1039"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.47 – The dataframe used for prediction combined with prediction results</p>
<p>Selecting the <strong class="bold">View data</strong> button in the <strong class="bold">Actions</strong> section of the combined prediction output shows you the complete contents<a id="_idIndexMarker208"/> of the dataframe with the predicted values next to it.</p>
<p>The following screenshot shows you the contents of the combined dataframes:</p>
<div>
<div class="IMG---Figure" id="_idContainer066">
<img alt="Figure 2.48 – The content of the combined dataframes " height="616" src="image/B17298_02_048.jpg" width="951"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.48 – The content of the combined dataframes</p>
<p>Observing the contents of the combined dataframe, you will notice that you can now easily compare the predicted values, as mentioned in the <strong class="bold">predict</strong> column, and compare them with the actual value in the <strong class="bold">HeartDisease</strong> column on the same row.</p>
<p>Congratulations! You have officially made predictions on a model that you trained and combined the results into a single dataframe for a comparative view, which you can share with your stakeholders. So, this sums<a id="_idIndexMarker209"/> up our walk-through of how to create an ML pipeline using H2O Flow.</p>
<h1 id="_idParaDest-50"><a id="_idTextAnchor058"/>Summary </h1>
<p>In this chapter, we understood the various functionality that H2O Flow has to offer. After getting comfortable with the web UI, we started implementing our ML pipeline. We imported and parsed the Heart Failure Prediction dataset. We understood the various operations that can be performed on the dataframe, understood the metadata and statistics of the dataframe, and prepared the dataset to later train, validate, and predict models.</p>
<p>Then, we trained models on the dataframe using AutoML. We understood the various parameters that needed to be input to correctly configure AutoML. We trained models using AutoML and understood the leaderboard. Then, we dived deeper into the details of the models trained and tried our best to understand their characteristics.</p>
<p>Once our model was trained, we performed predictions on it and then explored the prediction output by combining it with the original dataframe so that we could compare the predicted values.</p>
<p>In the next chapter, we will explore the various data manipulation operations further. This will help us to gain an understanding of what steps need to be taken in terms of cleaning and transforming the dataframe and how it could improve the quality of the models trained.</p>
</div>
<div>
<div id="_idContainer068">
</div>
</div>
</div>

<div id="sbo-rt-content"><div class="Content" id="_idContainer069">
<h1 id="_idParaDest-51"><a id="_idTextAnchor059"/>Part 2 H2O AutoML Deep Dive</h1>
<p>This part will help you understand the inner workings of H2O AutoML. This will involve how H2O AutoML handles data processing, training, and the selection of models, and how it measures the performance of trained models. This part will also help you understand how to read the various performance graphs and other model details that will help make sense of the models’ behavior. All of this will help you further experiment and explore H2O AutoML and get the most out of it based on your needs.</p>
<p>This section comprises the following chapters:</p>
<ul>
<li><a href="B17298_03.xhtml#_idTextAnchor066"><em class="italic">Chapter 3</em></a>, <a id="_idTextAnchor060"/><em class="italic">Understanding Data Processing</em></li>
<li><a href="B17298_04.xhtml#_idTextAnchor090"><em class="italic">Chapter 4</em></a>, <a id="_idTextAnchor061"/><em class="italic">Understanding H2O AutoML Training and Architecture</em></li>
<li><a href="B17298_05.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <a id="_idTextAnchor062"/><em class="italic">Understanding AutoML Algorithms</em></li>
<li><a href="B17298_06.xhtml#_idTextAnchor129"><em class="italic">Chapter 6</em></a>, <a id="_idTextAnchor063"/><em class="italic">Understanding H2O AutoML Leaderboard and Other Performance Metrics</em></li>
<li><a href="B17298_07.xhtml#_idTextAnchor143"><em class="italic">Chapter 7</em></a>, <a id="_idTextAnchor064"/><em class="italic">Working with Model Explainability<a id="_idTextAnchor065"/></em></li>
</ul>
</div>
</div></body></html>