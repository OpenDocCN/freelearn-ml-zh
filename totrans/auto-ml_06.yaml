- en: '*Chapter 4*: Getting Started with Azure Machine Learning'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"As a technologist, I see how AI and the fourth industrial revolution will
    impact every aspect of people''s lives."'
  prefs: []
  type: TYPE_NORMAL
- en: – Fei-Fei Li, Professor of Computer Science at Stanford University
  prefs: []
  type: TYPE_NORMAL
- en: In the previous chapter, you were introduced to the major AutoML **Open Source
    Software** (**OSS**) tools and libraries. We did a tour of the major OSS offerings,
    including TPOT, AutoKeras, auto-sklearn, Featuretools, and Microsoft NNI, which
    will have helped you, the reader, understand the differential value propositions
    and approaches used in each of these libraries.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will start exploring the first of many commercial offerings,
    namely Microsoft's Azure capabilities in automated **Machine Learning** (**ML**).
    Azure Machine Learning is part of the Microsoft AI ecosystem, which helps accelerate
    the end-to-end ML life cycle using the power of the Windows Azure platform and
    services. We will start with an enterprise-grade ML service for building and deploying
    models that empowers developers and data scientists to build, train, and deploy
    ML models faster. With examples and walk-throughs, you will learn the fundamentals
    to build and deploy automated ML solutions using Azure.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Getting started with Azure Machine Learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Azure Machine Learning stack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Getting started with the Azure Machine Learning service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modeling with Azure Machine Learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Deploying and testing models with Azure Machine Learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Getting started with Azure Machine Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Not so long ago, if you wanted to use ML in a production environment on the
    Azure platform, you needed to bring together a bunch of different services to
    support the full ML life cycle.
  prefs: []
  type: TYPE_NORMAL
- en: For example, to use the datasets, you would need storage repositories such as
    Azure Blob storage or Azure Data Lake storage. For compute, you would either need
    individual virtual machines, Spark clusters using HDInsight, or Azure Databricks
    to actually run your model code. To protect your data for enterprise readiness,
    you'd need to bring in your virtual networks or configure your compute and data
    inside the same virtual network, along with Azure Key Vault to manage and secure
    your credentials. In order to provide repeatability for your experiments by using
    a consistent set of ML libraries, and the different versions thereof, you'd create
    Docker containers and use Azure Container Registry to store those Docker containers.
    You would need to put that inside your virtual network and then use Azure Kubernetes
    Service. Woah! This all sounds like a whole lot of stuff to piece together to
    get the ML and all the models and everything to work.
  prefs: []
  type: TYPE_NORMAL
- en: But things have progressed since, and you are in luck. With the Azure Machine
    Learning service, Microsoft removed that complexity. As a managed service, Azure
    Machine Learning comes with its own compute, hosted notebooks, and capabilities
    for model management, version control, and model reproducibility built right in.
    You can layer that on top of your existing Azure services. For example, you can
    plug in the compute and storage that you already have as well as your other infrastructure
    services. Azure Machine Learning connects and orchestrates them within a single
    environment so that you have one end-to-end modular platform for your entire ML
    life cycle, as you prepare data, build, train, package, and deploy your ML models.
  prefs: []
  type: TYPE_NORMAL
- en: 'Microsoft''s Azure Machine Learning development group offers a great cheat
    sheet ([aka.ms/mlcheatsheet](http://aka.ms/mlcheatsheet)) that helps you choose
    the best ML algorithm for the predictive analytics task at hand. Whether you want
    to predict between categories, discover a structure, or extract information from
    text, in the following flow you can find out the best algorithm based on your
    needs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.1 – The Machine Learning Algorithm Cheat Sheet overview'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.1_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.1 – The Machine Learning Algorithm Cheat Sheet overview
  prefs: []
  type: TYPE_NORMAL
- en: The Azure Machine Learning service makes for an ideal working environment for
    citizen data scientists. They get the services, tools, and virtually everything
    configured for them and the luxury of not having to compile all these individual
    services helps them do what matters most – solve the business problem. These subject
    matter experts also don't need to learn how to use new tools. You can use the
    Jupyter Notebooks, your favorite Python editor – including VS Code and PyCharm,
    and Azure Machine Learning works with any Python ML framework library, such as
    TensorFlow, PyTorch, scikit-learn, and so on. This is amazing in terms of making
    the life cycle a lot shorter, in terms of getting everything up and running. You
    will see some of these examples in the rest of this chapter as we walk through
    building a classification model using the Azure Machine Learning service.
  prefs: []
  type: TYPE_NORMAL
- en: The Azure Machine Learning stack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Microsoft Azure ecosystem is quite broad; in this chapter, we will focus
    on its AI and ML related cloud offerings, especially the Azure Machine Learning
    service.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following figure shows the offerings available for ML in the Azure cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.2 – Azure cloud ML offerings'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.2_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.2 – Azure cloud ML offerings
  prefs: []
  type: TYPE_NORMAL
- en: 'You can visit the following link for more information about the offerings in
    the preceding table: [https://docs.microsoft.com/en-us/azure/architecture/data-guide/technology-choices/data-science-and-machine-learning.](https://docs.microsoft.com/en-us/azure/architecture/data-guide/technology-choices/data-science-and-machine-learning'
  prefs: []
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
- en: 'It can be confusing to know which Azure Machine Learning offering should be
    chosen among the many described in the preceding table. The following diagram
    helps with choosing the right offering based on the given business and technology
    scenario:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.3 – Azure Machine Learning decision flow'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.3_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.3 – Azure Machine Learning decision flow
  prefs: []
  type: TYPE_NORMAL
- en: Automated ML is a part of the Azure Machine Learning service capabilities. Other
    capabilities include collaborative notebooks, data labeling, ML operations, a
    drag-and-drop designer studio, autoscaling capabilities, and many other tools
    described in the following table.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.4 – Azure Machine Learning key service capabilities'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.4_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.4 – Azure Machine Learning key service capabilities
  prefs: []
  type: TYPE_NORMAL
- en: 'The AI and ML capabilities offered in Azure are quite comprehensive and the
    best place to start looking into these in detail is the Azure AI Fundamentals
    Learning Path on Microsoft Learn: [https://aka.ms/AzureLearn_AIFundamentals.](https://aka.ms/AzureLearn_AIFundamentals'
  prefs: []
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
- en: 'The Azure Machine Learning service arguably provides virtually everything a
    data scientist needs. It includes environments, experiments, pipelines, datasets,
    models, endpoints, and workspaces, which helps enabling other Azure resources
    such as the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Azure Container Registry** (**ACR**): This registry stores information about
    the Docker containers used during training and deployment.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure storage account**: The default datastore for the ML workspace; it also
    stores the associated Jupyter notebooks.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Application Insights**: This stores model monitoring information.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Key Vault**: Credentials and other secrets for compute and workspace
    needs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To train any ML algorithm, you need processing capabilities, that is, compute
    resources. Azure supports a variety of different compute resources, ranging from
    your local machine to remote VMs. The following table outlines different training
    targets for workloads. As shown in the table, you can use a local computer, a
    compute cluster, a remote virtual machine, and a variety of other training targets
    for automated ML workloads:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.5 – Azure Machine Learning training targets'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.5_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.5 – Azure Machine Learning training targets
  prefs: []
  type: TYPE_NORMAL
- en: In the step-by-step walk-through, you will see how to create and select a compute
    target. Lastly, all ML algorithms need operationalization and deployment. The
    infamous adage *it works on my machine* only goes so far; therefore, you need
    a deployment compute resource to be able to host your model and provide an endpoint.
  prefs: []
  type: TYPE_NORMAL
- en: 'This is where your service resides and will be consumed from, also known as
    the compute target used for deployment. The following table shows different types
    of deployment targets:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.6 – Azure machine compute target'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.6_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.6 – Azure machine compute target
  prefs: []
  type: TYPE_NORMAL
- en: With this introduction to Azure Machine Learning capabilities, let's explore,
    step by step, how to build a classification model using the Azure Machine Learning
    service.
  prefs: []
  type: TYPE_NORMAL
- en: Getting started with the Azure Machine Learning service
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we will explore a step-by-step walk-through of creating a
    classification model using Azure Machine Learning:'
  prefs: []
  type: TYPE_NORMAL
- en: Sign up for a Microsoft account, unless if you already have one, then log into
    the Azure Machine Learning portal at [ml.azure.com](http://ml.azure.com). Here,
    you will see the ML studio as shown in the following figure. An Azure subscription
    is essentially the way you pay for services. You can either use your existing
    subscription if you have one or sign up for a new one. For a brand-new user, the
    nice folks at Azure offer a $200 credit to get you acquainted. Make sure to turn
    off the resources when you are not using them; don't leave the data center lights
    on:![Figure 4.7 – Azure Machine Learning service subscription startup page
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.7_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.7 – Azure Machine Learning service subscription startup page
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the following figure, you can see we have now been asked to select a subscription.
    In this case, we'll choose **Free Trial** to explore the services. You can also
    choose **Pay-As-You-Go**, in which case, your account will be charged based on
    your compute, storage, and other service usage:![Figure 4.8 – Azure Machine Learning
    service subscription selection page
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.8_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.8 – Azure Machine Learning service subscription selection page
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now that you have chosen your subscription, you will be taken to the Azure portal,
    where you can do an overwhelming number of things. In this case, click on `Machine`
    `Learning` service, you will see the following screen to create an Azure Machine
    Learning service. This is where you can create one or more ML workspaces. Now
    proceed by clicking on the **Create Azure Machine Learning** button:![Figure 4.10
    – Azure Machine Learning service startup page in the portal
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.10_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.10 – Azure Machine Learning service startup page in the portal
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Upon clicking **Create Azure Machine Learning**, you will be brought to the
    following page to create an ML workspace. This is where you will select your subscription,
    create a resource group, and select a geographical region:![Figure 4.11 – Azure
    Machine Learning service – creating a workspace
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.11_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.11 – Azure Machine Learning service – creating a workspace
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: The following figure shows the filled-out form for creating an ML workspace
    I called `auto-ml-workspace`. A **resource group** acts as a container for a collection
    of different resources, and hence associated assets (compute, storage, and so
    on):![Figure 4.12 – Azure Machine Learning service page
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.12_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.12 – Azure Machine Learning service page
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'A workspace can contain compute instances, experiments, datasets, models, deployment
    endpoints, and so on, and is the top-level resource in Azure Machine Learning.
    You can refer to the breakdown of Azure workspaces shown in the following figure:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.13 – What is an Azure Machine Learning workspace?'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.13_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.13 – What is an Azure Machine Learning workspace?
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Upon clicking the **Create** button under **Project details**, your ML service
    will be deployed, and the associated dependencies will be created. It can take
    a few minutes. You will see something like the following figure:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.14 – Azure Machine Learning service deployment'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.14_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.14 – Azure Machine Learning service deployment
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Once the deployment is complete, you will see the resource group and its associated
    resources, as shown in the following figure. You can now click on the **Go to
    resource** button, which will take you to the ML workspace:![Figure 4.15 – Azure
    Machine Learning deployment completion screen
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.15_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.15 – Azure Machine Learning deployment completion screen
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: This is your ML workspace. Here, you can see your **Resource group**, **Subscription**,
    **Key Vault**, and all the important high-level details, but you are not in the
    ML arena, yet. There is one more click to go. So now, go ahead and click on the
    **Launch studio** button to take you to the ML studio:![Figure 4.16 – Azure Machine
    Learning workspace console to launch studio
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.16_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.16 – Azure Machine Learning workspace console to launch studio
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, the following is the screen you have been patiently waiting for all this
    time: the ML studio! Go ahead, take the tour by clicking on the **Start the tour**
    button – we will wait:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 4.17 – Azure Machine Learning studio home page'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.17_B16890_.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.17 – Azure Machine Learning studio home page
  prefs: []
  type: TYPE_NORMAL
- en: 'The following figure shows the Azure Machine Learning studio. There used to
    be a "classic" version of the ML studio but it''s no longer active so we will
    just focus on this new shiny web-based portal, which helps you do all things ML.
    On the left pane, you can see all the different offerings, which are also offered
    via a dropdown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.18 – Azure Machine Learning studio home page'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.18_B16890_.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.18 – Azure Machine Learning studio home page
  prefs: []
  type: TYPE_NORMAL
- en: The UI is modern, clean, and efficient. You can start by creating a new **Notebook**,
    an automated ML experiment, or a designer. Each of these offerings has a different
    purpose, yet they have a similar underlying infrastructure. Notebooks are great
    tools for hands-on data scientists, while automated ML experiments are targeted
    at AI democratization. The designer interface provides drag-and-drop capabilities
    to prepare data and deploy models.
  prefs: []
  type: TYPE_NORMAL
- en: Modeling with Azure Machine Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Before we create an automated ML workflow, let''s start with a simple Azure
    notebook:'
  prefs: []
  type: TYPE_NORMAL
- en: Azure notebooks are an integrated part of the Azure Machine Learning service,
    and you can either create or use a sample notebook to get started:![Figure 4.19
    – Azure Machine Learning sample notebooks
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.19_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.19 – Azure Machine Learning sample notebooks
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the `MNIST` and it will filter to show you the notebooks. Select the `image-classification-part1-training.ipynb`
    file to see the notebook in the right pane, and click on **Clone this notebook**
    to create your own copy:![Figure 4.20 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.20_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.20 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click on the `yml` configuration files to the `user` directory:![Figure 4.21
    – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.21_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.21 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now that you have cloned the assets, it's time to have a compute target. You
    cannot run a notebook without, well, actually having a machine to run it on. As
    you saw earlier, we were able to run code either on Google Colab or locally. In
    this case, we are running this workload on Azure, which requires us to be more
    explicit about our intent, hence you have to create a compute target to proceed.
    Click on **Create compute**:![Figure 4.22 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.22_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.22 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Once you''ve clicked on **Create compute**, you will be shown what kind of
    compute options are on offer, along with their associated cost. It''s no surprise
    that bigger and better hardware will cost you more:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You can read about different types of VMs and their associated costs at [https://azure.microsoft.com/en-us/pricing/details/virtual-machines/series/](https://azure.microsoft.com/en-us/pricing/details/virtual-machines/series/).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.23 – Create the new compute instance'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.23_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.23 – Create the new compute instance
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: For the purpose of this AutoML notebook, we will select a standard small VM,
    as seen in the following figure, and create the compute instance. You can create
    multiple compute instances and assign them to different experiments as needed:![Figure
    4.24 – Creating a new compute instance
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.24_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.24 – Creating a new compute instance
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click on **Create** to create a new compute instance – as you create a compute
    instance, which can take some time as you stare at the revolving circle of patience,
    you can explore other parts of the Azure Machine Learning portal:![Figure 4.25
    – MNIST automated ML compute instance
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.25_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.25 – MNIST automated ML compute instance
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, the compute is ready to be used, as seen in the following figure. First,
    you get the status **Starting**, seen in the following figure:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.26 – Compute instance attributes'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.26_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.26 – Compute instance attributes
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'The compute instance status will change to **Running** when the compute instance
    is ready. You can choose to **Stop**, **Restart**, or **Delete** a compute resource
    as you please. Just remember that it will jeopardize its dependencies (things
    using or planning to use this compute resource):'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.27 – Compute instance running'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.27_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.27 – Compute instance running
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Navigate back to the notebook by clicking on the `image-classification-mnist-data`
    notebook open, we can run the code to make sure that it works. And you can see
    the Azure Machine Learning SDK version gets printed in the following figure:![Figure
    4.28 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.28_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.28 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: One configuration step still remains – you have to authenticate to use the workspace
    to be able to utilize the resources. In order to do that, there is an interactive
    authentication system built in where you click the link (`devicelogin`) shown
    in the following figure and enter the code (also in the following figure) to authenticate.
    I am sure you won't be using the code in the following figure – it won't work,
    but nice try!![Figure 4.29 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.29_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.29 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now that we are authenticated and all, let's create a compute target. All the
    `boilerplate` code for configuration is already written for you as part of the
    Jupyter notebook. By running the cell shown in the following figure, you can now
    connect to the `ComputeTarget` programmatically and provision the node:![Figure
    4.30 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.30_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.30 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now it's time to programmatically download the MNIST dataset for training. Yann
    LeCun (Courant Institute, NYU) and Corinna Cortes (Google Labs, New York) hold
    the copyright of the MNIST dataset, which is a derivative work from the original
    MNIST datasets. The MNIST dataset is made available under the terms of the Creative
    Commons Attribution-Share Alike 3.0 license. Once downloaded, you can also visualize
    it as shown in the following notebook screenshot:![Figure 4.31 – MNIST image classification
    notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.31_B16890_.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.31 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: As you probably have remembered from our earlier adventures with MNIST, we will
    create the training and testing split for the dataset as shown in the following
    figure and train a logistic regression model. We'll now also create an estimator,
    which is used to submit the run to the cluster:![Figure 4.32 – MNIST image classification
    notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.32_B16890.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.32 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: When working in Azure Machine Learning, one cardinal rule to remember is that
    all experiments and associated runs are interlinked to maintain the consistency
    of the ecosystem. This helps a lot since, regardless of where you run your experiment
    (in a notebook, JupyterLab, as custom code, and so on), you can pull up the runs
    and see the details. More on this soon.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'In the following figure, you see the code demonstrating the creation of an
    estimator, and then submitting the job to the cluster by calling the `submit`
    function of the `experiment` object:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 4.33 – MNIST image classification notebook'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '](img/Figure_4.33_B16890.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.33 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: At this point, running the cells in the following figure demonstrates how you
    can visualize the details of `experiment` using the Jupyter widget `wait_for_completion`
    method to see the status of the job. This shows the job running on the remote
    cluster, and the corresponding build log as part of the widget. You can see the
    **Run** details as part of the widget as shown in the following figure:![Figure
    4.34 – MNIST image classification notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.34_B16890.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.34 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'As the job runs on the remote cluster, and we see the results streaming in,
    you can observe the training unfold in front of your eyes with the corresponding
    percentage indicator:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.35 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.35_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.35 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'As the job completes, you will see the time taken and the run ID displayed
    in the widget, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.36 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.36_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.36 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also see the details of the experiment in the web UI by clicking on
    the details page that follows. You can see detailed documentation about how experiments
    work by looking at the docs page link shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.37 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.37_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.37 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the training is complete, you will see the results metrics logged during
    the run, and can also register the model. This means you get the corresponding
    `.pkl` file for the model:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.38 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.38_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.38 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'Now you can retrieve all the metrics logged during the run by calling `run.get_metrics()`,
    including the accuracy of the model. In this case, the accuracy is 0.9193:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.39 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.39_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.39 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'At this point, the notebook automatically saves the model file (`.pkl`) as
    the output in the output folder. You can see the files by calling the `run.get_file_names()`
    method. In the next steps, we will use this model file to create a web service
    and invoke it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.40 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.40_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.40 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: Deploying and testing models with Azure Machine Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The model is now trained, a .`pkl` file has been created, and the model can
    be deployed for testing. The deployment part is done in the second notebook, `part2-deploy.ipynb`,
    as seen in the following figure. To deploy the model, we open up the `part 2-deploy.ipynb`
    notebook by clicking on the notebook in the left pane. We load the .`pkl` file
    by calling the `joblib.Load` method. You also see the `run` method in the following
    screenshot, which receives the raw JSON data, invokes the model''s `predict` method,
    and returns the result:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.41 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.41_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.41 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'In this step, we create a model object by calling the `Model` constructor as
    shown in the following figure. This model uses the configuration properties from
    the `Environment` object, and the service name to deploy the endpoint. This endpoint
    is deployed using **Azure Container Instances** (**ACI**). The endpoint location
    is available once the deployment is successful:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.42 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.42_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.42 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: You can now retrieve the scoring URI, which can be used to invoke the service
    and get the results from the model:![Figure 4.43 – MNIST image classification
    notebook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/Figure_4.43_B16890.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 4.43 – MNIST image classification notebook
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now you can invoke the web service to get the results:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 4.44 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.44_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.44 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also see the corresponding confusion matrix by invoking the `confusion_matrix`
    method:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.45 – MNIST image classification notebook'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_4.45_B16890.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.45 – MNIST image classification notebook
  prefs: []
  type: TYPE_NORMAL
- en: This completes the whole cycle of building a model, deploying, and testing it
    within Azure Machine Learning. We will continue with automated ML in the next
    chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, you learned how to get started with the Microsoft Azure platform,
    the ML services ecosystem capabilities, and learned about Microsoft's AI and ML
    offerings. You were also briefed on different capabilities within the Azure platform,
    such as collaborative notebooks, drag and drop ML, MLOPS, RStudio integration,
    reinforcement learning, enterprise-grade security, automated ML, data labeling,
    autoscaling compute, integration with other Azure services, responsible ML, and
    cost management. Finally, to test your newly discovered Azure superpowers, you
    configured, built, deployed, and tested a classification web service using an
    Azure Machine Learning notebook.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will further dive into using the automated ML features
    of the Azure Machine Learning service.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For more information on the following topics, you can visit the given links:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Python notebooks with ML and deep learning examples with Azure Machine Learning:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://github.com/Azure/MachineLearningNotebooks](https://github.com/Azure/MachineLearningNotebooks'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
- en: What are compute targets in Azure Machine Learning?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://docs.microsoft.com/en-us/azure/machine-learning/concept-compute-target](https://docs.microsoft.com/en-us/azure/machine-learning/concept-compute-target'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
- en: 'Use automated ML in an Azure Machine Learning pipeline in Python:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-automlstep-in-pipelines](https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-automlstep-in-pipelines'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
- en: 'A critical overview of AutoML solutions by Bahador Khaleghi:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://medium.com/analytics-vidhya/a-critical-overview-of-automl-solutions-cb37ab0eb59e](https://medium.com/analytics-vidhya/a-critical-overview-of-automl-solutions-cb37ab0eb59e'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: )
  prefs: []
  type: TYPE_NORMAL
