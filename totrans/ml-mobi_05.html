<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Regression Using Core ML in iOS</h1>
                </header>
            
            <article>
                
<p>This chapter will provide you with an overview of regression algorithms and insights into the basics of Core ML, and will introduce you to creating a machine learning program leveraging a regression algorithm and predicting the housing price for a given set of housing-related data using Core ML in iOS.</p>
<p>As we already saw in <a href="51fcaf51-eb68-4493-afc2-0b02f1c1d50e.xhtml" target="_blank">Chapter 1</a>, <em>Introduction to Machine Learning on Mobile</em>, any machine learning program has four phases. We will see what we are going to cover in the four phases and what tools we are going to use to solve the underlying machine learning problem.</p>
<p><strong>Problem definition</strong>: The housing information of a certain area is provided and we want to predict the <span>median value of a home in this area.</span></p>
<p>We will be covering the following topics in the chapter:</p>
<ul>
<li>Understanding what regression is and how to apply it to solve an ML problem</li>
<li>Understanding regression using a sample dataset and Excel</li>
<li>Understanding the basics of Core ML</li>
<li>Solving the problem using regression in Core ML:
<ul>
<li>Technical requirements</li>
<li>How to create the model file using scikit-learn </li>
<li>Testing the model</li>
<li>Understanding how to import the scikit-learn model into the Core ML project</li>
<li>Writing an iOS mobile application and using the <span>scikit-learn</span> model in it and doing the housing price prediction</li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction to regression</h1>
                </header>
            
            <article>
                
<p><span>Regression analysis is a basic method used in the statistical analysis of data. It's a statistical method that helps to find the relationships between variables. It is basically used for understanding the relationship between input and output numerical variables. We should first identify the dependent variable, which will vary based on the value of the independent variable. For example, the value of the house (dependent variable) varies based on the square footage of the house (independent variable). Regression analysis is very useful for prediction.</span></p>
<p>In a simple regression problem (a single <em>x</em> and a single <em>y</em>), the form of the model would be as follows:</p>
<div class="CDPAlignCenter CDPAlign"><em>y = A + B*x</em></div>
<p>In higher dimensions, when we have more than one input (<em>x</em>), the line is called a <strong>plane</strong> or a <strong>hyperplane</strong>. </p>
<p>In our example, we predict the price of the house based on the various parameters that may impact the price of the data in that particular area.</p>
<p>The following are some of the important points to be considered while addressing a regression problem:</p>
<ul>
<li>The prediction is to be a numeric quantity.</li>
<li>The input variables can be real-valued or discrete.</li>
<li>If there are multiple input variables then it is called a <strong>multivariate regression problem</strong>.</li>
<li>When the input variables are ordered by time, the regression problem is called a <strong>time series forecasting problem</strong>.</li>
<li>Regression should not be confused with classification. Classification is the task of predicting a discrete class label, whereas regression is the task of predicting a continuous quantity.</li>
</ul>
<p><span>An algorithm that is capable of learning a regression predictive model is called a <strong>regression algorithm</strong>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Linear regression</h1>
                </header>
            
            <article>
                
<p>In this section, we will try to understand linear regression using a detailed example with a specific dataset. We are going to use the same dataset to work out the iOS Core ML example too.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dataset</h1>
                </header>
            
            <article>
                
<p>We will use the Boston dataset for the regression problem. <span>This dataset contains information collected by the US Census Service concerning housing in the area of Boston, Massachusetts. It was obtained from the StatLib archive (</span><a href="http://lib.stat.cmu.edu/datasets/boston">http://lib.stat.cmu.edu/datasets/boston</a><span>) and has been used extensively throughout the literature to benchmark algorithms.</span><span> The dataset is small in size, with only 506 cases.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dataset naming</h1>
                </header>
            
            <article>
                
<p>The name for this dataset is simply<span> </span><strong>Boston</strong>. It has two photo tasks:<span> </span>now, in which the nitrous oxide level is to be predicted; and<span> </span>price, in which the median value of a home is to be predicted.</p>
<p>Miscellaneous details about the dataset are as follows:</p>
<ul>
<li><strong>Origin</strong>: The origin of the Boston housing data is<span> </span>Natural.</li>
<li><strong>Usage</strong>: This dataset may be used for<span> </span>assessment.</li>
<li><strong>Number of cases</strong>: The dataset contains a total of<span> </span>506<span> </span>cases.</li>
<li><strong>Order</strong>: The order of the cases is<span> </span>mysterious.</li>
<li><strong>Variables</strong>: There are<span> </span>14<span> </span>attributes in each case of the dataset. They are the following:
<ul>
<li><strong>CRIM</strong>: Per capita crime rate by town</li>
<li><strong>ZN</strong>: A proportion of residential land zoned for lots over 25,000 sq.ft</li>
<li><strong>INDUS</strong>: A proportion of nonretail business acres per town</li>
<li><strong>CHAS</strong>: Charles River dummy variable (1 if tract bounds river; 0 otherwise)</li>
<li><strong>NOX</strong>: Nitric oxide concentration (parts per 10 million)</li>
<li><strong>RM</strong>: Average number of rooms per dwelling</li>
<li><strong>AGE</strong>: A proportion of owner-occupied units built prior to 1940</li>
<li><strong>DIS</strong>: Weighted distances to five Boston employment centers</li>
<li><strong>RAD</strong>: Index of accessibility to radial highways</li>
<li><strong>TAX</strong>: Full-value property-tax rate per $10,000</li>
<li><strong>PTRATIO</strong>: Pupil-teacher ratio by a town</li>
<li><strong>B</strong>: <kbd>1000(Bk - 0.63)^2</kbd> where <kbd>Bk</kbd> is the proportion of blacks by a town</li>
<li><strong>LSTAT</strong>: Percentage lower status of the population</li>
<li><strong>MEDV</strong>: A median value of owner-occupied homes in $1000</li>
</ul>
</li>
</ul>
<p>We will try out both simple linear regression as well as multivariate regression using Excel for the dataset and understand the details. We will consider only the following 20 data elements from the 506 sample data space from the Boston dataset for our analysis purposes:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-916 image-border" src="assets/30b33a7e-b904-46bb-9b2b-7e0e6891cc6d.png" style="width:75.08em;height:32.42em;"/></p>
<p>Now, we can use the data analysis option given in Excel and try to predict the <kbd>MV</kbd> considering the dependent variable <kbd>DIS</kbd> alone. In data analysis, select <kbd>Regression</kbd> and select the <kbd>MV</kbd> as the <kbd>Y</kbd> value and <kbd>DIS</kbd> as the <kbd>X</kbd> value. This is a simple regression with one dependent variable to predict the output. The following is the output produced by Excel:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-917 image-border" src="assets/bdd8cb77-8ee6-4ba9-b811-b7583870d694.png" style="width:44.42em;height:18.50em;"/></p>
<p>The linear regression equation for prediction of <kbd>MV</kbd> with <kbd>DIS</kbd> as the dependent variable would be <em>Y = 1.11X + 17.17</em> (<kbd>DIS</kbd> coefficient of <kbd>DIS</kbd> + intercept value):</p>
<p class="CDPAlignCenter CDPAlign"><em>R2 =0.0250</em></p>
<p>Now, we can see the predicted output of <kbd>MV</kbd> for the set of 20 data samples considered for analysis:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-706 image-border" src="assets/91d8140e-e041-4d7e-8a2c-4f632a6714d9.png" style="width:33.17em;height:25.75em;"/></div>
<p>The output chart for the <kbd>MV</kbd> predicted for the <kbd>DIS</kbd> as a dependent variable is given as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-705 image-border" src="assets/95f4d6ac-183c-40b7-83ac-4e5d78c256f4.png" style="width:24.17em;height:12.58em;"/></p>
<p>Now, we get an understanding of how linear regression works for a single, dependent variable. In the same way, we can have any number of dependent variables, by including them as <em>X1</em>, <em>X2</em>, <em>X3</em>, ... <em>XN</em>.</p>
<p>In our dataset, we have 14 variables in total and we can have the <kbd>MV</kbd> dependent on all the remaining 13 variables and create the regression equation in the same manner as specified previously for a single variable.</p>
<p>Now that we have understood how to perform regression for our Boston dataset using Excel, we will be performing the same using Core ML. Before going ahead and implementing in Core ML, we will must understand what Core ML is and look into the basics of Core ML.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding the basics of Core ML</h1>
                </header>
            
            <article>
                
<p><span>Core ML enables iOS mobile applications to run machine learning models locally on a mobile device. It enables developers to integrate a broad variety of machine learning model types into a mobile application. Developers do not require extensive knowledge of machine learning or deep learning to write machine learning mobile applications using Core ML. </span><span>They just need to know how to include the ML model into the mobile app similar to other resources and use invoke it in the mobile application. A data scientist or a machine learning expert can create an ML model in any technology they are familiar with, say Keras, scikit-learn, and so on. Core ML provides tools to convert the ML data model created using other tools (tensor, scikit-learn, and so on) to a format that is mandated by Core ML. </span></p>
<p><span>This conversion to a Core ML model happens during the app development phase. It does not happen in real time when the application is being used. The conversion is done by using the <kbd>coremltools</kbd> Python library. When the app deserializes a Core ML model, it becomes an object having a <kbd>prediction</kbd> method. Core ML is not really meant for training, just for running pretrained models.</span></p>
<p><span>Core ML supports extensive deep learning capabilities with support for more than 30 layers. The layers in deep learning actually suggest the number of layers through which the data is transformed. It also supports standard models: tree ensembles, SVMs, and linear models. It is built on top of low-level technologies such as </span>Metal<span>. Core ML seamlessly takes advantage of the CPU and GPU to provide maximum performance and efficiency. It has the ability to switch between CPU and GPU based on the intensity of the task at hand. Since Core ML lets machine learning run locally on the device, data doesn't need to leave the device to be analyzed.</span></p>
<p>With Core ML, we can integrate trained machine learning models into our app:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-704 image-border" src="assets/a084aaaf-f488-4a3e-b4db-b45bab1c0df3.png" style="width:16.58em;height:17.25em;"/></p>
<p>A<span> </span>trained model<span> </span>is the result of applying a machine learning algorithm to a set of training data. The model makes predictions based on new input data. For example, a model that's been trained in a region's historical house prices may be able to predict a house's price when given the number of bedrooms and bathrooms.</p>
<p><span>Core ML is optimized for on-device performance, which minimizes memory footprint and power consumption. Running strictly on the device ensures the privacy of user data and guarantees that our app remains functional and responsive when a network connection is unavailable.</span></p>
<p>Core ML is the foundation for domain-specific frameworks and functionality. Core ML supports<span> <strong>Vision</strong></span><span> </span>for image analysis,<span> </span>Foundation<span> </span>for <strong>natural language processing</strong>, and<span> <strong>G</strong></span><strong>ameplaykit</strong><span> </span>for evaluating learned decision trees. <strong>Core ML</strong> itself builds on top of low-level primitives such as <strong>Accelerate<span> </span></strong>and <strong>BNNS</strong>, as well as<span> </span><strong>Metal Performance Shaders</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-698 image-border" src="assets/04f6501e-e6bf-4614-9a2c-e887484d1c7d.png" style="width:32.33em;height:13.25em;"/></p>
<p>An iOS developer who is going to write ML programs using Core ML <span>needs to be aware of </span><span>the following fundamental steps:</span></p>
<ol>
<li>Create the model outside of iOS. This can be done using scikit-learn, TensorFlow, or in any other way with which the developer is comfortable. Create the machine learning model file. For creating the machine learning model file, they need to be aware of the four key phases of machine learning already discussed.</li>
<li>Once the model is built, tested, and ready for use, this model needs to be converted to a format that is compatible with Core ML. Core ML tools are available that actually help to convert the model file created using any tool to a model file that is in a format as mandated by Core ML (<kbd>.mlmodel</kbd> file format).</li>
<li>Once the Core ML specific model file is created, the same can be imported into the iOS program and the Core ML-provided APIs can be used to interact with the model file to extract the required information as may be required by the iOS application, basically importing the <kbd>.mlmodel</kbd> file into the <kbd>resources</kbd> folder of the Xcode project.</li>
</ol>
<div class="packt_infobox"><span>Core ML's biggest advantage is that it is extremely simple to use. Just a few lines of code can help to integrate a complete ML model. Core ML can only help to integrate </span>pretrained<strong><span> </span></strong><span>ML models into an application. No model training is possible.</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Solving the problem using regression in Core ML</h1>
                </header>
            
            <article>
                
<p>This section will go through the details of creating a regression model and then using the regression model in an iOS mobile application. It will provide a detailed walk-through of the various steps involved in creating an iOS regression ML application to address the problem defined.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>The following software needs to be installed on the developer machine:</p>
<ul>
<li>Python</li>
<li>Xcode in a Mac environment</li>
</ul>
<p><span>The exercise programs for this chapter can be downloaded from our GitHub repository at <a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction">https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction</a>. </span></p>
<p class="mce-root">In the following program, we are going to use <kbd>pandas</kbd>, <kbd>numpy</kbd>, and <kbd>scikit-learn</kbd> to create the model. So, install these packages from the <kbd>pip</kbd> package manager using the following command from the Command Prompt/Terminal:</p>
<pre>pip install scikit-learn<br/>pip install numpy<br/>pip install pandas</pre>
<p>In order to convert the created model to the Core ML format, we need to use the Core ML <kbd>scikit-learn</kbd> Python converter provided by Apple:</p>
<pre><strong><span class="">pip install -U coremltools</span></strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to create the model file using scikit-learn</h1>
                </header>
            
            <article>
                
<p>This section will explain how we are going to create the linear regression model file using <kbd><span>scikit-learn</span></kbd> and also convert it into the <kbd>.mlmodel</kbd> file that is compatible with Core ML. We are going to use the Boston dataset for the model creation. The following is a simple Python program, which creates a simple linear regression model using <kbd><span>scikit-learn</span></kbd> using the Boston dataset. Then the Core ML tools convert it into the model file compatible with Core ML. Let's go through the program in detail.</p>
<p>First, we need to import the required packages needed for the program:</p>
<pre># importing required packages<br/> import numpy as np</pre>
<p>The preceding lines import the NumPy package. NumPy is the fundamental package for scientific computing with Python. It contains <span>a powerful N-dimensional array object. This <kbd>numpy</kbd> array will be used in this program for storing the dataset, which has 14 dimensions:</span></p>
<pre>import pandas as pd<br/> from pandas.core import series</pre>
<p>The preceding line imports the <kbd>pandas</kbd> package,<span> an open source, BSD-licensed library providing high-performance, easy-to-use data structures and data analysis tools for the </span>Python<span> programming language.</span> Using pandas, we can create a data frame. You can assume a <kbd>pandas</kbd> data frame as an Excel spreadsheet in which every sheet has headings and data:</p>
<pre>import coremltools<br/> from coremltools.converters.sklearn import _linear_regression</pre>
<p>The preceding lines import the Core ML Tools conversion package for the linear regression model that we have used in this program. Core ML Tools is a Python package for creating, examining, and testing models in the <kbd>.mlmodel</kbd> format. In particular, it can be used to do the following:</p>
<ul>
<li>Convert existing models to the <kbd>.mlmodel</kbd> format from popular machine learning tools including <kbd>Keras</kbd>, <kbd>Caffe</kbd>, <kbd>scikit-learn</kbd>, <kbd>libsvm</kbd>, and <kbd>XGBoost</kbd></li>
<li>Express models in <kbd>.mlmodel</kbd> format through a simple API</li>
<li>Make predictions with an <kbd>.mlmodel</kbd> (on select platforms for testing purposes):</li>
</ul>
<pre>from sklearn import datasets, linear_model<br/> from sklearn.metrics import mean_squared_error, r2_score</pre>
<p>The preceding lines import the <kbd>sklearn</kbd> packages. Data sets are used to import built-in datasets in the <kbd>sklearn</kbd> package. In this program, we are using the Boston housing price dataset that was explained in the previous section. The <kbd>linear_model</kbd> package is used to get access to the linear regression function, and the metrics package is used to calculate the testing metrics of our model, such as the mean squared error:</p>
<pre>boston = datasets.load_boston()</pre>
<p>The preceding line loads the Boston dataset from the <kbd>sklearn</kbd> datasets package:</p>
<pre> bos = pd.DataFrame(boston.data)</pre>
<p>Now, from the entire dataset, we need to extract the data:</p>
<pre><br/> bos.columns = boston.feature_names</pre>
<p>Get the column names, that is, the headings for that data:</p>
<pre>bos['price'] = boston.target</pre>
<p>Now, let's define the target column that we want to predict. The column defined as the target will be the one that will be predicted:</p>
<pre> x = bos.drop('price', axis=1)</pre>
<p>Once we define the target column, we will remove the data from the target column, so that it becomes <kbd>x</kbd>:</p>
<pre> y = bos.price</pre>
<p> Since we defined price as the target column, <kbd>y</kbd> is the price column in the dataset's data:</p>
<pre> X_train,X_test,Y_train,Y_test = sklearn.model_selection.train_test_split(x,y,test_size=0.3,random_state=5)</pre>
<p>We then split the data into training and test data as per the 70/30 rule:</p>
<pre> lm = sklearn.linear_model.LinearRegression() </pre>
<p>Once we have the training and test data, we can initiate a linear regression object:</p>
<pre> lm.fit(X_train, Y_train)</pre>
<p>With the linear regression object that has been initialized, we just have to feed the training and the test data into the regression model:</p>
<pre>Y_pred = lm.predict(X_test)</pre>
<p>The preceding line predicts the target:</p>
<pre>mse = sklearn.metrics.mean_squared_error(Y_test, Y_pred)<br/>print(mse);</pre>
<p>The preceding lines will calculate the mean squared error in our fitted model and predicted results.</p>
<p>Because a regression predictive model predicts a quantity, the skill of the model must be reported as an error in those predictions.</p>
<p>There are many ways to estimate the skill of a regression predictive model, but the most common is to calculate the <strong>root mean squared error</strong> (<strong>RMSE</strong>).</p>
<p>For example, if a regression predictive model made two predictions, one of <em>1.5</em> where the expected value is <em>1.0</em> and another of 3.3 and the expected value is <em>3.0</em>, then the <em>RMSE</em> would be as follows:</p>
<table style="border-collapse: collapse;width: 410px;height: 167px" border="1">
<tbody>
<tr>
<td style="width: 51px">1</td>
<td style="width: 353px"><em><span>RMSE = sqrt(average(error^2))</span></em></td>
</tr>
<tr>
<td style="width: 51px">2</td>
<td style="width: 353px">
<div class="crayon-line crayon-striped-line"><em>RMSE = sqrt(((1.0 - 1.5)^2 + (3.0 - 3.3)^2) / 2)</em></div>
</td>
</tr>
<tr>
<td style="width: 51px">3</td>
<td style="width: 353px">
<div class="crayon-line"><em>RMSE = sqrt((0.25 + 0.09) / 2)</em></div>
</td>
</tr>
<tr>
<td style="width: 51px">4</td>
<td style="width: 353px">
<div class="crayon-line crayon-striped-line"><em>RMSE = sqrt(0.17)</em></div>
</td>
</tr>
<tr>
<td style="width: 51px">5</td>
<td style="width: 353px"><em><span>RMSE = 0.412</span></em></td>
</tr>
</tbody>
</table>
<p> </p>
<p>A benefit of <em>RMSE</em> is that the units of the error score are in the same units as the predicted value:</p>
<pre> model = coremltools.converters.sklearn.convert(<br/>     sk_obj=lm,<span>input_features=boston.feature_names,</span><br/><span>     output_feature_names='price')</span></pre>
<p>In the preceding line, we are converting the fitted model to the Core ML format. Basically, this is the line where the <kbd>.mlmodel</kbd> file is created. And we are also specifying the input and output column names:</p>
<pre> model.save('HousePricer.mlmodel')</pre>
<p>In the preceding line, we are saving the model to the disk. This can later be used in our iOS program.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Running and testing the model</h1>
                </header>
            
            <article>
                
<p>When the model created by <kbd><span>scikit-learn</span></kbd> was executed and tested independently before converting it into the Core ML format, the following variance and mean square error were found:</p>
<ul>
<li>The mean square error for the prepared model was <kbd>30.703232</kbd></li>
<li>The variance score was <kbd>0.68</kbd></li>
<li>The process finished with exit code <kbd>0</kbd></li>
</ul>
<p class="mce-root"/>
<p>The following graph gives an idea of the predicted values versus the actual values:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-701 image-border" src="assets/2d37875f-7070-4c8b-805f-f43c360f59a9.png" style="width:57.33em;height:29.83em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing the model into the iOS project</h1>
                </header>
            
            <article>
                
<p>The following is the project structure of the Xcode project where the <kbd>.mlmodel</kbd> file is imported and used for prediction:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-702 image-border" src="assets/e388c71b-ab13-4629-a3dc-a3e8e67ffb0f.png" style="width:18.00em;height:18.50em;"/></p>
<p>The <kbd>ViewCcontroller.swift</kbd> file is where the model file created is used and the housing prediction is carried out in a mobile application. </p>
<p>The <kbd>housePricer.mlmodel</kbd> file is the model file that was created using <kbd><span>scikit-learn</span></kbd> and converted into the ML model file using the Core ML converter tools. This file is included in the <kbd>resources</kbd> folder of the iOS Xcode project.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Writing the iOS application</h1>
                </header>
            
            <article>
                
<p>This section provides the details of the <kbd>Swift</kbd> code that uses the model in the <kbd>.mlmodel</kbd> format and does the housing price prediction:</p>
<pre>//  ViewController.swift<br/>import UIKit<br/>import CoreML<br/>class ViewController: UIViewController {<br/>    let model = HousePricer()</pre>
<p>This line is to initialize the model class that we have imported into the project. The following lines define outlets/variables to the text fields to interact with them:</p>
<pre> @IBOutlet weak var crim: UITextField!<br/>    @IBOutlet weak var zn: UITextField!<br/>    @IBOutlet weak var price: UILabel!<br/>    @IBOutlet weak var b: UITextField!<br/>    @IBOutlet weak var ptratio: UITextField!<br/>    @IBOutlet weak var medv: UITextField!<br/>    @IBOutlet weak var lstat: UITextField!<br/>    @IBOutlet weak var rad: UITextField!<br/>    @IBOutlet weak var tax: UITextField!<br/>    @IBOutlet weak var dis: UITextField!<br/>    @IBOutlet weak var age: UITextField!<br/>    @IBOutlet weak var rm: UITextField!<br/>    @IBOutlet weak var nox: UITextField!<br/>    @IBOutlet weak var chas: UITextField!<br/>    @IBOutlet weak var indus: UITextField!<br/>    override func didReceiveMemoryWarning() {<br/>        super.didReceiveMemoryWarning()<br/>        // Dispose of any resources that can be recreated.<br/>    }<br/>    override func viewDidLoad() {<br/>        super.viewDidLoad();<br/>        updated(rad);<br/>    }<br/>    @IBAction func updated(_ sender: Any) {<br/>        guard let modeloutput = try? model.prediction(CRIM: Double(crim.text!)!, ZN: Double(zn.text!)!, INDUS: Double(indus.text!)!, CHAS: Double(chas.text!)!, NOX: Double(nox.text!)!, RM: Double(rm.text!)!, AGE: Double(age.text!)!, DIS: Double(dis.text!)!, RAD: Double(rad.text!)!, TAX: Double(tax.text!)!, PTRATIO: Double(ptratio.text!)!, B: Double(b.text!)!, LSTAT: Double(lstat.text!)!) else {<br/>            fatalError("unexpected runtime error")<br/>     }<br/>        price.text = "$" + String(format: "%.2f",modeloutput.price);<br/>    }<br/>}</pre>
<p> </p>
<p> </p>
<p>The preceding function is added as an <kbd>onchange</kbd> listener to all the preceding text fields. In this, we are using the model object we have created previously and predicting the price for the given values in the text fields.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Running the iOS application</h1>
                </header>
            
            <article>
                
<p>The Xcode project created was executed in the simulator and the following is the sample we got:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-703 image-border" src="assets/d86fa06c-912e-42ca-aa48-9c9a51313aa1.png" style="width:16.33em;height:28.92em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p><span>We can get more insight into Core ML and the services it offers by going to its official website at <a href="https://developer.apple.com/documentation/coreml">https://developer.apple.com/documentation/coreml</a>.<a href="https://developer.apple.com/documentation/coreml"/></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we covered the following topics:</p>
<ul>
<li><strong>Linear regression</strong>: Understanding the algorithm and implementing it for the Boston housing dataset using an Excel sheet.</li>
<li><strong>Core ML</strong>: We went through the high-level details of Core ML and the various features it offers.</li>
<li><strong>A sample application implemented for linear regression using Core ML</strong>: We took the Boston housing dataset and implemented the linear regression model using Core ML for an iOS mobile application and viewed the results in a mobile application.</li>
</ul>


            </article>

            
        </section>
    </body></html>