<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">A Taste of Machine Learning</h1>
                </header>
            
            <article>
                
<p>So, you have decided to enter the field of machine learning. That's great!</p>
<p>Nowadays, machine learning is all around us—from protecting our email, to automatically tagging our friends in pictures, to predicting what movies we like. As a form of artificial intelligence, machine learning enables computers to learn through experience; to make predictions about the future using collected data from the past. On top of that, computer vision is one of today's most exciting application fields of machine learning, with deep learning and convolutional neural networks driving innovative systems such as self-driving cars and Google's DeepMind.</p>
<p>However, fret not; your application does not need to be as large-scale or world-changing ...</p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>You can refer to the code for this chapter at the following link: <a href="https://github.com/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition/tree/master/Chapter01">https://github.com/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition/tree/master/Chapter01</a>.</p>
<p>Here is a short summary of the software and hardware requirements:</p>
<ul>
<li>OpenCV version 4.1.x (4.1.0 or 4.1.1 will both work just fine).</li>
<li>Python version 3.6 (any Python version 3.x will be fine).</li>
<li>Anaconda Python 3 for installing Python and the required modules.</li>
<li>You can use any OS—macOS, Windows, and Linux-based OS—with this book. We recommend you have at least 4 GB RAM in your system.</li>
<li>You don't need to have a GPU to run the code provided with this book.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting started with machine learning</h1>
                </header>
            
            <article>
                
<p>Machine learning has been around for at least 60 years. Growing out of the quest for artificial intelligence, early machine learning systems inferred the hand-coded rules of<span> </span><kbd>if...else</kbd><span> </span>statements to process data and make decisions. Think of a spam filter whose job is to parse incoming emails and move unwanted messages to a spam folder as shown here in the following diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-794 image-border" src="Images/13ad85ae-1adb-4546-a63d-6dedceceaae8.png" style="width:46.25em;height:18.17em;" width="1867" height="735"/></p>
<p>We could come up with a blacklist of words that, whenever they show up in a message, would mark an email as spam. This is a simple example of a hand-coded expert system. (We will build a smarter one in<span> </span><a href="08148129-87ac-4042-944d-8e0a2bbbe0c5.xhtml" target="_blank">Chapter 7</a>,<span> </span><em>Implementing a Spam ...</em></p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Problems that machine learning can solve</h1>
                </header>
            
            <article>
                
<p>Most machine learning problems belong to one of the following three main categories:</p>
<ul>
<li>In supervised learning, we have what is referred to as the label for a data point. Now, this can be the class of an object that is captured in the image, a bounding box around a face, the digit present in the image, or anything else. Think of it as a teacher who teaches but also tells you what the correct answer is to a problem. Now, the student can try to devise a model or an equation that takes into account all the problems and their correct answers and finds out the answer to a problem that does (or does not) have a correct answer. The data that goes into learning the model is called the <strong>training data</strong> and the data on which the process/model is tested is called <strong>test data</strong>. These predictions come in two flavors, such as identifying new photos with the correct animal (called a<span> </span><strong>classification</strong><span> </span><strong>problem</strong>) or<span> assigning </span>accurate sale prices to other used cars (called a<span> </span><strong>regression</strong><span> </span><strong>problem</strong>). Don't worry if this seems a little over your<span> head </span>for now—we will have the entirety of the book to nail down the details.</li>
</ul>
<ul>
<li>In unsupervised learning, data points have no<span> labels </span>associated with them (<a href="790a10c4-635a-40da-ae5f-13946bc0e9fd.xhtml" target="_blank">Chapter 8</a>,<span> </span><em>Discovering Hidden Structures with</em><span> </span><em>Unsupervised Learning</em>). Think of it like a class where the instructor gives you a jumbled puzzle and leaves it up to you to figure out what to do. Here, the most common result is the <strong>c</strong>lusters, which contain objects with similar characteristics. It can also result in different ways of looking at higher dimensional data (complex data) so that it appears simpler.</li>
<li>Reinforcement learning is about maximizing a reward in a problem. So, if the teacher gives you a candy for every correct answer and punishes you for every incorrect answer, he/she is reinforcing the concepts by making you increase the number of times you receive candies rather than the number of times you are subjected to a punishment.</li>
</ul>
<p><span>These three main categories are illustrated in the following</span> diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-795 image-border" src="Images/6161f52c-65f7-4402-b74e-f66b5cf5a3c6.png" style="width:31.00em;height:32.75em;" width="1246" height="1316"/></p>
<p>Now that we have covered the main machine learning categories, let's go over some concepts in Python that will prove very useful along the journey of this book.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting started with Python</h1>
                </header>
            
            <article>
                
<p>Python has become the common language for many data science and machine learning applications, thanks to its great number of open source libraries for processes such as data loading, data visualization, statistics, image processing, and natural language processing. One of the main advantages of using Python is the ability to interact directly with the code, using a Terminal or other<span> tools </span>such as the<span> </span><strong>Jupyter Notebook</strong>, which we'll look at shortly.</p>
<p>If you have mostly been using OpenCV in combination with C++, I would strongly suggest that you switch to Python, at least for the purpose of studying this book. This decision has not been made out of spite! Quite the contrary: I have done my fair share of C/C++ programming—especially ...</p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting started with OpenCV</h1>
                </header>
            
            <article>
                
<p>Being the avid user of OpenCV that I believe you are, I probably don't have to convince you about the power of OpenCV.</p>
<p>Built to provide a common infrastructure for computer vision applications, OpenCV has become a comprehensive set of both classic and state-of-the-art computer vision and machine learning algorithms. According to their own documentation, OpenCV has a user community of more than 47,000 people and has been downloaded over seven million times. That's pretty impressive! As an open source project, it is very easy for researchers, businesses, and government bodies to utilize and modify already available code.</p>
<p>That being said, a number of open source machine learning libraries have popped up as part of the recent machine learning boom that provide far more functionality than OpenCV. A<span> prominent </span>example is<span> </span><strong>scikit-learn</strong>, which provides a number of state-of-the-art machine learning algorithms as well as a wealth of online tutorials and code snippets. As OpenCV was developed<span> </span><span>mainly</span><span> </span>to provide computer vision algorithms, its machine learning functionality is restricted to a single module, called<span> </span><kbd>ml</kbd>. As we will see in this book, OpenCV still provides a number of state-of-the-art algorithms, but sometimes lacks a bit in functionality. In these rare cases, instead of reinventing the wheel, we will simply use scikit-learn for our purposes.</p>
<p>Last but not least, installing<span> OpenCV </span>using<span> </span><span>the Python Anaconda distribution is essentially a one-liner as we'll see in the following sections.</span></p>
<div class="packt_infobox">If you are a more advanced user who wants to build real-time applications, OpenCV's algorithms are well-optimized for this task, and Python provides several ways to speed up computations where it is necessary (using, for example,<span> </span><strong>Cython</strong><span> </span>or parallel processing libraries such as<span> </span><strong>joblib</strong><span> </span>or<span> </span><strong>dask</strong>).</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Installation</h1>
                </header>
            
            <article>
                
<p>Before we get started, let's make sure that we have all the tools and libraries installed that are necessary to create a fully functioning data science environment. After downloading the latest code for this book from GitHub, we are going to install the following software:</p>
<ul>
<li>Python's Anaconda distribution, based on Python 3.6 or higher</li>
<li>OpenCV 4.1</li>
<li>Some<span> supporting </span>packages</li>
</ul>
<div class="packt_tip">Don't feel like installing stuff? You can also visit<span> </span><a href="https://mybinder.org/v2/gh/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition/master">https://mybinder.org/v2/gh/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition/master</a>, where you will find all the code for this book in an interactive, executable environment and 100% free and open source, thanks to the<span> </span><strong>Binder</strong><span> </span>project.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting the latest code for this book</h1>
                </header>
            
            <article>
                
<p>You can get the<span> latest </span>code for this book from GitHub:<span> </span><a href="https://github.com/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition">https://github.com/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition</a>. You can either download a<span> </span><kbd>.zip</kbd><span> </span>package (beginners) or clone the<span> repository </span>using Git (intermediate users).</p>
<div class="packt_infobox">Git is a version control system that allows you to track changes in files and collaborate with others on your code. In addition, the web platform GitHub makes it easy for people to share their code with you on a public server. As I make improvements to the code, you can easily update your local copy, file bug reports, or suggest code changes.</div>
<p>If you choose to go with git, the first step is to<span> make </span>sure it is installed (<a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a>).</p>
<p>Then, open a<span> </span>Terminal (or Command Prompt, as it is called in Windows):</p>
<ul>
<li>On Windows 10, right-click on the Start Menu button, and select<span> </span><span class="packt_screen">Command Prompt</span>.</li>
<li>On macOS X, press<span> </span><em>Cmd</em> + <em>Space</em><span> </span>to open spotlight search, then type<span> </span><kbd>terminal</kbd>, and hit<span> </span><em>Enter</em>.</li>
<li>On Ubuntu, Linux/Unix and friends, press<span> </span><em>Ctrl + Alt + T</em>. On Red Hat, right-click on the desktop and choose<span> </span><span class="packt_screen">Open Terminal</span><span> </span>from the menu.</li>
</ul>
<p>Navigate to a directory where you want the code downloaded:</p>
<pre><strong>cd Desktop</strong></pre>
<p>Then you can grab a local copy of the latest code by typing the following:</p>
<pre><strong>git clone https://github.com/PacktPublishing/Machine-Learning-for-OpenCV-Second-Edition.git</strong></pre>
<p>This will download the latest code in a folder called<span> </span><kbd>OpenCV-ML</kbd>.</p>
<p>After a while, the code might change online. In that case, you can update your local copy by running the following command from within the<span> </span><kbd>OpenCV-ML</kbd><span> </span>directory:</p>
<pre><strong>git pull origin master</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting to grips with Python's Anaconda distribution</h1>
                </header>
            
            <article>
                
<p><strong>Anaconda</strong><span> </span>is a free<span> Python</span><span> </span>distribution developed by Continuum Analytics that is made for scientific computing. It works across Windows, Linux, and macOS X platforms and is free, even for commercial use. However, the best thing about it is that it comes with a number of preinstalled packages that are essential for data science, math, and engineering. These packages include the following:</p>
<ul>
<li><strong>NumPy</strong>: A fundamental package for scientific computing in Python that provides functionality for multidimensional arrays, high-level mathematical functions, and pseudo-random number generators</li>
<li><strong>SciPy</strong>: A<span> collection </span>of functions for scientific computing in Python<span> that</span> provides advanced linear algebra routines, ...</li></ul></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Installing OpenCV in a conda environment</h1>
                </header>
            
            <article>
                
<p>We will carry out the following steps to install OpenCV:</p>
<ol>
<li>In a Terminal, navigate to the<span> directory </span>where you<span> downloaded </span>the following code:</li>
</ol>
<pre style="padding-left: 60px"><strong>$ cd Desktop/OpenCV-ML</strong></pre>
<ol start="2">
<li>Then, run the following command to create a conda environment based on Python 3.6, which will also install all the necessary packages listed in the<span> </span><kbd>environment.yml</kbd><span> file (available in the GitHub repository) </span>in one fell swoop:</li>
</ol>
<pre style="padding-left: 60px"><strong>$ conda create env -f environment.yml</strong></pre>
<ol start="3">
<li>You can also have a look at the following <kbd>environment.yml</kbd> file:</li>
</ol>
<pre style="padding-left: 60px"><strong>name</strong>: OpenCV-ML<br/><strong>channels</strong>:<br/>  - conda-forge<br/><strong>dependencies</strong>:<br/>  - python==3.6<br/>  - numpy==1.15.4<br/>  - scipy==1.1.0<br/>  - scikit-learn==0.20.1<br/>  - matplotlib<br/>  - jupyter==1.0<br/>  - notebook==5.7.4<br/>  - pandas==0.23.4<br/>  - theano<br/>  - keras==2.2.4<br/>  - mkl-service==1.1.2<br/>  - pip<br/>  - <strong>pip</strong>:<br/>    - opencv-contrib-python==4.1.0.25</pre>
<div class="packt_infobox">Notice that the environment's name will be <kbd>OpenCV-ML</kbd>. This code will use the <kbd>conda-forge</kbd> channel to download all the <kbd>conda</kbd> based dependencies and use <kbd>pip</kbd> to install <kbd>OpenCV 4.0 (along with opencv_contrib)</kbd>.</div>
<ol start="4">
<li>To activate the environment, type one of the following, depending on your platform:</li>
</ol>
<pre style="padding-left: 60px" class="mce-root"><strong>$ source activate OpenCV-ML  # on Linux / Mac OS X</strong><br/><strong>$ activate OpenCV-ML         # on Windows</strong></pre>
<ol start="5">
<li>When we close the Terminal, the session will be deactivated—so we will have to run this last command again the next time we open a new Terminal. We can also deactivate the environment by hand:</li>
</ol>
<pre style="padding-left: 60px"><strong>$ source deactivate  # on Linux / Mac OS X</strong><br/><strong>$ deactivate         # on Windows</strong></pre>
<p>And done! Let's verify whether all this installation was successful or not.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Verifying the installation</h1>
                </header>
            
            <article>
                
<p>It's a good idea to double-check our installation. While our<span> terminal </span>is still open, we start IPython, which is an interactive shell to run Python commands:</p>
<pre><strong>$ ipython</strong></pre>
<p>Next, make sure that you are running (at least) Python 3.6 and not Python 2.7. You might see the version number displayed in IPython's welcome message. If not, you can run the following commands:</p>
<pre>In [1]: import sys...     print(sys.version)        3.6.0 | packaged by conda-forge | (default, Feb 9 2017, 14:36:55) [GCC 4.8.2 20140120 (Red Hat 4.8.2-15)]</pre>
<p>Now try to import OpenCV as follows:</p>
<pre>In [2]: import cv2</pre>
<p>You should get no error messages. Then, try to find out the version number like so:</p>
<pre>In [3]: cv2.__version__Out[3]: '4.0.0'</pre>
<p>Make sure that OpenCV's version ...</p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting a glimpse of OpenCV's ml module</h1>
                </header>
            
            <article>
                
<p>Starting with OpenCV 3.1, all machine learning related functions in<span> OpenCV </span>have been grouped into the<span> </span><kbd>ml</kbd><span> </span>module. This has been the case for the C++ API for quite some time. You can get a glimpse of what's to come by displaying all functions in the<span> </span><kbd>ml</kbd><span> </span>module:</p>
<pre>In [4]: dir(cv2.ml)<br/>Out[4]: ['ANN_MLP_ANNEAL',<br/> 'ANN_MLP_BACKPROP',<br/> 'ANN_MLP_GAUSSIAN',<br/> 'ANN_MLP_IDENTITY',<br/> 'ANN_MLP_LEAKYRELU',<br/> 'ANN_MLP_NO_INPUT_SCALE',<br/> 'ANN_MLP_NO_OUTPUT_SCALE',<br/> ...<br/> '__spec__']</pre>
<div class="packt_tip">If you have installed an older version of OpenCV, the<span> </span><kbd>ml</kbd><span> </span>module might not be present. For example, the k-nearest neighbor algorithm (which we will talk about in<span> </span><span><a href="323dbb44-1e2b-4eaa-8cd1-2575e6766ffc.xhtml" target="_blank"/><a href="323dbb44-1e2b-4eaa-8cd1-2575e6766ffc.xhtml" target="_blank">Chapter 3</a>,</span><span> </span><em>First Steps in Supervised Learning)</em><span> </span>used to be called<span> </span><kbd>cv2.KNearest()</kbd><span> </span>but is now called<span> </span><kbd>cv2.ml.KNearest_create()</kbd>. In order to avoid confusion throughout the book, I recommend using OpenCV 4.0.</div>
<p class="mce-root">This is all good but you will be wondering by now why should you even learn machine learning, and what are its applications? Let's answer this question in the next section.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Applications of machine learning</h1>
                </header>
            
            <article>
                
<p>Machine learning, artificial intelligence, deep learning, and data science are four terms that I believe are going to change the way we have always looked at things. Let's see if I can convince you why I believe so.</p>
<p class="mce-root">From making a computer learn how to play Go and defeat the world champion of the very same game to using the same branch to detect whether a person has a tumor or not just by seeing their brain's CT Scan, machine learning has left its mark in every single domain. One of the projects that I worked on was using machine learning to determine the residual life cycle of boiler water wall tubes in thermal power plants. The proposed solution was successful in saving a huge amount of money by using the ...</p></article></section></div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">What's new in OpenCV 4.0?</h1>
                </header>
            
            <article>
                
<p>So, we come to the last section of the very first chapter. I will keep it short and to the point since you as a reader can safely skip it. The topic of our discussion is <strong>OpenCV 4.0</strong>.</p>
<p>OpenCV 4.0 is a result of three and a half years of hard work and bug fixes by OpenCV and was finally released in November 2018. In this section, we will look at some of the major changes and new features in OpenCV 4.0:</p>
<ul>
<li>With the OpenCV 4.0 release, OpenCV has officially become a C++11 library. This means that you have to make sure that a C++11 compliant compiler is present in your system when you are trying to compile OpenCV 4.0. </li>
<li>In continuation of the previous point, a lot of C APIs have been removed. Some of the modules that have been affected include Video IO module (<kbd>videoio</kbd>), Object Detection module (<kbd>objdetect</kbd>), and others. File IO for XML, YAML, and JSON have also removed the C API.</li>
<li>OpenCV 4.0 also has a lot of improvements in the DNN module (the deep learning module). ONNX support has been added. <strong>Intel OpenVINO</strong> also marks its presence in the new OpenCV version. We will be looking into this in some more detail in our later chapters. </li>
<li>OpenCL acceleration has been fixed on AMD and NVIDIA GPUs. </li>
<li>OpenCV Graph API has also been added, which is a highly efficient engine for image processing and other operations.</li>
<li>As in every OpenCV release, there have been a lot of changes with the purpose of improving the performance. Some new features such as QR Code Detection and Decoding have also been added.</li>
</ul>
<p>In short, there have been a lot of changes in OpenCV 4.0 and they have their own uses. For example, ONNX support helps in the portability of models across various languages and frameworks, OpenCL reduces runtime for computer vision applications, Graph API helps in increasing the efficiency of the applications, and the OpenVINO toolkit uses Intel's processors and a model zoo to provide highly efficient deep learning models. We will be focusing primarily on OpenVINO toolkit and DLDT as well as accelerating computer vision applications in later chapters. But, I should also point out here that both OpenCV 3.4.4 and OpenCV 4.0.0 are being modified at a high speed to fix bugs. So, if you are going to use either of them in any application, be prepared to modify your code and installation to incorporate the changes made. On a similar note, OpenCV 4.0.1 and OpenCV 3.4.5 are also out within a few months of their predecessors.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we talked about machine learning at a high abstraction level: what it is, why it is important, and what kinds of problems it can solve. We learned that machine learning problems come in three flavors: supervised learning, unsupervised learning, and reinforcement learning. We talked about the prominence of supervised learning, and that this field can be further divided into two subfields: classification and regression. Classification models allow us to categorize objects into known classes (such as animals into cats and dogs), whereas regression analysis can be used to predict continuous outcomes of target variables (such as the sales price of used cars).</p>
<p>We also learned how to set up a data science environment using ...</p></article></section></div>



  </body></html>