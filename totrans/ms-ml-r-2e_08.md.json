["```py\n    > library(cluster) #conduct cluster analysis\n    > library(compareGroups) #build descriptive statistic tables\n    > library(HDclassif) #contains the dataset\n    > library(NbClust) #cluster validity measures\n    > library(sparcl) #colored dendrogram\n\n```", "```py\n    > data(wine)\n\n    > str(wine)\n    'data.frame':178 obs. of  14 variables:\n     $ class: int  1 1 1 1 1 1 1 1 1 1 ...\n     $ V1   : num  14.2 13.2 13.2 14.4 13.2 ...\n     $ V2   : num  1.71 1.78 2.36 1.95 2.59 1.76 1.87 2.15 1.64 1.35 \n       ...\n     $ V3   : num  2.43 2.14 2.67 2.5 2.87 2.45 2.45 2.61 2.17 2.27 ...\n     $ V4   : num  15.6 11.2 18.6 16.8 21 15.2 14.6 17.6 14 16 ...\n     $ V5   : int  127 100 101 113 118 112 96 121 97 98 ...\n     $ V6   : num  2.8 2.65 2.8 3.85 2.8 3.27 2.5 2.6 2.8 2.98 ...\n     $ V7   : num  3.06 2.76 3.24 3.49 2.69 3.39 2.52 2.51 2.98 3.15 \n       ...\n     $ V8   : num  0.28 0.26 0.3 0.24 0.39 0.34 0.3 0.31 0.29 0.22 ...\n     $ V9   : num  2.29 1.28 2.81 2.18 1.82 1.97 1.98 1.25 1.98 1.85 \n       ...\n     $ V10  : num  5.64 4.38 5.68 7.8 4.32 6.75 5.25 5.05 5.2 7.22 ...\n     $ V11  : num  1.04 1.05 1.03 0.86 1.04 1.05 1.02 1.06 1.08 1.01 \n       ...\n     $ V12  : num  3.92 3.4 3.17 3.45 2.93 2.85 3.58 3.58 2.85 3.55 ...\n     $ V13  : int  1065 1050 1185 1480 735 1450 1290 1295 1045 1045 ...\n\n```", "```py\n    > names(wine) <- c(\"Class\", \"Alcohol\", \"MalicAcid\", \"Ash\", \n      \"Alk_ash\", \"magnesium\", \"T_phenols\", \"Flavanoids\", \"Non_flav\", \n        \"Proantho\", \"C_Intensity\", \"Hue\", \"OD280_315\", \"Proline\")\n\n    > names(wine)\n    [1] \"Class\"       \"Alcohol\"     \"MalicAcid\"   \"Ash\" \n    [5] \"Alk_ash\"     \"magnesium\"   \"T_phenols\"   \"Flavanoids\" \n    [9] \"Non_flav\"    \"Proantho\"    \"C_Intensity\" \"Hue\" \n    [13] \"OD280_315\"   \"Proline\" \n\n```", "```py\n    > df <- as.data.frame(scale(wine[, -1]))\n\n```", "```py\n    > str(df)\n    'data.frame':178 obs. of  13 variables:\n     $ Alcohol    : num  1.514 0.246 0.196 1.687 0.295 ...\n     $ MalicAcid  : num  -0.5607 -0.498 0.0212 -0.3458 0.2271 ...\n     $ Ash        : num  0.231 -0.826 1.106 0.487 1.835 ...\n     $ Alk_ash    : num  -1.166 -2.484 -0.268 -0.807 0.451 ...\n     $ magnesium  : num  1.9085 0.0181 0.0881 0.9283 1.2784 ...\n     $ T_phenols  : num  0.807 0.567 0.807 2.484 0.807 ...\n     $ Flavanoids : num  1.032 0.732 1.212 1.462 0.661 ...\n     $ Non_flav   : num  -0.658 -0.818 -0.497 -0.979 0.226 ...\n     $ Proantho   : num  1.221 -0.543 2.13 1.029 0.4 ...\n     $ C_Intensity: num  0.251 -0.292 0.268 1.183 -0.318 ...\n     $ Hue        : num  0.361 0.405 0.317 -0.426 0.361 ...\n     $ OD280_315  : num  1.843 1.11 0.786 1.181 0.448 ...\n     $ Proline    : num  1.0102 0.9625 1.3912 2.328 -0.0378 ...\n\n```", "```py\n    > table(wine$Class)\n\n    1  2  3 \n    59 71 48\n\n```", "```py\n    > numComplete <- NbClust(df, distance = \"euclidean\", min.nc = 2, \n       max.nc=6, method = \"complete\", index = \"all\")\n    *** : The Hubert index is a graphical method of determining the \n       number of clusters.\n    In the plot of Hubert index, we seek a significant knee that \n       corresponds to a significant increase of the value of the \n         measure that is the significant peak in Hubert index second \n           differences plot. \n\n    *** : The D index is a graphical method of determining the number \n       of clusters. \n    In the plot of D index, we seek a significant knee (the significant peak in Dindex second differences plot) that corresponds to a significant increase of the value of the measure. \n\n    ******************************************************************* \n    * Among all indices: \n    * 1 proposed 2 as the best number of clusters \n    * 11 proposed 3 as the best number of clusters \n    * 6 proposed 5 as the best number of clusters \n    * 5 proposed 6 as the best number of clusters \n\n    ***** Conclusion ***** \n\n    * According to the majority rule, the best number of clusters is 3\n\n```", "```py\n    > numComplete$Best.nc\n                         KL      CH Hartigan   CCC    Scott\n    Number_clusters  5.0000  3.0000   3.0000 5.000   3.0000\n    Value_Index     14.2227 48.9898  27.8971 1.148 340.9634\n                         Marriot   TrCovW   TraceW Friedman\n    Number_clusters 3.000000e+00     3.00   3.0000   3.0000\n    Value_Index     6.872632e+25 22389.83 256.4861  10.6941\n\n```", "```py\n    > dis <- dist(df, method = \"euclidean\")\n\n```", "```py\n    > hc <- hclust(dis, method = \"complete\")\n\n```", "```py\n    > plot(hc, hang = -1, labels = FALSE, main = \"Complete-Linkage\")\n\n```", "```py\n    > comp3 <- cutree(hc, 3)\n\n```", "```py\n    > ColorDendrogram(hc, y = comp3, main = \"Complete\", branchlength = 50)\n\n```", "```py\n    > table(comp3)\n    comp3\n    1  2  3 \n     69 58 51\n\n```", "```py\n    > table(comp3,wine$Class)\n\n    comp3  1  2  3\n        1 51 18  0\n        2  8 50  0\n        3  0  3 48\n\n```", "```py\n    > numWard <- NbClust(df, diss = NULL, distance = \"euclidean\", \n      min.nc = 2, max.nc = 6, method = \"ward.D2\", index = \"all\") \n    *** : The Hubert index is a graphical method of determining the number of clusters.\n    In the plot of Hubert index, we seek a significant knee that corresponds to a significant increase of the value of the measure i.e the significant peak in Hubert index second differences plot. \n\n    *** : The D index is a graphical method of determining the number of clusters. \n    In the plot of D index, we seek a significant knee (the significant peak in Dindex second differences plot) that corresponds to a significant increase of the value of the measure. \n\n    ******************************************************************* \n    * Among all indices: \n    * 2 proposed 2 as the best number of clusters \n    * 18 proposed 3 as the best number of clusters \n    * 2 proposed 6 as the best number of clusters \n\n    ***** Conclusion ***** \n\n    * According to the majority rule, the best number of clusters is 3\n\n```", "```py\n    > hcWard <- hclust(dis, method = \"ward.D2\")\n\n    > plot(hcWard, labels = FALSE, main = \"Ward's-Linkage\")\n\n```", "```py\n    > ward3 <- cutree(hcWard, 3)\n    > table(ward3, wine$Class)\n\n    ward3  1  2  3\n        1 59  5  0\n        2  0 58  0\n        3  0  8 48\n\n```", "```py\n    > table(comp3, ward3)\n         ward3\n    comp3  1  2  3\n        1 53 11  5\n        2 11 47  0\n        3  0  0 51\n\n```", "```py\n    > aggregate(wine[, -1], list(comp3), mean)\n      Group.1  Alcohol MalicAcid      Ash  Alk_ash magnesium T_phenols\n    1       1 13.40609  1.898986 2.305797 16.77246 105.00000  2.643913\n    2       2 12.41517  1.989828 2.381379 21.11724  93.84483  2.424828\n    3       3 13.11784  3.322157 2.431765 21.33333  99.33333  1.675686\n      Flavanoids  Non_flav Proantho C_Intensity       Hue OD280_315  Proline\n    1  2.6689855 0.2966667 1.832899    4.990725 1.0696522  2.970000 984.6957\n    2  2.3398276 0.3668966 1.678103    3.280345 1.0579310  2.978448 573.3793\n    3  0.8105882 0.4443137 1.164314    7.170980 0.6913725  1.709804 622.4902\n\n```", "```py\n    > aggregate(wine[, -1], list(ward3), mean)\n      Group.1  Alcohol MalicAcid      Ash  Alk_ash magnesium T_phenols\n    1       1 13.66922  1.970000 2.463125 17.52812 106.15625  2.850000\n    2       2 12.20397  1.938966 2.215172 20.20862  92.55172  2.262931\n    3       3 13.06161  3.166607 2.412857 21.00357  99.85714  1.694286\n      Flavanoids  Non_flav Proantho C_Intensity      Hue OD280_315   Proline\n    1  3.0096875 0.2910937 1.908125    5.450000 1.071406  3.158437 1076.0469\n    2  2.0881034 0.3553448 1.686552    2.895345 1.060000  2.862241  501.4310\n    3  0.8478571 0.4494643 1.129286    6.850179 0.721000  1.727321  624.9464\n\n```", "```py\n    > par(mfrow =c (1, 2))\n\n```", "```py\n    > boxplot(wine$Proline ~ comp3, data = wine, \n              main=\"Proline by Complete Linkage\")\n\n    > boxplot(wine$Proline ~ ward3, data = wine, \n              main = \"Proline by Ward's Linkage\")\n\n```", "```py\n    > numKMeans <- NbClust(df, min.nc = 2, max.nc = 15, method = \n      \"kmeans\")\n    * Among all indices: \n    * 4 proposed 2 as the best number of clusters \n    * 15 proposed 3 as the best number of clusters \n    * 1 proposed 10 as the best number of clusters \n    * 1 proposed 12 as the best number of clusters \n    * 1 proposed 14 as the best number of clusters \n    * 1 proposed 15 as the best number of clusters \n\n    ***** Conclusion ***** \n\n    * According to the majority rule, the best number of clusters is 3\n\n```", "```py\n    > set.seed(1234)\n\n    > km <- kmeans(df, 3, nstart = 25)\n\n```", "```py\n    > table(km$cluster)\n\n    1  2  3 \n    62 65 51\n\n```", "```py\n    > km$centers\n         Alcohol  MalicAcid        Ash    Alk_ash   magnesium   T_phenols\n    1  0.8328826 -0.3029551  0.3636801 -0.6084749  0.57596208  0.88274724\n    2 -0.9234669 -0.3929331 -0.4931257  0.1701220 -0.49032869 -0.07576891\n    3  0.1644436  0.8690954  0.1863726  0.5228924 -0.07526047 -0.97657548\n       Flavanoids    Non_flav    Proantho C_Intensity        Hue  OD280_315\n    1  0.97506900 -0.56050853  0.57865427   0.1705823  0.4726504  0.7770551\n    2  0.02075402 -0.03343924  0.05810161  -0.8993770  0.4605046  0.2700025\n    3 -1.21182921  0.72402116 -0.77751312   0.9388902 -1.1615122 -1.2887761\n         Proline\n    1  1.1220202\n    2 -0.7517257\n    3 -0.4059428\n\n```", "```py\n\n    > boxplot(wine$Alcohol ~ km$cluster, data = wine, \n              main = \"Alcohol Content, K-Means\")\n\n    > boxplot(wine$Alcohol ~ ward3, data = wine, \n              main = \"Alcohol Content, Ward's\")\n\n```", "```py\n    > table(km$cluster, wine$Class)\n\n         1  2  3\n      1 59  3  0\n      2  0 65  0\n      3  0  3 48\n\n```", "```py\n    > wine$Alcohol <- as.factor(ifelse(df$Alcohol > 0, \"High\", \"Low\"))\n\n```", "```py\n    > disMatrix <- daisy(wine[, -1], metric = \"gower\")\n\n```", "```py\n    > set.seed(123)\n\n    > pamFit <- pam(disMatrix, k = 3)\n\n    > table(pamFit$clustering)\n\n    1  2  3 \n    63 67 48\n\n```", "```py\n    > table(pamFit$clustering, wine$Class)\n\n         1  2  3\n      1 57  6  0\n      2  2 64  1\n      3  0  1 47\n\n```", "```py\n    > wine$cluster <- pamFit$clustering\n\n    > group <- compareGroups(cluster ~ ., data = wine)\n\n    > clustab <- createTable(group)\n\n    > clustab\n\n    --------Summary descriptives table by 'cluster'---------\n\n __________________________________________________________ \n 1           2            3      p.overall \n N=63         N=67         N=48 \n ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ \n Class         1.10 (0.30)  1.99 (0.21)  2.98 (0.14) <0.001 \n Alcohol:                                            <0.001 \n High     63 (100%)    1 (1.49%)   28 (58.3%) \n Low     0 (0.00%)   66 (98.5%)   20 (41.7%) \n MalicAcid     1.98 (0.83)   1.92 (0.90) 3.39 (1.05) <0.001 \n Ash           2.42 (0.27)   2.27 (0.31) 2.44 (0.18)  0.001 \n Alk_ash       17.2 (2.73)   20.2 (3.28) 21.5 (2.21) <0.001 \n magnesium     105  (11.6)   95.6 (17.2) 98.5 (10.6)  0.001 \n T_phenols     2.82 (0.36)   2.24 (0.55) 1.68 (0.36) <0.001 \n Flavanoids    2.94 (0.47)   2.07 (0.70) 0.79 (0.31) <0.001 \n Non_flav      0.29 (0.08)   0.36 (0.12) 0.46 (0.12) <0.001 \n Proantho      1.86 (0.47)   1.64 (0.59) 1.17 (0.41) <0.001 \n C_Intensity   5.41 (1.31)   3.05 (0.89) 7.41 (2.29) <0.001 \n Hue           1.07 (0.13)   1.05 (0.20) 0.68 (0.12) <0.001 \n OD280_315     3.10 (0.39)   2.80 (0.53) 1.70 (0.27) <0.001 \n Proline       1065 (280)     533 (171)   628 (116)  <0.001 \n comp_cluster  1.16 (0.37)   1.81 (0.50) 3.00 (0.00) <0.001 \n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\n\n```", "```py\n    > export2csv(clustab,file = \"wine_clusters.csv\")\n\n```", "```py\n > set.seed(1) \n > rf <- randomForest(x = wine[, -1], ntree = 2000, proximity = T) \n > rf\n\n Call:\n randomForest(x = wine[, -1], ntree = 2000, proximity = T) \n Type of random forest: unsupervised\n Number of trees: 2000\n No. of variables tried at each split: 3\n\n```", "```py\n> dim(rf$proximity)\n[1] 178 178\n\n> rf$proximity[1:5, 1:5]\n 1         2         3          4          5\n1 1.0000000 0.2593985 0.2953586 0.36013986 0.17054264\n2 0.2593985 1.0000000 0.1307420 0.16438356 0.11029412\n3 0.2953586 0.1307420 1.0000000 0.29692833 0.23735409\n4 0.3601399 0.1643836 0.2969283 1.00000000 0.08076923\n5 0.1705426 0.1102941 0.2373541 0.08076923 1.00000000\n\n```", "```py\n > importance(rf)\n MeanDecreaseGini\n Alcohol      0.5614071\n MalicAcid    6.8422540\n Ash          6.4693717\n Alk_ash      5.9103567\n magnesium    5.9426505\n T_phenols    6.2928709\n Flavanoids   6.2902370\n Non_flav     5.7312940\n Proantho     6.2657613\n C_Intensity  6.5375605\n Hue          6.3297808\n OD280_315    6.4894731\n Proline      6.6105274\n\n```", "```py\n > dissMat <- sqrt(1 - rf$proximity)\n\n > dissMat[1:2, 1:2]\n 1         2\n 1 0.0000000 0.8605821\n 2 0.8605821 0.0000000\n\n```", "```py\n > set.seed(123)\n\n > pamRF <- pam(dissMat, k = 3)\n\n > table(pamRF$clustering)\n\n 1  2  3 \n 62 68 48 \n\n > table(pamRF$clustering, wine$Class)\n\n 1 2 3\n 1 57  5  0\n 2  2 64  2\n 3  0  2 46\n\n```"]