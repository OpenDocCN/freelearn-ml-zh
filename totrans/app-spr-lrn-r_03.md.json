["```py\n    PM25 <- read.csv(\"https://raw.githubusercontent.com/TrainingByPackt/Applied-Supervised-Learning-with-R/master/Lesson03/PRSA_data_2010.1.1-2014.12.31.csv\")\n    ```", "```py\n    str(PM25)\n    ```", "```py\n    'data.frame':\t43824 obs. of  13 variables:\n     $ No   : int  1 2 3 4 5 6 7 8 9 10 ...\n     $ year : int  2010 2010 2010 2010 2010 2010 2010 2010 2010 2010 ...\n     $ month: int  1 1 1 1 1 1 1 1 1 1 ...\n     $ day  : int  1 1 1 1 1 1 1 1 1 1 ...\n     $ hour : int  0 1 2 3 4 5 6 7 8 9 ...\n     $ pm2.5: int  NA NA NA NA NA NA NA NA NA NA ...\n     $ DEWP : int  -21 -21 -21 -21 -20 -19 -19 -19 -19 -20 ...\n     $ TEMP : num  -11 -12 -11 -14 -12 -10 -9 -9 -9 -8 ...\n     $ PRES : num  1021 1020 1019 1019 1018 ...\n     $ cbwd : Factor w/ 4 levels \"cv\",\"NE\",\"NW\",..: 3 3 3 3 3 3 3 3 3 3 ...\n     $ Iws  : num  1.79 4.92 6.71 9.84 12.97 ...\n     $ Is   : int  0 0 0 0 0 0 0 0 0 0 ...\n     $ Ir   : int  0 0 0 0 0 0 0 0 0 0 ...\n    ```", "```py\n    summary(PM25)\n    ```", "```py\n           No             year          month             day             hour           pm2.5       \n     Min.   :    1   Min.   :2010   Min.   : 1.000   Min.   : 1.00   Min.   : 0.00   Min.   :  0.00  \n     1st Qu.:10957   1st Qu.:2011   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 5.75   1st Qu.: 29.00  \n     Median :21912   Median :2012   Median : 7.000   Median :16.00   Median :11.50   Median : 72.00  \n     Mean   :21912   Mean   :2012   Mean   : 6.524   Mean   :15.73   Mean   :11.50   Mean   : 98.61  \n     3rd Qu.:32868   3rd Qu.:2013   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:17.25   3rd Qu.:137.00  \n     Max.   :43824   Max.   :2014   Max.   :12.000   Max.   :31.00   Max.   :23.00   Max.   :994.00  \n                                                                                     NA's   :2067    \n          DEWP              TEMP             PRES      cbwd            Iws               Is          \n     Min.   :-40.000   Min.   :-19.00   Min.   : 991   cv: 9387   Min.   :  0.45   Min.   : 0.00000  \n     1st Qu.:-10.000   1st Qu.:  2.00   1st Qu.:1008   NE: 4997   1st Qu.:  1.79   1st Qu.: 0.00000  \n     Median :  2.000   Median : 14.00   Median :1016   NW:14150   Median :  5.37   Median : 0.00000  \n     Mean   :  1.817   Mean   : 12.45   Mean   :1016   SE:15290   Mean   : 23.89   Mean   : 0.05273  \n     3rd Qu.: 15.000   3rd Qu.: 23.00   3rd Qu.:1025              3rd Qu.: 21.91   3rd Qu.: 0.00000  \n     Max.   : 28.000   Max.   : 42.00   Max.   :1046              Max.   :585.60   Max.   :27.00000  \n\n           Ir         \n     Min.   : 0.0000  \n     1st Qu.: 0.0000  \n     Median : 0.0000  \n     Mean   : 0.1949  \n     3rd Qu.: 0.0000  \n     Max.   :36.0000\n    ```", "```py\n    num_index <- nrow(PM25)\n    ```", "```py\n    train_index <- sample(1:num_index, 0.7*nrow(PM25))\n    ```", "```py\n    PM25_Train <- PM25[train_index,]\n    ```", "```py\n    PM25_Test <- PM25[-train_index,]\n    ```", "```py\n    library(dplyr)\n    library(lubridate)\n    library(tidyr)\n    library(grid)\n    library(ggplot2)\n    ```", "```py\n    PM25$datetime <- with(PM25, ymd_h(sprintf('%04d%02d%02d%02d', year, month, day,hour)))\n    ```", "```py\n    plot_pm25 <- PM25 %>%\n      select(datetime, pm2.5) %>%\n      na.omit() %>%\n      ggplot() + \n      geom_point(aes(x = datetime, y = pm2.5), size = 0.5, alpha = 0.75) +\n      ylab(\"PM2.5\")\n    plot_TEMP <- PM25 %>%\n      select(datetime, TEMP) %>%\n      na.omit() %>%\n      ggplot() + \n      geom_point(aes(x = datetime, y = TEMP), size = 0.5, alpha = 0.75) +\n      ylab(\"TEMP\")\n    plot_DEWP <- PM25 %>%\n      select(datetime, DEWP) %>%\n      na.omit() %>%\n      ggplot() + \n      geom_point(aes(x = datetime, y = DEWP), size = 0.5, alpha = 0.75) +\n      ylab(\"DEWP\")\n    plot_PRES <- PM25 %>%\n      select(datetime, PRES) %>%\n      na.omit() %>%\n      ggplot() + \n      geom_point(aes(x = datetime, y = PRES), size = 0.5, alpha = 0.75) +\n      ylab(\"PRES\")\n    ```", "```py\n    grid.newpage()\n    grid.draw(rbind(ggplotGrob(plot_pm25), ggplotGrob(plot_TEMP),ggplotGrob(plot_DEWP),ggplotGrob(plot_PRES), size = \"last\"))\n    ```", "```py\n    library(corrplot)\n    ```", "```py\n    corr <- cor(PM25[!is.na(PM25$pm2.5),c(\"pm2.5\",\"DEWP\",\"TEMP\",\"PRES\",\"Iws\",\"Is\",\"Ir\")])\n    ```", "```py\n    corrplot(corr)\n    ```", "```py\n    library(ggplot2)\n    ```", "```py\n    ggplot(data = PM25, aes(x = DEWP, y = pm2.5, color = month)) +  geom_point() +  geom_smooth(method='auto',formula=y~x, colour = \"red\", size =1.5)\n    ```", "```py\n    ggplot(data = PM25, aes(x = TEMP, y = pm2.5, color = month)) +  geom_point() +  geom_smooth(method='auto',formula=y~x, colour = \"red\", size =1.5)\n    ```", "```py\n    ggplot(data = PM25, aes(x = DEWP, y = pm2.5, color = hour)) +  geom_point() +  geom_smooth(method='auto',formula=y~x, colour = \"red\", size =1) +  facet_wrap(~ month, nrow = 4)\n    ```", "```py\n    simple_PM25_linear_model <- lm(pm2.5 ~ DEWP, data = PM25)\n    ```", "```py\n    summary(simple_PM25_linear_model)\n    ```", "```py\n    Call:\n    lm(formula = pm2.5 ~ DEWP, data = PM25)\n    Residuals:\n        Min      1Q  Median      3Q     Max \n    -115.47  -61.26  -28.75   33.83  923.54 \n    Coefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n    (Intercept) 96.69984    0.44705  216.31   <2e-16 ***\n    DEWP         1.09325    0.03075   35.55   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    Residual standard error: 90.69 on 41755 degrees of freedom\n      (2067 observations deleted due to missingness)\n    Multiple R-squared:  0.02939,\tAdjusted R-squared:  0.02936 \n    F-statistic:  1264 on 1 and 41755 DF,  p-value: < 2.2e-16\n    ```", "```py\n    multiple_PM25_linear_model <- lm(pm2.5 ~ DEWP+TEMP+Iws, data = PM25)\n    ```", "```py\n    summary(multiple_PM25_linear_model)\n    ```", "```py\n    A)\n    ______________________________________________________________\n    Call:\n    lm(formula = pm2.5 ~ DEWP + TEMP + Iws, data = PM25)\n    Residuals:\n        Min      1Q  Median      3Q     Max \n    -149.02  -53.74  -16.61   34.14  877.82 \n    ______________________________________________________________\n    B)\n    ______________________________________________________________\n    Coefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n    (Intercept) 161.151207   0.768727  209.63   <2e-16 ***\n    DEWP          4.384196   0.051159   85.70   <2e-16 ***\n    TEMP         -5.133511   0.058646  -87.53   <2e-16 ***\n    Iws          -0.274337   0.008532  -32.15   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    ______________________________________________________________\n    C)\n    ______________________________________________________________\n    Residual standard error: 81.51 on 41753 degrees of freedom\n      (2067 observations deleted due to missingness)\n    Multiple R-squared:  0.216,\tAdjusted R-squared:  0.2159 \n    F-statistic:  3834 on 3 and 41753 DF,  p-value: < 2.2e-16\n    ______________________________________________________________\n    ```", "```py\nglm(Y ~ X1 + X2 + X3, data = <train_data>,family=binomial(link='logit'))\n```", "```py\n    PM25$datetime <- with(PM25, ymd_h(sprintf('%04d%02d%02d%02d', year, month, day,hour)))\n    ```", "```py\n    PM25_subset <- na.omit(PM25[,c(\"datetime\",\"pm2.5\")])\n    head(PM25_subset$pm2.5)\n    ```", "```py\n    [1] 129 148 159 181 138 109\n    ```", "```py\n    zoo(PM25_subset$pm2.5,PM25_subset$datetime)\n    ```", "```py\n    2010-01-02 00:00:00 2010-01-02 01:00:00 2010-01-02 02:00:00 \n                    129                 148                 159 \n    2010-01-02 03:00:00 2010-01-02 04:00:00 2010-01-02 05:00:00 \n                    181                 138                 109 \n    ```", "```py\n    PM25_three_hour_pm25_avg <- rollapply(zoo(PM25_subset$pm2.5,PM25_subset$datetime), 3, mean)\n    ```", "```py\n    2010-01-02 01:00:00 2010-01-02 02:00:00 2010-01-02 03:00:00 \n               145.3333            162.6667            159.3333 \n    2010-01-02 04:00:00 2010-01-02 05:00:00 2010-01-02 06:00:00 \n               142.6667            117.3333            112.6667 \n    ```", "```py\n    Call:\n    glm(formula = pollution_level ~ DEWP + TEMP + Iws, family = binomial(link = \"logit\"), \n        data = PM25_for_class)\n    Deviance Residuals: \n        Min       1Q   Median       3Q      Max  \n    -2.4699  -0.5212   0.4569   0.6508   3.5824  \n    Coefficients:\n                  Estimate Std. Error z value Pr(>|z|)    \n    (Intercept)  2.5240276  0.0273353   92.34   <2e-16 ***\n    DEWP         0.1231959  0.0016856   73.09   <2e-16 ***\n    TEMP        -0.1028211  0.0018447  -55.74   <2e-16 ***\n    Iws         -0.0127037  0.0003535  -35.94   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    (Dispersion parameter for binomial family taken to be 1)\n        Null deviance: 49475  on 41754  degrees of freedom\n    Residual deviance: 37821  on 41751  degrees of freedom\n    AIC: 37829\n    Number of Fisher Scoring iterations: 5\n    ```", "```py\n    y_predicted <- predict(multiple_PM25_linear_model, data = PM25)\n    ```", "```py\n    y_actual <- PM25[!is.na(PM25$pm2.5),\"pm2.5\"]\n    ```", "```py\n    MAE <- mean(abs(y_actual - y_predicted))\n    ```", "```py\n    ## [1] 59.82112\n    ```", "```py\n    RMSE <- sqrt(mean((y_actual - y_predicted)^2))\n    ```", "```py\n    ## [1] 82.09164\n    ```", "```py\n    model_summary <- summary(multiple_PM25_linear_model)\n    model_summary$r.squared\n    ```", "```py\n    ## [1] 0.216\n    ```", "```py\n    model_summary$adj.r.squared\n    ```", "```py\n    ## [1] 0.2159\n    ```", "```py\n    Query_RR_Vector <- c(1/3,1/4,1)\n    MRR <- sum(Query_RR_Vector)/length(Query_RR_Vector)\n    ```", "```py\n    ## [1] 0.5277778\n    ```", "```py\n    predicted <- ifelse(PM25_logit_model$fitted.values>0.5, 1,0)\n    ```", "```py\n    actual <- PM25_for_class$pollution_level\n    ```", "```py\n    library(caret)\n    ```", "```py\n    confusionMatrix(predicted, actual)\n    ```", "```py\n    ## Confusion Matrix and Statistics\n    ## \n    ##           Reference\n    ## Prediction     0     1\n    ##          0  5437  2097\n    ##          1  6232 27989\n    ##                                           \n    ##                Accuracy : 0.8005          \n    ##                  95% CI : (0.7967, 0.8044)\n    ##     No Information Rate : 0.7205          \n    ##     P-Value [Acc > NIR] : < 2.2e-16       \n    ##                                           \n    ##                   Kappa : 0.4444          \n    ##  Mcnemar's Test P-Value : < 2.2e-16       \n    ##                                           \n    ##             Sensitivity : 0.4659          \n    ##             Specificity : 0.9303          \n    ##          Pos Pred Value : 0.7217          \n    ##          Neg Pred Value : 0.8179          \n    ##              Prevalence : 0.2795          \n    ##          Detection Rate : 0.1302          \n    ##    Detection Prevalence : 0.1804          \n    ##       Balanced Accuracy : 0.6981          \n    ##                                           \n    ##        'Positive' Class : 0               \n    ```", "```py\n    library(ROCR)\n    ```", "```py\n    pred1 <- prediction(predict(PM25_logit_model), PM25_for_class$pollution_level)\n    perf1 <- performance(pred1,\"tpr\",\"fpr\")\n    ```", "```py\n    auc <- performance(pred1,\"auc\")\n    as.numeric(auc@y.values)\n    ```", "```py\n    ## [1] 0.8077673\n    ```", "```py\n    plot(perf1)\n    ```"]