<html><head></head><body>
		<div id="_idContainer203">
			<h1 id="_idParaDest-266"><em class="italic"><a id="_idTextAnchor268"/>Appendix</em> : Alternative Methods to Launch H2O Clusters</h1>
			<p>This <a href="B16721_Appendix_Final_SK_ePub.xhtml#_idTextAnchor268"><em class="italic">Appendix</em></a> will show you how to launch H2O-3 and Sparkling Water clusters on your local machine so that you can run the code samples in this book. We will also show you how to launch H2O-3 clusters in the 90-day free trial environment for the H2O AI Cloud. This trial environment includes Enterprise Steam to launch and manage H2O clusters on Kubernetes infrastructure.</p>
			<p class="callout-heading">Note on Environments</p>
			<p class="callout"><strong class="bold">Architecture</strong>: As introduced in <a href="B16721_02_Final_SK_ePub.xhtml#_idTextAnchor024"><em class="italic">Chapter 2</em></a>, <em class="italic">Platform Components and Key Concepts</em>, you will use a client environment (with the H2O-3 or Sparkling Water libraries implemented) to run commands against a remote H2O-3 or Sparkling Water architecture distributed across multiple server nodes on a Kubernetes or Hadoop cluster. For small datasets, however, the architecture can be launched locally as a single process on the same machine as the client. </p>
			<p class="callout"><strong class="bold">Versions</strong>: Functionality and code samples from this book use the following versions: H2O-3 version 3.34.0.7, and Sparkling Water version 3.34.0.7-1-3.2 to run on Spark 3.2. You will set up your environment with the latest (most recent) stable versions, which will allow you to run the same code samples from this book but will also include capabilities in H2O-3 and Sparkling Water that were added after the book was written.</p>
			<p class="callout"><strong class="bold">Languages</strong>: You can set up your client environment in Python, R, or Java/Scala. We will use Python in this book. Your Python client can be a Jupyter notebook, PyCharm, or other.</p>
			<p>Let's learn how to run H2O-3 entirely in your local environment.</p>
			<h1 id="_idParaDest-267"><a id="_idTextAnchor269"/>Local H2O-3 cluster</h1>
			<p>This is the easiest method<a id="_idIndexMarker1162"/> to run H2O-3 and is suitable for the small datasets used in code samples in this book. It launches H2O-3 on your local machine (versus an enterprise cluster environment) and does not involve H2O Enterprise Steam.</p>
			<p>First, we will perform a one-time setup of our H2O-3 Python environment.</p>
			<h2 id="_idParaDest-268"><a id="_idTextAnchor270"/>Step 1 – Install H2O-3 in Python</h2>
			<p>To set up your H2O-3 Python client, simply install<a id="_idIndexMarker1163"/> three module dependencies in your Python environment and then the <strong class="source-inline">h2o-3</strong> Python module. You must use Python 2.7.x, 3.5.x, 3.6.x, or 3.7.x. </p>
			<p>More specifically, do the following:</p>
			<ol>
				<li value="1">Install dependencies in your Python environment:<p class="source-code"><strong class="bold">pip install requests</strong></p><p class="source-code"><strong class="bold">pip install tabulate</strong></p><p class="source-code"><strong class="bold">pip install future </strong></p></li>
				<li>Install the H2O-3 library in your Python environment:<p class="source-code"><strong class="bold">pip install h2o</strong></p></li>
			</ol>
			<p>Please refer to <a href="http://h2o-release.s3.amazonaws.com/h2o/rel-zumbo/1/index.html">http://h2o-release.s3.amazonaws.com/h2o/rel-zumbo/1/index.html</a> (the <strong class="bold">INSTALL IN PYTHON</strong> tab) to install<a id="_idIndexMarker1164"/> H2O-3 in Conda. </p>
			<p>You are now ready to run H2O-3 locally. Let's see how to do that.</p>
			<h2 id="_idParaDest-269"><a id="_idTextAnchor271"/>Step 2 – Launch your H2O-3 cluster and write code</h2>
			<p>To start a local<a id="_idIndexMarker1165"/> single-node<a id="_idIndexMarker1166"/> H2O-3 cluster, simply run the following in your Python IDE:</p>
			<pre class="source-code">import h2o</pre>
			<pre class="source-code">h2o.init()</pre>
			<pre class="source-code"># write h2o-3 code, including code samples in this book</pre>
			<p>You can now write your H2O-3 code, including all samples from this book. See <a href="B16721_02_Final_SK_ePub.xhtml#_idTextAnchor024"><em class="italic">Chapter 2</em></a>, <em class="italic">Platform Components and Key Concepts,</em> for a <strong class="source-inline">Hello World</strong> code sample and an explanation<a id="_idIndexMarker1167"/> of what happens<a id="_idIndexMarker1168"/> under the surface.</p>
			<p class="callout-heading">Java Dependency – Only When Running Locally</p>
			<p class="callout">The H2O-3 cluster (not the Python client) runs on Java. Because you are running the cluster on your local machine here (representing a single-node cluster), you must have Java installed. This is not required when you use your Python client to connect to a remote H2O cluster in your enterprise Kubernetes or Hadoop environment.</p>
			<p>Now, let's see how we can set up our environment to write Sparkling Water code on our local machine.</p>
			<h1 id="_idParaDest-270"><a id="_idTextAnchor272"/>Local Sparkling Water cluster</h1>
			<p>Running Sparkling Water<a id="_idIndexMarker1169"/> locally is similar to running H2O-3 locally, but with<a id="_idIndexMarker1170"/> Spark dependencies. See this <a id="_idIndexMarker1171"/>link for a full explanation<a id="_idIndexMarker1172"/> of the Spark, Python, and H2O components involved: <a href="https://docs.h2o.ai/sparkling-water/3.2/latest-stable/doc/pysparkling.html">https://docs.h2o.ai/sparkling-water/3.2/latest-stable/doc/pysparkling.html</a>. </p>
			<p>We will be using Spark 3.2 here. To use a different<a id="_idIndexMarker1173"/> version of Spark, go to the <strong class="bold">Sparkling Water</strong> section of the H2O downloads page at the following link: <a href="https://h2o.ai/resources/download/">https://h2o.ai/resources/download/</a>.</p>
			<p>For your Sparkling Water Python client, you must use Python 2.7.x, 3.5.x, 3.6.x, or 3.7.x. We will be running Sparkling Water from a Jupyter notebook here.</p>
			<h2 id="_idParaDest-271"><a id="_idTextAnchor273"/>Step 1 – Install Spark locally</h2>
			<p>Follow these steps<a id="_idIndexMarker1174"/> to install Spark locally:</p>
			<ol>
				<li value="1">Go to <a href="https://spark.apache.org/downloads.html">https://spark.apache.org/downloads.html</a> to download Spark. Make the following choices and then download:<ul><li>Spark version: 3.2.x</li><li>Package type: Pre-built for Hadoop 3.3 and later </li></ul></li>
				<li>Unzip the downloaded file.</li>
				<li>Set the following environment variables (shown here for macOS):<p class="source-code"><strong class="bold">export SPARK_HOME="/path/to/spark/folder"</strong></p><p class="source-code"><strong class="bold">export MASTER="local[*]"</strong></p></li>
			</ol>
			<p>Now, let's install the Sparkling Water library<a id="_idIndexMarker1175"/> in our Python environment.</p>
			<h2 id="_idParaDest-272"><a id="_idTextAnchor274"/>Step 2 – Install Sparkling Water in Python </h2>
			<p>Install the following<a id="_idIndexMarker1176"/> modules:</p>
			<ol>
				<li value="1">Install dependencies in your Python environment:<p class="source-code"><strong class="bold">pip install requests</strong></p><p class="source-code"><strong class="bold">pip install tabulate</strong></p><p class="source-code"><strong class="bold">pip install future </strong></p></li>
				<li>Install the Sparkling Water Python module (called <strong class="source-inline">PySparkling</strong>). Note the module reference to Spark 3.2 specifically here:<p class="source-code"><strong class="bold">pip install h2o_pysparkling_3.2</strong></p></li>
			</ol>
			<p>Next, let's install an interactive shell.</p>
			<h2 id="_idParaDest-273"><a id="_idTextAnchor275"/>Step 3 – Install a Sparkling Water Python interactive shell</h2>
			<p>To run Sparkling Water<a id="_idIndexMarker1177"/> locally, we need to install an interactive shell to launch the Sparkling Water cluster on Spark. (This is only required when running Sparkling Water locally; Enterprise Steam takes care of this when running on your enterprise cluster.) To do so, perform the following steps:</p>
			<ol>
				<li value="1">Download the interactive shell by navigating to the <strong class="bold">Sparkling Water</strong> section of <a href="https://h2o.ai/resources/download/">https://h2o.ai/resources/download/</a>, clicking <strong class="bold">Sparkling Water For Spark 3.2</strong>, and finally, clicking on the <strong class="bold">DOWNLOAD SPARKLING WATER</strong> button.</li>
				<li>Unzip<a id="_idIndexMarker1178"/> the download.</li>
			</ol>
			<p>Now, let's launch a Sparkling Water cluster and access it from a Jupyter notebook.</p>
			<h2 id="_idParaDest-274"><a id="_idTextAnchor276"/>Step 4 – Launch a Jupyter notebook on top of the Sparkling Water shell</h2>
			<p>We assume you have Jupyter Notebook<a id="_idIndexMarker1179"/> installed in the same Python environment<a id="_idIndexMarker1180"/> as your installations in step <em class="italic">2</em>. Perform<a id="_idIndexMarker1181"/> the following steps to launch a Jupyter notebook: </p>
			<ol>
				<li value="1">On the command line, navigate into the directory where you unzipped the download in step <em class="italic">3</em> of this section.</li>
				<li>Launch the Sparkling Water interactive shell and a Jupyter notebook in it:<ul><li>For macOS, use the following:<p class="source-code"><strong class="bold">PYSPARK_DRIVER_PYTHON="ipython" \</strong></p><p class="source-code"><strong class="bold">PYSPARK_DRIVER_PYTHON_OPTS="notebook" \</strong></p><p class="source-code"><strong class="bold">bin/pysparkling</strong></p></li><li>For Windows, use the following:<p class="source-code"><strong class="bold">SET PYSPARK_DRIVER_PYTHON=ipython</strong></p><p class="source-code"><strong class="bold">SET PYSPARK_DRIVER_PYTHON_OPTS=notebook</strong></p><p class="source-code"><strong class="bold">bin/pysparkling</strong></p></li></ul></li>
			</ol>
			<p>Your Jupyter notebook should launch in your browser.</p>
			<p>Now, let's write Sparkling Water code.</p>
			<h2 id="_idParaDest-275"><a id="_idTextAnchor277"/>Step 5 – Launch your Sparkling Water cluster and write code</h2>
			<p>In your Jupyter notebook, type the following <a id="_idIndexMarker1182"/>code to get you started:</p>
			<ol>
				<li value="1">Start your Sparkling Water cluster:<p class="source-code">from pysparkling import *</p><p class="source-code">import h2o</p><p class="source-code">hc = H2OContext.getOrCreate()</p><p class="source-code">hc</p></li>
				<li>Test the installation:<p class="source-code">localdata = "/path/to/my/csv"</p><p class="source-code">mysparkdata = spark.read.load(localdata, format="csv")</p><p class="source-code">myH2Odata = hc.asH2OFrame(mysparkdata)</p></li>
			</ol>
			<p>You are now ready to build<a id="_idIndexMarker1183"/> models using both H2O and Spark code.</p>
			<h1 id="_idParaDest-276"><a id="_idTextAnchor278"/>H2O-3 cluster in the 90-day free trial environment for H2O AI Cloud</h1>
			<p>Here, you must interact with Enterprise Steam to run H2O-3. In this case, you will install the <strong class="source-inline">h2osteam</strong> module in your Python client environment in addition to the <strong class="source-inline">h2o</strong> module as we did when running H2O-3 locally.</p>
			<h2 id="_idParaDest-277"><a id="_idTextAnchor279"/>Step 1 – Get your 90-day trial to H2O AI Cloud</h2>
			<p>Get your <a id="_idIndexMarker1184"/>trial access to H2O AI Cloud here: <a href="https://h2o.ai/freetrial">https://h2o.ai/freetrial</a>.</p>
			<p>When you have completed all steps and can log in to H2O AI Cloud, then we can start running H2O-3 clusters as part of the H2O AI Cloud platform. Here are the next steps.</p>
			<h2 id="_idParaDest-278"><a id="_idTextAnchor280"/>Step 2 – Set up your Python environment</h2>
			<p>To set up your Python<a id="_idIndexMarker1185"/> client environment, perform the following steps:</p>
			<ol>
				<li value="1">Log in to H2O AI Cloud and click on the <strong class="bold">My AI Engines</strong> tab. This will take you to Enterprise Steam, as shown in the following screenshot. From there, download the <strong class="source-inline">h2osteam</strong> library by clicking on the <strong class="bold">Python Client</strong> option from the sidebar:</li>
			</ol>
			<div>
				<div id="_idContainer202" class="IMG---Figure">
					<img src="image/B16721_15_001.jpg" alt="Figure 15.1 – Enterprise Steam&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 15.1 – Enterprise Steam</p>
			<ol>
				<li value="2">Install the <strong class="source-inline">h2osteam</strong> library<a id="_idIndexMarker1186"/> in your Python environment by running the following command:<p class="source-code"><strong class="bold">pip install /path/to/download.whl</strong></p></li>
			</ol>
			<p>Here, <strong class="source-inline">/path/to/download.whl</strong> is replaced by your actual path.</p>
			<ol>
				<li value="3">You will also need to install the <strong class="source-inline">h2o</strong> library. To do so, execute the following:<p class="source-code"><strong class="bold">pip install requests</strong></p><p class="source-code"><strong class="bold">pip install tabulate</strong></p><p class="source-code"><strong class="bold">pip install future </strong></p><p class="source-code"><strong class="bold">pip install h2o</strong></p></li>
			</ol>
			<p>Now, let's use Steam to start an H2O cluster and then write H2O code in Python.</p>
			<h2 id="_idParaDest-279"><a id="_idTextAnchor281"/>Step 3 – Launch your cluster</h2>
			<p>Follow these steps to launch<a id="_idIndexMarker1187"/> your H2O cluster, which is done on a Kubernetes server cluster:</p>
			<ol>
				<li value="1">In Enterprise Steam, click <strong class="bold">H2O</strong> on the sidebar and then click the <strong class="bold">Launch New Cluster</strong> button.</li>
				<li>You now can configure your H2O cluster and give it a name. Be sure to configure the latest H2O version from the dropdown, which should match the library you installed in the previous step.</li>
				<li>When configured, click the <strong class="bold">Launch Cluster</strong> button and wait for the cluster launch to complete.</li>
				<li>You will need the URL to Enterprise Steam to connect to it from your Jupyter notebook or other Python client. While in Steam, copy the URL from <strong class="source-inline">https</strong> to <strong class="source-inline">h2o.ai</strong>, inclusive.</li>
			</ol>
			<h2 id="_idParaDest-280"><a id="_idTextAnchor282"/>Step 4 – Write H2O-3 code</h2>
			<p>We can now start<a id="_idIndexMarker1188"/> writing code (for example in Jupyter) to build models on our H2O-3 cluster that we just launched. Perform the following steps after opening your Python client:</p>
			<ol>
				<li value="1">Import your libraries and connect to Enterprise Steam:<p class="source-code">import h2o</p><p class="source-code">import h2osteam</p><p class="source-code">from h2osteam.clients import H2oKubernetesClient</p><p class="source-code">conn = h2osteam.login(</p><p class="source-code">    url="https://SteamURL, </p><p class="source-code">verify_ssl=False,</p><p class="source-code">    username="yourH2OAICloudUserName", </p><p class="source-code">    password=" yourH2OAICloudPassword")</p><p class="callout-heading">Important Note </p><p class="callout">At the time of this writing the URL for the 90-day H2O AI Cloud trial is <a href="https://steam.cloud.h2o.ai">https://steam.cloud.h2o.ai</a>.</p><p class="callout">For password you can use your login password to the H2O AI Cloud trial environment, or you can use a temporary personal access token generated from the Enterprise Steam Configurations page.</p></li>
				<li>Connect to your H2O cluster you started in Enterprise Steam:<p class="source-code">cluster = H2oKubernetesClient().get_cluster(</p><p class="source-code">    name="yourClusterName", </p><p class="source-code">    created_by="yourH2OAICloudUserName")</p><p class="source-code">cluster.connect()</p><p class="source-code"># you are now ready to write code to run on this H2O cluster</p></li>
			</ol>
			<p>You can now write<a id="_idIndexMarker1189"/> your H2O-3 code, including all samples from this book. </p>
		</div>
	</body></html>