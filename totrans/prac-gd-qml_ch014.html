<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch014.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="13" id="chapter-6-gas-grover-adaptive-search">
<h1 class="H1---Chapter chapterHead" data-number="13"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 6</span></span><br/>
<span id="x1-1060006"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">GAS: Grover Adaptive Search</span></span></h1>
<div class="flushright">
<p><em><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">If you do not expect the unexpected, you will not find it, for it is not</span></em> <em><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">to be reached by search or trail.</span></em><br/><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">
— Heraclitus</span></p>
</div>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we are going to introduce another quantum method for solving combinatorial optimization problems. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">In this case, we are going to take Grover’s algorithm — one of the most famous and celebrated quantum methods out there — as a starting point. </span><span class="koboSpan" id="kobo.6.3" xmlns="http://www.w3.org/1999/xhtml">Grover’s algorithm is used to find elements that satisfy specific conditions in unsorted data structures. </span><span class="koboSpan" id="kobo.6.4" xmlns="http://www.w3.org/1999/xhtml">But, as we will soon see, it can be easily adapted to function minimization tasks — exactly what we need for our optimization problems! </span><span class="koboSpan" id="kobo.6.5" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-106001"/><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">resulting method is sometimes called </span><strong><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Grover Adaptive Search</span></strong><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">GAS</span></strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">It is important to note that GAS is essentially different from the kind of quantum algorithms that we have been studying so far in this part of the book. </span><span class="koboSpan" id="kobo.12.2" xmlns="http://www.w3.org/1999/xhtml">This method is not designed specifically for NISQ devices and would need fault-tolerant quantum computers to fully realize its potential. </span><span class="koboSpan" id="kobo.12.3" xmlns="http://www.w3.org/1999/xhtml">However, we have still decided to cover it because it is readily implemented in some quantum programming libraries — such as Qiskit — and it can be helpful in comparing and benchmarking other quantum optimization algorithms.</span></p>
<p><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">We will start the chapter by refreshing some details about Grover’s algorithm, including the circuits that we need in order to implement it and the role that </span><strong><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">oracles</span></strong><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml"> play in it. </span><span class="koboSpan" id="kobo.15.2" xmlns="http://www.w3.org/1999/xhtml">Then, we will talk </span><span id="dx1-106002"/><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">about the </span><strong><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">Dürr-Høyer</span></strong><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml"> method, which uses Grover’s techniques to find the minimum of certain types of functions. </span><span class="koboSpan" id="kobo.18.2" xmlns="http://www.w3.org/1999/xhtml">After that, we will particularize the algorithm to QUBO problems and we will study how to implement the kind of oracle that they require.</span></p>
<p><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">With all those tools, we will have everything that we need in order to formulate and solve optimization problems with GAS, so we will turn to explain how to use Qiskit’s implementation of the algorithm. </span><span class="koboSpan" id="kobo.19.2" xmlns="http://www.w3.org/1999/xhtml">We will study the different options that are available to run the method and we will test it on several different examples.</span></p>
<p><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">After reading this chapter, you will understand the theoretical foundations of Grover Adaptive Search, you will know how to implement efficient oracles for optimization problems and how to use them with GAS, and you will be able to run Qiskit’s implementation of the algorithm to solve your own optimization problems.</span></p>
<p><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">The topics covered in this chapter are as follows:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s algorithm</span></p></li>
<li><p><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">Quantum oracles for combinatorial optimization</span></p></li>
<li><p><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Using GAS with Qiskit</span></p></li>
</ul>
<section class="level2 sectionHead" data-number="13.1" id="grovers-algorithm">
<h1 class="sectionHead" data-number="13.1"><span class="titlemark"><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">6.1 </span></span> <span id="x1-1070006.1"><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s algorithm</span></span></h1>
<p><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we will cover the </span><span id="dx1-107001"/><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">most important properties of Grover’s algorithm. </span><span class="koboSpan" id="kobo.28.2" xmlns="http://www.w3.org/1999/xhtml">We will not cover all the theoretical details behind the procedure — for that, we recommend the book by Nielsen and Chuang </span><span class="cite"><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xnielsen11quantum"><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">69</span></a><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml"> and, especially, the lecture notes by John Watrous </span><span class="cite"><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xwatrous2005quantum"><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">95</span></a><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml"> — but we need to at least get familiar with how the method operates, what oracles are and how they are used in the algorithm, and what kind of circuits are needed to implement it.</span></p>
<p><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start with the basics. </span><span class="koboSpan" id="kobo.37.2" xmlns="http://www.w3.org/1999/xhtml">Grover’s </span><span id="dx1-107002"/><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">algorithm is used for searching elements that satisfy certain conditions. </span><span class="koboSpan" id="kobo.38.2" xmlns="http://www.w3.org/1999/xhtml">More formally, the algorithm assumes that we have a collection of elements indexed by strings of </span><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml"> bits, and a Boolean function </span><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml"> that takes those binary strings and returns ”true” (or </span><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">) if the element indexed by the string satisfies the condition and ”false” (or </span><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">) otherwise. </span><span class="koboSpan" id="kobo.46.2" xmlns="http://www.w3.org/1999/xhtml">For instance, imagine that we are searching among 8 different elements and that the ones that satisfy the condition are indexed by the strings </span><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="010" class="math inline" src="../media/file779.png" style="vertical-align:middle" title="010"/></span><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.50.2" xmlns="http://www.w3.org/1999/xhtml">Then, </span><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"> will be the Boolean function such that </span><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = 010" class="math inline" src="../media/file781.png" style="vertical-align:middle" title="x = 010"/></span><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = 100" class="math inline" src="../media/file782.png" style="vertical-align:middle" title="x = 100"/></span><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 0" class="math inline" src="../media/file783.png" style="vertical-align:middle" title="f(x) = 0"/></span><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.60.2" xmlns="http://www.w3.org/1999/xhtml">To simplify the notation, from now on we will identify an element with the string </span><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml"> that is used to index it.</span></p>
<p><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">It is important to notice that, in this setting, we have no access to the inner workings of </span><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.65.2" xmlns="http://www.w3.org/1999/xhtml">It acts like a black box. </span><span class="koboSpan" id="kobo.65.3" xmlns="http://www.w3.org/1999/xhtml">The only thing that we can do with the </span><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"> function is call it on inputs and observe the outputs, thus checking whether the given input satisfies the condition that we are considering or not. </span><span class="koboSpan" id="kobo.67.2" xmlns="http://www.w3.org/1999/xhtml">Since we do not have any information about the indices of the elements that satisfy the condition, we cannot favour any position over any other. </span><span class="koboSpan" id="kobo.67.3" xmlns="http://www.w3.org/1999/xhtml">Thus, with a classical algorithm, if we are searching among </span><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N" class="math inline" src="../media/file784.png" style="vertical-align:middle" title="N"/></span><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml"> elements and only one of them satisfies the condition we are interested in, we will need to call </span><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml"> about </span><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. N\slash 2 \right." class="math inline" src="../media/file785.png" style="vertical-align:middle" title="\left. N\slash 2 \right."/></span><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml"> times on average in order to find it. </span><span class="koboSpan" id="kobo.73.2" xmlns="http://www.w3.org/1999/xhtml">The element could be just anywhere! </span><span class="koboSpan" id="kobo.73.3" xmlns="http://www.w3.org/1999/xhtml">In fact, if we are extremely unlucky, we might need to use </span><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N - 1" class="math inline" src="../media/file786.png" style="vertical-align:middle" title="N - 1"/></span><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml"> calls (notice that we wouldn’t need </span><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N" class="math inline" src="../media/file784.png" style="vertical-align:middle" title="N"/></span><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml"> calls: if we don’t find the element after </span><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N - 1" class="math inline" src="../media/file786.png" style="vertical-align:middle" title="N - 1"/></span><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml"> different calls, we already know the remaining position to be the one where the element is located).</span></p>
<p><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">It may come as a big surprise, then, that with Grover’s algorithm it is possible to find the hidden element with high probability (much more on this later in this section) by calling </span><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml"> around </span><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{N}" class="math inline" src="../media/file787.png" style="vertical-align:middle" title="\sqrt{N}"/></span><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> times! </span><span class="koboSpan" id="kobo.84.2" xmlns="http://www.w3.org/1999/xhtml">This means that if we are searching among </span><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1\, 000\, 000" class="math inline" src="../media/file788.png" style="vertical-align:middle" title="1\, 000\, 000"/></span><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml"> elements, with a classical computer you would need to check </span><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml"> about </span><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="500\, 000" class="math inline" src="../media/file789.png" style="vertical-align:middle" title="500\, 000"/></span><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml"> times on average, but calling </span><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml"> less than </span><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1000" class="math inline" src="../media/file790.png" style="vertical-align:middle" title="1000"/></span><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"> times would suffice in order to solve the problem with a quantum computer, at least with a high likelihood. </span><span class="koboSpan" id="kobo.94.2" xmlns="http://www.w3.org/1999/xhtml">What is more, the difference in the number of calls between the classical and the quantum methods grows bigger if </span><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N" class="math inline" src="../media/file784.png" style="vertical-align:middle" title="N"/></span><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"> is higher.</span></p>
<p><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">How is this possible? </span><span class="koboSpan" id="kobo.97.2" xmlns="http://www.w3.org/1999/xhtml">It seems to defy all logic, but it rests on properties that we are already familiar with, such as superposition and entanglement. </span><span class="koboSpan" id="kobo.97.3" xmlns="http://www.w3.org/1999/xhtml">In fact, Grover’s algorithm will query </span><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"> with elements that are in superposition. </span><span class="koboSpan" id="kobo.99.2" xmlns="http://www.w3.org/1999/xhtml">But in order to understand this, we need to explore what </span><span id="dx1-107003"/><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">quantum oracles are and how they can be used, so let’s get to it!</span></p>
<section class="level3 subsectionHead" data-number="13.1.1" id="quantum-oracles">
<h2 class="subsectionHead" data-number="13.1.1"><span class="titlemark"><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">6.1.1 </span></span> <span id="x1-1080006.1.1"><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">Quantum oracles</span></span></h2>
<p><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">We have </span><span id="dx1-108001"/><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">mentioned that, in the setting of the search problem solved by Grover’s algorithm, we are given a Boolean function </span><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"> that we can use to determine whether an element is the one we are looking for or not. </span><span class="koboSpan" id="kobo.106.2" xmlns="http://www.w3.org/1999/xhtml">But what do we mean when we say that we are ”given” this function?</span></p>
<p><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">In the classical case, this is more or less straightforward. </span><span class="koboSpan" id="kobo.107.2" xmlns="http://www.w3.org/1999/xhtml">If we were writing our code in Python, we could be given a function object that receives an </span><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">-bit string and returns </span><code><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">False</span></code><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.113.2" xmlns="http://www.w3.org/1999/xhtml">Then, we could use that function in our own code to check the elements that we want to consider, without necessarily knowing how it is implemented.</span></p>
<p><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml">But…what is the equivalent to that function definition when we are working with quantum circuits? </span><span class="koboSpan" id="kobo.114.2" xmlns="http://www.w3.org/1999/xhtml">The most natural assumption is that we are provided with a new quantum gate </span><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml"> that implements </span><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml"> and that we can use in our circuits whenever we need it. </span><span class="koboSpan" id="kobo.118.2" xmlns="http://www.w3.org/1999/xhtml">However, a quantum gate needs to be a unitary operation and, in particular, reversible, so we need to be a little bit careful in how we design it.</span></p>
<p><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">In the classical case, we had </span><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml"> inputs — the </span><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml"> bits of the string — and just one output. </span><span class="koboSpan" id="kobo.123.2" xmlns="http://www.w3.org/1999/xhtml">In the quantum case, we need at least </span><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml"> inputs — </span><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml"> qubits — but just one output would not work, because then it would be impossible to make the operation reversible, let alone unitary. </span><span class="koboSpan" id="kobo.127.2" xmlns="http://www.w3.org/1999/xhtml">In fact, as you surely remember, every quantum gate has the same number of inputs and outputs.</span></p>
<p><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">The usual approach, then, is to consider a quantum gate on </span><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n + 1" class="math inline" src="../media/file792.png" style="vertical-align:middle" title="n + 1"/></span><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml"> qubits. </span><span class="koboSpan" id="kobo.130.2" xmlns="http://www.w3.org/1999/xhtml">The first </span><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml"> of these qubits will serve as the input and the additional one will be used to store the output. </span><span class="koboSpan" id="kobo.132.2" xmlns="http://www.w3.org/1999/xhtml">More formally, on any input </span><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| y \right\rangle" class="math inline" src="../media/file793.png" style="vertical-align:middle" title="\left| x \right\rangle\left| y \right\rangle"/></span><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"> is an </span><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">-bit string and </span><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"> is a single bit, the output of the </span><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"> gate will be </span><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| {y \oplus f(x)} \right\rangle" class="math inline" src="../media/file794.png" style="vertical-align:middle" title="\left| x \right\rangle\left| {y \oplus f(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\oplus" class="math inline" src="../media/file195.png" style="vertical-align:middle" title="\oplus"/></span><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"> denotes addition modulo 2 (see </span><em><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch025.xhtml#x1-226000B"><em><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">B</span></em></a><em><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">, Basic Linear Algebra</span></em><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">, for a refresher on modular arithmetic). </span><span class="koboSpan" id="kobo.150.2" xmlns="http://www.w3.org/1999/xhtml">This defines the action of the gate on the computational basis states and then we can extend it to the rest of the quantum states by linearity, as usual.</span></p>
<p><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-108002"/><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">may look like an odd choice. </span><span class="koboSpan" id="kobo.152.2" xmlns="http://www.w3.org/1999/xhtml">The ”natural” thing to do might seem to be requiring the output to be </span><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| {f(x)} \right\rangle" class="math inline" src="../media/file795.png" style="vertical-align:middle" title="\left| x \right\rangle\left| {f(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">, right? </span><span class="koboSpan" id="kobo.154.2" xmlns="http://www.w3.org/1999/xhtml">But that would not be reversible in general, because we would obtain the same output over the inputs </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file796.png" style="vertical-align:middle" title="\left| x \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| 1 \right\rangle" class="math inline" src="../media/file797.png" style="vertical-align:middle" title="\left| x \right\rangle\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.158.2" xmlns="http://www.w3.org/1999/xhtml">With our choice, though, the operation is reversible. </span><span class="koboSpan" id="kobo.158.3" xmlns="http://www.w3.org/1999/xhtml">If we applied </span><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml"> twice, we would obtain </span><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| {y \oplus f(x) \oplus f(x)} \right\rangle" class="math inline" src="../media/file798.png" style="vertical-align:middle" title="\left| x \right\rangle\left| {y \oplus f(x) \oplus f(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">, which is equal to </span><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| y \right\rangle" class="math inline" src="../media/file793.png" style="vertical-align:middle" title="\left| x \right\rangle\left| y \right\rangle"/></span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml"> because, when we are performing addition modulo </span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) \oplus f(x) = 0" class="math inline" src="../media/file799.png" style="vertical-align:middle" title="f(x) \oplus f(x) = 0"/></span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml"> no matter the value of </span><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox questionx" id="tcolobox-119">
<span id="x1-108004x6.1.1"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.1</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Prove that </span><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"> is not only reversible but also unitary and hence it deserves the name ”quantum gate.”</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">Usually, </span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml"> is said to be a quantum oracle for </span><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">, because we can consult it to get the value of </span><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"> on any input </span><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"> without having to worry about its internal workings. </span><span class="koboSpan" id="kobo.183.2" xmlns="http://www.w3.org/1999/xhtml">In fact, if the input to </span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file796.png" style="vertical-align:middle" title="\left| x \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">, then the output is </span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| {0 \oplus f(x)} \right\rangle = \left| x \right\rangle\left| {f(x)} \right\rangle" class="math inline" src="../media/file801.png" style="vertical-align:middle" title="\left| x \right\rangle\left| {0 \oplus f(x)} \right\rangle = \left| x \right\rangle\left| {f(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"> and we could hence recover </span><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> just by measuring the last qubit.</span></p>
<p><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">For any </span><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">, it is always possible to construct </span><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml"> by using just NOT and multi-controlled NOT gates — even if the resulting circuit is not the most efficient one in most cases. </span><span class="koboSpan" id="kobo.196.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if </span><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"> is a Boolean function on 3-bit strings such that </span><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml"> takes value </span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml"> just on </span><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="101" class="math inline" src="../media/file802.png" style="vertical-align:middle" title="101"/></span><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="011" class="math inline" src="../media/file803.png" style="vertical-align:middle" title="011"/></span><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">, then we can use the circuit depicted in </span><em><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.1"><em><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">6.1</span></em></a><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.209.2" xmlns="http://www.w3.org/1999/xhtml">Notice how we have used NOT gates before and after the multi-controlled gates to select those qubits that should be </span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"> in the input and to restore them to their original values.</span></p>
<figure>
<span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.1: Oracle for the Boolean function f that takes value 1 on 101 and 011, and value 0 on the rest of the 3-bit strings" src="../media/file804.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.1"><strong><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.1</span></strong><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml">Oracle for the Boolean function </span><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"> that takes value </span><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml"> on </span><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="101" class="math inline" src="../media/file802.png" style="vertical-align:middle" title="101"/></span><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="011" class="math inline" src="../media/file803.png" style="vertical-align:middle" title="011"/></span><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">, and value </span><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"> on the rest of the 3-bit strings</span></figcaption>
</figure>
<div class="tcolorbox questionx" id="tcolobox-120">
<span id="x1-108008x6.1.1"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.2</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">Construct a circuit for </span><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml"> where </span><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml"> is a 4-bit Boolean function that takes value </span><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml"> on </span><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0111" class="math inline" src="../media/file805.png" style="vertical-align:middle" title="0111"/></span><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1110" class="math inline" src="../media/file806.png" style="vertical-align:middle" title="1110"/></span><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0101" class="math inline" src="../media/file807.png" style="vertical-align:middle" title="0101"/></span><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">, and value </span><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml"> on any other input.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">This settles how we are going to receive the Boolean function </span><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"> that we can use to check whether a given element satisfies the conditions that we are interested in: the function will be given to us as a </span><span id="dx1-108009"/><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">quantum oracle. </span><span class="koboSpan" id="kobo.245.2" xmlns="http://www.w3.org/1999/xhtml">Now it’s time for us to show how we can use these quantum oracles in Grover’s algorithm.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.1.2" id="grovers-circuits">
<h2 class="subsectionHead" data-number="13.1.2"><span class="titlemark"><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">6.1.2 </span></span> <span id="x1-1090006.1.2"><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s circuits</span></span></h2>
<p><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">Let’s say that we </span><span id="dx1-109001"/><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">want to apply Grover’s algorithm to a Boolean function </span><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml"> which receives binary strings of length </span><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.253.2" xmlns="http://www.w3.org/1999/xhtml">In addition to the </span><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml"> oracle described in the previous section, the circuit used in Grover’s algorithm involves two other blocks, as you can see in </span><em><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.2"><em><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">6.2</span></em></a><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.2: Circuit for Grover’s algorithm in the case in which f receives strings of length 3 as input. The oracle O_{f} and Grover’s diffusion operator are repeated, in that order, a number of times before the final measurements " src="../media/file808.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.2"><strong><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.2</span></strong><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="content"><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for Grover’s algorithm in the case in which </span><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"> receives strings of length </span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> as input. </span><span class="koboSpan" id="kobo.266.2" xmlns="http://www.w3.org/1999/xhtml">The oracle </span><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"> and Grover’s diffusion operator are repeated, in that order, a number of times before the final measurements </span></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">The first block is composed of one-qubit gates that are applied to the initial state </span><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {0\cdots 0} \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file809.png" style="vertical-align:middle" title="\left| {0\cdots 0} \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">, where the first register is of length </span><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"> and the </span><span id="dx1-109004"/><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">second one is of length </span><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.276.2" xmlns="http://www.w3.org/1999/xhtml">Thus, the state just before applying the oracle is</span></p>
<p><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H^{\otimes n + 1}\left| 0 \right\rangle^{\otimes n}\left| 1 \right\rangle = \left| + \right\rangle^{\otimes n}\left| - \right\rangle = \frac{1}{\sqrt{2^{n}}}\left( {(\left| 0 \right\rangle + \left| 1 \right\rangle)\cdots(\left| 0 \right\rangle + \left| 1 \right\rangle)} \right)\left| - \right\rangle = \frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle," class="math display" src="../media/file810.png" style="vertical-align:middle" title="H^{\otimes n + 1}\left| 0 \right\rangle^{\otimes n}\left| 1 \right\rangle = \left| + \right\rangle^{\otimes n}\left| - \right\rangle = \frac{1}{\sqrt{2^{n}}}\left( {(\left| 0 \right\rangle + \left| 1 \right\rangle)\cdots(\left| 0 \right\rangle + \left| 1 \right\rangle)} \right)\left| - \right\rangle = \frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">because we apply the first </span><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml"> gate to </span><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"> to obtain </span><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">Notice that the first register of this state is a superposition of all basis states </span><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span id="dx1-109005"/><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">This is exactly what we will use in order to evaluate </span><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml"> ”in superposition” with our application of the </span><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml"> oracle. </span><span class="koboSpan" id="kobo.292.2" xmlns="http://www.w3.org/1999/xhtml">Indeed, by the definition of </span><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">, the state that we will have after the application of the oracle is</span></p>
<p><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{matrix} {O_{f}\left( {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle} \right) = O_{f}\left( {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle)} \right) =} &amp; \\ {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}O_{f}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle) = \frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle),} &amp; \\ \end{matrix}" class="math display" src="../media/file811.png" style="vertical-align:middle" title="\begin{matrix} {O_{f}\left( {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle} \right) = O_{f}\left( {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle)} \right) =} &amp; \\ {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}O_{f}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle) = \frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle),} &amp; \\ \end{matrix}"/></span></p>
<p><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">where in the last two equalities he have used linearity together with the definition of </span><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">Let’s focus on the </span><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle" class="math inline" src="../media/file812.png" style="vertical-align:middle" title="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml"> term. </span><span class="koboSpan" id="kobo.301.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 0" class="math inline" src="../media/file783.png" style="vertical-align:middle" title="f(x) = 0"/></span><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">, then it is just </span><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle - \left| 1 \right\rangle" class="math inline" src="../media/file813.png" style="vertical-align:middle" title="\left| 0 \right\rangle - \left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.305.2" xmlns="http://www.w3.org/1999/xhtml">However, if </span><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">, we have</span></p>
<p><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle = \left| {0 \oplus 1} \right\rangle - \left| {1 \oplus 1} \right\rangle = \left| 1 \right\rangle - \left| 0 \right\rangle = - (\left| 0 \right\rangle - \left| 1 \right\rangle)," class="math display" src="../media/file814.png" style="vertical-align:middle" title="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle = \left| {0 \oplus 1} \right\rangle - \left| {1 \oplus 1} \right\rangle = \left| 1 \right\rangle - \left| 0 \right\rangle = - (\left| 0 \right\rangle - \left| 1 \right\rangle),"/></span></p>
<p><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">because </span><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1 \oplus 1 = 0" class="math inline" src="../media/file815.png" style="vertical-align:middle" title="1 \oplus 1 = 0"/></span><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.311.2" xmlns="http://www.w3.org/1999/xhtml">In both cases, we can write</span></p>
<p><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle = {( - 1)}^{f(x)}(\left| 0 \right\rangle - \left| 1 \right\rangle)," class="math display" src="../media/file816.png" style="vertical-align:middle" title="\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle = {( - 1)}^{f(x)}(\left| 0 \right\rangle - \left| 1 \right\rangle),"/></span></p>
<p><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">because </span><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{( - 1)}^{0} = 1" class="math inline" src="../media/file817.png" style="vertical-align:middle" title="{( - 1)}^{0} = 1"/></span><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{( - 1)}^{1} = - 1" class="math inline" src="../media/file818.png" style="vertical-align:middle" title="{( - 1)}^{1} = - 1"/></span><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">Note how, thanks to these transformations, there is information about the value </span><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml"> coded into the amplitude of the state now. </span><span class="koboSpan" id="kobo.320.2" xmlns="http://www.w3.org/1999/xhtml">As you will soon see, this is a key ingredient of the algorithm.</span></p>
<p><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">If we take this to our </span><span id="dx1-109006"/><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">expression for the state after the oracle application, we get</span></p>
<p><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{matrix} {O_{f}\left( {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle} \right) = \frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle) =} &amp; \\ {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle) = \frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle\frac{1}{\sqrt{2}}(\left| 0 \right\rangle - \left| 1 \right\rangle) =} &amp; \\ {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle\left| - \right\rangle.} &amp; \\ \end{matrix}" class="math display" src="../media/file819.png" style="vertical-align:middle" title="\begin{matrix} {O_{f}\left( {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle\left| - \right\rangle} \right) = \frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}\left| x \right\rangle(\left| {0 \oplus f(x)} \right\rangle - \left| {1 \oplus f(x)} \right\rangle) =} &amp; \\ {\frac{1}{\sqrt{2^{n + 1}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle(\left| 0 \right\rangle - \left| 1 \right\rangle) = \frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle\frac{1}{\sqrt{2}}(\left| 0 \right\rangle - \left| 1 \right\rangle) =} &amp; \\ {\frac{1}{\sqrt{2^{n}}}\sum\limits_{x = 0}^{2^{n} - 1}{( - 1)}^{f(x)}\left| x \right\rangle\left| - \right\rangle.} &amp; \\ \end{matrix}"/></span></p>
<p><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">Notice how the application of </span><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml"> has introduced a relative phase in some of the states </span><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml"> of the superposition. </span><span class="koboSpan" id="kobo.328.2" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-109007"/><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">technique is called </span><strong><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">phase kickback</span></strong><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">, because we have only used the register in state </span><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| - \right\rangle" class="math inline" src="../media/file63.png" style="vertical-align:middle" title="\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> to create the phase but it ends up affecting the whole state. </span><span class="koboSpan" id="kobo.333.2" xmlns="http://www.w3.org/1999/xhtml">It is used in other famous quantum methods such as the Deutsch-Jozsa and Simon’s algorithms (see the book by Yanofsky and Mannucci </span><span class="cite"><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xyanofsky2008quantum"><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">100</span></a><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"> for an excellent explanation of these methods).</span></p>
<p><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">As we have proved, the phase that goes with the basis state </span><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml"> depends only on </span><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x)" class="math inline" src="../media/file800.png" style="vertical-align:middle" title="f(x)"/></span><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml"> and it is </span><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 0" class="math inline" src="../media/file783.png" style="vertical-align:middle" title="f(x) = 0"/></span><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.350.2" xmlns="http://www.w3.org/1999/xhtml">In this way, we say that we have </span><strong><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">marked</span></strong><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml"> those elements that satisfy the conditions that we are interested in, that is, those elements </span><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.356.2" xmlns="http://www.w3.org/1999/xhtml">Remarkably, we have done this with just one call to </span><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">, exploiting the possibility of evaluating it in superposition. </span><span class="koboSpan" id="kobo.358.2" xmlns="http://www.w3.org/1999/xhtml">That is an exponential number of function evaluations with just one call! </span><span class="koboSpan" id="kobo.358.3" xmlns="http://www.w3.org/1999/xhtml">It sounds like magic, doesn’t it?</span></p>
<p><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">However, although after applying </span><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> we have somehow separated the elements </span><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml"> that satisfy </span><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml"> from the rest, we do not seem to be closer to finding one of them. </span><span class="koboSpan" id="kobo.365.2" xmlns="http://www.w3.org/1999/xhtml">If we measure the state as it is, the probability of </span><span id="dx1-109008"/><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">measuring an </span><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml"> is the same as it was before applying </span><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.372.2" xmlns="http://www.w3.org/1999/xhtml">The phase that we have introduced has an absolute value equal to </span><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml"> and, consequently, does not affect the measurement probability.</span></p>
<p><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">But, wait! </span><span class="koboSpan" id="kobo.375.2" xmlns="http://www.w3.org/1999/xhtml">There is more to Grover’s algorithm. </span><span class="koboSpan" id="kobo.375.3" xmlns="http://www.w3.org/1999/xhtml">There is </span><span id="dx1-109009"/><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">another circuit block that we apply after </span><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">: it’s called </span><strong><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s diffusion operator</span></strong><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml"> and we will use it to increase the probability of measuring the marked states. </span><span class="koboSpan" id="kobo.380.2" xmlns="http://www.w3.org/1999/xhtml">Describing its inner workings in full detail would take us astray from our path — for that, we recommend checking out Dancing with Qubits </span><span class="cite"><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsutor2019dancing"><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">92</span></a><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">, by Robert Sutor, which offers a perfect explanation of its behaviour — but let’s at least give a quick overview of what it does.</span></p>
<p><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s diffusion operator implements an </span><span id="dx1-109010"/><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">operation called </span><strong><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">inversion about the</span></strong> <strong><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">mean</span></strong><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.389.2" xmlns="http://www.w3.org/1999/xhtml">This may sound complicated, but in fact it is quite simple. </span><span class="koboSpan" id="kobo.389.3" xmlns="http://www.w3.org/1999/xhtml">First, the average value </span><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml"> of all the amplitudes of the states is computed. </span><span class="koboSpan" id="kobo.391.2" xmlns="http://www.w3.org/1999/xhtml">Then, every amplitude </span><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a" class="math inline" src="../media/file16.png" style="vertical-align:middle" title="a"/></span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"> is replaced with </span><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2m - a" class="math inline" src="../media/file820.png" style="vertical-align:middle" title="2m - a"/></span><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.395.2" xmlns="http://www.w3.org/1999/xhtml">After this transformation, the positive amplitudes will be a little bit smaller, but the negative ones will be a little bit bigger. </span><span class="koboSpan" id="kobo.395.3" xmlns="http://www.w3.org/1999/xhtml">This is why the </span><span id="dx1-109011"/><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">technique used by Grover’s algorithm is called </span><strong><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml">amplitude amplification</span></strong><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.398.2" xmlns="http://www.w3.org/1999/xhtml">Again, we recommend you checking Sutor’s book </span><span class="cite"><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsutor2019dancing"><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">92</span></a><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml"> for a detailed description of how this operation works.</span></p>
<p><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">So, after this first application of Grover’s diffusion operator, the amplitudes of the elements that we are interested in finding are a little bit larger. </span><span class="koboSpan" id="kobo.403.2" xmlns="http://www.w3.org/1999/xhtml">But, in general, this will still not be enough to guarantee a high probability of measuring one of them. </span><span class="koboSpan" id="kobo.403.3" xmlns="http://www.w3.org/1999/xhtml">For this reason, we will need to mark the elements again with </span><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml"> and then apply the diffusion operator once more. </span><span class="koboSpan" id="kobo.405.2" xmlns="http://www.w3.org/1999/xhtml">We will repeat this procedure, applying first </span><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml"> and then the diffusion operator, several times until the probability of measuring one of the states we are looking for is high enough (close to </span><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.409.2" xmlns="http://www.w3.org/1999/xhtml">And that is the moment when we can measure the whole state and observe the result to, hopefully, obtain one element that satisfies the conditions.</span></p>
<p><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">But how many times should we apply </span><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"> followed by the diffusion operator? </span><span class="koboSpan" id="kobo.412.2" xmlns="http://www.w3.org/1999/xhtml">This is a crucial point in Grover’s algorithm that we will study in more detail in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.1.3" id="probability-of-finding-a-marked-element">
<h2 class="subsectionHead" data-number="13.1.3"><span class="titlemark"><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">6.1.3 </span></span> <span id="x1-1100006.1.3"><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">Probability of finding a marked element</span></span></h2>
<p><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">As we have just seen, when using Grover’s algorithm, we are repeatedly applying for a certain number of times the </span><span id="dx1-110001"/><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">quantum oracle given to us followed by the diffusion operator. </span><span class="koboSpan" id="kobo.416.2" xmlns="http://www.w3.org/1999/xhtml">Of course, we would like the number of repetitions to be as small as possible — so that the algorithm runs faster — while guaranteeing a high probability of finding one of the marked elements. </span><span class="koboSpan" id="kobo.416.3" xmlns="http://www.w3.org/1999/xhtml">How can we go about this?</span></p>
<p><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">One possible approach in order to analyze the behaviour of Grover’s algorithm could be studying the properties of the inversion about the mean operation that we mentioned in the previous subsection. </span><span class="koboSpan" id="kobo.417.2" xmlns="http://www.w3.org/1999/xhtml">However, there is a better way. </span><span class="koboSpan" id="kobo.417.3" xmlns="http://www.w3.org/1999/xhtml">It turns out that the combination of </span><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml"> and Grover’s diffusion operator acts like a rotation in a two-dimensional space. </span><span class="koboSpan" id="kobo.419.2" xmlns="http://www.w3.org/1999/xhtml">We will not give the full details — check the lecture notes by John Watrous </span><span class="cite"><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xwatrous2005quantum"><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">95</span></a><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> for a very thorough and readable explanation — but, if we have </span><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">-bit strings and there is only one marked element </span><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">, it can be proved that the state that we reach after </span><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml"> applications of </span><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"> followed by the diffusion operator is</span></p>
<p><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\cos(2m + 1)\theta\left| x_{0} \right\rangle + \sin(2m + 1)\theta\left| x_{1} \right\rangle," class="math display" src="../media/file821.png" style="vertical-align:middle" title="\cos(2m + 1)\theta\left| x_{0} \right\rangle + \sin(2m + 1)\theta\left| x_{1} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">where</span></p>
<p><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{0} \right\rangle = \sum\limits_{x \in {\{ 0,1\}}^{n},x \neq x_{1}}\sqrt{\frac{1}{2^{n} - 1}}\left| x \right\rangle" class="math display" src="../media/file822.png" style="vertical-align:middle" title="\left| x_{0} \right\rangle = \sum\limits_{x \in {\{ 0,1\}}^{n},x \neq x_{1}}\sqrt{\frac{1}{2^{n} - 1}}\left| x \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">and </span><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \theta \in (0,\pi\slash 2) \right." class="math inline" src="../media/file823.png" style="vertical-align:middle" title="\left. \theta \in (0,\pi\slash 2) \right."/></span><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml"> is such that</span></p>
<p><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\cos\theta = \sqrt{\frac{2^{n} - 1}{2^{n}}},\qquad\sin\theta = \sqrt{\frac{1}{2^{n}}}." class="math display" src="../media/file824.png" style="vertical-align:middle" title="\cos\theta = \sqrt{\frac{2^{n} - 1}{2^{n}}},\qquad\sin\theta = \sqrt{\frac{1}{2^{n}}}."/></span></p>
<p><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">Notice that </span><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{0} \right\rangle" class="math inline" src="../media/file825.png" style="vertical-align:middle" title="\left| x_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml"> is just the uniform superposition of the states </span><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 0" class="math inline" src="../media/file783.png" style="vertical-align:middle" title="f(x) = 0"/></span><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.445.2" xmlns="http://www.w3.org/1999/xhtml">Then, what we want to obtain is a state in which </span><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sin(2m + 1)\theta" class="math inline" src="../media/file826.png" style="vertical-align:middle" title="\sin(2m + 1)\theta"/></span><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml"> is close to </span><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">, because then </span><span id="dx1-110002"/><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">we would have a high probability of finding </span><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml"> when we measure. </span><span class="koboSpan" id="kobo.452.2" xmlns="http://www.w3.org/1999/xhtml">For that, ideally, we would like to have</span></p>
<p><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(2m + 1)\theta \approx \frac{\pi}{2}," class="math display" src="../media/file827.png" style="vertical-align:middle" title="(2m + 1)\theta \approx \frac{\pi}{2},"/></span></p>
<p><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">because </span><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \sin\pi\slash 2 = 1 \right." class="math inline" src="../media/file828.png" style="vertical-align:middle" title="\left. \sin\pi\slash 2 = 1 \right."/></span><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">Solving for </span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">, we obtain</span></p>
<p><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m \approx \frac{\pi}{4\theta} - \frac{1}{2}." class="math display" src="../media/file829.png" style="vertical-align:middle" title="m \approx \frac{\pi}{4\theta} - \frac{1}{2}."/></span></p>
<p><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">What is more, we know that </span><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sin\theta = \sqrt{\left. 1\slash 2^{n} \right.}" class="math inline" src="../media/file830.png" style="vertical-align:middle" title="\sin\theta = \sqrt{\left. 1\slash 2^{n} \right.}"/></span><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">, so, for a big enough </span><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">, we will have</span></p>
<p><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta \approx \sqrt{\frac{1}{2^{n}}}" class="math display" src="../media/file831.png" style="vertical-align:middle" title="\theta \approx \sqrt{\frac{1}{2^{n}}}"/></span></p>
<p><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">and then we can choose</span></p>
<p><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = \left\lfloor {\frac{\pi}{4}\sqrt{2^{n}}} \right\rfloor," class="math display" src="../media/file832.png" style="vertical-align:middle" title="m = \left\lfloor {\frac{\pi}{4}\sqrt{2^{n}}} \right\rfloor,"/></span></p>
<p><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">that is, the biggest integer that is less than or equal to </span><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. (\pi\slash 4)\sqrt{2^{n}} \right." class="math inline" src="../media/file833.png" style="vertical-align:middle" title="\left. (\pi\slash 4)\sqrt{2^{n}} \right."/></span><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">Notice that there are exactly </span><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"> elements but only one of them satisfies the conditions we are interested in. </span><span class="koboSpan" id="kobo.474.2" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-110003"/><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">means that, with a classical algorithm, if we can only use </span><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml"> to check if an element </span><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml"> is the one we are looking for — that is, to check if </span><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = 1" class="math inline" src="../media/file780.png" style="vertical-align:middle" title="f(x) = 1"/></span><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml"> — then we would need about </span><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 2^{n}\slash 2 \right." class="math inline" src="../media/file834.png" style="vertical-align:middle" title="\left. 2^{n}\slash 2 \right."/></span><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> calls to </span><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml"> on average to find </span><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.487.2" xmlns="http://www.w3.org/1999/xhtml">However, with Grover’s algorithm, we only need about </span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{2^{n}}" class="math inline" src="../media/file835.png" style="vertical-align:middle" title="\sqrt{2^{n}}"/></span><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.489.2" xmlns="http://www.w3.org/1999/xhtml">That is a quadratic speedup!</span></p>
<p><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, there is a subtlety here. </span><span class="koboSpan" id="kobo.490.2" xmlns="http://www.w3.org/1999/xhtml">In the classical setting, if we use </span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f" class="math inline" src="../media/file778.png" style="vertical-align:middle" title="f"/></span><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml"> more times, the probability of finding the marked element increases. </span><span class="koboSpan" id="kobo.492.2" xmlns="http://www.w3.org/1999/xhtml">But with Grover’s algorithm, if </span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml"> is not selected wisely, we can overshoot and actually decrease the success probability instead of increasing it!</span></p>
<p><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">This sounds baffling. </span><span class="koboSpan" id="kobo.495.2" xmlns="http://www.w3.org/1999/xhtml">How is it possible that by searching more we find ourselves with less possibilities of finding the hidden element? </span><span class="koboSpan" id="kobo.495.3" xmlns="http://www.w3.org/1999/xhtml">The key is that, as we have shown, the probability of measuring </span><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(\sin(2m + 1)\theta)}^{2}" class="math inline" src="../media/file836.png" style="vertical-align:middle" title="{(\sin(2m + 1)\theta)}^{2}"/></span><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.499.2" xmlns="http://www.w3.org/1999/xhtml">This function is periodic and oscillates between </span><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">, so after reaching values close to </span><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml">, it goes back down to </span><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">Let’s illustrate this with an example. </span><span class="koboSpan" id="kobo.508.2" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.3"><em><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">6.3</span></em></a><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">, we consider the case </span><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n = 4" class="math inline" src="../media/file837.png" style="vertical-align:middle" title="n = 4"/></span><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml"> and we show how the probability of finding exactly one marked element changes as we vary the number of Grover iterations </span><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml">, from </span><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.519.2" xmlns="http://www.w3.org/1999/xhtml">In this case, </span><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \lfloor(\pi\slash 4)\sqrt{2^{n}}\rfloor \right." class="math inline" src="../media/file838.png" style="vertical-align:middle" title="\left. \lfloor(\pi\slash 4)\sqrt{2^{n}}\rfloor \right."/></span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml"> and, as you can see, the success probability with </span><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = 3" class="math inline" src="../media/file839.png" style="vertical-align:middle" title="m = 3"/></span><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml"> is close to </span><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.527.2" xmlns="http://www.w3.org/1999/xhtml">However, for </span><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = 5" class="math inline" src="../media/file840.png" style="vertical-align:middle" title="m = 5"/></span><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml"> the probability has decreased dramatically, and for </span><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = 6" class="math inline" src="../media/file841.png" style="vertical-align:middle" title="m = 6"/></span><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml"> it is nearly </span><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.3: Probability of finding one marked element among 16 when using Grover’s algorithm with a number of iterations that varies from 0 to 20" src="../media/file842.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.3"><strong><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.3</span></strong><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="content"><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml">Probability of finding one marked element among 16 when using Grover’s algorithm with a number of iterations that varies from </span><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">This shows that we </span><span id="dx1-110006"/><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml">need to be very careful when selecting the number of iterations </span><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"> in Grover’s algorithm. </span><span class="koboSpan" id="kobo.544.2" xmlns="http://www.w3.org/1999/xhtml">For the case in which there is only one marked element, we have obtained a good choice for </span><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.546.2" xmlns="http://www.w3.org/1999/xhtml">But what if there is more than one marked element? </span><span class="koboSpan" id="kobo.546.3" xmlns="http://www.w3.org/1999/xhtml">It turns out — check the lecture notes by John Watrous </span><span class="cite"><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xwatrous2005quantum"><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml">95</span></a><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml"> — that if there are </span><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml"> marked elements, we can repeat our previous reasoning and show that a good value for </span><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml"> is</span></p>
<p><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = \left\lfloor {\frac{\pi}{4}\sqrt{\frac{2^{n}}{k}}} \right\rfloor," class="math display" src="../media/file843.png" style="vertical-align:middle" title="m = \left\lfloor {\frac{\pi}{4}\sqrt{\frac{2^{n}}{k}}} \right\rfloor,"/></span></p>
<p><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml">provided that </span><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml"> is small compared to </span><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.560.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml"> is not small compared to </span><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">, don’t worry; then the probability of finding a marked element just by choosing at random is </span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. k\slash 2^{n} \right." class="math inline" src="../media/file844.png" style="vertical-align:middle" title="\left. k\slash 2^{n} \right."/></span><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">, which will be sizeable, so you wouldn’t even need a quantum computer in the first place.</span><span id="dx1-110007"/></p>
<p><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">This solves our problem if we know how many marked elements there are. </span><span class="koboSpan" id="kobo.567.2" xmlns="http://www.w3.org/1999/xhtml">But, in the most general case, we may lack that information. </span><span class="koboSpan" id="kobo.567.3" xmlns="http://www.w3.org/1999/xhtml">In that circumstance, we can apply the results of a very useful paper by Boyer, Brassard, Høyer, and Tapp </span><span class="cite"><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xboyer1998tight"><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">20</span></a><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.571.2" xmlns="http://www.w3.org/1999/xhtml">They showed that by choosing </span><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml"> at random in a range that increases dynamically, we can still be guaranteed that will find a marked element with high probability while keeping the average number of iterations as </span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O(\sqrt{2^{n}})" class="math inline" src="../media/file845.png" style="vertical-align:middle" title="O(\sqrt{2^{n}})"/></span><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml"> (see </span><em><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch026.xhtml#x1-233000C"><em><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">C</span></em></a><em><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">, Computational Complexity</span></em><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">, for a refresher on asymptotic notation).</span></p>
<p><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">In fact, they proved that the probability of finding a </span><span id="dx1-110008"/><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">marked element with their method is at least </span><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash 4 \right." class="math inline" src="../media/file846.png" style="vertical-align:middle" title="\left. 1\slash 4 \right."/></span><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.583.2" xmlns="http://www.w3.org/1999/xhtml">This might seem unimpressive, but we can easily see how that is more than enough. </span><span class="koboSpan" id="kobo.583.3" xmlns="http://www.w3.org/1999/xhtml">Indeed, the probability of not finding a marked element is then no more than </span><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 3\slash 4 \right." class="math inline" src="../media/file847.png" style="vertical-align:middle" title="\left. 3\slash 4 \right."/></span><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.585.2" xmlns="http://www.w3.org/1999/xhtml">So, suppose that we repeat the process </span><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1000" class="math inline" src="../media/file790.png" style="vertical-align:middle" title="1000"/></span><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"> times. </span><span class="koboSpan" id="kobo.587.2" xmlns="http://www.w3.org/1999/xhtml">Then, the probability of failure is at most </span><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. (3\slash 4) \right.^{1000}" class="math inline" src="../media/file848.png" style="vertical-align:middle" title="\left. (3\slash 4) \right.^{1000}"/></span><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml">, which is extremely low. </span><span class="koboSpan" id="kobo.589.2" xmlns="http://www.w3.org/1999/xhtml">In fact, the chance of a meteorite hitting your quantum computer while running your circuits is much, much bigger than that!</span></p>
<p><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">So far in this section, we have covered all that we need to know in order to apply Grover’s algorithm in search problems. </span><span class="koboSpan" id="kobo.590.2" xmlns="http://www.w3.org/1999/xhtml">However, our main goal is solving optimization problems. </span><span class="koboSpan" id="kobo.590.3" xmlns="http://www.w3.org/1999/xhtml">We explore the connection between both tasks in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.1.4" id="finding-minima-with-grovers-algorithm">
<h2 class="subsectionHead" data-number="13.1.4"><span class="titlemark"><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">6.1.4 </span></span> <span id="x1-1110006.1.4"><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">Finding minima with Grover’s algorithm</span></span></h2>
<p><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">Optimization problems are </span><span id="dx1-111001"/><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">obviously related to search problems. </span><span class="koboSpan" id="kobo.594.2" xmlns="http://www.w3.org/1999/xhtml">In fact, when solving an optimization problem, we are trying to find a value with a special property: it should be a minimum or maximum among all the possible values. </span><span class="koboSpan" id="kobo.594.3" xmlns="http://www.w3.org/1999/xhtml">This connection was exploited by Dürr and Høyer in a 1996 paper </span><span class="cite"><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xdurr1996quantum"><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">33</span></a><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml"> in which they introduced a quantum algorithm, based on Grover’s search, to find minima of functions. </span><span class="koboSpan" id="kobo.598.2" xmlns="http://www.w3.org/1999/xhtml">The main idea behind the algorithm is quite straightforward. </span><span class="koboSpan" id="kobo.598.3" xmlns="http://www.w3.org/1999/xhtml">Suppose we want to find a minimum of a function </span><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml"> that is computed over binary strings of length </span><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.602.2" xmlns="http://www.w3.org/1999/xhtml">We select one such string </span><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml"> at random and we compute </span><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x_{0})" class="math inline" src="../media/file850.png" style="vertical-align:middle" title="g(x_{0})"/></span><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.606.2" xmlns="http://www.w3.org/1999/xhtml">Now we apply Grover’s algorithm with an oracle that, on input </span><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml">, returns </span><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(x_{0})" class="math inline" src="../media/file851.png" style="vertical-align:middle" title="g(x) &lt; g(x_{0})"/></span><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.614.2" xmlns="http://www.w3.org/1999/xhtml">If the element that we measure after applying Grover’s search, call it </span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml">, really achieves a value that is lower than </span><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x_{0})" class="math inline" src="../media/file850.png" style="vertical-align:middle" title="g(x_{0})"/></span><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">, we replace </span><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml"> with it and repeat the process but now with an oracle that checks the condition </span><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(x_{1})" class="math inline" src="../media/file852.png" style="vertical-align:middle" title="g(x) &lt; g(x_{1})"/></span><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.622.2" xmlns="http://www.w3.org/1999/xhtml">If not, we keep using </span><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.624.2" xmlns="http://www.w3.org/1999/xhtml">We repeat this process several times and we return the element with the lowest value among the ones that we have considered.</span></p>
<p><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">There are a </span><span id="dx1-111002"/><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">couple of details that we need to flesh out here. </span><span class="koboSpan" id="kobo.626.2" xmlns="http://www.w3.org/1999/xhtml">The first one is how to construct the oracles. </span><span class="koboSpan" id="kobo.626.3" xmlns="http://www.w3.org/1999/xhtml">In general, of course, it will depend on the function </span><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.628.2" xmlns="http://www.w3.org/1999/xhtml">For that reason, in the next section we will focus on circuits that we can use with the Dürr-Høyer algorithm to solve QUBO and HOBO problems.</span></p>
<p><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, we should take care of the number of iterations that we will use in each application of Grover’s algorithm and, also, of the number of times that we need to repeat the procedure for selecting a new element and constructing a new oracle. </span><span class="koboSpan" id="kobo.629.2" xmlns="http://www.w3.org/1999/xhtml">The original paper by Dürr and Høyer gives all the details, but let’s just mention that it uses the method proposed by Boyer, Brassard, Høyer, and Tapp </span><span class="cite"><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xboyer1998tight"><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml">20</span></a><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml"> that we explained in the previous subsection, and it guarantees that a minimum will be found with a probability of at least </span><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash 2 \right." class="math inline" src="../media/file136.png" style="vertical-align:middle" title="\left. 1\slash 2 \right."/></span><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml"> with a number of calls to the oracle that is </span><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O(\sqrt{2^{n}})" class="math inline" src="../media/file845.png" style="vertical-align:middle" title="O(\sqrt{2^{n}})"/></span><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">With this, we have now covered all the concepts that we need in order to apply this search method to solve QUBO and HOBO problems. </span><span class="koboSpan" id="kobo.638.2" xmlns="http://www.w3.org/1999/xhtml">We will devote the next section to explaining how to construct quantum oracles for these kinds of problems.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="13.2" id="quantum-oracles-for-combinatorial-optimization">
<h1 class="sectionHead" data-number="13.2"><span class="titlemark"><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml">6.2 </span></span> <span id="x1-1120006.2"><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml">Quantum oracles for combinatorial optimization</span></span></h1>
<p><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml">As we have seen, the Dürr-Høyer algorithm can be used to find the minimum of a function </span><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml"> with high </span><span id="dx1-112001"/><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml">probability and with a quadratic speedup over brute force search. </span><span class="koboSpan" id="kobo.644.2" xmlns="http://www.w3.org/1999/xhtml">However, in order to use it, we need a quantum oracle that, given binary strings </span><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">, checks whether </span><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">In our case, we are interested in functions </span><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml"> that can appear in QUBO and HOBO problems. </span><span class="koboSpan" id="kobo.653.2" xmlns="http://www.w3.org/1999/xhtml">This means that </span><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml"> will be a polynomial with real coefficients and binary variables, and we could implement the quantum oracle with a straightforward approach: design a classical circuit for it using AND, OR, and NOT gates, and then simulate the classical gates with the Toffoli quantum gate, as we showed in </span><em><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-370001.5.2"><em><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">1.5.2</span></em></a><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">However, in 2021, Gilliam, Woerner, and Gonciulea, introduced an improved way of implementing quantum oracles for QUBO and HOBO problems in a paper titled </span><em><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">Grover adaptive search for constrained polynomial binary</span></em> <em><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml">optimization</span></em> <span class="cite"><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xgilliam2021grover"><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">45</span></a><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we will study in detail the techniques that they proposed and how to use them to implement our </span><span id="dx1-112002"/><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">quantum oracles. </span><span class="koboSpan" id="kobo.667.2" xmlns="http://www.w3.org/1999/xhtml">We will start by considering the case in which all the coefficients of the polynomial are integer numbers and, then, we will extend our study to the most general case when the coefficients are real numbers. </span><span class="koboSpan" id="kobo.667.3" xmlns="http://www.w3.org/1999/xhtml">But, before we get to that, we need to take a brief detour to talk about one of the most important subroutines in all of quantum computing: the </span><strong><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">quantum Fourier</span></strong> <strong><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml">transform</span></strong><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<section class="level3 subsectionHead" data-number="13.2.1" id="the-quantum-fourier-transform">
<h2 class="subsectionHead" data-number="13.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">6.2.1 </span></span> <span id="x1-1130006.2.1"><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml">The quantum Fourier transform</span></span></h2>
<p><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-113001"/><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">quantum Fourier transform (usually abbreviated as </span><strong><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">QFT</span></strong><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml">) is, beyond any doubt, one of the most useful tools in quantum computing. </span><span class="koboSpan" id="kobo.676.2" xmlns="http://www.w3.org/1999/xhtml">It is an essential part of Shor’s algorithm for integer factorization </span><span class="cite"><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xshor99polynomial"><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml">87</span></a><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"> and it is behind the speedups of other famous quantum algorithms such as HHL </span><span class="cite"><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xharrow2009quantum"><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml">49</span></a><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml">We will use the QFT to help us implement the arithmetical operations that we need to compute the values of the polynomial function of our QUBO and HOBO problems. </span><span class="koboSpan" id="kobo.685.2" xmlns="http://www.w3.org/1999/xhtml">We could, for instance, implement these operations in a basis representation. </span><span class="koboSpan" id="kobo.685.3" xmlns="http://www.w3.org/1999/xhtml">As an example, we might design a unitary transformation taking </span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| y \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file854.png" style="vertical-align:middle" title="\left| x \right\rangle\left| y \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| y \right\rangle\left| {x + y} \right\rangle" class="math inline" src="../media/file855.png" style="vertical-align:middle" title="\left| x \right\rangle\left| y \right\rangle\left| {x + y} \right\rangle"/></span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml"> are binary numbers and </span><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x + y" class="math inline" src="../media/file856.png" style="vertical-align:middle" title="x + y"/></span><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml"> is their addition. </span><span class="koboSpan" id="kobo.695.2" xmlns="http://www.w3.org/1999/xhtml">However, this could involve a big number of one- and two-qubit gates.</span></p>
<p><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml">Instead, we will use the approach proposed by Gilliam, Woerner, and Gonciulea in </span><span class="cite"><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xgilliam2021grover"><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml">45</span></a><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml"> and we will compute the arithmetical operations using the state amplitudes. </span><span class="koboSpan" id="kobo.700.2" xmlns="http://www.w3.org/1999/xhtml">We will explain in detail how to do that in the next subsections. </span><span class="koboSpan" id="kobo.700.3" xmlns="http://www.w3.org/1999/xhtml">But, before that, we will study how to use the QFT to recover information from the amplitudes of a quantum state.</span></p>
<p><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">The QFT on </span><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml"> qubits is defined as the unitary transformation that takes the basis states </span><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| j \right\rangle" class="math inline" src="../media/file257.png" style="vertical-align:middle" title="\left| j \right\rangle"/></span><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml"> to</span></p>
<p><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle," class="math display" src="../media/file857.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i" class="math inline" src="../media/file49.png" style="vertical-align:middle" title="i"/></span><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml"> is the imaginary unit. </span><span class="koboSpan" id="kobo.709.2" xmlns="http://www.w3.org/1999/xhtml">Its action is extended to the rest of the states by linearity.</span></p>
<p><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">We will not study the properties of the QFT in detail. </span><span class="koboSpan" id="kobo.710.2" xmlns="http://www.w3.org/1999/xhtml">For that, you can refer to </span><em><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">Dancing with Qubits</span></em><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">, by Robert Sutor </span><span class="cite"><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsutor2019dancing"><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">92</span></a><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.716.2" xmlns="http://www.w3.org/1999/xhtml">However, we need to know that the QFT can be implemented with a number of one- and two-qubit gates that is quadratic in </span><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.718.2" xmlns="http://www.w3.org/1999/xhtml">This is an exponential speedup over the best algorithm that we have for the </span><span id="dx1-113002"/><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">analogous classical operation (the </span><strong><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml">discrete Fourier transform</span></strong><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
<p><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml">For example, the </span><span id="dx1-113003"/><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml">circuit for the QFT on three qubits is shown in </span><em><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.4"><em><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml">6.4</span></em></a><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.726.2" xmlns="http://www.w3.org/1999/xhtml">In it, the rightmost gate, which acts on the top and bottom qubits, is the SWAP gate. </span><span class="koboSpan" id="kobo.726.3" xmlns="http://www.w3.org/1999/xhtml">As we mentioned in </span><em><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-300001.4.3"><em><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">1.4.3</span></em></a><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">, this gate swaps the states of two qubits and it can be implemented by means of CNOT gates. </span><span class="koboSpan" id="kobo.729.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, this QFT circuit </span><span id="dx1-113004"/><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">uses the </span><strong><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">phase gate</span></strong><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">, denoted by </span><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P(\theta)" class="math inline" src="../media/file858.png" style="vertical-align:middle" title="P(\theta)"/></span><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.734.2" xmlns="http://www.w3.org/1999/xhtml">This is a parametrized gate that depends on an angle </span><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta" class="math inline" src="../media/file89.png" style="vertical-align:middle" title="\theta"/></span><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml"> and whose coordinate matrix is</span></p>
<p><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; e^{i\theta} \\ \end{pmatrix}." class="math display" src="../media/file859.png" style="vertical-align:middle" title="\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; e^{i\theta} \\ \end{pmatrix}."/></span></p>
<figure>
<span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.4: Circuit for the quantum Fourier transform on 3 qubits" src="../media/file860.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.4"><strong><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.4</span></strong><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for the quantum Fourier transform on </span><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml"> qubits</span></figcaption>
</figure>
<div class="tcolorbox important" id="tcolobox-121">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">The phase gate is very similar to the </span><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml"> gate that we introduced in </span><em><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-250001.3.4"><em><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">1.3.4</span></em></a><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.750.2" xmlns="http://www.w3.org/1999/xhtml">In fact, when applied on its own to a qubit, </span><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P(\theta)" class="math inline" src="../media/file858.png" style="vertical-align:middle" title="P(\theta)"/></span><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml"> is equivalent to </span><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}(\theta)" class="math inline" src="../media/file861.png" style="vertical-align:middle" title="R_{Z}(\theta)"/></span><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml"> up to an unimportant global phase. </span><span class="koboSpan" id="kobo.754.2" xmlns="http://www.w3.org/1999/xhtml">However, in the QFT circuit, we are using a controlled version of the phase gate and the global phase becomes a relative one, which is not unimportant at all!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">As we have seen, the QFT acts by </span><span id="dx1-113007"/><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">introducing phases of the form </span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{2\pi ijk \slash 2^{m}}" class="math inline" src="../media/file862.png" style="vertical-align:middle" title="e^{2\pi ijk \slash 2^{m}}"/></span><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml"> when it is applied on basis states </span><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| j \right\rangle" class="math inline" src="../media/file257.png" style="vertical-align:middle" title="\left| j \right\rangle"/></span><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.760.2" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, for the purposes of our computations, we are more interested in recovering the values </span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml"> from those phases. </span><span class="koboSpan" id="kobo.762.2" xmlns="http://www.w3.org/1999/xhtml">For that, we will need the </span><strong><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml">inverse quantum Fourier transform</span></strong><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">, usually denoted QFT</span><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{}^{\dagger}" class="math inline" src="../media/file863.png" style="vertical-align:middle" title="{}^{\dagger}"/></span><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.766.2" xmlns="http://www.w3.org/1999/xhtml">Of course, its action is the </span><span id="dx1-113008"/><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml">inverse of that of the QFT, meaning that it takes a state such as</span></p>
<p><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle" class="math display" src="../media/file864.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">to the basis state </span><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| j \right\rangle" class="math inline" src="../media/file257.png" style="vertical-align:middle" title="\left| j \right\rangle"/></span><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">The circuit for the inverse QFT can be obtained from that of the QFT by reading the circuit backwards and using the inverse of each gate we find. </span><span class="koboSpan" id="kobo.772.2" xmlns="http://www.w3.org/1999/xhtml">For example, the circuit for the inverse QFT on </span><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml"> qubits is shown in </span><em><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.5"><em><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">6.5</span></em></a><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.777.2" xmlns="http://www.w3.org/1999/xhtml">Notice that the inverse of </span><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P(\theta)" class="math inline" src="../media/file858.png" style="vertical-align:middle" title="P(\theta)"/></span><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P( - \theta)" class="math inline" src="../media/file865.png" style="vertical-align:middle" title="P( - \theta)"/></span><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">, while the </span><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml"> and SWAP gates are their own inverses.</span></p>
<figure>
<span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.5: Circuit for the inverse quantum Fourier transform on 3 qubits" src="../media/file866.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.5"><strong><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.5</span></strong><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for the inverse quantum Fourier transform on </span><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml"> qubits</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml">When designing a quantum oracle to minimize a function </span><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml">, our goal will be to perform the computation in such a way that the </span><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml"> values appear as exponents in the amplitudes of our states so that we can later recover them by means of the inverse QFT. </span><span class="koboSpan" id="kobo.794.2" xmlns="http://www.w3.org/1999/xhtml">This may sound like a difficult endeavour, but as we will show in the following subsections, we already have all the tools that we need in order to succeed. </span><span class="koboSpan" id="kobo.794.3" xmlns="http://www.w3.org/1999/xhtml">We will start by showing how to encode integer values in exactly the way that we require.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.2.2" id="encoding-and-adding-integer-numbers">
<h2 class="subsectionHead" data-number="13.2.2"><span class="titlemark"><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml">6.2.2 </span></span> <span id="x1-1140006.2.2"><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml">Encoding and adding integer numbers</span></span></h2>
<p><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">As will become </span><span id="dx1-114001"/><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">apparent soon in this section, the most convenient way of working with integer numbers in the context of GAS oracles is using their </span><strong><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">two’s complement</span></strong><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml"> representation. </span><span class="koboSpan" id="kobo.800.2" xmlns="http://www.w3.org/1999/xhtml">In it, we can encode numbers from </span><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2^{m - 1}" class="math inline" src="../media/file868.png" style="vertical-align:middle" title="- 2^{m - 1}"/></span><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{m - 1} - 1" class="math inline" src="../media/file869.png" style="vertical-align:middle" title="2^{m - 1} - 1"/></span><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml"> by using </span><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">-bit strings. </span><span class="koboSpan" id="kobo.806.2" xmlns="http://www.w3.org/1999/xhtml">Positive numbers are represented in the usual way for binary numbers, but a negative number </span><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml"> is represented by </span><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{m} - x" class="math inline" src="../media/file870.png" style="vertical-align:middle" title="2^{m} - x"/></span><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml">For instance, if </span><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m = 4" class="math inline" src="../media/file871.png" style="vertical-align:middle" title="m = 4"/></span><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml">, we represent </span><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml"> by </span><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0011" class="math inline" src="../media/file872.png" style="vertical-align:middle" title="0011"/></span><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml"> by </span><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1011" class="math inline" src="../media/file606.png" style="vertical-align:middle" title="1011"/></span><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml"> (which is the binary representation of </span><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="11 = 16 - 5" class="math inline" src="../media/file873.png" style="vertical-align:middle" title="11 = 16 - 5"/></span><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.823.2" xmlns="http://www.w3.org/1999/xhtml">One advantage of this representation is that the most significant bit indicates the sign of the encoded number: positive numbers always start with </span><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml">, while negative numbers start with </span><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml">Another perk of two’s complement representation is that, with it, we can compute additions involving both positive and negative numbers by simply performing regular binary addition and discarding the last carry-out, if it exists. </span><span class="koboSpan" id="kobo.828.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if we add </span><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0011" class="math inline" src="../media/file872.png" style="vertical-align:middle" title="0011"/></span><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml"> (which is </span><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1011" class="math inline" src="../media/file606.png" style="vertical-align:middle" title="1011"/></span><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml"> (which is </span><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml">), we obtain </span><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1110" class="math inline" src="../media/file806.png" style="vertical-align:middle" title="1110"/></span><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml"> which is, indeed, the encoding of </span><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2" class="math inline" src="../media/file333.png" style="vertical-align:middle" title="- 2"/></span><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml"> (because </span><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="14 = 16 - 2" class="math inline" src="../media/file874.png" style="vertical-align:middle" title="14 = 16 - 2"/></span><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.842.2" xmlns="http://www.w3.org/1999/xhtml">Similarly, if we add </span><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0110" class="math inline" src="../media/file875.png" style="vertical-align:middle" title="0110"/></span><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml"> (which is </span><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1100" class="math inline" src="../media/file876.png" style="vertical-align:middle" title="1100"/></span><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml"> (which is </span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 4" class="math inline" src="../media/file330.png" style="vertical-align:middle" title="- 4"/></span><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml">) we obtain </span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0010" class="math inline" src="../media/file877.png" style="vertical-align:middle" title="0010"/></span><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml"> (after discarding the last carry-out), which is </span><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml">, as expected. </span><span class="koboSpan" id="kobo.854.2" xmlns="http://www.w3.org/1999/xhtml">These facts about two’s complement arithmetic will be very helpful in implementing our quantum oracle, as we show next.</span></p>
<div class="tcolorbox questionx" id="tcolobox-122">
<span id="x1-114003x6.2.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.3</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml">Using two’s complement with 5 qubits, represent </span><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 7" class="math inline" src="../media/file470.png" style="vertical-align:middle" title="- 7"/></span><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml"> and perform their addition.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml">As we have mentioned in the previous subsection, when computing </span><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml"> with an oracle, we are interested in obtaining the state</span></p>
<p><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ig(x)k}{2^{m}}}\left| k \right\rangle" class="math display" src="../media/file878.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ig(x)k}{2^{m}}}\left| k \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml">so that we can then apply the inverse QFT to get </span><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {g(x)} \right\rangle" class="math inline" src="../media/file879.png" style="vertical-align:middle" title="\left| {g(x)} \right\rangle"/></span><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.867.2" xmlns="http://www.w3.org/1999/xhtml">We will achieve this step by step.</span></p>
<p><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml">Notice that </span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml"> is always a sum of products of integer values. </span><span class="koboSpan" id="kobo.870.2" xmlns="http://www.w3.org/1999/xhtml">So, let’s first deal with integer addition, and leave </span><span id="dx1-114004"/><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">multiplication for the next subsection.</span></p>
<p><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml">Following the notation of </span><span class="cite"><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xruiz2017quantum"><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">82</span></a><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml">, we will call the state</span></p>
<p><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle" class="math display" src="../media/file864.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}\left| k \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">the </span><strong><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml">phase encoding</span></strong><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.882.2" xmlns="http://www.w3.org/1999/xhtml">Then, for our purposes, it is enough to be able to know how to prepare the </span><span id="dx1-114005"/><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml">phase encoding of </span><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml"> and to know how to add a given integer </span><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml"> to the phase encoding of any other integer. </span><span class="koboSpan" id="kobo.887.2" xmlns="http://www.w3.org/1999/xhtml">In that way, we can start from </span><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml"> and add all the terms in the polynomial expression of </span><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml"> one by one.</span></p>
<p><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">Preparing the phase encoding of </span><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml"> could not be easier. </span><span class="koboSpan" id="kobo.894.2" xmlns="http://www.w3.org/1999/xhtml">We just need to apply the Hadamard gate to each and every qubit that we are using to represent the integer values. </span><span class="koboSpan" id="kobo.894.3" xmlns="http://www.w3.org/1999/xhtml">In this way, we will obtain the state</span></p>
<p><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}\left| k \right\rangle = \frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi i0k}{2^{m}}}\left| k \right\rangle," class="math display" src="../media/file880.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}\left| k \right\rangle = \frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi i0k}{2^{m}}}\left| k \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">which is, indeed, the phase encoding of </span><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">Suppose now that we have a state that phase-encodes </span><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml"> and we want to add </span><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml"> to it. </span><span class="koboSpan" id="kobo.903.2" xmlns="http://www.w3.org/1999/xhtml">We first assume that </span><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml"> is non-negative and, later, we will deal with negative numbers. </span><span class="koboSpan" id="kobo.905.2" xmlns="http://www.w3.org/1999/xhtml">To add </span><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml"> in phase encoding, we just need to apply the gates shown in </span><em><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.6"><em><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">6.6</span></em></a><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.6: Circuit for adding l to a state in phase encoding when we have m qubits" src="../media/file881.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.6"><strong><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.6</span></strong><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for adding </span><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml"> to a state in phase encoding when we have </span><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml"> qubits</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml">Indeed, when we </span><span id="dx1-114008"/><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">apply those gates to a basis state </span><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| k \right\rangle" class="math inline" src="../media/file882.png" style="vertical-align:middle" title="\left| k \right\rangle"/></span><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">, we obtain </span><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{2\pi ikl \slash 2^{m}}\left| k \right\rangle" class="math inline" src="../media/file883.png" style="vertical-align:middle" title="e^{2\pi ikl \slash 2^{m}}\left| k \right\rangle"/></span><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.924.2" xmlns="http://www.w3.org/1999/xhtml">To prove it, just notice how, if the </span><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h" class="math inline" src="../media/file519.png" style="vertical-align:middle" title="h"/></span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml">-th qubit of </span><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| k \right\rangle" class="math inline" src="../media/file882.png" style="vertical-align:middle" title="\left| k \right\rangle"/></span><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">, the circuit of </span><em><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.6"><em><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml">6.6</span></em></a><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml"> adds a phase of value </span><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{\pi il \slash 2^{h}} = e^{2^{m - h}\pi il \slash 2^{m}}" class="math inline" src="../media/file884.png" style="vertical-align:middle" title="e^{\pi il \slash 2^{h}} = e^{2^{m - h}\pi il \slash 2^{m}}"/></span><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml"> (we start counting qubits from </span><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml">) and no phase otherwise. </span><span class="koboSpan" id="kobo.937.2" xmlns="http://www.w3.org/1999/xhtml">When we sum all these phases over the qubits of </span><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| k \right\rangle" class="math inline" src="../media/file882.png" style="vertical-align:middle" title="\left| k \right\rangle"/></span><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml"> that have value </span><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">, we obtain exactly </span><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{2\pi ilk \slash 2^{m}}" class="math inline" src="../media/file885.png" style="vertical-align:middle" title="e^{2\pi ilk \slash 2^{m}}"/></span><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.943.2" xmlns="http://www.w3.org/1999/xhtml">Thus, by linearity, when we apply the circuit to the phase encoding of </span><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml">, we get</span></p>
<p><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}e^{}" class="math display" src="../media/file886.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2^{m}}}\sum\limits_{k = 0}^{2^{m} - 1}e^{\frac{2\pi ijk}{2^{m}}}e^{}"/></span></p>
<p><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml">2</span><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi ilk2^{m}\left| k \right\rangle = \frac{1}{\sqrt{2^{m}}}{\sum}_{k = 0}^{2^{m} - 1}e^{\frac{2\pi i(j + l)k}{2^{m}}}\left| k \right\rangle," class="math inline" src="../media/file887.png" style="vertical-align:middle" title="\pi ilk2^{m}\left| k \right\rangle = \frac{1}{\sqrt{2^{m}}}{\sum}_{k = 0}^{2^{m} - 1}e^{\frac{2\pi i(j + l)k}{2^{m}}}\left| k \right\rangle,"/></span><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="whichisthephaseencodingof" class="math inline" src="../media/file888.png" style="vertical-align:middle" title="whichisthephaseencodingof"/></span><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">j+l</span><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=",asdesired." class="math inline" src="../media/file889.png" style="vertical-align:middle" title=",asdesired."/></span></p>
<p><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml">So, this works beautifully for non-negative numbers. </span><span class="koboSpan" id="kobo.952.2" xmlns="http://www.w3.org/1999/xhtml">But, what about negative ones? </span><span class="koboSpan" id="kobo.952.3" xmlns="http://www.w3.org/1999/xhtml">It turns out that, if </span><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml"> is negative, we can again use the very circuit in </span><em><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.6"><em><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml">6.6</span></em></a><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml"> — no further adjustments required. </span><span class="koboSpan" id="kobo.957.2" xmlns="http://www.w3.org/1999/xhtml">The key observation is that, for any integer </span><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0 \leq h \leq m - 1" class="math inline" src="../media/file890.png" style="vertical-align:middle" title="0 \leq h \leq m - 1"/></span><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that</span></p>
<p><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{}" class="math display" src="../media/file891.png" style="vertical-align:middle" title="e^{}"/></span></p>
<p><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi i(2^{m} + l)2^{h} = e^{}" class="math inline" src="../media/file892.png" style="vertical-align:middle" title="\pi i(2^{m} + l)2^{h} = e^{}"/></span></p>
<p><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi il2^{h}e^{\frac{\pi i2^{m}}{2^{h}}} = e^{}" class="math inline" src="../media/file893.png" style="vertical-align:middle" title="\pi il2^{h}e^{\frac{\pi i2^{m}}{2^{h}}} = e^{}"/></span></p>
<p><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi il2^{h}e^{\pi i2^{m - h}} = e^{}" class="math inline" src="../media/file894.png" style="vertical-align:middle" title="\pi il2^{h}e^{\pi i2^{m - h}} = e^{}"/></span></p>
<p><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi il2^{h}," class="math inline" src="../media/file895.png" style="vertical-align:middle" title="\pi il2^{h},"/></span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="because" class="math inline" src="../media/file896.png" style="vertical-align:middle" title="because"/></span><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">m-h¿0</span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=",making" class="math inline" src="../media/file897.png" style="vertical-align:middle" title=",making"/></span><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml">2ˆm-h</span><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="evenandimplying" class="math inline" src="../media/file898.png" style="vertical-align:middle" title="evenandimplying"/></span><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml">eˆ</span><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\pi i2^{m - h} = 1." class="math inline" src="../media/file899.png" style="vertical-align:middle" title="\pi i2^{m - h} = 1."/></span></p>
<p><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">This means that if we plug in </span><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{m} + l" class="math inline" src="../media/file900.png" style="vertical-align:middle" title="2^{m} + l"/></span><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml"> in the gates of </span><em><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.6"><em><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml">6.6</span></em></a><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml">, we obtain exactly the same circuit. </span><span class="koboSpan" id="kobo.979.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we can work with the two’s complement representation of </span><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml"> instead of </span><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml"> and the results for the addition that we proved previously for non-negative integers will also hold for negative integers. </span><span class="koboSpan" id="kobo.983.2" xmlns="http://www.w3.org/1999/xhtml">The only concern could be that, when adding in two’s complement a positive and a negative number, we get a carry-out (like, for instance, when we added </span><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 4" class="math inline" src="../media/file330.png" style="vertical-align:middle" title="- 4"/></span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"> in a previous example). </span><span class="koboSpan" id="kobo.987.2" xmlns="http://www.w3.org/1999/xhtml">However, in that case, the carry-out will give us an even power of two and, again, the corresponding phase will be </span><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">, leaving the result unchanged. </span><span class="koboSpan" id="kobo.989.2" xmlns="http://www.w3.org/1999/xhtml">Effectively, we are performing arithmetic modulo </span><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{m}" class="math inline" src="../media/file901.png" style="vertical-align:middle" title="2^{m}"/></span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">, so we are safe. </span><span class="koboSpan" id="kobo.991.2" xmlns="http://www.w3.org/1999/xhtml">Notice, nevertheless, that, if we add two positive or two negative integers and we get a carry-out, then we will get a wrong result — in this case, modular arithmetic turns against us!</span></p>
<div class="tcolorbox important" id="tcolobox-123">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">You always need to use a number of qubits that is large enough to represent, in two’s complement, any integer number that may arise from the computations. </span><span class="koboSpan" id="kobo.993.2" xmlns="http://www.w3.org/1999/xhtml">If you are working with a polynomial </span><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml">, you can simply add up the absolute value of all the coefficients in </span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"> to obtain a constant </span><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="K" class="math inline" src="../media/file902.png" style="vertical-align:middle" title="K"/></span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.999.2" xmlns="http://www.w3.org/1999/xhtml">Then, you can choose any </span><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2^{m - 1} \leq - K \leq K \leq 2^{m - 1} - 1" class="math inline" src="../media/file903.png" style="vertical-align:middle" title="- 2^{m - 1} \leq - K \leq K \leq 2^{m - 1} - 1"/></span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1003.2" xmlns="http://www.w3.org/1999/xhtml">If you want to be even more precise, you can select </span><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="K" class="math inline" src="../media/file902.png" style="vertical-align:middle" title="K"/></span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml"> as the maximum between the sum of all positive coefficients and the sum of the absolute value of all the negative coefficients.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">As an example, in </span><em><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.7"><em><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml">6.7</span></em></a><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml">, we present a </span><span id="dx1-114009"/><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">circuit that prepares the phase representation of </span><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">, adds </span><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml"> to it, and then adds </span><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml"> (or, equivalently, subtracts </span><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1018.2" xmlns="http://www.w3.org/1999/xhtml">Notice that some of the gates could be simplified. </span><span class="koboSpan" id="kobo.1018.3" xmlns="http://www.w3.org/1999/xhtml">For instance, </span><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P(3\pi)" class="math inline" src="../media/file904.png" style="vertical-align:middle" title="P(3\pi)"/></span><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml"> is just </span><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P(\pi)" class="math inline" src="../media/file905.png" style="vertical-align:middle" title="P(\pi)"/></span><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1022.2" xmlns="http://www.w3.org/1999/xhtml">We could also merge consecutive </span><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P" class="math inline" src="../media/file1.png" style="vertical-align:middle" title="P"/></span><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml"> gates into single gates by adding their angles together (for instance, </span><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P( - 5\frac{\pi}{2})P(3\frac{\pi}{2}) = P( - 2\frac{\pi}{2}) = P(\pi)" class="math inline" src="../media/file906.png" style="vertical-align:middle" title="P( - 5\frac{\pi}{2})P(3\frac{\pi}{2}) = P( - 2\frac{\pi}{2}) = P(\pi)"/></span><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1026.2" xmlns="http://www.w3.org/1999/xhtml">For the sake of clarity, throughout this section, we will keep the gates in their original form, without any simplification.</span></p>
<figure>
<span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.7: Circuit for preparing the phase representation of 0, adding 3 to it and then subtracting 5" src="../media/file907.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.7"><strong><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.7</span></strong><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for preparing the phase representation of </span><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml">, adding </span><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml"> to it and then subtracting </span><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span></figcaption>
</figure>
<div class="tcolorbox questionx" id="tcolobox-124">
<span id="x1-114013x6.2.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.4</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">Derive a circuit that prepares the phase representation of </span><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml">, adds </span><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml"> to it and then subtracts </span><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1043.2" xmlns="http://www.w3.org/1999/xhtml">Use </span><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml"> qubits.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml">We now have the first </span><span id="dx1-114014"/><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml">ingredient that we need in order to compute the </span><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml"> polynomial: adding integers in phase encoding. </span><span class="koboSpan" id="kobo.1049.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will learn how to deal with the product of binary variables.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.2.3" id="computing-the-whole-polynomial">
<h2 class="subsectionHead" data-number="13.2.3"><span class="titlemark"><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml">6.2.3 </span></span> <span id="x1-1150006.2.3"><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">Computing the whole polynomial</span></span></h2>
<p><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">You may be </span><span id="dx1-115001"/><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml">tempted to think that performing the multiplications that we need to compute our polynomial </span><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml"> will be much harder than performing the additions. </span><span class="koboSpan" id="kobo.1055.2" xmlns="http://www.w3.org/1999/xhtml">But not quite! </span><span class="koboSpan" id="kobo.1055.3" xmlns="http://www.w3.org/1999/xhtml">Let’s look into this.</span></p>
<p><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml">All the variables that we are considering are binary, and this means that, when we perform a multiplication such as </span><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}x_{1}" class="math inline" src="../media/file908.png" style="vertical-align:middle" title="x_{0}x_{1}"/></span><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml">, we always obtain either </span><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml"> as a result. </span><span class="koboSpan" id="kobo.1062.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if </span><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"> is, for example, </span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0}x_{1} - 2x_{1}x_{2} + 1" class="math inline" src="../media/file909.png" style="vertical-align:middle" title="3x_{0}x_{1} - 2x_{1}x_{2} + 1"/></span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml">, we will need to add </span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml"> always (because it is the independent term and, as the name suggests, does not depend on the value of the variables), but we will only need to add </span><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml"> when both </span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml"> and we will only need to subtract </span><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml"> when both </span><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2}" class="math inline" src="../media/file444.png" style="vertical-align:middle" title="x_{2}"/></span><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml"> take value </span><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml">Does this sound familiar? </span><span class="koboSpan" id="kobo.1085.2" xmlns="http://www.w3.org/1999/xhtml">Well, it should, because these computations that we have described correspond, precisely, to the application of controlled operations. </span><span class="koboSpan" id="kobo.1085.3" xmlns="http://www.w3.org/1999/xhtml">Therefore, in order to calculate the contribution of a term such as </span><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0}x_{1}" class="math inline" src="../media/file910.png" style="vertical-align:middle" title="3x_{0}x_{1}"/></span><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml">, we can use the circuit that we derived in the previous subsection to add </span><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml"> in phase encoding, but with each gate controlled by both </span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1093.2" xmlns="http://www.w3.org/1999/xhtml">Notice that there is nothing special in using just two qubits as the controls, so we could also consider </span><span id="dx1-115002"/><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml">polynomials with terms such as </span><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2x_{0}x_{2}x_{4}" class="math inline" src="../media/file911.png" style="vertical-align:middle" title="- 2x_{0}x_{2}x_{4}"/></span><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5x_{1}x_{2}x_{3}x_{5}" class="math inline" src="../media/file912.png" style="vertical-align:middle" title="5x_{1}x_{2}x_{3}x_{5}"/></span><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml">To better illuminate these techniques, in </span><em><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.8"><em><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml">6.8</span></em></a><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml">, we show a circuit that computes </span><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0}x_{1} - 2x_{1}x_{2} + 1" class="math inline" src="../media/file909.png" style="vertical-align:middle" title="3x_{0}x_{1} - 2x_{1}x_{2} + 1"/></span><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1104.2" xmlns="http://www.w3.org/1999/xhtml">The first column of gates prepares the phase encoding of </span><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1106.2" xmlns="http://www.w3.org/1999/xhtml">The second one adds the independent term of the polynomial. </span><span class="koboSpan" id="kobo.1106.3" xmlns="http://www.w3.org/1999/xhtml">The next one adds </span><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">, but only if </span><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{1} = 1" class="math inline" src="../media/file913.png" style="vertical-align:middle" title="x_{0} = x_{1} = 1"/></span><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml"> (that is why all the gates are controlled by the </span><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{0} \right\rangle" class="math inline" src="../media/file825.png" style="vertical-align:middle" title="\left| x_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{1} \right\rangle" class="math inline" src="../media/file914.png" style="vertical-align:middle" title="\left| x_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml"> qubits). </span><span class="koboSpan" id="kobo.1114.2" xmlns="http://www.w3.org/1999/xhtml">Similarly, the last column subtracts </span><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml">, but only when </span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1} = x_{2} = 1" class="math inline" src="../media/file915.png" style="vertical-align:middle" title="x_{1} = x_{2} = 1"/></span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.8: Circuit for computing 3x_{0}x_{1} - 2x_{1}x_{2} + 1 in phase encoding" src="../media/file916.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.8"><strong><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.8</span></strong><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">Circuit for computing </span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0}x_{1} - 2x_{1}x_{2} + 1" class="math inline" src="../media/file909.png" style="vertical-align:middle" title="3x_{0}x_{1} - 2x_{1}x_{2} + 1"/></span><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml"> in phase encoding</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml">There are a couple of technical details to discuss about the circuit in </span><em><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.8"><em><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml">6.8</span></em></a><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1128.2" xmlns="http://www.w3.org/1999/xhtml">First, we have adopted the usual convention of setting all the one-qubit gates that are controlled by the same qubits in a single column. </span><span class="koboSpan" id="kobo.1128.3" xmlns="http://www.w3.org/1999/xhtml">In fact, we could consider them as a single multi-qubit gate, but in some quantum computers you may need to separate them and apply them in sequence (in any case, this is something that the transpiler should take care of, don’t worry). </span><span class="koboSpan" id="kobo.1128.4" xmlns="http://www.w3.org/1999/xhtml">Also, notice that these gates are multi-controlled, but — using techniques like the ones described in </span><em><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">Section 4.3</span></em><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="cite"><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xnielsen11quantum"><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml">69</span></a><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml"> — you can transform them into a combination of one- and two-qubit gates with Toffoli gates, which, in turn, can be decomposed into just one- and two-qubit gates.</span></p>
<div class="tcolorbox questionx" id="tcolobox-125">
<span id="x1-115006x6.2.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.5</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml">Design a circuit for computing </span><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}x_{2} - 3x_{0} + 2" class="math inline" src="../media/file917.png" style="vertical-align:middle" title="x_{1}x_{2} - 3x_{0} + 2"/></span><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml"> in phase encoding. </span><span class="koboSpan" id="kobo.1138.2" xmlns="http://www.w3.org/1999/xhtml">Use multi-qubit and multi-controlled gates.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml">So now we know how to compute, in phase encoding, the values of polynomials on binary variables with integer coefficients. </span><span class="koboSpan" id="kobo.1139.2" xmlns="http://www.w3.org/1999/xhtml">But what about the case in which the coefficients are real numbers? </span><span class="koboSpan" id="kobo.1139.3" xmlns="http://www.w3.org/1999/xhtml">We have two options to deal with that situation. </span><span class="koboSpan" id="kobo.1139.4" xmlns="http://www.w3.org/1999/xhtml">The first one is to </span><span id="dx1-115007"/><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml">approximate them by using fractions with the same denominator. </span><span class="koboSpan" id="kobo.1140.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if your coefficients are </span><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.25" class="math inline" src="../media/file615.png" style="vertical-align:middle" title="0.25"/></span><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1.17" class="math inline" src="../media/file918.png" style="vertical-align:middle" title="- 1.17"/></span><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml">, you can represent them by </span><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 25\slash 100 \right." class="math inline" src="../media/file919.png" style="vertical-align:middle" title="\left. 25\slash 100 \right."/></span><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. - 117\slash 100 \right." class="math inline" src="../media/file920.png" style="vertical-align:middle" title="\left. - 117\slash 100 \right."/></span><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1148.2" xmlns="http://www.w3.org/1999/xhtml">Then, you can multiply the whole polynomial by </span><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml"> without changing the variable values at which the minimum is attained and work with </span><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="25" class="math inline" src="../media/file921.png" style="vertical-align:middle" title="25"/></span><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 117" class="math inline" src="../media/file922.png" style="vertical-align:middle" title="- 117"/></span><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml">, which are integers. </span><span class="koboSpan" id="kobo.1154.2" xmlns="http://www.w3.org/1999/xhtml">The other option is to use the real numbers directly in the encoding. </span><span class="koboSpan" id="kobo.1154.3" xmlns="http://www.w3.org/1999/xhtml">For instance, in the circuit of </span><em><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.6"><em><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">6.6</span></em></a><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml">, you would use </span><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml"> even if it is not an integer. </span><span class="koboSpan" id="kobo.1159.2" xmlns="http://www.w3.org/1999/xhtml">In this case, you will work with a superposition of approximations of the real coefficient, with the better approximations having the larger amplitudes (see the discussion in </span><span class="cite"><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xgilliam2021grover"><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">45</span></a><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml"> for all the details).</span></p>
<p><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml">This completes our discussion on how to compute, in phase encoding, the value of any polynomial on binary variables. </span><span class="koboSpan" id="kobo.1164.2" xmlns="http://www.w3.org/1999/xhtml">However, we are not quite done yet! </span><span class="koboSpan" id="kobo.1164.3" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will use our newly-acquired knowledge to finally implement the oracles that we need for the GAS algorithm.</span></p>
</section>
<section class="level3 subsectionHead" data-number="13.2.4" id="constructing-the-oracle">
<h2 class="subsectionHead" data-number="13.2.4"><span class="titlemark"><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">6.2.4 </span></span> <span id="x1-1160006.2.4"><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml">Constructing the oracle</span></span></h2>
<p><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml">So far in this section we have covered a lot of ground. </span><span class="koboSpan" id="kobo.1167.2" xmlns="http://www.w3.org/1999/xhtml">However, we should not forget what our final goal is: we want to </span><span id="dx1-116001"/><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml">implement an oracle that, given </span><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">, returns whether </span><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml"> or not. </span><span class="koboSpan" id="kobo.1174.2" xmlns="http://www.w3.org/1999/xhtml">This is what we need in </span><span id="dx1-116002"/><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">order to use the </span><strong><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml">Dürr-Høyer</span></strong><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml"> algorithm to find a minimum of </span><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1179.2" xmlns="http://www.w3.org/1999/xhtml">In the previous subsection, we showed how to build a circuit that, given </span><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">, computes </span><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml"> in phase encoding. </span><span class="koboSpan" id="kobo.1183.2" xmlns="http://www.w3.org/1999/xhtml">For the sake of simplicity, in the circuits that we will use in this subsection, we will denote the sequence of gates that implements </span><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml">, excluding the initial column of </span><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml"> gates, by just a big box with </span><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x)" class="math inline" src="../media/file867.png" style="vertical-align:middle" title="g(x)"/></span><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml"> inside. </span><span class="koboSpan" id="kobo.1189.2" xmlns="http://www.w3.org/1999/xhtml">In a similar way, when we need to use the QFT or its inverse, we will use a box labeled QFT or QFT</span><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{}^{\dagger}" class="math inline" src="../media/file863.png" style="vertical-align:middle" title="{}^{\dagger}"/></span><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml">Using this notation, an oracle to determine whether </span><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml"> can be implemented by using the circuit depicted in </span><em><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.9"><em><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">6.9</span></em></a><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.9: Oracle to determine whether g(x) &lt; g(y)" src="../media/file923.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure6.9"><strong><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.9</span></strong><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml">Oracle to determine whether </span><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml">Let’s explain bit by bit the </span><span id="dx1-116005"/><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">elements of the circuit. </span><span class="koboSpan" id="kobo.1204.2" xmlns="http://www.w3.org/1999/xhtml">First, notice that the upper qubits are reserved for the inputs </span><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml"> and, consequently, are registers of </span><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml"> qubits each. </span><span class="koboSpan" id="kobo.1210.2" xmlns="http://www.w3.org/1999/xhtml">Next, we have </span><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml"> auxiliary qubits that we will use to compute the values of the polynomials (as we mentioned previously, you need to select </span><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml"> so that it is big enough to store all the intermediate results). </span><span class="koboSpan" id="kobo.1214.2" xmlns="http://www.w3.org/1999/xhtml">Finally, the bottom qubit will store the result of checking whether </span><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml">From what we have studied in this section and under the assumption that all the coefficients in </span><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g" class="math inline" src="../media/file849.png" style="vertical-align:middle" title="g"/></span><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml"> are integers, we know that the state just before the CNOT gate is </span><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle\left| y \right\rangle\left| {g(x) - g(y)} \right\rangle\left| 0 \right\rangle" class="math inline" src="../media/file924.png" style="vertical-align:middle" title="\left| x \right\rangle\left| y \right\rangle\left| {g(x) - g(y)} \right\rangle\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1221.2" xmlns="http://www.w3.org/1999/xhtml">Now, if </span><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) - g(y) &lt; 0" class="math inline" src="../media/file925.png" style="vertical-align:middle" title="g(x) - g(y) &lt; 0"/></span><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml"> and the most significant bit of </span><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) - g(y)" class="math inline" src="../media/file926.png" style="vertical-align:middle" title="g(x) - g(y)"/></span><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">, because we are working with two’s complement representation. </span><span class="koboSpan" id="kobo.1229.2" xmlns="http://www.w3.org/1999/xhtml">Thus, when we apply the CNOT gate, we will set the bottom qubit to </span><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">, and we will leave it in state </span><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.1235.2" xmlns="http://www.w3.org/1999/xhtml">This is the value that we will denote </span><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| z \right\rangle" class="math inline" src="../media/file927.png" style="vertical-align:middle" title="\left| z \right\rangle"/></span><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml">It would be natural to think that we could end the circuit after applying the CNOT gate. </span><span class="koboSpan" id="kobo.1238.2" xmlns="http://www.w3.org/1999/xhtml">After all, we have already computed the result that we needed: </span><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z" class="math inline" src="../media/file81.png" style="vertical-align:middle" title="z"/></span><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) &lt; g(y)" class="math inline" src="../media/file853.png" style="vertical-align:middle" title="g(x) &lt; g(y)"/></span><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml"> and it will be </span><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.1246.2" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, we need to set the </span><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"> auxiliary qubits back to </span><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1250.2" xmlns="http://www.w3.org/1999/xhtml">This is the value that is </span><span id="dx1-116006"/><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml">expected for the correct behaviour of the subsequent applications of the oracle (remember that we are using Grover’s algorithm, so there will be several repetitions of the oracle circuit). </span><span class="koboSpan" id="kobo.1251.2" xmlns="http://www.w3.org/1999/xhtml">What is more, we also need to set these qubits back to </span><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml"> to disentangle them from the rest of the qubits in the circuit. </span><span class="koboSpan" id="kobo.1253.2" xmlns="http://www.w3.org/1999/xhtml">If they remain entangled, they may prevent the rest of the circuit from working correctly.</span></p>
<p><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml">The process of setting the qubits back to </span><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml"> is known as </span><strong><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml">uncomputation</span></strong><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml"> and it is a very important technique in many </span><span id="dx1-116007"/><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml">quantum algorithms. </span><span class="koboSpan" id="kobo.1259.2" xmlns="http://www.w3.org/1999/xhtml">Since all quantum gates are reversible, we cannot just ”erase” the content of some qubits (that would be extremely irreversible, because we would be forgetting the original values and it would be impossible to restore them). </span><span class="koboSpan" id="kobo.1259.3" xmlns="http://www.w3.org/1999/xhtml">We need to perform the same computations that we carried out, but in reverse: hence the name ”uncomputation.” </span><span class="koboSpan" id="kobo.1259.4" xmlns="http://www.w3.org/1999/xhtml">In our case, we use the QFT to go back to phase encoding and then we add </span><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(y) - g(x)" class="math inline" src="../media/file928.png" style="vertical-align:middle" title="g(y) - g(x)"/></span><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml">, which, of course, is the inverse of adding </span><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) - g(y)" class="math inline" src="../media/file926.png" style="vertical-align:middle" title="g(x) - g(y)"/></span><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1263.2" xmlns="http://www.w3.org/1999/xhtml">Consequently, after the </span><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(y) - g(x)" class="math inline" src="../media/file928.png" style="vertical-align:middle" title="g(y) - g(x)"/></span><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml"> gate, the auxiliary qubits contain the phase encoding of </span><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml"> and, when we apply the column of </span><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml"> gates, we obtain </span><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml">, as desired.</span></p>
<p><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">We have, finally, completed our construction of the oracle that we need for GAS. </span><span class="koboSpan" id="kobo.1272.2" xmlns="http://www.w3.org/1999/xhtml">However, there are a couple of additional details that may be useful in practice. </span><span class="koboSpan" id="kobo.1272.3" xmlns="http://www.w3.org/1999/xhtml">On the one hand, notice that, in each application of Grover’s algorithm in GAS, the value of </span><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml"> is fixed (it is </span><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">, the best solution that we have found by then). </span><span class="koboSpan" id="kobo.1276.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we can simplify the design of the oracle in </span><em><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure6.9"><em><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml">6.9</span></em></a><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml"> by eliminating the qubits reserved for </span><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| y \right\rangle" class="math inline" src="../media/file268.png" style="vertical-align:middle" title="\left| y \right\rangle"/></span><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml">, computing </span><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x_{0})" class="math inline" src="../media/file850.png" style="vertical-align:middle" title="g(x_{0})"/></span><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml"> with a classical computer, and using </span><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x) - g(x_{0})" class="math inline" src="../media/file929.png" style="vertical-align:middle" title="g(x) - g(x_{0})"/></span><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="g(x_{0}) - g(x)" class="math inline" src="../media/file930.png" style="vertical-align:middle" title="g(x_{0}) - g(x)"/></span><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml"> in the gates that compute the values of the polynomial.</span></p>
<p><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, using techniques similar to the ones that we have studied in this section, we can create oracles to check whether polynomial constraints are met or not. </span><span class="koboSpan" id="kobo.1288.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if one of the constraints in our problem is </span><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - 2x_{0}x_{1} &lt; 3" class="math inline" src="../media/file931.png" style="vertical-align:middle" title="3x_{0} - 2x_{0}x_{1} &lt; 3"/></span><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml">, we can easily adapt our oracle construction to check whether that condition is met. </span><span class="koboSpan" id="kobo.1290.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we do not always need to transform our optimization problems into a pure QUBO form, but we can keep (some of) the constraints and check them directly. </span><span class="koboSpan" id="kobo.1290.3" xmlns="http://www.w3.org/1999/xhtml">This might be more convenient than working with penalty terms in some cases.</span></p>
<p><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">But enough of theoretical considerations for now. </span><span class="koboSpan" id="kobo.1291.2" xmlns="http://www.w3.org/1999/xhtml">In the next section, we will explain how to use GAS in Qiskit in order to solve combinatorial optimization problems.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="13.3" id="using-gas-with-qiskit">
<h1 class="sectionHead" data-number="13.3"><span class="titlemark"><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">6.3 </span></span> <span id="x1-1170006.3"><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml">Using GAS with Qiskit</span></span></h1>
<p><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">If you want to </span><span id="dx1-117001"/><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">practice what you have learned in this chapter about Grover’s search, the Dürr-Høyer algorithm, and the construction of oracles, you can try to implement your own version of GAS in Qiskit from scratch. </span><span class="koboSpan" id="kobo.1295.2" xmlns="http://www.w3.org/1999/xhtml">It is not a difficult project and it can be very satisfactory. </span><span class="koboSpan" id="kobo.1295.3" xmlns="http://www.w3.org/1999/xhtml">However, there is no need for that. </span><span class="koboSpan" id="kobo.1295.4" xmlns="http://www.w3.org/1999/xhtml">In the Qiskit Optimization module, you can find a ready-to-use implementation of Grover Adaptive Search (we will be using </span><strong><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">version 0.4.0</span></strong><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml"> of the package). </span><span class="koboSpan" id="kobo.1297.2" xmlns="http://www.w3.org/1999/xhtml">Let’s see how to use it.</span></p>
<p><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml">One additional advantage of working with Qiskit’s GAS implementation is that it accepts the optimization problem format that we used with QAOA in </span><em><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch013.xhtml#x1-1030005.2.2"><em><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml">5.2.2</span></em></a><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span id="dx1-117002"/><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml">The simplest way of using it is by defining a QUBO problem like the one that we can create with the following piece of code:</span></p>
<p><span id="x1-117003"/></p>
<pre class="lstlisting" id="listing-142"><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.problems import QuadraticProgram 
 
qp = QuadraticProgram() 
 
qp.binary_var(’x’) 
 
qp.binary_var(’y’) 
 
 
 
qp.minimize(linear = {’x’:2,’y’:2}, quadratic = {(’x’,’y’):-3}) 
 
 
 
print(qp.export_as_lp_string())
</span></pre>
<p><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml">The output of the execution is the following:</span></p>
<pre class="lstlisting" id="listing-143"><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">

\ This file has been generated by DOcplex 
 
\ ENCODING=ISO-8859-1 
 
\Problem name: CPLEX 
 
 
 
Minimize 
 
 obj: 2 x + 2 y + [ - 6 x*y ]/2 
 
Subject To 
 
 
 
Bounds 
 
 0 &lt;= x &lt;= 1 
 
 0 &lt;= y &lt;= 1 
 
 
 
Binaries 
 
 x y 
 
End
</span></pre>
<p><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml">As you surely recognize, this is the type of problem that we have been extensively working with in the last few chapters. </span><span class="koboSpan" id="kobo.1306.2" xmlns="http://www.w3.org/1999/xhtml">To solve it with </span><span id="dx1-117027"/><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">GAS in Qiskit, we need to define a </span><code><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml">GroverOptimizer</span></code><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml"> object as follows:</span></p>
<pre class="lstlisting" id="listing-144"><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.algorithms import GroverOptimizer 
 
from qiskit import Aer 
 
from qiskit.utils import algorithm_globals, QuantumInstance 
 
seed = 1234 
 
algorithm_globals.random_seed = seed 
 
quantum_instance = QuantumInstance(Aer.get_backend("aer_simulator"), 
 
    shots = 1024, seed_simulator = seed, seed_transpiler=seed) 
 
grover_optimizer = GroverOptimizer(num_value_qubits = 3, num_iterations=2, 
 
    quantum_instance=quantum_instance)
</span></pre>
<p><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we have set seed values for reproducibility and we have created a quantum instance based on the Aer simulator. </span><span class="koboSpan" id="kobo.1311.2" xmlns="http://www.w3.org/1999/xhtml">Of course, if you want to use a real quantum computer, you just need to create the quantum instance from one of the quantum devices, as we have seen in previous chapters. </span><span class="koboSpan" id="kobo.1311.3" xmlns="http://www.w3.org/1999/xhtml">Then, we have defined a </span><code><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">GroverOptimizer</span></code><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml"> object that uses </span><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml"> qubits to represent the values of the polynomial (what we have denoted as </span><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml"> in the previous section) and that stops the execution if it has seen no improvement in </span><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml"> consecutive iterations (the </span><code><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">num_iterations</span></code><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml"> parameter). </span><span class="koboSpan" id="kobo.1321.2" xmlns="http://www.w3.org/1999/xhtml">Notice that </span><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml"> qubits are enough to represent all the possible values of our </span><span id="dx1-117037"/><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml">polynomial in two’s complement, but </span><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml"> qubits would be too few.</span></p>
<p><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">To use this </span><code><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">GroverOptimizer</span></code><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml"> object to solve our problem, we can run the following instructions:</span></p>
<pre class="lstlisting" id="listing-145"><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">

results = grover_optimizer.solve(qp) 
 
print(results)
</span></pre>
<p><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">This will give us the following output:</span></p>
<pre class="lstlisting" id="listing-146"><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml">

fval=0.0, x=0.0, y=0.0, status=SUCCESS
</span></pre>
<p><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml">This is, indeed, the optimal solution to the problem, as you can check by trying the </span><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml"> possible options. </span><span class="koboSpan" id="kobo.1335.2" xmlns="http://www.w3.org/1999/xhtml">That was easy, wasn’t it?</span></p>
<div class="tcolorbox questionx" id="tcolobox-126">
<span id="x1-117042x6.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 6.6</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml">Write the code needed to use GAS in Qiskit to find the solution of the QUBO problem with binary variables </span><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z" class="math inline" src="../media/file81.png" style="vertical-align:middle" title="z"/></span><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml"> and objective function </span><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x + 2y - 3z + 3xy" class="math inline" src="../media/file932.png" style="vertical-align:middle" title="3x + 2y - 3z + 3xy"/></span><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml">But what if you want to solve a more complicated problem? </span><span class="koboSpan" id="kobo.1346.2" xmlns="http://www.w3.org/1999/xhtml">It turns out that the Grover Optimizer class also can work with problems with constraints. </span><span class="koboSpan" id="kobo.1346.3" xmlns="http://www.w3.org/1999/xhtml">Imagine that we define a problem with the following instructions:</span></p>
<pre class="lstlisting" id="listing-147"><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml">

qp = QuadraticProgram() 
 
qp.binary_var(’x’) 
 
qp.binary_var(’y’) 
 
qp.binary_var(’z’) 
 
qp.minimize(linear = {’x’:2}, quadratic = {(’x’,’z’):1, (’z’,’y’):-2}) 
 
qp.linear_constraint(linear = {’x’:2, ’y’:-1, ’z’:1}, 
 
    sense ="&lt;=", rhs = 2) 
 
print(qp.export_as_lp_string())
</span></pre>
<p><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">If we execute the code, we obtain the following output, which </span><span id="dx1-117051"/><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">corresponds to a quadratic program with linear constraints:</span></p>
<pre class="lstlisting" id="listing-148"><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">

\ This file has been generated by DOcplex 
 
\ ENCODING=ISO-8859-1 
 
\Problem name: CPLEX 
 
 
 
Minimize 
 
 obj: 2 x + [ 2 x*z - 4 y*z ]/2 
 
Subject To 
 
 c0: 2 x - y + z &lt;= 2 
 
 
 
Bounds 
 
 0 &lt;= x &lt;= 1 
 
 0 &lt;= y &lt;= 1 
 
 0 &lt;= z &lt;= 1 
 
 
 
Binaries 
 
 x y z 
 
End
</span></pre>
<p><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml">We could create a </span><code><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">GroverOptimizer</span></code><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml"> object and directly use its </span><code><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml">solve</span></code><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml"> method with </span><code><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml">qp</span></code><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1357.2" xmlns="http://www.w3.org/1999/xhtml">Then, the </span><code><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml">GroverOptimizer</span></code><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml"> object will convert the constrained problem into a QUBO one and solve it. </span><span class="koboSpan" id="kobo.1359.2" xmlns="http://www.w3.org/1999/xhtml">Easy peasy. </span><span class="koboSpan" id="kobo.1359.3" xmlns="http://www.w3.org/1999/xhtml">However, there is a small problem: how can we know how many qubits we should use for the polynomial values? </span><span class="koboSpan" id="kobo.1359.4" xmlns="http://www.w3.org/1999/xhtml">Since we don’t know the penalty terms that will be introduced in the conversion, we don’t know the coefficients of the polynomial. </span><span class="koboSpan" id="kobo.1359.5" xmlns="http://www.w3.org/1999/xhtml">Of course, we could use a big enough value to be sure that there will be no problems, but that will make the execution slower, especially in the simulator. </span><span class="koboSpan" id="kobo.1359.6" xmlns="http://www.w3.org/1999/xhtml">And if we use too few qubits, our results could be erroneous.</span></p>
<p><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml">For that reason, we recommend converting the problem first into QUBO form and then solving it with </span><span id="dx1-117069"/><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml">GAS. </span><span class="koboSpan" id="kobo.1361.2" xmlns="http://www.w3.org/1999/xhtml">In this way, we can more accurately determine the number of qubits that we need. </span><span class="koboSpan" id="kobo.1361.3" xmlns="http://www.w3.org/1999/xhtml">For instance, for the problem that we have just defined, we can obtain the transformed QUBO problem with the following instructions:</span></p>
<pre class="lstlisting" id="listing-149"><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.converters import QuadraticProgramToQubo 
 
qp_to_qubo = QuadraticProgramToQubo() 
 
qubo = qp_to_qubo.convert(qp) 
 
print(qubo.export_as_lp_string())
</span></pre>
<p><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml">The output is the following:</span></p>
<pre class="lstlisting" id="listing-150"><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">

\ This file has been generated by DOcplex 
 
\ ENCODING=ISO-8859-1 
 
\Problem name: CPLEX 
 
 
 
Minimize 
 
 obj: - 46 x + 24 y - 24 z - 24 c0@int_slack@0 - 48 c0@int_slack@1 + [ 48 x^2 
 
      - 48 x*y + 50 x*z + 48 x*c0@int_slack@0 + 96 x*c0@int_slack@1 + 12 y^2 
 
      - 28 y*z - 24 y*c0@int_slack@0 - 48 y*c0@int_slack@1 + 12 z^2 
 
      + 24 z*c0@int_slack@0 + 48 z*c0@int_slack@1 + 12 c0@int_slack@0^2 
 
      + 48 c0@int_slack@0*c0@int_slack@1 + 48 c0@int_slack@1^2 ]/2 + 24 
 
Subject To 
 
 
 
Bounds 
 
 0 &lt;= x &lt;= 1 
 
 0 &lt;= y &lt;= 1 
 
 0 &lt;= z &lt;= 1 
 
 0 &lt;= c0@int_slack@0 &lt;= 1 
 
 0 &lt;= c0@int_slack@1 &lt;= 1 
 
 
 
Binaries 
 
 x y z c0@int_slack@0 c0@int_slack@1 
 
End
</span></pre>
<p><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, this is now a bona fide QUBO problem. </span><span class="koboSpan" id="kobo.1365.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, by </span><span id="dx1-117096"/><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">inspecting the polynomial coefficients, we can notice that </span><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, for instance, are enough to store the polynomial values. </span><span class="koboSpan" id="kobo.1368.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we can solve the problem with the following piece of code:</span></p>
<pre class="lstlisting" id="listing-151"><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">

grover_optimizer = GroverOptimizer(10, 
 
    num_iterations=4, quantum_instance=quantum_instance) 
 
results = grover_optimizer.solve(qubo) 
 
print(results)
</span></pre>
<p><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">If we run it, we obtain the following, which is indeed the solution to the problem:</span></p>
<pre class="lstlisting" id="listing-152"><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml">

fval=-2.0, x=0.0, y=1.0, z=1.0, c0@int_slack@0=0.0, c0@int_slack@1=1.0, 
 
status=SUCCESS
</span></pre>
<p><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">However, this involves the slack variables used in the transformation. </span><span class="koboSpan" id="kobo.1372.2" xmlns="http://www.w3.org/1999/xhtml">If you don’t want to see them, you can alternatively run </span><span id="dx1-117103"/><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml">GAS on the original problem, now that we know how many qubits to use:</span></p>
<pre class="lstlisting" id="listing-153"><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml">

grover_optimizer = GroverOptimizer(10, num_iterations=4, 
 
    quantum_instance=quantum_instance) 
 
results = grover_optimizer.solve(qp) 
 
print(results)
</span></pre>
<p><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the output is the following:</span></p>
<pre class="lstlisting" id="listing-154"><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">

fval=-2.0, x=0.0, y=1.0, z=1.0, status=SUCCESS
</span></pre>
<p><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml">This is exactly the same solution that we obtained with the transformed problem, but now without the slack variables.</span></p>
<p><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">This is all you need to know if you want to use </span><span id="dx1-117109"/><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">GAS in Qiskit. </span><span class="koboSpan" id="kobo.1379.2" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we will study the </span><strong><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">Variational Quantum Eigensolver</span></strong><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml">, a generalization of QAOA that will allow us to solve many interesting optimization problems.</span></p>
</section>
<section class="level2 likesectionHead" data-number="13.4" id="summary-5">
<h1 class="likesectionHead" data-number="13.4"><span id="x1-1180006.3"><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></span></h1>
<p><span id="Q1-1-163"/></p>
<p><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we have learned about Grover’s search algorithm and how it can be adapted to find minima of functions with the Dürr-Høyer algorithm. </span><span class="koboSpan" id="kobo.1383.2" xmlns="http://www.w3.org/1999/xhtml">We have also learned about quantum oracles and their role in these two methods.</span></p>
<p><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml">After that, we learned how to perform arithmetic in phase encoding and how to retrieve the results by using the mighty Quantum Fourier Transform. </span><span class="koboSpan" id="kobo.1384.2" xmlns="http://www.w3.org/1999/xhtml">We also studied how to use all these techniques to implement oracles that can be used in Grover’s Adaptive Search to solve combinatorial optimization problems.</span></p>
<p><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml">Finally, we also learned how to use GAS with Qiskit to obtain solutions of both QUBO problems and constrained quadratic programs.</span></p>
<p><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml">Now, get ready for the next chapter: we will be studying the Variational Quantum Eigensolver and some of its most important applications!</span></p>
</section>
</section>
</body>
</html>
