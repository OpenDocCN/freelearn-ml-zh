<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Creating ML Applications with Firebase</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we learned about using some of the various Google machine learning APIs to predict/classify an event. However, we performed all our work in Datalab. In a real-world scenario, we could want to integrate machine learning APIs into a web application or a mobile application that we build. Firebase comes in handy in such a scenario. Firebase is a platform allows us to build web and mobile applications without server-side programming. Firebase provides multiple features that ensure that the developer focuses on building the application, while the backend is taken care of. Some of the features that Firebase provides are:</p>
<ul>
<li>Real-time database</li>
<li>File storage</li>
<li>Cloud functions</li>
<li>Hosting</li>
<li>Performance monitoring</li>
<li>Analytics</li>
<li>Authentication</li>
</ul>
<p>In this chapter, we will understand more about the various features provided by Firebase. Also, to understand how Firebase helps in building applications with machine learning capabilities, we will build a web application and a mobile application that translates text in any given language into english using the Google Translate API and provides the most translated text.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Features of Firebase</h1>
                </header>
            
            <article>
                
<p>Some of the features that Firebase provides are as follows:</p>
<ul>
<li><strong>Real-time database</strong>: Enables us to store and sync app data in milliseconds</li>
<li><strong>Cloud firestore</strong>: Enables us to store and sync data on global scale</li>
<li><strong>Cloud functions</strong>: Enables us to run backend code without managing servers</li>
<li><strong>Hosting</strong>: Delivers web app assets with speed and security</li>
<li><strong>Performance monitoring</strong>: Helps gain insights into an app's performance</li>
<li><strong>Crashlytics</strong>: Enables us to prioritize and fix issues with powerful, real-time crash reporting</li>
<li><strong>Authentication</strong>: Helps us authenticate users simply and securely</li>
<li><strong>Cloud storage</strong>: Enables us to store and serve files at Google scale</li>
<li><strong>Predictions</strong>: Enables us to define dynamic user groups based on predicted behavior</li>
<li><strong>Remote config</strong>: Enables us to modify our app without deploying a new version</li>
<li><strong>App indexing</strong>: Enables us to drive search traffic to mobile app</li>
<li><strong>Cloud messaging</strong>: Enables us to send targeted messages and notifications</li>
<li><strong>Dynamic links</strong>: Enables us to drive growth by using deep links with attribution</li>
<li><strong>Invites</strong>: Enables us to drive growth by using deep links with attribution</li>
</ul>
<p>In this chapter, we will build an application that takes an input text and translates it into English—first a web application and then a mobile application.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building a web application</h1>
                </header>
            
            <article>
                
<p>In order to build the web application, we make use of Node.js.</p>
<p>Download and install Node.js:</p>
<ol>
<li><kbd>node.js</kbd> can be downloaded from the link here: <a href="https://nodejs.org/en/">https://nodejs.org/en/</a>.<br/>
For the version that we are building now, we will use the 8.11.1 LTS version of Node.js on Windows 64-bit machine.</li>
<li>Once you download the executable file from <a href="https://nodejs.org/dist/v8.11.1/node-v8.11.1-x64.msi">https://nodejs.org/dist/v8.11.1/node-v8.11.1-x64.msi</a>, make sure to install Node.js using the default parameters.</li>
</ol>
<p>Create a Firebase project:</p>
<ol>
<li>A Firebase project can be created by logging in to the Firebase console here: <a href="https://console.firebase.google.com/">https://console.firebase.google.com</a></li>
<li>Within the console, click on <span class="packt_screen">Add project</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d0e73c87-b687-41ba-aa70-3257a4b986d5.png" style=""/></div>
<ol start="3">
<li>Enter project name (highlighted in red) and fetch project ID (highlighted in black), as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/289a67db-84a6-4ffd-80a7-9cbd8141346c.png" style=""/></div>
<ol start="4">
<li>Install Firebase tools using Node.js package manager, as follows:
<ul style="padding-left: 1px">
<li>Change directory to the folder where the <kbd>firebase</kbd> function files need to be stored. In the following screenshot, we are creating a folder named <kbd>firebase</kbd> in the <kbd>E</kbd> drive:</li>
</ul>
</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a07da3ae-5716-4fd7-9109-0f80980dd6c7.png" style=""/></div>
<ol start="5">
<li>We install Firebase tools using the following code snippet:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c90d5a0e-51f7-45fc-83e6-4b99ee707fff.png" style=""/></div>
<p>Log in and initialize Firebase:</p>
<ol>
<li>We log into Firebase, by specifying:</li>
</ol>
<pre style="padding-left: 60px"><strong>firebase login --reauth</strong></pre>
<ol start="2">
<li>The previous code snippet would allow us to log in using our credentials. Make sure to allow Firebase CLI to access your Google account.</li>
<li>Once we are logged into Firebase, we initialize <kbd>firebase</kbd> as follows:</li>
</ol>
<pre style="padding-left: 60px"><strong>firebase init</strong></pre>
<ol start="4">
<li>You will get the following screen:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c1fdcdf4-af7d-489c-b9c7-8b7507a85b0a.png" style=""/></div>
<ol start="5">
<li>Press <em>Y</em> to initialize Firebase.</li>
</ol>
<ol start="6">
<li>Select the features that are needed for the current application by pressing the space bar, and, once done with selection, press <em>Enter</em>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/334ae5fc-9f99-486f-84c9-35710568d815.png" style=""/></div>
<ol start="7">
<li>Once selected, for the version that we use here, let us specify that our functions are deployed with JavaScript, as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/129cda59-384c-4302-98c5-c23a4903fef1.png" style=""/></div>
<ol start="8">
<li>Once selected, we set the project with the project directory:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bd43fce2-8e09-4523-b36d-32ab9b2c5579.png"/></div>
<p class="mce-root CDPAlignLeft CDPAlign" style="padding-left: 60px">Note that <kbd>mytranslator</kbd> is the project that we created in <em>step 2</em>. Also note that once we've initialized Firebase, the folder structure looks like this:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/56d7a5b4-af7c-49de-9e35-0c2e03efdc5f.png" style=""/></div>
<ol start="9">
<li>In Command Prompt, press <em>Enter</em> for the various prompts after initializing Firebase. At the end of initialization, you should get a confirmation upon completing initialization as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0d9a7645-2078-4cb3-9b29-9c7d17519931.png" style=""/></div>
<p>Install Google Translate using Node.js package manager after scrolling to the <kbd>functions</kbd> folder:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/75d1e6f5-2658-4050-9c64-5e0735f6d8c2.png" style=""/></div>
<p>We specify all the functionalities (public API methods) that are required for our use case. These functions handle all the server programming:</p>
<ol>
<li>In order to specify these, let us overwrite the <kbd>index.js</kbd> file present in the <kbd>functions</kbd> folder with the following code snippet.</li>
</ol>
<pre style="padding-left: 60px">const functions = require('firebase-functions');<br/>const Translate = require('@google-cloud/translate');<br/>const admin = require("firebase-admin")<br/><br/>//setting connection to db<br/>admin.initializeApp();<br/><br/>const translate = new Translate({<br/>    projectId: 'mytranslator-c656d'<br/>});<br/>//Extract the most searched term<br/><br/>exports.getMessageStats=functions.https.onRequest((req,res) =&gt;<br/> {<br/> var output;<br/> var db = admin.database();<br/> var ref = db.ref("/translateMessageStats");<br/><br/>// Attach an asynchronous callback to read the data at our posts reference<br/> ref.orderByChild("count").limitToLast(1).on("value", function(snapshot) {<br/><br/>console.log(snapshot.forEach(element =&gt; {<br/> output=element.key+" : "+element.val().count + 'times'<br/> }))<br/> res.header("Access-Control-Allow-Origin", "*");<br/> return res.send(JSON.stringify(output));<br/> }, function (errorObject) {<br/> console.log("The read failed: " + errorObject.code);<br/> });<br/>})<br/><br/>// create a public API method of name "translateMessage"<br/><br/>exports.translateMessage=functions.https.onRequest((req,res) =&gt;<br/> {<br/> const input = req.query.text;<br/><br/>translate.translate(input,'en').then(results =&gt;<br/> {<br/> const output = results[0];<br/> console.log(output);<br/><br/>const db = admin.database();<br/>var ref = db.ref("/translateMessageStats");<br/><br/>//update database<br/> var dataRef= ref.child(input);<br/><br/>dataRef.once('value', function(snapshot) {<br/> if (snapshot.exists()) {<br/> dataRef.update({"count":snapshot.val().count+1});<br/> console.log("data exists")<br/> }<br/> else<br/> {<br/> console.log("data does not exist")<br/> dataRef.update({"count":1});<br/> }<br/> });<br/><br/>res.header("Access-Control-Allow-Origin", "*");<br/> return res.send(JSON.stringify(output));<br/> })<br/>});</pre>
<ol start="2">
<li>In this code, we import the required Node.js packages by using the following code:</li>
</ol>
<pre style="padding-left: 60px">const functions = require('firebase-functions');<br/>const Translate = require('@google-cloud/translate');<br/>const admin = require("firebase-admin")</pre>
<ol start="3">
<li class="mce-root">We initialize the connection to the database by specifying the following:</li>
</ol>
<pre style="padding-left: 60px">admin.initializeApp();</pre>
<ol start="4">
<li>We create <kbd>translate</kbd> object and pass the project ID as a parameter in it, as follows:</li>
</ol>
<pre style="padding-left: 60px">const translate = new Translate({<br/>    projectId: 'mytranslator-c656d'<br/>});</pre>
<ol start="5">
<li>We then create a public facing API with name <kbd>translateMessage</kbd>, as follows:</li>
</ol>
<pre style="padding-left: 60px">exports.translateMessage=functions.https.onRequest((req,res) =&gt;</pre>
<ol start="6">
<li>The input given by user is fetched through the following line:</li>
</ol>
<pre style="padding-left: 60px">const input = req.query.text;</pre>
<ol start="7">
<li>The translation of input text and the corresponding storage of translated text in the output is done by this code:</li>
</ol>
<pre style="padding-left: 60px">translate.translate(input,'en').then(results =&gt;<br/>{<br/>    const output = results[0];</pre>
<ol start="8">
<li class="mce-root">We create an instance of database, as follows:</li>
</ol>
<pre style="padding-left: 60px">const db = admin.database();<br/> var ref = db.ref("/translateMessageStats");</pre>
<ol start="9">
<li class="mce-root">The input is updated in the database:</li>
</ol>
<pre style="padding-left: 60px">var dataRef= ref.child(input);</pre>
<ol start="10">
<li class="mce-root">If a new input is given, <kbd>count</kbd> is initialized to <kbd>1</kbd>; else, <kbd>count</kbd> is incremented by <kbd>1</kbd>:</li>
</ol>
<pre style="padding-left: 60px">dataRef.once('value', function(snapshot) {<br/>    if (snapshot.exists()) {<br/>        dataRef.update({"count":snapshot.val().count+1});<br/>        console.log("data exists")<br/>    }<br/>    else<br/>    {<br/>        console.log("data does not exist")<br/>        dataRef.update({"count":1});<br/>    }<br/>  });</pre>
<p><span class="packt_screen">Enable</span> the <strong>Google Cloud Translation API</strong>, as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f8fc2986-fcf9-4097-bd42-0bc8c46c6e36.png" style=""/></div>
<p>Deploy the <kbd>firebase</kbd> function:</p>
<ol>
<li>We can deploy the <kbd>firebase</kbd> function as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/660f97c0-73eb-49b9-9a61-296816558bac.png" style=""/></div>
<ol start="2">
<li>Once the function is deployed, check out <span class="packt_screen">Functions</span> in the <span class="packt_screen">DEVELOP</span> section of <span class="packt_screen">Project Overview</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/fdde39b3-a99a-4cea-9cb1-343b53f3fb7b.png" style=""/></div>
<ol start="3">
<li>Once we click on <span class="packt_screen">Functions</span>, we should be able to see a dashboard that contains the function that we just created—<kbd>translateMessage</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4d25db6d-843c-4d0a-968f-bc9f4d3be734.png"/></div>
<p>Note that, the previous event provides us with a URL, using which we should be able to translate the input text, as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9057d9c3-0cd8-4eb7-a33f-60022317a938.png"/></div>
<p>Note the usage of <kbd>?text=</kbd> in the URL, which is the input.</p>
<p>In case there is an issue with the execution, we should be able to understand them in the <span class="packt_screen">Logs</span> tab (of the <span class="packt_screen">Functions</span> dashboard).</p>
<p>Additionally, all the inputs that we have searched for, are stored in database:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/caab7455-583e-43c8-bd50-de5a115b83b5.png" style=""/></div>
<p>Note that the count value is initialized as searched for the term <kbd>hola</kbd>.</p>
<p>Replace the content of <kbd>index.html</kbd> file in the <kbd>public</kbd> folder with the following code snippet. The output of following code snippet would be to create a textbox that lets us give an input text, translate the text, and produce the translated output.</p>
<ol>
<li>In your execution, replace the project ID <span><kbd>mytranslator-c656d</kbd> with your own project ID:</span></li>
</ol>
<pre style="padding-left: 60px">&lt;html&gt;<br/>  &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"&gt;  &lt;/script&gt;<br/>  &lt;script&gt;<br/> <br/>    $(document).ready(<br/>      getMessageStats()<br/>    );<br/>&lt;!-- The following code extracts the most searched term from the database that we create in the next function --&gt;<br/><br/>    function getMessageStats(){<br/>      var xhr = new XMLHttpRequest();<br/>      xhr.open('GET', "https://us-central1-mytranslator-c656d.cloudfunctions.net/getMessageStats", true);<br/>      xhr.send();<br/>  <br/>      xhr.onreadystatechange = processRequest;<br/> <br/>      function processRequest(e) {<br/>        if (xhr.readyState == 4) {<br/>          var response = JSON.parse(xhr.responseText);<br/>          document.getElementById("mostSearched").innerHTML=response;<br/>        }<br/>      }<br/>    }<br/>&lt;!-- the following function translates the input value into english --&gt;<br/>    function translateText()<br/>    {<br/>      var textInput= document.getElementById("input").value;<br/>      var xhr = new XMLHttpRequest();<br/>      xhr.open('GET', "https://us-central1-mytranslator-c656d.cloudfunctions.net/translateMessage?text="+textInput, true);<br/>      xhr.send();<br/> <br/>      xhr.onreadystatechange = processRequest;<br/>      function processRequest(e) {<br/><br/>        if (xhr.readyState == 4) {<br/>          var response = JSON.parse(xhr.responseText);<br/>          document.getElementById("output").innerHTML=response;<br/>          getMessageStats();<br/>        }<br/>      }<br/>    }<br/>  &lt;/script&gt;<br/>&lt;!-- the following code creates the layout of web application, with input text box and output--&gt;<br/>  &lt;body&gt;<br/>    &lt;label&gt;Enter Input Text&lt;/label&gt;<br/>    &lt;input id="input" type="text-area"&gt;&lt;/input&gt;<br/>    &lt;button onclick="translateText()" id="btnTrans"&gt;Translate&lt;/button&gt;<br/>    &lt;label id="output"&gt;&lt;/label&gt;<br/>    &lt;br/&gt;<br/>    &lt;div&gt;<br/>      &lt;h1&gt;Most Searched element&lt;/h1&gt;<br/>      &lt;label id="mostSearched"&gt;&lt;/label&gt;<br/>    &lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</pre>
<p>We deploy Firebase so that we upload the HTML file that specifies the structure of the final URL we would be working on:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/96024a9e-a6c8-4f00-9b49-0d5a2190a058.png" style=""/></div>
<p>We should now be able to access the link shown, which helps us in translating text, as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/beb2f050-23fb-48fa-8f0a-a0443a9f3d88.png" style=""/></div>
<p>From this, we have seen that we are able to create a web application that translates any given input text. Note that the web application made use of the API endpoint that was created by function, and the frontend code would only vary by the framework that we use—it could be different when we use Angular over HTML, but the server side code would remain the same.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building a mobile application</h1>
                </header>
            
            <article>
                
<p>In the previous section, we understood the frontend of an HTML page that would translate input for us. In this section, we will build the frontend of an Android app that leverages the endpoint we generated for the function to return the translated text for us.</p>
<p>We create the layout of the app as follows:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/> &lt;android.support.constraint.ConstraintLayout <br/>     <br/>     <br/>     android:layout_width="match_parent"<br/>     android:layout_height="match_parent"<br/>     tools:context=".MainActivity"&gt;<br/> <br/>     &lt;Button<br/>         android:id="@+id/button"<br/>         android:layout_width="wrap_content"<br/>         android:layout_height="wrap_content"<br/>         android:layout_marginStart="148dp"<br/>         android:layout_marginTop="56dp"<br/>         android:text="Translate"<br/>         app:layout_constraintStart_toStartOf="parent"<br/>         app:layout_constraintTop_toBottomOf="@+id/input" /&gt;<br/> <br/>     &lt;EditText<br/>         android:id="@+id/input"<br/>         android:layout_width="wrap_content"<br/>         android:layout_height="wrap_content"<br/>         android:layout_marginStart="84dp"<br/>         android:layout_marginTop="84dp"<br/>         android:ems="10"<br/>         android:inputType="textPersonName"<br/>         app:layout_constraintStart_toStartOf="parent"<br/>         app:layout_constraintTop_toTopOf="parent" /&gt;<br/> <br/>     &lt;TextView<br/>         android:id="@+id/out"<br/>         android:layout_width="197dp"<br/>         android:layout_height="80dp"<br/>         android:layout_marginStart="92dp"<br/>         android:layout_marginTop="56dp"<br/>         app:layout_constraintStart_toStartOf="parent"<br/>         app:layout_constraintTop_toBottomOf="@+id/button" /&gt;<br/> <br/> &lt;/android.support.constraint.ConstraintLayout&gt;</pre>
<p>The preceding code would output the layout of the app:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/394b75ab-8707-4b3c-93cd-188b37613337.png" style=""/></div>
<p>Note that we have an <span class="packt_screen">EditText</span> view that takes input.</p>
<p>The <span class="packt_screen">Button</span> is used to execute the translation and <span class="packt_screen">out</span> is the <span class="packt_screen">TextView</span> where the output is displayed.</p>
<p>Also note that in the preceding code, we have ensured that the components are aligned to the screen.</p>
<p>Within main activity, we execute the following code:</p>
<pre><strong>package</strong> com.example.admin.translateapp;<br/> <br/> <strong>import</strong> android.os.AsyncTask;<br/> <strong>import</strong> android.support.v7.app.AppCompatActivity;<br/> <strong>import</strong> android.os.Bundle;<br/> <strong>import</strong> android.view.View;<br/> <strong>import</strong> android.widget.Button;<br/> <strong>import</strong> android.widget.EditText;<br/> <strong>import</strong> android.widget.TextView;<br/> <br/> <strong>import</strong> java.io.BufferedReader;<br/> <strong>import</strong> java.io.IOException;<br/> <strong>import</strong> java.io.InputStreamReader;<br/> <strong>import</strong> java.net.HttpURLConnection;<br/> <strong>import</strong> java.net.URL;<br/> <br/> <strong>import</strong> javax.net.ssl.HttpsURLConnection;<br/> <br/> <strong>public class</strong> MainActivity <strong>extends</strong> AppCompatActivity {<br/>     <strong>public</strong> String <strong>myurl</strong>;<br/>     <strong>public</strong> String <strong>result</strong>;<br/>     <strong>public</strong> String <strong>response</strong>;<br/>     <strong>public</strong> EditText <strong>inp</strong>;<br/>     <strong>public</strong> TextView <strong>out</strong>;<br/>     <strong>public</strong> Button <strong>btn</strong>;<br/> <br/>     @Override<br/>     <strong>protected void</strong> onCreate(Bundle savedInstanceState) {<br/>         <strong>super</strong>.onCreate(savedInstanceState);<br/>         setContentView(R.layout.<strong>activity_main</strong>);<br/>         <strong>inp</strong> = (EditText) findViewById(R.id.<strong>input</strong>);<br/>         <strong>out</strong> = (TextView) findViewById(R.id.<strong>out</strong>);<br/>         <strong>btn</strong> = (Button) findViewById(R.id.<strong>button</strong>);<br/>         <strong>myurl</strong> = <strong>"</strong><strong>http://us-central1-mytranslator-c656d.cloudfunctions.net/translateMessage?text=</strong><strong>"</strong>;<br/> <br/>         <strong>btn</strong>.setOnClickListener(<strong>new</strong> View.OnClickListener() {<br/>             <strong>public void</strong> onClick(View v) {<br/>                 RequestTask task = <strong>new</strong> RequestTask();<br/>                 task.execute(<strong>inp</strong>.getText().toString());<br/>             }<br/>         });<br/>     }<br/> <br/>     <strong>private class</strong> RequestTask <strong>extends</strong> AsyncTask&lt;String, String, String&gt; {<br/> <br/>         @Override<br/>         <strong>protected</strong> String doInBackground(String... uri) {<br/>             <strong>try</strong> {<br/>                 URL url = <strong>new</strong> URL(<strong>myurl</strong>+uri[0].toString());<br/>                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();<br/>                 conn.setRequestMethod(<strong>"GET"</strong>);<br/>                 conn.connect();<br/>                 <strong>if</strong> (conn.getResponseCode() == HttpURLConnection.<strong>HTTP_OK</strong>) {<br/>                     InputStreamReader streamReader = <strong>new<br/>                            </strong> InputStreamReader(conn.getInputStream());<br/>                     //Create a new buffered reader and String Builder<br/>                     BufferedReader reader = <strong>new</strong> BufferedReader(streamReader);<br/>                     StringBuilder stringBuilder = <strong>new</strong> StringBuilder();<br/>                     //Check if the line we are reading is not null<br/>                     String inputLine;<br/>                     <strong>while</strong>((inputLine = reader.readLine()) != <strong>null</strong>){<br/>                         stringBuilder.append(inputLine);<br/>                     }<br/>                     //Close our InputStream and Buffered reader<br/>                     reader.close();<br/>                     streamReader.close();<br/>                     //Set our result equal to our stringBuilder<br/>                     <strong>result</strong> = stringBuilder.toString();<br/>                     //result = conn.getResponseMessage();<br/>                 } <strong>else</strong> {<br/>                 }<br/>             } <strong>catch</strong> (IOException e) {<br/>                 //<strong>TODO Handle problems..<br/>            </strong> }<br/>             <strong>return</strong> <strong>result</strong>;<br/>         }<br/> <br/>         @Override<br/>         <strong>protected void</strong> onPostExecute(String result1) {<br/>             <strong>super</strong>.onPostExecute(result1);<br/>             <strong>out</strong>.setText(result1);<em><br/>        </em> }<br/>     }<br/> }</pre>
<p>Let us understand the preceding code.</p>
<p>Import the relevant packages:</p>
<pre><strong>import</strong> android.os.AsyncTask;<br/> <strong>import</strong> android.support.v7.app.AppCompatActivity;<br/> <strong>import</strong> android.os.Bundle;<br/> <strong>import</strong> android.view.View;<br/> <strong>import</strong> android.widget.Button;<br/> <strong>import</strong> android.widget.EditText;<br/> <strong>import</strong> android.widget.TextView;<br/> <br/> <strong>import</strong> java.io.BufferedReader;<br/> <strong>import</strong> java.io.IOException;<br/> <strong>import</strong> java.io.InputStreamReader;<br/> <strong>import</strong> java.net.HttpURLConnection;<br/> <strong>import</strong> java.net.URL;</pre>
<p>Initialize the objects that we use in the <kbd>MainActivity</kbd> class:</p>
<pre><strong>public</strong> String <strong>myurl</strong>;<br/> <strong>public</strong> String <strong>result</strong>;<br/> <strong>public</strong> String <strong>response</strong>;<br/> <strong>public</strong> EditText <strong>inp</strong>;<br/> <strong>public</strong> TextView <strong>out</strong>;<br/> <strong>public</strong> Button <strong>btn</strong>;</pre>
<p>Also, initialize the views using the following code:</p>
<pre><strong>inp</strong> = (EditText) findViewById(R.id.<strong><em>input</em></strong>);<br/> <strong>out</strong> = (TextView) findViewById(R.id.<strong><em>out</em></strong>);<br/> <strong>btn</strong> = (Button) findViewById(R.id.<strong><em>button</em></strong>);</pre>
<p>Set the on-click listener:</p>
<pre><strong>btn</strong>.setOnClickListener(<strong>new</strong> View.OnClickListener() {<br/>     <strong>public void</strong> onClick(View v) {<br/>         RequestTask task = <strong>new</strong> RequestTask();<br/>         task.execute(<strong>inp</strong>.getText().toString());</pre>
<p>Specify the tasks that need to be executed when clicked on the button:</p>
<pre>URL url = <strong>new</strong> URL(<strong>myurl</strong>+uri[0].toString());<br/> HttpURLConnection conn = (HttpURLConnection) url.openConnection();<br/> conn.setRequestMethod(<strong>"GET"</strong>);<br/> conn.connect();<br/> <strong>if</strong> (conn.getResponseCode() == HttpURLConnection.<strong><em>HTTP_OK</em></strong>) {<br/>     InputStreamReader streamReader = <strong>new<br/>            </strong> InputStreamReader(conn.getInputStream());<br/>     //Create a new buffered reader and String Builder<br/>     BufferedReader reader = <strong>new</strong> BufferedReader(streamReader);<br/>     StringBuilder stringBuilder = <strong>new</strong> StringBuilder();<br/>     //Check if the line we are reading is not null<br/>     String inputLine;<br/>     <strong>while</strong>((inputLine = reader.readLine()) != <strong>null</strong>){<br/>         stringBuilder.append(inputLine);<br/>     }<br/>     //Close our InputStream and Buffered reader<br/>     reader.close();<br/>     streamReader.close();<br/>     //Set our result equal to our stringBuilder<br/>     <strong>result</strong> = stringBuilder.toString();</pre>
<p>From the preceding code, the URL gets evaluated to the URL that we have seen in the previous web application section.</p>
<p>The output of the preceding code is as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/374bfb06-bb99-46b7-8632-189359cb0a99.png" style=""/></div>
<p>Note that, on clicking the <span class="packt_screen">BUTTON</span>, we should be able to translate our text.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we understood the various features of Firebase and using <kbd>firebase</kbd> functions to build the backend of web and mobile applications. We also used <kbd>firebase</kbd> functions to update a database on a real-time basis and retrieve the most searched term historically from the database.</p>


            </article>

            
        </section>
    </body></html>