- en: '11'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Working with Model Object, Optimized (MOJO)
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we learned in [*Chapter 10*](B17298_10.xhtml#_idTextAnchor196), *Working
    with Plain Old Java Objects (POJOs)*, when working with production systems, we
    need portable software that we can easily deploy to our production servers. It
    is especially important in **Machine Learning** (**ML**) services that ML models
    be portable and self-sufficient. This helps engineers deploy new models regularly
    without worrying about breaking their systems in production because of any dependency
    issues.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: H2O’s model POJOs were a good solution to this problem. Model POJOs are H2O
    models that can be extracted in the form of Java POJOs that you can directly run
    using `h2o-genmodel.jar`.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: However, model POJOs have certain drawbacks that prevent them from being the
    best solution to all these problems. When it comes to the portability of software
    packages, including POJOs, the smaller the object, the faster it is to deploy
    it. POJOs have an inherent limit on the size of the source files, which is up
    to 1 GB. Thus, models larger than 1 GB cannot be extracted as POJOs and at the
    same time, large models can be slow to deploy and perform.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: That is why the team at H2O.ai created an alternative to POJOs called **Model
    Object, Optimized** (**MOJO**). MOJOs are low-latency, self-sufficient, and standalone
    objects that can be easily deployed in production. They are smaller and faster
    counterparts to POJOs and are as easy to extract and use as POJOs.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Understanding what a MOJO is
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extracting H2O models as MOJOs
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Viewing model MOJOs
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using H2O AutoML model MOJOs to make predictions
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By the end of this chapter, you will be able to understand the difference between
    POJOs and MOJOs, extract trained models in the form of MOJOs using Python, R,
    or H2O Flow, and then use those MOJO models to load your ML program to make predictions.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, you will need the following:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: The latest version of your preferred web browser
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An **Integrated Development Environment** (**IDE**) of your choice
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: (Optional) Jupyter Notebook by Project Jupyter ([https://jupyter.org/](https://jupyter.org/))
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All the experiments conducted in this chapter are performed on a Terminal. You
    are free to follow along using the same setup or perform the same experiments
    using any IDE of your choice. All code examples for this chapter can be found
    on GitHub at [https://github.com/PacktPublishing/Practical-Automated-Machine-Learning-on-H2O/tree/main/Chapter%2011](https://github.com/PacktPublishing/Practical-Automated-Machine-Learning-on-H2O/tree/main/Chapter%2011).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: Understanding what a MOJO is
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**MOJOs** are counterparts to H2O model POJOs and technically work in the same
    way. H2O can build and extract models trained in the form of MOJOs, and you can
    use the extracted MOJOs to deploy and make predictions on inbound data.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: So, what makes MOJOs different from POJOs?
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: 'POJOs have certain drawbacks that make them slightly less than ideal to use
    in a production environment, as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: POJOs are not supported for source files larger than 1 GB, so any models with
    a size larger than 1 GB cannot be compiled to POJOs.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: POJOs do not support stacked ensemble models or Word2Vec models.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MOJOs, on the other hand, have the following additional benefits:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: MOJOs have no size restrictions
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MOJOs solve the large size issue by removing the ML tree and using a generic
    tree walking algorithm to navigate the model computationally
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MOJOs are smaller in size and faster than POJOs
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MOJOs support all types of models trained using H2O AutoML
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As per H2O’s in-house experiments and testing, as stated at https://docs.h2o.ai/h2o/latest-stable/h2o-docs/productionizing.xhtml#benefits-of-mojos-over-pojos,
    it was noticed that MOJO models are roughly 20-25 times smaller in disk space
    than the respective POJO models. MOJOs were also twice as fast as POJOs when **hot
    scoring**, which is when scoring is done after the JVM has been able to optimize
    the execution paths. During **cold scoring**, which is when scoring is done before
    the JVM has optimized the execution path, MOJOs showed around 10-40 times faster
    execution compared to POJOs. MOJOs are more efficient compared to POJOs as the
    size of the model increases.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: H2O’s in-house testing also showed that when tested with 5,000 trees with a
    depth of 25, POJOs performed better when running binomial classification on very
    small trees of around 50 with 5 depths, but MOJOs performed better for multinomial
    classification.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know what MOJOs are, as well as their benefits, let’s see how we
    can extract models trained using H2O’s AutoML as MOJOs using simple examples.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: Extracting H2O models as MOJOs
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Just like POJOs, you can extract models trained using H2O’s AutoML using any
    of the H2O-supported languages.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: In the following sub-sections, we shall learn how to extract the model MOJOs
    using the Python and R programming languages, as well as see how we can extract
    model MOJOs using H2O Flow.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Extracting H2O models as MOJOs in Python
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s see how we can extract models as MOJOs using Python. We shall use the
    same **Iris flower dataset** for running AutoML.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these steps to train models using H2O AutoML. Then, we shall extract
    the leader model and download it as a MOJO:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: 'Import the `h2o` module and spin up your H2O server:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Import the Iris dataset by passing the appropriate location of the dataset
    in your system. Execute the following command:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Set the feature and label names by executing the following command:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Initialize the H2O AutoML object by setting the value of the `max_model` parameter
    to `10` and the `seed` value to `5` by executing the following commands:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Start the AutoML process by passing the training dataset, the feature columns,
    and the label column as parameters, as follows:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Once training has finished, you can view the AutoML leaderboard by executing
    the following command:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'You should get the following leaderboard:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 11.1 – AutoML leaderboard for extracting MOJOs ](img/B17298_11_001.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
- en: Figure 11.1 – AutoML leaderboard for extracting MOJOs
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: 'You can use `aml.leader` to get the leader model of the AutoML training. All
    models have an inbuilt function, `download_mojo()`, that extracts and downloads
    the model MOJO file:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This should download the model MOJO to your device. You can also download a
    specific model from the leaderboard using `model_id`. Let’s download the DRF model,
    which is ranked fourth on the leaderboard. Execute the following command:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You can also specify the path where you want the MOJO file to be downloaded
    by passing the `path` parameter, along with the location, to the `download_mojo()`
    function. You can also download `h2o-genmodel.jar`, along with the MOJO file,
    by passing `get_genmodel_jar` as `True` in the `download_mojo()` function.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: Let’s see how we can do the same in the R programming language.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: Extracting H2O models as MOJOs in R
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Similar to how we can extract a model from the AutoML leaderboard in Python,
    we can do the same in the R programming language. We shall use the same Iris flower
    dataset again to train models using H2O AutoML and then extract the leader model
    to download it as a POJO. Follow these steps:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: 'Import the `h2o` module and spin up your H2O server:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Import the dataset by passing the location of the dataset in your system. Execute
    the following command:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Set the feature and label names by executing the following commands:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Trigger AutoML by passing the training dataset, the feature columns, and the
    label columns as parameters. Also, set `max_models` to `10` and the `seed` value
    to `5`:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Once training has finished and you have the leaderboard, you can access the
    leader model using `aml@leaderboard`. Using the same command, we can download
    the leader model as a MOJO, like so:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: This will start downloading the model MOJO ZIP file to your device. Similar
    to Python, in R, you can specify the download path as well as set the `get_genmodel_jar`
    parameter to *True* to download the `h2o-genmodel.jar` file, along with the MOJO
    ZIP file.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know how to extract a model MOJO in the R programming language,
    let’s learn how to do the same in H2O Flow.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: Extracting H2O models as MOJOs in H2O Flow
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Downloading model MOJOs in H2O Flow is just as easy as it was with POJOs. Right
    beside the **Download POJO** button, you have another button to download MOJO
    models.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: As you learned in [*Chapter 2*](B17298_02.xhtml#_idTextAnchor038), *Working
    with H2O Flow (H2O’s Web UI)*, in the *Working with Model Training Functions in
    H2O Flow* section, you can access specific model information.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Actions** subsection, you have an interactive button titled **Model
    Deployment Package (MOJO)**, as shown in the following screenshot:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 11.2 – The Download Model Deployment Package (MOJO) button ](img/B17298_11_002.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
- en: Figure 11.2 – The Download Model Deployment Package (MOJO) button
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: Simply clicking on this button will download the model as a MOJO. All models
    can be downloaded this way by using this interactive button in H2O Flow.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: Unlike POJOs, where you have a single Java file, MOJOs can be downloaded as
    **ZIP files** that contain a collection of certain **configuration settings**,
    among other files. You can extract and explore these files if you wish, but from
    an implementation perspective, we will be using the whole ZIP file and using it
    in our services.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: But regardless of the difference between the type of file, whether it is a Java
    file or a ZIP file, `h2o-genmodel.jar` has interpreters and readers for both types
    of files that you can use to read the models and make predictions.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have extracted the model MOJO, let’s explore a special feature in
    MOJOs where we can graphically view the contents of a trained model.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: Viewing model MOJOs
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can view MOJO models as simple human-readable graphs by using a Java tool
    called **Graphviz**. Graphviz is a piece of visualization software that is used
    for graphically visualizing structural information in the form of diagrams or
    graphs. It is a handy tool that is often used to show technical details in networks,
    web designs, and ML as simple images.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: 'You can install the Graphviz library in different operating systems, as follows:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: '**Linux**: You can download the library by just running the following command
    in your Terminal:'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '`brew` to install this library in your Mac system. Execute the following command
    in your Mac Terminal:'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '**Windows**: Graphviz has a Windows installer that you can download from http://www.graphviz.org/download/.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Once you have installed Graphviz, you can view the model graphically by using
    the `PrintMojo` function from the Terminal to make a **PNG file**.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s try it out. Execute the following steps:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: Once you have downloaded your model MOJO file and installed Graphviz, you will
    need the `h2o.jar` file to be in the same path to access the `printMojo()` function
    in the `hex` class. You can download the `h2o.jar` file from http://h2o-release.s3.amazonaws.com/h2o/rel-zumbo/2/index.xhtml.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once your files are ready, open your Terminal in the same directory and execute
    the following command:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: We are using the DRF model we downloaded from the experiment we did in the *Extracting
    H2O model as MOJO in Python* section. This command generates a `model.gv` file
    that the Graphviz visualization tool can use to visualize the model.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, use the Graphviz tool to build a PNG file using the `model.gv` file. Execute
    the following code:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This generates the `model.png` file.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, open the `model.png` file; you should see an image of the model. The model
    should look as follows:'
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 11.3 – Model image generated from MOJO using Graphviz ](img/B17298_11_003.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
- en: Figure 11.3 – Model image generated from MOJO using Graphviz
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: The preceding diagram is a nice graphical representation of how the decision
    tree of the `PrintMojo` function without needing the Graphviz library. However,
    this option is only available in Java 8 and higher versions.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: Let’s try using the `PrintMojo` function to generate the model image. Execute
    the steps in sequence to generate an image of the model without using Graphviz.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Similar to the previous experiment, where we printed the model MOJO using Graphviz,
    make sure that you have downloaded the model MOJO and copied it into a directory,
    along with your `h2o.jar` file. Now, open a Terminal in the same folder and execute
    the following command:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The output of this command should generate a `tree.png` folder with images
    of the decision tree inside it. The diagram should look as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 11.4 – Graphical images for class Iris-setosa using PrintMojo without
    Graphviz ](img/B17298_11_004.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
- en: Figure 11.4 – Graphical images for class Iris-setosa using PrintMojo without
    Graphviz
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: Since we were using an ML model that has been trained on the Iris dataset, we
    have a multinomial classification model. Thus, inside the `tree.png` file, you
    will have individual images for every class – one for `Iris-setosa`, one for `Iris-virginica`,
    and one for `Iris-versicolor`.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: Note that this feature is only available for tree-based algorithms such as DRF,
    GBM, and XGBoost. Linear models such as GLM and deep learning models are not supported
    for viewing.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know how to view the models from model MOJOs, let’s learn how to
    use MOJOs to make predictions.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: Using H2O AutoML model MOJOs to make predictions
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Making predictions using MOJOs is the same as how we make predictions using
    model POJOS, albeit with some minor changes. Similar to POJOs, there is a dependency
    on the `h2o-genmodel.jar` file to compile and run the model MOJO to make predictions.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: So, let’s go ahead and quickly run an experiment where we can use the model
    MOJO with the `h2o-genmodel.jar` file to make predictions. We shall write a Java
    program that imports the `h2o-genmodel.jar` file and uses its classes to load
    and use our model MOJO to make predictions.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: So, let’s start by creating a folder where we can keep the H2O MOJO file needed
    for the experiment and then write some code that uses it.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these steps:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: 'Open your Terminal and create an empty folder by executing the following command:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Now, copy your model MOJO file to the folder by executing the following command:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Make sure that you change the name of the model MOJO, `DRF_1_AutoML_7_20220622_170835.zip`,
    to the model MOJO you are using.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, you need to download the `h2o-genmodel.jar` file. As you learned in [*Chapter
    10*](B17298_10.xhtml#_idTextAnchor196), *Working with Plain Old Java Objects (POJOs)*,
    there are two ways that you can do this. Either you can download the `h2o-genmodel.jar`
    file from your currently running local H2O server or, if you are working on a
    `h2o-genmodel`, as follows:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The Maven repository for this can be found here: https://mvnrepository.com/artifact/ai.h2o/h2o-genmodel.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s create the Java program that will be making predictions using the
    model MOJO. Create a Java program called `main.java` by executing the following
    command in your Terminal:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This should open the `vim` editor, where you can write your code.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s start writing our Java program:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'First, import the necessary dependencies, as follows:'
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Then, create the `main` class, as follows:'
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Then, inside the `main` class, create a `main` function, as follows:'
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE24]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Inside this `main` function, create the `EasyPredictModelWrapper` object by
    loading the MOJO model using the `MojoModel.load()` function and passing the location
    of your model MOJO. The code for this is as follows:'
  id: totrans-136
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE25]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Now that we have our model MOJO loaded and wrapped in `EasyPredictModelWrapper`,
    let’s create the sample data that we will use for making predictions. Add the
    following code to your file:'
  id: totrans-138
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE26]'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Similar to how we did when making predictions using model POJOs, we need a
    prediction handler to store the prediction results from the model MOJOs. The prediction
    handler that’s used for POJOs also works with MOJOs. So, let’s create an appropriate
    multinomial prediction handler object, as follows:'
  id: totrans-140
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Now, let’s add the necessary `print` statements so that we have a clean and
    easy way to understand the output. Add the following `print` statements:'
  id: totrans-142
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '`predictionResultHandler.label` will contain the predicted label value.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s also print out the different class probabilities. Add the following code:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE29]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Make sure all your braces are closed correctly and save the file.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once your file is ready, just compile the file by executing the following command:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE30]'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Once the compilation is successful, execute the compiled file by running the
    following command in your Terminal:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE31]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'You should get the following output:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 11.5 – Prediction results from the H2O model MOJO implementation ](img/B17298_11_005.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
- en: Figure 11.5 – Prediction results from the H2O model MOJO implementation
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, using the model MOJO is just as easy as using POJOs. Both are
    easy to extract and use in production. However, MOJOs benefit from being smaller
    and faster for large-sized models, which gives them a slight edge compared to
    POJOs.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: Congratulations! You now know how to build, extract, and deploy model MOJOs
    to make predictions.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we started by understanding what the drawbacks of POJOs are.
    Then, we learned that H2O created a counterpart to POJOs called MOJOs, which do
    not have the same issues that POJOs have. Then, we learned what MOJOs are and
    the benefits of using them over POJOs. We learned that MOJOs are smaller and faster
    than POJOs. In H2O’s internal experimentation, it was found that MOJOs performed
    better when working with large ML models.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: After that, we learned how to practically extract ML models trained using AutoML
    as MOJOs. We understood how MOJOs can be downloaded in Python, R, and H2O Flow.
    Another benefit that we came across with MOJOs was that there is a special function
    called `PrintMojo` that can be used to create graphical pictures of ML models
    that can be read by humans. This also makes understanding the contents of the
    ML model easy.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我们学习了如何实际地将使用AutoML训练的机器学习模型提取为MOJOs。我们了解了如何在Python、R和H2O Flow中下载MOJOs。我们还发现MOJOs的一个好处是存在一个名为`PrintMojo`的特殊函数，它可以用来创建人类可读的机器学习模型的图形化图片。这也使得理解机器学习模型的内容变得容易。
- en: Building on top of this knowledge, we implemented an experiment where we used
    the `h2o-genmodel.jar` file, along with the model MOJO, to make predictions on
    sample data, thus helping us get a better understanding of how we can use MOJOs
    in production.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个知识的基础上，我们实施了一个实验，在该实验中，我们使用了`h2o-genmodel.jar`文件以及模型MOJO，对样本数据进行预测，从而帮助我们更好地理解如何在生产环境中使用MOJOs。
- en: In the next chapter, we shall explore the various design patterns that we can
    use to implement H2O AutoML. This will help us understand how to implement ideal
    ML solutions using H2O AutoML.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨我们可以用来实现H2O AutoML的各种设计模式。这将帮助我们理解如何使用H2O AutoML实现理想的机器学习解决方案。
