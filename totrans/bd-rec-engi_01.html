<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Introduction to Recommendation Engines" id="aid-DB7S1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Introduction to Recommendation Engines</h1></div></div></div><p>How do we buy things? How do we make decisions in our day-to-day lives? We ask our friends or relatives for suggestions before making decisions. When it comes to making decisions online about buying products, we read reviews about the products from anonymous users, compare the products' specifications with other similar products and then we make our decisions to buy or not. In an online world, where information is growing at an exponential rate, looking for valid information will be a challenge. Buying the confidence of the user for the search results will be a much more challenging task. Recommender systems come to our rescue to provide relevant and required information.</p><p>The popularity of implementing recommendation engines comes as a result of their successful implementation by big players on the Internet. Some real-world examples include suggestions for products on Amazon, friends' suggestions on social applications such as Facebook, Twitter, and LinkedIn, video recommendations on YouTube, news recommendations on Google News, and so on. These successful implementations of recommendation engines have shown the way for other areas such as the travel, healthcare, and banking domains.</p><div class="section" title="Recommendation engine definition"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec7"/>Recommendation engine definition</h1></div></div></div><p>Recommendation engines, a branch of information retrieval and artificial intelligence, are powerful tools and techniques to analyze huge volumes of data, especially product information and user information, and then provide relevant suggestions based on data-mining approaches.</p><p>In technical terms, a recommendation engine problem is <span class="emphasis"><em>to develop a mathematical model or objective function which can predict how much a user will like an item</em></span>.</p><p>If <span class="emphasis"><em>U = {users}</em></span>, <span class="emphasis"><em>I = {items}</em></span> then <span class="emphasis"><em>F = Objective function</em></span> and measures the usefulness of item <span class="emphasis"><em>I</em></span> to user <span class="emphasis"><em>U</em></span>, given by:</p><div class="mediaobject"><img src="../Images/image00202.jpeg" alt="Recommendation engine definition"/></div><p style="clear:both; height: 1em;"> </p><p>Where <span class="emphasis"><em>R = {recommended items}</em></span>.</p><p>For each user <span class="emphasis"><em>u</em></span>, we want to choose the item <span class="emphasis"><em>i</em></span> that maximizes the objective function:</p><div class="mediaobject"><img src="../Images/image00203.jpeg" alt="Recommendation engine definition"/></div><p style="clear:both; height: 1em;"> </p><p>The main goal of recommender systems is to provide relevant suggestions to online users to make better decisions from many alternatives available over the Web. A better recommender system is directed more toward personalized recommendations by taking into consideration the available digital footprint of the user, such as user-demographic information, transaction details, interaction logs, and information about a product, such as specifications, feedback from users, comparison with other products, and so on, before making recommendations:</p><div class="mediaobject"><img src="../Images/image00204.jpeg" alt="Recommendation engine definition"/><div class="caption"><p>Pic credits: toptal</p></div></div><p style="clear:both; height: 1em;"> </p><p>Building a good recommendation engine poses challenges to both the actors of the system, namely, the consumers and sellers. From a consumer perspective, receiving relevant suggestions from a trusted source is critical for decision making. So the recommendation engine needs to build in such a way that it buys the confidence of the consumers. From a seller perspective, generating relevant recommendations to consumers at a personalized level is more important. With the rise of online sales, the big players are now collecting large volumes of transactional interaction logs of users to analyze the user behaviors more deeply than ever. Also, the need to recommend in real time is adding to the challenge. With advancements in technology and research, recommendation engines are evolving to overcome these challenges based on big-data analysis and artificial intelligence. The following diagram illustrates how organizations employ recommendation engines:</p><div class="mediaobject"><img src="../Images/image00205.jpeg" alt="Recommendation engine definition"/></div><p style="clear:both; height: 1em;"> </p></div></div>
<div class="section" title="Need for recommender systems" id="aid-E9OE1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec8"/>Need for recommender systems</h1></div></div></div><p>Given the complexity and challenges in building recommendation engines, a considerable amount of thought, skill, investment, and technology goes into building recommender systems. Are they worth such an investment? Let us look at some facts:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Two-thirds of movies watched by Netflix customers are recommended movies</li><li class="listitem">38% of click-through rates on Google News are recommended links</li><li class="listitem">35% of sales at Amazon arise from recommended products</li><li class="listitem">ChoiceStream claims that 28% of people would like to buy more music, if they find what they like</li></ul></div></div>
<div class="section" title="Big data driving the recommender systems" id="aid-F8901"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec9"/>Big data driving the recommender systems</h1></div></div></div><p>Of late, recommender systems are successful in impacting our lives in many ways. One such obvious example of this impact is how our online shopping experience has been redefined. As we browse through e-commerce sites and purchase products, the underlying recommendation engines respond immediately, in real time, with various relevant suggestions to consumers. Regardless of the perspective, from business player or consumer, recommendation engines have been immensely beneficial. Without a doubt, big data is the driving force behind recommender systems. A good recommendation engine should be reliable, scalable, highly available, and be able to provide personalized recommendations, in real time, to the large user base it contains.</p><p>A typical recommendation system cannot do its job efficiently without sufficient data. The introduction of big data technology enabled companies to capture plenty of user data, such as past purchases, browsing history, and feedback information, and feed it to the recommendation engines to generate relevant and effective recommendations in real time. In short, even the most advanced recommender system cannot be effective without the supply of big data. The role of big data and improvements in technology, both on the software and hardware front, goes beyond just supplying massive data. It also provides meaningful, actionable data fast, and provides the necessary setup to quickly process the data in real time.</p><p>Source: <a class="ulink" href="http://www.kdnuggets.com/2015/10/big-data-recommendation-systems-change-lives.html">http://www.kdnuggets.com/2015/10/big-data-recommendation-systems-change-lives.html</a>.</p></div>
<div class="section" title="Types of recommender systems"><div class="titlepage" id="aid-G6PI2"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Types of recommender systems</h1></div></div></div><p>Now that we have defined recommender systems, their objective, usefulness, and the driving force behind recommender systems, in this section, we introduce different types of popular recommender systems in use.</p><div class="section" title="Collaborative filtering recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec6"/>Collaborative filtering recommender systems</h2></div></div></div><p>Collaborative filtering recommender systems are basic forms of recommendation engines. In this type of recommendation engine, filtering items from a large set of alternatives is done collaboratively by users' preferences.</p><p>The basic assumption in a collaborative filtering recommender system is that if two users shared the same interests as each other in the past, they will also have similar tastes in the future. If, for example, user A and user B have similar movie preferences, and user A recently watched <span class="emphasis"><em>Titanic,</em></span> which user B has not yet seen, then the idea is to recommend this unseen new movie to user B. The movie recommendations on Netflix are one good example of this type of recommender system.</p><p>There are two types of collaborative filtering recommender systems:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>User-based collaborative filtering</strong></span>: In user-based collaborative filtering, recommendations are generated by considering the preferences in the user's neighborhood. User-based collaborative filtering is done in two steps:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Identify similar users based on similar user preferences</li><li class="listitem">Recommend new items to an active user based on the rating given by similar users on the items not rated by the active user.</li></ul></div></li><li class="listitem"><span class="strong"><strong>Item-based collaborative filtering</strong></span>: In item-based collaborative filtering, the recommendations are generated using the neighbourhood of items. Unlike user-based collaborative filtering, we first find similarities between items and then recommend non-rated items which are similar to the items the active user has rated in past. Item-based recommender systems are constructed in two steps:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Calculate the item similarity based on the item preferences</li><li class="listitem">Find the top similar items to the non-rated items by active user and recommend them</li></ul></div></li></ul></div><p>We will learn in depth about these two forms of recommendations in <a class="link" title="Chapter 3. Recommendation Engines Explained" href="part0022.xhtml#aid-KVCC1">Chapter 3</a>, <span class="emphasis"><em>Recommendation Engines Explained</em></span>.</p><p>While building collaborative filtering recommender systems, we will learn about the following aspects:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">How to calculate the similarity between users?</li><li class="listitem">How to calculate the similarity between items?</li><li class="listitem">How recommendations are generated?</li><li class="listitem">How to deal with new items and new users whose data is not known?</li></ul></div><p>The advantage of collaborative filtering systems is that they are simple to implement and very accurate. However, they have their own set of limitations, such as the <span class="emphasis"><em>Cold Start</em></span> problem, which means, collaborative filtering systems fails to recommend to the first-time users whose information is not available in the system:</p><div class="mediaobject"><img src="../Images/image00206.jpeg" alt="Collaborative filtering recommender systems"/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="Content-based recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec7"/>Content-based recommender systems</h2></div></div></div><p>In collaborative filtering, we consider only user-item-preferences and build the recommender systems. Though this approach is accurate, it makes more sense if we consider user properties and item properties while building recommendation engines. Unlike in collaborative filtering, we use item properties and user preferences to the item properties while building content-based recommendation engines.</p><p>As the name indicates, a content-based recommender system uses the content information of the items for building the recommendation model. A content recommender system typically contains a user-profile-generation step, item-profile-generation step- and model-building step to generate recommendations for an active user. The content-based recommender system recommends items to users by taking the content or features of items and user profiles. As an example, if you have searched for videos of Lionel Messi on YouTube, then the content-based recommender system will learn your preference and recommend other videos related to Lionel Messi and other videos related to football.</p><p>In simpler terms, the system recommends items similar to those that the user has liked in the past. The similarity of items is calculated based on the features associated with the other compared items and is matched with the user's historical preferences.</p><p>While building a content-based recommendation system, we take into consideration the following questions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">How do we choose content or features of the products?</li><li class="listitem">How do we create user profiles with preferences similar to that of the product content?</li><li class="listitem">How do we create similarity between items based on their features?</li><li class="listitem">How do we create and update user profiles continuously?</li></ul></div><p>The preceding considerations will be explained in <a class="link" title="Chapter 3. Recommendation Engines Explained" href="part0022.xhtml#aid-KVCC1">Chapter 3</a>, <span class="emphasis"><em>Recommendation Engines Explained</em></span>. This technique doesn't take into consideration the user's neighborhood preferences. Hence, it doesn't require a large user group's preference for items for better recommendation accuracy. It only considers the user's past preferences and the properties/features of the items. In <a class="link" title="Chapter 3. Recommendation Engines Explained" href="part0022.xhtml#aid-KVCC1">Chapter 3</a>, <span class="emphasis"><em>Recommendation Engines Explained</em></span>, we will learn about this system in detail, and also its pros and cons:</p><div class="mediaobject"><img src="../Images/image00207.jpeg" alt="Content-based recommender systems"/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="Hybrid recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec8"/>Hybrid recommender systems</h2></div></div></div><p>This type of recommendation engine is built by combining various recommender systems to build a more robust system. By combining various recommender systems, we can replace the disadvantages of one system with the advantages of another system and thus build a more robust system. For example, by combining collaborative filtering methods, where the model fails when new items don't have ratings, with content-based systems, where feature information about the items is available, new items can be recommended more accurately and efficiently.</p><p>For example, if you are a frequent reader of news on Google News, the underlying recommendation engine recommends news articles to you by combining popular news articles read by people similar to you and using your personal preferences, calculated using your previous click information. With this type of recommendation system, collaborative filtering recommendations are combined with content-based recommendations before pushing recommendations.</p><p>Before building a hybrid model, we should consider the following questions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">What recommender techniques should be combined to achieve the business solution?</li><li class="listitem">How should we combine various techniques and their results for better predictions?</li></ul></div><p>The advantage of hybrid recommendation engines is that this approach will increase the efficiency of recommendations compared to the individual recommendation techniques. This approach also suggests a good mix of recommendations to the users, both at the personalized level and at the neighborhood level. In <a class="link" title="Chapter 3. Recommendation Engines Explained" href="part0022.xhtml#aid-KVCC1">Chapter 3</a>, <span class="emphasis"><em>Recommendation Engines Explained</em></span>, we will learn more about hybrid recommendations:</p><div class="mediaobject"><img src="../Images/image00208.jpeg" alt="Hybrid recommender systems"/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="Context-aware recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec9"/>Context-aware recommender systems</h2></div></div></div><p>Personalized recommender systems, such as content-based recommender systems, are inefficient; they fail to suggest recommendations with respect to context. For example, assume a lady is very fond of ice-cream. Also assume that this lady goes to a cold place. Now there is high chance that a personalized recommender system suggests a popular ice-cream brand. Now let us ask our self a question: is it the right thing to suggest an ice-cream to a person in a cold place? Rather, it makes sense to suggest a coffee. This type of recommendation, which is personalized and context-aware is called a context-aware recommender systems. In the preceding example, place is the context.</p><p>User preferences may differ with the context, such as time of day, season, mood, place, location, options offered by the system, and so on. A person at a different location at a different time with different people may need different things. A context-aware recommender system takes the context into account before computing or serving recommendations. This recommender system caters for the different needs of people differently in different contexts.</p><p>Before building a context-aware model, we should consider the following questions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">How should we define the contexts to be used in the recommender system?</li><li class="listitem">What techniques should be used to build recommendations to achieve the business solution?</li><li class="listitem">How do we extract context the preferences of the users with respect to the products?</li><li class="listitem">What techniques should we use to combine the context preferences with user-profile preferences to generate recommendations?<div class="mediaobject"><img src="../Images/image00209.jpeg" alt="Context-aware recommender systems"/></div><p style="clear:both; height: 1em;"> </p></li></ul></div><p>The preceding image shows how different people, at different times and places, and with different company, need different dress recommendations.</p></div></div>
<div class="section" title="Evolution of recommender systems with technology" id="aid-H5A41"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Evolution of recommender systems with technology</h1></div></div></div><p>With the advancements in technology, research, and infrastructure, recommender systems have been evolving rapidly. Recommender systems are moving away from simple similarity-measure-based approaches, to machine-learning approaches, to very advanced approaches such as deep learning. From a business angle, both customers and organizations are looking toward more personalized recommendations to be catered for immediately. Building personalized recommenders to cater to the large user base and products, we need sophisticated systems, which can scale easily and respond fast. The following are the types of recommendations that can help solve this challenge.</p><div class="section" title="Mahout for scalable recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Mahout for scalable recommender systems</h2></div></div></div><p>As stated earlier, big data primarily drives recommender systems. The big-data platforms enabled researchers to access large datasets and analyze data at the individual level, paving paths for building personalized recommender systems. With increase in Internet usage and a constant supply of data, efficient recommenders not only require huge data, but also need infrastructure which can scale and have minimum downtime. To realize this, big-data technology such as the Apache Hadoop ecosystem provided the infrastructure and platform to supply large data. To build recommendation systems on this huge supply of data,<span class="strong"><strong> Mahout</strong></span>, a machine-learning library built on the Hadoop platform enables us to build scalable recommender systems. Mahout provides infrastructure to build, evaluate, and tune the different types of recommendation-engine algorithms. Since Hadoop is designed for offline batch processing, we can build offline recommender systems, which are scalable. In <a class="link" title="Chapter 9. Building Scalable Recommendation Engines with Mahout" href="part0063.xhtml#aid-1S2JE1">Chapter 9</a>, <span class="emphasis"><em>Building Scalable Recommendation Engines with Mahout</em></span>, we further see how to build scalable recommendation engines using Mahout.</p><p>The following figure displays how a scalable recommender system can be designed using Mahout:</p><div class="mediaobject"><img src="../Images/image00210.jpeg" alt="Mahout for scalable recommender systems"/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="Apache Spark for scalable real-time recommender systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Apache Spark for scalable real-time recommender systems</h2></div></div></div><p>We have seen many times, on any of the e-commerce sites, the <span class="emphasis"><em>You may also like</em></span> feature. This is a deceptively simple phrase that encapsulates a new era in customer relationship management delivered in real time. Business organizations started investing in such systems, which can generate recommendations personalized to the customers and can deliver them in real time. Building such a system will not only give good returns on investment but also, efficient systems will buy the confidence of the users. Building a scalable real-time recommender system will not only capture users' purchase history, product information, user preferences, and extract patterns and recommend products, but will also respond instantly based on user online interactions and multi-criteria search preferences.</p><p>This ability makes compelling suggestions requiring a new generation of technology. This technology has to consider large databases of users' previous purchasing history, their preferences, and online interaction information such as in-page navigation data and multi-criteria searches, and then analyzes all this information in real time and responds accurately according to the current and long-term needs of the users. In this book, we have considered in-memory and graph-based systems, which are capable of handling large-scale, real-time recommender systems.</p><p>Most popular recommendation engine collaborative filtering requires considering the entirety of users and product information while generating recommendations. Assume a scenario where we have 1 million user ratings on 10,000 products. In order to build a system to handle such heavy computations and respond online, we require a system that is big-data compatible and processes data in-memory. The key technology in enabling scalable, real-time recommendations is Apache Spark Streaming, a technology that leverages scalability of big data and generates recommendations in real time, and processes data in-memory:</p><div class="mediaobject"><img src="../Images/image00211.jpeg" alt="Apache Spark for scalable real-time recommender systems"/></div><p style="clear:both; height: 1em;"> </p><div class="section" title="Neo4j for real-time graph-based recommender systems"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec0"/>Neo4j for real-time graph-based recommender systems</h3></div></div></div><p>Graph databases have revolutionized the way people discover new products, information, and so on. In the human mind, we remember people, things, places, and so on, as graphs, relations, and networks. When we try to fetch information from these networks, we directly go to a required connection or graph and fetch information accurately. In a similar fashion, graph databases allow us to store user and product information in graphs as nodes and edges (relations). Searching in a graph database is fast. In recent times, recommender systems powered by graph databases have allowed organizations to build suggestions which are personalized and accurate in real time.</p><p>One of the key technologies enabling real-time recommendations using graph databases is Neo4j, a kind of NoSQL graph database that can easily outperform any other relational and NoSQL system in providing customer insights and product trends.</p><p>A NoSQL database, popularly known as <span class="emphasis"><em>not only SQL</em></span>, provides a new way of storing and managing data other than in relational format that is row and columns such as columnar, graph, key-value pair store of data. This new way of storing and managing data enables us to build scalable and real-time systems.</p><p>A graph database mainly consists of nodes and edges, wherein nodes represent the entities and edges the relations between them. The edges are directed lines or arrows that connect the nodes. In the preceding image, the circles are the nodes, which represent the entities, and the lines connecting the nodes are called edges, which represent relationships. The orientation of arrows follows the flow of information. By presenting all nodes and links of the graph, it helps users to have a global view of the structure.</p><p>The following image shows user-movie-rating information representation in graph form. Green and red circles indicate nodes representing users and movies, respectively. The ratings given by users to movies are represented as edges showing the relationship between users and movies. Each node and relation may contain properties to store further details of the data.</p><p>On this graph representation, we apply concepts of graph theory to generate recommendations in real time, as the retrieval and searching is very fast. In <a class="link" title="Chapter 8.  Building Real-Time Recommendations with Neo4j" href="part0057.xhtml#aid-1MBG21">Chapter 8</a>, <span class="emphasis"><em>Building Real Time Recommendation Engines with Neo4j</em></span>, we deal with building real-time recommendation engines using Neo4j:</p><div class="mediaobject"><img src="../Images/image00212.jpeg" alt="Neo4j for real-time graph-based recommender systems"/></div><p style="clear:both; height: 1em;"> </p></div></div></div>
<div class="section" title="Summary" id="aid-I3QM1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Summary</h1></div></div></div><p>In this chapter, we got introduced to various types of popular recommendation engines such as collaborative filtering, content-based recommendation engines, hybrid recommenders, context-aware systems, scalable recommenders, and graph-based, real-time recommenders.</p><p>We also learned how big data is fuelling the rise of recommendation engines and some real-world use-cases employed by major IT giants. In <a class="link" title="Chapter 3. Recommendation Engines Explained" href="part0022.xhtml#aid-KVCC1">Chapter 3</a>, <span class="emphasis"><em>Recommendation Engines Explained</em></span>, we will learn more about these recommendations in detail. In <a class="link" title="Chapter 2. Build Your First Recommendation Engine" href="part0020.xhtml#aid-J2B82">Chapter 2</a>, <span class="emphasis"><em>Build Your First Recommendation Engine</em></span>, we learn how to build a basic recommendation engine using R.</p></div></body></html>