["```py\n    CREATE OR REPLACE TABLE `09_recommendation_engine.all_ga_sessions` AS\n    SELECT * FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`;\n    ```", "```py\n    SELECT * FROM `09_recommendation_engine.all_ga_sessions`\n    TABLESAMPLE SYSTEM (10 PERCENT);\n    ```", "```py\nCREATE OR REPLACE TABLE `09_recommendation_engine.product_purchases` AS\nSELECT    fullVisitorId,\n          hits_product.productSKU AS purchased_product_id,\n          COUNT(hits_product.productSKU) AS quantity\nFROM\n          `09_recommendation_engine.all_ga_sessions`,\n          UNNEST(hits) AS hits,\n          UNNEST(hits.product) AS hits_product\nWHERE fullVisitorId IN (\n                         SELECT fullVisitorId\n                         FROM\n                `09_recommendation_engine.all_ga_sessions`,\n                         UNNEST(hits) AS hits\n                         WHERE \n                     hits.eCommerceAction.action_type = '6'\n                         GROUP BY fullVisitorId\n                          )\nGROUP BY fullVisitorId, purchased_product_id;\n```", "```py\nCREATE OR REPLACE MODEL `09_recommendation_engine.purchase_recommender`\nOPTIONS(model_type='matrix_factorization',\n        user_col='fullVisitorID',\n        item_col='purchased_product_id',\n        rating_col='quantity',\n        feedback_type='implicit'\n        )\nAS\nSELECT fullVisitorID, purchased_product_id, quantity \nFROM `09_recommendation_engine.product_purchases`; \n```", "```py\nSELECT\n  *\nFROM\n  ML.EVALUATE(MODEL `09_recommendation_engine.recommender`,\n    (\n    SELECT * FROM `09_recommendation_engine.product_visits`));\n```", "```py\nCREATE OR REPLACE TABLE `09_recommendation_engine.product_recommendations` AS\n    SELECT\n      DISTINCT fullVisitorID, purchased_product_id, predicted_quantity_confidence\n    FROM\n      ML.RECOMMEND(MODEL`09_recommendation_engine.purchase_recommender`,\n        (\n        SELECT\n          fullVisitorID\n        FROM\n          `09_recommendation_engine.product_purchases` ));\n```", "```py\nSELECT *\nFROM\n    `09_recommendation_engine.product_recommendations`\nORDER BY predicted_quantity_confidence DESC\nLIMIT 100;\n```"]