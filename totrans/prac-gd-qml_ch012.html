<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch012.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="11" id="chapter-4-adiabatic-quantum-computing-and-quantum-annealing">
<h1 class="H1---Chapter chapterHead" data-number="11"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></span><br/>
<span id="x1-750004"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Adiabatic Quantum Computing and Quantum Annealing</span></span></h1>
<div class="flushright">
<p><em><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">Love’s a different sort of thing, hot enough to make you flow into</span></em> <em><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">something, interflow, cool and anneal and be a weld stronger than</span></em> <em><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">what you started with.</span></em><br/><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">
— Theodore Sturgeon</span></p>
</div>
<p><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">In the previous chapter, we studied how to formulate different combinatorial optimization problems as QUBO instances that, in turn, could be rewritten as the optimization problem of finding a state with minimum energy in an Ising model system. </span><span class="koboSpan" id="kobo.7.2" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we will use this fact to introduce a way of </span><span id="dx1-75001"/><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">using </span><strong><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealers</span></strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml"> — a special type of quantum computer — to try to find (approximate) solutions to those combinatorial optimization problems.</span></p>
<p><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">But, in order to do that, we first need to talk a little bit more about Hamiltonians and their ground states, as well as the central role they play in adiabatic quantum computing.</span></p>
<p><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">The topics that we will cover in this chapter are as follows:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">Adiabatic quantum computing</span></p></li>
<li><p><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Quantum annealing</span></p></li>
<li><p><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">Using Ocean to formulate and transform optimization problems</span></p></li>
<li><p><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">Solving optimization problems on quantum annealers with Leap</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">Here we go!</span></p>
<section class="level2 sectionHead" data-number="11.1" id="adiabatic-quantum-computing">
<h1 class="sectionHead" data-number="11.1"><span class="titlemark"><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">4.1 </span></span> <span id="x1-760004.1"><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">Adiabatic quantum computing</span></span></h1>
<p><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch008.xhtml#x1-180001"><em><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">1</span></em></a><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Foundations of Quantum Computing</span></em><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">, we focused mainly on quantum circuits but we briefly mentioned that there were other equivalent quantum computing models. </span><span class="koboSpan" id="kobo.25.2" xmlns="http://www.w3.org/1999/xhtml">One of them is </span><span id="dx1-76001"/><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">adiabatic quantum computing, introduced in 2000 by Farhi, Goldstone, Gutmann, and Sipser in a widely influential paper </span><span class="cite"><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xfarhi2000quantum"><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">36</span></a><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">When using quantum circuits, we apply operations (our beloved quantum gates) through discrete, sequential steps. </span><span class="koboSpan" id="kobo.31.2" xmlns="http://www.w3.org/1999/xhtml">However, adiabatic quantum computing relies on the use of continuous transformations. </span><span class="koboSpan" id="kobo.31.3" xmlns="http://www.w3.org/1999/xhtml">Namely, we will use a Hamiltonian </span><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t)" class="math inline" src="../media/file541.png" style="vertical-align:middle" title="H(t)"/></span><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml"> that will vary with time and that will be the driving force to change the state of our qubits according to the time-dependent Schrödinger equation:</span></p>
<p><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t)\left| {\psi(t)} \right\rangle = i\hslash\frac{\partial}{\partial t}\left| {\psi(t)} \right\rangle." class="math display" src="../media/file542.png" style="vertical-align:middle" title="H(t)\left| {\psi(t)} \right\rangle = i\hslash\frac{\partial}{\partial t}\left| {\psi(t)} \right\rangle."/></span></p>
<div class="tcolorbox learnmore" id="tcolobox-88">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">As you may remember, in </span><em><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch008.xhtml#x1-180001"><em><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">1</span></em></a><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">Foundations of Quantum</span></em> <em><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">Computing</span></em><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">, we talked about the </span><strong><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">time-independent</span></strong><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml"> Schrödinger equation. </span><span class="koboSpan" id="kobo.45.2" xmlns="http://www.w3.org/1999/xhtml">In that case, the Hamiltonian — which you can think of as a </span><span id="dx1-76002"/><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">mathematical object that can describe the energy of the system — remained unchanged throughout the process. </span><span class="koboSpan" id="kobo.46.2" xmlns="http://www.w3.org/1999/xhtml">Now, we’ll consider situations in which this energy can vary with time. </span><span class="koboSpan" id="kobo.46.3" xmlns="http://www.w3.org/1999/xhtml">This is the case, for instance, if you are applying an electromagnetic pulse to your qubits and you change its intensity or its frequency.</span></p>
<p><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">The terms in this equation are the time-dependent Hamiltonian </span><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t)" class="math inline" src="../media/file541.png" style="vertical-align:middle" title="H(t)"/></span><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">, the state vector of the system </span><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\psi(t)} \right\rangle" class="math inline" src="../media/file47.png" style="vertical-align:middle" title="\left| {\psi(t)} \right\rangle"/></span><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">, the imaginary unit </span><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i" class="math inline" src="../media/file49.png" style="vertical-align:middle" title="i"/></span><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"> (defined by </span><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i^{2} = - 1" class="math inline" src="../media/file543.png" style="vertical-align:middle" title="i^{2} = - 1"/></span><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">), and the reduced Planck’s constant </span><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\hslash" class="math inline" src="../media/file50.png" style="vertical-align:middle" title="\hslash"/></span><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">In addition to using time-dependent Hamiltonians, there is another ingredient that we need for our new quantum computing model: the </span><span id="dx1-76003"/><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">idea of </span><strong><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">adiabatic</span></strong> <strong><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">evolution</span></strong><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.62.2" xmlns="http://www.w3.org/1999/xhtml">Roughly speaking, an adiabatic process is one in which the ”energy configuration” of the system changes ”very gently” (there are quite a few quotation marks here, aren’t there?). </span><span class="koboSpan" id="kobo.62.3" xmlns="http://www.w3.org/1999/xhtml">But…what does this have to do with quantum computing and how does it help us in finding solutions to our problems?</span></p>
<p><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">The key </span><span id="dx1-76004"/><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">observation is that we will be considering problems whose optimal solutions will correspond to minimum-energy or ground states of some Hamiltonian of an Ising model. </span><span class="koboSpan" id="kobo.64.2" xmlns="http://www.w3.org/1999/xhtml">So, if we start with our system in the ground state (for some Hamiltonian) and we evolve it adiabatically, we know that it will remain in a ground state through the whole process. </span><span class="koboSpan" id="kobo.64.3" xmlns="http://www.w3.org/1999/xhtml">We won’t be adding enough energy for the system to ”jump” to the next energy level: this is, in more ”physical” terms, to go from the ground </span><span id="dx1-76005"/><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">state to an </span><strong><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">excited state</span></strong><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.67.2" xmlns="http://www.w3.org/1999/xhtml">And we can use that to our advantage, because if we engineer the procedure so that the final Hamiltonian of the system is the one whose ground state will yield the solution to our problem, then we only need to measure the system to get the solution we are looking for.</span></p>
<div class="tcolorbox important" id="tcolobox-89">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">To put it in a nutshell, the idea behind adiabatic quantum computing is to start with a simple Hamiltonian, one for which we can easily obtain — and prepare! </span><span class="koboSpan" id="kobo.69.2" xmlns="http://www.w3.org/1999/xhtml">— the ground state, and evolve it ”carefully.” </span><span class="koboSpan" id="kobo.69.3" xmlns="http://www.w3.org/1999/xhtml">We do this so that we remain in the ground state all the time, slowly changing our system until the ground state of its Hamiltonian is the solution to our problem. </span><span class="koboSpan" id="kobo.69.4" xmlns="http://www.w3.org/1999/xhtml">And then, bang, we perform a measurement and get our result!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">Of course, the crucial thing here is how to perform the evolution to ensure that it is, indeed, adiabatic. </span><span class="koboSpan" id="kobo.70.2" xmlns="http://www.w3.org/1999/xhtml">But don’t worry, the </span><strong><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">adiabatic theorem</span></strong><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml"> has got our </span><span id="dx1-76006"/><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">backs there. </span><span class="koboSpan" id="kobo.73.2" xmlns="http://www.w3.org/1999/xhtml">This result, originally proved by Max Born and Vladimir Fock </span><span class="cite"><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xborn1928beweis"><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">18</span></a><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">, two of the fathers of quantum mechanics, says that for your process to be adiabatic, it should be slow enough. </span><span class="koboSpan" id="kobo.77.2" xmlns="http://www.w3.org/1999/xhtml">You may ask: how slow? </span><span class="koboSpan" id="kobo.77.3" xmlns="http://www.w3.org/1999/xhtml">Well, the total time should be inversely proportional to the square of the </span><strong><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">spectral</span></strong> <strong><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">gap</span></strong><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">, which is the </span><span id="dx1-76007"/><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">minimum difference in energy between the ground state and the first excited state of the Hamiltonian during the whole evolution.</span></p>
<p><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">This makes perfect intuitive sense. </span><span class="koboSpan" id="kobo.82.2" xmlns="http://www.w3.org/1999/xhtml">If there is always a big difference in energy between the ground state and the first excited state, then you can speed things up a little bit — you won’t risk jumping to the next energy level. </span><span class="koboSpan" id="kobo.82.3" xmlns="http://www.w3.org/1999/xhtml">However, if the difference is small, you’d better be careful, lest you accidentally go up a step (or several!) on the energy ladder.</span></p>
<p><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have a clear understanding of the ideas behind </span><span id="dx1-76008"/><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">adiabatic quantum computing, let’s make things a little bit more formal. </span><span class="koboSpan" id="kobo.84.2" xmlns="http://www.w3.org/1999/xhtml">Suppose that you have a problem for which </span><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml"> is the Hamiltonian whose ground state encodes the result that you want to find. </span><span class="koboSpan" id="kobo.86.2" xmlns="http://www.w3.org/1999/xhtml">For instance, </span><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml"> could be an Ising Hamiltonian that you obtained from transforming a QUBO problem. </span><span class="koboSpan" id="kobo.88.2" xmlns="http://www.w3.org/1999/xhtml">Now, imagine that your system is in the ground state of some initial Hamiltonian </span><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.90.2" xmlns="http://www.w3.org/1999/xhtml">We will soon discuss how to choose </span><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">, but for now just think that you can prepare its ground state easily enough so that it is a natural choice for you.</span></p>
<p><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">Suppose that we run the process for total time </span><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.95.2" xmlns="http://www.w3.org/1999/xhtml">The time-dependent Hamiltonian that we will consider will be of the form</span></p>
<p><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t) = A(t)H_{0} + B(t)H_{1}," class="math display" src="../media/file546.png" style="vertical-align:middle" title="H(t) = A(t)H_{0} + B(t)H_{1},"/></span></p>
<p><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml"> are real-valued functions that accept inputs over the interval </span><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lbrack 0,T\rbrack" class="math inline" src="../media/file547.png" style="vertical-align:middle" title="\lbrack 0,T\rbrack"/></span><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(0) = B(T) = 1" class="math inline" src="../media/file548.png" style="vertical-align:middle" title="A(0) = B(T) = 1"/></span><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(T) = B(0) = 0" class="math inline" src="../media/file549.png" style="vertical-align:middle" title="A(T) = B(0) = 0"/></span><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.107.2" xmlns="http://www.w3.org/1999/xhtml">Notice that it holds that </span><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(0) = H_{0}" class="math inline" src="../media/file550.png" style="vertical-align:middle" title="H(0) = H_{0}"/></span><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(T) = H_{1}" class="math inline" src="../media/file551.png" style="vertical-align:middle" title="H(T) = H_{1}"/></span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">, exactly as we desired. </span><span class="koboSpan" id="kobo.111.2" xmlns="http://www.w3.org/1999/xhtml">A common choice for the functions </span><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"> is to set </span><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. A(t) = 1 - t\slash T \right." class="math inline" src="../media/file552.png" style="vertical-align:middle" title="\left. A(t) = 1 - t\slash T \right."/></span><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. B(t) = t\slash T \right." class="math inline" src="../media/file553.png" style="vertical-align:middle" title="\left. B(t) = t\slash T \right."/></span><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.119.2" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, as we will see later in this chapter, sometimes we also use other options, under the requirement that they satisfy the aforementioned boundary conditions.</span></p>
<p><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">Adiabatic quantum </span><span id="dx1-76009"/><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">computing is polynomially equivalent to other quantum computing models, as proved by Aharonov et al. </span><span class="cite"><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xaharonov2007adiabatic"><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">4</span></a><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">, including the quantum circuit model. </span><span class="koboSpan" id="kobo.125.2" xmlns="http://www.w3.org/1999/xhtml">This means that anything that is efficiently computable in one of these models is also efficiently computable in adiabatic quantum computing, and vice versa. </span><span class="koboSpan" id="kobo.125.3" xmlns="http://www.w3.org/1999/xhtml">Consequently, you can choose to use any of these models depending on the particulars of your problem or, as we will see in the next section, on the kind of quantum computer that you have access to.</span></p>
</section>
<section class="level2 sectionHead" data-number="11.2" id="quantum-annealing">
<h1 class="sectionHead" data-number="11.2"><span class="titlemark"><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">4.2 </span></span> <span id="x1-770004.2"><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Quantum annealing</span></span></h1>
<p><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">Although we have just seen that adiabatic quantum computing is, theoretically, a perfectly viable alternative to the quantum circuit model, in its practical incarnation it is usually implemented in a </span><span id="dx1-77001"/><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">restricted version called </span><strong><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">quantum</span></strong> <strong><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">annealing</span></strong><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">Quantum annealing relies on the same core idea as adiabatic quantum computing: it takes an initial Hamiltonian </span><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">, a final Hamiltonian </span><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"> whose ground state encodes the solution to the problem of interest, and it gradually changes the acting Hamiltonian from the initial to the final one by using some functions </span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml"> (as described in the previous section) to decrease the action of </span><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml"> and to increase the action of </span><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.145.2" xmlns="http://www.w3.org/1999/xhtml">However, quantum annealing deviates from full adiabatic quantum computing in two ways. </span><span class="koboSpan" id="kobo.145.3" xmlns="http://www.w3.org/1999/xhtml">First of all, in practical implementations of quantum annealing, the final Hamiltonian </span><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml"> that can be realized cannot be chosen completely at will, but has to be selected from a certain, restricted class. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">A typical option is an Ising Hamiltonian of the form</span></p>
<p><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- \sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - \sum\limits_{j}h_{j}Z_{j}," class="math display" src="../media/file554.png" style="vertical-align:middle" title="- \sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - \sum\limits_{j}h_{j}Z_{j},"/></span></p>
<p><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">which is the quantum version of the one we introduced in </span><em><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-630003.1.3"><em><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">3.1.3</span></em></a><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.152.2" xmlns="http://www.w3.org/1999/xhtml">In this case, the user has the freedom of selecting the </span><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml"> coefficients within certain ranges. </span><span class="koboSpan" id="kobo.156.2" xmlns="http://www.w3.org/1999/xhtml">Due to this restriction in the choice of the final Hamiltonian, quantum annealing, unlike adiabatic quantum computing, is not universal and can only be used to solve a specific (but still very important!) type of problem. </span><span class="koboSpan" id="kobo.156.3" xmlns="http://www.w3.org/1999/xhtml">On the bright side, physical quantum devices based on quantum annealing are simpler to construct, making it possible to scale the size of these </span><strong><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealers</span></strong><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml"> up to </span><span id="dx1-77002"/><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">hundreds or even thousands of qubits.</span></p>
<p><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">The initial Hamiltonian in the quantum annealing setup is also usually fixed to be </span><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}" class="math inline" src="../media/file555.png" style="vertical-align:middle" title="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}"/></span><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml"> is the number of qubits, and </span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X_{j}" class="math inline" src="../media/file556.png" style="vertical-align:middle" title="X_{j}"/></span><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml"> stands for the tensor product in which the </span><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml"> matrix is acting on qubit </span><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"> with the rest of positions occupied by </span><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">, the identity matrix. </span><span class="koboSpan" id="kobo.172.2" xmlns="http://www.w3.org/1999/xhtml">The ground state of </span><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"> is easily seen to be </span><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\otimes}_{i = 0}^{n - 1}\left| + \right\rangle" class="math inline" src="../media/file557.png" style="vertical-align:middle" title="{\otimes}_{i = 0}^{n - 1}\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"> , the tensor product of </span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"> copies of the plus state, which is relatively easy to prepare because it is completely unentangled.</span></p>
<div class="tcolorbox questionx" id="tcolobox-90">
<span id="x1-77004x4.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 4.1</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">Prove that </span><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle = {\otimes}_{i = 0}^{n - 1}\left| + \right\rangle" class="math inline" src="../media/file558.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle = {\otimes}_{i = 0}^{n - 1}\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"> has the minimum possible energy for </span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}" class="math inline" src="../media/file555.png" style="vertical-align:middle" title="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}"/></span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"> by first showing that, for each </span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml"> and each state </span><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that </span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|X_{j}\left| \psi \right\rangle \leq 1" class="math inline" src="../media/file559.png" style="vertical-align:middle" title="\left\langle \psi \right|X_{j}\left| \psi \right\rangle \leq 1"/></span><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml"> and then showing that </span><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi_{0} \right|X_{j}\left| \psi_{0} \right\rangle = 1" class="math inline" src="../media/file560.png" style="vertical-align:middle" title="\left\langle \psi_{0} \right|X_{j}\left| \psi_{0} \right\rangle = 1"/></span><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"> for each </span><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">Thus, the Hamiltonian used in quantum annealing is given by</span></p>
<p><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t) = - A(t)\sum\limits_{j = 0}^{n - 1}X_{j} - B(t)\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - B(t)\sum\limits_{j}h_{j}Z_{j}," class="math display" src="../media/file561.png" style="vertical-align:middle" title="H(t) = - A(t)\sum\limits_{j = 0}^{n - 1}X_{j} - B(t)\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - B(t)\sum\limits_{j}h_{j}Z_{j},"/></span></p>
<p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"> are some adjustable coefficients, and </span><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml"> are functions such that </span><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(0) = B(T) = 1" class="math inline" src="../media/file548.png" style="vertical-align:middle" title="A(0) = B(T) = 1"/></span><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(T) = B(0) = 0" class="math inline" src="../media/file549.png" style="vertical-align:middle" title="A(T) = B(0) = 0"/></span><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">, with </span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"> being the </span><span id="dx1-77005"/><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">total </span><strong><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">annealing time</span></strong><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.214.2" xmlns="http://www.w3.org/1999/xhtml">In this context, </span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml"> are </span><span id="dx1-77006"/><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">called the </span><strong><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">annealing schedule</span></strong><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">The other important deviation from the adiabatic quantum computing model is that, in quantum annealing, evolution is no longer guaranteed to be adiabatic. </span><span class="koboSpan" id="kobo.222.2" xmlns="http://www.w3.org/1999/xhtml">There are two main reasons for this decision. </span><span class="koboSpan" id="kobo.222.3" xmlns="http://www.w3.org/1999/xhtml">As you surely remember, the spectral gap is the minimum of the difference between the ground state and the first excited state of </span><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t)" class="math inline" src="../media/file541.png" style="vertical-align:middle" title="H(t)"/></span><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="t \in \lbrack 0,T\rbrack" class="math inline" src="../media/file562.png" style="vertical-align:middle" title="t \in \lbrack 0,T\rbrack"/></span><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.226.2" xmlns="http://www.w3.org/1999/xhtml">Computing this spectral gap can be very difficult. </span><span class="koboSpan" id="kobo.226.3" xmlns="http://www.w3.org/1999/xhtml">Actually, it can be even harder than finding the ground state that we are looking for, as proved by Cubitt et al. </span><span class="cite"><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xcubitt2015undecidability"><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">27</span></a><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.230.2" xmlns="http://www.w3.org/1999/xhtml">The second reason is that, even if we are able to compute the time that we need for the process to be adiabatic, it can be so big that it wouldn’t be practical — or even possible! </span><span class="koboSpan" id="kobo.230.3" xmlns="http://www.w3.org/1999/xhtml">— to run the system evolution for so long.</span></p>
<p><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">Thus, in </span><span id="dx1-77007"/><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealing, we run the evolution for a certain amount of time that need not satisfy the conditions for adiabaticity, and hope to still be able to find good approximations of the optimal solution to our problem. </span><span class="koboSpan" id="kobo.232.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we don’t strictly need to remain in the ground state of </span><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t)" class="math inline" src="../media/file541.png" style="vertical-align:middle" title="H(t)"/></span><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.234.2" xmlns="http://www.w3.org/1999/xhtml">Since, at the end, we are going to measure the state, it would be enough if the amplitude of an optimal or sufficiently good solution in our final state were big enough. </span><span class="koboSpan" id="kobo.234.3" xmlns="http://www.w3.org/1999/xhtml">That’s because, then, the probability of obtaining a useful result will still be high. </span><span class="koboSpan" id="kobo.234.4" xmlns="http://www.w3.org/1999/xhtml">And, of course, we can always repeat the process several times and keep the best of all measurements!</span></p>
<p><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">In 2011, the Canadian company D-Wave was the first to ever commercialize a quantum device that implemented quantum annealing as we have just described it. </span><span class="koboSpan" id="kobo.235.2" xmlns="http://www.w3.org/1999/xhtml">That quantum annealer, called D-Wave One, had </span><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="128" class="math inline" src="../media/file563.png" style="vertical-align:middle" title="128"/></span><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, while one of D-Wave’s most recent quantum devices, the Advantage, has more than </span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5000" class="math inline" src="../media/file564.png" style="vertical-align:middle" title="5000"/></span><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, and it’s available for you to use online!</span></p>
<p><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">We need to keep in mind that, with these quantum computers, the evolution process will not be adiabatic in general, so there is no guarantee that the exact solution will be found in all cases. </span><span class="koboSpan" id="kobo.240.2" xmlns="http://www.w3.org/1999/xhtml">But, all over the world, many research teams and prominent companies — from sectors as diverse as finance, logistics, and aircraft manufacturing — are actively exploring the practical applications of quantum annealers. </span><span class="koboSpan" id="kobo.240.3" xmlns="http://www.w3.org/1999/xhtml">We will devote the rest of this chapter to showing you how you can also try them for your own optimization problems.</span></p>
<p><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">Using D-Wave’s quantum annealers is much easier than you may think. </span><span class="koboSpan" id="kobo.241.2" xmlns="http://www.w3.org/1999/xhtml">First of all, you need to follow the instructions in </span><em><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">, to install Ocean, which is D-Wave’s quantum annealing Python library, and to create a free account on D-Wave Leap, a cloud service where you can get one minute per month of free computing time on D-Wave’s </span><span id="dx1-77008"/><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealers. </span><span class="koboSpan" id="kobo.247.2" xmlns="http://www.w3.org/1999/xhtml">This may not seem like much, but you will see that it is enough to run quite a number of experiments.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-91">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">If one minute per month proves not to be enough for your annealing necessities, both D-Wave Leap and Amazon Braket offer paid access to quantum annealers. </span><span class="koboSpan" id="kobo.250.2" xmlns="http://www.w3.org/1999/xhtml">Obviously, the pricing of these services varies from time to time, so please check their websites to check the current rates and conditions.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">Once you have everything set up, you can access quantum annealers to find an approximation of a solution to any combinatorial optimization problem that you may have written as either an instance of finding the ground state of an Ising model or as a QUBO problem. </span><span class="koboSpan" id="kobo.251.2" xmlns="http://www.w3.org/1999/xhtml">For instance, let’s try to solve the MaxCut problem for the graph in </span><em><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="ch011.xhtml#Figure3.5"><em><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">3.5</span></em></a><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.254.2" xmlns="http://www.w3.org/1999/xhtml">As you surely remember, we can pose it as finding the ground state of</span></p>
<p><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} + Z_{0}Z_{2}," class="math display" src="../media/file565.png" style="vertical-align:middle" title="Z_{0}Z_{1} + Z_{0}Z_{2},"/></span></p>
<p><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">which is, of course, an Ising Hamiltonian in which </span><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{01} = J_{02} = 1" class="math inline" src="../media/file566.png" style="vertical-align:middle" title="J_{01} = J_{02} = 1"/></span><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml"> and the rest of the coefficients are </span><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">All we need to tell the quantum annealer is that those are the coefficients we want to use, and then we can perform the annealing multiple times to obtain some results that will hopefully solve our problem. </span><span class="koboSpan" id="kobo.261.2" xmlns="http://www.w3.org/1999/xhtml">To specify the problem, we can use the </span><code><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"> package, included in the Ocean library, as follows:</span></p>
<p><span id="x1-77009"/></p>
<pre class="lstlisting" id="listing-54"><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">

import dimod 
 
J = {(0,1):1, (0,2):1} 
 
h = {} 
 
problem = dimod.BinaryQuadraticModel(h, J, 0.0, dimod.SPIN) 
 
print("The problem we are going to solve is:") 
 
print(problem)
</span></pre>
<p><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">The output will be the following:</span></p>
<pre class="lstlisting" id="listing-55"><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">

The problem we are going to solve is: 
 
BinaryQuadraticModel({0: 0.0, 1: 0.0, 2: 0.0}, 
 
    {(1, 0): 1.0, (2, 0): 1.0}, 0.0, ’SPIN’)
</span></pre>
<p><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">There are a couple of things to notice here. </span><span class="koboSpan" id="kobo.267.2" xmlns="http://www.w3.org/1999/xhtml">First, we have used </span><code><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">J</span></code><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml"> for the coefficients of the degree </span><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml"> terms — </span><code><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">(0,1):1</span></code><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"> sets the </span><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{01}" class="math inline" src="../media/file567.png" style="vertical-align:middle" title="J_{01}"/></span><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml"> coefficient to 1 and </span><code><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">(0,2):1</span></code><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"> sets </span><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{02} = 1" class="math inline" src="../media/file568.png" style="vertical-align:middle" title="J_{02} = 1"/></span><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml"> — and </span><code><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">h</span></code><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml"> for the linear ones. </span><span class="koboSpan" id="kobo.281.2" xmlns="http://www.w3.org/1999/xhtml">Those coefficients that we do not specify are automatically set to </span><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml"> by the </span><code><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml"> constructor, but we still need to pass both the </span><code><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">J</span></code><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml"> and the </span><code><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">h</span></code><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml"> parameters (even in our case, where the latter is empty). </span><span class="koboSpan" id="kobo.289.2" xmlns="http://www.w3.org/1999/xhtml">Notice that in the output we get </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">(1,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">0):</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">1.0,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">(2,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">0):</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">1.0</span></code></span></span><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">, which seems to be the reverse of what we used. </span><span class="koboSpan" id="kobo.296.2" xmlns="http://www.w3.org/1999/xhtml">But they are exactly the same, because </span><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} = Z_{1}Z_{0}" class="math inline" src="../media/file569.png" style="vertical-align:middle" title="Z_{0}Z_{1} = Z_{1}Z_{0}"/></span><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"> and, thus, the situation is symmetrical. </span><span class="koboSpan" id="kobo.298.2" xmlns="http://www.w3.org/1999/xhtml">Second, we have used </span><code><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">0.0</span></code><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"> as the value for the </span><strong><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">offset</span></strong><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml">, which is a constant term that can be added to the Hamiltonian. </span><span class="koboSpan" id="kobo.302.2" xmlns="http://www.w3.org/1999/xhtml">Finally, we have used the </span><code><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">SPIN</span></code><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"> parameter because we are working with an Ising Hamiltonian and, thus, the values of our variables are </span><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.310.2" xmlns="http://www.w3.org/1999/xhtml">In just a minute, we will see how to use binary variables instead. </span><span class="koboSpan" id="kobo.310.3" xmlns="http://www.w3.org/1999/xhtml">But, before that, let’s use the following code to run the </span><span id="dx1-77019"/><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">annealing process on one of the quantum annealers:</span></p>
<pre class="lstlisting" id="listing-56"><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">

from dwave.system import DWaveSampler 
 
from dwave.system import EmbeddingComposite 
 
sampler = EmbeddingComposite(DWaveSampler()) 
 
result = sampler.sample(problem, num_reads=10) 
 
print("The solutions that we have obtained are") 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">What we are doing here is, first, importing </span><code><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">DWaveSampler</span></code><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">, which will give us access to the quantum annealers, and then </span><code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">, which will allow us to </span><strong><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">map</span></strong><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">embed</span></strong><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"> our problem into the actual qubits of the annealer — don’t worry, we will explain this in detail later. </span><span class="koboSpan" id="kobo.321.2" xmlns="http://www.w3.org/1999/xhtml">For now, you can think of this as an automatic way of selecting a few qubits in the computer that will be used to represent our variables. </span><span class="koboSpan" id="kobo.321.3" xmlns="http://www.w3.org/1999/xhtml">After that, we create an object </span><code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">sampler</span></code><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"> that we then use to obtain </span><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> samples or possible solutions to our problem. </span><span class="koboSpan" id="kobo.325.2" xmlns="http://www.w3.org/1999/xhtml">This is where the actual execution on the actual </span><span id="dx1-77026"/><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealer happens. </span><span class="koboSpan" id="kobo.326.2" xmlns="http://www.w3.org/1999/xhtml">After that, we just print the result, which will vary from execution to execution. </span><span class="koboSpan" id="kobo.326.3" xmlns="http://www.w3.org/1999/xhtml">This is because we are using an actual quantum computer, which is, as you know, essentially probabilistic. </span><span class="koboSpan" id="kobo.326.4" xmlns="http://www.w3.org/1999/xhtml">In our case, we obtained the following:</span></p>
<pre class="lstlisting" id="listing-57"><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">

The solutions that we have obtained are 
 
   0  1  2 energy num_oc. </span><span class="koboSpan" id="kobo.327.2" xmlns="http://www.w3.org/1999/xhtml">chain_. 
 
</span><span class="koboSpan" id="kobo.327.3" xmlns="http://www.w3.org/1999/xhtml">0 +1 -1 -1   -2.0       6     0.0 
 
1 -1 +1 +1   -2.0       4     0.0 
 
[’SPIN’, 2 rows, 10 samples, 3 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">This means that we obtained two different solutions: </span><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = 1" class="math inline" src="../media/file570.png" style="vertical-align:middle" title="z_{0} = 1"/></span><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = - 1" class="math inline" src="../media/file571.png" style="vertical-align:middle" title="z_{1} = - 1"/></span><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{2} = - 1" class="math inline" src="../media/file572.png" style="vertical-align:middle" title="z_{2} = - 1"/></span><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = - 1" class="math inline" src="../media/file573.png" style="vertical-align:middle" title="z_{0} = - 1"/></span><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = 1" class="math inline" src="../media/file574.png" style="vertical-align:middle" title="z_{1} = 1"/></span><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{2} = 1" class="math inline" src="../media/file575.png" style="vertical-align:middle" title="z_{2} = 1"/></span><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">, both with energy </span><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2" class="math inline" src="../media/file333.png" style="vertical-align:middle" title="- 2"/></span><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">; the first one was measured in </span><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"> of the executions and the</span><span id="dx1-77032"/><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"> second in the remaining </span><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"> — we will explain what the </span><code><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">chain_</span></code></p>
<p><code><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml"> data means later in the chapter. </span><span class="koboSpan" id="kobo.350.2" xmlns="http://www.w3.org/1999/xhtml">But meanwhile, we can rejoice. </span><span class="koboSpan" id="kobo.350.3" xmlns="http://www.w3.org/1999/xhtml">These two solutions are, indeed, maximum cuts in our graph, as you can easily check!</span></p>
<p><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">We can get some additional information from the </span><code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"> variable. </span><span class="koboSpan" id="kobo.353.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we can access the best solution through </span><code><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">first</span></code><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"> and the total time that we used the quantum annealer for, with </span><code><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">info</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">[</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">timing</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">][</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">qpu_access_time</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><code><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">]</span></code><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.370.2" xmlns="http://www.w3.org/1999/xhtml">This is the amount that will be subtracted from your monthly 60 seconds…or that you will be charged for if you have a paying plan. </span><span class="koboSpan" id="kobo.370.3" xmlns="http://www.w3.org/1999/xhtml">In our case, the time that we used the annealer for was </span><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="15\, 832.16" class="math inline" src="../media/file577.png" style="vertical-align:middle" title="15\, 832.16"/></span><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">, which may look like a huge number if you don’t realize that it is actually measured in microseconds. </span><span class="koboSpan" id="kobo.372.2" xmlns="http://www.w3.org/1999/xhtml">So for the 10 samples we used about </span><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.016" class="math inline" src="../media/file578.png" style="vertical-align:middle" title="0.016"/></span><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml"> seconds. </span><span class="koboSpan" id="kobo.374.2" xmlns="http://www.w3.org/1999/xhtml">That minute of access doesn’t seem so short anymore, right?</span></p>
<p><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">We can also use </span><code><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"> to work with QUBO problems. </span><span class="koboSpan" id="kobo.377.2" xmlns="http://www.w3.org/1999/xhtml">We will need to specify the coefficients of the degree </span><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"> terms, the linear coefficients — remember that, in QUBO, we are using binary variables, so expressions like </span><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{3}^{2}" class="math inline" src="../media/file579.png" style="vertical-align:middle" title="x_{3}^{2}"/></span><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"> can be simplified to </span><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{3}" class="math inline" src="../media/file580.png" style="vertical-align:middle" title="x_{3}"/></span><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> — and the independent coefficient, exactly as in the Ising case. </span><span class="koboSpan" id="kobo.383.2" xmlns="http://www.w3.org/1999/xhtml">The only change is that we will use the </span><code><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">BINARY</span></code><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml"> parameter when creating our problem with the </span><code><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml"> constructor.</span></p>
<div class="tcolorbox questionx" id="tcolobox-92">
<span id="x1-77034x4.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 4.2</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">Create an instance of a simple QUBO problem and solve it with an annealer. </span><span class="koboSpan" id="kobo.391.2" xmlns="http://www.w3.org/1999/xhtml">Notice that the values for the variables in the solution will be </span><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml"> instead of </span><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">This is just the simplest kind of </span><span id="dx1-77035"/><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">execution that we can run on a quantum annealer, in which we have used all the default parameters. </span><span class="koboSpan" id="kobo.401.2" xmlns="http://www.w3.org/1999/xhtml">But the Ocean software implements many other functionalities that allow us, for instance, to work more comfortably with optimization problems and to control the settings of our experiments more precisely, including the annealing time and other important values. </span><span class="koboSpan" id="kobo.401.3" xmlns="http://www.w3.org/1999/xhtml">The rest of this chapter will guide you through the most important features and options to help you get the most of your time with annealers, starting with how to use Ocean to work with optimization problems.</span></p>
</section>
<section class="level2 sectionHead" data-number="11.3" id="using-ocean-to-formulate-and-transform-optimization-problems">
<h1 class="sectionHead" data-number="11.3"><span class="titlemark"><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">4.3 </span></span> <span id="x1-780004.3"><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">Using Ocean to formulate and transform optimization problems</span></span></h1>
<p><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">As we </span><span id="dx1-78001"/><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">have just seen, the </span><code><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml"> class can be </span><span id="dx1-78002"/><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">used to define both Ising and QUBO problems. </span><span class="koboSpan" id="kobo.408.2" xmlns="http://www.w3.org/1999/xhtml">But </span><code><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"> also offers other </span><span id="dx1-78003"/><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">models and utilities that will make our lives a little bit easier. </span><span class="koboSpan" id="kobo.411.2" xmlns="http://www.w3.org/1999/xhtml">Let’s start by </span><span id="dx1-78004"/><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">studying how we can conveniently define problems with linear restrictions.</span></p>
<section class="level3 subsectionHead" data-number="11.3.1" id="constrained-quadratic-models-in-ocean">
<h2 class="subsectionHead" data-number="11.3.1"><span class="titlemark"><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">4.3.1 </span></span> <span id="x1-790004.3.1"><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">Constrained quadratic models in Ocean</span></span></h2>
<p><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">You surely </span><span id="dx1-79001"/><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">remember that a problem like</span></p>
<p><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} \leq 1,\qquad} &amp; &amp; \qquad \\ &amp; {3x_{0} - x_{1} + 3x_{2} \leq 4\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2\qquad} &amp; &amp; \qquad \\ &amp; \qquad &amp; &amp; \\ \end{array}" class="math display" src="../media/file581.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} \leq 1,\qquad} &amp; &amp; \qquad \\  &amp; {3x_{0} - x_{1} + 3x_{2} \leq 4\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2\qquad} &amp; &amp; \qquad \\  &amp; \qquad &amp; &amp; \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">is an instance of </span><span id="dx1-79002"/><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">binary linear programming. </span><span class="koboSpan" id="kobo.419.2" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-690003.4.1"><em><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">3.4.1</span></em></a><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">, we studied this family of problems in detail and we showed that they can be transformed into the QUBO and Ising models by using slack variables and penalty terms.</span></p>
<p><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">So, imagine that you want to solve the preceding problem in a quantum annealer. </span><span class="koboSpan" id="kobo.423.2" xmlns="http://www.w3.org/1999/xhtml">Do you need to perform all those boring transformations in order to obtain the QUBO coefficients and then use them to define a </span><code><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml"> object? </span><span class="koboSpan" id="kobo.425.2" xmlns="http://www.w3.org/1999/xhtml">No! </span><span class="koboSpan" id="kobo.425.3" xmlns="http://www.w3.org/1999/xhtml">Fortunately, </span><code><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml"> provides the </span><code><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">ConstrainedQuadraticModel</span></code><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml"> class, which simplifies the process of working with problems that involve linear constraints.</span></p>
<p><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">In order to instantiate our binary linear program as a </span><code><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">ConstrainedQuadraticModel</span></code><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"> object, the first thing that we need to do is to define the variables that we want to use and their types. </span><span class="koboSpan" id="kobo.432.2" xmlns="http://www.w3.org/1999/xhtml">In our case, we have three binary variables that we can define with the following piece of code:</span></p>
<pre class="lstlisting" id="listing-58"><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">

x0 = dimod.Binary("x0") 
 
x1 = dimod.Binary("x1") 
 
x2 = dimod.Binary("x2")
</span></pre>
<p><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">With these instructions, we have simply created three binary variables and we have labeled them so that we can use them in mathematical expressions and easily identify them when we print them.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-93">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">If you have used symbolic mathematics libraries (for instance, SymPy), you will recognize that the principles at work here are very similar.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">Now, we are going to </span><span id="dx1-79006"/><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">define a </span><code><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">ConstrainedQuadraticModel</span></code><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml"> object and we are going to set the </span><strong><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">objective</span></strong><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"> (the function that we seek to minimize) and also fix the constraints of the problem. </span><span class="koboSpan" id="kobo.443.2" xmlns="http://www.w3.org/1999/xhtml">For that, we will use the </span><span id="dx1-79007"/><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">variables that we have just created. </span><span class="koboSpan" id="kobo.444.2" xmlns="http://www.w3.org/1999/xhtml">This can be achieved with the </span><span id="dx1-79008"/><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">following instructions:</span></p>
<pre class="lstlisting" id="listing-59"><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">

blp = dimod.ConstrainedQuadraticModel() 
 
blp.set_objective(-5*x0+3*x1-2*x2) 
 
blp.add_constraint(x0 + x2 &lt;= 1, "First constraint") 
 
blp.add_constraint(3*x0 -x1 + 3*x2 &lt;= 4, "Second constraint")
</span></pre>
<p><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">Setting the objective or adding constraints automatically adds all the variables involved to the problem object. </span><span class="koboSpan" id="kobo.447.2" xmlns="http://www.w3.org/1999/xhtml">Notice also that we have provided labels to identify the constraints. </span><span class="koboSpan" id="kobo.447.3" xmlns="http://www.w3.org/1999/xhtml">If you prefer not to do it, then </span><code><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml"> will </span><span id="dx1-79013"/><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">randomly assign an alphanumeric string to each constraint and it will be used as its name, should you need it. </span><span class="koboSpan" id="kobo.450.2" xmlns="http://www.w3.org/1999/xhtml">If, later on, you want to rename any of them, you can use the </span><code><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">relabel_constraints</span></code><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml"> method.</span><span id="dx1-79014"/></p>
<p><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">We can inspect the elements of </span><code><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">blp</span></code><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml"> by accessing its </span><code><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">variables</span></code><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">objective</span></code><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">constraints</span></code><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml"> attributes. </span><span class="koboSpan" id="kobo.461.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we can execute these instructions:</span></p>
<pre class="lstlisting" id="listing-60"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">

print("Our variables are:") 
 
print(blp.variables) 
 
print("Our objective is:") 
 
print(blp.objective) 
 
print("Our constraints are:") 
 
print(blp.constraints)
</span></pre>
<p><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">And we will obtain something like this:</span></p>
<pre class="lstlisting" id="listing-61"><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">

Our variables are: 
 
Variables([’x0’, ’x1’, ’x2’]) 
 
Our objective is: 
 
ObjectiveView({’x0’: -5.0, ’x1’: 3.0, ’x2’: -2.0}, {}, 0.0, 
 
    {’x0’: ’BINARY’, ’x1’: ’BINARY’, ’x2’: ’BINARY’}) 
 
Our constraints are: 
 
{’First constraint’: Le(ConstraintView({’x0’: 1.0, ’x2’: 1.0}, {}, 0.0, 
 
    {’x0’: ’BINARY’, ’x2’: ’BINARY’}), 1.0), ’Second constraint’: 
 
    Le(ConstraintView({’x0’: 3.0, ’x1’: -1.0, ’x2’: 3.0}, {}, 0.0, 
 
    {’x0’: ’BINARY’, ’x1’: ’BINARY’, ’x2’: ’BINARY’}), 4.0)}
</span></pre>
<p><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">Notice that both the </span><span id="dx1-79031"/><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">objective and the </span><span id="dx1-79032"/><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">constraints are internally represented as quadratic functions and, therefore, they formally have quadratic terms, linear terms, and an offset or independent term. </span><span class="koboSpan" id="kobo.467.2" xmlns="http://www.w3.org/1999/xhtml">In our case, only the linear part of the constraints is non-empty, and the offset is </span><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"> in both cases.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-94">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content"><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">
As you can see from the output, the constraints that we have created are instances of the </span><code><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">sym</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">Le</span></code><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml"> class, where </span><code><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">Le</span></code><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"> stands for </span><em><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">less</span></em> <em><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">than or equal to</span></em><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.483.2" xmlns="http://www.w3.org/1999/xhtml">You can also create equality constraints, which will belong to the </span><code><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml">sym</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml">Eq</span></code><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml"> class or inequality constraints with </span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\geq" class="math inline" src="../media/file582.png" style="vertical-align:middle" title="\geq"/></span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">, which will be </span><code><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">sym</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span>
<code><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">Ge</span></code><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.497.2" xmlns="http://www.w3.org/1999/xhtml">Of course, an equality constraint is equivalent to one </span><code><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">Le</span></code><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml"> constraint plus one </span><code><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml">Ge</span></code><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml"> constraint with the same left- and right-hand sides. </span><span class="koboSpan" id="kobo.501.2" xmlns="http://www.w3.org/1999/xhtml">And we can transform </span><code><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">Le</span></code><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml"> constraints into </span><code><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">Ge</span></code><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml"> constraints — and the other way around — by multiplying everything by </span><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">.
</span></div>
</div>
<p><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">Now, we know how to construct problems with constraints using </span><code><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.510.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will learn how to use the problems that we have defined to compute the cost of different value assignments, check if those assignments satisfy the constraints, and to also find the optimal solution to the problem.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.3.2" id="solving-constrained-quadratic-models-with-dimod">
<h2 class="subsectionHead" data-number="11.3.2"><span class="titlemark"><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">4.3.2 </span></span> <span id="x1-800004.3.2"><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml">Solving constrained quadratic models with dimod</span></span></h2>
<p><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml"> package </span><span id="dx1-80001"/><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">provides many </span><span id="dx1-80002"/><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">tools to work with the constrained quadratic problems that we have just introduced. </span><span class="koboSpan" id="kobo.517.2" xmlns="http://www.w3.org/1999/xhtml">For instance, we can </span><span id="dx1-80003"/><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">define an assignment of values to the variables, check if it is feasible, and compute its cost for the problem defined in the previous subsection by using the following instructions:</span></p>
<pre class="lstlisting" id="listing-62"><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">

sample1 = {"x0":1, "x1":1, "x2":1} 
 
print("The assignment is", sample1) 
 
print("Its cost is", blp.objective.energy(sample1)) 
 
print("Is it feasible?",blp.check_feasible(sample1)) 
 
print("The violations of the constraints are") 
 
print(blp.violations(sample1))
</span></pre>
<p><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml">We are using the assignment </span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{1} = x_{2} = 1" class="math inline" src="../media/file583.png" style="vertical-align:middle" title="x_{0} = x_{1} = x_{2} = 1"/></span><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml">, so when we execute the code we obtain the following output:</span></p>
<pre class="lstlisting" id="listing-63"><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml">

The assignment is {’x0’: 1, ’x1’: 1, ’x2’: 1} 
 
Its cost is -4.0 
 
Is it feasible? </span><span class="koboSpan" id="kobo.523.2" xmlns="http://www.w3.org/1999/xhtml">False 
 
The violations of the constraints are 
 
{’First constraint’: 1.0, ’Second constraint’: 1.0}
</span></pre>
<p><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">This tells us that the assignment is not feasible, and the </span><code><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">violations</span></code><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml"> method gives us the amount by which the left-hand side of each inequality is bigger than the right-hand side.</span><span id="dx1-80015"/></p>
<p><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">If, on the other hand, we want to try the </span><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{1} = 0,x_{2} = 1" class="math inline" src="../media/file584.png" style="vertical-align:middle" title="x_{0} = x_{1} = 0,x_{2} = 1"/></span><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml"> assignment, we can use the following code:</span></p>
<pre class="lstlisting" id="listing-64"><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml">

sample2 = {"x0":0, "x1":0, "x2":1} 
 
print("The assignment is", sample2) 
 
print("Its cost is", blp.objective.energy(sample2)) 
 
print("Is it feasible?",blp.check_feasible(sample2)) 
 
print("The violations of the constraints are") 
 
print(blp.violations(sample2))
</span></pre>
<p><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml">The result that we obtain is the</span><span id="dx1-80022"/><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml"> following:</span></p>
<pre class="lstlisting" id="listing-65"><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml">

The assignment is {’x0’: 0, ’x1’: 0, ’x2’: 1} 
 
Its cost is -2.0 
 
Is it feasible? </span><span class="koboSpan" id="kobo.533.2" xmlns="http://www.w3.org/1999/xhtml">True 
 
The violations of the constraints are 
 
{’First constraint’: 0.0, ’Second constraint’: -1.0}
</span></pre>
<p><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the assignment is feasible and, therefore, no violation term is positive.</span></p>
<p><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml"> package also </span><span id="dx1-80028"/><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml">provides a brute-force solver that tries all possible assignments and sorts them </span><span id="dx1-80029"/><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml">according to their cost, from lowest to highest. </span><span class="koboSpan" id="kobo.539.2" xmlns="http://www.w3.org/1999/xhtml">Using it with our example is as simple as running</span></p>
<pre class="lstlisting" id="listing-66"><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml">

solver = dimod.ExactCQMSolver() 
 
solution = solver.sample_cqm(blp) 
 
print("The list of assignments is") 
 
print(solution)
</span></pre>
<p><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">to obtain</span></p>
<pre class="lstlisting" id="listing-67"><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml">

The list of assignments is 
 
  x0 x1 x2 energy num_oc. </span><span class="koboSpan" id="kobo.542.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.542.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.542.4" xmlns="http://www.w3.org/1999/xhtml">6  1  0  1   -7.0       1 arra...   </span><span class="koboSpan" id="kobo.542.5" xmlns="http://www.w3.org/1999/xhtml">False 
 
2  1  0  0   -5.0       1 arra...    </span><span class="koboSpan" id="kobo.542.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
7  1  1  1   -4.0       1 arra...   </span><span class="koboSpan" id="kobo.542.7" xmlns="http://www.w3.org/1999/xhtml">False 
 
3  1  1  0   -2.0       1 arra...    </span><span class="koboSpan" id="kobo.542.8" xmlns="http://www.w3.org/1999/xhtml">True 
 
4  0  0  1   -2.0       1 arra...    </span><span class="koboSpan" id="kobo.542.9" xmlns="http://www.w3.org/1999/xhtml">True 
 
0  0  0  0    0.0       1 arra...    </span><span class="koboSpan" id="kobo.542.10" xmlns="http://www.w3.org/1999/xhtml">True 
 
5  0  1  1    1.0       1 arra...    </span><span class="koboSpan" id="kobo.542.11" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  0  1  0    3.0       1 arra...    </span><span class="koboSpan" id="kobo.542.12" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 8 rows, 8 samples, 3 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml">The first number is just an identifier of the assignment. </span><span class="koboSpan" id="kobo.543.2" xmlns="http://www.w3.org/1999/xhtml">It is followed by the values given to the variables. </span><span class="koboSpan" id="kobo.543.3" xmlns="http://www.w3.org/1999/xhtml">Then, we find the cost of the assignment — or, rather, its energy, if interpreted in terms of the Hamiltonian. </span><span class="koboSpan" id="kobo.543.4" xmlns="http://www.w3.org/1999/xhtml">After that, comes the times this solution has been found, which will always be </span><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"> with this solver. </span><span class="koboSpan" id="kobo.545.2" xmlns="http://www.w3.org/1999/xhtml">Finally, we find information about which constraints are satisfied and </span><span id="dx1-80045"/><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml">whether the </span><span id="dx1-80046"/><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">solution is feasible or not. </span><span class="koboSpan" id="kobo.547.2" xmlns="http://www.w3.org/1999/xhtml">It is very important to notice that the assignments are ordered by cost, but some of them may be unfeasible, even the first one, as in this case.</span></p>
<p><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml">In fact, if we execute </span><code><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">solution</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">first</span></code><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">, we will obtain this output:</span></p>
<pre class="lstlisting" id="listing-68"><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">

Sample(sample={’x0’: 1, ’x1’: 0, ’x2’: 1}, energy=-7.0, 
 
    num_occurrences=1, is_satisfied=array([False, False]), 
 
    is_feasible=False)
</span></pre>
<p><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">where we can see that this assignment does not satisfy either of the two constraints of our problem. </span><span class="koboSpan" id="kobo.554.2" xmlns="http://www.w3.org/1999/xhtml">If you want the optimal solution to the problem, you should always remove the unfeasible solutions first with the </span><span class="lstinline"><span style="color:#A71D5D"><code><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">filter</span></code></span></span><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> method, using an instruction like the following:</span></p>
<pre class="lstlisting" id="listing-69"><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml">

feasible_sols = solution.filter(lambda s: s.is_feasible)
</span></pre>
<p><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml">Then, if you access </span><code><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">feasible_sols</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml">first</span></code><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">, you will get</span></p>
<pre class="lstlisting" id="listing-70"><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml">

Sample(sample={’x0’: 1, ’x1’: 0, ’x2’: 0}, energy=-5.0, num_occurrences=1, 
 
    is_satisfied=array([ True,  True]), is_feasible=True)
</span></pre>
<p><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">which is, indeed, the optimal solution to our binary linear program.</span></p>
<p><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml">Of course, all these computations are done with a (very inefficient) classical algorithm. </span><span class="koboSpan" id="kobo.565.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we explain how to use actual quantum annealers to try to solve the problems that we have defined.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.3.3" id="running-constrained-problems-on-quantum-annealers">
<h2 class="subsectionHead" data-number="11.3.3"><span class="titlemark"><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">4.3.3 </span></span> <span id="x1-810004.3.3"><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">Running constrained problems on quantum annealers</span></span></h2>
<p><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">As useful as the </span><code><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">ConstrainedQuadraticModel</span></code><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml"> class is, we cannot use it to </span><span id="dx1-81001"/><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">define problems that can be run on </span><span id="dx1-81002"/><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealers. </span><span class="koboSpan" id="kobo.572.2" xmlns="http://www.w3.org/1999/xhtml">In order to do that, we first need to eliminate the constraints and create a </span><code><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"> object that we can later execute on actual quantum hardware as we did in </span><em><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-770004.2"><em><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">4.2</span></em></a><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.577.2" xmlns="http://www.w3.org/1999/xhtml">Fortunately, the process is really simple thanks to the utilities </span><span id="dx1-81003"/><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">provided in the Ocean library. </span><span class="koboSpan" id="kobo.578.2" xmlns="http://www.w3.org/1999/xhtml">Let’s see how this works with an example.</span></p>
<p><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">To illustrate the general procedure, let’s define a simple constrained problem with the following code:</span></p>
<pre class="lstlisting" id="listing-71"><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">

y0, y1 = dimod.Binaries(["y0", "y1"]) 
 
cqm = dimod.ConstrainedQuadraticModel() 
 
cqm.set_objective(-2*y0-3*y1) 
 
cqm.add_constraint(y0 + 2*y1 &lt;= 2)
</span></pre>
<p><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">We can transform this </span><span id="dx1-81008"/><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">constrained problem into an unconstrained one by using the </span><code><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">cqm_to_bqm</span></code><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml"> method as follows:</span></p>
<pre class="lstlisting" id="listing-72"><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml">

qubo, invert = dimod.cqm_to_bqm(cqm, lagrange_multiplier = 5) 
 
print(qubo)
</span></pre>
<p><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">In a moment,</span><span id="dx1-81011"/><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"> we will explain what </span><code><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml">invert</span></code><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"> is and how it is used, but for now let’s focus on the output of those instructions, which will be something similar to the following:</span></p>
<pre class="lstlisting" id="listing-73"><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">

BinaryQuadraticModel({’y0’: -17.0, ’y1’: -23.0, 
 
    ’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_0’: -15.0, 
 
    ’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_1’: -15.0}, 
 
    {(’y1’, ’y0’): 20.0, 
 
    (’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_0’, ’y0’): 10.0, 
 
    (’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_0’, ’y1’): 20.0, 
 
    (’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_1’, ’y0’): 10.0, 
 
    (’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_1’, ’y1’): 20.0, 
 
    (’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_1’, 
 
    ’slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_0’): 10.0}, 
 
    20.0, ’BINARY’)
</span></pre>
<p><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">That is quite a mouthful, but we promise that it is not nearly as complicated as it seems. </span><span class="koboSpan" id="kobo.591.2" xmlns="http://www.w3.org/1999/xhtml">In fact, with what you already know from </span><em><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">QUBO:</span></em> <em><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">Quadratic Unconstrained Binary Optimization</span></em><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">, you could have computed a similar output yourself! </span><span class="koboSpan" id="kobo.597.2" xmlns="http://www.w3.org/1999/xhtml">Let’s unpack it.</span></p>
<p><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">Since this is an </span><span id="dx1-81023"/><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml">unconstrained problem, what we are seeing is the specification of the cost function. </span><span class="koboSpan" id="kobo.599.2" xmlns="http://www.w3.org/1999/xhtml">First, we have the linear part, which starts with </span><code><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml">y0</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">’:</span></code></span><span style="color:#000000"> </span></p>
<p><code><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">-17.0</span></code><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.604.2" xmlns="http://www.w3.org/1999/xhtml">It tells us that, in the objective function, </span><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0}" class="math inline" src="../media/file445.png" style="vertical-align:middle" title="y_{0}"/></span><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml"> has coefficient </span><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 17" class="math inline" src="../media/file585.png" style="vertical-align:middle" title="- 17"/></span><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{1}" class="math inline" src="../media/file460.png" style="vertical-align:middle" title="y_{1}"/></span><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml"> has coefficient </span><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 23" class="math inline" src="../media/file586.png" style="vertical-align:middle" title="- 23"/></span><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml">, and the two other variables have coefficient </span><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 15" class="math inline" src="../media/file587.png" style="vertical-align:middle" title="- 15"/></span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.614.2" xmlns="http://www.w3.org/1999/xhtml">Then comes the quadratic part, with coefficient </span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml"> for the </span><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0}y_{1}" class="math inline" src="../media/file589.png" style="vertical-align:middle" title="y_{0}y_{1}"/></span><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml"> term, something that we deduce from the </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml">(’</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml">y1</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml">’,</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml">y0</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml">’):</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">20.0</span></code></span></span><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml"> value, and with coefficients </span><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml"> for the other products of two variables. </span><span class="koboSpan" id="kobo.630.2" xmlns="http://www.w3.org/1999/xhtml">Finally, </span><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml"> is the independent term or offset, and we are also told that all the variables are binary.</span></p>
<p><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml">But, where do all these coefficients come from? </span><span class="koboSpan" id="kobo.633.2" xmlns="http://www.w3.org/1999/xhtml">What our good friend </span><code><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml"> is doing here is nothing but applying the transformations that we studied in </span><em><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-690003.4.1"><em><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml">3.4.1</span></em></a><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.638.2" xmlns="http://www.w3.org/1999/xhtml">First, two slack variables — with quite ugly random names — are introduced to</span><span id="dx1-81024"/><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml"> transform the inequality constraint into an equality one. </span><span class="koboSpan" id="kobo.639.2" xmlns="http://www.w3.org/1999/xhtml">Then, the equality constraint is incorporated into the cost function as a penalty term with a penalty coefficient (the </span><code><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml"> parameter), which equals </span><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.643.2" xmlns="http://www.w3.org/1999/xhtml">And that’s all! </span><span id="dx1-81025"/><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml">It wasn’t that mysterious after all, was it?</span></p>
<div class="tcolorbox questionx" id="tcolobox-95">
<span id="x1-81027x4.3.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 4.3</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml">Check that the QUBO problem returned by </span><code><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml">cqm_to_bqm</span></code><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml"> coincides with what you would obtain should you apply the transformations explained in </span><em><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-690003.4.1"><em><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">3.4.1</span></em></a><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.651.2" xmlns="http://www.w3.org/1999/xhtml">Don’t forget the offset!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml">We can now use a quantum annealer to solve the problem defined in the </span><code><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml">qubo</span></code><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"> object just as we did in </span><em><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-770004.2"><em><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml">4.2</span></em></a><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.657.2" xmlns="http://www.w3.org/1999/xhtml">For instance, we can run the following code:</span></p>
<pre class="lstlisting" id="listing-74"><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml">

sampler = EmbeddingComposite(DWaveSampler()) 
 
result = sampler.sample(qubo, num_reads=10) 
 
print("The solutions that we have obtained are") 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">Do not forget to import </span><code><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml">DWaveSampler</span></code><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml"> if you haven’t done it yet. </span><span class="koboSpan" id="kobo.663.2" xmlns="http://www.w3.org/1999/xhtml">If you run these instructions, you will obtain an output similar to the following:</span></p>
<pre class="lstlisting" id="listing-75"><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">

  slack_03b79fa9-3faa-410c-800b-65cfaf281cdf_0 ... </span><span class="koboSpan" id="kobo.664.2" xmlns="http://www.w3.org/1999/xhtml">y1 energy num_oc. </span><span class="koboSpan" id="kobo.664.3" xmlns="http://www.w3.org/1999/xhtml">... 
 
</span><span class="koboSpan" id="kobo.664.4" xmlns="http://www.w3.org/1999/xhtml">0                                            0 ...  </span><span class="koboSpan" id="kobo.664.5" xmlns="http://www.w3.org/1999/xhtml">1   -3.0       5 ... 
 
</span><span class="koboSpan" id="kobo.664.6" xmlns="http://www.w3.org/1999/xhtml">1                                            1 ...  </span><span class="koboSpan" id="kobo.664.7" xmlns="http://www.w3.org/1999/xhtml">0   -2.0       3 ... 
 
</span><span class="koboSpan" id="kobo.664.8" xmlns="http://www.w3.org/1999/xhtml">2                                            0 ...  </span><span class="koboSpan" id="kobo.664.9" xmlns="http://www.w3.org/1999/xhtml">0   -2.0       1 ... 
 
</span><span class="koboSpan" id="kobo.664.10" xmlns="http://www.w3.org/1999/xhtml">3                                            0 ...  </span><span class="koboSpan" id="kobo.664.11" xmlns="http://www.w3.org/1999/xhtml">1    0.0       1 ... 
 
</span><span class="koboSpan" id="kobo.664.12" xmlns="http://www.w3.org/1999/xhtml">[’BINARY’, 4 rows, 10 samples, 4 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">We can all agree that this is not very informative. </span><span class="koboSpan" id="kobo.665.2" xmlns="http://www.w3.org/1999/xhtml">The problem here is that we are looking at solutions to the </span><span id="dx1-81038"/><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">transformed problem, which </span><span id="dx1-81039"/><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">include the slack variables with all those long, cryptic names. </span><span class="koboSpan" id="kobo.667.2" xmlns="http://www.w3.org/1999/xhtml">Of course, we don’t really care about the slack variable values — we only introduced them in order to write our problem without any constraints. </span><span class="koboSpan" id="kobo.667.3" xmlns="http://www.w3.org/1999/xhtml">So, what can we do? </span><span class="koboSpan" id="kobo.667.4" xmlns="http://www.w3.org/1999/xhtml">Here’s where the </span><code><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">invert</span></code><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml"> object comes to our rescue! </span><span class="koboSpan" id="kobo.669.2" xmlns="http://www.w3.org/1999/xhtml">It allows us to retrieve the solutions to the original problem from the solutions to the transformed one. </span><span class="koboSpan" id="kobo.669.3" xmlns="http://www.w3.org/1999/xhtml">Thus, we can run the following instructions:</span></p>
<pre class="lstlisting" id="listing-76"><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">

samples = [] 
 
occurrences = [] 
 
for s in result.data(): 
 
    samples.append(invert(s.sample)) 
 
    occurrences.append(s.num_occurrences) 
 
sampleset = dimod.SampleSet.from_samples_cqm(samples,cqm, 
 
    num_occurrences=occurrences) 
 
print("The solutions to the original problem are") 
 
print(sampleset)
</span></pre>
<p><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">and obtain the following output, which now only shows the original variables:</span></p>
<pre class="lstlisting" id="listing-77"><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml">

The solutions to the original problem are 
 
  y0 y1 energy num_oc. </span><span class="koboSpan" id="kobo.672.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.672.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.672.4" xmlns="http://www.w3.org/1999/xhtml">3  1  1   -5.0       1 arra...   </span><span class="koboSpan" id="kobo.672.5" xmlns="http://www.w3.org/1999/xhtml">False 
 
0  0  1   -3.0       5 arra...    </span><span class="koboSpan" id="kobo.672.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  1  0   -2.0       3 arra...    </span><span class="koboSpan" id="kobo.672.7" xmlns="http://www.w3.org/1999/xhtml">True 
 
2  1  0   -2.0       1 arra...    </span><span class="koboSpan" id="kobo.672.8" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 4 rows, 10 samples, 2 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml">Here, we have </span><span id="dx1-81056"/><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">created a new </span><code><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">SampleSet</span></code><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml"> object — the type of structure in which </span><code><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml"> stores the results of solvers or samplers — from the samples obtained with the transformed problem. </span><span class="koboSpan" id="kobo.678.2" xmlns="http://www.w3.org/1999/xhtml">Notice that we use </span><code><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">invert</span></code><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span id="dx1-81057"/><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">eliminate the slack variables and that, by passing the </span><code><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml">cqm</span></code><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml"> problem to the </span><code><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">from_samples_cqm</span></code><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml"> method, the energy without the penalties is computed, as well as the feasibility status of each assignment. </span><span class="koboSpan" id="kobo.685.2" xmlns="http://www.w3.org/1999/xhtml">In fact, notice that when printing the solutions that we sampled for the transformed problem, we obtained a solution with </span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml"> energy. </span><span class="koboSpan" id="kobo.687.2" xmlns="http://www.w3.org/1999/xhtml">It corresponds to the assignment </span><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0} = 1" class="math inline" src="../media/file450.png" style="vertical-align:middle" title="y_{0} = 1"/></span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{1} = 1" class="math inline" src="../media/file590.png" style="vertical-align:middle" title="y_{1} = 1"/></span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml">, which, on the original problem, had energy </span><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.693.2" xmlns="http://www.w3.org/1999/xhtml">The difference in the two energies comes from the fact that this assignment is unfeasible, and in the unconstrained problem it receives a penalty for it. </span><span class="koboSpan" id="kobo.693.3" xmlns="http://www.w3.org/1999/xhtml">Notice that we have also used the number of occurrences to keep track of how many times each solution is sampled.</span></p>
<p><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">So, in this way, we have recovered some solutions to the original problem, but there are a couple of details that we still need to fix. </span><span class="koboSpan" id="kobo.694.2" xmlns="http://www.w3.org/1999/xhtml">The first one is that if we want to only retain the feasible solutions, we need to use the </span><span class="lstinline"><span style="color:#A71D5D"><code><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml">filter</span></code></span></span><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml"> method as we did in the previous subsection when using </span><code><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">ExactCMQSolver</span></code><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.698.2" xmlns="http://www.w3.org/1999/xhtml">The second has to do with the repetition — which we can observe in the last two outputs — of the solution that sets </span><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0} = 1" class="math inline" src="../media/file450.png" style="vertical-align:middle" title="y_{0} = 1"/></span><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0} = 0" class="math inline" src="../media/file455.png" style="vertical-align:middle" title="y_{0} = 0"/></span><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.702.2" xmlns="http://www.w3.org/1999/xhtml">These two solutions come from two different assignments in the transformed problem, but they only differed in the values given to the slack variables. </span><span class="koboSpan" id="kobo.702.3" xmlns="http://www.w3.org/1999/xhtml">So, when those slack variables are eliminated, they produce exactly the same assignment. </span><span class="koboSpan" id="kobo.702.4" xmlns="http://www.w3.org/1999/xhtml">If we want them to be considered together, as they should be, we can use the </span><code><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml">aggregate</span></code><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml"> method. </span><span class="koboSpan" id="kobo.704.2" xmlns="http://www.w3.org/1999/xhtml">Putting it all together, we can execute this code:</span></p>
<pre class="lstlisting" id="listing-78"><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml">

final_sols = sampleset.filter(lambda s: s.is_feasible) 
 
final_sols = final_sols.aggregate() 
 
print("The final solutions are") 
 
print(final_sols)
</span></pre>
<p><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml">This will print</span></p>
<pre class="lstlisting" id="listing-79"><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">

  y0 y1 energy num_oc. </span><span class="koboSpan" id="kobo.707.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.707.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.707.4" xmlns="http://www.w3.org/1999/xhtml">0  0  1   -3.0       5 arra...    </span><span class="koboSpan" id="kobo.707.5" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  1  0   -2.0       4 arra...    </span><span class="koboSpan" id="kobo.707.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 2 rows, 9 samples, 2 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml">which is </span><span id="dx1-81066"/><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml">something that we can </span><span id="dx1-81067"/><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">indeed use to solve our problem.</span></p>
<p><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we have learned how to work with constrained problems and how to solve them both by brute force and with quantum annealers, transforming them into something that the quantum computer can use and then getting back to the original formulation. </span><span class="koboSpan" id="kobo.711.2" xmlns="http://www.w3.org/1999/xhtml">In the next section, we will study how to have more control over what the quantum annealer is doing in order to find the ground state of our Hamiltonians. </span><span class="koboSpan" id="kobo.711.3" xmlns="http://www.w3.org/1999/xhtml">Let’s fiddle a little bit with the inner workings of those shiny quantum computers!</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="11.4" id="solving-optimization-problems-on-quantum-annealers-with-leap">
<h1 class="sectionHead" data-number="11.4"><span class="titlemark"><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">4.4 </span></span> <span id="x1-820004.4"><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml">Solving optimization problems on quantum annealers with Leap</span></span></h1>
<p><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">So far, we have run a couple of different </span><span id="dx1-82001"/><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml">optimization problems on actual quantum annealers. </span><span class="koboSpan" id="kobo.715.2" xmlns="http://www.w3.org/1999/xhtml">However, we have </span><span id="dx1-82002"/><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml">always used the default parameters and we do not even know the characteristics of the quantum computers that we are using. </span><span class="koboSpan" id="kobo.716.2" xmlns="http://www.w3.org/1999/xhtml">In this section, we shall remedy that. </span><span class="koboSpan" id="kobo.716.3" xmlns="http://www.w3.org/1999/xhtml">We will explain the different types of annealers that we can access through D-Wave Leap. </span><span class="koboSpan" id="kobo.716.4" xmlns="http://www.w3.org/1999/xhtml">We will also explore several hyperparameters that we can tweak when we are using these devices, and we will explain how to adjust the way in which our problems are embedded in the physical qubits — we will finally learn what that mysterious </span><code><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml"> object is used for!</span></p>
<section class="level3 subsectionHead" data-number="11.4.1" id="the-leap-annealers">
<h2 class="subsectionHead" data-number="11.4.1"><span class="titlemark"><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">4.4.1 </span></span> <span id="x1-830004.4.1"><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml">The Leap annealers</span></span></h2>
<p><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml">You can list the devices to </span><span id="dx1-83001"/><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml">which you have access with your Leap account by using the </span><code><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml">get_solvers</span></code><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml"> method in this way:</span></p>
<pre class="lstlisting" id="listing-80"><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml">

from dwave.cloud import Client 
 
for solver in Client.from_config().get_solvers(): 
 
    print(solver)
</span></pre>
<p><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">The results will depend on your actual access privileges, but for a typical free account you will see </span><span id="dx1-83005"/><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">something like this:</span></p>
<pre class="lstlisting" id="listing-81"><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">

BQMSolver(id=’hybrid_binary_quadratic_model_version2’) 
 
DQMSolver(id=’hybrid_discrete_quadratic_model_version1’) 
 
CQMSolver(id=’hybrid_constrained_quadratic_model_version1’) 
 
StructuredSolver(id=’Advantage_system6.1’) 
 
StructuredSolver(id=’Advantage2_prototype1.1’) 
 
StructuredSolver(id=’DW_2000Q_6’) 
 
StructuredSolver(id=’Advantage_system4.1’)
</span></pre>
<p><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">In this case, there are seven different solvers in total, of three different types. </span><span class="koboSpan" id="kobo.729.2" xmlns="http://www.w3.org/1999/xhtml">First, we have those with the word </span><em><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">hybrid</span></em><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml"> in their identifier.</span><span id="dx1-83013"/><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml"> We will talk about them later in the chapter, but, for now, it suffices to know that they combine classical and quantum resources to solve problems. </span><span class="koboSpan" id="kobo.732.2" xmlns="http://www.w3.org/1999/xhtml">The other four, called </span><code><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system6</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml">Advantage2_prototype1</span></code></span><code><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml">, are pure quantum annealers. </span><span class="koboSpan" id="kobo.743.2" xmlns="http://www.w3.org/1999/xhtml">These are the devices that are selected when we use </span><code><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">DWaveSampler</span></code><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml"> to solve a problem, as we have been doing so far in this chapter. </span><span class="koboSpan" id="kobo.745.2" xmlns="http://www.w3.org/1999/xhtml">Let’s explore their properties in more detail.</span></p>
<p><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml">We can select a particular annealer by using the </span><code><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">solver</span></code><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml"> parameter in the </span><code><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">DWaveSampler</span></code><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml"> constructor and then access the properties of the device with the </span><code><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">properties</span></code><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml"> attribute. </span><span class="koboSpan" id="kobo.752.2" xmlns="http://www.w3.org/1999/xhtml">For instance, for the </span><code><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml"> annealer, we can run the following instructions</span></p>
<pre class="lstlisting" id="listing-82"><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">

from dwave.system import DWaveSampler 
 
sampler=DWaveSampler(solver=’DW_2000Q_6’) 
 
print("Name:",sampler.properties["chip_id"]) 
 
print("Number of qubits:",sampler.properties["num_qubits"]) 
 
print("Category:",sampler.properties["category"]) 
 
print("Supported problems:",sampler.properties["supported_problem_types"]) 
 
print("Topology:",sampler.properties["topology"]) 
 
print("Range of reads:",sampler.properties["num_reads_range"])
</span></pre>
<p><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">to obtain this output:</span></p>
<pre class="lstlisting" id="listing-83"><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml">

Name: DW_2000Q_6 
 
Number of qubits: 2048 
 
Category: qpu 
 
Supported problems: [’ising’, ’qubo’] 
 
Topology: {’type’: ’chimera’, ’shape’: [16, 16, 4]} 
 
Range of reads: [1, 10000]
</span></pre>
<p><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml">If we do the </span><span id="dx1-83028"/><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml">same but with the </span><code><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code></p>
<p><code><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml"> solver, we obtain:</span></p>
<pre class="lstlisting" id="listing-84"><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml">

Name: Advantage_system4.1 
 
Number of qubits: 5760 
 
Category: qpu 
 
Supported problems: [’ising’, ’qubo’] 
 
Topology: {’type’: ’pegasus’, ’shape’: [16]} 
 
Range of reads: [1, 10000]
</span></pre>
<p><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">The properties of the </span><code><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system6</span></code></p>
<p><code><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml"> solver will be exactly the same — except for the name, of course.</span></p>
<p><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">Finally, for the </span><code><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">Advantage2_prototype1</span></code></p>
<p><code><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml"> solver, we obtain the following output:</span></p>
<pre class="lstlisting" id="listing-85"><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">

Name: Advantage2_prototype1.1 
 
Number of qubits: 576 
 
Category: qpu 
 
Supported problems: [’ising’, ’qubo’] 
 
Topology: {’type’: ’zephyr’, ’shape’: [4, 4]} 
 
Range of reads: [1, 10000]
</span></pre>
<div class="tcolorbox learnmore" id="tcolobox-96">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content"><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">
The </span><span id="dx1-83041"/><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">solvers have many other properties that we haven’t yet discussed; we will study some of the most relevant ones in </span><em><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">Sections</span></em> <em/> <a href="#x1-840004.4.2"><em><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml">4.4.2</span></em></a><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="#x1-850004.4.3"><em><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml">4.4.3</span></em></a><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><a href="#x1-860004.4.4"><em><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml">4.4.4</span></em></a><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.783.2" xmlns="http://www.w3.org/1999/xhtml">You can nonetheless access all of them through the </span><code><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml">properties</span></code><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml"> dictionary, printing it directly. </span><span class="koboSpan" id="kobo.785.2" xmlns="http://www.w3.org/1999/xhtml">But be careful: some of them can be huge to print, such as </span><code><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">properties</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">[</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">qubits</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span>
<code><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml">]</span></code><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml">, which contains information about all the potentially thousands of qubits in a device!
</span></div>
</div>
<p><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml">Some </span><span id="dx1-83042"/><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml">properties are the same for the four devices. </span><span class="koboSpan" id="kobo.794.2" xmlns="http://www.w3.org/1999/xhtml">For instance, as we can see, all are of type </span><strong><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml">qpu</span></strong><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml">, which means that </span><span id="dx1-83043"/><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">they are </span><strong><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">quantum processing units</span></strong><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml"> or quantum annealers. </span><span class="koboSpan" id="kobo.799.2" xmlns="http://www.w3.org/1999/xhtml">Also, all of them accept problems in the QUBO or Ising formats — but not constrained problems; that is why we had to transform them before running them in the previous section — and all can be used to obtain between </span><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10\, 000" class="math inline" src="../media/file592.png" style="vertical-align:middle" title="10\, 000"/></span><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml"> samples at a time. </span><span class="koboSpan" id="kobo.803.2" xmlns="http://www.w3.org/1999/xhtml">The main difference, other than the number of qubits — which is </span><span id="dx1-83044"/><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">notably bigger in the </span><code><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system6</span></code></span><code><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml"> devices — is the </span><strong><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml">topology</span></strong><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.812.2" xmlns="http://www.w3.org/1999/xhtml">This refers to the way in which the qubits are connected to each other in the machine, and determines </span><span id="dx1-83045"/><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml">which </span><strong><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml">couplings</span></strong><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml"> — or connections between variables — can be used to define our problems…unless we use an embedding, which will help us in mapping our coefficients to actual qubit connections.</span></p>
<p><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml">Advantage2_prototype1</span></code></p>
<p><code><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml"> solver is a little bit special. </span><span class="koboSpan" id="kobo.819.2" xmlns="http://www.w3.org/1999/xhtml">As can be inferred from the name, it is a prototype of a new family of annealers that D-Wave will introduce in 2023-2024 — that’s why, for now, it has fewer qubits than the rest of the devices, but the full version has been announced to have more than </span><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7000" class="math inline" src="../media/file593.png" style="vertical-align:middle" title="7000"/></span><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml"> qubits. </span><span class="koboSpan" id="kobo.821.2" xmlns="http://www.w3.org/1999/xhtml">It uses a new topology, called Zephyr, which is designed to increase connectivity and decrease errors. </span><span class="koboSpan" id="kobo.821.3" xmlns="http://www.w3.org/1999/xhtml">At the time of writing, the available device is not a final version. </span><span class="koboSpan" id="kobo.821.4" xmlns="http://www.w3.org/1999/xhtml">For this reason, we will not use it in the examples that we will be working with, nor will we describe its properties and topology in detail. </span><span class="koboSpan" id="kobo.821.5" xmlns="http://www.w3.org/1999/xhtml">Notice, however, that everything that we explain about how to work with the devices translates, with no changes, to this new annealer.</span></p>
<p><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml">We have summarized some of the </span><span id="dx1-83046"/><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml">annealer properties in </span><em><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml">Table</span></em> <em/> <a href="#x1-83047r1"><em><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml">4.1</span></em></a><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div>
<div>
<table>
<colgroup>
<col style="width: 33%; border: 1px solid black;"/>
<col style="width: 33%; border: 1px solid black;"/>
<col style="width: 33%"/>
</colgroup>
<tbody>
<tr style="border: 1px solid black;">
<th style="text-align: center;"><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml">Annealer name</span></th>
<th style="text-align: center;"><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml">Number of qubits</span></th>
<th style="text-align: center;"><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml">Topology</span></th>
</tr>
<tr>
<td style="text-align: center;"><code><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml">DW</span></code><code><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml">_2000Q</span></code><span class="cmtt-10x-x-109"><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml">_6 </span></span></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml">2048</span></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">Chimera</span></td>
</tr>
<tr>
<td style="text-align: center;"><code><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml">Advantage</span></code><code><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml">_system4.1 </span></code></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml">5760</span></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml">Pegasus</span></td>
</tr>
<tr>
<td style="text-align: center;"><code><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml">Advantage</span></code><code><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml">_system6.1 </span></code></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml">5760</span></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml">Pegasus</span></td>
</tr>
<tr>
<td style="text-align: center;"><code><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml">Advantage2</span></code><code><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml">_prototype1.1 </span></code></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">576</span></td>
<td style="text-align: center;"><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml">Zephyr</span></td>
</tr>
</tbody>
</table>
</div>
<p style="text-align: center;"><span id="x1-83047r1"/> <span id="x1-83048"/> <span class="id" style="text-align: center;"><strong><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml">Table 4.1</span></strong><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml">Summary of annealer properties</span></p>
</div>
<p><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we shall explore in more detail the annealers’ topologies and how we can embed our problems in them.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.4.2" id="embeddings-and-annealer-topologies">
<h2 class="subsectionHead" data-number="11.4.2"><span class="titlemark"><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml">4.4.2 </span></span> <span id="x1-840004.4.2"><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml">Embeddings and annealer topologies</span></span></h2>
<p><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">In current quantum computers, be they annealers or gate-based devices, technological difficulties prevent qubits from being connected in an all-to-all way. </span><span class="koboSpan" id="kobo.853.2" xmlns="http://www.w3.org/1999/xhtml">In fact, each qubit is usually connected exclusively to some of its neighbours and we can only apply two-qubit gates or use couplings (that is, use non-zero coefficients in the Ising model) between those qubits that are actually linked. </span><span class="koboSpan" id="kobo.853.3" xmlns="http://www.w3.org/1999/xhtml">The particular way in which the qubits are connected in a certain quantum chip is </span><span id="dx1-84001"/><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml">called its </span><strong><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">topology</span></strong><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml"> and sometimes it is important to be aware of it when we design our algorithms or when we anneal our problems.</span></p>
<p><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">For instance, the topology of the </span><code><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml"> annealer is called, as we saw in the previous subsection, Chimera. </span><span class="koboSpan" id="kobo.859.2" xmlns="http://www.w3.org/1999/xhtml">It </span><span id="dx1-84002"/><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml">consists of cells of 8 qubits organized into two groups of 4 qubits each. </span><span class="koboSpan" id="kobo.860.2" xmlns="http://www.w3.org/1999/xhtml">All the qubits in one group are connected to all the qubits in the other group, but there are no connections inside each group. </span><span class="koboSpan" id="kobo.860.3" xmlns="http://www.w3.org/1999/xhtml">For graph connoisseurs, the connections follow a complete bipartite graph </span><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="K_{4,4}" class="math inline" src="../media/file594.png" style="vertical-align:middle" title="K_{4,4}"/></span><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml">, which is depicted in </span><em><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure4.1"><em><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml">4.1</span></em></a><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 4.1: Qubit connections in a Chimera cell" src="../media/file595.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure4.1"><strong><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">Figure 4.1</span></strong><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml">Qubit connections in a Chimera cell</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml"> computer has </span><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="256" class="math inline" src="../media/file596.png" style="vertical-align:middle" title="256"/></span><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml"> of these cells, organized in a </span><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="16 \times 16" class="math inline" src="../media/file597.png" style="vertical-align:middle" title="16 \times 16"/></span><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml"> grid, making for a total of </span><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="8 \cdot 16 \cdot 16 = 2048" class="math inline" src="../media/file598.png" style="vertical-align:middle" title="8 \cdot 16 \cdot 16 = 2048"/></span><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, as expected. </span><span class="koboSpan" id="kobo.878.2" xmlns="http://www.w3.org/1999/xhtml">Each of the qubits that occupy the positions </span><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml"> in a cell is also connected to the qubits in the same position of the vertically adjacent cells. </span><span class="koboSpan" id="kobo.882.2" xmlns="http://www.w3.org/1999/xhtml">In a similar way, each qubit in positions </span><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml"> is also connected to the qubit in the same position of the </span><span id="dx1-84005"/><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml">horizontally adjacent cells. </span><span class="koboSpan" id="kobo.887.2" xmlns="http://www.w3.org/1999/xhtml">In total, each qubit will be connected to four other qubits in the same cell and to two other qubits (or one, if it lives in a border cell) from other cells.</span></p>
<p><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">We can obtain a list enumerating all the connections by using the </span><code><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml">properties</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml">[</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">couplers</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><code><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml">]</span></code><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml"> attribute as follows:</span></p>
<pre class="lstlisting" id="listing-86"><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">

sampler=DWaveSampler(solver=’DW_2000Q_6’) 
 
print("Couplings:",sampler.properties["couplers"])
</span></pre>
<p><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">Running this, we will get a very long list that begins like this:</span></p>
<pre class="lstlisting" id="listing-87"><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">

[[0, 4], [1, 4], [2, 4], [3, 4], [0, 5], [1, 5], [2, 5], [3, 5], 
 
[0, 6], [1, 6], [2, 6], [3, 6], [0, 7], [1, 7], [2, 7], [3, 7], 
 
[4, 12], [8, 12], [9, 12], [10, 12], [11, 12], [5, 13], [8, 13], 
 
[9, 13], [10, 13], [11, 13], [6, 14], [8, 14], [9, 14], [10, 14], 
 
[11, 14], [7, 15], [8, 15], [9, 15], [10, 15], [11, 15], [12, 20], 
 
[16, 20], [17, 20], [18, 20], [19, 20], [13, 21], [16, 21], 
 
[17, 21], [18, 21], [19, 21], [16, 22], [17, 22]...
</span></pre>
<p><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">A slightly more readable way of obtaining the same information is by using </span><code><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">sampler</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">adjacency</span></code><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml">, which will we give us a dictionary indexed by qubit numbers and values that specify the qubits that are connected to the qubit in the key. </span><span class="koboSpan" id="kobo.903.2" xmlns="http://www.w3.org/1999/xhtml">In our case, it starts like this:</span></p>
<pre class="lstlisting" id="listing-88"><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml">

{0: {4, 5, 6, 7, 128}, 1: {4, 5, 6, 7, 129}, 
 
 2: {4, 5, 6, 7, 130}, 3: {4, 5, 6, 7, 131}, 
 
 4: {0, 1, 2, 3, 12}, 5: {0, 1, 2, 3, 13}, 
 
 6: {0, 1, 2, 3, 14}, 7: {0, 1, 2, 3, 15}, 
 
 8: {12, 13, 14, 15, 136}, ...
</span></pre>
<div class="tcolorbox questionx" id="tcolobox-97">
<span id="x1-84021x4.4.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 4.4</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">Pick the qubits numbered from </span><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml"> and check that their connections correspond to the description of the Chimera topology that we have made in the text. </span><span class="koboSpan" id="kobo.910.2" xmlns="http://www.w3.org/1999/xhtml">Notice that they all lie in the top-left corner cell, so they will be connected to one cell on the right and one cell below.</span></p>
</div>
</div>
<div class="tcolorbox learnmore" id="tcolobox-98">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content"><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml">
The </span><code><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system6</span></code></span>
<code><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml"> annealers use a topology called </span><strong><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">Pegasus</span></strong><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.921.2" xmlns="http://www.w3.org/1999/xhtml">It also </span><span id="dx1-84022"/><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">groups qubits into cells, but their structure is more involved than that of the Chimera cells. </span><span class="koboSpan" id="kobo.922.2" xmlns="http://www.w3.org/1999/xhtml">Every qubit is connected to up to </span><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="15" class="math inline" src="../media/file599.png" style="vertical-align:middle" title="15"/></span><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml"> qubits, compared to the maximum of </span><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><code><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml">.
</span><p><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml">This topology also contains groups of 4 qubits that are all connected to each other, making it much easier to embed problems into it, as we will see later in the </span><em><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-840004.4.2"><em><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml">4.4.2</span></em></a><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml">
Describing the Pegasus topology in detail would get us too far out from our path, but you can find all the information in </span><em><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml">Section 2.3</span></em><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml"> of the </span><em><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml">QPU-Specific Physical Properties</span></em><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml"> document for the </span><code><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system6</span></code></span>
<code><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml"> annealers. </span><span class="koboSpan" id="kobo.943.2" xmlns="http://www.w3.org/1999/xhtml">You can download it, together with the corresponding documents for the rest of the D-Wave quantum computers, at </span><a class="url" href="https://docs.dwavesys.com/docs/latest/doc_physical_properties.html"><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">https://docs.dwavesys.com/docs/latest/doc_physical_properties.html</span></a><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml">.
</span></div>
</div>
<p><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml">One important thing to note about the </span><span id="dx1-84023"/><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml">Chimera topology is that it does not contain triangles. </span><span class="koboSpan" id="kobo.947.2" xmlns="http://www.w3.org/1999/xhtml">That is, there are no three vertices all connected to each other. </span><span class="koboSpan" id="kobo.947.3" xmlns="http://www.w3.org/1999/xhtml">Thus, if our Ising Hamiltonian is something like </span><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} + Z_{0}Z_{2} + Z_{1}Z_{2}" class="math inline" src="../media/file600.png" style="vertical-align:middle" title="Z_{0}Z_{1} + Z_{0}Z_{2} + Z_{1}Z_{2}"/></span><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml">, we cannot directly map it to qubits in the </span><code><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"> annealer. </span><span class="koboSpan" id="kobo.951.2" xmlns="http://www.w3.org/1999/xhtml">What can we do then? </span><span class="koboSpan" id="kobo.951.3" xmlns="http://www.w3.org/1999/xhtml">Is it impossible to solve such a problem with this computer? </span><span class="koboSpan" id="kobo.951.4" xmlns="http://www.w3.org/1999/xhtml">Don’t worry, embeddings are here to save the day!</span></p>
<p><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml">An </span><strong><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">embedding</span></strong><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml"> is, essentially, a way of </span><span id="dx1-84024"/><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml">mapping the qubits in our problem Hamiltonian to the physical qubits in the annealer. </span><span class="koboSpan" id="kobo.955.2" xmlns="http://www.w3.org/1999/xhtml">The trick here is that this mapping need not be one to one. </span><span class="koboSpan" id="kobo.955.3" xmlns="http://www.w3.org/1999/xhtml">In fact, we can use several physical qubits (what we call a </span><strong><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml">chain</span></strong><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml">) to represent a single qubit from our problem. </span><span class="koboSpan" id="kobo.957.2" xmlns="http://www.w3.org/1999/xhtml">In that case, though, we want all the qubits in the same chain to have the same value when we measure them. </span><span class="koboSpan" id="kobo.957.3" xmlns="http://www.w3.org/1999/xhtml">To guarantee that, we need to use coupling strengths that are negative and big in absolute value.</span></p>
<p><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml">For instance, if qubits </span><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="12" class="math inline" src="../media/file601.png" style="vertical-align:middle" title="12"/></span><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml"> are part of the same chain, the coefficient for </span><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(12,20)" class="math inline" src="../media/file602.png" style="vertical-align:middle" title="(12,20)"/></span><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"> could be, for instance, </span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 15" class="math inline" src="../media/file587.png" style="vertical-align:middle" title="- 15"/></span><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.966.2" xmlns="http://www.w3.org/1999/xhtml">Then, the term </span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 15Z_{12}Z_{20}" class="math inline" src="../media/file603.png" style="vertical-align:middle" title="- 15Z_{12}Z_{20}"/></span><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml"> will be part of the spin Hamiltonian that we want to minimize and it will make it very likely for </span><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{12}" class="math inline" src="../media/file604.png" style="vertical-align:middle" title="Z_{12}"/></span><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{20}" class="math inline" src="../media/file605.png" style="vertical-align:middle" title="Z_{20}"/></span><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml"> to be equal to each other, because that will make the total energy significantly lower.</span></p>
<p><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml">Of course, the embedding needs to define the physical qubits (chains) used to represent each problem qubit, ensure that they can be connected correctly, and compute some appropriate coupling strengths for the chains. </span><span class="koboSpan" id="kobo.973.2" xmlns="http://www.w3.org/1999/xhtml">This may seem very complicated, but Ocean can compute embeddings automatically for us. </span><span class="koboSpan" id="kobo.973.3" xmlns="http://www.w3.org/1999/xhtml">Let’s see, with an example, how to do it for a simple case. </span><span class="koboSpan" id="kobo.973.4" xmlns="http://www.w3.org/1999/xhtml">We could use the following code:</span></p>
<pre class="lstlisting" id="listing-89"><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml">

# Define the problem 
 
J = {(0,1):1, (0,2):1, (1,2):1} 
 
h = {} 
 
triangle = dimod.BinaryQuadraticModel(h, J, 0.0, dimod.SPIN) 
 
# Embed it and solve it on the DW_2000Q_6 annealer 
 
sampler = EmbeddingComposite(DWaveSampler(solver = "DW_2000Q_6")) 
 
result = sampler.sample(triangle, num_reads=10, 
 
    return_embedding = True) 
 
print("The samples obtained are") 
 
print(result) 
 
print("The embedding used was") 
 
print(result.info["embedding_context"])
</span></pre>
<p><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">In these instructions, we first define a problem that requires three qubits to be connected together, something that we know is not directly possible with the annealer that we have selected. </span><span class="koboSpan" id="kobo.975.2" xmlns="http://www.w3.org/1999/xhtml">But, since we are using </span><code><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">, a way of </span><span id="dx1-84037"/><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml">embedding our graph in the actual annealer topology is automatically found for us, and we can run the annealing process and obtain some samples. </span><span class="koboSpan" id="kobo.978.2" xmlns="http://www.w3.org/1999/xhtml">By setting the </span><code><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml">return_embedding</span></code><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml"> parameter to </span><code><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml">, we also recover the embedding information. </span><span class="koboSpan" id="kobo.982.2" xmlns="http://www.w3.org/1999/xhtml">Let’s see what the output of running this code may look like:</span></p>
<pre class="lstlisting" id="listing-90"><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml">

The samples obtained are 
 
   0  1  2 energy num_oc. </span><span class="koboSpan" id="kobo.983.2" xmlns="http://www.w3.org/1999/xhtml">chain_. 
 
</span><span class="koboSpan" id="kobo.983.3" xmlns="http://www.w3.org/1999/xhtml">0 +1 -1 -1   -1.0       3     0.0 
 
1 +1 +1 -1   -1.0       2     0.0 
 
2 +1 -1 +1   -1.0       2     0.0 
 
3 -1 +1 +1   -1.0       3     0.0 
 
[’SPIN’, 4 rows, 10 samples, 3 variables] 
 
The embedding used was 
 
{’embedding’: {1: (1015, 1008), 0: (1011,), 2: (1012,)}, 
 
’chain_break_method’: ’majority_vote’, ’embedding_parameters’: {}, 
 
’chain_strength’: 1.9996979771955565}
</span></pre>
<p><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, </span><code><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml"> performs the embedding in a way that is completely transparent for the user and, in fact, the samples returned only refer to the variables in the original problem. </span><span class="koboSpan" id="kobo.986.2" xmlns="http://www.w3.org/1999/xhtml">However, underneath the hood, variable </span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml"> has been mapped to qubit </span><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1011" class="math inline" src="../media/file606.png" style="vertical-align:middle" title="1011"/></span><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml">, variable </span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml"> has been mapped to qubit </span><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1012" class="math inline" src="../media/file607.png" style="vertical-align:middle" title="1012"/></span><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml">, and variable </span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"> is represented by the chain formed by qubits </span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1008" class="math inline" src="../media/file608.png" style="vertical-align:middle" title="1008"/></span><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1015" class="math inline" src="../media/file609.png" style="vertical-align:middle" title="1015"/></span><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1000.2" xmlns="http://www.w3.org/1999/xhtml">The coupling strength for these two qubits was almost </span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml">, which is bigger than the coefficients of the original problem in order to prevent the qubits in the chain from having different values. </span><span class="koboSpan" id="kobo.1002.2" xmlns="http://www.w3.org/1999/xhtml">If, for whatever reason, these two qubits in the chain happen to receive different values, the chain is said to be </span><strong><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml">broken</span></strong><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml"> and the method specified in </span><span class="lstinline"><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">chain_break_method</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml">’</span></code></span></span><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml"> would be used to assign a value to variable </span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1010.2" xmlns="http://www.w3.org/1999/xhtml">In this case, that value would be a simple majority vote between the qubits in the chain.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-99">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">Finding a suitable embedding is an </span><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">-hard problem. </span><span class="koboSpan" id="kobo.1015.2" xmlns="http://www.w3.org/1999/xhtml">However, the </span><code><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml">minorminer</span></code><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml"> package included with Ocean provides heuristics for finding embeddings that usually work well in practice. </span><span class="koboSpan" id="kobo.1017.2" xmlns="http://www.w3.org/1999/xhtml">These are used by </span><code><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml">In addition to </span><code><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">, there are other classes in Ocean that allow you to find embeddings for your problems. </span><span class="koboSpan" id="kobo.1022.2" xmlns="http://www.w3.org/1999/xhtml">For instance, </span><code><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml">AutoEmbeddingComposite</span></code><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml"> first tries to run the problem on the annealer directly, not using an </span><span id="dx1-84049"/><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml">embedding, and only looks for one if it is needed; this can save some computing time in some cases. </span><span class="koboSpan" id="kobo.1025.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">FixedEmbeddingComposite</span></code><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml"> class doesn’t compute an embedding, but uses whichever one is passed as a parameter; in this case, the embedding should be a Python dictionary with the format shown in the previous output. </span><span class="koboSpan" id="kobo.1027.2" xmlns="http://www.w3.org/1999/xhtml">We also can use </span><code><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">LazyFixedEmbeddingComposite</span></code><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml">, which only computes the embedding for a problem on the first call to the </span><code><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml"> method, storing it for future calls; </span><code><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml">, on the other hand, recomputes the embedding with each call to </span><code><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">So, that should cover most of your needs for embedding problems into any annealer topology. </span><span class="koboSpan" id="kobo.1036.2" xmlns="http://www.w3.org/1999/xhtml">But we’re not done yet! </span><span class="koboSpan" id="kobo.1036.3" xmlns="http://www.w3.org/1999/xhtml">There are still some additional parameters that we can control when running problems with Ocean on actual quantum devices. </span><span class="koboSpan" id="kobo.1036.4" xmlns="http://www.w3.org/1999/xhtml">We will study some of the most important ones in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.4.3" id="controlling-annealing-parameters">
<h2 class="subsectionHead" data-number="11.4.3"><span class="titlemark"><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">4.4.3 </span></span> <span id="x1-850004.4.3"><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">Controlling annealing parameters</span></span></h2>
<p><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml">You surely remember from the </span><span id="dx1-85001"/><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">beginning of this chapter that for an evolution to be adiabatic (and, hence, for the system to remain in a state of minimal energy), it needs to be slow enough. </span><span class="koboSpan" id="kobo.1040.2" xmlns="http://www.w3.org/1999/xhtml">However, this condition is difficult to meet in practice, so we just resort to running the evolution for a short period of time, resulting in what we call quantum annealing.</span></p>
<p><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">The question is: to what extent can we control the </span><span id="dx1-85002"/><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">annealing process with D-Wave’s quantum annealers? </span><span class="koboSpan" id="kobo.1042.2" xmlns="http://www.w3.org/1999/xhtml">It turns out that there are quite a number of things that we can do in order to try to improve the results for our combinatorial optimization problems. </span><span class="koboSpan" id="kobo.1042.3" xmlns="http://www.w3.org/1999/xhtml">The first (and most obvious) is changing the duration of the annealing process.</span></p>
<p><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">You can easily check the range of annealing times that a device supports, as well as its default annealing time, using instructions like the following:</span></p>
<pre class="lstlisting" id="listing-91"><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">

sampler = DWaveSampler(solver = "Advantage_system4.1") 
 
print("The default annealing time is", 
 
    sampler.properties["default_annealing_time"],"microseconds") 
 
print("The possible values for the annealing time (in microseconds)"\ 
 
    " lie in the range",sampler.properties["annealing_time_range"])
</span></pre>
<p><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml">The output, in this case, will be as follows:</span></p>
<pre class="lstlisting" id="listing-92"><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml">

The default annealing time is 20.0 microseconds 
 
The possible values for the annealing time (in microseconds) 
 
    lie in the range [0.5, 2000.0]
</span></pre>
<div class="tcolorbox questionx" id="tcolobox-100">
<span id="x1-85012x4.4.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 4.5</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml">Check the default annealing time and the annealing time range for the </span><code><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml">DW_2000Q_6</span></code><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml"> annealer.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">Modifying the </span><span id="dx1-85013"/><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">annealing time for a problem couldn’t be easier. </span><span class="koboSpan" id="kobo.1052.2" xmlns="http://www.w3.org/1999/xhtml">For instance, imagine that we want to increase it to </span><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml"> microseconds and sample from the triangle problem that we defined in the previous subsection. </span><span class="koboSpan" id="kobo.1054.2" xmlns="http://www.w3.org/1999/xhtml">Then, the only modification that we would need to apply is adding the </span><code><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml">annealing_time</span></code><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml"> parameter when calling the </span><code><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml"> method. </span><span class="koboSpan" id="kobo.1058.2" xmlns="http://www.w3.org/1999/xhtml">We could run, for instance, the following code:</span></p>
<pre class="lstlisting" id="listing-93"><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml">

J = {(0,1):1, (0,2):1, (1,2):1} 
 
h = {} 
 
triangle = dimod.BinaryQuadraticModel(h, J, 0.0, dimod.SPIN) 
 
sampler = EmbeddingComposite(DWaveSampler(solver = "DW_2000Q_6")) 
 
result = sampler.sample(triangle, num_reads=10, annealing_time = 100) 
 
print("The samples obtained are") 
 
print(result)
</span></pre>
<div class="tcolorbox important" id="tcolobox-101">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml">In order to try to obtain better and better solutions, you may be tempted to increase the annealing time to its maximum possible value. </span><span class="koboSpan" id="kobo.1061.2" xmlns="http://www.w3.org/1999/xhtml">However, be warned that this may have two unwanted consequences. </span><span class="koboSpan" id="kobo.1061.3" xmlns="http://www.w3.org/1999/xhtml">On the one hand, the longer you run the annealing process, the higher the possibility that external interactions will affect the system state and ruin your computation: you might get worse results instead of better ones! </span><span class="koboSpan" id="kobo.1061.4" xmlns="http://www.w3.org/1999/xhtml">On the other hand, by increasing the annealing time, you will obviously spend more time using the quantum processing unit…and you will be charged accordingly!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml">With Ocean, the options to control the </span><span id="dx1-85021"/><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml">annealing process are not reduced to just modifying the annealing time. </span><span class="koboSpan" id="kobo.1063.2" xmlns="http://www.w3.org/1999/xhtml">You can also tailor, to some extent, the annealing schedule itself. </span><span class="koboSpan" id="kobo.1063.3" xmlns="http://www.w3.org/1999/xhtml">As we already know, this refers to the </span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"> functions in the expression</span></p>
<p><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t) = - A(t)\sum\limits_{j = 0}^{n - 1}X_{j} - B(t)\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - B(t)\sum\limits_{j}h_{j}Z_{j}," class="math display" src="../media/file561.png" style="vertical-align:middle" title="H(t) = - A(t)\sum\limits_{j = 0}^{n - 1}X_{j} - B(t)\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - B(t)\sum\limits_{j}h_{j}Z_{j},"/></span></p>
<p><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml">which defines the Hamiltonian that we use in the annealing process.</span></p>
<p><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml">You may remember that we only required </span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml"> to satisfy that </span><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(0) = B(T) = 1" class="math inline" src="../media/file548.png" style="vertical-align:middle" title="A(0) = B(T) = 1"/></span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(T) = B(0) = 0" class="math inline" src="../media/file549.png" style="vertical-align:middle" title="A(T) = B(0) = 0"/></span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"> is the total annealing time, but we did not restrict in any way how </span><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml"> should behave except for these boundary conditions. </span><span class="koboSpan" id="kobo.1084.2" xmlns="http://www.w3.org/1999/xhtml">D-Wave’s annealers have default schedules. </span><span class="koboSpan" id="kobo.1084.3" xmlns="http://www.w3.org/1999/xhtml">You can find them at </span><a class="url" href="https://docs.dwavesys.com/docs/latest/doc_physical_properties.html"><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml">https://docs.dwavesys.com/docs/latest/doc_physical_properties.html</span></a><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"> and in the annealing schedule sections of the user manuals for the devices, which you can find on that same web page. </span><span class="koboSpan" id="kobo.1086.2" xmlns="http://www.w3.org/1999/xhtml">We can modify those default schedules by specifying the values that we want the functions to take at some intermediate times.</span></p>
<p><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml">We can define a custom annealing schedule through a list of pairs of real numbers. </span><span class="koboSpan" id="kobo.1087.2" xmlns="http://www.w3.org/1999/xhtml">The first number of each pair needs to be a time value given in microseconds and the second one has to be a number between </span><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1091.2" xmlns="http://www.w3.org/1999/xhtml">This second </span><span id="dx1-85022"/><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml">number is called the </span><strong><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml">anneal fraction</span></strong><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml">, usually denoted by </span><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1096.2" xmlns="http://www.w3.org/1999/xhtml">The higher the value of </span><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml"> is, the higher the value of </span><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml"> and the lower the value of </span><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml"> will be. </span><span class="koboSpan" id="kobo.1102.2" xmlns="http://www.w3.org/1999/xhtml">As a consequence, when </span><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s = 1" class="math inline" src="../media/file611.png" style="vertical-align:middle" title="s = 1"/></span><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml">, we can interpret that </span><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml"> is 0; when </span><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s = 0" class="math inline" src="../media/file612.png" style="vertical-align:middle" title="s = 0"/></span><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">, we can interpret that </span><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml">There are two types of annealing schedules that we can use. </span><span class="koboSpan" id="kobo.1121.2" xmlns="http://www.w3.org/1999/xhtml">The first one is called </span><strong><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">forward annealing</span></strong><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span id="dx1-85023"/><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml">corresponds to the usual </span><span id="dx1-85024"/><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml">annealing process that we have been studying since the beginning of this chapter. </span><span class="koboSpan" id="kobo.1125.2" xmlns="http://www.w3.org/1999/xhtml">It starts with </span><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,0)" class="math inline" src="../media/file613.png" style="vertical-align:middle" title="(0,0)"/></span><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml"> and ends at </span><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(T,1)" class="math inline" src="../media/file614.png" style="vertical-align:middle" title="(T,1)"/></span><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml"> is the total annealing time — which, of course, must not be bigger than the maximum annealing time allowed by the device. </span><span class="koboSpan" id="kobo.1131.2" xmlns="http://www.w3.org/1999/xhtml">In addition, the values of </span><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml"> must monotonically increase over the time points.</span></p>
<p><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml">An example of a forward annealing schedule could be the following:</span></p>
<pre class="lstlisting" id="listing-94"><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">

forward_schedule=[[0.0, 0.0], [5.0, 0.25], [25, 0.75], [30, 1.0]]
</span></pre>
<p><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml">In this case, </span><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml"> starts at </span><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml">, gets value </span><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.25" class="math inline" src="../media/file615.png" style="vertical-align:middle" title="0.25"/></span><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml"> at 5 microseconds, </span><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.75" class="math inline" src="../media/file616.png" style="vertical-align:middle" title="0.75"/></span><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml"> at 25 microseconds and, finally, </span><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml"> at 30 microseconds, which is the end of the annealing process. </span><span class="koboSpan" id="kobo.1146.2" xmlns="http://www.w3.org/1999/xhtml">The growth of </span><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml"> will be linear between the points specified in the schedule. </span><span class="koboSpan" id="kobo.1148.2" xmlns="http://www.w3.org/1999/xhtml">To use this custom schedule in a device, you only need to pass it as the </span><code><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml">anneal_schedule</span></code><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml"> parameter. </span><span class="koboSpan" id="kobo.1150.2" xmlns="http://www.w3.org/1999/xhtml">For instance, you can do something like the following:</span></p>
<pre class="lstlisting" id="listing-95"><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml">

forward_schedule=[[0.0, 0.0], [5.0, 0.25], [25, 0.75], [30, 1.0]] 
 
sampler = EmbeddingComposite(DWaveSampler()) 
 
result = sampler.sample(triangle, num_reads=10, 
 
    anneal_schedule = forward_schedule)
</span></pre>
<p><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml">Here, </span><code><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml">triangle</span></code><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml"> is the problem that we defined in the previous code block.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-102">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml">Controlling the annealing schedule can be useful for certain problems, especially if you know that at some points the ground state and the first excited state are closer. </span><span class="koboSpan" id="kobo.1157.2" xmlns="http://www.w3.org/1999/xhtml">In this case, you can use a custom schedule to slow the annealing process down on those ”dangerous” regions, while allowing it to go faster on other, less problematic, time intervals. </span><span id="dx1-85030"/></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml">In addition to forward annealing, we can also use </span><strong><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml">reverse annealing</span></strong><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1160.2" xmlns="http://www.w3.org/1999/xhtml">In </span><span id="dx1-85031"/><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">reverse annealing, </span><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml"> starts at </span><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">, decreases for some time, and then increases back to </span><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml"> at the end of the annealing process. </span><span class="koboSpan" id="kobo.1167.2" xmlns="http://www.w3.org/1999/xhtml">An example of a reverse annealing schedule could be</span></p>
<pre class="lstlisting" id="listing-96"><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml">

reverse_schedule=[[0.0, 1.0], [10.0, 0.5], [20, 1.0]]
</span></pre>
<p><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml">where, as in the case of forward annealing, the values of </span><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s" class="math inline" src="../media/file610.png" style="vertical-align:middle" title="s"/></span><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml"> are linearly interpolated between the points given in the list.</span></p>
<p><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">When using reverse annealing, you also need to specify an initial state. </span><span class="koboSpan" id="kobo.1172.2" xmlns="http://www.w3.org/1999/xhtml">This is because now we do not start with a Hamiltonian whose ground state is known to us. </span><span class="koboSpan" id="kobo.1172.3" xmlns="http://www.w3.org/1999/xhtml">You can do that with the </span><code><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml">initial_state</span></code><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml"> parameter of the </span><code><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml"> method. </span><span class="koboSpan" id="kobo.1176.2" xmlns="http://www.w3.org/1999/xhtml">Reverse annealing is commonly used on an </span><span id="dx1-85033"/><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml">approximate solution that we already have in an attempt to find a better one. </span><span class="koboSpan" id="kobo.1177.2" xmlns="http://www.w3.org/1999/xhtml">In this case, we take that solution to be the initial state, we decrease the intensity of the final Hamiltonian for some time, and then we increase it again in an attempt to obtain a new solution with a lower energy.</span></p>
<p><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">There are two different ways in which we can use reverse annealing. </span><span class="koboSpan" id="kobo.1178.2" xmlns="http://www.w3.org/1999/xhtml">We can run several repetitions of the annealing process on the same initial state with the </span><code><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">reinitialize_state</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml"> option when calling </span><code><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1184.2" xmlns="http://www.w3.org/1999/xhtml">Alternatively, we can use the final (measured) state of one execution as the initial state of the next one by setting </span><code><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml">reinitialize_state</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><code><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml">False</span></code><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml">Let’s now look at an example in which we will apply reverse annealing to a simple problem. </span><span class="koboSpan" id="kobo.1189.2" xmlns="http://www.w3.org/1999/xhtml">The following code, in which we use the </span><code><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml">triangle</span></code><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml"> problem defined previously, is almost self-explanatory:</span></p>
<pre class="lstlisting" id="listing-97"><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml">

reverse_schedule=[[0.0, 1.0], [10.0, 0.5], [20, 1.0]] 
 
initial_state = {0:1, 1:1, 2:1} 
 
sampler = EmbeddingComposite(DWaveSampler()) 
 
result = sampler.sample(triangle, num_reads=10, 
 
    anneal_schedule = reverse_schedule, 
 
    reinitialize_state=False, initial_state = initial_state) 
 
print("The samples obtained are") 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml">A possible output of these </span><span id="dx1-85042"/><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml">instructions could be the following:</span></p>
<pre class="lstlisting" id="listing-98"><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml">

The samples obtained are 
 
   0  1  2 energy num_oc. </span><span class="koboSpan" id="kobo.1195.2" xmlns="http://www.w3.org/1999/xhtml">chain_. 
 
</span><span class="koboSpan" id="kobo.1195.3" xmlns="http://www.w3.org/1999/xhtml">0 -1 +1 -1   -1.0       1     0.0 
 
1 +1 +1 -1   -1.0       1     0.0 
 
2 +1 +1 -1   -1.0       1     0.0 
 
3 -1 +1 -1   -1.0       1     0.0 
 
4 -1 -1 +1   -1.0       1     0.0 
 
5 +1 -1 +1   -1.0       1     0.0 
 
6 +1 +1 -1   -1.0       1     0.0 
 
7 +1 +1 -1   -1.0       1     0.0 
 
8 +1 -1 -1   -1.0       1     0.0 
 
9 -1 +1 -1   -1.0       1     0.0 
 
[’SPIN’, 10 rows, 10 samples, 3 variables]
</span></pre>
<div class="tcolorbox learnmore" id="tcolobox-103">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml">Some researchers have found that reverse annealing can be more effective than forward annealing for some problems. </span><span class="koboSpan" id="kobo.1198.2" xmlns="http://www.w3.org/1999/xhtml">For a very illuminating example, please check the paper by Carugno et al. </span><span class="cite"><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xcarugno2022evaluating"><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml">23</span></a><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml">Now, we know how to control both the </span><span id="dx1-85056"/><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">annealing time and the schedule. </span><span class="koboSpan" id="kobo.1204.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will explain why it is important to set the coupling strengths and the penalty terms wisely, something that is easily overlooked, but that can greatly affect the results of our executions.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.4.4" id="the-importance-of-coupling-strengths">
<h2 class="subsectionHead" data-number="11.4.4"><span class="titlemark"><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml">4.4.4 </span></span> <span id="x1-860004.4.4"><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml">The importance of coupling strengths</span></span></h2>
<p><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml">You surely </span><span id="dx1-86001"/><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml">remember that there are a couple of situations in which we have to select values for some arbitrary constants that are used to set coupling strengths in the annealer. </span><span class="koboSpan" id="kobo.1208.2" xmlns="http://www.w3.org/1999/xhtml">The first situation is having to introduce constraints as penalty terms in the objective function, using the </span><code><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml"> parameter in the </span><code><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml">cqm_to_bqm</span></code><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml"> method of the </span><code><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml"> package. </span><span class="koboSpan" id="kobo.1214.2" xmlns="http://www.w3.org/1999/xhtml">The second one is having to select the coupling strengths for the chains in a particular embedding, which is usually handled automatically by classes such as </span><code><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml">It would be very natural to think that you would want these constants to be as big as possible. </span><span class="koboSpan" id="kobo.1217.2" xmlns="http://www.w3.org/1999/xhtml">After all, you are not interested in solutions that do not satisfy the problem constraints and you do not want your chains to be broken. </span><span class="koboSpan" id="kobo.1217.3" xmlns="http://www.w3.org/1999/xhtml">However, there is an important detail that makes choosing the values of these constants a little bit trickier than expected.</span><span id="dx1-86002"/></p>
<p><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml">It turns out that the range of values that you use for qubit couplings in D-Wave’s annealers is not arbitrarily large. </span><span class="koboSpan" id="kobo.1218.2" xmlns="http://www.w3.org/1999/xhtml">For example, the following instructions allow us to check what the possible values are for the case of the </span><code><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code></p>
<p><code><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml"> device — and, of course, if you change the solver name, you can get the values for any other annealers as well:</span></p>
<pre class="lstlisting" id="listing-99"><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml">

sampler = DWaveSampler("Advantage_system4.1") 
 
print("The coupling strength range is", sampler.properties["h_range"])
</span></pre>
<p><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml">The output that you will get if you run these instructions is the following:</span></p>
<pre class="lstlisting" id="listing-100"><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml">

The coupling strength range is [-4.0, 4.0]
</span></pre>
<p><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml">This means that, if you set coupling strengths (that is, </span><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J" class="math inline" src="../media/file617.png" style="vertical-align:middle" title="J"/></span><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml"> coefficients) that in absolute value are bigger than </span><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">, the largest one will be scaled down to </span><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml">…and the rest of the coefficients in your model will be scaled down accordingly. </span><span class="koboSpan" id="kobo.1231.2" xmlns="http://www.w3.org/1999/xhtml">This can cause some of the values to be very close together, even closer than the resolution of the device, affecting the results of the annealing process. </span><span class="koboSpan" id="kobo.1231.3" xmlns="http://www.w3.org/1999/xhtml">Let’s illustrate it with an example.</span></p>
<p><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml">The following code defines a constrained problem, converts it into an unconstrained model using the penalty constant </span><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="M = 10" class="math inline" src="../media/file618.png" style="vertical-align:middle" title="M = 10"/></span><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml">, and then runs it on </span><code><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">Advantage_system4</span></code></p>
<p><code><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml">.1</span></code><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml"> taking 100 samples. </span><span class="koboSpan" id="kobo.1237.2" xmlns="http://www.w3.org/1999/xhtml">Then, it converts the samples back to the variables of the original problem, aggregates the results, as we did in </span><em><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-810004.3.3"><em><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml">4.3.3</span></em></a><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml">, and shows the frequency of each obtained solution:</span></p>
<pre class="lstlisting" id="listing-101"><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml">

sampler = EmbeddingComposite(DWaveSampler("Advantage_system4.1")) 
 
# Define the problem 
 
x0 = dimod.Binary("x0") 
 
x1 = dimod.Binary("x1") 
 
x2 = dimod.Binary("x2") 
 
blp = dimod.ConstrainedQuadraticModel() 
 
blp.set_objective(-5*x0+3*x1-2*x2) 
 
blp.add_constraint(x0 + x2 &lt;= 1, "First constraint") 
 
blp.add_constraint(3*x0 -x1 + 3*x2 &lt;= 4, "Second constraint") 
 
# Convert the problem and run it 
 
qubo, invert = dimod.cqm_to_bqm(blp, lagrange_multiplier = 10) 
 
result = sampler.sample(qubo, num_reads=100) 
 
# Aggregate and show the results 
 
samples = [] 
 
occurrences = [] 
 
for s in result.data(): 
 
    samples.append(invert(s.sample)) 
 
    occurrences.append(s.num_occurrences) 
 
sampleset = dimod.SampleSet.from_samples_cqm(samples,blp, 
 
    num_occurrences=occurrences) 
 
print("The solutions to the original problem are") 
 
print(sampleset.filter(lambda s: s.is_feasible).aggregate())
</span></pre>
<p><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">When we ran this code, we </span><span id="dx1-86028"/><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml">obtained the following output:</span></p>
<pre class="lstlisting" id="listing-102"><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml">

The solutions to the original problem are 
 
  x0 x1 x2 energy num_oc. </span><span class="koboSpan" id="kobo.1244.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.1244.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.1244.4" xmlns="http://www.w3.org/1999/xhtml">0  1  0  0   -5.0      21 arra...    </span><span class="koboSpan" id="kobo.1244.5" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  1  1  0   -2.0      32 arra...    </span><span class="koboSpan" id="kobo.1244.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
2  0  0  1   -2.0      11 arra...    </span><span class="koboSpan" id="kobo.1244.7" xmlns="http://www.w3.org/1999/xhtml">True 
 
3  0  0  0    0.0      17 arra...    </span><span class="koboSpan" id="kobo.1244.8" xmlns="http://www.w3.org/1999/xhtml">True 
 
4  0  1  1    1.0      10 arra...    </span><span class="koboSpan" id="kobo.1244.9" xmlns="http://www.w3.org/1999/xhtml">True 
 
5  0  1  0    3.0       9 arra...    </span><span class="koboSpan" id="kobo.1244.10" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 6 rows, 100 samples, 3 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml">So, in 21 out of 100 samples, we have obtained the optimal solution, and, in 43 more cases, we </span><span id="dx1-86038"/><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml">obtained solutions with the second lowest energy. </span><span class="koboSpan" id="kobo.1246.2" xmlns="http://www.w3.org/1999/xhtml">Not too bad…but not very good either. </span><span class="koboSpan" id="kobo.1246.3" xmlns="http://www.w3.org/1999/xhtml">The not-so-obvious problem behind this result is that the penalty constant (the </span><code><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"> parameter) is too big compared to the range of energies of the objective function. </span><span class="koboSpan" id="kobo.1248.2" xmlns="http://www.w3.org/1999/xhtml">In fact, if you use </span><code><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml">ExactSolver</span></code><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml"> on the transformed problem, you can easily check that all the assignments that are unfeasible on the original problem get energy </span><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="16" class="math inline" src="../media/file619.png" style="vertical-align:middle" title="16"/></span><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml"> or higher on the transformed one, while the feasible solutions always get energy </span><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml"> or lower. </span><span class="koboSpan" id="kobo.1254.2" xmlns="http://www.w3.org/1999/xhtml">That is a huge gap!</span></p>
<p><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml">But notice what happened when we ran the same code after reducing the penalty constant to </span><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1257.2" xmlns="http://www.w3.org/1999/xhtml">In that case, we obtained the following result:</span></p>
<pre class="lstlisting" id="listing-103"><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">

The solutions to the original problem are 
 
  x0 x1 x2 energy num_oc. </span><span class="koboSpan" id="kobo.1258.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.1258.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.1258.4" xmlns="http://www.w3.org/1999/xhtml">0  1  0  0   -5.0      30 arra...    </span><span class="koboSpan" id="kobo.1258.5" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  1  1  0   -2.0      31 arra...    </span><span class="koboSpan" id="kobo.1258.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
2  0  0  1   -2.0      16 arra...    </span><span class="koboSpan" id="kobo.1258.7" xmlns="http://www.w3.org/1999/xhtml">True 
 
3  0  0  0    0.0       8 arra...    </span><span class="koboSpan" id="kobo.1258.8" xmlns="http://www.w3.org/1999/xhtml">True 
 
4  0  1  1    1.0      10 arra...    </span><span class="koboSpan" id="kobo.1258.9" xmlns="http://www.w3.org/1999/xhtml">True 
 
5  0  1  0    3.0       3 arra...    </span><span class="koboSpan" id="kobo.1258.10" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 6 rows, 98 samples, 3 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, the frequency of the optimal solution has increased to </span><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="30" class="math inline" src="../media/file620.png" style="vertical-align:middle" title="30"/></span><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml"> and the two solutions with the second lowest energy appear, more or less, the same number of times as in the experiment with </span><code><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code></p>
<p><code><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">=10</span></code><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1264.2" xmlns="http://www.w3.org/1999/xhtml">In this case (check it by using </span><code><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml">ExactSolver</span></code><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">), the unfeasible </span><span id="dx1-86048"/><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml">solutions all have energy that is at least </span><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml"> in the transformed problem, so all the feasible solutions have lower energy. </span><span class="koboSpan" id="kobo.1269.2" xmlns="http://www.w3.org/1999/xhtml">Notice, though, that the gap is now much smaller and we only recovered </span><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="98" class="math inline" src="../media/file621.png" style="vertical-align:middle" title="98"/></span><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml"> feasible solutions from the </span><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml"> samples.</span></p>
<p><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml">We even tried a more extreme experiment, setting </span><code><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code></p>
<p><code><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">=1</span></code><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1277.2" xmlns="http://www.w3.org/1999/xhtml">When we ran it, we obtained the following output:</span></p>
<pre class="lstlisting" id="listing-104"><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml">

The solutions to the original problem are 
 
  x0 x1 x2 energy num_oc. </span><span class="koboSpan" id="kobo.1278.2" xmlns="http://www.w3.org/1999/xhtml">is_sat. </span><span class="koboSpan" id="kobo.1278.3" xmlns="http://www.w3.org/1999/xhtml">is_fea. 
 
</span><span class="koboSpan" id="kobo.1278.4" xmlns="http://www.w3.org/1999/xhtml">0  1  0  0   -5.0      76 arra...    </span><span class="koboSpan" id="kobo.1278.5" xmlns="http://www.w3.org/1999/xhtml">True 
 
1  0  0  1   -2.0       5 arra...    </span><span class="koboSpan" id="kobo.1278.6" xmlns="http://www.w3.org/1999/xhtml">True 
 
2  1  1  0   -2.0      11 arra...    </span><span class="koboSpan" id="kobo.1278.7" xmlns="http://www.w3.org/1999/xhtml">True 
 
3  0  0  0    0.0       1 arra...    </span><span class="koboSpan" id="kobo.1278.8" xmlns="http://www.w3.org/1999/xhtml">True 
 
4  0  1  1    1.0       1 arra...    </span><span class="koboSpan" id="kobo.1278.9" xmlns="http://www.w3.org/1999/xhtml">True 
 
[’INTEGER’, 5 rows, 94 samples, 3 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">The frequency of the optimal solution has dramatically improved, up to </span><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="76" class="math inline" src="../media/file622.png" style="vertical-align:middle" title="76"/></span><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml"> out of </span><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml"> samples. </span><span class="koboSpan" id="kobo.1283.2" xmlns="http://www.w3.org/1999/xhtml">However, we also ”lost” 6 samples because they corresponded to unfeasible solutions. </span><span class="koboSpan" id="kobo.1283.3" xmlns="http://www.w3.org/1999/xhtml">In this case, there are some unfeasible solutions with energy as low as </span><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2" class="math inline" src="../media/file333.png" style="vertical-align:middle" title="- 2"/></span><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml"> in the transformed problem. </span><span class="koboSpan" id="kobo.1285.2" xmlns="http://www.w3.org/1999/xhtml">This is still bigger than the optimal energy, which is </span><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml">, but the low energy of these unfeasible solutions can fool the annealer into selecting them at times, as we have seen.</span></p>
<p><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml">Setting a good penalty constant can be difficult, because it involves having some information about the energy distribution of the solutions to the problem. </span><span class="koboSpan" id="kobo.1288.2" xmlns="http://www.w3.org/1999/xhtml">But let the examples here serve as a warning that you should not just use any value for </span><code><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">lagrange_multiplier</span></code><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml">, because setting it too high can affect the quality of your solutions. </span><span class="koboSpan" id="kobo.1290.2" xmlns="http://www.w3.org/1999/xhtml">In case of doubt, try some different options and keep the one that offers the best results.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-104">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml">Something similar may happen when the value of the coupling strength for chains in an embedding is too big. </span><span class="koboSpan" id="kobo.1293.2" xmlns="http://www.w3.org/1999/xhtml">Fortunately, the methods used by </span><code><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">EmbeddingComposite</span></code><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml"> and its relatives take this into account and will try to keep the value as low as possible without risking breaking many chains. </span><span class="koboSpan" id="kobo.1295.2" xmlns="http://www.w3.org/1999/xhtml">But should you need, for some reason, to create your own embedding, do not take the choice of the coupling strength lightly.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">You now know how to adjust the most important </span><span id="dx1-86057"/><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">parameters that govern quantum annealing and, more importantly, you understand the implications of such adjustments. </span><span class="koboSpan" id="kobo.1297.2" xmlns="http://www.w3.org/1999/xhtml">But it turns out that D-Wave offers other ways of solving optimization problems beyond ”pure” quantum annealing. </span><span class="koboSpan" id="kobo.1297.3" xmlns="http://www.w3.org/1999/xhtml">Let us study them in the following subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="11.4.5" id="classical-and-hybrid-samplers">
<h2 class="subsectionHead" data-number="11.4.5"><span class="titlemark"><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml">4.4.5 </span></span> <span id="x1-870004.4.5"><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml">Classical and hybrid samplers</span></span></h2>
<p><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml">We have already seen that </span><code><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml">dimod</span></code><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml"> provides a </span><strong><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml">classical</span></strong><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml"> solver called </span><code><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">ExactSolver</span></code><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1306.2" xmlns="http://www.w3.org/1999/xhtml">And it’s not alone! </span><span class="koboSpan" id="kobo.1306.3" xmlns="http://www.w3.org/1999/xhtml">In Ocean, we can also find solvers such as, for example, </span><code><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">SimulatedAnnealing</span></code><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml">SteepestDescentSolver</span></code><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml"> that do not rely on any quantum resources whatsoever.</span></p>
<p><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml">The purpose of including these classical solvers in a quantum optimization library is two-fold. </span><span class="koboSpan" id="kobo.1311.2" xmlns="http://www.w3.org/1999/xhtml">On the one hand, it allows you to try and use different methods to solve your problems. </span><span class="koboSpan" id="kobo.1311.3" xmlns="http://www.w3.org/1999/xhtml">On the other hand, they can be used in combination with quantum annealers in what D-Wave </span><span id="dx1-87001"/><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">calls </span><strong><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml">hybrid solvers</span></strong><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1314.2" xmlns="http://www.w3.org/1999/xhtml">Let’s briefly study these two aspects.</span></p>
<section class="level4 subsubsectionHead" data-number="11.4.5.1" id="classical-solvers">
<h3 class="subsubsectionHead" data-number="11.4.5.1"><span id="x1-880004.4.5"><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml">Classical solvers</span></span></h3>
<p><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml">Using classical solvers </span><span id="dx1-88001"/><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml">with Ocean couldn’t be simpler. </span><span class="koboSpan" id="kobo.1317.2" xmlns="http://www.w3.org/1999/xhtml">As long as you have a QUBO or Ising problem, you can use the </span><code><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml">sample</span></code><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml"> method of any classical solver to get (approximate) solutions to it, exactly like you would do with a quantum annealer. </span><span class="koboSpan" id="kobo.1319.2" xmlns="http://www.w3.org/1999/xhtml">In fact, you can also use the </span><code><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">num_reads</span></code><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml"> parameter to specify the number of samples that you want.</span></p>
<p><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml">We will devote the rest of this subsection to describing the classical solvers included in Ocean at the time of writing.</span></p>
<p><span class="paragraphHead"><span id="x1-890004.4.5"/><code><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">SteepestDescentSolver</span></code></span><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml"> This is included in the </span><span id="dx1-89001"/><code><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">greedy</span></code><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml"> package and it is a discrete version of the gradient descent algorithm for continuous optimization (more on that in </span><em><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <a href="ch017.xhtml#x1-1390008"><em><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">8</span></em></a><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">What is Quantum Machine Learning?</span></em><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1331.2" xmlns="http://www.w3.org/1999/xhtml">At each step, it </span><span id="dx1-89002"/><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml">selects one direction (that is, one variable flip) in which the decrease in energy is bigger. </span><span class="koboSpan" id="kobo.1332.2" xmlns="http://www.w3.org/1999/xhtml">We can use it as shown in the following piece of code, where we first define a simple Ising problem and then we sample from it:</span></p>
<pre class="lstlisting" id="listing-105"><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml">

import greedy 
 
import dimod 
 
J = {(0,1):1, (1,2):1, (2,3):1, (3,0):1} 
 
h = {} 
 
problem = dimod.BinaryQuadraticModel(h, J, 0.0, dimod.SPIN) 
 
# Sample with SteepestDescentSolver 
 
solver = greedy.SteepestDescentSolver() 
 
solution = solver.sample(problem, num_reads = 10) 
 
print(solution.aggregate())
</span></pre>
<p><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml">The output of running these instructions will be similar to the following:</span></p>
<pre class="listings"><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml">

0  1  2  3 energy num_oc. </span><span class="koboSpan" id="kobo.1335.2" xmlns="http://www.w3.org/1999/xhtml">num_st. 
</span><span class="koboSpan" id="kobo.1335.3" xmlns="http://www.w3.org/1999/xhtml">0 +1 -1 +1 -1   -4.0       5       1 
2 -1 +1 -1 +1   -4.0       3       1 
1 +1 -1 -1 +1    0.0       1       0 
3 +1 +1 -1 -1    0.0       1       0 
[’SPIN’, 4 rows, 10 samples, 4 variables]
</span></pre>
<p><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, this is exactly the format the we already know and love from using quantum solvers.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-105">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml">In addition to the </span><code><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml">num_reads</span></code><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml"> parameter, you can also set </span><code><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml">initial_states</span></code><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml"> to specify the solutions from which the descent is going to start. </span><span class="koboSpan" id="kobo.1343.2" xmlns="http://www.w3.org/1999/xhtml">If you don’t use this parameter, then the initial states will be selected at random. </span><span class="koboSpan" id="kobo.1343.3" xmlns="http://www.w3.org/1999/xhtml">In that case, you can use the </span><code><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml">seed</span></code><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml"> argument should you want your results to be reproducible.</span></p>
</div>
</div>
<p><span class="paragraphHead"><span id="x1-900004.4.5"/><code><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml">TabuSolver</span></code></span><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml"> This </span><span id="dx1-90001"/><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">solver is </span><span id="dx1-90002"/><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">included in the </span><code><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">tabu</span></code><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml"> package. </span><span class="koboSpan" id="kobo.1351.2" xmlns="http://www.w3.org/1999/xhtml">It is an example of a </span><strong><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">local</span></strong> <strong><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml">search</span></strong><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml"> algorithm. </span><span class="koboSpan" id="kobo.1354.2" xmlns="http://www.w3.org/1999/xhtml">That is, it tries to improve a solution by exploring its neighbors — the solutions that can be obtained by flipping one variable, for instance. </span><span class="koboSpan" id="kobo.1354.3" xmlns="http://www.w3.org/1999/xhtml">In this, the method is somewhat similar to the greedy descent algorithm implemented in </span><code><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml">SteepestDescentSolver</span></code><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml">, but it tries to avoid falling into local minima by sometimes accepting solutions with higher energy than the current one, and it also ”remembers” solutions it has already visited in order not to explore them again — that is where the name </span><em><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">tabu</span></em><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml"> comes from.</span></p>
<p><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml">Ocean implements the multistart tabu algorithm described in </span><span class="cite"><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xpalubeckis2004multistart"><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml">72</span></a><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1363.2" xmlns="http://www.w3.org/1999/xhtml">It can be used with the following instructions:</span></p>
<pre class="lstlisting" id="listing-106"><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">

import tabu 
 
solver = tabu.TabuSampler() 
 
solution = solver.sample(problem, num_reads = 10) 
 
print(solution.aggregate())
</span></pre>
<p><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml">The tabu algorithm also accepts </span><code><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">initial_states</span></code><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">seed</span></code><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml"> parameters.</span></p>
<p><span class="paragraphHead"><span id="x1-910004.4.5"/><code><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">SimulatedAnnealingSampler</span></code></span><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml"> This is </span><span id="dx1-91001"/><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">included in the </span><code><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml">neal</span></code><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml"> package and it </span><span id="dx1-91002"/><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">implements the heuristic algorithm known as </span><strong><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">simulated annealing</span></strong> <span class="cite"><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xkirkpatrick1983optimization"><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">59</span></a><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1380.2" xmlns="http://www.w3.org/1999/xhtml">It is </span><span id="dx1-91003"/><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml">another local search algorithm that explores the neighbourhood of the candidate solution that it is considering at a given moment. </span><span class="koboSpan" id="kobo.1381.2" xmlns="http://www.w3.org/1999/xhtml">With that, it tries to move to solutions with lower energy. </span><span class="koboSpan" id="kobo.1381.3" xmlns="http://www.w3.org/1999/xhtml">However, like tabu search, it can move to solutions with higher energy with some probability. </span><span class="koboSpan" id="kobo.1381.4" xmlns="http://www.w3.org/1999/xhtml">This probability is bounded by a global ”temperature” parameter that decreases with time, eventually reaching </span><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">, inspired by the way in which metals become less malleable when they cool down during annealing — hence the name of the method. </span><span class="koboSpan" id="kobo.1383.2" xmlns="http://www.w3.org/1999/xhtml">In fact, quantum annealing is seen by some people as a quantum version of </span><span id="dx1-91004"/><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml">simulated annealing. </span><span class="koboSpan" id="kobo.1384.2" xmlns="http://www.w3.org/1999/xhtml">The analogy they make is that the intensity of the initial Hamiltonian </span><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml"> can be understood as analogous to the temperature in simulated annealing: it allows the </span><span id="dx1-91005"/><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml">solutions to move or ”tunnel” to some neighboring ones and it decreases over time. </span><span class="koboSpan" id="kobo.1387.2" xmlns="http://www.w3.org/1999/xhtml">Simulated </span><span id="dx1-91006"/><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml">annealing can be used in Ocean as follows:</span></p>
<pre class="lstlisting" id="listing-107"><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml">

import neal 
 
solver = neal.SimulatedAnnealingSampler() 
 
solution = solver.sample(problem, num_reads = 10) 
 
print(solution.aggregate())
</span></pre>
<p><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml">As you surely guessed, the </span><code><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">initial_states</span></code><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml">seed</span></code><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml"> parameters are also supported.</span></p>
<p><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml">These samplers are all classical algorithms that do not use quantum resources. </span><span class="koboSpan" id="kobo.1395.2" xmlns="http://www.w3.org/1999/xhtml">However, they can be combined with quantum annealers, as we show in the next subsection.</span></p>
</section>
<section class="level4 subsubsectionHead" data-number="11.4.5.2" id="hybrid-solvers">
<h3 class="subsubsectionHead" data-number="11.4.5.2"><span id="x1-920004.4.5"><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml">Hybrid solvers</span></span></h3>
<p><span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml">In addition to quantum annealers and classical solvers, Ocean also provides the programmer with hybrid solvers that try to combine the best of both worlds. </span><span class="koboSpan" id="kobo.1397.2" xmlns="http://www.w3.org/1999/xhtml">You may remember that, back in </span><em><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-830004.4.1"><em><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml">4.4.1</span></em></a><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml">, these hybrid </span><span id="dx1-92001"/><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml">solvers were listed among the devices available through your Leap account. </span><span class="koboSpan" id="kobo.1401.2" xmlns="http://www.w3.org/1999/xhtml">Finally, the time to learn how to use them has come!</span></p>
<p><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start with </span><code><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridSampler</span></code><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1404.2" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-92002"/><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">sampler accepts QUBO and Ising problems and can scale up to a high </span><span id="dx1-92003"/><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml">number of variables because, internally, it divides the problem, assigns different parts to classical solvers and quantum annealers, and then reconstructs a global solution from the local ones. </span><span class="koboSpan" id="kobo.1406.2" xmlns="http://www.w3.org/1999/xhtml">Its use is very similar to that of the samplers that we have studied so far. </span><span class="koboSpan" id="kobo.1406.3" xmlns="http://www.w3.org/1999/xhtml">For instance, you can run the following instructions, with </span><code><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml">problem</span></code><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml"> as defined in the previous subsection — or just any other QUBO or Ising problem:</span></p>
<pre class="lstlisting" id="listing-108"><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml">

import dwave.system 
 
sampler = dwave.system.LeapHybridSampler() 
 
solution = solver.sample(problem, num_reads = 10) 
 
print(solution.aggregate())
</span></pre>
<p><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">One interesting </span><span id="dx1-92008"/><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml">property of </span><code><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridSampler</span></code><span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml"> and the rest of the hybrid samplers is what is called the </span><strong><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml">quota conversion rate</span></strong><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1415.2" xmlns="http://www.w3.org/1999/xhtml">It can be </span><span id="dx1-92009"/><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml">checked through the following property:</span></p>
<pre class="lstlisting" id="listing-109"><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml">

sampler.properties["quota_conversion_rate"]
</span></pre>
<p><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml">In the case of </span><code><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridSampler</span></code><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml">, it is 20. </span><span class="koboSpan" id="kobo.1420.2" xmlns="http://www.w3.org/1999/xhtml">This means that for each 20 microseconds that you use this hybrid sampler, you will get charged just 1 microsecond of quantum processor access because the quantum annealers are not used for the whole computation. </span><span class="koboSpan" id="kobo.1420.3" xmlns="http://www.w3.org/1999/xhtml">Neat, right?</span></p>
<p><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml">Ocean also provides </span><code><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridCQMSampler</span></code><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml">, which is used </span><span id="dx1-92011"/><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml">similarly to </span><code><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridSampler</span></code><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml">, but with constrained problems like the ones we defined in </span><em><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-810004.3.3"><em><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml">4.3.3</span></em></a><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1429.2" xmlns="http://www.w3.org/1999/xhtml">Finally, there is also </span><code><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml">LeapHybridDQMSampler</span></code><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml">, which </span><span id="dx1-92012"/><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">works with </span><span id="dx1-92013"/><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml">discrete quadratic problems defined as objects of the </span><code><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml">DiscreteQuadraticModel</span></code><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-106">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml">We have not </span><span id="dx1-92014"/><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml">worked with the </span><code><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml">DiscreteQuadraticModel</span></code><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml"> class, but it is very similar to </span><code><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml">BinaryQuadraticModel</span></code><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1443.2" xmlns="http://www.w3.org/1999/xhtml">The main difference is that it accepts variables that take a finite amount of different values instead of just </span><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1447.2" xmlns="http://www.w3.org/1999/xhtml">The problems defined through this class can be converted to binary quadratic </span><span id="dx1-92015"/><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">problems by </span><strong><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml">one-hot encoding</span></strong><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">; that is, each discrete variable is represented by a vector of </span><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml"> binary variables, where </span><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml"> is the total number of values that the original discrete variable can take. </span><span class="koboSpan" id="kobo.1454.2" xmlns="http://www.w3.org/1999/xhtml">The restriction is that only one of those variables can take the value </span><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml"> at a given time. </span><span class="koboSpan" id="kobo.1456.2" xmlns="http://www.w3.org/1999/xhtml">So, if binary variable number </span><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml">, this means that the original variable takes the value </span><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml">This ends our study of quantum annealing and its use in combinatorial optimization. </span><span class="koboSpan" id="kobo.1463.2" xmlns="http://www.w3.org/1999/xhtml">But this kind of problem can also be solved with algorithms designed for quantum computers based on the quantum circuit model. </span><span class="koboSpan" id="kobo.1463.3" xmlns="http://www.w3.org/1999/xhtml">That will be the topic of our next chapter.</span></p>
</section>
</section>
</section>
<section class="level2 likesectionHead" data-number="11.5" id="summary-3">
<h1 class="likesectionHead" data-number="11.5"><span id="x1-930004.4.5"><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></span></h1>
<p><span id="Q1-1-117"/></p>
<p><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you have learned about the adiabatic quantum computing model, which is equivalent to the quantum circuit model that we had already studied. </span><span class="koboSpan" id="kobo.1465.2" xmlns="http://www.w3.org/1999/xhtml">Instead of discrete quantum gates, adiabatic quantum computing uses continuous evolution through a time-dependent Hamiltonian. </span><span class="koboSpan" id="kobo.1465.3" xmlns="http://www.w3.org/1999/xhtml">You have learned how to select this Hamiltonian to encode combinatorial optimization problems and how, if the evolution is slow enough, the adiabatic theorem guarantees that we will measure the ground state at the end of the process.</span></p>
<p><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml">You have also learned that, in practice, quantum annealing is used instead of adiabatic quantum computing, because adiabatic evolution can take too long for the process to be feasible. </span><span class="koboSpan" id="kobo.1466.2" xmlns="http://www.w3.org/1999/xhtml">What is more, you now know how to use actual quantum annealers through D-Wave Leap to find approximate solutions to combinatorial optimization problems in several different ways.</span></p>
<p><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml">You also know how to control several parameters of the annealing process, in order to improve the quality of the solutions that you can find with quantum annealers. </span><span class="koboSpan" id="kobo.1467.2" xmlns="http://www.w3.org/1999/xhtml">Finally, you have also learned how to use hybrid solvers that divide big problems into smaller pieces and combine classical and quantum techniques to find a global solution to the original problem.</span></p>
<p><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml">We will now turn to using quantum computers based on the quantum circuit model. </span><span class="koboSpan" id="kobo.1468.2" xmlns="http://www.w3.org/1999/xhtml">But we will not forget about optimization problems and Hamiltonians. </span><span class="koboSpan" id="kobo.1468.3" xmlns="http://www.w3.org/1999/xhtml">In fact, as you will soon see, the topic of our next chapter will be how to discretize quantum annealing so that it can be implemented with quantum gates.</span></p>
</section>
</section>
</body>
</html>
