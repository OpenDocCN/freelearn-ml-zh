<html><head></head><body>
		<div id="_idContainer119">
			<h1 id="_idParaDest-69"><em class="italic"><a id="_idTextAnchor076"/>Chapter 4</em>: Getting Started with Azure Machine Learning </h1>
			<p class="author-quote">"As a technologist, I see how AI and the fourth industrial revolution will impact every aspect of people's lives." </p>
			<p class="author-quote">– Fei-Fei Li, Professor of Computer Science at Stanford University</p>
			<p>In the previous chapter, you were introduced to the major AutoML <strong class="bold">Open Source Software</strong> (<strong class="bold">OSS</strong>) tools and libraries. We did a<a id="_idIndexMarker174"/> tour of the major OSS offerings, including TPOT, AutoKeras, auto-sklearn, Featuretools, and Microsoft NNI, which will have helped you, the reader, understand the differential value propositions and approaches used in each of these libraries. </p>
			<p>In this chapter, we will start exploring the first of many commercial offerings, namely Microsoft's Azure capabilities in automated <strong class="bold">Machine Learning</strong> (<strong class="bold">ML</strong>). Azure Machine Learning is part of the Microsoft AI ecosystem, which helps accelerate the end-to-end ML life cycle using the power of the Windows Azure platform and services. We will start with an enterprise-grade ML service for building and deploying models that empowers developers and data scientists to build, train, and deploy ML models faster. With examples and walk-throughs, you will learn the fundamentals to build and deploy automated ML solutions using Azure. </p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Getting started with Azure Machine Learning </li>
				<li>The Azure Machine Learning stack</li>
				<li>Getting started with the Azure Machine Learning service</li>
				<li>Modeling with Azure Machine Learning </li>
				<li>Deploying and testing models with Azure Machine Learning</li>
			</ul>
			<h1 id="_idParaDest-70"><a id="_idTextAnchor077"/>Getting started with Azure Machine Learning </h1>
			<p>Not so long ago, if you wanted to use<a id="_idIndexMarker175"/> ML in a production environment on the Azure platform, you needed to bring together a bunch of different services to support the full ML life cycle.</p>
			<p>For example, to use the datasets, you would need storage repositories such as Azure Blob storage or Azure Data Lake storage. For compute, you would either need individual virtual machines, Spark clusters using HDInsight, or Azure Databricks to actually run your model code. To protect your data for enterprise readiness, you'd need to bring in your virtual networks or configure your compute and data inside the same virtual network, along with Azure Key Vault to manage and secure your credentials. In order to provide repeatability for your experiments by using a consistent set of ML libraries, and the different versions thereof, you'd create Docker containers and use Azure Container Registry to store those Docker containers. You would need to put that inside your virtual network and then use Azure Kubernetes Service. Woah! This all sounds like a whole lot of stuff to piece together to get the ML and all the models and everything to work.</p>
			<p>But things have progressed since, and you are in luck. With the Azure Machine Learning service, Microsoft removed that complexity. As a managed service, Azure Machine Learning comes with its own compute, hosted notebooks, and capabilities for model management, version control, and model reproducibility built right in. You can layer that on top of your existing Azure services. For example, you can plug in the compute and storage that you already have as well as your other infrastructure services. Azure Machine Learning connects and orchestrates them within a single environment so that you have one end-to-end modular platform for your entire ML life cycle, as you prepare data, build, train, package, and deploy your ML models.</p>
			<p>Microsoft's Azure Machine Learning development group offers a great cheat sheet (<a href="http://aka.ms/mlcheatsheet">aka.ms/mlcheatsheet</a>) that helps you choose the best ML algorithm for the predictive analytics task at hand. Whether you want to predict between categories, discover a structure, or extract information from text, in the following flow you can find out the best algorithm based on your needs: </p>
			<div>
				<div id="_idContainer074" class="IMG---Figure">
					<img src="image/Figure_4.1_B16890.jpg" alt="Figure 4.1 – The Machine Learning Algorithm Cheat Sheet overview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1 – The Machine Learning Algorithm Cheat Sheet overview</p>
			<p>The Azure Machine Learning service makes for an ideal <a id="_idIndexMarker176"/>working environment for citizen data scientists. They get the services, tools, and virtually everything configured for them and the luxury of not having to compile all these individual <a id="_idIndexMarker177"/>services helps them do what matters most – solve the business problem. These subject matter experts also don't need to learn how to use new tools. You can use the Jupyter Notebooks, your favorite Python editor – including VS Code and PyCharm, and Azure Machine Learning works with any Python ML framework library, such as TensorFlow, PyTorch, scikit-learn, and so on. This is amazing in terms of making the life cycle a lot shorter, in terms of getting everything up and running. You will see some of these examples in the rest of this chapter as we walk through building a classification model using the Azure Machine Learning service. </p>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor078"/>The Azure Machine Learning stack</h1>
			<p>The Microsoft Azure ecosystem is<a id="_idIndexMarker178"/> quite broad; in this chapter, we will focus on its AI and ML related cloud offerings, especially the Azure Machine Learning service. </p>
			<p>The following figure shows the offerings available for ML in the Azure cloud: </p>
			<div>
				<div id="_idContainer075" class="IMG---Figure">
					<img src="image/Figure_4.2_B16890.jpg" alt="Figure 4.2 – Azure cloud ML offerings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.2 – Azure cloud ML offerings</p>
			<p>You can visit the following link for more information about the offerings in the preceding table: <a href="https://docs.microsoft.com/en-us/azure/architecture/data-guide/technology-choices/data-science-and-machine-learning&#13;">https://docs.microsoft.com/en-us/azure/architecture/data-guide/technology-choices/data-science-and-machine-learning.</a></p>
			<p>It can be confusing to know which Azure Machine Learning offering should be chosen among the many described in the preceding table. The following diagram helps with choosing the right offering based on the given business and technology scenario:</p>
			<div>
				<div id="_idContainer076" class="IMG---Figure">
					<img src="image/Figure_4.3_B16890.jpg" alt="Figure 4.3 – Azure Machine Learning decision flow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.3 – Azure Machine Learning decision flow</p>
			<p>Automated ML is a part of the <a id="_idIndexMarker179"/>Azure Machine Learning service capabilities. Other <a id="_idIndexMarker180"/>capabilities include collaborative notebooks, data labeling, ML operations, a drag-and-drop designer studio, autoscaling capabilities, and many other tools described in the following table.</p>
			<div>
				<div id="_idContainer077" class="IMG---Figure">
					<img src="image/Figure_4.4_B16890.jpg" alt="Figure 4.4 – Azure Machine Learning key service capabilities &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.4 – Azure Machine Learning key service capabilities </p>
			<p>The AI and ML capabilities offered in Azure are quite comprehensive and the best place to start looking into these in detail is the Azure AI Fundamentals Learning Path on Microsoft Learn: <a href="https://aka.ms/AzureLearn_AIFundamentals&#13;">https://aka.ms/AzureLearn_AIFundamentals.</a></p>
			<p>The Azure Machine Learning<a id="_idIndexMarker181"/> service arguably provides virtually everything a data scientist needs. It includes environments, experiments, pipelines, datasets, models, endpoints, and workspaces, which helps enabling other Azure resources such as the following:</p>
			<ul>
				<li><strong class="bold">Azure Container Registry</strong> (<strong class="bold">ACR</strong>): This<a id="_idIndexMarker182"/> registry stores information about the Docker containers used during training and deployment. </li>
				<li><strong class="bold">Azure storage account</strong>: The default datastore<a id="_idIndexMarker183"/> for the ML workspace; it also stores the associated Jupyter notebooks.</li>
				<li><strong class="bold">Azure Application Insights</strong>: This stores model <a id="_idIndexMarker184"/>monitoring information.</li>
				<li><strong class="bold">Azure Key Vault</strong>: Credentials and other secrets <a id="_idIndexMarker185"/>for compute and workspace needs. </li>
			</ul>
			<p>To train any ML algorithm, you need processing capabilities, that is, compute resources. Azure supports a variety of different compute resources, ranging from your local machine to remote VMs. The following table outlines different training targets for workloads. As shown in the table, you can use a local computer, a compute cluster, a remote virtual machine, and a variety of other training targets for automated ML workloads: </p>
			<div>
				<div id="_idContainer078" class="IMG---Figure">
					<img src="image/Figure_4.5_B16890.jpg" alt="Figure 4.5 – Azure Machine Learning training targets&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.5 – Azure Machine Learning training targets</p>
			<p>In the step-by-step walk-through, you will see how to<a id="_idIndexMarker186"/> create and select a compute target. Lastly, all ML algorithms need operationalization and deployment. The infamous adage <em class="italic">it works on my machine</em> only goes so far; therefore, you need a deployment compute resource to be able to host your model and provide an endpoint. </p>
			<p>This is where your service resides and will be consumed <a id="_idIndexMarker187"/>from, also known as the compute target used for deployment. The following table shows different types <a id="_idIndexMarker188"/>of deployment targets: </p>
			<div>
				<div id="_idContainer079" class="IMG---Figure">
					<img src="image/Figure_4.6_B16890.jpg" alt="Figure 4.6 – Azure machine compute target&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.6 – Azure machine compute target</p>
			<p>With this<a id="_idIndexMarker189"/> introduction to<a id="_idIndexMarker190"/> Azure Machine Learning capabilities, let's explore, step by step, how to build a classification model using the Azure Machine Learning service. </p>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor079"/>Getting started with the Azure Machine Learning service</h1>
			<p>In this section, we will explore a<a id="_idIndexMarker191"/> step-by-step walk-through of creating a classification model using Azure Machine Learning: </p>
			<ol>
				<li>Sign up for a Microsoft account, unless if you already have one, then log into the Azure Machine Learning portal at <a href="http://ml.azure.com">ml.azure.com</a>. Here, you will <a id="_idIndexMarker192"/>see the ML studio as shown in the following figure. An Azure subscription is essentially the way you pay for services. You can either use your existing subscription if you have one or sign up for a new one. For a brand-new user, the nice folks at Azure offer a $200 credit to get you acquainted. Make sure to turn off the resources when you are not using them; don't leave the data center lights on: <div id="_idContainer080" class="IMG---Figure"><img src="image/Figure_4.7_B16890_.jpg" alt="Figure 4.7 – Azure Machine Learning service subscription startup page&#13;&#10;"/></div><p class="figure-caption">Figure 4.7 – Azure Machine Learning service subscription startup page</p></li>
				<li>In the following figure, you <a id="_idIndexMarker193"/>can see we have now been asked to select a subscription. In this case, we'll choose <strong class="bold">Free Trial</strong> to explore the services. You can also choose <strong class="bold">Pay-As-You-Go</strong>, in which case, your account will be charged based on your compute, storage, and other service usage: <div id="_idContainer081" class="IMG---Figure"><img src="image/Figure_4.8_B16890_.jpg" alt="Figure 4.8 – Azure Machine Learning service subscription selection page&#13;&#10;"/></div><p class="figure-caption">Figure 4.8 – Azure Machine Learning service subscription selection page</p></li>
				<li>Now that you have chosen your<a id="_idIndexMarker194"/> subscription, you will be taken to the Azure portal, where you can do an overwhelming number of things. In this case, click on <strong class="bold">Create a resource</strong> and select the <strong class="bold">Machine Learning</strong> service: <div id="_idContainer082" class="IMG---Figure"><img src="image/Figure_4.9_B16890_.jpg" alt="Figure 4.9 – Azure portal home page&#13;&#10;"/></div><p class="figure-caption">Figure 4.9 – Azure portal home page</p><p>Once you have selected the <strong class="screen-inline">Machine </strong><strong class="screen-inline"><a id="_idIndexMarker195"/></strong><strong class="screen-inline">Learning</strong> service, you will see the following screen to create an Azure Machine Learning service. This is where you can create one or more ML workspaces. Now proceed by clicking on the <strong class="bold">Create Azure Machine Learning</strong> button: </p><div id="_idContainer083" class="IMG---Figure"><img src="image/Figure_4.10_B16890_.jpg" alt="Figure 4.10 – Azure Machine Learning service startup page in the portal&#13;&#10;"/></div><p class="figure-caption">Figure 4.10 – Azure Machine Learning service startup page in the portal</p></li>
				<li>Upon clicking <strong class="bold">Create Azure Machine Learning</strong>, you will be brought to the following page to<a id="_idIndexMarker196"/> create an ML workspace. This is where you will select your subscription, create a resource group, and select a geographical region: <div id="_idContainer084" class="IMG---Figure"><img src="image/Figure_4.11_B16890_.jpg" alt="Figure 4.11 – Azure Machine Learning service – creating a workspace &#13;&#10;"/></div><p class="figure-caption">Figure 4.11 – Azure Machine Learning service – creating a workspace </p></li>
				<li>The following figure shows<a id="_idIndexMarker197"/> the filled-out form for creating an ML workspace I called <strong class="source-inline">auto-ml-workspace</strong>. A <strong class="bold">resource group</strong> acts as a container for a collection of different resources, and hence associated assets (compute, storage, and so on): <div id="_idContainer085" class="IMG---Figure"><img src="image/Figure_4.12_B16890_.jpg" alt="Figure 4.12 – Azure Machine Learning service page&#13;&#10;"/></div><p class="figure-caption">Figure 4.12 – Azure Machine Learning service page</p><p>A workspace can contain <a id="_idIndexMarker198"/>compute instances, experiments, datasets, models, deployment endpoints, and so on, and is the top-level resource in Azure Machine Learning. You can refer to the breakdown of Azure workspaces shown in the following figure: </p><div id="_idContainer086" class="IMG---Figure"><img src="image/Figure_4.13_B16890_.jpg" alt="Figure 4.13 – What is an Azure Machine Learning workspace? &#13;&#10;"/></div><p class="figure-caption">Figure 4.13 – What is an Azure Machine Learning workspace? </p><p>Upon clicking the <strong class="bold">Create</strong> button under <strong class="bold">Project details</strong>, your ML service will be deployed, and the associated dependencies will be created. It can take a few minutes. You will see<a id="_idIndexMarker199"/> something like the following figure: </p><div id="_idContainer087" class="IMG---Figure"><img src="image/Figure_4.14_B16890_.jpg" alt="Figure 4.14 – Azure Machine Learning service deployment&#13;&#10;"/></div><p class="figure-caption">Figure 4.14 – Azure Machine Learning service deployment</p></li>
				<li>Once the deployment is complete, you will see the resource group and its associated resources, as shown in the following figure. You can now click on the <strong class="bold">Go to resource</strong> button, which will take you to the ML workspace: <div id="_idContainer088" class="IMG---Figure"><img src="image/Figure_4.15_B16890_.jpg" alt="Figure 4.15 – Azure Machine Learning deployment completion screen&#13;&#10;"/></div><p class="figure-caption">Figure 4.15 – Azure Machine Learning deployment completion screen</p></li>
				<li>This is your ML workspace. Here, you can see your <strong class="bold">Resource group</strong>, <strong class="bold">Subscription</strong>, <strong class="bold">Key Vault</strong>, and all the important high-level details, but you are not in the ML arena, yet. There is one more<a id="_idIndexMarker200"/> click to go. So now, go ahead and click on the <strong class="bold">Launch studio</strong> button to take you to the ML studio: <div id="_idContainer089" class="IMG---Figure"><img src="image/Figure_4.16_B16890_.jpg" alt="Figure 4.16 – Azure Machine Learning workspace console to launch studio&#13;&#10;"/></div><p class="figure-caption">Figure 4.16 – Azure Machine Learning workspace console to launch studio</p></li>
				<li>Now, the following is the screen <a id="_idIndexMarker201"/>you have been patiently waiting for all this time: the ML studio! Go ahead, take the tour by clicking on the <strong class="bold">Start the tour</strong> button – we will wait: </li>
			</ol>
			<div>
				<div id="_idContainer090" class="IMG---Figure">
					<img src="image/Figure_4.17_B16890_.jpg" alt="Figure 4.17 – Azure Machine Learning studio home page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.17 – Azure Machine Learning studio home page</p>
			<p>The following figure shows<a id="_idIndexMarker202"/> the Azure Machine Learning studio. There used to be a "classic" version of the ML studio but it's no longer active so we will just focus on this new shiny web-based portal, which helps you do all things ML. On the left pane, you can see all the different offerings, which are also offered via a dropdown: </p>
			<div>
				<div id="_idContainer091" class="IMG---Figure">
					<img src="image/Figure_4.18_B16890_.jpg" alt="Figure 4.18 – Azure Machine Learning studio home page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.18 – Azure Machine Learning studio home page</p>
			<p>The UI is <a id="_idIndexMarker203"/>modern, clean, and efficient. You can start by creating a new <strong class="bold">Notebook</strong>, an automated ML experiment, or a designer. Each of these offerings has a different purpose, yet they have a similar underlying infrastructure. Notebooks are great tools for hands-on data scientists, while automated ML experiments are targeted at AI democratization. The designer interface provides drag-and-drop capabilities to prepare data and deploy models. </p>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor080"/>Modeling with Azure Machine Learning </h1>
			<p>Before we create an automated ML workflow, let's<a id="_idIndexMarker204"/> start with a simple Azure notebook: </p>
			<ol>
				<li value="1">Azure notebooks are an integrated part of the Azure Machine Learning service, and you can either create or use a <a id="_idIndexMarker205"/>sample notebook to get started: <div id="_idContainer092" class="IMG---Figure"><img src="image/Figure_4.19_B16890_.jpg" alt="Figure 4.19 – Azure Machine Learning sample notebooks&#13;&#10;"/></div><p class="figure-caption">Figure 4.19 – Azure Machine Learning sample notebooks</p></li>
				<li>In the <strong class="bold">Search to filter notebooks</strong> box in the left pane, as shown in the following figure, search for <strong class="source-inline">MNIST</strong> and it will filter to show you the notebooks. Select the <strong class="source-inline">image-classification-part1-training.ipynb</strong> file to see the notebook in the right pane, and click on <strong class="bold">Clone this notebook</strong> to create your own copy:<div id="_idContainer093" class="IMG---Figure"><img src="image/Figure_4.20_B16890_.jpg" alt="Figure 4.20 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.20 – MNIST image classification notebook</p></li>
				<li>Click on the <strong class="bold">Clone this notebook</strong> button to clone the notebook. Cloning the notebook copies the notebook <a id="_idIndexMarker206"/>and associated configurations into your user folder as shown in the following figure. This step copies the notebooks and <strong class="source-inline">yml</strong> configuration files to the <strong class="source-inline">user</strong> directory: <div id="_idContainer094" class="IMG---Figure"><img src="image/Figure_4.21_B16890_.jpg" alt="Figure 4.21 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.21 – MNIST image classification notebook</p></li>
				<li>Now that you have<a id="_idIndexMarker207"/> cloned the assets, it's time to have a compute target. You cannot run a notebook without, well, actually having a machine to run it on. As you saw earlier, we were able to run code either on Google Colab or locally. In this case, we are running this workload on Azure, which requires us to be more explicit about our intent, hence you have to create a compute target to proceed. Click on <strong class="bold">Create compute</strong>: <div id="_idContainer095" class="IMG---Figure"><img src="image/Figure_4.22_B16890_.jpg" alt="Figure 4.22 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.22 – MNIST image classification notebook</p></li>
				<li>Once you've clicked on <strong class="bold">Create compute</strong>, you will be shown what kind of compute options<a id="_idIndexMarker208"/> are on offer, along with their associated cost. It's no surprise that bigger and better hardware will cost you more: <p class="callout-heading">Note</p><p class="callout">You can read about different types of VMs and their associated costs at <a href="https://azure.microsoft.com/en-us/pricing/details/virtual-machines/series/">https://azure.microsoft.com/en-us/pricing/details/virtual-machines/series/</a>. </p><div id="_idContainer096" class="IMG---Figure"><img src="image/Figure_4.23_B16890_.jpg" alt="Figure 4.23 – Create the new compute instance&#13;&#10;"/></div><p class="figure-caption">Figure 4.23 – Create the new compute instance</p></li>
				<li>For the purpose <a id="_idIndexMarker209"/>of this AutoML notebook, we will select a standard small VM, as seen in the following figure, and create the compute instance. You can create multiple compute instances and assign them to different experiments as needed: <p class="figure-caption"> </p><div id="_idContainer097" class="IMG---Figure"><img src="image/Figure_4.24_B16890_.jpg" alt="Figure 4.24 – Creating a new compute instance&#13;&#10;"/></div><p class="figure-caption">Figure 4.24 – Creating a new compute instance</p></li>
				<li>Click on <strong class="bold">Create</strong> to create a new <a id="_idIndexMarker210"/>compute instance – as you create a compute instance, which can take some time as you stare at the revolving circle of patience, you can explore other parts of the Azure Machine Learning portal: <div id="_idContainer098" class="IMG---Figure"><img src="image/Figure_4.25_B16890_.jpg" alt="Figure 4.25 – MNIST automated ML compute instance&#13;&#10;"/></div><p class="figure-caption">Figure 4.25 – MNIST automated ML compute instance</p><p>Now, the compute is ready to <a id="_idIndexMarker211"/>be used, as seen in the following figure. First, you get the status <strong class="bold">Starting</strong>, seen in the following figure:</p><div id="_idContainer099" class="IMG---Figure"><img src="image/Figure_4.26_B16890_.jpg" alt="Figure 4.26 – Compute instance attributes&#13;&#10;"/></div><p class="figure-caption">Figure 4.26 – Compute instance attributes</p><p>The compute<a id="_idIndexMarker212"/> instance status will change to <strong class="bold">Running</strong> when the compute instance is ready. You can choose to <strong class="bold">Stop</strong>, <strong class="bold">Restart</strong>, or <strong class="bold">Delete</strong> a compute resource as you please. Just remember that it will jeopardize its dependencies (things using or planning to use this compute resource):</p><div id="_idContainer100" class="IMG---Figure"><img src="image/Figure_4.27_B16890_.jpg" alt="Figure 4.27 – Compute instance running &#13;&#10;"/></div><p class="figure-caption">Figure 4.27 – Compute instance running </p></li>
				<li>Navigate back to<a id="_idIndexMarker213"/> the notebook by clicking on the <strong class="bold">Notebooks</strong> link in the left pane. Now that we have the <strong class="source-inline">image-classification-mnist-data</strong> notebook open, we can run the code to make sure that it works. And you can see the Azure Machine Learning SDK version gets printed in the following figure: <div id="_idContainer101" class="IMG---Figure"><img src="image/Figure_4.28_B16890_.jpg" alt="Figure 4.28 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.28 – MNIST image classification notebook</p></li>
				<li>One configuration <a id="_idIndexMarker214"/>step still remains – you have to authenticate to use the workspace to be able to utilize the resources. In order to do that, there is an interactive authentication system built in where you click the link (<strong class="source-inline">devicelogin</strong>) shown in the following figure and enter the code (also in the following figure) to authenticate. I am sure you won't be using the code in the following figure – it won't work, but nice try! <div id="_idContainer102" class="IMG---Figure"><img src="image/Figure_4.29_B16890_.jpg" alt="Figure 4.29 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.29 – MNIST image classification notebook</p></li>
				<li>Now that we are authenticated and all, let's create a compute target. All the <strong class="source-inline">boilerplate</strong> code for <a id="_idIndexMarker215"/>configuration is already written for you as part of the Jupyter notebook. By running the cell shown in the following figure, you can now connect to the <strong class="source-inline">ComputeTarget</strong> programmatically and provision the node:<div id="_idContainer103" class="IMG---Figure"><img src="image/Figure_4.30_B16890_.jpg" alt="Figure 4.30 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.30 – MNIST image classification notebook</p></li>
				<li>Now it's time to programmatically download the MNIST dataset for training. Yann LeCun (Courant Institute, NYU) and Corinna Cortes (Google Labs, New York) hold the copyright of the MNIST dataset, which is a derivative work from the original MNIST datasets. The MNIST dataset is made available under the terms of the Creative<a id="_idIndexMarker216"/> Commons Attribution-Share Alike 3.0 license. Once downloaded, you can also visualize it as shown in the following notebook screenshot: <div id="_idContainer104" class="IMG---Figure"><img src="image/Figure_4.31_B16890_.jpg" alt="Figure 4.31 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.31 – MNIST image classification notebook</p></li>
				<li>As you probably have remembered from our earlier adventures with MNIST, we will create the training and testing split for the dataset as shown in the following figure and train a logistic regression model. We'll now also create an estimator, which is used to submit the run to the cluster: <p class="figure-caption"> </p><div id="_idContainer105" class="IMG---Figure"><img src="image/Figure_4.32_B16890.jpg" alt="Figure 4.32 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.32 – MNIST image classification notebook</p><p>When working in Azure Machine Learning, one cardinal rule to remember is that all experiments and associated runs are interlinked to maintain the consistency of the ecosystem. This helps a lot since, regardless of where you run your experiment (in a notebook, JupyterLab, as custom code, and so on), you can pull up the runs and see the<a id="_idIndexMarker217"/> details. More on this soon. </p><p>In the following figure, you see the code demonstrating the creation of an estimator, and then submitting the job to the cluster by calling the <strong class="source-inline">submit</strong> function of the <strong class="source-inline">experiment</strong> object: </p><div id="_idContainer106" class="IMG---Figure"><img src="image/Figure_4.33_B16890.jpg" alt="Figure 4.33 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.33 – MNIST image classification notebook</p></li>
				<li>At this point, running the cells in the following figure demonstrates how you can visualize the details of <strong class="source-inline">experiment</strong> using the Jupyter widget <strong class="source-inline">wait_for_completion</strong> method to see the status of the job. This shows the job running on the remote cluster, and the<a id="_idIndexMarker218"/> corresponding build log as part of the widget. You can see the <strong class="bold">Run</strong> details as part of the widget as shown in the following figure:<div id="_idContainer107" class="IMG---Figure"><img src="image/Figure_4.34_B16890.jpg" alt="Figure 4.34 – MNIST image classification notebook&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">   </p>
			<p class="figure-caption">Figure 4.34 – MNIST image classification notebook</p>
			<p>As the job runs on the remote cluster, and we see the results streaming in, you can observe the training unfold in front of your eyes with the corresponding percentage indicator:</p>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/Figure_4.35_B16890.jpg" alt="Figure 4.35 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.35 – MNIST image classification notebook</p>
			<p>As the job completes, you will <a id="_idIndexMarker219"/>see the time taken and the run ID displayed in the widget, as shown in the following screenshot: </p>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/Figure_4.36_B16890.jpg" alt="Figure 4.36 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.36 – MNIST image classification notebook</p>
			<p>You can also see the details <a id="_idIndexMarker220"/>of the experiment in the web UI by clicking on the details page that follows. You can see detailed documentation about how experiments work by looking at the docs page link shown in the following screenshot: </p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/Figure_4.37_B16890.jpg" alt="Figure 4.37 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.37 – MNIST image classification notebook</p>
			<p>Once the training is complete, you will see the results metrics logged during the run, and can also register the model. This means you get the corresponding <strong class="source-inline">.pkl</strong> file for the model:</p>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="image/Figure_4.38_B16890.jpg" alt="Figure 4.38 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.38 – MNIST image classification notebook</p>
			<p>Now you can retrieve all the metrics<a id="_idIndexMarker221"/> logged during the run by calling <strong class="source-inline">run.get_metrics()</strong>, including the accuracy of the model. In this case, the accuracy is 0.9193: </p>
			<div>
				<div id="_idContainer112" class="IMG---Figure">
					<img src="image/Figure_4.39_B16890.jpg" alt="Figure 4.39 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.39 – MNIST image classification notebook</p>
			<p>At this point, the notebook automatically saves the model file (<strong class="source-inline">.pkl</strong>) as the output in the output folder. You can see the files by calling the <strong class="source-inline">run.get_file_names()</strong> method. In the next steps, we <a id="_idIndexMarker222"/>will use this model file to create a web service and invoke it:</p>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="image/Figure_4.40_B16890.jpg" alt="Figure 4.40 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.40 – MNIST image classification notebook</p>
			<h1 id="_idParaDest-74"><a id="_idTextAnchor081"/>Deploying and testing models with Azure Machine Learning </h1>
			<p>The model is now trained, a .<strong class="source-inline">pkl</strong> file has been<a id="_idIndexMarker223"/> created, and the model can be deployed for testing. The deployment part is done in the second notebook, <strong class="source-inline">part2-deploy.ipynb</strong>, as seen in the following figure. To deploy the <a id="_idIndexMarker224"/>model, we open up the <strong class="source-inline">part 2-deploy.ipynb</strong> notebook by clicking on the notebook in the left pane. We load the .<strong class="source-inline">pkl</strong> file by calling the <strong class="source-inline">joblib.Load</strong> method. You also see the <strong class="source-inline">run</strong> method in the following screenshot, which receives the raw JSON data, invokes the model's <strong class="source-inline">predict</strong> method, and returns the result: </p>
			<div>
				<div id="_idContainer114" class="IMG---Figure">
					<img src="image/Figure_4.41_B16890.jpg" alt="Figure 4.41 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.41 – MNIST image classification notebook</p>
			<p>In this step, we<a id="_idIndexMarker225"/> create a model object by calling the <strong class="source-inline">Model</strong> constructor as shown in the following figure. This model uses the configuration properties from the <strong class="source-inline">Environment</strong> object, and the service name to deploy the endpoint. This<a id="_idIndexMarker226"/> endpoint is <a id="_idIndexMarker227"/>deployed using <strong class="bold">Azure Container Instances</strong> (<strong class="bold">ACI</strong>). The endpoint location is available once the deployment is successful: </p>
			<div>
				<div id="_idContainer115" class="IMG---Figure">
					<img src="image/Figure_4.42_B16890.jpg" alt="Figure 4.42 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.42 – MNIST image classification notebook</p>
			<ol>
				<li value="1">You can now retrieve the scoring URI, which can be used to invoke the service and get the results<a id="_idIndexMarker228"/> from the model:<div id="_idContainer116" class="IMG---Figure"><img src="image/Figure_4.43_B16890.jpg" alt="Figure 4.43 – MNIST image classification notebook&#13;&#10;"/></div><p class="figure-caption">Figure 4.43 – MNIST image classification notebook</p></li>
				<li>Now you can invoke<a id="_idIndexMarker229"/> the web service to get the results: </li>
			</ol>
			<div>
				<div id="_idContainer117" class="IMG---Figure">
					<img src="image/Figure_4.44_B16890.jpg" alt="Figure 4.44 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.44 – MNIST image classification notebook</p>
			<p>You can also see the corresponding confusion matrix by invoking the <strong class="source-inline">confusion_matrix</strong> method: </p>
			<div>
				<div id="_idContainer118" class="IMG---Figure">
					<img src="image/Figure_4.45_B16890.jpg" alt="Figure 4.45 – MNIST image classification notebook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.45 – MNIST image classification notebook</p>
			<p>This completes the <a id="_idIndexMarker230"/>whole cycle of building a model, deploying, and testing it <a id="_idIndexMarker231"/>within Azure Machine Learning. We will continue with automated ML in the next chapter.</p>
			<h1 id="_idParaDest-75"><a id="_idTextAnchor082"/>Summary</h1>
			<p>In this chapter, you learned how to get started with the Microsoft Azure platform, the ML services ecosystem capabilities, and learned about Microsoft's AI and ML offerings. You were also briefed on different capabilities within the Azure platform, such as collaborative notebooks, drag and drop ML, MLOPS, RStudio integration, reinforcement learning, enterprise-grade security, automated ML, data labeling, autoscaling compute, integration with other Azure services, responsible ML, and cost management. Finally, to test your newly discovered Azure superpowers, you configured, built, deployed, and tested a classification web service using an Azure Machine Learning notebook.</p>
			<p>In the next chapter, we will further dive into using the automated ML features of the Azure Machine Learning service. </p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor083"/>Further reading</h1>
			<p>For more information on the following topics, you can visit the given links:</p>
			<ul>
				<li>Python notebooks with ML and deep learning examples with Azure Machine Learning: <p><a href="https://github.com/Azure/MachineLearningNotebooks&#13;">https://github.com/Azure/MachineLearningNotebooks</a></p></li>
				<li>What are compute targets in Azure Machine Learning? <p><a href="https://docs.microsoft.com/en-us/azure/machine-learning/concept-compute-target&#13;">https://docs.microsoft.com/en-us/azure/machine-learning/concept-compute-target</a></p></li>
				<li>Use automated ML in an Azure Machine Learning pipeline in Python:<p><a href="https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-automlstep-in-pipelines&#13;">https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-automlstep-in-pipelines</a></p></li>
				<li>A critical overview of AutoML solutions by Bahador Khaleghi:<p><a href="https://medium.com/analytics-vidhya/a-critical-overview-of-automl-solutions-cb37ab0eb59e&#13;">https://medium.com/analytics-vidhya/a-critical-overview-of-automl-solutions-cb37ab0eb59e</a></p></li>
			</ul>
		</div>
	</body></html>