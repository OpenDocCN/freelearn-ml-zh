<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Google Cloud Storage</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will explore two data storage services from the Google Cloud platform, Google Storage, for files, and Google SQL, for structured data. Google Storage is a file-hosting service that allows you to store files in the cloud. Quite simple and straightforward, it is very similar to the Amazon S3 service. To go beyond basic usage, we will look into some advanced subjects, such as signed-URLs, collaboration bucket settings, optimizing upload speeds, and transferring big datasets</p>
<p>Google SQL is Google's simple SQL database service. Less developed at the moment than Amazon SQL services in terms of types of SQLs, it comes with MySQL as the main database. A beta version of Postgre is also available. We will look at the differences between the two in terms of respective functionalities.</p>
<p>Making services talk to one another, or more precisely, allowing data transfers between different data stores and data consumers, is usually where the difficulty lies when using cloud-based solutions for data science projects.</p>
<p>Issues such as volume, latency, and throughput can affect the speed of your scripts and the efficiency of your work. Setting the right level of permissions so that your data can be accessed within your project environment while still being protected from outside access is also key.</p>
<p>In this chapter, you will learn:</p>
<ul>
<li>How to store files on Google Storage with gsutil</li>
<li>How to create databases and seed them with data on Google SQL</li>
<li>How to access your Google Storage files and your Google SQL database </li>
</ul>
<p>At the end of the chapter, you will be able to upload data and manage it using the services provided by the Google Cloud platform and understand the potential of Google Cloud SQL for the creation of <span>relational database management systems.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud Storage</h1>
                </header>
            
            <article>
                
<p>Cloud storage is a model for storing data on computers available on the network, where the data is stored on multiple servers, real and/or virtual, generally hosted at third-party facilities or on dedicated servers. Through this model, it is possible to access personal or business information, whether it be videos, music, photographs, databases, or files, without knowing the physical location of the data, from any part of the world with any suitable device. The advantages of this methodology are numerous: infinite capacity of memory space, payment only of the actual amount of memory used, files accessible from anywhere in the world, highly reduced maintenance, and greater security, as the files are protected from theft, fire, or damage that may occur on local computers.</p>
<p>Google Cloud Storage is the Google proposal for Cloud storage: it's a developer service provided by Google that allows you to save and manipulate data directly on Google's infrastructure. In more detail, Google Cloud Storage provides a programming interface that makes use of simple HTTP requests to perform operations on its infrastructure. With Google Cloud Storage you can perform the following operations: uploading a file, downloading a file, deleting a file, obtaining a list of files, or obtaining the size of a given file. Each of these HTTP requests contains information about the method used and the resource to request. It follows that it becomes possible to create an application that, using these HTTP requests, provides a service in which applications save data remotely, generally via third-party servers.</p>
<p>The Google Storage platform is an enterprise storage solution that offers three levels of storage with different accessibility needs and associated pricing:</p>
<ul>
<li>Standard storage is for fast access to large amounts of data. At $0.026/GB, it offers a high speed of response to requests.</li>
<li><strong>Durable Reduced Availability</strong> (<strong>DRA</strong>) is for long-term data storage and infrequent access. It is priced lower, at $0.02/GB.</li>
<li>Finally, nearline storage is for even-less-frequent access. It is the cheapest version of the service, with much longer response time. It is the cheapest option, currently priced at $0.01/ GB.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Box–storage versus drive</h1>
                </header>
            
            <article>
                
<p><span>Google Drive is used for storing personal files. It is free up to 15 GB across all your different personal services (email, photo, and so on). It offers further data storage volume for a monthly fee (for instance $9.99/month for 1 TB). But, compared to Google Storage, there is no data compression or data encryption. It is not offered by Google as an enterprise platform with associated features, support, and reliability. There are no advanced management features, such as metadata, and no data organization management through buckets. There are also no advanced storage tiers (cold versus hot data). </span></p>
<p>The main features of the Google Drive service are as follows:</p>
<ul>
<li class="mce-root">There is no data storage based on tiers</li>
<li class="mce-root">It is not a commercial solution</li>
<li class="mce-root">It does not support advanced data management features</li>
<li class="mce-root">The storage plan is limited to 30 TB</li>
</ul>
<p>To understand the potential offered by Google Cloud Storage, see the following:</p>
<ul>
<li>It provides unlimited space</li>
<li>It has more security than Google Drive thanks to the use of OAuth</li>
<li>It offers advanced storage levels</li>
<li>It provides REST API support for advanced integration of enterprise services and applications</li>
<li>It has the possibility to resume data transfer after an error</li>
</ul>
<p>By analyzing only some of the features offered by Google Cloud Storage, it appears evident its superiority justifies the cost.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing control lists</h1>
                </header>
            
            <article>
                
<p>The documentation says it best, <strong>Access Control Lists</strong> (<strong>ACLs</strong>) allow you to control who can read and write your data, and who can read and write the ACLs themselves.</p>
<p class="mce-root">If not specified at the time an object is uploaded (e.g., via the <kbd>gsutil cp -a</kbd> option),<br/>
objects will be created with a default object ACL set on the bucket (see <kbd>gsutil help</kbd><br/>
<kbd>defacl</kbd> <a href="https://cloud.Google.com/storage/docs/gsutil/commands/defacl">https://cloud.Google.com/storage/docs/gsutil/commands/defacl</a>). You can<br/>
replace the ACL on an object or bucket using the gsutil acl set command, or modify the existing ACL using the <kbd>gsutil acl ch</kbd> command (see <kbd>gsutil help acl</kbd>: <a href="https://cloud.google.com/storage/docs/gsutil/commands/acl">https://</a><a href="https://cloud.google.com/storage/docs/gsutil/commands/acl">cloud.Google.com/storage/docs/gsutil/commands/acl</a>).</p>
<p>ACL are assigned to objects (files) or buckets. By default all files in a bucket have the same<br/>
ACL as the bucket they're in.<br/>
A couple of points to remember are:</p>
<ul>
<li>There is no write access for objects; attempting to set an ACL with write<br/>
permission for an object will result in an error</li>
<li>The object ACL is what determines read access independently of the bucket ACL read settings. (the folder permissions does not override the file access. )</li>
</ul>
<p>Several presets are available. The available canned ACLs are:</p>
<ul>
<li><strong>Project-private:</strong> Gives permission to the project team based on their roles.<br/>
Anyone who is part of the team has read permission, and project owners and<br/>
project editors have owner permission. This is the default ACL for newly created<br/>
buckets. This is also the default ACL for newly created objects unless the default<br/>
object ACL for that bucket has been changed. For more details see gsutil help<br/>
projects.</li>
<li><strong>Private:</strong> Gives the requester (and only the requester) owner permission for a<br/>
bucket or object.</li>
<li><strong>Public-read:</strong> Gives all users (whether logged in or anonymous) read permission.<br/>
When you apply this to an object, anyone on the internet can read the object<br/>
without authenticating.</li>
<li><strong>Public-read-write:</strong> Gives all users read and write permission. This ACL applies<br/>
only to buckets. Setting a bucket to public-read-write will allow anyone on the<br/>
internet to upload anything to your bucket. You will be responsible for this<br/>
content. There are other settings, check the doc.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Access and management through the web console</h1>
                </header>
            
            <article>
                
<p>In the previous sections, we introduced the service provided by the GCP. Now it's time to see how to access the service and how to manage it. To do this, Google has created a web-based interface for completely online service management and gsutil, a command-line tool that allows you to perform all the operations you need on the service.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">gsutil</h1>
                </header>
            
            <article>
                
<p>gsutil is the command-line tool, a subset of <kbd>gcloud</kbd> shell scripts, that allows you to manage buckets and objects (files) on Google Storage. The operations available via gsutil go from simple straightforward commands for creating buckets and moving files around, to management commands to manage settings, storage class, and permissions. More advanced commands include setting access control via ACLs, defining life cycle rules (delete all files after 1 year), logging, creating notifications, and troubleshooting with perfdiag.</p>
<p>Let's start with the simple commands. We will create a bucket named <kbd>packt-gcp</kbd>, upload some files, get info on these files, move them around, and change the storage class.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">gsutil cheatsheet</h1>
                </header>
            
            <article>
                
<p>The following is a list of the most-used commands that we can issue via gsutil:</p>
<ul>
<li>Creating a bucket named <kbd>packt-gcp</kbd>:
<ul>
<li><kbd>gsutil mb gs://packt-gcp</kbd></li>
</ul>
</li>
<li>
<p>Uploading a file to the bucket:</p>
<ul>
<li><kbd>gsutil cp gs://packt-gcp/</kbd></li>
</ul>
</li>
<li>Creating a subfolder in the bucket:
<ul>
<li style="color: black"><kbd>gsutil cp your-file gs://packt-gcp/</kbd></li>
</ul>
</li>
<li>Listing the folder:
<ul>
<li style="color: black"><kbd>gsutil ls gs://packt-gcp/</kbd></li>
</ul>
</li>
<li>Getting help on gsutil commands:
<ul>
<li><kbd>gsutil help</kbd></li>
</ul>
</li>
</ul>
<ul>
<li>How much storage are we using (the <kbd>-h</kbd> makes it readable):
<ul>
<li><kbd>gsutil du -h gs://packt-gcp/</kbd></li>
</ul>
</li>
<li>Copying a whole folder to a bucket:
<ul>
<li style="color: black"><kbd>gsutil cp -r gs://packt-gcp/</kbd></li>
</ul>
</li>
</ul>
<p>For instance, I have a local <kbd>./img</kbd> directory with some images. I can copy the whole directory and create the bucket subdirectory at the same time with the following command:</p>
<pre><strong>gsutil cp -r ./img gs://packt-gcp/</strong></pre>
<p>Let's analyze an option that is particularly useful: I refer to the <kbd>-m</kbd> flag. If you are performing a sequence of <kbd>gsutil</kbd> operations it may run significantly faster if you instead use <kbd>gsutil -m -o</kbd>, this means to run in parallel. This can significantly improve performance if you are performing operations on a large number of files over a reasonably fast network connection but may make performance worse if you are using a slower network.</p>
<p>The <kbd>-m</kbd> flag is particularly suited to the following commands: <kbd>ls</kbd>, <kbd>mb</kbd>, <kbd>mv</kbd>, <kbd>rb</kbd>, and <kbd>du</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced gsutil</h1>
                </header>
            
            <article>
                
<p>Previously, we have seen some simple basic commands that we can import using <kbd>gsutil</kbd>. But with this tool we can do something else:</p>
<ul>
<li>
<p><kbd>gsutil</kbd> supports wildcards (and ?) and limits a wildcard to files. To include folders in the wildcard target double the sign: <kbd>gsutil ll gs:///**.txt</kbd> will list all the text files in subdirectories.</p>
</li>
<li>
<p><kbd>gsutil</kbd> requires use of UTF-8 character encoding. For Windows: to use Unicode characters you need to run this command in the command shell before the first time you use <kbd>gsutil</kbd> in that shell: <kbd>chcp 65001</kbd>.</p>
</li>
<li>
<p>The <kbd>.boto</kbd> file in your local machine user path is the configuration file for the gsutil CLI. You can edit it directly or via the <kbd>gsutil</kbd><kbd>config</kbd> command. Some interesting parameters in the <kbd>.boto</kbd> file are as follows:</p>
<ul>
<li><kbd>parallel_composite_upload_threshold</kbd>: This is used to specify the maximum size of a file to be uploaded in a single stream. Files larger than this threshold will be uploaded in parallel. The <kbd>parallel_composite_upload_threshold</kbd> parameter is for the moment disabled by default.</li>
<li><kbd>check_hashes</kbd>: This is used to enforce integrity checks when downloading data, always, never, or conditionally.</li>
<li><kbd>prefer_api</kbd>: This parameter value is JSON or XML.</li>
<li><kbd>aws_access_key_id</kbd>: <span>This is used for interoperability with S3.</span></li>
<li><kbd>aws_secret_access_key</kbd>: This is used for interoperability with S3.</li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Signed URLs</h1>
                </header>
            
            <article>
                
<p>Signed URLs is a mechanism for query string authentication for buckets and objects. Signed URLs provide a way to give time-limited read or write access to anyone in possession of the URL, regardless of whether they have a Google account.</p>
<p>Why use a signed URL? Sometimes, it is necessary to control the access of users who do not have a Google account. To grant these users access to Google Cloud Storage we can provide them with a signed URL, which allows the user to read, write, or delete access to that resource for a limited period of time. Access to the resource is allowed to the owner of the URL until the URL expires.</p>
<p>There are two ways to create a signed URL:</p>
<ul>
<li>Creating signed URLs with <kbd>gsutil</kbd></li>
<li>Creating signed URLs with a program. </li>
</ul>
<p>The easiest way to create a signed URL is to use the <kbd>gsutil signurl</kbd> command. To do this, you first need to generate a private key or use an existing private key. To create a private key you first have to create an OAuth client ID for a service account. </p>
<p>To create a new <span>private key visit: </span><a href="https://console.cloud.google.com/apis/credentials?project=packt-gcp">https://console.cloud.Google.com/apis/credentials?project=packt-gcp</a></p>
<p>Follow the instructions and download the file. Two formats are available: </p>
<ul>
<li><span><strong>JSON</strong>: Required if you are using application default credentials in a production environment outside of Google Cloud platform</span></li>
<li><span><span><strong>PKCS12</strong>: Supported by many different programming languages and libraries</span></span></li>
</ul>
<div class="packt_tip">To restrict the role that can access GCP: Get JSON file downloaded to your computer.</div>
<p>You can now create a signed URL for one of your files with <kbd>gsutil</kbd> via the following command:</p>
<pre><strong>gsutil signurl -d 10m -m GET Desktop/privatekey1.json gs://packt-gcp/file1.csv</strong></pre>
<p>Remember, signed URLs do not work on directories. If you want to give access to multiple files you can use wildcards as follows:</p>
<pre><strong>gsutil signurl -d 10m -m GET Desktop/privatekey1.json gs://packt-gcp/img/.png</strong></pre>
<p>But that will generate one signed URL per <kbd>.png</kbd> file in the <kbd>img/</kbd> folder.</p>
<p>Signed URLs can also be used to upload files (<kbd>-m PUT</kbd> and <kbd>POST</kbd>) and specify the content type with <kbd>-c text/plain</kbd> or <kbd>-c image/jpg</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a bucket in Google Cloud Storage</h1>
                </header>
            
            <article>
                
<p><span>As we said previously, a bucket is a container that holds your data. Everything saved in Google Storage must be contained within a bucket, corresponding to the folders. You can use them to organize and control access to data, but, unlike folders, you can not create sub-buckets. In Google Storage, individual data is saved in the form of objects. Such objects can be files of any type, extension, and size; tables created with BigQuery are also considered objects, as we will see in <a href="862553c5-4bb7-4a5c-b7bd-03f0eb8d413e.xhtml" target="_blank">Chapter 4</a>, <em>Querying Your Data with BigQuery</em>. All objects related to a single job must be contained in a bucket.</span></p>
<p>Objects are immutable, so an object cannot be edited directly in Google Storage. It is important to specify that it is not possible to make any kind of changes to the content of an object; if you want to modify an object stored in Google Storage it can only be replaced. In case you do not want to delete it and reload it, you can do the same thing with just one operation, by overwriting it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Storage namespace</h1>
                </header>
            
            <article>
                
<p>Google Storage uses a hierarchical structure to store buckets and objects. All buckets are in this one environment, and all objects are also inside a hierarchy within a certain bucket. Based on this hierarchical structure, a<span> bucket name has to be unique across all the existing Google Storage buckets. Each bucket name must be unique across the entire Cloud storage namespace. </span></p>
<p>To name a bucket, we cannot use a name that has already been chosen by another user. While objects must have a unique name only within a given bucket, we can therefore have multiple buckets that always contain an object with the same name.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Naming a bucket</h1>
                </header>
            
            <article>
                
<p>To name a bucket, we have to follow some rules imposed by the fact; as we anticipated, all the buckets reside in the only Google Storage namespace. Bucket names must comply with the following rules:</p>
<ul>
<li>They must be 3 to 63 characters long</li>
<li>They must start and end with a number or a letter</li>
<li>They must contain only lowercase letters, numbers, dots, and dashes</li>
<li>They cannot be represented as an IP address in dotted decimal notation</li>
<li>They cannot start with the prefix GOOG</li>
<li>They cannot contain two adjacent points or a dash before or after a point</li>
</ul>
<p>Finally, it should be noted that once you have created the name of a bucket, you cannot change it. To change it, you should create a new bucket with the desired name and move the contents from the old bucket to the new bucket.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Naming an object</h1>
                </header>
            
            <article>
                
<p><span>In Google Storage, individual data is saved in the form of objects. Object names must comply with the following rules:</span></p>
<ul>
<li>They can contain any sequence of valid Unicode characters, of length 1-1,024 bytes when UTF-8 encoded</li>
<li>They cannot contain carriage return or line feed characters</li>
<li>They cannot start with well-known/acme-challenge</li>
</ul>
<p>To eliminate the limitations given by the flat hierarchy, we can use the slash (<kbd>/</kbd>) character in the object names. For example, if we have to use the same name for two different objects we could name an object <kbd>/NewYork/Stadium.jpg</kbd> and another <kbd>/Boston/Stadium.jpg</kbd>. In this way it is possible to organize the objects as if they were inside directories and manage them as such. In fact, Google Storage sees objects as independent objects that have no hierarchical relationship.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a bucket</h1>
                </header>
            
            <article>
                
<p>To operate in Google Cloud Storage we can use two tools: console and gsutil. The first tool makes use of typical graphic interfaces, while the second uses command-line windows.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud Storage console</h1>
                </header>
            
            <article>
                
<p>To start with, we will see how to create a bucket using the Google Cloud Storage console. First, when we access it, we can get to that console starting from the main Google Cloud Platform by clicking on the left in the Resources section on the entry Cloud Storage. The following window will be open:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f6636d32-3b36-4bee-9fe0-fcbd1f337a42.png"/></div>
<p>In the window that opens, all the buckets related to the account are present. For each of them, there are the following features:</p>
<ul>
<li><strong>Name</strong>: Bucket name.</li>
<li><strong>Default storage class</strong>: S<span>torage class assigned by default to the objects added to a bucket.</span></li>
<li><strong>Location</strong>: Place where data is stored.</li>
<li><strong>Lifecycle</strong>: <span>Allows you to set rules for automatically deleting objects or downgrading their storage class.</span></li>
<li><strong>Labels</strong>: Help organize your buckets. Labels are also included in your bill, so you can see the distribution of costs across your labels.</li>
<li><strong>Requester pays</strong>: <span>If On</span><span>, requests for the bucket's data will be billed to the requester's project.</span></li>
</ul>
<p>To create a new bucket, simply click on the <span class="packt_screen">CREATE BUCKET</span> button at the top of the Google Cloud Storage browser. The following page is opened:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/45b5f24a-6b35-471b-a591-a999a215a242.png"/></div>
<p>On the page that opens, you need to specify the following information:</p>
<ul>
<li><strong>Name</strong>: Remember, it <span>must be unique across Cloud Storage</span></li>
<li><span><strong>Default storage class</strong>: Four options are available: Multi-Regional, Regional, Nearline, and Coldline</span></li>
<li><span><strong>Location</strong>: This drop-down menu allows us to choose the location</span></li>
</ul>
<p>After making these choices, just click on the <span class="packt_screen">CREATE</span> button and a new bucket will be added to the Google Cloud Storage browser. </p>
<p>Now we have the container, it is time to enrich it with contents. To do this, we must first access the simple bucket by clicking on its name. <span>The following page is opened:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e3cb3512-7378-4241-a2e4-298519b86f70.png"/></div>
<p>On the page that opens, all the contents of the buckets is listed. For each object, a series of information is proposed:</p>
<ul>
<li><strong>Name</strong>: Object name</li>
<li><strong>Size</strong>: Object dimension</li>
<li><strong>Type</strong>: Object type</li>
<li><strong>Storage class</strong>: <span>Storage class assigned to the objects added to a bucket</span></li>
<li><strong>Last modified</strong>: Date of last modification of the object</li>
</ul>
<p>To add another object to the bucket:</p>
<ol>
<li>Simply click on the <span class="packt_screen">UPLOAD FILES</span> button at the top of the Google Cloud Storage browser. A dialog window is opened.</li>
<li>In the dialog window, select the file or folder you want to upload to your bucket.</li>
<li>Click <span class="packt_screen">Open</span>.</li>
</ol>
<p>If we use Chrome as a browser it is possible to perform folder uploads. This way, we can load the entire contents of a folder into a bucket. Otherwise, we can first create a folder, using the <span class="packt_screen">CREATE FOLDER</span> button and then upload all the objects individually.</p>
<p>To rename, copy, and move objects simply click the more options button (three vertical dots) associated with the object. A context menu is opened. In it we will be able to carry out the following operations:</p>
<ul>
<li>Edit permissions</li>
<li>Edit metadata</li>
<li>Copy</li>
<li>Move</li>
<li>Rename</li>
</ul>
<p>For each option, a relative window will be opened that will guide us in the operation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud Storage gsutil</h1>
                </header>
            
            <article>
                
<p>We have seen that using the Google <span>Cloud Storage browser </span>is simple and intuitive. But in some cases it is necessary to operate through a command window. In such cases, as we have seen in previous sections, we can use <kbd>gsutil</kbd>. Previously, we had already seen a series of commands via <kbd>gsutil</kbd>.</p>
<p>To create a bucket using <kbd>gsutil</kbd>, use the <kbd>mb</kbd> command. For example, use the following command:</p>
<pre><strong>gsutil mb gs://NameBucket1</strong></pre>
<p>This creates a bucket named <kbd>NameBucket1</kbd>. It is important to remember that bucket names must be unique within the entire Google Storage namespace. If another user has already created a bucket with the name we want to use, we must choose another name.</p>
<p>Once the buckets are created, we can import the objects within them. With the <kbd>cp</kbd> command, we can copy files from our computer to Google Storage:</p>
<pre><strong>gsutil cp figure.jpg gs://NameBucket1/fig.jpg</strong></pre>
<p>This copies the image <kbd>figure.jpg</kbd> from the folder in which we are positioned with the shell in the bucket <kbd>NameBucket1</kbd> renaming the object in <kbd>fig.jpg</kbd>.</p>
<p>To list our buckets or the objects contained in them you must use the <kbd>ls</kbd> command.</p>
<div class="packt_tip">The <kbd>ls</kbd> command is used in Unix-like operating systems to display information about files and directories. If we open a terminal and type <kbd>ls</kbd>, we get the list of files and directories of the current directory.</div>
<p>The following command <span>lists all the buckets we have created:</span></p>
<pre class="mce-root"><strong>gsutil ls</strong></pre>
<p class="mce-root"> While this command <span>lists the objects contained in</span> <kbd><span>NameBucket1</span></kbd><span>:</span></p>
<pre class="mce-root"><strong>gsutil ls gs: // NameBucket1</strong></pre>
<p>You can also use the <kbd>-L</kbd> option of the <kbd>ls</kbd> command to get more information about objects and buckets. The following command <span>provides information about the size of objects, the date of the last modification, the data type, and the <strong>Access Control Lists</strong> (<strong>ACL</strong>) of all objects contained in the <kbd>NameBucket1</kbd> bucket:</span></p>
<pre class="mce-root"><strong>gsutil ls -L gs: // NameBucket1</strong></pre>
<p class="mce-root">While the following command <span>provides information on our buckets, such as the number of objects contained, the total size, and the ACL of all our buckets:</span></p>
<pre class="mce-root"><strong>gsutil ls -L</strong></pre>
<p>Finally, to transfer an object from one bucket to another, use the <kbd>mv</kbd> command, this command can also be used to rename an object. For example, the following command <span>transfers the image <kbd>figure.png</kbd> from the <kbd>NameBucket1</kbd> bucket to the <kbd>NameBucket2</kbd> bucket:</span></p>
<pre class="mce-root"><strong>gsutil mv gs://NameBucket1/figure.png gs:// NameBucket2/</strong></pre>
<p class="mce-root"> While this command <span>renames the image </span><kbd>figure.png</kbd><span> to </span><kbd>fig.png</kbd><span>:</span></p>
<pre class="mce-root"><strong>gsutil mv gs://NameBucket1/figure.png gs://NameBucket1/fig.png</strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Life cycle management</h1>
                </header>
            
            <article>
                
<p>With Google Cloud Storage, the life cycle management of objects becomes simple and immediate. The life cycle of an object is the time between the creation of an object and its destruction. The rules for the duration of the object vary significantly between the programming platforms. In the case of archived objects we refer to the time in which the object remains stored in the space assigned to it.</p>
<p>The life cycle of a bucket can be managed through its configuration. The configuration contains a set of rules that apply to all objects in the bucket. The action specified on the object is performed when the object meets the criteria of one of the rules.</p>
<p>To enable life cycle for a bucket using the Google Cloud Console:</p>
<ol>
<li>Go to Open the Google Cloud Platform Console and click on the Cloud Storage browser; the following window is opened:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5bb12fd1-74a5-4a5a-831b-9ebce5c810ba.png"/></div>
<ol start="2">
<li>In this window, examine the <strong>Lifecycle</strong> column, choose the bucket, and click on the entry <strong>None</strong>; a new page is opened. </li>
<li>In this window, click on <span class="packt_screen">Add Rule</span>.</li>
<li>In the page that opens, we can specify the configuration by selecting the conditions and the actions. </li>
<li>Finally, click on the <span class="packt_screen">Save</span> button.</li>
</ol>
<p>A similar procedure can be performed to check the life cycle configuration set on a bucket, and to disable life cycle management for a bucket. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud SQL</h1>
                </header>
            
            <article>
                
<p>Google Cloud SQL is a database service of the Google Cloud Platform that allows the creation, management, and administration of relational databases in the cloud for their applications. The service guarantees excellent performance and scalability thanks to the Google infrastructure on which the databases will be hosted. Like every service on the platform, the simplicity of use is fundamental: there is no need to install any software, make updates manually, or take care of backups and replications of their databases. The Google platform will take care of all of it and ensure an availability of 99.95%. The data is encrypted before being saved in the databases and in the backups, to guarantee the security of the infrastructure.</p>
<p>You can also set up a network firewall for each database instance to directly regulate access to the instances. The service can be used with any type of Cloud-based application or website that is compatible with MySQL or PostgreSQL, and the instances are easily accessible through the app engine, compute engine, and platform workstation.</p>
<p>The cost of the service does not require any initial payment, but is calculated minute by minute for the entire duration of use and only the resources actually allocated will be charged. In the case of MySQL databases, the standard price range for a Cloud SQL instance is $0.0150 – $4.0240 per hour (up to 208 GB of RAM), while for storage space it goes from $ 0.08 per GB/month for backups, $ 0.09 per GB/month for HDD storage, and $ 0.17 GB/month for SSD storage. To these must be added the costs for the management of the network through the compute engine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Databases supported</h1>
                </header>
            
            <article>
                
<p>With Google Cloud SQL, it is possible to create two types of relational databases:</p>
<ul>
<li>MySQL</li>
<li>PostgreSQL</li>
</ul>
<p>MySQL is an open source <strong>relational database management system</strong> (<strong>RDMB</strong>) available for free using <strong>Structured Query Language</strong> (<strong>SQL</strong>). SQL is the most popular language for adding, accessing, and managing content in a database. It is known for its rapid processing, proven reliability, ease, and flexibility of use. MySQL is an essential part of almost all open source PHP applications.</p>
<p>PostgreSQL is an advanced database system with a long history behind it. It is available for a wide range of platforms and is used in microscopic embedded systems as well as in huge multi-terabyte systems. PostgreSQL has earned an excellent reputation over the years for its innovative features, data integrity, security, and reliability.</p>
<p>PostgreSQL support is still in beta, so features such as replication or high availability are not available. The instances of the platform they support MySQL 5.7 or PostgreSQL 9.6 databases in the cloud and allow for up to 208 GB of RAM, 32 CPUs, and 10 TB of storage. The data, encrypted on Google networks and within tables and backups, are accessible from their applications created through the app engine (written in Java, Python, PHP, Node.js, Go, or Ruby), through clients MySQL/PostgreSQL using standard protocols, or even through external applications, with the possibility of using secure connection protocols, such as SSL.</p>
<p class="mce-root">In general, there are no noticeable differences between the functionality provided by the standard MySQL/PostgreSQL instances locally and those provided by the Cloud SQL instances. In particular, we remind you that it is impossible to create new functions in MySQL using the <kbd>CREATE FUNCTION</kbd> statement and the lack <kbd>SUPER</kbd> (MySQL) and <kbd>SUPERUSER</kbd> (PostgreSQL) privileges.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud SQL performance and scalability</h1>
                </header>
            
            <article>
                
<p>Cloud SQL offers excellent performance and scalability. As mentioned previously, the maximum storage capacity is 10 TB (to be distributed between HDD and SSD), while the maximum RAM that can be selected is 208 GB, and the maximum number of CPUs is 32. Google also guarantees a maximum of 25,000 IOPS, that is, input/output operations per second. The possibility to choose such resources allows us therefore to use Cloud SQL for every type of application, from those with lower workloads to applications that require intense performance. There are no limits of <span><strong>query per second</strong> (</span><strong>QPS</strong>), but there are some limits regarding the connections. In fact, up to a maximum of 4,000 concurrent connections are possible in the case of second-generation MySQL instances, while for the other cases the limits are more stringent.</p>
<p class="mce-root">For first-generation MySQL databases only, where incoming requests are briefly queuing before establishing a connection, there is a limit of 100 queued connections at the same time. The databases are also easily scalable both vertically, increasing or reducing the available resources (storage space, CPU, and RAM), and horizontally increasing the number of servers and instances that work simultaneously. Once you have created your instance, you can change the resources allocated for it directly from the console. In general, the changes are applied immediately, but the restart of the instance will close the existing connections and will need a few moments (in the case of first-generation MySQL) or a few minutes (second generation) to get back online.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Cloud SQL security and architecture</h1>
                </header>
            
            <article>
                
<p>Regarding security, the data available on Cloud SQL is encrypted within the tables, in temporary files, in backup copies, and during the movements within the Google infrastructure from one server to another using secure network protocols. The platform infrastructure is therefore designed to ensure the security of its data at every stage of information management. No action is required by the user: the data is automatically encrypted by the platform through the compute engine, so all the services provided by it will comply with these requirements.</p>
<p>From a design point of view, the security of the infrastructure on a global scale is organized according to a layered architecture. This architecture allows the safe use of services, data, and communications between services, users, and administrators.</p>
<p>Starting from the lowest level, that is, hardware, we have data centers that Google designs and builds autonomously, accessible only to a small number of employees and monitored by equipment such as metal detectors, video cameras, or biometric identification technologies. Individual data centers are made up of multiple servers connected to a single local network: it is always up to Google to verify that the components, designed by themselves, and their suppliers meet the company's security standards. The individual server machines, individually identified to be easily traceable, are controlled by digital signatures on each individual low-level component and validated at each start-up.</p>
<p>Moving to the software level, every application written and made to run on the platform is run in multiple copies on multiple machines to use the necessary amount of resources for each workload. The software architecture is multi-tenant, in which a single instance of a software runs on a server and serves more tenants (that is, users who share access to the instance). It will be the task of the application to provide to each tenant a dedicated part of the instance. The concept is diametrically opposed to that of the multi-instance architecture, where there are several instances of software each dedicated to the single client.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating Google Cloud SQL instances</h1>
                </header>
            
            <article>
                
<p>A Google Cloud SQL instance is a set of memory structures that manage database files. The instance manages its associated data and serves the users of the database. Every running Google Cloud SQL database is associated with at least one database instance.</p>
<p><span>Cloud SQL instances are fully managed, relational MySQL and PostgreSQL databases. Google handles replication, patch management, and database management to ensure availability and performance. When you create an instance, choose a size and billing plan to fit your application.</span></p>
<p><span>To create a Google Cloud SQL instance:</span></p>
<ol>
<li>Go to the <span>Google Cloud </span><span>SQL instances page at the following URL: </span><a href="https://console.cloud.google.com/sql/instances" target="_blank">https://console.cloud.google.com/sql/instances</a>.</li>
<li>Click on the <span class="packt_screen">create instance</span> button at the middle of the page. A guided sequence will lead us to create the instance.</li>
<li>Choose the database type; two options are available: MySQL and PostgreSQL (MySQL is the default choice). After making your choice, click on the next button.</li>
<li><span>Choose a MySQL instance type; two options are available: MySQL Second Generation (recommended) and MySQL First Generation. MySQL Second Generation offers high performance, high storage capacity, and low cost. MySQL First Generation is the older version of Cloud SQL, providing basic performance and storage capacity. To make your choice, click on the Choose Second/First Generation button. </span></li>
</ol>
<ol start="5">
<li><span>A </span><span>new page is opened. In this page, a set of choices must be made, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><span><img src="assets/fcdd0720-2204-4dbf-8443-b14e15f57e27.png"/></span></div>
<p class="CDPAlignCenter CDPAlign CDPAlignLeft" style="padding-left: 60px"><span> The first choice concerns the name of the instance. This is a name visible from the outside so it is advisable not to include sensitive or personally identifiable information in that name. Furthermore, it is not necessary to include the project ID in the instance name; if necessary, it is added automatically.</span></p>
<ol start="6">
<li>Set <span>the password for the <kbd>'root'@'%'</kbd> user.</span></li>
<li><span>Set the region.</span></li>
<li>Set configuration options.</li>
<li>Finally, click on the <kbd>Create</kbd> button.</li>
</ol>
<p>In this way, a new instance will have been created.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we have discovered two additional services offered by Google Cloud Platform: Google Cloud Storage, and Google Cloud SQL. Google Cloud Storage is a file hosting service that lets you store files in the cloud. We have seen how to store videos, music, photographs, databases or files, without knowing the physical location of data, from anywhere in the world, with any suitable device. We have performed the file uploading operations either using the browser or using the command line.</p>
<p>Afterward, we understood the potential of Google Cloud SQL for the creation of a relational database management system. Using Google Cloud SQL you can create, manage and administer relational databases. At first we discovered the characteristics of the service and later we learned to create a new database instance through a practical example.</p>


            </article>

            
        </section>
    </body></html>