- en: Chapter 2. Data Exploration with RMS Titanic
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章：使用RMS Titanic进行数据探索
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下食谱：
- en: Reading a Titanic dataset from a CSV file
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从CSV文件中读取Titanic数据集
- en: Converting types on character variables
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在字符变量上转换类型
- en: Detecting missing values
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测缺失值
- en: Imputing missing values
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 填充缺失值
- en: Exploring and visualizing data
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索和可视化数据
- en: Predicting passenger survival with a decision tree
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用决策树预测乘客生存率
- en: Validating the power of prediction with a confusion matrix
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用混淆矩阵验证预测能力
- en: Assessing performance with the ROC curve
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ROC曲线评估性能
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: Data exploration helps a data consumer to focus on searching for information,
    with a view to forming a true analysis from the gathered information. Furthermore,
    with the completion of the steps of data munging, analysis, modeling, and evaluation,
    users can generate insights and valuable points from their focused data.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 数据探索帮助数据消费者专注于搜索信息，目的是从收集到的信息中形成真正的分析。此外，在完成数据清洗、分析、建模和评估的步骤后，用户可以从他们专注的数据中生成见解和有价值的信息。
- en: 'In a real data exploration project, there are six steps involved in the exploration
    process. They are as follows:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个真实的数据探索项目中，探索过程中涉及六个步骤。它们如下所示：
- en: Asking the right questions.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提出正确的问题。
- en: Data collection.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据收集。
- en: Data munging.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据清洗。
- en: Basic exploratory data analysis.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基本的数据探索分析。
- en: Advanced exploratory data analysis.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 高级数据探索分析。
- en: Model assessment.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型评估。
- en: 'A more detailed explanation of these six steps is provided here:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这里提供了这六个步骤的更详细解释：
- en: '**Asking the right questions**: When the user presents their question, for
    example "What are my expected findings after the exploration is finished?", or
    "What kind of information can I extract through the exploration?," different results
    will be given. Therefore, asking the right question is essential in the first
    place, for the question itself determines the objective and target of the exploration.'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**提出正确的问题**：当用户提出问题，例如“探索完成后，我预期的发现是什么？”或“通过探索我可以提取哪些信息？”时，会得到不同的结果。因此，首先提出正确的问题是至关重要的，因为问题本身决定了探索的目标和对象。'
- en: '**Data collection**: Once the goal of exploration is determined, the user can
    start collecting or extracting relevant data from the data source, with regard
    to the exploration target. Mostly, data collected from disparate systems appears
    unorganized and diverse in format. Clearly, the original data may be from different
    sources, such as files, databases, or the Internet. To retrieve data from these
    sources requires the assistance of the file IO function, JDBC/ODBC, web crawler,
    and so on. This extracted data is called **raw data**, which is because it has
    not been subjected to processing, or been through any other manipulation. Most
    raw data is not easily consumed by the majority of analysis tools or visualization
    programs.'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**数据收集**：一旦确定了探索的目标，用户就可以开始从数据源收集或提取与探索目标相关的相关数据。大多数情况下，从不同的系统中收集的数据看起来是不规则的和格式多样的。显然，原始数据可能来自不同的来源，如文件、数据库或互联网。从这些来源检索数据需要文件IO函数、JDBC/ODBC、网络爬虫等的帮助。这种提取的数据被称为**原始数据**，因为它尚未经过处理，或经过任何其他操作。大多数原始数据不易被大多数分析工具或可视化程序消费。'
- en: '**Data munging**: The next phase is data munging (or wrangling), a step to
    help map raw data into a more convenient format for consumption. During this phase,
    there are many processes, such as data parsing, sorting, merging, filtering, missing
    value completion, and other processes to transform and organize the data, and
    enable it to fit into a consume structure. Later, the mapped data can be further
    utilized for data aggregation, analysis, or visualization.'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**数据清洗**：下一个阶段是数据清洗（或整理），这是一个帮助将原始数据映射到更便于消费的格式的步骤。在这个阶段，有许多过程，如数据解析、排序、合并、过滤、缺失值补全以及其他转换和组织数据的过程，使其能够适应消费结构。随后，映射后的数据可以进一步用于数据聚合、分析或可视化。'
- en: '**Basic exploratory data analysis**: After the data munging phase, users can
    conduct further analysis toward data processing. The most basic analysis is to
    perform exploratory data analysis. Exploratory data analysis involves analyzing
    a dataset by summarizing its characteristics. Performing basic statistical, aggregation,
    and visual methods are also crucial tasks to help the user understand data characteristics,
    which are beneficial for the user to capture the majority, trends, and outliers
    easily through plots.'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**基本探索性数据分析**：在数据清洗阶段之后，用户可以进一步进行数据处理分析。最基本的分析是执行探索性数据分析。探索性数据分析涉及通过总结其特征来分析数据集。执行基本的统计、聚合和可视化方法对于帮助用户理解数据特征也是至关重要的任务，这有助于用户通过图表轻松捕捉到大多数、趋势和异常值。'
- en: '**Advanced exploratory data analysis**: Until now, the descriptive statistic
    gives a general description of data features. However, one would like to generate
    an inference rule for the user to predict data features based on input parameters.
    Therefore, the application of machine learning enables the user to generate an
    inferential model, where the user can input a training dataset to generate a predictive
    model. After this, the prediction model can be utilized to predict the output
    value or label based on given parameters.'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**高级探索性数据分析**：到目前为止，描述性统计提供了数据特征的总体描述。然而，人们希望为用户提供一个基于输入参数预测数据特征的推理规则。因此，机器学习的应用使得用户能够生成一个推理模型，用户可以输入训练数据集以生成预测模型。之后，预测模型可以根据给定的参数预测输出值或标签。'
- en: '**Model assessment**: Finally, to assess whether the generating model performs
    the best in the data estimation of a given problem, one must perform a model selection.
    The selection method here involves many steps, including data preprocessing, tuning
    parameters, and even switching the machine learning algorithm. However, one thing
    that is important to keep in mind is that the simplest model frequently achieves
    the best results in predictive or exploratory power; whereas complex models often
    result in over fitting.'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**模型评估**：最后，为了评估生成的模型在给定问题的数据估计中是否表现最佳，必须进行模型选择。选择方法涉及许多步骤，包括数据预处理、调整参数，甚至切换机器学习算法。然而，有一点需要记住的是，最简单的模型通常在预测或探索能力方面取得最佳结果；而复杂的模型往往会导致过拟合。'
- en: For the following example, we would like to perform a sample data exploration
    based on the dataset of passengers surviving the Titanic shipwreck. The steps
    we demonstrate here follow how to collect data from the online source, Kaggle;
    clean data through data munging; perform basic exploratory data analysis to discover
    important attributes that might give a prediction of the survival rate; perform
    advanced exploratory data analysis using the classification algorithm to predict
    the survival rate of the given data; and finally, perform model assessment to
    generate a prediction model.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于以下示例，我们希望基于泰坦尼克号沉船幸存者数据集进行一次样本数据探索。我们在这里展示的步骤包括如何从在线资源Kaggle收集数据，通过数据清洗进行数据整理；执行基本的探索性数据分析以发现可能预测生存率的属性；使用分类算法进行高级探索性数据分析以预测给定数据的生存率；最后，执行模型评估以生成预测模型。
- en: Reading a Titanic dataset from a CSV file
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从CSV文件读取泰坦尼克号数据集
- en: To start the exploration, we need to retrieve a dataset from Kaggle ([https://www.kaggle.com/](https://www.kaggle.com/)).
    We had look at some of the samples in [Chapter 1](part0015_split_000.html#page
    "Chapter 1. Practical Machine Learning with R"), *Practical Machine Learning with
    R*. Here, we introduce methods to deal with real-world problems.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始探索，我们需要从Kaggle([https://www.kaggle.com/](https://www.kaggle.com/))检索一个数据集。我们曾在[第1章](part0015_split_000.html#page
    "第1章. 实践机器学习与R")中查看了一些样本，*实践机器学习与R*。在这里，我们介绍了处理现实世界问题的方法。
- en: Getting ready
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备中
- en: 'To retrieve data from Kaggle, you need to first sign up for a Kaggle account
    ([https://www.kaggle.com/account/register](https://www.kaggle.com/account/register)).
    Then, log in to the account for further exploration:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 要从Kaggle检索数据，您首先需要注册一个Kaggle账户([https://www.kaggle.com/account/register](https://www.kaggle.com/account/register))。然后，登录账户进行进一步探索：
- en: '![Getting ready](img/00030.jpeg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![准备中](img/00030.jpeg)'
- en: Kaggle.com
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: Kaggle.com
- en: How to do it...
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to read the Titanic dataset from the CSV file:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以从CSV文件读取泰坦尼克号数据集：
- en: Go to [http://www.kaggle.com/c/titanic-gettingStarted/data](http://www.kaggle.com/c/titanic-gettingStarted/data)
    to retrieve the data list.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往 [http://www.kaggle.com/c/titanic-gettingStarted/data](http://www.kaggle.com/c/titanic-gettingStarted/data)
    获取数据列表。
- en: 'You can see a list of data files for download, as shown in the following table:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以看到以下表格中列出的数据文件下载列表：
- en: '| Filename | Available formats |'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 文件名 | 可用格式 |'
- en: '| --- | --- |'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `train` | `.csv` (59.76 kb) |'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `train` | `.csv` (59.76 kb) |'
- en: '| `genderclassmodel` | `.py` (4.68 kb) |'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `genderclassmodel` | `.py` (4.68 kb) |'
- en: '| `myfirstforest` | `.csv` (3.18 kb) |'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `myfirstforest` | `.csv` (3.18 kb) |'
- en: '| `myfirstforest` | `.py` (3.83 kb) |'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `myfirstforest` | `.py` (3.83 kb) |'
- en: '| `gendermodel` | `.csv` (3.18 kb) |'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `gendermodel` | `.csv` (3.18 kb) |'
- en: '| `genderclassmodel` | `.csv` (3.18 kb) |'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `genderclassmodel` | `.csv` (3.18 kb) |'
- en: '| `test` | `.csv` (27.96 kb) |'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `test` | `.csv` (27.96 kb) |'
- en: '| `gendermodel` | `.py` (3.58 kb) |'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `gendermodel` | `.py` (3.58 kb) |'
- en: Download the training data ([https://www.kaggle.com/c/titanic-gettingStarted/download/train.csv](https://www.kaggle.com/c/titanic-gettingStarted/download/train.csv))
    to a local disk.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将训练数据 ([https://www.kaggle.com/c/titanic-gettingStarted/download/train.csv](https://www.kaggle.com/c/titanic-gettingStarted/download/train.csv))
    下载到本地磁盘。
- en: 'Then, make sure the downloaded file is placed under the current directory.
    You can use the `getwd` function to check the current working directory. If the
    downloaded file is not located in the working directory, move the file to the
    current working directory. Or, you can use `setwd()` to set the working directory
    to where the downloaded files are located:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，确保下载的文件放置在当前目录下。您可以使用 `getwd` 函数来检查当前工作目录。如果下载的文件不在工作目录中，请将文件移动到当前工作目录。或者，您可以使用
    `setwd()` 将工作目录设置为下载文件所在的目录：
- en: '[PRE0]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, one can use `read.csv` to load data into the data frame. Here, one can
    use the `read.csv` function to read `train.csv` to frame the data with the variable
    names set as `train.data`. However, in order to treat the blank string as `NA`,
    one can specify that `na.strings` equals either `"NA"` or an empty string:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，可以使用 `read.csv` 将数据加载到数据框中。在这里，可以使用 `read.csv` 函数读取 `train.csv` 并将数据框的变量名设置为
    `train.data`。然而，为了将空白字符串视为 `NA`，可以指定 `na.strings` 等于 `"NA"` 或空字符串：
- en: '[PRE1]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Then, check the loaded data with the `str` function:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，使用 `str` 函数检查加载的数据：
- en: '[PRE2]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: How it works...
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: To begin the data exploration, we first downloaded the Titanic dataset from
    Kaggle, a website containing many data competitions and datasets. To load the
    data into the data frame, this recipe demonstrates how to apply the `read.csv`
    function to load the dataset with the `na.strings` argument, for the purpose of
    converting blank strings and `"NA"` to NA values. To see the structure of the
    dataset, we used the `str` function to compactly display `train.data`; you can
    find the dataset contains demographic information and survival labels of the passengers.
    The data collected here is good enough for beginners to practice how to process
    and analyze data.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始数据探索，我们首先从 Kaggle 下载了泰坦尼克号数据集，Kaggle 是一个包含许多数据竞赛和数据集的网站。为了将数据加载到数据框中，本食谱演示了如何使用
    `read.csv` 函数并应用 `na.strings` 参数来加载数据集，目的是将空白字符串和 `"NA"` 转换为 NA 值。为了查看数据集的结构，我们使用了
    `str` 函数来紧凑地显示 `train.data`；您可以看到数据集包含乘客的人口统计信息和生存标签。这里收集的数据对于初学者来说足够练习如何处理和分析数据。
- en: There's more...
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: On Kaggle, much of the data on science is related to competitions, which mostly
    refer to designing a machine learning method to solve real-world problems.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Kaggle 上，大部分科学数据都与竞赛相关，这些竞赛大多涉及设计机器学习方法来解决现实世界问题。
- en: Most competitions on Kaggle are held by either academia or corporate bodies,
    such as Amazon or Facebook. In fact, they create these contests and provide rewards,
    such as bonuses, or job prospects (see [https://www.kaggle.com/competitions](https://www.kaggle.com/competitions)).
    Thus, there are many data scientists who are attracted to registering for a Kaggle
    account to participate in competitions. A beginner in a pilot exploration can
    participate in one of these competitions, which will help them gain experience
    by solving real-world problems with their machine learning skills.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Kaggle 上的大多数竞赛都是由学术界或企业机构举办的，例如亚马逊或 Facebook。实际上，他们创建这些竞赛并提供奖励，如奖金或就业前景（见 [https://www.kaggle.com/competitions](https://www.kaggle.com/competitions)）。因此，许多数据科学家被吸引注册
    Kaggle 账户以参加竞赛。一个在试点探索中的初学者可以参加这些竞赛之一，通过解决现实世界问题并运用他们的机器学习技能来获得经验。
- en: To create a more challenging learning environment as a competitor, a participant
    needs to submit their output answer and will receive the assessment score, so
    that each one can assess their own rank on the leader board.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建一个更具挑战性的学习环境作为竞争对手，参与者需要提交他们的输出答案，并将收到评估分数，这样每个人都可以评估自己在排行榜上的排名。
- en: Converting types on character variables
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在字符变量上转换类型
- en: In R, since nominal, ordinal, interval, and ratio variable are treated differently
    in statistical modeling, we have to convert a nominal variable from a character
    into a factor.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在 R 中，由于名义变量、有序变量、区间变量和比率变量在统计建模中被不同对待，我们必须将名义变量从字符类型转换为因子类型。
- en: Getting ready
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You need to have the previous recipe completed by loading the Titanic training
    data into the R session, with the `read.csv` function and assigning an argument
    of `na.strings` equal to NA and the blank string (""). Then, assign the loaded
    data from `train.csv` into the `train.data` variables.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要通过使用 `read.csv` 函数将泰坦尼克号训练数据加载到 R 会话中，并将 `na.strings` 参数设置为 NA 和空字符串 ("")，然后，将加载的
    `train.csv` 数据分配给 `train.data` 变量。
- en: How to do it...
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to convert the types on character variables:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以转换字符变量的类型：
- en: 'Use the `str` function to print the overview of the Titanic data:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `str` 函数打印泰坦尼克号数据的概览：
- en: '[PRE3]'
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To transform the variable from the `int` numeric type to the `factor` categorical
    type, you can cast `factor`:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将变量从 `int` 数值类型转换为 `factor` 类别类型，你可以使用 `factor` 转换：
- en: '[PRE4]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Print out the variable with the `str` function and again, you can see that
    `Pclass` and `Survived` are now transformed into the factor as follows:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `str` 函数打印变量，再次可以看到 `Pclass` 和 `Survived` 已经转换为以下因子类型：
- en: '[PRE5]'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: How it works...
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Talking about statistics, there are four measurements: nominal, ordinal, interval,
    and ratio. Nominal variables are used to label variables, such as gender and name;
    ordinal variables, and are measures of non-numeric concepts, such as satisfaction
    and happiness. Interval variables shows numeric scales, which tell us not only
    the order but can also show the differences between the values, such as temperatures
    in Celsius. A ratio variable shows the ratio of a magnitude of a continuous quantity
    to a unit magnitude. Ratio variables provide order, differences between the values,
    and a true zero value, such as weight and height. In R, different measurements
    are calculated differently, so you should perform a type conversion before applying
    descriptive or inferential analytics toward the dataset.'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 谈论统计学，有四种度量：名义、有序、区间和比率。名义变量用于标记变量，例如性别和姓名；有序变量用于衡量非数值概念，例如满意度和幸福感。区间变量显示数值尺度，它不仅告诉我们顺序，还可以显示值之间的差异，例如摄氏度温度。比率变量显示连续量的量级与单位量级的比率。比率变量提供顺序、值之间的差异和真正的零值，例如体重和身高。在
    R 中，不同的度量有不同的计算方式，因此在应用描述性或推理性分析之前，你应该先进行类型转换。
- en: In this recipe, we first display the structure of the train data using the `str`
    function. From the structure of data, you can find the attribute name, data type,
    and the first few values contained in each attribute. From the `Survived` and
    `Pclass` attribute, you can see the data type as `int`. As the variable description
    listed in Chart 1 (*Preface*), you can see that `Survived` (0 = No; 1 = Yes) and
    `Pclass` (1 = 1st; 2 = 2nd; 3 = 3rd) are categorical variables. As a result, we
    transform the data from a character to a factor type via the `factor` function.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，我们首先使用 `str` 函数显示训练数据的结构。从数据结构中，您可以找到属性名称、数据类型以及每个属性中包含的前几个值。从 `Survived`
    和 `Pclass` 属性中，您可以看到数据类型为 `int`。正如图表 1（*前言*）中列出的变量描述，您可以看到 `Survived`（0 = 否；1
    = 是）和 `Pclass`（1 = 1 级；2 = 2 级；3 = 3 级）是分类变量。因此，我们通过 `factor` 函数将数据从字符类型转换为因子类型。
- en: There's more...
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Besides factor, there are more type conversion functions. For numeric types,
    there are `is.numeric()` and `as.numeric()`; for character, there are: `is.character()`
    and `as.character()`. For vector, there are: `is.vector()` and `as.vector()`;
    for matrix, there are `is.matrix()` and `as.matrix()`. Finally, for data frame,
    there are: `is.data.frame()` and `as.data.frame()`.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 除了因子之外，还有更多类型转换函数。对于数值类型，有 `is.numeric()` 和 `as.numeric()`；对于字符类型，有：`is.character()`
    和 `as.character()`。对于向量，有：`is.vector()` 和 `as.vector()`；对于矩阵，有 `is.matrix()` 和
    `as.matrix()`。最后，对于数据框，有：`is.data.frame()` 和 `as.data.frame()`。
- en: Detecting missing values
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测缺失值
- en: Missing values reduce the representativeness of the sample, and furthermore,
    might distort inferences about the population. This recipe will focus on detecting
    missing values within the Titanic dataset.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 缺失值会降低样本的代表性，并且还可能扭曲对总体的推断。本食谱将专注于检测泰坦尼克号数据集中的缺失值。
- en: Getting ready
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You need to have completed the previous recipes by the `Pclass` attribute and
    `Survived` to a factor type.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要通过`Pclass`属性和`Survived`因子类型完成之前的食谱。
- en: In R, a missing value is noted with the symbol **NA** (**not available**), and
    an impossible value is **NaN** (**not a number**).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在R中，缺失值用**NA**（**不可用**）符号表示，不可能的值是**NaN**（**不是数字**）。
- en: How to do it...
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to detect the missing value:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来检测缺失值：
- en: 'The `is.na` function is used to denote which index of the attribute contains
    the NA value. Here, we apply it to the `Age` attribute first:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`is.na`函数来表示哪个属性索引包含NA值。在这里，我们首先将其应用于`Age`属性：
- en: '[PRE6]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The `is.na` function indicates the missing value of the `Age` attribute. To
    get a general number of how many missing values there are, you can perform a `sum`
    to calculate this:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`is.na`函数指示`Age`属性的缺失值。要得到一个大致的缺失值数量，您可以执行一个`sum`来计算这个值：'
- en: '[PRE7]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To calculate the percentage of missing values, one method adopted is to count
    the number of missing values against nonmissing values:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了计算缺失值的百分比，采用的一种方法是计算缺失值与非缺失值的数量：
- en: '[PRE8]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To get a percentage of the missing value of the attributes, you can use `sapply`
    to calculate the percentage of all the attributes:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要获取属性缺失值的百分比，您可以使用`sapply`来计算所有属性的百分比：
- en: '[PRE9]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Besides simply viewing the percentage of missing data, one may also use the
    `Amelia` package to visualize the missing values. Here, we use `install.packages`
    and `require` to install `Amelia` and load the package. However, before the installation
    and loading of the `Amelia` package, you are required to install `Rcpp`, beforehand:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 除了简单地查看缺失数据的百分比之外，还可以使用`Amelia`包来可视化缺失值。在这里，我们使用`install.packages`和`require`来安装`Amelia`并加载包。然而，在安装和加载`Amelia`包之前，您需要先安装`Rcpp`：
- en: '[PRE10]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Then, use the `missmap` function to plot the missing value map:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，使用`missmap`函数绘制缺失值地图：
- en: '[PRE11]'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![How to do it...](img/00031.jpeg)'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00031.jpeg)'
- en: Missing map of the Titanic dataset
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 泰坦尼克号数据集的缺失值地图
- en: How it works...
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: In R, a missing value is often noted with the `"NA"` symbol, which stands for
    not available. Most functions (such as `mean` or `sum`) may output NA while encountering
    an NA value in the dataset. Though you can assign an argument such as `na.rm`
    to remove the effect of NA, it is better to impute or remove the missing data
    in the dataset to prevent propagating the effect of the missing value. To find
    out the missing value in the Titanic dataset, we first sum up all the NA values
    and divide them by the number of values within each attribute, Then, we apply
    the calculation to all the attributes with `sapply`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在R中，缺失值通常用`"NA"`符号表示，代表不可用。大多数函数（如`mean`或`sum`）在数据集中遇到NA值时可能会输出NA。尽管您可以分配一个如`na.rm`的参数来消除NA的影响，但最好是在数据集中插补或删除缺失数据，以防止缺失值的影响传播。要找出泰坦尼克号数据集中的缺失值，我们首先将所有NA值加起来，然后除以每个属性中的值数，然后我们使用`sapply`对具有所有属性进行计算。
- en: In addition to this, to display the calculation results using a table, you can
    utilize the `Amelia` package to plot the missing value map of every attribute
    on one chart. The visualization of missing values enables users to get a better
    understanding of the missing percentage within each dataset. From the preceding
    screenshot, you may have observed that the missing value is beige colored, and
    its observed value is dark red. The *x*-axis shows different attribute names,
    and the *y*-axis shows the recorded index. Clearly, most of the cabin shows missing
    data, and it also shows that about 19.87 percent of the data is missing when counting
    the `Age` attribute, and two values are missing in the `Embarked` attribute.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，为了使用表格显示计算结果，您可以使用`Amelia`包在一张图表上绘制每个属性的缺失值地图。缺失值的可视化使用户能够更好地理解每个数据集中的缺失百分比。从前面的屏幕截图，您可能已经观察到缺失值是米色的，其观测值是深红色。*x*轴显示不同的属性名称，*y*轴显示记录的索引。显然，大多数船舱都显示缺失数据，并且它还显示在计算`Age`属性时大约有19.87%的数据是缺失的，`Embarked`属性中缺失两个值。
- en: There's more...
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: To handle the missing values, we introduced `Amelia` to visualize them. Apart
    from typing console commands, you can also use the interactive GUI of `Amelia`
    and `AmeliaView`, which allows users to load datasets, manage options, and run
    `Amelia` from a windowed environment.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理缺失值，我们引入了`Amelia`来可视化它们。除了输入控制台命令外，您还可以使用`Amelia`和`AmeliaView`的交互式GUI，它允许用户从窗口环境中加载数据集、管理选项和运行`Amelia`。
- en: 'To start running `AmeliaView`, simply type `AmeliaView()` in the R Console:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动运行`AmeliaView`，只需在R控制台中输入`AmeliaView()`：
- en: '[PRE12]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![There''s more...](img/00032.jpeg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/00032.jpeg)'
- en: AmeliaView
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: AmeliaView
- en: Imputing missing values
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 缺失值插补
- en: After detecting the number of missing values within each attribute, we have
    to impute the missing values since they might have a significant effect on the
    conclusions that can be drawn from the data.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在检测到每个属性中的缺失值数量后，我们必须插补缺失值，因为它们可能会对从数据中得出的结论产生重大影响。
- en: Getting ready
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: This recipe will require `train.data` loaded in the R session and have the previous
    recipe completed by converting `Pclass` and `Survived` to a factor type.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 此菜谱需要将`train.data`加载到R会话中，并且需要完成之前的菜谱，将`Pclass`和`Survived`转换为因子类型。
- en: How to do it...
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to impute the missing values:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以插补缺失值：
- en: 'First, list the distribution of **Port of Embarkation**. Here, we add the `useNA
    = "always"` argument to show the number of NA values contained within `train.data`:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，列出**登船港口**的分布情况。在这里，我们添加`useNA = "always"`参数以显示`train.data`中包含的NA值的数量：
- en: '[PRE13]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Assign the two missing values to a more probable port (that is, the most counted
    port), which is Southampton in this case:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将两个缺失值赋给一个更可能的港口（即计数最多的港口），在这种情况下是南安普顿：
- en: '[PRE14]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'In order to discover the types of titles contained in the names of `train.data`,
    we first tokenize `train.data$Name` by blank (a regular expression pattern as
    `"\\s+"`), and then count the frequency of occurrence with the `table` function.
    After this, since the name title often ends with a period, we use the regular
    expression to grep the word containing the period. In the end, `sort` the table
    in decreasing order:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了发现`train.data`名称中包含的标题类型，我们首先使用空白（正则表达式模式`"\\s+"`）对`train.data$Name`进行分词，然后使用`table`函数计算出现的频率。在此之后，由于名称标题通常以句点结尾，我们使用正则表达式grep包含句点的单词。最后，按降序`sort`表格：
- en: '[PRE15]'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'To obtain which title contains missing values, you can use `str_match` provided
    by the `stringr` package to get a substring containing a period, then bind the
    column together with `cbind`. Finally, by using the table function to acquire
    the statistics of missing values, you can work on counting each title:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要获取包含缺失值的标题，您可以使用`stringr`包提供的`str_match`函数获取包含句点的子串，然后使用`cbind`函数将列绑定在一起。最后，通过使用表格函数获取缺失值的统计信息，您可以逐个标题进行计数：
- en: '[PRE16]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'For a title containing a missing value, one way to impute data is to assign
    the mean value for each title (not containing a missing value):'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于包含缺失值的标题，一种数据插补的方法是将每个标题（不包含缺失值）的平均值赋值：
- en: '[PRE17]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Then, assign the missing value with the mean value of each title:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，将缺失值赋值为每个标题的平均值：
- en: '[PRE18]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: How it works...
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: To impute the missing value of the `Embarked` attribute, we first produce the
    statistics of the embarked port with the `table` function. The `table` function
    counts two NA values in `train.data`. From the dataset description, we recognize
    C, Q, and S(C = Cherbourg, Q = Queenstown, S = Southampton). Since we do not have
    any knowledge about which category these two missing values are in, one possible
    way is to assign the missing value to the most likely port, which is `Southampton`.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 要插补`Embarked`属性的缺失值，我们首先使用`table`函数生成登船港口的统计信息。`table`函数在`train.data`中计算了两个NA值。从数据集描述中，我们识别出C、Q和S（C
    = Cherbourg，Q = Queenstown，S = Southampton）。由于我们不知道这两个缺失值属于哪个类别，一种可能的方法是将缺失值赋给最可能的港口，即`Southampton`。
- en: As for another attribute, `Age`, though about 20 percent of the value is missing,
    users can still infer the missing value with the title of each passenger. To discover
    how many titles there are within the name of the dataset, we suggest the method
    of counting segmented words in the `Name` attribute, which helps to calculate
    the number of missing values of each given title. The resultant word table shows
    common titles such as `Mr`, `Mrs`, `Miss`, and `Master`. You may reference an
    English honorific entry from Wikipedia to get the description of each title.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 对于另一个属性，`年龄`，尽管大约20%的值是缺失的，但用户仍然可以通过每位乘客的头衔来推断缺失值。为了发现数据集中名称中包含多少个头衔，我们建议使用`Name`属性中分段单词的计数方法，这有助于计算每个给定头衔的缺失值数量。结果词表显示了常见的头衔，如`Mr`、`Mrs`、`Miss`和`Master`。您可以参考维基百科上的英语敬语条目以获取每个头衔的描述。
- en: Considering the missing data, we reassign the mean value of each title to the
    missing value with the corresponding title. However, for the `Cabin` attribute,
    there are too many missing values, and we cannot infer the value from any referencing
    attribute. Therefore, we find it does not work by trying to use this attribute
    for further analysis.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到缺失数据，我们将每个头衔的平均值重新分配给相应的缺失值。然而，对于`船舱`属性，缺失值太多，我们无法从任何引用属性中推断出值。因此，我们通过尝试使用此属性进行进一步分析，发现这种方法不起作用。
- en: There's more...
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'Here we list the honorific entry from Wikipedia for your reference. According
    to it ([http://en.wikipedia.org/wiki/English_honorific](http://en.wikipedia.org/wiki/English_honorific)):'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 这里我们列出维基百科上的敬语条目供您参考。根据它（[http://en.wikipedia.org/wiki/English_honorific](http://en.wikipedia.org/wiki/English_honorific)）：
- en: '**Mr**: This is used for a man, regardless of his marital status'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**先生**：此词用于男性，无论其婚姻状况如何'
- en: '**Master**: This is used for young men or boys, especially used in the UK'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**先生**：用于拥有第一专业学位的美国人士'
- en: '**Miss**: It is usually used for unmarried women, though also used by married
    female entertainers'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**小姐**：通常用于未婚女性，尽管已婚女性表演者也会使用'
- en: '**Mrs**: It is used for married women'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**夫人**：用于已婚女性'
- en: '**Dr**: It is used for a person in the US who owns his first professional degree'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**博士**：用于拥有美国第一专业学位的人士'
- en: Exploring and visualizing data
  id: totrans-136
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索和可视化数据
- en: After imputing the missing values, one should perform an exploratory analysis,
    which involves using a visualization plot and an aggregation method to summarize
    the data characteristics. The result helps the user gain a better understanding
    of the data in use. The following recipe will introduce how to use basic plotting
    techniques with a view to help the user with exploratory analysis.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在填充缺失值之后，应进行探索性分析，这包括使用可视化图表和聚合方法来总结数据特征。结果有助于用户更好地理解所使用的数据。以下食谱将介绍如何使用基本的绘图技术，以帮助用户进行探索性分析。
- en: Getting ready
  id: totrans-138
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: This recipe needs the previous recipe to be completed by imputing the missing
    value in the `age` and `Embarked` attribute.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱需要先前的食谱通过填充`年龄`和`登船`属性中的缺失值来完成。
- en: How to do it...
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to explore and visualize data:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以探索和可视化数据：
- en: 'First, you can use a bar plot and histogram to generate descriptive statistics
    for each attribute, starting with passenger survival:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，您可以使用条形图和直方图为每个属性生成描述性统计，从乘客生存开始：
- en: '[PRE19]'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![How to do it...](img/00033.jpeg)'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00033.jpeg)'
- en: Passenger survival
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客生存
- en: 'We can generate the bar plot of passenger class:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以生成乘客等级的条形图：
- en: '[PRE20]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![How to do it...](img/00034.jpeg)'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00034.jpeg)'
- en: Passenger class
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客等级
- en: 'Next, we outline the gender data with the bar plot:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们使用条形图概述性别数据：
- en: '[PRE21]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![How to do it...](img/00035.jpeg)'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00035.jpeg)'
- en: Passenger gender
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客性别
- en: 'We then plot the histogram of the different ages with the `hist` function:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们使用`hist`函数绘制不同年龄的直方图：
- en: '[PRE22]'
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![How to do it...](img/00036.jpeg)'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00036.jpeg)'
- en: Passenger age
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客年龄
- en: 'We can plot the bar plot of sibling passengers to get the following:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以绘制同辈乘客的条形图以获得以下结果：
- en: '[PRE23]'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![How to do it...](img/00037.jpeg)'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00037.jpeg)'
- en: Passenger siblings
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客同辈
- en: 'Next, we can get the distribution of the passenger parch:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们可以获取乘客口渴度的分布：
- en: '[PRE24]'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![How to do it...](img/00038.jpeg)'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00038.jpeg)'
- en: Passenger parch
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客口渴度
- en: 'Next, we plot the histogram of the passenger fares:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们绘制乘客船票的直方图：
- en: '[PRE25]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '![How to do it...](img/00039.jpeg)'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00039.jpeg)'
- en: Passenger fares
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客船票
- en: 'Finally, one can look at the port of embarkation:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，可以查看登船港口：
- en: '[PRE26]'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![How to do it...](img/00040.jpeg)'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00040.jpeg)'
- en: Port of embarkation
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上船港口
- en: 'Use `barplot` to find out which gender is more likely to perish during shipwrecks:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `barplot` 来找出在沉船事故中哪个性别更容易丧生：
- en: '[PRE27]'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![How to do it...](img/00041.jpeg)'
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00041.jpeg)'
- en: Passenger survival by sex
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 按性别划分的乘客生存率
- en: 'Next, we should examine whether the `Pclass` factor of each passenger may affect
    the survival rate:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们应该检查每个乘客的 `Pclass` 因素是否可能影响生存率：
- en: '[PRE28]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![How to do it...](img/00042.jpeg)'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00042.jpeg)'
- en: Passenger survival by class
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 按舱位划分的乘客生存率
- en: 'Next, we examine the gender composition of each `Pclass`:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们检查每个 `Pclass` 的性别构成：
- en: '[PRE29]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '![How to do it...](img/00043.jpeg)'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00043.jpeg)'
- en: Passenger gender by class
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 按舱位划分的乘客性别
- en: 'Furthermore, we examine the histogram of passenger ages:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，我们检查乘客年龄的直方图：
- en: '[PRE30]'
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![How to do it...](img/00044.jpeg)'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00044.jpeg)'
- en: Passenger age histogram
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 乘客年龄直方图
- en: 'To examine more details about the relationship between the age and survival
    rate, one can use a `boxplot`:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查年龄和生存率之间关系的更多细节，可以使用 `boxplot`：
- en: '[PRE31]'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '![How to do it...](img/00045.jpeg)'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/00045.jpeg)'
- en: Passenger survival by age
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 按年龄划分的乘客生存率
- en: 'To categorize people with different ages into different groups, such as children
    (below 13), youths (13 to 19), adults (20 to 65), and senior citizens (above 65),
    execute the following commands:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将不同年龄的人分类到不同的组中，例如儿童（13岁以下）、青少年（13至19岁）、成年人（20至65岁）和老年人（65岁以上），请执行以下命令：
- en: '[PRE32]'
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: How it works...
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Before we predict the survival rate, one should first use the aggregation and
    visualization method to examine how each attribute affects the fate of the passengers.
    Therefore, we begin the examination by generating a bar plot and histogram of
    each attribute.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测生存率之前，一个人应该首先使用聚合和可视化方法来检查每个属性如何影响乘客的命运。因此，我们开始通过生成每个属性的条形图和直方图来检查。
- en: The plots from the screenshots in the preceding list give one an outline of
    each attribute of the Titanic dataset. As per the first screenshot, more passengers
    perished than survived during the shipwreck. Passengers in the third class made
    up the biggest number out of the three classes on board, which also reflects the
    truth that the third class was the most economical class on the Titanic (step
    2). For the sex distribution, there were more male passengers than female (step
    3). As for the age distribution, the screenshot in step 4 shows that most passengers
    were aged between 20 to 40\. According to the screenshot in step 5, most passengers
    had one or fewer siblings. The screenshot in step 6 shows that most of the passengers
    have 0 to 2 parch.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 前面截图中的图表为泰坦尼克号数据集的每个属性提供了一个概述。根据第一张截图，在沉船事故中丧生的乘客比幸存的乘客多。在船上的三个舱位中，三等舱的乘客人数最多，这也反映了三等舱是泰坦尼克号上最经济的舱位（第2步）。至于性别分布，男性乘客比女性乘客多（第3步）。至于年龄分布，第4步的截图显示，大多数乘客的年龄在20至40岁之间。根据第5步的截图，大多数乘客有一个或一个以下的兄弟姐妹。第6步的截图显示，大多数乘客有0到2个孩子。
- en: In the screenshot in step 7, the fare histogram shows there were fare differences,
    which may be as a result of the different passenger classes on the Titanic. At
    last, the screenshot in step 8 shows that the boat made three stops to pick up
    passengers.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在第7步的截图显示，票价直方图显示了票价差异，这可能是由于泰坦尼克号上不同舱位的乘客造成的。最后，第8步的截图显示，这艘船停了三次来接乘客。
- en: As we began the exploration from the `sex` attribute, and judging by the resulting
    bar plot, it clearly showed that female passengers had a higher rate of survival
    than males during the shipwreck (step 9). In addition to this, the Wikipedia entry
    for RMS Titanic ([http://en.wikipedia.org/wiki/RMS_Titanic](http://en.wikipedia.org/wiki/RMS_Titanic))
    explains that *'A disproportionate number of men were left aboard because of a
    "women and children first" protocol followed by some of the officers loading the
    lifeboats'*. Therefore, it is reasonable that the number of female survivors outnumbered
    the male survivors. In other words, simply using `sex` can predict whether a person
    will survive with a high degree of accuracy.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们从 `sex` 属性开始探索，并且根据产生的条形图，它清楚地显示在沉船事故中女性乘客的生存率高于男性（第9步）。此外，维基百科上关于泰坦尼克号（[http://en.wikipedia.org/wiki/RMS_Titanic](http://en.wikipedia.org/wiki/RMS_Titanic)）的条目解释说，“由于一些官员在装载救生艇时遵循了‘妇女和儿童优先’的协议，因此有不成比例的男性被留在船上”。因此，女性幸存者人数超过男性幸存者人数是合理的。换句话说，仅使用
    `sex` 就可以以高精度预测一个人是否会幸存。
- en: Then, we examined whether the passenger class affected the survival rate (step
    10). Here, from the definition of `Pclass`, the fares for each class were priced
    accordingly with the quality; high fares for first class, and low fares for third
    class. As the class of each passenger seemed to indicate their social and financial
    status, it is fair to assume that the wealthier passengers may have had more chances
    to survive.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们考察了乘客等级是否影响了生存率（步骤10）。在这里，根据`Pclass`的定义，每个等级的票价都相应地与质量定价；一等舱票价高，三等舱票价低。由于每个乘客的等级似乎表明了他们的社会和财务状况，因此可以合理地假设富裕的乘客可能更有机会幸存。
- en: Unfortunately, there was no correlation between the class and survival rate,
    so the result does not show the phenomenon we assumed. Nevertheless, after we
    examined `sex` in the composition of `pclass` (step 11), the results revealed
    that most third-class passengers were male; the assumption of wealthy people tending
    to survive more may not be that concrete.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，等级与生存率之间没有相关性，因此结果并没有显示出我们假设的现象。然而，在我们检查了`pclass`组成中的`sex`（步骤11）之后，结果揭示出大多数三等舱乘客是男性；富裕的人更有可能幸存的假设可能并不那么具体。
- en: Next, we examined the relationship between the age and passenger fate through
    a histogram and box plot (step 12). The bar plot shows the age distribution with
    horizontal columns in which red columns represent the passengers that survived,
    while blue columns represent those who perished. It is hard to tell the differences
    in the survival rate from the ages of different groups. The bar plots that we
    created did not prove that passengers in different age groups were more likely
    to survive. On the other hand, the plots showed that most people on board were
    aged between 20 to 40, but does not show whether this group was more likely to
    survive compared to elderly or young children (step 13). Here, we introduced a
    box plot, which is a standardized plotting technique that displays the distribution
    of data with information, such as minimum, first quartile, median, third quartile,
    maximum, and outliers.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过直方图和箱线图（步骤12）考察了年龄与乘客命运之间的关系。条形图显示了年龄分布，其中水平柱状图表示乘客的年龄，红色柱状图代表幸存者，蓝色柱状图代表遇难者。很难从不同年龄组的年龄中看出生存率的差异。我们创建的条形图并没有证明不同年龄组的乘客更有可能幸存。另一方面，这些图显示船上大多数人的年龄在20至40岁之间，但并没有显示出这个群体与老年人或年幼儿童相比是否更有可能幸存（步骤13）。在这里，我们引入了箱线图，这是一种标准化的绘图技术，可以显示数据的分布，包括最小值、第一四分位数、中位数、第三四分位数、最大值和异常值。
- en: Later, we further examined whether age groups have any relation to passenger
    fates, by categorizing passenger ages into four groups. The statistics show the
    the children group (below 13) was more likely to survive than the youths (13 to
    20), adults (20 to 65), and senior citizens (above 65). The results showed that
    people in the younger age groups were more likely to survive the shipwreck. However,
    we noted that this possibly resulted from the 'women and children first' protocol.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 后来，我们进一步考察了年龄组与乘客命运之间是否存在任何关系，通过将乘客年龄分为四个组别。统计数据显示，儿童组（13岁以下）比青少年（13至20岁）、成年人（20至65岁）和老年人（65岁以上）更有可能幸存。结果显示，年轻年龄组的人更有可能从海难中幸存。然而，我们注意到这可能是由“妇女和儿童优先”的协议导致的。
- en: There's more...
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Apart from using bar plots, histograms, and boxplots to visualize data, one
    can also apply `mosaicplot` in the `vcd` package to examine the relationship between
    multiple categorical variables. For example, when we examine the relationship
    between the `Survived` and `Pclass` variables, the application is performed as
    follows:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用条形图、直方图和箱线图来可视化数据外，还可以在`vcd`包中应用`mosaicplot`来检查多个分类变量之间的关系。例如，当我们检查`Survived`和`Pclass`变量之间的关系时，应用过程如下：
- en: '[PRE33]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '![There''s more...](img/00046.jpeg)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/00046.jpeg)'
- en: Passenger survival by class
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 乘客按等级的生存情况
- en: See also
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For more information about the shipwreck, one can read the history of RMS Titanic
    (please refer to the entry *Sinking of the RMS Titanic* in Wikipedia [http://en.wikipedia.org/wiki/Sinking_of_the_RMS_Titanic](http://en.wikipedia.org/wiki/Sinking_of_the_RMS_Titanic)),
    as some of the protocol practiced at that time may have substantially affected
    the passenger survival rate.
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于海难的更多信息，可以阅读RMS泰坦尼克号的历史（请参阅维基百科中的条目*RMS泰坦尼克号的沉没* [http://en.wikipedia.org/wiki/Sinking_of_the_RMS_Titanic](http://en.wikipedia.org/wiki/Sinking_of_the_RMS_Titanic)），因为当时实施的某些协议可能极大地影响了乘客的生存率。
- en: Predicting passenger survival with a decision tree
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用决策树预测乘客生存情况
- en: The exploratory analysis helps users gain insights into how single or multiple
    variables may affect the survival rate. However, it does not determine what combinations
    may generate a prediction model, so as to predict the passengers' survival. On
    the other hand, machine learning can generate a prediction model from a training
    dataset, so that the user can apply the model to predict the possible labels from
    the given attributes. In this recipe, we will introduce how to use a decision
    tree to predict passenger survival rates from the given variables.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 探索性分析有助于用户了解单个或多个变量可能如何影响生存率。然而，它并不能确定哪些组合可以生成预测模型，以便预测乘客的生存。另一方面，机器学习可以从训练数据集中生成预测模型，从而用户可以将模型应用于预测给定属性的可能的标签。在本菜谱中，我们将介绍如何使用决策树从给定变量中预测乘客的生存率。
- en: Getting ready
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will use the data, `train.data`, that we have already used in our previous
    recipes.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用我们在之前的菜谱中已经使用过的数据，`train.data`。
- en: How to do it...
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to predict the passenger survival with the decision
    tree:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来使用决策树预测乘客的生存情况：
- en: 'First, we construct a data split `split.data` function with three input parameters:
    `data`, `p`, and `s`. The `data` parameter stands for the input dataset, the `p`
    parameter stands for the proportion of generated subset from the input dataset,
    and the `s` parameter stands for the random seed:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们构建一个具有三个输入参数的数据拆分函数`split.data`：`data`参数表示输入数据集，`p`参数表示从输入数据集中生成的子集的比例，`s`参数表示随机种子：
- en: '[PRE34]'
  id: totrans-219
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Then, we split the data, with 70 percent assigned to the training dataset and
    the remaining 30 percent for the testing dataset:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将数据分为训练集和测试集，其中70%分配给训练集，剩余的30%用于测试集：
- en: '[PRE35]'
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'For the condition tree, one has to use the `ctree` function from the party
    package; therefore, we install and load the party package:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于条件树，必须使用`party`包中的`ctree`函数；因此，我们需要安装并加载`party`包：
- en: '[PRE36]'
  id: totrans-223
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'We then use `Survived` as a label to generate the prediction model in use.
    After that, we assign the classification tree model into the `train.ctree` variable:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将`Survived`用作标签来生成正在使用的预测模型。之后，我们将分类树模型分配给`train.ctree`变量：
- en: '[PRE37]'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'We use a `plot` function to plot the tree:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们使用一个`plot`函数来绘制树形图：
- en: '[PRE38]'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '![How to do it...](img/00047.jpeg)'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00047.jpeg)'
- en: Conditional inference tree of the Titanic dataset
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 泰坦尼克号数据集的条件推理树
- en: How it works...
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: This recipe introduces how to use a conditional inference tree, `ctree`, to
    predict passenger survival. While the conditional inference tree is not the only
    method to solve the classification problem, it is an easy method to comprehend
    the decision path to predict passenger survival.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 本菜谱介绍了如何使用条件推理树`ctree`来预测乘客的生存情况。虽然条件推理树不是解决分类问题的唯一方法，但它是一种易于理解预测乘客生存决策路径的方法。
- en: We first split the data into a training and testing set by using our implemented
    function, `split.data`. So, we can then use the training set to generate a prediction
    model and later employ the prediction model on the testing dataset in the recipe
    of the model assessment. Then, we install and load the `party` package, and use
    `ctree` to build a prediction model, with `Survived` as its label. Without considering
    any particular attribute, we put attributes such as `Pclass`, `Sex`, `Age`, `SibSp`,
    `Parch`, `Embarked`, and `Fare` as training attributes, except for `Cabin`, as
    most of this attribute's values are missing.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先使用我们实现的函数`split.data`将数据分为训练集和测试集。这样，我们就可以使用训练集生成预测模型，然后在模型评估的菜谱中使用预测模型对测试集进行预测。然后，我们安装并加载`party`包，并使用`ctree`构建预测模型，其中`Survived`作为其标签。不考虑任何特定属性，我们将`Pclass`、`Sex`、`Age`、`SibSp`、`Parch`、`Embarked`和`Fare`等属性作为训练属性，除了`Cabin`，因为该属性的大部分值都是缺失的。
- en: After constructing the prediction model, we can either print out the decision
    path and node in a text mode, or use a plot function to plot the decision tree.
    From the decision tree, the user can see what combination of variables may be
    helpful in predicting the survival rate. As per the preceding screenshot, users
    can find a combination of `Pclass` and `Sex`, which served as a good decision
    boundary (node 9) to predict the survival rates. This shows female passengers
    who were in first and second class mostly survived the shipwreck. Male passengers,
    those in second and third class and aged over nine, almost all perished during
    the shipwreck. From the tree, one may find that attributes such as `Embarked`
    and `Parch` are missing. This is because the conditional inference tree regards
    these attributes as less important during classification.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 构建预测模型后，我们可以以文本模式打印决策路径和节点，或者使用绘图函数绘制决策树。从决策树中，用户可以看到哪些变量的组合可能有助于预测生存率。根据前面的截图，用户可以找到一个
    `Pclass` 和 `Sex` 的组合，这作为一个好的决策边界（节点 9）来预测生存率。这表明大多数在头等舱和二等舱的女性乘客在船难中幸存。男性乘客，那些在二等舱和三等舱以及年龄超过九岁的乘客，在船难中几乎全部丧生。从树中，人们可能会发现属性如
    `Embarked` 和 `Parch` 是缺失的。这是因为条件推断树在分类过程中将这些属性视为不太重要。
- en: From the decision tree, the user can see what combination of variables may be
    helpful in predicting the survival rate. Furthermore, a conditional inference
    tree is helpful in selecting important attributes during the classification process;
    one can examine the built tree to see whether the selected attribute matches one's
    presumption.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 从决策树中，用户可以看到哪些变量的组合可能有助于预测生存率。此外，条件推断树在分类过程中选择重要属性时很有帮助；用户可以检查构建的树，以查看所选属性是否与假设相符。
- en: There's more...
  id: totrans-235
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: This recipe covers issues relating to classification algorithms and conditional
    inference trees. Since we do not discuss the background knowledge of the adapted
    algorithm, it is better for the user to use the `help` function to view the documents
    related to `ctree` in the `party` package, if necessary.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱涵盖了与分类算法和条件推断树相关的问题。由于我们不讨论适应算法的背景知识，因此用户最好在需要时使用 `help` 函数查看 `party` 包中与
    `ctree` 相关的文档。
- en: There is a similar decision tree based package, named `rpart`. The difference
    between `party` and `rpart` is that `ctree` in the party package avoids the following
    variable selection bias of `rpart` and `ctree` in the `party` package, tending
    to select variables that have many possible splits or many missing values. Unlike
    the others, `ctree` uses a significance testing procedure in order to select variables,
    instead of selecting the variable that maximizes an information measure.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 存在着一个类似的决策树包，名为 `rpart`。`party` 和 `rpart` 之间的区别在于，`party` 包中的 `ctree` 避免了 `rpart`
    和 `party` 包中的 `ctree` 的以下变量选择偏差，倾向于选择具有许多可能分割或许多缺失值的变量。与其他方法不同，`ctree` 使用显著性检验程序来选择变量，而不是选择最大化信息量的变量。
- en: 'Besides `ctree`, one can also use `svm` to generate a prediction model. To
    load the `svm` function, load the `e1071` package first, and then use the `svm`
    build to generate this prediction:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 `ctree` 之外，还可以使用 `svm` 生成预测模型。要加载 `svm` 函数，首先加载 `e1071` 包，然后使用 `svm` 构建生成此预测：
- en: '[PRE39]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Here, we use `svm` to show how easy it is that you can immediately use different
    machine learning algorithms on the same dataset when using R. For further information
    on how to use `svm`, please refer to [Chapter 6](part0072_split_000.html#page
    "Chapter 6. Classification (II) – Neural Network and SVM"), *Classification (II)
    – Neural Network, SVM*.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用 `svm` 来展示当使用 R 时，如何轻松地将不同的机器学习算法立即应用于同一数据集。有关如何使用 `svm` 的更多信息，请参阅[第
    6 章](part0072_split_000.html#page "第 6 章。分类（II）——神经网络和 SVM")，*分类（II）——神经网络，SVM*。
- en: Validating the power of prediction with a confusion matrix
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用混淆矩阵验证预测能力
- en: After constructing the prediction model, it is important to validate how the
    model performs while predicting the labels. In the previous recipe, we built a
    model with `ctree` and pre-split the data into a training and testing set. For
    now, users will learn to validate how well `ctree` performs in a survival prediction
    via the use of a confusion matrix.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 构建预测模型后，验证模型在预测标签时的表现非常重要。在前面的食谱中，我们使用 `ctree` 构建了一个模型，并将数据预先分割为训练集和测试集。现在，用户将学习如何通过使用混淆矩阵来验证
    `ctree` 在生存预测中的表现。
- en: Getting ready
  id: totrans-243
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Before assessing the prediction model, first be sure that the generated training
    set and testing dataset are within the R session.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估预测模型之前，首先确保生成的训练集和测试数据集在R会话中。
- en: How to do it...
  id: totrans-245
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to validate the prediction power:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以验证预测能力：
- en: 'We start using the constructed `train.ctree` model to predict the survival
    of the testing set:'
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们开始使用构建的`train.ctree`模型来预测测试集的生存率：
- en: '[PRE40]'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'First, we install the `caret` package, and then load it:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们安装`caret`包，然后加载它：
- en: '[PRE41]'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'After loading `caret`, one can use a confusion matrix to generate the statistics
    of the output matrix:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在加载`caret`之后，可以使用混淆矩阵生成输出矩阵的统计信息：
- en: '[PRE42]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: How it works...
  id: totrans-253
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: After building the prediction model in the previous recipe, it is important
    to measure the performance of the constructed model. The performance can be assessed
    by whether the prediction result matches the original label contained in the testing
    dataset. The assessment can be done by using the confusion matrix provided by
    the caret package to generate a confusion matrix, which is one method to measure
    the accuracy of predictions.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一个食谱中构建预测模型后，重要的是要衡量所构建模型的性能。性能可以通过预测结果是否与测试数据集中包含的原始标签匹配来评估。评估可以通过使用caret包提供的混淆矩阵来生成混淆矩阵来完成，这是衡量预测准确率的一种方法。
- en: To generate a confusion matrix, a user needs to install and load the `caret`
    package first. The confusion matrix shows that purely using `ctree` can achieve
    accuracy of up to 84 percent. One may generate a better prediction model by tuning
    the attribute used, or by replacing the classification algorithm to SVM, `glm`,
    or random forest.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 要生成混淆矩阵，用户首先需要安装并加载`caret`包。混淆矩阵显示，仅使用`ctree`可以达到高达84%的准确率。可以通过调整使用的属性或替换分类算法为SVM、`glm`或随机森林来生成更好的预测模型。
- en: There's more...
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'A caret package (*Classification and Regression Training*) helps make iterating
    and comparing different predictive models very convenient. The package also contains
    several functions, including:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: '`caret`包（*分类和回归训练*）有助于使迭代和比较不同的预测模型变得非常方便。该包还包含几个函数，包括：'
- en: Data splits
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据拆分
- en: 'Common preprocessing: creating dummy variables, identifying zero- and near-zero-variance
    predictors, finding correlated predictors, centering, scaling, and so on'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 常见的预处理：创建虚拟变量、识别零和接近零方差预测变量、寻找相关预测变量、中心化、缩放等
- en: Training (using cross-validation)
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 训练（使用交叉验证）
- en: Common visualizations (for example, `featurePlot`)
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 常见的可视化（例如，`特征图`）
- en: Assessing performance with the ROC curve
  id: totrans-262
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ROC曲线评估性能
- en: Another measurement is by using the ROC curve (this requires the `ROCR` package),
    which plots a curve according to its true positive rate against its false positive
    rate. This recipe will introduce how we can use the ROC curve to measure the performance
    of the prediction model.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种测量方法是使用ROC曲线（这需要`ROCR`包），它根据其真正率与假正率绘制曲线。本食谱将介绍我们如何使用ROC曲线来衡量预测模型的性能。
- en: Getting ready
  id: totrans-264
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Before applying the ROC curve to assess the prediction model, first be sure
    that the generated training set, testing dataset, and built prediction model,
    `ctree.predict`, are within the R session.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 在将ROC曲线应用于评估预测模型之前，首先确保生成的训练集、测试数据集和构建的预测模型`ctree.predict`都在R会话中。
- en: How to do it...
  id: totrans-266
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to assess prediction performance:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以评估预测性能：
- en: 'Prepare the probability matrix:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备概率矩阵：
- en: '[PRE43]'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Install and load the `ROCR` package:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并加载`ROCR`包：
- en: '[PRE44]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Create an `ROCR` prediction object from probabilities:'
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从概率创建`ROCR`预测对象：
- en: '[PRE45]'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Prepare the ROCR performance object for the ROC curve (`tpr=true positive rate,
    fpr=false positive rate`) and the area under curve (AUC):'
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备ROC曲线（`tpr`为真正率，`fpr`为假正率）和曲线下面积（AUC）的ROCR性能对象：
- en: '[PRE46]'
  id: totrans-275
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Plot the ROC curve, with colorize as `TRUE`, and put `AUC` as the title:'
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制ROC曲线，将颜色设置为`TRUE`，并将`AUC`作为标题：
- en: '[PRE47]'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '![How to do it...](img/00048.jpeg)'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/00048.jpeg)'
- en: ROC of the prediction model
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 预测模型的ROC
- en: How it works...
  id: totrans-280
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Here, we first create the prediction object from the probabilities matrix, and
    then prepare the ROCR performance object for the ROC curve (`tpr=true positive
    rate`, `fpr=false positive rate`) and the AUC. Lastly, we use the plot function
    to draw the ROC curve.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们首先从概率矩阵中创建预测对象，然后准备ROC曲线（`tpr=true positive rate`，`fpr=false positive
    rate`）和AUC的ROCR性能对象。最后，我们使用绘图函数绘制ROC曲线。
- en: 'The result drawn in the preceding screenshot is interpreted in the following
    way: the larger under the curve (a perfect prediction will make AUC equal to 1),
    the better the prediction accuracy of the model. Our model returns a value of
    0.857, which suggests that the simple conditional inference tree model is powerful
    enough to make survival predictions.'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 前一截图中的结果可以这样解释：曲线下方的面积越大（完美的预测将使AUC等于1），模型的预测精度就越好。我们的模型返回的值为0.857，这表明简单的条件推理树模型足够强大，可以做出生存预测。
- en: See also
  id: totrans-283
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考资料也
- en: 'To get more information on the ROCR, you can read the paper *Sing, T.*, *Sander,
    O.*, *Berenwinkel, N.*, and *Lengauer, T.* (2005). *ROCR: visualizing classifier
    performance in R*. *Bioinformatics, 21(20), 3940-3941*.'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '要获取更多关于ROCR的信息，您可以阅读以下论文：*Sing, T.*，*Sander, O.*，*Berenwinkel, N.*，和*Lengauer,
    T.*（2005）。*ROCR: 在R中可视化分类器性能*。《生物信息学》，21(20)，3940-3941。'
