<html><head></head><body>
        <section>

            <header>
                <h1 class="header-title">Introduction to Machine Learning and Predictive Analytics</h1>
            </header>

            <article>
                
<p>As artificial intelligence and big data have become a ubiquitous part of our everyday lives, cloud-based machine learning services are part of a rising billion-dollar industry. Among the several services currently available on the market, Amazon Machine Learning stands out for its simplicity. Amazon Machine Learning was launched in April 2015 with a clear goal of lowering the barrier to predictive analytics by offering a service accessible to companies without the need for highly skilled technical resources.</p>
<p>This introductory chapter is a general presentation of the Amazon Machine Learning service and the types of predictive analytics problems it can solve. The Amazon Machine Learning platform distinguishes itself by its simplicity and straightforwardness. However, simplicity often implies that hard choices have been made. We explain what was sacrificed, why these choices make sense, and how the resulting simplicity can be extended with other services in the rich data-focused AWS ecosystem.</p>
<p>We explore what types of predictive analytics projects the Amazon Machine Learning platform can address and how it uses a simple linear model for regression and classification problems. Before starting a predictive analytics project, it is important to understand what context is appropriate and what constitutes good results. We present the context for successful predictions with <strong>Amazon Machine Learning</strong> (<strong>Amazon ML</strong>).</p>
<p>The reader will understand what sort of problems <span>Amazon ML</span> can address and the assumptions with regard to the underlying data. We show how <span>Amazon ML</span> solves linear regression and classification problems with a simple linear model and why that makes sense. Finally, we present the limitations of the platform.</p>
<p>This chapter addresses the following topics:</p>
<ul>
<li>What is Machine Learning as a Service (MLaaS) and why does it matter?</li>
<li>How <span>Amazon ML</span> successfully leverages linear regression, a simple and powerful model</li>
<li>What is predictive analytics and what types of regression and classification problems can it address?</li>
<li>The necessary conditions the data must verify to obtain reliable predictions</li>
<li>What's missing from the<span> </span><span>Amazon ML</span> service?</li>
</ul>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Introducing Amazon Machine Learning</h1>
            </header>

            <article>
                
<p>In the emerging MLaaS industry,<span> </span><span>Amazon ML</span> stands out on several fronts. Its simplicity, allied to the power of the AWS ecosystem, lowers barriers to entry in machine learning for companies while balancing out performances and costs.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Machine Learning as a Service</h1>
            </header>

            <article>
                
<p>Amazon Machine Learning is an online service by <strong>Amazon Web Services</strong> (<strong>AWS</strong>) that does supervised learning for predictive analytics.</p>
<p>Launched in April 2015 at the AWS summit,<span> </span><span>Amazon ML</span> joins a growing list of cloud-based machine learning services, such as Microsoft Azure, Google prediction, IBM Watson, Prediction IO, BigML, and many others. These online machine learning services form an offer commonly referred to as <strong>Machine Learning as a Service</strong> or <strong>MLaaS</strong> following a similar denomination pattern of other cloud-based services such as <strong>SaaS</strong>, <strong>PaaS,</strong> and <strong>IaaS</strong> respectively for Software, Platform, or Infrastructure as a Service.</p>
<p>Studies show that MLaaS is a potentially big business trend. ABI research, a business intelligence consultancy, estimates machine learning-based data analytics tools and services revenues to hit nearly $20 billion in 2021 as MLaaS services take off as outlined in this business report:<span class="URLPACKT"> <a href="http://iotbusinessnews.com/2016/08/01/39715-machine-learning-iot-enterprises-spikes-advent-machine-learning-service-models/" target="_blank">http://iotbusinessnews.com/2016/08/01/39715-machine-learning-iot-enterprises-spikes-advent-machine-learning-service-models/</a></span></p>
<p><em>Eugenio Pasqua, Research Analyst</em> at <em>ABI Research</em>, said the following:</p>
<div class="packt_quote">"The emergence of the Machine-Learning-as-a-Service (MLaaS) model is good news for the market, as it cuts down the complexity and time required to implement machine learning and thus opens the doors to an increase in its adoption level, especially in the small-to-medium business sector."</div>
<p>The increased accessibility is a direct result of using an API-based infrastructure to build machine-learning models instead of developing applications from scratch. Offering efficient predictive analytics models without the need to code, host, and maintain complex code bases lowers the bar and makes ML available to smaller businesses and institutions.</p>
<p>Amazon ML takes this democratization approach further than the other actors in the field by significantly simplifying the predictive analytics process and its implementation. This simplification revolves around four design decisions that are embedded in the platform:</p>
<ul>
<li>A limited set of tasks: binary classification, multi classification and regression</li>
<li>A single linear algorithm</li>
<li>A limited choice of metrics to assess the quality of the prediction</li>
<li>A simple set of tuning parameters for the underlying predictive algorithm</li>
</ul>
<p>That somewhat constrained environment is simple enough while addressing most predictive analytics problems relevant to business. It can be leveraged across an array of different industries and use cases.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Leveraging full AWS integration</h1>
            </header>

            <article>
                
<p>The AWS data ecosystem of pipelines, storage, environments, and Artificial Intelligence (AI) is also a strong argument in favor of choosing Amazon ML as a business platform for its predictive analytics needs. Although Amazon ML is simple, the service evolves to greater complexity and more powerful features once it is integrated in a larger structure of AWS data related services. </p>
<p>AWS is already a major actor in cloud computing. Here's what an excerpt from <em>The Economist</em>, <em>August  2016 </em>has to say about AWS <span class="URLPACKT">(<a href="http://www.economist.com/news/business/21705849-how-open-source-software-and-cloud-computing-have-set-up-it-industry" target="_blank">http://www.economist.com/news/business/21705849-how-open-source-software-and-cloud-computing-have-set-up-it-industry</a>)</span>:</p>
<div class="packt_quote">AWS shows no sign of slowing its progress towards full dominance of cloud computing's wide skies. It has ten times as much computing capacity as the next 14 cloud providers combined, according to Gartner, a consulting firm. AWS's sales in the past quarter were about three times the size of its closest competitor, Microsoft's Azure.</div>
<p>This gives an edge to Amazon ML, as many companies that are using cloud services are likely to be already using AWS. Adding simple and efficient machine learning tools to the product offering mix anticipates the rise of predictive analytics features as a standard component of web services. Seamless integration with other AWS services is a strong argument in favor of using Amazon ML despite its apparent simplicity.</p>
<p>The following architecture is a case study taken from an AWS <em>January 2016</em> white paper titled <em>Big Data Analytics Options on AWS (</em><span class="URLPACKT"><a href="http://d0.awsstatic.com/whitepapers/Big_Data_Analytics_Options_on_AWS.pdf" target="_blank">http://d0.awsstatic.com/whitepapers/Big_Data_Analytics_Options_on_AWS.pdf</a>),</span> showing a potential AWS architecture for sentiment analysis on social media. It shows how Amazon ML can be part of a more complex architecture of AWS services:</p>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="341" src="assets/image_01_001.png" width="587"/></div>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Comparing performances</h1>
            </header>

            <article>
                
<p>Keeping systems and applications simple is always difficult, but often worth it for the business. Examples abound with overloaded UIs bringing down the user experience, while products with simple, elegant interfaces and minimal features enjoy widespread popularity. The <em>Keep It Simple</em> mantra is even more difficult to adhere to in a context such as predictive analytics where performance is key. This is the challenge Amazon took on with its Amazon ML service.</p>
<p>A typical predictive analytics project is a sequence of complex operations: getting the data, cleaning the data, selecting, optimizing and validating a model and finally making predictions. In the scripting approach, data scientists develop codebases using machine learning libraries such as the Python <strong>scikit-learn</strong> library or <strong>R</strong> packages to handle all these steps from data gathering to predictions in production. As a developer breaks down the necessary steps into modules for maintainability and testability, Amazon ML breaks down a predictive analytics project into different entities: datasource, model, evaluation and predictions. It's the simplicity of each of these steps that makes AWS so powerful to implement successful predictive analytics projects.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Engineering data versus model variety</h1>
            </header>

            <article>
                
<p>Having a large choice of algorithms for your predictions is always a good thing, but at the end of the day, domain knowledge and the ability to extract meaningful features from clean data is often what wins the game.</p>
<p><strong>Kaggle</strong> is a well-known platform for predictive analytics competitions, where the best data scientists across the world compete to make predictions on complex datasets. In these predictive competitions, gaining a few decimals on your prediction score is what makes the difference between earning the prize or being just an extra line on the public leaderboard among thousands of other competitors. One thing Kagglers quickly learn is that choosing and tuning the model is only half the battle. Feature extraction or how to extract relevant predictors from the dataset is often the key to winning the competition.</p>
<p>In real life, when working on business related problems, the quality of the data processing phase and the ability to extract meaningful signal out of raw data is the most important and time consuming part of building an efficient predictive model. It is well know that "<em>data preparation accounts for about 80% of the work of data scientists</em>" <em>(</em><span class="URLPACKT"><a href="http://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/" target="_blank">http://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/</a>)</span>. Model selection and algorithm optimization remains an important part of the work but is often not the deciding factor when implementation is concerned.</p>
<p>A solid and robust implementation that is easy to maintain and connects to your ecosystem seamlessly is often preferred to an overly complex model developed and coded in-house, especially when the scripted model only produces small gains when compared to a service based implementation.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Amazon's expertise and the gradient descent algorithm</h1>
            </header>

            <article>
                
<p>Amazon has been using machine learning for the retail side of its business and has build a serious expertise in predictive analytics. This expertise translates into the choice of algorithm powering the Amazon ML service.</p>
<p>The <strong>Stochastic Gradient Descent</strong> (<strong>SGD</strong>) algorithm is the algorithm powering Amazon ML linear models and is ultimately responsible for the accuracy of the predictions generated by the service. The SGD algorithm is one of the most robust, resilient, and optimized algorithms. It has been used in many diverse environments, from signal processing to deep learning and for a wide variety of problems, since the 1960s with great success. The SGD has also given rise to many highly efficient variants adapted to a wide variety of data contexts. We will come back to this important algorithm in a later chapter; suffice it to say at this point that the SGD algorithm is the Swiss army knife of all possible predictive analytics algorithm.</p>
<p>Several benchmarks and tests of the Amazon ML service can be found across the web (Amazon, Google and Azure: <a href="https://blog.onliquid.com/machine-learning-services-2/" target="_blank">https://blog.onliquid.com/machine-learning-services-2/</a> and Amazon versus <strong>scikit-learn</strong>: <a href="http://lenguyenthedat.com/minimal-data-science-2-avazu/" target="_blank">http://lenguyenthedat.com/minimal-data-science-2-avazu/</a>). Overall results show that the Amazon ML performance is on a par with other MLaaS platforms, but also with scripted solutions based on popular machine learning libraries such as <kbd>scikit-learn</kbd>.</p>
<p>For a given problem in a specific context and with an available dataset and a particular choice of a scoring metric, it is probably possible to code a predictive model using an adequate library and obtain better performances than the ones obtained with Amazon ML. But what Amazon ML offers is stability, absence of coding, and a very solid benchmark record, as well as a seamless integration with the Amazon Web Services ecosystem that already powers a large portion of the Internet.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Pricing</h1>
            </header>

            <article>
                
<p>As with other MLaaS providers and AWS services, Amazon ML only charges for what you consume.</p>
<p>The cost is broken down into the following:</p>
<ul>
<li>An hourly rate for the computing time used to build predictive models</li>
<li>A prediction fee per thousand prediction samples</li>
<li>And in the context of real-time (streaming) predictions, a fee based on the memory allocated upfront for the model</li>
</ul>
<p>The computational time increases as a function of the following:</p>
<ul>
<li>The complexity of the model</li>
<li>The size of the input data</li>
<li>The number of attributes</li>
<li>The number and types of transformations applied</li>
</ul>
<p>At the time of writing, these charges are as follows:</p>
<ul>
<li>$0.42 per hour for data analysis and model building fees</li>
<li>$0.10 per 1,000 predictions for batch predictions</li>
<li>$0.0001 per prediction for real-time predictions</li>
<li>$0.001 per hour for each 10 MB of memory provisioned for your model</li>
</ul>
<p>These prices do not include fees related to the data storage (S3, Redshift, or RDS), which are charged separately. </p>
<p>During the creation of your model, Amazon ML gives you a cost estimation based on the data source that has been selected.</p>
<p>The Amazon ML service is not part of the AWS free tier, a 12-month offer applicable to certain AWS services for free under certain conditions.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Understanding predictive analytics</h1>
            </header>

            <article>
                
<p>Data Science, predictive analytics, machine learning -- these terms are used in many ways and sometimes overlap each other. What they actually refer to is not always obvious.</p>
<p>Data science is one of the most popular technical domains whose trend erupted after the publication of the often cited <em>Harvard Business Review</em> article of October 2012, <em>Data Scientist: The Sexiest Job of the 21st Century</em><span class="URLPACKT"> (<a href="https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century" target="_blank">https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century</a>)</span>. Data science can be seen as an evolution from data mining and data analytics. Data mining is about exploring data to discover patterns that potentially lead to decisions and actions at the business level. Data science englobes data analytics and regroups a wider scope of domains, such as statistics, data visualization, predictive analytics, software engineering, and so on, under one very large umbrella.</p>
<p>Predictive analytics is the art of predicting future events based on past observations. It requires your data to be organized in a certain way with predictor variables and outcomes well identified. As the Danish politician <em>Karl Kristian Steincke</em> once said, "<em>Making predictions is difficult especially about the future.</em>" (This quote has also been attributed to Niels Bohr, Yogi Berra and others by <span class="URLPACKT"><a href="http://quoteinvestigator.com/2013/10/20/no-predict/" target="_blank">http://quoteinvestigator.com/2013/10/20/no-predict/</a>).</span> Predictive analytics applications are diverse and far ranging: predicting consumer behavior, natural events (weather, earthquakes, and so on), people's behavior or health, financial markets, industrial applications, and so on. Predictive analytics relies on supervised learning, where data and labels are given to train the model.</p>
<p>Machine learning comprises the tools, methods, and concepts for computers to optimize models used for predictive analytics or other goals.</p>
<p>Machine learning's scope is much larger than predictive analytics. Three different types of machine learning are usually considered:</p>
<ul>
<li><strong>Supervised learning:</strong> Assumes that a certain amount of training data with known outcomes is available and can be used to train the model. Predictive analytics is part of supervised learning.</li>
<li><strong>Unsupervised learning:</strong> Is about finding patterns in existing data without knowing the outcome. Clustering customer behavior or reducing the dimensions of the dataset for visualization purposes are examples of unsupervised learning.</li>
<li><strong>Reinforcement learning:</strong> Is the third type of machine learning, where agents learn to act on their own when given a set of rules and a specific reward schema. Examples of reinforcement learning applications include <strong>AlphaGo</strong>, Google's world championship Go algorithm, self-driving cars, and semi-autonomous robots. AlphaGo learned from thousands of past games and was able to beat the world Go champion in March 2016 (<span class="URLPACKT"><a href="https://www.wired.com/2016/03/go-grandmaster-lee-sedol-grabs-consolation-win-googles-ai/" target="_blank">https://www.wired.com/2016/03/go-grandmaster-lee-sedol-grabs-consolation-win-googles-ai/</a>).</span> A classic reinforcement learning implementation follows this schema, where an agent adapts its actions on an environment based on the resulting rewards:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="140" src="assets/B05028_01_04a.png" width="306"/></div>
<p>The difference between supervised and unsupervised learning in the context of binary classification and clustering is illustrated in the following two figures:</p>
<ul>
<li>For <strong>supervised learning</strong>, the original dataset is composed of two classes (squares and circles), and we know from the start to which class each sample belongs. Giving that information to a binary classification algorithm allows for a somewhat optimized separation of the two classes. Once that separating frontier is known, the model (the line) can be used to predict the class of new samples depending on which side the sample ends up being:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="267" src="assets/image_01_002.png" width="463"/></div>
<ul>
<li>In <strong>unsupervised learning</strong>, the different classes are not known. There is no ground truth. The data is given to an algorithm along with some parameters, such as the number of classes to be found, and the algorithm finds the best set of clusters in the original dataset according to a defined criteria or metric. The results may be very dependent on the initialization parameters. There is no truth, no accuracy, just an interpretation of the data. The following figure shows the results obtained by a clustering algorithm asked to find three classes in the original data:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="273" src="assets/image_01_003.png" width="472"/></div>
<p>The reader will notice at this point that the book is titled Amazon Machine Learning and not Amazon Predictive Analytics. This is a bit misleading, as machine learning covers many applications and problems besides predictive analytics. However, calling the service machine learning leaves the door open for Amazon to roll out future services that are not focused on predictive analytics. The following figure maps out the relationships between data science terms:</p>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="297" src="assets/image_01_004.png" width="401"/></div>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Building the simplest predictive analytics algorithm</h1>
            </header>

            <article>
                
<p>Predictive analytics can be very simple. We introduce a very simple example of a predictive model in the context of binary classification based on a simple threshold.</p>
<p>Imagine that a truck transporting small oranges and large grapefruits runs off the road; all the boxes of fruits open up, and all the fruits end up mixed together. Equipped with a simple weighing scale and a way to roll the fruits out of the truck, you want to be able to separate them automatically based on their weights. You have some information on the average weights of small oranges (96g) and large grapefruits (166g).</p>
<div class="packt_infobox">According to the USDA, the average weight of a medium-sized orange is 131 grams, while a larger orange weighs approximately 184 grams, and a smaller one around 96 grams. </div>
<ul>
<li>Large grapefruit (approx 4-1/2'' dia) 166g</li>
<li>Medium grapefruit (approx 4'' dia) 128g</li>
<li>Small grapefruit (approx 3-1/2'' dia) 100g</li>
</ul>
<p>Your predictive model is the following:</p>
<ul>
<li>You arbitrarily set a threshold of 130g</li>
<li>You weigh each fruit</li>
<li>If the fruit weighs more than 130g, it's a grapefruit; otherwise it's an orange</li>
</ul>
<p>There! You have a robust reliable, predictive model that can be applied to all your mixed up fruits to separate them. Note that in this case, you've set the threshold with an educated guess. There was no machine learning involved.</p>
<p>In machine learning, the models learn by themselves. Instead of setting the threshold yourself, you let your program evolve and calculate the weight separation threshold of fruits by itself.</p>
<p>For that, you would set aside a certain number of oranges and grapefruits. This is called the training dataset. It's important that this training dataset has roughly the same number of oranges and grapefruits.</p>
<p>And you let the machine decide the threshold value by itself. A possible algorithm could be along these lines:</p>
<ol>
<li>Set original weight estimation at <kbd>w_0 = 100g</kbd> to initialize and a counter <kbd>k = 0</kbd></li>
<li>For each new fruit in the training dataset, adjust the weight estimation according to the following:</li>
</ol>
<pre>
        For each new fruit_weight:<br/>            w(k+1) = (k*w(k) + fruit_weight)/ (k+1)<br/>            k = k+1
</pre>
<p class="CDPAlignLeft CDPAlign">Assuming that your training dataset is representative of all the remaining fruits and that you have enough fruits, the threshold would converge under certain conditions to the best average between all the fruit weights. A value which you use to separate all the other fruits depending on whether they weight more or less than the threshold you estimated. The following plot shows the convergence of this crude algorithm to estimate the average weight of the fruits:</p>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="401" src="assets/B05028_01_30.png" width="401"/></div>
<p>This problem is a typical binary classification model. If we had not two but three types of fruits (lemons, oranges, and grapefruit), we would have a multiclass classification problem.</p>
<p>In this example, we only have one predictor: the weight of the fruit. We could add another predictor such as the diameter. This would result in what is called a multivariate classification problem.</p>
<p>In practice, machine learning uses more complex algorithms such as the SGD, the linear algorithm used by Amazon ML. Other classic prediction algorithms include Support Vector Machines, Bayes classifiers, Random forests and so on. Each algorithm has its strength and set of assumptions on the dataset.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Regression versus classification</h1>
            </header>

            <article>
                
<p>Amazon ML does two types of predictive analytics: classification and <strong>regression</strong>.</p>
<p>As discussed in the preceding paragraph, classification is about predicting a finite set of labels or categories for a given set of samples.</p>
<ul>
<li>In the case of two classes, the problem is called Binary classification</li>
<li>When there are more than two classes and the classes are mutually exclusive, the problem is a multiclass classification problem</li>
<li>If the samples can belong to several classes at once, we talk about a multilabel classification problem</li>
</ul>
<p>In short, classification is the prediction of a finite set of classes, labels, categories.</p>
<ul>
<li>Examples of Binary classification are: buying outcome (yes/no), survival outcome (yes/no), anomaly detection (spam, bots), and so on</li>
<li>Examples of multiclass classification are: classifying object in images (fruits, cars, and so on), identifying a music genre, or a movement based on smartphone sensors, document classification and so on</li>
</ul>
<p>In regression problems, the outcome has continuous values. Predicting age, weight, stock prices, salaries, rainfall, temperature, and so forth are all regression problems. We talk about multiple regression when there are several predictors and multivariate regression when the predictions predict several values for each sample. Amazon ML does univariate regression and classification, both binary and multiclass, but not multilabel.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Expanding regression to classification with logistic regression</h1>
            </header>

            <article>
                
<p>Amazon ML uses a linear regression model for regression, binary, and multiclass predictions. Using the <strong>logistic regression</strong> model extends continuous regression to classification problems.</p>
<p>A simple regression model with one predictor is modeled as follows:</p>
<div class="CDPAlignLeft CDPAlign"><img height="25" src="assets/B05028_01_01_eq.png" width="98"/></div>
<p>Here, <em>x</em> is the predictor, <em>y</em> is the outcome, and (a, b) are the model parameters. Each predicted value <em>y</em> is continuous and not bounded. How can we use that model to predict classes which are by definition categorical values?</p>
<p>Take the example of binary predictions. The method is to transform the continuous predictions that are not bounded into probabilities, which are all between 0 and 1. We then associate these probabilities to one of the two classes using a predefined threshold. This model is called the <strong>logistic regression</strong> model–misleading name as logistic regression is a classification model and not a regression one.</p>
<p>To transform continuous not bounded values into probabilities, we use the <kbd>sigmoid</kbd> function defined as follows:</p>
<div class="CDPAlignLeft CDPAlign"><img height="39" src="assets/B05028_01_05_eq.png" width="120"/></div>
<p>This function transforms any real number into a value within the <em>[0,1]</em> interval. Its output can, therefore, be interpreted as a probability:</p>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="205" src="assets/B05028_01_06-1.png" width="303"/></div>
<p>In conclusion, the way to do binary classification with a regression model is as follows:</p>
<ol>
<li>Build the regression model, and estimate the real valued outcomes <em>y</em>.</li>
<li>Use the predicted value <em>y</em> as the argument of the <kbd>sigmoid</kbd> function. The result <em>f(y)</em> is a probability measure of belonging to one of the two classes.</li>
<li>Set a threshold <em>T</em> in [0,1]. All predicted samples with a probability <em>f(y) &gt; T</em> belong to one class, others belong to the other class. The default value for <em>T = 0.5</em>.</li>
</ol>
<p>Logistic regression is, by nature, a Binary classifier. There are several strategies to transform a binary classifier into a multi class classifier.</p>
<p>The <strong>one versus all (OvA)</strong> technique consists in selecting one class as positive and all the others as negative to go back to a binary classification problem. Once the classification on the first class is carried out, a second class is selected as the positive versus all the others as negative. This process is repeated N-1 times when there are N classes to predict. The following set of plots shows:</p>
<ul>
<li>The original datasets and the classes for all the samples</li>
<li>The result of the first Binary classification (circles versus all the others)</li>
<li>The result of the second classification that separates the squares and the triangles</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="180" src="assets/B05028_01_11.png" width="540"/></div>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Extracting features to predict outcomes</h1>
            </header>

            <article>
                
<p>That available data needs to be accessible and meaningful in order for the algorithm to extract information.</p>
<p>Let's consider a simple example. Imagine that we want to predict the market price of a house in a given city. We can think of many variables that would be predictors of the price of a house: the number of rooms or bathrooms, the neighborhood, the surface, the heating system, and so on. These variables are called features, attributes, or predictors. The value that we want to predict is called the outcome or the target.</p>
<p>If we want our predictions to be reliable, we need several features. Predicting the price of a house based on its surface alone would not be very efficient. Many other factors influence the price of a house and our dataset should include as many as possible (with conditions).</p>
<p>It's often possible to add large numbers of attributes to a model to try to improve the predictions. For instance, in our housing pricing prediction, we could add all the characteristics of the house (bathroom, superficies, heating system, the number of windows). Some of these variables would bring more information to our pricing model and increase the accuracy of our predictions, while others would just add noise and confuse the algorithm. Adding new variables to a predicting model does not always improve the predictions.</p>
<p>In order to make reliable predictions, each of the new features you bring to your model must bring some valuable piece of information. However, this is also not always the case. As we will see in <a href="8ec21c70-b7f9-4bb2-bbfd-df8337db86a2.xhtml" target="_blank"><span class="ChapterrefPACKT">Chapter 2</span></a>, <em>Machine Learning Definitions and Concepts</em>, correlated predictors can hurt the performances of the model.</p>
<p>Predictive analytics is built on several assumptions and conditions:</p>
<ul>
<li>The value you are trying to predict is predictable and not just some random noise.</li>
<li>You have access to data that has some degree of association to the target.</li>
<li>The available dataset is large enough. Reliable predictions cannot be inferred from a dataset that is too small. (For instance, you can define and therefore predict a line with two points but you cannot infer data that follows a sine curve from only two points.)</li>
<li>The new data you will base future predictions on is similar to the one you parameterized and trained your model on.</li>
</ul>
<p>You may have a great dataset, but that does not mean it will be efficient for predictions.</p>
<p>These conditions on the data are very general. In the case of SGD, the conditions are more constrained.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Diving further into linear modeling for prediction</h1>
            </header>

            <article>
                
<p>Amazon ML is based on linear modeling. Recall the equation for a straight line in the plan:</p>
<p><img height="24" src="assets/B05028_01_01_eq.png" width="93"/></p>
<p>This linear equation with coefficients (<em>a, b</em>) can be interpreted as a predictive linear model with <em>x</em> as the predictor and <em>y</em> as the outcome. In this simple case, we have two parameters (<em>a, b</em>) and one predictor <em>x</em>. An example can be that of predicting the height of children with respect to their weight and find some a and b such that the following equation is true:</p>
<div class="CDPAlignLeft CDPAlign"><img height="24" src="assets/B05028_01_10_eq.png" width="181"/></div>
<p>Let's consider the classic <em>Lewis Taylor (1967)</em> dataset with 237 samples of children's age, weight, height, and gender (<span class="URLPACKT"><a href="https://v8doc.sas.com/sashtml/stat/chap55/sect51.htm" target="_blank">https://v8doc.sas.com/sashtml/stat/chap55/sect51.htm</a>) and focus on the relation between the height and weight of the children. </span>In this dataset, the optimal regression line follows the following equation:</p>
<div class="CDPAlignLeft CDPAlign"><img height="22" src="assets/B05028_01_11_eq.png" width="204"/></div>
<p>The following figure illustrates the height versus weight dataset and the associated linear regression:</p>
<div class="CDPAlignCenter CDPAlign"><img class=" image-border" height="354" src="assets/B05028_01_14.png" width="354"/></div>
<p>Consider now that we have not one predictor but several, and let's generalize the preceding linear equation to N predictors denoted by <em>{x<sub>1</sub>, . . . , x<sub>n</sub>}</em> and <em>N +1</em> coefficients or <em>{w<sub>o</sub>, w<sub>1</sub>, . . ., w<sub>n</sub>}</em> weights. The linear model can be written as follows:</p>
<div class="CDPAlignLeft CDPAlign"><img height="35" src="assets/B05028_01_14_eq.png" width="164"/></div>
<p>Here, <em>ŷ</em> denotes the predicted value, (<em>y</em> would correspond to the true value to be predicted). To simplify notations, we will assume for the rest of the book the coefficient <em>w<sub>o</sub> = 0</em>.</p>
<p>This equation can be rewritten in vector form as follows:</p>
<p><img height="17" src="assets/B05028_01_21.png" width="69"/></p>
<p>Where <em>T</em> is the transpose operator, X = <em>{x<sub>1</sub>, . . ., x<sub>n</sub>}</em> and  W= {<em>w<sub>1</sub>, . . .,w<sub>n</sub></em>} are the respective vectors of predictors and model weights. Under certain conditions, the coefficients <em>w<sub>i</sub></em> can be calculated precisely. However, for a large number of samples <em>N</em>, these calculations are expensive in terms of required computations as they involve inverting matrices of dimension <em>N</em>, which for large datasets is costly and slow. As the number of samples grows, it becomes more efficient to estimate these model coefficients via an iterative process.</p>
<p>The Stochastic Gradient Descent algorithm iteratively estimates the coefficients <em>{w<sub>o</sub>, w<sub>1</sub>, . . ., w<sub>n</sub>}</em> of the model. At each iteration, it uses a random sample of the training dataset for which the real outcome value is known. The SGD algorithm works by minimizing a function of the prediction error:</p>
<div class="CDPAlignLeft CDPAlign"><img height="28" src="assets/B05028_01_21_eq.png" width="200"/></div>
<p>Functions that take the prediction error as argument are also called <strong>loss functions</strong>. Different loss functions result in different algorithms. A convex loss function has a unique minimum, which corresponds to the optimal set of weights for the regression problem. We will come back to the SGD algorithm in details in later chapters<em>.</em> Suffice to say for now that the SGD algorithm is especially well-suited to deal with large datasets.</p>
<p>There are many reasons to justify selecting the SGD algorithm for general purpose predictive analysis problems:</p>
<ul>
<li>It is robust</li>
<li>Its convergence properties have been extensively studied and are well known</li>
<li>It is well adapted to optimization techniques</li>
<li>It has many extensions and variants</li>
<li>It has low computational cost</li>
<li>It can be applied to regression, classification, and streaming data</li>
</ul>
<p>Some weaknesses include the following:</p>
<ul>
<li>The need to properly initialize its parameters</li>
<li>A convergence rate dependent on a parameter called the learning rate</li>
</ul>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Validating the dataset</h1>
            </header>

            <article>
                
<p>Not all datasets lend themselves to linear modeling. There are several conditions that the samples must verify for your linear model to make sense. Some conditions are strict, others can be relaxed.</p>
<p>In general, linear modeling assumes the following conditions (<span class="URLPACKT"><a href="http://www.statisticssolutions.com/assumptions-of-multiple-linear-regression/" target="_blank">http://www.statisticssolutions.com/assumptions-of-multiple-linear-regression/</a>):</span></p>
<ul>
<li><strong>Normalization/standardization</strong>: Linear regression can be sensitive to predictors that exhibit very different scales. This is true for all loss functions that rely on a measure of the distance between samples or on the standard deviations of samples. Predictors with higher means and standard deviations have more impact on the model and may potentially overshadow predictors with better predictive power but more constrained range of values. Standardization of predictors puts all the predictors on the same level.</li>
<li><strong>Independent and identically distributed (i.i.d.)</strong>:<strong> </strong>The samples are assumed to be independent from each other and to follow a similar distribution. This property is often assumed even when the samples are not that independent from each other. In the case of time series where samples depend on previous values, using the sample to sample difference as the data is often enough to satisfy the independence assumption. As we will see in <span class="ChapterrefPACKT"><a href="8ec21c70-b7f9-4bb2-bbfd-df8337db86a2.xhtml" target="_blank">Chapter 2</a></span>, <em>Machine Learning Definitions and Concepts,</em> confounders and noise will also negatively impact linear regression.</li>
<li><strong>No multicollinearity</strong>:<strong> </strong>Linear regression assumes that there is little or no multicollinearity in the data, meaning that one predictor is not a linear composition of other predictors. Predictors that can be approximated by linear combinations of other predictors will confuse the model.</li>
<li><strong>Heteroskedasticity</strong>: The standard deviation of a predictor is constant across the whole range of its values.</li>
<li><strong>Gaussian distribution of the residuals</strong>: This is more than a posteriori validation that the linear regression is valid. The residuals are the differences between the true values and their linear estimation. The linear regression is considered relevant if these residuals follow a Gaussian distribution.</li>
</ul>
<p>These assumptions are rarely perfectly met in real-life datasets. As we will see in <span class="ChapterrefPACKT"><a href="8ec21c70-b7f9-4bb2-bbfd-df8337db86a2.xhtml" target="_blank">Chapter 2</a></span><span>,</span> <em>Machine Learning Definitions and Concepts</em>, there are techniques to detect when the linear modeling assumptions are not respected, and subsequently to transform the data to get closer to the ideal linear regression context.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Missing from Amazon ML</h1>
            </header>

            <article>
                
<p>Amazon ML offers supervised learning predictions for classification (binary and multiclass) and regression problems. It offers some very basic visualization of the original data and has a preset list of data transformations, such as binning or normalizing the data. It is efficient and simple. However, several functionalities that are important to the data scientist are unfortunately missing from the platform. Lacking these features may not be a deal breaker, but it nonetheless restricts the scope of problems Amazon ML can be applied to.</p>
<p>Some of the common machine learning features Amazon ML does not offer are as follows:</p>
<ul>
<li><strong>Unsupervised learning</strong>: It is not possible to do clustering or dimensionality reduction of your data.</li>
<li><strong>A choice of models beside linear models</strong>: Non-linear Support Vector Machines, any type of Bayes classification, neural networks, and tree, based algorithms (decision trees, random forests, or boosted trees) are all absent models. All predictions, all experiments will be built on linear regression and logistic regression with the SGD.</li>
<li>Data visualization capabilities are reduced to histograms and density plots.</li>
<li><strong>A choice of metrics</strong>: Amazon ML uses F1-score and ROC-AUC metrics for classification, and MSE for regression. It is not possible to assess the model performance with any other metric.</li>
<li>You cannot download your trained model and use it anywhere else than Amazon ML.</li>
</ul>
<p>Finally, although it is not possible to directly use your own scripts (R, Python, Scala, and so on) within the Amazon ML platform, it is possible and recommended to use other AWS services, such as AWS Lambda, to preprocess the datasets. Data manipulation beyond the transformations available in Amazon ML can also be carried out with SQL if your data is stored in one of the AWS SQL enabled services (Athena, RDS, Redshift, and others).</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">The statistical approach versus the machine learning approach</h1>
            </header>

            <article>
                
<p>In 2001, <em>Leo Breiman</em> published a paper titled <em>Statistical Modeling: The Two Cultures (</em><span class="URLPACKT"><a href="http://projecteuclid.org/euclid.ss/1009213726" target="_blank">http://projecteuclid.org/euclid.ss/1009213726</a>)</span> that underlined the differences between the statistical approach focused on validation and explanation of the underlying process in the data and the machine learning approach, which is more concerned with the results.</p>
<p>Roughly put, a classic statistical analysis follows steps such as the following:</p>
<ol>
<li>A hypothesis called the null hypothesis is stated. This null hypothesis usually states that the observation is due to randomness.</li>
<li>The probability (or p-value) of the event under the null hypothesis is then calculated.</li>
<li>If that probability is below a certain threshold (usually p &lt; 0.05), then the null hypothesis is rejected, which means that the observation is not a random fluke.</li>
</ol>
<div class="packt_infobox"><kbd>p&gt; 0.05</kbd> does not imply that the null hypothesis is true. It only means that you cannot reject it, as the probability of the observation happening by chance is not large enough.</div>
<p>This methodology is geared toward explaining and discovering the influencing factors of the phenomenon. The goal here is to establish/build a somewhat static and fully known model that will fit observations as well as possible and, therefore, will be able to predict future patterns, behaviors, and observations.</p>
<p>In the machine learning approach, in predictive analytics, an explicit representation of the model is not the focus. The goal is to build the best model for the prediction period, and the model builds itself from the observations. The internals of the models are not explicit. This <span>machine learning approach is</span> called a black box model.</p>
<p>By removing the need for explicit modeling of the data, the ML approach has a stronger potential for predictions. ML is focused on making the most accurate predictions possible by minimizing the prediction error of a model at the expense of explainability. </p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Summary</h1>
            </header>

            <article>
                
<p>In this introductory chapter, we presented the techniques used by the Amazon ML service. Although Amazon ML offers fewer features than other machine learning workflows, Amazon ML is built on a solid ground, with a simple yet very efficient algorithm driving its predictions.</p>
<p>Amazon ML does not offer to solve any type of automated learning problems and will not be adequate in some contexts and some datasets. However, its simple approach and design will be sufficient for many predictive analytics projects, on the condition that the initial dataset is properly preprocessed and contains relevant signals on which predictions can be made.</p>
<p>In <a href="8ec21c70-b7f9-4bb2-bbfd-df8337db86a2.xhtml" target="_blank"><span class="ChapterrefPACKT">Chapter 2</span></a>, <em>Machine Learning Definitions and Concepts</em>, we will dive further into techniques and concepts used in predictive analytics.</p>
<p>More precisely, we will present the most common techniques used to improve the quality of raw data; we will spot and correct common anomalies within a dataset; we will learn how to train and validate a predictive model and how to improve the predictions when faced with poor predictive performance.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    </body></html>