["```py\nCreate schema chapter11_byom;\n```", "```py\n#provide your s3 bucket here\nS3_BUCKET='Redshift ML s3 bucket name'\n#provide the model path, this is coming from the model_data parameter\nMODEL_PATH=model_data\n#Provide Redshift cluster attached role ARN\nREDSHIFT_IAM_ROLE = 'Redshift Cluster IAM Role'\n```", "```py\nsql_text=(\"drop model if exists predict_abalone_age; \\\n CREATE MODEL chapter11_byom.predict_abalone_age \\\nFROM '{}' \\\nFUNCTION predict_abalone_age ( int, int, float, float,float,float,float,float,float) \\\nRETURNS int \\\nIAM_ROLE '{}' \\\nsettings( S3_BUCKET '{}') \\\n\")\nprint (sql_text.format(model_data,REDSHIFT_IAM_ROLE, S3_BUCKET))\n```", "```py\nCREATE MODEL chapter11_byom.predict_abalone_age\nFROM 's3://redshift-ml-22-redshiftmlbucket-1cckvqgktpfe0/sagemaker/DEMO-xgboost-abalone-default/single-xgboost/DEMO-xgboost-regression-2022-12-31-01-45-30/output/model.tar.gz'\nFUNCTION predict_abalone_age ( int, int, float, float,float,float,float,float,float) RETURNS int IAM_ROLE 'arn:aws:iam::215830312345:role/spectrumrs'\nsettings( S3_BUCKET 'redshift-ml-22-redshiftmlbucket-1cckvqgktpfe0') ;\n```", "```py\nshow model chapter11_byom.predict_abalone_age;\n```", "```py\ndrop table if exists chapter11_byom.abalone_test;\ncreate table chapter11_byom.abalone_test\n(Rings int, sex int,Length_ float, Diameter float, Height float, WholeWeight float, ShuckedWeight float,VisceraWeight float, ShellWeight float );\ncopy chapter11_byom.abalone_test\nfrom 's3://jumpstart-cache-prod-us-east-1/1p-notebooks-datasets/abalone/text-csv/test/'\nIAM_ROLE 'arn:aws:iam::212330312345:role/spectrumrs'\ncsv ;\n```", "```py\nselect * from chapter11_byom.abalone_test limit 10;\n```", "```py\nSelect original_age, predicted_age, original_age-predicted_age as Error\nFrom(\nselect predict_abalone_age(Rings,sex,\nLength_ ,\nDiameter ,\nHeight ,\nWholeWeight ,\nShuckedWeight ,\nVisceraWeight ,\nShellWeight ) predicted_age, rings as original_age\nfrom chapter11_byom.abalone_test ) a;\n```", "```py\nREDSHIFT_IAM_ROLE = 'arn:aws:iam::215830312345:role/spectrumrs'\nSAGEMAKER_ENDPOINT = rcf_inference.endpoint\n```", "```py\nsql_text=(\"drop model if exists chapter11_byom.remote_random_cut_forest;\\\nCREATE MODEL chapter11_byom.remote_random_cut_forest\\\n FUNCTION remote_fn_rcf (int)\\\n RETURNS decimal(10,6)\\\n SAGEMAKER'{}'\\\n IAM_ROLE'{}'\\\n\")\nprint(sql_text.format(SAGEMAKER_ENDPOINT,REDSHIFT_IAM_ROLE))\n```", "```py\nCREATE MODEL chapter11_byom.remote_random_cut_forest\nFUNCTION remote_fn_rcf (int) RETURNS decimal(10,6)\nSAGEMAKER'randomcutforest-2022-12-31-03-48-13-259'\nIAM_ROLE'arn:aws:iam:: 215830312345:role/spectrumrs'\n;\n```", "```py\nshow model chapter11_byom.remote_random_cut_forest;\n```", "```py\nCOPY chapter11_byom.rcf_taxi_data\nFROM 's3://sagemaker-sample-files/datasets/tabular/anomaly_benchmark_taxi/NAB_nyc_taxi.csv'\nIAM_ROLE 'arn:aws:iam::215830312345:role/spectrumrs' ignoreheader 1 csv delimiter ',';\n```", "```py\nselect * from chapter11_byom.rcf_taxi_data limit 10;\n```", "```py\nselect ride_timestamp, nbr_passengers, chapter11_byom.remote_fn_rcf(nbr_passengers) as score\nfrom chapter11_byom.rcf_taxi_data;\n```", "```py\nwith score_cutoff as\n(select stddev(chapter11_byom.remote_fn_rcf(nbr_passengers)) as std, avg(chapter11_byom.remote_fn_rcf(nbr_passengers)) as mean, ( mean + 3 * std ) as score_cutoff_value\nFrom chapter11_byom.rcf_taxi_data)\nselect ride_timestamp, nbr_passengers, chapter11_byom.remote_fn_rcf(nbr_passengers) as score\nfrom chapter11_byom.3rcf_taxi_data\nwhere score > (select score_cutoff_value from score_cutoff)\n;\n```"]