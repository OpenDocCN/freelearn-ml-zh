<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer149">&#13;
			<h1 id="_idParaDest-128" class="chapter-number"><a id="_idTextAnchor131"/>7</h1>&#13;
			<h1 id="_idParaDest-129"><a id="_idTextAnchor132"/>Linear Algebra in R</h1>&#13;
			<p>The previous chapter introduced an efficient and effective reporting approach using R Markdown. <em class="italic">Part 1</em> of this book essentially covered the practical aspects of getting things done using R. <em class="italic">Part 2</em> of this book goes back to the fundamentals, covering two essential pillars of mathematics: linear algebra and calculus. Understanding these basics will better prepare us to appreciate and work with common mathematical operations to the point that these operations feel natural to us. <em class="italic">Part 2</em> aims to develop that level of literacy, starting with a fundamental review of linear algebra with R in <span class="No-Break">this chapter.</span></p>&#13;
			<p>By the end of this chapter, you will have learned about the basic concepts of linear algebra, including vectors, matrices, and the system of equations. You will also be able to interpret basic notations in linear algebra and work with common matrices <span class="No-Break">using R.</span></p>&#13;
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>&#13;
			<ul>&#13;
				<li>Introducing <span class="No-Break">linear algebra</span></li>&#13;
				<li>Common matrix operations <span class="No-Break">and properties</span></li>&#13;
				<li>Solving system of <span class="No-Break">linear equations</span></li>&#13;
			</ul>&#13;
			<h1 id="_idParaDest-130"><a id="_idTextAnchor133"/>Technical requirements</h1>&#13;
			<p>All the code and data for this chapter is available <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_7/working.R"><span class="No-Break">https://github.com/PacktPublishing/The-Statistics-and-Machine-Learning-with-R-Workshop/blob/main/Chapter_7/working.R</span></a><span class="No-Break">.</span></p>&#13;
			<h1 id="_idParaDest-131"><a id="_idTextAnchor134"/>Introducing linear algebra</h1>&#13;
			<p>This chapter delves<a id="_idIndexMarker593"/> into one of the most important branches of mathematics: <strong class="bold">linear algebra</strong>. Linear algebra deals with linear operations of mathematical objects, including vectors, matrices, and tensors (high-dimensional matrices), the most common forms of data. For example, the typical table we use to store data in Excel consists of a series of columns. Each column is called a vector, which stores a specific number of elements and takes the form of a column instead of a row by default. A collection of these column vectors forms a matrix, a two-dimensional Excel table, or DataFrame, as we used to call it in the previous chapters. We can also view the same table as a collection of row vectors, where each vector lives in the form of <span class="No-Break">a row.</span></p>&#13;
			<p>Let’s put these in context. The following code snippet loads the sleep dataset and prints out the first six rows and three columns. We use <span class="_-----MathTools-_Math_Variable_v-bold">A</span> to denote this 6x3 matrix in the <span class="No-Break">following exposition:</span></p>&#13;
			<pre class="source-code">&#13;
&gt;&gt;&gt; data(sleep)&#13;
&gt;&gt;&gt; head(sleep)&#13;
  extra group ID&#13;
1   0.7     1  1&#13;
2  -1.6     1  2&#13;
3  -0.2     1  3&#13;
4  -1.2     1  4&#13;
5  -0.1     1  5&#13;
6   3.4     1  6</pre>			<p>Let’s introduce some <a id="_idIndexMarker594"/>notation here. We use a bold lowercase letter, <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span>, to denote a column vector, say the <strong class="source-inline">extra</strong> variable, which consists of six elements in the vector. In other words, <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span> is a six-dimensional vector. The column vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span>, can be <em class="italic">transposed</em> into a row vector, denoting <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span>. Since <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span> is a row vector, we can write <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">0.7</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1.6</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.2</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1.2</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0.1</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Number">3.4</span><span class="_-----MathTools-_Math_Base">]</span>, which is also the typical way of writing row vectors (or transposed column vectors) in many books. Similarly, a row vector can be transposed into the (original) column vector, giving us <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span></span><span class="No-Break">.</span></p>&#13;
			<p>A graphical illustration will help here. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.1</em> depicts the process of transposing the column vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span>, into a row vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span>, then transposing it again into the original column vector, <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">a</span>. Therefore, we can view the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">A</span>, as a collection of column vectors concatenated horizontally, or a collection of row vectors <span class="No-Break">concatenated vertically:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer139" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_001.jpg" alt="Figure 7.1 – Transposing the column vector into a row vector, and then transposing it again into the original column vector" width="850" height="486"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.1 – Transposing the column vector into a row vector, and then transposing it again into the original column vector</p>&#13;
			<p>Note that the rows <a id="_idIndexMarker595"/>are also referred to as observations and that the columns are referred to as features <span class="No-Break">or attributes.</span></p>&#13;
			<p>We will start by working with vectors in the <span class="No-Break">following section.</span></p>&#13;
			<h2 id="_idParaDest-132"><a id="_idTextAnchor135"/>Working with vectors</h2>&#13;
			<p>A vector in R chains<a id="_idIndexMarker596"/> together data elements of the same type. Multiple<a id="_idIndexMarker597"/> vectors join hands, often side by side, to form a matrix. Therefore, it is the building block in linear algebra, and we must start <span class="No-Break">from there.</span></p>&#13;
			<p>There are multiple ways to create a vector. We will explore a few such options in the <span class="No-Break">following exercise.</span></p>&#13;
			<h3>Exercise 7.1 – creating a vector</h3>&#13;
			<p>This exercise will introduce <a id="_idIndexMarker598"/>three common ways of creating a vector. Let’s <span class="No-Break">get started:</span></p>&#13;
			<ol>&#13;
				<li>Create a vector of integers from 1 to 6 using the <strong class="source-inline">c()</strong> function, where <strong class="source-inline">c</strong> stands <span class="No-Break">for concatenation:</span><pre class="source-code">&#13;
x = c(1, 2, 3, 4, 5, 6)&#13;
&gt;&gt;&gt; x&#13;
[1] 1 2 3 4 5 6</pre><p class="list-inset">Note that <strong class="source-inline">[1]</strong> indicates that the result is a <span class="No-Break">one-dimensional vector.</span></p><p class="list-inset">Since this list is sequential and equally spaced by 1, we can use the colon notation and write <strong class="source-inline">1:6</strong> to create the same list, as shown in the following <span class="No-Break">code snippet:</span></p><pre class="source-code">x = c(1:6)</pre><p class="list-inset">One more function we can use to create a sequence of integers is the <strong class="source-inline">seq()</strong> function, which generates a sequence of numbers equally spaced based on the <span class="No-Break"><strong class="source-inline">by</strong></span><span class="No-Break"> argument.</span></p></li>				<li>Create the same vector <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">seq()</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
x = seq(1, 6, by=1)</pre><p class="list-inset">These three implementations create the <span class="No-Break">same vector.</span></p><p class="list-inset">In addition, we can use the <strong class="source-inline">rep()</strong> function to create a list of repeated numbers. The following code snippet produces a 6-element vector whose data is <span class="No-Break">all ones:</span></p><pre class="source-code">y = rep(1, 6)&#13;
&gt;&gt;&gt; y&#13;
[1] 1 1 1 1 1 1</pre></li>			</ol>&#13;
			<p>A vector in R is<a id="_idIndexMarker599"/> mutable, meaning we can change the value in the vector’s specific position(s). Let’s look at how to <span class="No-Break">achieve this.</span></p>&#13;
			<h3>Exercise 7.2 – modifying a vector</h3>&#13;
			<p>Modifying the contents of a <a id="_idIndexMarker600"/>vector is a common operation, especially in the context of processing a DataFrame using column-wise filtering conditions. The algebra of vectors follows mostly the same principle as scalars. To see this, we must first index the desired elements in the vector, followed by using an assignment operation to override the value of the specific element. Let’s take <span class="No-Break">a look:</span></p>&#13;
			<ol>&#13;
				<li>Change the value of the second element in the vector, <strong class="source-inline">x</strong>, <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">20</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
x[2] = 20&#13;
&gt;&gt;&gt; x&#13;
[1]  1 20  3  4  5  6</pre><p class="list-inset">So, we can access an element in a vector by wrapping the position in a squared bracket. We can also perform bulk operations that exert the same effect on all elements in <span class="No-Break">a vector.</span></p></li>				<li>Double all elements in the <span class="No-Break">vector, </span><span class="No-Break"><strong class="source-inline">x</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
&gt;&gt;&gt; x*2&#13;
[1]  2 40  6  8 10 12</pre><p class="list-inset">Here, the multiplier, <strong class="source-inline">2</strong>, is broadcast to each element in the vector to perform the respective multiplication. The same broadcasting mechanism applies to the addition operation <span class="No-Break">and more.</span></p></li>				<li>Increment all elements in <strong class="source-inline">x</strong> <span class="No-Break">by one:</span><pre class="source-code">&#13;
&gt;&gt;&gt; x + 1&#13;
[1]  2 21  4  5  6  7</pre><p class="list-inset">Of course, we can obtain the same result by adding <strong class="source-inline">x</strong> to <strong class="source-inline">y</strong>, a vector of ones with the <span class="No-Break">same length:</span></p><pre class="source-code">&gt;&gt;&gt; x + y&#13;
[1]  2 21  4  5  6  7</pre></li>			</ol>&#13;
			<p>Now that we’ve<a id="_idIndexMarker601"/> reviewed the basics of working with vectors, we can enter the realm <span class="No-Break">of matrices.</span></p>&#13;
			<h2 id="_idParaDest-133"><a id="_idTextAnchor136"/>Working with matrices</h2>&#13;
			<p>A matrix is a stack of<a id="_idIndexMarker602"/> vectors superimposed together. An <span class="_-----MathTools-_Math_Variable">m</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">n</span> matrix<a id="_idIndexMarker603"/> can be considered <span class="_-----MathTools-_Math_Variable">n</span> <span class="_-----MathTools-_Math_Variable">m</span>-dimensional column vectors stacked horizontally, or <span class="_-----MathTools-_Math_Variable">m</span> <span class="_-----MathTools-_Math_Variable">n</span>-dimensional row vectors stacked vertically. For each of the DataFrames that we have worked with, each row is an observation, and each column represents <span class="No-Break">a feature.</span></p>&#13;
			<p>Let’s look at how to create matrices by completing <span class="No-Break">an exercise.</span></p>&#13;
			<h3>Exercise 7.3 – creating a matrix</h3>&#13;
			<p>We can use the <strong class="source-inline">matrix()</strong> function<a id="_idIndexMarker604"/> to create a matrix. This function accepts three arguments: the data to be passed into the matrix via <strong class="source-inline">data</strong>, the number of rows via <strong class="source-inline">nrow</strong>, and the number of columns <span class="No-Break">via </span><span class="No-Break"><strong class="source-inline">ncol</strong></span><span class="No-Break">:</span></p>&#13;
			<ol>&#13;
				<li>Create a 3x2 matrix, <strong class="source-inline">X</strong>, filled with the <span class="No-Break">number </span><span class="No-Break"><strong class="source-inline">2</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
X = matrix(data=2, nrow=3, ncol=2)&#13;
&gt;&gt;&gt; X&#13;
     [,1] [,2]&#13;
[1,]    2    2&#13;
[2,]    2    2&#13;
[3,]    2    2</pre><p class="list-inset">Note the use of the broadcasting mechanism here. As we only pass in a single number, it is replicated across all the cells in the matrix. Also, observe the indexing pattern in the result. The position on the left indexes each row before the comma and each column by the position on the right after the comma. We can verify this observation by indexing the element located in the second row and the <span class="No-Break">first column:</span></p><pre class="source-code">&gt;&gt;&gt; X[1,2]&#13;
2</pre><p class="list-inset">Let’s verify the class of <span class="No-Break">this object:</span></p><pre class="source-code">&gt;&gt;&gt; class(X)&#13;
[1] "matrix" "array"</pre><p class="list-inset">The result shows that <strong class="source-inline">X</strong> is both a matrix and (<span class="No-Break">multi-dimensional) array.</span></p><p class="list-inset">We can also create a matrix based on <span class="No-Break">a vector.</span></p></li>				<li>Create a 3x2 matrix using the <strong class="source-inline">x</strong> variable. Fill the matrix <span class="No-Break">by rows:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(x, nrow=3, ncol=2, byrow=TRUE)&#13;
     [,1] [,2]&#13;
[1,]    1   20&#13;
[2,]    3    4&#13;
[3,]    5    6</pre><p class="list-inset">Here, filling by rows means sequentially placing each element in the original vector, <strong class="source-inline">x</strong>, row-wise, beginning from the first row from left to right and jumping to the next row when hitting the end of the current row. We can also design the filling <span class="No-Break">by columns.</span></p></li>				<li>Fill in the <a id="_idIndexMarker605"/>matrix by <span class="No-Break">columns instead:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(x, nrow=3, ncol=2, byrow=FALSE)&#13;
     [,1] [,2]&#13;
[1,]    1    4&#13;
[2,]   20    5&#13;
[3,]    3    6</pre><p class="list-inset">As with the vector, we can change a specific element in a matrix by first locating the element via indexing and assigning the new value, as <span class="No-Break">shown here:</span></p><pre class="source-code">X[1,1] = 10&#13;
&gt;&gt;&gt; X&#13;
     [,1] [,2]&#13;
[1,]   10    2&#13;
[2,]    2    2&#13;
[3,]    2    2</pre></li>			</ol>&#13;
			<p>A common operation in linear algebra is to multiply a matrix by a vector. Such an operation gives rise to many<a id="_idIndexMarker606"/> interesting and important interpretations regarding matrix manipulation. We’ll look at this operation in the <span class="No-Break">following section.</span></p>&#13;
			<h2 id="_idParaDest-134"><a id="_idTextAnchor137"/>Matrix vector multiplication</h2>&#13;
			<p>An overarching rule <a id="_idIndexMarker607"/>when multiplying a matrix by a vector is the <a id="_idIndexMarker608"/>equality of the inner dimension. In other words, the column dimension (meaning the number of columns) of the matrix, when multiplied by a vector on its right, has to be equal to the row dimension of the multiplying vector. For example, given an <span class="_-----MathTools-_Math_Variable">m</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">n</span> matrix, it can only multiply a column vector of size <span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Number">1</span>, and such multiplication results in another vector of size <span class="_-----MathTools-_Math_Variable">m</span><span class="_-----MathTools-_Math_Space"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-normal">x</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Space"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">1</span></span><span class="No-Break">.</span></p>&#13;
			<p>Let’s look at a concrete example here. Recall that <span class="_-----MathTools-_Math_Variable_v-bold">X</span> is a <span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Number">2</span> matrix. Multiplying it by a <span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Number">1</span> vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, should produce a <span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Number">1</span> vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">z</span>. The transition from the original vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, to the new vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">z</span>, has an extra meaning here: <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> has changed space and now lives in a three-dimensional world instead of two! We can also say the old vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, is projected and stretched to the new vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">z</span>, because of the projection matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>. Such a projection, or transformation, constitutes the majority of operations in modern neural networks. By projecting matrices (also called representations) across different layers, a neural network can <em class="italic">learn</em> different levels <span class="No-Break">of abstraction.</span></p>&#13;
			<p>Let’s assume <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> is a vector of ones. The rule of matrix-vector multiplication says that each entry in the resulting vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">z</span>, is the inner product of the corresponding vectors. The inner product between two vectors, also called the dot product, is the sum of the products of the corresponding elements in each vector. For example, the first entry in <span class="_-----MathTools-_Math_Variable_v-bold-italic">z</span> is 12. Its positional index, which is [1,1], says that it requires the first row in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, which is [10, 2], and the first column in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, which is [1, 1], to enter the inner product operation. Multiplying the corresponding elements in each vector and summing the results gives us 10*1+2*1=12. Similarly, the second entry is calculated as 2*1+2*1=4. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.2</em> summarizes this <span class="No-Break">matrix-vector multiplication:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer140" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_002.jpg" alt="Figure 7.2 – Illustrating the matrix-vector multiplication process" width="519" height="242"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.2 – Illustrating the matrix-vector multiplication process</p>&#13;
			<p>Now, let’s<a id="_idIndexMarker609"/> look at<a id="_idIndexMarker610"/> how to perform matrix-vector multiplication <span class="No-Break">in R.</span></p>&#13;
			<h3>Exercise 7.4 – applying matrix-vector multiplication</h3>&#13;
			<p>The matrix-vector <a id="_idIndexMarker611"/>multiplication operation comes via the <strong class="source-inline">%*%</strong> symbol in R. The <strong class="source-inline">%*%</strong> notation is very different from the <strong class="source-inline">*</strong> notation alone, which stands for element-wise multiplication. The following exercise illustrates such <span class="No-Break">a difference:</span></p>&#13;
			<ol>&#13;
				<li>Multiply the previous matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, by a 2x1 vector <span class="No-Break">of ones:</span><pre class="source-code">&#13;
&gt;&gt;&gt; X %*% c(1,1)&#13;
     [,1]&#13;
[1,]   12&#13;
[2,]    4&#13;
[3,]    4</pre><p class="list-inset">The result shows that the generated vector is 3x1. Note that the multiplication will not go through if the dimensions do <span class="No-Break">not check:</span></p><pre class="source-code">&gt;&gt;&gt; X %*% c(1,1,1)&#13;
Error in X %*% c(1, 1, 1) : non-conformable arguments</pre><p class="list-inset">The error says that the dimensions of the vector, <strong class="source-inline">c(1,1,1)</strong>, do not match those in the <span class="No-Break"><strong class="source-inline">X</strong></span><span class="No-Break"> matrix.</span></p><p class="list-inset">We can verify the calculation of each cell in the <span class="No-Break">resulting vector.</span></p></li>				<li>Calculate the first entry in the resulting <span class="No-Break">vector separately:</span><pre class="source-code">&#13;
&gt;&gt;&gt; X[1,] %*% c(1,1)&#13;
     [,1]&#13;
[1,]   12</pre><p class="list-inset">The result shows that the first entry is the dot product of the first row, <strong class="source-inline">X[1,]</strong>, and the first (and only) column, <strong class="source-inline">c(1,1)</strong>. We can also re-express the dot product as explicit element-wise multiplication <span class="No-Break">and summation.</span></p></li>				<li>Re-express the previous dot product as explicit element-wise multiplication <span class="No-Break">and summation:</span><pre class="source-code">&#13;
&gt;&gt;&gt; sum(X[1,] * c(1,1))&#13;
[1] 12</pre><p class="list-inset">Note that both results <a id="_idIndexMarker612"/>return the same value but assume a different data structure: the dot product operation returns a matrix, while the re-expressed operation returns <span class="No-Break">a vector.</span></p></li>				<li>Let’s verify the same calculation using the second entry in the <span class="No-Break">resulting vector:</span><pre class="source-code">&#13;
&gt;&gt;&gt; X[2,] %*% c(1,1)&#13;
     [,1]&#13;
[1,]    4&#13;
&gt;&gt;&gt; sum(X[2,] * c(1,1))&#13;
[1] 4</pre><p class="list-inset">We can also examine the behavior of multiplying a matrix with <span class="No-Break">a scalar.</span></p></li>				<li>Double each element in the <span class="No-Break">matrix, </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span></span><span class="No-Break">:</span><pre class="source-code">&#13;
&gt;&gt;&gt; X * 2&#13;
     [,1] [,2]&#13;
[1,]   20    4&#13;
[2,]    4    4&#13;
[3,]    4    4</pre><p class="list-inset">Note that when switching to the element-wise multiplication symbol, <strong class="source-inline">*</strong>, the dimension of the resulting matrix remains unchanged. In addition, the broadcasting mechanism is in play here, where a scalar of 2 is multiplied by each element in the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>. The effect is as if we’re multiplying <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> by another matrix of the <span class="No-Break">same dimensions:</span></p><pre class="source-code">&gt;&gt;&gt; X * matrix(2, 3, 2)&#13;
     [,1] [,2]&#13;
[1,]   20    4&#13;
[2,]    4    4&#13;
[3,]    4    4</pre></li>			</ol>&#13;
			<p>Now, let’s cover<a id="_idIndexMarker613"/> matrix-matrix multiplication. We will refer to it as matrix multiplication <span class="No-Break">for short.</span></p>&#13;
			<h2 id="_idParaDest-135"><a id="_idTextAnchor138"/>Matrix multiplication</h2>&#13;
			<p>Matrix multiplication is<a id="_idIndexMarker614"/> the most widely used form of operation in<a id="_idIndexMarker615"/> many domains. Take the neural network model, for example. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.3</em> shows a simple network architecture called a fully connected neural network, where all neurons are fully connected. The input data, represented by the input layer with 10 rows and 3 columns, will enter a series of matrix multiplications (plus nonlinear transformations, which are ignored here) to learn useful representations (<span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>) and, therefore, accurate predictions (<span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>). There are two matrix multiplications here. The first matrix multiplication happens between the 10x3 input data, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, and the weight matrix <span class="_-----MathTools-_Math_Variable_v-bold-italic">W</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>, which produces a 10x4 hidden representation, <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>, in the hidden layer. The second matrix multiplication transforms <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> into the final 10x2 output, <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>, using another 4x2 weight matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">W</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>. We can also interpret a series of matrix multiplications as transforming/projecting the input data, <span class="_-----MathTools-_Math_Variable">X</span>, to the hidden representation, <span class="_-----MathTools-_Math_Variable_v-bold">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>, and then to the output, <span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold">Z</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">2</span></span><span class="No-Break">:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer141" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_003.jpg" alt="Figure 7.3 – Schematic of a simple two-layer fully connected neural network" width="605" height="519"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.3 – Schematic of a simple two-layer fully connected neural network</p>&#13;
			<p>As you can <a id="_idIndexMarker616"/>see<a id="_idIndexMarker617"/> from <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.3</em>, the input data, represented by the input layer with 10 rows and 3 columns, will enter a series of matrix multiplications (plus nonlinear transformations, which are ignored here) to learn useful representations (<span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>) and, therefore, accurate predictions (<span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>). The first matrix multiplication happens between the 10x3 input data, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, and the weight matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">W</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>, resulting in a 10x4 hidden representation, <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>. The second matrix multiplication transforms <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> into the final 10x2 output, <span class="_-----MathTools-_Math_Variable_v-bold-italic">Z</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>, using another 4x2 weight matrix, <span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">W</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">2</span></span><span class="No-Break">.</span></p>&#13;
			<p>There is more to these matrix multiplications. Let’s assume the input data has many features. By applying these matrix multiplications with the automatically learned weight matrices, these features can be weighed correspondingly to produce accurate predictions in the output layer. Automatic feature learning, including those nodes in the hidden layer, is a distinguishing characteristic of modern neural networks compared to traditional manual <span class="No-Break">feature learning.</span></p>&#13;
			<p>Let’s look at a single matrix multiplication in more detail. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.4</em> illustrates the calculation process of multiplying a 2x2 matrix, <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span>, by another 2x2 matrix, <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span>. We can also view each column in the resulting matrix as a result of matrix-vector multiplication, as covered earlier; these columns are then concatenated to form the new <span class="No-Break">output matrix:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer142" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_004.jpg" alt="Figure 7.4 – Breaking down the matrix multiplication process" width="447" height="313"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.4 – Breaking down the matrix multiplication process</p>&#13;
			<p>Let’s go<a id="_idIndexMarker618"/> through<a id="_idIndexMarker619"/> an exercise to put the practical part of things <span class="No-Break">into context.</span></p>&#13;
			<h3>Exercise 7.5 – working with matrix multiplication</h3>&#13;
			<p>Matrix multiplication<a id="_idIndexMarker620"/> still relies on the <strong class="source-inline">%*%</strong> sign in R. In this exercise, we will reproduce the example in <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.4</em>, with a bit of stretch in terms of the order <span class="No-Break">of multiplication:</span></p>&#13;
			<ol>&#13;
				<li>Reproduce the previous matrix <span class="No-Break">multiplication example:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(1:4, 2, 2) %*% matrix(2, 2, 2)&#13;
     [,1] [,2]&#13;
[1,]    8    8&#13;
[2,]   12   12</pre><p class="list-inset">Here, we use the <strong class="source-inline">matrix()</strong> function to create two matrices, the first generated by converting a vector and the second by duplicating a scalar value <span class="No-Break">via broadcasting.</span></p><p class="list-inset">The order of multiplication is of key importance in matrix algebra; shuffling the order will produce a different result in most cases. Let me switch these <span class="No-Break">two matrices.</span></p></li>				<li>Switch the order <a id="_idIndexMarker621"/>of multiplication for these <span class="No-Break">two matrices:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(2, 2, 2) %*% matrix(1:4, 2, 2)&#13;
     [,1] [,2]&#13;
[1,]    6   14&#13;
[2,]    6   14</pre><p class="list-inset">Please verify the result of the matrix multiplication and appreciate the importance of order in multiplying two matrices: matrix multiplication is <span class="No-Break"><em class="italic">not</em></span><span class="No-Break"> commutative.</span></p><p class="list-inset">Additionally, element-wise multiplication happens using the <strong class="source-inline">*</strong> <span class="No-Break">operator.</span></p></li>				<li>Double every element in the previous matrix on <span class="No-Break">the left:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(1:4, 2, 2) * matrix(2, 2, 2)&#13;
     [,1] [,2]&#13;
[1,]    2    6&#13;
[2,]    4    8</pre></li>			</ol>&#13;
			<p>Several special <a id="_idIndexMarker622"/>matrices are of particular interest. We’ll review them in the <span class="No-Break">next section.</span></p>&#13;
			<h2 id="_idParaDest-136"><a id="_idTextAnchor139"/>The identity matrix</h2>&#13;
			<p>There are many <a id="_idIndexMarker623"/>special types of matrices. The first type of special matrix is <a id="_idIndexMarker624"/>the <strong class="bold">identity matrix</strong>, which assumes a value of 1 at the on-diagonal positions and 0 elsewhere. The biggest characteristic of an identity matrix is the identity preservation of the original multiplying matrix – that is, any matrix that can successfully multiply by an identity matrix obtains the same result as itself. This sounds like multiplying by one, and we are indeed doing so when the identity matrix <span class="No-Break">is 1x1.</span></p>&#13;
			<h3>Exercise 7.6 – working with the identity matrix</h3>&#13;
			<p>Let’s go <a id="_idIndexMarker625"/>through an exercise to see how identity <span class="No-Break">matrices work:</span></p>&#13;
			<ol>&#13;
				<li>Create a 2x2 identity matrix using the <span class="No-Break"><strong class="source-inline">diag()</strong></span><span class="No-Break"> function:</span><pre class="source-code">&#13;
&gt;&gt;&gt; diag(2)&#13;
     [,1] [,2]&#13;
[1,]    1    0&#13;
[2,]    0    1</pre><p class="list-inset">To create an identity matrix, we simply need to pass the number of ones in the diagonal of the matrix. A diagonal matrix can also be created from <span class="No-Break">a vector:</span></p><pre class="source-code">&gt;&gt;&gt; diag(c(1,2,3), nrow=3, ncol=3)&#13;
     [,1] [,2] [,3]&#13;
[1,]    1    0    0&#13;
[2,]    0    2    0&#13;
[3,]    0    0    3</pre><p class="list-inset">Here, the elements in the vector are used to fill in the diagonal positions of the diagonal matrix while leaving all the rest of the cells <span class="No-Break">as 0.</span></p><p class="list-inset">Let’s multiply the 2x2 identity matrix by the previous <span class="No-Break">running matrix.</span></p></li>				<li>Multiply<a id="_idIndexMarker626"/> this identity matrix by the previous 2x2 matrix numbered 1 <span class="No-Break">to 4:</span><pre class="source-code">&#13;
&gt;&gt;&gt; matrix(1:4, 2, 2) %*% diag(2)&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre><p class="list-inset">We can see that there is no change in the resulting matrix. Let’s verify <span class="No-Break">this again:</span></p><pre class="source-code">&gt;&gt;&gt; matrix(1:4, 2, 2)&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre><p class="list-inset">Lastly, let’s verify that the result is still the same after switching the order <span class="No-Break">of multiplication.</span></p></li>				<li>Move the multiplying identity matrix to the left and perform <span class="No-Break">matrix multiplication:</span><pre class="source-code">&#13;
&gt;&gt;&gt; diag(2) %*% matrix(1:4, 2, 2)&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre><p class="list-inset">The result shows no change to the original matrix. If we use <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> to denote the original matrix and <span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span> to denote the identity matrix, we will get <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span></span><span class="No-Break">.</span></p></li>			</ol>&#13;
			<p>Other operations <a id="_idIndexMarker627"/>can derive new matrices based on the original one, such as transposing or inversing <span class="No-Break">a matrix.</span></p>&#13;
			<h2 id="_idParaDest-137"><a id="_idTextAnchor140"/>Transposing a matrix</h2>&#13;
			<p>We already have some<a id="_idIndexMarker628"/> experience transposing a vector, which is a special <a id="_idIndexMarker629"/>case of transposing a matrix. Transposing a matrix means flipping the original matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, to generate a new one, <span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span>, whose columns and rows are now switched. Transposing a transposed matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span>, gives back the original matrix, <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span></span><span class="No-Break">.</span></p>&#13;
			<p>A special type of matrix is <a id="_idIndexMarker630"/>called the <strong class="bold">symmetric matrix</strong>, such that <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>. A symmetric matrix is<a id="_idIndexMarker631"/> also a <strong class="bold">square matrix</strong>; otherwise, the <a id="_idIndexMarker632"/>transposed dimensions will <span class="No-Break">not check.</span></p>&#13;
			<p>Let’s see this <span class="No-Break">in practice.</span></p>&#13;
			<h3>Exercise 7.7 – transposing a matrix</h3>&#13;
			<p>In this exercise, we will <a id="_idIndexMarker633"/>transpose a matrix using the <strong class="source-inline">t()</strong> function and transpose it again to see whether it matches the <span class="No-Break">original matrix:</span></p>&#13;
			<ol>&#13;
				<li>Create a square matrix, <strong class="source-inline">X</strong>, with elements one to four filled <span class="No-Break">by column:</span><pre class="source-code">&#13;
X = matrix(1:4, 2, 2)&#13;
&gt;&gt;&gt; X&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre></li>				<li>Transpose the matrix <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">t()</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
&gt;&gt;&gt; t(X)&#13;
     [,1] [,2]&#13;
[1,]    1    2&#13;
[2,]    3    4</pre><p class="list-inset">Here, we can see <a id="_idIndexMarker634"/>that the transposed matrix has its rows and columns flipped from the original matrix. The diagonal elements stay the <span class="No-Break">same, though.</span></p></li>				<li>Transpose the transposed matrix again and verify whether it is equal to the <span class="No-Break">original matrix:</span><pre class="source-code">&#13;
&gt;&gt;&gt; t(t(X))&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre><p class="list-inset">A visual inspection shows that it is indeed the same original matrix. However, we can also use the built-in <strong class="source-inline">all.equal()</strong> function to perform a <span class="No-Break">systematic check:</span></p><pre class="source-code">&gt;&gt;&gt; all.equal(X, t(t(X)))&#13;
[1] TRUE</pre><p class="list-inset">The result shows that these two matrices are equal to each other, thus being the <span class="No-Break">same </span><span class="No-Break"><a id="_idIndexMarker635"/></span><span class="No-Break">matrix.</span></p></li>			</ol>&#13;
			<p>Let’s review the last type of operation: inversing <span class="No-Break">a matrix.</span></p>&#13;
			<h2 id="_idParaDest-138"><a id="_idTextAnchor141"/>Inverting a matrix</h2>&#13;
			<p>Inversing a scalar <a id="_idIndexMarker636"/>number is intuitive. For any number, <span class="_-----MathTools-_Math_Variable">x</span>, its inverse (or reciprocal) is <span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Variable"> </span> if <span class="_-----MathTools-_Math_Variable">x</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">≠</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>. This<a id="_idIndexMarker637"/> condition ensures that <span class="_-----MathTools-_Math_Variable">x</span> is invertible. Similarly, not all matrices <span class="No-Break">are invertible.</span></p>&#13;
			<p>Formally, we say that a matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, is invertible if it can, when multiplied by its inverse, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span>, produce an identity matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span>. In other words,  <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span></span><span class="No-Break">.</span></p>&#13;
			<p>There are some interesting properties of an invertible matrix as well. For example, inverting an inverse matrix gives us the original matrix: <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold">X</span>. Also, since the product of an identity matrix with itself is an identity matrix, the inverse of an identity matrix is thus the identity matrix itself, a special case compared <span class="No-Break">to others.</span></p>&#13;
			<p>The inverse of a<a id="_idIndexMarker638"/> matrix can be obtained using the <strong class="source-inline">solve()</strong> function in R, which will give us an error if the <a id="_idIndexMarker639"/>matrix is not invertible. Let’s practice this via the <span class="No-Break">following exercise.</span></p>&#13;
			<h3>Exercise 7.8 – inverting a matrix</h3>&#13;
			<p>In this exercise, we will<a id="_idIndexMarker640"/> invert both an identity matrix and a standard square matrix using the <span class="No-Break"><strong class="source-inline">solve()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<ol>&#13;
				<li>Invert a two-dimensional <span class="No-Break">identity matrix:</span><pre class="source-code">&#13;
&gt;&gt;&gt; solve(diag(2))&#13;
     [,1] [,2]&#13;
[1,]    1    0&#13;
[2,]    0    1</pre><p class="list-inset">The result shows that the inverse of an identity matrix <span class="No-Break">is itself.</span></p></li>				<li>Invert the running matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, from the <span class="No-Break">previous example:</span><pre class="source-code">&#13;
Xinv = solve(X)&#13;
&gt;&gt;&gt; Xinv&#13;
     [,1] [,2]&#13;
[1,]   -2  1.5&#13;
[2,]    1 -0.5</pre><p class="list-inset">We can verify the validity of this inverse matrix by multiplying it by the original matrix and checking whether it gives us an <span class="No-Break">identity matrix.</span></p></li>				<li>Multiply by the <a id="_idIndexMarker641"/>original matrix to verify it based on the definition of <span class="No-Break">matrix inversion:</span><pre class="source-code">&#13;
&gt;&gt;&gt; Xinv %*% X&#13;
     [,1] [,2]&#13;
[1,]    1    0&#13;
[2,]    0    1&#13;
&gt;&gt;&gt; X %*% Xinv&#13;
     [,1] [,2]&#13;
[1,]    1    0&#13;
[2,]    0    1</pre><p class="list-inset">The result shows that <strong class="source-inline">Xinv</strong> is indeed the inverse matrix <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">X</strong></span><span class="No-Break">.</span></p></li>			</ol>&#13;
			<p>In the following <a id="_idIndexMarker642"/>section, we will look at matrix-vector multiplication from the perspective of solving a system of linear equations, which is an essential task in many machine <span class="No-Break">learning algorithms.</span></p>&#13;
			<h1 id="_idParaDest-139"><a id="_idTextAnchor142"/>Solving a system of linear equations</h1>&#13;
			<p>The matrix-vector<a id="_idIndexMarker643"/> multiplication operation gives rise to a system of equations. In a typical machine learning algorithm, data comes in the form of a matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, and the target outcome is a vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. When the model that’s used is a straightforward linear model, we assume the input-output relationship as <span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, where <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span> represents the vector of features/coefficients. An <span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable">p</span> matrix of input data multiplies a <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Number">1</span> vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>, of features to produce, as expected, an <span class="_-----MathTools-_Math_Variable">n</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Space"> </span><span class="_-----MathTools-_Math_Number">1</span> output vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. The essence of linear regress is thus to solve for the exact values in <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span> such that the system of linear equations in <span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> <span class="No-Break">are satisfied.</span></p>&#13;
			<p>The equivalence between matrix-vector multiplication and the system of linear equations may take some time to become noticeable. Let’s pause and look at <span class="No-Break">this equivalence.</span></p>&#13;
			<h2 id="_idParaDest-140"><a id="_idTextAnchor143"/>System of linear equations</h2>&#13;
			<p>We are already familiar <a id="_idIndexMarker644"/>with the process of calculating a matrix-vector multiplication operation. A 2x2 matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, when multiplying a 2x1 vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>, will result in a 2x1 vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. The first element in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, positioned as (1, 1), comes from the dot product (weighted sum) between the first row in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and the first column in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. Similarly, the second element in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, positioned as (2, 1), comes from the dot product between the second row in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and the first column in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. The positional index of each element in <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> determines the ingredients used in the respective dot <span class="No-Break">product operation.</span></p>&#13;
			<p>Such an interpretation, however, is a raw and low-level one. A more advanced interpretation lies in the column space of <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and the associated linear combination of the column vectors in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> weighted by the weights in <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span> in the same matrix-vector multiplication. A concrete example will <span class="No-Break">help here.</span></p>&#13;
			<p>Suppose we have a simple matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span>, and a vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1,1</span><span class="_-----MathTools-_Math_Base">]</span>. The output vector is <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Base">]</span> based on the usual method of calculation. The column view gives another process of calculation: <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Base">]</span>. Here, the two columns, <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span> and <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span>, are weighted by each element in <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>, respectively. In other words, these two columns are linearly combined to produce the output column vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. This forms the basis of the system of linear equations. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.5</em> summarizes these two different <a id="_idIndexMarker645"/>perspectives of matrix-vector multiplication for <span class="No-Break">this example:</span></p>&#13;
			<p class="IMG---Figure"> </p>&#13;
			<div>&#13;
				<div id="_idContainer143" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_005.jpg" alt="Figure 7.5 – Illustrating the two different ways of calculating matrix-vector multiplication" width="1379" height="449"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.5 – Illustrating the two different ways of calculating matrix-vector multiplication</p>&#13;
			<p>Now, assume the weight vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>, is unknown, with two unknown elements, <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> and <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span> – in other words, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">T</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span>. Also, assume that the input matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, and the output vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, are known. This is a common situation where we are given the input-output data pairs and asked to estimate the coefficients of the linear model such that <span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. Now comes the system of linear equations. Plugging in the previous weighted combination of column vectors <span class="No-Break">gives us</span></p>&#13;
			<p> <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Symbol_v-normal">*</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Base">]</span>. We have a system of equations, <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span></p>&#13;
			<p>Solving this system of <a id="_idIndexMarker646"/>linear equations gives us <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span>. The equivalence of matrix-vector multiplication and the system of linear equations is <span class="No-Break">manifested here.</span></p>&#13;
			<p>Let’s go through an exercise to appreciate the equivalence in terms <span class="No-Break">of code.</span></p>&#13;
			<h3>Exercise 7.9 – understanding the system of linear equations</h3>&#13;
			<p>In this exercise, we will first use the usual matrix-vector multiplication procedure to calculate the result, followed by providing a detailed and manual column-view implementation of the same operation. We will see that both give the <span class="No-Break">same result:</span></p>&#13;
			<ol>&#13;
				<li>Create a 2x2 matrix, <strong class="source-inline">X</strong>, that consists of four numbers, 1 to 4, and is filled <span class="No-Break">by column:</span><pre class="source-code">&#13;
X = matrix(c(1:4), nrow=2, ncol=2)&#13;
&gt;&gt;&gt; X&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4</pre></li>				<li>Create a vector, <strong class="source-inline">w</strong>, of length two, both filled with a value <span class="No-Break">of 1:</span><pre class="source-code">&#13;
w = c(1,1)&#13;
&gt;&gt;&gt; w&#13;
[1] 1 1</pre><p class="list-inset">Note that a vector is a column vector by default. When the 2x2 matrix, <strong class="source-inline">X</strong>, multiplies the 2x1 vector, <strong class="source-inline">w</strong>, as shown in the following code, the vector, <strong class="source-inline">w</strong>, is expressed as a<a id="_idIndexMarker647"/> column vector before entering the <span class="No-Break">multiplication operation.</span></p></li>				<li>Multiply <strong class="source-inline">X</strong> and <strong class="source-inline">w</strong> and save the result <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">y</strong></span><span class="No-Break">:</span><pre class="source-code">&#13;
y = X %*% w&#13;
&gt;&gt;&gt; y&#13;
     [,1]&#13;
[1,]    4&#13;
[2,]    6</pre><p class="list-inset">Now, the <strong class="source-inline">y</strong> vector is displayed as an explicit column vector. Lastly, let’s verify the calculation using the <span class="No-Break">column view.</span></p></li>				<li>Perform the same matrix-vector multiplication using the column view, meaning a weighted sum of <span class="No-Break">column vectors:</span><pre class="source-code">&#13;
&gt;&gt;&gt; w[1] * X[,1] + w[2] * X[,2]&#13;
[1] 4 6</pre><p class="list-inset">Here, we use <strong class="source-inline">X[,1]</strong> and <strong class="source-inline">X[,2]</strong> to access the first and second columns, respectively. The result agrees with the previous one, although following a different format as it is displayed as a row <span class="No-Break">vector now.</span></p></li>			</ol>&#13;
			<p>Matrix-vector multiplication gives rise to a system of linear equations. However, this system of linear equations may or may not have a solution. Even if there is a solution, it may not be<a id="_idIndexMarker648"/> unique. In the following section, we will examine the potential solution to <span class="No-Break">matrix-vector equations.</span></p>&#13;
			<h2 id="_idParaDest-141"><a id="_idTextAnchor144"/>The solution to matrix-vector equations</h2>&#13;
			<p>Let’s continue with<a id="_idIndexMarker649"/> the example where a 2x2 matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, multiplies a 2x1 weight vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>, to produce a 2x1 output vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. We will discuss three cases here: without a solution, with a unique solution, and with infinitely <span class="No-Break">many solutions.</span></p>&#13;
			<p>We will start with the second case. Recall our previous values in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Operator">,</span> and <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>. In <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span> x <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">]</span> <span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Base">]</span>, we multiplied the former two (<span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>) to produce the third one (<span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span><span class="_-----MathTools-_Math_Base">)</span> and showed how to derive the values of <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span> given <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> by solving a system of linear equations in <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span> x <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span> <span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Base">]</span>. In other words, the solution is unique, and we can solve it analytically by writing out the explicit system of linear equations and solving the unknowns. It will be more involved when we have more unknowns to solve, but the process stays the same. In a typical linear regression setting, when the number of unknowns (the length of the weight vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>) is the same as the number of equations (the number of rows in <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>), and provided that the input matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, is a nice one (for example, if its columns are uncorrelated), we can find a unique solution to the system of <span class="No-Break">linear equations.</span></p>&#13;
			<p>Now, let’s tweak the<a id="_idIndexMarker650"/> input matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, so that no solution can be found. One way to do this is to set the second row vector of <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> to zero, giving us <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">]</span>. Thus, we have <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="No-Break"><span class="_-----MathTools-_Math_Number">4</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">6</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p>It is obvious that the second equation fails, and therefore this system of linear equations cannot have a solution. This is called an <em class="italic">inconsistent</em> system since 0 cannot be 6. Note that in the first equation, there are infinitely many pairs of <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">)</span> that satisfy the equation. This also leads to our <span class="No-Break">third case.</span></p>&#13;
			<p>Now, suppose we change the output vector slightly and make the second entry of <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span> zero, giving us <span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">]</span>. Thus, we have <span class="No-Break">the following:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Variable_v-normal">x</span><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="No-Break"><span class="_-----MathTools-_Math_Number">4</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p>Now, this system of linear equations has at least one solution and is <em class="italic">consistent</em>, but with infinitely many solutions. There is not much we can take away from solving this system of equations; since there are infinitely many solutions, we are unable to evaluate which one is the best to report. Real-world optimization problems are typically concerned with finding <em class="italic">the</em> single most optimal solution or the best sub-optimal solution that is closest to <a id="_idIndexMarker651"/>the empirically unattainable <span class="No-Break">optimal solution.</span></p>&#13;
			<p><span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.6</em> summarizes these <span class="No-Break">three cases:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer144" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_006.jpg" alt="Figure 7.6 – Three different cases when solving a system of linear equations" width="1153" height="467"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.6 – Three different cases when solving a system of linear equations</p>&#13;
			<p>It turns out that we can also view the process of solving a system of linear equations from a geometric <a id="_idIndexMarker652"/>perspective. Let’s <span class="No-Break">dive in.</span></p>&#13;
			<h2 id="_idParaDest-142"><a id="_idTextAnchor145"/>Geometric interpretation of solving a system of linear equations</h2>&#13;
			<p>Once again, let’s <a id="_idIndexMarker653"/>start with the case where we have a unique solution for the system of linear equations with two unknowns (<span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> and <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span>) and <span class="No-Break">two equations:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">]</span> x <span class="_-----MathTools-_Math_Base">[</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base">]</span> <span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="No-Break"><span class="_-----MathTools-_Math_Number">4</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">6</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">6</span></p>&#13;
			<p>If we introduce a two-dimensional coordinate system and put <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span> and <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span> on the <em class="italic">x</em> axis and <em class="italic">y</em> axis, respectively, we will see two lines on the coordinate system, each representing a linear equation in the system. Now, we can re-express the previous system of equations <span class="No-Break">as follows:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p>Therefore, solving<a id="_idIndexMarker654"/> the system of linear equations corresponds with finding the intersection point of these two lines, since it is only at the intersection point that both equations are satisfied. The following codes help us plot the <span class="No-Break">two lines:</span></p>&#13;
			<pre class="source-code">&#13;
plot(x=1, y=1, xlab="w1", ylab="w2", xlim=c(0, 5), ylim=c(0, 5))&#13;
abline(a=4/3, b=-1/3)&#13;
abline(a=3/2, b=-1/2)</pre>			<p>Here, we use the <strong class="source-inline">plot()</strong> function to draw a two-dimensional coordinate system with a circle representing the point (1,1). We also add two lines using the <strong class="source-inline">abline()</strong> function, which accepts the intercept and slope of the line as <span class="No-Break">input arguments.</span></p>&#13;
			<p>Running this code generates <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.7</em>. We can see that these two lines happen to meet at point (1,1), which is not <span class="No-Break">a coincidence!</span></p>&#13;
			<div>&#13;
				<div id="_idContainer145" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_007.jpg" alt="Figure 7.7 – Plotting the system of linear equations as intersecting lines" width="1059" height="749"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.7 – Plotting the system of linear equations as intersecting lines</p>&#13;
			<p>Now, we will look at the case with no solution for the system of equations. The previous example shows an <a id="_idIndexMarker655"/>inconsistent system of equations, where the second equation simply does not stand. With the geometric interpretation in the coordinate system, we can make another line parallel to the first one, such as by shifting the line up by one unit, to produce a case with no solution. Specifically, we can have the following system <span class="No-Break">of equations:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base">)</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span></p>&#13;
			<p>Here, we minus 1 from <span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span> to shift the line upward by one unit. Again, we can express these equations as a function of <span class="No-Break"><span class="_-----MathTools-_Math_Variable">w</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base"> </span></span><span class="No-Break"><span class="_-----MathTools-_Math_Number">1</span></span><span class="No-Break">:</span></p>&#13;
			<p><span class="_-----MathTools-_Math_Base">{</span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">4</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">  </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">2</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">+</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">7</span><span class="_-----MathTools-_Math_Number"> </span><span class="_-----MathTools-_Math_Base">_</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">3</span><span class="_-----MathTools-_Math_Number"> </span></p>&#13;
			<p>Let’s plot these two lines on the coordinate system via the following code. The only change is the bigger intercept in the second line compared to the <span class="No-Break">first one:</span></p>&#13;
			<pre class="source-code">&#13;
plot(x=1, y=1, xlab="w1", ylab="w2", xlim=c(0, 5), ylim=c(0, 5))&#13;
abline(a=4/3, b=-1/3)&#13;
abline(a=7/3, b=-1/3)</pre>			<p>Running this code generates <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.8</em>. Since these two lines are parallel, there will be no intersection<a id="_idIndexMarker656"/> between the two lines, so we’ll end up with no solution to the system of <span class="No-Break">linear equations:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer146" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_008.jpg" alt="Figure 7.8 – Plotting two parallel lines" width="1082" height="764"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.8 – Plotting two parallel lines</p>&#13;
			<p>Now, let’s move on to the case with infinitely many solutions. As you may have guessed, we just need to make the second equation the same as the first one, thus creating two overlapping lines in the coordinate system. Any point on these two overlapping lines is a valid solution, and there is an infinite number of such points on <span class="No-Break">the line(s).</span></p>&#13;
			<p>Working with a system of linear equations may not guarantee a solution. Even if there are as many unknown <a id="_idIndexMarker657"/>variables as there are rows in the system, this isn’t guaranteed to give us a solution. In the following section, we’ll look at under what conditions we are guaranteed to get a <span class="No-Break">unique solution.</span></p>&#13;
			<h2 id="_idParaDest-143"><a id="_idTextAnchor146"/>Obtaining a unique solution to a system of linear equations</h2>&#13;
			<p>Recall our<a id="_idIndexMarker658"/> analytical framework: <span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, where we are given input-output pairs <span class="_-----MathTools-_Math_Base">(</span><span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Operator">,</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span><span class="_-----MathTools-_Math_Base">)</span> and would like to solve the unknown vector, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>. If things were simple and all these variables were scalars, we would simply divide both sides by <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> and obtain the solution, <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span>, provided that <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span> is invertible. Note that we would multiply both sides by <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span> on the left to perform the division. This brings us to the first condition: the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, needs to have a corresponding inverse matrix; that is, it <span class="No-Break">is invertible.</span></p>&#13;
			<ol>&#13;
				<li><span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.9</em> illustrates the correspondence between simple scalar calculations in regular algebra and matrix manipulations in matrix algebra. Note that by definition of matrix inverse, we have <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">−</span><span class="_-----MathTools-_Math_Number">1</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold">I</span><span class="_-----MathTools-_Math_Operator">.</span><span class="_-----MathTools-_Math_Space"> </span>We used this result in the derivation. The identity matrix is special; any matrix multiplying an identity matrix will stay unchanged. Thus, we have <span class="_-----MathTools-_Math_Variable_v-bold-italic">I</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span>. Again, we assume the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, <span class="No-Break">is invertible:</span></li>&#13;
			</ol>&#13;
			<div>&#13;
				<div id="_idContainer147" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_009.jpg" alt="Figure 7.9 – Comparing scalar and matrix manipulations when solving the system of linear equations" width="1003" height="456"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.9 – Comparing scalar and matrix manipulations when solving the system of linear equations</p>&#13;
			<p>The second condition is that the <em class="italic">determinant</em> of the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, cannot be zero. The determinant is a summary measure of the size of the matrix; we will discuss this in more detail in the next chapter. The third condition is what we alluded to earlier: the rows and columns of the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, can form a <em class="italic">basis</em> for the corresponding row and column space. There should be no correlated rows or columns in the matrix. A basis of a vector space is a set of vectors that can uniquely generate all the other vectors in the same vector space via <span class="No-Break">linear combinations.</span></p>&#13;
			<p>In addition, we <a id="_idIndexMarker659"/>would need a somewhat trivial condition: when <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span><span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Number">0</span>, we have <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="No-Break"><span class="_-----MathTools-_Math_Number">0</span></span><span class="No-Break">.</span></p>&#13;
			<p>Computing the inverse and determinant of a matrix is straightforward in R. In the following code, we are calculating the inverse of the matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, using the <strong class="source-inline">solve()</strong> function and its determinant using the <span class="No-Break"><strong class="source-inline">det()</strong></span><span class="No-Break"> function:</span></p>&#13;
			<pre class="source-code">&#13;
&gt;&gt;&gt; solve(X)&#13;
     [,1] [,2]&#13;
[1,]   -2  1.5&#13;
[2,]    1 -0.5&#13;
&gt;&gt;&gt; det(X)&#13;
[1] -2</pre>			<p>The next chapter will touch on the matrix determinant, norm, trace, and other special properties in <span class="No-Break">more detail.</span></p>&#13;
			<p>Now that we can calculate the matrix inverse, let’s learn how to obtain the solution to the system of linear<a id="_idIndexMarker660"/> equations using the inverse of the input matrix, <span class="_-----MathTools-_Math_Variable_v-bold-italic">X</span>, and output, <span class="No-Break">vector </span><span class="No-Break"><span class="_-----MathTools-_Math_Variable_v-bold-italic">y</span></span><span class="No-Break">.</span></p>&#13;
			<h3>Exercise 7.10 – obtaining the unique solution to a system of linear equations</h3>&#13;
			<p>In this exercise, we will make use of the matrix inverse to obtain the solution to a system of <span class="No-Break">linear equations:</span></p>&#13;
			<ol>&#13;
				<li>Construct the <a id="_idIndexMarker661"/>input matrix, <strong class="source-inline">X</strong>, and output vector, <strong class="source-inline">y</strong>, based on the <span class="No-Break">previous example:</span><pre class="source-code">&#13;
X = matrix(c(1:4), nrow=2, ncol=2)&#13;
&gt;&gt;&gt; X&#13;
     [,1] [,2]&#13;
[1,]    1    3&#13;
[2,]    2    4&#13;
y = c(4, 6)&#13;
&gt;&gt;&gt; y&#13;
[1] 4 6</pre><p class="list-inset">Note that the data we chose here is based on the previous running example, where the solution to the unknown variables is <span class="_-----MathTools-_Math_Variable_v-bold-italic">w</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Base">[</span><span class="No-Break"><span class="_-----MathTools-_Math_Number">1,1</span></span><span class="No-Break"><span class="_-----MathTools-_Math_Base">]</span></span><span class="No-Break">.</span></p></li>				<li>Calculate the solution to the system of <span class="No-Break">linear equations:</span><pre class="source-code">&#13;
w_hat = solve(X) %*% y&#13;
&gt;&gt;&gt; w_hat&#13;
     [,1]&#13;
[1,]    1&#13;
[2,]    1</pre><p class="list-inset">As we can see, the solution, which can be called the coefficient vector, matches the true result exactly. We can also multiply the input matrix by this solution to obtain an estimated output and check whether it is the same as the given <span class="No-Break">output vector.</span></p></li>				<li>Calculate the output via matrix-vector multiplication between the input matrix and the estimated <span class="No-Break">coefficient vector:</span><pre class="source-code">&#13;
&gt;&gt;&gt; X %*% w_hat&#13;
     [,1]&#13;
[1,]    4&#13;
[2,]    6</pre><p class="list-inset">The result matches the given <span class="No-Break">output vector.</span></p></li>			</ol>&#13;
			<p>Solving a system of linear equations with a square input matrix is a simple setting. When working with real data, the input matrix will likely be non-square, with more rows or columns. When there are more rows than columns, we have a limited number of unknown variables that need to satisfy more equations. This is an <strong class="bold">overdetermined system</strong>. On the<a id="_idIndexMarker662"/> other hand, when there are more unknown variables to satisfy fewer equations, we have an <strong class="bold">underdetermined system</strong>. We will discuss these two situations in the <span class="No-Break">following section.</span></p>&#13;
			<h2 id="_idParaDest-144"><a id="_idTextAnchor147"/>Overdetermined and underdetermined systems of linear equations</h2>&#13;
			<p>The example<a id="_idIndexMarker663"/> we covered earlier, which consisted of<a id="_idIndexMarker664"/> two equations and two unknown variables to solve, gives a solution that passes through both lines on the coordinate system. This is<a id="_idIndexMarker665"/> called <strong class="bold">interpolation</strong>, where the solution perfectly satisfies both equations without any errors. In the language of machine learning, interpolation means the trained model can score 100% on the training dataset. This is not necessarily a good thing since the model will likely run into the risk of overfitting – that is, it will do pretty well on the training set but not so well on the <span class="No-Break">test set.</span></p>&#13;
			<p>Complex models such as neural networks and other nonlinear models tend to have very low or even zero training errors – that is, they are likely to interpolate the training data. The zero training cost occurs when the model becomes sufficiently complex to interpolate the training data. Perfect prediction in the training data is likely to happen when the number of coefficients, <span class="_-----MathTools-_Math_Variable">p</span>, used by the model is equal to or larger than the number of observations, <span class="_-----MathTools-_Math_Variable">n</span>, in the training input. In the case of linear regression, when <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">n</span>, we solve a system of linear equations where the number of free variables, whose optimal values we are solving for, is equal to the number of linear equations in <span class="No-Break">the system.</span></p>&#13;
			<p>A simple example is a two-dimensional training set with two observation points on a coordinate system, as we saw earlier. When only one parameter is available, the model is reflected as a straight horizontal line in the coordinate system. This univariate model is too simple to fit these two points unless they happen to live along the fitted line. The resulting system of equations is said to be overdetermined and under-parameterized since we have more linear equations than the unknown variables in <span class="No-Break">the system.</span></p>&#13;
			<p>When we have two parameters to fit the model, the problem can be solved with an exact solution: two linear equations and two unknowns, a straightforward exercise. We can fit a line anywhere in the coordinate system by adjusting its intercept and slope. So, the problem becomes fitting a line that passes through the two points. We can train a model that passes through the two points and produces zero training error, thus interpolating between these <span class="No-Break">two points.</span></p>&#13;
			<p>When there are <a id="_idIndexMarker666"/>more<a id="_idIndexMarker667"/> than two unknown variables – say we have three weights in the model – the problem becomes underdetermined and over-parameterized. The solution, when solvable, will be infinite. Having more than two parameters corresponds to fitting two points with a curved line. Any curve that passes through the two points produces zero training error, yet the curve can be arbitrarily wiggly and complex, depending on the number of parameters used. <span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.10</em> summarizes these <span class="No-Break">three scenarios:</span></p>&#13;
			<div>&#13;
				<div id="_idContainer148" class="IMG---Figure">&#13;
					<img src="Images/B18680_07_010.jpg" alt="Figure 7.10 – Three scenarios of model complexity" width="1649" height="614"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.10 – Three scenarios of model complexity</p>&#13;
			<p><span class="No-Break"><em class="italic">Figure 7</em></span><em class="italic">.10</em> shows fitting two two-dimensional observations using different model complexities. The left plot contains a 0<span class="superscript">th</span> degree polynomial model that contains only one parameter, thus being a horizontal line. The middle plot has an equal number of parameters to the number of observations, making the solution unique and exact. The right plot contains models with more than two parameters, where the solution is non-unique due to being an <span class="No-Break">underdetermined system.</span></p>&#13;
			<p>Perfect interpolation occurs when <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">=</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">n</span> – that is, the number of features is equal to the number of observations. The perfect interpolation continues with <span class="_-----MathTools-_Math_Variable">p</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Operator">&gt;</span><span class="_-----MathTools-_Math_Base"> </span><span class="_-----MathTools-_Math_Variable">n</span> when the system of <a id="_idIndexMarker668"/>equations <a id="_idIndexMarker669"/>becomes underdetermined and over-parameterized, leading to infinitely many solutions that correspond to models of an arbitrary shape. All these models pass through the observed data points and thus give zero <span class="No-Break">training error.</span></p>&#13;
			<h1 id="_idParaDest-145"><a id="_idTextAnchor148"/>Summary</h1>&#13;
			<p>In this chapter, we introduced the basics of linear algebra, including working with vectors and matrices and performing matrix-vector multiplication. We highlighted a few special matrices, such as the identity matrix, and common operations, such as transposing and inverting <span class="No-Break">a matrix.</span></p>&#13;
			<p>Next, we used matrix-vector multiplication to solve a system of linear equations under different settings. We introduced the geometric interpretation that corresponds to the system of linear equations, along with how to obtain the solution using matrix inverse and <span class="No-Break">multiplication operations.</span></p>&#13;
			<p>Lastly, we touched upon common settings of the input matrix in the machine learning context, covering both underdetermined and overdetermined systems. Developing such an understanding will be crucial when we delve into statistical modeling and machine learning in the third part of <span class="No-Break">this book.</span></p>&#13;
			<p>In the next chapter, we will discuss slightly more advanced concepts in matrix algebra and implementations <span class="No-Break">in R.</span></p>&#13;
		</div>&#13;
	</div></body></html>