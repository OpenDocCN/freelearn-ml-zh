- en: '*Chapter 8*: Anomaly Detection in Other Elastic Stack Apps'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When the first edition of this book was authored two years ago, there was no
    concept of other apps within the stack leveraging Elastic ML for domain-specific
    solutions. However, since then, Elastic ML has become a **provider** of anomaly
    detection for domain-specific solutions, providing tailor-made job configurations
    that users can enable with a single click.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will explore what Elastic ML brings to various Elastic
    Stack apps:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Anomaly detection in Elastic APM
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection in the Logs app
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection in the Metrics app
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection in the Uptime app
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection in the Elastic Security app
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The information in this chapter is relevant as of v7.12 of the Elastic Stack.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Anomaly detection in Elastic APM
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Elastic APM takes application monitoring and performance management to a whole
    new level by allowing users to instrument their application code to get deep insights
    into the performance of individual microservices and transactions. In complex
    environments, this could generate a large number of measurements and poses a potentially
    paradoxical situation – one in which greater observability is obtained via this
    detailed level of measurement while possibly overwhelming the analyst who has
    to sift through the results for actionable insights.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: Fortunately, Elastic APM and Elastic ML are a match made in heaven. Anomaly
    detection not only automatically adapts to the unique performance characteristics
    of each transaction type via unsupervised machine learning, but it can also scale
    to handle the possibly voluminous amounts of data that APM can generate.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: While the user is always free to create anomaly detection jobs against any kind
    of time-series data in any index, regardless of type, there is a compelling argument
    to simply provide pre-made, out-of-the-box job configurations on Elastic APM data,
    since the data format is already known.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Enabling anomaly detection for APM
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In order to take advantage of anomaly detection with your APM data, you need
    to obviously have some APM data collected for some declared services, and to have
    the data collected to be stored in indices accessible via the `apm-*` index pattern:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: If you have not yet set up anomaly detection on your APM data, you will see
    an indicator at the top of the screen letting you know that it still needs to
    be set up:![Figure 8.1 – An indicator for when anomaly detection is not yet enabled
    on APM
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '](img/B17040_08_1.jpg)'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Figure 8.1 – An indicator for when anomaly detection is not yet enabled on APM
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: To demonstrate what the configuration of anomaly detection would look like,
    a trivial *Hello World* Node.js application was created and instrumented with
    Elastic APM. This application (called *myapp*) was also tagged with the `environment`
    tag of `dev` to signify that the application is a development app (this is all
    done within the APM agent for the Node.js configuration):![Figure 8.2 – Sample
    Node.js app instrumented with Elastic APM
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了展示异常检测配置将如何，创建了一个简单的*Hello World* Node.js应用程序，并使用Elastic APM进行了配置。此应用程序（称为*myapp*）还标记了`environment`标签为`dev`，以表示该应用程序是开发应用程序（所有这些都是在Node.js配置的APM代理内完成的）：![图8.2
    – 使用Elastic APM进行配置的示例Node.js应用
- en: '](img/B17040_08_2.jpg)'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_2.jpg)'
- en: Figure 8.2 – Sample Node.js app instrumented with Elastic APM
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.2 – 使用Elastic APM进行配置的示例Node.js应用
- en: When viewed inside of Elastic APM, the service will look as follows:![Figure
    8.3 – Sample Node.js app viewed in the Elastic APM UI
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Elastic APM内部查看时，服务将如下所示：![图8.3 – 在Elastic APM UI中查看的示例Node.js应用
- en: '](img/B17040_08_3.jpg)'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_3.jpg)'
- en: Figure 8.3 – Sample Node.js app viewed in the Elastic APM UI
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.3 – 在Elastic APM UI中查看的示例Node.js应用
- en: To enable anomaly detection on this service, simply go to **Settings**, click
    on **Anomaly detection**, and then click on the **Create ML Job** button:![Figure
    8.4 – Creating ML jobs for APM data
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启用此服务的异常检测，只需转到**设置**，点击**异常检测**，然后点击**创建ML作业**按钮：![图8.4 – 为APM数据创建ML作业
- en: '](img/B17040_08_4.jpg)'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_4.jpg)'
- en: Figure 8.4 – Creating ML jobs for APM data
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.4 – 为APM数据创建ML作业
- en: Next, specify the environment name that you want to build the job for:![Figure
    8.5 – Specifying the environment to build the ML job for
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，指定您想要为该作业构建的环境名称：![图8.5 – 指定构建ML作业的环境
- en: '](img/B17040_08_5.jpg)'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_5.jpg)'
- en: Figure 8.5 – Specifying the environment to build the ML job for
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.5 – 指定构建ML作业的环境
- en: Here we will select **dev** as it is the only choice available for our application.
    Once selected and after clicking the **Create Jobs** button, we get confirmation
    that our job was created, and it is listed in the table:![Figure 8.6 – Listing
    of created anomaly detection jobs in APM
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，我们将选择**dev**，因为它是我们应用唯一可用的选项。一旦选择并点击**创建作业**按钮，我们将收到确认我们的作业已创建，并在表中列出：![图8.6
    – APM中创建的异常检测作业列表
- en: '](img/B17040_08_6.jpg)'
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_6.jpg)'
- en: Figure 8.6 – Listing of created anomaly detection jobs in APM
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.6 – APM中创建的异常检测作业列表
- en: If we go to the Elastic ML app to see the details of the job that was created
    for us, we will see the following:![Figure 8.7 – Listing of created anomaly detection
    jobs in ML
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们转到Elastic ML应用，查看为我们创建的作业的详细信息，我们将看到以下内容：![图8.7 – ML中创建的异常检测作业列表
- en: '](img/B17040_08_7.jpg)'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_7.jpg)'
- en: Figure 8.7 – Listing of created anomaly detection jobs in ML
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.7 – ML中创建的异常检测作业列表
- en: Inspecting this further, we can see that the actual detector configuration for
    the job is the following:![Figure 8.8 – Detector configuration for the APM job
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进一步检查，我们可以看到作业的实际检测器配置如下：![图8.8 – APM作业的检测器配置
- en: '](img/B17040_08_8.jpg)'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17040_08_8.jpg)'
- en: Figure 8.8 – Detector configuration for the APM job
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.8 – APM作业的检测器配置
- en: Notice that this leverages the `high_mean` function on the `transaction.duration.us`
    field, split both on `transaction.type` and partitioned on `service.name`. Also
    notice that the `bucket_span` value of the job is 15 minutes, which may or may
    not be the ideal setting for your environment.
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这利用了`transaction.duration.us`字段上的`high_mean`函数，同时在`transaction.type`上分割，并在`service.name`上分区。同时注意，作业的`bucket_span`值为15分钟，这可能或可能不是您环境的理想设置。
- en: Note
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: It should be noted that this configuration is the only one possible when using
    this one-click approach from the APM UI, as the configuration is hardcoded. If
    you want to customize or create your own configurations, you could either create
    them from scratch or possibly clone this job and set your own bucket span and/or
    detector logic.
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 应该注意的是，当使用APM UI的此一键方法时，此配置是唯一可能的，因为配置是硬编码的。如果您想自定义或创建自己的配置，您可以从头创建它们，或者可能克隆此作业并设置自己的桶跨度以及/或检测逻辑。
- en: 'From the perspective of the data that is being queried, we can click on the
    `"service.environment" : "dev"` as we indicated when setting up the job in the
    APM UI.'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '从查询的数据视角来看，我们可以点击我们在APM UI设置作业时指示的`"service.environment" : "dev"`。'
- en: 'We can click on the **Datafeed preview** tab to see a sample of the observations
    that will be fed to Elastic ML for this particular job, as shown in the following
    figure:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以点击**数据源预览**选项卡来查看将馈送到 Elastic ML 的此特定作业的观测样本，如图所示：
- en: '![Figure 8.10 – Datafeed preview for the APM job'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.10 – APM 作业的数据源预览'
- en: '](img/B17040_08_10..jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_10..jpg)'
- en: Figure 8.10 – Datafeed preview for the APM job
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.10 – APM 作业的数据源预览
- en: Now that the APM job is configured and running, let's turn our focus to where
    within the APM UI the anomaly detection job's results will be reflected.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 现在APM作业已配置并运行，让我们关注在APM UI中异常检测作业结果将如何反映。
- en: Viewing the anomaly detection job results in the APM UI
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 APM UI 中查看异常检测作业结果
- en: 'In addition to viewing the job results in the Elastic ML UI, there are three
    key places in which the results of anomaly detection jobs are manifested in the
    APM UI:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 除了在 Elastic ML UI 中查看作业结果外，还有三个关键位置在 APM UI 中显示了异常检测作业的结果：
- en: '**Services overview**: This view in the APM UI gives a high-level health indicator
    that corresponds to the max anomaly score of the anomaly detection results for
    that particular service:'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务概览**：APM UI 中的此视图提供了一个高级健康指标，对应于特定服务的异常检测结果的最高异常分数：'
- en: '![Figure 8.11 – Services overview in the APM UI'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.11 – APM UI 中的服务概览'
- en: '](img/B17040_08_11..jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_11..jpg)'
- en: Figure 8.11 – Services overview in the APM UI
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.11 – APM UI 中的服务概览
- en: '**Service map**: This dynamic view shows application transaction dependencies,
    with a color-coded anomaly indicator based on the max anomaly score of the anomaly
    detection results for that particular service:'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务图**：这个动态视图显示了应用程序事务依赖关系，基于特定服务的异常检测结果的最高异常分数进行颜色编码的异常指示器：'
- en: '![Figure 8.12 – Service map in the APM UI'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.12 – APM UI 中的服务图'
- en: '](img/B17040_08_12..jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_12..jpg)'
- en: Figure 8.12 – Service map in the APM UI
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.12 – APM UI 中的服务图
- en: '**Transaction duration chart**: This chart, under the main **Transactions**
    view in APM, shows the expected bounds and a colored annotation when the anomaly
    score is over 75 for a particular transaction type:'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事务持续时间图表**：此图表位于APM中的主要**事务**视图下，当特定事务类型的异常分数超过75时，显示预期的边界和彩色注释：'
- en: '![Figure 8.13 – Transaction duration chart in the APM UI'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 8.13 – APM UI 中的事务持续时间图表'
- en: '](img/B17040_08_13..jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_13..jpg)'
- en: Figure 8.13 – Transaction duration chart in the APM UI
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.13 – APM UI 中的事务持续时间图表
- en: These helpful indicators of anomalousness guide the user to investigate further
    and troubleshoot problems using the deep capabilities of the APM and ML UIs. Let's
    see one more way to integrate Elastic ML with data from APM, using the **data
    recognizer**.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 这些异常性指示器有助于用户进一步调查并使用 APM 和 ML UI 的深度功能来解决问题。让我们看看一种将 Elastic ML 与 APM 数据集成的更多方法，使用
    **数据识别器**。
- en: Creating ML Jobs via the data recognizer
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通过数据识别器创建 ML 作业
- en: While "the data recognizer" isn't an official marketing name of an actual feature
    in Elastic ML, it can in fact be very helpful in assisting the user to create
    pre-configured jobs for data that is *recognized*.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然“数据识别器”不是 Elastic ML 中实际功能的官方营销名称，但它实际上在帮助用户为已识别的数据创建预配置作业时非常有帮助。
- en: Note
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'Pre-configured jobs for the data recognizer are defined and stored in the following
    GitHub repository: [https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules](https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules).'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 预配置的数据识别器作业定义和存储在以下 GitHub 仓库中：[https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules](https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules)。
- en: 'Essentially, the workflow for creating a new job using the recognizer is as
    follows:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，使用识别器创建新作业的工作流程如下：
- en: 'If, during the process of creating an anomaly detection job, the data selected
    for the job''s input (index pattern or saved search) matches search patterns known
    to one of the pre-defined recognizer modules, then you can offer the user the
    ability to create one of those pre-defined jobs. We can see an example of this
    using the trivial Node.js example from earlier in this chapter. Instead of creating
    the anomaly detection job from the APM UI, we can instead go through the Elastic
    ML UI and select the `apm-*` index pattern:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在创建异常检测作业的过程中，为作业输入（索引模式或保存的搜索）选择的数据与预定义识别模块之一已知搜索模式匹配，那么你可以向用户提供创建这些预定义作业之一的能力。我们可以通过使用本章早期提到的简单Node.js示例来查看这个示例。我们不是从APM
    UI创建异常检测作业，而是通过Elastic ML UI选择`apm-*`索引模式：
- en: 'By selecting the index pattern, we will see two preconfigured jobs offered
    to us in addition to the normal job wizards:'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过选择索引模式，我们将看到除了正常作业向导外，我们还提供了两个预配置的作业：
- en: '![Figure 8.14 – Jobs offered from the data recognizer'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.14 – 数据识别器提供的职位'
- en: '](img/B17040_08_14..jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_14..jpg]'
- en: Figure 8.14 – Jobs offered from the data recognizer
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.14 – 数据识别器提供的职位
- en: 'The first "APM" job is the same type of job we already created earlier in this
    chapter from the APM UI. The second option (**APM**: **Node.js**) is actually
    a collection of three jobs:'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个“APM”作业与我们本章早期从APM UI创建的作业类型相同。第二个选项（**APM**：**Node.js**）实际上是一个包含三个作业的集合：
- en: '![Figure 8.15 – Node.js jobs offered from the data recognizer'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.15 – 数据识别器提供的Node.js作业'
- en: '](img/B17040_08_15..jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_15..jpg]'
- en: Figure 8.15 – Node.js jobs offered from the data recognizer
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.15 – 数据识别器提供的Node.js作业
- en: The third is, yet again, the same type of job we already created earlier in
    this chapter from the APM UI, but the other two are unique. This notion of offering
    the users suggested jobs if the source data is "recognized" is not unique to APM
    data and you may see those suggested jobs in other situations or use cases (such
    as choosing the indices of the sample Kibana data, data from nginx, and so on).
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三个是，再次，与我们本章早期从APM UI创建的相同类型的职位，但其他两个是独特的。如果源数据被“识别”，向用户提供建议性职位这一概念并不仅限于APM数据，你可能在其他情况或用例（如选择样本Kibana数据的索引、nginx数据等）中看到这些建议性职位。
- en: Now that we've seen how Elastic ML is be embedded into the APM app, let's keep
    exploring to find out how anomaly detection is leveraged by the Logs app.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看到了Elastic ML是如何嵌入到APM应用中的，让我们继续探索，以了解异常检测是如何在日志应用中被利用的。
- en: Anomaly detection in the Logs app
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 日志应用中的异常检测
- en: 'The Logs app inside of the **Observability** section of Kibana offers a similar
    view of your data as the Discover app. However, the users who appreciate more
    of a *live tail* view of their logs, regardless of the index the data is stored,
    will love the Logs app:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: Kibana中的**可观察性**部分内的日志应用提供了与Discover应用类似的数据视图。然而，对于那些更喜欢查看日志的**实时尾部**视图的用户，无论数据存储在哪个索引中，都会喜欢日志应用：
- en: '![Figure 8.16 – The Logs app, part of the Observability section of Kibana'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 8.16 – Kibana的可观察性部分中的日志应用'
- en: '](img/B17040_08_16..jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_16..jpg]'
- en: Figure 8.16 – The Logs app, part of the Observability section of Kibana
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.16 – Kibana的可观察性部分中的日志应用
- en: Notice that there is both an **Anomalies** tab and a **Categories** tab. Let's
    first discuss the **Categories** section.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这里既有**异常**标签页，也有**类别**标签页。让我们首先讨论**类别**部分。
- en: Log categories
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志类别
- en: Elastic ML's categorization capabilities, first shown back in [*Chapter 3*](B17040_03_Epub_AM.xhtml#_idTextAnchor049)*,
    Anomaly Detection*, are applied in a generic way to any index of unstructured
    log data. Within the Logs app, however, categorization is employed with some more
    strict constraints on the data. In short, the data is expected to be in `event.dataset`).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic ML的分类能力，最早在[*第3章*](B17040_03_Epub_AM.xhtml#_idTextAnchor049)*，异常检测*中展示，以通用方式应用于任何非结构化日志数据的索引。然而，在日志应用中，分类使用了一些对数据更严格的约束。简而言之，数据预期位于`event.dataset`中）。
- en: Note
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The logs dataset from [*Chapter 7*](B17040_07_Epub_AM.xhtml#_idTextAnchor131)*,
    AIOps and Root Cause Analysis*, is duplicated for this chapter in the GitHub repository
    for use with the Logs app, with the addition of the `event.dataset` field. If
    you're importing via the file upload facility in ML, be sure to override the field
    name to be `event.dataset` instead of the default `event_dataset` that will be
    offered.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 来自[*第7章*](B17040_07_Epub_AM.xhtml#_idTextAnchor131)*，AIOps和根本原因分析*的日志数据集在此章节的GitHub仓库中进行了复制，用于与Logs应用一起使用，并增加了`event.dataset`字段。如果您通过ML中的文件上传功能导入，请确保将字段名称覆盖为`event.dataset`，而不是默认的`event_dataset`。
- en: One can imagine the reason behind this constraint, given that the Logs app is
    trying to create the categorization job for you in a templated way. Therefore,
    it needs to be certain of the naming convention of the fields. This would obviously
    not be the case if this were to be done in the ML app, where the onus is on the
    user to declare the names of the categorization field and the message field.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 可以想象出这种限制背后的原因，因为Logs应用正在尝试以模板化的方式为您创建分类作业。因此，它需要确定字段的命名约定。如果这要在ML应用中完成，那么情况显然不会是这样，在那里用户负责声明分类字段和消息字段的名称。
- en: 'If you do, however, configure the Logs app to invoke categorization, then the
    output of this will look something like the following figure, which shows each
    distinct log category, sorted by the maximum anomaly score:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您配置Logs应用以调用分类，那么输出将类似于以下图示，它显示了每个不同的日志类别，按最大异常分数排序：
- en: '![Figure 8.17 – The Logs app displaying categorization results from Elastic
    ML'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.17 – Logs应用显示Elastic ML的分类结果'
- en: '](img/B17040_08_17..jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_17..jpg)'
- en: Figure 8.17 – The Logs app displaying categorization results from Elastic ML
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.17 – Logs应用显示Elastic ML的分类结果
- en: Users can then click the **Analyze in ML** button to navigate over to the Anomaly
    Explorer in the ML UI for further inspection.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以点击**在ML中分析**按钮，导航到ML UI中的异常检测器进行进一步检查。
- en: Log anomalies
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志异常
- en: 'The **Anomalies** section of the Logs app provides a view similar to that of
    the Anomaly Explorer:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Logs应用的**异常**部分提供了一个类似于异常检测器的视图：
- en: '![Figure 8.18 – The Logs app displaying a view similar to ML''s Anomaly Explorer'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.18 – Logs应用显示类似于ML异常检测器的视图'
- en: '](img/B17040_08_18..jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_18..jpg)'
- en: Figure 8.18 – The Logs app displaying a view similar to ML's Anomaly Explorer
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.18 – Logs应用显示类似于ML异常检测器的视图
- en: 'It also allows the user to manage the anomaly detection jobs if the **Manage
    ML jobs** button is clicked:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户点击**管理ML作业**按钮，它还允许用户管理异常检测作业：
- en: '![Figure 8.19 – The Logs app allowing the management of ML jobs'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.19 – Logs应用允许管理ML作业'
- en: '](img/B17040_08_19..jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_19..jpg)'
- en: Figure 8.19 – The Logs app allowing the management of ML jobs
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.19 – Logs应用允许管理ML作业
- en: The `count` detector, partitioned on the `event.dataset` field.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '`count`检测器，按`event.dataset`字段分区。'
- en: Users should note that these ML jobs can be recreated here, but not permanently
    deleted – you must go to the anomaly detection job management page in the ML app
    to delete the jobs.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 用户应注意，这些ML作业可以在此处重新创建，但不能永久删除 – 您必须转到ML应用中的异常检测作业管理页面来删除作业。
- en: Obviously, an expert user might just resort to creating and managing their anomaly
    detection jobs for their logs within the ML app. But it is nice that the Logs
    app does surface Elastic ML's capabilities in a way that makes the functionality
    obvious and easy to implement. Let's continue this trend to see how Elastic ML
    is utilized in the Metrics app.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，一个高级用户可能会仅仅在ML应用中创建和管理他们的日志异常检测作业。但很棒的是，Logs应用以一种使功能明显且易于实施的方式展示了Elastic
    ML的能力。让我们继续这一趋势，看看Elastic ML在Metrics应用中的使用情况。
- en: Anomaly detection in the Metrics app
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Metrics应用中的异常检测
- en: 'The Metrics app, also part of the **Observability** section of Kibana, allows
    users to have an inventory and metrics-driven view of their data:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: Metrics应用也是Kibana中**可观察性**部分的组成部分，它允许用户以库存和指标驱动的视图查看他们的数据：
- en: 'In the **Inventory** view, users see an overall map of monitored resources.
    Entities such as hosts, pods, or containers can be organized and filtered to customize
    the view – including a color-coded health scale as shown in the following figure:'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在**库存**视图中，用户可以看到监控资源的整体地图。实体，如主机、Pod或容器，可以组织并筛选以自定义视图 – 包括以下图示中的颜色编码健康量表：
- en: '![Figure 8.20 – The Metrics app showing the Inventory view'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.20 – Metrics应用显示库存视图'
- en: '](img/B17040_08_20..jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17040_08_20..jpg)'
- en: Figure 8.20 – The Metrics app showing the Inventory view
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.20 – 指标应用显示库存视图
- en: Notice that the bottom panel would display anomalies, if detected. This is currently
    the only place to view anomalies within the Metrics app.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，如果检测到异常，底部面板将显示异常。这是目前在指标应用中查看异常的唯一位置。
- en: 'To enable the built-in anomaly detection jobs via the Metrics app, click the
    **Anomaly detection** button at the top to enable the configuration flyout:'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要通过指标应用启用内置的异常检测作业，请点击顶部的**异常检测**按钮以启用配置飞出窗口：
- en: '![Figure 8.21 – The Metrics app showing the management of anomaly detection
    jobs'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.21 – 指标应用显示异常检测作业的管理'
- en: '](img/B17040_08_21..jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_21..jpg]'
- en: Figure 8.21 – The Metrics app showing the management of anomaly detection jobs
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.21 – 指标应用显示异常检测作业的管理
- en: 'If, for example, we choose to enable anomaly detection for hosts, clicking
    the appropriate **Enable** button will show this:'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如，如果我们选择为主机启用异常检测，点击相应的**启用**按钮将显示此内容：
- en: '![Figure 8.22 – The Metrics app showing the config of anomaly detection on
    hosts'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.22 – 指标应用显示主机上的异常检测配置'
- en: '](img/B17040_08_22..jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_22..jpg]'
- en: Figure 8.22 – The Metrics app showing the config of anomaly detection on hosts
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.22 – 指标应用显示主机上的异常检测配置
- en: 'Notice that a partition field is offered as part of the configuration, if desired.
    When you click the **Enable jobs** button, three different anomaly detection jobs
    are created for you on your behalf, viewable in Elastic ML''s **Job** **Management**
    section:'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注意，如果需要，配置中会提供分区字段。当你点击**启用作业**按钮时，会为你创建三个不同的异常检测作业，你可以在Elastic ML的**作业管理**部分查看：
- en: '![Figure 8.23 – The anomaly detection jobs for hosts created by the Metrics
    app'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.23 – 指标应用创建的主机异常检测作业'
- en: '](img/B17040_08_23..jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_23..jpg]'
- en: Figure 8.23 – The anomaly detection jobs for hosts created by the Metrics app
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.23 – 指标应用创建的主机异常检测作业
- en: 'To set the minimum anomaly score required to have the Metrics app display anomalies
    for you, head on over to the **Settings** tab and configure the **Anomaly Severity
    Threshold** setting:'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要设置指标应用显示异常所需的最小异常分数，请转到**设置**选项卡并配置**异常严重程度阈值**设置：
- en: '![Figure 8.24 – The Anomaly Severity Threshold setting within the Metrics app'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.24 – 指标应用中的异常严重程度阈值设置'
- en: '](img/B17040_08_24..jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_24..jpg]'
- en: Figure 8.24 – The Anomaly Severity Threshold setting within the Metrics app
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.24 – 指标应用中的异常严重程度阈值设置
- en: The Elastic ML integration with the Metrics app is quite simple and straightforward
    – it allows the user to quickly get started using anomaly detection on their metric
    data. Let's now take a quick look at the integration in the Uptime app.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic ML与指标应用的集成非常简单直接 – 它允许用户快速开始使用异常检测来处理他们的指标数据。现在让我们快速看一下Uptime应用中的集成。
- en: Anomaly detection in the Uptime app
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Uptime应用中的异常检测
- en: 'The Uptime app allows simple availability and response time monitoring of services
    via a variety of network protocols, including **HTTP/S**, **TCP**, and **ICMP**:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: Uptime应用允许通过多种网络协议（包括**HTTP/S**、**TCP**和**ICMP**）对服务的简单可用性和响应时间进行监控：
- en: Often classified as *synthetic monitoring*, the Uptime app uses Heartbeat to
    actively probe network endpoints from one or more locations:![Figure 8.25 – The
    Uptime app in Kibana
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通常被归类为**合成监控**，Uptime应用使用心跳从一个或多个位置主动探测网络端点：![图8.25 – Kibana中的Uptime应用
- en: '](img/B17040_08_25..jpg)'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![img/B17040_08_25..jpg]'
- en: Figure 8.25 – The Uptime app in Kibana
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.25 – Kibana中的Uptime应用
- en: If you would like to enable anomaly detection on a monitor, simply click on
    the monitor name to see the monitor detail. Within the **Monitor duration** panel,
    notice the **Enable anomaly detection** button:![Figure 8.26 – Enabling anomaly
    detection for an Uptime monitor
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你想要在监控器上启用异常检测，只需点击监控器名称以查看监控器详细信息。在**监控持续时间**面板中，注意**启用异常检测**按钮：![图8.26 –
    启用Uptime监控器的异常检测
- en: '](img/B17040_08_26..jpg)'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![img/B17040_08_26..jpg]'
- en: Figure 8.26 – Enabling anomaly detection for an Uptime monitor
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.26 – 启用Uptime监控器的异常检测
- en: Clicking on the **Enable anomaly detection** button creates the job in the background
    and offers the user the option to create an alert for anomalies surfaced by the
    job:![Figure 8.27 – Creating an alert on the anomaly detection job in the Uptime
    app
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**启用异常检测**按钮将在后台创建作业，并允许用户为作业中出现的异常创建警报：![图8.27 – 在Uptime应用中创建异常检测作业的警报
- en: '](img/B17040_08_27..jpg)'
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![img/B17040_08_27..jpg]'
- en: Figure 8.27 – Creating an alert on the anomaly detection job in the Uptime app
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图8.27 – 在Uptime应用中创建异常检测作业的警报
- en: 'Once the anomaly detection job is available, any anomalies discovered will
    also be displayed within the monitor''s detail page in the **Monitor duration**
    panel:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦异常检测作业可用，发现的任何异常也将显示在监控器的详细页面中的**监控持续时间**面板内：
- en: '![Figure 8.28 – Anomalies displayed in the Uptime app'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.28 – Uptime应用中显示的异常]'
- en: '](img/B17040_08_28..jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B17040_08_28..jpg)'
- en: Figure 8.28 – Anomalies displayed in the Uptime app
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.28 – Uptime应用中显示的异常
- en: Again, the integration of Elastic ML with another one of the **Observability**
    applications in the stack makes it incredibly easy for users to take advantage
    of sophisticated anomaly detection. But we also know that Elastic ML can do some
    interesting things with respect to population and rare analysis. The integration
    of ML with the Elastic SIEM is in store for you in the next section – let's get
    detecting!
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，Elastic ML与堆栈中另一个**可观察性**应用的集成使得用户利用复杂的异常检测变得极其简单。但我们也知道，Elastic ML在人口和罕见分析方面也能做一些有趣的事情。下一节将介绍ML与Elastic
    SIEM的集成——让我们开始检测吧！
- en: Anomaly detection in the Elastic Security app
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Elastic Security应用中的异常检测
- en: Elastic Security is truly the quintessence of a purpose-driven application in
    the Elastic Stack. Created from the ground up with the security analyst's workflow
    in mind, the comprehensiveness of the Elastic Security app could fill an entire
    book on its own. However, the heart of the Elastic Security app is the Detections
    feature in which user- and Elastic-created rules execute to create alerts when
    rules' conditions are met. As we'll see, Elastic ML plays a significant role in
    the Detections feature.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic Security确实是Elastic Stack中一个以目标为导向的应用的精髓。从头开始创建，考虑到安全分析师的工作流程，Elastic
    Security应用的全面性足以填满一本整本书。然而，Elastic Security应用的核心是检测功能，其中用户和Elastic创建的规则在满足规则条件时执行以创建警报。正如我们将看到的，Elastic
    ML在检测功能中发挥着重要作用。
- en: Prebuilt anomaly detection jobs
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预构建的异常检测作业
- en: 'The majority of the detection rules in Elastic Security are static, but many
    are backed by prebuilt anomaly detection jobs that operate on the data collected
    from Elastic Agent or Beats, or equivalent data that conforms with the ECS fields
    that are applicable for each job type. To see a comprehensive list of anomaly
    detection jobs supplied by Elastic, view the datafeed and job configuration definition
    in the `security_*` and `siem_*` folders in the following GitHub repository: [https://github.com/elastic/kibana/tree/7.12/x-pack/plugins/ml/server/models/data_recognizer/modules](https://github.com/elastic/kibana/tree/7.12/x-pack/plugins/ml/server/models/data_recognizer/modules).'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic Security中的大多数检测规则是静态的，但许多规则背后是由预构建的异常检测作业支持的，这些作业在Elastic Agent或Beats收集的数据上运行，或者符合适用于每种作业类型的应用ECS字段的数据。要查看Elastic提供的异常检测作业的完整列表，请查看以下GitHub仓库中的数据源和作业配置定义：[https://github.com/elastic/kibana/tree/7.12/x-pack/plugins/ml/server/models/data_recognizer/modules](https://github.com/elastic/kibana/tree/7.12/x-pack/plugins/ml/server/models/data_recognizer/modules)。
- en: (You can add the latest release version number in the spot currently occupied
    by 7.12.)
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: （您可以在目前占据7.12版本号的空白处添加最新发布版本号。）
- en: An astute reader will notice that many of the prebuilt jobs leverage either
    population analysis or the rare detector. Each of these styles of anomaly detection
    is well aligned with the goals of the security analyst – where finding novel behaviors
    and/or behaviors that make users or entities different from the crowd is often
    linked to an indicator of compromise.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 精明的读者会注意到，许多预构建的作业利用了人口分析或罕见检测器。这些异常检测风格与安全分析师的目标非常一致——找到新颖的行为和/或使用户或实体与众不同的行为，通常与入侵指标有关。
- en: 'The prebuilt anomaly detection jobs are viewable in the **Detections** tab
    of Elastic Security and have the ML tag:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 预构建的异常检测作业可在Elastic Security的**检测**标签页中查看，并带有ML标签：
- en: '![Figure 8.29 – ML jobs in the Detection rules section of the Security app'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.29 – 安全应用检测规则部分的ML作业]'
- en: '](img/B17040_08_29..jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](img/B17040_08_29..jpg)'
- en: Figure 8.29 – ML jobs in the Detection rules section of the Security app
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.29 – 安全应用检测规则部分的ML作业
- en: 'Clicking on **ML job settings** at the top right of the screen will expose
    the settings list, where the user can see all of the jobs in the library – even
    the ones that are not available (marked with a warning icon):'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 点击屏幕右上角的**ML作业设置**将显示设置列表，用户可以查看库中的所有作业 – 即使是那些不可用的作业（用警告图标标记）：
- en: '![Figure 8.30 – All jobs in the ML job settings section of the Security app'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.30 – 安全应用中ML作业设置部分的全部作业'
- en: '](img/B17040_08_30..jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_30..jpg](img/B17040_08_30..jpg)'
- en: Figure 8.30 – All jobs in the ML job settings section of the Security app
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.30 – 安全应用中ML作业设置部分的全部作业
- en: 'Jobs are marked as unavailable if the necessary data for the job to use is
    not currently indexed in Elasticsearch. If the job is available, you can activate
    the job by clicking the toggle switch and the anomaly detection job will be provisioned
    in the background. Of course, you can always view the jobs created in the Elastic
    ML **Job** **Management** UI:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 如果作业所需的数据尚未在Elasticsearch中索引，作业将被标记为不可用。如果作业可用，您可以通过点击切换开关来激活作业，异常检测作业将在后台配置。当然，您始终可以查看在Elastic
    ML **作业** **管理** UI中创建的作业：
- en: '![Figure 8.31 – Elastic ML jobs created by Security as a view in the Job Management
    UI'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.31 – 安全作为作业管理UI中的视图创建的Elastic ML作业'
- en: '](img/B17040_08_31..jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_31..jpg](img/B17040_08_31..jpg)'
- en: Figure 8.31 – Elastic ML jobs created by Security as a view in the Job Management
    UI
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.31 – 安全作为作业管理UI中的视图创建的Elastic ML作业
- en: Now that we know how to enable anomaly detection jobs, it is time to see how
    they create detection alerts for the Security app.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道了如何启用异常检测作业，是时候看看它们如何为安全应用创建检测警报了。
- en: Anomaly detection jobs as detection alerts
  id: totrans-167
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常检测作业作为检测警报
- en: 'As we return to the **Detections** view shown back in *Figure 8.28*, if you
    click on the **Create new rule** button, we can see that we can select **Machine
    Learning** as the rule type:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们回到*图8.28*中显示的**检测**视图时，如果您点击**创建新规则**按钮，我们可以看到我们可以选择**机器学习**作为规则类型：
- en: '![Figure 8.32 – Creating an ML-based detection rule'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.32 – 创建基于ML的检测规则'
- en: '](img/B17040_08_32..jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_32..jpg](img/B17040_08_32..jpg)'
- en: Figure 8.32 – Creating an ML-based detection rule
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.32 – 创建基于ML的检测规则
- en: 'If you were to select a specific machine learning job using the drop-down list,
    you would also be asked to select the **Anomaly score threshold** value that needs
    to be exceeded to trigger the detection alert:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您要通过下拉列表选择特定的机器学习作业，您还将被要求选择需要超过以触发检测警报的**异常分数阈值**值：
- en: '![Figure 8.33 – Selecting the ML job and score threshold for the detection
    rule'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '![图8.33 – 选择检测规则的ML作业和分数阈值'
- en: '](img/B17040_08_33.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '![img/B17040_08_33.jpg](img/B17040_08_33.jpg)'
- en: Figure 8.33 – Selecting the ML job and score threshold for the detection rule
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.33 – 选择检测规则的ML作业和分数阈值
- en: Obviously, if the job is not currently running, a warning will indicate that
    the job needs to be started. It is also notable that if you created your own custom
    job (that is, not using one of the prebuilt jobs) but assigned it to a **Job Group**
    called "security" in the Elastic ML app, that custom job would also be a candidate
    to be chosen within the drop-down box in this view. The remainder of the detection
    rule configuration can be left to the reader – as the rest is not specific to
    machine learning.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，如果作业当前没有运行，警告将指示需要启动作业。值得注意的是，如果您创建了自己的自定义作业（即，不是使用预构建的作业），但在Elastic ML应用中将它分配给名为“安全”的**作业组**，那么这个自定义作业也将是此视图中下拉框中可选的候选之一。检测规则配置的其余部分可以留给读者
    – 因为其余部分并不特定于机器学习。
- en: The Elastic Security app clearly relies heavily on anomaly detection to augment
    traditional static rules with dynamic, user/entity behavioral analysis that can
    surface notable events that are often worthy of investigation. It will be interesting
    to see how far and how broadly the machine learning capabilities continue to bolster
    this emerging use case as time goes on!
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic Security应用显然严重依赖异常检测来增强传统的静态规则，通过动态的用户/实体行为分析揭示值得调查的显著事件。随着时间的推移，将很有趣地看到机器学习功能如何继续加强这一新兴用例，以及其影响的深度和广度！
- en: Summary
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Elastic ML has clearly infiltrated many of the other apps in the Elastic Stack,
    bringing easy-to-use functionality to users' fingertips. This proves how much
    Elastic ML is really a core functionality to the Stack itself, akin to other key
    stack features such as aggregations.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: Elastic ML显然已经渗透到Elastic Stack中的许多其他应用中，将易于使用的功能带到了用户的手指之间。这证明了Elastic ML确实是堆栈本身的核心功能，类似于其他关键堆栈功能，如聚合。
- en: Congratulations, you have reached the end of the first half of this book, and
    hopefully you feel well armed with everything that you need to know about Elastic
    ML's anomaly detection.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜你，你已经到达了这本书第一部分的终点，希望你现在感觉武装到了牙齿，拥有了关于Elastic ML异常检测所需的所有知识。
- en: Now, we will venture into the "*other side"* of Elastic ML – data frame analytics
    – where you will learn how to bring other machine learning techniques (including
    supervised-based model creation and inferencing) to open up analytical solutions
    to a vast new array of use cases.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将探索Elastic ML的“另一面”——数据帧分析——在这里，你将学习如何将其他机器学习技术（包括基于监督的模型创建和推理）应用到广泛的用例中，以开启新的分析解决方案。
