<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch029.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="28" id="chapter-f-assessments">
<h1 class="H1---Chapter chapterHead" data-number="28"><span id="x1-247000F"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Assessments</span></span></h1>
<section class="level2 sectionHead" data-number="28.1" id="f.1-chapter-1-foundations-of-quantum-computing">
<h1 class="sectionHead" data-number="28.1"> <span id="x1-248000F.1"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 1, Foundations of Quantum Computing</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">(1.1)</span></strong><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml"> The probability of measuring </span><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml"> if the state of a qubit is </span><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file25.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml"> is exactly</span></p>
<p><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left| \sqrt{\left. 1\slash 2 \right.} \right|^{2} = 1\slash 2. \right." class="math display" src="../media/file1663.png" style="vertical-align:middle" title="\left. \left| \sqrt{\left. 1\slash 2 \right.} \right|^{2} = 1\slash 2. \right."/></span></p>
<p><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">In the same way, the probability of measuring </span><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml"> is also </span><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash 2 \right." class="math inline" src="../media/file136.png" style="vertical-align:middle" title="\left. 1\slash 2 \right."/></span><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.14.2" xmlns="http://www.w3.org/1999/xhtml">If the state of the qubit is </span><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 3 \right.}\left| 0 \right\rangle + \sqrt{\left. 2\slash 3 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file26.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 3 \right.}\left| 0 \right\rangle + \sqrt{\left. 2\slash 3 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">, the probability of measuring </span><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left| \sqrt{\left. 1\slash 3 \right.} \right|^{2} = 1\slash 3 \right." class="math display" src="../media/file1664.png" style="vertical-align:middle" title="\left. \left| \sqrt{\left. 1\slash 3 \right.} \right|^{2} = 1\slash 3 \right."/></span><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml"> and the probability of measuring </span><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left| \sqrt{\left. 2\slash 3 \right.} \right|^{2} = 2\slash 3. \right." class="math display" src="../media/file1665.png" style="vertical-align:middle" title="\left. \left| \sqrt{\left. 2\slash 3 \right.} \right|^{2} = 2\slash 3. \right."/></span></p>
<p><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Finally, if the qubit state is </span><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle - \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file27.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle - \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">, the probability of measuring </span><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left| \sqrt{\left. 1\slash 2 \right.} \right|^{2} = 1\slash 2 \right." class="math display" src="../media/file1666.png" style="vertical-align:middle" title="\left. \left| \sqrt{\left. 1\slash 2 \right.} \right|^{2} = 1\slash 2 \right."/></span><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml"> and the probability of measuring </span><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left| {- \sqrt{\left. 1\slash 2 \right.}} \right|^{2} = 1\slash 2. \right." class="math display" src="../media/file1667.png" style="vertical-align:middle" title="\left. \left| {- \sqrt{\left. 1\slash 2 \right.}} \right|^{2} = 1\slash 2. \right."/></span></p>
<p><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">(1.2)</span></strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml"> The inner product of </span><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file25.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 3 \right.}\left| 0 \right\rangle + \sqrt{\left. 2\slash 3 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file26.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 3 \right.}\left| 0 \right\rangle + \sqrt{\left. 2\slash 3 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 3 \right.} + \sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 2\slash 3 \right.} = \sqrt{\left. 1\slash 6 \right.} + \sqrt{\left. 1\slash 3 \right.}." class="math display" src="../media/file1668.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 3 \right.} + \sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 2\slash 3 \right.} = \sqrt{\left. 1\slash 6 \right.} + \sqrt{\left. 1\slash 3 \right.}."/></span></p>
<p><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">The inner product of </span><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file25.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle - \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle" class="math inline" src="../media/file27.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left| 0 \right\rangle - \sqrt{\left. 1\slash 2 \right.}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 2 \right.} - \sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 2 \right.} = 0." class="math display" src="../media/file1669.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 2 \right.} - \sqrt{\left. 1\slash 2 \right.}\sqrt{\left. 1\slash 2 \right.} = 0."/></span></p>
<p><strong><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">(1.3)</span></strong><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml"> The adjoint of </span><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"> itself and it holds that </span><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="XX = I" class="math inline" src="../media/file1670.png" style="vertical-align:middle" title="XX = I"/></span><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.54.2" xmlns="http://www.w3.org/1999/xhtml">Hence, </span><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"> is unitary and its inverse is </span><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml"> itself. </span><span class="koboSpan" id="kobo.58.2" xmlns="http://www.w3.org/1999/xhtml">The operation </span><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml"> takes </span><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a\left| 0 \right\rangle + b\left| 1 \right\rangle" class="math inline" src="../media/file22.png" style="vertical-align:middle" title="a\left| 0 \right\rangle + b\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="b\left| 0 \right\rangle + a\left| 1 \right\rangle" class="math inline" src="../media/file1671.png" style="vertical-align:middle" title="b\left| 0 \right\rangle + a\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">(1.4)</span></strong><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml"> The adjoint of </span><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml"> itself and it holds that </span><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HH = I" class="math inline" src="../media/file1672.png" style="vertical-align:middle" title="HH = I"/></span><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.72.2" xmlns="http://www.w3.org/1999/xhtml">Hence, </span><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml"> is unitary and its inverse is </span><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"> itself. </span><span class="koboSpan" id="kobo.76.2" xmlns="http://www.w3.org/1999/xhtml">The operation </span><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml"> takes </span><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| + \right\rangle" class="math inline" src="../media/file61.png" style="vertical-align:middle" title="\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| - \right\rangle" class="math inline" src="../media/file63.png" style="vertical-align:middle" title="\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.86.2" xmlns="http://www.w3.org/1999/xhtml">Finally, it holds that </span><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X\left| + \right\rangle = \left| + \right\rangle" class="math inline" src="../media/file1673.png" style="vertical-align:middle" title="X\left| + \right\rangle = \left| + \right\rangle"/></span><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X\left| - \right\rangle = - \left| - \right\rangle" class="math inline" src="../media/file1674.png" style="vertical-align:middle" title="X\left| - \right\rangle = - \left| - \right\rangle"/></span><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml">(1.5)</span></strong><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that </span><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z\left| 0 \right\rangle = HXH\left| 0 \right\rangle = HX\left| + \right\rangle = H\left| + \right\rangle = \left| 0 \right\rangle" class="math display" src="../media/file1675.png" style="vertical-align:middle" title="Z\left| 0 \right\rangle = HXH\left| 0 \right\rangle = HX\left| + \right\rangle = H\left| + \right\rangle = \left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z\left| 1 \right\rangle = HXH\left| 1 \right\rangle = HX\left| - \right\rangle = - H\left| - \right\rangle = - \left| 1 \right\rangle." class="math display" src="../media/file1676.png" style="vertical-align:middle" title="Z\left| 1 \right\rangle = HXH\left| 1 \right\rangle = HX\left| - \right\rangle = - H\left| - \right\rangle = - \left| 1 \right\rangle."/></span><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"> It also holds that </span><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix}\begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \\ \end{pmatrix}\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix} = \begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix}\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}." class="math display" src="../media/file1677.png" style="vertical-align:middle" title="\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix}\begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \\ \end{pmatrix}\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix} = \begin{pmatrix} \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \end{pmatrix}\begin{pmatrix} \frac{1}{\sqrt{2}} &amp; {- \frac{1}{\sqrt{2}}} \\ \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\ \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}."/></span></p>
<p><strong><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">(1.6)</span></strong><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"> Since </span><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\frac{\pi}{4}}e^{i\frac{\pi}{4}} = e^{i\frac{\pi}{2}}" class="math inline" src="../media/file1678.png" style="vertical-align:middle" title="e^{i\frac{\pi}{4}}e^{i\frac{\pi}{4}} = e^{i\frac{\pi}{2}}"/></span><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">, it is apparent that </span><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T^{2} = S" class="math inline" src="../media/file76.png" style="vertical-align:middle" title="T^{2} = S"/></span><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.103.2" xmlns="http://www.w3.org/1999/xhtml">Also, we have </span><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\frac{\pi}{2}}e^{i\frac{\pi}{2}} = e^{i\pi} = - 1" class="math inline" src="../media/file1679.png" style="vertical-align:middle" title="e^{i\frac{\pi}{2}}e^{i\frac{\pi}{2}} = e^{i\pi} = - 1"/></span><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"> by Eulerâ€™s identity, so </span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S^{2} = Z" class="math inline" src="../media/file78.png" style="vertical-align:middle" title="S^{2} = Z"/></span><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.107.2" xmlns="http://www.w3.org/1999/xhtml">As a consequence, </span><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SS^{3} = S^{2}S^{2} = ZZ = I" class="math inline" src="../media/file1680.png" style="vertical-align:middle" title="SS^{3} = S^{2}S^{2} = ZZ = I"/></span><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">, so </span><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S^{\dagger} = S^{3}" class="math inline" src="../media/file1681.png" style="vertical-align:middle" title="S^{\dagger} = S^{3}"/></span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.111.2" xmlns="http://www.w3.org/1999/xhtml">Also, </span><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="TT^{7} = T^{2}T^{2}T^{2}T^{2} = S^{4} = I" class="math inline" src="../media/file1682.png" style="vertical-align:middle" title="TT^{7} = T^{2}T^{2}T^{2}T^{2} = S^{4} = I"/></span><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">, and it follows that </span><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T^{\dagger} = T^{7}" class="math inline" src="../media/file1683.png" style="vertical-align:middle" title="T^{\dagger} = T^{7}"/></span><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">(1.7)</span></strong><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> By the definition of </span><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{X}" class="math inline" src="../media/file118.png" style="vertical-align:middle" title="R_{X}"/></span><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml"> we have that </span><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{X}(\pi) = \begin{pmatrix} {\cos\frac{\pi}{2}} &amp; {- i\sin\frac{\pi}{2}} \\ {- i\sin\frac{\pi}{2}} &amp; {\cos\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; {- i} \\ {- i} &amp; 0 \\ \end{pmatrix} = - iX." class="math display" src="../media/file1684.png" style="vertical-align:middle" title="R_{X}(\pi) = \begin{pmatrix} {\cos\frac{\pi}{2}} &amp; {- i\sin\frac{\pi}{2}} \\ {- i\sin\frac{\pi}{2}} &amp; {\cos\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; {- i} \\ {- i} &amp; 0 \\ \end{pmatrix} = - iX."/></span></p>
<p><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">Analogously, </span><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Y}(\pi) = \begin{pmatrix} {\cos\frac{\pi}{2}} &amp; {- \sin\frac{\pi}{2}} \\ {\sin\frac{\pi}{2}} &amp; {\cos\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; {- 1} \\ 1 &amp; 0 \\ \end{pmatrix} = - iY" class="math display" src="../media/file1685.png" style="vertical-align:middle" title="R_{Y}(\pi) = \begin{pmatrix} {\cos\frac{\pi}{2}} &amp; {- \sin\frac{\pi}{2}} \\ {\sin\frac{\pi}{2}} &amp; {\cos\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; {- 1} \\ 1 &amp; 0 \\ \end{pmatrix} = - iY"/></span><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}(\pi) = \begin{pmatrix} e^{- i\frac{\pi}{2}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} {- i} &amp; 0 \\ 0 &amp; i \\ \end{pmatrix} = - iZ." class="math display" src="../media/file1686.png" style="vertical-align:middle" title="R_{Z}(\pi) = \begin{pmatrix} e^{- i\frac{\pi}{2}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{2}} \\ \end{pmatrix} = \begin{pmatrix} {- i} &amp; 0 \\ 0 &amp; i \\ \end{pmatrix} = - iZ."/></span></p>
<p><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">Also, </span><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}\left( \frac{\pi}{2} \right) = \begin{pmatrix} e^{- i\frac{\pi}{4}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{4}} \\ \end{pmatrix} = e^{- i\frac{\pi}{4}}S" class="math display" src="../media/file1687.png" style="vertical-align:middle" title="R_{Z}\left( \frac{\pi}{2} \right) = \begin{pmatrix} e^{- i\frac{\pi}{4}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{4}} \\ \end{pmatrix} = e^{- i\frac{\pi}{4}}S"/></span><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}\left( \frac{\pi}{4} \right) = \begin{pmatrix} e^{- i\frac{\pi}{8}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{8}} \\ \end{pmatrix} = e^{- i\frac{\pi}{8}}T." class="math display" src="../media/file1688.png" style="vertical-align:middle" title="R_{Z}\left( \frac{\pi}{4} \right) = \begin{pmatrix} e^{- i\frac{\pi}{8}} &amp; 0 \\ 0 &amp; e^{i\frac{\pi}{8}} \\ \end{pmatrix} = e^{- i\frac{\pi}{8}}T."/></span></p>
<p><strong><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">(1.8)</span></strong><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml"> From the definition of </span><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U\left( {\theta,\varphi,\lambda} \right)" class="math inline" src="../media/file130.png" style="vertical-align:middle" title="U\left( {\theta,\varphi,\lambda} \right)"/></span><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">, we have that </span><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U\left( {\theta,\varphi,\lambda} \right)U\left( {\theta,\varphi,\lambda} \right)^{\dagger} = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- e^{i\lambda}\sin\frac{\theta}{2}} \\ {e^{i\varphi}\sin\frac{\theta}{2}} &amp; {e^{i{({\varphi + \lambda})}}\cos\frac{\theta}{2}} \\ \end{pmatrix}\begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {e^{- i\varphi}\sin\frac{\theta}{2}} \\ {- e^{- i\lambda}\sin\frac{\theta}{2}} &amp; {e^{- i{({\varphi + \lambda})}}\cos\frac{\theta}{2}} \\ \end{pmatrix} = I" class="math display" src="../media/file1689.png" style="vertical-align:middle" title="U\left( {\theta,\varphi,\lambda} \right)U\left( {\theta,\varphi,\lambda} \right)^{\dagger} = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- e^{i\lambda}\sin\frac{\theta}{2}} \\ {e^{i\varphi}\sin\frac{\theta}{2}} &amp; {e^{i{({\varphi + \lambda})}}\cos\frac{\theta}{2}} \\ \end{pmatrix}\begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {e^{- i\varphi}\sin\frac{\theta}{2}} \\ {- e^{- i\lambda}\sin\frac{\theta}{2}} &amp; {e^{- i{({\varphi + \lambda})}}\cos\frac{\theta}{2}} \\ \end{pmatrix} = I"/></span><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml"> and, analogously, </span><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U\left( {\theta,\varphi,\lambda} \right)^{\dagger}U\left( {\theta,\varphi,\lambda} \right) = I" class="math inline" src="../media/file1690.png" style="vertical-align:middle" title="U\left( {\theta,\varphi,\lambda} \right)^{\dagger}U\left( {\theta,\varphi,\lambda} \right) = I"/></span><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.136.2" xmlns="http://www.w3.org/1999/xhtml">Then, </span><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U\left( {\theta,\varphi,\lambda} \right)" class="math inline" src="../media/file130.png" style="vertical-align:middle" title="U\left( {\theta,\varphi,\lambda} \right)"/></span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"> is unitary.</span></p>
<p><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">Also, we get that </span><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. U(\theta, - \pi\slash 2,\pi\slash 2) = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- i\sin\frac{\theta}{2}} \\ {- i\sin\frac{\theta}{2}} &amp; {\cos\frac{\theta}{2}} \\ \end{pmatrix} = R_{X}(\theta). \right." class="math display" src="../media/file1691.png" style="vertical-align:middle" title="\left. U(\theta, - \pi\slash 2,\pi\slash 2) = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- i\sin\frac{\theta}{2}} \\ {- i\sin\frac{\theta}{2}} &amp; {\cos\frac{\theta}{2}} \\ \end{pmatrix} = R_{X}(\theta). \right."/></span></p>
<p><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">Analogously, it holds that </span><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U(\theta,0,0) = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- \sin\frac{\theta}{2}} \\ {\sin\frac{\theta}{2}} &amp; {\cos\frac{\theta}{2}} \\ \end{pmatrix} = R_{Y}(\theta)" class="math display" src="../media/file1692.png" style="vertical-align:middle" title="U(\theta,0,0) = \begin{pmatrix} {\cos\frac{\theta}{2}} &amp; {- \sin\frac{\theta}{2}} \\ {\sin\frac{\theta}{2}} &amp; {\cos\frac{\theta}{2}} \\ \end{pmatrix} = R_{Y}(\theta)"/></span><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U(0,0,\theta) = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; e^{i\theta} \\ \end{pmatrix} = e^{i\frac{\theta}{2}}R_{Z}(\theta)." class="math display" src="../media/file1693.png" style="vertical-align:middle" title="U(0,0,\theta) = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; e^{i\theta} \\ \end{pmatrix} = e^{i\frac{\theta}{2}}R_{Z}(\theta)."/></span></p>
<p><strong><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">(1.9)</span></strong><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"> Since </span><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\theta = 2\arccos\sqrt{p}" class="math inline" src="../media/file138.png" style="vertical-align:middle" title="\theta = 2\arccos\sqrt{p}"/></span><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that the state before measurement is </span><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\cos\frac{\theta}{2}\left| 0 \right\rangle + \sin\frac{\theta}{2}\left| 1 \right\rangle = \sqrt{p}\left| 0 \right\rangle + \sqrt{1 - p}\left| 1 \right\rangle." class="math display" src="../media/file1694.png" style="vertical-align:middle" title="\cos\frac{\theta}{2}\left| 0 \right\rangle + \sin\frac{\theta}{2}\left| 1 \right\rangle = \sqrt{p}\left| 0 \right\rangle + \sqrt{1 - p}\left| 1 \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">As a consequence, the probability of measuring </span><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml"> and the probability of measuring </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1 - p" class="math inline" src="../media/file142.png" style="vertical-align:middle" title="1 - p"/></span><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">(1.10)</span></strong><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml"> The probability of obtaining </span><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| a_{10} \right|^{2} + \left| a_{11} \right|^{2}" class="math inline" src="../media/file1695.png" style="vertical-align:middle" title="\left| a_{10} \right|^{2} + \left| a_{11} \right|^{2}"/></span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.164.2" xmlns="http://www.w3.org/1999/xhtml">Upon that measurement result, the state will collapse to </span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{a_{10}\left| {10} \right\rangle + a_{11}\left| {11} \right\rangle}{\sqrt{\left| a_{10} \right|^{2} + \left| a_{11} \right|^{2}}}." class="math display" src="../media/file1696.png" style="vertical-align:middle" title="\frac{a_{10}\left| {10} \right\rangle + a_{11}\left| {11} \right\rangle}{\sqrt{\left| a_{10} \right|^{2} + \left| a_{11} \right|^{2}}}."/></span></p>
<p><strong><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">(1.11)</span></strong><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that </span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(U_{1} \otimes U_{2})(U_{1}^{\dagger} \otimes U_{2}^{\dagger}) = (U_{1}U_{1}^{\dagger}) \otimes (U_{2}U_{2}^{\dagger}) = I \otimes I." class="math display" src="../media/file1697.png" style="vertical-align:middle" title="(U_{1} \otimes U_{2})(U_{1}^{\dagger} \otimes U_{2}^{\dagger}) = (U_{1}U_{1}^{\dagger}) \otimes (U_{2}U_{2}^{\dagger}) = I \otimes I."/></span></p>
<p><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">Analogously, </span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(U_{1}^{\dagger} \otimes U_{2}^{\dagger})(U_{1} \otimes U_{2}) = I \otimes I" class="math inline" src="../media/file1698.png" style="vertical-align:middle" title="(U_{1}^{\dagger} \otimes U_{2}^{\dagger})(U_{1} \otimes U_{2}) = I \otimes I"/></span><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.171.2" xmlns="http://www.w3.org/1999/xhtml">Hence, the inverse of </span><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{1} \otimes U_{2}" class="math inline" src="../media/file179.png" style="vertical-align:middle" title="U_{1} \otimes U_{2}"/></span><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{1}^{\dagger} \otimes U_{2}^{\dagger}" class="math inline" src="../media/file186.png" style="vertical-align:middle" title="U_{1}^{\dagger} \otimes U_{2}^{\dagger}"/></span><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.175.2" xmlns="http://www.w3.org/1999/xhtml">Also, from the definition of tensor product of two matrices we get that, for every matrix </span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml"> (even in they are non-unitary), it holds that </span><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {A^{\dagger} \otimes B^{\dagger} = \begin{pmatrix} a_{11}^{\ast} &amp; a_{21}^{\ast} \\ a_{12}^{\ast} &amp; a_{22}^{\ast} \\ \end{pmatrix} \otimes \begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {= \begin{pmatrix} {a_{11}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {a_{21}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} \\ {a_{12}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {a_{22}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} \\ \end{pmatrix}\qquad} &amp; &amp; \qquad \\ &amp; {= \begin{pmatrix} {a_{11}^{\ast}b_{11}^{\ast}} &amp; {a_{11}^{\ast}b_{21}^{\ast}} &amp; {a_{21}^{\ast}b_{11}^{\ast}} &amp; {a_{21}^{\ast}b_{21}^{\ast}} \\ {a_{11}^{\ast}b_{12}^{\ast}} &amp; {a_{11}^{\ast}b_{22}^{\ast}} &amp; {a_{21}^{\ast}b_{12}^{\ast}} &amp; {a_{21}^{\ast}b_{22}^{\ast}} \\ {a_{12}^{\ast}b_{11}^{\ast}} &amp; {a_{12}^{\ast}b_{21}^{\ast}} &amp; {a_{22}^{\ast}b_{11}^{\ast}} &amp; {a_{22}^{\ast}b_{21}^{\ast}} \\ {a_{12}^{\ast}b_{12}^{\ast}} &amp; {a_{12}^{\ast}b_{22}^{\ast}} &amp; {a_{22}^{\ast}b_{12}^{\ast}} &amp; {a_{22}^{\ast}b_{22}^{\ast}} \\ \end{pmatrix} = {(A \otimes B)}^{\dagger}.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1699.png" style="vertical-align:middle" title="\begin{array}{rlrl} {A^{\dagger} \otimes B^{\dagger} = \begin{pmatrix} a_{11}^{\ast} &amp; a_{21}^{\ast} \\ a_{12}^{\ast} &amp; a_{22}^{\ast} \\ \end{pmatrix} \otimes \begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {= \begin{pmatrix} {a_{11}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {a_{21}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} \\ {a_{12}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} &amp; {a_{22}^{\ast}\begin{pmatrix} b_{11}^{\ast} &amp; b_{21}^{\ast} \\ b_{12}^{\ast} &amp; b_{22}^{\ast} \\ \end{pmatrix}} \\ \end{pmatrix}\qquad} &amp; &amp; \qquad \\  &amp; {= \begin{pmatrix} {a_{11}^{\ast}b_{11}^{\ast}} &amp; {a_{11}^{\ast}b_{21}^{\ast}} &amp; {a_{21}^{\ast}b_{11}^{\ast}} &amp; {a_{21}^{\ast}b_{21}^{\ast}} \\ {a_{11}^{\ast}b_{12}^{\ast}} &amp; {a_{11}^{\ast}b_{22}^{\ast}} &amp; {a_{21}^{\ast}b_{12}^{\ast}} &amp; {a_{21}^{\ast}b_{22}^{\ast}} \\ {a_{12}^{\ast}b_{11}^{\ast}} &amp; {a_{12}^{\ast}b_{21}^{\ast}} &amp; {a_{22}^{\ast}b_{11}^{\ast}} &amp; {a_{22}^{\ast}b_{21}^{\ast}} \\ {a_{12}^{\ast}b_{12}^{\ast}} &amp; {a_{12}^{\ast}b_{22}^{\ast}} &amp; {a_{22}^{\ast}b_{12}^{\ast}} &amp; {a_{22}^{\ast}b_{22}^{\ast}} \\ \end{pmatrix} = {(A \otimes B)}^{\dagger}.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><strong><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">(1.12)</span></strong><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"> The matrix for </span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X \otimes X" class="math inline" src="../media/file188.png" style="vertical-align:middle" title="X \otimes X"/></span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0 &amp; 0 \\ \end{pmatrix}." class="math display" src="../media/file1700.png" style="vertical-align:middle" title="\begin{pmatrix} 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0 &amp; 0 \\ \end{pmatrix}."/></span></p>
<p><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">The matrix for </span><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H \otimes I" class="math inline" src="../media/file189.png" style="vertical-align:middle" title="H \otimes I"/></span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{2}}\begin{pmatrix} 1 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 1 \\ 1 &amp; 0 &amp; {- 1} &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; {- 1} \\ \end{pmatrix}." class="math display" src="../media/file1701.png" style="vertical-align:middle" title="\frac{1}{\sqrt{2}}\begin{pmatrix} 1 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 1 \\ 1 &amp; 0 &amp; {- 1} &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; {- 1} \\ \end{pmatrix}."/></span></p>
<p><strong><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">(1.13)</span></strong><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> In the circuit</span></p>
<div id="x1-248014x13">
<p><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HHHH " src="../media/file1702.jpg"/></span></p>
<p><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">the states </span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {00} \right\rangle" class="math inline" src="../media/file198.png" style="vertical-align:middle" title="\left| {00} \right\rangle"/></span><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml"> are left unchanged, while </span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {11} \right\rangle" class="math inline" src="../media/file201.png" style="vertical-align:middle" title="\left| {11} \right\rangle"/></span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"> are mapped to each other. </span><span class="koboSpan" id="kobo.201.2" xmlns="http://www.w3.org/1999/xhtml">This is exactly the action of a CNOT gate whose control is the bottom qubit and whose target is the top one.</span></p>
<p><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">The matrix for the circuit is</span></p>
<span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ \end{pmatrix}," class="math display" src="../media/file1703.png" style="vertical-align:middle" title="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ \end{pmatrix},"/></span>
<p><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">which is exactly the matrix for the CNOT gate from bottom qubit to top qubit.</span></p>
<p><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, the circuit</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=" " src="../media/file1704.jpg"/></span></p>
</div>
<p><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">leaves </span><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {00} \right\rangle" class="math inline" src="../media/file198.png" style="vertical-align:middle" title="\left| {00} \right\rangle"/></span><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {11} \right\rangle" class="math inline" src="../media/file201.png" style="vertical-align:middle" title="\left| {11} \right\rangle"/></span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"> unchanged, while it maps </span><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"> to each other. </span><span class="koboSpan" id="kobo.215.2" xmlns="http://www.w3.org/1999/xhtml">This is exactly the action of a SWAP gate.</span></p>
<p><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">Alternatively, the matrix for the circuit is</span></p>
<span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{pmatrix}," class="math display" src="../media/file1705.png" style="vertical-align:middle" title="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{pmatrix},"/></span>
<p><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">which is, again, the matrix of the SWAP gate.</span></p>
</div>
<div id="x1-248016x14">
<p><strong><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">(1.14)</span></strong><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml"> The state </span><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 3 \right.}(\left| {00} \right\rangle + \left| {01} \right\rangle + \left| {11} \right\rangle)" class="math inline" src="../media/file214.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 3 \right.}(\left| {00} \right\rangle + \left| {01} \right\rangle + \left| {11} \right\rangle)"/></span><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml"> is indeed entangled. </span><span class="koboSpan" id="kobo.222.2" xmlns="http://www.w3.org/1999/xhtml">However, </span><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{2}(\left| {00} \right\rangle + \left| {01} \right\rangle + \left| {10} \right\rangle + \left| {11} \right\rangle)" class="math inline" src="../media/file215.png" style="vertical-align:middle" title="\frac{1}{2}(\left| {00} \right\rangle + \left| {01} \right\rangle + \left| {10} \right\rangle + \left| {11} \right\rangle)"/></span><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml"> is a product state because it can be written as </span><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| + \right\rangle\left| + \right\rangle." class="math inline" src="../media/file1706.png" style="vertical-align:middle" title="\left| + \right\rangle\left| + \right\rangle."/></span></p>
</div>
<div id="x1-248018x15">
<p><strong><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">(1.15)</span></strong><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml"> If the matrix of </span><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U" class="math inline" src="../media/file51.png" style="vertical-align:middle" title="U"/></span><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(u_{ij})}_{i,j = 1}^{2}" class="math inline" src="../media/file231.png" style="vertical-align:middle" title="{(u_{ij})}_{i,j = 1}^{2}"/></span><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {00} \right\rangle" class="math inline" src="../media/file198.png" style="vertical-align:middle" title="\left| {00} \right\rangle"/></span><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml"> are taken to themselves by </span><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U" class="math inline" src="../media/file229.png" style="vertical-align:middle" title="\text{C}U"/></span><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.237.2" xmlns="http://www.w3.org/1999/xhtml">What is more, </span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"> is taken to </span><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle(u_{11}\left| 0 \right\rangle + u_{21}\left| 1 \right\rangle" class="math inline" src="../media/file1707.png" style="vertical-align:middle" title="\left| 1 \right\rangle(u_{11}\left| 0 \right\rangle + u_{21}\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">) and </span><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {11} \right\rangle" class="math inline" src="../media/file201.png" style="vertical-align:middle" title="\left| {11} \right\rangle"/></span><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml"> is taken to </span><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle(u_{12}\left| 0 \right\rangle + u_{22}\left| 1 \right\rangle)" class="math inline" src="../media/file1708.png" style="vertical-align:middle" title="\left| 1 \right\rangle(u_{12}\left| 0 \right\rangle + u_{22}\left| 1 \right\rangle)"/></span><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.245.2" xmlns="http://www.w3.org/1999/xhtml">Hence, the matrix of </span><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U" class="math inline" src="../media/file229.png" style="vertical-align:middle" title="\text{C}U"/></span><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml"> is</span></p>
<span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; u_{11} &amp; u_{12} \\ 0 &amp; 0 &amp; u_{21} &amp; u_{22} \\ \end{pmatrix}." class="math display" src="../media/file1709.png" style="vertical-align:middle" title="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; u_{11} &amp; u_{12} \\ 0 &amp; 0 &amp; u_{21} &amp; u_{22} \\ \end{pmatrix}."/></span>
<p><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">The adjoint of </span><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U" class="math inline" src="../media/file229.png" style="vertical-align:middle" title="\text{C}U"/></span><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U^{\dagger}" class="math inline" src="../media/file1710.png" style="vertical-align:middle" title="\text{C}U^{\dagger}"/></span><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml"> and it holds that </span><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U\text{C}U^{\dagger} = \text{C}U^{\dagger}\text{C}U = I" class="math inline" src="../media/file1711.png" style="vertical-align:middle" title="\text{C}U\text{C}U^{\dagger} = \text{C}U^{\dagger}\text{C}U = I"/></span><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.255.2" xmlns="http://www.w3.org/1999/xhtml">Hence, </span><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\text{C}U" class="math inline" src="../media/file229.png" style="vertical-align:middle" title="\text{C}U"/></span><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml"> is unitary.</span></p>
</div>
<div id="x1-248020x16">
<p><strong><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">(1.16)</span></strong><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"> The equivalence follows directly from the fact that </span><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HXH = Z" class="math inline" src="../media/file1712.png" style="vertical-align:middle" title="HXH = Z"/></span><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-248022x17">
<p><strong><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">(1.17)</span></strong><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"> We can prepare </span><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}\left( {\left| {00} \right\rangle - \left| {11} \right\rangle} \right)" class="math inline" src="../media/file241.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}\left( {\left| {00} \right\rangle - \left| {11} \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml"> with the following circuit:</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="|H|Z00âŸ©âŸ© " src="../media/file1713.jpg"/></span></p>
</div>
<p><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">We can use the circuit</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="|0HX|0âŸ©âŸ© " src="../media/file1714.jpg"/></span></p>
</div>
<p><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">to prepare </span><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle + \left| {01} \right\rangle)." class="math inline" src="../media/file1715.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle + \left| {01} \right\rangle)."/></span></p>
<p><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">Finally, the circuit</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="|0HX|0ZâŸ©âŸ© " src="../media/file1716.jpg"/></span></p>
</div>
<p><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">can be used to obtain </span><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle)." class="math inline" src="../media/file1717.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle)."/></span></p>
<p><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, to prepare these states, we are only using tensor product gates appended to the circuit that we used to obtain the original Bell state </span><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)" class="math inline" src="../media/file209.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)"/></span><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.277.2" xmlns="http://www.w3.org/1999/xhtml">For instance, we have that</span></p>
<span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle) = (X \otimes Z)\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)" class="math display" src="../media/file1718.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle) = (X \otimes Z)\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)"/></span>
<p><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">and, then, it also holds that</span></p>
<span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(X \otimes Z)\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle) = \sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)." class="math display" src="../media/file1719.png" style="vertical-align:middle" title="(X \otimes Z)\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle) = \sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)."/></span>
<p><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle)" class="math inline" src="../media/file243.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {10} \right\rangle - \left| {01} \right\rangle)"/></span><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml"> were a product state, then </span><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)" class="math inline" src="../media/file209.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)"/></span><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml"> would also be a product state. </span><span class="koboSpan" id="kobo.285.2" xmlns="http://www.w3.org/1999/xhtml">But that is impossible, because we know that </span><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)" class="math inline" src="../media/file209.png" style="vertical-align:middle" title="\sqrt{\left. 1\slash 2 \right.}(\left| {00} \right\rangle + \left| {11} \right\rangle)"/></span><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml"> is entangled.</span></p>
</div>
<div id="x1-248024x18">
<p><strong><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">(1.18)</span></strong><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml"> We can prove it by induction. </span><span class="koboSpan" id="kobo.289.2" xmlns="http://www.w3.org/1999/xhtml">We know that the result is true for </span><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n = 1" class="math inline" src="../media/file1720.png" style="vertical-align:middle" title="n = 1"/></span><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.291.2" xmlns="http://www.w3.org/1999/xhtml">Now, assume that it is true for </span><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n &gt; 1" class="math inline" src="../media/file1721.png" style="vertical-align:middle" title="n &gt; 1"/></span><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml"> and consider a basis state </span><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n + 1" class="math inline" src="../media/file792.png" style="vertical-align:middle" title="n + 1"/></span><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml"> qubits. </span><span class="koboSpan" id="kobo.297.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = \left| 0 \right\rangle\left| \psi^{\prime} \right\rangle" class="math inline" src="../media/file1722.png" style="vertical-align:middle" title="\left| \psi \right\rangle = \left| 0 \right\rangle\left| \psi^{\prime} \right\rangle"/></span><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">, then the column vector for </span><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml"> will start with the elements of the column vector of </span><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi^{\prime} \right\rangle" class="math inline" src="../media/file1723.png" style="vertical-align:middle" title="\left| \psi^{\prime} \right\rangle"/></span><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"> and then it will have </span><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml"> zeroes. </span><span class="koboSpan" id="kobo.305.2" xmlns="http://www.w3.org/1999/xhtml">But the column vector for </span><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi^{\prime} \right\rangle" class="math inline" src="../media/file1723.png" style="vertical-align:middle" title="\left| \psi^{\prime} \right\rangle"/></span><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml"> is, by the induction hypothesis, exactly of the form that we are interested in. </span><span class="koboSpan" id="kobo.307.2" xmlns="http://www.w3.org/1999/xhtml">It follows that </span><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml"> also has the desired structure. </span><span class="koboSpan" id="kobo.309.2" xmlns="http://www.w3.org/1999/xhtml">The case when </span><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = \left| 1 \right\rangle\left| \psi^{\prime} \right\rangle" class="math inline" src="../media/file1724.png" style="vertical-align:middle" title="\left| \psi \right\rangle = \left| 1 \right\rangle\left| \psi^{\prime} \right\rangle"/></span><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml"> is analogous.</span></p>
<p><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, since every </span><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">-qubit state can be written as a normalized linear combination of basis states, it follows that its vector representation is a unit length column vector with </span><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml"> coordinates.</span></p>
</div>
<div id="x1-248026x19">
<p><strong><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">(1.19)</span></strong><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml"> If we measure the </span><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">-th qubit of a generic multi-qubit state, the probability of obtaining </span><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml"> is given by</span></p>
<span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{l \in J_{1}}\left| a_{l} \right|^{2}," class="math display" src="../media/file1725.png" style="vertical-align:middle" title="\sum\limits_{l \in J_{1}}\left| a_{l} \right|^{2},"/></span>
<p><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{1}" class="math inline" src="../media/file1726.png" style="vertical-align:middle" title="J_{1}"/></span><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml"> is the set of numbers whose </span><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">-th bit is </span><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.330.2" xmlns="http://www.w3.org/1999/xhtml">The state after the collapse will be</span></p>
<span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{\sum\limits_{l \in J_{1}}a_{l}\left| l \right\rangle}{\sqrt{\sum\limits_{l \in J_{1}}\left| a_{i} \right|^{2}}}." class="math display" src="../media/file1727.png" style="vertical-align:middle" title="\frac{\sum\limits_{l \in J_{1}}a_{l}\left| l \right\rangle}{\sqrt{\sum\limits_{l \in J_{1}}\left| a_{i} \right|^{2}}}."/></span>
</div>
<div id="x1-248028x20">
<p><strong><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">(1.20)</span></strong><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> The probability of getting </span><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"> when we measure the second qubit of </span><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. (1\slash 2)\left| {100} \right\rangle + (1\slash 2)\left| {010} \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| {001} \right\rangle \right." class="math inline" src="../media/file265.png" style="vertical-align:middle" title="\left. (1\slash 2)\left| {100} \right\rangle + (1\slash 2)\left| {010} \right\rangle + \sqrt{\left. 1\slash 2 \right.}\left| {001} \right\rangle \right."/></span><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"> is</span></p>
<span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \frac{1}{2} \right|^{2} + \left| \frac{1}{\sqrt{2}} \right|^{2} = \frac{1}{4} + \frac{1}{2} = \frac{3}{4}." class="math display" src="../media/file1728.png" style="vertical-align:middle" title="\left| \frac{1}{2} \right|^{2} + \left| \frac{1}{\sqrt{2}} \right|^{2} = \frac{1}{4} + \frac{1}{2} = \frac{3}{4}."/></span>
<p><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">The result after measuring the second qubit and obtaining </span><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"> would be</span></p>
<span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{\sqrt{3}}\left| {100} \right\rangle + \frac{\sqrt{2}}{\sqrt{3}}\left| {001} \right\rangle." class="math display" src="../media/file1729.png" style="vertical-align:middle" title="\frac{1}{\sqrt{3}}\left| {100} \right\rangle + \frac{\sqrt{2}}{\sqrt{3}}\left| {001} \right\rangle."/></span>
</div>
<div id="x1-248030x21">
<p><strong><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">(1.21)</span></strong><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"> Letâ€™s denote </span><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = x_{1}\ldots x_{n}" class="math inline" src="../media/file1730.png" style="vertical-align:middle" title="x = x_{1}\ldots x_{n}"/></span><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y = y_{1}\ldots y_{n}" class="math inline" src="../media/file1731.png" style="vertical-align:middle" title="y = y_{1}\ldots y_{n}"/></span><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{i}" class="math inline" src="../media/file714.png" style="vertical-align:middle" title="x_{i}"/></span><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml"> is the </span><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i" class="math inline" src="../media/file49.png" style="vertical-align:middle" title="i"/></span><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">-th bit of </span><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{i}" class="math inline" src="../media/file1732.png" style="vertical-align:middle" title="y_{i}"/></span><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml"> is the </span><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i" class="math inline" src="../media/file49.png" style="vertical-align:middle" title="i"/></span><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">-th bit of </span><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.360.2" xmlns="http://www.w3.org/1999/xhtml">Then, it holds that</span></p>
<span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \middle| x \right\rangle = \left\langle y_{1} \middle| x_{1} \right\rangle\ldots\left\langle y_{n} \middle| x_{n} \right\rangle." class="math display" src="../media/file1733.png" style="vertical-align:middle" title="\left\langle y \middle| x \right\rangle = \left\langle y_{1} \middle| x_{1} \right\rangle\ldots\left\langle y_{n} \middle| x_{n} \right\rangle."/></span>
<p><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">As a consequence, </span><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \middle| x \right\rangle = 1" class="math inline" src="../media/file1734.png" style="vertical-align:middle" title="\left\langle y \middle| x \right\rangle = 1"/></span><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = y" class="math inline" src="../media/file941.png" style="vertical-align:middle" title="x = y"/></span><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \middle| x \right\rangle = 0" class="math inline" src="../media/file366.png" style="vertical-align:middle" title="\left\langle y \middle| x \right\rangle = 0"/></span><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x \neq y" class="math inline" src="../media/file364.png" style="vertical-align:middle" title="x \neq y"/></span><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.370.2" xmlns="http://www.w3.org/1999/xhtml">From this, it follows that the elements in </span><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| x \right\rangle\}}_{x \in {\{ 0,1\}}^{n}}" class="math inline" src="../media/file271.png" style="vertical-align:middle" title="{\{\left| x \right\rangle\}}_{x \in {\{ 0,1\}}^{n}}"/></span><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml"> are orthonormal. </span><span class="koboSpan" id="kobo.372.2" xmlns="http://www.w3.org/1999/xhtml">Since the cardinality of this set is </span><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">, which is the dimension of </span><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">-qubit states, we can conclude that the set forms a basis.</span></p>
</div>
<div id="x1-248032x22">
<p><strong><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml">(1.22)</span></strong><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that</span></p>
<span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} &amp; {\frac{1}{\sqrt{2}}\left( {\left\langle {000} \right| + \left\langle {111} \right|} \right)\frac{1}{2}\left( {\left| {000} \right\rangle + \left| {011} \right\rangle + \left| {101} \right\rangle + \left| {110} \right\rangle} \right)\qquad} &amp; &amp; \qquad \\ &amp; {\qquad = \frac{1}{2\sqrt{2}}(\left\langle 000 \middle| 000 \right\rangle + \left\langle 000 \middle| 011 \right\rangle + \left\langle 000 \middle| 101 \right\rangle + \left\langle 000 \middle| 110 \right\rangle + \qquad} &amp; &amp; \qquad \\ &amp; {\qquad\qquad\left\langle 111 \middle| 000 \right\rangle + \left\langle 111 \middle| 011 \right\rangle + \left\langle 111 \middle| 101 \right\rangle + \left\langle 111 \middle| 110 \right\rangle)\qquad} &amp; &amp; \qquad \\ &amp; {\qquad = \frac{1}{2\sqrt{2}},\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1735.png" style="vertical-align:middle" title="\begin{array}{rlrl}  &amp; {\frac{1}{\sqrt{2}}\left( {\left\langle {000} \right| + \left\langle {111} \right|} \right)\frac{1}{2}\left( {\left| {000} \right\rangle + \left| {011} \right\rangle + \left| {101} \right\rangle + \left| {110} \right\rangle} \right)\qquad} &amp; &amp; \qquad \\  &amp; {\qquad = \frac{1}{2\sqrt{2}}(\left\langle 000 \middle| 000 \right\rangle + \left\langle 000 \middle| 011 \right\rangle + \left\langle 000 \middle| 101 \right\rangle + \left\langle 000 \middle| 110 \right\rangle + \qquad} &amp; &amp; \qquad \\  &amp; {\qquad\qquad\left\langle 111 \middle| 000 \right\rangle + \left\langle 111 \middle| 011 \right\rangle + \left\langle 111 \middle| 101 \right\rangle + \left\langle 111 \middle| 110 \right\rangle)\qquad} &amp; &amp; \qquad \\  &amp; {\qquad = \frac{1}{2\sqrt{2}},\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
<p><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">because all the inner products are </span><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml"> except </span><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle 000 \middle| 000 \right\rangle" class="math inline" src="../media/file1736.png" style="vertical-align:middle" title="\left\langle 000 \middle| 000 \right\rangle"/></span><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">, which is </span><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-248034x23">
<p><strong><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">(1.23)</span></strong><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml"> From its action of the basis states, we deduce that the matrix for the CCNOT gate is:</span></p>
<span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\ \end{pmatrix}" class="math display" src="../media/file1737.png" style="vertical-align:middle" title="\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\  &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\ \end{pmatrix}"/></span>
<p><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">It holds that this matrix is its own adjoint and that its square is the identity. </span><span class="koboSpan" id="kobo.390.2" xmlns="http://www.w3.org/1999/xhtml">As a consequence, the matrix is unitary.</span></p>
</div>
<div id="x1-248036x24">
<p><strong><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">(1.24)</span></strong><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml"> The circuit</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HTTTTHTTTâ€ â€ â€  " src="../media/file1738.jpg"/></span></p>
</div>
<p><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">leaves all the states but </span><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {011} \right\rangle" class="math inline" src="../media/file1739.png" style="vertical-align:middle" title="\left| {011} \right\rangle"/></span><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {111} \right\rangle" class="math inline" src="../media/file1740.png" style="vertical-align:middle" title="\left| {111} \right\rangle"/></span><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml"> unchanged. </span><span class="koboSpan" id="kobo.398.2" xmlns="http://www.w3.org/1999/xhtml">It also interchanges </span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {011} \right\rangle" class="math inline" src="../media/file1739.png" style="vertical-align:middle" title="\left| {011} \right\rangle"/></span><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {111} \right\rangle" class="math inline" src="../media/file1740.png" style="vertical-align:middle" title="\left| {111} \right\rangle"/></span><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.402.2" xmlns="http://www.w3.org/1999/xhtml">That is exactly the action of a CCNOT gate with target on the top qubit.</span></p>
</div>
</section>
<section class="level2 sectionHead" data-number="28.2" id="f.2-chapter-2-the-tools-of-the-trade-in-quantum-computing">
<h1 class="sectionHead" data-number="28.2"> <span id="x1-249000F.2"><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 2, The Tools of the Trade in Quantum Computing</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">(2.1)</span></strong><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml"> We already gave you the solution in </span><em><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">(2.2)</span></strong><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"> In order to construct the circuit in </span><em><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <a href="ch009.xhtml#Figure2.2b"><em><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">2.2b</span></em></a><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">, you would have to execute the following piece of code:</span></p>
<div id="x1-249003x0">
<pre class="lstlisting" id="listing-365"><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import * 
 
import numpy as np 
 
 
 
qc = QuantumCircuit(2) 
 
 
 
qc.z(0) 
 
qc.y(1) 
 
qc.cry(np.pi/2, 0, 1) 
 
qc.u(np.pi/4, np.pi, 0, 0) 
 
qc.rz(np.pi/4,1)
</span></pre><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">
If you want to visualize the circuit, of course, you can use </span><code><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">qc</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">draw</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">(</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">mpl</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span>
<code><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">)</span></code><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">.
</span></div>
<div id="x1-249016x3">
<p><strong><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">(2.3)</span></strong><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"> You can check IBMâ€™s own implementation (</span><a class="url" href="https://github.com/Qiskit/qiskit-terra/blob/5ccf3a41cb10742ae2158b6ee9d13bbb05f64f36/qiskit/circuit/quantumcircuit.py#L2205"><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">https://github.com/Qiskit/qiskit-terra/blob/5ccf3a41cb10742ae2158b6ee9d13bbb05f64f36/qiskit/circuit/quantumcircuit.py#L2205</span></a><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">) of the method and compare it to your own!</span></p>
<p><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">They take some additional steps that we have not considered, such as adding </span><strong><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml">barriers</span></strong><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml"> in the circuit, but you can ignore those details.</span></p>
</div>
<div id="x1-249018x4">
<p><strong><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">(2.4)</span></strong><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml"> You already have the solution in </span><em><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch027.xhtml#x1-240000D"><em><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">D</span></em></a><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">Installing the Tools</span></em><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-249020x5">
<p><strong><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">(2.5)</span></strong><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"> We have already seen how to construct these circuits in Qiskit. </span><span class="koboSpan" id="kobo.442.2" xmlns="http://www.w3.org/1999/xhtml">In order to construct them in PennyLane, we would need to run the following piece of code:</span></p>
<pre class="lstlisting" id="listing-366"><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">

import pennylane as qml 
 
import numpy as np 
 
dev = qml.device(â€™default.qubitâ€™, wires = 2) 
 
@qml.qnode(dev) 
 
def qcircA(): 
 
    qml.PauliX(wires = 0) 
 
    qml.RX(np.pi/4, wires = 1) 
 
    qml.CNOT(wires = [0,1]) 
 
    qml.U3(np.pi/3, 0, np.pi, wires = 0) 
 
    return qml.state() 
 
 
 
@qml.qnode(dev) 
 
def qcircB(): 
 
    qml.PauliZ(wires = 0) 
 
    qml.PauliY(wires = 1) 
 
    qml.CRY(np.pi/2, wires = [0,1]) 
 
    qml.U3(np.pi/4, np.pi, 0, wires = 0) 
 
    qml.RZ(np.pi/4, wires = 1) 
 
    return qml.state()
</span></pre>
<p><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">If we run this, for instance, for circuit B by executing </span><span class="lstinline"><span style="color:#A71D5D"><code><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">print</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">(</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">qcircB</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">()</span></code></span></span><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">, we get the following state vector:</span></p>
<pre class="listings"><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">

 
tensor([ 0.        </span><span class="koboSpan" id="kobo.450.2" xmlns="http://www.w3.org/1999/xhtml">+0.j        , -0.35355339+0.85355339j, 
         0.        </span><span class="koboSpan" id="kobo.450.3" xmlns="http://www.w3.org/1999/xhtml">+0.j        ,  0.14644661-0.35355339j], 
         requires_grad=True)
      
</span></pre>
<p><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, if we simulate that very same circuit with Qiskit, we get this output:</span></p>
<pre class="listings"><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">

 
Statevector([-5.65831421e-17-3.20736464e-17j, 
              2.34375049e-17+1.32853393e-17j, 
             -3.53553391e-01+8.53553391e-01j, 
              1.46446609e-01-3.53553391e-01j], 
            dims=(2, 2))
      
</span></pre>
<p><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">Notice that this is the same result that we got with PennyLane. </span><span class="koboSpan" id="kobo.453.2" xmlns="http://www.w3.org/1999/xhtml">We first have to take into account the fact that the first two entries are â€” computationally speaking â€” zero. </span><span class="koboSpan" id="kobo.453.3" xmlns="http://www.w3.org/1999/xhtml">And then we have to draw our attention to how Qiskit, following its own conventions, gives us the amplitudes of the basis states in the following order: </span><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {00} \right\rangle" class="math inline" src="../media/file198.png" style="vertical-align:middle" title="\left| {00} \right\rangle"/></span><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {11} \right\rangle" class="math inline" src="../media/file201.png" style="vertical-align:middle" title="\left| {11} \right\rangle"/></span><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</section>
<section class="level2 sectionHead" data-number="28.3" id="f.3-chapter-3-working-with-quadratic-unconstrained-binary-optimization-problems">
<h1 class="sectionHead" data-number="28.3"> <span id="x1-250000F.3"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 3, Working with Quadratic Unconstrained Binary Optimization Problems</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">(3.1)</span></strong><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml"> We can put vertices </span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"> in one group, and vertices </span><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"> in the other. </span><span class="koboSpan" id="kobo.474.2" xmlns="http://www.w3.org/1999/xhtml">Then, five edges belong to the cut, namely </span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,2),(1,2),(1,3),(2,4)" class="math inline" src="../media/file1741.png" style="vertical-align:middle" title="(0,2),(1,2),(1,3),(2,4)"/></span><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(3,4)" class="math inline" src="../media/file1742.png" style="vertical-align:middle" title="(3,4)"/></span><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">(3.2)</span></strong><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"> The optimization problem for the Max-Cut of the graph in </span><em><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="ch011.xhtml#Figure3.3"><em><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">3.3</span></em></a><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> is</span></p>
<p><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2} + z_{1}z_{2} + z_{1}z_{4} + z_{2}z_{3} + z_{3}z_{4} + z_{3}z_{5} + z_{4}z_{5}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,5.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1743.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2} + z_{1}z_{2} + z_{1}z_{4} + z_{2}z_{3} + z_{3}z_{4} + z_{3}z_{5} + z_{4}z_{5}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,5.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">The value of the cut given by </span><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{1} = z_{2} = 1" class="math inline" src="../media/file334.png" style="vertical-align:middle" title="z_{0} = z_{1} = z_{2} = 1"/></span><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{3} = z_{4} = z_{5} = - 1" class="math inline" src="../media/file335.png" style="vertical-align:middle" title="z_{3} = z_{4} = z_{5} = - 1"/></span><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.491.2" xmlns="http://www.w3.org/1999/xhtml">This cut is not optimal, because, for instance, </span><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{1} = z_{2} = z_{5} = 1" class="math inline" src="../media/file1744.png" style="vertical-align:middle" title="z_{0} = z_{1} = z_{2} = z_{5} = 1"/></span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{3} = z_{4} = - 1" class="math inline" src="../media/file1745.png" style="vertical-align:middle" title="z_{3} = z_{4} = - 1"/></span><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml"> achieves a lower value.</span></p>
<p><strong><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">(3.3)</span></strong><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that </span><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {010} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {010} \right\rangle = 0" class="math inline" src="../media/file1746.png" style="vertical-align:middle" title="\left\langle {010} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {010} \right\rangle = 0"/></span><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {100} \right\rangle = - 2" class="math inline" src="../media/file1747.png" style="vertical-align:middle" title="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {100} \right\rangle = - 2"/></span><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.501.2" xmlns="http://www.w3.org/1999/xhtml">This latter value is the minimum possible, because we only have two edges in our graph.</span></p>
<p><strong><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">(3.4)</span></strong><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml"> We can compute the required expectation values with the following code:</span></p>
<div id="x1-250005x0">
<pre class="lstlisting" id="listing-367"><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.quantum_info import Pauli 
 
from qiskit.opflow.primitive_ops import PauliOp 
 
from qiskit.quantum_info import Statevector 
 
H_cut = PauliOp(Pauli("ZZI")) + PauliOp(Pauli("ZIZ")) 
 
for x in range(8): # We consider x=0,1...7 
 
    psi = Statevector.from_int(x, dims = 8) 
 
    print("The expectation value of |",x,"&gt;", "is", 
 
        psi.expectation_value(H_cut))
</span></pre>
<p><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml">If we run it, we obtain the following output:</span></p>
<pre class="lstlisting" id="listing-368"><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">

The expectation value of | 0 &gt; is (2+0j) 
 
The expectation value of | 1 &gt; is 0j 
 
The expectation value of | 2 &gt; is 0j 
 
The expectation value of | 3 &gt; is (-2+0j) 
 
The expectation value of | 4 &gt; is (-2+0j) 
 
The expectation value of | 5 &gt; is 0j 
 
The expectation value of | 6 &gt; is 0j 
 
The expectation value of | 7 &gt; is (2+0j)
</span></pre>
<p><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">Thus, we can see that there are two states that obtain the optimal value and both correspond to the cut in which </span><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"> is in one group and </span><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml"> in the other.</span></p>
</div>
<div id="x1-250024x5">
<p><strong><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml">(3.5)</span></strong><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml"> The QUBO problem would be</span></p>
<span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {x_{0}^{2} - 4x_{0}x_{1} + 6x_{0}x_{2} - 8x_{0}x_{3} + 4x_{1}^{2} - 12x_{1}x_{2} + 16x_{1}x_{3} + 9x_{2}^{2}\qquad} &amp; &amp; \qquad \\ &amp; {- 24x_{2}x_{3} + 16x_{3}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1748.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {x_{0}^{2} - 4x_{0}x_{1} + 6x_{0}x_{2} - 8x_{0}x_{3} + 4x_{1}^{2} - 12x_{1}x_{2} + 16x_{1}x_{3} + 9x_{2}^{2}\qquad} &amp; &amp; \qquad \\  &amp; {- 24x_{2}x_{3} + 16x_{3}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
<p><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">The equivalent Ising ground state problem would be</span></p>
<span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {- z_{0}z_{1} + \frac{3z_{0}z_{2}}{2} - 2z_{0}z_{3} + z_{0} - 3z_{1}z_{2} + 4z_{1}z_{3} - 2z_{1} - 6z_{2}z_{3} + 3z_{2} - 4z_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ 1, - 1\},\qquad j = 0,1,2,3,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1749.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {- z_{0}z_{1} + \frac{3z_{0}z_{2}}{2} - 2z_{0}z_{3} + z_{0} - 3z_{1}z_{2} + 4z_{1}z_{3} - 2z_{1} - 6z_{2}z_{3} + 3z_{2} - 4z_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ 1, - 1\},\qquad j = 0,1,2,3,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
<p><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">where we have dropped the independent term </span><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{17}{2}" class="math inline" src="../media/file1750.png" style="vertical-align:middle" title="\frac{17}{2}"/></span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-250026x6">
<p><strong><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml">(3.6)</span></strong><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml"> The binary linear program would be</span></p>
<span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 3x_{0} - x_{1} - 7x_{2} - 7x_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {2x_{0} + x_{1} + 5x_{2} + 4x_{3} \leq 8,\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1751.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 3x_{0} - x_{1} - 7x_{2} - 7x_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {2x_{0} + x_{1} + 5x_{2} + 4x_{3} \leq 8,\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
</div>
<div id="x1-250028x7">
<p><strong><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">(3.7)</span></strong><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml"> The QUBO problem is</span></p>
<span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {{(x_{00} + x_{01} - 1)}^{2} + {(x_{10} + x_{11} - 1)}^{2} + {(x_{20} + x_{21} - 1)}^{2} + {(x_{30} + x_{31} - 1)}^{2}\qquad} &amp; &amp; \qquad \\ &amp; {+ x_{00}x_{10} + x_{01}x_{11} + x_{00}x_{20} + x_{01}x_{21} + x_{10}x_{30} + x_{11}x_{31} + x_{20}x_{30} + x_{21}x_{31}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{jk} \in \{ 0,1\},\qquad j = 0,1,2,3,k = 0,1.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1752.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {{(x_{00} + x_{01} - 1)}^{2} + {(x_{10} + x_{11} - 1)}^{2} + {(x_{20} + x_{21} - 1)}^{2} + {(x_{30} + x_{31} - 1)}^{2}\qquad} &amp; &amp; \qquad \\  &amp; {+ x_{00}x_{10} + x_{01}x_{11} + x_{00}x_{20} + x_{01}x_{21} + x_{10}x_{30} + x_{11}x_{31} + x_{20}x_{30} + x_{21}x_{31}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{jk} \in \{ 0,1\},\qquad j = 0,1,2,3,k = 0,1.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
</div>
<div id="x1-250030x8">
<p><strong><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">(3.8)</span></strong><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml"> The expression for the route cost is</span></p>
<span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlr} {+ 2x_{00}x_{11} + x_{00}x_{21} + 3x_{00}x_{31} + 2x_{10}x_{01} + 4x_{10}x_{21} + x_{10}x_{31} + x_{20}x_{01}} &amp; \qquad &amp; \\ {+ 4x_{20}x_{11} + x_{20}x_{31} + 3x_{30}x_{01} + x_{30}x_{11} + x_{30}x_{21} + 2x_{01}x_{12} + x_{01}x_{22}} &amp; \qquad &amp; \\ {+ 3x_{01}x_{32} + 2x_{11}x_{02} + 4x_{11}x_{22} + x_{11}x_{32} + x_{21}x_{02} + 4x_{21}x_{12} + x_{21}x_{32}} &amp; \qquad &amp; \\ {+ 3x_{31}x_{02} + x_{31}x_{12} + x_{31}x_{22} + 2x_{02}x_{13} + x_{02}x_{23} + 3x_{02}x_{33} + 2x_{12}x_{03}} &amp; \qquad &amp; \\ {+ 4x_{12}x_{23} + x_{12}x_{33} + x_{22}x_{03} + 4x_{22}x_{13} + x_{22}x_{33} + 3x_{32}x_{03} + x_{32}x_{13} + x_{32}x_{23}.} &amp; \qquad &amp; \\ \end{array}" class="math display" src="../media/file1753.png" style="vertical-align:middle" title="\begin{array}{rlr} {+ 2x_{00}x_{11} + x_{00}x_{21} + 3x_{00}x_{31} + 2x_{10}x_{01} + 4x_{10}x_{21} + x_{10}x_{31} + x_{20}x_{01}} &amp; \qquad &amp; \\ {+ 4x_{20}x_{11} + x_{20}x_{31} + 3x_{30}x_{01} + x_{30}x_{11} + x_{30}x_{21} + 2x_{01}x_{12} + x_{01}x_{22}} &amp; \qquad &amp; \\ {+ 3x_{01}x_{32} + 2x_{11}x_{02} + 4x_{11}x_{22} + x_{11}x_{32} + x_{21}x_{02} + 4x_{21}x_{12} + x_{21}x_{32}} &amp; \qquad &amp; \\ {+ 3x_{31}x_{02} + x_{31}x_{12} + x_{31}x_{22} + 2x_{02}x_{13} + x_{02}x_{23} + 3x_{02}x_{33} + 2x_{12}x_{03}} &amp; \qquad &amp; \\ {+ 4x_{12}x_{23} + x_{12}x_{33} + x_{22}x_{03} + 4x_{22}x_{13} + x_{22}x_{33} + 3x_{32}x_{03} + x_{32}x_{13} + x_{32}x_{23}.} &amp; \qquad &amp; \\ \end{array}"/></span>
</div>
</section>
<section class="level2 sectionHead" data-number="28.4" id="f.4-chapter-4-adiabatic-quantum-computing-and-quantum-annealing">
<h1 class="sectionHead" data-number="28.4"> <span id="x1-251000F.4"><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4, Adiabatic Quantum Computing and Quantum Annealing</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">(4.1)</span></strong><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml"> We first consider a state </span><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle = \left| x_{0} \right\rangle\left| x_{1} \right\rangle\cdots\left| x_{n - 1} \right\rangle" class="math inline" src="../media/file1754.png" style="vertical-align:middle" title="\left| x \right\rangle = \left| x_{0} \right\rangle\left| x_{1} \right\rangle\cdots\left| x_{n - 1} \right\rangle"/></span><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml"> where each </span><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{j} \right\rangle" class="math inline" src="../media/file1755.png" style="vertical-align:middle" title="\left| x_{j} \right\rangle"/></span><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml"> is either </span><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| + \right\rangle" class="math inline" src="../media/file61.png" style="vertical-align:middle" title="\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| - \right\rangle" class="math inline" src="../media/file63.png" style="vertical-align:middle" title="\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.541.2" xmlns="http://www.w3.org/1999/xhtml">The set of all </span><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml"> such states for an orthonormal basis and, hence, any generic state </span><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"> can be written as </span><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = {\sum}_{x}a_{x}\left| x \right\rangle," class="math inline" src="../media/file1756.png" style="vertical-align:middle" title="\left| \psi \right\rangle = {\sum}_{x}a_{x}\left| x \right\rangle,"/></span><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml"> where </span><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \sum \middle| a_{x}|^{2} = 1 \right." class="math inline" src="../media/file1757.png" style="vertical-align:middle" title="\left. \sum \middle| a_{x}|^{2} = 1 \right."/></span><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml">Then, for each </span><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that</span></p>
<p><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|X_{j}\left| x \right\rangle = \left\langle x_{j} \right|X_{j}\left| x_{j} \right\rangle." class="math display" src="../media/file1758.png" style="vertical-align:middle" title="\left\langle x \right|X_{j}\left| x \right\rangle = \left\langle x_{j} \right|X_{j}\left| x_{j} \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">But </span><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x_{j} \right|X_{j}\left| x_{j} \right\rangle" class="math inline" src="../media/file1759.png" style="vertical-align:middle" title="\left\langle x_{j} \right|X_{j}\left| x_{j} \right\rangle"/></span><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{j} \right\rangle = \left| + \right\rangle" class="math inline" src="../media/file1760.png" style="vertical-align:middle" title="\left| x_{j} \right\rangle = \left| + \right\rangle"/></span><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml"> and it is </span><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{j} \right\rangle = \left| - \right\rangle" class="math inline" src="../media/file1761.png" style="vertical-align:middle" title="\left| x_{j} \right\rangle = \left| - \right\rangle"/></span><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.564.2" xmlns="http://www.w3.org/1999/xhtml">Hence, it holds that </span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left\langle \psi \right|X_{j}\left| \psi \right\rangle = \sum\limits_{x} \middle| a_{x}|^{2}\left\langle x \right|X_{j}\left| x \right\rangle \leq 1, \right." class="math display" src="../media/file1762.png" style="vertical-align:middle" title="\left. \left\langle \psi \right|X_{j}\left| \psi \right\rangle = \sum\limits_{x} \middle| a_{x}|^{2}\left\langle x \right|X_{j}\left| x \right\rangle \leq 1, \right."/></span><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml"> because </span><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| a_{x}|^{2} \geq 0 \right." class="math inline" src="../media/file1763.png" style="vertical-align:middle" title="\left| a_{x}|^{2} \geq 0 \right."/></span><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml"> for every </span><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \sum \middle| a_{x}|^{2} = 1 \right." class="math inline" src="../media/file1757.png" style="vertical-align:middle" title="\left. \sum \middle| a_{x}|^{2} = 1 \right."/></span><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">Then, since </span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}" class="math inline" src="../media/file555.png" style="vertical-align:middle" title="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}"/></span><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">, by linearity we have </span><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{0}\left| \psi \right\rangle = - \sum\limits_{j = 0}^{n - 1}\left\langle \psi \right|X_{j}\left| \psi \right\rangle \geq - n." class="math display" src="../media/file1764.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{0}\left| \psi \right\rangle = - \sum\limits_{j = 0}^{n - 1}\left\langle \psi \right|X_{j}\left| \psi \right\rangle \geq - n."/></span></p>
<p><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, if we consider </span><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle = {\otimes}_{i = 0}^{n - 1}\left| + \right\rangle" class="math inline" src="../media/file558.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle = {\otimes}_{i = 0}^{n - 1}\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">, by the previous reasoning we have that </span><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi_{0} \right|X_{j}\left| \psi_{0} \right\rangle = 1" class="math inline" src="../media/file560.png" style="vertical-align:middle" title="\left\langle \psi_{0} \right|X_{j}\left| \psi_{0} \right\rangle = 1"/></span><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.581.2" xmlns="http://www.w3.org/1999/xhtml">Hence, </span><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi_{0} \right|H_{0}\left| \psi_{0} \right\rangle = - n" class="math inline" src="../media/file1765.png" style="vertical-align:middle" title="\left\langle \psi_{0} \right|H_{0}\left| \psi_{0} \right\rangle = - n"/></span><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">, which is the minimum possible value and, hence, </span><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml"> is the ground state that we were looking for.</span></p>
<p><strong><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">(4.2)</span></strong><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"> We can define the QUBO problem of minimizing </span><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}x_{2} - x_{0}x_{1} + 2x_{1}" class="math inline" src="../media/file1766.png" style="vertical-align:middle" title="x_{0}x_{2} - x_{0}x_{1} + 2x_{1}"/></span><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"> with the following code:</span></p>
<div id="x1-251003x0">
<pre class="lstlisting" id="listing-369"><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">

import dimod 
 
J = {(0,1):-1, (0,2):1} 
 
h = {1:2} 
 
problem = dimod.BinaryQuadraticModel(h, J, 0.0, dimod.BINARY) 
 
print("The problem we are going to solve is:") 
 
print(problem)
</span></pre>
<p><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">We can then solve it with the following:</span></p>
<pre class="lstlisting" id="listing-370"><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">

from dwave.system import DWaveSampler 
 
from dwave.system import EmbeddingComposite 
 
sampler = EmbeddingComposite(DWaveSampler()) 
 
result = sampler.sample(problem, num_reads=10) 
 
print("The solutions that we have obtained are") 
 
print(result)
</span></pre>
</div>
<div id="x1-251018x3">
<p><strong><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">(4.3)</span></strong><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml"> For simplicity, we will denote the slack variables as </span><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s_{0}" class="math inline" src="../media/file1767.png" style="vertical-align:middle" title="s_{0}"/></span><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="s_{1}" class="math inline" src="../media/file1768.png" style="vertical-align:middle" title="s_{1}"/></span><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.598.2" xmlns="http://www.w3.org/1999/xhtml">Then, the penalty term is </span><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(y_{0} + 2y_{1} + s_{0} + s_{1} - 2)}^{2}" class="math inline" src="../media/file1769.png" style="vertical-align:middle" title="{(y_{0} + 2y_{1} + s_{0} + s_{1} - 2)}^{2}"/></span><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.600.2" xmlns="http://www.w3.org/1999/xhtml">When you multiply by 5, expand it, and add it to the cost function, you obtain exactly the expression computed by the </span><code><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml">cqm_to_bqm</span></code><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml"> method.</span></p>
</div>
<div id="x1-251020x4">
<p><strong><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">(4.4)</span></strong><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml"> For qubits </span><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml"> through </span><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml">, we have the following connections:</span></p>
<pre class="lstlisting" id="listing-371"><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml">

{0: {4, 5, 6, 7, 128}, 1: {4, 5, 6, 7, 129}, 
 
 2: {4, 5, 6, 7, 130}, 3: {4, 5, 6, 7, 131}, 
 
 4: {0, 1, 2, 3, 12}, 5: {0, 1, 2, 3, 13}, 
 
 6: {0, 1, 2, 3, 14}, 7: {0, 1, 2, 3, 15}}
</span></pre>
<p><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml">Clearly, each vertex from </span><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml"> is connected to each from </span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">, as we need. </span><span class="koboSpan" id="kobo.618.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, each vertex from </span><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml"> is connected to one vertex from </span><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="128" class="math inline" src="../media/file563.png" style="vertical-align:middle" title="128"/></span><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="131" class="math inline" src="../media/file1770.png" style="vertical-align:middle" title="131"/></span><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">, which are in the cell below the first one, and each vertex from </span><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml"> is connected to one vertex from </span><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="12" class="math inline" src="../media/file601.png" style="vertical-align:middle" title="12"/></span><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="15" class="math inline" src="../media/file599.png" style="vertical-align:middle" title="15"/></span><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml">, which are in the cell to the right of the first one.</span></p>
</div>
<div id="x1-251026x5">
<p><strong><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml">(4.5)</span></strong><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml"> You can easily check those values with the following instructions:</span></p>
<pre class="lstlisting" id="listing-372"><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml">

sampler = DWaveSampler(solver = "DW_2000Q_6") 
 
print("The default annealing time is", 
 
    sampler.properties["default_annealing_time"],"microsends") 
 
print("The possible values for the annealing time (in microseconds)"\ 
 
    " lie in the range",sampler.properties["annealing_time_range"])
</span></pre>
<p><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">The output, in this case, will be as follows:</span></p>
<pre class="lstlisting" id="listing-373"><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml">

The default annealing time is 20.0 microsends 
 
The possible values for the annealing time (in microseconds) 
 
    lie in the range [1.0, 2000.0]
</span></pre>
</div>
</section>
<section class="level2 sectionHead" data-number="28.5" id="f.5-chapter-5-qaoa-quantum-approximate-optimization-algorithm">
<h1 class="sectionHead" data-number="28.5"> <span id="x1-252000F.5"><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 5, QAOA: Quantum Approximate Optimization Algorithm</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml">(5.1)</span></strong><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml"> The QAOA circuit for </span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{1}Z_{3} + Z_{0}Z_{2} - 2Z_{1} + 3Z_{2}" class="math inline" src="../media/file689.png" style="vertical-align:middle" title="Z_{1}Z_{3} + Z_{0}Z_{2} - 2Z_{1} + 3Z_{2}"/></span><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 1" class="math inline" src="../media/file676.png" style="vertical-align:middle" title="p = 1"/></span><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml"> is the following:</span><br/>
<br/>
</p>
<div id="x1-252002x1">
<p><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HRHRRHRRRHRR ((âˆ’((2(6((2(22Î³Î³2Î³2Î²4Î²Î²Î²Î³)))))))) XZXZZXZX 11111111 " src="../media/file1771.jpg"/></span></p>
</div>
<div id="x1-252004x2">
<p><strong><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">(5.2)</span></strong><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that</span></p>
<span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|H_{1}\left| {100} \right\rangle = 3\left\langle {100} \right|Z_{0}Z_{2}\left| {100} \right\rangle - \left\langle {100} \right|Z_{1}Z_{2}\left| {100} \right\rangle + 2\left\langle {100} \right|Z_{0}\left| {100} \right\rangle = - 3 - 1 - 2 = - 6." class="math display" src="../media/file1772.png" style="vertical-align:middle" title="\left\langle {100} \right|H_{1}\left| {100} \right\rangle = 3\left\langle {100} \right|Z_{0}Z_{2}\left| {100} \right\rangle - \left\langle {100} \right|Z_{1}Z_{2}\left| {100} \right\rangle + 2\left\langle {100} \right|Z_{0}\left| {100} \right\rangle = - 3 - 1 - 2 = - 6."/></span>
</div>
<div id="x1-252006x3">
<p><strong><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">(5.3)</span></strong><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml"> We can rewrite the problem as</span></p>
<span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {(1 - x_{0})(1 - x_{1})x_{2}(1 - x_{3}) + x_{0}(1 - x_{1})(1 - x_{2})(1 - x_{3}) + x_{0}(1 - x_{1})x_{2}x_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ &amp; \qquad &amp; &amp; \\ \end{array}" class="math display" src="../media/file1773.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {(1 - x_{0})(1 - x_{1})x_{2}(1 - x_{3}) + x_{0}(1 - x_{1})(1 - x_{2})(1 - x_{3}) + x_{0}(1 - x_{1})x_{2}x_{3}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\  &amp; \qquad &amp; &amp; \\ \end{array}"/></span>
</div>
<div id="x1-252008x4">
<p><strong><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml">(5.4)</span></strong><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml"> The operation can be implemented with the following circuit:</span><br/>
<br/>
</p>
<div class="center">
<p><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="|||||RxxxxxZ01234âŸ©âŸ©âŸ©âŸ©âŸ©(Ï€2) " src="../media/file1774.jpg"/></span></p>
</div>
</div>
<div id="x1-252010x5">
<p><strong><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">(5.5)</span></strong><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that</span></p>
<span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle {100} \right|H_{1}\left| {100} \right\rangle} &amp; {= \left\langle {100} \right|Z_{0}Z_{1}Z_{2}\left| {100} \right\rangle + 3\left\langle {100} \right|Z_{0}Z_{2}\left| {100} \right\rangle - \left\langle {100} \right|Z_{1}Z_{2}\left| {100} \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {+ 2\left\langle {100} \right|Z_{0}\left| {100} \right\rangle = - 1 - 3 - 1 - 2 = - 7.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file1775.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle {100} \right|H_{1}\left| {100} \right\rangle} &amp; {= \left\langle {100} \right|Z_{0}Z_{1}Z_{2}\left| {100} \right\rangle + 3\left\langle {100} \right|Z_{0}Z_{2}\left| {100} \right\rangle - \left\langle {100} \right|Z_{1}Z_{2}\left| {100} \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {+ 2\left\langle {100} \right|Z_{0}\left| {100} \right\rangle = - 1 - 3 - 1 - 2 = - 7.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span>
</div>
<div id="x1-252012x6">
<p><strong><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">(5.6)</span></strong><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml"> You can use the following code to obtain reproducible results:</span></p>
<pre class="lstlisting" id="listing-374"><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import Aer 
 
from qiskit.algorithms import QAOA 
 
from qiskit.algorithms.optimizers import COBYLA 
 
from qiskit.utils import algorithm_globals, QuantumInstance 
 
from qiskit_optimization.algorithms import MinimumEigenOptimizer 
 
 
 
seed = 1234 
 
algorithm_globals.random_seed = seed 
 
quantum_instance = QuantumInstance(Aer.get_backend("aer_simulator"), 
 
    shots = 1024, seed_simulator=seed, seed_transpiler=seed) 
 
qaoa = QAOA(optimizer = COBYLA(), 
 
            quantum_instance=quantum_instance, reps = 1) 
 
qaoa_optimizer = MinimumEigenOptimizer(qaoa) 
 
result = qaoa_optimizer.solve(qp) 
 
print(â€™Variable order:â€™, [var.name for var in result.variables]) 
 
for s in result.samples: 
 
    print(s)
</span></pre>
</div>
<div id="x1-252031x7">
<p><strong><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">(5.7)</span></strong><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml"> We can define the </span><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 3Z_{0}Z_{1}Z_{2} + 2Z_{1}Z_{2} - Z_{2}" class="math inline" src="../media/file773.png" style="vertical-align:middle" title="- 3Z_{0}Z_{1}Z_{2} + 2Z_{1}Z_{2} - Z_{2}"/></span><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian using the following instructions:</span></p>
<pre class="lstlisting" id="listing-375"><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">

coefficients = [-3,2,-1] 
 
paulis = [PauliZ(0)@PauliZ(1)@PauliZ(2), 
 
    PauliZ(1)@PauliZ(2),PauliZ(2)] 
 
H = qml.Hamiltonian(coefficients,paulis)
</span></pre>
<p><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">We can also use</span></p>
<pre class="lstlisting" id="listing-376"><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml">

H = -3*PauliZ(0)@PauliZ(1)@PauliZ(2) 
 
    + 2*PauliZ(1)@PauliZ(2) -PauliZ(2)
</span></pre>
</div>
</section>
<section class="level2 sectionHead" data-number="28.6" id="f.6-chapter-6-gas-grover-adaptative-search">
<h1 class="sectionHead" data-number="28.6"> <span id="x1-253000F.6"><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 6, GAS: Grover Adaptative Search</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">(6.1)</span></strong><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml"> From our definition, </span><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml"> always takes one basis state to another basis state. </span><span class="koboSpan" id="kobo.674.2" xmlns="http://www.w3.org/1999/xhtml">Hence, in matrix representation, its columns are vectors in which exactly one element is </span><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml"> and the rest are </span><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.678.2" xmlns="http://www.w3.org/1999/xhtml">This means that, in particular, all its entries are real.</span></p>
<p><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">What is more, this matrix is symmetric. </span><span class="koboSpan" id="kobo.679.2" xmlns="http://www.w3.org/1999/xhtml">To prove this, suppose that the matrix has entries </span><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{jk}" class="math inline" src="../media/file1776.png" style="vertical-align:middle" title="m_{jk}"/></span><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.681.2" xmlns="http://www.w3.org/1999/xhtml">If it is not symmetric, there exist </span><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j,k" class="math inline" src="../media/file1777.png" style="vertical-align:middle" title="j,k"/></span><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{jk} \neq m_{kj}" class="math inline" src="../media/file1778.png" style="vertical-align:middle" title="m_{jk} \neq m_{kj}"/></span><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.685.2" xmlns="http://www.w3.org/1999/xhtml">We can suppose, without loss of generality, that </span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{jk} = 0" class="math inline" src="../media/file1779.png" style="vertical-align:middle" title="m_{jk} = 0"/></span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{kj} = 1" class="math inline" src="../media/file1780.png" style="vertical-align:middle" title="m_{kj} = 1"/></span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.689.2" xmlns="http://www.w3.org/1999/xhtml">We also know that </span><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}O_{f} = I" class="math inline" src="../media/file1781.png" style="vertical-align:middle" title="O_{f}O_{f} = I"/></span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml">, so the square of the matrix is the identity. </span><span class="koboSpan" id="kobo.691.2" xmlns="http://www.w3.org/1999/xhtml">In particular, </span><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{l}m_{jl}m_{lj} = 1" class="math inline" src="../media/file1782.png" style="vertical-align:middle" title="{\sum}_{l}m_{jl}m_{lj} = 1"/></span><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml">, because this is the element in row </span><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml">, column </span><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml"> of the square of the matrix. </span><span class="koboSpan" id="kobo.697.2" xmlns="http://www.w3.org/1999/xhtml">But we know that </span><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{jk}m_{kj} = 0 \cdot 1 = 0" class="math inline" src="../media/file1783.png" style="vertical-align:middle" title="m_{jk}m_{kj} = 0 \cdot 1 = 0"/></span><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{lj} = 0" class="math inline" src="../media/file1784.png" style="vertical-align:middle" title="m_{lj} = 0"/></span><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l \neq k" class="math inline" src="../media/file1785.png" style="vertical-align:middle" title="l \neq k"/></span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml">, because there is a single </span><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml"> in each column. </span><span class="koboSpan" id="kobo.705.2" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, then, </span><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{l}m_{jl}m_{lj} = 0" class="math inline" src="../media/file1786.png" style="vertical-align:middle" title="{\sum}_{l}m_{jl}m_{lj} = 0"/></span><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">, which is a contradiction.</span></p>
<p><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml">Thus, we have </span><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}^{\dagger} = O_{f}" class="math inline" src="../media/file1787.png" style="vertical-align:middle" title="O_{f}^{\dagger} = O_{f}"/></span><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml"> and, since </span><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}O_{f} = I" class="math inline" src="../media/file1781.png" style="vertical-align:middle" title="O_{f}O_{f} = I"/></span><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">, it follows that </span><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="O_{f}" class="math inline" src="../media/file791.png" style="vertical-align:middle" title="O_{f}"/></span><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml"> is unitary.</span></p>
<p><strong><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml">(6.2)</span></strong><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following circuit:</span></p>
<div id="x1-253003x2">
<p><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="XXXXXXXX " src="../media/file1788.jpg"/></span></p>
</div>
<div id="x1-253005x3">
<p><strong><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml">(6.3)</span></strong><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml"> The representation of </span><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="01010" class="math inline" src="../media/file1789.png" style="vertical-align:middle" title="01010"/></span><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml"> and the representation of </span><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 7" class="math inline" src="../media/file470.png" style="vertical-align:middle" title="- 7"/></span><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="11001" class="math inline" src="../media/file1790.png" style="vertical-align:middle" title="11001"/></span><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.727.2" xmlns="http://www.w3.org/1999/xhtml">Their addition is </span><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="00011" class="math inline" src="../media/file1791.png" style="vertical-align:middle" title="00011"/></span><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">, which encodes </span><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-253007x4">
<p><strong><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">(6.4)</span></strong><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following circuit:</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="HPPHPPHPPHPP((((((((6âˆ’6âˆ’6âˆ’6âˆ’Ï€Ï€Ï€Ï€)4444Ï€)Ï€)Ï€)Ï€)))) 248248 " src="../media/file1792.jpg"/></span></p>
</div>
</div>
<div id="x1-253009x5">
<p><strong><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">(6.5)</span></strong><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following circuit:</span></p>
<div class="center">
<p><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=" Ï€Ï€Ï€Ï€ Ï€Ï€ |x|x|x|0HPPP|0HPPP|0HPPP012âŸ©(((âŸ©(((âŸ©(((âŸ©âŸ©âŸ©2âˆ’Ï€2âˆ’22âˆ’4Ï€)2)4))3)3)3Ï€24))) " src="../media/file1793.jpg"/></span></p>
</div>
</div>
<div id="x1-253011x6">
<p><strong><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml">(6.6)</span></strong><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following code:</span></p>
<span id="x1-253012"/>
<pre class="lstlisting" id="listing-377"><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.problems import QuadraticProgram 
 
from qiskit_optimization.algorithms import GroverOptimizer 
 
from qiskit import Aer 
 
from qiskit.utils import algorithm_globals, QuantumInstance 
 
seed = 1234 
 
algorithm_globals.random_seed = seed 
 
 
 
qp = QuadraticProgram() 
 
qp.binary_var(â€™xâ€™) 
 
qp.binary_var(â€™yâ€™) 
 
qp.binary_var(â€™zâ€™) 
 
qp.minimize(linear = {â€™xâ€™:3,â€™yâ€™:2,â€™zâ€™:-3}, quadratic = {(â€™xâ€™,â€™yâ€™):3}) 
 
 
 
quantum_instance = QuantumInstance(Aer.get_backend("aer_simulator"), 
 
    shots = 1024, seed_simulator = seed, seed_transpiler=seed) 
 
grover_optimizer = GroverOptimizer(num_value_qubits = 5, 
 
    num_iterations=4, quantum_instance=quantum_instance) 
 
results = grover_optimizer.solve(qp) 
 
print(results)
</span></pre>
</div>
</section>
<section class="level2 sectionHead" data-number="28.7" id="f.7-chapter-7-vqe-variational-quantum-eigensolver">
<h1 class="sectionHead" data-number="28.7"> <span id="x1-254000F.7"><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 7, VQE: Variational Quantum Eigensolver</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml">(7.1)</span></strong><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml"> This all follows from the fact that the matrix is diagonal and all its diagonal entries are different, with eigenvalues corresponding to the actual labels of the measurement outcomes.</span></p>
<p><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">Remember that, if the coordinate matrix of an operator with respect to a basis is diagonal, this means that the basis vectors are eigenvectors of the operator and, what is more, the corresponding eigenvalues are found on the diagonal.</span></p>
<p><strong><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">(7.2)</span></strong><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml"> We know that</span></p>
<p><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( {A_{1} \otimes \cdots \otimes A_{n}} \right)\left| \lambda_{1} \right\rangle \otimes \cdots \otimes \left| \lambda_{n} \right\rangle = A_{1}\left| \lambda_{1} \right\rangle \otimes \cdots \otimes A_{n}\left| \lambda_{n} \right\rangle." class="math display" src="../media/file1794.png" style="vertical-align:middle" title="\left( {A_{1} \otimes \cdots \otimes A_{n}} \right)\left| \lambda_{1} \right\rangle \otimes \cdots \otimes \left| \lambda_{n} \right\rangle = A_{1}\left| \lambda_{1} \right\rangle \otimes \cdots \otimes A_{n}\left| \lambda_{n} \right\rangle."/></span><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml"> Since </span><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{j}\left| \lambda_{j} \right\rangle = \lambda_{j}\left| \lambda_{j} \right\rangle" class="math inline" src="../media/file1795.png" style="vertical-align:middle" title="A_{j}\left| \lambda_{j} \right\rangle = \lambda_{j}\left| \lambda_{j} \right\rangle"/></span><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml">, the result follows directly.</span></p>
<p><strong><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">(7.3)</span></strong><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that </span><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z\left| 0 \right\rangle = \left| 0 \right\rangle" class="math inline" src="../media/file67.png" style="vertical-align:middle" title="Z\left| 0 \right\rangle = \left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z\left| 1 \right\rangle = - \left| 1 \right\rangle" class="math inline" src="../media/file68.png" style="vertical-align:middle" title="Z\left| 1 \right\rangle = - \left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X\left| + \right\rangle = \left| + \right\rangle" class="math inline" src="../media/file1673.png" style="vertical-align:middle" title="X\left| + \right\rangle = \left| + \right\rangle"/></span><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X\left| - \right\rangle = - \left| - \right\rangle" class="math inline" src="../media/file1674.png" style="vertical-align:middle" title="X\left| - \right\rangle = - \left| - \right\rangle"/></span><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right) = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1796.png" style="vertical-align:middle" title="Y\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right) = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right) = - \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1797.png" style="vertical-align:middle" title="Y\left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right) = - \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml">Since it is also true that </span><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I\left| \psi \right\rangle = \left| \psi \right\rangle" class="math inline" src="../media/file1798.png" style="vertical-align:middle" title="I\left| \psi \right\rangle = \left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml"> for any </span><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">, the result follows.</span></p>
<p><strong><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">(7.4)</span></strong><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml"> A possible orthonormal basis of eigenvectors of </span><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes I \otimes X" class="math inline" src="../media/file975.png" style="vertical-align:middle" title="Z \otimes I \otimes X"/></span><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml"> is formed by </span><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 0 \right\rangle\left| + \right\rangle" class="math inline" src="../media/file1799.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 0 \right\rangle\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 1 \right\rangle\left| - \right\rangle" class="math inline" src="../media/file1800.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 1 \right\rangle\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| 0 \right\rangle\left| - \right\rangle" class="math inline" src="../media/file1801.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| 0 \right\rangle\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| 1 \right\rangle\left| + \right\rangle" class="math inline" src="../media/file1802.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| 1 \right\rangle\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 0 \right\rangle\left| - \right\rangle" class="math inline" src="../media/file1803.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 0 \right\rangle\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| 1 \right\rangle\left| + \right\rangle" class="math inline" src="../media/file1804.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| 1 \right\rangle\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| 0 \right\rangle\left| + \right\rangle" class="math inline" src="../media/file1805.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| 0 \right\rangle\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| 1 \right\rangle\left| - \right\rangle" class="math inline" src="../media/file1806.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| 1 \right\rangle\left| - \right\rangle"/></span><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.789.2" xmlns="http://www.w3.org/1999/xhtml">The first four eigenvectors are associated with the </span><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml"> eigenvalue, and the rest with the </span><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml"> eigenvalue.</span></p>
<p><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml">Letâ€™s denote, for simplicity, </span><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| i \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1807.png" style="vertical-align:middle" title="\left| i \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {- i} \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1808.png" style="vertical-align:middle" title="\left| {- i} \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.798.2" xmlns="http://www.w3.org/1999/xhtml">Then, a possible orthonormal basis of eigenvalues for </span><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I \otimes Y \otimes Y" class="math inline" src="../media/file976.png" style="vertical-align:middle" title="I \otimes Y \otimes Y"/></span><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| i \right\rangle\left| i \right\rangle" class="math inline" src="../media/file1809.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| i \right\rangle\left| i \right\rangle"/></span><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| {- i} \right\rangle\left| {- i} \right\rangle" class="math inline" src="../media/file1810.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| {- i} \right\rangle\left| {- i} \right\rangle"/></span><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| i \right\rangle\left| {- i} \right\rangle" class="math inline" src="../media/file1811.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| i \right\rangle\left| {- i} \right\rangle"/></span><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| {- i} \right\rangle\left| i \right\rangle" class="math inline" src="../media/file1812.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| {- i} \right\rangle\left| i \right\rangle"/></span><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| i \right\rangle\left| {- i} \right\rangle" class="math inline" src="../media/file1813.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| i \right\rangle\left| {- i} \right\rangle"/></span><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left| {- i} \right\rangle\left| i \right\rangle" class="math inline" src="../media/file1814.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left| {- i} \right\rangle\left| i \right\rangle"/></span><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| i \right\rangle\left| i \right\rangle" class="math inline" src="../media/file1815.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| i \right\rangle\left| i \right\rangle"/></span><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left| {- i} \right\rangle\left| {- i} \right\rangle" class="math inline" src="../media/file1816.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left| {- i} \right\rangle\left| {- i} \right\rangle"/></span><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.816.2" xmlns="http://www.w3.org/1999/xhtml">The first four eigenvectors are associated to the </span><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml"> eigenvalue and the rest, to the </span><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml"> eigenvalue.</span></p>
<p><strong><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml">(7.5)</span></strong><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml"> It holds that </span><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H\left| 0 \right\rangle = \left| + \right\rangle" class="math inline" src="../media/file1817.png" style="vertical-align:middle" title="H\left| 0 \right\rangle = \left| + \right\rangle"/></span><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H\left| 1 \right\rangle = \left| - \right\rangle" class="math inline" src="../media/file1818.png" style="vertical-align:middle" title="H\left| 1 \right\rangle = \left| - \right\rangle"/></span><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.826.2" xmlns="http://www.w3.org/1999/xhtml">This proves that </span><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml"> takes the computational basis to the eigenvectors of </span><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.830.2" xmlns="http://www.w3.org/1999/xhtml">Also, </span><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SH\left| 0 \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1819.png" style="vertical-align:middle" title="SH\left| 0 \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle + i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SH\left| 1 \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)" class="math inline" src="../media/file1820.png" style="vertical-align:middle" title="SH\left| 1 \right\rangle = \left( 1\slash\sqrt{2} \right)\left( {\left| 0 \right\rangle - i\left| 1 \right\rangle} \right)"/></span><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">, so </span><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="SH" class="math inline" src="../media/file1023.png" style="vertical-align:middle" title="SH"/></span><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml"> takes the computational basis to the eigenvectors of </span><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y" class="math inline" src="../media/file11.png" style="vertical-align:middle" title="Y"/></span><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml">(7.6)</span></strong><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml"> This follows directly from the fact that if </span><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| u_{j} \right\rangle\}}_{j}" class="math inline" src="../media/file1821.png" style="vertical-align:middle" title="{\{\left| u_{j} \right\rangle\}}_{j}"/></span><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| v_{k} \right\rangle\}}_{k}" class="math inline" src="../media/file1822.png" style="vertical-align:middle" title="{\{\left| v_{k} \right\rangle\}}_{k}"/></span><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml"> are eigenvector bases of </span><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{1}" class="math inline" src="../media/file1024.png" style="vertical-align:middle" title="A_{1}"/></span><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{2}" class="math inline" src="../media/file1025.png" style="vertical-align:middle" title="A_{2}"/></span><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml">, respectively, then </span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\{\left| u_{j} \right\rangle \otimes \left| v_{k} \right\rangle\}}_{j,k}" class="math inline" src="../media/file1823.png" style="vertical-align:middle" title="{\{\left| u_{j} \right\rangle \otimes \left| v_{k} \right\rangle\}}_{j,k}"/></span><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml"> is an eigenvector basis of </span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A_{1} \otimes A_{2}" class="math inline" src="../media/file1026.png" style="vertical-align:middle" title="A_{1} \otimes A_{2}"/></span><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">(7.7)</span></strong><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml"> The Hamiltonian for our problem is </span><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H = Z_{0}Z_{1} + Z_{1}Z_{2} + Z_{2}Z_{3} + Z_{3}Z_{4} + Z_{4}Z_{0}." class="math display" src="../media/file1824.png" style="vertical-align:middle" title="H = Z_{0}Z_{1} + Z_{1}Z_{2} + Z_{2}Z_{3} + Z_{3}Z_{4} + Z_{4}Z_{0}."/></span><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml"> Then, we can use the following code to solve it with VQE:</span></p>
<div id="x1-254008x0">
<pre class="lstlisting" id="listing-378"><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.circuit.library import EfficientSU2 
 
from qiskit.algorithms import VQE 
 
from qiskit import Aer 
 
from qiskit.utils import QuantumInstance 
 
import numpy as np 
 
from qiskit.algorithms.optimizers import COBYLA 
 
from qiskit.opflow import Z, I 
 
 
 
seed = 1234 
 
np.random.seed(seed) 
 
 
 
H= (Z^Z^I^I^I) + (I^Z^Z^I^I) + (I^I^Z^Z^I) + (I^I^I^Z^Z) + (Z^I^I^I^Z) 
 
 
 
ansatz = EfficientSU2(num_qubits=5, reps=1, entanglement="linear", 
 
    insert_barriers = True) 
 
optimizer = COBYLA() 
 
initial_point = np.random.random(ansatz.num_parameters) 
 
quantum_instance = QuantumInstance(backend = 
 
    Aer.get_backend(â€™aer_simulator_statevectorâ€™)) 
 
vqe = VQE(ansatz=ansatz, optimizer=optimizer, 
 
    initial_point=initial_point, 
 
    quantum_instance=quantum_instance) 
 
result = vqe.compute_minimum_eigenvalue(H) 
 
print(result)
</span></pre>
</div>
<div id="x1-254035x8">
<p><strong><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml">(7.8)</span></strong><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following code:</span></p>
<pre class="lstlisting" id="listing-379"><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_nature.drivers import Molecule 
 
from qiskit_nature.drivers.second_quantization import \ 
 
    ElectronicStructureMoleculeDriver, ElectronicStructureDriverType 
 
from qiskit_nature.problems.second_quantization import \ 
 
    ElectronicStructureProblem 
 
from qiskit_nature.converters.second_quantization import QubitConverter 
 
from qiskit_nature.mappers.second_quantization import JordanWignerMapper 
 
from qiskit_nature.algorithms import VQEUCCFactory 
 
from qiskit import Aer 
 
from qiskit.utils import QuantumInstance 
 
from qiskit_nature.algorithms import GroundStateEigensolver 
 
import matplotlib.pyplot as plt 
 
import numpy as np 
 
 
 
quantum_instance = QuantumInstance( 
 
    backend = Aer.get_backend(â€™aer_simulator_statevectorâ€™)) 
 
 
 
vqeuccf = VQEUCCFactory(quantum_instance = quantum_instance) 
 
 
 
qconverter = QubitConverter(JordanWignerMapper()) 
 
solver = GroundStateEigensolver(qconverter, vqeuccf) 
 
 
 
energies = [] 
 
distances = np.arange(0.2, 2.01, 0.01) 
 
for d in distances: 
 
  mol = Molecule(geometry=[[â€™Hâ€™, [0., 0., -d/2]], 
 
                              [â€™Hâ€™, [0., 0., d/2]]]) 
 
 
 
  driver = ElectronicStructureMoleculeDriver(mol, basis=â€™sto3gâ€™, 
 
        driver_type=ElectronicStructureDriverType.PYSCF) 
 
  problem = ElectronicStructureProblem(driver) 
 
  result = solver.solve(problem) 
 
  energies.append(result.total_energies) 
 
 
 
plt.plot(distances, energies) 
 
plt.title(â€™Dissociation profileâ€™) 
 
plt.xlabel(â€™Distanceâ€™) 
 
plt.ylabel(â€™Energyâ€™);
</span></pre>
</div>
<div id="x1-254075x9">
<p><strong><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml">(7.9)</span></strong><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following code:</span></p>
<pre class="lstlisting" id="listing-380"><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import * 
 
from qiskit.providers.aer import AerSimulator 
 
from qiskit.utils.mitigation import CompleteMeasFitter 
 
from qiskit.utils import QuantumInstance 
 
 
 
provider = IBMQ.load_account() 
 
backend = AerSimulator.from_backend( 
 
    provider.get_backend(â€™ibmq_manilaâ€™)) 
 
 
 
shots = 1024 
 
 
 
qc = QuantumCircuit(2,2) 
 
qc.h(0) 
 
qc.cx(0,1) 
 
qc.measure(range(2),range(2)) 
 
 
 
result = execute(qc, backend, shots = shots) 
 
print("Result of noisy simulation:") 
 
print(result.result().get_counts()) 
 
 
 
quantum_instance = QuantumInstance( 
 
    backend = backend, shots = shots, 
 
    measurement_error_mitigation_cls=CompleteMeasFitter) 
 
 
 
result = quantum_instance.execute(qc) 
 
print("Result of noisy simulation with error mitigation:") 
 
print(result.get_counts())
</span></pre>
<p><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml">Our results when running these instructions were the following:</span></p>
<pre class="lstlisting" id="listing-381"><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml">

Result of noisy simulation: 
 
{â€™01â€™: 88, â€™10â€™: 50, â€™00â€™: 453, â€™11â€™: 433} 
 
Result of noisy simulation with error mitigation: 
 
{â€™00â€™: 475, â€™01â€™: 12, â€™10â€™: 14, â€™11â€™: 523}
</span></pre>
<p><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml">We know that the ideal result of running this circuit should not produce any </span><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="01" class="math inline" src="../media/file159.png" style="vertical-align:middle" title="01"/></span><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml"> measurement. </span><span class="koboSpan" id="kobo.870.2" xmlns="http://www.w3.org/1999/xhtml">These are present quite prominently in the noisy simulation, but not so much when we use readout error mitigation.</span></p>
</div>
<div id="x1-254108x10">
<p><strong><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">(7.10)</span></strong><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml"> We can use the following code:</span></p>
<pre class="lstlisting" id="listing-382"><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.opflow import Z 
 
from qiskit.providers.aer import AerSimulator 
 
from qiskit.algorithms import QAOA 
 
from qiskit.utils import QuantumInstance 
 
from qiskit import Aer, IBMQ 
 
from qiskit.algorithms.optimizers import COBYLA 
 
from qiskit.utils.mitigation import CompleteMeasFitter 
 
 
 
H1 = Z^Z 
 
 
 
provider = IBMQ.load_account() 
 
backend = AerSimulator.from_backend( 
 
    provider.get_backend(â€™ibmq_manilaâ€™)) 
 
 
 
quantum_instance = QuantumInstance(backend=backend, 
 
                   shots = 1024) 
 
qaoa = QAOA(optimizer = COBYLA(), quantum_instance=quantum_instance) 
 
result = qaoa.compute_minimum_eigenvalue(H1) 
 
print("Result of noisy simulation:",result.optimal_value) 
 
 
 
quantum_instance = QuantumInstance(backend=backend, 
 
    measurement_error_mitigation_cls=CompleteMeasFitter, 
 
    shots = 1024) 
 
qaoa = QAOA(optimizer = COBYLA(), quantum_instance=quantum_instance) 
 
result = qaoa.compute_minimum_eigenvalue(H1) 
 
print("Result of noisy simulation with error mitigation:", 
 
    result.optimal_value)
</span></pre>
<p><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">The results that we obtained when we ran it were the following:</span></p>
<pre class="lstlisting" id="listing-383"><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml">

Result of noisy simulation: -0.8066406250000001 
 
Result of noisy simulation with error mitigation: -0.93359375
</span></pre>
<p><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml">We know that the actual optimal value for our Hamiltonian is </span><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.878.2" xmlns="http://www.w3.org/1999/xhtml">We observe, then, that noise has a negative effect on the performance of QAOA in this case and that it is reduced by the use of readout error mitigation.</span></p>
</div>
</section>
<section class="level2 sectionHead" data-number="28.8" id="f.8-chapter-8-what-is-quantum-machine-learning">
<h1 class="sectionHead" data-number="28.8"> <span id="x1-255000F.8"><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 8, What is Quantum machine Learning?</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml">(8.1)</span></strong><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml"> Letâ€™s proceed by a proof by contradiction. </span><span class="koboSpan" id="kobo.881.2" xmlns="http://www.w3.org/1999/xhtml">We will assume that there exist some coefficients </span><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{1},w_{2},b" class="math inline" src="../media/file1825.png" style="vertical-align:middle" title="w_{1},w_{2},b"/></span><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml"> such that</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0w_{1} + 1w_{2} + b = 1,\qquad 1w_{1} + 0w_{2} + b = 1," class="math display" src="../media/file1826.png" style="vertical-align:middle" title="0w_{1} + 1w_{2} + b = 1,\qquad 1w_{1} + 0w_{2} + b = 1,"/></span></td>
</tr>
</tbody>
</table>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0w_{1} + 0w_{2} + b = 0,\qquad 1w_{1} + 1w_{2} + b = 0." class="math display" src="../media/file1827.png" style="vertical-align:middle" title="0w_{1} + 0w_{2} + b = 0,\qquad 1w_{1} + 1w_{2} + b = 0."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml">Simplifying, these are equivalent to</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{2} + b = 1,\qquad w_{1} + b = 1,\qquad b = 0,\qquad w_{1} + w_{2} + b = 0." class="math display" src="../media/file1828.png" style="vertical-align:middle" title="w_{2} + b = 1,\qquad w_{1} + b = 1,\qquad b = 0,\qquad w_{1} + w_{2} + b = 0."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">The first three identities imply that </span><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="b = 0" class="math inline" src="../media/file1496.png" style="vertical-align:middle" title="b = 0"/></span><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{1} = w_{2} = 1" class="math inline" src="../media/file1829.png" style="vertical-align:middle" title="w_{1} = w_{2} = 1"/></span><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">, hence the last identity cannot be satisfied.</span></p>
<p><strong><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">(8.2)</span></strong><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml"> Histograms are usually versatile and powerful options. </span><span class="koboSpan" id="kobo.894.2" xmlns="http://www.w3.org/1999/xhtml">In this case, however, since our dataset has two features, we could have also drawn a scatter plot using the </span><code><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml">plt</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">scatter</span></code><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml"> function.</span></p>
<p><strong><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">(8.3)</span></strong><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml"> The function is clearly strictly increasing, for its derivative is</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{e^{x}}{{(e^{x} + 1)}^{2}} &gt; 0." class="math display" src="../media/file1830.png" style="vertical-align:middle" title="\frac{e^{x}}{{(e^{x} + 1)}^{2}} &gt; 0."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">Moreover, it is immediate that </span><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\underset{x\rightarrow\infty}{\lim}S(x) = 1" class="math inline" src="../media/file1831.png" style="vertical-align:middle" title="\underset{x\rightarrow\infty}{\lim}S(x) = 1"/></span><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\underset{x\rightarrow - \infty}{\lim}S(x) = 0" class="math inline" src="../media/file1832.png" style="vertical-align:middle" title="\underset{x\rightarrow - \infty}{\lim}S(x) = 0"/></span><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">The ELU function is smooth because the derivative of </span><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml"> at </span><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml"> and so is that of </span><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{x} - 1" class="math inline" src="../media/file1833.png" style="vertical-align:middle" title="e^{x} - 1"/></span><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml"> at </span><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.917.2" xmlns="http://www.w3.org/1999/xhtml">Both functions are strictly increasing and </span><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\underset{x\rightarrow\infty}{\lim}x = \infty" class="math inline" src="../media/file1834.png" style="vertical-align:middle" title="\underset{x\rightarrow\infty}{\lim}x = \infty"/></span><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\underset{x\rightarrow - \infty}{\lim}e^{x} - 1 = - 1" class="math inline" src="../media/file1835.png" style="vertical-align:middle" title="\underset{x\rightarrow - \infty}{\lim}e^{x} - 1 = - 1"/></span><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">The image of the ReLU function is, clearly, </span><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lbrack 0,\infty)" class="math inline" src="../media/file1836.png" style="vertical-align:middle" title="\lbrack 0,\infty)"/></span><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.924.2" xmlns="http://www.w3.org/1999/xhtml">It is not smooth because </span><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(x)}^{\prime} = 1" class="math inline" src="../media/file1837.png" style="vertical-align:middle" title="{(x)}^{\prime} = 1"/></span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"> yet </span><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(0)}^{\prime} = 0" class="math inline" src="../media/file1838.png" style="vertical-align:middle" title="{(0)}^{\prime} = 0"/></span><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><strong><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml">(8.4)</span></strong><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml"> Without loss of generality, we will assume </span><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y = 1" class="math inline" src="../media/file769.png" style="vertical-align:middle" title="y = 1"/></span><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml"> (the case </span><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y = 0" class="math inline" src="../media/file1408.png" style="vertical-align:middle" title="y = 0"/></span><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml"> is fully analogous). </span><span class="koboSpan" id="kobo.934.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="M_{\theta}(x) = y = 1" class="math inline" src="../media/file1839.png" style="vertical-align:middle" title="M_{\theta}(x) = y = 1"/></span><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(\theta;x,y) = - 1{\,\log}(1) + 0 = 0" class="math inline" src="../media/file1840.png" style="vertical-align:middle" title="H(\theta;x,y) = - 1{\,\log}(1) + 0 = 0"/></span><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml"> because </span><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1 - y" class="math inline" src="../media/file1841.png" style="vertical-align:middle" title="1 - y"/></span><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml"> for any value of </span><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.944.2" xmlns="http://www.w3.org/1999/xhtml">On the other hand, when </span><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. M_{\theta}(x)\rightarrow 0 \right." class="math inline" src="../media/file1842.png" style="vertical-align:middle" title="\left. M_{\theta}(x)\rightarrow 0 \right."/></span><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml">, then </span><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. - {\log}(M_{\theta}(x))\rightarrow\infty \right." class="math inline" src="../media/file1843.png" style="vertical-align:middle" title="\left. - {\log}(M_{\theta}(x))\rightarrow\infty \right."/></span><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml">, hence </span><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H" class="math inline" src="../media/file10.png" style="vertical-align:middle" title="H"/></span><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml"> also diverges.</span></p>
<p><strong><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml">(8.5)</span></strong><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml"> We can plot the losses using the following piece of code:</span></p>
<div id="x1-255006x0">
<pre class="lstlisting" id="listing-384"><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">

val_loss = history.history["val_loss"] 
 
train_loss = history.history["loss"] 
 
epochs = range(len(train_loss)) 
 
plt.plot(epochs, train_loss, label = "Training loss") 
 
plt.plot(epochs, val_loss, label = "Validation loss") 
 
plt.legend() 
 
plt.show()
</span></pre>
</div>
<div id="x1-255016x6">
<p><strong><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml">(8.6)</span></strong><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml"> The result is less accurate when we decrease the learning rate without increasing the number of epochs, because the algorithm canâ€™t take enough steps to reach a minimum. </span><span class="koboSpan" id="kobo.955.2" xmlns="http://www.w3.org/1999/xhtml">We also get worse results when we reduce the training dataset to </span><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="20" class="math inline" src="../media/file588.png" style="vertical-align:middle" title="20"/></span><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml">, because we have overfitting. </span><span class="koboSpan" id="kobo.957.2" xmlns="http://www.w3.org/1999/xhtml">This can be identified by looking at the evolution of the validation loss and noticing how it skyrockets while the training loss plummets.</span></p>
</div>
</section>
<section class="level2 sectionHead" data-number="28.9" id="f.9-chapter-9-quantum-support-vector-machines">
<h1 class="sectionHead" data-number="28.9"> <span id="x1-256000F.9"><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 9, Quantum Support Vector Machines</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">(9.1)</span></strong><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"> We will prove that the distance between a hyperplane </span><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml">, characterized by either </span><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = 1" class="math inline" src="../media/file1244.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = 1"/></span><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = - 1" class="math inline" src="../media/file1245.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = - 1"/></span><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml">, given by </span><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = 0" class="math inline" src="../media/file1201.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = 0"/></span><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml">, is </span><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash\left\| w \right\| \right." class="math inline" src="../media/file1844.png" style="vertical-align:middle" title="\left. 1\slash\left\| w \right\| \right."/></span><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.972.2" xmlns="http://www.w3.org/1999/xhtml">The result will then follow from the fact that </span><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = \pm 1" class="math inline" src="../media/file1241.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot \overset{\rightarrow}{x} + b = \pm 1"/></span><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml"> are projections of each other over </span><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">Let us consider a point </span><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\overset{\rightarrow}{x}}_{0} \in H_{0}" class="math inline" src="../media/file1845.png" style="vertical-align:middle" title="{\overset{\rightarrow}{x}}_{0} \in H_{0}"/></span><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.979.2" xmlns="http://www.w3.org/1999/xhtml">The distance between </span><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml"> will be the length of the only vector in the direction normal to </span><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml"> that connects </span><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\overset{\rightarrow}{x}}_{0}" class="math inline" src="../media/file1846.png" style="vertical-align:middle" title="{\overset{\rightarrow}{x}}_{0}"/></span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"> to a point in </span><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.989.2" xmlns="http://www.w3.org/1999/xhtml">What is more, since </span><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w}" class="math inline" src="../media/file1205.png" style="vertical-align:middle" title="\overset{\rightarrow}{w}"/></span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml"> is normal to </span><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">, such a vector needs to be of the form </span><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\alpha\overset{\rightarrow}{w}" class="math inline" src="../media/file1847.png" style="vertical-align:middle" title="\alpha\overset{\rightarrow}{w}"/></span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml"> for some scalar </span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\alpha" class="math inline" src="../media/file84.png" style="vertical-align:middle" title="\alpha"/></span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.997.2" xmlns="http://www.w3.org/1999/xhtml">Let us find that scalar.</span></p>
<p><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml">We know that </span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\overset{\rightarrow}{x}}_{0} + \alpha{\overset{\rightarrow}{x}}_{1} \in H_{1}" class="math inline" src="../media/file1848.png" style="vertical-align:middle" title="{\overset{\rightarrow}{x}}_{0} + \alpha{\overset{\rightarrow}{x}}_{1} \in H_{1}"/></span><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml">, so we must have</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot \left( {{\overset{\rightarrow}{x}}_{0} + \alpha\overset{\rightarrow}{w}} \right) + b = 1." class="math display" src="../media/file1849.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot \left( {{\overset{\rightarrow}{x}}_{0} + \alpha\overset{\rightarrow}{w}} \right) + b = 1."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml">But taking into account that </span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} \in H_{0}" class="math inline" src="../media/file1850.png" style="vertical-align:middle" title="x_{0} \in H_{0}"/></span><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml"> and, therefore, </span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\overset{\rightarrow}{w} \cdot {\overset{\rightarrow}{x}}_{0} + b = 0" class="math inline" src="../media/file1851.png" style="vertical-align:middle" title="\overset{\rightarrow}{w} \cdot {\overset{\rightarrow}{x}}_{0} + b = 0"/></span><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">, this can be further simplified to</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \overset{\rightarrow}{w} \cdot \alpha\overset{\rightarrow}{w} = 1\;\Leftrightarrow\;\alpha = \frac{1}{\left\| w \right\|^{2}}. \right." class="math display" src="../media/file1852.png" style="vertical-align:middle" title="\left. \overset{\rightarrow}{w} \cdot \alpha\overset{\rightarrow}{w} = 1\;\Leftrightarrow\;\alpha = \frac{1}{\left\| w \right\|^{2}}. \right."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml">The length of </span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\alpha\overset{\rightarrow}{w}" class="math inline" src="../media/file1847.png" style="vertical-align:middle" title="\alpha\overset{\rightarrow}{w}"/></span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml"> will just be </span><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="|\alpha| \cdot \left\| \overset{\rightarrow}{w} \right\|" class="math inline" src="../media/file1853.png" style="vertical-align:middle" title="|\alpha| \cdot \left\| \overset{\rightarrow}{w} \right\|"/></span><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">, which is </span><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash\left\| w \right\| \right." class="math inline" src="../media/file1844.png" style="vertical-align:middle" title="\left. 1\slash\left\| w \right\| \right."/></span><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml">, just as we wanted to prove.</span></p>
<p><strong><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">(9.2)</span></strong><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml"> Letâ€™s assume that the kernel function is defined as </span><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k(a,b) = \left| \left\langle \varphi(a) \middle| \varphi(b) \right\rangle \right|^{2}" class="math inline" src="../media/file1854.png" style="vertical-align:middle" title="k(a,b) = \left| \left\langle \varphi(a) \middle| \varphi(b) \right\rangle \right|^{2}"/></span><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1018.2" xmlns="http://www.w3.org/1999/xhtml">The inner product in </span><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C^{n}" class="math inline" src="../media/file1526.png" style="vertical-align:middle" title="C^{n}"/></span><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml"> is conjugate-symmetric, so we must have</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k(b,a) = \left| \left\langle \varphi(b) \middle| \varphi(a) \right\rangle \right|^{2} = \left| \overline{\left\langle \varphi(a) \middle| \varphi(b) \right\rangle} \right|^{2} = \left| \left\langle \varphi(a) \middle| \varphi(b) \right\rangle \right|^{2} = k(a,b)." class="math display" src="../media/file1855.png" style="vertical-align:middle" title="k(b,a) = \left| \left\langle \varphi(b) \middle| \varphi(a) \right\rangle \right|^{2} = \left| \overline{\left\langle \varphi(a) \middle| \varphi(b) \right\rangle} \right|^{2} = \left| \left\langle \varphi(a) \middle| \varphi(b) \right\rangle \right|^{2} = k(a,b)."/></span></td>
</tr>
</tbody>
</table>
<p><strong><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">(9.3)</span></strong><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"> Quantum states need to be normalized and, therefore, the scalar product with themselves must be one.</span></p>
<p><strong><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml">(9.4)</span></strong><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml"> The following piece of code would implement that function:</span></p>
<div id="x1-256005x0">
<pre class="lstlisting" id="listing-385"><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import * 
 
from qiskit . </span><span class="koboSpan" id="kobo.1026.2" xmlns="http://www.w3.org/1999/xhtml">circuit import ParameterVector 
 
 
 
def AngleEncodingX(n): 
 
    x = ParameterVector("x", length = n) 
 
    qc = QuantumCircuit(n) 
 
    for i in range(n): 
 
        qc.rx(parameter[i], i) 
 
    return qc
</span></pre>
</div>
</section>
<section class="level2 sectionHead" data-number="28.10" id="f.10-chapter-10-quantum-neural-networks">
<h1 class="sectionHead" data-number="28.10"> <span id="x1-257000F.10"><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 10, Quantum Neural Networks</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">(10.1)</span></strong><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml"> It suffices to remember that, while kets are represented by column matrices, bras are represented by row matrices. </span><span class="koboSpan" id="kobo.1029.2" xmlns="http://www.w3.org/1999/xhtml">In this way,</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle\left\langle 0 \right| = \begin{pmatrix} 1 \\ 0 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 0 \\ \end{pmatrix}." class="math display" src="../media/file1856.png" style="vertical-align:middle" title="\left| 0 \right\rangle\left\langle 0 \right| = \begin{pmatrix} 1 \\ 0 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 0 \\ \end{pmatrix}."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">Analogously,</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle\left\langle 1 \right| = \begin{pmatrix} 0 \\ 1 \\ \end{pmatrix}\begin{pmatrix} 0 &amp; 1 \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; 0 \\ 0 &amp; 1 \\ \end{pmatrix}." class="math display" src="../media/file1857.png" style="vertical-align:middle" title="\left| 1 \right\rangle\left\langle 1 \right| = \begin{pmatrix} 0 \\ 1 \\ \end{pmatrix}\begin{pmatrix} 0 &amp; 1 \\ \end{pmatrix} = \begin{pmatrix} 0 &amp; 0 \\ 0 &amp; 1 \\ \end{pmatrix}."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml">The results follow trivially from this.</span></p>
<p><strong><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml">(10.2)</span></strong><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml"> The process would be fully analogous. </span><span class="koboSpan" id="kobo.1035.2" xmlns="http://www.w3.org/1999/xhtml">The only differences would be found in the definition of the network, the device, and the weights dictionary, which could be the following:</span></p>
<div id="x1-257003x0">
<pre class="lstlisting" id="listing-386"><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">

nqubits = 5 
 
dev = qml.device("default.qubit", wires=nqubits) 
 
 
 
def qnn_circuit(inputs, theta): 
 
    qml.AmplitudeEmbedding(features = [a for a in inputs], 
 
        wires = range(nqubits), normalize = True, pad_with = 0.) 
 
    TwoLocal(nqubits = nqubits, theta = theta, reps = 2) 
 
    return qml.expval(qml.Hermitian(M, wires = [0])) 
 
 
 
qnn = qml.QNode(qnn_circuit, dev, interface="tf") 
 
 
 
weights = {"theta": 15}
</span></pre>
<p><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">Also, remember that you should train this model on the original dataset (</span><code><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">x_tr</span></code><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">y_tr</span></code><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">), not on the reduced one!</span></p>
</div>
<div id="x1-257018x3">
<p><strong><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">(10.3)</span></strong><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml"> On quantum hardware, one may use â€” for most return types â€” the finite differences method and the parameter shift rule. </span><span class="koboSpan" id="kobo.1043.2" xmlns="http://www.w3.org/1999/xhtml">On simulators â€” under certain conditions â€” one may use these methods in addition to backpropagation and adjoint differentiation.</span></p>
</div>
</section>
<section class="level2 sectionHead" data-number="28.11" id="f.11-chapter-11-the-best-of-both-worlds-hybrid-architectures">
<h1 class="sectionHead" data-number="28.11"> <span id="x1-258000F.11"><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 11, The Best of Both Worlds: Hybrid Architectures</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml">(11.1)</span></strong><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml"> In order to include the extra classical layers, we would have to execute the same code but define the model in the following manner:</span></p>
<div id="x1-258002x0">
<pre class="lstlisting" id="listing-387"><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml">

model = tf.keras.models.Sequential([ 
 
    tf.keras.layers.Input(20), 
 
    tf.keras.layers.Dense(16, activation = "elu"), 
 
    tf.keras.layers.Dense(8, activation = "elu"), 
 
    tf.keras.layers.Dense(4, activation = "sigmoid"), 
 
    qml.qnn.KerasLayer(qnn, weights, output_dim=1) 
 
])
</span></pre>
<p><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml">This model has similar performance after training. </span><span class="koboSpan" id="kobo.1048.2" xmlns="http://www.w3.org/1999/xhtml">The addition of the classical layers doesnâ€™t make a very significant difference.</span></p>
</div>
<div id="x1-258012x2">
<p><strong><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml">(11.2)</span></strong><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml"> In order to have optimized both the learning rate and the batch size, we could have defined the objective function as follows:</span></p>
<pre class="lstlisting" id="listing-388"><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">

def objective(trial): 
 
    # Define the learning rate as an optimizable parameter. 
 
    </span><span class="koboSpan" id="kobo.1051.2" xmlns="http://www.w3.org/1999/xhtml">lrate = trial.suggest_float("learning_rate", 0.001, 0.1) 
 
    bsize = trial.suggest_int("batch_size", 5, 50) 
 
 
 
    # Define the optimizer with the learning rate. 
 
    </span><span class="koboSpan" id="kobo.1051.3" xmlns="http://www.w3.org/1999/xhtml">opt = tf.keras.optimizers.Adam(learning_rate = lrate) 
 
 
 
    # Prepare and compile the model. 
 
    </span><span class="koboSpan" id="kobo.1051.4" xmlns="http://www.w3.org/1999/xhtml">model = tf.keras.models.Sequential([ 
 
        tf.keras.layers.Input(20), 
 
        tf.keras.layers.Dense(4, activation = "sigmoid"), 
 
        qml.qnn.KerasLayer(qnn, weights, output_dim=1) 
 
    ]) 
 
    model.compile(opt, loss=tf.keras.losses.BinaryCrossentropy()) 
 
 
 
    # Train it! 
 
    </span><span class="koboSpan" id="kobo.1051.5" xmlns="http://www.w3.org/1999/xhtml">history = model.fit(x_tr, y_tr, epochs = 50, shuffle = True, 
 
        validation_data = (x_val, y_val), 
 
        batch_size = bsize, 
 
        callbacks = [earlystop], 
 
        verbose = 0 # We want TensorFlow to be quiet. 
 
    </span><span class="koboSpan" id="kobo.1051.6" xmlns="http://www.w3.org/1999/xhtml">) 
 
 
 
    # Return the validation accuracy. 
 
    </span><span class="koboSpan" id="kobo.1051.7" xmlns="http://www.w3.org/1999/xhtml">return accuracy_score(model.predict(x_val) &gt;= 0.5, y_val)
</span></pre>
</div>
<div id="x1-258040x3">
<p><strong><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">(11.3)</span></strong><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml"> We could try to find a numerical approximation of </span><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="f(x) = {(x - 3)}^{2}" class="math inline" src="../media/file1405.png" style="vertical-align:middle" title="f(x) = {(x - 3)}^{2}"/></span><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml"> using Optuna as follows:</span></p>
<pre class="lstlisting" id="listing-389"><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml">

import optuna 
 
from optuna.samplers import TPESampler 
 
 
 
seed = 1234 
 
 
 
def objective(trial): 
 
    x = trial.suggest_float("x", -10, 10) 
 
    return (x-3)**2 
 
 
 
study = optuna.create_study(direction=â€™minimizeâ€™, 
 
sampler=TPESampler(seed = seed)) 
 
study.optimize(objective, n_trials=100)
</span></pre>
<p><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml">Of course, Optuna was not designed with (general) function minimization in mind, but it was conceived solely as a hyperparameter optimizer.</span></p>
</div>
<div id="x1-258054x4">
<p><strong><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml">(11.4)</span></strong><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml"> Let </span><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y = 0,1" class="math inline" src="../media/file1858.png" style="vertical-align:middle" title="y = 0,1"/></span><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml"> be the expected label. </span><span class="koboSpan" id="kobo.1061.2" xmlns="http://www.w3.org/1999/xhtml">It suffices to notice that </span><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml"> in one-hot form is </span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(1 - y,y)" class="math inline" src="../media/file1859.png" style="vertical-align:middle" title="(1 - y,y)"/></span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"> and that the probability assigned by the model to </span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"> being of class </span><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y" class="math inline" src="../media/file270.png" style="vertical-align:middle" title="y"/></span><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N_{\theta}{(x)}_{j}" class="math inline" src="../media/file1860.png" style="vertical-align:middle" title="N_{\theta}{(x)}_{j}"/></span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1071.2" xmlns="http://www.w3.org/1999/xhtml">Hence</span></p>
<span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(\theta;x,(1 - y,y)) = \sum\limits_{j} - y_{j}{\log}(N_{\theta}(x)_{j}) =" class="math display" src="../media/file1861.png" style="vertical-align:middle" title="H(\theta;x,(1 - y,y)) = \sum\limits_{j} - y_{j}{\log}(N_{\theta}(x)_{j}) ="/></span><br/><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- (1 - y){\,\log}(N_{\theta}(x)_{0}) - y{\,\log}(N_{\theta}(x)_{1}) =" class="math display" src="../media/file1862.png" style="vertical-align:middle" title="- (1 - y){\,\log}(N_{\theta}(x)_{0}) - y{\,\log}(N_{\theta}(x)_{1}) ="/></span><br/><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- (1 - y){\,\log}(1 - N_{\theta}(x)_{1}) - y{\,\log}(N_{\theta}(x)_{1})," class="math display" src="../media/file1863.png" style="vertical-align:middle" title="- (1 - y){\,\log}(1 - N_{\theta}(x)_{1}) - y{\,\log}(N_{\theta}(x)_{1}),"/></span>
<p><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml">where we assume that </span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N_{\theta}(x)" class="math inline" src="../media/file1406.png" style="vertical-align:middle" title="N_{\theta}(x)"/></span><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml"> is normalized and, therefore, </span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N_{\theta}{(x)}_{0} + N_{\theta}{(x)}_{1} = 1" class="math inline" src="../media/file1864.png" style="vertical-align:middle" title="N_{\theta}{(x)}_{0} + N_{\theta}{(x)}_{1} = 1"/></span><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1079.2" xmlns="http://www.w3.org/1999/xhtml">The result now follows from the fact that, in binary cross entropy, the probability that we consider is that of assigning label </span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml">, that is, </span><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="N_{(}\theta)_{1}" class="math inline" src="../media/file1865.png" style="vertical-align:middle" title="N_{(}\theta)_{1}"/></span><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<div id="x1-258056x5">
<p><strong><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml">(11.5)</span></strong><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml"> We just have to use the </span><code><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml">y</span></code><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml"> targets instead of the </span><code><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml">y_hot</span></code><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml"> targets when preparing the datasets and then call the sparse categorical cross-entropy loss given in the statement when compiling the model.</span></p>
</div>
<div id="x1-258058x6">
<p><strong><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml">(11.6)</span></strong><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml"> You can create a suitable dataset with 1000 samples and 20 features with the following instruction:</span></p>
<pre class="lstlisting" id="listing-390"><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml">

x, y = make_regression(n_samples = 1000, n_features = 20)
</span></pre>
<p><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml">Then, you can construct the model as follows:</span></p>
<pre class="lstlisting" id="listing-391"><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml">

nqubits = 4 
 
dev = qml.device("lightning.qubit", wires = nqubits) 
 
 
 
@qml.qnode(dev, interface="tf", diff_method = "adjoint") 
 
def qnn(inputs, theta): 
 
    qml.AngleEmbedding(inputs, range(nqubits)) 
 
    TwoLocal(nqubits, theta, reps = 2) 
 
    return [qml.expval(qml.Hermitian(M, wires = [0]))] 
 
 
 
weights = {"theta": 12} 
 
 
 
model = tf.keras.models.Sequential([ 
 
    tf.keras.layers.Input(20), 
 
    tf.keras.layers.Dense(16, activation = "elu"), 
 
    tf.keras.layers.Dense(8, activation = "elu"), 
 
    tf.keras.layers.Dense(4, activation = "sigmoid"), 
 
    qml.qnn.KerasLayer(qnn, weights, output_dim=1), 
 
    tf.keras.layers.Dense(1) 
 
])
</span></pre><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml">
Then it would be trained like any of our previous models using the MSE loss function, which you can access with </span><code><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">tf</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml">keras</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">losses</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml">MeanSquaredError</span></code></span>
<code><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">()</span></code><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml">.
</span></div>
</section>
<section class="level2 sectionHead" data-number="28.12" id="f.12-chapter-12-quantum-generative-adversarial-networks">
<h1 class="sectionHead" data-number="28.12"> <span id="x1-259000F.12"><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 12, Quantum Generative Adversarial Networks</span></span></h1>
<p><strong><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml">(12.1)</span></strong><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml"> (1) QSVMs, QNNs or Hybrid QNNs (2) QGANs. </span><span class="koboSpan" id="kobo.1107.2" xmlns="http://www.w3.org/1999/xhtml">(3) QSVMs, QNNs or Hybrid QNNs. </span><span class="koboSpan" id="kobo.1107.3" xmlns="http://www.w3.org/1999/xhtml">(4) QSVMs, QNNs or Hybrid QNNs. </span><span class="koboSpan" id="kobo.1107.4" xmlns="http://www.w3.org/1999/xhtml">(5) QGANs.</span></p>
<p><strong><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">(12.2)</span></strong><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml"> The steps to produce the solution are analogous to what we did in the main text; itâ€™s only necessary to change the values of the angles that define the state </span><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{1} \right\rangle" class="math inline" src="../media/file177.png" style="vertical-align:middle" title="\left| \psi_{1} \right\rangle"/></span><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml">, and, possibly, to increase the number of training cycles.</span></p>
<p><strong><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">(12.3)</span></strong><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"> Letâ€™s consider a point </span><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x,y,z)" class="math inline" src="../media/file1866.png" style="vertical-align:middle" title="(x,y,z)"/></span><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml"> in the Bloch sphere. </span><span class="koboSpan" id="kobo.1115.2" xmlns="http://www.w3.org/1999/xhtml">Its spherical coordinates are </span><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(\theta,\varphi)" class="math inline" src="../media/file1867.png" style="vertical-align:middle" title="(\theta,\varphi)"/></span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"> such that</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x,y,z) = (\sin\theta\cos\varphi,\sin\theta\sin\varphi,\cos\theta)" class="math display" src="../media/file1868.png" style="vertical-align:middle" title="(x,y,z) = (\sin\theta\cos\varphi,\sin\theta\sin\varphi,\cos\theta)"/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml">and a state with those spherical Bloch sphere coordinates is in the state </span><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. {|\psi\rangle} = {\cos}(\theta/2){|0\rangle} + e^{i\phi}{\sin}(\theta/2){|1\rangle}. \right." class="math display" src="../media/file1869.png" style="vertical-align:middle" title="\left. {|\psi\rangle} = {\cos}(\theta/2){|0\rangle} + e^{i\phi}{\sin}(\theta/2){|1\rangle}. \right."/></span><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml"> The expectation value of </span><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z = \left| 0 \right\rangle\left\langle 0 \right| - \left| 1 \right\rangle\left\langle 1 \right|" class="math inline" src="../media/file1870.png" style="vertical-align:middle" title="Z = \left| 0 \right\rangle\left\langle 0 \right| - \left| 1 \right\rangle\left\langle 1 \right|"/></span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"> in the state </span><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml"> is</span></p>
<table class="equation-star">
<tbody>
<tr class="odd odd">
<td><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. \left\langle \psi \right|Z\left| \psi \right\rangle = {\cos}^{2}(\theta\slash 2) - e^{- i\varphi + i\varphi}{\sin}^{2}(\theta\slash 2) = \cos\theta = z. \right." class="math display" src="../media/file1871.png" style="vertical-align:middle" title="\left. \left\langle \psi \right|Z\left| \psi \right\rangle = {\cos}^{2}(\theta\slash 2) - e^{- i\varphi + i\varphi}{\sin}^{2}(\theta\slash 2) = \cos\theta = z. \right."/></span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml">Regarding the expectation value </span><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Y = i\left| 1 \right\rangle\left\langle 0 \right| - i\left| 0 \right\rangle\left\langle 1 \right|" class="math inline" src="../media/file1872.png" style="vertical-align:middle" title="Y = i\left| 1 \right\rangle\left\langle 0 \right| - i\left| 0 \right\rangle\left\langle 1 \right|"/></span><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">, we have </span><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. {\langle\psi|}Y{|\psi\rangle} = ie^{- i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) - ie^{i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) \right." class="math display" src="../media/file1873.png" style="vertical-align:middle" title="\left. {\langle\psi|}Y{|\psi\rangle} = ie^{- i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) - ie^{i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) \right."/></span><br/><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. = i(e^{- i\phi} - e^{i\phi})({\sin}(\theta/2){\,\cos}(\theta/2)) \right." class="math display" src="../media/file1874.png" style="vertical-align:middle" title="\left. = i(e^{- i\phi} - e^{i\phi})({\sin}(\theta/2){\,\cos}(\theta/2)) \right."/></span><br/><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. = {\sin\,}\phi \cdot 2{\,\sin}(\theta/2){\,\cos}(\theta/2) = {\sin\,}\phi{\,\sin\,}\theta = y. \right." class="math display" src="../media/file1875.png" style="vertical-align:middle" title="\left. = {\sin\,}\phi \cdot 2{\,\sin}(\theta/2){\,\cos}(\theta/2) = {\sin\,}\phi{\,\sin\,}\theta = y. \right."/></span></p>
<p><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml">Lastly, in regard to the expectation value of </span><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X = \left| 1 \right\rangle\left\langle 0 \right| + \left| 0 \right\rangle\left\langle 1 \right|" class="math inline" src="../media/file1876.png" style="vertical-align:middle" title="X = \left| 1 \right\rangle\left\langle 0 \right| + \left| 0 \right\rangle\left\langle 1 \right|"/></span><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">,</span></p>
<p><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. {\langle\psi|}X{|\psi\rangle} = e^{- i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) + e^{i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) \right." class="math display" src="../media/file1877.png" style="vertical-align:middle" title="\left. {\langle\psi|}X{|\psi\rangle} = e^{- i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) + e^{i\phi}{\sin}(\theta/2){\,\cos}(\theta/2) \right."/></span><br/><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. = (e^{- i\phi} + e^{i\phi})({\sin}(\theta/2){\,\cos}(\theta/2)) \right." class="math display" src="../media/file1878.png" style="vertical-align:middle" title="\left. = (e^{- i\phi} + e^{i\phi})({\sin}(\theta/2){\,\cos}(\theta/2)) \right."/></span><br/><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. = {\cos\,}\phi \cdot 2{\,\sin}(\theta/2){\,\cos}(\theta/2) = {\cos\,}\phi{\,\sin\,}\theta = x. \right." class="math display" src="../media/file1879.png" style="vertical-align:middle" title="\left. = {\cos\,}\phi \cdot 2{\,\sin}(\theta/2){\,\cos}(\theta/2) = {\cos\,}\phi{\,\sin\,}\theta = x. \right."/></span></p>
</section>
</section>
</body>
</html>
