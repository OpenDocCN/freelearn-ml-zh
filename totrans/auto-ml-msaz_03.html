<html><head></head><body>
		<div id="_idContainer027">
			<h1 id="_idParaDest-24"><em class="italic"><a id="_idTextAnchor023"/>Chapter 2</em>: Getting Started with Azure Machine Learning Service</h1>
			<p>Now that we know that the key to delivering return on investment in artificial intelligence is delivering machine learning (ML) projects at a brisk pace, we need to learn how to use <strong class="bold">Automated Machine Learning</strong> (<strong class="bold">AutoML</strong>) to achieve that goal. Before we can do that, however, we need to learn how to use the <strong class="bold">Azure Machine Learning Service</strong> (<strong class="bold">AMLS</strong>). AMLS is Microsoft's premier ML platform on the Azure cloud.</p>
			<p>We will begin this chapter by creating an Azure account and creating an AMLS workspace. Once you have created a workspace, you will proceed to create different types of compute to run Python code and ML jobs remotely using a cluster of machines. Next, you will learn how to work with data using the Azure dataset and datastore constructs. Finally, we will provide an overview of AutoML. This will boost your ability to create high-performing models. </p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Creating your first AMLS workspace</li>
				<li>Building compute to run your AutoML jobs</li>
				<li>Working with data in AMLS</li>
				<li>Understanding how AutoML works on Azure</li>
			</ul>
			<h1 id="_idParaDest-25"><a id="_idTextAnchor024"/>Technical requirements</h1>
			<p>In order to complete the exercises in this chapter, you will need the following:</p>
			<ul>
				<li>Access to the internet</li>
				<li>A web browser, preferably Google Chrome or Microsoft Edge Chromium</li>
				<li>A Microsoft account</li>
			</ul>
			<h1 id="_idParaDest-26"><a id="_idTextAnchor025"/>Creating your first AMLS workspace</h1>
			<p>Navigating <a id="_idIndexMarker042"/>Microsoft Azure for the first time can be a daunting experience. With hundreds of services with similar capabilities, it's easy to get lost. Therefore, it is important for you to follow this guide<a id="_idIndexMarker043"/> step by step, beginning by creating an Azure account. If you already have an Azure account, you can skip ahead to the <em class="italic">Creating an AMLS workspace</em> section.</p>
			<h2 id="_idParaDest-27"><a id="_idTextAnchor026"/>Creating an Azure account </h2>
			<p>Let's begin:</p>
			<ol>
				<li>To create <a id="_idIndexMarker044"/>an Azure account, navigate to <a href="https://azure.microsoft.com">https://azure.microsoft.com</a>. </li>
				<li>Click the green <strong class="bold">Start free</strong> button, as shown in the following screenshot. Depending on your location, this button may be located in a slightly different location. Once you've clicked this button, you will be asked to select an email address associated with your Microsoft account: <p class="callout-heading">Note</p><p class="callout">If you use Microsoft Windows, you should have a Microsoft account. If you do not, then you can create a Microsoft account by following the instructions at <a href="https://account.microsoft.com/account">https://account.microsoft.com/account</a>. </p></li>
			</ol>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="image/B16595_02_001.jpg" alt="Figure 2.1 – Microsoft Azure account creation screen "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1 – Microsoft Azure account creation screen</p>
			<p>Microsoft will ask you to fill in some information about your country, first name, last name, email address, and phone number. You will then have to verify your identity via a phone number and enter your credit card information. </p>
			<p>Note that <a id="_idIndexMarker045"/>you will not be charged for creating an Azure account unless you upgrade. Once you sign the agreement, you will have $200 free credit to use for your first 30 days of Azure. You will not be automatically charged at the end of the 30-day period.  </p>
			<p class="callout-heading">Important tip</p>
			<p class="callout">If you have already signed up for a Microsoft Azure free account with an email address, you will not receive an additional $200 free credit. It can only be received once, and you will only be able to choose the pay-as-you-go option. In this case, create a new Microsoft account with a different email address and try again.</p>
			<p>With an account<a id="_idIndexMarker046"/> in place, you can now create resources within Microsoft Azure. Hundreds of resources are available, and it can be tempting to explore them. Stay focused. Setting up AMLS is the first step you must take toward using AutoML. </p>
			<h2 id="_idParaDest-28"><a id="_idTextAnchor027"/>Creating an AMLS workspace</h2>
			<p>Once you have created an Azure account, you<a id="_idIndexMarker047"/> can create an <strong class="bold">Azure Machine Learning Service (AMLS)</strong> workspace. An AMLS <a id="_idIndexMarker048"/>workspace is a centralized resource for all your ML work on Azure. It also provides access to <strong class="bold">AML studio</strong>. This studio is a graphical web portal that allows easy, intuitive access to all the different components of the AMLS workspace. Let's get started:</p>
			<ol>
				<li value="1">Begin by navigating to <a href="https://portal.azure.com">https://portal.azure.com</a>. </li>
				<li>Click the <strong class="bold">Create a resource</strong> button, which should be in a blue cross. Resources are simply Azure services. Every Azure service, be it a virtual machine, cloud database, or ML tool, counts as a resource.</li>
				<li>After clicking the blue cross, type <strong class="source-inline">Machine Learning</strong> into the search box and press <em class="italic">Enter</em>. You will see a new screen with a large blue flask in the top-right corner. This is the AML symbol. </li>
				<li>Click <strong class="bold">Create</strong>. The following screenshot shows the process flow:<div id="_idContainer011" class="IMG---Figure"><img src="image/B16595_02_002.jpg" alt="Figure 2.2 – Creating an AMLS resource "/></div><p class="figure-caption">Figure 2.2 – Creating an AMLS resource</p></li>
				<li>You will then be<a id="_idIndexMarker049"/> presented with a screen asking you to select a subscription, fill in a resource group, create a workspace name, select a region, and select a workspace edition. If you have multiple Azure subscriptions, select the one associated with the<a id="_idIndexMarker050"/> account you would like to use. A <strong class="bold">resource group</strong> is simply a collection of Azure resources. Create a new one by following the naming conventions.<p class="callout-heading">Important tip</p><p class="callout">Different Azure resources have different naming conventions. Resource groups must consist of alphanumeric characters, periods, hyphens, parentheses, and underscores, while AMLS workspaces must consist of alphanumeric characters, hyphens, and underscores. Simply follow any instructions that appear if you provide an incorrect name. </p></li>
				<li>Fill in the rest of the form by naming your AMLS workspace and selecting a region. Pick a region close to where you live. For example, if you live in Chicago, select North Central US or East US, but don't select North Europe. After filling out all the values, your form should look similar to what's shown in the following screenshot.<p>Notice that, in addition to the AMLS workspace, you are also creating additional resources automatically. A <strong class="bold">container registry</strong> to hold containerized code will be automatically created for you if you require it, so do not create one:</p><p class="figure-caption"> </p><div id="_idContainer012" class="IMG---Figure"><img src="image/B16595_02_003.jpg" alt="Figure 2.3 – Example of a filled-in AMLS workspace creation form "/></div><p class="figure-caption">Figure 2.3 – Example of a filled-in AMLS workspace creation form</p></li>
				<li>Finish creating your AMLS workspace by clicking <strong class="bold">Review + create</strong>, followed by <strong class="bold">Create</strong>. <p>You will see a <a id="_idIndexMarker051"/>screen that says <strong class="bold">Deployment is in progress</strong>, and four different Azure resources will be created. This will include your AMLS workspace, a <strong class="bold">Storage account</strong> instance for storing your data, an <strong class="bold">Azure Key Vault</strong> instance for<a id="_idIndexMarker052"/> storing your passwords, and an <strong class="bold">Application Insights</strong> resource for<a id="_idIndexMarker053"/> monitoring your<a id="_idIndexMarker054"/> ML jobs. Do not delete any of these resources once they have been created.</p><p class="callout-heading">Important Tip</p><p class="callout">Once you've created a ML pipeline or a real-time endpoint, an Azure container registry will be automatically created. Like the other automatically created resources, do not delete it.</p></li>
			</ol>
			<h2 id="_idParaDest-29"><a id="_idTextAnchor028"/>Creating an AMLS workspace with code</h2>
			<p>Alternatively, you <a id="_idIndexMarker055"/>can create an AMLS workspace by using the <strong class="bold">Azure CLI</strong> with either <strong class="bold">Bash</strong> or <strong class="bold">PowerShell</strong>. The <strong class="bold">Azure command-line interface</strong> (<strong class="bold">Azure CLI</strong>) is an interface you can use to create and manage Azure resources. Bash is the UNIX shell and command<a id="_idIndexMarker056"/> language, while PowerShell is a Microsoft-specific framework. The Azure CLI can be accessed via the front page of <a href="https://portal.azure.com">https://portal.azure.com</a> by clicking the<a id="_idIndexMarker057"/> computer screen icon at the top left. When you hover over it, the words <strong class="bold">Cloud Shell</strong> will pop up.</p>
			<p>To create an AMLS workspace, type in the following commands in the order shown here:</p>
			<ol>
				<li value="1">Install the Azure CLI ML extension with the following code:<p class="source-code"><strong class="bold">az extension add -n azure-cli-ml</strong></p></li>
				<li>Next, create a resource group. Make sure that you specify your Azure location. <strong class="source-inline">-n</strong> denotes the resource group's name, while <strong class="source-inline">-l</strong> specifies its location:<p class="source-code"><strong class="bold">az group create -n automl-cli-group -l eastus</strong></p></li>
				<li>Instantiate your AMLS workspace. <strong class="source-inline">-w</strong> denotes your workspace name, while <strong class="source-inline">-g</strong> specifies your resource group. Make sure it matches the resource group you created in the previous step:<p class="source-code"><strong class="bold">az ml workspace create -w automl-ws -g automl-cli-group</strong></p></li>
			</ol>
			<p>You can learn more about workspace-specific commands at <a href="https://docs.microsoft.com/en-us/azure/machine-learning/reference-azure-machine-learning-cli">https://docs.microsoft.com/en-us/azure/machine-learning/reference-azure-machine-learning-cli</a>.</p>
			<p>Now that you have<a id="_idIndexMarker058"/> created an AMLS workspace, you are ready to explore its many objects. You will do this through AML studio, a GUI built on top of your AMLS workspace. </p>
			<h2 id="_idParaDest-30"><a id="_idTextAnchor029"/>Navigating AML studio</h2>
			<p>With your AMLS workspace created, you can <a id="_idIndexMarker059"/>now navigate to AML studio. </p>
			<p>Either navigate to <a href="https://ml.azure.com">https://ml.azure.com</a> or open your AMLS workspace and click <strong class="bold">Launch Now</strong>, which can be found in the middle of the screen. AML studio is your one-stop shop for your AMLS needs. The following screenshot shows the studio and its navigation bar:</p>
			<div>
				<div id="_idContainer013" class="IMG---Figure">
					<img src="image/B16595_02_004.jpg" alt="Figure 2.4 – AML studio home page and navigation "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4 – AML studio home page and navigation</p>
			<p>Your AML studio can be<a id="_idIndexMarker060"/> quite intimidating at first. With many tabs to navigate and a plethora of unfamiliar terms, many first-time users get lost. To make your journey easier, here's a description of each tab and what it does:  </p>
			<ul>
				<li><strong class="bold">Home</strong> returns you to the AML studio home page.</li>
				<li><strong class="bold">Notebooks</strong> lets you write code using <strong class="bold">Jupyter</strong> or <strong class="bold">JupyterLab</strong>.</li>
				<li><strong class="bold">Automated ML (preview)</strong> lets you run AutoML jobs using a guided user interface. It is currently in preview mode.</li>
				<li><strong class="bold">Designer (preview)</strong> lets you transform data and create ML models using a guided user interface. It is currently in preview mode.</li>
				<li><strong class="bold">Datasets</strong> are pointers to files in Azure Storage accounts or SQL queries in Azure SQL databases. You can use this tab to create new datasets or profile, update, and retrieve information on existing datasets.</li>
				<li><strong class="bold">Experiments</strong> are records of your ML training jobs on Azure. Experiments contains the results of your runs, along with logs, charts, and graphs.</li>
				<li><strong class="bold">Pipelines</strong> keeps track of<a id="_idIndexMarker061"/> any ML pipelines you have created. Pipelines are used for batch scoring or model training and are commonly scheduled using Azure Data Factory. Use this tab to retrieve your pipeline names and IDs.   </li>
				<li><strong class="bold">Models</strong> keeps track of any ML models you have trained and registered to your AMLS workspace. Use this tab to keep track of them.</li>
				<li><strong class="bold">Endpoints</strong> keeps track of any real-time endpoints you have created for real-time scoring, as well as any pipeline endpoints you have created. You can also find pipeline endpoints in the <strong class="bold">Pipelines</strong> tab.</li>
				<li><strong class="bold">Compute</strong> lets you<a id="_idIndexMarker062"/> create and access <strong class="bold">compute instances</strong> for running Jupyter, JupyterLab, and R Studio notebooks. It also lets you create <strong class="bold">compute clusters</strong> for running <a id="_idIndexMarker063"/>remote training jobs. We will create both in the next section.</li>
				<li><strong class="bold">Datastores</strong> are pointers to blob containers on Azure Storage accounts or to Azure SQL databases. You can use this tab to create new datastores and retrieve information about your existing datastores.</li>
				<li><strong class="bold">Data Labeling</strong> is useful for labeling image data. As you manually label images, you can train a machine model to make this process automatic in the future.</li>
			</ul>
			<p>Throughout the rest of this chapter, we will explore the <strong class="bold">Compute</strong>, <strong class="bold">Dataset</strong>, and <strong class="bold">Datastore</strong> tabs. As we proceed throughout this book, we will use the <strong class="bold">Automated ML</strong>, <strong class="bold">Experiment</strong>, <strong class="bold">Model</strong>, <strong class="bold">Pipeline</strong>, and <strong class="bold">Endpoint</strong> tabs. We will not cover the <strong class="bold">Notebook</strong>, <strong class="bold">Designer</strong>, or <strong class="bold">Data Labeling</strong> tabs. To run<a id="_idIndexMarker064"/> AutoML jobs through the GUI or through code, you will first need compute, so let's start there.  </p>
			<h1 id="_idParaDest-31"><a id="_idTextAnchor030"/>Building compute to run your AutoML jobs</h1>
			<p>The first time you open AML studio, <a id="_idIndexMarker065"/>navigate to the <strong class="bold">Compute</strong> tab to create a compute instance and a compute cluster. Once you open the tab, you will see four headings at the top: <strong class="bold">Compute instances</strong>, <strong class="bold">Compute clusters</strong>, <strong class="bold">Inference clusters</strong>, and <strong class="bold">Attached compute</strong>. Let's take a look at these in more detail:</p>
			<ul>
				<li><strong class="bold">Compute instances</strong> are virtual machines that you can use to write and run Python code in Jupyter or JupyterLab notebooks; you can also use a compute instance to write R code using R Studio.</li>
				<li><strong class="bold">Compute clusters</strong> are groups of virtual machines used to train ML models remotely. You <a id="_idIndexMarker066"/>can kick off jobs on a compute cluster and continue working on code in your compute instance. </li>
				<li><strong class="bold">Inference clusters</strong> are groups of <a id="_idIndexMarker067"/>virtual machines used to score data in real time. </li>
				<li><strong class="bold">Attached compute</strong> refers to using<a id="_idIndexMarker068"/> Databricks or HDInsight compute to run big data jobs. </li>
			</ul>
			<p>Let's see them in action.</p>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor031"/>Creating a compute instance</h2>
			<p>We'll start with <a id="_idIndexMarker069"/>a compute instance:</p>
			<ol>
				<li value="1">Make sure the tab at the top is highlighted in black. Then, click the <strong class="bold">Add New</strong> button, which is the blue cross highlighted in the following screenshot:<div id="_idContainer014" class="IMG---Figure"><img src="image/B16595_02_005.jpg" alt="Figure 2.5 – Creating a compute instance "/></div><p class="figure-caption">Figure 2.5 – Creating a compute instance</p><p>You will be asked to<a id="_idIndexMarker070"/> select a virtual machine type and a virtual machine size. Select <strong class="bold">CPU</strong> for your virtual machine type and <strong class="bold">Standard_DS3_v2</strong> as your virtual machine size. <strong class="bold">Standard_DS3_v2</strong> is the recommended virtual machine for most ML jobs using small- to medium-sized datasets. </p><p>For larger datasets, you will want virtual machines with more RAM. As a rough guideline, we recommend having 20 times more RAM than the size of your data in CSV format. Once you <a id="_idIndexMarker071"/>have entered your settings, as shown in the following screenshot, click <strong class="bold">Next</strong>:</p><p class="callout-heading">Important Tip – CPU versus GPU</p><p class="callout">For the majority of your AutoML and ML jobs, CPUs will be sufficient. When you are training deep learning models, however, you want to select the more expensive GPU virtual machines.</p><div id="_idContainer015" class="IMG---Figure"><img src="image/B16595_02_006.jpg" alt="Figure 2.6 – Compute instance settings "/></div><p class="figure-caption">Figure 2.6 – Compute instance settings</p></li>
				<li>You will then be asked to name your compute instance. Give it any name you wish or use <strong class="source-inline">automl-compute-instance</strong>, as shown in the following screenshot, and click <strong class="bold">Create</strong>:<div id="_idContainer016" class="IMG---Figure"><img src="image/B16595_02_007.jpg" alt="Figure 2.7 – Naming your compute instance "/></div><p class="figure-caption">Figure 2.7 – Naming your compute instance</p></li>
				<li>Now that you<a id="_idIndexMarker072"/> have created a compute instance, you can start coding to complete the rest of your tasks or you can continue to use the GUI. To write in Python, simply open the link to <strong class="bold">Jupyter</strong>, as shown in the following screenshot: <div id="_idContainer017" class="IMG---Figure"><img src="image/B16595_02_008.jpg" alt="Figure 2.8 – Opening a Jupyter notebook "/></div><p class="figure-caption">Figure 2.8 – Opening a Jupyter notebook</p></li>
				<li>You can begin coding <a id="_idIndexMarker073"/>by creating a Python notebook in Jupyter. To do this, click the <strong class="bold">New</strong> button at the top right of the screen. From the dropdown, select the latest version of Python with AzureML, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer018" class="IMG---Figure">
					<img src="image/B16595_02_009.jpg" alt="Figure 2.9 – Creating a new Python notebook "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – Creating a new Python notebook</p>
			<p>Now, you are ready to start coding!</p>
			<h2 id="_idParaDest-33"><a id="_idTextAnchor032"/>Creating a compute cluster</h2>
			<p>Your next step is to <a id="_idIndexMarker074"/>create a compute cluster so that you can run AutoML jobs using the visual interface. You can create a compute cluster either using code in a Jupyter notebook or through the GUI. </p>
			<ol>
				<li value="1">To create a compute cluster through the GUI, click the <strong class="bold">Compute</strong> tab, click <strong class="bold">Compute clusters</strong>, and then click the <strong class="bold">Create</strong> button, as shown in the following screenshot:<p class="figure-caption"> </p><div id="_idContainer019" class="IMG---Figure"><img src="image/B16595_02_010.jpg" alt="Figure 2.10 – Creating a compute cluster"/></div><p class="figure-caption">Figure 2.10 – Creating a compute cluster</p></li>
				<li>There are more<a id="_idIndexMarker075"/> settings when it comes to creating a compute cluster. First, create a name by following the naming convention. Compute clusters can only have names that are 16 characters long, so think carefully. Your region is automatically selected so that it matches your workspace. <p>As we did previously, select <strong class="bold">CPU</strong> as the virtual machine's type and <strong class="bold">Standard_DS3_v2</strong> as the virtual machine's size. For virtual machine priority, select <strong class="bold">Dedicated</strong> instead of <strong class="bold">Low priority</strong>. Jobs running on low-priority virtual machines may be interrupted in periods of high usage. Then, click <strong class="bold">Next</strong>, as shown in the following screenshot:</p><p class="figure-caption"> </p><div id="_idContainer020" class="IMG---Figure"><img src="image/B16595_02_011.jpg" alt="Figure 2.11 – Compute cluster settings – part 1 "/></div><p class="figure-caption">Figure 2.11 – Compute cluster settings – part 1</p></li>
				<li>On the next page, begin by naming<a id="_idIndexMarker076"/> your compute cluster while following the naming convention. Compute clusters can only have names that are 16 characters long, so think carefully. Then, select the number of nodes. This is the most important difference between compute clusters and compute instances. <p>With compute instances, you have a single node to run your jobs; with clusters, you can set the minimum and maximum numbers of nodes, and they will autoscale according to your job. AutoML makes use of compute clusters by training different models in parallel on separate nodes. </p></li>
			</ol>
			<p>Set your minimum<a id="_idIndexMarker077"/> node count to <strong class="source-inline">0</strong> to minimize your costs when no jobs are running and set your maximum node count to <strong class="source-inline">4</strong>. Lastly, change the number of seconds before nodes scale down to <strong class="source-inline">1200</strong> seconds, or <strong class="source-inline">20</strong> minutes, to keep your machines from shutting down while you work. Check your settings against those shown in the following screenshot and click the <strong class="bold">Create</strong> button:</p>
			<div>
				<div id="_idContainer021" class="IMG---Figure">
					<img src="image/B16595_02_012.jpg" alt="Figure 2.12 – Compute cluster settings – part 2 "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12 – Compute cluster settings – part 2</p>
			<h3>Creating a compute cluster with code</h3>
			<p>You can also create a<a id="_idIndexMarker078"/> compute cluster using Python code in a Jupyter notebook. Let's take a look:</p>
			<ol>
				<li value="1">First, import the necessary packages so that you can connect to your AMLS workspace and create your compute cluster:<p class="source-code">import azureml.core</p><p class="source-code">from azureml.core.workspace import Workspace</p><p class="source-code">from azureml.core.compute import ComputeTarget, AmlCompute</p></li>
				<li>Now, connect to your AMLS workspace with the following code:<p class="source-code">ws = Workspace.from_config()</p></li>
				<li>Next, set your variables so that they match the settings you used when you created the cluster on the GUI:<p class="source-code">compute_name = 'automl-cluster'</p><p class="source-code">compute_min_nodes = 0</p><p class="source-code">compute_max_nodes = 4</p><p class="source-code">vm_size = 'Standard_DS3_v2' </p><p class="source-code">idle_seconds = 1200</p></li>
				<li>Once you have stored the variables, create a provisioning configuration for your compute cluster by using the following code:<p class="source-code">Compute_Config = AmlCompute.provisioning_configuration(vm_size=vm_size, min_nodes=compute_min_nodes, max_nodes=compute_max_nodes, idle_seconds_before_scaledown = idle_seconds)</p></li>
				<li>Finally, create the compute target:<p class="source-code">compute_target = ComputeTarget.create(ws, compute_name, provisioning_config)</p><p class="source-code">compute_target.wait_for_completion(show_output=True)</p></li>
			</ol>
			<p>Next, we will see<a id="_idIndexMarker079"/> another way to create the compute clusters and instances.</p>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor033"/>Creating a compute cluster and compute instance with the Azure CLI</h2>
			<p>A third way to create <a id="_idIndexMarker080"/>both compute clusters and compute instances is through the Azure CLI. To do so, open the Azure CLI by navigating to <a href="https://portal.azure.com">https://portal.azure.com</a> and clicking on<a id="_idIndexMarker081"/> the computer screen icon in the top right of the screen. When you hover over the icon, it will say <em class="italic">Cloud Shell</em>. Once it's opened, do the following:</p>
			<ol>
				<li value="1">Create a compute instance. <strong class="source-inline">-n</strong> denotes the name of your compute instance, while <strong class="source-inline">-s</strong> specifies your virtual machine's size:<p class="source-code">az ml computetarget create computeinstance -n clicompute -s "STANDARD_DS3_V2" -v</p></li>
				<li>Create a compute cluster. <strong class="source-inline">-n</strong> denotes the name of your compute cluster, while <strong class="source-inline">-s</strong> specifies your virtual machine's size. You also need to set your minimum and maximum numbers of nodes:<p class="source-code">az ml computetarget create amlcompute -n clicluster –min-nodes 0 –max-nodes 1 -s STANDARD_DS3_V2</p></li>
			</ol>
			<p>You now know three ways you can create compute on AMLS: through the GUI, through Python code, and through the Azure CLI. By creating compute, you can now run all the AutoML jobs you want. Think of compute as the engine of AutoML. Like any engine, however, it requires fuel to run. If compute is the engine of AutoML, data is its fuel.</p>
			<h1 id="_idParaDest-35"><a id="_idTextAnchor034"/>Working with data in AMLS</h1>
			<p>Now that you've created <a id="_idIndexMarker082"/>a compute, all you need to do is create a dataset and you will be ready to run your first AutoML job. <strong class="bold">Datasets</strong> are simply pointers to files on your <strong class="bold">Storage account</strong> or pointers to SQL queries on Azure SQL databases. </p>
			<p>A dataset is not a file itself. You can create datasets from local files, from SQL queries, or from files in your <a id="_idIndexMarker083"/>storage accounts. <strong class="bold">Azure Open Datasets</strong>, publicly<a id="_idIndexMarker084"/> available data curated by Microsoft, can also be registered as datasets. For this exercise, we will create a dataset using the Diabetes open dataset.</p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor035"/>Creating a dataset using the GUI</h2>
			<p>Let's<a id="_idIndexMarker085"/> begin:</p>
			<ol>
				<li value="1">Click the <strong class="bold">Dataset</strong> tab. </li>
				<li>Click the <strong class="bold">Create dataset</strong> button, indicated by the blue cross, and you will be presented with a dropdown. Select <strong class="bold">From Open Datasets</strong>, as shown in the following screenshot.<p>Note that you can also use this dropdown to create datasets from local files on your computer, from web files, or from data found in your datastores. Like datasets, <strong class="bold">datastores</strong> are pointers, but they point to blob containers on Azure Storage accounts or to Azure SQL databases:</p><p class="callout-heading">Important Tip</p><p class="callout">Datastores can be created from Azure Blob storage, Azure File Share, Azure Data Lake Gen 1, Azure Data Lake Gen 2, Azure SQL Database, Azure PostgreSQL Database, and Azure MySQL Database. </p><div id="_idContainer022" class="IMG---Figure"><img src="image/B16595_02_013.jpg" alt="Figure 2.13 – Creating a dataset using the GUI "/></div><p class="figure-caption">Figure 2.13 – Creating a dataset using the GUI</p><p>You will be<a id="_idIndexMarker086"/> presented with an array of datasets. Some, such as <strong class="source-inline">Sample: Diabetes</strong>, <strong class="source-inline">Sample: OJ Sales Simulated Data</strong>, and <strong class="source-inline">The MNIST database of handwritten digits</strong> are useful for demoing ML. You can use Diabetes for regression, OJ Sales for forecasting, and MNIST for deep learning image recognition. </p></li>
				<li>Type <strong class="source-inline">Diabetes</strong> into the search bar, click the <strong class="bold">Sample: Diabetes</strong> box, and then click <strong class="bold">Next</strong>, as shown in the following screenshot:<div id="_idContainer023" class="IMG---Figure"><img src="image/B16595_02_014.jpg" alt="Figure 2.14 – Selecting the sample – Diabetes open dataset "/></div><p class="figure-caption">Figure 2.14 – Selecting the sample – Diabetes open dataset</p></li>
				<li>You will now be <a id="_idIndexMarker087"/>asked to name your dataset. Dataset names must be unique in your workspace. Unlike many other Azure artifacts, dataset names may contain spaces, but they may not begin or end with a white space. Datasets also contain version numbers, beginning with 1.<p>Every time you update a dataset so that it points to a different file with updated data, a new version will be created. Give your dataset the name <strong class="source-inline">Diabetes Sample</strong> and click <strong class="bold">Create</strong>, as shown in the following screenshot:</p></li>
			</ol>
			<div>
				<div id="_idContainer024" class="IMG---Figure">
					<img src="image/B16595_02_015.jpg" alt="Figure 2.15 – Naming your dataset "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15 – Naming your dataset</p>
			<p>Congratulations! Now, you have a<a id="_idIndexMarker088"/> dataset that you can use for AutoML. </p>
			<h2 id="_idParaDest-37"><a id="_idTextAnchor036"/>Creating a dataset using code</h2>
			<p>Like compute<a id="_idIndexMarker089"/> clusters, you can also create datasets entirely from code:</p>
			<ol>
				<li value="1">Begin by loading in the following packages. <strong class="source-inline">Diabetes</strong> makes <strong class="source-inline">Sample: Diabetes</strong> available, while <strong class="source-inline">Dataset</strong> lets you create, register, and use datasets:<p class="source-code">from azureml.opendatasets import Diabetes</p><p class="source-code">from azureml.core import Dataset</p></li>
				<li>Once you have imported your packages, run the following code to pull in Diabetes data as a<a id="_idIndexMarker090"/> tabular dataset. <strong class="bold">Tabular datasets</strong> refer to data that contains <a id="_idIndexMarker091"/>rows and columns, whereas <strong class="bold">file datasets</strong> are used for non-tabular data such as image files:<p class="source-code">diabetes_tabular = Diabetes.get_tabular_dataset()</p></li>
				<li>Next, give your dataset a name and register it in your workspace. To do this, you will need the workspace code we used earlier while making a compute cluster:<p class="source-code">from azureml.core.workspace import Workspace	</p><p class="source-code">ws = Workspace.from_config()</p><p class="source-code">diabetes = diabetes_tabular.register(workspace=ws, name='Diabetes Sample')</p></li>
				<li>Once a dataset has<a id="_idIndexMarker092"/> been registered to your AMLS workspace, it's extremely easy to call it in the future. Simply navigate to the <strong class="bold">Dataset</strong> tab, select your dataset, and hit <strong class="bold">Consume</strong> to obtain the code you need to call your dataset. Click the folded page icon next to <strong class="bold">Sample usage</strong> to copy the code to your clipboard, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer025" class="IMG---Figure">
					<img src="image/B16595_02_016.jpg" alt="Figure 2.16 – Using your dataset "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16 – Using your dataset</p>
			<p>You have now learned how to create a dataset using the GUI and code. Datasets are useful not only for AutoML but for all tasks within AMLS. Accessing datasets is as easy as copying automatically generated code into the studio. Try creating your own from local files using the GUI before moving on to the next section.</p>
			<p>Your AutoML is<a id="_idIndexMarker093"/> ready to run. You built the engine in the previous section and now you have your fuel; that is, your data. Before you give AutoML a try, however, it's important to understand how it works. You wouldn't want to drive it into a ditch, after all.</p>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor037"/>Understanding how AutoML works on Azure</h1>
			<p>Before running<a id="_idIndexMarker094"/> your first AutoML experiment, it's important to understand how AutoML works on Azure. AutoML is more than just machine learning, after all. It's also about data transformation and manipulation. </p>
			<p>As shown in the following diagram, you can divide the stages of AutoML into roughly five parts: <strong class="bold">Data Guardrails Check</strong>, <strong class="bold">Intelligent Feature Engineering</strong>, <strong class="bold">Iterative Data Transformation</strong>, <strong class="bold">Iterative ML Model Building</strong>, and <strong class="bold">Model Ensembling</strong>. Only at the end of this process does AutoML produce a definitive best model:</p>
			<div>
				<div id="_idContainer026" class="IMG---Figure">
					<img src="image/B16595_02_017.jpg" alt="Figure 2.17 – The Azure AutoML process "/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17 – The Azure AutoML process</p>
			<p>Let's take a closer look at each step in this process.</p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor038"/>Ensuring data quality with data guardrails</h2>
			<p><strong class="bold">Data guardrails</strong> check to make<a id="_idIndexMarker095"/> sure that <a id="_idIndexMarker096"/>your data is in the correct format for AutoML, and if it is not, it will alter the data accordingly. There are currently six main checks that are performed on your data. Two of the checks – one to detect missing values and another to detect high-cardinality columns – will occur on every dataset. The other four checks are problem- or setting-dependent.  </p>
			<p><strong class="bold">Missing feature values imputation</strong> will detect any null values in your dataset. <strong class="bold">High-cardinality feature handling</strong>, on the other hand, will identify any categorical columns with a large number of unique values. These are both important for the next step; that is, <strong class="bold">Intelligent Feature Engineering</strong>. </p>
			<p>Unlike the first two checks, <strong class="bold">validation split handling</strong> will only occur if you set the validation configuration to <strong class="bold">auto</strong>. We will go over all of the different settings in <em class="italic">Chapters 4</em>, <em class="italic">5</em>, and <em class="italic">6</em>. This check automatically splits the data into training and test sets so that you don't have to. It's one of the <a id="_idIndexMarker097"/>many ways that AutoML speeds up the data science process.</p>
			<p><strong class="bold">Class balancing detection</strong> is specific to classification problems that are trying to predict a category, while <strong class="bold">memory issues detection</strong> and <strong class="bold">frequency detection</strong> are specific to forecasting problems that are trying to predict a future number. More on these checks will be discussed in <a href="B16595_05_ePub.xhtml#_idTextAnchor068"><em class="italic">Chapter 5</em></a><em class="italic">, Building an AutoML Classification Solution</em>, and <a href="B16595_06_ePub.xhtml#_idTextAnchor081"><em class="italic">Chapter 6</em></a><em class="italic">, Building an AutoML Forecasting Solution</em>, which cover classification and forecasting, respectively. </p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor039"/>Improving data with intelligent feature engineering</h2>
			<p>Once your data has passed the <a id="_idIndexMarker098"/>data guardrails check, the next step is <strong class="bold">intelligent feature engineering</strong>. This consists of <a id="_idIndexMarker099"/>filling in missing values, dealing with high-cardinality categorical features, generating additional features, and one-hot encoding categorical features. More advanced feature engineering techniques using k-means clustering, weight of evidence, and advanced text analytics are also applied here.</p>
			<p>To begin, any columns consisting of all missing values, identical values, or extremely high cardinality (ID fields, GUIDs, and so on) will be automatically removed. Next, your missing numeric values will be filled in with the average (mean) of the column, while your missing categorical values will be filled with the most common value. </p>
			<p>Following missing value imputation, additional columns will be generated for datetime features and text features. Datetime features include year, month, day, day of week, day of year, quarter, week of the year, hour, minute, and second. Text features include term frequency for groups of one, two, and three words. </p>
			<p class="callout-heading">Tip </p>
			<p class="callout">It's sometimes better to fill in your missing values with measures other than the mean or most common value. In this case, fill in your data before it reaches AutoML.</p>
			<p><strong class="bold">One-hot encoding</strong> is then applied to all <a id="_idIndexMarker100"/>categorical columns. Simply put, this <a id="_idIndexMarker101"/>means that columns of 1s and 0s are created to represent each unique value in your original column. If your original column was <em class="italic">animal</em>, a dog will have a <em class="italic">1</em> in the newly created dog column and a <em class="italic">0</em> in all other animal columns. High-cardinality categorical columns will have grouped columns (<em class="italic">dog-cat</em>) created instead.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">Advanced feature engineering is also applied; these techniques require a high degree of specialized knowledge in data science and text analytics. If you would like to learn more, please check Microsoft's <em class="italic">Featurization in Automated ML</em> documentation, located at <a href="https://docs.microsoft.com/en-us/azure/machine-learning/how-to-configure-auto-features">https://docs.microsoft.com/en-us/azure/machine-learning/how-to-configure-auto-features</a>.</p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor040"/>Normalizing data for ML with iterative data transformation</h2>
			<p>ML<a id="_idIndexMarker102"/> models often perform better when you scale data. For example, if you have one column of numeric data with values between 5 and 10 and another column with values between 1 and 10 million, it's often better to normalize each column so that its minimum value is 0 and its maximum value is 1. There are many types of normalization, and luckily, AutoML<a id="_idIndexMarker103"/> performs them for you with <strong class="bold">iterative data transformation</strong>.</p>
			<p>Every time AutoML trains a new model, it begins by scaling your data using one of seven methods. These seven methods are as follows:</p>
			<ul>
				<li><strong class="bold">StandardScaler </strong></li>
				<li><strong class="bold">MinMaxScaler</strong></li>
				<li><strong class="bold">Maximum absolute value scaler</strong></li>
				<li><strong class="bold">RobustScaler</strong></li>
				<li><strong class="bold">PCA</strong></li>
				<li><strong class="bold">Truncated Singular Value Decomposition</strong></li>
				<li><strong class="bold">SparseNormalizer</strong></li>
			</ul>
			<p>Usually, you would<a id="_idIndexMarker104"/> have to code these yourself and try each one to determine which scaling method works best, but with AutoML, you don't even have to think about it.</p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor041"/>Training models quickly with iterative ML model building</h2>
			<p>The core of <a id="_idIndexMarker105"/>Azure AutoML is <strong class="bold">iterative ML model building</strong>. AutoML will train models in parallel based<a id="_idIndexMarker106"/> on your settings from an extensive list of algorithms. Microsoft's AutoML team has only selected the best-performing algorithms models to be included in AutoML, and before adding a new one, it undergoes extensive testing. This ensures high model performance.</p>
			<p>As you watch AutoML train models, you will often notice that it uses the same algorithm over and over again. In this case, it's trying out different combinations of hyperparameters to achieve a higher score. Hyperparameters are simply settings you can set that are<a id="_idIndexMarker107"/> specific to an algorithm, such as <strong class="bold">tree depth</strong> for decision trees or <strong class="bold">loss</strong> in stochastic gradient<a id="_idIndexMarker108"/> descent.</p>
			<p>Speaking of scores, each type of problem – regression, classification, and forecasting – has different metrics you can use to score. AutoML also uses a different set of algorithms for each problem type. More information on both scoring metrics and algorithms is found in <em class="italic">Chapters 4, 5</em>, and <em class="italic">6</em>, which are on regression, classification, and forecasting, respectively.</p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor042"/>Getting the best results with ML model ensembling</h2>
			<p>AutoML will keep training <a id="_idIndexMarker109"/>ML models until it reaches a set time limit or a set limit on the number of models. Once either of these limits is passed, it will perform <strong class="bold">machine learning model ensembling</strong> using a <strong class="bold">voting ensemble</strong> and a <strong class="bold">stack ensemble</strong>. Voting ensembles score data <a id="_idIndexMarker110"/>based on the weighted averages of your best <a id="_idIndexMarker111"/>models, while stack ensembles train a meta-model <a id="_idIndexMarker112"/>based on the predictions of your best models.</p>
			<p>After training your ensemble models, AutoML will stop running and output the best model. Either the voting ensemble or stack ensemble will usually be your best-performing model. Sometimes, however, another model will slightly outperform both.</p>
			<h1 id="_idParaDest-44"><a id="_idTextAnchor043"/>Summary</h1>
			<p>In this chapter, you have learned about all the prerequisites that are necessary for creating AutoML solutions in Azure. You created an AMLS workspace and accessed AML studio before creating the necessary compute to run and write your AutoML jobs. You then loaded data into a datastore and registered it as a dataset to make it available for your AutoML runs.</p>
			<p>Importantly, you should now understand the four steps of the AutoML process: a data guardrails check, intelligent feature engineering, data transformation, and iterative ML model building. Everything you have done in this chapter will enable you to create a ML model in record time.</p>
			<p>You are now ready for <a href="B16595_03_ePub.xhtml#_idTextAnchor044"><em class="italic">Chapter 3</em></a>, <em class="italic">Training Your First AutoML Model</em>, where you will build your first AutoML model through a <strong class="bold">GUI</strong>. This chapter will cover a range of topics, from examining data to scoring models and explaining results. By the end of that chapter, you will not only be able to train models with AutoML, but you will also be able to show and explain your results to end users in a way that's guaranteed to earn their trust. </p>
		</div>
</body></html>