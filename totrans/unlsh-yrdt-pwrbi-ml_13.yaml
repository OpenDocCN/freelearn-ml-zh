- en: '13'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Using OpenAI and Azure OpenAI in Power BI Dataflows
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Chapter 12*](B19500_12.xhtml#_idTextAnchor165) of this book provided an overview
    of the OpenAI and Azure OpenAI technologies. The chapter also explored methods
    to incorporate these cutting-edge AI technologies into your use case using FAA
    Wildlife Strike data. To enhance the quality of the content in [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165),
    OpenAI ChatGPT was utilized to generate better text. Moving forward, ChatGPT will
    continue to be used on occasion as a tool to improve the writing quality of the
    rest of the book.'
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, there are two use cases for OpenAI and Azure OpenAI technologies
    that are discussed in detail in this chapter. Specifically, you will focus on
    their applications in summarization and descriptive content generation, as discussed
    in [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165). To illustrate these use cases,
    a project is included in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, you will see how to integrate OpenAI (or Azure OpenAI) into
    your Power BI solution for FAA Wildlife Strike data. Through this integration,
    you will be able to leverage GPT model APIs by adding new functions to Power BI
    dataflows. These functions will enable the generation of new content for each
    row of data in your solution. You will also use **Cognitive Services** in Power
    BI, which is an AI capability that has existed in Power Query and dataflows for
    a few years.
  prefs: []
  type: TYPE_NORMAL
- en: By the end of this chapter, you will have gained the knowledge necessary to
    apply GPT REST APIs in either OpenAI or Azure OpenAI to Power BI dataflows. These
    dataflows can then be refreshed on a predefined schedule. This capability will
    provide you with a powerful toolset for generating new content and insights from
    your data with minimal effort. The step-by-step instructions and examples provided
    in this chapter will equip you with the necessary skills to implement this solution
    in your own projects.
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter, you’ll need the following:'
  prefs: []
  type: TYPE_NORMAL
- en: 'An account with the original open source OpenAI: [https://openai.com/](https://openai.com/).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Optional – Azure OpenAI as part of your Azure subscription: [https://azure.microsoft.com/en-us/products/cognitive-services/openai-service](https://azure.microsoft.com/en-us/products/cognitive-services/openai-service).
    The book is written so that this is optional since it is not available to everyone
    at the time of publication.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: FAA Wildlife Strike data files from either the FAA website or the Packt GitHub
    site.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A Power BI Pro license.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'One of the following Power BI licensing options for access to Power BI dataflows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Power BI Premium
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Power BI Premium Per User
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'One of the following options for getting data into the Power BI cloud service:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft OneDrive (with connectivity to the Power BI cloud service)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Access + Power BI Gateway
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Data Lake (with connectivity to the Power BI cloud service)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring OpenAI and Azure OpenAI for use in your Power BI solution
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Prior to proceeding with the configuration of OpenAI and Azure OpenAI, it is
    important to note that OpenAI is still a nascent technology at the time of writing
    this book. In the future, the integration of OpenAI with Power BI may become less
    technical, as advancements in the technology continue to be made. However, the
    use cases that will be demonstrated in this chapter will remain applicable.
  prefs: []
  type: TYPE_NORMAL
- en: As such, the instructions provided in this chapter will showcase how this integration
    can be used to enhance your data analytics capabilities in the context of Power
    BI.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring OpenAI
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You can create an account in OpenAI (if you do not have one already) from this
    link: [https://chat.openai.com/auth/login](https://chat.openai.com/auth/login).
    At the time of writing, new accounts are granted trial credits to begin using
    OpenAI. If you run out of trial credits, or if the trial is no longer offered
    after this book has been written, you may need to pay for the use of OpenAI. Pricing
    details can be found at this link: [https://openai.com/pricing](https://openai.com/pricing).'
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have an OpenAI account, you will need to create an API key that will
    be used to authenticate your API calls. An API key can be easily created at this
    link: [https://platform.openai.com/account/api-keys](https://platform.openai.com/account/api-keys).
    Clicking on `abc123xyz` as an example key for the sample code. Be sure to use
    the actual **Key** from OpenAI, and not the **Key Name**.'
  prefs: []
  type: TYPE_NORMAL
- en: Once you have an account and an API key, you are ready to go with OpenAI for
    this book!
  prefs: []
  type: TYPE_NORMAL
- en: Configuring Microsoft Azure OpenAI
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: OpenAI is also available as a service in Microsoft Azure. By using the Microsoft
    Azure OpenAI Service, users can leverage large-scale AI models with the benefits
    of Azure, such as role-based access security, private networks, and comprehensive
    security tools that integrate with other Microsoft tools in Azure. Billing and
    governance can be centralized for large organizations to help ensure the responsible
    use of AI.
  prefs: []
  type: TYPE_NORMAL
- en: For the purposes of this book, Azure OpenAI is optional as an alternative to
    the original OpenAI. Azure OpenAI may not be available to everyone since it is
    a new technology with high demand. All of the content for the workshop can be
    done with either OpenAI or Azure OpenAI.
  prefs: []
  type: TYPE_NORMAL
- en: 'Instructions for setting up Azure OpenAI can be found at this link: [https://learn.microsoft.com/en-us/azure/cognitive-services/openai/how-to/create-resource/](https://learn.microsoft.com/en-us/azure/cognitive-services/openai/how-to/create-resource/).
    Once you’ve created a resource, you can also deploy a model per the instructions
    at that link. As noted in [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165), you
    will be using the `text-davinci-003` model for the workshop associated with this
    chapter. OpenAI is evolving rapidly, and you may be able to choose different models
    at the time you are reading this book. Take note of the following values when
    walking through these steps; they will be needed later in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '`PBI_OpenAI_project` for the examples in this chapter.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`text-davinci-003` model deployment. This book will use `davinci-PBIML` for
    names of deployments in examples of code.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Next, you’ll need to create a key for your Azure OpenAI API calls. From your
    Azure OpenAI resource, named `PBI_OpenAI_project` for this book, go to `abc123xyz`
    as an example key for the sample code.
  prefs: []
  type: TYPE_NORMAL
- en: Once you have either OpenAI or Azure OpenAI set up and ready to go, you can
    add some new generative text capabilities to your project using FAA Wildlife Strike
    data!
  prefs: []
  type: TYPE_NORMAL
- en: Preparing a Power BI dataflow for OpenAI and Azure OpenAI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165), you decided to use OpenAI
    for two use cases with your FAA Wildlife Strike database project:'
  prefs: []
  type: TYPE_NORMAL
- en: Generating descriptions of airplane models and the operator of the aircraft,
    for each incident
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summarizing the free text remarks provided in the report for each incident
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Since OpenAI is still new at the time of writing this book, Power BI does not
    yet have connectors built into the product. But you can still call OpenAI and
    Azure OpenAI APIs from both Power Query and Power BI dataflows using custom M
    scripts. Let’s get started!
  prefs: []
  type: TYPE_NORMAL
- en: 'First, you will create a new dataflow for use with OpenAI and Cognitive Services
    in Power BI:'
  prefs: []
  type: TYPE_NORMAL
- en: From your Power BI workspace, on the ribbon, select **New** | **Dataflow**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Define new tables** | **Link tables from** **other dataflows**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sign in and click **Next**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand your workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand the **Strike Reports** dataflow and check **Strike Reports** **Curated
    New**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Transform Data**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a group named **Sources** and move **Strike Reports Curated New** into
    that group.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click **Strike Reports Curated New** and unselect **Enable load**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, you will create a version of the query that will be used with OpenAI
    and Cognitive Services:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on **Strike Reports Curated New** and select **Reference**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Rename the new query `Strike Reports Curated` `New OpenAI`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a group named **OpenAI** and move **Strike Reports Curated New OpenAI**
    into the group.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165), you decided to use the
    FAA Wildlife Strike `UNKNOWN`:'
  prefs: []
  type: TYPE_NORMAL
- en: For the `UNKNOWN`, `UNKNOWN COMMERCIAL`, `BUSINESS`, and `PRIVATELY` `OWNED`
    values.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For the `UNKNOWN`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For the `Unknown bird`, `Unknown bird – large`, `Unknown bird – medium`, `Unknown
    bird – small`, and `Unknown bird` `or bat`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For the `(blank)`.
  prefs: []
  type: TYPE_NORMAL
- en: Finally – this step is optional – you can filter the number of rows for testing
    purposes. Both OpenAI and Azure OpenAI can run up a bill, so limiting the number
    of calls for this workshop makes sense. For the example in this book, the **Strike
    Reports Curated New OpenAI** table will be filtered to events happening in or
    after December 2022, which can be filtered using the **Incident** **Date** column.
  prefs: []
  type: TYPE_NORMAL
- en: Now you are ready to add OpenAI and Cognitive Services content to your data!
  prefs: []
  type: TYPE_NORMAL
- en: Creating OpenAI and Azure OpenAI functions in Power BI dataflows
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As noted earlier, integrating OpenAI and Azure OpenAI with Power Query or dataflows
    currently requires custom M code. To facilitate this process, we have provided
    M code for both OpenAI and Azure OpenAI, giving you the flexibility to choose
    which version to use based on your specific needs and requirements.
  prefs: []
  type: TYPE_NORMAL
- en: By leveraging this provided M code, you can seamlessly integrate OpenAI or Azure
    OpenAI with your existing Power BI solutions. This will allow you to take advantage
    of the unique features and capabilities offered by these powerful AI technologies,
    while also gaining insights and generating new content from your data with ease.
  prefs: []
  type: TYPE_NORMAL
- en: OpenAI and Azure OpenAI functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'OpenAI offers a user-friendly API that can be easily accessed and utilized
    from within Power Query or dataflows in Power BI. For further information regarding
    the specifics of the API, we refer you to the official OpenAI documentation, available
    at this link: [https://platform.openai.com/docs/introduction/overview](https://platform.openai.com/docs/introduction/overview).'
  prefs: []
  type: TYPE_NORMAL
- en: It is worth noting that optimizing and tuning the OpenAI API will likely be
    a popular topic in the coming year. Various concepts, including **prompt engineering**,
    **optimal token usage**, fine-tuning, embeddings, plugins, and parameters that
    modify response creativity (such as temperature and top *p*), can all be tested
    and fine-tuned for optimal results.
  prefs: []
  type: TYPE_NORMAL
- en: 'While these topics are complex and may be explored in greater detail in future
    works, this book will focus primarily on establishing connectivity between OpenAI
    and Power BI. Specifically, we will explore prompt engineering and token limits,
    which are key considerations that will be incorporated into the API call to ensure
    optimal performance:'
  prefs: []
  type: TYPE_NORMAL
- en: '`[Operator]` and `[Airplane]` as values without context, text was added to
    the request in the previous chapter such that the API will receive `Tell me about
    the airplane model [Aircraft] operated by [Operator] in three sentences:`. The
    prompt adds context to the values passed to the OpenAI model.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Tokens**: Words sent to the OpenAI model get broken into chunks called tokens.
    Per the OpenAI website, a token contains about four English language characters.
    Reviewing the **Remarks** column in the Power BI dataset reveals that most entries
    have up to 2,000 characters. (2000 / 4) = 500, so you will specify 500 as the
    token limit. Is that the right number? You’d need to do extensive testing to answer
    that question, which goes beyond the scope of this book.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s get started with building your OpenAI and Azure OpenAI API calls for Power
    BI dataflows!
  prefs: []
  type: TYPE_NORMAL
- en: Creating OpenAI and Azure OpenAI functions for Power BI dataflows
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You will create two functions for OpenAI in your dataflow named **OpenAI**.
    The only difference between the two will be the token limits. The purpose of having
    different token limits is primarily cost savings, since larger token limits could
    potentially run up a bigger bill. Follow these steps to create a new function
    named **OpenAIshort**:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Get data** | **Blank query**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Paste in the following M code and select `abc123xyz` with your OpenAI API key.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here is the code for the function. The code can also be found as `01 OpenAIshortFunction.M`
    in the Packt GitHub repository at [https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13](https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Now, you can rename the function `OpenAIshort`. Right-click on the function
    in the **Queries** panel and duplicate it. The new function will have a larger
    token limit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Rename this new function `OpenAIlong`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **OpenAIlong** and select **Advanced editor**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the section of code reading `Text.From(120)` to `Text.From(500)`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Your screen should now look like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.1 – OpenAI functions added to a Power BI dataflow](img/Figure_13.1_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.1 – OpenAI functions added to a Power BI dataflow
  prefs: []
  type: TYPE_NORMAL
- en: 'These two functions can be used to complete the workshop for the remainder
    of this chapter. If you’d prefer to use Azure OpenAI, the M code for `PBI_OpenAI_project`
    with your Azure resource name, `davinci-PBIML` with your deployment name, and
    `abc123xyz` with your API key:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'As with the previous example, changing the token limit for `Text.From(120)`
    to `Text.From(500)` is all you need to do to create an Azure OpenAI function for
    500 tokens instead of 120\. The M code to create the dataflows for your OpenAI
    functions can also be found on the Packt GitHub site at this link: [https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13](https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13).'
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have your OpenAI and Azure OpenAI functions ready to go in a Power
    BI dataflow, you can test them out on the FAA Wildlife Strike data!
  prefs: []
  type: TYPE_NORMAL
- en: Using OpenAI and Azure OpenAI functions in Power BI dataflows
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Your next step is to prep the FAA Wildlife Strike data for the OpenAI or Azure
    OpenAI functions to do content generation and summarization. As discussed previously,
    you’ll need to build effective prompts to provide context for the OpenAI models
    to process. The completed query for **Reports Curated New OpenAI**, which can
    be copied and pasted into Power BI, is also available from the Packt GitHub repository:
    [https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13](https://github.com/PacktPublishing/Unleashing-Your-Data-with-Power-BI-Machine-Learning-and-OpenAI/tree/main/Chapter-13).'
  prefs: []
  type: TYPE_NORMAL
- en: 'Looking back to [*Chapter 12*](B19500_12.xhtml#_idTextAnchor165), you decided
    upon the following combinations of new text with row-level content from the FAA
    Wildlife Strike database:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Generating new information about airplanes and the carriers: `Tell me about
    the airplane model [Aircraft] operated by [Operator] in` `three sentences:`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Summarizing the remarks from each report, including the operator, aircraft,
    and species: `Summarize the following: A [Operator] [Aircraft] struck a [Species].
    Remarks on the FAA report` `were: [Remarks]`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can now add two new columns to the **Strike Reports Curated New OpenAI**
    query. First, you add a column to prompt text generation:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Add column** | **Custom Column**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set `Text` `Generation Prompt`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Paste in the following text: `"Tell me about the airplane model " & [Aircraft]
    &" operated by " & [Operator] & " in three sentences:"`. Then, select **OK**.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the data type to `Text`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Validate that the new column creates text to be used as information with built-in
    prompts that look like this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.2 – New column to be used with OpenAI](img/Figure_13.2_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.2 – New column to be used with OpenAI
  prefs: []
  type: TYPE_NORMAL
- en: 'Now create a second column that will be used for text summarization that also
    contains built-in prompts:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Add column** | **Custom Column**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set `Text` `Summarization Prompt`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Paste in the following text: `"Summarize the following: A " & [Operator] &
    " " & [Aircraft] & " struck a " & [Species] & ". Remarks on the FAA report were:
    " & [``Remarks]`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the data type to `Text`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Validate that the new column for summarization, with a built-in prompt, looks
    like this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.3 – New column for summarizations with built-in prompt](img/Figure_13.3_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.3 – New column for summarizations with built-in prompt
  prefs: []
  type: TYPE_NORMAL
- en: 'Now you’ve created two columns in your Power BI dataflow query that are ready
    for OpenAI functions! Start by calling OpenAI using the `OpenAIshort` function
    for text generation:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Add column** | **Custom Column**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set `OpenAI` `Aircraft Description`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Paste the following text into `OpenAIshort([Text` `Generation Prompt])`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Validate that OpenAI generated text for the new column. You can hover over
    a field in the new column to read the full text:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.4 – OpenAI generated a description of the aircraft for that operator
    with new data from outside the FAA Wildlife Strike database](img/Figure_13.4_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.4 – OpenAI generated a description of the aircraft for that operator
    with new data from outside the FAA Wildlife Strike database
  prefs: []
  type: TYPE_NORMAL
- en: 'Repeating the preceding steps for text summarization of the `OpenAIlong` function:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Add column** | **Custom Column**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set `OpenAI` `Remarks Summarization`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Paste the following text into `OpenAIlong([Text` `Summarization Prompt])`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Validate that OpenAI generated text for the new column, and again you can hover
    over a field to view the full summarization:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.5 – Text summarization for remarks about aircraft hitting wildlife](img/Figure_13.5_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.5 – Text summarization for remarks about aircraft hitting wildlife
  prefs: []
  type: TYPE_NORMAL
- en: You’ve done it! OpenAI was successfully used to both generate new information
    about aircraft and summarize the free text remarks about wildlife strike incidents.
    You might want to save your dataflow at this point so that you don’t lose any
    work.
  prefs: []
  type: TYPE_NORMAL
- en: Adding a Cognitive Services function to the solution
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Finally, you decide to add more value to the deliverables by showcasing the
    Cognitive Services capabilities in Power BI. In both Power BI Desktop and Power
    BI dataflows, Cognitive Services is built in as part of the SaaS tool. Details
    about using Cognitive Services in Power BI can be found at this link: [https://learn.microsoft.com/en-us/power-bi/connect-data/service-tutorial-use-cognitive-services](https://learn.microsoft.com/en-us/power-bi/connect-data/service-tutorial-use-cognitive-services).'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cognitive Services refers to Azure services that can be called using APIs to
    score data with standard ML models. These tools can score the sentiment of text,
    identify images, extract key phrases, detect emotion in pictures, and more. The
    following Cognitive Services features are native to Power BI at the time of writing
    this book:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Detect Language**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Tag Images**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Score Sentiment**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Extract** **Key Phrases**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For this final addition to the project, you will use the Score Sentiment function
    on the `0` to `1`, with `0` being negative, `0.5` being neutral, and `1` being
    positive.
  prefs: []
  type: TYPE_NORMAL
- en: 'Opening back up your **OpenAI** dataflow, navigate to the query for **Strike
    Reports Curated New OpenAI** and follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Highlight the **Remarks** column.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to **Home** | **Insights** | **AI Insights**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sign in and an **AI Insights** window will pop up.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Notice that Cognitive Services is available, along with the Power BI ML models
    that you created! You can also use this capability to reuse your Power BI ML models
    to score multiple columns of data in different dataflows.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.6 – Cognitive Services and Power BI ML models can be called as
    functions](img/Figure_13.6_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.6 – Cognitive Services and Power BI ML models can be called as functions
  prefs: []
  type: TYPE_NORMAL
- en: Select **CognitiveServices.ScoreSentiment**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Remarks** column from the dropdown and hit **Apply**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the data type to `decimal number`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Validate that the sentiment was scored and added as a new column:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.7 – Sentiment scores for the Remarks column](img/Figure_13.7_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.7 – Sentiment scores for the Remarks column
  prefs: []
  type: TYPE_NORMAL
- en: 'You can now save and refresh your dataflow, and you’re done! When the dataflow
    has refreshed, you can connect from Power BI Desktop and browse the results of
    your work:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.8 – Results of OpenAI and Cognitive Services viewed in Power BI](img/Figure_13.8_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.8 – Results of OpenAI and Cognitive Services viewed in Power BI
  prefs: []
  type: TYPE_NORMAL
- en: To make it easier to read, *Figure 13**.8* is split into two images. *Figure
    13**.9* shows the left hand columns.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.9 – Results of OpenAI and Cognitive Services viewed in Power BI](img/Figure_13.9_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.9 – Results of OpenAI and Cognitive Services viewed in Power BI
  prefs: []
  type: TYPE_NORMAL
- en: The right-hand column is shown in *Figure 13**.10*.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.10 – Results of OpenAI and Cognitive Services viewed in Power BI](img/Figure_13.10_B19500.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.10 – Results of OpenAI and Cognitive Services viewed in Power BI
  prefs: []
  type: TYPE_NORMAL
- en: Once you have gained a solid understanding of how to implement various tools
    and services within Power BI, such as Cognitive Services provided by OpenAI or
    Azure OpenAI, you can experiment with different prompt strategies and explore
    a wide range of additional capabilities.
  prefs: []
  type: TYPE_NORMAL
- en: By leveraging the knowledge and skills gained from this book, you will be equipped
    to test new ideas, fine-tune your approaches, and optimize the performance of
    your solutions. With these tools at your disposal, the possibilities for enhancing
    your data analytics and content generation capabilities within Power BI are virtually
    limitless. So, don’t be afraid to dive in and explore all that these powerful
    technologies have to offer!
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter covered the integration of OpenAI or Azure OpenAI with Power BI,
    along with a use case for Power BI Cognitive Services. By leveraging these advanced
    tools, you were able to generate new descriptions of airplanes using external
    data and GPT models, summarize remarks about wildlife strikes, and even score
    the remarks for sentiment analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Moving forward, the next and final chapter will provide an opportunity to review
    and reflect on the work accomplished throughout this book and the accompanying
    workshop. We will also begin to explore new strategies for enhancing and expanding
    upon the existing project, as we recognize that projects are never truly complete
    if there is still potential for additional value to be achieved.
  prefs: []
  type: TYPE_NORMAL
