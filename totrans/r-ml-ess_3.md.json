["```py\nhelp(Titanic)\n```", "```py\nclass(Titanic)\n[1] \"table\"\n\n```", "```py\nTitanic\n, , Age = Child, Survived = No\n\n Sex\nClass  Male Female\n 1st     0      0\n 2nd     0      0\n 3rd    35     17\n Crew    0      0\n...\n\n```", "```py\ndfTitanic <- data.frame(Titanic)\n```", "```py\nstr(dfTitanic)\n'data.frame':   32 obs. of  5 variables:\n $ Class   : Factor w/ 4 levels \"1st\",\"2nd\",\"3rd\",..: 1 2 3 4 1 2 3 4 1 2 ...\n $ Sex     : Factor w/ 2 levels \"Male\",\"Female\": 1 1 1 1 2 2 2 2 1 1 ...\n $ Age     : Factor w/ 2 levels \"Child\",\"Adult\": 1 1 1 1 1 1 1 1 2 2 ...\n $ Survived: Factor w/ 2 levels \"No\",\"Yes\": 1 1 1 1 1 1 1 1 1 1 ...\n $ Freq    : num  0 0 35 0 0 0 17 0 118 154 ...\n\n```", "```py\nlibrary(data.table)\ndtTitanic <- data.table(dfTitanic)\n```", "```py\nhead(dtTitanic)\n Class    Sex   Age Survived Freq\n1:   1st   Male Child       No    0\n2:   2nd   Male Child       No    0\n3:   3rd   Male Child       No   35\n4:  Crew   Male Child       No    0\n5:   1st Female Child       No    0\n6:   2nd Female Child       No    0\n\n```", "```py\nnTot <- dtTitanic[, sum(Freq)]\nnTot\n[1] 2201\n\n```", "```py\ndtSurvived <- dtTitanic[, list(n=sum(Freq)), by='Survived']\ndtSurvived\n Survived    n\n1:       No 1490\n2:      Yes  711\n\n```", "```py\nhelp(barplot)\n```", "```py\n    vectorHeight <- dtSurvived[, n]\n    ```", "```py\n    vectorNames <- dtSurvived[, Survived]\n    ```", "```py\n    barplot(height=vectorHeight, names.arg=vectorNames)\n    ```", "```py\nbarplot(height=dtSurvived[, n], names.arg=dtSurvived[, Survived])\n```", "```py\n    dtSurvived[, percentage := n / sum(n)]\n    ```", "```py\n    dtSurvived[, colorPlot := ifelse(Survived == 'Yes', 'blue', 'red')]\n    ```", "```py\n    barplot(\n      height=dtSurvived[, percentage],\n      names.arg=dtSurvived[, Survived],\n      col=dtSurvived[, colorPlot],\n      ylim=c(0, 1)\n    )\n    ```", "```py\n    dtSurvived[, textPercentage := paste(round(percentage * 100), '%', sep='')]\n    ```", "```py\n    plotTitle <- 'Proportion of passengers surviving or not'\n    ```", "```py\n    ylabel <- 'percentage'\n    ```", "```py\n    barplot(\n      height=dtSurvived[, percentage],\n      names.arg=dtSurvived[, Survived],\n      col=dtSurvived[, colorPlot],\n      ylim=c(0, 1),\n      legend.text=dtSurvived[, textPercentage],\n      ylab=ylabel,\n      main=plotTitle\n    )\n    ```", "```py\ndtGender <- dtTitanic[, list(n=sum(Freq)), by=c('Survived', 'Sex')]\ndtGender\n Survived    Sex    n\n1:       No   Male 1364\n2:       No Female  126\n3:      Yes   Male  367\n4:      Yes Female  344\n\n```", "```py\n    dtGender[, percentage := n / sum(n), by='Sex']\n    ```", "```py\n    dtGender[, colorPlot := ifelse(Survived == 'Yes', 'blue', 'red')]\n    ```", "```py\n    dtGender[, textPercentage := paste(round(percentage * 100), '%', sep='')]\n    ```", "```py\n    dtGenderMale <- dtGender[Sex == 'Male']\n    ```", "```py\n    barplot(\n      height=dtGenderMale[, percentage],\n      names.arg=dtGenderMale[, Survived],\n      col=dtGenderMale[, colorPlot],\n      ylim=c(0, 1),\n      legend.text=dtGenderMale[, textPercentage],\n      ylab='percentage',\n      main='Survival rate for the males'\n    )\n    ```", "```py\n    barplot(\n      height=dtGender[Sex == 'Female', percentage],\n      names.arg=dtGender[Sex == 'Female', Survived],\n      col=dtGender[Sex == 'Female', colorPlot],\n      ylim=c(0, 1),\n      legend.text=dtGender[Sex == 'Female', textPercentage],\n      ylab='percentage',\n      main='Survival rate for the females'\n    )\n    ```", "```py\nbarplot(\n  height=dtGender[Survived == 'Yes', percentage],\n  names.arg=dtGender[Survived == 'Yes', Sex],\n  col=dtGender[Survived == 'Yes', Sex],\n  ylim=c(0, 1),\n  legend.text=dtGender[Survived == 'Yes', textPercentage],\n  ylab='percentage',\n  main='Survival rate by gender'\n)\n```", "```py\n    dtClass <- dtTitanic[, list(n=sum(Freq)), by=c('Survived', 'Class')]\n    ```", "```py\n    dtClass[, percentage := n / sum(n), by='Class']\n    ```", "```py\n    dtClass[, textPercentage := paste(round(percentage * 100), '%', sep='')]\n    ```", "```py\n    barplot(\n      height=dtClass[Survived == 'Yes', percentage],\n      names.arg=dtClass[Survived == 'Yes', Class],\n      col=dtClass[Survived == 'Yes', Class],\n      ylim=c(0, 1),\n      legend.text=dtClass[Survived == 'Yes', textPercentage],\n      ylab='survival rate',\n      main='Survival rate by class'\n    )\n    ```", "```py\ndtGenderFreq <- dtTitanic[, list(n=sum(Freq)), by=c('Sex', 'Class')]\ndtGenderFreq[, percentage := n / sum(n), by='Class']\ndtGenderFreq <- dtGenderFreq[Sex == 'Female']\ndtGenderFreq[, textPercentage := paste(round(percentage * 100), '%', sep='')]\nbarplot(\n  height=dtGenderFreq[, percentage],\n  names.arg=dtGenderFreq[, Class],\n  col=dtGenderFreq[, Class],\n  ylim=c(0, 1),\n  legend.text=dtGenderFreq[, textPercentage],\n  ylab='survival rate',\n  main='Percentage of females'\n)\n```", "```py\n    dtGenderClass <- dtTitanic[, list(n=sum(Freq)), by=c('Survived', 'Sex', 'Class')]\n    ```", "```py\n    dtGenderClass[, nTot := sum(n), by=c('Sex', 'Class')]\n    ```", "```py\n    dtGenderClass[, percentage := n / sum(n), by=c('Sex', 'Class')]\n    ```", "```py\n    dtGenderClass <- dtGenderClass[Survived == 'Yes']\n    ```", "```py\n    dtGenderClass[, textPercentage := paste(round(percentage * 100), '%', sep='')]\n    ```", "```py\n    dtGenderClass[, colorPlot := rainbow(nrow(dtGenderClass))]\n    ```", "```py\n    dtGenderClass[, SexAbbr := ifelse(Sex == 'Male', 'M', 'F')]\n    dtGenderClass[, barName := paste(Class, SexAbbr, sep='')]\n    ```", "```py\n    dtGenderClass[, barLabel := paste(barName, nTot, sep='\\n')]\n    ```", "```py\n    barplot(\n      height=dtGenderClass[, percentage],\n      names.arg=dtGenderClass[, barLabel],\n      col=dtGenderClass[, colorPlot],\n      xlim=c(0, 11),\n      ylim=c(0, 1),\n      ylab='survival rate',\n      legend.text=dtGenderClass[, textPercentage]\n    )\n    ```", "```py\n    dtTitanic[, nTot := sum(Freq), by=c('Sex', 'Class', 'Age')]\n    ```", "```py\n    dtTitanic[, percentage := Freq / nTot]\n    ```", "```py\n    dtAll <- dtTitanic[Survived == 'Yes', ]\n    ```", "```py\n    dtAll[, ClassAbbr := substring(Class, 1, 1)]\n    dtAll[, SexAbbr := ifelse(Sex == 'Male', 'M', 'F')]\n    dtAll[, AgeAbbr := ifelse(Age == 'Child', 'C', 'A')]\n    dtAll[, textLegend := paste(ClassAbbr, SexAbbr, AgeAbbr, sep='')];\n    ```", "```py\n    dtAll[, colorPlot := rainbow(nrow(dtAll))]\n    ```", "```py\n    dtAll[, labelPerc := paste(round(percentage * 100), '%', sep='')]\n    ```", "```py\n    dtAll[, label := paste(labelPerc, nTot, sep='\\n')]\n    ```", "```py\n    barplot(\n      height=dtAll[, percentage],\n      names.arg=dtAll[, label],\n      col=dtAll[, colorPlot],\n      xlim=c(0, 23),\n      legend.text=dtAll[, textLegend],\n      cex.names=0.5\n    )\n    ```", "```py\ninstall.packages('rpart')\ninstall.packages('rpart.plot')\n```", "```py\nlibrary('rpart')\nlibrary('rpart.plot')\n```", "```py\ndtLong <- dtTitanic[\n  , list(Freq = rep(1, Freq)),\n  by=c('Survived', 'Sex', 'Age', 'Class')\n  ]\n```", "```py\ndtLong[, Freq := NULL]\n```", "```py\ndtLong[, Survived := ifelse(Survived == 'Yes', 1, 0)]\n```", "```py\nhead(dtLong)\n Survived  Sex   Age Class\n1:        0 Male Child   3rd\n2:        0 Male Child   3rd\n3:        0 Male Child   3rd\n4:        0 Male Child   3rd\n5:        0 Male Child   3rd\n6:        0 Male Child   3rd\n\n```", "```py\nhelp(rpart)\n```", "```py\nformulaRpart <- formula('Survived ~ Sex + Age + Class')\n```", "```py\ntreeRegr <- rpart(\n  formula=formulaRpart,\n  data=dtLong\n)\n```", "```py\ntreeClass = rpart(\n    formula='Survived ~ Sex + Age + Class',\n    data=dtLong,\n    method='class'\n)\nprp(treeClass)\n```", "```py\ninstall.packages('randomForest')\nlibrary('randomForest')\n```", "```py\n    dtDummy <- copy(dtLong)\n    ```", "```py\n    dtDummy[, Male := Sex == 'Male']\n    dtDummy[, Sex := NULL]\n    ```", "```py\n    dtDummy[, Child := Age == 'Child']\n    dtDummy[, Age := NULL]\n    ```", "```py\n    dtDummy[, Class1 := Class == '1st']\n    dtDummy[, Class2 := Class == '2nd']\n    dtDummy[, Class3 := Class == '3rd']\n    dtDummy[, Class := NULL]\n    ```", "```py\n    formulaRf <- formula('Survived ~ Male + Child + Class1 + Class2 + Class3')\n    ```", "```py\n    forest <- randomForest(\n      formula=formulaRf,\n      data=dtDummy\n    )\n    ```", "```py\nforest$ntree\n[1] 500\n\n```", "```py\nforest$mtry\n[1] 1\n\n```", "```py\nforest$type\n[1] \"regression\"\n\n```", "```py\nforest <- randomForest(\n  formula=formulaRf,\n  data=dtDummy,\n  ntree=1000,\n  mtry=3,\n  sampsize=1500\n)\n```", "```py\nrowRandom <- dtDummy[100]\nrowRandom\n Survived Freq Male Child Class1 Class2 Class3\n1:       No    1 TRUE FALSE   TRUE  FALSE  FALSE\n\n```", "```py\npredict(forest, rowRandom)\n 1 \n0.3830159\n\n```", "```py\nprediction = predict(forest, dtDummy)\n```", "```py\nsample(prediction, 6)\n 1895       448       967      1553      1683         4 \n0.6934046 0.2260507 0.2499303 0.3830159 0.2260507 0.2974706\n\n```", "```py\ndtDummy[, SurvivalRatePred := predict(forest, dtDummy)]\n```", "```py\ndtDummy[, SurvivedPred := ifelse(SurvivalRatePred > 0.5, 1, 0)]\n```", "```py\ndtDummy[, error := SurvivedPred != Survived]\n```", "```py\npercError <- dtDummy[, sum(error) / .N]\npercError\n[1] 0.2094502\n\n```", "```py\ndtTitanic[Survived == 'No', sum(Freq)] / dtTitanic[, sum(Freq)]\n[1] 0.676965\n\n```", "```py\nindexTrain <- sample(\n  x=c(TRUE, FALSE),\n  size=nrow(dtDummy),\n  replace=TRUE,\n  prob=c(0.8, 0.2)\n)\n```", "```py\ndtTrain <- dtDummy[indexTrain]\n```", "```py\ndtTest <- dtDummy[!indexTrain]\n```", "```py\nforest <- randomForest(\n  formula=formulaRf,\n  data=dtTrain,\n  ntree=1000,\n  mtry=3,\n  sampsize=1200\n)\n```", "```py\ndtTest[, SurvivalRatePred := predict(forest, dtTest)]\ndtTest[, SurvivedPred := ifelse(SurvivalRatePred > 0.5, 1, 0)]\ndtTest[, error := SurvivedPred != Survived]\npercError <- dtTest[, sum(error) / .N]\npercError\n[1] 0.2416107\n\n```"]