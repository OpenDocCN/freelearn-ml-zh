# 前言

在过去十年中，**机器学习**（**ML**）已经从科学界的一个小众概念发展成为一个企业级工具集，可以用来改进业务流程和构建智能产品和服务。主要原因是全球生成数据的量持续增加，需要分布式系统、强大的算法和可扩展的云基础设施来计算洞察。这本书将帮助你提高你对ML概念的了解，找到适合你用例的正确模型，并为你提供运行机器学习模型和在Azure云中构建端到端ML管道的技能集。

本书从概述端到端ML项目的每一步骤以及如何选择适合不同ML任务的正确Azure服务开始。从那时起，它专注于Azure Machine Learning服务，并带你了解数据准备和特征工程的重要流程。随后，本书专注于满足不同需求的ML建模技术，包括使用**自然语言处理**（**NLP**）的高级特征提取技术、经典ML技术如集成学习，以及使用深度学习方法的优秀推荐引擎和高效计算机视觉模型的秘诀。此外，本书探讨了如何使用Azure自动化机器学习和HyperDrive训练、优化和调整模型，以及在Azure上的分布式训练集群上执行模型训练。最后，本书涵盖了将ML模型部署到不同的目标计算环境，如Azure Machine Learning集群、Azure Kubernetes服务以及**现场可编程门阵列（FPGA**），以及使用Azure DevOps设置MLOps管道。

在本书结束时，你将具备从开始到结束运行一个精心设计的ML项目的坚实基础，并将掌握Azure中用于训练、部署和操作ML模型和管道的工具。

# 这本书面向的对象

本书是为那些希望使用Microsoft Azure云来管理他们的数据集和机器学习实验，并使用MLOps构建企业级ML架构的机器学习工程师、数据科学家和机器学习开发者所写。任何对ML主题感兴趣的读者都将学习到ML过程的重要步骤以及如何使用Azure Machine Learning来支持他们。本书将支持任何构建强大的ML云应用程序的人。建议读者具备基本的Python理解和ML知识。

# 这本书涵盖的内容

[*第一章*](B17928_01_ePub.xhtml#_idTextAnchor015)，*理解端到端机器学习过程*，涵盖了机器学习的历史、应用机器学习的场景、必要的统计知识，以及运行自定义端到端机器学习项目所需的步骤和组件。其目的是让每位读者达到相同的基础水平。因此，对于非常了解机器学习的读者来说，某些部分可能是一些回顾，但仍然可能包含一些有用的实用技巧和指南。它还旨在成为本书的指南，其中机器学习过程中的每一步都将指向详细涵盖它们的章节。

[*第二章*](B17928_02_ePub.xhtml#_idTextAnchor034)，*在Azure中选择合适的机器学习服务*，帮助我们了解和分类可用的Azure机器学习服务。我们将定义使用某些服务的场景，并得出结论，对于构建自定义机器学习模型，Azure机器学习是最好的选择。从本章开始，我们将使用Azure机器学习服务中可用的工具来执行所有即将到来的机器学习过程中的任务。

[*第三章*](B17928_03_ePub.xhtml#_idTextAnchor054)，*准备Azure机器学习工作区*，涵盖了Azure机器学习服务的设置以及使用该服务进行的一些初步机器学习培训。我们将学习如何在Azure机器学习中跟踪实验、绘制指标和创建机器学习运行的快照，同时进行机器学习训练实验。

[*第四章*](B17928_04_ePub.xhtml#_idTextAnchor071)，*数据摄取和管理数据集*，涵盖了存储我们底层数据的可用Azure服务以及如何在Azure中设置它们。此外，我们将了解如何通过**提取、转换和加载**（**ETL**）过程手动或自动地将所需数据带到这些服务中，以及如何将其他Azure数据服务与Azure机器学习集成。最后，我们将介绍Azure机器学习中的数据存储和数据集的概念，以及如何在实验运行中使用它们。

[*第五章*](B17928_05_ePub.xhtml#_idTextAnchor085)，*执行数据分析与可视化*，涵盖了探索和预处理机器学习数据集所需的步骤。我们将了解表格数据集和文件数据集之间的区别，并学习如何清理我们的数据集、关联特征，以及使用统计特性和领域知识来深入了解我们的数据集。利用我们所学的知识，我们将亲自动手处理一个真实数据集来应用我们的知识。最后，我们将简要了解一些流行的嵌入技术，如PCA、LDA、t-SNE和UMAP。

[*第6章*](B17928_06_ePub.xhtml#_idTextAnchor102), *特征工程和标注*，涵盖了在数据集中创建或调整特征以及为监督机器学习训练创建标签的重要过程。我们将了解改变特征的原因，并简要浏览各种可用的方法来创建、转换、提取和选择数据集中的特征，然后我们将使用这些方法在我们的实际数据集上。此外，我们将探讨为不同类型的数据集标注技术，并在Azure机器学习中的数据标注工具上进行实际操作。

[*第7章*](B17928_07_ePub.xhtml#_idTextAnchor112), *使用NLP进行高级特征提取*，进一步探讨了从文本和分类数据中提取特征的问题——这是用户在训练机器学习模型时经常遇到的问题。本章将描述**自然语言处理**（**NLP**）特征提取的基础。这将帮助我们使用包括n-gram、词袋模型、TF-IDF、Word2Vec等技术在分类和文本数据中创建语义嵌入。

[*第8章*](B17928_08_ePub.xhtml#_idTextAnchor135), *Azure机器学习管道*，介绍了如何使用Azure机器学习管道将所学知识应用于自动化的预处理和训练管道。我们将学习如何将代码拆分为模块化管道步骤，以及如何通过端点和调度参数化和触发管道。最后，我们将构建几个训练管道，并学习如何将它们集成到其他Azure服务中。

[*第9章*](B17928_09_ePub.xhtml#_idTextAnchor152), *使用Azure机器学习构建ML模型*，教你如何使用集成技术构建Azure中的传统机器学习模型。本章重点介绍基于决策树的集成学习方法，使用Azure机器学习中的LightGBM实现流行的最先进提升和袋装技术。这将帮助你将袋装和提升的概念应用于机器学习模型。

[*第10章*](B17928_10_ePub.xhtml#_idTextAnchor165), *在Azure上训练深度神经网络*，介绍了如何使用深度学习来训练更复杂的参数化模型，以在大数据集上实现更好的泛化。我们将简要概述哪些情况下深度学习可以很好地应用，以及它与更传统的机器学习方法的区别。之后，我们将讨论合理的实用指南，最终在Azure机器学习上使用Keras训练**卷积神经网络**（**CNN**）。

[*第11章*](B17928_11_ePub.xhtml#_idTextAnchor178), *超参数调整和自动化机器学习*，涵盖了机器学习训练过程的优化以及如何自动化它以避免人为错误。这些调整技巧将帮助你更快、更有效地训练模型。因此，我们将探讨超参数调整（在Azure机器学习中也称为**HyperDrive**），这是一种优化机器学习模型所有外部参数的标准技术。通过评估不同的超参数调整采样技术，如随机采样、网格采样和贝叶斯优化，你将学习如何有效地管理运行时间和模型性能之间的权衡。然后，我们将从超参数优化推广到使用**Azure自动化机器学习**自动化完整的端到端机器学习训练过程。

[*第12章*](B17928_12_ePub.xhtml#_idTextAnchor189), *Azure上的分布式机器学习*，探讨了用于在GPU上并行高效训练机器学习模型的分布式和并行计算算法和框架。本章的目标是在Azure中构建一个环境，你可以通过向你的训练环境添加更多机器来加速经典机器学习和深度学习模型的训练过程，从而扩展集群。

[*第13章*](B17928_13_ePub.xhtml#_idTextAnchor202), *在Azure中构建推荐引擎*，深入探讨了传统和现代推荐引擎，这些推荐引擎通常结合了前面章节中介绍的技术和技巧。我们将快速查看不同类型的推荐引擎，每种类型需要哪些数据，以及可以使用这些不同方法推荐什么，例如基于内容的推荐和基于评分的推荐引擎。我们将结合这两种技术构建一个单一的混合推荐器，并了解现代推荐引擎的最新技术。

[*第14章*](B17928_14_ePub.xhtml#_idTextAnchor217), *模型部署、端点和操作*，最后介绍了如何将我们的机器学习模型部署到生产环境中，无论是部署到批处理集群进行离线评分，还是作为端点进行在线评分。为了实现这一点，我们将打包模型和执行运行时，在模型注册表中注册它们，并将它们部署到执行环境中。我们只需几行代码就可以将Azure机器学习中的模型自动部署到**Azure Kubernetes服务**。最后，你将学习如何使用现成的自定义指标来监控你的目标环境。

[*第15章*](B17928_15_ePub.xhtml#_idTextAnchor238)，*模型互操作性、硬件优化和集成*，介绍了使用**开放神经网络交换**（**ONNX**）标准化部署模型格式的方法，解释了**现场可编程门阵列**（**FPGA**）是什么，以及如何在Azure中将它们用作部署目标。此外，我们将学习如何将Azure人工智能与其他Microsoft服务（如**Azure IoT Edge**和**Power BI**）集成。在这里，我们将了解FPGA和GPU在性能、成本和效率方面的基本差异，并在Power BI中进行实际操作，以集成我们之前部署的端点之一。

[*第16章*](B17928_16_ePub.xhtml#_idTextAnchor252)，*使用MLOps将模型投入生产*，最终介绍了如何将数据摄取、数据准备、我们的机器学习训练和部署管道以及任何所需的脚本整合为一个端到端操作。这包括创建环境；启动、停止和扩展集群；提交实验；执行参数优化；以及在Kubernetes上部署完整的评分服务。我们将重用之前应用的所有概念，以构建一个版本控制的、可重复的、自动化的机器学习训练和部署过程，作为Azure DevOps中的**持续集成/持续部署**（**CI/CD**）管道。

[*第17章*](B17928_17_ePub.xhtml#_idTextAnchor269)，*为成功的人工智能之旅做准备*，通过总结我们在整本书中学到的重大概念，并强调在执行人工智能时真正重要的事情来结束全书。我们重申了干净的基础设施、监控和自动化的重要性，并讨论了人工智能和基于云的服务不断变化的特点。最后，我们涵盖了本书中多次提及的一个重要话题，即数据处理中的伦理问题。我们将讨论您拥有公平且可解释的人工智能模型的责任，以及Azure人工智能和开源工具如何帮助您实现这一目标。

# 为了充分利用这本书

本书需要使用Azure服务，因此需要一个Azure订阅。您可以通过注册页面[https://azure.microsoft.com/en-us/free/](https://azure.microsoft.com/en-us/free/)免费创建Azure账户，并在30天内获得200美元的信用额度。

要运行作者代码，您可以使用Azure Machine Learning工作区中的计算实例（通常是`Standard_DS3_v2`虚拟机），这为您提供了访问Jupyter环境和所有预安装的基本库，或者您可以在自己的本地机器上运行它。要这样做，您需要一个安装了Jupyter包的Python运行时和一些额外的库，这些库将在每一章的技术要求中提到。我们在写作时使用Python版本3.8和Azure ML Python SDK版本1.34.0测试了所有代码。如果您想使用不同的设置，请确保检查Azure ML Python SDK支持的Python版本（[https://pypi.org/project/azureml-sdk/](https://pypi.org/project/azureml-sdk/)）。

**如果您正在使用这本书的数字版，我们建议您亲自输入代码或从书的GitHub仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误。**

最后，为了最大限度地利用本书，您应该有使用Python进行编程的经验，并对流行的ML和数据操作库（如TensorFlow、Keras、scikit-learn和pandas）有基本的了解。

# 下载示例代码文件

您可以从GitHub（[https://github.com/PacktPublishing/Mastering-Azure-Machine-Learning-Second-Edition](https://github.com/PacktPublishing/Mastering-Azure-Machine-Learning-Second-Edition)）下载本书的示例代码文件。如果代码有更新，它将在GitHub仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包，可在[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)找到。查看它们吧！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图和图表的彩色图像的PDF文件。您可以从这里下载：[https://static.packt-cdn.com/downloads/9781803232416_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781803232416_ColorImages.pdf)。

# 使用的约定

在本书中使用了多种文本约定。

**文本中的代码**：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟URL、用户输入和Twitter昵称。以下是一个示例：“`score.py`脚本是一个部署文件，需要包含`init()`和`run(batch)`方法。”

代码块设置如下：

[PRE0]

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

[PRE1]

任何命令行输入或输出都按以下方式编写：

[PRE2]

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以粗体显示。以下是一个示例：“我们可以看到数据集作为名为**titanic**的输入传递到**预处理**步骤。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至[customercare@packtpub.com](mailto:customercare@packtpub.com)，并在邮件主题中提及书名。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告，我们将非常感谢。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上发现我们作品的任何非法副本，我们将不胜感激，如果您能提供位置地址或网站名称，我们将非常感谢。请通过[copyright@packt.com](mailto:copyright@packt.com)与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《精通Azure机器学习》，我们很乐意听到您的想法！请[点击此处直接访问亚马逊评论页面](https://packt.link/r/1-803-23241-2)并分享您的反馈。

您的评论对我们和科技社区都非常重要，并将帮助我们确保我们提供高质量的内容。
