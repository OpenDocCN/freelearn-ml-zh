- en: '1'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '1'
- en: Introducing Conformal Prediction
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正规预测介绍
- en: This book is about conformal prediction, a modern framework for uncertainty
    quantification that is becoming increasingly popular in industry and academia.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本书关于正规预测，这是一个用于不确定性量化的现代框架，在工业和学术界越来越受欢迎。
- en: Machine learning and AI applications are everywhere. In the realm of machine
    learning, prediction is a fundamental task. Given a training dataset, we train
    a machine learning model to make predictions on new data.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习和人工智能应用无处不在。在机器学习的领域，预测是一个基本任务。给定一个训练数据集，我们训练一个机器学习模型对新数据进行预测。
- en: '![Figure 1.1 – Machine learning prediction model](img/B19925_01_001.jpg)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
  zh: '![图1.1 – 机器学习预测模型](img/B19925_01_001.jpg)'
- en: Figure 1.1 – Machine learning prediction model
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.1 – 机器学习预测模型
- en: However, in many real-world applications, the predictions made by statistical,
    machine learning, and deep learning models are often incorrect or unreliable because
    of various factors, such as insufficient or incomplete data, issues arising during
    the modeling process, or simply because of the randomness and complexities of
    the underlying problem.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在许多实际应用中，由于各种因素，如数据不足或不完整、建模过程中的问题，或者仅仅是底层问题的随机性和复杂性，统计、机器学习和深度学习模型做出的预测往往是不正确或不可靠的。
- en: Predictions made by machine learning models often come without the uncertainty
    quantification required for confident and reliable decision-making. This is where
    conformal prediction comes in. By providing a clear measure of the reliability
    of its predictions, conformal prediction enhances the trustworthiness and explainability
    of machine learning models, making them more transparent and user-friendly for
    decision-makers.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习模型做出的预测通常没有提供所需的置信度和可靠性量化，这正是正规预测发挥作用的地方。通过提供其预测可靠性的明确度量，正规预测增强了机器学习模型的可信度和可解释性，使它们对决策者更加透明和用户友好。
- en: This chapter will introduce conformal prediction and explore how it can be applied
    in practical settings.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍正规预测，并探讨它在实际环境中的应用。
- en: 'In this chapter, we’re going to cover the following main topics:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要主题：
- en: Introduction to conformal prediction
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正规预测简介
- en: The origins of conformal prediction
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正规预测的起源
- en: How conformal prediction differs from traditional machine learning
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正规预测与传统机器学习的区别
- en: The p-value and its role in conformal prediction
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: p值及其在正规预测中的作用
- en: The chapter will provide a practical understanding of conformal prediction and
    its applications. By the end of this chapter, you will be able to understand how
    conformal prediction can be applied to your own machine learning models to improve
    their reliability and interpretability.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将提供对正规预测及其应用的实用理解。在本章结束时，您将能够理解如何将正规预测应用于自己的机器学习模型，以提高其可靠性和可解释性。
- en: Technical requirements
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'This book uses Python. The code for this book is hosted on GitHub and can be
    found here: [https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction](https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction)
    You can run notebooks locally or upload them to Google Colab ([https://colab.research.google.com/](https://colab.research.google.com/)).'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 本书使用Python。本书的代码托管在GitHub上，可在以下链接找到：[https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction](https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction)。您可以在本地运行笔记本或将它们上传到Google
    Colab ([https://colab.research.google.com/](https://colab.research.google.com/))。
- en: Introduction to conformal prediction
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正规预测简介
- en: In this section, we will introduce conformal prediction and explain how it can
    be used to improve the reliability of predictions produced by statistical, machine
    learning, and deep learning models. We will provide an overview of the key ideas
    and concepts behind conformal prediction, including its underlying principles
    and benefits. By the end of this section, you will have a solid understanding
    of conformal prediction and why it is an important framework to know.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将介绍正规预测，并解释如何利用它来提高统计、机器学习和深度学习模型生成的预测的可靠性。我们将概述正规预测背后的关键思想和概念，包括其基本原理和优势。在本节结束时，您将对正规预测有一个扎实的理解，并了解为什么它是一个重要的知识框架。
- en: Conformal prediction is a powerful machine learning framework that provides
    valid confidence measures for individual predictions. This means that when you
    make a prediction using any model from the conformal prediction framework, you
    can also measure your confidence in that prediction.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测是一种强大的机器学习框架，为个别预测提供有效的置信度度量。这意味着当你使用正规预测框架中的任何模型进行预测时，你还可以测量你对该预测的置信度。
- en: This is incredibly useful in many practical applications where it is crucial
    to have reliable and interpretable predictions. For example, in medical diagnosis,
    conformal prediction can provide a confidence level that a tumor is malignant
    versus benign. This enables physicians to make more informed treatment decisions
    based on the prediction confidence. In finance, conformal prediction can provide
    prediction intervals estimating financial risk. This allows investors to quantify
    upside and downside risks.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 这在许多实际应用中非常有用，在这些应用中，可靠和可解释的预测至关重要。例如，在医疗诊断中，正规预测可以提供肿瘤是恶性还是良性的置信水平。这使得医生可以根据预测置信度做出更明智的治疗决策。在金融领域，正规预测可以提供估计金融风险的预测区间。这允许投资者量化上行和下行风险。
- en: Specifically, conformal prediction can determine a 95% chance a tumor is malignant,
    giving physicians high confidence in a cancer diagnosis. Or, it can predict an
    80% probability that a stock price will fall between $50 and $60 next month, providing
    an estimated trading range. Conformal prediction increases trust and is valuable
    in real-world applications such as medical diagnosis and financial forecasting
    by delivering quantifiable confidence in predictions.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 具体来说，正规预测可以确定有95%的可能性肿瘤是恶性的，这使医生对癌症诊断充满信心。或者，它可以预测下个月股价将在50美元和60美元之间的80%的可能性，提供一个估计的交易范围。正规预测通过提供可量化的置信度，增加了信任，并在医疗诊断和金融预测等现实世界应用中非常有价值。
- en: The key benefit of conformal prediction is that it provides valid confidence
    measures for individual predictions. A conformal prediction model usually provides
    a prediction in the form of a prediction interval or prediction set with a specified
    confidence level, for example, 95%. In classification problems, conformal prediction
    can also calibrate class probabilities, enhancing confidence and informed decision-making.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测的关键优势是它为个别预测提供有效的置信度度量。正规预测模型通常以预测区间或预测集的形式提供预测，并指定一个置信水平，例如95%。在分类问题中，正规预测还可以校准类概率，增强置信度和明智的决策。
- en: In conformal prediction, “coverage” denotes the likelihood that the predicted
    region – whether a set of potential outcomes in classification tasks or a prediction
    interval in regression tasks – accurately encompasses the true values. Essentially,
    if you choose a coverage of 95%, it means there’s a 95% chance that the true values
    fall within the provided prediction set or interval.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在正规预测中，“覆盖”表示预测区域（无论是分类任务中的潜在结果集合还是回归任务中的预测区间）准确包含真实值的可能性。本质上，如果你选择95%的覆盖，这意味着有95%的可能性真实值落在提供的预测集或区间内。
- en: We call such prediction regions “valid.” The requirement for the validity of
    predictions is crucial to ensure that the model does not contain prediction bias
    and is especially important in consequential applications such as health, finance,
    and self-driving cars. Valid predictions are a prerequisite of trust in the machine
    learning model that has produced this prediction.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们称这样的预测区域为“有效的”。预测有效性的要求对于确保模型不包含预测偏差至关重要，特别是在健康、金融和自动驾驶汽车等后果重大的应用中尤为重要。有效的预测是信任产生该预测的机器学习模型的前提。
- en: While there are alternative approaches to uncertainty quantification, such as
    Bayesian methods, Monte Carlo methods, and bootstrapping, to provide validity
    guarantees, such approaches require distribution-specific assumptions about the
    data – for example, an assumption that the data follows a normal distribution.
    However, the true underlying distribution of real-world data is generally unknown.
    Conversely, conformal prediction does not make distributional assumptions and
    can provide validity guarantees without making assumptions about the specifics
    of data distribution. This makes conformal prediction more broadly applicable
    to real data that may not satisfy common statistical assumptions such as normality,
    smoothness, and so on.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然有其他方法来量化不确定性，例如贝叶斯方法、蒙特卡洛方法和自助法，以提供有效性保证，但这些方法需要关于数据的特定分布假设——例如，假设数据遵循正态分布。然而，真实世界数据的真实分布通常未知。相反，正规预测不做出分布假设，可以在不假设数据分布具体细节的情况下提供有效性保证。这使得正规预测更广泛地适用于可能不满足如正态性、平滑性等常见统计假设的真实数据。
- en: In practice, the need for distribution-specific assumptions limits the ability
    of methods such as Bayesian inference or bootstrapping to make formally rigorous
    statements about arbitrary real data sources. There is no guarantee that predictions
    from such methods will have the claimed confidence level or coverage across all
    data types, since the assumptions may not hold. This can create a mismatch between
    the confidence level communicated to users and the actual coverage achieved, leading
    to inaccurate decisions and misleading users about the reliability of model predictions.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，对特定分布的假设需求限制了贝叶斯推理或自助法等方法正式严格地陈述关于任意真实数据源的能力。无法保证这些方法的预测将具有所声称的置信水平或覆盖范围，因为这些假设可能不成立。这可能导致向用户传达的置信水平与实际覆盖范围之间存在不匹配，导致决策不准确并误导用户关于模型预测可靠性的认识。
- en: Conformal prediction sidesteps these issues by providing distribution-free finite
    sample validity guarantees without relying on hard-to-verify distributional assumptions
    about the data. This makes conformal prediction confidence estimates more trustworthy
    and robust for real-world applications.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测通过提供不依赖于难以验证的数据分布假设的无分布有限样本有效性保证来规避这些问题。这使得正规预测的置信度估计在现实世界应用中更加可靠和稳健。
- en: 'Conformal prediction has multiple benefits:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测具有多重优势：
- en: '**Guaranteed coverage**: Conformal prediction guarantees the validity of prediction
    regions automatically. Any method from the conformal prediction framework guarantees
    the validity of prediction regions by mathematical design. In comparison, alternative
    methods output predictions that do not provide any validity guarantees. By way
    of an example, the popular NGBoost package does not produce valid prediction intervals
    (you can read more about it at the following link: [https://medium.com/@valeman/does-ngboost-work-evaluating-ngboost-against-critical-criteria-for-good-probabilistic-prediction-28c4871c1bab](https://medium.com/@valeman/does-ngboost-work-evaluating-ngboost-against-critical-criteria-for-good-probabilistic-prediction-28c4871c1bab)).'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**保证覆盖范围**：正规预测自动保证预测区域的有效性。来自正规预测框架的任何方法都通过数学设计保证了预测区域的有效性。相比之下，其他方法输出的预测不提供任何有效性保证。例如，流行的NGBoost包不产生有效的预测区间（你可以在以下链接中了解更多信息：[https://medium.com/@valeman/does-ngboost-work-evaluating-ngboost-against-critical-criteria-for-good-probabilistic-prediction-28c4871c1bab](https://medium.com/@valeman/does-ngboost-work-evaluating-ngboost-against-critical-criteria-for-good-probabilistic-prediction-28c4871c1bab))。'
- en: '**Distribution-free**: Conformal prediction is distribution-free and can be
    applied to any data distribution regardless of the properties of the distribution
    as long as the data is exchangeable. Exchangeability means that the order or index
    of the data points does not matter – shuffling or permuting the data points will
    not change the overall data distribution. For example, exchangeability assumes
    that observation 1, 2, 3 has the same distribution as observation 2, 3, 1 or 3,
    1, 2\. This is a weaker assumption than IID and is required to provide validity
    guarantees. Unlike many classical statistical models, conformal prediction does
    not make assumptions such as the data following a normal distribution. The data
    can have any distribution, even with irregularities such as fat tails. The only
    requirement is exchangeability. By relying only on exchangeability rather than
    strict distributional assumptions, conformal prediction provides finite sample
    guarantees on prediction coverage that are distribution-free and applicable to
    any data source.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无分布依赖性**：一致性预测是无分布依赖性的，可以应用于任何数据分布，无论分布的性质如何，只要数据是可交换的。可交换性意味着数据点的顺序或索引并不重要——对数据点进行洗牌或排列不会改变整体数据分布。例如，可交换性假设观察1、2、3与观察2、3、1或3、1、2具有相同的分布。这是一个比独立同分布（IID）更弱的假设，并且是提供有效性保证所必需的。与许多经典统计模型不同，一致性预测不假设数据遵循正态分布。数据可以具有任何分布，甚至包括像厚尾这样的不规则性。唯一的要求是可交换性。通过仅依赖于可交换性而不是严格的分布假设，一致性预测在预测覆盖范围上提供了有限样本保证，这些保证是无分布依赖性的，并且适用于任何数据源。'
- en: '**Model-agnostic**: Conformal prediction can be applied to any prediction model
    that produces point predictions in classification, regression, time series, computer
    vision, NLP, reinforcement learning, or other statistical, machine learning, and
    deep learning tasks. Conformal prediction has been successfully applied to many
    innovative model types, including recent innovations such as diffusion models
    and **large language models** (**LLMs**). Conformal prediction does not require
    the model to be statistical, machine learning, or deep learning. It could be any
    model of any type, for example, a business heuristic developed by domain experts.
    If you have a model to make point predictions, you can use conformal prediction
    as an uncertainty quantification layer on top of your point prediction model to
    obtain a well-calibrated, reliable, and safe probabilistic prediction model.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型无关性**：一致性预测可以应用于任何产生点预测的预测模型，包括分类、回归、时间序列、计算机视觉、自然语言处理、强化学习或其他统计、机器学习和深度学习任务。一致性预测已经成功应用于许多创新模型类型，包括最近的一些创新，如扩散模型和**大型语言模型**（**LLMs**）。一致性预测不要求模型是统计的、机器学习的或深度学习的。它可以是任何类型的任何模型，例如由领域专家开发的商业启发式模型。如果您有一个用于进行点预测的模型，您可以使用一致性预测作为您点预测模型上的不确定性量化层，以获得一个校准良好、可靠且安全的概率预测模型。'
- en: '**Non-intrusive**: Conformal prediction stands out in its simplicity and efficiency.
    Rather than overhauling your existing point prediction model, it seamlessly integrates
    with it. For businesses with established models already in production, this is
    a game changer. And for data scientists, the process is even more exciting. Simply
    overlay your point prediction model with the uncertainty quantification layer
    provided by conformal prediction, and you’re equipped with a state-of-the-art
    probabilistic prediction model.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**非侵入性**：一致性预测在简单性和效率方面脱颖而出。它不是彻底改造现有的点预测模型，而是无缝地与之集成。对于已经将模型投入生产的公司来说，这是一个颠覆性的变化。对于数据科学家来说，这个过程甚至更加令人兴奋。只需将您的点预测模型与一致性预测提供的不确定性量化层叠加，您就装备了一个最先进的概率预测模型。'
- en: '**Dataset size**: Conformal prediction stands apart from typical statistical
    methods that depend on stringent data distribution assumptions, such as normality,
    or need vast datasets for solid guarantees. It offers inherent mathematical assurances
    of valid predictions without bias, irrespective of the dataset’s size. While smaller
    datasets may yield broader prediction intervals in regression tasks (or larger
    sets in classification), conformal prediction remains consistently valid. The
    validity is assured no matter the dataset size, underlying prediction model, or
    data distribution, making it a unique and unmatched method for uncertainty quantification.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据集大小**：符合预测与典型的统计方法不同，后者依赖于严格的数据分布假设，如正态性，或需要大量数据集才能提供可靠的保证。它提供内在的数学保证，确保无论数据集大小如何，预测都是有效的且无偏差。虽然较小的数据集在回归任务中可能产生更宽的预测区间（或分类中的更大集合），但符合预测始终保持一致性。无论数据集大小、底层预测模型或数据分布如何，其有效性都得到保证，使其成为不确定性量化的一种独特且无与伦比的方法。'
- en: '**Easy to use**: A few years back, the adoption of conformal prediction was
    limited due to the scarcity of open source libraries, even though esteemed universities
    and major corporations such as Microsoft had been utilizing it for years. Fast
    forward to today, and the landscape has dramatically shifted. There’s a rich selection
    of top-tier Python packages such as MAPIE and Amazon Fortuna, among others. This
    means that generating well-calibrated probabilistic predictions via conformal
    prediction is just a few lines of code away, making it straightforward to integrate
    into business applications. Furthermore, platforms such as KNIME have democratized
    its use, offering conformal prediction through low-code or no-code solutions.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**易于使用**：几年前，由于开源库的稀缺，符合预测的采用受到限制，尽管一些著名大学和主要公司如微软已经使用它多年。快进到今天，情况发生了巨大变化。现在有丰富的顶级Python包，如MAPIE和Amazon
    Fortuna等。这意味着通过符合预测生成良好校准的概率预测只需几行代码，使其能够轻松集成到商业应用中。此外，KNIME等平台通过低代码或无代码解决方案使它的使用民主化。'
- en: '**Fast**: The most widely embraced conformal prediction variant, inductive
    conformal prediction, stands out because it operates efficiently without the need
    to retrain the foundational model. In contrast, other methods, such as Bayesian
    networks, often necessitate retraining. This distinction means that inductive
    conformal prediction offers a streamlined approach, eliminating the time and computational
    costs associated with repeated model retraining.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**快速**：最广泛采用的符合预测变体，归纳符合预测，因其高效运行且无需重新训练基础模型而脱颖而出。相比之下，其他方法，如贝叶斯网络，通常需要重新训练。这种区别意味着归纳符合预测提供了一种简化的方法，消除了与重复模型重新训练相关的时延和计算成本。'
- en: '**Non-intrusive**: Unlike many uncertainty quantification techniques, conformal
    prediction seamlessly integrates without altering the underlying point prediction
    models. Its non-invasive nature is cost-effective and convenient, especially compared
    to other methods that demand potentially costly and complex adjustments to the
    machine or deep learning models. The benefits of using conformal prediction are
    truly incredible. You might be interested to know how conformal prediction achieves
    the unique and powerful benefits that it offers to its users.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**非侵入性**：与许多不确定性量化技术不同，符合预测无缝集成，不会改变底层点预测模型。其非侵入性既经济又方便，尤其是与其他需要可能昂贵且复杂的机器或深度学习模型调整的方法相比。使用符合预测的好处确实是令人难以置信的。你可能想知道符合预测是如何实现其提供给用户的独特而强大的益处的。'
- en: The key objective of conformal prediction is to provide valid confidence measures
    that adapt based on the difficulty of making individual predictions. Conformal
    prediction uses “nonconformity measures” to assess how well new observations fit
    with previous observations.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 符合预测的关键目标是提供有效的置信度度量，这些度量会根据做出个别预测的难度进行调整。符合预测使用“非一致性度量”来评估新观测值与先前观测值拟合得有多好。
- en: 'The overall workflow consists of the following steps:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 整体工作流程包括以下步骤：
- en: A conformal predictor learns from past training examples to quantify uncertainty
    around predictions for the new observations.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 符合预测器通过从过去的训练示例中学习来量化对新观测值的预测的不确定性。
- en: When quantifying uncertainty around predictions for the new observations, it
    calculates nonconformity scores, measuring how different or “nonconforming” the
    new observation is, compared to the training set (in the classical transductive
    version of conformal prediction) or calibration (in the most popular variant of
    conformal prediction – inductive conformal prediction).
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在量化新观察预测的不确定性时，它计算非符合度得分，衡量新观察与训练集（在符合预测的经典归纳版本中）或校准（在符合预测最受欢迎的变体——归纳符合预测中）相比有多不同或“不符合”。
- en: These nonconformity scores are used to determine whether the new observation
    falls within the range of values expected based on the training data.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这些非符合度得分用于确定新观察是否落在基于训练数据预期的值范围内。
- en: The model calculates personalized confidence measures and prediction sets (in
    classification problems) or prediction intervals (in regression problems and time
    series forecasting) for each prediction.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该模型为每个预测计算个性化的置信度度量以及预测集（在分类问题中）或预测区间（在回归问题和时间序列预测中）。
- en: The magic of conformal prediction lies in these nonconformity measures, which
    allow the model to evaluate each new prediction in the context of the previously
    seen data. This simple but powerful approach results in finite sample coverage
    guarantees adapted to the intrinsic difficulty of making a given prediction. The
    validity holds for any data distribution, prediction algorithm, or dataset size.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 符合预测的魔力在于这些非符合度度量，它允许模型在先前看到的数据的背景下评估每个新的预测。这种简单但强大的方法导致了对给定预测内在难度的适应性的有限样本覆盖保证。这种有效性适用于任何数据分布、预测算法或数据集大小。
- en: In this book, we will talk interchangeably about nonconformity and conformity
    measures; one is the inverse of the other, and depending on the application, it
    will be more convenient to use either conformity or nonconformity measures.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，我们将交替讨论非符合度和符合度度量；一个是另一个的倒数，并且根据应用，使用符合度或非符合度度量可能更方便。
- en: Understanding conformity measures
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解符合度度量
- en: A conformity measure is a critical component of conformal prediction and is
    essentially a function that assigns a numerical score (conformity score) to each
    object in a dataset. The conformity score indicates how well a new observation
    fits the observed data. When making a new prediction, we can use the conformity
    measure to calculate a conformity score for the new observation and compare it
    to the conformity scores of the previous observations. Based on this comparison,
    we can calculate a measure of confidence for our prediction. The conformity score
    indicates a degree of confidence in the prediction.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 符合度度量是符合预测的一个关键组成部分，本质上是一个函数，它将数值分数（符合度分数）分配给数据集中每个对象。符合度分数表示新观察与观测数据拟合得有多好。在做出新的预测时，我们可以使用符合度度量来计算新观察的符合度分数，并将其与先前观察的符合度分数进行比较。基于这种比较，我们可以计算预测的置信度度量。符合度分数表示预测的置信度程度。
- en: The choice of conformity measure is a key step in conformal prediction. The
    conformity measure determines how we assess how similar new observations are to
    past examples. There are many options for defining conformity measures depending
    on the problem.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 符合度度量的选择是符合预测的关键步骤。符合度度量决定了我们如何评估新观察与过去示例的相似性。根据问题的不同，定义符合度度量的选项有很多。
- en: In a classification setting, a simple conformity measure could calculate the
    probability scores assigned to each class by the prediction model for a new observation.
    The class with the highest probability would have the best conformity or match
    to the training data.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在分类设置中，一个简单的符合度度量可以计算预测模型为新观察分配给每个类的概率得分。概率得分最高的类别将具有最佳的符合度或与训练数据的匹配度。
- en: The key advantage of conformal prediction is that we obtain valid prediction
    regions regardless of the conformity measure used. This is because conformal prediction
    relies only on the order induced by the conformity measure rather than its exact
    form.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 符合预测的关键优势在于，无论使用何种符合度度量，我们都能获得有效的预测区域。这是因为符合预测仅依赖于符合度度量所诱导的顺序，而不是其确切形式。
- en: So, we have the flexibility to incorporate domain knowledge in designing an
    appropriate conformity measure for the problem at hand. If the measure ranks how
    well new observations match past data, conformal prediction can be used to deliver
    finite sample coverage guarantees.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们有灵活性在设计中融入领域知识，为当前问题设计适当的一致性度量。如果度量可以评估新观测值与过去数据的匹配程度，则符合性预测可以用来提供有限样本覆盖保证。
- en: While all conformal predictors provide valid prediction regions, the choice
    of conformity measure impacts their efficiency. Efficiency relates to the width
    of the prediction intervals or sets – narrower intervals contain more valuable
    information for decision-making.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然所有符合性预测器都提供有效的预测区域，但一致性度量的选择会影响它们的效率。效率与预测区间或集合的宽度相关——较窄的区间包含更多对决策有价值的信息。
- en: Though validity holds for any conformity measure, thoughtfully choosing one
    tailored to the application can improve efficiency and produce narrower, more
    useful prediction intervals. The intervals should also be adaptable based on the
    model’s uncertainty – expanding for difficult predictions and contracting for
    clear ones.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然任何一致性度量都保持有效性，但精心选择一个针对应用的定制度量可以提高效率，并产生更窄、更有用的预测区间。这些区间还应根据模型的不确定性进行调整——对于难以预测的情况扩大，对于清晰的情况缩小。
- en: Let’s illustrate this with an example. Say we have a dataset of patients diagnosed
    with a disease, with features such as age, gender, and test results. We want to
    predict whether new patients are at risk.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用一个例子来说明这一点。假设我们有一个包含疾病诊断患者的数据集，具有年龄、性别和测试结果等特征。我们想要预测新患者是否处于风险之中。
- en: A simple conformity measure could calculate how similar the feature values are
    between new patients and those in the training data. New patients very different
    from the data would get low conformity scores and wide prediction intervals, indicating
    high uncertainty. While this conformity measure would produce valid intervals,
    we can improve efficiency with a more tailored approach.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的一致性度量可以计算新患者的特征值与训练数据中的患者之间的相似度。与数据差异很大的新患者将获得低一致性得分和宽预测区间，这表明高度的不确定性。虽然这种一致性度量会产生有效的区间，但我们可以通过更定制的方法来提高效率。
- en: By carefully selecting conformity measures aligned to our prediction problem
    and domain knowledge, we can obtain high-quality conformal predictors that provide
    both validity and efficiency.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 通过仔细选择与我们的预测问题和领域知识相一致的一致性度量，我们可以获得高质量的符合性预测器，这些预测器既有效又高效。
- en: We will now talk briefly about the origins of conformal prediction.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将简要谈谈符合性预测的起源。
- en: The origins of conformal prediction
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 符合性预测的起源
- en: The origins of conformal prediction are documented in *Gentle Introduction to
    Conformal Prediction and Distribution-Free Uncertainty Quantification* by Anastasios
    N. Angelopoulos and Stephen Bates ([https://arxiv.org/abs/2107.07511](https://arxiv.org/abs/2107.07511)).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 符合性预测的起源在阿纳斯塔西奥斯·N·安杰洛普洛斯（Anastasios N. Angelopoulos）和斯蒂芬·贝茨（Stephen Bates）所著的《符合性预测与无分布不确定性量化轻松入门》（[https://arxiv.org/abs/2107.07511](https://arxiv.org/abs/2107.07511)）中有详细记录。
- en: Note
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Conformal prediction was invented by my PhD supervisor Prof. Vladimir Vovk,
    a professor at Royal Holloway University of London. Vladimir Vovk graduated from
    Moscow State University, where he studied mathematics and became a student of
    one of the most notable mathematicians of the 20th century, Andrey Kolmogorov.
    During this time, initial ideas that later gave rise to the invention of conformal
    prediction appeared.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 符合性预测是由我的博士导师、伦敦皇家霍洛威大学的教授弗拉基米尔·沃克（Prof. Vladimir Vovk）发明的。弗拉基米尔·沃克毕业于莫斯科国立大学，在那里他学习数学，并成为了20世纪最著名的数学家之一安德烈·柯尔莫哥洛夫的学生。在这段时间里，后来引发符合性预测发明的初步想法出现了。
- en: The first edition of *Algorithmic Learning in a Random World* ([https://link.springer.com/book/10.1007/b106715](https://link.springer.com/book/10.1007/b106715))
    by Vladimir Vovk, Alexander Gammerman, and Glenn Shafer was published in 2005\.
    The second edition of the book was published in 2022 ([https://link.springer.com/book/10.1007/978-3-031-06649-8](https://link.springer.com/book/10.1007/978-3-031-06649-8)).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 《随机世界中的算法学习》的第一版（[https://link.springer.com/book/10.1007/b106715](https://link.springer.com/book/10.1007/b106715)）由弗拉基米尔·沃克（Vladimir
    Vovk）、亚历山大·加默曼（Alexander Gammerman）和格伦·沙弗（Glenn Shafer）所著，于2005年出版。该书的第二版于2022年出版（[https://link.springer.com/book/10.1007/978-3-031-06649-8](https://link.springer.com/book/10.1007/978-3-031-06649-8)）。
- en: Conformal prediction was popularized in United States academia by Professor
    Larry Wasserman (Carnegie Mellon) and his collaborators, who have published some
    key papers and introduced conformal prediction to many other researchers in the
    United States.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 同构预测在美国学术界得到普及，是由Carnegie Mellon大学的Larry Wasserman教授及其合作者推广的，他们发表了一些关键论文，并将同构预测介绍给了美国的其他许多研究人员。
- en: Note
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: In 2022, I finished my PhD in machine learning. In the same year, I created
    *Awesome Conformal Prediction* ([https://github.com/valeman/awesome-conformal-prediction](https://github.com/valeman/awesome-conformal-prediction))
    – the most comprehensive professionally curated resource on conformal prediction,
    which has since received thousands of GitHub stars.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在2022年，我完成了我的机器学习博士学位。同年，我创建了 *Awesome Conformal Prediction* ([https://github.com/valeman/awesome-conformal-prediction](https://github.com/valeman/awesome-conformal-prediction))
    – 这是关于同构预测最全面的专业整理资源，自那时起已经收到了数千个GitHub星标。
- en: Conformal prediction has grown rapidly from a niche research area into a mainstream
    framework for uncertainty quantification. The field has exploded in recent years,
    with over 1,000 research papers on conformal prediction estimated to be published
    in 2023 alone.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 同构预测已经从一个小众研究领域迅速发展为主流的不确定性量化框架。近年来，该领域迅速发展，预计仅在2023年就有超过1,000篇关于同构预测的研究论文发表。
- en: This surge of research reflects the increasing popularity and applicability
    of conformal prediction across academia and industry. Major technology companies
    such as Microsoft, Amazon, DeepMind, and NVIDIA now conduct research into and
    apply conformal prediction. The framework has also been adopted in high-stakes
    domains such as healthcare and finance, where validity and reliability are critical.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 这股研究热潮反映了同构预测在学术界和工业界的日益流行和适用性。像Microsoft、Amazon、DeepMind和NVIDIA这样的主要科技公司现在都在研究和应用同构预测。该框架也已被应用于医疗保健和金融等高风险领域，在这些领域中，有效性和可靠性至关重要。
- en: In just over two decades since its introduction, conformal prediction has cemented
    itself as one of the premier and most trusted approaches for uncertainty quantification
    in machine learning. The field will continue to expand as more practitioners recognize
    the value of conformal prediction’s finite sample guarantees compared to traditional
    statistical methods reliant on asymptotic theory and unverifiable distributional
    assumptions. With growing research and adoption, conformal prediction is poised
    to become a standard tool for any application requiring rigorous uncertainty estimates
    alongside point predictions.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 自从引入以来，超过二十年的时间里，同构预测已经巩固了自己作为机器学习不确定性量化领域中最优秀和最可信的方法之一。随着越来越多的从业者认识到同构预测的有限样本保证相对于依赖于渐近理论和不可验证的分布假设的传统统计方法的价值，该领域将继续扩大。随着研究的增长和采用率的提高，同构预测有望成为任何需要严格不确定性估计和点预测的应用的标准工具。
- en: 'At *NeurIPS 2022*, one of the prominent mathematicians of our time, Emmanuel
    Candes (Stanford), delivered a key invited talk titled *Conformal Prediction in
    2022* ([https://slideslive.com/38996063/conformal-prediction-in-2022?ref=speaker-43789](https://slideslive.com/38996063/conformal-prediction-in-2022?ref=speaker-43789))
    to tens of thousands of attendees. In his talk, Emmanuel Candes said:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *NeurIPS 2022* 上，我们这个时代的杰出数学家之一，Emmanuel Candes（斯坦福大学）发表了一场主题为 *2022年的同构预测*
    的关键邀请演讲 ([https://slideslive.com/38996063/conformal-prediction-in-2022?ref=speaker-43789](https://slideslive.com/38996063/conformal-prediction-in-2022?ref=speaker-43789))，吸引了成千上万的参与者。在他的演讲中，Emmanuel
    Candes 表示：
- en: Conformal inference methods are becoming all the rage in academia and industry
    alike. In a nutshell, these methods deliver exact prediction intervals for future
    observations without making any distributional assumption whatsoever other than
    having IID, and more generally, exchangeable data.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 同构推断方法在学术界和工业界都变得非常流行。简而言之，这些方法为未来的观测提供了精确的预测区间，而不需要对任何分布假设做出任何假设，除了具有独立同分布（IID）数据，以及更一般地，可交换数据。
- en: The future of conformal prediction
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 同构预测的未来
- en: For years, I have promoted conformal prediction as the premier framework for
    reliable probabilistic predictions. Excitingly, over the last 2-3 years, there
    has been an explosion of interest in and adoption of conformal prediction, including
    by major tech leaders such as Amazon, Microsoft, Google, and DeepMind. Many universities
    and companies are researching conformal prediction, actively developing real-world
    applications, and releasing open source libraries such as MAPIE and Amazon Fortuna.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，我一直推广一致预测作为可靠概率预测的顶级框架。令人兴奋的是，在过去的2-3年里，对一致预测的兴趣和采用率激增，包括亚马逊、微软、谷歌和DeepMind等主要科技领导者。许多大学和公司正在研究一致预测，积极开发实际应用，并发布开源库，如MAPIE和Amazon
    Fortuna。
- en: 'These trends will only accelerate as more practitioners recognize the power
    of conformal prediction for trustworthy uncertainty quantification. As renowned
    machine learning researcher Michael I. Jordan noted at the ICML 2021 workshop
    ([https://icml.cc/virtual/2021/workshop/8373](https://icml.cc/virtual/2021/workshop/8373)):
    "*Conformal prediction ideas are THE answer to UQ (uncertainty quantification);
    I think it’s the best I have seen – it’s simple, generalizable, and* *so on*."'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 随着越来越多的从业者认识到一致预测在可信不确定性量化方面的力量，这些趋势将只会加速。正如著名机器学习研究者迈克尔·I·乔丹在ICML 2021研讨会([https://icml.cc/virtual/2021/workshop/8373](https://icml.cc/virtual/2021/workshop/8373))上所指出的：“*一致预测的想法是UQ（不确定性量化）的答案；我认为这是我见过的最好的——它简单、可推广，等等*。”
- en: 'Conformal prediction has an incredibly bright future as an indispensable tool
    for quantifying uncertainty in machine learning. Several key reasons are driving
    the momentum and adoption of conformal prediction:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 一致预测作为量化机器学习中不确定性的不可或缺的工具，拥有极其光明的未来。几个关键原因推动了一致预测的势头和采用率：
- en: '**Simplicity**: Conformal prediction is straightforward to understand and implement,
    making it accessible to practitioners without deep statistical expertise. At its
    core is the intuitive idea of measuring how new observations conform to past data.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单性**：一致预测易于理解和实现，使得没有深厚统计专业知识的从业者也能使用。其核心是直观地衡量新观测值如何与过去的数据一致。'
- en: '**Flexibility**: It can be applied to any machine learning model and data distribution.
    No modifications to existing predictors are needed. This model-agnostic property
    greatly expands the applicability of conformal prediction.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**灵活性**：它可以应用于任何机器学习模型和数据分布。不需要对现有的预测器进行修改。这种模型无关的特性极大地扩大了一致预测的应用范围。'
- en: '**Theoretical guarantees**: The finite sample coverage guarantees provide an
    unmatched level of reliability compared to traditional statistical methods reliant
    on asymptotic theory.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**理论保证**：有限的样本覆盖保证提供了与传统依赖于渐近理论的统计方法相比无与伦比的可信度水平。'
- en: These advantages perfectly position conformal prediction as the gold standard
    for uncertainty quantification in machine learning applications where trustworthy
    confidence estimates are critical.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这些优势使一致预测完美地定位为机器学习应用中不确定性量化的黄金标准，在这些应用中，可信的置信度估计至关重要。
- en: I am confident that the adoption of conformal prediction in academic research
    and industry will accelerate rapidly in the coming years. Its simple yet powerful
    approach is cementing its place as an essential tool for any practitioner or organization
    managing predictive uncertainty. The next few years will be incredibly exciting
    as we realize the full potential of this game-changing framework.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 我坚信，在未来的几年里，在学术研究和工业界采用一致预测将会迅速加速。它简单而强大的方法正在巩固其在任何处理预测不确定性的从业者或组织中的基本工具地位。在接下来的几年里，随着我们充分发挥这一颠覆性框架的潜力，将会非常激动人心。
- en: How conformal prediction differs from traditional machine learning
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一致预测与传统机器学习的不同之处
- en: Conformal prediction allows the production of well-calibrated probabilistic
    predictions for any statistical, machine learning, or deep learning model. This
    is achieved without relying on restrictive assumptions required by other methods
    such as Bayesian techniques, Monte Carlo simulation, and bootstrapping. Importantly,
    conformal prediction does not require subjective priors. It provides mathematically
    guaranteed, well-calibrated predictions every time – regardless of the underlying
    prediction model, data distribution, or dataset size.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测允许为任何统计、机器学习或深度学习模型生成良好校准的概率预测。这是在不依赖其他方法（如贝叶斯技术、蒙特卡洛模拟和重抽样）所需的限制性假设的情况下实现的。重要的是，正规预测不需要主观先验。它每次都提供数学保证的、良好校准的预测——无论底层预测模型、数据分布或数据集大小如何。
- en: A key limitation of traditional machine learning is the need for more reasonable
    confidence measures for individual predictions. Models may have excellent overall
    performance but not be able to quantify uncertainty for a given input reliably.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 传统机器学习的一个关键限制是需要为单个预测提供更合理的置信度度量。模型可能具有出色的整体性能，但无法可靠地量化给定输入的不确定性。
- en: Conformal prediction solves this by outputting prediction regions and confidence
    measures with statistical validity guarantees. It achieves this distribution-free
    reliability without needing to modify the underlying predictor.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测通过输出具有统计有效保证的预测区域和置信度度量来解决这一问题。它在不需修改底层预测器的情况下实现了无分布依赖的可靠性。
- en: While machine learning and deep learning models struggle to quantify uncertainty,
    limiting user trust, conformal prediction has been successfully applied to consequential
    real-world problems. Examples include diagnosing depression, drug discovery, and
    predicting risks of cancer and stroke.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 当机器学习和深度学习模型在量化不确定性方面遇到困难，限制了用户信任时，正规预测已成功应用于具有重大现实问题的领域。例如，诊断抑郁症、药物发现以及预测癌症和中风的风险。
- en: By delivering trustworthy individual prediction uncertainties, conformal prediction
    unlocks the potential of machine learning for high-stakes applications requiring
    confidence measures alongside predictions.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 通过提供可靠的个体预测不确定性，正规预测释放了机器学习在需要置信度度量的高风险应用中的潜力。
- en: 'Conformal prediction has invaluable applications across many high-stakes domains
    where reliable confidence estimates are critical:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 正规预测在许多高风险领域具有宝贵的应用，在这些领域中，可靠的置信度估计至关重要：
- en: '**Medicine**: Conformal prediction can improve trust in AI severity ratings
    for medical imaging, assisting radiologists in disease grading using MRI scans'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**医学**：正规预测可以提高对医学影像中AI严重程度评分的信任，协助放射科医生使用MRI扫描进行疾病分级。'
- en: '**Health**: It can detect anomalies and provide reliable anomaly scores to
    inform treatment decisions'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**健康**：它可以检测异常并提供可靠的异常分数，以告知治疗决策。'
- en: '**Self-driving cars**: Conformal prediction can improve autonomous vehicle
    safety by providing reliable prediction intervals for pedestrian positions and
    trajectories'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动驾驶汽车**：正规预测可以通过提供可靠的人行横道位置和轨迹预测区间来提高自动驾驶车辆的安全性。'
- en: '**Finance**: It can ensure algorithmic fairness in lending by providing well-calibrated
    predictions'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**金融**：它可以确保贷款中的算法公平性，通过提供良好校准的预测。'
- en: '**Recommender systems**: Augmenting recommenders with conformal prediction
    can improve recommendations by guaranteeing high-quality suggestions and minimizing
    erroneous items'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推荐系统**：通过正规预测增强推荐系统可以提高推荐质量，通过保证高质量的建议和最小化错误项目。'
- en: By delivering rigorous confidence estimates, conformal prediction unlocks reliable
    and ethical AI applications in medicine, transportation, finance, and beyond.
    Its validity guarantees make it invaluable for high-stakes decisions relying on
    machine learning.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 通过提供严格的置信度估计，正规预测在医学、交通、金融等领域解锁了可靠和道德的AI应用。其有效性保证使其对于依赖机器学习的高风险决策变得极其宝贵。
- en: The p-value and its role in conformal prediction
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: p值及其在正规预测中的作用
- en: In conformal prediction, p-values are key in constructing prediction regions
    and intervals with a guaranteed confidence level. However, their purpose is different
    than in traditional statistical hypothesis testing.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在正规预测中，p值在构建具有保证置信水平的预测区域和区间中起着关键作用。然而，它们的目的与传统统计假设检验中的不同。
- en: 'Let’s walk through an example binary classification task to understand how
    this works. Suppose we want to predict whether a patient has a medical condition
    based on their symptoms and characteristics:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个二元分类任务的例子来了解这是如何工作的。假设我们想根据患者的症状和特征来预测患者是否有医疗状况：
- en: First, we calculate a nonconformity score that measures how different or “nonconforming”
    the new patient is compared to previously seen patients. We can define this score
    in various ways, such as the distance between feature values.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们计算一个非一致性分数，该分数衡量新患者与先前看到的患者的不同或“不符合”程度。我们可以以各种方式定义此分数，例如特征值之间的距离。
- en: Next, we temporarily assign the patient each possible label – 0 (no condition)
    and 1 (has condition) – and recalculate the nonconformity score with that assigned
    label.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们暂时为患者分配每个可能的标签——0（无状况）和1（有状况），并使用分配的标签重新计算非一致性分数。
- en: If the score is similar to scores for past patients with label 0, then label
    0 conforms well to the data. To measure this fit statistically, we compute the
    p-value by comparing the test object’s “strangeness” using the test object’s nonconformity
    score to the nonconformity scores of the previous patients.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 如果分数与过去具有标签0的患者的分数相似，那么标签0很好地符合数据。为了从统计上测量这种拟合，我们通过比较测试对象的“异常性”来计算p值，使用测试对象的非一致性分数与先前患者的非一致性分数进行比较。
- en: If this p-value exceeds our chosen significance level, we add label 0 to the
    prediction set since it fits the data. We repeat this for label 1 to see whether
    we should include it.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这个p值超过我们选择的显著性水平，我们就将标签0添加到预测集中，因为它符合数据。我们重复这个过程，看看是否应该包括标签1。
- en: Ultimately, we construct a prediction set containing all labels whose nonconformity
    scores result in p-values exceeding the significance level. This provides finite
    sample guarantees on the confidence level of the prediction regions.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，我们构建了一个包含所有标签的预测集，这些标签的非一致性分数导致p值超过显著性水平。这为预测区域的置信水平提供了有限样本保证。
- en: So, in summary, nonconformity scores measure how well each potential label conforms
    to the training data. Then p-values let us convert these scores into statistically
    rigorous prediction sets and intervals. The two concepts work hand in hand within
    the conformal prediction framework.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，总的来说，非一致性分数衡量每个潜在标签与训练数据拟合得有多好。然后p值让我们将这些分数转换为统计上严格的预测集和区间。这两个概念在一致性预测框架中是相辅相成的。
- en: Summary
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we have introduced conformal prediction and explained the multiple
    benefits of this powerful framework for reliably quantifying the uncertainty of
    predictions to improve trust in machine learning models.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了一致性预测，并解释了这一强大框架在可靠地量化预测不确定性以提高对机器学习模型信任方面的多重好处。
- en: We explained that the key benefit of conformal prediction is that, unlike any
    other probabilistic prediction framework, it provides valid probabilistic predictions
    accompanied by confidence measures, regardless of the underlying model, the dataset
    size, and the data distribution.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们解释说，一致性预测的关键好处是，与任何其他概率预测框架不同，它提供了有效的概率预测，并附带置信度度量，无论底层模型、数据集大小和数据分布如何。
- en: We then explored the origins of conformal prediction and saw how it has recently
    become a very popular framework adopted by leading universities and companies.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们随后探讨了一致性预测的起源，并了解了它最近如何成为被领先大学和公司采用的非常流行的框架。
- en: Finally, we looked at how conformal prediction differs from traditional machine
    learning and learned about the role of p-values in conformal prediction.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们探讨了一致性预测与传统机器学习的不同之处，并了解了p值在一致性预测中的作用。
- en: In [*Chapter 2*](B19925_02.xhtml#_idTextAnchor024), we will explain why conformal
    prediction is a valuable tool for quantifying the uncertainty of predictions,
    especially in critical settings such as healthcare, self-driving cars, and finance.
    We will also discuss the concept of uncertainty quantification and how the conformal
    prediction framework has successfully addressed the challenge of quantifying uncertainty.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第二章*](B19925_02.xhtml#_idTextAnchor024)中，我们将解释为什么一致性预测是量化预测不确定性的宝贵工具，特别是在医疗保健、自动驾驶汽车和金融等关键环境中。我们还将讨论不确定性量化的概念以及一致性预测框架如何成功地解决了量化不确定性的挑战。
