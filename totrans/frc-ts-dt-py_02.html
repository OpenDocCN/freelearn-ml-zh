<html><head></head><body>
<div id="_idContainer019">
<h1 class="chapter-number" id="_idParaDest-29"><a id="_idTextAnchor104"/><a id="_idTextAnchor105"/><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-30"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.2.1">Getting Started with Prophet</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Prophet</span><a id="_idIndexMarker057"/><span class="koboSpan" id="kobo.4.1"> is an open source piece of software, which means that the entirety of the underlying code is freely available to anyone to inspect and modify. </span><span class="koboSpan" id="kobo.4.2">This gives Prophet a great deal of power, as any user can add features or fix bugs, but it also has its downsides. </span><span class="koboSpan" id="kobo.4.3">Many closed source software packages, such as Microsoft Word or Tableau, come packaged in their own independent installation file with a neat graphical user interface to not only walk users through installation but also enable them to interact with the software once it has </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">been installed.</span></span></p>
<p><span class="koboSpan" id="kobo.6.1">Prophet, in contrast, is </span><a id="_idIndexMarker058"/><span class="koboSpan" id="kobo.7.1">accessed through</span><a id="_idIndexMarker059"/><span class="koboSpan" id="kobo.8.1"> either the </span><strong class="bold"><span class="koboSpan" id="kobo.9.1">Python</span></strong><span class="koboSpan" id="kobo.10.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.11.1">R</span></strong><span class="koboSpan" id="kobo.12.1"> programming language and depends upon many additional open source libraries. </span><span class="koboSpan" id="kobo.12.2">This gives it great flexibility, as users can tweak features or even add entirely new ones to suit their specific problem, but it comes with the downside of potentially difficult usability. </span><span class="koboSpan" id="kobo.12.3">That’s what this book aims </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">to simplify.</span></span></p>
<p><span class="koboSpan" id="kobo.14.1">In this chapter, we will walk you through the entire installation procedure depending upon which operating system you use, and then we will build our first forecast together by modeling the atmospheric carbon dioxide levels over the last </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">few decades.</span></span></p>
<p><span class="koboSpan" id="kobo.16.1">In full, this chapter will cover </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">the following:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.18.1">Installing Prophet</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Building a simple model </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">in Prophet</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Interpreting the </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">forecast DataFrame</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">components plo</span><a id="_idTextAnchor108"/><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.25.1">ts</span></span></li>
</ul>
<h1 id="_idParaDest-31"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.26.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.27.1">The data files and code for examples in this chapter can be found </span><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.28.1">at </span><a href="https://github.com/PacktPublishing/Forecasting-Time-Series-Data-with-Prophet-Second-Edition"><span class="koboSpan" id="kobo.29.1">https://github.com/PacktPublishing/Forecasting-Time-Series-Data-with-Prophet-Second-Edition</span></a><span class="koboSpan" id="kobo.30.1">. </span><span class="koboSpan" id="kobo.30.2">In this chapter, we will walk through the process of installing many of the requirements. </span><span class="koboSpan" id="kobo.30.3">So, to begin this chapter, it is only necessary that you have a Windows, macOS, or Linux machine capable of running Anaconda with </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">Python 3.7</span><a id="_idTextAnchor112"/><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.32.1">+.</span></span></p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.33.1">Installing Prophet</span></h1>
<p><span class="koboSpan" id="kobo.34.1">Installing </span><a id="_idIndexMarker060"/><span class="koboSpan" id="kobo.35.1">Prop</span><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.36.1">het on your machine is a straightforward process. </span><span class="koboSpan" id="kobo.36.2">However, under the hood, Prophet depends upon</span><a id="_idIndexMarker061"/><span class="koboSpan" id="kobo.37.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.38.1">Stan</span></strong><span class="koboSpan" id="kobo.39.1"> programming language, and</span><a id="_idIndexMarker062"/><span class="koboSpan" id="kobo.40.1"> installing </span><strong class="bold"><span class="koboSpan" id="kobo.41.1">PyStan</span></strong><span class="koboSpan" id="kobo.42.1">, the Python interface for it, is unfortunately not so straightforward because it requires many </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">non-standard compilers.</span></span></p>
<p><span class="koboSpan" id="kobo.44.1">But don’t worry, because there is a really easy way to get Prophet and all dependencies installed, no matter which operating system you use, and that is </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">through Anaconda.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.46.1">Anaconda</span></strong><span class="koboSpan" id="kobo.47.1"> is a</span><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.48.1"> free</span><a id="_idIndexMarker063"/><span class="koboSpan" id="kobo.49.1"> distribution of Python that comes bundled with hundreds of additional Python packages that are useful for data science, along with the package management </span><a id="_idIndexMarker064"/><span class="koboSpan" id="kobo.50.1">system </span><strong class="bold"><span class="koboSpan" id="kobo.51.1">conda</span></strong><span class="koboSpan" id="kobo.52.1">. </span><span class="koboSpan" id="kobo.52.2">This is in contrast to installing the Python</span><a id="_idIndexMarker065"/><span class="koboSpan" id="kobo.53.1"> language </span><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.54.1">from its source on </span><a href="https://www.python.org/"><span class="koboSpan" id="kobo.55.1">https://www.python.org/</span></a><span class="koboSpan" id="kobo.56.1">, which will include the default Python</span><a id="_idTextAnchor118"/><span class="koboSpan" id="kobo.57.1"> package </span><a id="_idIndexMarker066"/><span class="koboSpan" id="kobo.58.1">manager, </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">called </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.60.1">pip</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.62.1">When </span><strong class="source-inline"><span class="koboSpan" id="kobo.63.1">pip</span></strong><span class="koboSpan" id="kobo.64.1"> installs a new package, it will install any dependencies without checking whether these dependent Python packages will conflict with others. </span><span class="koboSpan" id="kobo.64.2">This can be a particular problem when one package is dependent on one version, while another package requires a different version. </span><span class="koboSpan" id="kobo.64.3">You may have, for example, a working installation of Google’s TensorFlow package, which requires the NumPy package to work with large, multidimensional arrays, and use </span><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">pip</span></strong><span class="koboSpan" id="kobo.66.1"> to install a new package that specifies a different NumPy version as </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">a dependency.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">The different version of NumPy would then overwrite the other version and you may find that TensorFlow suddenly doesn’t work as expected, or even at all. </span><span class="koboSpan" id="kobo.68.2">In contrast, </span><strong class="source-inline"><span class="koboSpan" id="kobo.69.1">conda</span></strong><span class="koboSpan" id="kobo.70.1"> will analyze the current environment and work out on its own how to install a compatible set of dependencies for all installed packages and provide a warning if this cannot </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">be done.</span></span></p>
<p><span class="koboSpan" id="kobo.72.1">PyStan, and many other </span><a id="_idIndexMarker067"/><span class="koboSpan" id="kobo.73.1">Python tools, for that matter, require compilers written in the C language. </span><span class="koboSpan" id="kobo.73.2">These types of dependencies are unable to be installed using </span><strong class="source-inline"><span class="koboSpan" id="kobo.74.1">pip</span></strong><span class="koboSpan" id="kobo.75.1">, but Anaconda already includes them. </span><span class="koboSpan" id="kobo.75.2">Therefore, it </span><em class="italic"><span class="koboSpan" id="kobo.76.1">is strongly recommended to first </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.77.1">install Anaconda</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.79.1">If you already have a Python environment that you are happy with and do not want to install the full Anaconda distribution, there is a much smaller version available called </span><strong class="bold"><span class="koboSpan" id="kobo.80.1">Minico</span><a id="_idTextAnchor119"/><span class="koboSpan" id="kobo.81.1">nda</span></strong><span class="koboSpan" id="kobo.82.1">, which </span><a id="_idIndexMarker068"/><span class="koboSpan" id="kobo.83.1">only includes </span><strong class="source-inline"><span class="koboSpan" id="kobo.84.1">conda</span></strong><span class="koboSpan" id="kobo.85.1">, Python, and a small number of required packages. </span><span class="koboSpan" id="kobo.85.2">Although it is technically possible to install Prophet and all dependencies without Anaconda, it can be extremely difficult and the procedure varies a great deal depending on the machine in use, so writing a single guide to cover all scenarios is </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">nearly impossible.</span></span></p>
<p><span class="koboSpan" id="kobo.87.1">This guide assumes that you will begin with an Anaconda or Miniconda installation, with Python 3 or greater</span><a id="_idTextAnchor120"/><span class="koboSpan" id="kobo.88.1">. </span><span class="koboSpan" id="kobo.88.2">If you’re unsure of whether you want Ana</span><a id="_idTextAnchor121"/><span class="koboSpan" id="kobo.89.1">conda or Miniconda, go with Anaconda. </span><span class="koboSpan" id="kobo.89.2">Note that the full Anaconda distribution will require about 3 GB of space on your computer due to all of the packages included, so if space is an issue, you should consider </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">Miniconda instead.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.91.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.92.1">As of Prophet version 0.6, Python 2 is no longer supported. </span><span class="koboSpan" id="kobo.92.2">Be sure that you have Python 3.7+ installed on your machine before proceeding. </span><span class="koboSpan" id="kobo.92.3">Installing Anaconda is </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">strongly r</span><a id="_idTextAnchor122"/><a id="_idTextAnchor123"/><span class="koboSpan" id="kobo.94.1">ecommended.</span></span></p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor124"/><span class="koboSpan" id="kobo.95.1">Installation on macOS</span></h2>
<p><span class="koboSpan" id="kobo.96.1">If</span><a id="_idTextAnchor125"/><span class="koboSpan" id="kobo.97.1"> you do not already have Anaconda or Miniconda installed, tha</span><a id="_idTextAnchor126"/><span class="koboSpan" id="kobo.98.1">t should be your first step. </span><span class="koboSpan" id="kobo.98.2">Instructions for installi</span><a id="_idTextAnchor127"/><span class="koboSpan" id="kobo.99.1">ng Anaconda can be found in the Anaconda</span><a id="_idIndexMarker069"/><span class="koboSpan" id="kobo.100.1"> documentation at </span><a href="https://docs.anaconda.com/anaconda/install/mac-os/"><span class="koboSpan" id="kobo.101.1">https://docs.anaconda.com/anaconda/install/mac-os/</span></a><span class="koboSpan" id="kobo.102.1">.</span><a id="_idTextAnchor128"/><span class="koboSpan" id="kobo.103.1"> If you know that you want Mi</span><a id="_idTextAnchor129"/><span class="koboSpan" id="kobo.104.1">niconda over Anaconda, start here: </span><a href="https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/macos.html"><span class="koboSpan" id="kobo.105.1">https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/macos.html</span></a><span class="koboSpan" id="kobo.106.1">. </span><span class="koboSpan" id="kobo.106.2">Use all of the defaults for installation in </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">either case.</span></span></p>
<p><span class="koboSpan" id="kobo.108.1">With </span><a id="_idIndexMarker070"/><span class="koboSpan" id="kobo.109.1">Anaconda or Miniconda installed, installing Prophet</span><a id="_idIndexMarker071"/><span class="koboSpan" id="kobo.110.1"> can be achieved using </span><strong class="source-inline"><span class="koboSpan" id="kobo.111.1">conda</span></strong><span class="koboSpan" id="kobo.112.1">. </span><span class="koboSpan" id="kobo.112.2">Simply run the following two commands in the terminal to first install </span><strong class="source-inline"><span class="koboSpan" id="kobo.113.1">gcc</span></strong><span class="koboSpan" id="kobo.114.1">, a collection of compilers that PyStan requires, and then install Prophet itself, which will automatically also </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">install PyStan:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.116.1">
conda install gcc
conda install -c conda-forge prophet</span></pre>
<p><span class="koboSpan" id="kobo.117.1">A</span><a id="_idTextAnchor130"/><span class="koboSpan" id="kobo.118.1">fter that, you should be able to get started! </span><span class="koboSpan" id="kobo.118.2">You can skip ahead to the </span><em class="italic"><span class="koboSpan" id="kobo.119.1">Building a simple model in Prophet</span></em><span class="koboSpan" id="kobo.120.1"> sec</span><a id="_idTextAnchor131"/><span class="koboSpan" id="kobo.121.1">tion, in which we will see how to build you</span><a id="_idTextAnchor132"/><a id="_idTextAnchor133"/><span class="koboSpan" id="kobo.122.1">r </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">first model.</span></span></p>
<h2 id="_idParaDest-34"><span class="koboSpan" id="kobo.124.1">Installation on W</span><a id="_idTextAnchor134"/><span class="koboSpan" id="kobo.125.1">indows</span></h2>
<p><span class="koboSpan" id="kobo.126.1">As with </span><a id="_idIndexMarker072"/><span class="koboSpan" id="kobo.127.1">macOS, the first step is to ensur</span><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.128.1">e that Anaconda</span><a id="_idIndexMarker073"/><span class="koboSpan" id="kobo.129.1"> or Miniconda is installed. </span><span class="koboSpan" id="kobo.129.2">Anaconda installat</span><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.130.1">ion instructions can be found at </span><a href="https://docs.anaconda.com/anaconda/install/windows/"><span class="koboSpan" id="kobo.131.1">https://docs.anaconda.com/anaconda/install/windows/</span></a><span class="koboSpan" id="kobo.132.1">, and those for Miniconda are available </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">here: </span></span><a href="https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/windows.html"><span class="No-Break"><span class="koboSpan" id="kobo.134.1">https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/windows.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.135.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.136.1">On Windows, you must check the box to register Anaconda as the default Python version. </span><span class="koboSpan" id="kobo.136.2">This is required to install PyStan correctly. </span><span class="koboSpan" id="kobo.136.3">You may see a version of Python other than the one shown here, such</span><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.137.1"> as </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">Python 3.8:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer014">
<span class="koboSpan" id="kobo.139.1"><img alt="Figure 2.1 – Registering Anaconda as the default Python version" src="image/Fig_2.1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.140.1">Figure 2.1 – Registering Anaconda as the default Python version</span></p>
<p><span class="koboSpan" id="kobo.141.1">O</span><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.142.1">nce Anaconda or Miniconda has been install</span><a id="_idTextAnchor139"/><span class="koboSpan" id="kobo.143.1">ed, you’ll</span><a id="_idIndexMarker074"/><span class="koboSpan" id="kobo.144.1"> have access to the </span><strong class="bold"><span class="koboSpan" id="kobo.145.1">conda package manager</span></strong><span class="koboSpan" id="kobo.146.1">, which greatly simplifies Prophet’s installation on Windows by getting around many issues with PyStan installation. </span><span class="koboSpan" id="kobo.146.2">First, install </span><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">gcc</span></strong><span class="koboSpan" id="kobo.148.1">, which is a collection of compilers that PyStan requires, and then install Prophet itself, which will automatically also install PyStan, by running the following two commands in your </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">Command Prompt:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.150.1">
conda install gcc
conda install -c conda-forge prophet</span></pre>
<p><span class="koboSpan" id="kobo.151.1">That second </span><a id="_idIndexMarker075"/><span class="koboSpan" id="kobo.152.1">command includes additional syntax to instruct </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">conda</span></strong><span class="koboSpan" id="kobo.154.1"> to look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">conda-forge</span></strong><span class="koboSpan" id="kobo.156.1"> channel for the Prophet files. </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">conda-forge</span></strong><span class="koboSpan" id="kobo.158.1"> is a </span><a id="_idIndexMarker076"/><span class="koboSpan" id="kobo.159.1">community effort that allows developers to </span><a id="_idIndexMarker077"/><span class="koboSpan" id="kobo.160.1">provide their software as a </span><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">conda</span></strong><span class="koboSpan" id="kobo.162.1"> package. </span><span class="koboSpan" id="kobo.162.2">Prophet is not included in the default Anaconda distribution, but with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">conda</span><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.164.1">-forge</span></strong><span class="koboSpan" id="kobo.165.1"> channel, the Facebook team provi</span><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.166.1">des access directly </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">through </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">conda</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.170.1">That should leave you with Prophet </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">succ</span><a id="_idTextAnchor142"/><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.172.1">essfully installed!</span></span></p>
<h2 id="_idParaDest-35"><span class="koboSpan" id="kobo.173.1">Installation </span><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.174.1">on Linux</span></h2>
<p><span class="koboSpan" id="kobo.175.1">Installing </span><a id="_idIndexMarker078"/><span class="koboSpan" id="kobo.176.1">Anaconda on Linux requires just a </span><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.177.1">few additional steps</span><a id="_idIndexMarker079"/><span class="koboSpan" id="kobo.178.1"> compared with macOS or Windows, but they should not pose any problems. </span><span class="koboSpan" id="kobo.178.2">Full instructions can b</span><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.179.1">e found in Anaconda’s documentation at </span><a href="https://docs.anaconda.com/anaconda/install/linux/"><span class="koboSpan" id="kobo.180.1">https://docs.anaconda.com/anaconda/install/linux/</span></a><span class="koboSpan" id="kobo.181.1">. </span><span class="koboSpan" id="kobo.181.2">Instructions for Miniconda are available </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">at </span></span><a href="https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/linux.html"><span class="No-Break"><span class="koboSpan" id="kobo.183.1">https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/linux.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.184.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.185.1">Because Linux is offered by various distributions, it is not possible to write a fully comprehensive guide for Prophet installation. </span><span class="koboSpan" id="kobo.185.2">However, if you are already using Linux, it is a fair assumption that you are also well versed in </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">its intricacies.</span></span></p>
<p><span class="koboSpan" id="kobo.187.1">Just make sure that you have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">gcc</span></strong><span class="koboSpan" id="kobo.189.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">g++</span></strong><span class="koboSpan" id="kobo.191.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">build-essential</span></strong><span class="koboSpan" id="kobo.193.1"> compilers installed, as well as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">python-dev</span></strong><span class="koboSpan" id="kobo.195.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">python3-dev</span></strong><span class="koboSpan" id="kobo.197.1"> Python development tools. </span><span class="koboSpan" id="kobo.197.2">If your Linux distribution is a Red Hat system, install </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">gcc64</span></strong><span class="koboSpan" id="kobo.199.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">gcc64-c++</span></strong><span class="koboSpan" id="kobo.201.1">. </span><span class="koboSpan" id="kobo.201.2">After that, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">conda</span></strong><span class="koboSpan" id="kobo.203.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">install Prophet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.205.1">
conda install -c conda-forge prophet</span></pre>
<p><span class="koboSpan" id="kobo.206.1">If everything went well, you should be ready to go now! </span><span class="koboSpan" id="kobo.206.2">Let’s test it out by build</span><a id="_idTextAnchor147"/><a id="_idTextAnchor148"/><span class="koboSpan" id="kobo.207.1">ing your </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">first model.</span></span></p>
<h1 id="_idParaDest-36"><span class="koboSpan" id="kobo.209.1">Building a simple model i</span><a id="_idTextAnchor149"/><span class="koboSpan" id="kobo.210.1">n Prophet</span></h1>
<p><span class="koboSpan" id="kobo.211.1">The </span><a id="_idIndexMarker080"/><span class="koboSpan" id="kobo.212.1">longest </span><a id="_idIndexMarker081"/><span class="koboSpan" id="kobo.213.1">record of direct measurements o</span><a id="_idTextAnchor150"/><span class="koboSpan" id="kobo.214.1">f </span><strong class="bold"><span class="koboSpan" id="kobo.215.1">Carbon Dioxide</span></strong><span class="koboSpan" id="kobo.216.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.217.1">CO</span></strong><span class="subscript"><span class="koboSpan" id="kobo.218.1">2</span></span><span class="koboSpan" id="kobo.219.1">) in the atmosphere was started in March 1958 by Charles David Keeling of the Scripps Institution of Oceanography. </span><span class="koboSpan" id="kobo.219.2">Keeling was based in La Jolla, C</span><a id="_idTextAnchor151"/><span class="koboSpan" id="kobo.220.1">alifornia, but received permission from the </span><strong class="bold"><span class="koboSpan" id="kobo.221.1">National Oceanic and Atmospheric Administration</span></strong><span class="koboSpan" id="kobo.222.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.223.1">NOAA</span></strong><span class="koboSpan" id="kobo.224.1">) to </span><a id="_idIndexMarker082"/><span class="koboSpan" id="kobo.225.1">use its facility located 2 miles above sea level on the northern slope of Mauna Loa, a volcano on the island of Hawaii, to collect CO</span><span class="subscript"><span class="koboSpan" id="kobo.226.1">2</span></span><span class="koboSpan" id="kobo.227.1"> samples. </span><span class="koboSpan" id="kobo.227.2">At that elevation, Keeling’s measurements would be unaffected by local releases of CO</span><span class="subscript"><span class="koboSpan" id="kobo.228.1">2</span></span><span class="koboSpan" id="kobo.229.1">, such as from </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">nearby factories.</span></span></p>
<p><span class="koboSpan" id="kobo.231.1">In 1961, Keeling published the data he had collected thus far, establishing that there was strong seasonal variation in CO</span><span class="subscript"><span class="koboSpan" id="kobo.232.1">2</span></span><span class="koboSpan" id="kobo.233.1"> levels and that they were rising steadily, a trend th</span><a id="_idTextAnchor152"/><span class="koboSpan" id="kobo.234.1">at later became known as</span><a id="_idIndexMarker083"/><span class="koboSpan" id="kobo.235.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.236.1">Keeling Curve</span></strong><span class="koboSpan" id="kobo.237.1">. </span><span class="koboSpan" id="kobo.237.2">By May 1974, the NOAA had begun their own parallel measurements and have continued since then. </span><span class="koboSpan" id="kobo.237.3">The Keeling Cu</span><a id="_idTextAnchor153"/><span class="koboSpan" id="kobo.238.1">rve graph is </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer015">
<span class="koboSpan" id="kobo.240.1"><img alt="Figure 2.2 – The Keeling Curve, showing the concentration of carbon dioxide in the atmosphere" src="image/Fig_2.2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.241.1">Figure 2.2 – The Keeling Curve, showing the concentration of carbon dioxide in the atmosphere</span></p>
<p><span class="koboSpan" id="kobo.242.1">With its seasonality and increasing trend, this curve is a good candidate to try out with Prophet. </span><span class="koboSpan" id="kobo.242.2">This dataset contains over 19,000 daily observations across 53 years. </span><span class="koboSpan" id="kobo.242.3">The unit of measurement for</span><a id="_idIndexMarker084"/><span class="koboSpan" id="kobo.243.1"> CO</span><span class="subscript"><span class="koboSpan" id="kobo.244.1">2</span></span><span class="koboSpan" id="kobo.245.1"> is </span><strong class="bold"><span class="koboSpan" id="kobo.246.1">Parts Per Million</span></strong><span class="koboSpan" id="kobo.247.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.248.1">PPM</span></strong><span class="koboSpan" id="kobo.249.1">), a measure of CO</span><span class="subscript"><span class="koboSpan" id="kobo.250.1">2</span></span><span class="koboSpan" id="kobo.251.1"> molecules per million molecules </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">of air.</span></span></p>
<p><span class="koboSpan" id="kobo.253.1">To begin our model, we need to import the necessary libraries, </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">pandas</span></strong><span class="koboSpan" id="kobo.255.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">matplotlib</span></strong><span class="koboSpan" id="kobo.257.1">, and import the Prophet class from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">prophet</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.259.1"> package:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.260.1">
import pandas as pd
import matplotlib.pyplot as plt
from prophet import Prophet</span></pre>
<p><span class="koboSpan" id="kobo.261.1">As input, Prophet always requires a pandas DataFrame with </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">two columns:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">ds</span></strong><span class="koboSpan" id="kobo.264.1">, for date stamp, should be a </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">datestamp</span></strong><span class="koboSpan" id="kobo.266.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">timestamp</span></strong><span class="koboSpan" id="kobo.268.1"> column in a format expected </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">by pandas</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">y</span></strong><span class="koboSpan" id="kobo.271.1">, a numeric column containing the measurement we wish </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">to forecast</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.273.1">Here, we </span><a id="_idIndexMarker085"/><span class="koboSpan" id="kobo.274.1">use pandas to import the data, in this case, a </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">.csv</span></strong><span class="koboSpan" id="kobo.276.1"> file, and</span><a id="_idIndexMarker086"/><span class="koboSpan" id="kobo.277.1"> then load it into a D</span><a id="_idTextAnchor154"/><span class="koboSpan" id="kobo.278.1">ataFrame. </span><span class="koboSpan" id="kobo.278.2">Note that we also convert the </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">ds</span></strong><span class="koboSpan" id="kobo.280.1"> column into a pandas </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">datetime</span></strong><span class="koboSpan" id="kobo.282.1"> format to ensure that pandas correctly identifies it as containing dates and doesn’t simply load it as an </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">alphanumeric string:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.284.1">
df = pd.read_csv('co2-ppm-daily_csv.csv')
df['date'] = pd.to_datetime(df['date'])
df.columns = ['ds', 'y']</span></pre>
<p><span class="koboSpan" id="kobo.285.1">If you’re familiar with the scikit-learn (</span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">sklearn</span></strong><span class="koboSpan" id="kobo.287.1">) package, you’ll feel right at home in Prophet because it was designed to operate in a similar way. </span><span class="koboSpan" id="kobo.287.2">Prophet follows the sklearn paradigm of first creating an instance of the model class before calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">fit</span></strong><span class="koboSpan" id="kobo.289.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">predict</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.291.1"> methods:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.292.1">
model = Prophet()
model.fit(df)</span></pre>
<p><span class="koboSpan" id="kobo.293.1">In that single </span><strong class="source-inline"><span class="koboSpan" id="kobo.294.1">fit</span></strong><span class="koboSpan" id="kobo.295.1"> command, Prophet analyzed the data and isolated both the seasonality and trend without requiring us to specify any additional parameters. </span><span class="koboSpan" id="kobo.295.2">It has not yet made any future forecast, though. </span><span class="koboSpan" id="kobo.295.3">To do that, we need to first make a DataFrame of future dates and then call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">predict</span></strong><span class="koboSpan" id="kobo.297.1"> method. </span><span class="koboSpan" id="kobo.297.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">make_future_dataframe</span></strong><span class="koboSpan" id="kobo.299.1"> method requires us to specify the number of days we intend to forecast out. </span><span class="koboSpan" id="kobo.299.2">In this case, we will choose 10 years, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">365</span></strong><span class="koboSpan" id="kobo.301.1"> days </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">times </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">10</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.305.1">
future = model.make_future_dataframe(periods=365 * 10)
forecast = model.predict(future)</span></pre>
<p><span class="koboSpan" id="kobo.306.1">At this </span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.307.1">point, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">forecast</span></strong><span class="koboSpan" id="kobo.309.1"> DataFrame contains </span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.310.1">Prophet’s prediction for CO</span><span class="subscript"><span class="koboSpan" id="kobo.311.1">2</span></span><span class="koboSpan" id="kobo.312.1"> concentrations going 10 years into the future. </span><span class="koboSpan" id="kobo.312.2">We will explore that DataFrame in a moment, but first, let’s plot the data using Prophet’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">plot</span></strong><span class="koboSpan" id="kobo.314.1"> functionality. </span><span class="koboSpan" id="kobo.314.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">plot</span></strong><span class="koboSpan" id="kobo.316.1"> method is built upon Matplotlib; it requires a DataFrame output from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">predict</span></strong><span class="koboSpan" id="kobo.318.1"> method (our </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">forecast</span></strong><span class="koboSpan" id="kobo.320.1"> DataFrame in </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">this example).</span></span></p>
<p><span class="koboSpan" id="kobo.322.1">We’re labeling the axes with the optional </span><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">xlabel</span></strong><span class="koboSpan" id="kobo.324.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.325.1">ylabel</span></strong><span class="koboSpan" id="kobo.326.1"> arguments, but just </span><a id="_idTextAnchor155"/><span class="koboSpan" id="kobo.327.1">sticking with the default for the optional </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">figsize</span></strong><span class="koboSpan" id="kobo.329.1"> argument. </span><span class="koboSpan" id="kobo.329.2">Note that I am also adding a title using raw Matplotlib syntax; because the Prophet plot is built </span><a id="_idTextAnchor156"/><span class="koboSpan" id="kobo.330.1">upon Matplotlib, anything you can do to a Matplotlib figure can be performed here as well. </span><span class="koboSpan" id="kobo.330.2">Also, don’t be confused by the odd </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">ylabel</span></strong><span class="koboSpan" id="kobo.332.1"> text with the dollar signs; that just tells Matplotlib to use its own TeX-like engine to mark the subscript </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">in CO</span></span><span class="No-Break"><span class="subscript"><span class="koboSpan" id="kobo.334.1">2</span></span></span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.336.1">
fig = model.plot(forecast, xlabel='Date',
                 ylabel=r'CO$_2$ PPM')
plt.title('Daily Carbon Dioxide Levels Measured at Mauna Loa')
plt.sho</span><a id="_idTextAnchor157"/><span class="koboSpan" id="kobo.337.1">w()</span></pre>
<p><span class="koboSpan" id="kobo.338.1">The graph is </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer016">
<span class="koboSpan" id="kobo.340.1"><img alt="Figure 2.3 – Prophet forecast" src="image/Fig_2.3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.341.1">Figure 2.3 – Prophet forecast</span></p>
<p><span class="koboSpan" id="kobo.342.1">And </span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.343.1">that’s it! </span><span class="koboSpan" id="kobo.343.2">In those 12 lines of code, we have arr</span><a id="_idTextAnchor158"/><a id="_idTextAnchor159"/><span class="koboSpan" id="kobo.344.1">ived at our</span><a id="_idIndexMarker090"/> <span class="No-Break"><span class="koboSpan" id="kobo.345.1">10-year forecast.</span></span></p>
<h1 id="_idParaDest-37"><span class="koboSpan" id="kobo.346.1">Interpreting the forecast Da</span><a id="_idTextAnchor160"/><span class="koboSpan" id="kobo.347.1">taFrame</span></h1>
<p><span class="koboSpan" id="kobo.348.1">Now, let’s take a look at </span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.349.1">that </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">forecast</span></strong><span class="koboSpan" id="kobo.351.1"> DataFrame by displaying the first three rows (I’ve transposed it here, in order to better see the column names on the page) and learn how these values were used in the </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">preceding chart:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.353.1">
forecast.head(3).T</span></pre>
<p><span class="koboSpan" id="kobo.354.1">After running that command, you should see th</span><a id="_idTextAnchor161"/><span class="koboSpan" id="kobo.355.1">e following table </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">printed out:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer017">
<span class="koboSpan" id="kobo.357.1"><img alt="Figure 2.4 – The forecas﻿t DataFrame" src="image/Fig_2.4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.358.1">Figure 2.4 – The forecas</span><a id="_idTextAnchor162"/><span class="koboSpan" id="kobo.359.1">t DataFrame</span></p>
<p><span class="koboSpan" id="kobo.360.1">The following is a description of each of the columns in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">forecast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.362.1"> DataFrame:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.363.1">'ds'</span></strong><span class="koboSpan" id="kobo.364.1">: The </span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.365.1">date stamp or timestamp that the values in that row </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">pertain to</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">'trend'</span></strong><span class="koboSpan" id="kobo.368.1">: The value of the trend </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">component alone</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">'yhat_lower'</span></strong><span class="koboSpan" id="kobo.371.1">: The lower bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.372.1">final prediction</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">'yhat_upper'</span></strong><span class="koboSpan" id="kobo.374.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">final prediction</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">'trend_lower'</span></strong><span class="koboSpan" id="kobo.377.1">: The lower bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">trend component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.379.1">'trend_upper'</span></strong><span class="koboSpan" id="kobo.380.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">trend component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">'additive_terms'</span></strong><span class="koboSpan" id="kobo.383.1">: The combined value of all the </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">additive seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">'additive_terms_lower'</span></strong><span class="koboSpan" id="kobo.386.1">: The lower bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">additive seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">'additive_terms</span><a id="_idTextAnchor163"/><span class="koboSpan" id="kobo.389.1">_upper'</span></strong><span class="koboSpan" id="kobo.390.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">additive seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">'weekly'</span></strong><span class="koboSpan" id="kobo.393.1">: The value of the weekly </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">seasonality component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">'weekly_lower'</span></strong><span class="koboSpan" id="kobo.396.1">: The lower bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">weekly component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.398.1">'weekly_upper'</span></strong><span class="koboSpan" id="kobo.399.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">weekly component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">'yearly'</span></strong><span class="koboSpan" id="kobo.402.1">: The value of the yearly </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">seasonality component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.404.1">'yearly_lower'</span></strong><span class="koboSpan" id="kobo.405.1">: The lower bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">yearly component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">'yearly_upper'</span></strong><span class="koboSpan" id="kobo.408.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">yearly component</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.410.1">'multiplicative_terms'</span></strong><span class="koboSpan" id="kobo.411.1">: The combined value of all the </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">multiplicative seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">'multiplicative_terms_lower'</span></strong><span class="koboSpan" id="kobo.414.1">: The lower bound of the uncertainty interval around the </span><a id="_idIndexMarker093"/><span class="No-Break"><span class="koboSpan" id="kobo.415.1">multiplicative seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">'multiplicative_terms_upper'</span></strong><span class="koboSpan" id="kobo.417.1">: The upper bound of the uncertainty interval around the </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">multiplicative seasonalities</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.419.1">'yhat'</span></strong><span class="koboSpan" id="kobo.420.1">: The final predicted value; a combination of </span><strong class="source-inline"><span class="koboSpan" id="kobo.421.1">'trend'</span></strong><span class="koboSpan" id="kobo.422.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.423.1">'multiplicative_terms'</span></strong><span class="koboSpan" id="kobo.424.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.425.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.426.1">'additive_terms'</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.427.1">If the data</span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.428.1"> contains a daily seasonality, then the columns for </span><strong class="source-inline"><span class="koboSpan" id="kobo.429.1">'daily'</span></strong><span class="koboSpan" id="kobo.430.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.431.1">'daily_upper'</span></strong><span class="koboSpan" id="kobo.432.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">'daily_lower'</span></strong><span class="koboSpan" id="kobo.434.1"> will also be included, following the pattern established by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">'weekly'</span></strong><span class="koboSpan" id="kobo.436.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.437.1">'yearly'</span></strong><span class="koboSpan" id="kobo.438.1"> columns. </span><span class="koboSpan" id="kobo.438.2">Later chapters will include discussions and examples of both the additive/multiplicative seasonalities and the </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">uncertainty intervals.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.440.1">Tip</span></p>
<p class="callout"><em class="italic"><span class="koboSpan" id="kobo.441.1">yhat</span></em><span class="koboSpan" id="kobo.442.1"> is pronounced as </span><em class="italic"><span class="koboSpan" id="kobo.443.1">why hat</span></em><span class="koboSpan" id="kobo.444.1">. </span><span class="koboSpan" id="kobo.444.2">It comes from the statistical notation where the </span><em class="italic"><span class="koboSpan" id="kobo.445.1">ŷ</span></em><span class="koboSpan" id="kobo.446.1"> variable represents a predicted value of the </span><em class="italic"><span class="koboSpan" id="kobo.447.1">y</span></em><span class="koboSpan" id="kobo.448.1"> variable. </span><span class="koboSpan" id="kobo.448.2">In general, placing a hat, or caret, over a true parameter denotes an estimator </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">of it.</span></span></p>
<p><span class="koboSpan" id="kobo.450.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.451.1">Figure 2</span></em></span><em class="italic"><span class="koboSpan" id="kobo.452.1">.3</span></em><span class="koboSpan" id="kobo.453.1">, the black dots represent the actual recorded </span><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">y</span></strong><span class="koboSpan" id="kobo.455.1"> values we fit (those in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">df['y']</span></strong><span class="koboSpan" id="kobo.457.1"> column), whereas the solid line represents the calculated </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">yhat</span></strong><span class="koboSpan" id="kobo.459.1"> values (t</span><a id="_idTextAnchor164"/><span class="koboSpan" id="kobo.460.1">he </span><strong class="source-inline"><span class="koboSpan" id="kobo.461.1">forecast['yhat']</span></strong><span class="koboSpan" id="kobo.462.1"> column). </span><span class="koboSpan" id="kobo.462.2">Note that the solid line extends beyond the range of the black dots where we have forecasted into the future. </span><span class="koboSpan" id="kobo.462.3">The lighter shading notable around the solid line in the forecasted</span><a id="_idIndexMarker095"/><span class="koboSpan" id="kobo.463.1"> region represents the uncertainty interval, bound by </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">forecast['yhat_lower']</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.465.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">forecast['yhat_upper']</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.468.1">Now, let’s break down </span><a id="_idTextAnchor165"/><a id="_idTextAnchor166"/><span class="koboSpan" id="kobo.469.1">that forecast into </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">its components.</span></span></p>
<h1 id="_idParaDest-38"><a id="_idTextAnchor167"/><span class="koboSpan" id="kobo.471.1">Understanding components plots</span></h1>
<p><span class="koboSpan" id="kobo.472.1">In </span><a href="B19630_01.xhtml#_idTextAnchor031"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.473.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.474.1">, </span><em class="italic"><span class="koboSpan" id="kobo.475.1">The History and Development of Time Series Forecas</span><a id="_idTextAnchor168"/><span class="koboSpan" id="kobo.476.1">ting</span></em><span class="koboSpan" id="kobo.477.1">, Prophet was introduced as</span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.478.1"> an additive regression model. </span><em class="italic"><span class="koboSpan" id="kobo.479.1">Figures 1.4 and 1.5</span></em><span class="koboSpan" id="kobo.480.1"> showed how individual component curves for the trend and the different seasonalities are added together to create a more complex curve. </span><span class="koboSpan" id="kobo.480.2">The Prophet algorithm essentially does this in reverse; it takes a complex curve and decomposes it into its constituent parts. </span><span class="koboSpan" id="kobo.480.3">The first step toward greater control over a Prophet forecast is to understand these components so that they can be manipulated individually. </span><span class="koboSpan" id="kobo.480.4">Prophet provides a </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">plot_components</span></strong><span class="koboSpan" id="kobo.482.1"> method to </span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">visualize these.</span></span></p>
<p><span class="koboSpan" id="kobo.484.1">Continuing with our progress on the Mauna Loa model, plotting the components is as simple as running </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">these commands:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.486.1">
fig2 = model.plot_components(forecas</span><a id="_idTextAnchor169"/><span class="koboSpan" id="kobo.487.1">t)
plt.show()</span></pre>
<p><span class="koboSpan" id="kobo.488.1">As you can see in the</span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.489.1"> output plot, Prophet has isolated three components in this dataset: </span><strong class="bold"><span class="koboSpan" id="kobo.490.1">trend</span></strong><span class="koboSpan" id="kobo.491.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.492.1">weekly s</span><a id="_idTextAnchor170"/><span class="koboSpan" id="kobo.493.1">easonality</span></strong><span class="koboSpan" id="kobo.494.1">, and </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.495.1">yearly seasonality</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer018">
<span class="koboSpan" id="kobo.497.1"><img alt="Figure 2.5 – Mauna Loa c﻿omponents plot" src="image/Fig_2.5.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.498.1">Figure 2.5 – Mauna Loa c</span><a id="_idTextAnchor171"/><span class="koboSpan" id="kobo.499.1">omponents plot</span></p>
<p><span class="koboSpan" id="kobo.500.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.501.1">trend</span></strong><span class="koboSpan" id="kobo.502.1"> constantly </span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.503.1">increases but seems to have a steepening slope as</span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.504.1"> time progresses—an acceleration of CO</span><span class="subscript"><span class="koboSpan" id="kobo.505.1">2</span></span><span class="koboSpan" id="kobo.506.1"> concentration in the atmosphere. </span><span class="koboSpan" id="kobo.506.2">The trend line also shows slim uncertainty intervals in the forecasted year. </span><span class="koboSpan" id="kobo.506.3">From this curve, we learn that atmospheric CO</span><span class="subscript"><span class="koboSpan" id="kobo.507.1">2</span></span><span class="koboSpan" id="kobo.508.1"> concentrations were about 320 PPM in 1965. </span><span class="koboSpan" id="kobo.508.2">This grew to about 400 PPM by 2015 and we expect about 430 PPM by 2030. </span><span class="koboSpan" id="kobo.508.3">However, these exact numbers will vary depending upon the day of the week and the time of year due to the existence of the </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">seasonality effects.</span></span></p>
<p><span class="koboSpan" id="kobo.510.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.511.1">weekly seasonality</span></strong><span class="koboSpan" id="kobo.512.1"> shows that</span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.513.1"> by day of the week, values will vary by about 0.01 PPM—an insignificant amount and most likely due purely to noise and random chance. </span><span class="koboSpan" id="kobo.513.2">Indeed, intuition tells us that CO</span><span class="subscript"><span class="koboSpan" id="kobo.514.1">2</span></span><span class="koboSpan" id="kobo.515.1"> levels (when measured far enough away from human activity, as they are on the high slopes of Mauna Loa) do not care much what day of the week it is and are unaffected </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">by it.</span></span></p>
<p><span class="koboSpan" id="kobo.517.1">We will learn in </span><a href="B19630_05.xhtml#_idTextAnchor254"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.518.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.519.1">, </span><em class="italic"><span class="koboSpan" id="kobo.520.1">Working with Seasonality</span></em><span class="koboSpan" id="kobo.521.1">, how to instruct Prophet not to fit a weekly seasonality, as is prudent in this case. </span><span class="koboSpan" id="kobo.521.2">In </span><a href="B19630_11.xhtml#_idTextAnchor728"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.522.1">Chapter 11</span></em></span></a><span class="koboSpan" id="kobo.523.1">, </span><em class="italic"><span class="koboSpan" id="kobo.524.1">Managing Uncertainty Intervals</span></em><span class="koboSpan" id="kobo.525.1">, we will learn how to plot uncertainty for seasonality and ensure that a seasonality such as this can </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">be ignored.</span></span></p>
<p><span class="koboSpan" id="kobo.527.1">Now, looking at the </span><strong class="bold"><span class="koboSpan" id="kobo.528.1">yearly seasonality</span></strong><span class="koboSpan" id="kobo.529.1"> reveals</span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.530.1"> that CO</span><span class="subscript"><span class="koboSpan" id="kobo.531.1">2</span></span><span class="koboSpan" id="kobo.532.1"> rises throughout the winter and peaks in May or so, while falling in the summer with a trough in </span><a id="_idTextAnchor172"/><span class="koboSpan" id="kobo.533.1">October. </span><span class="koboSpan" id="kobo.533.2">Measurements of CO</span><span class="subscript"><span class="koboSpan" id="kobo.534.1">2</span></span><span class="koboSpan" id="kobo.535.1"> can be 3 PPM above or 3 PPM below what the trend alone would predict, based on the time of year. </span><span class="koboSpan" id="kobo.535.2">If you refer back to the original data plotted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.536.1">Figure 2</span></em></span><em class="italic"><span class="koboSpan" id="kobo.537.1">.2</span></em><span class="koboSpan" id="kobo.538.1">, you will be reminded that there was a very obvious cyclical nature to the curve, captured with this </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">yearly seasonality.</span></span></p>
<p><span class="koboSpan" id="kobo.540.1">As simple as that model was, that is often all you need to make very accurate forecasts with Prophet! </span><span class="koboSpan" id="kobo.540.2">We used no additional parameters than the defau</span><a id="_idTextAnchor173"/><a id="_idTextAnchor174"/><span class="koboSpan" id="kobo.541.1">lts and yet achieved very </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">good results.</span></span></p>
<h1 id="_idParaDest-39"><a id="_idTextAnchor175"/><span class="koboSpan" id="kobo.543.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.544.1">Hopefully, you experienced no issues in installing Prophet on your machine at the beginning of this chapter. </span><span class="koboSpan" id="kobo.544.2">The potential challenge of installing the Stan dependency is greatly eased by using the Anaconda distribution of Python. </span><span class="koboSpan" id="kobo.544.3">After installation, we looked at the CO</span><span class="subscript"><span class="koboSpan" id="kobo.545.1">2</span></span><span class="koboSpan" id="kobo.546.1"> levels measured in the atmosphere 2 miles above the Pacific Ocean at Mauna Loa in Hawaii. </span><span class="koboSpan" id="kobo.546.2">We built our first Prophet model and, in just 12 lines of code, were able to forecast the next 10 years of </span><span class="No-Break"><span class="koboSpan" id="kobo.547.1">CO</span></span><span class="No-Break"><span class="subscript"><span class="koboSpan" id="kobo.548.1">2</span></span></span><span class="No-Break"><span class="koboSpan" id="kobo.549.1"> levels.</span></span></p>
<p><span class="koboSpan" id="kobo.550.1">After that, we inspected the </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">forecast</span></strong><span class="koboSpan" id="kobo.552.1"> DataFrame and saw the rich results that Prophet outputs. </span><span class="koboSpan" id="kobo.552.2">Finally, we plotted the components of the forecast – the trend, yearly seasonality, and weekly seasonality – to better understand the </span><span class="No-Break"><span class="koboSpan" id="kobo.553.1">data’s behavior.</span></span></p>
<p><span class="koboSpan" id="kobo.554.1">There is a lot more to Prophet than just this simple example, though. </span><span class="koboSpan" id="kobo.554.2">In the next chapter, we’ll take a deep dive into the equations behind Prophet’s model to understand how </span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">it works.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer020">
</div>
</div>
</body></html>