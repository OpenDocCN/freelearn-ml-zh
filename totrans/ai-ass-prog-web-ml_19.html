<html><head></head><body>
  <div class="calibre1" id="_idContainer204">
    <h1 class="chapternumber">19</h1>
    <h1 class="chaptertitle" id="_idParaDest-425">Regression with Copilot Suggestions</h1>
    <h1 class="heading" id="_idParaDest-426">Introduction</h1>
    <p class="normal">In the previous chapter, we used GitHub Copilot Chat to build a regression problem and explored how AI can assist in coding. In this chapter, we’ll take a different approach. We will write code with the help of GitHub Copilot, allowing it to guide us through coding and adding helpful comments. This will be an interactive experience, combining our coding skills with Copilot’s suggestions to effectively tackle a regression problem. Let’s see how GitHub Copilot can enhance our coding process in real time. </p>
    <p class="normal1">In the task, we will use the Apple dataset to predict stock prices and help investors decide whether to buy or not. This is the same dataset we used in <em class="italic">Chapter 18</em>, <em class="italic">Regression with Copilot Chat</em>, where we used Copilot Chat to analyze it.</p>
    <h1 class="heading" id="_idParaDest-427">Dataset overview </h1>
    <p class="normal">This dataset provides<a id="_idIndexMarker901" class="calibre3"/> us with a wealth of information about Apple’s stock (traded under AAPL) over the past decade, starting from the year 2010. This data is incredibly valuable because it can help us develop forecasting algorithms to predict the future price of Apple’s stock, which is crucial for making investment decisions. The data in this set has been collected and aggregated from 25 different stock exchanges. </p>
    <p class="normal1">To effectively use this data for forecasting, we need to understand the key elements: the features that influence our target, which is predicting stock prices.</p>
    <p class="normal1">The dataset includes five important values that indicate how the stock price changes over a specific period of time, which is typically one day, but it could also be one week or one month. These values are: </p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Open</strong>: This is the stock price at the beginning of the trading day. </li>
      <li class="bulletlist1"><strong class="screentext">Close</strong>: This is the stock price at the end of the trading day. </li>
      <li class="bulletlist1"><strong class="screentext">High</strong>: This value shows the highest price the stock reached during the trading day. </li>
      <li class="bulletlist1"><strong class="screentext">Low</strong>: This indicates the lowest price the stock hit during the trading day. </li>
      <li class="bulletlist1"><strong class="screentext">Volume</strong>: This is the total number of shares that were traded throughout the day before the market closed. </li>
    </ul>
    <p class="normal1">Our focus will be on using historical<a id="_idIndexMarker902" class="calibre3"/> price data, which includes these five recorded values, along with the stock’s past performance, to make predictions about its future prices.</p>
    <h1 class="heading" id="_idParaDest-428">Prompt strategy</h1>
    <p class="normal">In this chapter, we’ll use the “Exploratory prompt pattern” as described in <em class="italic">Chapter 2</em>. We feel pretty confident on what actions we want to take in general but is interested in what the AI assistant will generate in case we need to pivot. </p>
    <h1 class="heading" id="_idParaDest-429">Start coding with Copilot’s help </h1>
    <p class="normal">With GitHub Copilot<a id="_idIndexMarker903" class="calibre3"/> installed, you’re ready to start coding your regression problem in Python. The approach of using suggestions in an open file is a bit different from using the chat window. The main difference is that we will rely on typing comments and use the <em class="italic">Tab</em> key to get Copilot to provide us with suggestions. This technique works equally well in Jupyter Notebook and normal text files. Here’s how it works:</p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># generate import statements for libraries to use with a Regression problem</span>
</code></pre>
    <p class="normal1">Here, we have an open text file. We’ve added comments to generate <code class="inlinecode">import</code> statements. To get Copilot to generate a response, we need to use the <em class="italic">Return</em> key followed by the <em class="italic">Tab</em> key to accept the suggestion. Here’s how the above text file could change:</p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># generate import statements for libraries to use with a Regression problem</span>
<span class="hljs-keyword">import</span> pandas
<span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">import</span> scikit-learn
</code></pre>
    <p class="normal1">The <code class="inlinecode">import</code> statement<a id="_idIndexMarker904" class="calibre3"/> is what is generated by Copilot when pressing <em class="italic">Tab</em> followed by <em class="italic">Return</em>.</p>
    <div class="note">
      <p class="normal1">The AI assistant helps by providing code completion, but remember to review and understand each suggestion before accepting it.</p>
    </div>
    <h2 class="heading1" id="_idParaDest-430">Step 1: Import libraries with Copilot’s assistance </h2>
    <p class="normal">We could start with a prompt suggestion<a id="_idIndexMarker905" class="calibre3"/> comment that describes<a id="_idIndexMarker906" class="calibre3"/> the problem upfront, the dataset, and more, just like we did with Copilot Chat in other chapters in this book. Then, the prompt could look like so:</p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># generate the steps I need to follow for performing a Regression problem, here's my dataset and its columns </span>
</code></pre>
    <p class="normal1">However, we will try an approach where we ask for everything we need.</p>
    <p class="normal1">Let’s begin. Let’s create our first comment (this is equivalent to typing in a chat window):</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1"># import pandas </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">Accept the suggestion with <em class="italic">Tab</em>. You should see the following bold code:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># import pandas </span>
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Great! We have imported the libraries we need. Let’s load and explore the dataset next. </p>
    <h2 class="heading1" id="_idParaDest-431">Step 2: Load and explore the dataset</h2>
    <p class="normal">In the next step, we want to load<a id="_idIndexMarker907" class="calibre3"/> the dataset<a id="_idIndexMarker908" class="calibre3"/> and explore the data features. Keep working in the same file and add the below prompt:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Load the dataset into a pandas DataFrame  </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">At this point, Copilot understands what we’re trying to do, so we don’t need to type more than the above prompt comment. So, we just need to press <em class="italic">Return</em> followed by <em class="italic">Tab</em> a number of times, and we should get the content below:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Load the dataset into a pandas DataFrame </span>
df = pd.read_csv(<span class="hljs-string">'enter-your-file-path'</span>) 
 
<span class="hljs-comment"># Print the first 5 rows of the DataFrame </span>
<span class="hljs-built_in">print</span>(df.head()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <div class="note">
      <p class="normal1">Ensure you have downloaded the dataset from Kaggle (<a href="https://www.kaggle.com/datasets/varpit94/apple-stock-data-updated-till-22jun2021" class="calibre3"><span class="calibre3">https://www.kaggle.com/datasets/varpit94/apple-stock-data-updated-till-22jun2021</span></a>) and that you have replaced the path in <code class="inlinecode">read_csv</code> to point to where the file is in your system.</p>
    </div>
    <p class="normal1">If you run<a id="_idIndexMarker909" class="calibre3"/> the suggested code, you should see similar output<a id="_idIndexMarker910" class="calibre3"/> to:</p>
    <pre class="programlisting"><code class="hljs-code">         Date     Close     Volume      Open      High       Low 
0  02/28/2020   $273.36  106721200   $257.26   $278.41   $256.37 
1  02/27/2020   $273.52   80151380    $281.1      $286   $272.96 
2  02/26/2020   $292.65   49678430   $286.53   $297.88    $286.5 
3  02/25/2020   $288.08   57668360   $300.95   $302.53   $286.13 
4  02/24/2020   $298.18   55548830   $297.26   $304.18   $289.23 
</code></pre>
    <p class="normal1">If you see the above, that means the data was loaded successfully.</p>
    <h3 class="heading2" id="_idParaDest-432">Get types and columns</h3>
    <p class="normal">Great! Now that we’ve successfully loaded<a id="_idIndexMarker911" class="calibre3"/> the data, let’s learn more<a id="_idIndexMarker912" class="calibre3"/> about the loaded dataset, such as what columns and column types it has. As usual, let’s keep working on the same file and add a prompt as a comment like so:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Get the data types of the columns in the dataset </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see the below results:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Get the data types of the columns in the dataset </span>
<span class="hljs-built_in">print</span>(df.dtypes) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Now, let’s run the code. It should show our columns and their data types:</p>
    <pre class="programlisting"><code class="hljs-code">Date      object 
Close     object 
Volume     int64 
Open      object 
High      object 
Low       object 
dtype: object 
</code></pre>
    <p class="normal1">Great! We see the columns, but many of the columns<a id="_idIndexMarker913" class="calibre3"/> have the <code class="inlinecode">object</code><code class="inlinecode"><a id="_idIndexMarker914" class="calibre3"/></code> type. That’s not good; they need to be numerical to be used in machine learning training. Let’s see if we can address this shortly, but first, let’s learn more about the shape of the dataset.</p>
    <h3 class="heading2" id="_idParaDest-433">Shape of the dataset</h3>
    <p class="normal">Let’s learn more about<a id="_idIndexMarker915" class="calibre3"/> our dataset in terms of structure, like how many columns and how many rows it consists of. This will help us assess its complexity, see how much data we have, and whether it’s enough to train a model to be reliable. Let’s write our next prompt comment:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Get the shape of the dataset </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see the below suggestion:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Get the shape of the dataset </span>
<span class="hljs-built_in">print</span>(df.shape) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Running the code above should provide the response below:</p>
    <pre class="programlisting"><code class="hljs-code">(2518, 6) 
</code></pre>
    <p class="normal1">This response<a id="_idIndexMarker916" class="calibre3"/> tells us we have 2518 rows and 6 columns.</p>
    <h3 class="heading2" id="_idParaDest-434">Addressing the column types</h3>
    <p class="normal">At this point, we know<a id="_idIndexMarker917" class="calibre3"/> we need more numerical columns, so let’s deal with the ones that aren’t numerical. First, let’s identify those non-numerical columns:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># print the columns in the dataset </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a suggestion like below:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># print the columns in the dataset </span>
<span class="hljs-built_in">print</span>(df.columns) 
Index([<span class="hljs-string">'Date'</span>, <span class="hljs-string">'Close'</span>, <span class="hljs-string">'Volume'</span>, <span class="hljs-string">'Open'</span>, <span class="hljs-string">'High'</span>, <span class="hljs-string">'Low'</span>], dtype=<span class="hljs-string">'object'</span>) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">It’s interesting that although we just asked to print the columns, Copilot makes the decision to show us only the columns of the <code class="inlinecode">object</code> type. It’s not really surprising because Copilot has been trained on machine learning and is able to deduce what will happen next, which in this case is converting columns for use in model training.</p>
    <p class="normal1">Next, let’s be a bit prescriptive and ask for columns to be converted to numerical versions with the below prompt comment:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Replace the $ symbol with an empty string and convert the column to float data type </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see the below code, which turns several columns into numerical versions.</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Replace the $ symbol with an empty string and convert the column to float data type </span>
df[<span class="hljs-string">'Open'</span>] = df[<span class="hljs-string">'Open'</span>].replace({<span class="hljs-string">'\$'</span>: <span class="hljs-string">''</span>}, regex=<span class="hljs-literal">True</span>).astype(<span class="hljs-built_in">float</span>) 
df[<span class="hljs-string">'Close'</span>] = df[<span class="hljs-string">'Close'</span>].replace({<span class="hljs-string">'\$'</span>: <span class="hljs-string">''</span>}, regex=<span class="hljs-literal">True</span>).astype(<span class="hljs-built_in">float</span>) 
df[<span class="hljs-string">'High'</span>] = df[<span class="hljs-string">'High'</span>].replace({<span class="hljs-string">'\$'</span>: <span class="hljs-string">''</span>}, regex=<span class="hljs-literal">True</span>).astype(<span class="hljs-built_in">float</span>) 
df[<span class="hljs-string">'Low'</span>] = df[<span class="hljs-string">'Low'</span>].replace({<span class="hljs-string">'\$'</span>: <span class="hljs-string">''</span>}, regex=<span class="hljs-literal">True</span>).astype(<span class="hljs-built_in">float</span>) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Great! Let’s inspect the columns next to ensure the conversion has been carried out correctly.</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Print the first 5 rows of the DataFrame to confirm the changes </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Print the first 5 rows of the DataFrame to confirm the changes </span>
<span class="hljs-built_in">print</span>(df.head()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">If you run the above code, you should see the response below:</p>
    <pre class="programlisting"><code class="hljs-code">         Date   Close     Volume    Open    High     Low 
0  02/28/2020  273.36  106721200  257.26  278.41  256.37 
1  02/27/2020  273.52   80151380  281.10  286.00  272.96 
2  02/26/2020  292.65   49678430  286.53  297.88  286.50 
3  02/25/2020  288.08   57668360  300.95  302.53  286.13 
4  02/24/2020  298.18   55548830  297.26  304.18  289.23 
</code></pre>
    <p class="normal1">We can clearly see that the dollar<a id="_idIndexMarker918" class="calibre3"/> signs have been removed and the columns are now numerical, save for the Date column, which we can deal with later.</p>
    <h3 class="heading2" id="_idParaDest-435">Statistical summary</h3>
    <p class="normal">Next, let’s learn a bit more about<a id="_idIndexMarker919" class="calibre3"/> the dataset by asking for a statistical summary. We can expect to see these values:</p>
    <ul class="calibre15">
      <li class="bulletlist"><strong class="screentext">Count</strong>: The number of non-null entries</li>
      <li class="bulletlist1"><strong class="screentext">Mean</strong>: The average value</li>
      <li class="bulletlist1"><strong class="screentext">Standard Deviation (std)</strong>: The spread of the data</li>
      <li class="bulletlist1"><strong class="screentext">Minimum (min)</strong>: The smallest value</li>
      <li class="bulletlist1"><strong class="screentext">25th Percentile (25%)</strong>: The value below which 25% of the data falls</li>
      <li class="bulletlist1"><strong class="screentext">Median (50%)</strong>: The middle value, also known as the 50th percentile</li>
      <li class="bulletlist1"><strong class="screentext">75th Percentile (75%)</strong>: The value below which 75% of the data falls</li>
      <li class="bulletlist1"><strong class="screentext">Maximum (max)</strong>: The largest value</li>
    </ul>
    <p class="normal1">With that in mind, let’s write a prompt comment:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># get the statistical summary of the dataset </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see an output similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># get the statistical summary of the dataset </span>
<span class="hljs-built_in">print</span>(df.describe()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">If you run the code, you will see data similar to this:</p>
    <pre class="programlisting"><code class="hljs-code">             Close        Volume         Open         High          Low 
count  <span class="hljs-attr">2518.000000</span>  <span class="hljs-attr">2.518000e+03</span>  <span class="hljs-attr">2518.000000</span>  <span class="hljs-attr">2518.000000</span>  <span class="hljs-attr">2518.000000</span> 
mean    <span class="hljs-attr">114.769522</span>  <span class="hljs-attr">7.258009e+07</span>   <span class="hljs-attr">114.728443</span>   <span class="hljs-attr">115.766415</span>   <span class="hljs-attr">113.690582</span> 
std      <span class="hljs-attr">60.662405</span>  <span class="hljs-attr">5.663113e+07</span>    <span class="hljs-attr">60.546893</span>    <span class="hljs-attr">61.134456</span>    <span class="hljs-attr">60.085105</span> 
<span class="hljs-built_in">min</span>      <span class="hljs-attr">29.835700</span>  <span class="hljs-attr">1.136205e+07</span>    <span class="hljs-attr">29.392800</span>    <span class="hljs-attr">29.928600</span>    <span class="hljs-attr">28.464300</span> 
<span class="hljs-attr">25</span>%      <span class="hljs-attr">66.822475</span>  <span class="hljs-attr">3.053026e+07</span>    <span class="hljs-attr">66.877150</span>    <span class="hljs-attr">67.475300</span>    <span class="hljs-attr">66.372950</span> 
<span class="hljs-attr">50</span>%     <span class="hljs-attr">101.090000</span>  <span class="hljs-attr">5.295469e+07</span>   <span class="hljs-attr">101.115000</span>   <span class="hljs-attr">102.085000</span>   <span class="hljs-attr">100.350000</span> 
<span class="hljs-attr">75</span>%    
</code></pre>
    <h3 class="heading2" id="_idParaDest-436">Check for missing values</h3>
    <p class="normal">It’s crucial to identify missing values<a id="_idIndexMarker920" class="calibre3"/> to assess the quality of your dataset. High numbers of null values might indicate issues with data collection or entry and may affect our model, so we need a way to handle them:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">Check for missing values </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># check for missing values </span>
<span class="hljs-built_in">print</span>(df.isnull().<span class="hljs-built_in">sum</span>()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Great! So, what does the code do? Well, let’s explain. Let’s say you have the following dataset:</p>
    <pre class="programlisting"><code class="hljs-code">data = {'A': [7, 99, None, 3, None],
        'B': [5, None, 6, 8, 9],
        'C': [10, 15, 12, None, 11]}
</code></pre>
    <p class="normal1">Running the suggested code would summarize the number of missing values per column, and you would see a response like this:</p>
    <pre class="programlisting"><code class="hljs-code">A: 2
B: 1
C: 1
</code></pre>
    <p class="normal1">What you can do is replace the missing value with a value that doesn’t affect the overall score. One way to do so is to add the mean value and replace <code class="inlinecode">None</code> with that.</p>
    <h3 class="heading2" id="_idParaDest-437">Check for duplicates</h3>
    <p class="normal">Another way to clean up the data<a id="_idIndexMarker921" class="calibre3"/> is to remove duplicated data, because you don’t want that data to create a reinforcing effect on the model. Let’s create a comment for that and see if Copilot can help us:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-built_in">print</span>(df.duplicated().<span class="hljs-built_in">sum</span>()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">At this point, Copilot understands what we’re trying to do, that is, identify and remove duplicates. So, you should see suggested code for both operations below:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># check for duplicates </span>
<span class="hljs-built_in">print</span>(df.duplicated().<span class="hljs-built_in">sum</span>()) 
 
<span class="hljs-comment"># drop duplicates </span>
df.drop_duplicates(inplace=<span class="hljs-literal">True</span>)
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <h3 class="heading2" id="_idParaDest-438">Scale numerical features</h3>
    <p class="normal">Next, we’re going to scale<a id="_idIndexMarker922" class="calibre3"/> values, so they fall into a specific range, 0–1. This type of preprocessing will have beneficial effects on a number of things, such as algorithm performance, convergence speed, interpretability, and preventing a group of values from dominating. Let’s create a prompt for scaling features:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Scale numerical features </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">Note that when there’s more than one row in the response, you may need to press <em class="italic">Return</em> and <em class="italic">Tab</em> repeatedly. You should see output similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Scale numerical features </span>
<span class="hljs-comment"># import StandardScaler </span>
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler 
 
scaler = StandardScaler() 
df[[<span class="hljs-string">'Open'</span>, <span class="hljs-string">'Close'</span>, <span class="hljs-string">'High'</span>, <span class="hljs-string">'Low'</span>, <span class="hljs-string">'Volume'</span>]] = scaler.fit_transform(df[[<span class="hljs-string">'Open'</span>, <span class="hljs-string">'Close'</span>, <span class="hljs-string">'High'</span>, <span class="hljs-string">'Low'</span>, <span class="hljs-string">'Volume'</span>]]) 
 
<span class="hljs-comment"># Print the first 5 rows of the DataFrame to confirm the changes </span>
<span class="hljs-built_in">print</span>(df.head()) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Running the suggested<a id="_idIndexMarker923" class="calibre3"/> code should result in the below output:</p>
    <pre class="programlisting"><code class="hljs-code">         Date     Close    Volume      Open      High       Low 
0  02/28/2020  2.614832  0.602988  2.354536  2.660953  2.375094 
1  02/27/2020  2.617470  0.133721  2.748359  2.785130  2.651257 
2  02/26/2020  2.932884 -0.404481  2.838059  2.979494  2.876649 
3  02/25/2020  2.857534 -0.263366  3.076269  3.055571  2.870490 
4  02/24/2020  3.024063 -0.300800  3.015313  3.082566  2.922093 
</code></pre>
    <h3 class="heading2" id="_idParaDest-439">Visualization</h3>
    <p class="normal">Next, we want to visualize<a id="_idIndexMarker924" class="calibre3"/> our data. We could give vague instructions on how to do it, but in this case, a scatter plot is a good tool to use, so let’s reflect that in the prompt:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Create a scatter plot of the Open and Close columns </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt 
<span class="hljs-comment"># Create a scatter plot of the Open and Close columns </span>
plt.scatter(df[<span class="hljs-string">'Open'</span>], df[<span class="hljs-string">'</span><span class="hljs-string">Close'</span>]) 
plt.xlabel(<span class="hljs-string">'Open'</span>) 
plt.ylabel(<span class="hljs-string">'Close'</span>) 
plt.title(<span class="hljs-string">'Relationship between Open and Close'</span>) 
plt.show() 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">Running the code above should result<a id="_idIndexMarker925" class="calibre3"/> in a scatter plot like this:</p>
    <figure class="mediaobject"><img alt="A blue dotted line with white text  Description automatically generated" src="../Images/B21232_19_01.png" class="calibre19"/> </figure>
    <p class="packt_figref">Figure 19.1: Scatter plot showing the relation between the Open and Close columns</p>
    <h2 class="heading1" id="_idParaDest-440">Step 3: Split data into training and testing sets </h2>
    <p class="normal">Before we can train<a id="_idIndexMarker926" class="calibre3"/> the model, we need to split the data into training data and test data. Let’s create a prompt to help with this:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">“use train_test_split from scikit-learn to split the dataset”</p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see an output similar to:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Use train_test_split from scikit-learn to split the dataset </span>
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split 
 
<span class="hljs-comment"># Drop the Date column from the DataFrame </span>
df = df.drop(<span class="hljs-string">'Date'</span>, axis=<span class="hljs-attr">1</span>) 
 
<span class="hljs-comment"># Split the dataset into training and testing sets </span>
X = df.drop(<span class="hljs-string">'Close'</span>, axis=<span class="hljs-attr">1</span>) 
y = df[<span class="hljs-string">'Close'</span>] 
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-attr">0.2</span>, random_state=<span class="hljs-attr">42</span>) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Print the shapes of the training and testing sets </span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">'X_train shape:'</span>, X_train.shape) 
<span class="hljs-built_in">print</span>(<span class="hljs-string">'y_train shape:'</span>, y_train.shape) 
<span class="hljs-built_in">print</span>(<span class="hljs-string">'X_test shape:'</span>, X_test.shape) 
<span class="hljs-built_in">print</span>(<span class="hljs-string">'y_test shape:'</span>, y_test.shape) 
</code></pre>
    <p class="normal1">If you run the code<a id="_idIndexMarker927" class="calibre3"/> above, you should see a response similar to:</p>
    <pre class="programlisting"><code class="hljs-code">X_train shape: (2014, 4) 
y_train shape: (2014,) 
X_test shape: (504, 4) 
y_test shape: (504,) 
</code></pre>
    <h3 class="heading2" id="_idParaDest-441">Asking questions</h3>
    <p class="normal">Just like in the chat experience<a id="_idIndexMarker928" class="calibre3"/> of Copilot, it’s possible to ask questions on a specific topic. If you prefix a question with “Q:”, Copilot understands it’s a question. Let’s try this to find out our next step:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">Q: what is the next step after splitting the data into training and testing sets? </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response <a id="_idIndexMarker929" class="calibre3"/>similar to:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Q: what is the next step after splitting the data into training and testing sets? </span>
<span class="hljs-comment"># A: train the model using the training set and test the model using the tesing set </span>
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <h2 class="heading1" id="_idParaDest-442">Step 4: Build a regression problem </h2>
    <p class="normal">The time has come<a id="_idIndexMarker930" class="calibre3"/> to train the model. You could be pretty vague here and just ask Copilot to perform training. It’s recommended, however, to suggest the type of training you want. In this case, we want linear regression, so let’s create a prompt that includes that:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">“initialize a LinearRegression model”. </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># initialize a LinearRegression model </span>
<span class="hljs-comment"># import LinearRegression </span>
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression 
 
<span class="hljs-comment"># Instantiate LinearRegression as lr </span>
lr = LinearRegression() 
</code></pre>
    <p class="normal1"><strong class="screentext">[End Suggestion Response]</strong></p>
    <p class="normal1">Great! We have some code that ensures we use linear regression. We haven’t carried out any training, though, so that’s next.</p>
    <h2 class="heading1" id="_idParaDest-443">Step 5: Train the model </h2>
    <p class="normal">With the type of training<a id="_idIndexMarker931" class="calibre3"/> specified, let’s train the model next:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">“fit the model” </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see a response similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment"># Fit lr to the training data </span>
lr.fit(X_train, y_train) 
 
<span class="hljs-comment"># Predict the labels of the test set </span>
y_pred = lr.predict(X_test) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <h2 class="heading1" id="_idParaDest-444">Step 6: Evaluate model performance </h2>
    <p class="normal">Great! We have trained<a id="_idIndexMarker932" class="calibre3"/> the model, but we don’t know anything about how well it performs, and that’s something we should address next:</p>
    <p class="normal1"><strong class="screentext">[Prompt]</strong></p>
    <p class="normal1">Evaluate the performance metrics like MSE or R-squared. </p>
    <p class="normal1"><strong class="screentext">[End of prompt]</strong></p>
    <p class="normal1">You should see an output similar to this:</p>
    <p class="normal1"><strong class="screentext">[Prompt response]</strong></p>
    <pre class="programlisting"><code class="hljs-code"><span class="hljs-comment">#evaluate the performance metrics like MSE or R-squared </span>
 
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error 
 
<span class="hljs-comment"># Calculate the Mean Squared Error (MSE) of the model on the testing set </span>
mean_squared_error = mean_squared_error(y_test, y_pred) 
<span class="hljs-built_in">print</span>(<span class="hljs-string">'Mean squared error:'</span>, mean_squared_error) 
 
<span class="hljs-comment"># Calculate the Root Mean Squared Error (RMSE) of the model on the testing set </span>
root_mean_squared_error = np.sqrt(mean_squared_error) 
<span class="hljs-built_in">print</span>(<span class="hljs-string">'Root mean squared error:'</span>, root_mean_squared_error) 
</code></pre>
    <p class="normal1"><strong class="screentext">[End of response]</strong></p>
    <p class="normal1">If you run the above code, you should see a response like this:</p>
    <pre class="programlisting"><code class="hljs-code">MSE: 0.00011569609998631774 
RMSE: 0.010756212157926123 
</code></pre>
    <p class="normal1">The output we get represents two different errors: mean squared error and root mean squared error. </p>
    <p class="normal1">A lower MSE indicates<a id="_idIndexMarker933" class="calibre3"/> a better fit of the model to the data. In this case, the MSE is quite low, suggesting that the model’s predictions are very close to the actual values.</p>
    <p class="normal1">The RMSE value is also very low, reinforcing that the model’s predictions are highly accurate. Great! Let’s go over this chapter’s assignment, and then summarize what we have learned about using Copilot to help us with machine learning.</p>
    <h1 class="heading" id="_idParaDest-445">Assignment</h1>
    <p class="normal">Try to solve this problem using a prompting approach where you provide a lot of information upfront. We suggest constructing a prompt like so:</p>
    <ul class="calibre15">
      <li class="bulletlist">“Carry out regression on a dataset with the following shape:</li>
      <li class="bulletlist1">Open: This is the stock price at the beginning of the trading day. </li>
      <li class="bulletlist1">Close: This represents the stock price at the end of the trading day. </li>
      <li class="bulletlist1">High: This value shows the highest price the stock reached during the trading day. </li>
      <li class="bulletlist1">Low: This indicates the lowest price the stock hit during the trading day. </li>
      <li class="bulletlist1">Volume: This is the total number of shares that were traded throughout the day before the market closed. </li>
    </ul>
    <p class="normal1">Suggest all the steps from loading and pre-processing the data to training and evaluating the model. You must show code for each step.”</p>
    <p class="normal1">Then see what the response is and try to run the suggested code snippet for each step. If you encounter any issues, indicate the error to Copilot with a question prompt like so:</p>
    <ul class="calibre15">
      <li class="bulletlist">“Q: the below/above code doesn’t work, please fix”</li>
    </ul>
    <p class="normal1">Don’t forget to press <em class="italic">Return</em> and <em class="italic">Tab</em> to accept the completion.</p>
    <h1 class="heading" id="_idParaDest-446">Summary</h1>
    <p class="normal">In this chapter, we wanted to use the suggestion feature of GitHub Copilot, meaning we would type comments and use the <em class="italic">Return</em> and <em class="italic">Tab</em> keys to receive suggestions from Copilot. There’s a bit of a trick to it because sometimes you need to repeatedly press <em class="italic">Return</em> and <em class="italic">Tab</em> to get the full response. It’s also an AI experience that’s well suited to whenever you actively write code. GitHub Copilot Chat also has a place. In fact, the two different experiences complement one another; choose how much of each approach you want to use. Also, always test the code suggested by Copilot and ask Copilot to fix the code output if needed.</p>
    <h1 class="heading" id="_idParaDest-447">Join our community on Discord </h1>
    <p class="normal">Join our community’s Discord space for discussions with the author and other readers: </p>
    <p class="normal1"><a href="https://packt.link/aicode" class="calibre3"><span class="calibre3">https://packt.link/aicode</span></a></p>
    <p class="normal1"><span class="calibre3"><img alt="" src="../Images/QR_Code510410532445718281.png" class="calibre4"/></span></p>
  </div>
</body></html>