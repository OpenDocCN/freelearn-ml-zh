<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Understanding Models</h1>
                </header>
            
            <article>
                
<p class="mce-root CDPAlignLeft CDPAlign">In this chapter, we're going to look into general model interpretation. We will have a look at the different types of predictive models. Then we will interpret some machine learning models using various techniques.</p>
<p>We will be covering the following topics in this chapter:</p>
<ul>
<li>Types of models</li>
<li>Using graphs to interpret machine learning models</li>
<li>Using statistics to interpret machine learning models</li>
<li>Using decision trees to interpret machine learning models</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Models</h1>
                </header>
            
            <article>
                
<p class="mce-root">There are three different types of predictive models:</p>
<ul>
<li class="mce-root">Statistical models</li>
<li class="mce-root">Decision tree models</li>
<li class="mce-root">Machine learning models</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Statistical models</h1>
                </header>
            
            <article>
                
<p class="mce-root">The <span>first thing that t</span>he statistical models identify is which predictors are most important in a model. T<span>he statistical models </span>also create an equation that allows you to make predictions. For example, as we can see in the following screenshot, the coefficients that are part of the prediction equation have been highlighted:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-97 image-border" src="assets/3f1b8253-9aa7-4c21-b0b8-c59ab41f712f.png" style="width:34.17em;height:24.25em;"/></p>
<p class="mce-root">The following screenshot highlights the equation to predict current salaries:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-98 image-border" src="assets/9fd36505-1a1d-47da-9ab1-e394f5b5dc3e.png" style="width:33.67em;height:23.92em;"/></p>
<p class="mce-root">In the following screenshot, we can see that we take the coefficient for the variable beginning salary and we multiply it by the actual beginning salary:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-99 image-border" src="assets/2e1d4de4-f734-487f-9a5a-8521fd88436c.png" style="width:33.00em;height:24.17em;"/></p>
<p class="mce-root"/>
<p class="mce-root">Now, we take the coefficient for education level and we multiply it by a person's number of years of education:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-100 image-border" src="assets/24d21da0-98c0-4436-845a-f59576ecb026.png" style="width:32.67em;height:23.17em;"/></p>
<p class="mce-root">We also need the person's <strong>age</strong>, which is highlighted in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-101 image-border" src="assets/2601c49e-8ee0-4cf3-aaa0-b331729c1382.png" style="width:33.83em;height:24.17em;"/></p>
<p class="mce-root">We multiply all the values with their respective coefficients, and finally, we add all the constants, which predicts what the person's salary is going to be. Now that's great. But in addition, the statistical models allow us to determine the effect of a one-unit increase in each predictor, and you can see the effect of this predictor on the different outcome variables.</p>
<p class="mce-root">So, for example, with education level, we see that it has a coefficient of <strong>298</strong>. That tells us that a person's current salary is increasing by $298 for each additional year of education that the person has:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-102 image-border" src="assets/a401970e-a6c2-4749-87b5-227b2e65253a.png" style="width:35.25em;height:25.42em;"/></p>
<p class="mce-root">So you can really see the impact of each individual independent variable and how it ends up impacting the overall prediction.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Decision tree models</h1>
                </header>
            
            <article>
                
<p class="mce-root">Just like statistical models, decision tree models help you identify which predictors are most important in the model. There are no equations, and we can't determine a one-unit impact and along with the effect that it has on an outcome variable. Instead we are going to create rules that make predictions by segmenting data in two mutually-exclusive categories.</p>
<p class="mce-root"/>
<p class="mce-root">So, for example, as you can see in the following screenshot, we have anybody with a variable <strong>Premier</strong> value of <strong>No</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-90 image-border" src="assets/c56a361c-0ea4-41bb-a9ce-371bf0ad65ea.png" style="width:61.25em;height:50.58em;"/></p>
<p class="mce-root"/>
<p class="mce-root">We have anybody that was a customer for three years or fewer, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-91 image-border" src="assets/d14f3bdc-d889-443c-b9fc-c569babe31d5.png" style="width:60.92em;height:50.58em;"/></p>
<p class="mce-root"/>
<p class="mce-root">And we have people whose estimated revenue was less than or equal to about 4,000,000, <span>as shown in the following screenshot:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-92 image-border" src="assets/54d74176-6eff-42d4-a2f4-76ced11d50f3.png" style="width:60.75em;height:50.33em;"/></p>
<p class="mce-root"/>
<p class="mce-root">They happen to be located in another country, and we're predicting that they're going to churn, <span>as shown in the following screenshot</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-93 image-border" src="assets/73406733-ef73-4e08-8115-07e128328366.png" style="width:60.58em;height:50.25em;"/></p>
<p class="mce-root">This rule was applied to 25 people, and the accuracy of that rule was 100%, <span>as shown in the following screenshot</span>. So, for all the customers who fit those criteria, we ended up losing them as customers 100% of the time.</p>
<p class="mce-root"/>
<p class="mce-root">Next, there's a second rule, and it's exactly the same as the first. The only difference is that the location is a <strong>National</strong> customer, and you will notice that we're still predicting the people who will be churned. That rule applies to <strong>47</strong> individuals, but the accuracy of that rule is only 66%:</p>
<p class="mce-root CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-94 image-border" src="assets/612b3aa8-6733-4b25-a8ee-3fd829127773.png" style="width:60.33em;height:49.75em;"/></span></p>
<p class="mce-root">Now, at first glance it might seem that these are fairly similar rules, but this is where you have to go back and try to identify what's really going on.</p>
<p class="mce-root"/>
<p class="mce-root">Notice that when all the criteria were met and we happen to have an international customer, we always lost them, but when we have a <strong>National</strong> customer, we still are most likely to lose them, but we didn't lose all of them. You might want to ask yourself why? Well, maybe you could go back over to the sales reps. They might inform you that they call the <strong>National</strong> customers once a quarter just to see how they're doing and that one call manages to keep some of those customers, so that you don't end up losing them. So, Decision trees allow you to create these different rules that allow you to make predictions, and then you can see the inner workings of the model very well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Machine learning models</h1>
                </header>
            
            <article>
                
<p class="mce-root">Like both statistical and decision tree models, machine learning models identify which predictors are the most important in the model.</p>
<p class="mce-root">In the following example of a neural net model, we see that the <strong>Speakers</strong> variable was the most important, followed by <strong>Premier</strong>, followed by <strong>TVs</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-96 image-border" src="assets/e19a0a48-b294-4f0f-8e9f-1f3c94ef6684.png" style="width:64.67em;height:33.67em;"/></p>
<p class="mce-root">So, those are the most important predictors and that's all we get. We don't get any equations or a rule. We don't even know the direction of the relationship, for example, are we more likely to keep or lose customers that buy more speakers? We really don't know; we don't get that kind of information from any machine learning model because they're all black boxes.</p>
<p class="mce-root"/>
<p class="mce-root">Hence, in the next section, we're going to see how you would figure out exactly how to interpret the results of a machine learning model. Also, we'll see how to use graphs to interpret machine learning models.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using graphs to interpret machine learning models</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>In this section, we're going to see how to use graphs to interpret the results of a machine learning model. Specifically, it's important to know what kind of data you have, because the type of data will determine the type of graph that you can create. This graph will then help you understand what goes into the predictions of a machine learning model. We will also understand how a machine learning model uses these different variables for the predictions and eventually use these predictions for our final interpretation.</span></p>
<p class="mce-root">For example, when we have an outcome variable that is a categorical variable and our predictor is also a categorical variable, we can use a bar chart or a web plot. We can use either type of graph to help us understand how the machine learning model is making its predictions. The following table represents data and graph combinations:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td/>
<td>Categorical</td>
<td>Continuous</td>
</tr>
<tr>
<td><span>Cat</span><span>egorical</span></td>
<td>Bar chart/web plot</td>
<td>Histogram</td>
</tr>
<tr>
<td><span>Continuous</span></td>
<td>Histogram</td>
<td>Scatter plot</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">As we can see from the preceding table, when we have a categorical outcome variable but we have a continuous predictor, we might have to use a histogram. A histogram can help us to visually understand what's going on behind those predictions.</p>
<p class="mce-root">Now let's look into some other possibilities. Let's say that our outcome variable is actually a continuous variable but we had a categorical predictor, so here we could use a histogram. And finally, when we have an outcome variable that's a continuous variable and a predictor variable that's also a continuous variable, we can end up using a scatter plot. We will see examples related to this in the upcoming sections.</p>
<p class="mce-root">In the previous section, we built a neural net model. Let's take a look at the model that we built:</p>
<ol>
<li class="mce-root">Let's use the model that we created in the previous chapter:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-748 image-border" src="assets/ace85d6f-43c5-4430-ba79-7edfb2be01dd.png" style="width:45.75em;height:35.17em;"/></p>
<ol start="2">
<li class="mce-root">Set the <strong>Random seed</strong> as <kbd>5000</kbd> and then run the model</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-111 image-border" src="assets/d75bd06e-c904-4d49-9d6e-89e232148112.png" style="width:41.50em;height:43.50em;"/></p>
<ol start="3">
<li class="mce-root">Click on the newly generated model and in the observations, we can see that the <strong>Premier</strong> variable is the most important predictor, followed by <strong>Years_as_customer</strong>, and then <strong>Stereos</strong>, <strong>TVs</strong>, and so forth:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-113 image-border" src="assets/7deb3710-1ec3-4d43-bde2-f7af05214c83.png" style="width:98.42em;height:58.83em;"/></p>
<p class="mce-root CDPAlignLeft CDPAlign" style="padding-left: 60px">Now we know the most important predictors in this model, but we don't know how these predictors are being used by the model. Therefore, we will investigate their relationships.</p>
<p class="mce-root" style="padding-left: 60px">There are several ways in which we can know about the relationships between components of the model. We can use graphs or tables. Let's go through a few examples:</p>
<ol start="4">
<li>Select the <strong>Record Ops</strong> palette.</li>
<li class="mce-root">Connect the generated model over to a <strong>Select</strong> node.</li>
<li class="mce-root">Let's look at the data for the training dataset. We will keep the testing dataset separate because we will use that data later to confirm the findings.</li>
<li class="mce-root">Click on the <strong>Select</strong> node to edit it.</li>
</ol>
<ol start="8">
<li class="mce-root">Click on the <strong>Expression Builder</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-107 image-border" src="assets/5379eaa3-6a30-4fb9-acca-d1a5366c52e7.png" style="width:35.00em;height:22.33em;"/></p>
<ol start="9">
<li class="mce-root">Select any variable. For example, the <strong>Partition</strong> variable, select <kbd>=</kbd><span>,</span> and the training dataset<span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-120 image-border" src="assets/19d44971-564c-4ede-87d2-3badd083fd91.png" style="width:37.58em;height:25.25em;"/></p>
<ol start="10">
<li class="mce-root">This is how a expression will look also, c<span>lick on </span><strong>OK</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-747 image-border" src="assets/74a8d25b-c3b2-476b-b2d8-ecc34b682b4f.png" style="width:32.83em;height:23.42em;"/></p>
<p style="padding-left: 60px">We have selected only the people in the training dataset. Now, let's take a look at the relationships between the actual predictions and the important variables in this model to figure out exactly how these variables are used by the model:</p>
<ol start="11">
<li>Go to the <strong>Graphs</strong> palette and connect the <strong>Select</strong> <span>node to a</span> <strong>Distribution</strong> <span>node. T</span>he <strong>Distribution</strong> node is basically a bar chart, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-538 image-border" src="assets/03810d88-a27c-409d-969b-392b685fbc94.png" style="width:49.67em;height:38.08em;"/></p>
<ol start="12">
<li class="mce-root">Edit the <strong>Distribution</strong> node. Select the <strong>Premier</strong> field:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-749 image-border" src="assets/b3f6f409-af05-4844-b683-0e770a96d140.png" style="width:33.25em;height:24.00em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">N<span>otice that only categorical fields are available here:<br/></span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-130 image-border" src="assets/2fe1d30b-d52b-40d1-84fb-7cb5913fc814.png" style="width:32.42em;height:31.42em;"/></p>
<p class="mce-root" style="padding-left: 60px"><span>We are selecting the <strong>Premier</strong> variable because that was the most important predictor in the model and we will see how that variable is used in its predictions:</span></p>
<ol start="13">
<li class="mce-root">Click on the overlay button:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-131 image-border" src="assets/f84d9025-c7df-408a-8e71-212f7601c785.png" style="width:43.33em;height:31.08em;"/></p>
<ol start="14">
<li>Select the variable <strong>$N-Status</strong>, which is our actual prediction<span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-132 image-border" src="assets/db07a940-746f-4b4d-9e47-ab7aaf53bc64.png" style="width:25.75em;height:25.00em;"/></p>
<ol start="15">
<li>To make comparisons a little easier,  click <span>on normalize by <strong>Color</strong>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-133 image-border" src="assets/05546d69-e6a5-4ccf-9c1a-c697b7895297.png" style="width:25.67em;height:25.00em;"/></p>
<p class="mce-root"/>
<ol start="16">
<li class="mce-root">Click on <strong>Run</strong> and you <span>can see what was done here:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-750 image-border" src="assets/f9fe6071-51fb-491b-bf7b-f6d6b78b9c17.png" style="width:37.25em;height:24.00em;"/></p>
<p class="CDPAlignLeft CDPAlign">Notice that the blue color is associated with those who were predicted as going to churn, and the red color is associated with people who were predicted as current customers. You can also see that the people that are <strong>Premier</strong> customers we are associating them with being a current customer. The people that are not <strong>Premier</strong> customers we are associating them with the blue color which means that we're predicting that they're going to churn.</p>
<p class="mce-root"><span>So that's how you investigate the relationship between a categorical predictor and a categorical outcome variable. We could use something similar to a bar chart, in this case, it's called the <strong>Distribution</strong> node in Modeler; it would be called as a <strong>bar chart</strong> in other software packages, but you're looking at the relationship between these two categorical variables and now you can see what's going on with these relationships. Let's use a <strong>Web</strong> node to look at the relationship between the two categorical variables:</span></p>
<ol>
<li class="mce-root"><span>Go down to the <strong>Graphs</strong> palette and connect the <strong>Select</strong> node to the <strong>Web</strong> node:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-541 image-border" src="assets/7650b517-b61e-4705-bdb8-d9d6274dc870.png" style="width:106.83em;height:82.58em;"/></p>
<ol start="2">
<li class="mce-root">Edit the <strong>Web</strong> node, you can either build this as a <strong>Web</strong>, which basically allows us to take a lot of categorical variables and put them all together, or<span> we</span><span> can create a <strong>Directed web</strong> so that all the categorical variables in those categories are all directed towards one specific variable, which is what we are going to do here. </span><span>C</span>hoose the <span><strong>Directed web</strong>.</span></li>
</ol>
<ol start="3">
<li class="mce-root">Click on the field box</li>
<li class="mce-root">Add your prediction, which is the <strong>$N-Status</strong> variable, add all other categorical variables:<br/></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/05421b68-1d48-4fa0-9860-2fd00d078154.png" style="width:32.75em;height:30.50em;"/></p>
<ol start="5">
<li class="mce-root">The following screenshot shows all the selected flag fields:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-751 image-border" src="assets/4e0ada63-0cca-47b9-a93b-129a61dc6d8e.png" style="width:33.17em;height:30.75em;"/></p>
<ol start="6">
<li class="mce-root">Add other categorical fields. Select <strong>Payment_Method</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-158 image-border" src="assets/7ccd57b6-492d-4893-b9a9-418f6f6e522c.png" style="width:34.33em;height:32.75em;"/></p>
<ol start="7">
<li class="mce-root">Hold <span>the <em>Ctrl</em></span> <span>key and scroll down a<strong>n</strong>d</span><span> select <strong>TV_Categories </strong> and<strong> </strong>c</span>lick on<span> </span><strong>OK</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-752 image-border" src="assets/7b65d60b-36dd-475c-96fd-32e743ebe4bc.png" style="width:34.25em;height:32.00em;"/></p>
<ol start="8">
<li class="mce-root">Set the <strong>Line values</strong><strong> </strong>to <strong>Absolute</strong>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-161 image-border" src="assets/37d7d523-7bdf-4d8d-8b7f-0bb3be31b813.png" style="width:34.50em;height:32.67em;"/></p>
<ol start="9">
<li class="mce-root">Set <strong>Line values are</strong> to <strong>Percentages of "From" the field/value</strong>. From these <strong>Predictor</strong> fields, we will see how these values are related to the <strong>Outcome</strong> field and click on Run:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-162 image-border" src="assets/e5cdafc9-a707-49d9-9588-19686e6c6aef.png" style="width:33.08em;height:31.17em;"/></p>
<p class="mce-root"><span>Notice that there are two lines that are a little thicker than the others:</span></p>
<p class="mce-root CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-546 image-border" src="assets/c2497460-486d-47cb-98db-ac512e537950.png" style="width:106.75em;height:82.17em;"/><br/></span></p>
<p class="mce-root"><span>You can see that one of the line values says <strong>Yes. </strong></span><span>The other line value says <strong>No</strong> and they're both related to the field current and churned as we can see in the following output</span></p>
<p class="mce-root"><span>Let's take a look at the thickest <strong>Yes</strong> line:</span></p>
<p class="mce-root CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-547 image-border" src="assets/12acc62c-ef3f-4c29-b018-27907bed616d.png" style="width:106.33em;height:81.50em;"/><br/></span></p>
<p class="mce-root"><span>We can see that this line is showing us that these are people that on the <strong>Premier</strong> variable had a value of <strong>Yes</strong> and the prediction is associated with being a current customer and then we can see that <strong>87%</strong> of the people that are predicted to be current customers they had a value of <strong>Yes</strong> on the variable <strong>Premier</strong>.</span></p>
<p class="mce-root"><span>Similarly, the next thickest line would be the one where we're on the <strong>Premier</strong> variable. We  have a value of no and that's associated with churning and that value ended up being <strong>80%</strong>:</span></p>
<ol>
<li class="mce-root"><span>Here is another way we can look at the relationship between a categorical <strong>Predictor</strong> and a categorical <strong>Outcome</strong> variable. The strongest relationship is between the <strong>Premier</strong> variable and the <strong>Outcome</strong> variable:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-548 image-border" src="assets/eecf6620-93cc-4056-8b46-fbe0f5dbb005.png" style="width:106.33em;height:82.00em;"/><br/></span></p>
<ol start="2">
<li class="mce-root">Let's look at the relationship between a continuous <strong>Predictor</strong> and a categorical <strong>Outcome</strong> variable. To do that, we are going to go down to the <strong>Graphs</strong> palette and connect the <strong>Select</strong> node to a histogram:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-549 image-border" src="assets/944c65a6-d974-4a69-92d5-2e3a86d3b73c.png" style="width:107.00em;height:82.25em;"/></p>
<ol start="3">
<li class="mce-root">Edit the <strong>Histogram, </strong>In the field box, select the <strong>TVs</strong> field . Choose the <strong>TVs</strong> field because this is one of the most important predictors in the mode:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-753 image-border" src="assets/3104d599-9931-4d18-b36b-95a74b5761d6.png" style="width:30.33em;height:31.25em;"/></p>
<ol start="4">
<li class="mce-root">In the overlay color box, enter the prediction, which is the variable <strong>$N-Status</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-185 image-border" src="assets/bca016b3-6698-477f-80e1-6d24889ef98f.png" style="width:29.67em;height:31.17em;"/></p>
<ol start="5">
<li class="mce-root">Go to the <strong>Options</strong> tab and click on <strong>Normalize by color</strong> to make your comparisons a little easier  and click on<span> </span><strong>Run</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-754 image-border" src="assets/ce3989bc-8a7f-4e6b-ac13-93860f5646e5.png" style="width:30.50em;height:23.33em;"/></p>
<ol start="6">
<li class="CDPAlignLeft CDPAlign">We will see the following results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-553 image-border" src="assets/ebffd7c0-7652-4ca6-bd37-5ff44fb0a4cf.png" style="width:106.67em;height:82.50em;"/></p>
<p class="CDPAlignLeft CDPAlign">We can see tha<span>t</span><span> the blue color is associated with those customers that we predicted we were going to lose. </span>The red color is associated with those customers that we predicted we were going to keep. Notice that the people who bought fewer <strong>TVs</strong> we are predicting about 50%; basically that we're going to end up keeping these customers. As customers are buying more <strong>TVs</strong><span>, we're</span> predicting <span>that we're going to lose these customers. </span>So that's how this variable is being used by the model, the model is depicting that if you're not buying many <strong>TVs</strong> <span>there's</span> about <span>an equal chance that we're going to keep or lose you as a customer, but if you're buying a lot of</span> <strong>TVs</strong> <span>then we think that we're more likely to lose you as a customer.</span></p>
<p class="mce-root"><span>In this example, we're going to look at the relationship between two continuous variables:</span></p>
<p class="mce-root"><span>Let's work with a different dataset. Bring in the <strong>Var. File</strong> node:</span></p>
<ol start="1">
<li class="mce-root">Edit this node and link it up to a dataset. Navigate to where our dataset, <span><kbd>Bank_Data</kbd> </span> is located Select the <span> file:</span></li>
<li class="mce-root">Open the dataset. It's a comma-delimited file, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-200 image-border" src="assets/320860bf-32ef-4958-980f-3bd08d314875.png" style="width:37.50em;height:41.33em;"/></p>
<p class="mce-root"/>
<ol start="3">
<li class="mce-root">Go to the <strong>Types</strong> tab and c<span>lick on </span><strong>Read Values</strong><span> and then select </span><strong>OK. You will see your variables</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-755 image-border" src="assets/0cf6fa21-d744-42be-8e50-73c3db52e89b.png" style="width:36.67em;height:28.33em;"/></p>
<p style="padding-left: 60px"><kbd>salnow</kbd> is our dependent variable. Hence make sure that it is a target variable. IF it isn't, then change its role to target. Set the role of <strong>id</strong> to <strong>None</strong>. All the other variables are going to be predictors for the current salary variable. Click on <strong>OK</strong></p>
<ol start="4">
<li class="mce-root">Let's look at the relationship between our outcome variable, which happens to be a continuous variable, and another continuous variable, which is a predictor. Go to the <strong>Graphs</strong> palette and connect the  source node to the <strong>Plot</strong> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-559 image-border" src="assets/a66cff6a-90f6-420c-b290-7c9afbed4969.png" style="width:56.83em;height:43.67em;"/></p>
<p style="padding-left: 60px">The <strong>Plot</strong> node will allow us create a scatter plot. So, let's edit the <strong>Plot</strong> node.</p>
<ol start="5">
<li class="mce-root">In the <strong>X field</strong> box, we will input our predictor and here we will add the education level, which is the number of years of education that a person has and i<span>n the </span><strong>Y field</strong><span> box, we will add our outcome variable which is </span><strong>salnow</strong><span>, that is, the current salary</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-756 image-border" src="assets/e26d20d2-6c11-4414-88b7-c6442a65c1ec.png" style="width:32.42em;height:26.00em;"/></p>
<p class="mce-root"/>
<ol start="6">
<li class="mce-root">Click on <strong>Run</strong> and we get the following graph as the result:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-563 image-border" src="assets/a43673c6-9549-4047-ba95-ccc08b0f1d8e.png" style="width:106.75em;height:81.83em;"/></p>
<p class="mce-root"><span>You can see that as the number of years of education increases, the current salary increases too. We have a positive linear relationship, which means that as one variable increases the other variable increases as well, so more education ends up leading to higher current salary, and less education is associated with a lower current salary.</span></p>
<p class="mce-root"><span>So, this is a way in which we can represent the relationship between two continuous variables. In the next section, we will see how to use statistical tests to interpret the results of a machine learning model.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using statistics to interpret machine learning models</h1>
                </header>
            
            <article>
                
<p>In this section, we will be using statistics to interpret the results of a machine learning model. We talked about graphs and how they allow us to see and interpret the predictions of a machine learning model, but we can also use those graph for statistical tests. Have a look at the following table:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td/>
<td>Categorical</td>
<td>Continuous</td>
</tr>
<tr>
<td>Categorical </td>
<td>Chi-square</td>
<td>ANOVA</td>
</tr>
<tr>
<td>Continuous</td>
<td><span>ANOVA</span></td>
<td>Correlation</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Let's say we had a categorical outcome variable and we had a categorical predictor, we could use the chi-square test. The chi-square test of Independence will allow us to look at the relationship between two categorical variables.</p>
<p>Also, if we have a categorical outcome variable and a continuous predictor, we can use ANOVA to analyze the variance. If we have two categories that we're comparing, we can have a t-test instead, which will allow us to interpret what's going on. On the other hand, if our outcome variable is a continuous variable and we have a categorical predictor, we can use ANOVA. We could also use logistic regression or discriminant analysis if we wanted. And finally, when both of our variables are continuous variables, we can use correlation or linear regression. Let's take a look at a few examples. We will outline some of these techniques so that we can understand what's going on, in terms of the inner workings of a machine learning model.</p>
<p>Let's take a look at how some tables can help clarify relationships between our variables and to see how these different predictors are used by a model.<br/>
Go to the <strong>Output</strong> palette and connect the Select node to a matrix node:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-564 image-border" src="assets/1462550a-ad25-4cde-a56c-0f1f53e8af9f.png" style="width:107.17em;height:82.08em;"/></p>
<p class="CDPAlignLeft CDPAlign">The <strong>Matrix</strong> node will allow us to do the chi-square test, which will help us to look at the relationship between two categorical variables. In this case, we're going to look at the relationship between a categorical predictor and a categorical outcome variable. Let's edit the <strong>Matrix</strong> node. In the <strong>Rows</strong> field, we will input our prediction, which is the <strong>$N-Status</strong> variable and in the<span> </span><strong>Columns</strong><span> </span>field, we will select the important predictor in the model, which will be the <strong>Premier</strong> variable:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-757 image-border" src="assets/d809c33d-232d-4524-bd83-023b0fc4f67f.png" style="width:33.08em;height:27.67em;"/></p>
<p class="CDPAlignCenter CDPAlign"/>
<p class="CDPAlignLeft CDPAlign">Go to the <strong>Appearance</strong> tab and select <span class="packt_screen">Percentage of columns</span>, which means we will get the column percentages and click on Run:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-758 image-border" src="assets/9060d4d0-c216-4a35-9886-4a7ab4f2c1ff.png" style="width:32.33em;height:26.92em;"/></p>
<p class="CDPAlignLeft CDPAlign">We will get the following result:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-759 image-border" src="assets/6fc16b3d-b158-4a04-a9a0-2adbed0c49ed.png" style="width:35.67em;height:24.33em;"/></p>
<p class="CDPAlignLeft CDPAlign">We actually have a <strong>Chi-square</strong> test that is statistically significant, so Premier is an important predictor in the model.</p>
<p>We also get some numerical information that is backing up what we have seen in our graphs previously . We can see that about <strong>80%</strong> of those people, the non-premier customers that  are associated with being with <strong>Churned</strong> and  about <strong>87%</strong> of the <strong>Premier</strong> customers that are associated with being a <strong>Current</strong> customer.</p>
<p>This is what the model has been doing. Now, we understand how at least one variable is used in the model.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding the relationship between a continuous predictor and a categorical outcome variable</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to look at the relationship between a continuous predictor and a categorical outcome variable. In order to do that, we can either run a t-test or ANOVA and which is also called the <strong>Means</strong> node in Modeler:</p>
<ol>
<li>Connect the <strong>Select</strong> node to the <strong>Means</strong> node from the output palette:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-568 image-border" src="assets/c6b40643-c1df-48fa-8bc2-c2a67280f8d7.png" style="width:106.67em;height:82.25em;"/></p>
<ol start="2">
<li>Edit the <strong>Me</strong><strong>ans</strong> node. In the <strong>Grouping field</strong> box, input the prediction, which is the <strong>$N-Status</strong> variable:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-569 image-border" src="assets/b9e21c33-b012-456f-a287-3e7b0d272a1c.png" style="width:41.83em;height:32.33em;"/></p>
<p class="mce-root"/>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px"><span>I</span><span>n the</span><span> </span><strong>Test field(s)</strong><span> box, select all of the continuous variables. Also, deselect the </span><span>actual confidence</span><span>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-760 image-border" src="assets/b2b12a23-f152-4a5f-9430-2c9229559bdf.png" style="width:32.00em;height:33.42em;"/></p>
<ol start="3">
<li>Click on <strong>OK</strong> and then click on <strong>Run</strong>. You will get the following output:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-761 image-border" src="assets/1e2ca582-9b5e-4e9b-b997-c04fab0ea67b.png" style="width:36.33em;height:40.42em;"/></p>
<p><span>We can see that most of the variables ended up differentiating between the prediction for churn and the prediction for being a current customer. There are some predictors that weren't important. For example, estimated revenue was not statistically significant and neither was the number of employees, but the rest of the predictors were very important.</span></p>
<p><span>Now, here we are seeing the <strong>Mean</strong>. But, let's try to find some more information. We'll change the <strong>View</strong> from <strong>Simple</strong> to Advanced and we will get the following results:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-573 image-border" src="assets/4d6b0afc-35b4-49e6-a4ce-539d038a564d.png" style="width:43.25em;height:51.33em;"/></p>
<p><span>As you can see, we have the same number of cases for each of these variables. The most important predictor ended up being the <strong>TVs</strong> variable, as we can see in the following screenshot, and that's the one that's able to differentiate these groups the most.</span></p>
<p><span>For example look at the TVs field, we can see that the current customers are the people who we predicted to churn and we thought we're going to lose these customer, on average they bought 2.4 <strong>TVs</strong></span>. <span>This prediction is significantly more than the people who were predicted to be going to stay as current customers which bought about one TV on average As we can see, we had a statistically significant result. </span><span>The opposite is true when it comes to <strong>Stereos</strong>. You can see that we have a statistically significant result, however you can see that the people that we'd predicted to lose as customers on average, bought <strong>13.2</strong> stereos, </span><span>whereas the people that we'd predicted were going to stay as customers on average bought <strong>16.2</strong> stereos</span></p>
<p class="CDPAlignLeft CDPAlign"><span><span>The last thing we're going to do is look at the relationship between two continuous variables. Earlier, we used the scatter plot to show the relationship between two continuous variables. Here, we're going to quantify that by calculating a correlation:</span></span></p>
<ol start="1">
<li class="CDPAlignLeft CDPAlign"><span>Using the bank dataset, go to the <strong>Output</strong> p</span><span>alette in</span> Modeler and connect the <strong>Statistics</strong> node to source node<span>:</span><span><br/></span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-574 image-border" src="assets/0e29a00d-c352-4886-b28f-e41d82f03f72.png" style="width:89.00em;height:78.42em;"/><br/></span></p>
<ol start="2">
<li>Edit the <strong>Statistics</strong> node, which allows us to get summary statistics in the examine box. Click on the fields option and select current salary:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-762 image-border" src="assets/5ea694a3-58bf-4799-bd66-2f40573711ee.png" style="width:33.67em;height:29.00em;"/></p>
<ol start="3">
<li>Click on <strong>OK</strong> and correlate current salary with the other continuous variables. Click on the arrow next to the correlate box and select the ruler icon, which will select all our continuous variables:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-264 image-border" src="assets/21cccea1-c7d4-4931-b42a-35e7999b72f2.png" style="width:29.92em;height:28.33em;"/></p>
<ol start="4">
<li>Hold down the <em>Ctrl</em> key and deselect <strong>id</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-265 image-border" src="assets/cb0907dd-66b3-4a27-a933-9990dd0daf5e.png" style="width:17.75em;height:17.25em;"/></p>
<ol start="5">
<li class="CDPAlignLeft CDPAlign">Click o<span>n <strong>OK</strong> and</span> <span>then click on <strong>Run.</strong></span> You will see the following result:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-763 image-border" src="assets/24736c99-0c7a-47e2-a4d4-551023155d51.png" style="width:32.92em;height:28.58em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px"><span>As we can see that the current salary correlates very highly with the starting salary:</span></p>
<p class="CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-576 image-border" src="assets/73d70395-047f-4591-84fe-068e7573196e.png" style="width:37.17em;height:32.33em;"/><br/></span></p>
<p class="CDPAlignLeft CDPAlign"><span>Remember that correlation values can range anywhere from -1 to +1. The farther away the value is from zero, the stronger the relationship. If the correlation coefficients are positive, this means that as the value of one variable increases, the value of the other variable increases. If the correlation coefficients are negative, this means that as the value of one variable increases, the value of the other variable decreases.</span></p>
<p class="CDPAlignLeft CDPAlign"><span>Notice that the correlation between beginning salary and current salary is very high, almost 0.9. You can also see that the correlation between education law and current salary is also very high, at 0.66.</span></p>
<p class="CDPAlignLeft CDPAlign"><span>On the other hand, you can see that the correlation between the amount of time that someone has worked at this particular job and also the correlation of the number of months that someone has been employed before they have this current job, those variables don't really correlate with current salary. Notice that the correlation values are actually pretty close to zero.</span></p>
<p class="CDPAlignLeft CDPAlign"><span>This gives us an indication of the types of relationships that you have and it allows us to quantify those relationships. In the next section, we are going to see how to use decision trees to interpret the results of a machine learning model.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using decision trees to interpret machine learning models</h1>
                </header>
            
            <article>
                
<p>In this section, we're going to take the predictions from a machine learning model, and use those predictions as our outcome variables. Then we will use the original predictors to understand what's going on, that is, the logic behind the machine learning model.</p>
<p>Previously, we saw that we could use different graphs and tables to figure out how to look at relationships between just one variable, one predictor and how it relates to an outcome variable, which is useful and important information to have. But generally, a model uses many variables at the same time. Hence looking at one predictor is useful, but it doesn't exactly give us a complete picture.</p>
<p>Another technique would be to use a decision tree model to help us understand the logic behind a neural net model, or any kind of machine learning model.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Here, we will be taking our predictions from the model and use that prediction as our outcome variable. Then, we will start with our predictions based on the predictors that the model used:</p>
<ol>
<li>Go to the <strong>Field Ops</strong> palette and connect the generated model to the <strong>Type</strong> node:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-577 image-border" src="assets/6eef4cd8-883f-4b6b-a263-1b193146b35b.png" style="width:106.75em;height:82.00em;"/></p>
<ol start="2">
<li>Edit the <strong>Type</strong> node and change the role of the original outcome of the <strong>Status</strong> variable. It won't be <strong>Target</strong> anymore since we are going to change its role to <strong>None</strong>. Hence, it won't be included in the model that we are going to build:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-765 image-border" src="assets/6b0a7c18-a4c9-4329-a455-f807d3e4522c.png" style="width:37.58em;height:25.83em;"/></p>
<ol start="3">
<li>Scroll down a little bit. Here, the <strong>$N-Status</strong> prediction is no longer just a prediction or the input; in fact, it will be the <strong>Target</strong> itself. And that's what we are going to predict:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/930c3796-c0fa-4e9f-b38b-9df8388d6046.png" style="width:37.25em;height:25.50em;"/></p>
<p style="padding-left: 60px">Here, we are trying to get inside the head of a neural net model (or any kind of machine learning model). Take a look at the model's predictions, and use the variables that it used to try to figure out the logic.</p>
<ol start="4">
<li>Remove the confidence value from that prediction since it's not needed. Change its role to <strong>None</strong> and click on <strong>OK</strong>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-766 image-border" src="assets/d47ff2d2-b619-47d8-8497-ce0e90cb204d.png" style="width:38.83em;height:26.42em;"/></p>
<p>At this point, we have to use another model to understand what happened during the predictions of a machine learning model. We could use a statistical model. But the statistical models have a lot of requirements and assumptions of the data. Also, they can't handle complex interactions and nonlinear relationships very well.</p>
<p>A decision tree model is probably going to do the best job in terms of trying to replicate what the neural net model did:</p>
<ol>
<li>Go to the <strong>Modeling</strong> palette and choose a decision tree model to understand what's going on behind the <strong>Neural Net</strong> model. Connect the <strong>Type</strong> node to <strong>C&amp;R</strong> Tree model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-581 image-border" src="assets/61ecb72e-8e4e-4fdc-8651-e206b64b0e9b.png" style="width:106.50em;height:82.00em;"/></p>
<p class="CDPAlignLeft CDPAlign" style="padding-left: 60px">We will be predicting the prediction from the <strong>Neural Net</strong> model.</p>
<ol start="2">
<li>When you edit that model, you will be using all of the predictors that the <strong>Neural Net</strong> model used initially to understand what's going on behind those predictions:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-767 image-border" src="assets/32156349-b83f-46a0-b99e-6e7245ea3686.png" style="width:62.17em;height:52.75em;"/></p>
<ol start="3">
<li>Click on <strong>Run</strong>, and have a look at the generated model:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-583 image-border" src="assets/fb41c0d9-8175-4917-9f2c-7b24d0b190ca.png" style="width:106.58em;height:82.08em;"/></p>
<ol start="4">
<li>We will get the following results:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-768 image-border" src="assets/995ffe41-ac9d-4a6d-8c2d-93c0ec5a1f49.png" style="width:98.08em;height:66.92em;"/></p>
<p style="padding-left: 60px">Notice that the <strong>C&amp;R</strong> model also thinks that the <strong>Premier</strong> variable is the most important predictor in the model. The <strong>C&amp;R</strong> model has a lot of same predictors that the neural net model had as the most important predictors. That is important because we want to make sure that we understand the logic of the neural net model (or any machine learning model).</p>
<p class="mce-root"/>
<ol start="5">
<li> Click on the <strong>All</strong> button.</li>
<li>Click on the <strong>%</strong> button and we can see some numbers behind these predictions:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-769 image-border" src="assets/1bb8e074-b27d-41d7-94a7-42d56fd26147.png" style="width:98.00em;height:66.83em;"/></p>
<p>We aren't interested in predicting our outcome variable, <strong>Status</strong> here. Instead, we're trying to understand the reasoning behind the predictions of the neural net model.</p>
<p>Here, you can see that we're using multiple variables. Have a look at the preceding screenshot. The first rule says that if the variable is <strong>Premier</strong>, you had a value of <strong>NO</strong> and you have been a customer of ours for less than or equal to four and a half years, and you bought less than or equal to one and a half TVs, and you bought less than or equal to ten point five speakers, we're predicting that we're going to lose you as a customer. That rule applied to 41 people and the confidence in that rule is about 81%. On the other hand, if all of that same criteria is applied, so that you're still a non-premier customer, you haven't been with us that long as a customer, you've bought very few TVs but you bought more than 10.5 speakers, we're predicting that you're going to be a current customer. That rule applied to 127 people, and the confidence in that rule is 88%.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Now we try to understand the logic as to what potentially the neural net model was doing. It's not exactly the same as what the neural net model did, because the algorithms for a neural net model and a decision tree model are very different. We were just trying to understand the logic behind a neural net model. In this case, we had a whole set of criteria, and it ended up allowing us to use or view the relationship between multiple variables simultaneously and how they end up impacting the prediction. This is just another tool you can use to try to understand what's going on behind the predictions of a machine learning model. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we started off by looking at different types of prediction models. Then we used these models to interpret the machine learning models.</p>
<p><span>In the next chapter, we will explore different ways that we can improve individual models.</span></p>


            </article>

            
        </section>
    </body></html>