- en: Importing Data into Excel from Different Data Sources
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从不同的数据源将数据导入Excel
- en: Serious data analysis and machine learning cannot be done by using hand-typed
    data. Data sources come in different flavors and sizes, and Excel can handle many
    of them. This chapter deals with how to import data from different sources, which
    is the first step of any analysis.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 严肃的数据分析和机器学习不能仅通过手工输入数据来完成。数据源有不同的风味和大小，Excel可以处理其中许多。本章将讨论如何从不同的来源导入数据，这是任何分析的第一步。
- en: Get & Transform (known as **Power Query** in Excel versions before 2016) is
    a powerful tool that you can use to load data from different sources and transform
    it. These transformations are necessary so that you have a clean data sample that
    you can then use to train and test any machine learning model.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Get & Transform（在Excel 2016之前的版本中称为**Power Query**）是一个强大的工具，您可以使用它从不同的来源加载数据并进行转换。这些转换是必要的，以便您有一个干净的数据样本，然后可以使用它来训练和测试任何机器学习模型。
- en: If you are running Excel 2010 SP1 or Excel 2013, you need to download and install
    Power Query. Refer link [https://www.microsoft.com/en-us/download/details.aspx?id=39379](https://www.microsoft.com/en-us/download/details.aspx?id=39379) for
    instructions on how to install it.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在运行Excel 2010 SP1或Excel 2013，您需要下载并安装Power Query。有关安装说明，请参阅链接[https://www.microsoft.com/en-us/download/details.aspx?id=39379](https://www.microsoft.com/en-us/download/details.aspx?id=39379)。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Importing data from a text file
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从文本文件导入数据
- en: Importing data from another Excel workbook
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从另一个Excel工作簿导入数据
- en: Importing data from a web page
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从网页导入数据
- en: Importing data from Facebook
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Facebook导入数据
- en: Importing data from a JSON file
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从JSON文件导入数据
- en: Importing data from a database
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从数据库导入数据
- en: Technical requirements
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will need to download the `homes.csv`, `homes.txt`, `titanic.xls`, and `azure_text_analytics.json`
    files from this book's GitHub repository at [https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要从本书的GitHub仓库下载`homes.csv`、`homes.txt`、`titanic.xls`和`azure_text_analytics.json`文件，该仓库地址为[https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03)。
- en: Importing data from a text file
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从文本文件导入数据
- en: 'The more commonly used data text file is **comma-separated values** (**CSV**).
    As the name suggests, values are written to the file in rows and, for each row,
    a comma separates the values belonging to each column. Open a new workbook and
    follow these steps:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 最常用的数据文本文件是**逗号分隔值**（**CSV**）。正如其名所示，值按行写入文件，并且对于每一行，逗号分隔了属于每一列的值。打开一个新的工作簿，按照以下步骤操作：
- en: Click on Data.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”。
- en: 'Navigate to *Get Data* | *From File* | *From Text/CSV*:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“获取数据”|“从文件”|“从文本/CSV”：
- en: '![](img/eb58bb3b-d5b6-4c78-b103-029ef1de0c6d.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eb58bb3b-d5b6-4c78-b103-029ef1de0c6d.png)'
- en: Navigate to the file's location and open the `homes.csv` file.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到文件的存储位置并打开`homes.csv`文件。
- en: 'A window will pop up, showing you a preview of the file''s contents, as shown
    in the following screenshot:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将弹出一个窗口，显示文件内容的预览，如下面的截图所示：
- en: '![](img/edb7f2e3-2a95-4597-95d5-c45faa205359.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/edb7f2e3-2a95-4597-95d5-c45faa205359.png)'
- en: We can see that Excel correctly identifies the different columns by using the
    right delimiter (comma). It also tries to detect the data types automatically.
    There is a small problem, though. This file is not pure CSV, and has an extra
    line at the beginning, showing us where it was downloaded from originally. This
    is good for giving credit to the original author, but it confuses the loading
    process a bit. Fortunately, this situation has already been taken into account.
    To solve this issue, click on Edit.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，Excel通过使用正确的分隔符（逗号）正确地识别了不同的列。它还尝试自动检测数据类型。不过，这里有一个小问题。这个文件不是纯CSV格式，开头多了一行，显示了它最初是从哪里下载的。这对于给原作者致谢是好的，但它会稍微混淆加载过程。幸运的是，这种情况已经被考虑到了。要解决这个问题，请点击“编辑”。
- en: 'A window will pop up, containing many options to deal with these file format
    differences:'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将弹出一个窗口，包含许多处理这些文件格式差异的选项：
- en: '![](img/b1afec1d-0bd1-4d9b-96ed-9c227c325305.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b1afec1d-0bd1-4d9b-96ed-9c227c325305.png)'
- en: Navigate to *Remove Rows* | *Remove Top Rows.*
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“删除行”|“删除顶部行”。
- en: 'You will see the option to specify how many rows you want to skip. In this
    file, we need to skip `2` rows, as shown in the following screenshot:'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将看到指定要跳过多少行的选项。在这个文件中，我们需要跳过`2`行，如下面的截图所示：
- en: '![](img/8c5578ea-90b1-41bd-a4aa-2c3ccc70518a.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/8c5578ea-90b1-41bd-a4aa-2c3ccc70518a.png)'
- en: After removing the rows, we keep only the data of interest. You will notice
    that the file headers haven't been used as column names yet, which would be ideal.
    To correct this, click on Use First Row as Headers.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在移除行之后，我们只保留感兴趣的数据。你会注意到文件标题尚未用作列名，这将是理想的。为了纠正这一点，点击使用第一行作为标题。
- en: 'The result of this is shown in the following screenshot:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如下截图所示，这是结果：
- en: '![](img/d449e040-48f3-4695-9631-a81a67694a77.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/d449e040-48f3-4695-9631-a81a67694a77.png)'
- en: Note that a list of the steps have been applied to the input data, to the right
    of the table. This allows you to undo any of your actions and is useful to keep
    track of what you have done, especially if you make more complicated transformations,
    like the ones we will show you in the next chapter.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，步骤列表已经应用于输入数据，位于表格的右侧。这允许你撤销任何操作，并且有助于跟踪你所做的一切，尤其是当你进行更复杂的转换时，比如我们在下一章将要展示给你的那些。
- en: 'The process is almost ready, except for the data type of each column. Originally,
    it was set automatically to text, since the first two rows, that we skipped later,
    were evaluated as not containing numerical data. There are two types of columns:
    `Acres` shows decimal numbers, while the rest show integer or whole numbers. To
    define the data type correctly, perform the following steps:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 过程几乎准备好了，除了每列的数据类型。最初，它被自动设置为文本，因为我们跳过的前两行后来被评估为不包含数值数据。有两种类型的列：`Acres`显示十进制数，而其余的显示整数或整个数字。为了正确定义数据类型，执行以下步骤：
- en: Select `Acres`.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“Acres”。
- en: Navigate to Data Type in the Transform menu.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到转换菜单中的数据类型。
- en: Change the type to Decimal Number.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将类型更改为十进制数。
- en: Select the rest of the columns and change the type to Whole Number to fix the
    other columns.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择其余的列，并将类型更改为整数以修复其他列。
- en: 'Finally, click on Close & Load. You will see the following data table:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，点击关闭并加载。你会看到以下数据表：
- en: '![](img/131c346e-4fa7-4e7e-975b-e64425ec56e6.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/131c346e-4fa7-4e7e-975b-e64425ec56e6.png)'
- en: This table looks like any Excel table, except that we can always double-click
    on the query (called `homes`) and perform more transformations or even undo the
    ones we've already made.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这个表格看起来像任何Excel表格，除了我们总是可以双击查询（称为`homes`）并执行更多转换，甚至撤销我们已做的转换。
- en: 'If the file is not a CSV file but just a text file that''s using a different
    separator, we can still load it using a similar procedure. We just repeat the
    steps we used for importing the CSV file:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果文件不是CSV文件，而是一个使用不同分隔符的文本文件，我们仍然可以使用类似的程序来加载它。我们只需重复用于导入CSV文件的步骤：
- en: Click on Data.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击数据。
- en: Navigate to *Get Data* | *From File* | *From Text/CSV*.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“获取数据”|“从文件”|“从文本/CSV”。
- en: 'Navigate to the file''s location and open `homes.txt`. You will see the following
    preview:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到文件的存储位置并打开`homes.txt`。你会看到以下预览：
- en: '![](img/5b5137bb-b29e-4760-b079-5ba582fcf643.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/5b5137bb-b29e-4760-b079-5ba582fcf643.png)'
- en: In this case, there are no extra lines at the beginning, but we can see that
    Excel fails to identify the column delimiter, which is the `|` character. To fix
    this, select Custom from the drop-down menu.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，开头没有多余的行，但我们可以看到Excel未能识别列分隔符，即`|`字符。为了修复这个问题，从下拉菜单中选择自定义。
- en: Type `|`.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`|`。
- en: 'The result is that the data is now correctly separated into columns. The columns
    are automatically labeled using the file header and the data types are guessed
    correctly, as shown in the following screenshot:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 结果是数据现在已经被正确地分隔成列。列自动使用文件标题进行标记，并且数据类型被正确猜测，如下面的截图所示：
- en: '![](img/11f958ce-f023-41e2-bfcd-a88d99942510.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/11f958ce-f023-41e2-bfcd-a88d99942510.png)'
- en: The final result is a table that is identical to the one we loaded from `homes.csv`,
    but that took less steps to obtain since the file structure was simpler.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 最终结果是表格与我们从`homes.csv`加载的表格相同，但获得它所需的步骤更少，因为文件结构更简单。
- en: In this section, we have learned how to import a text file into Excel, which
    is the simplest case. Let's continue with some more complex examples.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们学习了如何将文本文件导入Excel，这是最简单的情况。让我们继续一些更复杂的例子。
- en: Importing data from another Excel workbook
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从另一个Excel工作簿导入数据
- en: Why would we import data from an Excel workbook if we can just open it? The
    main reason is to take advantage of the transformations we can do using Get &
    Transform. We will show this by using a file containing real data from the Titanic
    passengers, which is often used to test machine learning classification models
    and predict whether a given passenger survived the tragedy or not.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么我们还要从 Excel 工作簿导入数据，如果我们可以直接打开它呢？主要原因是想利用 Get & Transform 可以进行的转换。我们将通过使用包含泰坦尼克号乘客真实数据的文件来展示这一点，这个文件常被用来测试机器学习分类模型，并预测某个乘客是否在悲剧中幸存。
- en: 'Let''s follow some simple steps to load and transform the data. While in a
    new workbook, follow these steps:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们遵循一些简单的步骤来加载数据并进行转换。在新的工作簿中，请按照以下步骤操作：
- en: Click on Data.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”。
- en: 'Navigate to Get Data | From File | From Workbook, as shown in the following
    screenshot:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“获取数据 | 从文件 | 从工作簿”，如下面的截图所示：
- en: '![](img/823c4c39-81d8-4aeb-83ac-3f3bb56182fd.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/823c4c39-81d8-4aeb-83ac-3f3bb56182fd.png)'
- en: 'The preview window is slightly different to the one we see when opening a CSV
    file, as you can see in the following screenshot:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 预览窗口与我们打开 CSV 文件时看到的略有不同，如下面的截图所示：
- en: '![](img/7c7c2b86-db46-4c7b-b4e0-555415581841.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/7c7c2b86-db46-4c7b-b4e0-555415581841.png)'
- en: In the left part of the preview, you can see a folder named `titanic.xls`, which
    represents the file, and below that the worksheets contained within. `Dictionary`
    is just a short description of the variables; the data is contained in the `Passenger
    data` sheet.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在预览的左侧，你可以看到一个名为 `titanic.xls` 的文件夹，它代表文件，下面是包含的工作表。`Dictionary` 只是变量的简短描述；数据包含在
    `Passenger data` 工作表中。
- en: 'When this item is selected, we will see a table containing the data. We can
    click on Load and put the data in our worksheet, but first we will try one of
    the transformations that we will discuss in detail in the next chapter. To do
    this, click on Edit and get to the Query Editor, as shown in the following screenshot:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 当选择此项目时，我们将看到一个包含数据的表格。我们可以点击“加载”并将数据放入我们的工作表中，但在尝试我们将在下一章详细讨论的转换之前，我们将先尝试一下。为此，点击“编辑”并进入查询编辑器，如下面的截图所示：
- en: '![](img/2c4884bc-84a0-4af0-a556-672540e337a1.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/2c4884bc-84a0-4af0-a556-672540e337a1.png)'
- en: The columns are identified correctly and the names that are taken from the column
    names are placed in the input file. You can see that one of the columns, `cabin`,
    contains missing values, identified as `null`. This means that, for those passengers,
    there is no information about which cabin in the ship they where occupying. Some
    machine learning models do not accept empty values, so we need to fix this by
    selecting the column, as shown in the preceding screenshot.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 列被正确识别，并且从列名中提取的名称被放置在输入文件中。你可以看到其中一个列，`cabin`，包含缺失值，标记为 `null`。这意味着对于这些乘客，没有关于他们在船上哪个船舱的信息。一些机器学习模型不接受空值，因此我们需要通过选择该列，如前一个截图所示来修复这个问题。
- en: Click on Replace Values in the Transform menu.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在转换菜单中点击“替换值”。
- en: 'You will get a pop-up dialog where you can tell Excel to replace `null` with
    `Unknown`, as shown in the following screenshot:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将得到一个弹出对话框，你可以告诉 Excel 将 `null` 替换为 `Unknown`，如下面的截图所示：
- en: '![](img/1879af25-7f8b-4071-9fa1-1b0655d203fe.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1879af25-7f8b-4071-9fa1-1b0655d203fe.png)'
- en: 'The result is what you can see in the following screenshot, where all `null`
    values are replaced with `Unknown`. This is both more elegant and easier to manage
    by machine learning models:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如以下截图所示，所有 `null` 值都被替换为 `Unknown`。这对于机器学习模型来说既更优雅也更容易管理：
- en: '![](img/42f58f44-a39c-4bd1-9b1d-0e8c7ac28ace.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/42f58f44-a39c-4bd1-9b1d-0e8c7ac28ace.png)'
- en: Many different transformations can be performed on the data using the Query
    Editor. We will show other examples in the next chapter. You should try to test
    different options as well.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 使用查询编辑器可以对数据进行多种转换。我们将在下一章中展示其他示例。你应该尝试测试不同的选项。
- en: Importing data from a web page
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从网页导入数据
- en: 'If a web page contains data in tabular form, then Excel is able to import these
    tables automatically. As an example, we will import a table from the Wikipedia
    page about Excel. Here''s how we will go about it:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一个网页包含表格形式的数据，那么 Excel 能够自动导入这些表格。作为一个例子，我们将从关于 Excel 的维基百科页面导入一个表格。以下是我们的操作步骤：
- en: 'Click on Data and then navigate to Get Data | From Other Sources | From Web,
    as shown in the following screenshot:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”，然后导航到“获取数据 | 从其他来源 | 从网页”，如下面的截图所示：
- en: '![](img/a8546c95-ea93-49a9-9b78-7f8c86841c2e.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a8546c95-ea93-49a9-9b78-7f8c86841c2e.png)'
- en: 'In the dialog that pops up, we type in the URL of the mentioned web page and
    click OK, as shown in the following screenshot:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在弹出的对话框中，我们输入所提及网页的URL并点击确定，如下截图所示：
- en: '![](img/fa49887f-3868-48f3-8a26-7e5caaffcd9e.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/fa49887f-3868-48f3-8a26-7e5caaffcd9e.png)'
- en: 'Now, we will be able to see a list of available tables. Pick the one showing
    Excel''s release history. A table preview is shown to the right, as shown in the
    following screenshot:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将能够看到可用表格的列表。选择显示Excel发布历史的表格。右侧显示了表格预览，如下截图所示：
- en: '![](img/d11c8a9b-5c72-4f76-9fd2-bb5e3cf972c1.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/d11c8a9b-5c72-4f76-9fd2-bb5e3cf972c1.png)'
- en: As we did before, we can just load the data or edit it, transforming the values
    according to our needs. The final result is an Excel table.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 就像我们之前做的那样，我们只需加载数据或编辑它，根据我们的需求转换值。最终结果是Excel表格。
- en: We also have the choice of changing to web view and seeing the target web page
    as we would in Internet Explorer, which can help us to identify which information
    is useful for our analysis.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以选择切换到网页视图，就像在Internet Explorer中查看目标网页一样，这有助于我们确定哪些信息对我们的分析有用。
- en: 'We have seen how easy it is to import data from a web page. Now, let''s explore
    importing data from one of the most popular websites: Facebook.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到从网页导入数据是多么容易。现在，让我们探索从最受欢迎的网站之一：Facebook导入数据。
- en: Importing data from Facebook
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从Facebook导入数据
- en: 'It is possible to import data directly from a Facebook profile or page. If
    we want to, for example, register the dates and times when a new post appears,
    we could follow these steps:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 可以直接从Facebook个人资料或页面导入数据。如果我们想记录新帖子出现的时间和日期，例如，我们可以按照以下步骤操作：
- en: Click on Data.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”。
- en: 'Navigate to Get Data | From Online Services | From Facebook, as shown in the
    following screenshot:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到“获取数据”|“从在线服务”|“从Facebook”，如下截图所示：
- en: '![](img/dcbf16e2-ab85-4435-8142-547ee88c99cb.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/dcbf16e2-ab85-4435-8142-547ee88c99cb.png)'
- en: 'You need to specify the user or page name, which is the last part of the page
    URL. As an example, I will use my own Facebook page, which is the default option.
    The first time you connect, you will have to log in with your username and password
    (to connect to Facebook from Excel, you need a Facebook profile). The following
    dialog will appear:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要指定用户或页面名称，这是页面URL的最后部分。例如，我将使用我的Facebook页面，这是默认选项。第一次连接时，您将需要使用用户名和密码登录（要从Excel连接到Facebook，您需要一个Facebook个人资料）。以下对话框将出现：
- en: '![](img/30b7fa98-99c8-4c6f-a581-31ba568150b3.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/30b7fa98-99c8-4c6f-a581-31ba568150b3.png)'
- en: 'We will choose to get information about Posts. After clicking OK, we get the
    following screen (I will only show it partially, to protect my privacy):'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将选择获取帖子信息。点击确定后，我们得到以下屏幕（我将只展示部分，以保护我的隐私）：
- en: '![](img/723918d7-1940-431d-ad0b-930db25a8ecd.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/723918d7-1940-431d-ad0b-930db25a8ecd.png)'
- en: As we can see, the date and times of the posts are concatenated in a single
    column. To split this column, click on Edit.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如我们所见，帖子的时间和日期被合并在一个单独的列中。要拆分这个列，点击编辑。
- en: Select the column and then Split Column in the Query Editor.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择列，然后在查询编辑器中选择“拆分列”。
- en: 'In the dialog, specify that you want to split the column by the character,
    `T`, as shown in the following screenshot:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在对话框中，指定您想要通过字符“T”拆分列，如下截图所示：
- en: '![](img/b2a33581-9206-489b-87c4-12f9edba3b8e.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/b2a33581-9206-489b-87c4-12f9edba3b8e.png)'
- en: 'As a result, you get two new columns, one for the date and another one for
    the time, as shown in the following screenshot:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因此，你将得到两个新的列，一个用于日期，另一个用于时间，如下截图所示：
- en: '![](img/1b4af768-9c3d-4f2d-8b51-03a2f512aca6.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1b4af768-9c3d-4f2d-8b51-03a2f512aca6.png)'
- en: You have successfully extracted information from your Facebook page, which you
    can now use to analyze how often you are publishing, what type of content you
    are publishing, and other useful insights. This is especially useful if you are
    looking at a commercial profile, where you might want to adapt the content to
    improve the marketing of your service or product.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 您已成功从您的Facebook页面提取信息，您现在可以使用这些信息来分析您发布频率，发布的内容类型以及其他有用的见解。这对于查看商业个人资料尤其有用，您可能希望调整内容以提高您的服务或产品的营销。
- en: Importing data from a JSON file
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从JSON文件导入数据
- en: JSON is a standard format for sharing data, since it uses text fields that can
    be read by a human being. It is used by most web applications for data input and
    output.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: JSON是一种标准的数据共享格式，因为它使用人类可读的文本字段。它被大多数网络应用程序用于数据输入和输出。
- en: In our example, we will use the Azure Text Analytics API. Given a sentence,
    this service can identify the text sentiment and the language and extract keywords,
    among other things.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例中，我们将使用Azure文本分析API。给定一个句子，这项服务可以识别文本情感、语言并提取关键词等。
- en: 'The input sentence is `I had a wonderful trip to Seattle and enjoyed seeing
    the Space Needle!`. The API correctly identifies the language as English, extracts
    the main keywords, and tells us that the sentiment is positive (assigning a value
    larger than 0.5). All of this information is given in JSON format on the right-hand
    side of the window, and is available in the file we are going to import. The following
    screenshot has been extracted from the Azure Text Analytics demonstration page:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 输入句子为`我在西雅图度过了一次美妙的旅行，并享受了看到太空针塔的乐趣！`。API正确识别语言为英语，提取了主要关键词，并告诉我们情感是积极的（分配的值大于0.5）。所有这些信息都以JSON格式显示在窗口的右侧，并且可以在我们即将导入的文件中找到。以下截图是从Azure文本分析演示页面提取的：
- en: '![](img/62330292-4aed-4309-94d4-69cf7a29cb13.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/62330292-4aed-4309-94d4-69cf7a29cb13.png)'
- en: 'To load the input JSON file, follow these steps:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 要加载输入的JSON文件，请按照以下步骤操作：
- en: Click on Data.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”。
- en: 'Navigate to *Get Data* | *From File* | *From JSON*, as shown in the following
    screenshot:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到*获取数据 | 从文件 | 从JSON*，如下截图所示：
- en: '![](img/cd85bd52-fee7-46cc-a88d-7991b2ec5a90.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cd85bd52-fee7-46cc-a88d-7991b2ec5a90.png)'
- en: 'You will get a preview showing the main fields in the JSON structure, as shown
    in the following screenshot:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将获得一个预览，显示JSON结构中的主要字段，如下截图所示：
- en: '![](img/12e4f670-3066-4ce2-b3ca-877c6da637b3.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](img/12e4f670-3066-4ce2-b3ca-877c6da637b3.png)'
- en: 'Click on Into Table to convert the entries into regular Excel tables, as shown
    in the following screenshot:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“转换为表格”将条目转换为常规Excel表格，如下截图所示：
- en: '![](img/039be9fd-10b2-48c6-a988-6912ef3f4608.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](img/039be9fd-10b2-48c6-a988-6912ef3f4608.png)'
- en: The `Value` column is a special table column that contains nested values. To
    navigate to the desired variable, we need to click on the ![](img/02042345-fbc1-4ccc-971d-2912235403f2.png)
    symbol and repeat this operation in the columns that will successively appear.
    By doing, this we can, for example, get to the sentiment value, which is 0.97\.
    Once there are no more columns to expand, we can load the data and create a regular
    Excel table that contains all of the values in the JSON structure, which will
    be used for further analysis.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '`值`列是一个包含嵌套值的特殊表列。要导航到所需的变量，我们需要点击![](img/02042345-fbc1-4ccc-971d-2912235403f2.png)符号，并在随后出现的列中重复此操作。通过这样做，例如，我们可以获取情感值，它是0.97。一旦没有更多的列可以展开，我们就可以加载数据并创建一个包含JSON结构中所有值的常规Excel表格，这将用于进一步分析。'
- en: Importing data from a database
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从数据库导入数据
- en: 'There are many different databases available, and Excel can connect to most
    of them. The connection procedure is similar for all of them. We are going to
    use one as an example: the MS SQL Server Express database, which is free and can
    be downloaded on any computer. It has some limitations, but it is extremely useful
    for learning and testing with small amounts of data. Assuming there is a local
    database in your computer, perform the following steps to connect the database:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 可用的数据库种类繁多，Excel可以连接到其中大多数。对于所有这些数据库，连接过程都是相似的。我们将以一个为例：免费的MS SQL Server Express数据库，可以在任何计算机上下载。它有一些限制，但对于学习和测试少量数据来说非常实用。假设您的计算机中有一个本地数据库，请按照以下步骤连接数据库：
- en: Click on Data.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”。
- en: 'Navigate to *Get Data | From Database | From SQL Server Database*, as shown
    in the following screenshot:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到*获取数据 | 从数据库 | 从SQL服务器数据库*，如下截图所示：
- en: '![](img/984d7e11-49d0-4cba-ae96-7cf41159c81a.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/984d7e11-49d0-4cba-ae96-7cf41159c81a.png)'
- en: 'The pop-up dialog will request the name of the database server. In this case,
    it is the local computer name and the SQL Express Server. Optionally, we can add
    the database name, but if we leave it blank, we will be able to see a list of
    all databases in the server. These details are shown in the following screenshot:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 弹出对话框将请求数据库服务器的名称。在这种情况下，它是本地计算机名称和SQL Express服务器。可选地，我们可以添加数据库名称，但如果我们留空，我们将能够看到服务器中所有数据库的列表。以下截图显示了这些细节：
- en: '![](img/552c58be-81fd-4ff1-ac85-99df76bca9f1.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/552c58be-81fd-4ff1-ac85-99df76bca9f1.png)'
- en: 'Connect to the database using your credentials. It could be that you can log
    in with your Windows username and password (as shown in the following screenshot)
    or that you have a special username and password pair for the database:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用您的凭证连接到数据库。您可能可以使用 Windows 用户名和密码登录（如下面的截图所示）或者您可能有一个用于数据库的特殊用户名和密码对：
- en: '![](img/7c35f6ce-7c2c-41ab-8b23-2de04e5d0101.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7c35f6ce-7c2c-41ab-8b23-2de04e5d0101.png)'
- en: If the connection is successful, you will see a list of all databases on the
    server and the tables contained in each database.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果连接成功，您将看到服务器上所有数据库及其包含的表的列表。
- en: 'Select one of the tables and get the usual preview, as shown in the following
    screenshot:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个表格，并获取通常的预览，如下面的截图所示：
- en: '![](img/0c3086a3-00d1-4225-b4ce-1257026ac26e.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0c3086a3-00d1-4225-b4ce-1257026ac26e.png)'
- en: As in the previous cases, you can choose between editing the data or loading
    it. The final result will always be an Excel table.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 与前述案例一样，您可以选择编辑数据或加载数据。最终结果总是一个 Excel 表格。
- en: Now, you know how to connect your Excel sheet to a database, which is the most
    commonly used way of storing data. Now that we have the data, the next step is
    to prepare it for analysis. This will be shown in detail in the next chapter.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经知道如何将 Excel 表格连接到数据库，这是最常用的数据存储方式。现在我们有了数据，下一步是准备它以进行分析。这将在下一章中详细展示。
- en: Summary
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we described different methods of inputting information into
    an Excel spreadsheet, going beyond what can be done by hand-typing data. A variety
    of file types, web data sources, and databases can be analyzed from within Excel
    by using Power Query and Query Editor to extract, transform, and load data. I
    encourage you to explore other data sources, since the loading procedure is very
    similar.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们描述了将信息输入到 Excel 工作表中的不同方法，这超出了手动输入数据的范围。通过使用 Power Query 和查询编辑器，可以从 Excel
    内部分析各种文件类型、网络数据源和数据库，以提取、转换和加载数据。我鼓励您探索其他数据源，因为加载过程非常相似。
- en: So far, we have seen some very simple data transformations being applied to
    the data before it was loaded. In the next chapter, we will discuss more advanced
    techniques for cleansing data.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经看到了一些非常简单的数据转换在数据加载之前被应用。在下一章中，我们将讨论更多用于数据清洗的高级技术。
- en: Questions
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which characters can be used as separators in a text file?
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本文件中可以使用哪些字符作为分隔符？
- en: Why is it so important to pre-process the data before loading it?
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为什么在加载数据之前预处理数据如此重要？
- en: What is the difference between opening an Excel file and importing it?
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 Excel 文件和导入它之间有什么区别？
- en: What type of information can be imported from a web page?
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以从网页导入哪些类型的信息？
- en: JSON is one of the structured formats that's used to exchange information. What
    other formats exist?
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: JSON 是用于交换信息的结构化格式之一。还有哪些格式存在？
- en: Do some online research to understand the advantages of using databases over
    individual data files.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进行一些在线研究，了解使用数据库而不是单个数据文件的优势。
- en: Further reading
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Power Query Documentation*: [https://docs.microsoft.com/en-us/power-query/](https://docs.microsoft.com/en-us/power-query/)'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Power Query 文档*：[https://docs.microsoft.com/en-us/power-query/](https://docs.microsoft.com/en-us/power-query/)'
- en: '*Introduction to the Query Editor (Power Query)*: [https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9](https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9)'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*查询编辑器（Power Query）简介*：[https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9](https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9)'
- en: '*Introducing JSON*: [https://www.json.org/](https://www.json.org/)'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*介绍 JSON*：[https://www.json.org/](https://www.json.org/)'
