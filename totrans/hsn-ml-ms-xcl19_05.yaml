- en: Importing Data into Excel from Different Data Sources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Serious data analysis and machine learning cannot be done by using hand-typed
    data. Data sources come in different flavors and sizes, and Excel can handle many
    of them. This chapter deals with how to import data from different sources, which
    is the first step of any analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Get & Transform (known as **Power Query** in Excel versions before 2016) is
    a powerful tool that you can use to load data from different sources and transform
    it. These transformations are necessary so that you have a clean data sample that
    you can then use to train and test any machine learning model.
  prefs: []
  type: TYPE_NORMAL
- en: If you are running Excel 2010 SP1 or Excel 2013, you need to download and install
    Power Query. Refer link [https://www.microsoft.com/en-us/download/details.aspx?id=39379](https://www.microsoft.com/en-us/download/details.aspx?id=39379) for
    instructions on how to install it.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from a text file
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Importing data from another Excel workbook
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Importing data from a web page
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Importing data from Facebook
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Importing data from a JSON file
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Importing data from a database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You will need to download the `homes.csv`, `homes.txt`, `titanic.xls`, and `azure_text_analytics.json`
    files from this book's GitHub repository at [https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter03).
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from a text file
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The more commonly used data text file is **comma-separated values** (**CSV**).
    As the name suggests, values are written to the file in rows and, for each row,
    a comma separates the values belonging to each column. Open a new workbook and
    follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to *Get Data* | *From File* | *From Text/CSV*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/eb58bb3b-d5b6-4c78-b103-029ef1de0c6d.png)'
  prefs: []
  type: TYPE_IMG
- en: Navigate to the file's location and open the `homes.csv` file.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'A window will pop up, showing you a preview of the file''s contents, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/edb7f2e3-2a95-4597-95d5-c45faa205359.png)'
  prefs: []
  type: TYPE_IMG
- en: We can see that Excel correctly identifies the different columns by using the
    right delimiter (comma). It also tries to detect the data types automatically.
    There is a small problem, though. This file is not pure CSV, and has an extra
    line at the beginning, showing us where it was downloaded from originally. This
    is good for giving credit to the original author, but it confuses the loading
    process a bit. Fortunately, this situation has already been taken into account.
    To solve this issue, click on Edit.
  prefs: []
  type: TYPE_NORMAL
- en: 'A window will pop up, containing many options to deal with these file format
    differences:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b1afec1d-0bd1-4d9b-96ed-9c227c325305.png)'
  prefs: []
  type: TYPE_IMG
- en: Navigate to *Remove Rows* | *Remove Top Rows.*
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will see the option to specify how many rows you want to skip. In this
    file, we need to skip `2` rows, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/8c5578ea-90b1-41bd-a4aa-2c3ccc70518a.png)'
  prefs: []
  type: TYPE_IMG
- en: After removing the rows, we keep only the data of interest. You will notice
    that the file headers haven't been used as column names yet, which would be ideal.
    To correct this, click on Use First Row as Headers.
  prefs: []
  type: TYPE_NORMAL
- en: 'The result of this is shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d449e040-48f3-4695-9631-a81a67694a77.png)'
  prefs: []
  type: TYPE_IMG
- en: Note that a list of the steps have been applied to the input data, to the right
    of the table. This allows you to undo any of your actions and is useful to keep
    track of what you have done, especially if you make more complicated transformations,
    like the ones we will show you in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: 'The process is almost ready, except for the data type of each column. Originally,
    it was set automatically to text, since the first two rows, that we skipped later,
    were evaluated as not containing numerical data. There are two types of columns:
    `Acres` shows decimal numbers, while the rest show integer or whole numbers. To
    define the data type correctly, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Select `Acres`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to Data Type in the Transform menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the type to Decimal Number.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the rest of the columns and change the type to Whole Number to fix the
    other columns.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Finally, click on Close & Load. You will see the following data table:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/131c346e-4fa7-4e7e-975b-e64425ec56e6.png)'
  prefs: []
  type: TYPE_IMG
- en: This table looks like any Excel table, except that we can always double-click
    on the query (called `homes`) and perform more transformations or even undo the
    ones we've already made.
  prefs: []
  type: TYPE_NORMAL
- en: 'If the file is not a CSV file but just a text file that''s using a different
    separator, we can still load it using a similar procedure. We just repeat the
    steps we used for importing the CSV file:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to *Get Data* | *From File* | *From Text/CSV*.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to the file''s location and open `homes.txt`. You will see the following
    preview:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5b5137bb-b29e-4760-b079-5ba582fcf643.png)'
  prefs: []
  type: TYPE_IMG
- en: In this case, there are no extra lines at the beginning, but we can see that
    Excel fails to identify the column delimiter, which is the `|` character. To fix
    this, select Custom from the drop-down menu.
  prefs: []
  type: TYPE_NORMAL
- en: Type `|`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The result is that the data is now correctly separated into columns. The columns
    are automatically labeled using the file header and the data types are guessed
    correctly, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/11f958ce-f023-41e2-bfcd-a88d99942510.png)'
  prefs: []
  type: TYPE_IMG
- en: The final result is a table that is identical to the one we loaded from `homes.csv`,
    but that took less steps to obtain since the file structure was simpler.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we have learned how to import a text file into Excel, which
    is the simplest case. Let's continue with some more complex examples.
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from another Excel workbook
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Why would we import data from an Excel workbook if we can just open it? The
    main reason is to take advantage of the transformations we can do using Get &
    Transform. We will show this by using a file containing real data from the Titanic
    passengers, which is often used to test machine learning classification models
    and predict whether a given passenger survived the tragedy or not.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s follow some simple steps to load and transform the data. While in a
    new workbook, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to Get Data | From File | From Workbook, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/823c4c39-81d8-4aeb-83ac-3f3bb56182fd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The preview window is slightly different to the one we see when opening a CSV
    file, as you can see in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7c7c2b86-db46-4c7b-b4e0-555415581841.png)'
  prefs: []
  type: TYPE_IMG
- en: In the left part of the preview, you can see a folder named `titanic.xls`, which
    represents the file, and below that the worksheets contained within. `Dictionary`
    is just a short description of the variables; the data is contained in the `Passenger
    data` sheet.
  prefs: []
  type: TYPE_NORMAL
- en: 'When this item is selected, we will see a table containing the data. We can
    click on Load and put the data in our worksheet, but first we will try one of
    the transformations that we will discuss in detail in the next chapter. To do
    this, click on Edit and get to the Query Editor, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2c4884bc-84a0-4af0-a556-672540e337a1.png)'
  prefs: []
  type: TYPE_IMG
- en: The columns are identified correctly and the names that are taken from the column
    names are placed in the input file. You can see that one of the columns, `cabin`,
    contains missing values, identified as `null`. This means that, for those passengers,
    there is no information about which cabin in the ship they where occupying. Some
    machine learning models do not accept empty values, so we need to fix this by
    selecting the column, as shown in the preceding screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: Click on Replace Values in the Transform menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will get a pop-up dialog where you can tell Excel to replace `null` with
    `Unknown`, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1879af25-7f8b-4071-9fa1-1b0655d203fe.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The result is what you can see in the following screenshot, where all `null`
    values are replaced with `Unknown`. This is both more elegant and easier to manage
    by machine learning models:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/42f58f44-a39c-4bd1-9b1d-0e8c7ac28ace.png)'
  prefs: []
  type: TYPE_IMG
- en: Many different transformations can be performed on the data using the Query
    Editor. We will show other examples in the next chapter. You should try to test
    different options as well.
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from a web page
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If a web page contains data in tabular form, then Excel is able to import these
    tables automatically. As an example, we will import a table from the Wikipedia
    page about Excel. Here''s how we will go about it:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on Data and then navigate to Get Data | From Other Sources | From Web,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a8546c95-ea93-49a9-9b78-7f8c86841c2e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In the dialog that pops up, we type in the URL of the mentioned web page and
    click OK, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fa49887f-3868-48f3-8a26-7e5caaffcd9e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we will be able to see a list of available tables. Pick the one showing
    Excel''s release history. A table preview is shown to the right, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d11c8a9b-5c72-4f76-9fd2-bb5e3cf972c1.png)'
  prefs: []
  type: TYPE_IMG
- en: As we did before, we can just load the data or edit it, transforming the values
    according to our needs. The final result is an Excel table.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We also have the choice of changing to web view and seeing the target web page
    as we would in Internet Explorer, which can help us to identify which information
    is useful for our analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'We have seen how easy it is to import data from a web page. Now, let''s explore
    importing data from one of the most popular websites: Facebook.'
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from Facebook
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'It is possible to import data directly from a Facebook profile or page. If
    we want to, for example, register the dates and times when a new post appears,
    we could follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to Get Data | From Online Services | From Facebook, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/dcbf16e2-ab85-4435-8142-547ee88c99cb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You need to specify the user or page name, which is the last part of the page
    URL. As an example, I will use my own Facebook page, which is the default option.
    The first time you connect, you will have to log in with your username and password
    (to connect to Facebook from Excel, you need a Facebook profile). The following
    dialog will appear:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/30b7fa98-99c8-4c6f-a581-31ba568150b3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We will choose to get information about Posts. After clicking OK, we get the
    following screen (I will only show it partially, to protect my privacy):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/723918d7-1940-431d-ad0b-930db25a8ecd.png)'
  prefs: []
  type: TYPE_IMG
- en: As we can see, the date and times of the posts are concatenated in a single
    column. To split this column, click on Edit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the column and then Split Column in the Query Editor.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the dialog, specify that you want to split the column by the character,
    `T`, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b2a33581-9206-489b-87c4-12f9edba3b8e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As a result, you get two new columns, one for the date and another one for
    the time, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1b4af768-9c3d-4f2d-8b51-03a2f512aca6.png)'
  prefs: []
  type: TYPE_IMG
- en: You have successfully extracted information from your Facebook page, which you
    can now use to analyze how often you are publishing, what type of content you
    are publishing, and other useful insights. This is especially useful if you are
    looking at a commercial profile, where you might want to adapt the content to
    improve the marketing of your service or product.
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from a JSON file
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: JSON is a standard format for sharing data, since it uses text fields that can
    be read by a human being. It is used by most web applications for data input and
    output.
  prefs: []
  type: TYPE_NORMAL
- en: In our example, we will use the Azure Text Analytics API. Given a sentence,
    this service can identify the text sentiment and the language and extract keywords,
    among other things.
  prefs: []
  type: TYPE_NORMAL
- en: 'The input sentence is `I had a wonderful trip to Seattle and enjoyed seeing
    the Space Needle!`. The API correctly identifies the language as English, extracts
    the main keywords, and tells us that the sentiment is positive (assigning a value
    larger than 0.5). All of this information is given in JSON format on the right-hand
    side of the window, and is available in the file we are going to import. The following
    screenshot has been extracted from the Azure Text Analytics demonstration page:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/62330292-4aed-4309-94d4-69cf7a29cb13.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To load the input JSON file, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to *Get Data* | *From File* | *From JSON*, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/cd85bd52-fee7-46cc-a88d-7991b2ec5a90.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will get a preview showing the main fields in the JSON structure, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/12e4f670-3066-4ce2-b3ca-877c6da637b3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on Into Table to convert the entries into regular Excel tables, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/039be9fd-10b2-48c6-a988-6912ef3f4608.png)'
  prefs: []
  type: TYPE_IMG
- en: The `Value` column is a special table column that contains nested values. To
    navigate to the desired variable, we need to click on the ![](img/02042345-fbc1-4ccc-971d-2912235403f2.png)
    symbol and repeat this operation in the columns that will successively appear.
    By doing, this we can, for example, get to the sentiment value, which is 0.97\.
    Once there are no more columns to expand, we can load the data and create a regular
    Excel table that contains all of the values in the JSON structure, which will
    be used for further analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Importing data from a database
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are many different databases available, and Excel can connect to most
    of them. The connection procedure is similar for all of them. We are going to
    use one as an example: the MS SQL Server Express database, which is free and can
    be downloaded on any computer. It has some limitations, but it is extremely useful
    for learning and testing with small amounts of data. Assuming there is a local
    database in your computer, perform the following steps to connect the database:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to *Get Data | From Database | From SQL Server Database*, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/984d7e11-49d0-4cba-ae96-7cf41159c81a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The pop-up dialog will request the name of the database server. In this case,
    it is the local computer name and the SQL Express Server. Optionally, we can add
    the database name, but if we leave it blank, we will be able to see a list of
    all databases in the server. These details are shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/552c58be-81fd-4ff1-ac85-99df76bca9f1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Connect to the database using your credentials. It could be that you can log
    in with your Windows username and password (as shown in the following screenshot)
    or that you have a special username and password pair for the database:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7c35f6ce-7c2c-41ab-8b23-2de04e5d0101.png)'
  prefs: []
  type: TYPE_IMG
- en: If the connection is successful, you will see a list of all databases on the
    server and the tables contained in each database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select one of the tables and get the usual preview, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0c3086a3-00d1-4225-b4ce-1257026ac26e.png)'
  prefs: []
  type: TYPE_IMG
- en: As in the previous cases, you can choose between editing the data or loading
    it. The final result will always be an Excel table.
  prefs: []
  type: TYPE_NORMAL
- en: Now, you know how to connect your Excel sheet to a database, which is the most
    commonly used way of storing data. Now that we have the data, the next step is
    to prepare it for analysis. This will be shown in detail in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we described different methods of inputting information into
    an Excel spreadsheet, going beyond what can be done by hand-typing data. A variety
    of file types, web data sources, and databases can be analyzed from within Excel
    by using Power Query and Query Editor to extract, transform, and load data. I
    encourage you to explore other data sources, since the loading procedure is very
    similar.
  prefs: []
  type: TYPE_NORMAL
- en: So far, we have seen some very simple data transformations being applied to
    the data before it was loaded. In the next chapter, we will discuss more advanced
    techniques for cleansing data.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Which characters can be used as separators in a text file?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Why is it so important to pre-process the data before loading it?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What is the difference between opening an Excel file and importing it?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What type of information can be imported from a web page?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: JSON is one of the structured formats that's used to exchange information. What
    other formats exist?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Do some online research to understand the advantages of using databases over
    individual data files.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*Power Query Documentation*: [https://docs.microsoft.com/en-us/power-query/](https://docs.microsoft.com/en-us/power-query/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Introduction to the Query Editor (Power Query)*: [https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9](https://support.office.com/en-us/article/introduction-to-the-query-editor-power-query-1d6cdb63-bf70-4ae8-a7d5-6ae9547004d9)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Introducing JSON*: [https://www.json.org/](https://www.json.org/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
