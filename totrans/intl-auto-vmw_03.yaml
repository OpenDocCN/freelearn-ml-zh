- en: Proactive Measures with vSAN Advanced Analytics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter will brief you on **virtual storage area network** (**vSAN**) design
    recommendations, as well as all of the monitoring options through which your customers
    can assess, recommend, and design their environment. This will help them achieve
    different business objectives by automating their operations with smart policies.
  prefs: []
  type: TYPE_NORMAL
- en: We will learn to configure policy-based operations as per ML algorithms and
    we'll learn how the end user experience is improved by the proactive resolving
    of customer issues. We'll also learn to optimize a **hyperconverged infrastructure**
    (**HCI**) to achieve customer business objectives.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Application scalability on vSAN
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Intelligent monitoring
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**High availability** (**HA**) configuration in stretched clusters'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN policy design with **Storage Policy-Based Management** (**SPBM**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can download VMware vCenter Server 6.5 U1 from the site at [https://my.vmware.com/web/vmware/details?downloadGroup=VC65U1&amp;productId=676&amp;rPId=28154](https://my.vmware.com/web/vmware/details?downloadGroup=VC65U1&productId=676&rPId=28154)[.](https://my.vmware.com/web/vmware/details?downloadGroup=VC65U1&productId=676&rPId=28154)
  prefs: []
  type: TYPE_NORMAL
- en: Application scalability on vSAN
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: VMware vSAN can support containers and a next-generation application based on
    an updated vSphere Docker volume driver with native support directly through Docker
    APIs. This allows Docker to be built on top of vSAN and take advantage of the
    proven, persistent storage capabilities of vSAN. This driver update has new features,
    including support for multi-tenancy, SPBM, cloning, and snapshots. VMware has
    a principle of *APIs first*, and all management features are available through
    APIs, which are extensions of the vSphere APIs that tens of thousands of enterprise
    customers use to automate their operations.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following parameters should be taken into consideration to detain the storage
    tier where application data should be stored:'
  prefs: []
  type: TYPE_NORMAL
- en: '**I/O operations per second** (**IOPS**) requirements'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MBps requirements
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Capacity requirements
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Availability requirements
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Latency requirements
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consider any existing SLAs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consider whether data might move between storage tiers during the information
    life cycle
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These details can be used to move applications and services to the storage tier
    that's been designed with matching characteristics.
  prefs: []
  type: TYPE_NORMAL
- en: Storage and network assessment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A holistic approach to vSAN management can have a significantly positive impact
    on the infrastructure. It integrates with vRealize Operation and complements it
    by providing more in-depth information about resources. The following VMware recommendations
    view the business challenges from three different perspectives:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Organizational recommendations**: Develop a virtualization policy with a
    service-centered approach such as a menu of offerings and service levels.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Operational recommendations**: Focus on process definition and improvement,
    specifically in the areas of provisioning, systems monitoring, and problem management.
    Research and evaluate virtual infrastructure monitoring tools.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Technical recommendations**: Implement consistent configurations across similar
    systems, perform minor network adjustments to greatly improve network performance
    during contention and backup windows, and configure virtual machines to exploit
    the benefits of virtualization.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Storage design policy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The assessment summaries are based on the **VMware Health Analyzer** (**vHA**)
    checkpoints and documented vSAN best practices. We will take a look at some of
    the recommendations in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: VMware best practices recommendations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are VMware''s best practices, along with recommendations for
    the storage design policies:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Verify that we have set up storage policies correctly in vCenter console:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Default rule settings should be modified by default. The policy should be applied
    as per your requirements.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Policy settings**: Force provisioning should be set to true during configuration.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Object space reservation (%) should be set to 100%.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: The VM storage policies in vSAN can affect the performance
    of VMs running on the vSAN datastore. These include the Number of disk stripes
    per object, Flash read cache reservation (%), Number of failures to tolerate,
    and Object space reservation (%) parameters.'
  prefs: []
  type: TYPE_NORMAL
- en: VMware recommends that you go with the default policy of one failure to tolerate
    and one disk stripe. We can change the policy as per customer requirements and
    also change the configuration. We have to update the policy for each additional
    failure to tolerate. *2n+1* hosts are required to fulfill the policy, where *n*
    is number of failure to tolerate.
  prefs: []
  type: TYPE_NORMAL
- en: Verify that VMs are distributed evenly across vSAN nodes. Just as disk resources
    should generally be distributed evenly across vSAN hosts, for the best performance,
    virtual machines should also be distributed relatively evenly across those hosts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: This reduces the chances of performance being impacted due
    to an imbalance of virtual machines on a single host, which could saturate the
    vSAN network. vSphere''s **Distributed Resource Scheduler** (**DRS**) can help
    with disk resource distribution by monitoring and balancing the virtual machines
    as needed.'
  prefs: []
  type: TYPE_NORMAL
- en: The storage controller's settings should be configured correctly for best performance.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: The VM storage policies in vSAN can affect the performance
    of VMs running on the vSAN datastore. A low controller queue depth may impact
    the availability of production VMs during rebuild/resync, so a minimum queue depth
    of 256 is required in vSAN. The VMware Compatibility Guide for vSAN has been updated
    to include only adapters with this requirement. However, certain adapters with
    older firmware might still have the queue depth artificially limited. The controller
    should have caching disabled. If this is not possible, set read caching to 100%.
    If the controller is not set to pass-through, present each disk as its own device.
    Do not configure drives as one large RAID volume.'
  prefs: []
  type: TYPE_NORMAL
- en: Avoid using the flash read cache policy reservations unless absolutely necessary.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: vSAN allows for the customization of policies for use with
    virtual machines. One of the policy options, Flash read cache reservation (%),
    allows for the reservation of read cache. Do not set this policy option unless
    absolutely necessary. These reservations reserve a portion of the read cache for
    objects based on the percentage of capacity disk size (10% of a 250 GB disk is
    25 GB.) If they are not used sparingly, cache reservations quickly reduce the
    available cache and the effectiveness of vSAN.'
  prefs: []
  type: TYPE_NORMAL
- en: We should upgrade the on-disk file format to 3.0.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: To use the full set of vSAN capabilities in vSphere, be
    sure to upgrade the on-disk file format. During the vSAN upgrade from version
    5.5 to version 6.7, it is possible to keep the on-disk format version, that is,
    1.0, but you cannot use many of the new features. vSAN supports both on-disk formats.'
  prefs: []
  type: TYPE_NORMAL
- en: vSAN should be using optimal **non-volatile memory express** (**NVMe**) CLASS
    E disks. Verify that you are using supported and high-performing **solid state
    drives** (**SSDs**) for best performance.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: All writes hit SSDs in vSAN first. vSAN read cache hits
    come from SSDs, so the performance of the SSDs is a critical factor in the overall
    performance of vSAN.'
  prefs: []
  type: TYPE_NORMAL
- en: 'We can use SSDs instead of magnetic disks for the capacity tier as well. The
    VMware Compatibility Guide helps customers in selecting the right SSDs by segregating
    them into different groups based on their performance, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Class A**: 2,500–5,000 writes per second'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Class B**: 5,000–10,000 writes per second'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Class C**: 10,000–20,000 writes per second'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Class D**: 20,000–30,000 writes per second'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Class E**: 30,000+ writes per second'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware always recommends using flash drives that meet application performance
    needs for optimal performance. As per best practices, we have to consider 10 percent
    of projected used **hard disk drive** (**HDD**) capacity before the failures-to-tolerate
    policy is applied for a minimum flash drive.
  prefs: []
  type: TYPE_NORMAL
- en: Network design policy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: vSAN requires a VMkernel network configuration for synchronization and replication
    activities. This port group should generally be dedicated and isolated to vSAN
    traffic. However, if a 10 gigabits network interface is being used, it can be
    shared. 1 gigabit networks require a dedicated **network inte****rface card**
    (**NIC**) to be assigned to the port group.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are the major decision points regarding vSAN network configuration:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Network speed requirements**: All-flash vSAN configurations (with Advanced
    and Enterprise Edition) will only work with 10 gigabits Ethernet network uplinks.
    A 10 gigabits network is required to achieve the highest performance (IOPS). VMware
    recommends a 10 gigabits Ethernet connection (MTU 9000) for use with vSAN in all
    configurations.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Type of virtual switch to be used**:vSAN supports both vSphere standard virtual
    switch configurations and distributed switch configurations. A distributed switch
    allows network I/O control to be used for the prioritization of bandwidth. It
    allows the interface to be shared and prioritizes performance levels in contention
    scenarios. VMware recommends using a **vSphere Distributed Switch** (**VDS**)
    for the vSAN port group.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Jumbo frame**:vSAN supports using jumbo frames for vSAN network transmissions.
    VMware recommends using jumbo frames for vSAN, but only if the underlying physical
    environment is already configured to support them.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '** Business continuity and disaster recovery** (**BC/DR**) **and teaming considerations**:BC/DR
    is critical in any environment in case of a network failure. vSAN supports teaming
    configurations for network cards to enhance the availability and redundancy of
    the network. VMware recommends that configurations use an active/active redundancy
    with a route based on physical adapter load for the teaming in the environment.
    Idle network cards do not wait for a failure to occur and aggregate bandwidth
    in this configuration.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware best practices recommendations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are VMware''s best practices with recommendations for the network
    design policies:'
  prefs: []
  type: TYPE_NORMAL
- en: We should distribute VMNICs for a port group across various **Peripheral Component
    Interconnect** (**PCI**) buses for enhancing availability
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: Distributing VMNICs for a port group across different PCI
    buses provides protection from failures related to a specific PCI bus. You need
    to team VMNICs from different PCI buses to improve fault resiliency from component
    failures.'
  prefs: []
  type: TYPE_NORMAL
- en: Configure NICs, physical switch speed, and duplex settings consistently
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: Incorrect network speed and duplex settings can impact performance.
    The network adapter (VMNIC) and physical switch settings must be checked and set
    correctly. If your physical switch is configured for a specific speed and duplex
    setting, we must force the network driver to use the same speed and duplex setting.
    Network settings should be set to auto-negotiate and not forced for gigabits links.
    We can set network adapter speed and duplex settings from the vSphere client,
    but a reboot is required for the changes to take effect.'
  prefs: []
  type: TYPE_NORMAL
- en: It is always recommended to use 10 gigabits or faster networks with vSAN
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: Small vSAN deployments can perform well with 1 gigabit Ethernet
    links between the ESXi hosts in the vSAN cluster, but most deployments will require
    10 gigabits or faster links. VMware recommends using a minimum of 10 gigabits
    links for best datastore performance.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Network I/O control** (**NIOC**) shares are configured to ensure at least
    8 gigabits are available for vSAN traffic to avoid contention. We will use vSAN
    reservations while using NIOC.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: VMware suggests reservations with vSAN for specific use
    cases but primarily for environmental conditions in the physical network, thus
    reducing the actual bandwidth. This can be scheduled between the physical NIC
    and the physical network. Reservations ensure that the vSAN network traffic is
    not consumed by other traffic types. NIOC can redistribute reserved bandwidth
    to other system traffic types (management, **i****nternet small computer system
    interface** (**iSCSI**), **fault tolerance** (**FT**), vMotion, and so on), but
    not to VM traffic. VM traffic is limited without any congestion even with minimal
    management traffic.'
  prefs: []
  type: TYPE_NORMAL
- en: Multicast networking is enabled for efficient operation as one multicast group
    contains no network partitions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Justification**: Multicast networking using **internet group management protocol**
    (**IGMP**) snooping is required for vSAN. We should validate that the networking
    infrastructure supports this requirement by running network discovery commands.
    The infrastructure will require either a snooper carrier configured for the vSAN
    network, or IGMP snooping to be disabled explicitly on the VLAN or ports which
    are used by default in many environments. All of the physical switches and routers
    handling vSAN traffic, along with the layer 2 path and the layer 3 (optional)
    path, should be enabled with multicast. VMware recommends using layer 2 multicast
    for the simplicity of configuration and operations.'
  prefs: []
  type: TYPE_NORMAL
- en: VMware's Customer Experience Improvement Program/vSAN ReadyCare
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We have enhancements that have been added to and developed by an engineering
    team based on customer feedback from the past 6 – 12 months. VMware retrieves
    technical data regarding VMware solutions that are deployed in the customer's
    environment and other services that are integrated with the customer's VMware
    license keys.
  prefs: []
  type: TYPE_NORMAL
- en: 'Depending on the nature of the VMware product or service and the level of participation
    the customer selects, the technical data that''s accumulated is comprised of all
    or some of the following data:'
  prefs: []
  type: TYPE_NORMAL
- en: Configuration data providing information about the configuration of VMware solutions,
    along with associated products that are deployed in the customer's environment,
    like the version of VMware products, configuration details, and applications/hardware
    configuration with VMware products/services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Product feature-specific data, which provides information about how VMware tools
    are utilized in a customer's data center, including user interface activity and
    integration with third-party tools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Performance data helps with the different metrics to measure the performance
    of various VMware product features, like availability/scalability/security, along
    with response times for user interfaces and API integrations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Product log data that's fostered from the initial deployment to the production
    stage by VMware products, such as the logs of past system events and different
    system states for a specific time period, without having a customer's application
    data/content
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'VMware updates all of this information at regular intervals to reflect changes
    in its products/services through the **Customer Experience Improvement Program** (**CEIP**),
    and we always suggest that our customers browse this web page (CEIP) regularly
    so that they''re always updated: [https://www.vmware.com/in/solutions/trustvmware/ceip.html](https://www.vmware.com/in/solutions/trustvmware/ceip.html).'
  prefs: []
  type: TYPE_NORMAL
- en: We will now see how we can use machine learning techniques to collect logs and
    for monitoring purposes.
  prefs: []
  type: TYPE_NORMAL
- en: Intelligent monitoring
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'vSAN environment monitoring is critical for a successful deployment. We have
    to follow the following monitoring practices:'
  prefs: []
  type: TYPE_NORMAL
- en: General monitoring practices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN Health Check plugin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN Observer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware vRealize Operations Manager Monitoring
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitoring design
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: General monitoring practices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: vSAN supports monitoring datastores through the VMware vSphere Web Client, the
    HTML 5 client, and the vSAN Management API. The vSphere Web Client monitors different
    objects, like clusters and datastores.
  prefs: []
  type: TYPE_NORMAL
- en: Without effective control over the infrastructure, a VM or ESXi host sprawl
    can quickly diminish the return of investment from virtualization. Areas for improvement
    include assessing workloads to determine performance metrics that can then be
    used to create VM-specific vSAN policies to better suit the workload. A stripe
    policy of two nodes for write-intensive workloads that are bigger than the cache
    disk size may lead to performance improvements. We can minimize the troubleshooting
    time that is spent by the operations teams on VMs that have performance-related
    issues.
  prefs: []
  type: TYPE_NORMAL
- en: vSAN Health Check plugin
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The vSAN Health Check plugin is a simple way to check the health of the vSAN
    cluster. It is included by default in the installation. The health check technical
    recommendations are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Priority** | **Component** | **Recommended action item** |'
  prefs: []
  type: TYPE_TB
- en: '| P1 | vSAN | Verify vSAN firmware and driver versions. |'
  prefs: []
  type: TYPE_TB
- en: '| P2 | vSAN network | Distribute VMNICs for a port group across different PCI
    buses for greater redundancy. |'
  prefs: []
  type: TYPE_TB
- en: '| P3 | vSAN network | Configure NICs, physical switch speed, and duplex settings
    consistently. Set to auto negotiation for 1 gigabit NICs. |'
  prefs: []
  type: TYPE_TB
- en: '| P3 | vSAN | Verify that you have set up the storage policies correctly. |'
  prefs: []
  type: TYPE_TB
- en: '| P3 | vSAN | Verify that the VMs are distributed evenly across vSAN nodes.
    |'
  prefs: []
  type: TYPE_TB
- en: VMware recommends using the Health Check plugin to allow for easy monitoring
    of the vSAN clusters.
  prefs: []
  type: TYPE_NORMAL
- en: vSAN Observer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'vSAN Observer does in-depth monitoring of disk groups, shows an aggregate view
    for the group and disk layers, and also monitors vSAN physical disk layer latencies.
    It reads cache hit rate, evictions and performance, and other parameters, such
    as size, disk type, manufacturers, model, local/non-local, and so on. vSAN Observer
    is part of the **Ruby vSphere Console** (**RVC**), which supports the use of the
    vCenter Server certificate on Windows platforms and provides network, a **Content-Based
    Read Cache** (**CRBC**), and vSANSparse statistics. The following tools/data can
    help your customers troubleshoot vSAN-related issues:'
  prefs: []
  type: TYPE_NORMAL
- en: vSAN configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN health monitoring
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN disks statistics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN performance statistics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Observer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vSAN Observer recommends that you deploy a vCenter Server appliance and run
    the observer session on the newly deployed or remote vCenter Server appliance
    to increase the data gathering time beyond the default (2 hours).
  prefs: []
  type: TYPE_NORMAL
- en: 'The vSAN Observer user interface displays the following performance details:'
  prefs: []
  type: TYPE_NORMAL
- en: Statistics of the physical disk layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extensive physical disk group details
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CPU usage statistics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consumption of vSAN memory pools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Physical and in-memory object distribution across vSAN clusters
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vRealize Operations Manager monitoring
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A business can be heavily impacted when service interruptions continue to rise
    and IT teams become more eager to find interruption issues in a small time period. Logs
    have become a critical source of information and are required to troubleshoot
    IT operations issues. However, the amount and size of logs have grown due to increasingly
    complex IT environments.
  prefs: []
  type: TYPE_NORMAL
- en: As customers become more cost-sensitive, Log Intelligence, one of the VMware
    Cloud services, helps customers overcome these challenges by providing valuable
    insights into public and private cloud infrastructure. Log Intelligence offers
    rapid IT troubleshooting, deep operational visibility across multiple clouds,
    including VMware Cloud on AWS, and centralized log management. VMware recommends
    installing and monitoring vSAN with vRealize Operations Manager, which helps in
    the comprehensive monitoring of vSAN in the environment.
  prefs: []
  type: TYPE_NORMAL
- en: Challenges affecting business outcomes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are the challenges that affect business outcomes:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Lack of visibility**: IT teams that don''t have system-wide visibility through
    a single pane of glass spend an ample amount of time manually reviewing logs,
    preventing them from spending time on more strategic tasks'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Reactive troubleshooting**: IT teams spend too much time identifying and
    solving issues due to isolated metrics that trigger alarms, increasing time spent,
    cost, and downtime'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Business benefits
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Log Intelligence is a service that offers rapid IT troubleshooting, deep operational
    visibility across public and private cloud environments, and centralized log management,
    making it easier for IT teams to decipher and solve issues more efficiently.
  prefs: []
  type: TYPE_NORMAL
- en: 'Following are the benefits:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Minimize costs**: Help customers improve performance and create a faster
    problem resolution that raises savings at a company''s top and bottom line'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Prevent downtime**: Move away from a reactive mechanism to spot potential
    problems and track infrastructure whose log values were out of normal operation,
    preventing future downtime'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Saving time**: Use a centralized log management tool to automatically collect
    and organize information'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical Issues
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The technical issues such as monitoring and proactive support to reduce resolution
    time are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Lack of insight into the SDDC environment**: IT administrators generally
    don''t have good visibility into their organization''s cloud environment, especially
    the workloads that are deployed by their application teams in public clouds.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Reactive performance troubleshooting**: Traditional log management tools
    rely on raw performance metrics and typically do not go beyond alerting administrators
    when performance thresholds are exceeded. In addition, they do not provide additional
    insights from log files for troubleshooting and root cause analysis.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical solution
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Log Intelligence, a SaaS offering, is easy to onboard and use. IT administrators
    can use it to collect and analyze various types of machine-generated log data.
    Log Intelligence can be connected to infrastructure and applications for enterprise-wide
    visibility via log analytics.
  prefs: []
  type: TYPE_NORMAL
- en: Log Intelligence offers an intuitive GUI-based interface, making it easy for
    IT administrators to run simple interactive searches, as well as deep analytical
    queries for quick insights that provide immediate value and improved IT efficiency.
  prefs: []
  type: TYPE_NORMAL
- en: Log Intelligence advantages
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s take a look at some of the advantages of Log Intelligence:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Immediate time to value**: Log Intelligence provides automated data collection
    from public and private cloud environments and provides immediate time to value
    by helping customers ingest universal log collection and analytics efficiently,
    while delivering intuitive, interesting events'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cost savings**: It helps customers in reducing the resolution time of escalated
    support requests with its innovative approach of indexing and grouping in rapid
    troubleshooting across virtual and cloud deployments'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Increased productivity**: It has a single log management console with all
    of the relevant information, which helps users to innovate new things in the organization'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We will now learn about the different configuration parameters that you can
    use during a stretched clusters deployment.
  prefs: []
  type: TYPE_NORMAL
- en: HA configuration in stretched clusters
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: VMware vSAN has the option to deploy two ESXi hosts in a cluster with a remote
    witness appliance. We can define specific vSphere HA behaviors for vSAN to validate
    the VM's individual state. vSphere HA can dictate a particular VM failover action
    if the virtual machine's components are accessible from a defined partition.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is a screenshot of the cluster settings:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/05f2f519-c6a6-43cb-9ffb-18b74a6839bf.png)'
  prefs: []
  type: TYPE_IMG
- en: 'vSAN stretched cluster-enabled HA has the following configurations in the cluster''s
    settings:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **vSphere HA** | Configuration** parameters** |'
  prefs: []
  type: TYPE_TB
- en: '| Host Monitoring | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Host Hardware Monitoring —VM Component Protection: Protect against Storage
    Connectivity Loss |  No, default |'
  prefs: []
  type: TYPE_TB
- en: '| Virtual Machine Monitoring | No, default |'
  prefs: []
  type: TYPE_TB
- en: '| Admission Control | Enabled |'
  prefs: []
  type: TYPE_TB
- en: '| Datastore Heartbeats | Datastore Heartbeat will be disabled by using datastores
    from the defined list, but without choosing any datastores from this list |'
  prefs: []
  type: TYPE_TB
- en: 'To configure the policy to enable HA, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to the HA Settings (HA enabled) and configure the static routes on the host
    servers and witness host
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add static routes to the witness VM's vSAN VLAN to the vSAN network of the ESXi
    hosts in the data centers
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The traffic for the vSAN is enabled for the VMkernel port groups
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Static routes are added by executing the `esxcfg-route –a` command on all the
    ESXi hosts in the cluster across data sites and the witness host
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The `esxcli` command is used to add a static route, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Two-node clusters
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Two-node clusters aren't possible with vSAN as a minimum of three hosts are
    required to make sure that all of the components are protected.
  prefs: []
  type: TYPE_NORMAL
- en: 'A two-node cluster can be configured from the configuration wizard with a witness.
    This is good for smaller environments. VMware introduced **witness traffic separation**
    (**WTS**) for two-node configurations and also supports this feature for stretched
    clusters. Most of the stretched vSAN customers leverage this feature by configuring
    (witness) through the CLI (`esxcli`). All we have to do is tag a **VMKernel NIC**
    (**vmknic**) for witness traffic with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Witness appliance for the vSAN cluster
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: VMware has a vSAN witness appliance, which is basically an ESXi instance running
    in a VM to act as a witness. A witness host needs less capacity, bandwidth, and
    performance compared to hosts in normal vSAN clusters, or hosts in data center
    parts of the vSAN stretched cluster. A witness appliance stores the VM's witness
    components and is responsible for object quorums in the case of failure or a split-brain
    situation to make the required VM available.
  prefs: []
  type: TYPE_NORMAL
- en: 'The configuration of the witness appliance for a tiny environment are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Tiny (10 VMs or less: application/domain controller/file and print server)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Two vCPUs, 8 GB vRAM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 8 GB ESXi Boot Disk, one 10 GB SSD, one 15 GB HDD
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Supports a maximum of 750 witness components
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring the vSAN cluster
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'All VMware vSAN certified servers that are mentioned in the VMware HCL can
    be considered to be a part of the vSAN cluster, which utilizes both magnetic disks
    and flash disks for capacity and cache tiers. 70% of the available cache is allocated
    for storing frequently read disk blocks by reducing accesses to the slower magnetic
    disks, while the remaining 30% of the available cache is allocated to writes.
    Multiple writes should be coalesced and written sequentially to enhance magnetic
    disk performance:'
  prefs: []
  type: TYPE_NORMAL
- en: Choose the cluster that the host servers are added on.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Configure... option on the right-hand side to manage all the datastores
    powered by vSAN:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c23cd23b-1a2e-408a-ac7a-fc44ac3c525a.png)'
  prefs: []
  type: TYPE_IMG
- en: Find the option to configure the vSAN under Virtual SAN.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the configuration page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Then, go to Claim disks from datastore, and then choose **Manual**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0b134d98-ab25-433b-b64f-9423ff4fd03c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Fault Domains & Stretched Cluster: Configure two host vSAN clusters.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Confirm that the networking is valid on the vSAN VMkernel adapters.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify that all of the disks show up for each server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Collapse the disks to their logical drives. Then, set the SSDs to the Cache
    tier and the HDDs to the Capacity tier.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the fault domains and the Preferred fault domain and Secondary fault
    domain.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click Next and continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the option to choose the witness VM.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Map the capacity and the **Cache tier** for the witness VM host. Then, deploy
    the witness VM to monitor the vSAN cluster:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d69ca947-6440-4421-87ae-e8148df4b004.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on Finish to complete the vSAN configuration. The disks should now be
    visible.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Log on to a host server and type the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Verify that the cluster shows up as healthy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Under Cluster | Monitor | VSAN |, run the health check to confirm that the configuration
    is correct.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We have gone through how to configure a vSAN cluster, as well as how to perform
    health check monitoring. Now, we will learn about the various policies that we
    can configure through SPBM.
  prefs: []
  type: TYPE_NORMAL
- en: vSAN policy design with SPBM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The storage class definition in vSphere maps to policies that are defined through
    vSAN SPBM to achieve different levels of **service level agreements** (**SLAs**)
    and **quality of service** (**QoS**), and can leverage these benefits from advanced
    vSAN data service functionalities such as de-duplication, compression, and checksums.
    Using general policies is advisable if no specific use cases exist.
  prefs: []
  type: TYPE_NORMAL
- en: 'Start by assessing the following different application requirements:'
  prefs: []
  type: TYPE_NORMAL
- en: I/O performance and the profile of your workloads on a per-virtual-disk basis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Working sets of your workloads
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hot-add (feature of vSphere) of additional cache requires re-population of the
    cache
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Specific application best practices, such as block size
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Defining a policy based on business objectives
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: vSAN integrates storage parameters into vCenter Server by using vSphere APIs
    for storage awareness. SPBM further helps in defining VM-centric policies, which
    are basically constructs that store VM storage provisioning needs based on the
    available storage features with various policies (with configuration parameters).
  prefs: []
  type: TYPE_NORMAL
- en: 'These are given here:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Number of disk stripes per object (performance): Default value = 01, maximum
    value = 12'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: VM disk performance gets enhanced with RAID 0 stripe configuration by
    defining the HDD''s number.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Flash read cache reservation (%) (performance): Default % = 0, maximum % =
    100'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: We can leverage this configuration exclusively for VMs, which
    must have read IOPS issues. This needs to be sorted out, but reservations should
    be not recommended as per VMware best practices.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Number of failures to tolerate, FTT (redundancy): Default value= 01, maximum
    value = 03'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: The FTT number decides the number of host, disk, or network failures
    a storage object can tolerate. We can tolerate *n (0, 1, 2, 3)* failures when *n+1*
    copies of the disk are created and *2n+1* hosts or fault domains need to contribute
    to the storage alongside mirroring. We can tolerate one failure, with minimum
    four nodes or fault domains and subsequent can tolerate two failures with minimum
    six hosts or fault domains along with erasure coding. The maximum value is 1 if
    the disk size is greater than 16 TB.'
  prefs: []
  type: TYPE_NORMAL
- en: 'These parameters are configured in the Configure interface:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Failure tolerance method (Performance/Capacity): Default = RAID 1 (Mirroring)-Performance'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: RAID 1 can tackle failure tolerance using mirrors with good performance,
    while RAID 5/6 helps with failure tolerance by using parity blocks with great
    space efficiency. RAID 5/6 is only available on all-flash vSAN clusters, and when
    the Number of failures to tolerate (FTT) is set to `1` or `2`. A value of `1`
    FTT implies a RAID 5 configuration, and a value of 2 FTT implies a RAID 6 configuration.'
  prefs: []
  type: TYPE_NORMAL
- en: 'IOPS limit for object (performance): Default = 0'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: The IOPS limit for a disk IOPS is calculated as the number of
    I/Os using a defined size. It uses a base size of 32 KB by default, so a 64 KB
    I/O will represent 2 I/O. No limit policy is defined by setting the limit equal
    to `0`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Disable object checksum (override policy): Default = No'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: This setting determines whether checksums will be calculated for
    the data being written to the volume or not. Checksum calculation and error-correction
    are executed in the background.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Force provisioning (override policy): Default = No'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks:** Force provisioning overrides the current policy if it won''t comply
    with the available resources.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Object space reservation (thick provisioning %): Default value = 0, maximum
    = 100'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remarks**: It will help with a percentage of thick-provisioned storage objects
    upon VM creation, while the rest of the storage objects are thin-provisioned.
    When the expected amount of storage is already filled with objects, then it will
    help in reducing repeatable disk growth operation tasks.'
  prefs: []
  type: TYPE_NORMAL
- en: FTT policy with RAID configurations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Policies are configured based on application requirements and are applied based
    on the objects that are available. The following table lists the FTT policy options
    that are applied in different scenarios:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/699b2416-8bcb-4065-bae3-d691616a9d56.png)'
  prefs: []
  type: TYPE_IMG
- en: '**RAID-1** will be used for the **Fault Tolerance Method** on the host servers.
    If we are not using the HBA mode for the hosts, then we will have to RAID the
    individual disks as RAID 0\. Sometimes, RAID 5 and RAID 6 over the network are
    also referred to as erasure coding. This is done inline so that no post-processing
    is needed. Erasure coding distributes the **RAID5/6** stripe across multiple hosts
    without any overhead or need of data locality. **RAID-5** needs a minimum of **4**
    host clusters, with 3+1 logic, and has to sustain one node failure without data
    loss. This reduces disk capacity consumption. Erasure coding can guarantee capacity
    reduction. This policy can be executed on a per **v****irtual machine disk** (**VMDK**)
    file/disk using the SPDM system.'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The vSAN performance and health service helps with updated health checks for
    known issues and provides visibility to the end user. It will not help users collect
    the logs from a customer's site and send them in for support so that the development
    team will get the incident after the end user has logged a support ticket with
    issues. Instead, it helps with data that assists the engineering team in enhancing
    VMware products and related services, resolving issues, and recommend best practices
    to follow while implementing VMware solutions.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, [Chapter 3](6e95024c-c15b-43b6-80e8-7975b6bde0af.xhtml), *Security
    with Workspace One Intelligence*, we will learn about how customers are becoming
    increasingly pressured to provide more intelligent insights about their organizations
    and user behavior to deliver the best IT service possible. Having different tools
    and systems that house this insightful data across **mobile device management**
    (**MDM**), PC, and other third-party systems causes fragmentation of this data
    and inconsistency in the process of training, as well as the end user experience.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*VMware Virtual SAN Design and Sizing Guide*, at [https://www.vmware.com/files/pdf/products/vsan/VSAN_Design_and_Sizing_Guide.pdf](https://docs.vmware.com/en/VMware-vSphere/6.7/vsan-671-planning-deployment-guide.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*VMware Virtual SAN Health Check Plugin Guide*, at [http://www.vmware.com/files/pdf/products/vsan/VMW-GDL-VSAN-Health-Check.pdf](http://www.vmware.com/files/pdf/products/vsan/VMW-GDL-VSAN-Health-Check.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*vSphere 6.0 Configuration Maximums guide*, at [https://www.vmware.com/pdf/vsphere6/r60/vsphere-60-configuration-maximums.pdf](https://www.vmware.com/pdf/vsphere6/r60/vsphere-60-configuration-maximums.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Virtual SAN documentation from the vSphere Storage guide in the VMware vSphere
    Documentation*, at [https://www.vmware.com/support/pubs/vsphere-esxi-vcenter-server-pubs.html](https://www.vmware.com/support/pubs/vsphere-esxi-vcenter-server-pubs.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*VMware Virtual SAN section of Performance Best Practices for VMware vSphere
    6.0*, at [http://www.vmware.com/files/pdf/techpaper/VMware-PerfBest-Practices-vSphere6-0.pdf](http://www.vmware.com/files/pdf/techpaper/VMware-PerfBest-Practices-vSphere6-0.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Solutions for Poor Network Performance section of vSphere Monitoring and Performance
    vSphere 6.0*, at [https://pubs.vmware.com/vsphere-60/topic/com.vmware.ICbase/PDF/vsphere-esxi-vcenter-server-60-monitoring-performance-guide.pdf](https://pubs.vmware.com/vsphere-60/topic/com.vmware.ICbase/PDF/vsphere-esxi-vcenter-server-60-monitoring-performance-guide.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
