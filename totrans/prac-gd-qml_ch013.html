<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch013.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="12" id="chapter-5-qaoa-quantum-approximate-optimization-algorithm">
<h1 class="H1---Chapter chapterHead" data-number="12"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 5</span></span><br/>
<span id="x1-940005"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate Optimization Algorithm</span></span></h1>
<div class="flushright">
<p><em><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">True optimization is the revolutionary contribution of modern</span></em> <em><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">research to decision processes.</span></em><br/><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">
— George Dantzig</span></p>
</div>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">The techniques that we have introduced in the two previous chapters already allow us to solve combinatorial optimization problems on quantum computers. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">Specifically, we have studied how to write problems using the QUBO formalism and how to use quantum annealers to sample approximate solutions. </span><span class="koboSpan" id="kobo.6.3" xmlns="http://www.w3.org/1999/xhtml">This is an important approach to quantum optimization, but it is not the only one.</span></p>
<p><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we are going to show how the ideas that we have already explored can also be used on digital quantum computers. </span><span class="koboSpan" id="kobo.7.2" xmlns="http://www.w3.org/1999/xhtml">We will be using our beloved quantum circuits — with all their qubits, quantum gates, and measurements — to solve combinatorial optimization problems formulated in the QUBO framework.</span></p>
<p><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">More concretely, we will be </span><span id="dx1-94001"/><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">studying the famous </span><strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Approximate</span></strong> <strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">Optimization Algorithm</span></strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">QAOA</span></strong><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">), which is a gate-based algorithm that can be understood to be the counterpart to quantum annealing in the quantum circuit model. </span><span class="koboSpan" id="kobo.14.2" xmlns="http://www.w3.org/1999/xhtml">We will start by introducing all the theoretical concepts that are needed in order to understand this algorithm, then we will study the kind of circuits used in its implementation, and finally, we will explain how to run QAOA with both Qiskit and PennyLane.</span></p>
<p><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">After reading this chapter, you will understand how QAOA works, you will know how to design the circuits used in the algorithm, and you will be able to solve your own combinatorial optimization problems using QAOA in Qiskit and PennyLane.</span></p>
<p><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">The topics that we will cover in this chapter are the following:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">From adiabatic computing to QAOA</span></p></li>
<li><p><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">Using QAOA with Qiskit</span></p></li>
<li><p><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">Using QAOA with PennyLane</span></p></li>
</ul>
<section class="level2 sectionHead" data-number="12.1" id="from-adiabatic-computing-to-qaoa">
<h1 class="sectionHead" data-number="12.1"><span class="titlemark"><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">5.1 </span></span> <span id="x1-950005.1"><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">From adiabatic computing to QAOA</span></span></h1>
<p><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">In this first section, we will introduce all the theoretical concepts that will allow us to understand QAOA in depth. </span><span class="koboSpan" id="kobo.22.2" xmlns="http://www.w3.org/1999/xhtml">But before that, we will give an intuitive idea of how QAOA works by studying its relationship with quantum annealing. </span><span class="koboSpan" id="kobo.22.3" xmlns="http://www.w3.org/1999/xhtml">Sounds interesting? </span><span class="koboSpan" id="kobo.22.4" xmlns="http://www.w3.org/1999/xhtml">Then keep on reading, because here we go!</span></p>
<section class="level3 subsectionHead" data-number="12.1.1" id="discretizing-adiabatic-quantum-computing">
<h2 class="subsectionHead" data-number="12.1.1"><span class="titlemark"><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">5.1.1 </span></span> <span id="x1-960005.1.1"><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Discretizing adiabatic quantum computing</span></span></h2>
<p><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">In the previous chapter, we studied </span><span id="dx1-96001"/><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">adiabatic quantum computing and its practical realization, quantum annealing, and we learned how to use them in order to obtain approximate solutions to combinatorial optimization problems. </span><span class="koboSpan" id="kobo.26.2" xmlns="http://www.w3.org/1999/xhtml">Both of these techniques relied on the adiabatic theorem. </span><span class="koboSpan" id="kobo.26.3" xmlns="http://www.w3.org/1999/xhtml">When we applied them, we used a time-dependent Hamiltonian that induced a continuous transformation of the state of a quantum system: from an initial state to a final state that — hopefully — has a big overlap with the solution to our problem.</span></p>
<p><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">A natural question to ask is whether there is any sort of analog to this way of solving optimization problems for circuit-based quantum computers. </span><span class="koboSpan" id="kobo.27.2" xmlns="http://www.w3.org/1999/xhtml">At first sight, there is an apparent difficulty in this idea, because in the quantum circuit model we apply </span><em><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">instantaneous</span></em><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml"> operations — quantum gates — that change the state vector in discrete steps. </span><span class="koboSpan" id="kobo.29.2" xmlns="http://www.w3.org/1999/xhtml">How can we resolve this ”tension” between these discrete operations and the continuous evolution that we rely on for adiabatic quantum computing?</span></p>
<p><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">The answer is that we may </span><strong><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">discretize</span></strong><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml"> any continuous evolution, approximating it with a sequence of small, discrete changes. </span><span class="koboSpan" id="kobo.32.2" xmlns="http://www.w3.org/1999/xhtml">This process, </span><span id="dx1-96002"/><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">sometimes called </span><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">Trotterization</span></strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">, is the inspiration for the topic to which this chapter is devoted: the Quantum Approximate Optimization Algorithm — QAOA, for short.</span></p>
<p><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">QAOA was </span><span id="dx1-96003"/><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">initially proposed </span><span class="cite"><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xfarhi2014quantum"><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">37</span></a><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml"> as a </span><strong><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">discretization</span></strong><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml"> or Trotterization of adiabatic quantum computing with the goal of approximating the optimal solutions to combinatorial optimization problems. </span><span class="koboSpan" id="kobo.43.2" xmlns="http://www.w3.org/1999/xhtml">As you surely remember, the Hamiltonian that is used in adiabatic quantum computing — and in quantum annealing — is of the form</span></p>
<p><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t) = A(t)H_{0} + B(t)H_{1}," class="math display" src="../media/file546.png" style="vertical-align:middle" title="H(t) = A(t)H_{0} + B(t)H_{1},"/></span></p>
<p><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">with </span><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml"> two fixed Hamiltonians and </span><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(t)" class="math inline" src="../media/file623.png" style="vertical-align:middle" title="A(t)"/></span><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B(t)" class="math inline" src="../media/file624.png" style="vertical-align:middle" title="B(t)"/></span><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"> functions satisfying </span><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(0) = B(T) = 1" class="math inline" src="../media/file548.png" style="vertical-align:middle" title="A(0) = B(T) = 1"/></span><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A(T) = B(0) = 0" class="math inline" src="../media/file549.png" style="vertical-align:middle" title="A(T) = B(0) = 0"/></span><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml"> is the total time of the process. </span><span class="koboSpan" id="kobo.59.2" xmlns="http://www.w3.org/1999/xhtml">It turns out that the evolution of the quantum system is governed by the famous time-dependent Schrödinger equation, and if you can solve it, you will have an expression for the state vector of your system at any moment </span><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="t" class="math inline" src="../media/file48.png" style="vertical-align:middle" title="t"/></span><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml"> between </span><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">However, to understand QAOA we don’t need to learn how to solve the Schrödinger equation — that was close, but we managed to dodge the bullet! </span><span class="koboSpan" id="kobo.66.2" xmlns="http://www.w3.org/1999/xhtml">All that we need to know is that, applying discretization, we can express the solution as a product of operators of the form</span></p>
<p><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}}" class="math display" src="../media/file625.png" style="vertical-align:middle" title="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}}"/></span></p>
<p><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">applied to the initial state. </span><span class="koboSpan" id="kobo.68.2" xmlns="http://www.w3.org/1999/xhtml">Here, </span><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i" class="math inline" src="../media/file49.png" style="vertical-align:middle" title="i"/></span><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml"> is the imaginary unit, </span><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="t_{c}" class="math inline" src="../media/file626.png" style="vertical-align:middle" title="t_{c}"/></span><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml"> is a fixed time point in </span><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lbrack 0,T\rbrack" class="math inline" src="../media/file547.png" style="vertical-align:middle" title="\lbrack 0,T\rbrack"/></span><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\Delta t" class="math inline" src="../media/file627.png" style="vertical-align:middle" title="\Delta t"/></span><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"> is a small amount of time. </span><span class="koboSpan" id="kobo.76.2" xmlns="http://www.w3.org/1999/xhtml">The key idea is that in the interval </span><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\lbrack t_{c},t_{c} + \Delta t\rbrack" class="math inline" src="../media/file628.png" style="vertical-align:middle" title="\lbrack t_{c},t_{c} + \Delta t\rbrack"/></span><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml"> we assume that the Hamiltonian is constant and equal to </span><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H(t_{c}) = A(t_{c})H_{0} + B(t_{c})H_{1}" class="math inline" src="../media/file629.png" style="vertical-align:middle" title="H(t_{c}) = A(t_{c})H_{0} + B(t_{c})H_{1}"/></span><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.80.2" xmlns="http://www.w3.org/1999/xhtml">Of course, the smaller </span><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\Delta t" class="math inline" src="../media/file627.png" style="vertical-align:middle" title="\Delta t"/></span><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml"> is, the better this approximation will be. </span><span class="koboSpan" id="kobo.82.2" xmlns="http://www.w3.org/1999/xhtml">It is also important to notice that </span><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}}" class="math inline" src="../media/file630.png" style="vertical-align:middle" title="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}}"/></span><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> is a unitary transformation, just like the ones we studied in </span><em><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch008.xhtml#x1-180001"><em><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">1</span></em></a><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">Foundations of Quantum Computing</span></em><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.89.2" xmlns="http://www.w3.org/1999/xhtml">In fact, you surely </span><span id="dx1-96004"/><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">remember that some of the quantum gates that we introduced in that chapter, such as </span><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{X}" class="math inline" src="../media/file118.png" style="vertical-align:middle" title="R_{X}"/></span><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Y}" class="math inline" src="../media/file119.png" style="vertical-align:middle" title="R_{Y}"/></span><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">, are also exponentials of some matrices. </span><span class="koboSpan" id="kobo.96.2" xmlns="http://www.w3.org/1999/xhtml">Using this discretization technique, if </span><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml"> is the initial state, then the final state can be approximated by</span></p>
<p><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left( {\prod\limits_{m = 0}^{p}e^{i\Delta t{({A(t_{m})H_{0} + B(t_{m})H_{1}})}}} \right)\left| \psi_{0} \right\rangle," class="math display" src="../media/file632.png" style="vertical-align:middle" title="\left( {\prod\limits_{m = 0}^{p}e^{i\Delta t{({A(t_{m})H_{0} + B(t_{m})H_{1}})}}} \right)\left| \psi_{0} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="t_{m} = m\frac{\Delta t}{T}" class="math inline" src="../media/file633.png" style="vertical-align:middle" title="t_{m} = m\frac{\Delta t}{T}"/></span><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = \frac{T}{\Delta t}" class="math inline" src="../media/file634.png" style="vertical-align:middle" title="p = \frac{T}{\Delta t}"/></span><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">In order to compute this state with a quantum circuit, we just need an additional approximation. </span><span class="koboSpan" id="kobo.105.2" xmlns="http://www.w3.org/1999/xhtml">As you know, for any real numbers </span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a" class="math inline" src="../media/file16.png" style="vertical-align:middle" title="a"/></span><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="b" class="math inline" src="../media/file17.png" style="vertical-align:middle" title="b"/></span><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that </span><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{a + b} = e^{a}e^{b}" class="math inline" src="../media/file635.png" style="vertical-align:middle" title="e^{a + b} = e^{a}e^{b}"/></span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.111.2" xmlns="http://www.w3.org/1999/xhtml">The analogous identity for exponentials of matrices does not hold in general — unless the matrices commute. </span><span class="koboSpan" id="kobo.111.3" xmlns="http://www.w3.org/1999/xhtml">However, if </span><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\Delta t" class="math inline" src="../media/file627.png" style="vertical-align:middle" title="\Delta t"/></span><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml"> is small, then</span></p>
<p><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}} \approx e^{i\Delta tA(t_{c})H_{0}}e^{i\Delta tB(t_{c})H_{1}}," class="math display" src="../media/file636.png" style="vertical-align:middle" title="e^{i\Delta t{({A(t_{c})H_{0} + B(t_{c})H_{1}})}} \approx e^{i\Delta tA(t_{c})H_{0}}e^{i\Delta tB(t_{c})H_{1}},"/></span></p>
<p><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">which is </span><span id="dx1-96005"/><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">known as the </span><strong><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml">Lie-Trotter formula</span></strong><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">Putting it all together, the final state of the adiabatic evolution can be approximated by</span></p>
<p><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\prod\limits_{m = 0}^{p}e^{i\Delta tA(t_{m})H_{0}}e^{i\Delta tB(t_{m})H_{1}}\left| \psi_{0} \right\rangle," class="math display" src="../media/file637.png" style="vertical-align:middle" title="\prod\limits_{m = 0}^{p}e^{i\Delta tA(t_{m})H_{0}}e^{i\Delta tB(t_{m})H_{1}}\left| \psi_{0} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">which is the </span><span id="dx1-96006"/><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">inspiration for QAOA, as we will see in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="12.1.2" id="qaoa-the-algorithm">
<h2 class="subsectionHead" data-number="12.1.2"><span class="titlemark"><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">5.1.2 </span></span> <span id="x1-970005.1.2"><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: The algorithm</span></span></h2>
<p><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-97001"/><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">starting point and goal of QAOA are exactly the same as those of quantum annealing. </span><span class="koboSpan" id="kobo.126.2" xmlns="http://www.w3.org/1999/xhtml">We begin with a combinatorial optimization problem that we want to solve, and we encode it, as we learned in </span><em><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic</span></em> <em><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">Unconstrained Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">, into an Ising Hamiltonian </span><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.134.2" xmlns="http://www.w3.org/1999/xhtml">In order to find its ground state and solve our problem, we seek to apply a quantum state evolution similar to that of quantum annealing, but using a quantum circuit instead of a quantum annealer.</span></p>
<p><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">In light of the discretization of adiabatic evolution that we obtained at the end of the previous subsection, the idea behind QAOA is simple. </span><span class="koboSpan" id="kobo.135.2" xmlns="http://www.w3.org/1999/xhtml">In order to simulate with a quantum circuit the evolution of a state under a time-dependent Hamiltonian, you only need to take an initial state </span><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"> and then alternate for </span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml"> times the application of the operators </span><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\gamma H_{1}}" class="math inline" src="../media/file638.png" style="vertical-align:middle" title="e^{i\gamma H_{1}}"/></span><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\beta H_{0}}" class="math inline" src="../media/file639.png" style="vertical-align:middle" title="e^{i\beta H_{0}}"/></span><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml"> for some values of </span><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma" class="math inline" src="../media/file127.png" style="vertical-align:middle" title="\gamma"/></span><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta" class="math inline" src="../media/file126.png" style="vertical-align:middle" title="\beta"/></span><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, by the way, we will see that the unitary transformations </span><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\gamma H_{1}}" class="math inline" src="../media/file638.png" style="vertical-align:middle" title="e^{i\gamma H_{1}}"/></span><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\beta H_{0}}" class="math inline" src="../media/file639.png" style="vertical-align:middle" title="e^{i\beta H_{0}}"/></span><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"> can be implemented with just one-qubit and two-qubit quantum gates.</span></p>
<p><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">What we are doing is, then, using a quantum circuit to prepare a state of the form</span></p>
<p><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\beta_{p}H_{0}}e^{i\gamma_{p}H_{1}}\ldots e^{i\beta_{2}H_{0}}e^{i\gamma_{2}H_{1}}e^{i\beta_{1}H_{0}}e^{i\gamma_{1}H_{1}}\left| \psi_{0} \right\rangle," class="math display" src="../media/file640.png" style="vertical-align:middle" title="e^{i\beta_{p}H_{0}}e^{i\gamma_{p}H_{1}}\ldots e^{i\beta_{2}H_{0}}e^{i\gamma_{2}H_{1}}e^{i\beta_{1}H_{0}}e^{i\gamma_{1}H_{1}}\left| \psi_{0} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p \geq 1" class="math inline" src="../media/file641.png" style="vertical-align:middle" title="p \geq 1"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.156.2" xmlns="http://www.w3.org/1999/xhtml">Usually, we collect all the coefficients in the exponents in two tuples </span><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta} = (\beta_{1},\ldots,\beta_{p})" class="math inline" src="../media/file642.png" style="vertical-align:middle" title="\mathbf{\beta} = (\beta_{1},\ldots,\beta_{p})"/></span><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma} = (\gamma_{1},\ldots,\gamma_{p})" class="math inline" src="../media/file643.png" style="vertical-align:middle" title="\mathbf{\gamma} = (\gamma_{1},\ldots,\gamma_{p})"/></span><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml"> and we denote the whole state by </span><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml">In QAOA, we choose a fixed value of </span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"> and we have some values for </span><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.169.2" xmlns="http://www.w3.org/1999/xhtml">Instead of thinking of the values for </span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml"> as small increments of time multiplied by intensity coefficients given by the functions </span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">, as we did in the previous subsection, we’ll just consider them to be ”plain real numbers.” </span><span class="koboSpan" id="kobo.177.2" xmlns="http://www.w3.org/1999/xhtml">And this is where the magic kicks in. </span><span class="koboSpan" id="kobo.177.3" xmlns="http://www.w3.org/1999/xhtml">Since we are now free to choose their values as we see fit…why not choose the </span><em><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">best</span></em><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml"> possible values for them?</span></p>
<p><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">But what does </span><em><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">best</span></em><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"> mean here? </span><span class="koboSpan" id="kobo.182.2" xmlns="http://www.w3.org/1999/xhtml">Remember that we are just trying to find the ground state of </span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml">, so, for us, the lower the value of the energy </span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file647.png" style="vertical-align:middle" title="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">, the better. </span><span class="koboSpan" id="kobo.186.2" xmlns="http://www.w3.org/1999/xhtml">In this way, we have transformed our </span><span id="dx1-97002"/><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">optimization problem into another one: finding the values </span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> that minimize</span></p>
<p><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma}) = \left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle." class="math display" src="../media/file648.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma}) = \left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, since the values </span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml"> are real and so is the energy </span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">, what we have in our hands is the old problem of finding a minimum for a real-valued function with real inputs. </span><span class="koboSpan" id="kobo.199.2" xmlns="http://www.w3.org/1999/xhtml">There are many algorithms that we can apply for this, for instance, the famous </span><strong><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">gradient descent algorithm</span></strong><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">, which we will be using to train </span><span id="dx1-97003"/><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">machine learning models in </span><em><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">Part</span></em> <em/> <a href="ch016.xhtml#x1-138000III"><em><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">III</span></em></a><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">A Match Made in Heaven:</span></em> <em><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Machine Learning</span></em><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">, of this book. </span><span class="koboSpan" id="kobo.208.2" xmlns="http://www.w3.org/1999/xhtml">However, there is an important twist. </span><span class="koboSpan" id="kobo.208.3" xmlns="http://www.w3.org/1999/xhtml">As we know, the number of amplitudes needed to describe a state like </span><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"> is exponential in the number of qubits that we are using. </span><span class="koboSpan" id="kobo.210.2" xmlns="http://www.w3.org/1999/xhtml">Thus, computing </span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml"> may be difficult with just a classical computer.</span></p>
<p><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">But it turns out that estimating values of </span><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"> is something that we can do very efficiently with a quantum computer — at least when the number of terms in </span><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"> is polynomial in the number of qubits, something that is usually the case in the problems we are interested in. </span><span class="koboSpan" id="kobo.217.2" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will explain in detail how to compute that kind of estimation, but for now just keep in mind that, given some values </span><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">, we can rely on the quantum computer to compute </span><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can take any classical algorithm for function minimization and, whenever it needs to compute a value of the </span><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml"> function, we use a quantum computer to estimate it and we give that value back to the classical algorithm until it needs another of value </span><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.228.2" xmlns="http://www.w3.org/1999/xhtml">At that moment, we again use the quantum computer to obtain it and so on and so forth, all until we meet the stopping criteria of the classical algorithm. </span><span class="koboSpan" id="kobo.228.3" xmlns="http://www.w3.org/1999/xhtml">This is what we </span><span id="dx1-97004"/><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">call a </span><strong><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">hybrid algorithm</span></strong><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">, one where the classical and the quantum computer work in tandem to solve a problem. </span><span class="koboSpan" id="kobo.231.2" xmlns="http://www.w3.org/1999/xhtml">We will see this kind of interaction many more times throughout the book.</span></p>
<p><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">Once we have obtained the optimal values </span><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta^{\ast}}" class="math inline" src="../media/file650.png" style="vertical-align:middle" title="\mathbf{\beta^{\ast}}"/></span><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma^{\ast}}" class="math inline" src="../media/file651.png" style="vertical-align:middle" title="\mathbf{\gamma^{\ast}}"/></span><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"> — or, at least, an estimation of them — we can use the </span><span id="dx1-97005"/><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">quantum computer once more in order to prepare the state </span><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle" class="math inline" src="../media/file652.png" style="vertical-align:middle" title="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle"/></span><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.243.2" xmlns="http://www.w3.org/1999/xhtml">This state should have a sizeable overlap with the ground state of </span><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">, so when we measure it in the computational basis, we will have a good chance of obtaining a string of zeros and ones that is a good solution to our original problem — the one encoded in </span><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml"> by using the techniques of </span><em><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained</span></em> <em><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">We now have all the pieces of the puzzle, so let’s put them all together. </span><span class="koboSpan" id="kobo.254.2" xmlns="http://www.w3.org/1999/xhtml">The input to QAOA is an Ising Hamiltonian </span><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">, the ground state of which we wish to approximate because it encodes the solution to a certain combinatorial optimization problem. </span><span class="koboSpan" id="kobo.256.2" xmlns="http://www.w3.org/1999/xhtml">To that end, we consider the energy function </span><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml"> as defined before and we proceed to minimize it. </span><span class="koboSpan" id="kobo.258.2" xmlns="http://www.w3.org/1999/xhtml">For that, we choose </span><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p \geq 1" class="math inline" src="../media/file641.png" style="vertical-align:middle" title="p \geq 1"/></span><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml"> and some initial values </span><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta_{0}}" class="math inline" src="../media/file653.png" style="vertical-align:middle" title="\mathbf{\beta_{0}}"/></span><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma_{0}}" class="math inline" src="../media/file654.png" style="vertical-align:middle" title="\mathbf{\gamma_{0}}"/></span><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"> that we shall use as the starting point for some classical minimization algorithm. </span><span class="koboSpan" id="kobo.264.2" xmlns="http://www.w3.org/1999/xhtml">Then, we run the minimization algorithm and, whenever it requests an evaluation of </span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> on some points </span><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">, we use the quantum computer to prepare the state </span><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"> and estimate its energy, and we return the value to the classical algorithm. </span><span class="koboSpan" id="kobo.272.2" xmlns="http://www.w3.org/1999/xhtml">We continue this process until the classical minimization algorithm stops, returning some optimal values </span><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta^{\ast}}" class="math inline" src="../media/file650.png" style="vertical-align:middle" title="\mathbf{\beta^{\ast}}"/></span><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma^{\ast}}" class="math inline" src="../media/file651.png" style="vertical-align:middle" title="\mathbf{\gamma^{\ast}}"/></span><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.276.2" xmlns="http://www.w3.org/1999/xhtml">As a final step, we use the quantum computer to prepare </span><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle" class="math inline" src="../media/file652.png" style="vertical-align:middle" title="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle"/></span><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.278.2" xmlns="http://www.w3.org/1999/xhtml">When we measure it, we obtain a — hopefully, good — approximate solution to our combinatorial problem.</span></p>
<p><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">We have collected all these steps as pseudocode in the following algorithm. </span><span class="koboSpan" id="kobo.279.2" xmlns="http://www.w3.org/1999/xhtml">Notice that there are just two points at which the quantum computer is required. </span><span id="x1-97006r1"/></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-97007r1"/> <strong><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">Algorithm 5.1</span></strong><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml"> (QAOA)</span><strong><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml">.</span></strong> </span><span id="x1-97008"/></p>
<div class="algorithmic">
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml"> Choose a value for </span><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml"> Choose a starting set of values </span><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta} = (\beta_{1},\ldots,\beta_{p})" class="math inline" src="../media/file642.png" style="vertical-align:middle" title="\mathbf{\beta} = (\beta_{1},\ldots,\beta_{p})"/></span><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma} = (\gamma_{1},\ldots,\gamma_{p})" class="math inline" src="../media/file643.png" style="vertical-align:middle" title="\mathbf{\gamma} = (\gamma_{1},\ldots,\gamma_{p})"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"> <strong><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">while</span></strong><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml"> the stopping criteria are not met </span><strong><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">do</span></strong> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml"> Prepare state </span><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">    </span><span id="textcolor1"><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\vartriangleright" class="math inline" src="../media/file655.png" style="vertical-align:middle" title="\vartriangleright"/></span> <em><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">This</span></em> <em><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">is done on the quantum computer!</span></em></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"> From measurements of </span><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">, estimate </span><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E(\mathbf{\beta},\mathbf{\gamma})" class="math inline" src="../media/file649.png" style="vertical-align:middle" title="E(\mathbf{\beta},\mathbf{\gamma})"/></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"> Update </span><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"> according to the minimization algorithm </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml"> - </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> Obtain the optimal values </span><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta^{\ast}}" class="math inline" src="../media/file650.png" style="vertical-align:middle" title="\mathbf{\beta^{\ast}}"/></span><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma^{\ast}}" class="math inline" src="../media/file651.png" style="vertical-align:middle" title="\mathbf{\gamma^{\ast}}"/></span><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml"> returned by the minimization algorithm </span></span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml"> Prepare state </span><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle" class="math inline" src="../media/file652.png" style="vertical-align:middle" title="\left| {\mathbf{\beta^{\ast}},\mathbf{\gamma^{\ast}}} \right\rangle"/></span><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">    </span><span id="textcolor2"><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\vartriangleright" class="math inline" src="../media/file655.png" style="vertical-align:middle" title="\vartriangleright"/></span> <em><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">This</span></em> <em><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">is done on the quantum computer!</span></em></span> </span><br/>
<span class="label-5.475pt"> </span> <span class="algorithmic"><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml"> Measure the state to obtain an approximate solution </span></span>
</div>
</div>
<div class="tcolorbox learnmore" id="tcolobox-107">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">Just before bringing this subsection to an end, we thought this could be a good time for us to share a historical fact with you.</span></p>
<p><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">When it was introduced in a 2014 paper </span><span class="cite"><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xfarhi2014quantum"><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml">37</span></a><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">, QAOA provided a better ratio of approximation for the Max-Cut problem than any existing classical algorithm that would run on polynomial time. </span><span class="koboSpan" id="kobo.327.2" xmlns="http://www.w3.org/1999/xhtml">And we say that it </span><em><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">provided</span></em><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml"> because, soon after, this claim was challenged by a paper </span><span class="cite"><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xbarak2015beating"><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">11</span></a><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> that presented a classical algorithm that could beat QAOA.</span></p>
<p><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">What can we say? </span><span class="koboSpan" id="kobo.334.2" xmlns="http://www.w3.org/1999/xhtml">Sometimes classics refuse to die!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-97009"/><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">description of QAOA that we have discussed may seem a little bit abstract. </span><span class="koboSpan" id="kobo.336.2" xmlns="http://www.w3.org/1999/xhtml">But don’t worry. </span><span class="koboSpan" id="kobo.336.3" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will make all of this much more concrete, because we will be studying in detail the quantum circuits that are needed to implement the parts of the algorithm that run on quantum computers.</span></p>
</section>
<section class="level3 subsectionHead" data-number="12.1.3" id="circuits-for-qaoa">
<h2 class="subsectionHead" data-number="12.1.3"><span class="titlemark"><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">5.1.3 </span></span> <span id="x1-980005.1.3"><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">Circuits for QAOA</span></span></h2>
<p><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">As we have just seen, quantum </span><span id="dx1-98001"/><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">computers are only used at certain steps in QAOA. </span><span class="koboSpan" id="kobo.340.2" xmlns="http://www.w3.org/1999/xhtml">And, in fact, those steps always involve the </span><span id="dx1-98002"/><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">preparation of a state of the form</span></p>
<p><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = e^{i\beta_{p}H_{0}}e^{i\gamma_{p}H_{1}}\ldots e^{i\beta_{2}H_{0}}e^{i\gamma_{2}H_{1}}e^{i\beta_{1}H_{0}}e^{i\gamma_{1}H_{1}}\left| \psi_{0} \right\rangle," class="math display" src="../media/file656.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = e^{i\beta_{p}H_{0}}e^{i\gamma_{p}H_{1}}\ldots e^{i\beta_{2}H_{0}}e^{i\gamma_{2}H_{1}}e^{i\beta_{1}H_{0}}e^{i\gamma_{1}H_{1}}\left| \psi_{0} \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi_{0} \right\rangle" class="math inline" src="../media/file631.png" style="vertical-align:middle" title="\left| \psi_{0} \right\rangle"/></span><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"> is the ground state of </span><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.347.2" xmlns="http://www.w3.org/1999/xhtml">Of course, we need to prepare the state with adequate quantum gates on a quantum circuit, so let’s analyze the operations that we need to perform. </span><span class="koboSpan" id="kobo.347.3" xmlns="http://www.w3.org/1999/xhtml">A crucial observation is that the Hamiltonians </span><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"> take a very specific form. </span><span class="koboSpan" id="kobo.351.2" xmlns="http://www.w3.org/1999/xhtml">As we studied in the previous chapter, </span><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"> is usually taken to be </span><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- {\sum}_{j = 0}^{n - 1}X_{j}" class="math inline" src="../media/file657.png" style="vertical-align:middle" title="- {\sum}_{j = 0}^{n - 1}X_{j}"/></span><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">, while </span><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"> is an Ising Hamiltonian of the form</span></p>
<p><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- \sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - \sum\limits_{j}h_{j}Z_{j}," class="math display" src="../media/file554.png" style="vertical-align:middle" title="- \sum\limits_{j,k}J_{jk}Z_{j}Z_{k} - \sum\limits_{j}h_{j}Z_{j},"/></span></p>
<p><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">where the coefficients </span><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml"> are real numbers.</span></p>
<p><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-98003"/><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">ground state of </span><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\otimes}_{i = 0}^{n - 1}\left| + \right\rangle" class="math inline" src="../media/file557.png" style="vertical-align:middle" title="{\otimes}_{i = 0}^{n - 1}\left| + \right\rangle"/></span><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">, as you proved in </span><em><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">Exercise</span></em> <em/> <a href="ch012.xhtml#x1-77004x4.2"><em><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">4.2</span></em></a><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.372.2" xmlns="http://www.w3.org/1999/xhtml">This state can be easily prepared: starting from </span><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">, you just need to use a Hadamard gate on each qubit of the circuit.</span></p>
<p><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">That was easy, so let’s now focus on the </span><span id="dx1-98004"/><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">operations of the form </span><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\beta_{k}H_{0}}" class="math inline" src="../media/file658.png" style="vertical-align:middle" title="e^{i\beta_{k}H_{0}}"/></span><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">, with </span><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{j}" class="math inline" src="../media/file659.png" style="vertical-align:middle" title="\beta_{j}"/></span><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml"> a real number. </span><span class="koboSpan" id="kobo.380.2" xmlns="http://www.w3.org/1999/xhtml">Notice that </span><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}" class="math inline" src="../media/file555.png" style="vertical-align:middle" title="H_{0} = - {\sum}_{j = 0}^{n - 1}X_{j}"/></span><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml"> and that all the </span><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X_{j}" class="math inline" src="../media/file556.png" style="vertical-align:middle" title="X_{j}"/></span><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml"> matrices commute with each other, so we can replace the exponential of the sum with the product of the exponentials. </span><span class="koboSpan" id="kobo.384.2" xmlns="http://www.w3.org/1999/xhtml">Therefore, it holds that</span></p>
<p><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\beta_{k}H_{0}} = e^{- i\beta_{k}\sum\limits_{j = 0}^{n - 1}X_{j}} = \prod\limits_{j = 0}^{n - 1}e^{- i\beta_{k}X_{j}}." class="math display" src="../media/file660.png" style="vertical-align:middle" title="e^{i\beta_{k}H_{0}} = e^{- i\beta_{k}\sum\limits_{j = 0}^{n - 1}X_{j}} = \prod\limits_{j = 0}^{n - 1}e^{- i\beta_{k}X_{j}}."/></span></p>
<p><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">But </span><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\beta X_{j}}" class="math inline" src="../media/file661.png" style="vertical-align:middle" title="e^{- i\beta X_{j}}"/></span><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml"> is the expression for the rotation gate </span><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{X}(2\beta)" class="math inline" src="../media/file662.png" style="vertical-align:middle" title="R_{X}(2\beta)"/></span><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">, so this means that we just need to apply this gate to each of the qubits in our circuit. </span><span class="koboSpan" id="kobo.390.2" xmlns="http://www.w3.org/1999/xhtml">Neat, isn’t it?</span></p>
<p><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">The last type of operation that we need to translate into quantum gates is </span><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\gamma_{l}H_{1}}" class="math inline" src="../media/file663.png" style="vertical-align:middle" title="e^{i\gamma_{l}H_{1}}"/></span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"> for any real coefficient </span><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{l}" class="math inline" src="../media/file664.png" style="vertical-align:middle" title="\gamma_{l}"/></span><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.395.2" xmlns="http://www.w3.org/1999/xhtml">We know that </span><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> is a sum of terms of the form </span><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}Z_{j}Z_{k}" class="math inline" src="../media/file665.png" style="vertical-align:middle" title="J_{jk}Z_{j}Z_{k}"/></span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}Z_{j}" class="math inline" src="../media/file666.png" style="vertical-align:middle" title="h_{j}Z_{j}"/></span><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.401.2" xmlns="http://www.w3.org/1999/xhtml">Again, these matrices commute with each other, so we get</span></p>
<p><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\gamma_{l}H_{1}} = e^{- i\gamma_{l}(\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} + \sum\limits_{j}h_{j}Z_{j})} = \prod\limits_{j,k}e^{- i\gamma_{l}J_{jk}Z_{j}Z_{k}}\prod\limits_{j}e^{- i\gamma_{l}h_{j}Z_{j}}." class="math display" src="../media/file667.png" style="vertical-align:middle" title="e^{i\gamma_{l}H_{1}} = e^{- i\gamma_{l}(\sum\limits_{j,k}J_{jk}Z_{j}Z_{k} + \sum\limits_{j}h_{j}Z_{j})} = \prod\limits_{j,k}e^{- i\gamma_{l}J_{jk}Z_{j}Z_{k}}\prod\limits_{j}e^{- i\gamma_{l}h_{j}Z_{j}}."/></span></p>
<p><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">Similar to the case of </span><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">, the operations of the form </span><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\gamma_{l}h_{j}Z_{j}}" class="math inline" src="../media/file668.png" style="vertical-align:middle" title="e^{- i\gamma_{l}h_{j}Z_{j}}"/></span><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml"> can be carried out with rotation gates </span><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.409.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we only need to learn how to implement </span><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\gamma_{l}J_{jk}Z_{j}Z_{k}}" class="math inline" src="../media/file669.png" style="vertical-align:middle" title="e^{- i\gamma_{l}J_{jk}Z_{j}Z_{k}}"/></span><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.411.2" xmlns="http://www.w3.org/1999/xhtml">To keep things simple, let’s denote the real number </span><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{l}J_{jk}" class="math inline" src="../media/file670.png" style="vertical-align:middle" title="\gamma_{l}J_{jk}"/></span><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml"> by </span><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a" class="math inline" src="../media/file16.png" style="vertical-align:middle" title="a"/></span><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.415.2" xmlns="http://www.w3.org/1999/xhtml">Notice that </span><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j}Z_{k}}" class="math inline" src="../media/file671.png" style="vertical-align:middle" title="e^{- iaZ_{j}Z_{k}}"/></span><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml"> is the exponential of a diagonal matrix, because </span><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}Z_{k}" class="math inline" src="../media/file363.png" style="vertical-align:middle" title="Z_{j}Z_{k}"/></span><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml"> is the tensor product of diagonal matrices. </span><span class="koboSpan" id="kobo.419.2" xmlns="http://www.w3.org/1999/xhtml">In fact, it holds that if </span><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml"> is a computational basis state in which qubits </span><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml"> have the same value, then</span></p>
<p><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j}Z_{k}}\left| x \right\rangle = e^{- ia}\left| x \right\rangle." class="math display" src="../media/file672.png" style="vertical-align:middle" title="e^{- iaZ_{j}Z_{k}}\left| x \right\rangle = e^{- ia}\left| x \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, if qubits </span><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"> have different values, then</span></p>
<p><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j}Z_{k}}\left| x \right\rangle = e^{ia}\left| x \right\rangle." class="math display" src="../media/file673.png" style="vertical-align:middle" title="e^{- iaZ_{j}Z_{k}}\left| x \right\rangle = e^{ia}\left| x \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-98005"/><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">unitary action is implemented by the </span><span id="dx1-98006"/><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">circuit in </span><em><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.1"><em><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">5.1</span></em></a><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">, where, for simplicity, we have only depicted qubits </span><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"> — the action on the rest of the qubits would be the identity gate.</span></p>
<figure>
<span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.1: Implementation of e^{- iaZ_{j}Z_{k}}" src="../media/file674.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.1"><strong><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.1</span></strong><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">Implementation of </span><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j}Z_{k}}" class="math inline" src="../media/file671.png" style="vertical-align:middle" title="e^{- iaZ_{j}Z_{k}}"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">We now have all the elements in place, so let’s illustrate them with an example. </span><span class="koboSpan" id="kobo.448.2" xmlns="http://www.w3.org/1999/xhtml">Imagine that the Ising Hamiltonian of your problem is </span><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}" class="math inline" src="../media/file675.png" style="vertical-align:middle" title="3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}"/></span><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.450.2" xmlns="http://www.w3.org/1999/xhtml">Then, the circuit used by QAOA to prepare </span><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 1" class="math inline" src="../media/file676.png" style="vertical-align:middle" title="p = 1"/></span><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml"> is the one shown in </span><em><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.2"><em><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">5.2</span></em></a><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.2: QAOA circuit with p = 1" src="../media/file677.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.2"><strong><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.2</span></strong><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">QAOA circuit with </span><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 1" class="math inline" src="../media/file676.png" style="vertical-align:middle" title="p = 1"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">Notice how we first prepare the ground state of </span><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml"> with a column of Hadamard gates. </span><span class="koboSpan" id="kobo.465.2" xmlns="http://www.w3.org/1999/xhtml">Then, we have the implementation of </span><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i3\gamma_{1}Z_{0}Z_{2}}" class="math inline" src="../media/file678.png" style="vertical-align:middle" title="e^{- i3\gamma_{1}Z_{0}Z_{2}}"/></span><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml"> with a CNOT gate between qubits </span><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">, an </span><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml"> gate on qubit </span><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">, and another CNOT gate between qubits </span><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.479.2" xmlns="http://www.w3.org/1999/xhtml">The implementation of </span><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{i\gamma_{1}Z_{1}Z_{2}}" class="math inline" src="../media/file679.png" style="vertical-align:middle" title="e^{i\gamma_{1}Z_{1}Z_{2}}"/></span><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml"> is similar, but on qubits </span><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.485.2" xmlns="http://www.w3.org/1999/xhtml">Then, we use an </span><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml"> gate on qubit </span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml"> to implement </span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i2\gamma_{1}Z_{0}}" class="math inline" src="../media/file680.png" style="vertical-align:middle" title="e^{- i2\gamma_{1}Z_{0}}"/></span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.491.2" xmlns="http://www.w3.org/1999/xhtml">Finally, a column of </span><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{X}" class="math inline" src="../media/file118.png" style="vertical-align:middle" title="R_{X}"/></span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml"> gates implements </span><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\beta_{1}{\sum}_{j}X_{j}}" class="math inline" src="../media/file681.png" style="vertical-align:middle" title="e^{- i\beta_{1}{\sum}_{j}X_{j}}"/></span><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.495.2" xmlns="http://www.w3.org/1999/xhtml">If we increased the number of </span><strong><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">layers</span></strong> <span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">, the </span><span id="dx1-98011"/><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">circuit would grow by repeating for another </span><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p - 1" class="math inline" src="../media/file682.png" style="vertical-align:middle" title="p - 1"/></span><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml"> times the very same </span><span id="dx1-98012"/><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">circuit structure shown in </span><em><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.2"><em><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">5.2</span></em></a><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml"> except for the initial Hadamard gates. </span><span class="koboSpan" id="kobo.505.2" xmlns="http://www.w3.org/1999/xhtml">Additionally, we would have to replace the parameters </span><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1}" class="math inline" src="../media/file683.png" style="vertical-align:middle" title="\gamma_{1}"/></span><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1}" class="math inline" src="../media/file684.png" style="vertical-align:middle" title="\beta_{1}"/></span><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"> by </span><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{2}" class="math inline" src="../media/file685.png" style="vertical-align:middle" title="\gamma_{2}"/></span><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{2}" class="math inline" src="../media/file686.png" style="vertical-align:middle" title="\beta_{2}"/></span><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml"> in the second layer, by </span><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{3}" class="math inline" src="../media/file687.png" style="vertical-align:middle" title="\gamma_{3}"/></span><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{3}" class="math inline" src="../media/file688.png" style="vertical-align:middle" title="\beta_{3}"/></span><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml"> in the third, and so on and so forth.</span></p>
<div class="tcolorbox questionx" id="tcolobox-108">
<span id="x1-98014x5.1.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.1</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">Obtain the QAOA circuit for </span><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{1}Z_{3} + Z_{0}Z_{2} - 2Z_{1} + 3Z_{2}" class="math inline" src="../media/file689.png" style="vertical-align:middle" title="Z_{1}Z_{3} + Z_{0}Z_{2} - 2Z_{1} + 3Z_{2}"/></span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 1" class="math inline" src="../media/file676.png" style="vertical-align:middle" title="p = 1"/></span><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know all the circuits that we need for QAOA, let’s study how to use them in order to estimate the energy of the states </span><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</section>
<section class="level3 subsectionHead" data-number="12.1.4" id="estimating-the-energy">
<h2 class="subsectionHead" data-number="12.1.4"><span class="titlemark"><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">5.1.4 </span></span> <span id="x1-990005.1.4"><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">Estimating the energy</span></span></h2>
<p><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-99001"/><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml">circuits that we have just studied allow us to prepare any state of the form </span><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.532.2" xmlns="http://www.w3.org/1999/xhtml">But we are not interested in the states themselves. </span><span class="koboSpan" id="kobo.532.3" xmlns="http://www.w3.org/1999/xhtml">What we need is their energy with respect to </span><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">, because that is the quantity that we want to minimize. </span><span class="koboSpan" id="kobo.534.2" xmlns="http://www.w3.org/1999/xhtml">That is, we need to evaluate </span><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file647.png" style="vertical-align:middle" title="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">, but, of course, we don’t have access to the state vector because we are preparing the state with a quantum computer. </span><span class="koboSpan" id="kobo.536.2" xmlns="http://www.w3.org/1999/xhtml">So, what can we do?</span></p>
<p><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml">The key observation here is that we already know how to evaluate efficiently </span><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"> for any basis state </span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.541.2" xmlns="http://www.w3.org/1999/xhtml">In fact, </span><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml"> is the value of </span><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"> in the cost function of our combinatorial optimization problem, because we derived </span><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml"> from it. </span><span class="koboSpan" id="kobo.547.2" xmlns="http://www.w3.org/1999/xhtml">So, for instance, if we are trying to solve a Max-Cut problem, each </span><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml"> represents a cut and we can easily compute — with a classical computer — the cost of that cut, as we did in </span><em><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-620003.1.2"><em><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">3.1.2</span></em></a><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">What is more, we can also evaluate </span><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml"> directly from the expression of the Hamiltonian. </span><span class="koboSpan" id="kobo.555.2" xmlns="http://www.w3.org/1999/xhtml">We only need to notice that </span><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j}\left| x \right\rangle = 1" class="math inline" src="../media/file691.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j}\left| x \right\rangle = 1"/></span><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"> if the </span><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">-th bit of </span><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml"> and that </span><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j}\left| x \right\rangle = - 1" class="math inline" src="../media/file692.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j}\left| x \right\rangle = - 1"/></span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.565.2" xmlns="http://www.w3.org/1999/xhtml">In a similar way, </span><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle = 1" class="math inline" src="../media/file693.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle = 1"/></span><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml"> if the </span><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">-th and </span><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">-th bits of </span><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml"> are equal and </span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle = - 1" class="math inline" src="../media/file694.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle = - 1"/></span><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml"> if they are different.</span></p>
<p><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">Then, by linearity, we can easily evaluate </span><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.578.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if </span><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}" class="math inline" src="../media/file695.png" style="vertical-align:middle" title="H_{1} = 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}"/></span><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">, we will have</span></p>
<p><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {101} \right|H_{1}\left| {101} \right\rangle = 3\left\langle {101} \right|Z_{0}Z_{2}\left| {101} \right\rangle - \left\langle {101} \right|Z_{1}Z_{2}\left| {101} \right\rangle + 2\left\langle {101} \right|Z_{0}\left| {101} \right\rangle = 3 + 1 - 2 = 4." class="math display" src="../media/file696.png" style="vertical-align:middle" title="\left\langle {101} \right|H_{1}\left| {101} \right\rangle = 3\left\langle {101} \right|Z_{0}Z_{2}\left| {101} \right\rangle - \left\langle {101} \right|Z_{1}Z_{2}\left| {101} \right\rangle + 2\left\langle {101} \right|Z_{0}\left| {101} \right\rangle = 3 + 1 - 2 = 4."/></span></p>
<div class="tcolorbox questionx" id="tcolobox-109">
<span id="x1-99003x5.1.4"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.2</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">Evaluate </span><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|H_{1}\left| {100} \right\rangle" class="math inline" src="../media/file697.png" style="vertical-align:middle" title="\left\langle {100} \right|H_{1}\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}" class="math inline" src="../media/file695.png" style="vertical-align:middle" title="H_{1} = 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}"/></span><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml">We also know that we can always write </span><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml"> as a linear </span><span id="dx1-99004"/><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">combination of basis states. </span><span class="koboSpan" id="kobo.591.2" xmlns="http://www.w3.org/1999/xhtml">Namely, we have</span></p>
<p><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = \sum\limits_{x}a_{x}\left| x \right\rangle" class="math display" src="../media/file698.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = \sum\limits_{x}a_{x}\left| x \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">for certain amplitudes </span><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{x}" class="math inline" src="../media/file699.png" style="vertical-align:middle" title="a_{x}"/></span><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{x}\left| a_{x} \right|^{2} = 1" class="math inline" src="../media/file371.png" style="vertical-align:middle" title="{\sum}_{x}\left| a_{x} \right|^{2} = 1"/></span><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">But then it holds that</span></p>
<p><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = \left( {\sum\limits_{y}a_{y}^{\ast}\left\langle y \right|} \right)H_{1}\left( {\sum\limits_{x}a_{x}\left| x \right\rangle} \right) = \sum\limits_{y}\sum\limits_{x}a_{y}^{\ast}a_{x}\left\langle y \right|H_{1}\left| x \right\rangle = \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|H_{1}\left| x \right\rangle," class="math display" src="../media/file700.png" style="vertical-align:middle" title="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle = \left( {\sum\limits_{y}a_{y}^{\ast}\left\langle y \right|} \right)H_{1}\left( {\sum\limits_{x}a_{x}\left| x \right\rangle} \right) = \sum\limits_{y}\sum\limits_{x}a_{y}^{\ast}a_{x}\left\langle y \right|H_{1}\left| x \right\rangle = \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|H_{1}\left| x \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">because </span><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}\left| x \right\rangle" class="math inline" src="../media/file701.png" style="vertical-align:middle" title="H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml"> is always a multiple of </span><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml"> (just notice that </span><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml"> is a diagonal matrix because it is a sum of diagonal matrices), because </span><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \middle| x \right\rangle = 0" class="math inline" src="../media/file366.png" style="vertical-align:middle" title="\left\langle y \middle| x \right\rangle = 0"/></span><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml"> when </span><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y \neq x" class="math inline" src="../media/file702.png" style="vertical-align:middle" title="y \neq x"/></span><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml">, and because </span><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{x}^{\ast}a_{x} = \left| a_{x} \right|^{2}" class="math inline" src="../media/file369.png" style="vertical-align:middle" title="a_{x}^{\ast}a_{x} = \left| a_{x} \right|^{2}"/></span><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml">Now, since we can compute </span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml"> easily with the classical computer, we have reduced our problem to computing the values </span><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| a_{x} \right|^{2}" class="math inline" src="../media/file372.png" style="vertical-align:middle" title="\left| a_{x} \right|^{2}"/></span><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.617.2" xmlns="http://www.w3.org/1999/xhtml">But </span><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| a_{x} \right|^{2}" class="math inline" src="../media/file372.png" style="vertical-align:middle" title="\left| a_{x} \right|^{2}"/></span><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml"> is the probability of measuring </span><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml"> when the state </span><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml"> is prepared — this is the reason why, back in </span><em><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic</span></em> <em><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml">Unconstrained Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml">, we referred to expressions of the form </span><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{1}\left| \psi \right\rangle" class="math inline" src="../media/file703.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{1}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml"> as expectation values; they are indeed the expected or average energy under </span><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml"> when we measure the state </span><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml">!</span></p>
<p><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml">From this observation, it follows that we can use the quantum computer to prepare </span><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml"> and measure it </span><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="M" class="math inline" src="../media/file704.png" style="vertical-align:middle" title="M"/></span><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml"> times to make the estimation</span></p>
<p><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle \approx \sum\limits_{x}\frac{m_{x}}{M}\left\langle x \right|H_{1}\left| x \right\rangle," class="math display" src="../media/file705.png" style="vertical-align:middle" title="\left\langle {\mathbf{\beta},\mathbf{\gamma}} \right|H_{1}\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle \approx \sum\limits_{x}\frac{m_{x}}{M}\left\langle x \right|H_{1}\left| x \right\rangle,"/></span></p>
<p><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m_{x}" class="math inline" src="../media/file706.png" style="vertical-align:middle" title="m_{x}"/></span><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml"> is the number of times that </span><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml"> was measured. </span><span class="koboSpan" id="kobo.646.2" xmlns="http://www.w3.org/1999/xhtml">Of course, the higher the value of </span><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="M" class="math inline" src="../media/file704.png" style="vertical-align:middle" title="M"/></span><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">, the better this approximation will be.</span></p>
<div class="tcolorbox important" id="tcolobox-110">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">In the process of estimating the energies of all the different states prepared with quantum computers, we will compute the cost, for our optimization problem, of many binary strings </span><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.652.2" xmlns="http://www.w3.org/1999/xhtml">Of course, it would be wise for us to always keep the best </span><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"> seen during the optimization process. </span><span class="koboSpan" id="kobo.654.2" xmlns="http://www.w3.org/1999/xhtml">Occasionally, it might be even better than the ones we obtain when measuring the final state </span><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta}^{\ast},\mathbf{\gamma}^{\ast}} \right\rangle" class="math inline" src="../media/file707.png" style="vertical-align:middle" title="\left| {\mathbf{\beta}^{\ast},\mathbf{\gamma}^{\ast}} \right\rangle"/></span><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">We’ve now covered all that we needed to know about the inner workings of QAOA. </span><span class="koboSpan" id="kobo.657.2" xmlns="http://www.w3.org/1999/xhtml">Before we move on to show how to implement and use this </span><span id="dx1-99005"/><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml">algorithm with Qiskit and PennyLane, we will introduce a little perk that we get from the fact that we are no longer using quantum annealers, but universal quantum computers instead. </span><span class="koboSpan" id="kobo.658.2" xmlns="http://www.w3.org/1999/xhtml">This will help us in formulating some problems in a more natural way, as we will show in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="12.1.5" id="qubo-and-hobo">
<h2 class="subsectionHead" data-number="12.1.5"><span class="titlemark"><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">5.1.5 </span></span> <span id="x1-1000005.1.5"><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">QUBO and HOBO</span></span></h2>
<p><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml">Up to this point, we have only considered problems that can be written under the QUBO formalism. </span><span class="koboSpan" id="kobo.661.2" xmlns="http://www.w3.org/1999/xhtml">That is, minimization problems in which the cost function is a quadratic polynomial on binary variables that had no constraints on the values they could take. </span><span class="koboSpan" id="kobo.661.3" xmlns="http://www.w3.org/1999/xhtml">This is less restricting than it may seem, because QUBO is </span><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">-hard and there are many important problems that we can rewrite via reductions, as we saw in </span><em><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-680003.4"><em><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">3.4</span></em></a><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">However, consider a problem like the </span><span id="dx1-100001"/><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">famous </span><strong><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml">satisfiability</span></strong><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">SAT</span></strong><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.672.2" xmlns="http://www.w3.org/1999/xhtml">In it, we are given a Boolean formula on binary variables and we have to determine whether there is any assignment of values that makes the formula true. </span><span class="koboSpan" id="kobo.672.3" xmlns="http://www.w3.org/1999/xhtml">For example, we may receive</span></p>
<p><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2})," class="math display" src="../media/file708.png" style="vertical-align:middle" title="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2}),"/></span></p>
<p><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">which is </span><strong><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">satisfiable</span></strong><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml"> (by assigning </span><em><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">true</span></em><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml"> to all the variables, for instance). </span><span class="koboSpan" id="kobo.678.2" xmlns="http://www.w3.org/1999/xhtml">Or we can be given</span></p>
<p><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} \land \neg x_{0}," class="math display" src="../media/file709.png" style="vertical-align:middle" title="x_{0} \land \neg x_{0},"/></span></p>
<p><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml">which is clearly </span><strong><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">unsatisfiable</span></strong><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml">SAT is </span><span id="dx1-100002"/><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">easily seen to be in </span><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"> (and, in fact, it is </span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml">-complete — see </span><em><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml">Section 7.4</span></em><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml"> in Sipser’s book </span><span class="cite"><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsipser2012introduction"><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml">90</span></a><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.694.2" xmlns="http://www.w3.org/1999/xhtml">Then, we know that there must be a way of rewriting any SAT instance in the QUBO formalism. </span><span class="koboSpan" id="kobo.694.3" xmlns="http://www.w3.org/1999/xhtml">But the task becomes much easier if we relax the conditions in the QUBO formulation by allowing binary polynomials of </span><em><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml">any order</span></em><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.696.2" xmlns="http://www.w3.org/1999/xhtml">Let’s see why!</span></p>
<p><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">Let us consider, for the sake of an example, the formula </span><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2})" class="math inline" src="../media/file710.png" style="vertical-align:middle" title="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2})"/></span><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.699.2" xmlns="http://www.w3.org/1999/xhtml">We’ll show how it can be represented as the polynomial</span></p>
<p><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p(x_{0},x_{1},x_{2}) = (1 - x_{0})x_{1}(1 - x_{2}) + x_{0}(1 - x_{1})x_{2} + (1 - x_{0})(1 - x_{1})(1 - x_{2})," class="math display" src="../media/file711.png" style="vertical-align:middle" title="p(x_{0},x_{1},x_{2}) = (1 - x_{0})x_{1}(1 - x_{2}) + x_{0}(1 - x_{1})x_{2} + (1 - x_{0})(1 - x_{1})(1 - x_{2}),"/></span></p>
<p><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">on the binary variables </span><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1}" class="math inline" src="../media/file712.png" style="vertical-align:middle" title="x_{1}"/></span><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2}" class="math inline" src="../media/file444.png" style="vertical-align:middle" title="x_{2}"/></span><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.707.2" xmlns="http://www.w3.org/1999/xhtml">Let’s say that we consider some assignment of truth values for the variables in the original formula, and we set </span><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{i} = 1" class="math inline" src="../media/file713.png" style="vertical-align:middle" title="x_{i} = 1"/></span><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml"> in the polynomial if </span><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{i}" class="math inline" src="../media/file714.png" style="vertical-align:middle" title="x_{i}"/></span><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml"> is true and </span><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{i} = 0" class="math inline" src="../media/file715.png" style="vertical-align:middle" title="x_{i} = 0"/></span><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml"> if </span><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{i}" class="math inline" src="../media/file714.png" style="vertical-align:middle" title="x_{i}"/></span><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml"> is false. </span><span class="koboSpan" id="kobo.715.2" xmlns="http://www.w3.org/1999/xhtml">It’s easy to see that the original formula will be true under this assignment if and only if </span><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p(x_{0},x_{1},x_{2}) = 0" class="math inline" src="../media/file716.png" style="vertical-align:middle" title="p(x_{0},x_{1},x_{2}) = 0"/></span><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml">, and that it will be false if and only if </span><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p(x_{0},x_{1},x_{2}) &gt; 0" class="math inline" src="../media/file717.png" style="vertical-align:middle" title="p(x_{0},x_{1},x_{2}) &gt; 0"/></span><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.719.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if the polynomial </span><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml"> for some values of its variables, then the original formula must be satisfiable. </span><span class="koboSpan" id="kobo.723.2" xmlns="http://www.w3.org/1999/xhtml">Otherwise, it has to be unsatisfiable.</span></p>
<p><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can rewrite our original problem as follows:</span></p>
<p><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {(1 - x_{0})x_{1}(1 - x_{2}) + x_{0}(1 - x_{1})x_{2} + (1 - x_{0})(1 - x_{1})(1 - x_{2})\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ &amp; \qquad &amp; &amp; \\ \end{array}" class="math display" src="../media/file718.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {(1 - x_{0})x_{1}(1 - x_{2}) + x_{0}(1 - x_{1})x_{2} + (1 - x_{0})(1 - x_{1})(1 - x_{2})\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\  &amp; \qquad &amp; &amp; \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">If the minimum of the polynomial is </span><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">, then the formula will be satisfiable. </span><span class="koboSpan" id="kobo.728.2" xmlns="http://www.w3.org/1999/xhtml">Otherwise, the formula will be unsatisfiable.</span></p>
<p><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">With a simple transformation, we have been able to reformulate our problem as something that looks very much like a QUBO instance. </span><span class="koboSpan" id="kobo.729.2" xmlns="http://www.w3.org/1999/xhtml">But wait! </span><span class="koboSpan" id="kobo.729.3" xmlns="http://www.w3.org/1999/xhtml">This is </span><em><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">not</span></em><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml"> a QUBO problem. </span><span class="koboSpan" id="kobo.731.2" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-100003"/><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">reason is that the degree of the binary polynomial is </span><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml"> and not </span><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml">, as you can easily check by expanding its expression. </span><span class="koboSpan" id="kobo.736.2" xmlns="http://www.w3.org/1999/xhtml">These optimization problems in which we are asked to minimize a binary polynomial — of any degree — with no </span><span id="dx1-100004"/><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml">additional restrictions are called </span><strong><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml">Higher Order Binary Optimization</span></strong><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">HOBO</span></strong><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml">) or </span><strong><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml">Polynomial Unconstrained Binary Optimization</span></strong><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">PUBO</span></strong><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">) problems, for </span><span id="dx1-100005"/><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml">obvious reasons.</span></p>
<p><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">The method that we have applied is quite general. </span><span class="koboSpan" id="kobo.747.2" xmlns="http://www.w3.org/1999/xhtml">In fact, it is easy to see that we can apply it to any Boolean formula that is given as conjunctions of disjunctions of variables and negations of variables. </span><span class="koboSpan" id="kobo.747.3" xmlns="http://www.w3.org/1999/xhtml">Something like, for instance, </span><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2})" class="math inline" src="../media/file710.png" style="vertical-align:middle" title="(x_{0} \vee \neg x_{1} \vee x_{2}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2}) \land (x_{0} \vee x_{1} \vee x_{2})"/></span><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0} \vee x_{1} \vee \neg x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2} \vee \neg x_{3})" class="math inline" src="../media/file719.png" style="vertical-align:middle" title="(x_{0} \vee x_{1} \vee \neg x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2} \vee \neg x_{3})"/></span><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.751.2" xmlns="http://www.w3.org/1999/xhtml">We say that these </span><span id="dx1-100006"/><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml">formulas are in </span><strong><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">conjunctive normal form</span></strong><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">CNF</span></strong><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.756.2" xmlns="http://www.w3.org/1999/xhtml">In this case, we can just obtain an associated polynomial consisting of a sum of products. </span><span class="koboSpan" id="kobo.756.3" xmlns="http://www.w3.org/1999/xhtml">Each product will correspond to one of the disjunctions of the formula. </span><span class="koboSpan" id="kobo.756.4" xmlns="http://www.w3.org/1999/xhtml">If a variable </span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml"> appears negated in the disjunction, it will appear as </span><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml"> in the product. </span><span class="koboSpan" id="kobo.760.2" xmlns="http://www.w3.org/1999/xhtml">If it appears in positive form, it will appear as </span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1 - x" class="math inline" src="../media/file720.png" style="vertical-align:middle" title="1 - x"/></span><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml"> in the product.</span></p>
<div class="tcolorbox questionx" id="tcolobox-111">
<span id="x1-100008x5.1.5"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.3</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">Write the HOBO version of the SAT problem with the Boolean formula</span></p>
<span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0} \vee x_{1} \vee \neg x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2} \vee \neg x_{3})." class="math display" src="../media/file721.png" style="vertical-align:middle" title="(x_{0} \vee x_{1} \vee \neg x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee x_{2} \vee x_{3}) \land (\neg x_{0} \vee x_{1} \vee \neg x_{2} \vee \neg x_{3})."/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">And what about Boolean formulas that are not in CNF? </span><span class="koboSpan" id="kobo.766.2" xmlns="http://www.w3.org/1999/xhtml">In this case, we can apply a method, called the </span><strong><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml">Tseitin transformation</span></strong><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">, that runs in </span><span id="dx1-100009"/><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">polynomial time and gives us a </span><span id="dx1-100010"/><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">formula in CNF that is satisfiable if and only if the original formula was satisfiable (see </span><span class="cite"><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xbiere2009handbook"><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">17</span></a><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml">, Chapter 2]</span></span><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml"> for more details). </span><span class="koboSpan" id="kobo.774.2" xmlns="http://www.w3.org/1999/xhtml">In fact, the resulting formula will be in </span><strong><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">3-CNF</span></strong><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">, meaning that the disjunctions will involve at most three variables or negations of variables. </span><span class="koboSpan" id="kobo.776.2" xmlns="http://www.w3.org/1999/xhtml">This is very convenient, because it guarantees that the process of expanding the polynomial to obtain the coefficients will be efficient.</span></p>
<p><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">But enough about satisfiability. </span><span class="koboSpan" id="kobo.777.2" xmlns="http://www.w3.org/1999/xhtml">Let’s come back to HOBO problems. </span><span class="koboSpan" id="kobo.777.3" xmlns="http://www.w3.org/1999/xhtml">How can we solve them? </span><span class="koboSpan" id="kobo.777.4" xmlns="http://www.w3.org/1999/xhtml">One way of doing this is by transforming them into QUBO problems. </span><span class="koboSpan" id="kobo.777.5" xmlns="http://www.w3.org/1999/xhtml">There are different techniques for rewriting HOBO problems as QUBO instances by introducing auxiliary variables. </span><span class="koboSpan" id="kobo.777.6" xmlns="http://www.w3.org/1999/xhtml">For example, you can substitute products </span><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="xy" class="math inline" src="../media/file722.png" style="vertical-align:middle" title="xy"/></span><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml"> by a new binary variable </span><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z" class="math inline" src="../media/file81.png" style="vertical-align:middle" title="z"/></span><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml"> as long as you introduce a penalty term </span><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="xy - 2xz - 2yz + 3z" class="math inline" src="../media/file723.png" style="vertical-align:middle" title="xy - 2xz - 2yz + 3z"/></span><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">, which is </span><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml"> if and only if </span><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="xy = z" class="math inline" src="../media/file724.png" style="vertical-align:middle" title="xy = z"/></span><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.787.2" xmlns="http://www.w3.org/1999/xhtml">In this way, you can reduce a term of order </span><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m + 1" class="math inline" src="../media/file725.png" style="vertical-align:middle" title="m + 1"/></span><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml"> such as </span><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}x_{1}\cdots x_{m}" class="math inline" src="../media/file726.png" style="vertical-align:middle" title="x_{0}x_{1}\cdots x_{m}"/></span><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml"> to a term of order </span><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m" class="math inline" src="../media/file259.png" style="vertical-align:middle" title="m"/></span><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml"> of the form </span><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="zx_{2}\cdots x_{m}" class="math inline" src="../media/file727.png" style="vertical-align:middle" title="zx_{2}\cdots x_{m}"/></span><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml"> and a quadratic penalty term on </span><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0},x_{1}" class="math inline" src="../media/file728.png" style="vertical-align:middle" title="x_{0},x_{1}"/></span><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z" class="math inline" src="../media/file81.png" style="vertical-align:middle" title="z"/></span><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.799.2" xmlns="http://www.w3.org/1999/xhtml">By repeating this process as many times as needed, you can obtain an equivalent problem in which the objective function is a binary quadratic polynomial. </span><span class="koboSpan" id="kobo.799.3" xmlns="http://www.w3.org/1999/xhtml">Transformations of this kind are used in D-Wave’s Ocean, where you can find </span><code><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml">BinaryPolynomial</span></code><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml"> objects that you can reduce to polynomials of degree </span><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml"> with the </span><code><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">make_quadratic</span></code><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml"> function.</span></p>
<p><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">However, if you are using QAOA, you can deal with </span><span id="dx1-100011"/><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml">HOBO problems directly. </span><span class="koboSpan" id="kobo.807.2" xmlns="http://www.w3.org/1999/xhtml">We can consider a binary polynomial of any degree and transform it using the techniques of </span><em><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-670003.3"><em><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml">3.3</span></em></a><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.810.2" xmlns="http://www.w3.org/1999/xhtml">We will end up having a Hamiltonian that is a sum of tensor products of </span><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}" class="math inline" src="../media/file384.png" style="vertical-align:middle" title="Z_{j}"/></span><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml"> matrices. </span><span class="koboSpan" id="kobo.812.2" xmlns="http://www.w3.org/1999/xhtml">The only difference is that, now, these products can involve more than just one or two </span><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}" class="math inline" src="../media/file384.png" style="vertical-align:middle" title="Z_{j}"/></span><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml"> matrices.</span></p>
<p><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml">This implies that, when we set out to create a circuit for </span><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\gamma_{l}H_{1}}" class="math inline" src="../media/file729.png" style="vertical-align:middle" title="e^{- i\gamma_{l}H_{1}}"/></span><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml">, we may need to implement unitary operations of the form </span><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}" class="math inline" src="../media/file730.png" style="vertical-align:middle" title="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}"/></span><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml">, with </span><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="m &gt; 2" class="math inline" src="../media/file731.png" style="vertical-align:middle" title="m &gt; 2"/></span><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.821.2" xmlns="http://www.w3.org/1999/xhtml">But that is not much more difficult than implementing </span><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j}Z_{k}}" class="math inline" src="../media/file671.png" style="vertical-align:middle" title="e^{- iaZ_{j}Z_{k}}"/></span><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.823.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we can almost repeat the argument in </span><em><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-980005.1.3"><em><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml">5.1.3</span></em></a><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">, because both </span><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}" class="math inline" src="../media/file732.png" style="vertical-align:middle" title="Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}"/></span><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}" class="math inline" src="../media/file730.png" style="vertical-align:middle" title="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}"/></span><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml"> are diagonal matrices. </span><span class="koboSpan" id="kobo.830.2" xmlns="http://www.w3.org/1999/xhtml">In fact, if </span><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml"> is a basis state, then</span></p>
<p><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}\left| x \right\rangle = e^{- ia}\left| x \right\rangle" class="math display" src="../media/file733.png" style="vertical-align:middle" title="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}\left| x \right\rangle = e^{- ia}\left| x \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">if the sum of the bits of </span><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml"> in positions </span><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{1},j_{2},\ldots,j_{m}" class="math inline" src="../media/file734.png" style="vertical-align:middle" title="j_{1},j_{2},\ldots,j_{m}"/></span><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml"> is even, and</span></p>
<p><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}\left| x \right\rangle = e^{ia}\left| x \right\rangle" class="math display" src="../media/file735.png" style="vertical-align:middle" title="e^{- iaZ_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}}\left| x \right\rangle = e^{ia}\left| x \right\rangle"/></span></p>
<p><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml">if the sum is odd.</span></p>
<p><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml">This unitary action can be implemented by using consecutive CNOT gates with control qubits in </span><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{1},j_{2},\ldots,j_{m - 1}" class="math inline" src="../media/file736.png" style="vertical-align:middle" title="j_{1},j_{2},\ldots,j_{m - 1}"/></span><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml"> and targets in </span><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{m}" class="math inline" src="../media/file737.png" style="vertical-align:middle" title="j_{m}"/></span><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">, then an </span><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="R_{Z}" class="math inline" src="../media/file120.png" style="vertical-align:middle" title="R_{Z}"/></span><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml"> gate with parameter </span><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2a" class="math inline" src="../media/file738.png" style="vertical-align:middle" title="2a"/></span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml"> on qubit </span><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{m}" class="math inline" src="../media/file737.png" style="vertical-align:middle" title="j_{m}"/></span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml"> and, again, consecutive CNOT gates with control qubits in </span><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{m - 1},j_{m - 2},\ldots,j_{1}" class="math inline" src="../media/file739.png" style="vertical-align:middle" title="j_{m - 1},j_{m - 2},\ldots,j_{1}"/></span><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml"> and targets in </span><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{m}" class="math inline" src="../media/file737.png" style="vertical-align:middle" title="j_{m}"/></span><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">. </span><em><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.3"><em><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">5.3</span></em></a><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml"> illustrates this procedure for the case of </span><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{0}Z_{1}Z_{3}}" class="math inline" src="../media/file740.png" style="vertical-align:middle" title="e^{- iaZ_{0}Z_{1}Z_{3}}"/></span><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml">, under the assumption that we only have four qubits.</span></p>
<figure>
<span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.3: Implementation of e^{- iaZ_{0}Z_{1}Z_{3}}" src="../media/file741.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.3"><strong><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.3</span></strong><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml">Implementation of </span><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- iaZ_{0}Z_{1}Z_{3}}" class="math inline" src="../media/file740.png" style="vertical-align:middle" title="e^{- iaZ_{0}Z_{1}Z_{3}}"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml">Of course, this </span><span id="dx1-100014"/><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">operation would be just one part in the implementation of </span><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\gamma_{l}H_{1}}" class="math inline" src="../media/file729.png" style="vertical-align:middle" title="e^{- i\gamma_{l}H_{1}}"/></span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml"> and we would need to repeat a similar process for each term of the Hamiltonian.</span></p>
<div class="tcolorbox questionx" id="tcolobox-112">
<span id="x1-100016x5.1.5"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.4</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">Implement, in a circuit with 5 qubits, the operation </span><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="e^{- i\frac{\pi}{4}Z_{0}Z_{2}Z_{4}}" class="math inline" src="../media/file742.png" style="vertical-align:middle" title="e^{- i\frac{\pi}{4}Z_{0}Z_{2}Z_{4}}"/></span><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we can also estimate the energy of a Hamiltonian </span><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml"> that includes tensor products of </span><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml"> matrices in a way that is very similar to the one that we explained in </span><em><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-990005.1.4"><em><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml">5.1.4</span></em></a><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.881.2" xmlns="http://www.w3.org/1999/xhtml">The key fact is that, for any basis state </span><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that</span></p>
<p><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}\left| x \right\rangle = 1" class="math display" src="../media/file743.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}\left| x \right\rangle = 1"/></span></p>
<p><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml">if the sum of the bits of </span><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml"> in positions </span><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{1},j_{2},\ldots,j_{m}" class="math inline" src="../media/file734.png" style="vertical-align:middle" title="j_{1},j_{2},\ldots,j_{m}"/></span><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml"> is even, and</span></p>
<p><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}\left| x \right\rangle = - 1" class="math display" src="../media/file744.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j_{1}}Z_{j_{2}}\cdots Z_{j_{m}}\left| x \right\rangle = - 1"/></span></p>
<p><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">otherwise. </span><span class="koboSpan" id="kobo.891.2" xmlns="http://www.w3.org/1999/xhtml">By linearity, we can then evaluate </span><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|H_{1}\left| x \right\rangle" class="math inline" src="../media/file690.png" style="vertical-align:middle" title="\left\langle x \right|H_{1}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml"> and, from that, we can estimate </span><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{1}\left| \psi \right\rangle" class="math inline" src="../media/file703.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{1}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml"> by measuring </span><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml"> a number of times, exactly as we did in </span><em><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-990005.1.4"><em><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">5.1.4</span></em></a><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox questionx" id="tcolobox-113">
<span id="x1-100018x5.1.5"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.5</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">Evaluate </span><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|H_{1}\left| {100} \right\rangle" class="math inline" src="../media/file697.png" style="vertical-align:middle" title="\left\langle {100} \right|H_{1}\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = Z_{0}Z_{1}Z_{2} + 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}" class="math inline" src="../media/file745.png" style="vertical-align:middle" title="H_{1} = Z_{0}Z_{1}Z_{2} + 3Z_{0}Z_{2} - Z_{1}Z_{2} + 2Z_{0}"/></span><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">We have now covered all the necessary concepts to understand QAOA in all its glory. </span><span class="koboSpan" id="kobo.907.2" xmlns="http://www.w3.org/1999/xhtml">In the next two sections, we will show how to implement and run this algorithm with both Qiskit and PennyLane.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="12.2" id="using-qaoa-with-qiskit">
<h1 class="sectionHead" data-number="12.2"><span class="titlemark"><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml">5.2 </span></span> <span id="x1-1010005.2"><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">Using QAOA with Qiskit</span></span></h1>
<p><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml">With </span><span id="dx1-101001"/><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml">everything that we have learned in the previous sections of this chapter and what we already know about Qiskit from </span><em><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch009.xhtml#x1-400002"><em><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml">2</span></em></a><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml">The</span></em> <em><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml">Tools of the Trade in Quantum Computing</span></em><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><em><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch011.xhtml#x1-660003.2.2"><em><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml">3.2.2</span></em></a><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">, we could implement our own Qiskit version of QAOA. </span><span class="koboSpan" id="kobo.920.2" xmlns="http://www.w3.org/1999/xhtml">However, there is no need for that! </span><span class="koboSpan" id="kobo.920.3" xmlns="http://www.w3.org/1999/xhtml">As we shall show in this section, the Qiskit Optimization package provides all that is necessary to run QAOA on both quantum simulators and actual quantum computers. </span><span class="koboSpan" id="kobo.920.4" xmlns="http://www.w3.org/1999/xhtml">Moreover, it includes a set of tools to work directly with problems written under the QUBO formalism. </span><span class="koboSpan" id="kobo.920.5" xmlns="http://www.w3.org/1999/xhtml">As a matter of fact, in this section, we will also see how, underneath the hood, Qiskit uses the very same mathematical concepts that we have been studying.</span></p>
<p><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start by explaining how to work with QAOA in Qiskit when we already have the problem Hamiltonian.</span></p>
<section class="level3 subsectionHead" data-number="12.2.1" id="using-qaoa-with-hamiltonians">
<h2 class="subsectionHead" data-number="12.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">5.2.1 </span></span> <span id="x1-1020005.2.1"><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml">Using QAOA with Hamiltonians</span></span></h2>
<p><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml">If we have the Hamiltonian </span><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"> that encodes our </span><span id="dx1-102001"/><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">optimization problem, it is very easy to use Qiskit’s QAOA implementation to approximate its ground state. </span><span class="koboSpan" id="kobo.927.2" xmlns="http://www.w3.org/1999/xhtml">Let’s start with a simple example in which we have </span><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = Z_{0}Z_{1}" class="math inline" src="../media/file746.png" style="vertical-align:middle" title="H_{1} = Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.929.2" xmlns="http://www.w3.org/1999/xhtml">We can create this </span><span id="dx1-102002"/><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian and prepare the corresponding QAOA circuit with the following lines of code:</span></p>
<p><span id="x1-102003"/></p>
<pre class="lstlisting" id="listing-110"><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.opflow import Z 
 
from qiskit.algorithms import QAOA 
 
 
 
H1 = Z^Z # Define Z_0Z_1 
 
qaoa = QAOA() 
 
circuit = qaoa.construct_circuit([1,2],H1)[0] 
 
circuit.draw(output="mpl")
</span></pre>
<p><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml">As a result, we will obtain the circuit shown in </span><em><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.4"><em><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml">5.4</span></em></a><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.935.2" xmlns="http://www.w3.org/1999/xhtml">We can see how it starts with two Hadamard gates, which are then followed by the exponential of </span><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml"> and then the exponential of </span><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml"> (because </span><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0} = X_{0}X_{1} = X_{0}I + IX_{1}" class="math inline" src="../media/file747.png" style="vertical-align:middle" title="H_{0} = X_{0}X_{1} = X_{0}I + IX_{1}"/></span><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.941.2" xmlns="http://www.w3.org/1999/xhtml">This is exactly the circuit that we derived in the first part of the chapter.</span></p>
<figure>
<span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.4: QAOA circuit for H_{1} = Z_{0}Z_{1}" src="../media/file748.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.4"><strong><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.4</span></strong><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml">QAOA circuit for </span><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = Z_{0}Z_{1}" class="math inline" src="../media/file746.png" style="vertical-align:middle" title="H_{1} = Z_{0}Z_{1}"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml">In order to create the circuit, in addition to </span><code><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml">H1</span></code><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml">, we’ve passed </span><code><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">[1,2]</span></code><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"> to the method called </span><code><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml">construct_circuit</span></code><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.953.2" xmlns="http://www.w3.org/1999/xhtml">This list </span><span id="dx1-102013"/><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml">contains the </span><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml"> parameters that we want to use. </span><span class="koboSpan" id="kobo.958.2" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.4"><em><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml">5.4</span></em></a><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml">, this is indicated by the </span><span id="dx1-102014"/><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml">numbers below the exponentials in the gate boxes. </span><span class="koboSpan" id="kobo.962.2" xmlns="http://www.w3.org/1999/xhtml">Notice that this means that the first element in </span><code><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml">[1,2]</span></code><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"> is what we call </span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1}" class="math inline" src="../media/file684.png" style="vertical-align:middle" title="\beta_{1}"/></span><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml"> and the second is </span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1}" class="math inline" src="../media/file683.png" style="vertical-align:middle" title="\gamma_{1}"/></span><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.968.2" xmlns="http://www.w3.org/1999/xhtml">Also notice that we have used </span><code><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml">[0]</span></code><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml"> after the call to </span><code><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml">construct_circuit</span></code><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.972.2" xmlns="http://www.w3.org/1999/xhtml">This is because this method, in general, returns a list of several circuits — but in this case, there is only one, which is the one that we pick.</span></p>
<p><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml">We can visualize the circuit in more detail by decomposing the exponentials — that is, transforming them into simpler gates — a couple of times. </span><span class="koboSpan" id="kobo.973.2" xmlns="http://www.w3.org/1999/xhtml">For that, we may use</span></p>
<pre class="lstlisting" id="listing-111"><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml">

circuit.decompose().decompose().draw(output="mpl")
</span></pre>
<p><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">to get the circuit shown in </span><em><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.5"><em><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">5.5</span></em></a><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.978.2" xmlns="http://www.w3.org/1999/xhtml">The sequence of gates in that circuit is exactly the one that we would expect from our derivations earlier in this chapter, because </span><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. U(\pi\slash 2,0,\pi) = H \right." class="math inline" src="../media/file749.png" style="vertical-align:middle" title="\left. U(\pi\slash 2,0,\pi) = H \right."/></span><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml">, as you can easily check from the definition that we gave in </span><em><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-250001.3.4"><em><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml">1.3.4</span></em></a><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U_{3}" class="math inline" src="../media/file750.png" style="vertical-align:middle" title="U_{3}"/></span><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml"> is Qiskit’s name for our </span><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="U" class="math inline" src="../media/file51.png" style="vertical-align:middle" title="U"/></span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"> gate).</span></p>
<figure>
<span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.5: QAOA circuit for H_{1} = Z_{0}Z_{1}, more detailed" src="../media/file751.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.5"><strong><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.5</span></strong><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">QAOA circuit for </span><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = Z_{0}Z_{1}" class="math inline" src="../media/file746.png" style="vertical-align:middle" title="H_{1} = Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">, more detailed</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml">By default, the value of </span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p" class="math inline" src="../media/file141.png" style="vertical-align:middle" title="p"/></span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"> for QAOA in Qiskit is </span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.998.2" xmlns="http://www.w3.org/1999/xhtml">However, we can change it by using the </span><code><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml">reps</span></code><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml"> parameter when calling the class constructor. </span><span class="koboSpan" id="kobo.1000.2" xmlns="http://www.w3.org/1999/xhtml">For instance, the following code can be used to obtain the QAOA circuit for </span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 2" class="math inline" src="../media/file752.png" style="vertical-align:middle" title="p = 2"/></span><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1} = 1" class="math inline" src="../media/file753.png" style="vertical-align:middle" title="\beta_{1} = 1"/></span><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{2} = 2" class="math inline" src="../media/file754.png" style="vertical-align:middle" title="\beta_{2} = 2"/></span><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1} = 3" class="math inline" src="../media/file755.png" style="vertical-align:middle" title="\gamma_{1} = 3"/></span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{2} = 4" class="math inline" src="../media/file756.png" style="vertical-align:middle" title="\gamma_{2} = 4"/></span><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<pre class="lstlisting" id="listing-112"><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">

qaoa = QAOA(reps = 2) 
 
circuit = qaoa.construct_circuit([1,2,3,4],H1)[0] 
 
circuit.decompose().decompose().draw(output="mpl")
</span></pre>
<p><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml">The result of the </span><span id="dx1-102021"/><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">execution is the circuit shown in </span><em><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure5.6"><em><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml">5.6</span></em></a><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure>
<span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 5.6: QAOA circuit for H_{1} = Z_{0}Z_{1} with p = 2" src="../media/file757.png"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure5.6"><strong><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml">Figure 5.6</span></strong><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">QAOA circuit for </span><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1} = Z_{0}Z_{1}" class="math inline" src="../media/file746.png" style="vertical-align:middle" title="H_{1} = Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 2" class="math inline" src="../media/file752.png" style="vertical-align:middle" title="p = 2"/></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">All this is well and good, but we haven’t yet solved any optimization problems! </span><span class="koboSpan" id="kobo.1026.2" xmlns="http://www.w3.org/1999/xhtml">For that, we need to pass two </span><span id="dx1-102024"/><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml">additional parameters when creating a </span><code><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">QAOA</span></code><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml"> object. </span><span class="koboSpan" id="kobo.1029.2" xmlns="http://www.w3.org/1999/xhtml">The first one is a </span><code><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1031.2" xmlns="http://www.w3.org/1999/xhtml">That is, some backend capable of executing the QAOA quantum circuit to evaluate the energy of the </span><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle" class="math inline" src="../media/file644.png" style="vertical-align:middle" title="\left| {\mathbf{\beta},\mathbf{\gamma}} \right\rangle"/></span><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml"> states. </span><span class="koboSpan" id="kobo.1033.2" xmlns="http://www.w3.org/1999/xhtml">The second one is a classical optimizer, which will set initial values for </span><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">, use the </span><code><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml"> to evaluate state energies, and update the </span><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\beta}" class="math inline" src="../media/file645.png" style="vertical-align:middle" title="\mathbf{\beta}"/></span><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\mathbf{\gamma}" class="math inline" src="../media/file646.png" style="vertical-align:middle" title="\mathbf{\gamma}"/></span><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml"> parameters in order to optimize them, until some stopping criterion is met.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-114">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml">The choice of classical optimizer can have a big impact on the execution time and quality of the solutions obtained with QAOA.</span></p>
<p><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml">For some insights into this, you can refer to </span><span class="cite"><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xfernandez2022study"><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml">39</span></a><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">In the following piece of code, we give an example of how to create the quantum instance and the classical minimizer objects, and of how to use them with QAOA to solve a simple problem:</span></p>
<pre class="lstlisting" id="listing-113"><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.utils import algorithm_globals, QuantumInstance 
 
from qiskit import Aer 
 
from qiskit.algorithms.optimizers import COBYLA 
 
seed = 1234 
 
algorithm_globals.random_seed = seed 
 
quantum_instance = QuantumInstance(Aer.get_backend("aer_simulator"), 
 
                   seed_simulator=seed, seed_transpiler=seed, 
 
                   shots = 10) 
 
qaoa = QAOA(optimizer = COBYLA(), quantum_instance=quantum_instance) 
 
result = qaoa.compute_minimum_eigenvalue(H1) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml">Here, we are relying on the </span><span id="dx1-102036"/><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml">previous definition of </span><code><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml">H1</span></code><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml"> as </span><code><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml">Z</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml">^</span></code></span><code><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml">Z</span></code><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml">, running the circuit on the </span><code><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml">Aer</span></code><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml"> simulator with </span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"> shots, and using </span><code><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml">COBYLA</span></code><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"> as the classical optimizer — for an updated list of minimizers, please refer to Qiskit’s documentation at </span><a class="url" href="https://qiskit.org/documentation/stubs/qiskit.algorithms.optimizers.html"><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml">https://qiskit.org/documentation/stubs/qiskit.algorithms.optimizers.html</span></a><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1069.2" xmlns="http://www.w3.org/1999/xhtml">We are also setting seeds for those processes that require </span><span id="dx1-102037"/><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml">random numbers, in order to obtain reproducible results.</span></p>
<p><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml">If you run the preceding instructions, you will obtain the following output:</span></p>
<p><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml">@empty</span></p>
<pre class="lstlisting" id="listing-114"><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operator_eigenvalues’: None, 
 
    ’cost_function_evals’: 20, 
 
    ’eigenstate’: {’01’: 0.5477225575051661, ’10’: 0.8366600265340756}, 
 
    ’eigenvalue’: (-1+0j), 
 
    ’optimal_parameters’: { 
 
    ParameterVectorElement(@$\gamma$@[0]): -0.847240391875931, 
 
    ParameterVectorElement(@$\beta$@[0]): 6.7647519845416655}, 
 
    ’optimal_point’: array([ 6.76475198, -0.84724039]), 
 
    ’optimal_value’: -1.0, 
 
    ’optimizer_evals’: None, 
 
    ’optimizer_time’: 0.07764506340026855}
</span></pre>
<p><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml">That is quite a lot of information! </span><span class="koboSpan" id="kobo.1074.2" xmlns="http://www.w3.org/1999/xhtml">Let’s try to explain the most relevant pieces. </span><span class="koboSpan" id="kobo.1074.3" xmlns="http://www.w3.org/1999/xhtml">The first thing that we need to understand is that this result refers to the final state </span><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {\mathbf{\beta}^{\ast},\mathbf{\gamma}^{\ast}} \right\rangle" class="math inline" src="../media/file707.png" style="vertical-align:middle" title="\left| {\mathbf{\beta}^{\ast},\mathbf{\gamma}^{\ast}} \right\rangle"/></span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml"> obtained by QAOA, not to the </span><span id="dx1-102049"/><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml">solutions that we would obtain if we measured it. </span><span class="koboSpan" id="kobo.1077.2" xmlns="http://www.w3.org/1999/xhtml">In fact, this state is reconstructed from </span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml"> measurements — because our simulator is using </span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml"> shots — but those </span><span id="dx1-102050"/><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml">measurements are not given as part of the output. </span><span class="koboSpan" id="kobo.1082.2" xmlns="http://www.w3.org/1999/xhtml">Instead, we get the </span><code><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml">eigenstate</span></code><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml"> field, which shows that we have </span><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"> with an amplitude roughly </span><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.5477" class="math inline" src="../media/file758.png" style="vertical-align:middle" title="0.5477"/></span><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"> with an amplitude about </span><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.8367" class="math inline" src="../media/file759.png" style="vertical-align:middle" title="0.8367"/></span><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1092.2" xmlns="http://www.w3.org/1999/xhtml">These numbers are, in fact, </span><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 3\slash 10 \right.}" class="math inline" src="../media/file760.png" style="vertical-align:middle" title="\sqrt{\left. 3\slash 10 \right.}"/></span><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sqrt{\left. 7\slash 10 \right.}" class="math inline" src="../media/file761.png" style="vertical-align:middle" title="\sqrt{\left. 7\slash 10 \right.}"/></span><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">, which means that, once the state with the optimal parameters found by the minimizer was prepared and measured, </span><code><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml">01</span></code><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml"> was obtained </span><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml"> out of </span><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml"> times and </span><code><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">10</span></code><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml"> was obtained the remaining </span><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml"> times. </span><span class="koboSpan" id="kobo.1106.2" xmlns="http://www.w3.org/1999/xhtml">This state can be prepared with the QAOA circuit by using the optimal parameters reported in the result: </span><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1} \approx 6.7648" class="math inline" src="../media/file762.png" style="vertical-align:middle" title="\beta_{1} \approx 6.7648"/></span><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1} \approx - 0.8472" class="math inline" src="../media/file763.png" style="vertical-align:middle" title="\gamma_{1} \approx - 0.8472"/></span><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, with respect to the </span><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian, both </span><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"> have an expected value of </span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml">, which is the optimal energy. </span><span class="koboSpan" id="kobo.1119.2" xmlns="http://www.w3.org/1999/xhtml">This means that we have been able to find an optimal solution — two of them, in fact — with QAOA! </span><span class="koboSpan" id="kobo.1119.3" xmlns="http://www.w3.org/1999/xhtml">To get to this result, QAOA evaluated the energy function — by preparing a circuit with some values of </span><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1}" class="math inline" src="../media/file684.png" style="vertical-align:middle" title="\beta_{1}"/></span><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1}" class="math inline" src="../media/file683.png" style="vertical-align:middle" title="\gamma_{1}"/></span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"> and measuring it to estimate its expectation value — 20 times, as indicated by the </span><code><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml">cost_function_evals</span></code><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml"> field, and it used about </span><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0.08" class="math inline" src="../media/file764.png" style="vertical-align:middle" title="0.08"/></span><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml"> seconds of computing time — your running time will most surely be different from ours, though.</span></p>
<p><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml">All this has been done with the Aer simulator. </span><span class="koboSpan" id="kobo.1128.2" xmlns="http://www.w3.org/1999/xhtml">If we wanted to use a real quantum computer, we could just replace the </span><code><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">backend</span></code><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"> in the instantiation of the </span><code><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml">QuantumInstance</span></code><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml"> object and use some of the quantum devices provided by IBM, as we showed in </span><em><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch009.xhtml#x1-510002.2.4"><em><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml">2.2.4</span></em></a><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1135.2" xmlns="http://www.w3.org/1999/xhtml">However, this is not the best way to proceed. </span><span class="koboSpan" id="kobo.1135.3" xmlns="http://www.w3.org/1999/xhtml">The problem with this straightforward approach is that you will be running the classical part of the algorithm locally. </span><span class="koboSpan" id="kobo.1135.4" xmlns="http://www.w3.org/1999/xhtml">Then, each time that an energy estimation is required, a new job will be submitted to the quantum computer and you will have to wait on the queue if other users have also sent jobs to execute. </span><span class="koboSpan" id="kobo.1135.5" xmlns="http://www.w3.org/1999/xhtml">This can be quite slow, not because of the process itself, but because of the queue waiting times.</span></p>
<p><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml">Fortunately, Qiskit has recently introduced a new module called </span><span id="dx1-102051"/><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml">Runtime that allows us to reduce the execution time for hybrid algorithms such as QAOA. </span><span class="koboSpan" id="kobo.1137.2" xmlns="http://www.w3.org/1999/xhtml">Instead of submitting each circuit individually, with </span><span id="dx1-102052"/><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml">Runtime you can submit a </span><strong><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml">program</span></strong><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml"> that includes both the classical and the </span><span id="dx1-102053"/><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml">quantum part of the algorithm. </span><span class="koboSpan" id="kobo.1141.2" xmlns="http://www.w3.org/1999/xhtml">The program is then queued just once, greatly speeding up the whole execution.</span></p>
<p><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml">Using Runtime with QAOA is very easy. </span><span class="koboSpan" id="kobo.1142.2" xmlns="http://www.w3.org/1999/xhtml">In fact, we just need to specify the same elements that we have used with the </span><code><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml">QAOA</span></code><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml"> class, but in a slightly different way. </span><span class="koboSpan" id="kobo.1144.2" xmlns="http://www.w3.org/1999/xhtml">The following piece of code shows an example of how to do this:</span></p>
<pre class="lstlisting" id="listing-115"><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import IBMQ 
 
provider = IBMQ.load_account() 
 
program_id = "qaoa" 
 
 
 
H1 = Z^Z 
 
opt = COBYLA() 
 
reps = 1 
 
shots = 1024 
 
 
 
runtime_inputs = { 
 
    "operator": H1, 
 
    "reps": reps, 
 
    "optimizer": opt, 
 
    "initial_point": [0,0], 
 
    "use_swap_strategies": False 
 
} 
 
 
 
options = {"backend_name": "ibmq_belem"} 
 
job = provider.runtime.run(program_id=program_id, 
 
      options=options, inputs=runtime_inputs)
</span></pre>
<p><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml">This will create and run a QAOA Runtime job whose quantum part will be executed in the quantum </span><span id="dx1-102074"/><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml">computer that we have specified in the </span><code><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml">options</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml">[</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml">backend_name</span></code></span><span style="color:#0086E5"><code><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml">"</span></code></span><code><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml">]</span></code><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml"> field — in our case, </span><code><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml">ibmq_belem</span></code><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1156.2" xmlns="http://www.w3.org/1999/xhtml">We have used the </span><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian, COBYLA as the optimizer, a value of </span><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="p = 1" class="math inline" src="../media/file676.png" style="vertical-align:middle" title="p = 1"/></span><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml"> (specified with the </span><code><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">reps</span></code><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"> variable), and </span><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1024" class="math inline" src="../media/file291.png" style="vertical-align:middle" title="1024"/></span><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml"> shots.</span></p>
<p><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">We have also chosen the initial values of </span><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1}" class="math inline" src="../media/file684.png" style="vertical-align:middle" title="\beta_{1}"/></span><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1}" class="math inline" src="../media/file683.png" style="vertical-align:middle" title="\gamma_{1}"/></span><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml"> to be </span><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml"> with the </span><code><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">initial_point</span></code><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml"> field. </span><span class="koboSpan" id="kobo.1173.2" xmlns="http://www.w3.org/1999/xhtml">If this field is not used, the initial values are chosen at random.</span></p>
<p><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml">Once the program has </span><span id="dx1-102075"/><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">finished running (you can keep track of its execution using </span><code><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml">job</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">status</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">()</span></code><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml">), the result can be retrieved with </span><code><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">job</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code></span><code><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">()</span></code><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1185.2" xmlns="http://www.w3.org/1999/xhtml">We can access some of its parameters with the following instructions:</span></p>
<pre class="lstlisting" id="listing-116"><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml">

result = job.result() 
 
print("Optimizer time", result[’optimizer_time’]) 
 
print("Optimal value", result[’optimal_value’]) 
 
print("Optimal point", result[’optimal_point’]) 
 
print("Optimal state", result[’eigenstate’])
</span></pre>
<p><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml">In our case, running those lines of code offered the following result:</span></p>
<pre class="lstlisting" id="listing-117"><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml">

Optimizer time 88.11612486839294 
 
Optimal value -0.84765625 
 
Optimal point [0.42727683 2.39693691] 
 
Optimal state {’00’: 0.2576941016011038, ’01’: 0.691748238161833, 
 
               ’10’: 0.6584783595532961, ’11’: 0.14657549249448218}
</span></pre>
<p><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml">As you can appreciate, the results are slightly worse than with the simulator, due to the influence of noise. </span><span class="koboSpan" id="kobo.1189.2" xmlns="http://www.w3.org/1999/xhtml">But the two optimal basis states — </span><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="01" class="math inline" src="../media/file159.png" style="vertical-align:middle" title="01"/></span><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="10" class="math inline" src="../media/file161.png" style="vertical-align:middle" title="10"/></span><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml"> — are still the most probable ones and, therefore, if we prepare and measure the final state several times, we will have a very high probability of finding an optimal solution.</span></p>
<p><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml">So now we know how to solve problems with QAOA using Qiskit, both with simulators and with actual quantum computers. </span><span class="koboSpan" id="kobo.1194.2" xmlns="http://www.w3.org/1999/xhtml">However, so far, we’ve had to prepare the Hamiltonian of the problem ourselves, and that is not ideal. </span><span class="koboSpan" id="kobo.1194.3" xmlns="http://www.w3.org/1999/xhtml">As we learned in </span><em><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained</span></em> <em><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml">Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml">, for many problems, it is more convenient to work with a QUBO formulation or even to write the problem as a binary linear program. </span><span class="koboSpan" id="kobo.1200.2" xmlns="http://www.w3.org/1999/xhtml">Would it be possible to use those formalisms directly with QAOA in Qiskit? </span><span class="koboSpan" id="kobo.1200.3" xmlns="http://www.w3.org/1999/xhtml">Absolutely! </span><span class="koboSpan" id="kobo.1200.4" xmlns="http://www.w3.org/1999/xhtml">We’ll show you how in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="12.2.2" id="solving-qubo-problems-with-qaoa-in-qiskit">
<h2 class="subsectionHead" data-number="12.2.2"><span class="titlemark"><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml">5.2.2 </span></span> <span id="x1-1030005.2.2"><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml">Solving QUBO problems with QAOA in Qiskit</span></span></h2>
<p><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml">Qiskit provides tools to work </span><span id="dx1-103001"/><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">with quadratic problems, both with and without constraints, which are similar to the ones that we studied when working with Ocean in </span><em><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch012.xhtml#x1-750004"><em><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml">4</span></em></a><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Adiabatic Computing and Quantum Annealing</span></em><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1209.2" xmlns="http://www.w3.org/1999/xhtml">For example, we can define a simple binary program with the following piece of code:</span></p>
<p><span id="x1-103002"/></p>
<pre class="lstlisting" id="listing-118"><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.problems import QuadraticProgram 
 
 
 
qp = QuadraticProgram() 
 
qp.binary_var(’x’) 
 
qp.binary_var(’y’) 
 
qp.binary_var(’z’) 
 
 
 
qp.minimize(linear = {’y’:-1}, quadratic = {(’x’,’y’):2, (’z’,’y’):-4}) 
 
qp.linear_constraint(linear = {’x’:1, ’y’:2, ’z’:3}, 
 
    sense ="&lt;=", rhs = 5) 
 
 
 
print(qp.export_as_lp_string())
</span></pre>
<p><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, we are defining a quadratic problem with three binary variables, a function to minimize that has a linear and a quadratic part, and a linear constraint in the binary variables. </span><span class="koboSpan" id="kobo.1211.2" xmlns="http://www.w3.org/1999/xhtml">When we run these instructions, we obtain the following output:</span></p>
<pre class="lstlisting" id="listing-119"><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml">

\ This file has been generated by DOcplex 
 
\ ENCODING=ISO-8859-1 
 
\Problem name: CPLEX 
 
 
 
Minimize 
 
 obj: - y + [ 4 x*y - 8 y*z ]/2 
 
Subject To 
 
 c0: x + 2 y + 3 z &lt;= 5 
 
 
 
Bounds 
 
 0 &lt;= x &lt;= 1 
 
 0 &lt;= y &lt;= 1 
 
 0 &lt;= z &lt;= 1 
 
 
 
Binaries 
 
 x y z 
 
End
</span></pre>
<p><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-103032"/><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml">problem has exactly the elements that we specified. </span><span class="koboSpan" id="kobo.1214.2" xmlns="http://www.w3.org/1999/xhtml">The only detail that may deserve a small explanation is why the quadratic part of the objective function is represented as </span><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. (4xy - 8yz)\slash 2 \right." class="math inline" src="../media/file765.png" style="vertical-align:middle" title="\left. (4xy - 8yz)\slash 2 \right."/></span><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml"> instead of </span><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2xy - 4yz" class="math inline" src="../media/file766.png" style="vertical-align:middle" title="2xy - 4yz"/></span><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1218.2" xmlns="http://www.w3.org/1999/xhtml">The reason for this seemingly odd choice is that, in this way, the matrix with the quadratic coefficients can be made symmetric. </span><span class="koboSpan" id="kobo.1218.3" xmlns="http://www.w3.org/1999/xhtml">Instead of having </span><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml"> for the </span><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="xy" class="math inline" src="../media/file722.png" style="vertical-align:middle" title="xy"/></span><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml"> coefficient and </span><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml"> for the </span><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="yx" class="math inline" src="../media/file767.png" style="vertical-align:middle" title="yx"/></span><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml"> product, the value is duplicated and both terms will have </span><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml"> as their coefficient — but then we need to divide by </span><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml"> so that the total coefficient remains as in the original specification.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-115">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">The internal representation of these quadratic problems is the one used by CPLEX, an IBM package that is used to solve optimization problems with classical methods. </span><span class="koboSpan" id="kobo.1233.2" xmlns="http://www.w3.org/1999/xhtml">You can learn more about CPLEX on its web page: </span><a class="url" href="https://www.ibm.com/products/ilog-cplex-optimization-studio"><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml">https://www.ibm.com/products/ilog-cplex-optimization-studio</span></a><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml">Once we have a </span><code><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml">QuadraticProgram</span></code><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml"> object, we can solve it with one of the algorithms provided by Qiskit. </span><span class="koboSpan" id="kobo.1238.2" xmlns="http://www.w3.org/1999/xhtml">To achieve this, we can use </span><code><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml">MinimumEigenOptimizer</span></code><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml"> together with a concrete solver. </span><span class="koboSpan" id="kobo.1240.2" xmlns="http://www.w3.org/1999/xhtml">For example, we can use a classical exact solver, which tries every possible solution and selects the </span><span id="dx1-103033"/><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml">optimal one. </span><span class="koboSpan" id="kobo.1241.2" xmlns="http://www.w3.org/1999/xhtml">In Qiskit, this is as simple as using the following instructions:</span></p>
<pre class="lstlisting" id="listing-120"><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.algorithms import MinimumEigenOptimizer 
 
from qiskit.algorithms import NumPyMinimumEigensolver 
 
np_solver = NumPyMinimumEigensolver() 
 
np_optimizer = MinimumEigenOptimizer(np_solver) 
 
result = np_optimizer.solve(qp) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml">The result of the execution is as follows:</span></p>
<pre class="lstlisting" id="listing-121"><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml">

fval=-5.0, x=0.0, y=1.0, z=1.0, status=SUCCESS
</span></pre>
<p><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, we obtain the optimal assignment (</span><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x = 0" class="math inline" src="../media/file768.png" style="vertical-align:middle" title="x = 0"/></span><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y = 1" class="math inline" src="../media/file769.png" style="vertical-align:middle" title="y = 1"/></span><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z = 1" class="math inline" src="../media/file770.png" style="vertical-align:middle" title="z = 1"/></span><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml">), the optimal value of the function (in this case, </span><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5" class="math inline" src="../media/file591.png" style="vertical-align:middle" title="- 5"/></span><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml">), and whether the assignment satisfies the constraints, indicated by the </span><code><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml">SUCCESS</span></code><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml"> value, or not — if there were no assignments satisfying the constraints, we would obtain </span><code><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml">INFEASIBLE</span></code><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml"> as the value for </span><code><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">status</span></code><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml">In a similar way, we can use QAOA to solve the problem with the following instructions:</span></p>
<pre class="lstlisting" id="listing-122"><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit import Aer 
 
from qiskit.algorithms import QAOA 
 
from qiskit.algorithms.optimizers import COBYLA 
 
from qiskit.utils import QuantumInstance 
 
quantum_instance = QuantumInstance(Aer.get_backend("aer_simulator"), 
 
    shots = 1024) 
 
qaoa = QAOA(optimizer = COBYLA(), 
 
    quantum_instance=quantum_instance, reps = 1) 
 
qaoa_optimizer = MinimumEigenOptimizer(qaoa) 
 
result = qaoa_optimizer.solve(qp) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the result will be the same one that we obtained with </span><code><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">NumPyMinimumEigensolver</span></code><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1264.2" xmlns="http://www.w3.org/1999/xhtml">But we can also obtain </span><span id="dx1-103052"/><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml">additional information with the following instructions:</span></p>
<pre class="lstlisting" id="listing-123"><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">

print(’Variable order:’, [var.name for var in result.variables]) 
 
for s in result.samples: 
 
    print(s)
</span></pre>
<p><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml">The result will be something like the following:</span></p>
<pre class="lstlisting" id="listing-124"><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml">

Variable order: [’x’, ’y’, ’z’] 
 
SolutionSample(x=array([0., 1., 1.]), fval=-5.0, 
 
probability=0.11621093749999999, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([0., 1., 0.]), fval=-1.0, 
 
probability=0.107421875, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([1., 0., 1.]), fval=0.0, 
 
probability=0.1494140625, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([0., 0., 1.]), fval=0.0, 
 
probability=0.1103515625, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([1., 0., 0.]), fval=0.0, 
 
probability=0.103515625, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([0., 0., 0.]), fval=0.0, 
 
probability=0.1416015625, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([1., 1., 0.]), fval=1.0, 
 
probability=0.13769531249999997, status=&lt;OptimizationResultStatus.SUCCESS: 0&gt;) 
 
SolutionSample(x=array([1., 1., 1.]), fval=-3.0, 
 
probability=0.1337890625, status=&lt;OptimizationResultStatus.INFEASIBLE: 2&gt;)
</span></pre>
<p><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml">First, we have printed the order of variables, to more easily interpret the assignments considered by the solver. </span><span class="koboSpan" id="kobo.1269.2" xmlns="http://www.w3.org/1999/xhtml">Then, we have a listing of the different solutions that are part of the final, optimal state found by QAOA. </span><span class="koboSpan" id="kobo.1269.3" xmlns="http://www.w3.org/1999/xhtml">Each item of the list includes the assignment, the energy or function value, the probability of obtaining the corresponding basis state when </span><span id="dx1-103073"/><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml">measuring the QAOA state, and whether the solution is feasible or not — </span><code><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml">status</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">=&lt;</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml">OptimizationResultStatus</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml">SUCCESS</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">:</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml">0&gt;</span></code><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml"> indicates that the solution is feasible, while </span><code><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">status</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml">=&lt;</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml">OptimizationResultStatus</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml">INFEASIBLE</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml">:</span></code></span><span style="color:#000000"> </span></p>
<p><code><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml">2&gt;</span></code><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml"> indicates that it is not.</span></p>
<div class="tcolorbox questionx" id="tcolobox-116">
<span id="x1-103075x5.2.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.6</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml">Modify the code that we have just run to make the results reproducible. </span><em><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">Hint</span></em><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml">: you can set seeds in the same way that we did in </span><em><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-1020005.2.1"><em><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">5.2.1</span></em></a><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">We can also obtain full information about the QAOA execution by using the following:</span></p>
<pre class="lstlisting" id="listing-125"><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">

print(result.min_eigen_solver_result)
</span></pre>
<p><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">We would obtain something like the following (where we have truncated part of the output):</span></p>
<p><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">@empty</span></p>
<pre class="lstlisting" id="listing-126"><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml">

{   ’aux_operator_eigenvalues’: None, 
 
    ’cost_function_evals’: 32, 
 
    ’eigenstate’: {   ’000000’: 0.09375, 
 
                      ’000001’: 0.03125, 
 
                      ’000010’: 0.05412658773652741, 
 
                      [.....] 
 
                      ’111101’: 0.11692679333668567, 
 
                      ’111110’: 0.08838834764831845, 
 
                      ’111111’: 0.07654655446197431}, 
 
    ’eigenvalue’: (-14.7548828125+0j), 
 
    ’optimal_parameters’: { 
 
    ParameterVectorElement(@$\gamma$@[0]): -5.087643335935586, 
 
    ParameterVectorElement(@$\beta$@[0]): -0.24590437874189125}, 
 
    ’optimal_point’: array([-0.24590438, -5.08764334]), 
 
    ’optimal_value’: -14.7548828125, 
 
    ’optimizer_evals’: None, 
 
    ’optimizer_time’: 0.6570718288421631}
</span></pre>
<p><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml">Notice, however, that these assignments include the auxiliary variables used in the transformation from constrained to unconstrained problem, as in the procedure that we studied in </span><em><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained</span></em> <em><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml">Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">, and the function values are also the ones taken in the transformed problem. </span><span class="koboSpan" id="kobo.1305.2" xmlns="http://www.w3.org/1999/xhtml">In fact, you can obtain the </span><span id="dx1-103094"/><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml">corresponding QUBO problem with the following code:</span></p>
<pre class="lstlisting" id="listing-127"><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.converters import QuadraticProgramToQubo 
 
qp_to_qubo = QuadraticProgramToQubo() 
 
qubo = qp_to_qubo.convert(qp) 
 
print(qubo.export_as_lp_string())
</span></pre>
<p><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml">The output will be the following:</span></p>
<pre class="lstlisting" id="listing-128"><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml">

\ This file has been generated by DOcplex 
 
\ ENCODING=ISO-8859-1 
 
\Problem name: CPLEX 
 
 
 
Minimize 
 
 obj: - 80 x - 161 y - 240 z - 80 c0@int_slack@0 - 160 c0@int_slack@1 
 
      - 160 c0@int_slack@2 + [ 16 x^2 + 68 x*y + 96 x*z + 
 
      32 x*c0@int_slack@0 + 64 x*c0@int_slack@1 + 64 x*c0@int_slack@2 
 
      + 64 y^2 + 184 y*z + 64 y*c0@int_slack@0 + 128 y*c0@int_slack@1 
 
      + 128 y*c0@int_slack@2 + 144 z^2 + 96 z*c0@int_slack@0 
 
      + 192 z*c0@int_slack@1 + 192 z*c0@int_slack@2 
 
      + 16 c0@int_slack@0^2 + 64 c0@int_slack@0*c0@int_slack@1 
 
      + 64 c0@int_slack@0*c0@int_slack@2 + 64 c0@int_slack@1^2 
 
      + 128 c0@int_slack@1*c0@int_slack@2 + 64 c0@int_slack@2^2 ]/2 
 
      + 200 
 
Subject To 
 
 
 
Bounds 
 
 0 &lt;= x &lt;= 1 
 
 0 &lt;= y &lt;= 1 
 
 0 &lt;= z &lt;= 1 
 
 0 &lt;= c0@int_slack@0 &lt;= 1 
 
 0 &lt;= c0@int_slack@1 &lt;= 1 
 
 0 &lt;= c0@int_slack@2 &lt;= 1 
 
 
 
Binaries 
 
 x y z c0@int_slack@0 c0@int_slack@1 c0@int_slack@2 
 
End
</span></pre>
<p><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, this is now a </span><span id="dx1-103127"/><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml">QUBO problem in which slack variables and penalty terms have been introduced, exactly as we did in </span><em><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch011.xhtml#x1-590003"><em><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml">3</span></em></a><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml">Working</span></em> <em><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml">with Quadratic Unconstrained Binary Optimization Problems</span></em><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-117">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content"><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">
In the </span><code><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml">qiskit_optimization</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span>
<code><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">converters</span></code><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml"> module, you can also find the functions </span><code><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">InequalityToEquality</span></code><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">IntegerToBinary</span></code><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml">LinearEqualityToPenalty</span></code><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1330.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">QuadraticProgramToQubo</span></code><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml"> function calls them to convert quadratic programs with constraints into QUBO instances, by first introducing slack variables to transform inequalities into equalities, then transforming the integer slack variables into binary ones, and finally, replacing the equality constraints with penalty terms.
</span></div>
</div>
<p><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml">You may now be wondering how to use </span><code><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml">MinimumEigenOptimizer</span></code><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml"> with a quantum computer instead of with a simulator. </span><span class="koboSpan" id="kobo.1335.2" xmlns="http://www.w3.org/1999/xhtml">Of course, when defining the </span><code><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">quantum_instance</span></code><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml"> parameter to use with the </span><code><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">QAOA</span></code><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml"> object, you can simply declare a real quantum device. </span><span class="koboSpan" id="kobo.1339.2" xmlns="http://www.w3.org/1999/xhtml">But, as we have already mentioned, that would imply entering the device queue many times, with the consequent delay.</span></p>
<p><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml">As you surely remember from the previous subsection, if you have a Hamiltonian, you can use it directly in a QAOA Runtime program in order to submit your problem to the queue just once. </span><span class="koboSpan" id="kobo.1340.2" xmlns="http://www.w3.org/1999/xhtml">So, is it possible to obtain the Hamiltonian of our problem? </span><span class="koboSpan" id="kobo.1340.3" xmlns="http://www.w3.org/1999/xhtml">It sure is! </span><span class="koboSpan" id="kobo.1340.4" xmlns="http://www.w3.org/1999/xhtml">You can run the following code to further transform the QUBO problem into an equivalent Hamiltonian:</span></p>
<pre class="lstlisting" id="listing-129"><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml">

H1, offset = qubo.to_ising() 
 
 
 
print("The Hamiltonian is", H1) 
 
print("The constant term is", offset)
</span></pre>
<p><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml">You can then use </span><code><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml">H1</span></code><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml"> to solve the problem with the QAOA Runtime program and even recover the energy by adding back the </span><code><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml">offset</span></code><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml"> term. </span><span class="koboSpan" id="kobo.1346.2" xmlns="http://www.w3.org/1999/xhtml">But... </span><span class="koboSpan" id="kobo.1346.3" xmlns="http://www.w3.org/1999/xhtml">that seems like a lot of work, doesn’t it? </span><span class="koboSpan" id="kobo.1346.4" xmlns="http://www.w3.org/1999/xhtml">What’s more, you would need to deal with all those ugly slack variables that were introduced to transform the quadratic program into </span><span id="dx1-103132"/><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml">QUBO form. </span><span class="koboSpan" id="kobo.1347.2" xmlns="http://www.w3.org/1999/xhtml">Surely, there has to be a simpler way.</span></p>
<p><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">Fortunately, the Qiskit developers are very thoughtful, and they have enabled us to use Qiskit Runtime directly with </span><code><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">MinimumEigenOptimizer</span></code><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1350.2" xmlns="http://www.w3.org/1999/xhtml">To do that, though, you need something called the </span><code><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml">QAOAClient</span></code><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">, which will take care of running everything smoothly with Runtime once you plug it into </span><code><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml">MinimumEigenOptimizer</span></code><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1354.2" xmlns="http://www.w3.org/1999/xhtml">Using it is as simple as selecting a device with enough qubits. </span><span class="koboSpan" id="kobo.1354.3" xmlns="http://www.w3.org/1999/xhtml">We need at least </span><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="6" class="math inline" src="../media/file576.png" style="vertical-align:middle" title="6"/></span><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml">, so we have selected </span><code><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">ibm_lagos</span></code><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml">, which has </span><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml">; if you don’t have access to a big enough device, you can always use </span><code><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml">ibmq_qasm_simulator</span></code><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">, which supports up to </span><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="32" class="math inline" src="../media/file771.png" style="vertical-align:middle" title="32"/></span><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1364.2" xmlns="http://www.w3.org/1999/xhtml">And once we have a device, we can just run the following instructions:</span></p>
<pre class="lstlisting" id="listing-130"><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit_optimization.runtime import QAOAClient 
 
from qiskit import IBMQ 
 
 
 
provider = IBMQ.load_account() 
 
qaoa_client = QAOAClient(provider=provider, 
 
                      backend=provider.get_backend("ibm_oslo"), reps=1) 
 
 
 
qaoa = MinimumEigenOptimizer(qaoa_client) 
 
result = qaoa.solve(qp) 
 
print(result)
</span></pre>
<p><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">This will yield the following output:</span></p>
<pre class="lstlisting" id="listing-131"><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml">

fval=-5.0, x=0.0, y=1.0, z=1.0, status=SUCCESS
</span></pre>
<p><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">And, of course, you can obtain further </span><span id="dx1-103144"/><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">information about the execution, as we did in previous examples, by accessing and using the values of the variables </span><code><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">variables</span></code><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">samples</span></code><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">result</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">min_eigen_solver_result</span></code><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1381.2" xmlns="http://www.w3.org/1999/xhtml">Very convenient, right?</span></p>
<p><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml">We have now learned how to work with QAOA in Qiskit and how to manage and solve our problems in many different ways. </span><span class="koboSpan" id="kobo.1382.2" xmlns="http://www.w3.org/1999/xhtml">It is time for us to turn back to PennyLane and see what it can offer in order to solve our beloved QUBO problems.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="12.3" id="using-qaoa-with-pennylane">
<h1 class="sectionHead" data-number="12.3"><span class="titlemark"><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">5.3 </span></span> <span id="x1-1040005.3"><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml">Using QAOA with PennyLane</span></span></h1>
<p><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml">As we mentioned in </span><em><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch009.xhtml#x1-400002"><em><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml">2</span></em></a><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml">The Tools of the Trade in Quantum Computing</span></em><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml">, PennyLane is a quantum programming library focused mainly on quantum machine learning. </span><span class="koboSpan" id="kobo.1390.2" xmlns="http://www.w3.org/1999/xhtml">As such, it doesn’t include as </span><span id="dx1-104001"/><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">many tools for quantum </span><span id="dx1-104002"/><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml">optimization algorithms — such as QAOA — as Qiskit does. </span><span class="koboSpan" id="kobo.1392.2" xmlns="http://www.w3.org/1999/xhtml">However, it does provide some interesting features such as automatic differentiation — that is, analytical computation of gradients — that may make it an appealing alternative to Qiskit in some circumstances.</span></p>
<p><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml">Let’s begin by explaining how to declare and work with Hamiltonians in PennyLane. </span><span class="koboSpan" id="kobo.1393.2" xmlns="http://www.w3.org/1999/xhtml">For that, we will use the </span><code><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian</span></code><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml"> class. </span><span class="koboSpan" id="kobo.1395.2" xmlns="http://www.w3.org/1999/xhtml">It provides a constructor that accepts a list of coefficients and a list of products of Pauli matrices. </span><span class="koboSpan" id="kobo.1395.3" xmlns="http://www.w3.org/1999/xhtml">For instance, if you want to define </span><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2Z_{0}Z_{1} - Z_{0}Z_{2} + 3.5Z_{1}" class="math inline" src="../media/file772.png" style="vertical-align:middle" title="2Z_{0}Z_{1} - Z_{0}Z_{2} + 3.5Z_{1}"/></span><span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml">, you will pass </span><code><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml">[2,-1,3.5]</span></code><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml"> as the first argument and </span><code><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml">[</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">@PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml">(1),</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml">@PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml">(2),</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><code><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">(1)]</span></code><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml"> as the second one. </span><span class="koboSpan" id="kobo.1411.2" xmlns="http://www.w3.org/1999/xhtml">As we know from </span><em><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch009.xhtml#x1-400002"><em><span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml">2</span></em></a><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml">The Tools of the Trade in Quantum Computing</span></em><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml"> is the </span><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml"> matrix in PennyLane. </span><span class="koboSpan" id="kobo.1420.2" xmlns="http://www.w3.org/1999/xhtml">We are also using the </span><code><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml">@</span></code><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml"> operator, which is PennyLane’s symbol for the tensor product operation. </span><span class="koboSpan" id="kobo.1422.2" xmlns="http://www.w3.org/1999/xhtml">Putting it all together, we get the following instructions:</span></p>
<p><span id="x1-104003"/></p>
<pre class="lstlisting" id="listing-132"><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml">

import pennylane as qml 
 
from pennylane import PauliZ 
 
coefficients = [2,-1,3.5] 
 
 
 
paulis = [PauliZ(0)@PauliZ(1),PauliZ(0)@PauliZ(2),PauliZ(1)] 
 
 
 
H = qml.Hamiltonian(coefficients,paulis) 
 
print(H)
</span></pre>
<p><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml">The output when we execute that code will be the following:</span></p>
<pre class="lstlisting" id="listing-133"><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml">

(3.5) [Z1] 
 
+ (-1) [Z0 Z2] 
 
+ (2) [Z0 Z1]
</span></pre>
<p><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml">As you can see, we have </span><span id="dx1-104015"/><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml">constructed exactly the Hamiltonian that we wanted. </span><span class="koboSpan" id="kobo.1427.2" xmlns="http://www.w3.org/1999/xhtml">We can also obtain its matrix by using </span><span class="lstinline"><span style="color:#A71D5D"><code><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml">print</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml">(</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">matrix</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml">(</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml">H</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml">))</span></code></span></span><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">, which would give us the following output:</span></p>
<pre class="lstlisting" id="listing-134"><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml">

[[4.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.2" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.3" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.4" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.5" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.6" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.7" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.8" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.9" xmlns="http://www.w3.org/1999/xhtml">+0.j  6.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.10" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.11" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.12" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.13" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.14" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.15" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.16" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.17" xmlns="http://www.w3.org/1999/xhtml">+0.j -6.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.18" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.19" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.20" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.21" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.22" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.23" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.24" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.25" xmlns="http://www.w3.org/1999/xhtml">+0.j -4.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.26" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.27" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.28" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.29" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.30" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.31" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.32" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.33" xmlns="http://www.w3.org/1999/xhtml">+0.j  2.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.34" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.35" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.36" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.37" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.38" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.39" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.40" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.41" xmlns="http://www.w3.org/1999/xhtml">+0.j  0.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.42" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.43" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.44" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.45" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.46" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.47" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.48" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.49" xmlns="http://www.w3.org/1999/xhtml">+0.j -0.5+0.j  0. </span><span class="koboSpan" id="kobo.1437.50" xmlns="http://www.w3.org/1999/xhtml">+0.j] 
 
 [0. </span><span class="koboSpan" id="kobo.1437.51" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.52" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.53" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.54" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.55" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.56" xmlns="http://www.w3.org/1999/xhtml">+0.j  0. </span><span class="koboSpan" id="kobo.1437.57" xmlns="http://www.w3.org/1999/xhtml">+0.j -2.5+0.j]]
</span></pre>
<p><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml">As expected, this is a diagonal matrix. </span><span class="koboSpan" id="kobo.1438.2" xmlns="http://www.w3.org/1999/xhtml">We can </span><span id="dx1-104024"/><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml">visualize it in a more compact way by executing the following instructions, which will give us only the non-zero elements:</span></p>
<pre class="lstlisting" id="listing-135"><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml">

from pennylane.utils import sparse_hamiltonian 
 
 
 
print(sparse_hamiltonian(H))
</span></pre>
<p><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml">The result will be the following:</span></p>
<pre class="lstlisting" id="listing-136"><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml">

  (0, 0)    (4.5+0j) 
 
  (1, 1)    (6.5+0j) 
 
  (2, 2)    (-6.5+0j) 
 
  (3, 3)    (-4.5+0j) 
 
  (4, 4)    (2.5+0j) 
 
  (5, 5)    (0.5+0j) 
 
  (6, 6)    (-0.5+0j) 
 
  (7, 7)    (-2.5+0j)
</span></pre>
<p><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml">You can also define Hamiltonians in a more compact manner by specifying them in a mathematical </span><span id="dx1-104036"/><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml">expression like the following one:</span></p>
<pre class="lstlisting" id="listing-137"><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml">

H = 2*PauliZ(0)@PauliZ(1) - PauliZ(0)@PauliZ(2) +3.5*PauliZ(1)
</span></pre>
<p><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml">If you print </span><code><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">H</span></code><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">, you will find that this </span><span id="dx1-104038"/><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml">definition is equivalent to the one that was introduced previously.</span></p>
<div class="tcolorbox questionx" id="tcolobox-118">
<span id="x1-104040x5.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 5.7</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml">Use PennyLane to define the </span><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 3Z_{0}Z_{1}Z_{2} + 2Z_{1}Z_{2} - Z_{2}" class="math inline" src="../media/file773.png" style="vertical-align:middle" title="- 3Z_{0}Z_{1}Z_{2} + 2Z_{1}Z_{2} - Z_{2}"/></span><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian in two different ways.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know how to define Hamiltonians, we can use them to create QAOA circuits with PennyLane. </span><span class="koboSpan" id="kobo.1454.2" xmlns="http://www.w3.org/1999/xhtml">To this end, we will import the </span><code><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml">qaoa</span></code><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml"> module, which will give us access to the </span><code><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml">cost_layer</span></code><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml">mixer_layer</span></code><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml"> functions. </span><span class="koboSpan" id="kobo.1460.2" xmlns="http://www.w3.org/1999/xhtml">We will need a cost Hamiltonian — the one that encodes our optimization problem — to use with </span><code><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml">cost_layer</span></code><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml"> and we will use </span><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{j}X_{j}" class="math inline" src="../media/file774.png" style="vertical-align:middle" title="{\sum}_{j}X_{j}"/></span><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><code><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml">mixer_layer</span></code><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml"> (in the QAOA literature, our </span><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian is sometimes called the </span><strong><span class="koboSpan" id="kobo.1469.1" xmlns="http://www.w3.org/1999/xhtml">mixer Hamiltonian</span></strong><span class="koboSpan" id="kobo.1470.1" xmlns="http://www.w3.org/1999/xhtml">, hence the name of the function). </span><span class="koboSpan" id="kobo.1470.2" xmlns="http://www.w3.org/1999/xhtml">With them, we can create a function that </span><span id="dx1-104041"/><span class="koboSpan" id="kobo.1471.1" xmlns="http://www.w3.org/1999/xhtml">constructs the QAOA circuit and that computes the energy of the state prepared by the circuit with respect to </span><span class="koboSpan" id="kobo.1472.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.1473.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1473.2" xmlns="http://www.w3.org/1999/xhtml">This latter part is very easy to accomplish with PennyLane, because it provides the </span><code><span class="koboSpan" id="kobo.1474.1" xmlns="http://www.w3.org/1999/xhtml">expval</span></code><span class="koboSpan" id="kobo.1475.1" xmlns="http://www.w3.org/1999/xhtml"> function, which computes exactly that, and it can be used instead of the types of measurements that we introduced in </span><em><span class="koboSpan" id="kobo.1476.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch009.xhtml#x1-530002.3.1"><em><span class="koboSpan" id="kobo.1477.1" xmlns="http://www.w3.org/1999/xhtml">2.3.1</span></em></a><span class="koboSpan" id="kobo.1478.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1479.1" xmlns="http://www.w3.org/1999/xhtml">We can, thus, define a function that computes the energy of parameters with the following piece of code:</span></p>
<pre class="lstlisting" id="listing-138"><span class="koboSpan" id="kobo.1480.1" xmlns="http://www.w3.org/1999/xhtml">

from pennylane import qaoa 
 
 
 
H0 = qml.PauliX(0) + qml.PauliX(1) 
 
H1 = 1.0*qml.PauliZ(0) @ qml.PauliZ(1) 
 
 
 
wires = range(2) 
 
dev = qml.device("default.qubit", wires=wires) 
 
 
 
p = 2 
 
 
 
@qml.qnode(dev) 
 
def energy(angles): 
 
    for w in wires: 
 
        qml.Hadamard(wires=w) 
 
    for i in range(p): 
 
        qaoa.cost_layer(angles[2*i+1], H1) 
 
        qaoa.mixer_layer(angles[2*i], H0) 
 
    return qml.expval(H1)
</span></pre>
<p><span class="koboSpan" id="kobo.1481.1" xmlns="http://www.w3.org/1999/xhtml">There are </span><span id="dx1-104060"/><span class="koboSpan" id="kobo.1482.1" xmlns="http://www.w3.org/1999/xhtml">several details that we need to </span><span id="dx1-104061"/><span class="koboSpan" id="kobo.1483.1" xmlns="http://www.w3.org/1999/xhtml">explain here. </span><span class="koboSpan" id="kobo.1483.2" xmlns="http://www.w3.org/1999/xhtml">First, we are working with a simple problem in which we want to find the ground state of </span><span class="koboSpan" id="kobo.1484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1485.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1485.2" xmlns="http://www.w3.org/1999/xhtml">We have defined our </span><span class="koboSpan" id="kobo.1486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1487.1" xmlns="http://www.w3.org/1999/xhtml"> Hamiltonian as </span><span class="koboSpan" id="kobo.1488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X_{0} + X_{1}" class="math inline" src="../media/file775.png" style="vertical-align:middle" title="X_{0} + X_{1}"/></span><span class="koboSpan" id="kobo.1489.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1490.1" xmlns="http://www.w3.org/1999/xhtml">H0</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1491.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1492.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1493.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1494.1" xmlns="http://www.w3.org/1999/xhtml">PauliX</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1495.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1496.1" xmlns="http://www.w3.org/1999/xhtml">+</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1497.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1498.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1499.1" xmlns="http://www.w3.org/1999/xhtml">PauliX</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1500.1" xmlns="http://www.w3.org/1999/xhtml">(1)</span></code></span></span><span class="koboSpan" id="kobo.1501.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1501.2" xmlns="http://www.w3.org/1999/xhtml">For </span><span class="koboSpan" id="kobo.1502.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.1503.1" xmlns="http://www.w3.org/1999/xhtml">, we have used </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1504.1" xmlns="http://www.w3.org/1999/xhtml">1.0*</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1505.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1506.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1507.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1508.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1509.1" xmlns="http://www.w3.org/1999/xhtml">@</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1510.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1511.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1512.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1513.1" xmlns="http://www.w3.org/1999/xhtml">(1)</span></code></span></span><span class="koboSpan" id="kobo.1514.1" xmlns="http://www.w3.org/1999/xhtml"> instead of just </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.1515.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1516.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1517.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1518.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1519.1" xmlns="http://www.w3.org/1999/xhtml">@</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1520.1" xmlns="http://www.w3.org/1999/xhtml">qml</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1521.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1522.1" xmlns="http://www.w3.org/1999/xhtml">PauliZ</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1523.1" xmlns="http://www.w3.org/1999/xhtml">(1)</span></code></span></span><span class="koboSpan" id="kobo.1524.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1524.2" xmlns="http://www.w3.org/1999/xhtml">If you do not include the </span><code><span class="koboSpan" id="kobo.1525.1" xmlns="http://www.w3.org/1999/xhtml">1.0</span></code><span class="koboSpan" id="kobo.1526.1" xmlns="http://www.w3.org/1999/xhtml"> coefficient, the tensor product will not be converted to a </span><code><span class="koboSpan" id="kobo.1527.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian</span></code><span class="koboSpan" id="kobo.1528.1" xmlns="http://www.w3.org/1999/xhtml"> object, so you should be careful with that. </span><span class="koboSpan" id="kobo.1528.2" xmlns="http://www.w3.org/1999/xhtml">Another important detail is that the </span><code><span class="koboSpan" id="kobo.1529.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></code><span class="koboSpan" id="kobo.1530.1" xmlns="http://www.w3.org/1999/xhtml"> function only receives as parameters the angles for the rotations in the QAOA circuit and we have declared </span><code><span class="koboSpan" id="kobo.1531.1" xmlns="http://www.w3.org/1999/xhtml">p</span></code><span class="koboSpan" id="kobo.1532.1" xmlns="http://www.w3.org/1999/xhtml"> as a global variable. </span><span class="koboSpan" id="kobo.1532.2" xmlns="http://www.w3.org/1999/xhtml">This is because we later want to optimize </span><code><span class="koboSpan" id="kobo.1533.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></code><span class="koboSpan" id="kobo.1534.1" xmlns="http://www.w3.org/1999/xhtml"> with respect to its parameters, and </span><code><span class="koboSpan" id="kobo.1535.1" xmlns="http://www.w3.org/1999/xhtml">p</span></code><span class="koboSpan" id="kobo.1536.1" xmlns="http://www.w3.org/1999/xhtml"> is not something that we want to optimize, but a fixed value — in this case, we are setting it to </span><span class="koboSpan" id="kobo.1537.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1538.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1539.1" xmlns="http://www.w3.org/1999/xhtml">Finally, notice that the exponentials for </span><span class="koboSpan" id="kobo.1540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.1541.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1543.1" xmlns="http://www.w3.org/1999/xhtml"> receive their parameters from the </span><code><span class="koboSpan" id="kobo.1544.1" xmlns="http://www.w3.org/1999/xhtml">angles</span></code><span class="koboSpan" id="kobo.1545.1" xmlns="http://www.w3.org/1999/xhtml"> list alternating between </span><span class="koboSpan" id="kobo.1546.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1547.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1548.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.1549.1" xmlns="http://www.w3.org/1999/xhtml">: first for the </span><span class="koboSpan" id="kobo.1550.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1551.1" xmlns="http://www.w3.org/1999/xhtml"> exponential (which is implemented by </span><code><span class="koboSpan" id="kobo.1552.1" xmlns="http://www.w3.org/1999/xhtml">mixer_layer</span></code><span class="koboSpan" id="kobo.1553.1" xmlns="http://www.w3.org/1999/xhtml">), then for the </span><span class="koboSpan" id="kobo.1554.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{1}" class="math inline" src="../media/file544.png" style="vertical-align:middle" title="H_{1}"/></span><span class="koboSpan" id="kobo.1555.1" xmlns="http://www.w3.org/1999/xhtml"> exponential (implemented by </span><code><span class="koboSpan" id="kobo.1556.1" xmlns="http://www.w3.org/1999/xhtml">cost_layer</span></code><span class="koboSpan" id="kobo.1557.1" xmlns="http://www.w3.org/1999/xhtml">), then again for the </span><span class="koboSpan" id="kobo.1558.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{0}" class="math inline" src="../media/file545.png" style="vertical-align:middle" title="H_{0}"/></span><span class="koboSpan" id="kobo.1559.1" xmlns="http://www.w3.org/1999/xhtml"> exponential, and so on. </span><span class="koboSpan" id="kobo.1559.2" xmlns="http://www.w3.org/1999/xhtml">In the </span><span id="dx1-104062"/><span class="koboSpan" id="kobo.1560.1" xmlns="http://www.w3.org/1999/xhtml">notation that we </span><span id="dx1-104063"/><span class="koboSpan" id="kobo.1561.1" xmlns="http://www.w3.org/1999/xhtml">have been using throughout this chapter, if </span><code><span class="koboSpan" id="kobo.1562.1" xmlns="http://www.w3.org/1999/xhtml">angles</span></code><span class="koboSpan" id="kobo.1563.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><code><span class="koboSpan" id="kobo.1564.1" xmlns="http://www.w3.org/1999/xhtml">[1.0,2.0.3.0,4.0]</span></code><span class="koboSpan" id="kobo.1565.1" xmlns="http://www.w3.org/1999/xhtml">, then we would have </span><span class="koboSpan" id="kobo.1566.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{1} = 1" class="math inline" src="../media/file753.png" style="vertical-align:middle" title="\beta_{1} = 1"/></span><span class="koboSpan" id="kobo.1567.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1568.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{1} = 2" class="math inline" src="../media/file776.png" style="vertical-align:middle" title="\gamma_{1} = 2"/></span><span class="koboSpan" id="kobo.1569.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1570.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\beta_{2} = 3" class="math inline" src="../media/file777.png" style="vertical-align:middle" title="\beta_{2} = 3"/></span><span class="koboSpan" id="kobo.1571.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1572.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\gamma_{2} = 4" class="math inline" src="../media/file756.png" style="vertical-align:middle" title="\gamma_{2} = 4"/></span><span class="koboSpan" id="kobo.1573.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1573.2" xmlns="http://www.w3.org/1999/xhtml">Now we are ready to run the optimization process. </span><span class="koboSpan" id="kobo.1573.3" xmlns="http://www.w3.org/1999/xhtml">To do that, we can use the following code:</span></p>
<pre class="lstlisting" id="listing-139"><span class="koboSpan" id="kobo.1574.1" xmlns="http://www.w3.org/1999/xhtml">

from pennylane import numpy as np 
 
optimizer = qml.GradientDescentOptimizer() 
 
steps = 20 
 
angles = np.array([1,1,1,1], requires_grad=True) 
 
 
 
for i in range(steps): 
 
    angles = optimizer.step(energy, angles) 
 
 
 
print("Optimal angles", angles)
</span></pre>
<p><span class="koboSpan" id="kobo.1575.1" xmlns="http://www.w3.org/1999/xhtml">We are using </span><code><span class="koboSpan" id="kobo.1576.1" xmlns="http://www.w3.org/1999/xhtml">GradientDescentOptimizer</span></code><span class="koboSpan" id="kobo.1577.1" xmlns="http://www.w3.org/1999/xhtml"> as the classical minimizer. </span><span class="koboSpan" id="kobo.1577.2" xmlns="http://www.w3.org/1999/xhtml">It uses the famous gradient descent algorithm — we will study this method in detail in </span><em><span class="koboSpan" id="kobo.1578.1" xmlns="http://www.w3.org/1999/xhtml">Part</span></em> <em/> <a href="ch016.xhtml#x1-138000III"><em><span class="koboSpan" id="kobo.1579.1" xmlns="http://www.w3.org/1999/xhtml">III</span></em></a><span class="koboSpan" id="kobo.1580.1" xmlns="http://www.w3.org/1999/xhtml"> of the book — by taking advantage of the fact that PennyLane implements automatic differentiation to compute all the required derivatives. </span><span class="koboSpan" id="kobo.1580.2" xmlns="http://www.w3.org/1999/xhtml">That is why we use </span><code><span class="koboSpan" id="kobo.1581.1" xmlns="http://www.w3.org/1999/xhtml">requires_grad</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1582.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1583.1" xmlns="http://www.w3.org/1999/xhtml">True</span></code><span class="koboSpan" id="kobo.1584.1" xmlns="http://www.w3.org/1999/xhtml"> when defining the initial angles, to inform PennyLane that these are parameters for which we will need to compute gradients. </span><span class="koboSpan" id="kobo.1584.2" xmlns="http://www.w3.org/1999/xhtml">We run the process for 10 steps and…voilá! </span><span class="koboSpan" id="kobo.1584.3" xmlns="http://www.w3.org/1999/xhtml">We obtain some (close to) optimal parameters. </span><span class="koboSpan" id="kobo.1584.4" xmlns="http://www.w3.org/1999/xhtml">In this case, </span><code><span class="koboSpan" id="kobo.1585.1" xmlns="http://www.w3.org/1999/xhtml">[0.78178403</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1586.1" xmlns="http://www.w3.org/1999/xhtml">0.7203965</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.1587.1" xmlns="http://www.w3.org/1999/xhtml">1.17250771</span></code></span><span style="color:#000000"> </span></p>
<p><code><span class="koboSpan" id="kobo.1588.1" xmlns="http://www.w3.org/1999/xhtml">1.27995423]</span></code><span class="koboSpan" id="kobo.1589.1" xmlns="http://www.w3.org/1999/xhtml"> was the answer found by the optimizer. </span><span class="koboSpan" id="kobo.1589.2" xmlns="http://www.w3.org/1999/xhtml">The angles and energy that you find can be highly dependent on the initial parameters, so it is advisable to run your code with several different choices of initial angles.</span></p>
<p><span class="koboSpan" id="kobo.1590.1" xmlns="http://www.w3.org/1999/xhtml">In any case, we can now sample from the QAOA circuit with the parameters that we have found in order to obtain candidate solutions to our problem. </span><span class="koboSpan" id="kobo.1590.2" xmlns="http://www.w3.org/1999/xhtml">We just need to modify slightly the </span><code><span class="koboSpan" id="kobo.1591.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></code><span class="koboSpan" id="kobo.1592.1" xmlns="http://www.w3.org/1999/xhtml"> function that we defined previously. </span><span class="koboSpan" id="kobo.1592.2" xmlns="http://www.w3.org/1999/xhtml">We can do it, for instance, as follows:</span></p>
<pre class="lstlisting" id="listing-140"><span class="koboSpan" id="kobo.1593.1" xmlns="http://www.w3.org/1999/xhtml">

@qml.qnode(dev) 
 
def sample_solutions(angles): 
 
    for w in wires: 
 
        qml.Hadamard(wires=w) 
 
    for i in range(p): 
 
        qaoa.cost_layer(angles[2*i+1], H1) 
 
        qaoa.mixer_layer(angles[2*i], H0) 
 
    return qml.sample() 
 
print(sample_solutions(angles, shots = 5))
</span></pre>
<p><span class="koboSpan" id="kobo.1594.1" xmlns="http://www.w3.org/1999/xhtml">The output when you run these </span><span id="dx1-104082"/><span class="koboSpan" id="kobo.1595.1" xmlns="http://www.w3.org/1999/xhtml">instructions will be something like the following:</span></p>
<pre class="lstlisting" id="listing-141"><span class="koboSpan" id="kobo.1596.1" xmlns="http://www.w3.org/1999/xhtml">

[[0 1] 
 
 [0 1] 
 
 [0 1] 
 
 [1 0] 
 
 [0 1]]
</span></pre>
<p><span class="koboSpan" id="kobo.1597.1" xmlns="http://www.w3.org/1999/xhtml">The five samples are, indeed, ground states of </span><span class="koboSpan" id="kobo.1598.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.1599.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1599.2" xmlns="http://www.w3.org/1999/xhtml">Once more, we have been able to use QAOA to solve the problem, this time with PennyLane!</span></p>
<p><span class="koboSpan" id="kobo.1600.1" xmlns="http://www.w3.org/1999/xhtml">You surely have </span><span id="dx1-104088"/><span class="koboSpan" id="kobo.1601.1" xmlns="http://www.w3.org/1999/xhtml">noticed that we have run our code on the </span><code><span class="koboSpan" id="kobo.1602.1" xmlns="http://www.w3.org/1999/xhtml">default</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.1603.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><code><span class="koboSpan" id="kobo.1604.1" xmlns="http://www.w3.org/1999/xhtml">qubit</span></code><span class="koboSpan" id="kobo.1605.1" xmlns="http://www.w3.org/1999/xhtml"> device, which is a simulator. </span><span class="koboSpan" id="kobo.1605.2" xmlns="http://www.w3.org/1999/xhtml">Of course, you can replace it with a quantum device, as we learned to do in </span><em><span class="koboSpan" id="kobo.1606.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch009.xhtml#x1-540002.3.2"><em><span class="koboSpan" id="kobo.1607.1" xmlns="http://www.w3.org/1999/xhtml">2.3.2</span></em></a><span class="koboSpan" id="kobo.1608.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1608.2" xmlns="http://www.w3.org/1999/xhtml">However, this will mean that you will have to wait on the quantum computer execution queue every time the optimizer needs to evaluate the energy of some parameters.</span></p>
<p><span class="koboSpan" id="kobo.1609.1" xmlns="http://www.w3.org/1999/xhtml">Unfortunately, at the time of writing, PennyLane does not yet include an option to run QAOA programs using Qiskit Runtime. </span><span class="koboSpan" id="kobo.1609.2" xmlns="http://www.w3.org/1999/xhtml">However, do not despair! </span><span class="koboSpan" id="kobo.1609.3" xmlns="http://www.w3.org/1999/xhtml">As we will learn in </span><em><span class="koboSpan" id="kobo.1610.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch015.xhtml#x1-1190007"><em><span class="koboSpan" id="kobo.1611.1" xmlns="http://www.w3.org/1999/xhtml">7</span></em></a><em><span class="koboSpan" id="kobo.1612.1" xmlns="http://www.w3.org/1999/xhtml">, VQE: Variational Quantum</span></em> <em><span class="koboSpan" id="kobo.1613.1" xmlns="http://www.w3.org/1999/xhtml">Solver</span></em><span class="koboSpan" id="kobo.1614.1" xmlns="http://www.w3.org/1999/xhtml">, there is a PennyLane implementation of Runtime programs for some other algorithms. </span><span class="koboSpan" id="kobo.1614.2" xmlns="http://www.w3.org/1999/xhtml">Hopefully, QAOA will receive the same treatment soon.</span></p>
<p><span class="koboSpan" id="kobo.1615.1" xmlns="http://www.w3.org/1999/xhtml">With this, we have now concluded our study of QAOA. </span><span class="koboSpan" id="kobo.1615.2" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we will study a different </span><span id="dx1-104089"/><span class="koboSpan" id="kobo.1616.1" xmlns="http://www.w3.org/1999/xhtml">method for finding solutions to optimization problems, and it will be based on one of the most famous of all </span><span id="dx1-104090"/><span class="koboSpan" id="kobo.1617.1" xmlns="http://www.w3.org/1999/xhtml">quantum algorithms ever: Grover’s algorithm.</span></p>
</section>
<section class="level2 likesectionHead" data-number="12.4" id="summary-4">
<h1 class="likesectionHead" data-number="12.4"><span id="x1-1050005.3"><span class="koboSpan" id="kobo.1618.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></span></h1>
<p><span id="Q1-1-139"/></p>
<p><span class="koboSpan" id="kobo.1619.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you have learned about QAOA, one of the most popular quantum algorithms used to solve optimization problems with gate-based quantum computers. </span><span class="koboSpan" id="kobo.1619.2" xmlns="http://www.w3.org/1999/xhtml">You now know that QAOA is derived as a discretization of quantum annealing and that it is implemented as a hybrid method that uses both a classical and a quantum computer to achieve its goal.</span></p>
<p><span class="koboSpan" id="kobo.1620.1" xmlns="http://www.w3.org/1999/xhtml">You also understand how to construct circuits for all the operations needed in the quantum part of the algorithm. </span><span class="koboSpan" id="kobo.1620.2" xmlns="http://www.w3.org/1999/xhtml">In particular, you know how to use these circuits to estimate expectation values in an efficient way.</span></p>
<p><span class="koboSpan" id="kobo.1621.1" xmlns="http://www.w3.org/1999/xhtml">You have also mastered the tools that Qiskit provides in order to implement QAOA instances and to run them on both quantum simulators and quantum computers. </span><span class="koboSpan" id="kobo.1621.2" xmlns="http://www.w3.org/1999/xhtml">You even know how to accelerate the process of running your code on quantum devices by using Qiskit Runtime. </span><span class="koboSpan" id="kobo.1621.3" xmlns="http://www.w3.org/1999/xhtml">And, should you need to use QAOA with PennyLane, you also know how to do it with the help of some predefined utilities and PennyLane capabilities for automatic differentiation. </span><span class="koboSpan" id="kobo.1621.4" xmlns="http://www.w3.org/1999/xhtml">This gives you the flexibility to solve optimization problems with QAOA in a number of different ways, depending on your needs and on the resources at your disposal.</span></p>
<p><span class="koboSpan" id="kobo.1622.1" xmlns="http://www.w3.org/1999/xhtml">Our next stop will be </span><strong><span class="koboSpan" id="kobo.1623.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s Adaptive Search</span></strong><span class="koboSpan" id="kobo.1624.1" xmlns="http://www.w3.org/1999/xhtml">, also known as </span><strong><span class="koboSpan" id="kobo.1625.1" xmlns="http://www.w3.org/1999/xhtml">GAS</span></strong><span class="koboSpan" id="kobo.1626.1" xmlns="http://www.w3.org/1999/xhtml">, a quite different quantum method that you can use to solve optimization problems, which we’ll cover in the next chapter.</span></p>
</section>
</section>
</body>
</html>
