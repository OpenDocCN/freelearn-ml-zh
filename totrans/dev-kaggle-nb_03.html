<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer060">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 class="chapterTitle" id="_idParaDest-37"><span class="koboSpan" id="kobo.2.1">Starting Our Travel – Surviving the Titanic Disaster</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">In this chapter, we will start our journey around the data world. </span><span class="koboSpan" id="kobo.3.2">The first dataset we will analyze is from the competition </span><em class="italic"><span class="koboSpan" id="kobo.4.1">Titanic - Machine Learning from Disaster</span></em><span class="koboSpan" id="kobo.5.1"> (refer </span><em class="italic"><span class="koboSpan" id="kobo.6.1">Reference 1</span></em><span class="koboSpan" id="kobo.7.1"> at the end of this chapter for a link to this dataset). </span><span class="koboSpan" id="kobo.7.2">It is a rather small dataset and, because it is related to a competition, it is split between train and test sets.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.8.1">In this chapter, besides the competition approach, we will introduce our systematic approach to exploratory data analysis and apply it to get familiar with the data, understand it in more detail, and extract useful insights. </span><span class="koboSpan" id="kobo.8.2">We will also provide a short introduction to the process of using the results of data analysis to build model training pipelines. </span><span class="koboSpan" id="kobo.8.3">Before diving into the actual data, it is useful to understand the context, and, ideally, define the possible objectives of the analysis.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.9.1">All the code snapshots and the figures in this chapter are extracted from the accompanying notebook, </span><em class="italic"><span class="koboSpan" id="kobo.10.1">Titanic - start of a journey around data world</span></em><span class="koboSpan" id="kobo.11.1"> (refer </span><em class="italic"><span class="koboSpan" id="kobo.12.1">Reference 2</span></em><span class="koboSpan" id="kobo.13.1">). </span><span class="koboSpan" id="kobo.13.2">The notebook is also available in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.14.1">Chapter-03</span></code><span class="koboSpan" id="kobo.15.1"> folder of the GitHub repository for the book (see </span><em class="italic"><span class="koboSpan" id="kobo.16.1">References 3</span></em><span class="koboSpan" id="kobo.17.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.18.1">4</span></em><span class="koboSpan" id="kobo.19.1">).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.20.1">In a nutshell, we will do the following in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.21.1">Find out the story behind the Titanic dataset. </span><span class="koboSpan" id="kobo.21.2">We will learn what happened on that fateful day in 1912 when the Titanic sank, and we will find out the size of the crew, how many passengers were aboard, and how many fatalities there were.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.22.1">Get familiar with the data, explain the meaning of the features, get a first view of the data quality, and explore some statistical information about the data.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.23.1">Continue the data exploration with univariate analysis after we introduce the graphical elements used through the analysis: a customized color palette and a derived color map.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.24.1">Add more insights into the data using multivariate analysis to capture complex interactions between the features.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.25.1">Perform a detailed analysis using the recorded passengers’ names, from which we will extract multiple features.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.26.1">Explore the richness of features using an aggregated view of feature variation.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.27.1">Prepare a baseline model.</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-38"><span class="koboSpan" id="kobo.28.1">A closer look at the Titanic</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.29.1">The Titanic was a British passenger ship that sank on its first voyage in the North Atlantic in April 1912. </span><span class="koboSpan" id="kobo.29.2">The tragic event, caused by striking an iceberg, resulted in more than 1,500 fatalities (the estimate by US</span><a id="_idIndexMarker076"/><span class="koboSpan" id="kobo.30.1"> officials was 1,517 and by the British investigating committee, it was 1,503) from the 2,224 total number of crew and passengers. </span><span class="koboSpan" id="kobo.30.2">Most of the casualties were part of the crew, followed by third-class passengers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.31.1">How was this possible? </span><span class="koboSpan" id="kobo.31.2">The Titanic was considered an unsinkable vessel when it was built using state-of-the-art technology in the early 20</span><sup class="superscript"><span class="koboSpan" id="kobo.32.1">th</span></sup><span class="koboSpan" id="kobo.33.1"> century. </span><span class="koboSpan" id="kobo.33.2">This confidence was the recipe for disaster. </span><span class="koboSpan" id="kobo.33.3">As we know, it did sink, as the contact with the iceberg damaged several water-tight compartments – enough to compromise its integrity. </span><span class="koboSpan" id="kobo.33.4">The ship was originally designed to carry 48 lifeboats but only 20 were present on board, and most of those were carrying less than 60% of their full capacity when they were lowered into the water.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.34.1">The Titanic was 269 meters in length and had a maximum breadth of 28 meters. </span><span class="koboSpan" id="kobo.34.2">It had seven decks identified with letters from A to G (A and B were for first-class passengers, C was mostly reserved for crew, and D to G were for second- and third-class passengers). </span><span class="koboSpan" id="kobo.34.3">It also had two additional decks: the boat deck (from where the boats were lowered into the water) and the Orlop deck (below the waterline). </span><span class="koboSpan" id="kobo.34.4">Although third-class and second-class amenities were not as luxurious and comfortable as those in first-class, all classes had common leisure facilities, like a library, smoking rooms, and even a gymnasium. </span><span class="koboSpan" id="kobo.34.5">Passengers could also use open-air or indoor promenade areas. </span><span class="koboSpan" id="kobo.34.6">The Titanic was advanced in terms of comfort and amenities compared to other liners of the era.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.35.1">The Titanic started its voyage from Southampton and had two other stops scheduled – one in Cherbourg, France, and one in Queenstown, Ireland. </span><span class="koboSpan" id="kobo.35.2">The passengers were shuttled with special trains from London and Paris to Southampton and Cherbourg, respectively. </span><span class="koboSpan" id="kobo.35.3">The crew on the Titanic consisted of around 885 people for this first trip. </span><span class="koboSpan" id="kobo.35.4">The majority of the crew were</span><a id="_idIndexMarker077"/><span class="koboSpan" id="kobo.36.1"> not sailors but stewards, who took care of the passengers, firemen, stockers, and engineers, who were in charge of the engines of the ship.</span></p>
<h1 class="heading-1" id="_idParaDest-39"><span class="koboSpan" id="kobo.37.1">Conducting data inspection</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.38.1">The story of the Titanic is fascinating. </span><span class="koboSpan" id="kobo.38.2">For those interested in data exploration, the data about the tragedy is also </span><a id="_idIndexMarker078"/><span class="koboSpan" id="kobo.39.1">captivating. </span><span class="koboSpan" id="kobo.39.2">Let’s start with a short introduction to the competition data. </span><span class="koboSpan" id="kobo.39.3">The dataset from </span><em class="italic"><span class="koboSpan" id="kobo.40.1">Titanic - Machine Learning from Disaster</span></em><span class="koboSpan" id="kobo.41.1"> contains three </span><strong class="keyWord"><span class="koboSpan" id="kobo.42.1">CSV</span></strong><span class="koboSpan" id="kobo.43.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.44.1">comma-separated values</span></strong><span class="koboSpan" id="kobo.45.1">) files, as in many Kaggle competitions that you will encounter:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.46.1">train.csv</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">test.csv</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.48.1">sample_submission.csv</span></code></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.49.1">We will start by loading these files into a new notebook. </span><span class="koboSpan" id="kobo.49.2">You learned how to do this in the previous chapter, in the </span><em class="italic"><span class="koboSpan" id="kobo.50.1">Basic capabilities</span></em><span class="koboSpan" id="kobo.51.1"> section. </span><span class="koboSpan" id="kobo.51.2">You can also create a notebook by forking one that already exists. </span><span class="koboSpan" id="kobo.51.3">In our case, we will start a new notebook from scratch.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.52.1">Usually, notebooks start with a cell in which we import packages. </span><span class="koboSpan" id="kobo.52.2">We will do the same here. </span><span class="koboSpan" id="kobo.52.3">In one of the next cells, we would like to read train and test data. </span><span class="koboSpan" id="kobo.52.4">In general, the CSV files that you need have similar directories as in this example:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.53.1">train_df = pd.read_csv(</span><span class="hljs-string"><span class="koboSpan" id="kobo.54.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.55.1">/kaggle/input/titanic/train.csv"</span></span><span class="koboSpan" id="kobo.56.1">)
test_df = pd.read_csv(</span><span class="hljs-string"><span class="koboSpan" id="kobo.57.1">"/kaggle/input/titanic/test.csv"</span></span><span class="koboSpan" id="kobo.58.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.59.1">After we load the data, we will manually inspect it, looking at what each column contains – that is, samples of data. </span><span class="koboSpan" id="kobo.59.2">We will do this for each file in the dataset, but mostly, we will focus on the train and test files for now.</span></p>
<h2 class="heading-2" id="_idParaDest-40"><span class="koboSpan" id="kobo.60.1">Understanding the data</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.61.1">In </span><em class="italic"><span class="koboSpan" id="kobo.62.1">Figures 3.1</span></em><span class="koboSpan" id="kobo.63.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.64.1">3.2</span></em><span class="koboSpan" id="kobo.65.1">, we get a glimpse of a selection of values. </span><span class="koboSpan" id="kobo.65.2">From this visual inspection, we can already see some characteristics of the data. </span><span class="koboSpan" id="kobo.65.3">Let’s try to summarize them. </span><span class="koboSpan" id="kobo.65.4">The following columns are</span><a id="_idIndexMarker079"/><span class="koboSpan" id="kobo.66.1"> common to both train and test files:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.67.1">PassengerId</span></code><span class="koboSpan" id="kobo.68.1">: A unique identifier for each patient.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">Pclass</span></code><span class="koboSpan" id="kobo.70.1">: The class in which each passenger was traveling. </span><span class="koboSpan" id="kobo.70.2">We know from our background information that possible values are 1, 2, or 3. </span><span class="koboSpan" id="kobo.70.3">This can be considered a categorical data type. </span><span class="koboSpan" id="kobo.70.4">Because the order of the class conveys meaning and is ordered, we can consider it as ordinal or numerical.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.71.1">Name</span></code><span class="koboSpan" id="kobo.72.1">: This is a text type of field. </span><span class="koboSpan" id="kobo.72.2">It is the full name of the passenger, with their family name, first name, and, in some cases, their name before marriage, as well as a nickname. </span><span class="koboSpan" id="kobo.72.3">It also contains their title regarding social class, background, profession, or, in some cases, royalty.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.73.1">Sex</span></code><span class="koboSpan" id="kobo.74.1">: This is also a categorical field. </span><span class="koboSpan" id="kobo.74.2">We can assume that this was important information at the time, considering that they prioritized saving women and children first.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.75.1">Age</span></code><span class="koboSpan" id="kobo.76.1">: This is a numerical field. </span><span class="koboSpan" id="kobo.76.2">Also, their age was an important feature since children were prioritized for saving.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.77.1">SibSp</span></code><span class="koboSpan" id="kobo.78.1">: This field provides the siblings or the spouse of each passenger. </span><span class="koboSpan" id="kobo.78.2">It is an indicator of the size of the family or group with which the passenger was traveling. </span><span class="koboSpan" id="kobo.78.3">This is important information since we can safely assume that one would not board a lifeboat without their brothers, sisters, or partner.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">Parch</span></code><span class="koboSpan" id="kobo.80.1">: This is the number of parents (for child passengers) or children (for parent passengers). </span><span class="koboSpan" id="kobo.80.2">Considering that parents would wait for all their children before boarding a lifeboat, this is also an important feature. </span><span class="koboSpan" id="kobo.80.3">Together with </span><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">SibSp</span></code><span class="koboSpan" id="kobo.82.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">Parch</span></code><span class="koboSpan" id="kobo.84.1"> can be used to calculate the size of the family for each passenger.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.85.1">Ticket</span></code><span class="koboSpan" id="kobo.86.1">: This is a code associated with the ticket. </span><span class="koboSpan" id="kobo.86.2">It is an alphanumerical field, neither categorical nor numerical.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">Fare</span></code><span class="koboSpan" id="kobo.88.1">: This is a numerical field. </span><span class="koboSpan" id="kobo.88.2">From the sample we see, we can observe that </span><code class="inlineCode"><span class="koboSpan" id="kobo.89.1">Fare</span></code><span class="koboSpan" id="kobo.90.1"> values varied considerably (with one order of magnitude from class 3 to class 1) but we can also see that some of the passengers in the same class had quite different </span><code class="inlineCode"><span class="koboSpan" id="kobo.91.1">Fare</span></code><span class="koboSpan" id="kobo.92.1"> values.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.93.1">Cabin</span></code><span class="koboSpan" id="kobo.94.1">: This is an alphanumerical field. </span><span class="koboSpan" id="kobo.94.2">From the small sample that we see in </span><em class="italic"><span class="koboSpan" id="kobo.95.1">Figures 3.1</span></em><span class="koboSpan" id="kobo.96.1"> and</span><em class="italic"><span class="koboSpan" id="kobo.97.1"> 3.2</span></em><span class="koboSpan" id="kobo.98.1">, we can see that some of the values are missing. </span><span class="koboSpan" id="kobo.98.2">In other cases, there are multiple cabins reserved for the same passenger (presumably a well-to-do passenger traveling with their family). </span><span class="koboSpan" id="kobo.98.3">The name of a cabin starts with a letter (C, D, E, or F). </span><span class="koboSpan" id="kobo.98.4">We remember that there are multiple decks on the Titanic so we can guess that the letter represents the deck and then that is </span><a id="_idIndexMarker080"/><span class="koboSpan" id="kobo.99.1">followed by the cabin number on that deck.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.100.1">Embarked</span></code><span class="koboSpan" id="kobo.101.1">: This is a categorical field. </span><span class="koboSpan" id="kobo.101.2">In the sample here, we only see the letters C, S, and Q, and we already know that the Titanic started from Southampton and had a stop at Cherbourg, France, and one at Queenstown (today, this is called Cobh, the port for Cork, Ireland). </span><span class="koboSpan" id="kobo.101.3">We can infer that S stands for Southampton (the starting port), C stands for Cherbourg, and Q for Queenstown.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.102.1">The train file contains a </span><code class="inlineCode"><span class="koboSpan" id="kobo.103.1">Survived</span></code><span class="koboSpan" id="kobo.104.1"> field as well, which is the target feature. </span><span class="koboSpan" id="kobo.104.2">This has either a value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">1</span></code><span class="koboSpan" id="kobo.106.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">0</span></code><span class="koboSpan" id="kobo.108.1">, where </span><code class="inlineCode"><span class="koboSpan" id="kobo.109.1">1</span></code><span class="koboSpan" id="kobo.110.1"> means the passenger survived and </span><code class="inlineCode"><span class="koboSpan" id="kobo.111.1">0</span></code><span class="koboSpan" id="kobo.112.1"> means they sadly didn’t.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.113.1"><img alt="" role="presentation" src="../Images/B20963_03_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.114.1">Figure 3.1: Sample of the train data file</span></p>
<p class="normal"><span class="koboSpan" id="kobo.115.1">The test file does not include the target feature, as you can see in the following sample:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.116.1"><img alt="" role="presentation" src="../Images/B20963_03_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.117.1">Figure 3.2: Sample of the test data file</span></p>
<p class="normal"><span class="koboSpan" id="kobo.118.1">Once we have had a look at </span><a id="_idIndexMarker081"/><span class="koboSpan" id="kobo.119.1">the columns in the train and test files, we can continue with a few additional checks to find the dimensions of the datasets and the feature distribution:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.120.1">Check the shape of each dataset (</span><code class="inlineCode"><span class="koboSpan" id="kobo.121.1">train_df</span></code><span class="koboSpan" id="kobo.122.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.123.1">test_df</span></code><span class="koboSpan" id="kobo.124.1">), using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.125.1">shape()</span></code><span class="koboSpan" id="kobo.126.1"> function. </span><span class="koboSpan" id="kobo.126.2">This will give us the dimension of the train and test files (number of rows and columns).</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.127.1">Run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.128.1">info()</span></code><span class="koboSpan" id="kobo.129.1"> function for each dataset. </span><span class="koboSpan" id="kobo.129.2">This will give us more complex information, such as the amount of non-null data per column, and the type of the data.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.130.1">Run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">describe()</span></code><span class="koboSpan" id="kobo.132.1"> function for each dataset. </span><span class="koboSpan" id="kobo.132.2">This only applies to numerical data and will create a statistic on the data distribution, including minimum, maximum, and first 25%, 50%, and 75% values, as well as the average value and standard deviation.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.133.1">The preceding checks give us preliminary information on the data distribution for the numerical values in the train and test datasets. </span><span class="koboSpan" id="kobo.133.2">We can continue later in our analysis with more sophisticated and detailed tools, but for now, you may consider these steps a general preliminary approach for investigating any tabular dataset that you put your hands on.</span></p>
<h2 class="heading-2" id="_idParaDest-41"><span class="koboSpan" id="kobo.134.1">Analyzing the data</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.135.1">By evaluating the</span><a id="_idIndexMarker082"/><span class="koboSpan" id="kobo.136.1"> shape of the dataset, the types of values, the number of null values, and the feature distribution, we will form a preliminary image of the dataset.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.137.1">We can build our own tools for inspecting data statistics. </span><span class="koboSpan" id="kobo.137.2">I will introduce here three small scripts to get the missing value stats, the unique values, and the most frequent values.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.138.1">First, the code to retrieve missing data:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.139.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.140.1">missing_data</span></span><span class="koboSpan" id="kobo.141.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.142.1">data</span></span><span class="koboSpan" id="kobo.143.1">):
    total = data.isnull().</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.144.1">sum</span></span><span class="koboSpan" id="kobo.145.1">()
    percent = (data.isnull().</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.146.1">sum</span></span><span class="koboSpan" id="kobo.147.1">()/data.isnull().count()*</span><span class="hljs-number"><span class="koboSpan" id="kobo.148.1">100</span></span><span class="koboSpan" id="kobo.149.1">)
    tt = pd.concat([total, percent], axis=</span><span class="hljs-number"><span class="koboSpan" id="kobo.150.1">1</span></span><span class="koboSpan" id="kobo.151.1">, keys=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.152.1">'Total'</span></span><span class="koboSpan" id="kobo.153.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.154.1">'Percent'</span></span><span class="koboSpan" id="kobo.155.1">])
    types = []
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.156.1">for</span></span><span class="koboSpan" id="kobo.157.1"> col </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.158.1">in</span></span><span class="koboSpan" id="kobo.159.1"> data.columns:
        dtype = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.160.1">str</span></span><span class="koboSpan" id="kobo.161.1">(data[col].dtype)
        types.append(dtype)
    tt[</span><span class="hljs-string"><span class="koboSpan" id="kobo.162.1">'Types'</span></span><span class="koboSpan" id="kobo.163.1">] = types
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.164.1">return</span></span><span class="koboSpan" id="kobo.165.1">(np.transpose(tt))
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.166.1">Next, the code to </span><a id="_idIndexMarker083"/><span class="koboSpan" id="kobo.167.1">display the most frequent values:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.168.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.169.1">most_frequent_values</span></span><span class="koboSpan" id="kobo.170.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.171.1">data</span></span><span class="koboSpan" id="kobo.172.1">):
    total = data.count()
    tt = pd.DataFrame(total)
    tt.columns = [</span><span class="hljs-string"><span class="koboSpan" id="kobo.173.1">'Total'</span></span><span class="koboSpan" id="kobo.174.1">]
    items = []
    vals = []
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.175.1">for</span></span><span class="koboSpan" id="kobo.176.1"> col </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.177.1">in</span></span><span class="koboSpan" id="kobo.178.1"> data.columns:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.179.1">try</span></span><span class="koboSpan" id="kobo.180.1">:
            itm = data[col].value_counts().index[</span><span class="hljs-number"><span class="koboSpan" id="kobo.181.1">0</span></span><span class="koboSpan" id="kobo.182.1">]
            val = data[col].value_counts().values[</span><span class="hljs-number"><span class="koboSpan" id="kobo.183.1">0</span></span><span class="koboSpan" id="kobo.184.1">]
            items.append(itm)
            vals.append(val)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.185.1">except</span></span><span class="koboSpan" id="kobo.186.1"> Exception </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.187.1">as</span></span><span class="koboSpan" id="kobo.188.1"> ex:
            </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.189.1">print</span></span><span class="koboSpan" id="kobo.190.1">(ex)
            items.append(</span><span class="hljs-number"><span class="koboSpan" id="kobo.191.1">0</span></span><span class="koboSpan" id="kobo.192.1">)
            vals.append(</span><span class="hljs-number"><span class="koboSpan" id="kobo.193.1">0</span></span><span class="koboSpan" id="kobo.194.1">)
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.195.1">continue</span></span><span class="koboSpan" id="kobo.196.1">
    tt[</span><span class="hljs-string"><span class="koboSpan" id="kobo.197.1">'Most frequent item'</span></span><span class="koboSpan" id="kobo.198.1">] = items
    tt[</span><span class="hljs-string"><span class="koboSpan" id="kobo.199.1">'Frequence'</span></span><span class="koboSpan" id="kobo.200.1">] = vals
    tt[</span><span class="hljs-string"><span class="koboSpan" id="kobo.201.1">'Percent from total'</span></span><span class="koboSpan" id="kobo.202.1">] = np.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.203.1">round</span></span><span class="koboSpan" id="kobo.204.1">(vals / total * </span><span class="hljs-number"><span class="koboSpan" id="kobo.205.1">100</span></span><span class="koboSpan" id="kobo.206.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.207.1">3</span></span><span class="koboSpan" id="kobo.208.1">)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.209.1">return</span></span><span class="koboSpan" id="kobo.210.1">(np.transpose(tt))
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.211.1">And finally, the code for unique values:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.212.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.213.1">unique_values</span></span><span class="koboSpan" id="kobo.214.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.215.1">data</span></span><span class="koboSpan" id="kobo.216.1">):
    total = data.count()
    tt = pd.DataFrame(total)
    tt.columns = [</span><span class="hljs-string"><span class="koboSpan" id="kobo.217.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.218.1">Total'</span></span><span class="koboSpan" id="kobo.219.1">]
    uniques = []
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.220.1">for</span></span><span class="koboSpan" id="kobo.221.1"> col </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.222.1">in</span></span><span class="koboSpan" id="kobo.223.1"> data.columns:
        unique = data[col].nunique()
        uniques.append(unique)
    tt[</span><span class="hljs-string"><span class="koboSpan" id="kobo.224.1">'Uniques'</span></span><span class="koboSpan" id="kobo.225.1">] = uniques
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.226.1">return</span></span><span class="koboSpan" id="kobo.227.1">(np.transpose(tt))
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.228.1">In the next chapter, we will reuse these functions. </span><span class="koboSpan" id="kobo.228.2">On Kaggle, you can do this by implementing utility scripts. </span><span class="koboSpan" id="kobo.228.3">We will include these functions in a reusable utility script that will then be included in other notebooks as well.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.229.1">In the following figure, we</span><a id="_idIndexMarker084"/><span class="koboSpan" id="kobo.230.1"> see the result of applying the </span><code class="inlineCode"><span class="koboSpan" id="kobo.231.1">missing_data</span></code><span class="koboSpan" id="kobo.232.1"> function to the train (</span><em class="italic"><span class="koboSpan" id="kobo.233.1">a</span></em><span class="koboSpan" id="kobo.234.1">) and test (</span><em class="italic"><span class="koboSpan" id="kobo.235.1">b</span></em><span class="koboSpan" id="kobo.236.1">) datasets:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.237.1"><img alt="" role="presentation" src="../Images/B20963_03_03.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.238.1">a</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.239.1"><img alt="" role="presentation" src="../Images/B20963_03_04.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.240.1">b</span></p>
<p class="packt_figref"><span class="koboSpan" id="kobo.241.1">Figure 3.3: Missing values in (a) train and (b) test sets, respectively</span></p>
<p class="normal"><span class="koboSpan" id="kobo.242.1">Some of the fields, like </span><code class="inlineCode"><span class="koboSpan" id="kobo.243.1">Age</span></code><span class="koboSpan" id="kobo.244.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">Cabin</span></code><span class="koboSpan" id="kobo.246.1">, show a considerable percentage of missing data, both for train and test datasets. </span><span class="koboSpan" id="kobo.246.2">From the inspection of the missing data percentage, we can also preliminarily evaluate the quality of the data with respect to the train-test split. </span><span class="koboSpan" id="kobo.246.3">If the percentages of missing values for a certain feature are very different in train and test data, we can already suspect that the splitting did not capture the overall data distribution. </span><span class="koboSpan" id="kobo.246.4">In our case, the percentages of missing values have close values for each feature in the train and test datasets.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.247.1">In the following figure, we</span><a id="_idIndexMarker085"/><span class="koboSpan" id="kobo.248.1"> can see the most frequent values for the features in the train (</span><em class="italic"><span class="koboSpan" id="kobo.249.1">a</span></em><span class="koboSpan" id="kobo.250.1">) and test (</span><em class="italic"><span class="koboSpan" id="kobo.251.1">b</span></em><span class="koboSpan" id="kobo.252.1">) datasets:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.253.1"><img alt="" role="presentation" src="../Images/B20963_03_05.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.254.1">a</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.255.1"><img alt="" role="presentation" src="../Images/B20963_03_06.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.256.1">b</span></p>
<p class="packt_figref"><span class="koboSpan" id="kobo.257.1">Figure 3.4: Most frequent values in (a) train and (b) test sets, respectively.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.258.1">We already can see from the preceding data that most of the people on the Titanic were male (and this majority is reflected in both the train and test datasets), and most of the passengers and crew embarked in Southampton (</span><code class="inlineCode"><span class="koboSpan" id="kobo.259.1">S</span></code><span class="koboSpan" id="kobo.260.1">). </span><span class="koboSpan" id="kobo.260.2">For features with more granular values, like </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">Age</span></code><span class="koboSpan" id="kobo.262.1">, the most frequent value differs in train and test data, although the values with maximum frequency are close (</span><code class="inlineCode"><span class="koboSpan" id="kobo.263.1">Age</span></code><span class="koboSpan" id="kobo.264.1"> value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.265.1">21</span></code><span class="koboSpan" id="kobo.266.1"> in train versus </span><code class="inlineCode"><span class="koboSpan" id="kobo.267.1">24</span></code><span class="koboSpan" id="kobo.268.1"> in the test dataset). </span><span class="koboSpan" id="kobo.268.2">This hints at the limitations of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.269.1">Age</span></code><span class="koboSpan" id="kobo.270.1"> directly as a feature in a machine learning model since we can already observe that the overall distribution is different between train and test data.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.271.1">The following figure shows the results of applying the </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">unique_values</span></code><span class="koboSpan" id="kobo.273.1"> function to obtain the unique values stats for train and test datasets:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.274.1"><img alt="" role="presentation" src="../Images/B20963_03_07.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.275.1">a</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.276.1"><img alt="" role="presentation" src="../Images/B20963_03_08.png"/></span></figure>
<p class="center"><span class="koboSpan" id="kobo.277.1">b</span></p>
<p class="packt_figref"><span class="koboSpan" id="kobo.278.1">Figure 3.5: Unique values in (a) train and (b) test sets, respectively</span></p>
<p class="normal"><span class="koboSpan" id="kobo.279.1">As you can see, for</span><a id="_idIndexMarker086"/><span class="koboSpan" id="kobo.280.1"> the categorical type of fields, all categories present in the train dataset are also present in the test dataset. </span><span class="koboSpan" id="kobo.280.2">Ideally, we would like the same results to show for numerical features such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.281.1">SibSp</span></code><span class="koboSpan" id="kobo.282.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.283.1">Parch</span></code><span class="koboSpan" id="kobo.284.1">. </span><span class="koboSpan" id="kobo.284.2">However, in the case of </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1">Parch</span></code><span class="koboSpan" id="kobo.286.1">, we can see that the number of unique values is </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">7</span></code><span class="koboSpan" id="kobo.288.1"> in train and </span><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">8</span></code><span class="koboSpan" id="kobo.290.1"> in test data.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.291.1">In this section, we started with an initial data inspection to understand the dataset features, followed by checking the data quality to see whether we had missing values. </span><span class="koboSpan" id="kobo.291.2">We also conducted a statistical analysis of the features in both train and test datasets. </span><span class="koboSpan" id="kobo.291.3">Next in our data exploration, we will perform univariate analysis on the categorical and numerical features of the train and test datasets. </span><span class="koboSpan" id="kobo.291.4">The images with plots of various features provide more information and are easier to understand and interpret, even for a non-technical reader.</span></p>
<h1 class="heading-1" id="_idParaDest-42"><span class="koboSpan" id="kobo.292.1">Performing univariate analysis</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.293.1">Before starting to build our first plots, we will set a unique color scheme for the notebook. </span><span class="koboSpan" id="kobo.293.2">Ensuring color and style unity across the entire notebook helps us to maintain the consistency of the</span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.294.1"> presentation and ensures a well-balanced experience for the reader. </span><span class="koboSpan" id="kobo.294.2">The notebook will have a consistent presentation and the visuals will coherently support the notebook narrative.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.295.1">Therefore, we will define the set of colors that we will use throughout the notebook in our graphics. </span><span class="koboSpan" id="kobo.295.2">We will select a palette that will create a visual identity specific to our work. </span><span class="koboSpan" id="kobo.295.3">This can be one of the already-defined palettes or color sets or we can define our own palette, based on a set of colors chosen to match the subject. </span><span class="koboSpan" id="kobo.295.4">For this sea-faring (or nautical) related notebook, I chose</span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.296.1"> a set of marine colors with several shades of blue. </span><span class="koboSpan" id="kobo.296.2">Based on this set of colors, I also defined a palette. </span><span class="koboSpan" id="kobo.296.3">The code for defining and displaying the palette is:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.297.1">import</span></span><span class="koboSpan" id="kobo.298.1"> matplotlib.pyplot </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.299.1">as</span></span><span class="koboSpan" id="kobo.300.1"> plt
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.301.1">from</span></span><span class="koboSpan" id="kobo.302.1"> matplotlib.colors </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.303.1">import</span></span><span class="koboSpan" id="kobo.304.1"> ListedColormap
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.305.1">import</span></span><span class="koboSpan" id="kobo.306.1"> seaborn </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.307.1">as</span></span><span class="koboSpan" id="kobo.308.1"> sns
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.309.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.310.1">set_color_map</span></span><span class="koboSpan" id="kobo.311.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.312.1">color_list</span></span><span class="koboSpan" id="kobo.313.1">):
    cmap_custom = ListedColormap(color_list)
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.314.1">print</span></span><span class="koboSpan" id="kobo.315.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.316.1">"Notebook Color Schema:"</span></span><span class="koboSpan" id="kobo.317.1">)
    sns.palplot(sns.color_palette(color_list))
    plt.show()
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.318.1">return</span></span><span class="koboSpan" id="kobo.319.1"> cmap_custom
color_list = [</span><span class="hljs-string"><span class="koboSpan" id="kobo.320.1">"#A5D7E8"</span></span><span class="koboSpan" id="kobo.321.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.322.1">"#576CBC"</span></span><span class="koboSpan" id="kobo.323.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.324.1">"#19376D"</span></span><span class="koboSpan" id="kobo.325.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.326.1">"#0b2447"</span></span><span class="koboSpan" id="kobo.327.1">]
cmap_custom = set_color_map(color_list)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.328.1">In the following figure, we show the reduced set of colors that compose our custom palette. </span><span class="koboSpan" id="kobo.328.2">The notebook color scheme uses shades of blue, from a pale clear-sky color to a dark ultramarine:</span></p>
<p class="packt_figref"><span class="koboSpan" id="kobo.329.1"><img alt="Chart  Description automatically generated" src="../Images/B20963_03_09.png"/></span></p>
<p class="packt_figref"><span class="koboSpan" id="kobo.330.1">Figure 3.6: The notebook color scheme</span></p>
<p class="normal"><span class="koboSpan" id="kobo.331.1">We will define two plotting functions (one for categorical, and one for continuous/numerical values) to represent the distribution of one feature on the same image, grouped by survival or grouped by the train/test set.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.332.1">We will concatenate train and test in a single dataset (and add a new column storing the original/source dataset). </span><span class="koboSpan" id="kobo.332.2">The functions use two of the most common libraries for data plotting: </span><code class="inlineCode"><span class="koboSpan" id="kobo.333.1">matplotlib</span></code><span class="koboSpan" id="kobo.334.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.335.1">seaborn</span></code><span class="koboSpan" id="kobo.336.1">. </span><span class="koboSpan" id="kobo.336.2">As we will plot these graphs for multiple features, it is preferable to define a few plotting functions, so that we don’t repeat the code.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.337.1">In the first function, we display</span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.338.1"> two sets of values using the option </span><code class="inlineCode"><span class="koboSpan" id="kobo.339.1">hue</span></code><span class="koboSpan" id="kobo.340.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.341.1">countplot</span></code><span class="koboSpan" id="kobo.342.1"> function from </span><code class="inlineCode"><span class="koboSpan" id="kobo.343.1">seaborn</span></code><span class="koboSpan" id="kobo.344.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.345.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.346.1">plot_count_pairs</span></span><span class="koboSpan" id="kobo.347.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.348.1">data_df, feature, title, hue=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.349.1">"set"</span></span><span class="koboSpan" id="kobo.350.1">):
    f, ax = plt.subplots(</span><span class="hljs-number"><span class="koboSpan" id="kobo.351.1">1</span></span><span class="koboSpan" id="kobo.352.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.353.1">1</span></span><span class="koboSpan" id="kobo.354.1">, figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.355.1">8</span></span><span class="koboSpan" id="kobo.356.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.357.1">4</span></span><span class="koboSpan" id="kobo.358.1">))
    sns.countplot(x=feature, data=data_df, hue=hue, palette= color_list)
    plt.grid(color=</span><span class="hljs-string"><span class="koboSpan" id="kobo.359.1">"black"</span></span><span class="koboSpan" id="kobo.360.1">, linestyle=</span><span class="hljs-string"><span class="koboSpan" id="kobo.361.1">"-."</span></span><span class="koboSpan" id="kobo.362.1">, linewidth=</span><span class="hljs-number"><span class="koboSpan" id="kobo.363.1">0.5</span></span><span class="koboSpan" id="kobo.364.1">, axis=</span><span class="hljs-string"><span class="koboSpan" id="kobo.365.1">"y"</span></span><span class="koboSpan" id="kobo.366.1">, which=</span><span class="hljs-string"><span class="koboSpan" id="kobo.367.1">"major"</span></span><span class="koboSpan" id="kobo.368.1">)
    ax.set_title(</span><span class="hljs-string"><span class="koboSpan" id="kobo.369.1">f"Number of passengers / </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.370.1">{title}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.371.1">"</span></span><span class="koboSpan" id="kobo.372.1">)
    plt.show()    
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.373.1">In the second function, to display feature distribution, we call </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">histplot</span></code><span class="koboSpan" id="kobo.375.1"> from </span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">seaborn</span></code><span class="koboSpan" id="kobo.377.1"> twice – once for each feature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.378.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.379.1">plot_distribution_pairs</span></span><span class="koboSpan" id="kobo.380.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.381.1">data_df, feature, title, hue=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.382.1">"set"</span></span><span class="koboSpan" id="kobo.383.1">):
    f, ax = plt.subplots(</span><span class="hljs-number"><span class="koboSpan" id="kobo.384.1">1</span></span><span class="koboSpan" id="kobo.385.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.386.1">1</span></span><span class="koboSpan" id="kobo.387.1">, figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.388.1">8</span></span><span class="koboSpan" id="kobo.389.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.390.1">4</span></span><span class="koboSpan" id="kobo.391.1">))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.392.1">for</span></span><span class="koboSpan" id="kobo.393.1"> i, h </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.394.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.395.1">enumerate</span></span><span class="koboSpan" id="kobo.396.1">(data_df[hue].unique()):
        g = sns.histplot(data_df.loc[data_df[hue]==h, feature], color=color_list[i], ax=ax, label=h)
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.397.1">#plt.grid(color="black", linestyle="-.", linewidth=0.5, axis="y", which="major")</span></span><span class="koboSpan" id="kobo.398.1">
    ax.set_title(</span><span class="hljs-string"><span class="koboSpan" id="kobo.399.1">f"Number of passengers / </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.400.1">{title}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.401.1">"</span></span><span class="koboSpan" id="kobo.402.1">)
    g.legend()
    plt.show()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.403.1">To see the complete list of images, go to the book repository and check the </span><em class="italic"><span class="koboSpan" id="kobo.404.1">Titanic - start of a journey around data world</span></em><span class="koboSpan" id="kobo.405.1"> notebook (</span><em class="italic"><span class="koboSpan" id="kobo.406.1">Reference 3</span></em><span class="koboSpan" id="kobo.407.1">). </span><span class="koboSpan" id="kobo.407.2">Alternatively, you can access the same content on Kaggle, by following this path: </span><a href="https://www.kaggle.com/code/gpreda/titanic-start-of-a-journey-around-data-world"><span class="url"><span class="koboSpan" id="kobo.408.1">https://www.kaggle.com/code/gpreda/titanic-start-of-a-journey-around-data-world</span></span></a><span class="koboSpan" id="kobo.409.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.410.1">Reference 2</span></em><span class="koboSpan" id="kobo.411.1">).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.412.1">Here, we only show a small selection of images, for only two features – one for a categorical value and one for a numerical value. </span><span class="koboSpan" id="kobo.412.2">In the notebook, we represent the graphs for </span><code class="inlineCode"><span class="koboSpan" id="kobo.413.1">Sex</span></code><span class="koboSpan" id="kobo.414.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.415.1">Pclass</span></code><span class="koboSpan" id="kobo.416.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.417.1">SibSp</span></code><span class="koboSpan" id="kobo.418.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.419.1">Parch</span></code><span class="koboSpan" id="kobo.420.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.421.1">Embark</span></code><span class="koboSpan" id="kobo.422.1">, as well as </span><code class="inlineCode"><span class="koboSpan" id="kobo.423.1">Age</span></code><span class="koboSpan" id="kobo.424.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.425.1">Fare</span></code><span class="koboSpan" id="kobo.426.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.427.1">We will represent each of these features in two graphs: one shows the distribution of the feature for all passengers, grouped by train/test. </span><span class="koboSpan" id="kobo.427.2">The other shows, for the same feature, the distribution only for train data, and the split between </span><code class="inlineCode"><span class="koboSpan" id="kobo.428.1">Survived</span></code><span class="koboSpan" id="kobo.429.1">/</span><code class="inlineCode"><span class="koboSpan" id="kobo.430.1">Not Survived</span></code><span class="koboSpan" id="kobo.431.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.432.1">We start with </span><code class="inlineCode"><span class="koboSpan" id="kobo.433.1">Pclass</span></code><span class="koboSpan" id="kobo.434.1"> (which is a categorical feature), showing the distribution of the feature for all passengers, grouped by train/test datasets. </span><span class="koboSpan" id="kobo.434.2">Notice in the following screenshot, there are three classes, </span><code class="inlineCode"><span class="koboSpan" id="kobo.435.1">1</span></code><span class="koboSpan" id="kobo.436.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">2</span></code><span class="koboSpan" id="kobo.438.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">3</span></code><span class="koboSpan" id="kobo.440.1">:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.441.1"><img alt="" role="presentation" src="../Images/B20963_03_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.442.1">Figure 3.7: Number of passengers per passenger class, grouped by train and test</span></p>
<p class="normal"><span class="koboSpan" id="kobo.443.1">For the same </span><code class="inlineCode"><span class="koboSpan" id="kobo.444.1">Pclass</span></code><span class="koboSpan" id="kobo.445.1"> feature, but </span><a id="_idIndexMarker090"/><span class="koboSpan" id="kobo.446.1">only from the train set, we represent the data grouped by </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">Survived</span></code><span class="koboSpan" id="kobo.448.1">:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.449.1"><img alt="" role="presentation" src="../Images/B20963_03_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.450.1">Figure 3.8: Number of passengers per passenger class in the train set, grouped by Survived</span></p>
<p class="normal"><span class="koboSpan" id="kobo.451.1">We follow with </span><code class="inlineCode"><span class="koboSpan" id="kobo.452.1">Age</span></code><span class="koboSpan" id="kobo.453.1"> (which is a numerical value). </span><span class="koboSpan" id="kobo.453.2">In </span><em class="italic"><span class="koboSpan" id="kobo.454.1">Figure 3.9</span></em><span class="koboSpan" id="kobo.455.1">, we show the histogram of </span><code class="inlineCode"><span class="koboSpan" id="kobo.456.1">Age</span></code><span class="koboSpan" id="kobo.457.1"> in all the data (train and test), grouped by train/test. </span><span class="koboSpan" id="kobo.457.2">We are using a histogram here because this feature, although</span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.458.1"> not a continuous number (is still discrete), has many values (from the stats we ran, it appears that there are at least 88 unique </span><code class="inlineCode"><span class="koboSpan" id="kobo.459.1">Age</span></code><span class="koboSpan" id="kobo.460.1"> values), and is, from the point of view of our analysis, just like a continuous number.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.461.1"><img alt="" role="presentation" src="../Images/B20963_03_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.462.1">Figure 3.9: Number of passengers per Age, grouped by train and test</span></p>
<p class="normal"><em class="italic"><span class="koboSpan" id="kobo.463.1">Figure 3.10 </span></em><span class="koboSpan" id="kobo.464.1">shows the histogram of </span><code class="inlineCode"><span class="koboSpan" id="kobo.465.1">Age</span></code><span class="koboSpan" id="kobo.466.1"> in the train set, grouped by survival status.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.467.1"><img alt="" role="presentation" src="../Images/B20963_03_13.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.468.1">Figure 3.10: Number of passengers per Age in the train set, grouped by survival status</span></p>
<p class="normal"><span class="koboSpan" id="kobo.469.1">By simple inspection of these univariate distributions for either categorical or continuous (numerical) data, we can already understand some interesting facts from the data. </span><span class="koboSpan" id="kobo.469.2">For example, in </span><em class="italic"><span class="koboSpan" id="kobo.470.1">Figures 3.7</span></em><span class="koboSpan" id="kobo.471.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.472.1">3.8</span></em><span class="koboSpan" id="kobo.473.1">, we can see that the ratio between data in the train and test sets is quite similar </span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.474.1">with respect to the distribution in the three classes (</span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">1</span></code><span class="koboSpan" id="kobo.476.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.477.1">2</span></code><span class="koboSpan" id="kobo.478.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.479.1">3</span></code><span class="koboSpan" id="kobo.480.1">). </span><span class="koboSpan" id="kobo.480.2">At the same time, from the Survived/Not Survived distribution, we can see that while around 60% of first-class passengers survived, the split of Survived/Not Survived in second class was around 50-50%, while in third class, only around 25% of the passengers survived. </span><span class="koboSpan" id="kobo.480.3">Similarly, we can extract useful insights from the univariate distributions of </span><code class="inlineCode"><span class="koboSpan" id="kobo.481.1">Sex</span></code><span class="koboSpan" id="kobo.482.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">SibSp</span></code><span class="koboSpan" id="kobo.484.1"> (siblings or spouses), or </span><code class="inlineCode"><span class="koboSpan" id="kobo.485.1">Parch</span></code><span class="koboSpan" id="kobo.486.1"> (number of parents or children).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.487.1">In some cases, we would like to build new features from existing features – in other words, perform feature engineering. </span><span class="koboSpan" id="kobo.487.2">Feature engineering involves the extraction and transformation of useful information from raw data. </span><span class="koboSpan" id="kobo.487.3">One technique for feature engineering is to define a new feature as a function of other features. </span><span class="koboSpan" id="kobo.487.4">We saw that </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">Parch</span></code><span class="koboSpan" id="kobo.489.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.490.1">SibSp</span></code><span class="koboSpan" id="kobo.491.1"> together give information about families that were present on the Titanic. </span><span class="koboSpan" id="kobo.491.2">By summing up </span><code class="inlineCode"><span class="koboSpan" id="kobo.492.1">Parch</span></code><span class="koboSpan" id="kobo.493.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.494.1">SibSp</span></code><span class="koboSpan" id="kobo.495.1"> and adding </span><code class="inlineCode"><span class="koboSpan" id="kobo.496.1">1</span></code><span class="koboSpan" id="kobo.497.1"> (for the actual passenger), for each passenger, we get the size of their family onboard the Titanic.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.498.1">In </span><em class="italic"><span class="koboSpan" id="kobo.499.1">Figure 3.11</span></em><span class="koboSpan" id="kobo.500.1">, we can see the graph for family size, from all passengers, grouped by train/test datasets:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.501.1"><img alt="" role="presentation" src="../Images/B20963_03_14.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.502.1">Figure 3.11: Number of passengers per family size, grouped by train and test</span></p>
<p class="normal"><span class="koboSpan" id="kobo.503.1">In the next figure, we see</span><a id="_idIndexMarker093"/><span class="koboSpan" id="kobo.504.1"> the graph for train data, for the same family size, grouped by Survived/Not Survived:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.505.1"><img alt="" role="presentation" src="../Images/B20963_03_15.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.506.1">Figure 3.12: Number of passengers per family size, grouped by survival status</span></p>
<p class="normal"><span class="koboSpan" id="kobo.507.1">We can observe that prevalent is the number of single passengers (and the large number also highlights the high frequency of this type of passenger in third class). </span><span class="koboSpan" id="kobo.507.2">This number is then followed by families without children and single parents, followed by small and large families of</span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.508.1"> up to 8 and even 11 members. </span><span class="koboSpan" id="kobo.508.2">As you can see, this pattern came from data analysis using an exploratory approach before modeling.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.509.1">If we look then at the survival rate, we can see that single passengers had a small survival rate (around 30%) while small families (with 2, 3, or 4 members) had a survival rate above 50%. </span><span class="koboSpan" id="kobo.509.2">As the size of the family became larger than 4, we can see that the survival rate decreased severely, with families with 8 or 11 members having a zero survival rate.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.510.1">This might be because they were traveling in cheaper classes (we know that survival in third class was inferior to survival in first class) or because they spent too much time trying to gather all their family members before heading to the lifeboats. </span><span class="koboSpan" id="kobo.510.2">We will investigate these details a bit later in this chapter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.511.1">We can observe that </span><code class="inlineCode"><span class="koboSpan" id="kobo.512.1">Age</span></code><span class="koboSpan" id="kobo.513.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.514.1">Fare</span></code><span class="koboSpan" id="kobo.515.1"> are distributed values. </span><span class="koboSpan" id="kobo.515.2">While it is useful to know the exact age of a certain passenger, there is not much value when we build a model to include the exact age. </span><span class="koboSpan" id="kobo.515.3">Actually, by learning a large variety of ages, the model risks overfitting the training data, and its generalization will degrade. </span><span class="koboSpan" id="kobo.515.4">For analysis and modeling purposes, it makes sense to aggregate the age (or fare) in value intervals.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.516.1">The next code snippet shows the calculation of a new feature called </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">Age Interval</span></code><span class="koboSpan" id="kobo.518.1">, to form five classes, from </span><code class="inlineCode"><span class="koboSpan" id="kobo.519.1">0</span></code><span class="koboSpan" id="kobo.520.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.521.1">4</span></code><span class="koboSpan" id="kobo.522.1">, corresponding</span><a id="_idIndexMarker095"/><span class="koboSpan" id="kobo.523.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">Age</span></code><span class="koboSpan" id="kobo.525.1"> intervals between </span><code class="inlineCode"><span class="koboSpan" id="kobo.526.1">0</span></code><span class="koboSpan" id="kobo.527.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.528.1">16</span></code><span class="koboSpan" id="kobo.529.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">16</span></code><span class="koboSpan" id="kobo.531.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.532.1">32</span></code><span class="koboSpan" id="kobo.533.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1">32</span></code><span class="koboSpan" id="kobo.535.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1">48</span></code><span class="koboSpan" id="kobo.537.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.538.1">48</span></code><span class="koboSpan" id="kobo.539.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">64</span></code><span class="koboSpan" id="kobo.541.1">, and above </span><code class="inlineCode"><span class="koboSpan" id="kobo.542.1">64</span></code><span class="koboSpan" id="kobo.543.1">, respectively:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.544.1">all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.545.1">"Age Interval"</span></span><span class="koboSpan" id="kobo.546.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.547.1">0.0</span></span><span class="koboSpan" id="kobo.548.1">
all_df.loc[ all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.549.1">'Age'</span></span><span class="koboSpan" id="kobo.550.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.551.1">16</span></span><span class="koboSpan" id="kobo.552.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.553.1">'Age Interval'</span></span><span class="koboSpan" id="kobo.554.1">]  = </span><span class="hljs-number"><span class="koboSpan" id="kobo.555.1">0</span></span><span class="koboSpan" id="kobo.556.1">
all_df.loc[(all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.557.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.558.1">Age'</span></span><span class="koboSpan" id="kobo.559.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.560.1">16</span></span><span class="koboSpan" id="kobo.561.1">) &amp; (all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.562.1">'Age'</span></span><span class="koboSpan" id="kobo.563.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.564.1">32</span></span><span class="koboSpan" id="kobo.565.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.566.1">'Age Interval'</span></span><span class="koboSpan" id="kobo.567.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.568.1">1</span></span><span class="koboSpan" id="kobo.569.1">
all_df.loc[(all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.570.1">'Age'</span></span><span class="koboSpan" id="kobo.571.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.572.1">32</span></span><span class="koboSpan" id="kobo.573.1">) &amp; (all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.574.1">'Age'</span></span><span class="koboSpan" id="kobo.575.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.576.1">48</span></span><span class="koboSpan" id="kobo.577.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.578.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.579.1">Age Interval'</span></span><span class="koboSpan" id="kobo.580.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.581.1">2</span></span><span class="koboSpan" id="kobo.582.1">
all_df.loc[(all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.583.1">'Age'</span></span><span class="koboSpan" id="kobo.584.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.585.1">48</span></span><span class="koboSpan" id="kobo.586.1">) &amp; (all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.587.1">'Age'</span></span><span class="koboSpan" id="kobo.588.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.589.1">64</span></span><span class="koboSpan" id="kobo.590.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.591.1">'Age Interval'</span></span><span class="koboSpan" id="kobo.592.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.593.1">3</span></span><span class="koboSpan" id="kobo.594.1">
all_df.loc[ all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.595.1">'Age'</span></span><span class="koboSpan" id="kobo.596.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.597.1">64</span></span><span class="koboSpan" id="kobo.598.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.599.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.600.1">Age Interval'</span></span><span class="koboSpan" id="kobo.601.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.602.1">4</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.603.1">The following code block calculates a new feature called </span><code class="inlineCode"><span class="koboSpan" id="kobo.604.1">Fare Interval</span></code><span class="koboSpan" id="kobo.605.1">, where the values from </span><code class="inlineCode"><span class="koboSpan" id="kobo.606.1">0</span></code><span class="koboSpan" id="kobo.607.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.608.1">3</span></code><span class="koboSpan" id="kobo.609.1"> (four classes) are obtained from values of </span><code class="inlineCode"><span class="koboSpan" id="kobo.610.1">Fare</span></code><span class="koboSpan" id="kobo.611.1"> between </span><code class="inlineCode"><span class="koboSpan" id="kobo.612.1">0</span></code><span class="koboSpan" id="kobo.613.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.614.1">7.91</span></code><span class="koboSpan" id="kobo.615.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.616.1">7.91</span></code><span class="koboSpan" id="kobo.617.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.618.1">14.454</span></code><span class="koboSpan" id="kobo.619.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.620.1">14.454</span></code><span class="koboSpan" id="kobo.621.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.622.1">31</span></code><span class="koboSpan" id="kobo.623.1">, and above </span><code class="inlineCode"><span class="koboSpan" id="kobo.624.1">31</span></code><span class="koboSpan" id="kobo.625.1">, respectively:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.626.1">all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.627.1">'Fare Interval'</span></span><span class="koboSpan" id="kobo.628.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.629.1">0.0</span></span><span class="koboSpan" id="kobo.630.1">
all_df.loc[ all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.631.1">'Fare'</span></span><span class="koboSpan" id="kobo.632.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.633.1">7.91</span></span><span class="koboSpan" id="kobo.634.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.635.1">'Fare Interval'</span></span><span class="koboSpan" id="kobo.636.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.637.1">0</span></span><span class="koboSpan" id="kobo.638.1">
all_df.loc[(all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.639.1">'Fare'</span></span><span class="koboSpan" id="kobo.640.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.641.1">7.91</span></span><span class="koboSpan" id="kobo.642.1">) &amp; (all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.643.1">'Fare'</span></span><span class="koboSpan" id="kobo.644.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.645.1">14.454</span></span><span class="koboSpan" id="kobo.646.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.647.1">'Fare Interval'</span></span><span class="koboSpan" id="kobo.648.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.649.1">1</span></span><span class="koboSpan" id="kobo.650.1">
all_df.loc[(all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.651.1">'Fare'</span></span><span class="koboSpan" id="kobo.652.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.653.1">14.454</span></span><span class="koboSpan" id="kobo.654.1">) &amp; (all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.655.1">'Fare'</span></span><span class="koboSpan" id="kobo.656.1">] &lt;= </span><span class="hljs-number"><span class="koboSpan" id="kobo.657.1">31</span></span><span class="koboSpan" id="kobo.658.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.659.1">'Fare Interval'</span></span><span class="koboSpan" id="kobo.660.1">]   = </span><span class="hljs-number"><span class="koboSpan" id="kobo.661.1">2</span></span><span class="koboSpan" id="kobo.662.1">
all_df.loc[ all_df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.663.1">'Fare'</span></span><span class="koboSpan" id="kobo.664.1">] &gt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.665.1">31</span></span><span class="koboSpan" id="kobo.666.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.667.1">'Fare Interval'</span></span><span class="koboSpan" id="kobo.668.1">] = </span><span class="hljs-number"><span class="koboSpan" id="kobo.669.1">3</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.670.1">The feature transformations for </span><code class="inlineCode"><span class="koboSpan" id="kobo.671.1">Age</span></code><span class="koboSpan" id="kobo.672.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.673.1">Fare</span></code><span class="koboSpan" id="kobo.674.1"> described above have the effect of regularization. </span><span class="koboSpan" id="kobo.674.2">In the following graph, we show the </span><code class="inlineCode"><span class="koboSpan" id="kobo.675.1">Age</span></code><span class="koboSpan" id="kobo.676.1"> Intervals for all passengers, separated by train and test:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.677.1"><img alt="" role="presentation" src="../Images/B20963_03_16.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.678.1">Figure 3.13: Number of passengers per Age intervals, grouped by train and test</span></p>
<p class="normal"><span class="koboSpan" id="kobo.679.1">The following figure shows </span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.680.1">the distribution of </span><code class="inlineCode"><span class="koboSpan" id="kobo.681.1">Age</span></code><span class="koboSpan" id="kobo.682.1"> intervals for Survived versus Not Survived passengers:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.683.1"><img alt="" role="presentation" src="../Images/B20963_03_17.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.684.1">Figure 3.14: Number of passengers per Age intervals, grouped by Survived status</span></p>
<p class="normal"><span class="koboSpan" id="kobo.685.1">So far, we have analyzed individual features. </span><span class="koboSpan" id="kobo.685.2">We merged train and test and represented, on the same graph, the data split between train and test. </span><span class="koboSpan" id="kobo.685.3">We also showed the train data only for one feature, split between Survived and Not Survived, and we visualized a few engineered features. </span><span class="koboSpan" id="kobo.685.4">In the next section, we will follow by representing multiple features on the same graph</span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.686.1"> using multivariate analysis.</span></p>
<h1 class="heading-1" id="_idParaDest-43"><span class="koboSpan" id="kobo.687.1">Performing multivariate analysis</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.688.1">We saw how, by using graphs for the distribution of each feature, we can get very interesting insights into the data. </span><span class="koboSpan" id="kobo.688.2">Then, we experimented with feature engineering to get useful, more relevant features. </span><span class="koboSpan" id="kobo.688.3">While observing variables separately can help us get an initial image of the data </span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.689.1">distribution, grouping values and looking at more than one feature at a time can reveal correlations and more insights into how different features interact.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.690.1">Now, we will use various graphics to explore correlations of features while we also explore the visualization options. </span><span class="koboSpan" id="kobo.690.2">We will continue for now with our initial option of using a combination of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.691.1">matplotlib</span></code><span class="koboSpan" id="kobo.692.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.693.1">seaborn</span></code><span class="koboSpan" id="kobo.694.1"> graphical libraries.</span></p>
<p class="normal"><em class="italic"><span class="koboSpan" id="kobo.695.1">Figure 3.15</span></em><span class="koboSpan" id="kobo.696.1"> shows the number of passengers per Age Interval, grouped by passenger class. </span><span class="koboSpan" id="kobo.696.2">We can see from this image that in third class, the majority of passengers were in the first and second Age interval (that is, between 0–16 and 16–32 years old), while in first class, we have the most well-balanced age groups. </span><span class="koboSpan" id="kobo.696.3">The most balanced age interval between the three classes is the third age interval.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.697.1"><img alt="" role="presentation" src="../Images/B20963_03_18.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.698.1">Figure 3.15: Number of passengers per Age Interval, grouped by class</span></p>
<p class="normal"><span class="koboSpan" id="kobo.699.1">As we can see in the next graph in </span><em class="italic"><span class="koboSpan" id="kobo.700.1">Figure 3.16</span></em><span class="koboSpan" id="kobo.701.1">, most passengers embarked at Southampton (identified by the initial </span><strong class="keyWord"><span class="koboSpan" id="kobo.702.1">S</span></strong><span class="koboSpan" id="kobo.703.1">). </span><span class="koboSpan" id="kobo.703.2">Also, most of these passengers were of a young age, under 32 (age intervals </span><strong class="keyWord"><span class="koboSpan" id="kobo.704.1">0</span></strong><span class="koboSpan" id="kobo.705.1"> and </span><strong class="keyWord"><span class="koboSpan" id="kobo.706.1">1</span></strong><span class="koboSpan" id="kobo.707.1">). </span><span class="koboSpan" id="kobo.707.2">For people embarking in Cherbourg (identified by the initial </span><strong class="keyWord"><span class="koboSpan" id="kobo.708.1">C</span></strong><span class="koboSpan" id="kobo.709.1">), the age groups are more balanced. </span><span class="koboSpan" id="kobo.709.2">The passengers who embarked in Queensland (identified by the initial </span><strong class="screenText"><span class="koboSpan" id="kobo.710.1">Q</span></strong><span class="koboSpan" id="kobo.711.1">) were mostly in the first age group. </span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.712.1"><img alt="" role="presentation" src="../Images/B20963_03_19.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.713.1">Figure 3.16: Number of passengers per Age Interval, grouped by embarked port</span></p>
<p class="normal"><span class="koboSpan" id="kobo.714.1">From the following figure, we can see that with increased family size and lower passenger class, the likelihood of surviving decreased. </span><span class="koboSpan" id="kobo.714.2">The worst survival rate was for large families in third class, where almost no one survived. </span><span class="koboSpan" id="kobo.714.3">Even for small families, being in third class drastically reduced their likelihood of survival.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.715.1"><img alt="" role="presentation" src="../Images/B20963_03_20.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.716.1">Figure 3.17: Distribution of family size and passenger class (Pclass), grouped by Survived status</span></p>
<p class="normal"><span class="koboSpan" id="kobo.717.1">We can also create composed features – for example, we can merge </span><code class="inlineCode"><span class="koboSpan" id="kobo.718.1">Sex</span></code><span class="koboSpan" id="kobo.719.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.720.1">Pclass</span></code><span class="koboSpan" id="kobo.721.1">, two of the most predictive factors, into one single feature; let’s call it </span><code class="inlineCode"><span class="koboSpan" id="kobo.722.1">Sex_Pclass</span></code><span class="koboSpan" id="kobo.723.1">. </span><span class="koboSpan" id="kobo.723.2">The following figure shows the distribution of this new feature when we split the values based on survival</span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.724.1"> status. </span><span class="koboSpan" id="kobo.724.2">Females in first and second class had a survival rate above 90%. </span><span class="koboSpan" id="kobo.724.3">In third class, females had around a 50% survival rate. </span><span class="koboSpan" id="kobo.724.4">Males in first and second class had survival rates of around 30% and 20%, respectively. </span><span class="koboSpan" id="kobo.724.5">Most of the males in third class died.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.725.1"><img alt="Chart, bar chart  Description automatically generated" src="../Images/B20963_03_21.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.726.1">Figure 3.18: Distribution composed feature Sex_Pclass, grouped by Survived status</span></p>
<p class="normal"><span class="koboSpan" id="kobo.727.1">After the data quality assessment, we demonstrated how to perform univariate analysis. </span><span class="koboSpan" id="kobo.727.2">Then, we gave a few examples of feature engineering for numerical data, and performed multivariate analysis. </span><span class="koboSpan" id="kobo.727.3">Next, we will explore the richness of information we can find in the passengers’ names. </span><span class="koboSpan" id="kobo.727.4">Let’s see </span><em class="italic"><span class="koboSpan" id="kobo.728.1">what is in a name</span></em><span class="koboSpan" id="kobo.729.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-44"><span class="koboSpan" id="kobo.730.1">Extracting meaningful information from passenger names</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.731.1">We continue now with our analysis, including analyzing the passengers’ names to extract meaningful information. </span><span class="koboSpan" id="kobo.731.2">As</span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.732.1"> you will remember from the beginning of this chapter, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.733.1">Name</span></code><span class="koboSpan" id="kobo.734.1"> column also contains some additional information. </span><span class="koboSpan" id="kobo.734.2">After our preliminary visual analysis, it became apparent that all names follow a similar structure. </span><span class="koboSpan" id="kobo.734.3">They begin with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.735.1">Family Name</span></code><span class="koboSpan" id="kobo.736.1">, followed by a comma, then a </span><code class="inlineCode"><span class="koboSpan" id="kobo.737.1">Title</span></code><span class="koboSpan" id="kobo.738.1"> (short version, followed by a period), then a </span><code class="inlineCode"><span class="koboSpan" id="kobo.739.1">Given Name</span></code><span class="koboSpan" id="kobo.740.1">, and, in cases where a new name was acquired through marriage, the previous or </span><code class="inlineCode"><span class="koboSpan" id="kobo.741.1">Maiden Name</span></code><span class="koboSpan" id="kobo.742.1">. </span><span class="koboSpan" id="kobo.742.2">Let’s process the data to extract this information. </span><span class="koboSpan" id="kobo.742.3">The code to extract this information will be:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.743.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.744.1">parse_names</span></span><span class="koboSpan" id="kobo.745.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.746.1">row</span></span><span class="koboSpan" id="kobo.747.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.748.1">try</span></span><span class="koboSpan" id="kobo.749.1">:
        text = row[</span><span class="hljs-string"><span class="koboSpan" id="kobo.750.1">"Name"</span></span><span class="koboSpan" id="kobo.751.1">]
        split_text = text.split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.752.1">","</span></span><span class="koboSpan" id="kobo.753.1">)
        family_name = split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.754.1">0</span></span><span class="koboSpan" id="kobo.755.1">]
        next_text = split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.756.1">1</span></span><span class="koboSpan" id="kobo.757.1">]
        split_text = next_text.split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.758.1">"."</span></span><span class="koboSpan" id="kobo.759.1">)
        title =  (split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.760.1">0</span></span><span class="koboSpan" id="kobo.761.1">] + </span><span class="hljs-string"><span class="koboSpan" id="kobo.762.1">"."</span></span><span class="koboSpan" id="kobo.763.1">).lstrip().rstrip()
        next_text = split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.764.1">1</span></span><span class="koboSpan" id="kobo.765.1">]
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.766.1">if</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.767.1">"("</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.768.1">in</span></span><span class="koboSpan" id="kobo.769.1"> next_text:
            split_text = next_text.split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.770.1">"("</span></span><span class="koboSpan" id="kobo.771.1">)
            given_name = split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.772.1">0</span></span><span class="koboSpan" id="kobo.773.1">]
            maiden_name = split_text[</span><span class="hljs-number"><span class="koboSpan" id="kobo.774.1">1</span></span><span class="koboSpan" id="kobo.775.1">].rstrip(</span><span class="hljs-string"><span class="koboSpan" id="kobo.776.1">")"</span></span><span class="koboSpan" id="kobo.777.1">)
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.778.1">return</span></span><span class="koboSpan" id="kobo.779.1"> pd.Series([family_name, title, given_name, maiden_name])
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.780.1">else</span></span><span class="koboSpan" id="kobo.781.1">:
            given_name = next_text
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.782.1">return</span></span><span class="koboSpan" id="kobo.783.1"> pd.Series([family_name, title, given_name, </span><span class="hljs-literal"><span class="koboSpan" id="kobo.784.1">None</span></span><span class="koboSpan" id="kobo.785.1">])
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.786.1">except</span></span><span class="koboSpan" id="kobo.787.1"> Exception </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.788.1">as</span></span><span class="koboSpan" id="kobo.789.1"> ex:
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.790.1">print</span></span><span class="koboSpan" id="kobo.791.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.792.1">f"Exception: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.793.1">{ex}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.794.1">"</span></span><span class="koboSpan" id="kobo.795.1">)
all_df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.796.1">"Family Name"</span></span><span class="koboSpan" id="kobo.797.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.798.1">"Title"</span></span><span class="koboSpan" id="kobo.799.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.800.1">"Given Name"</span></span><span class="koboSpan" id="kobo.801.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.802.1">"Maiden Name"</span></span><span class="koboSpan" id="kobo.803.1">]] = all_df.apply(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.804.1">lambda</span></span><span class="koboSpan" id="kobo.805.1"> row: parse_names(row), axis=</span><span class="hljs-number"><span class="koboSpan" id="kobo.806.1">1</span></span><span class="koboSpan" id="kobo.807.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.808.1">As you might’ve noticed, we opted to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.809.1">split</span></code><span class="koboSpan" id="kobo.810.1"> function to implement the extraction of </span><code class="inlineCode"><span class="koboSpan" id="kobo.811.1">Family Name</span></code><span class="koboSpan" id="kobo.812.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.813.1">Title</span></code><span class="koboSpan" id="kobo.814.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.815.1">Given Name</span></code><span class="koboSpan" id="kobo.816.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.817.1">Maiden Name</span></code><span class="koboSpan" id="kobo.818.1">. </span><span class="koboSpan" id="kobo.818.2">We can also use a more compact implementation, with</span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.819.1"> regex.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.820.1">Let’s inspect the results, by looking first at the distribution of </span><code class="inlineCode"><span class="koboSpan" id="kobo.821.1">Title</span></code><span class="koboSpan" id="kobo.822.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.823.1">Sex</span></code><span class="koboSpan" id="kobo.824.1"> in parallel:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.825.1"><img alt="" role="presentation" src="../Images/B20963_03_22.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.826.1">Figure 3.19: Distribution of Title by Sex</span></p>
<p class="normal"><span class="koboSpan" id="kobo.827.1">We can see that most of the titles are gender-specific, with the most frequent being </span><code class="inlineCode"><span class="koboSpan" id="kobo.828.1">Miss</span></code><span class="koboSpan" id="kobo.829.1"> (with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.830.1">Mlle.</span></code><span class="koboSpan" id="kobo.831.1"> version) and </span><code class="inlineCode"><span class="koboSpan" id="kobo.832.1">Mrs.</span></code><span class="koboSpan" id="kobo.833.1"> (with </span><code class="inlineCode"><span class="koboSpan" id="kobo.834.1">Mme.</span></code><span class="koboSpan" id="kobo.835.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.836.1">Dona.</span></code><span class="koboSpan" id="kobo.837.1"> versions) for females, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.838.1">Mr.</span></code><span class="koboSpan" id="kobo.839.1"> (and </span><code class="inlineCode"><span class="koboSpan" id="kobo.840.1">Ms.</span></code><span class="koboSpan" id="kobo.841.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.842.1">Don.</span></code><span class="koboSpan" id="kobo.843.1"> versions) and </span><code class="inlineCode"><span class="koboSpan" id="kobo.844.1">Master</span></code><span class="koboSpan" id="kobo.845.1"> for males. </span><span class="koboSpan" id="kobo.845.2">Some titles are rare, like military (</span><code class="inlineCode"><span class="koboSpan" id="kobo.846.1">Capt.</span></code><span class="koboSpan" id="kobo.847.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.848.1">Col.</span></code><span class="koboSpan" id="kobo.849.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.850.1">Major</span></code><span class="koboSpan" id="kobo.851.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.852.1">Jonkheer</span></code><span class="koboSpan" id="kobo.853.1">), occupational (</span><code class="inlineCode"><span class="koboSpan" id="kobo.854.1">Dr.</span></code><span class="koboSpan" id="kobo.855.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.856.1">Rev.</span></code><span class="koboSpan" id="kobo.857.1">), or nobility (</span><code class="inlineCode"><span class="koboSpan" id="kobo.858.1">Sir</span></code><span class="koboSpan" id="kobo.859.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.860.1">Lady</span></code><span class="koboSpan" id="kobo.861.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.862.1">Countess</span></code><span class="koboSpan" id="kobo.863.1">). </span><code class="inlineCode"><span class="koboSpan" id="kobo.864.1">Dr.</span></code><span class="koboSpan" id="kobo.865.1"> is the only title that is used by both genders, and we will take a closer look at it a bit later in</span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.866.1"> this chapter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.867.1">Let’s look now at the distribution of </span><code class="inlineCode"><span class="koboSpan" id="kobo.868.1">Title</span></code><span class="koboSpan" id="kobo.869.1"> by </span><code class="inlineCode"><span class="koboSpan" id="kobo.870.1">Age Interval</span></code><span class="koboSpan" id="kobo.871.1">:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.872.1"><img alt="" role="presentation" src="../Images/B20963_03_23.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.873.1">Figure 3.20: Distribution of Title by Age Interval</span></p>
<p class="normal"><span class="koboSpan" id="kobo.874.1">From this new view, we can see that some of the titles are reserved for certain age intervals, while others are distributed across all age intervals. </span><code class="inlineCode"><span class="koboSpan" id="kobo.875.1">Master</span></code><span class="koboSpan" id="kobo.876.1"> appears to be used only for males under 18 years of age, but </span><code class="inlineCode"><span class="koboSpan" id="kobo.877.1">Mr.</span></code><span class="koboSpan" id="kobo.878.1"> is also used for this age interval. </span><span class="koboSpan" id="kobo.878.2">From what we have seen, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.879.1">Master</span></code><span class="koboSpan" id="kobo.880.1"> title was only used for male children traveling with their families, whereas males of a young age with the title </span><code class="inlineCode"><span class="koboSpan" id="kobo.881.1">Mr.</span></code><span class="koboSpan" id="kobo.882.1"> were traveling alone and, because independent already, were considered young adults. </span><span class="koboSpan" id="kobo.882.2">The title </span><code class="inlineCode"><span class="koboSpan" id="kobo.883.1">Miss</span></code><span class="koboSpan" id="kobo.884.1"> doesn’t respect the same pattern, since it is attributed equally to female children, young, or unmarried women (but less frequently for advanced ages). </span><span class="koboSpan" id="kobo.884.2">It is interesting to see that </span><code class="inlineCode"><span class="koboSpan" id="kobo.885.1">Dr.</span></code><span class="koboSpan" id="kobo.886.1"> is a title well distributed in a wide range of ages.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.887.1">Let’s look now at a few of the large families from third class. </span><span class="koboSpan" id="kobo.887.2">If we sort the data by </span><code class="inlineCode"><span class="koboSpan" id="kobo.888.1">Family Name</span></code><span class="koboSpan" id="kobo.889.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.890.1">Family Size</span></code><span class="koboSpan" id="kobo.891.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.892.1">Ticket</span></code><span class="koboSpan" id="kobo.893.1"> (to keep together those who traveled with the same ticket), and </span><code class="inlineCode"><span class="koboSpan" id="kobo.894.1">Age</span></code><span class="koboSpan" id="kobo.895.1">, we will obtain sequences of passengers from the same real family. </span><span class="koboSpan" id="kobo.895.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.896.1">Family Name</span></code><span class="koboSpan" id="kobo.897.1"> values with the highest occurrence are Andersson (11 entries), Sage (11 entries), Goodwin (8 entries), Asplund (8 entries) and Davies (7 entries). </span><span class="koboSpan" id="kobo.897.2">We don’t yet know whether they are also from the same family or just share the same family name. </span><span class="koboSpan" id="kobo.897.3">Let’s look at the data for the passengers who share the Andersson family name.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.898.1">From </span><em class="italic"><span class="koboSpan" id="kobo.899.1">Figure 3.21</span></em><span class="koboSpan" id="kobo.900.1">, we see that there is one family called Andersson with a father called Anders Johan and a mother called Alfrida Konstantia, accompanied by their five children (four daughters and one son) with ages between 2 and 11 years. </span><span class="koboSpan" id="kobo.900.2">The married women in the family are registered with their title followed by their husband’s name, and their maiden name added within </span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.901.1">brackets. </span><span class="koboSpan" id="kobo.901.2">No one from this family traveling in third class survived.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.902.1"><img alt="A screenshot of a computer  Description automatically generated" src="../Images/B20963_03_24.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.903.1">Figure 3.21: Passengers sharing the Andersson family name</span></p>
<p class="normal"><span class="koboSpan" id="kobo.904.1">Only those who traveled on the same ticket were part of the same family. </span><span class="koboSpan" id="kobo.904.2">This means that only those traveling with ticket number 347082 were part of the Andersson family, while the others were traveling separately. </span><span class="koboSpan" id="kobo.904.3">The data seems to not be very accurate in their cases since some of them appear to be part of a larger family but we cannot find their relatives.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.905.1">The next largest family is Sage, as we can see from </span><em class="italic"><span class="koboSpan" id="kobo.906.1">Figure 3.22</span></em><span class="koboSpan" id="kobo.907.1">. </span><span class="koboSpan" id="kobo.907.2">This was an 11-member family (two parents and nine children). </span><span class="koboSpan" id="kobo.907.3">We do not know their ages (apart from one of the boys’ who was 14.5 years old); we just know their names and the fact that there were five boys and four girls. </span><span class="koboSpan" id="kobo.907.4">We suppose that three of the boys were grown-up since their titles were </span><code class="inlineCode"><span class="koboSpan" id="kobo.908.1">Mr.</span></code><span class="koboSpan" id="kobo.909.1">. </span><span class="koboSpan" id="kobo.909.2">We only know that 9 out of the 11 did not survive (the other family members, for which </span><strong class="keyWord"><span class="koboSpan" id="kobo.910.1">Survived</span></strong><span class="koboSpan" id="kobo.911.1"> has no assigned value, are part of the test set).</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.912.1"><img alt="" role="presentation" src="../Images/B20963_03_25.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.913.1">Figure 3.22: Passengers sharing the Sage family name</span></p>
<p class="normal"><span class="koboSpan" id="kobo.914.1">The stories of these families who were looking for a better life in the New World are moving, especially when we realize that, sadly, these large families with lots of children didn’t manage to save themselves. </span><span class="koboSpan" id="kobo.914.2">We don’t know what the decisive factor was: they might have waited too long until they headed for the boat deck, hoping to reunite, or maybe they were </span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.915.1">struggling to keep together on their way to the lifeboats. </span><span class="koboSpan" id="kobo.915.2">Either way, adding the family size information into the model might give us a useful feature to predict survival, since we can see that people in larger families had a lower chance of survival.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.916.1">There are also other interesting analyses we can make, with fewer predictive values for survival, but which can give us some more insights into the data distribution. </span><span class="koboSpan" id="kobo.916.2">The following figure shows the </span><code class="inlineCode"><span class="koboSpan" id="kobo.917.1">Given Name</span></code><span class="koboSpan" id="kobo.918.1"> distribution (grouped by sex) for the overall data:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.919.1"><img alt="" role="presentation" src="../Images/B20963_03_26.png"/></span> </figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.920.1">Figure 3.23: Passengers’ given names (girls/unmarried women and boys/men)</span></p>
<p class="normal"><span class="koboSpan" id="kobo.921.1">The following figure shows the Family Name distribution overall and according to embarking port. </span><span class="koboSpan" id="kobo.921.2">We saw that most passengers embarked in Southampton (identified with </span><strong class="keyWord"><span class="koboSpan" id="kobo.922.1">S</span></strong><span class="koboSpan" id="kobo.923.1">); therefore, the distribution of embarked passengers’ names in this port will dominate the overall case. </span><span class="koboSpan" id="kobo.923.2">The other two embarking ports were Cherbourg, France (identified with </span><strong class="keyWord"><span class="koboSpan" id="kobo.924.1">C</span></strong><span class="koboSpan" id="kobo.925.1">) and Queenstown, Ireland (identified with </span><strong class="keyWord"><span class="koboSpan" id="kobo.926.1">Q</span></strong><span class="koboSpan" id="kobo.927.1">). </span><span class="koboSpan" id="kobo.927.2">We can observe the prevalence of ethnic </span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.928.1">names in various embarkment ports, with Scandinavian in Southampton; French, Italian, Greek, and North African in Cherbourg; and Irish and Scottish in Queenstown.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.929.1"><img alt="" role="presentation" src="../Images/B20963_03_27.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.930.1">Figure 3.24: Family names grouped by embarking port</span></p>
<p class="normal"><span class="koboSpan" id="kobo.931.1">In </span><em class="italic"><span class="koboSpan" id="kobo.932.1">Figure 3.25</span></em><span class="koboSpan" id="kobo.933.1">, we see the two passengers sharing cabin </span><strong class="keyWord"><span class="koboSpan" id="kobo.934.1">D17</span></strong><span class="koboSpan" id="kobo.935.1">. </span><span class="koboSpan" id="kobo.935.2">One of them had the title </span><code class="inlineCode"><span class="koboSpan" id="kobo.936.1">Dr.</span></code><span class="koboSpan" id="kobo.937.1"> and was also a female. </span><span class="koboSpan" id="kobo.937.2">She was traveling with another female companion, Mrs. </span><span class="koboSpan" id="kobo.937.3">Swift, in first class. </span><span class="koboSpan" id="kobo.937.4">Both of them survived.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.938.1">We created an engineered feature, </span><code class="inlineCode"><span class="koboSpan" id="kobo.939.1">Title</span></code><span class="koboSpan" id="kobo.940.1">, because Dr. </span><span class="koboSpan" id="kobo.940.2">Leader was both a </span><code class="inlineCode"><span class="koboSpan" id="kobo.941.1">Mrs.</span></code><span class="koboSpan" id="kobo.942.1"> (we know she was married because her maiden name is also mentioned) and a </span><code class="inlineCode"><span class="koboSpan" id="kobo.943.1">Dr.</span></code><span class="koboSpan" id="kobo.944.1">; we had to choose which title to assign to her. </span><code class="inlineCode"><span class="koboSpan" id="kobo.945.1">Dr.</span></code><span class="koboSpan" id="kobo.946.1"> was a title associated mostly with males (with lower survival likelihood) at that time. </span><span class="koboSpan" id="kobo.946.2">As a female, she would have had a higher survival probability. </span><span class="koboSpan" id="kobo.946.3">While that is matter of debate, of course, I mention it here just to give you a better image of the depth we can get while engineering the candidate features for a predictive model.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.947.1"><img alt="" role="presentation" src="../Images/B20963_03_28.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.948.1">Figure 3.25: Passengers sharing cabin D17 – one of them was a female and had the Dr. </span><span class="koboSpan" id="kobo.948.2">title</span></p>
<p class="normal"><span class="koboSpan" id="kobo.949.1">After introducing univariate and multivariate analysis and a few types of feature engineering, including the processing of names to extract titles, we also performed some detailed analysis of large families and some rare cases: very large families and passengers with unusual titles. </span><span class="koboSpan" id="kobo.949.2">In the next section, we will create a dashboard figure with multiple plots, each</span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.950.1"> with univariate or bivariate analysis. </span><span class="koboSpan" id="kobo.950.2">We can use such complex figures to better capture the complex feature interactions, without loading one graph with too many features.</span></p>
<h1 class="heading-1" id="_idParaDest-45"><span class="koboSpan" id="kobo.951.1">Creating a dashboard showing multiple plots</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.952.1">We have explored categorical and</span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.953.1"> numerical data, as well as text data. </span><span class="koboSpan" id="kobo.953.2">We have learned how to extract various features from text data, and we built aggregated features from some of the numerical ones. </span><span class="koboSpan" id="kobo.953.3">Let’s now build two more features by grouping </span><strong class="keyWord"><span class="koboSpan" id="kobo.954.1">Title</span></strong><span class="koboSpan" id="kobo.955.1"> and </span><strong class="keyWord"><span class="koboSpan" id="kobo.956.1">Family Size</span></strong><span class="koboSpan" id="kobo.957.1">. </span><span class="koboSpan" id="kobo.957.2">We will create two new features:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.958.1">Titles</span></strong><span class="koboSpan" id="kobo.959.1">: By clustering together similar titles (like </span><code class="inlineCode"><span class="koboSpan" id="kobo.960.1">Miss</span></code><span class="koboSpan" id="kobo.961.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.962.1">Mlle.</span></code><span class="koboSpan" id="kobo.963.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.964.1">Mrs.</span></code><span class="koboSpan" id="kobo.965.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.966.1">Mme.</span></code><span class="koboSpan" id="kobo.967.1">) or rare (like </span><code class="inlineCode"><span class="koboSpan" id="kobo.968.1">Dona.</span></code><span class="koboSpan" id="kobo.969.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.970.1">Don.</span></code><span class="koboSpan" id="kobo.971.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.972.1">Capt.</span></code><span class="koboSpan" id="kobo.973.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.974.1">Jonkheer</span></code><span class="koboSpan" id="kobo.975.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.976.1">Rev.</span></code><span class="koboSpan" id="kobo.977.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.978.1">Countess</span></code><span class="koboSpan" id="kobo.979.1">) and keeping the most frequent ones – </span><code class="inlineCode"><span class="koboSpan" id="kobo.980.1">Mr.</span></code><span class="koboSpan" id="kobo.981.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.982.1">Mrs.</span></code><span class="koboSpan" id="kobo.983.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.984.1">Master</span></code><span class="koboSpan" id="kobo.985.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.986.1">Miss</span></code></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.987.1">Family Type</span></strong><span class="koboSpan" id="kobo.988.1">: By creating three clusters from the </span><strong class="keyWord"><span class="koboSpan" id="kobo.989.1">Family Size</span></strong><span class="koboSpan" id="kobo.990.1"> values – </span><strong class="keyWord"><span class="koboSpan" id="kobo.991.1">Single</span></strong><span class="koboSpan" id="kobo.992.1"> for a family size of 1, </span><strong class="keyWord"><span class="koboSpan" id="kobo.993.1">Small</span></strong><span class="koboSpan" id="kobo.994.1"> for families made of up to 4 members, and </span><strong class="keyWord"><span class="koboSpan" id="kobo.995.1">Large</span></strong><span class="koboSpan" id="kobo.996.1"> for families with more than 4 members</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.997.1">Then, we will represent, on a single graph, several simple or derived features that we learned have an important predictive value. </span><span class="koboSpan" id="kobo.997.2">We show the passengers’ survival rates for </span><code class="inlineCode"><span class="koboSpan" id="kobo.998.1">Sex</span></code><span class="koboSpan" id="kobo.999.1">, Passenger Class (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1000.1">Pclass</span></code><span class="koboSpan" id="kobo.1001.1">), </span><code class="inlineCode"><span class="koboSpan" id="kobo.1002.1">Age Interval</span></code><span class="koboSpan" id="kobo.1003.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1004.1">Fare Interval</span></code><span class="koboSpan" id="kobo.1005.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1006.1">Family Type</span></code><span class="koboSpan" id="kobo.1007.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1008.1">Title </span></code><span class="koboSpan" id="kobo.1009.1">(clustered). </span><span class="koboSpan" id="kobo.1009.2">The graphs also show the percentage that the subset (given by both the category and survived status) represents from all passengers:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1010.1"><img alt="Chart, bar chart  Description automatically generated" src="../Images/B20963_03_29.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1011.1">Figure 3.26: Passenger survival rates for different features (original or derived)</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1012.1">With that, we have performed a step-by-step exploratory data analysis of the </span><em class="italic"><span class="koboSpan" id="kobo.1013.1">Titanic - Machine Learning from Disaster</span></em><span class="koboSpan" id="kobo.1014.1"> competition</span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.1015.1"> dataset. </span><span class="koboSpan" id="kobo.1015.2">Now, with the knowledge we gathered about data distribution, the relationship between features, and the correlation between various features and the target feature (the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1016.1">Survived</span></code><span class="koboSpan" id="kobo.1017.1"> field), we will create a baseline model.</span></p>
<h1 class="heading-1" id="_idParaDest-46"><span class="koboSpan" id="kobo.1018.1">Building a baseline model</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1019.1">As a result of our data analysis, we were able to identify some of the features with predictive value. </span><span class="koboSpan" id="kobo.1019.2">We can now build a model by using this knowledge to select relevant features. </span><span class="koboSpan" id="kobo.1019.3">We will start with </span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.1020.1">a model that will use just two out of the many features we investigated. </span><span class="koboSpan" id="kobo.1020.2">This is called a baseline model and it is used as a starting point for the incremental refinement of the solution.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1021.1">For the baseline model, we chose a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1022.1">RandomForestClassifier</span></code><span class="koboSpan" id="kobo.1023.1"> model. </span><span class="koboSpan" id="kobo.1023.2">The model is simple to use, gives good results with the default parameters, and can be interpreted easily, using feature importance.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1024.1">Let’s begin with the following code block to implement the model. </span><span class="koboSpan" id="kobo.1024.2">First, we import a few libraries that are needed to prepare the model. </span><span class="koboSpan" id="kobo.1024.3">Then, we convert the categorical data to numerical. </span><span class="koboSpan" id="kobo.1024.4">We need to do this since the model we chose deals with numbers only. </span><span class="koboSpan" id="kobo.1024.5">The operation of converting the categorical feature values to numbers is called label encoding. </span><span class="koboSpan" id="kobo.1024.6">Then, we split the train dataset into train and validation subsets, using an 80-20% split. </span><span class="koboSpan" id="kobo.1024.7">The model is then fitted using the train subset and we use the validation subset to evaluate the trained (fitted) model:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1025.1">from</span></span><span class="koboSpan" id="kobo.1026.1"> sklearn.model_selection </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1027.1">import</span></span><span class="koboSpan" id="kobo.1028.1"> train_test_split
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1029.1">from</span></span><span class="koboSpan" id="kobo.1030.1"> sklearn </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1031.1">import</span></span><span class="koboSpan" id="kobo.1032.1"> metrics
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1033.1">from</span></span><span class="koboSpan" id="kobo.1034.1"> sklearn.ensemble </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1035.1">import</span></span><span class="koboSpan" id="kobo.1036.1"> RandomForestClassifier
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1037.1"># convert categorical data in numerical</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1038.1">for</span></span><span class="koboSpan" id="kobo.1039.1"> dataset </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1040.1">in</span></span><span class="koboSpan" id="kobo.1041.1"> [train_df, test_df]:
    dataset[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1042.1">'Sex'</span></span><span class="koboSpan" id="kobo.1043.1">] = dataset[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1044.1">'Sex'</span></span><span class="koboSpan" id="kobo.1045.1">].</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1046.1">map</span></span><span class="koboSpan" id="kobo.1047.1">( {</span><span class="hljs-string"><span class="koboSpan" id="kobo.1048.1">'female'</span></span><span class="koboSpan" id="kobo.1049.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1050.1">1</span></span><span class="koboSpan" id="kobo.1051.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1052.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1053.1">male'</span></span><span class="koboSpan" id="kobo.1054.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1055.1">0</span></span><span class="koboSpan" id="kobo.1056.1">} ).astype(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1057.1">int</span></span><span class="koboSpan" id="kobo.1058.1">)
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1059.1"># train-validation split (20% validation)</span></span><span class="koboSpan" id="kobo.1060.1">
VALID_SIZE = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1061.1">0.2</span></span><span class="koboSpan" id="kobo.1062.1">
train, valid = train_test_split(train_df, test_size=VALID_SIZE, random_state=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1063.1">42</span></span><span class="koboSpan" id="kobo.1064.1">, shuffle=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1065.1">True</span></span><span class="koboSpan" id="kobo.1066.1">)
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1067.1"># define predictors and target feature (labels)</span></span><span class="koboSpan" id="kobo.1068.1">
predictors = [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1069.1">"Sex"</span></span><span class="koboSpan" id="kobo.1070.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1071.1">"Pclass"</span></span><span class="koboSpan" id="kobo.1072.1">]
target = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1073.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1074.1">Survived'</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1075.1"># train and validation data and labels</span></span><span class="koboSpan" id="kobo.1076.1">
train_X = train[predictors]
train_Y = train[target].values
valid_X = valid[predictors]
valid_Y = valid[target].values
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1077.1"># define the classification model (Random Forest)</span></span><span class="koboSpan" id="kobo.1078.1">
clf = RandomForestClassifier(n_jobs=-</span><span class="hljs-number"><span class="koboSpan" id="kobo.1079.1">1</span></span><span class="koboSpan" id="kobo.1080.1">, 
                             random_state=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1081.1">42</span></span><span class="koboSpan" id="kobo.1082.1">,
                             criterion=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1083.1">"gini"</span></span><span class="koboSpan" id="kobo.1084.1">,
                             n_estimators=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1085.1">100</span></span><span class="koboSpan" id="kobo.1086.1">,
                             verbose=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1087.1">False</span></span><span class="koboSpan" id="kobo.1088.1">)
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1089.1"># fit the model with training data and labels</span></span><span class="koboSpan" id="kobo.1090.1">
clf.fit(train_X, train_Y)
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1091.1"># predict the survival status for the validation set</span></span><span class="koboSpan" id="kobo.1092.1">
preds = clf.predict(valid_X)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1093.1">In </span><em class="italic"><span class="koboSpan" id="kobo.1094.1">Figure 3.27</span></em><span class="koboSpan" id="kobo.1095.1">, we show the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1096.1">precision</span></code><span class="koboSpan" id="kobo.1097.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1098.1">recall</span></code><span class="koboSpan" id="kobo.1099.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">f1-score</span></code><span class="koboSpan" id="kobo.1101.1"> for the validation set (values obtained using </span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.1102.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1103.1">classification_report</span></code><span class="koboSpan" id="kobo.1104.1"> function from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1105.1">sklearn.metrics</span></code><span class="koboSpan" id="kobo.1106.1"> module).</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1107.1"><img alt="A screenshot of a computer  Description automatically generated" src="../Images/B20963_03_30.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1108.1">Figure 3.27: Classification report for the validation data for the baseline model trained with Sex and Pclass features</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1109.1">The preceding results obtained with this baseline model are still poor. </span><span class="koboSpan" id="kobo.1109.2">We will have to refine the model using the techniques for model refinement, starting with the observations on training and validation errors. </span><span class="koboSpan" id="kobo.1109.3">Based on these observations, we might want to improve the training first before focusing on improving model generalization. </span><span class="koboSpan" id="kobo.1109.4">We might, therefore, opt for adding more features (with predictive values), either by selecting from existing features or creating new features via feature engineering, performing hyperparameter optimization, choosing a better classification algorithm, or combining different algorithms.</span></p>
<h1 class="heading-1" id="_idParaDest-47"><span class="koboSpan" id="kobo.1110.1">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1111.1">In this chapter, we started our journey around the data world on board the Titanic. </span><span class="koboSpan" id="kobo.1111.2">We started with a preliminary statistical analysis of each feature and then continued with univariate analysis and feature engineering to create derived or aggregated features. </span><span class="koboSpan" id="kobo.1111.3">We extracted multiple features from text, and we also created complex graphs to visualize multiple features at the same time and reveal their predictive value. </span><span class="koboSpan" id="kobo.1111.4">We then learned how to assign a uniform visual identity for our analysis by using a custom color map across the notebook.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1112.1">For some of the features – most notably, those derived from names – we performed a deep-dive exploration to learn about the fate of large families on the Titanic and about name distribution according to the embarking port. </span><span class="koboSpan" id="kobo.1112.2">Some of the analysis and visualization tools are easily reusable and, in the next chapter, we will see how to extract them to be used as utility scripts in other notebooks as well.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1113.1">In the next chapter, we will perform a detailed exploratory data analysis on two datasets with geospatial data. </span><span class="koboSpan" id="kobo.1113.2">For each of the datasets, we will start with a data quality assessment, and then continue with data exploration, introducing analysis methods, tools, and libraries specific for geographical data analysis. </span><span class="koboSpan" id="kobo.1113.3">We will learn how to manipulate polygon data, and how to merge, fusion, and clip sets of geographical data stored as collections of polygons. </span><span class="koboSpan" id="kobo.1113.4">We will also introduce various libraries for the visualization of geospatial data. </span><span class="koboSpan" id="kobo.1113.5">After performing the individual analyses on both datasets, we will combine the information from the two datasets to build advanced maps with several layers of information from the two datasets.</span></p>
<h1 class="heading-1" id="_idParaDest-48"><span class="koboSpan" id="kobo.1114.1">References</span></h1>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1115.1">Titanic - Machine Learning from Disaster, Kaggle competition: </span><a href="https://www.kaggle.com/competitions/titanic"><span class="url"><span class="koboSpan" id="kobo.1116.1">https://www.kaggle.com/competitions/titanic</span></span></a> </li>
<li class="numberedList"><span class="koboSpan" id="kobo.1117.1">Gabriel Preda, Titanic – start of a journey around data world, Kaggle notebook: </span><a href="https://www.kaggle.com/code/gpreda/titanic-start-of-a-journey-around-data-world"><span class="url"><span class="koboSpan" id="kobo.1118.1">https://www.kaggle.com/code/gpreda/titanic-start-of-a-journey-around-data-world</span></span></a> </li>
<li class="numberedList"><span class="koboSpan" id="kobo.1119.1">Developing-Kaggle-Notebooks, Packt Publishing GitHub repository: </span><a href="https://github.com/PacktPublishing/Developing-Kaggle-Notebooks/"><span class="url"><span class="koboSpan" id="kobo.1120.1">https://github.com/PacktPublishing/Developing-Kaggle-Notebooks/</span></span></a> </li>
<li class="numberedList"><span class="koboSpan" id="kobo.1121.1">Developing-Kaggle-Notebooks, Packt Publishing GitHub repository, Chapter 3: </span><a href="https://github.com/PacktPublishing/Developing-Kaggle-Notebooks/tree/main/Chapter-03"><span class="url"><span class="koboSpan" id="kobo.1122.1">https://github.com/PacktPublishing/Developing-Kaggle-Notebooks/tree/main/Chapter-03</span></span></a> </li>
</ol>
<h1 class="heading-1"><span class="koboSpan" id="kobo.1123.1">Join our book’s Discord space</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1124.1">Join our Discord community to meet like-minded people and learn alongside more than 5000 members at:</span></p>
<p class="normal"><a href="https://packt.link/kaggle"><span class="url"><span class="koboSpan" id="kobo.1125.1">https://packt.link/kaggle</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.1126.1"><img alt="" role="presentation" src="../Images/QR_Code9220780366773140.png"/></span></p>
</div>
</body></html>