<html><head></head><body>
<div id="_idContainer034" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-38"><a id="_idTextAnchor037" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-39" class="calibre5"><a id="_idTextAnchor038" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.2.1">Machine Learning Phases and Privacy Threats/Attacks in Each Phase</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">In this chapter, we will provide a quick refresher on the different types of </span><strong class="bold"><span class="kobospan" id="kobo.4.1">machine learning</span></strong><span class="kobospan" id="kobo.5.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.6.1">ML</span></strong><span class="kobospan" id="kobo.7.1">): supervised, unsupervised, and reinforcement learning. </span><span class="kobospan" id="kobo.7.2">We will also review the essential phases or pipelines of ML. </span><span class="kobospan" id="kobo.7.3">You may already be familiar with these; if not, this chapter will serve as a </span><span><span class="kobospan" id="kobo.8.1">foundational introduction.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.9.1">Subsequently, we will delve into the crucial topic of privacy preservation within each phase of the ML process. </span><span class="kobospan" id="kobo.9.2">Specifically, we will explore the importance of maintaining privacy in training data, input data, model storage, and inference/output data. </span><span class="kobospan" id="kobo.9.3">Additionally, we will examine various privacy attacks that can occur in each phase, such as training data extraction attacks, model inversion attacks, and model inference attacks. </span><span class="kobospan" id="kobo.9.4">Through detailed examples, we will gain an understanding of how these attacks function and discuss strategies to safeguard </span><span><span class="kobospan" id="kobo.10.1">against them.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.11.1">We will cover the following </span><span><span class="kobospan" id="kobo.12.1">main topics:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span><span class="kobospan" id="kobo.13.1">ML types</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.14.1">Overview of </span><span><span class="kobospan" id="kobo.15.1">ML phases</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.16.1">Privacy threats/attacks in the </span><span><span class="kobospan" id="kobo.17.1">ML phases</span></span></li>
</ul>
<h1 id="_idParaDest-40" class="calibre5"><a id="_idTextAnchor039" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.18.1">ML types</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.19.1">Some of you may </span><a id="_idIndexMarker067" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.20.1">already be familiar with the different types of ML, namely supervised ML, unsupervised ML, and reinforcement learning. </span><span class="kobospan" id="kobo.20.2">In the next sections, we will provide a quick refresher on these ML types, summarizing what you may have </span><span><span class="kobospan" id="kobo.21.1">already learned.</span></span></p>
<h2 id="_idParaDest-41" class="calibre7"><a id="_idTextAnchor040" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.22.1">Supervised ML</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.23.1">Supervised ML models involve the development of a mathematical model using a set of input data and corresponding </span><a id="_idIndexMarker068" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.24.1">actual output. </span><span class="kobospan" id="kobo.24.2">The input data is known as the training data, while the output is referred to</span><a id="_idIndexMarker069" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.25.1"> as the </span><a id="_idIndexMarker070" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.26.1">predicted output. </span><span class="kobospan" id="kobo.26.2">These models employ mathematical functions to learn from the training data and aim to minimize the errors between the predicted output and the expected output using an optimal function. </span><span class="kobospan" id="kobo.26.3">The training data, which consists of input examples, is typically represented in formats such as arrays, vectors, matrices, or tensors. </span><span class="kobospan" id="kobo.26.4">This data is often referred to as feature data or feature vectors, where each attribute within the data is considered </span><span><span class="kobospan" id="kobo.27.1">a feature.</span></span></p>
<table class="no-table-style" id="table001-2">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.28.1">Type</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.29.1">Example</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.30.1">Details</span></strong></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.31.1">Scalar</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.32.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.33.1">A scalar is a </span><span><span class="kobospan" id="kobo.34.1">single number.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.35.1">Vector</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.36.1">[ 1 2 3 </span><span><span class="kobospan" id="kobo.37.1">4 ]</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.38.1">A vector is an array of numbers or objects with different </span><span><span class="kobospan" id="kobo.39.1">data types.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.40.1">Matrix</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.41.1">[</span></span><span><span class="kobospan" id="kobo.42.1">1</span></span><span><span class="kobospan" id="kobo.43.1">¬†</span></span><span><span class="kobospan" id="kobo.44.1">2</span></span><span><span class="kobospan" id="kobo.45.1">¬†</span></span><span><span class="kobospan" id="kobo.46.1">3</span></span><span><span class="kobospan" id="kobo.47.1">¬†</span></span><span><span class="kobospan" id="kobo.48.1">4</span></span><span><span class="kobospan" id="kobo.49.1">¬†</span></span><span><span class="kobospan" id="kobo.50.1">5</span></span><span><span class="kobospan" id="kobo.51.1">¬†</span></span><span><span class="kobospan" id="kobo.52.1">6</span></span><span><span class="kobospan" id="kobo.53.1">¬†</span></span><span><span class="kobospan" id="kobo.54.1">7</span></span><span><span class="kobospan" id="kobo.55.1">¬†</span></span><span><span><span class="kobospan" id="kobo.56.1">8</span></span></span><span><span><span class="kobospan" id="kobo.57.1">¬†</span></span></span><span><span><span class="kobospan" id="kobo.58.1">9</span></span></span><span><span><span class="kobospan" id="kobo.59.1">]</span></span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.60.1">A matrix is an array of numbers arranged in rows and columns. </span><span class="kobospan" id="kobo.60.2">In order to access the matrix, we need two indexes: column number and </span><span><span class="kobospan" id="kobo.61.1">row number.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.62.1">Tensor</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.63.1">[</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.64.1">[ 1 2] [ 3 4] [ </span><span><span class="kobospan" id="kobo.65.1">5 6]</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.66.1">[ 7 8 ] [9 0] [ </span><span><span class="kobospan" id="kobo.67.1">0 1]</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.68.1">]</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.69.1">A tensor is an </span><em class="italic"><span class="kobospan" id="kobo.70.1">n</span></em><span class="kobospan" id="kobo.71.1">-dimensional array </span><span><span class="kobospan" id="kobo.72.1">with </span></span><span><em class="italic"><span class="kobospan" id="kobo.73.1">n&gt;2</span></em></span><span><span class="kobospan" id="kobo.74.1">.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.75.1">Table 2.1 ‚Äì Examples of scalar, vector, matrix, and tensor</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.76.1">In mathematical terms, supervised learning in ML can be represented by a model, with parameters, </span><em class="italic"><span class="kobospan" id="kobo.77.1">ùúÉ</span></em><span class="kobospan" id="kobo.78.1">. </span><span class="kobospan" id="kobo.78.2">This model acts as a mapping function between input </span><em class="italic"><span class="kobospan" id="kobo.79.1">x</span></em><span class="kobospan" id="kobo.80.1"> and output </span><em class="italic"><span class="kobospan" id="kobo.81.1">y</span></em><span class="kobospan" id="kobo.82.1">, denoted as </span><em class="italic"><span class="kobospan" id="kobo.83.1">y = </span></em><span class="kobospan" id="kobo.84.1">ùëì</span><em class="italic"><span class="kobospan" id="kobo.85.1"> (x, </span></em><span class="kobospan" id="kobo.86.1">ùúÉ</span><em class="italic"><span class="kobospan" id="kobo.87.1">). </span></em><span class="kobospan" id="kobo.88.1">In this context, </span><em class="italic"><span class="kobospan" id="kobo.89.1">x</span></em><span class="kobospan" id="kobo.90.1"> represents a vector of attributes or features with a dimensionality of </span><em class="italic"><span class="kobospan" id="kobo.91.1">ùëõ</span></em><span class="kobospan" id="kobo.92.1">. </span><span class="kobospan" id="kobo.92.2">The output or label </span><em class="italic"><span class="kobospan" id="kobo.93.1">y</span></em><span class="kobospan" id="kobo.94.1"> can vary in dimension depending on the specific </span><span><span class="kobospan" id="kobo.95.1">learning task.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.96.1">To train the model, a training set T, is utilized, which consists of data points in the form of T = {(x , y</span><span class="subscript"><span class="kobospan1" id="kobo.97.1">ùëñ</span></span><span class="kobospan" id="kobo.98.1">)}, where </span><em class="italic"><span class="kobospan" id="kobo.99.1">ùëñ</span></em><span class="kobospan" id="kobo.100.1"> ranges from 1 to n, representing the number of </span><span><span class="kobospan" id="kobo.101.1">input‚Äìoutput pairs.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.102.1">Supervised ML algorithms</span><a id="_idIndexMarker071" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.103.1"> typically fall into two categories: regression and classification. </span><span class="kobospan" id="kobo.103.2">These algorithms aim to learn patterns and relationships within the training data to make predictions or assign labels to new, </span><span><span class="kobospan" id="kobo.104.1">unseen data.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.105.1">Regression</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.106.1">A target variable in ML is the </span><a id="_idIndexMarker072" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.107.1">variable that we aim to predict or forecast. </span><span class="kobospan" id="kobo.107.2">It is also often termed as the dependent variable. </span><span class="kobospan" id="kobo.107.3">It is what the ML model is trained to predict using</span><a id="_idIndexMarker073" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.108.1"> independent or feature variables. </span><span class="kobospan" id="kobo.108.2">For example, in a house price prediction model, the house price would be the </span><span><span class="kobospan" id="kobo.109.1">target variable.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.110.1">Regression is a fundamental concept in ML that focuses on predicting continuous numerical values based on input variables. </span><span class="kobospan" id="kobo.110.2">It is a supervised learning technique that involves analyzing the relationship between the input features and the target variable. </span><span class="kobospan" id="kobo.110.3">The goal of regression is to build a mathematical model that can accurately estimate or approximate the value of the target variable when provided with new </span><span><span class="kobospan" id="kobo.111.1">input data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.112.1">In regression, the target variable, also known as the </span><a id="_idIndexMarker074" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.113.1">dependent variable, is a continuous value. </span><span class="kobospan" id="kobo.113.2">The input variables, also called independent </span><a id="_idIndexMarker075" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.114.1">variables or features, can be numerical or categorical. </span><span class="kobospan" id="kobo.114.2">The regression model seeks to understand the relationship between these input variables and the target variable, enabling predictions to be made for </span><span><span class="kobospan" id="kobo.115.1">unseen data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.116.1">The performance of a regression model is typically measured by evaluating the closeness of its predictions to the actual target values. </span><span class="kobospan" id="kobo.116.2">Various regression algorithms exist, such as linear regression, polynomial regression, and more complex techniques such as support vector regression and random forest regression. </span><span class="kobospan" id="kobo.116.3">These algorithms use mathematical optimization methods to fit a regression function that minimizes the difference between predicted values and the true values of the </span><span><span class="kobospan" id="kobo.117.1">target variable.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.118.1">Regression analysis finds applications in numerous fields, including finance, economics, healthcare, and social sciences, where it is used for tasks such as price prediction, demand forecasting, risk assessment, and trend analysis. </span><span class="kobospan" id="kobo.118.2">By leveraging regression algorithms, valuable insights can be gained from data, allowing for informed decision-making and </span><span><span class="kobospan" id="kobo.119.1">accurate </span></span><span><a id="_idIndexMarker076" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.120.1">predictions.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.121.1">Regression model example</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.122.1">Here‚Äôs a straightforward example of predicting a target variable using two input features. </span><span class="kobospan" id="kobo.122.2">In this scenario, a model is trained on a set of historical data, typically representing the data from the last </span><span><span class="kobospan" id="kobo.123.1">X days.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.124.1">The purpose is to forecast or predict the</span><a id="_idIndexMarker077" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.125.1"> target variable based on the provided input data. </span><span class="kobospan" id="kobo.125.2">By analyzing patterns and relationships in the historical dataset, the trained model can make predictions about the target variable when presented with new input data. </span><span class="kobospan" id="kobo.125.3">This process allows for forecasting future values or understanding potential outcomes based on the given inputs. </span><span class="kobospan" id="kobo.125.4">The model‚Äôs accuracy and performance are evaluated based on how well it can predict the target variable compared to the actual values. </span><span class="kobospan" id="kobo.125.5">By leveraging historical data and utilizing ML algorithms, valuable insights can be gained, enabling accurate predictions and </span><span><span class="kobospan" id="kobo.126.1">informed decision-making.</span></span></p>
<table class="no-table-style" id="table002-1">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.127.1">Feature 1 value</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.128.1">Feature 2 value</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.129.1">Target variable value</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.130.1">10</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.131.1">10</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.132.1">130</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.133.1">10</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.134.1">20</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.135.1">180</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.136.1">20</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.137.1">20</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.138.1">210</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.139.1">20</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.140.1">30</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.141.1">260</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.142.1">30</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.143.1">50</span></p>
</td>
<td class="no-table-style2">
<p class="author-quote"><span class="kobospan" id="kobo.144.1">??</span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.145.1">Table 2.2 ‚Äì regression model example</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.146.1">This example was implemented using the scikit-learn library. </span><span class="kobospan" id="kobo.146.2">I have used Python version 3.8 and scikit-learn </span><span><span class="kobospan" id="kobo.147.1">version 1.2.1.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.148.1">These are the steps followed in </span><span><span class="kobospan" id="kobo.149.1">this example:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.150.1">Install Jupyter Notebook (</span><strong class="source-inline1"><span class="kobospan" id="kobo.151.1">pip </span></strong><span><strong class="source-inline1"><span class="kobospan" id="kobo.152.1">install notebook</span></strong></span><span><span class="kobospan" id="kobo.153.1">).</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.154.1">Open a Python Jupyter notebook (</span><span><strong class="source-inline1"><span class="kobospan" id="kobo.155.1">jupyter notebook</span></strong></span><span><span class="kobospan" id="kobo.156.1">).</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.157.1">Install sci-kit learn libraries (</span><strong class="source-inline1"><span class="kobospan" id="kobo.158.1">pip install -</span></strong><span><strong class="source-inline1"><span class="kobospan" id="kobo.159.1">U scikit-learn</span></strong></span><span><span class="kobospan" id="kobo.160.1">).</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.161.1">Type the following code and run the </span><span><span class="kobospan" id="kobo.162.1">model code.</span></span></li>
</ol>
<p class="calibre3"><span class="kobospan" id="kobo.163.1">You can directly execute the code using the Jupyter notebook provided in the GitHub location of this book‚Äî</span><strong class="source-inline"><span class="kobospan" id="kobo.164.1">LinearRegression.ipynb</span></strong><span class="kobospan" id="kobo.165.1">‚Äîlocated </span><span><span class="kobospan" id="kobo.166.1">at </span></span><a href="https://github.com/PacktPublishing/Privacy-Preserving-Machine-Learning/blob/main/Chapter%202/LinearRegression.ipynb" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.167.1">https://github.com/PacktPublishing/Privacy-Preserving-Machine-Learning/blob/main/Chapter%202/LinearRegression.ipynb</span></span></a><span><span class="kobospan" id="kobo.168.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.169.1">
import numpy as np
from sklearn.linear_model import LinearRegression
# Prepare sample input data with two features (feature 1, feature 2
X = np.array([[10, 10], [10, 20], [20, 20], [20, 30]])
# Assume that target feature has some relationship with the input features with the formula y = 3 * x_1 + 5 * x_2 + 50
y = np.dot(X, np.array([3, 5])) + 50
# Run the model with the input data and output values
reg = LinearRegression().fit(X, y)
reg.score(X, y)
reg.coef_
reg.intercept_
reg.predict(np.array([[30, 50]]))
Output: array([390.])</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.170.1">In this example, target variable y is linearly dependent on input variables X</span><span class="subscript"><span class="kobospan1" id="kobo.171.1">0</span></span><span class="kobospan" id="kobo.172.1"> and X</span><span class="subscript"><span class="kobospan1" id="kobo.173.1">1</span></span><span class="kobospan" id="kobo.174.1"> with the linear equation y= 3X</span><span class="subscript"><span class="kobospan1" id="kobo.175.1">0</span></span><span class="kobospan" id="kobo.176.1">+ 5X</span><span class="subscript"><span class="kobospan1" id="kobo.177.1">1</span></span><span class="kobospan" id="kobo.178.1">+50 (50 is the intercept of </span><span><span class="kobospan" id="kobo.179.1">the line).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.180.1">The model uses the root</span><a id="_idIndexMarker078" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.181.1"> mean square value as an optimal function and predicts the target variable. </span><span class="kobospan" id="kobo.181.2">In this case, it predicts 100% accuracy because of the strong linear relationship between the features and the </span><span><span class="kobospan" id="kobo.182.1">target variable.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.183.1">Model persistence and retrieving the persisted model for inference</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.184.1">After developing and testing the model using training data and validating it with test data, the next step is to persist the model. </span><span class="kobospan" id="kobo.184.2">This allows for easy sharing with other developers or engineers without </span><a id="_idIndexMarker079" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.185.1">revealing the training data and intricate model details. </span><span class="kobospan" id="kobo.185.2">Additionally, if the model demonstrates sufficient accuracy during</span><a id="_idIndexMarker080" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.186.1"> training, it can be deployed in </span><span><span class="kobospan" id="kobo.187.1">production environments.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.188.1">To persist the model, various formats are supported to store it in the disk or file system. </span><span class="kobospan" id="kobo.188.2">The specific format utilized depends on the framework </span><a id="_idIndexMarker081" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.189.1">used to develop the ML or </span><strong class="bold"><span class="kobospan" id="kobo.190.1">deep learning</span></strong><span class="kobospan" id="kobo.191.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.192.1">DL</span></strong><span class="kobospan" id="kobo.193.1">) model. </span><span class="kobospan" id="kobo.193.2">By employing these formats, the model can be stored and accessed efficiently, facilitating seamless integration into production systems or collaborations with other </span><span><span class="kobospan" id="kobo.194.1">team members.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.195.1">Persisting the model enables reproducibility and scalability, as it can be shared, reused, and deployed in different environments without the need to retrain it from scratch. </span><span class="kobospan" id="kobo.195.2">It also helps protect proprietary information and intellectual property associated with the model, allowing organizations to safeguard their valuable research and </span><span><span class="kobospan" id="kobo.196.1">development efforts.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer020">
<span class="kobospan" id="kobo.197.1"><img alt="Figure 2.1 ‚Äì Model persistence and retrieval" src="image/B16573_02_01.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.198.1">Figure 2.1 ‚Äì Model persistence and retrieval</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.199.1">The following table shows some formats that are widely used and accepted in </span><span><span class="kobospan" id="kobo.200.1">the community:</span></span></p>
<table class="no-table-style" id="table003-1">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.201.1">Framework</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.202.1">Model </span><span><span class="kobospan" id="kobo.203.1">persistence format</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.204.1">Details</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.205.1">scikit-learn</span></span></p>
<p class="calibre3"><a href="https://scikit-learn.org/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.206.1">https://scikit-learn.org/</span></span></a></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.207.1">Joblib</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.208.1">P</span></span><span><span class="kobospan" id="kobo.209.1">ickle</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.210.1">The Joblib and pickle formats don‚Äôt require any </span><span><span class="kobospan" id="kobo.211.1">code changes.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.212.1">The pickle format has security issues, so most frameworks don‚Äôt advise using the pickle format for model persistence because arbitrary code can be executed </span><span><span class="kobospan" id="kobo.213.1">during unpickling.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.214.1">TensorFlow/Keras</span></span></p>
<p class="calibre3"><a href="https://www.tensorflow.org/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.215.1">https://www.tensorflow.org/</span></span></a></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.216.1">JSON</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.217.1">YAML</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.218.1">HDF5</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.219.1">This is model data stored in JSON format or YAML format, and these formats are text-based formats, so they </span><span><span class="kobospan" id="kobo.220.1">are language-agnostic.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.221.1">Weights are saved in </span><span><span class="kobospan" id="kobo.222.1">HDF5 format.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.223.1">PyTorch</span></span></p>
<p class="calibre3"><a href="https://pytorch.org/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.224.1">https://pytorch.org/</span></span></a></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.225.1">state_dict</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.226.1">Pickle</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.227.1">For</span><a id="_idIndexMarker082" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.228.1"> neural network models to store weights </span><span><span class="kobospan" id="kobo.229.1">and</span></span><span><a id="_idIndexMarker083" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.230.1"> biases.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.231.1">ONNX</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.232.1">Onnx</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.233.1">Models need to be converted to ONNX format and exported and loaded/executed using ONNX Runtime so that they can be run either on CPU- or </span><span><span class="kobospan" id="kobo.234.1">GPU-based servers.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.235.1">Table 2.3 ‚Äì Examples of scalar, vector, matrix, and tensor</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.236.1">The following code shows how to store and retrieve a model in the Joblib format </span><span><span class="kobospan" id="kobo.237.1">using Python:</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.238.1">What is Joblib?</span></p>
<p class="callout"><span class="kobospan" id="kobo.239.1">Joblib (</span><a href="https://joblib.readthedocs.io/en/latest/" class="pcalibre1 calibre6 pcalibre"><span class="kobospan" id="kobo.240.1">https://joblib.readthedocs.io/en/latest/</span></a><span class="kobospan" id="kobo.241.1">) is a set of tools to</span><a id="_idIndexMarker084" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.242.1"> provide lightweight pipelining in </span><a id="_idIndexMarker085" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.243.1">Python to persist (or serialize) the </span><a id="_idIndexMarker086" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.244.1">Python objects. </span><span class="kobospan" id="kobo.244.2">Joblib version 1.2.0 is used in </span><span><span class="kobospan" id="kobo.245.1">this code.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.246.1">The Jupyter notebook for this example </span><span><span class="kobospan" id="kobo.247.1">is </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.248.1">LinearRegression_SaveModel.ipynb</span></strong></span><span><span class="kobospan" id="kobo.249.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.250.1">
# Persist the model in python Joblib file
# Retrieve the model weights and use it further prediction
import joblib
import numpy as np
from sklearn.linear_model import LinearRegression
X = np.array([[10, 10], [10, 20], [20, 20], [20, 30]])
# Assume that target feature has some relationship with the input features with the formula y = 3 * x_1 + 5 * x2 + 50
y = np.dot(X, np.array([3, 5])) + 50# Run the model with the input data and output values
reg = LinearRegression().fit(X, y)
# Persist the model in python Joblib file
filename = "sample_model.sav"
joblib.dump(reg, filename)
# regression model which is used earlier 
# Share this file alone to others for deploying in to production and for inferencing/predictions</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.251.1">Once the model is persisted in a file system or a file, then the file can be shared with other developers or engineers without sharing any of the training data or model details used in the code. </span><span class="kobospan" id="kobo.251.2">Other developers/engineers can then load this file and use it for further predictions or deploy it in production for production usage. </span><span class="kobospan" id="kobo.251.3">This is explained in </span><span><em class="italic"><span class="kobospan" id="kobo.252.1">Figure 2</span></em></span><em class="italic"><span class="kobospan" id="kobo.253.1">.1</span></em><span class="kobospan" id="kobo.254.1">. </span><span class="kobospan" id="kobo.254.2">This model is saved in the</span><a id="_idIndexMarker087" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.255.1"> current directory and has the name </span><strong class="source-inline"><span class="kobospan" id="kobo.256.1">sample_model.sav</span></strong><span class="kobospan" id="kobo.257.1">; you </span><a id="_idIndexMarker088" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.258.1">can make use of any extension as it doesn‚Äôt matter which extension is used. </span><span class="kobospan" id="kobo.258.2">The source code is </span><span><span class="kobospan" id="kobo.259.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.260.1">Linear_Regression_Load_Model.ipynb</span></strong></span><span><span class="kobospan" id="kobo.261.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.262.1">
import joblib
import numpy as np
filename = "sample_model.sav"
# Load the model from disk
loaded_model = joblib.load(filename)
result = loaded_model.predict(np.array([[30, 50]]))
print(result)
Output: [390.]</span></pre>
<h3 class="calibre9"><span class="kobospan" id="kobo.263.1">Classification</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.264.1">A classification model employs different algorithms to predict an output or dependent variable based on the relationship between the input variables. </span><span class="kobospan" id="kobo.264.2">Classification algorithms are specifically designed to </span><a id="_idIndexMarker089" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.265.1">predict discrete values, such as spam/not spam, male/female, yes/no, and</span><a id="_idIndexMarker090" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.266.1"> so on. </span><span class="kobospan" id="kobo.266.2">Each of these predicted values is referred to as a label </span><span><span class="kobospan" id="kobo.267.1">or class.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.268.1">In binary classification scenarios, there are only two possible class labels, e.g., determining whether an email is spam or not spam. </span><span class="kobospan" id="kobo.268.2">On the other hand, multi-label classification involves predicting multiple class labels simultaneously. </span><span class="kobospan" id="kobo.268.3">An example could be classifying images into various categories such as cat, dog, </span><span><span class="kobospan" id="kobo.269.1">and bird.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.270.1">Classification models are trained using historical data that contains both the input variables and their corresponding class labels. </span><span class="kobospan" id="kobo.270.2">The algorithms learn from this labeled data and establish patterns and relationships to make accurate predictions on new, unseen data. </span><span class="kobospan" id="kobo.270.3">The performance of a classification model is evaluated based on metrics such as accuracy, precision, recall, and F1 score. </span><span class="kobospan" id="kobo.270.4">These metrics assess how well the model can correctly assign the appropriate class labels to new instances based on their </span><span><span class="kobospan" id="kobo.271.1">input features.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.272.1">Classification models find extensive applications in various domains, including spam filtering, sentiment analysis, customer churn prediction, fraud detection, and medical diagnosis. </span><span class="kobospan" id="kobo.272.2">By leveraging different classification algorithms, valuable insights can be gained from data, enabling</span><a id="_idIndexMarker091" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.273.1"> informed decision-making and </span><span><span class="kobospan" id="kobo.274.1">efficient problem-solving.</span></span></p>
<table class="no-table-style" id="table004-1">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.275.1">Classification type</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.276.1">Details</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.277.1">Examples</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.278.1">Algorithms</span></strong></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.279.1">Binary</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.280.1">Predicts one of two classes based on the </span><span><span class="kobospan" id="kobo.281.1">training data</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.282.1">Yes/no</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.283.1">Spam/not spam</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.284.1">Pass/fail</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.285.1">Cancer/no cancer</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.286.1">Logistic regression</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.287.1">K-nearest neighbors</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.288.1">Decision trees</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.289.1">Support </span><span><span class="kobospan" id="kobo.290.1">vector machine</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.291.1">Naive Bayes</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.292.1">Multi-class</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.293.1">Predicts one of more than </span><span><span class="kobospan" id="kobo.294.1">two classes</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.295.1">Based on symptoms, e.g., cold, flu, </span><span><span class="kobospan" id="kobo.296.1">or COVID-19</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.297.1">K-nearest neighbors</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.298.1">Decision trees</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.299.1">Naive Bayes</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.300.1">Random forest</span></span></p>
<p class="calibre3"><span><span class="kobospan" id="kobo.301.1">Gradient boosting</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.302.1">Multi-label</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.303.1">Has two or more </span><span><span class="kobospan" id="kobo.304.1">class labels</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.305.1">Prediction of the topic based on the content: finance, politics, science, language, or all </span><span><span class="kobospan" id="kobo.306.1">of them</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.307.1">Multi-label </span><span><span class="kobospan" id="kobo.308.1">decision trees</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.309.1">Multi-label </span><span><span class="kobospan" id="kobo.310.1">random forests</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.311.1">Multi-label </span><span><span class="kobospan" id="kobo.312.1">gradient boosting</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.313.1">Extreme</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.314.1">Classification task in which the number of candidate labels </span><span><span class="kobospan" id="kobo.315.1">is huge</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.316.1">Amazon 3M dataset, where the number of labels </span><span><span class="kobospan" id="kobo.317.1">is 2,812,281</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.318.1">DL algorithms</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.319.1">More </span><span><span class="kobospan" id="kobo.320.1">algorithms: </span></span><a href="http://manikvarma.org/downloads/XC/XMLRepository.html" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.321.1">http://manikvarma.org/downloads/XC/XMLRepository.html</span></span></a></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.322.1">Table 2.4 ‚Äì Classification types and associated algorithms</span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.323.1">Classification example</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.324.1">In this example, we will utilize</span><a id="_idIndexMarker092" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.325.1"> the decision tree classification algorithm to determine the likelihood of a patient‚Äôs survival based on two features: age and whether they have a pre-existing </span><span><span class="kobospan" id="kobo.326.1">cancer condition.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.327.1">The decision tree classification algorithm is a widely used technique in ML that constructs a tree-like model of decisions. </span><span class="kobospan" id="kobo.327.2">It analyzes the provided data to create a structure that represents the </span><span><span class="kobospan" id="kobo.328.1">decision-making process.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.329.1">In our scenario, the age of the patient and their cancer status will be used as input features for classification. </span><span class="kobospan" id="kobo.329.2">By examining a labeled dataset consisting of patient information, including age, cancer status, and survival outcome, the algorithm learns patterns and establishes </span><span><span class="kobospan" id="kobo.330.1">decision rules.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.331.1">Once the model is trained, it becomes capable of predicting the survival outcome for new patients who have not been previously encountered. </span><span class="kobospan" id="kobo.331.2">By considering the age and cancer status of these patients, the model traverses the decision tree until reaching a leaf node that signifies the predicted outcome: whether the patient is expected to survive </span><span><span class="kobospan" id="kobo.332.1">or not.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.333.1">By employing the decision tree classification algorithm in this example, we aim to classify patients‚Äô survival probabilities based on their age and cancer status. </span><span class="kobospan" id="kobo.333.2">This valuable insight can aid medical professionals in assessing patient prognosis and informing </span><span><span class="kobospan" id="kobo.334.1">treatment decisions.</span></span></p>
<table class="no-table-style" id="table005">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.335.1">Age (years)</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.336.1">Has/had cancer (1 = yes, 0 = </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.337.1">no)</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.338.1">Survived (1 = yes, </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.339.1">0 =no)</span></strong></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.340.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.341.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.342.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.343.1">20</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.344.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.345.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.346.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.347.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.348.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.349.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.350.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.351.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.352.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.353.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.354.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.355.1">78</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.356.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.357.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.358.1">35</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.359.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.360.1">?? </span><span class="kobospan" id="kobo.360.2">(</span><span><span class="kobospan" id="kobo.361.1">predict)</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.362.1">78</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.363.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.364.1">?? </span><span class="kobospan" id="kobo.364.2">(</span><span><span class="kobospan" id="kobo.365.1">predict)</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.366.1">Table 2.5 ‚Äì Toy dataset for classification example</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.367.1">In this toy dataset, the model needs to predict whether the last two patients survive or not (classification with two labels) based on the trained historical data of </span><span><span class="kobospan" id="kobo.368.1">the model.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.369.1">The source code is </span><span><span class="kobospan" id="kobo.370.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.371.1">Classification_Example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.372.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.373.1">Scikit-learn provides </span><a id="_idIndexMarker093" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.374.1">various Python classes for classification algorithms. </span><span class="kobospan" id="kobo.374.2">Since we have chosen the decision tree algorithm for this example, import the necessary classes and prepare the data in a format that the </span><span><span class="kobospan" id="kobo.375.1">model accepts:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.376.1">
from sklearn import tree
X = [[10,1],[20,1],[30,1],[80,1],[75,0],[78,0]]
Y = [1,1,1,0,0,0]
clf = tree.DecisionTreeClassifier()
clf = clf.fit(X, Y)
clf.predict([[35,1]])
Output: array([1])
clf.predict([[78,1]])
Output: array([0])</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.377.1">In this case, the model predicted that the 35-year-old patient would survive but the 78-year-old patient would not survive based on the training </span><span><span class="kobospan" id="kobo.378.1">data provided.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.379.1">To understand more about decision trees and how the trees are split, let‚Äôs look at the following line </span><span><span class="kobospan" id="kobo.380.1">of code:</span></span></p>
<pre class="source-code">
<strong class="source-inline2"><span class="kobospan1" id="kobo.381.1">tree.plot_tree(clf)</span></strong></pre>
<p class="calibre3"><span class="kobospan" id="kobo.382.1">This will plot the tree </span><a id="_idIndexMarker094" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.383.1">based on the input features and how the tree is split. </span><span class="kobospan" id="kobo.383.2">This is useful when more features are in the training data and we need to know which feature has </span><span><span class="kobospan" id="kobo.384.1">more importance:</span></span></p>
<pre class="console"><span class="kobospan1" id="kobo.385.1">
[Text(167.4, 163.07999999999998, ‚ÄòX[0] &lt;= 52.5\ngini = 0.5\nsamples = 6\nvalue = [3, 3]‚Äô),
 Text(83.7, 54.360000000000014, ‚Äògini = 0.0\nsamples = 3\nvalue = [0, 3]‚Äô),
 Text(251.10000000000002, 54.360000000000014, ‚Äògini = 0.0\nsamples = 3\nvalue = [3, 0]‚Äô)]</span></pre>
<div class="calibre2">
<div class="img---figure" id="_idContainer021">
<span class="kobospan" id="kobo.386.1"><img alt="Figure 2.2 - Visualizing tree splitting" src="image/B16573_02_02.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.387.1">Figure 2.2 - Visualizing tree splitting</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.388.1">Once the model is trained and tested, it can be persisted in a file system or directly used </span><span><span class="kobospan" id="kobo.389.1">for production.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.390.1">In the last example, we persisted the model in the </span><span><span class="kobospan" id="kobo.391.1">Joblib format.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.392.1">Let‚Äôs now try to persist the model with the ONNX format to learn more </span><span><span class="kobospan" id="kobo.393.1">about it.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.394.1">Model persistence using the ONNX format and executing the model</span></h4>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.395.1">ONNX</span></strong><span class="kobospan" id="kobo.396.1">, short for </span><strong class="bold"><span class="kobospan" id="kobo.397.1">Open Neural Network Exchange</span></strong><span class="kobospan" id="kobo.398.1">, is an open source format designed for ML and DL models. </span><span class="kobospan" id="kobo.398.2">Its purpose is </span><a id="_idIndexMarker095" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.399.1">to facilitate the interoperability of models across different frameworks. </span><span class="kobospan" id="kobo.399.2">It accomplishes this by providing an extensible computation graph model and defining a </span><a id="_idIndexMarker096" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.400.1">set of built-in operators and standard </span><span><span class="kobospan" id="kobo.401.1">data types.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.402.1">With ONNX, ML/DL models can be </span><a id="_idIndexMarker097" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.403.1">easily converted to the ONNX format, allowing for seamless deployment, export, loading, and execution using ONNX Runtime. </span><span class="kobospan" id="kobo.403.2">ONNX Runtime is a powerful tool that enables high-performance execution of ML models on either CPU or GPU. </span><span class="kobospan" id="kobo.403.3">Importantly, it does not rely on dependencies on the specific training framework used to develop the models. </span><span class="kobospan" id="kobo.403.4">By leveraging ONNX and ONNX Runtime, developers can ensure that their models are portable across various frameworks and can be efficiently executed. </span><span class="kobospan" id="kobo.403.5">More details about ONNX can be found </span><span><span class="kobospan" id="kobo.404.1">at </span></span><a href="https://github.com/onnx/onnx" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.405.1">https://github.com/onnx/onnx</span></span></a><span><span class="kobospan" id="kobo.406.1">.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.407.1">Converting the sklearn sample model to the ONNX format</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.408.1">Converting the model to ONNX format</span><a id="_idIndexMarker098" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.409.1"> requires the frameworks </span><strong class="source-inline"><span class="kobospan" id="kobo.410.1">onnx</span></strong><span class="kobospan" id="kobo.411.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.412.1">onnxruntime</span></strong><span class="kobospan" id="kobo.413.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.414.1">skl2onnx</span></strong><span class="kobospan" id="kobo.415.1"> for scikit-learn. </span><span class="kobospan" id="kobo.415.2">Install the frameworks in the </span><span><span class="kobospan" id="kobo.416.1">following maner:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.417.1">
pip3 install onnx --user
pip3 install onnxruntime --user
pip3 install skl2onnx --user</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.418.1">Once the frameworks are installed, execute the following code to convert the model to ONNX format (the source code is </span><span><span class="kobospan" id="kobo.419.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.420.1">Model_Persistence_Load_ONNX_Format.ipynb</span></strong></span><span><span class="kobospan" id="kobo.421.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.422.1">
import numpy as np
from sklearn.linear_model import LinearRegression
from skl2onnx import convert_sklearn
from skl2onnx.common.data_types import FloatTensorType
initial_type = [('float_input', FloatTensorType([None, 2]))]
onx = convert_sklearn(clf, initial_types=initial_type)
with open("survive.onnx", "wb") as f:
¬†¬†¬†¬†f.write(onx.SerializeToString())</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.423.1">In this case, to convert the ML model that was developed using </span><strong class="source-inline"><span class="kobospan" id="kobo.424.1">sklearn</span></strong><span class="kobospan" id="kobo.425.1"> to ONNX format, first, the data types</span><a id="_idIndexMarker099" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.426.1"> used in the training need to </span><span><span class="kobospan" id="kobo.427.1">be provided:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.428.1">
initial_type = [(‚Äòfloat_input‚Äô, FloatTensorType([None, 2]))]</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.429.1">Later, use the methods provided to convert the model to ONNX format and specify the classifier that is used in </span><strong class="source-inline"><span class="kobospan" id="kobo.430.1">sklearn</span></strong><span class="kobospan" id="kobo.431.1">. </span><span class="kobospan" id="kobo.431.2">In our examples, we have used decision trees and named the </span><span><span class="kobospan" id="kobo.432.1">model </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.433.1">clf</span></strong></span><span><span class="kobospan" id="kobo.434.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.435.1">
onx = convert_sklearn(clf, initial_types=initial_type)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.436.1">Once the model is converted to ONNX format, store it in the disk and name the model file (in our </span><span><span class="kobospan" id="kobo.437.1">example, </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.438.1">survive.onnx</span></strong></span><span><span class="kobospan" id="kobo.439.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.440.1">
with open(‚Äúsurvive.onnx‚Äù, ‚Äúwb‚Äù) as f:
¬†¬†¬†¬†f.write(onx.SerializeToString())</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.441.1">Now the model is stored in ONNX format and it can be loaded and executed on any framework that supports </span><span><span class="kobospan" id="kobo.442.1">ONNX Runtime.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.443.1">Loading the ML model using ONNX format and executing the model</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.444.1">The following lines of code show how to </span><a id="_idIndexMarker100" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.445.1">load the model stored in ONNX format and how to use the model for inference. </span><span class="kobospan" id="kobo.445.2">ONNX version 1.14.1 is used in this code (the source code is </span><span><span class="kobospan" id="kobo.446.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.447.1">Model_Persistence_Load_ONNX_Format.ipynb</span></strong></span><span><span class="kobospan" id="kobo.448.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.449.1">
import onnxruntime as rt
import numpy as np
sess = rt.InferenceSession("survive.onnx")
input_name = sess.get_inputs()[0].name
# To test whether the patient will survive or not with 78 years age and doesn‚Äôt have prior cancer
X_test = np.array([[78.0, 0.0]])
pred_onx = sess.run(None, {input_name: X_test.astype(np.float32)})[0]
print(pred_onx)
Output: [0]</span></pre>
<h2 id="_idParaDest-42" class="calibre7"><a id="_idTextAnchor041" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.450.1">Unsupervised ML</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.451.1">In unsupervised ML, the </span><a id="_idIndexMarker101" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.452.1">model is trained using unlabeled training data, which means there are no target labels or classes provided. </span><span class="kobospan" id="kobo.452.2">Instead, unsupervised ML models focus on understanding the inherent patterns and structures within the </span><a id="_idIndexMarker102" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.453.1">data. </span><span class="kobospan" id="kobo.453.2">Unlike supervised learning, where the model learns from labeled examples, unsupervised machine learning models uncover hidden patterns and relationships within the data without any predefined class labels. </span><span class="kobospan" id="kobo.453.3">This allows for the discovery of previously unknown insights and patterns that may not be readily apparent. </span><span class="kobospan" id="kobo.453.4">By leveraging unsupervised ML techniques, analysts and data scientists can gain valuable insights from unlabeled data, uncover hidden structures, and make data-driven decisions based on the inherent patterns discovered in </span><span><span class="kobospan" id="kobo.454.1">the dataset.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.455.1">Clustering</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.456.1">Clustering is a primary technique used in unsupervised ML. </span><span class="kobospan" id="kobo.456.2">It involves grouping similar data points together based</span><a id="_idIndexMarker103" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.457.1"> on their intrinsic characteristics. </span><span class="kobospan" id="kobo.457.2">By examining the data and identifying similarities, unsupervised models create clusters, which represent distinct groups or patterns within </span><span><span class="kobospan" id="kobo.458.1">the dataset.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.459.1">Clustering algorithms, such as k-means clustering, hierarchical clustering, or density-based clustering, are commonly employed in unsupervised ML to organize data into meaningful groups. </span><span class="kobospan" id="kobo.459.2">These clusters can help in data exploration, anomaly detection, customer segmentation, and other </span><span><span class="kobospan" id="kobo.460.1">data-driven tasks.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.461.1">Clustering example</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.462.1">Let‚Äôs consider a scenario where a company aims to offer transportation services to its employees and wants to cluster them based on their residential locations. </span><span class="kobospan" id="kobo.462.2">To achieve this, the company can utilize a clustering model that takes the longitude and latitude coordinates of each employee‚Äôs residence as input data. </span><span class="kobospan" id="kobo.462.3">The ML model will cluster the employees based on the specified cluster size, which can be equal to the number of vehicles available for transportation. </span><span class="kobospan" id="kobo.462.4">By analyzing the spatial data of employees‚Äô locations, the clustering model will group individuals who live in close proximity to one another. </span><span class="kobospan" id="kobo.462.5">This grouping enables the company to efficiently allocate vehicles to </span><span><span class="kobospan" id="kobo.463.1">each cluster.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.464.1">Once the clustering model is trained and established, it can predict the appropriate cluster for new employees based on their residential coordinates. </span><span class="kobospan" id="kobo.464.2">This allows the company to easily determine </span><a id="_idIndexMarker104" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.465.1">which cluster the new employee should join, facilitating seamless </span><span><span class="kobospan" id="kobo.466.1">transportation arrangements.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.467.1">By utilizing ML clustering techniques in this scenario, the company can effectively organize its transportation services and optimize resource allocation based on employees‚Äô </span><span><span class="kobospan" id="kobo.468.1">residential locations.</span></span></p>
<table class="no-table-style" id="table006">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<thead class="calibre18">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.469.1">Employee number</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.470.1">Latitude (</span></strong><span><strong class="bold"><span class="kobospan" id="kobo.471.1">o N)</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.472.1">Longitude (</span></strong><span><strong class="bold"><span class="kobospan" id="kobo.473.1">o E)</span></strong></span></p>
</td>
</tr>
</thead>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.474.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.475.1">12.93</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.476.1">77.4472</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.477.1">2</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.478.1">12.32</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.479.1">77.4472</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.480.1">3</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.481.1">12.51</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.482.1">77.4472</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.483.1">4</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.484.1">12.62</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.485.1">77.4472</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.486.1">5</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.487.1">12.73</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.488.1">77.4472</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.489.1">6</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.490.1">12.84</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.491.1">76.4158</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.492.1">7</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.493.1">12.91</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.494.1">76.4158</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.495.1">8</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.496.1">12.41</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.497.1">76.4158</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.498.1">9</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.499.1">12.92</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.500.1">76.4158</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.501.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.502.1">12.55</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.503.1">76.4158</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.504.1">Table 2.6 ‚Äì Toy dataset for clustering example</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.505.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.506.1">sklearn</span></strong><span class="kobospan" id="kobo.507.1"> framework supports various clustering algorithms, and we will use the K-means clustering algorithm in this example to cluster the </span><span><span class="kobospan" id="kobo.508.1">given data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.509.1">The K-means algorithm is a centroid-based algorithm, where each cluster is associated with a centroid. </span><span class="kobospan" id="kobo.509.2">The main aim of this algorithm is to minimize the sum of distances between the input data point and their </span><span><span class="kobospan" id="kobo.510.1">corresponding cluster.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.511.1">The source code is </span><span><span class="kobospan" id="kobo.512.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.513.1">Clustering_Example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.514.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.515.1">Import the </span><strong class="source-inline"><span class="kobospan" id="kobo.516.1">sklearn</span></strong><span class="kobospan" id="kobo.517.1"> K-means </span><a id="_idIndexMarker105" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.518.1">clustering classes and prepare the training data as a </span><strong class="source-inline"><span class="kobospan" id="kobo.519.1">numpy</span></strong> <span><span class="kobospan" id="kobo.520.1">array format:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.521.1">
from sklearn.cluster import KMeans
import numpy as np
from sklearn.cluster import KMeans
import numpy as np
X = np.array([
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.93,77.4472],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.32,77.4472],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.51,77.4472],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.62,77.4472],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.73,77.4472],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.84,76.4158],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.91,76.4158],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.41,76.4158],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.92,76.4158],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†[12.55,76.4158],
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†])
kmeans = KMeans(n_clusters=2, random_state=0).fit(X)
kmeans.labels_
array([1, 1, 1, 1, 1, 0, 0, 0, 0, 0], dtype=int32)
¬†¬†¬†¬†¬†¬†kmeans.cluster_centers_
array([[12.726 , 76.4158],
¬†¬†¬†¬†¬†¬†¬†[12.622 , 77.4472]])
kmeans.predict([[12.88, 76.88]])
¬†¬†¬†¬†¬†¬†array([0], dtype=int32</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.522.1">In this </span><a id="_idIndexMarker106" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.523.1">case, the first five employees are assigned to cluster </span><strong class="source-inline"><span class="kobospan" id="kobo.524.1">1</span></strong><span class="kobospan" id="kobo.525.1"> and the remaining are assigned to </span><span><span class="kobospan" id="kobo.526.1">cluster </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.527.1">0</span></strong></span><span><span class="kobospan" id="kobo.528.1">:</span></span></p>
<table class="no-table-style" id="table007">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.529.1">Employee number</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.530.1">Latitude (</span><span><span class="superscript"><span class="kobospan1" id="kobo.531.1">o </span></span></span><span><span class="kobospan" id="kobo.532.1">N)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.533.1">Longitude (</span><span><span class="superscript"><span class="kobospan1" id="kobo.534.1">o</span></span></span><span><span class="kobospan" id="kobo.535.1"> E)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.536.1">Assigned cluster</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.537.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.538.1">12.93</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.539.1">77.4472</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.540.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.541.1">2</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.542.1">12.32</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.543.1">77.4472</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.544.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.545.1">3</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.546.1">12.51</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.547.1">77.4472</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.548.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.549.1">4</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.550.1">12.62</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.551.1">77.4472</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.552.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.553.1">5</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.554.1">12.73</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.555.1">77.4472</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.556.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.557.1">6</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.558.1">12.84</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.559.1">76.4158</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.560.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.561.1">7</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.562.1">12.91</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.563.1">76.4158</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.564.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.565.1">8</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.566.1">12.41</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.567.1">76.4158</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.568.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.569.1">9</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.570.1">12.92</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.571.1">76.4158</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.572.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.573.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.574.1">12.55</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.575.1">76.4158</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.576.1">0</span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.577.1">Table 2.7 - Assigned cluster</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.578.1">The cluster model learned based on the input and formed two clusters. </span><span class="kobospan" id="kobo.578.2">K-means is a clustering algorithm that </span><a id="_idIndexMarker107" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.579.1">finds the center of the cluster, divides the data into clusters, and predicts the new data based on the </span><span><span class="kobospan" id="kobo.580.1">nearest cluster.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.581.1">The following is the list of clustering algorithms supported by the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.582.1">sklearn</span></strong></span><span><span class="kobospan" id="kobo.583.1"> framework:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span><span class="kobospan" id="kobo.584.1">Affinity propagation</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.585.1">Agglomerative clustering</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.586.1">BIRCH</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.587.1">DBSCAN</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.588.1">K-means</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.589.1">Mini-batch K-means</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.590.1">Mean shift</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.591.1">OPTICS</span></span></li>
<li class="calibre11"><span><span class="kobospan" id="kobo.592.1">Spectral clustering</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.593.1">Mixture </span><span><span class="kobospan" id="kobo.594.1">of Gaussians</span></span></li>
</ul>
<h2 id="_idParaDest-43" class="calibre7"><a id="_idTextAnchor042" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.595.1">Reinforced ML</span></h2>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.596.1">Reinforcement learning</span></strong><span class="kobospan" id="kobo.597.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.598.1">RL</span></strong><span class="kobospan" id="kobo.599.1">) is a type of </span><a id="_idIndexMarker108" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.600.1">ML technique that enables an agent to learn in an interactive environment by trial and error using feedback from its own actions and experiences. </span><span class="kobospan" id="kobo.600.2">The agent</span><a id="_idIndexMarker109" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.601.1"> learns a series of actions that lead to the</span><a id="_idIndexMarker110" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.602.1"> final goal, maximizing its total rewards. </span><span class="kobospan" id="kobo.602.2">RL differs from supervised learning in that the model learns from taking actions and observing the results, not from </span><span><span class="kobospan" id="kobo.603.1">explicit teaching.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.604.1">One classic use case of RL is in gaming, such as teaching a model to play and excel at chess. </span><span class="kobospan" id="kobo.604.2">The model starts with no knowledge of the game but learns by making moves and seeing the outcome of the game it plays, with the aim of maximizing the reward (i.e., winning </span><span><span class="kobospan" id="kobo.605.1">the game).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.606.1">In the context of RL, exploration and exploitation are two strategies that an agent can use to navigate through </span><span><span class="kobospan" id="kobo.607.1">the environment:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.608.1">Exploration</span></strong><span class="kobospan" id="kobo.609.1">: This is when the agent seeks to learn more about its environment. </span><span class="kobospan" id="kobo.609.2">It means trying out different actions and gathering more information to learn about each possible action‚Äôs reward. </span><span class="kobospan" id="kobo.609.3">The agent aims to balance out the reward it gets from known</span><a id="_idIndexMarker111" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.610.1"> information with the possibility of receiving an even higher reward from unknown areas. </span><span class="kobospan" id="kobo.610.2">However, exploration might involve the risk of the agent making </span><span><span class="kobospan" id="kobo.611.1">non-optimal choices.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.612.1">Exploitation</span></strong><span class="kobospan" id="kobo.613.1">: Here, the agent uses the information it has already learned to make the best action that will </span><a id="_idIndexMarker112" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.614.1">maximize its reward. </span><span class="kobospan" id="kobo.614.2">It means using known information to maximize success instead of further exploring. </span><span class="kobospan" id="kobo.614.3">The benefit of exploitation is that it allows for more assured, immediate rewards, but excessive exploitation can lead to suboptimal results as it may neglect even better options. </span><span class="kobospan" id="kobo.614.4">The challenge lies in finding the right balance, as focusing too much on exploration might mean the agent will lose out on immediate rewards while focusing extensively on exploitation might prevent the agent from exploring options that could lead to larger rewards in the future. </span><span class="kobospan" id="kobo.614.5">This trade-off is often referred to as the </span><span><span class="kobospan" id="kobo.615.1">exploration‚Äìexploitation dilemma.</span></span></li>
</ul>
<h3 class="calibre9"><span class="kobospan" id="kobo.616.1">Example problem using RL‚Äîthe multi-armed bandit problem</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.617.1">The multi-armed bandit problem is a classic problem in the field of RL that captures the fundamental trade-off between exploration and exploitation. </span><span class="kobospan" id="kobo.617.2">The name is derived from a hypothetical experiment in which you</span><a id="_idIndexMarker113" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.618.1"> face several slot machines (also known as ‚Äúone-armed bandits‚Äù) with different fixed payouts. </span><span class="kobospan" id="kobo.618.2">Because of these differing payouts, your goal is to maximize your total payout over a certain number of attempts by figuring out which machines to play, how many times to play each machine, and in what sequence‚Äîhence, the ‚Äúmulti-armed </span><span><span class="kobospan" id="kobo.619.1">bandit problem.‚Äù</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.620.1">The primary challenge in the multi-armed bandit problem is balancing the immediate rewards from exploitative actions (playing the machine that you believe currently has the highest expected payout) with the possible benefits from exploration (trying out others that might have higher expected payouts but you‚Äôre less certain about). </span><span class="kobospan" id="kobo.620.2">This tension between exploration and exploitation is at the core of many reinforcement </span><span><span class="kobospan" id="kobo.621.1">learning problems.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.622.1">The following is example code for reinforcement learning‚Äîthe source code is </span><span><span class="kobospan" id="kobo.623.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.624.1">BandIt_RL_Example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.625.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.626.1">
import numpy as np
# This example will use a 4-armed bandit.
</span><span class="kobospan1" id="kobo.626.2"># Initialization
num_trials = 1000
bandit_probabilities = [0.1, 0.15, 0.3, 0.35]¬†¬†# The probability of each bandit to give reward
reward_counts = np.zeros(4)
selected_bandit = 0
for i in range(num_trials):
¬†¬†¬†¬†# Select a bandit
¬†¬†¬†¬†selected_bandit = np.random.randint(0, 4)
¬†¬†¬†¬†# Pull bandit‚Äôs arm
¬†¬†¬†¬†random_num = np.random.random()
¬†¬†¬†¬†if random_num &lt;= bandit_probabilities[selected_bandit]:
¬†¬†¬†¬†¬†¬†¬†¬†¬†reward = 1
¬†¬†¬†¬†else:
¬†¬†¬†¬†¬†¬†¬†¬†¬†reward = 0
¬†¬†¬†¬†reward_counts[selected_bandit] += reward
print(‚ÄúMost successful bandit:‚Äù, np.argmax(reward_counts))
Most successful bandit: 3</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.627.1">In this example, the </span><a id="_idIndexMarker114" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.628.1">epsilon-greedy strategy is used, where epsilon </span><span><span class="kobospan" id="kobo.629.1">is </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.630.1">1</span></strong></span><span><span class="kobospan" id="kobo.631.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.632.1">This is a very simplistic example and real-world RL problems require much more sophisticated algorithms (e.g., Q-learning, policy gradient, etc.) and are therefore implemented using </span><span><span class="kobospan" id="kobo.633.1">specialized libraries.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.634.1">In this section, we have </span><a id="_idIndexMarker115" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.635.1">covered the different types of ML and provided examples of how to save and load models for inference and prediction. </span><span class="kobospan" id="kobo.635.2">Moving forward, the next section will delve into the various phases of ML, providing a </span><span><span class="kobospan" id="kobo.636.1">detailed exploration.</span></span></p>
<h1 id="_idParaDest-44" class="calibre5"><a id="_idTextAnchor043" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.637.1">Overview of ML phases</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.638.1">ML encompasses a variety of techniques and approaches, and it involves several distinct phases or stages in the process of developing and deploying ML models. </span><span class="kobospan" id="kobo.638.2">These phases help guide engineers through the iterative and cyclical nature of ML projects, allowing them to build effective and </span><span><span class="kobospan" id="kobo.639.1">accurate models.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.640.1">The ML process typically consists of several key phases, each serving a specific purpose and contributing to the </span><a id="_idIndexMarker116" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.641.1">overall success of the project. </span><span class="kobospan" id="kobo.641.2">These phases are not always strictly linear, and iterations may occur between them to refine and improve the models. </span><span class="kobospan" id="kobo.641.3">The specific steps and terminology used may vary depending on the ML methodology employed, but the core phases </span><span><span class="kobospan" id="kobo.642.1">remain consistent.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.643.1">The ML phases provide a systematic framework for developing and deploying ML models, guiding practitioners through the complexities and challenges inherent in building effective solutions. </span><span class="kobospan" id="kobo.643.2">By following these phases, practitioners can maximize their chances of success and create ML models that deliver valuable insights and predictions in a wide range </span><span><span class="kobospan" id="kobo.644.1">of applications.</span></span></p>
<h2 id="_idParaDest-45" class="calibre7"><a id="_idTextAnchor044" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.645.1">The main phases of ML</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.646.1">The following are the main phases </span><span><span class="kobospan" id="kobo.647.1">of ML:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.648.1">Data collection</span></strong><span class="kobospan" id="kobo.649.1">: This phase involves gathering relevant data from various sources, such as databases, APIs, or </span><a id="_idIndexMarker117" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.650.1">manual collection. </span><span class="kobospan" id="kobo.650.2">The data should be representative of the problem domain and cover a wide range </span><span><span class="kobospan" id="kobo.651.1">of scenarios.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.652.1">Data preparation</span></strong><span class="kobospan" id="kobo.653.1">: In this phase, the </span><a id="_idIndexMarker118" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.654.1">collected data is preprocessed and transformed into a suitable format for analysis. </span><span class="kobospan" id="kobo.654.2">This may include tasks such as cleaning the data, handling missing values, removing outliers, and normalizing or scaling </span><span><span class="kobospan" id="kobo.655.1">the features.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.656.1">Feature engineering</span></strong><span class="kobospan" id="kobo.657.1">: Feature engineering involves selecting and creating relevant features from the available </span><a id="_idIndexMarker119" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.658.1">data that will enhance the model‚Äôs predictive power. </span><span class="kobospan" id="kobo.658.2">This phase requires domain knowledge and creativity to extract meaningful insights from </span><span><span class="kobospan" id="kobo.659.1">the data.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.660.1">Model development</span></strong><span class="kobospan" id="kobo.661.1">: In this phase, a</span><a id="_idIndexMarker120" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.662.1"> suitable ML algorithm or model is selected based on the problem at hand. </span><span class="kobospan" id="kobo.662.2">The model is trained on the prepared data to learn patterns and relationships within </span><span><span class="kobospan" id="kobo.663.1">the data.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.664.1">Model evaluation</span></strong><span class="kobospan" id="kobo.665.1">: The trained model is evaluated using appropriate evaluation metrics to assess its performance. </span><span class="kobospan" id="kobo.665.2">This </span><a id="_idIndexMarker121" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.666.1">helps in understanding how well the model generalizes to unseen data and whether it meets the desired criteria for accuracy </span><span><span class="kobospan" id="kobo.667.1">and reliability.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.668.1">Model optimization</span></strong><span class="kobospan" id="kobo.669.1">: If the model‚Äôs </span><a id="_idIndexMarker122" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.670.1">performance is not satisfactory, this phase involves fine-tuning the model by adjusting hyperparameters or trying different algorithms to improve its performance. </span><span class="kobospan" id="kobo.670.2">The optimization process aims to achieve the best </span><span><span class="kobospan" id="kobo.671.1">possible results.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.672.1">Model Deployment</span></strong><span class="kobospan" id="kobo.673.1">: Once the model is trained and optimized, it is deployed in a production environment</span><a id="_idIndexMarker123" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.674.1"> where it can make predictions on new, unseen data. </span><span class="kobospan" id="kobo.674.2">This phase involves integrating the model into existing systems or creating an interface for users to interact with </span><span><span class="kobospan" id="kobo.675.1">the model.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.676.1">Model monitoring and maintenance</span></strong><span class="kobospan" id="kobo.677.1">: After deployment, the model needs to be monitored to ensure it continues to perform well over time. </span><span class="kobospan" id="kobo.677.2">Monitoring involves tracking performance</span><a id="_idIndexMarker124" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.678.1"> metrics, identifying drift in data distribution, and updating the model if necessary. </span><span class="kobospan" id="kobo.678.2">Regular maintenance is essential to keeping the model up to date </span><span><span class="kobospan" id="kobo.679.1">and accurate.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.680.1">These phases provide a systematic approach to building and deploying ML models, enabling organizations to leverage the power of data and make </span><span><span class="kobospan" id="kobo.681.1">informed decisions.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.682.1">Sub-phases in the ML process</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.683.1">The following diagram shows the phases of the </span><span><span class="kobospan" id="kobo.684.1">ML process:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer022">
<span class="kobospan" id="kobo.685.1"><img alt="Figure 2.3 ‚Äì ML phases" src="image/B16573_02_03.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.686.1">Figure 2.3 ‚Äì ML phases</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.687.1">These are the </span><a id="_idIndexMarker125" class="pcalibre1 calibre6 pcalibre"/><span><span class="kobospan" id="kobo.688.1">main phases:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span class="kobospan" id="kobo.689.1">Data </span><span><span class="kobospan" id="kobo.690.1">preparation phase</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.691.1">ML model phase (design </span><span><span class="kobospan" id="kobo.692.1">and development)</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.693.1">ML </span><span><span class="kobospan" id="kobo.694.1">operations phase</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.695.1">Let‚Äôs look at these in </span><span><span class="kobospan" id="kobo.696.1">more detail.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.697.1">Data preparation phase</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.698.1">The data preparation phase</span><a id="_idIndexMarker126" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.699.1"> deals with data collection, extraction, </span><span><span class="kobospan" id="kobo.700.1">and manipulation.</span></span></p>
<table class="no-table-style" id="table008">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.701.1">Phase</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.702.1">Sub-phases</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.703.1">Details</span></strong></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2" rowspan="4">
<p class="calibre3">
</p>
<p class="calibre3"><span><span class="kobospan" id="kobo.704.1">Data preparation</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.705.1">Data collection</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.706.1">Identify the data that needs to </span><span><span class="kobospan" id="kobo.707.1">be analyzed</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.708.1">Data extraction</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.709.1">Extract the data from the </span><span><span class="kobospan" id="kobo.710.1">data source</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.711.1">Data manipulation</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.712.1">Data transformation, missing data, duplicate data, noise, and </span><span><span class="kobospan" id="kobo.713.1">data preprocessing</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.714.1">Exploratory data </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.715.1">analysis</span></strong></span><span><span class="kobospan" id="kobo.716.1"> (</span></span><span><strong class="bold"><span class="kobospan" id="kobo.717.1">EDA</span></strong></span><span><span class="kobospan" id="kobo.718.1">)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.719.1">EDA and </span><span><span class="kobospan" id="kobo.720.1">handling data</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.721.1">Table 2.8 - Data preparation phase</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.722.1">The following figure shows the data </span><span><span class="kobospan" id="kobo.723.1">preparation sub-phases:</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.724.1">Data Preparation Phase</span></h4>
<div class="calibre2">
<div class="img---figure" id="_idContainer023">
<span class="kobospan" id="kobo.725.1"><img alt="Figure 2.4 ‚Äì ML data preparation sub-phases" src="image/B16573_02_04.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.726.1">Figure 2.4 ‚Äì ML data preparation sub-phases</span></p>
</div>


<div id="_idContainer034" class="calibre2">
<h4 class="calibre17"><span class="kobospan" id="kobo.727.1">ML model phase</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.728.1">This phase is subdivided into several </span><a id="_idIndexMarker127" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.729.1">phases to deal with feature engineering, actual model identification, the training and testing of models, and </span><span><span class="kobospan" id="kobo.730.1">so on.</span></span></p>
<table class="no-table-style" id="table009">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.731.1">Phase</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.732.1">Sub-phases</span></strong></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><strong class="bold"><span class="kobospan" id="kobo.733.1">Details</span></strong></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2" rowspan="9">
<p class="calibre3"><span><span class="kobospan" id="kobo.734.1">ML model</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.735.1">Model identification</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.736.1">This involves classification, clustering, re-enforcement, time series analysis, and </span><span><span class="kobospan" id="kobo.737.1">so on.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.738.1">Feature engineering</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.739.1">In this phase, features are selected from </span><span><span class="kobospan" id="kobo.740.1">the data.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.741.1">Input data preparation for </span><span><span class="kobospan" id="kobo.742.1">the model</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.743.1">This involves data processed and data prepared in the format the </span><span><span class="kobospan" id="kobo.744.1">model expects.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.745.1">Split the data (train, test, </span><span><span class="kobospan" id="kobo.746.1">and validate)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.747.1">Split the entire data into three parts‚Äîtraining data, test data, and validation data‚Äîto train, test, and validate </span><span><span class="kobospan" id="kobo.748.1">the models.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.749.1">Train the model with the </span><span><span class="kobospan" id="kobo.750.1">training dataset</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.751.1">In this phase, the model is trained with the </span><span><span class="kobospan" id="kobo.752.1">training data.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.753.1">Test the model with the </span><span><span class="kobospan" id="kobo.754.1">testing dataset</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.755.1">The ML model is tested with the test data to find out the accuracy </span><span><span class="kobospan" id="kobo.756.1">of predictions.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.757.1">Version of data, model, model parameters, </span><span><span class="kobospan" id="kobo.758.1">and results</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.759.1">Version control is applied to datasets used, as well as to the model and its parameters, along with the results of </span><span><span class="kobospan" id="kobo.760.1">each experiment.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.761.1">Validate the dataset with the </span><span><span class="kobospan" id="kobo.762.1">trained model</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.763.1">This is</span><a id="_idIndexMarker128" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.764.1"> similar to test data but the samples are from the </span><span><span class="kobospan" id="kobo.765.1">validation dataset.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.766.1">Predict results with new </span><span><span class="kobospan" id="kobo.767.1">data (inference)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.768.1">For inference, use the new data and find out </span><span><span class="kobospan" id="kobo.769.1">the results.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.770.1">Table 2.9 - ML model phase</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.771.1">The following figure shows the ML </span><span><span class="kobospan" id="kobo.772.1">model sub-phases:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer024">
<span class="kobospan" id="kobo.773.1"><img alt="Figure 2.5 ‚Äì ML model sub-phases" src="image/B16573_02_05.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.774.1">Figure 2.5 ‚Äì ML model sub-phases</span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.775.1">ML operations phase</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.776.1">This phase is mainly focused </span><a id="_idIndexMarker129" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.777.1">on the operations of the models </span><span><span class="kobospan" id="kobo.778.1">in </span></span><span><a id="_idIndexMarker130" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.779.1">production.</span></span></p>
<table class="no-table-style" id="table010">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.780.1">Phase</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.781.1">Sub-phases</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.782.1">Details</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2" rowspan="5">
<p class="calibre3"><span><span class="kobospan" id="kobo.783.1">ML operations</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.784.1">(</span><span><span class="kobospan" id="kobo.785.1">MLOps)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.786.1">Package </span><span><span class="kobospan" id="kobo.787.1">model artifacts</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.788.1">Persist the model (store the weights and biases) in ONNX format or </span><span><span class="kobospan" id="kobo.789.1">other formats.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.790.1">Deploy model</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.791.1">This involves the production deployment of </span><span><span class="kobospan" id="kobo.792.1">the model.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.793.1">(A/B testing, canary deployment, shadow </span><span><span class="kobospan" id="kobo.794.1">models, etc.)</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.795.1">Validate the </span><span><span class="kobospan" id="kobo.796.1">inference results</span></span></p>
</td>
<td class="no-table-style2"/>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.797.1">Monitor </span><span><span class="kobospan" id="kobo.798.1">model performance</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.799.1">Monitor the performance model, i.e, whether the accuracy stays constant or degrades over </span><span><span class="kobospan" id="kobo.800.1">a period.</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.801.1">Retrain the model and repeat the ML model </span><a id="_idIndexMarker131" class="pcalibre1 calibre6 pcalibre"/><span><span class="kobospan" id="kobo.802.1">life cycle</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.803.1">Retrain the model if the model performance degrades and handle model drift and data </span><span><span class="kobospan" id="kobo.804.1">drift accordingly.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.805.1">Table 2.10 - ML operations</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.806.1">The following figure shows the ML </span><span><span class="kobospan" id="kobo.807.1">operations sub-phases:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer025">
<span class="kobospan" id="kobo.808.1"><img alt="Figure 2.6 ‚Äì ML operations sub-phases" src="image/B16573_02_06.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.809.1">Figure 2.6 ‚Äì ML operations sub-phases</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.810.1">We have thoroughly covered the development of ML models and the various phases involved in the process. </span><span class="kobospan" id="kobo.810.2">In the upcoming section, our focus will shift to exploring the privacy threats and attacks</span><a id="_idIndexMarker132" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.811.1"> that can occur in each phase of ML. </span><span class="kobospan" id="kobo.811.2">We will delve into understanding these threats and discuss effective mitigation strategies to safeguard the privacy of the data and models involved. </span><span class="kobospan" id="kobo.811.3">By addressing these privacy concerns at each stage, we can ensure the responsible and secure implementation of </span><span><span class="kobospan" id="kobo.812.1">ML techniques.</span></span></p>
<h1 id="_idParaDest-46" class="calibre5"><a id="_idTextAnchor045" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.813.1">Privacy threats/attacks in ML phases</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.814.1">ML projects are developed in</span><a id="_idIndexMarker133" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.815.1"> collaboration with data engineers, ML engineers, and software engineers, and each one plays a different role in order to develop end-to-end systems to predict and </span><span><span class="kobospan" id="kobo.816.1">provide insights.</span></span></p>
<h2 id="_idParaDest-47" class="calibre7"><a id="_idTextAnchor046" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.817.1">Collaborative roles in ML projects</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.818.1">ML projects are collaborative efforts involving various roles such as data engineers, ML engineers, and software engineers. </span><span class="kobospan" id="kobo.818.2">Each role contributes in different ways to develop end-to-end systems that can predict outcomes and provide valuable insights. </span><span class="kobospan" id="kobo.818.3">Let‚Äôs explore the roles and their responsibilities in the ML project </span><span><span class="kobospan" id="kobo.819.1">life cycle:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.820.1">Data engineer</span></strong><span class="kobospan" id="kobo.821.1">: The data engineer primarily focuses on the data preparation phase. </span><span class="kobospan" id="kobo.821.2">They are responsible for extracting data from one or multiple sources and ensuring its quality and </span><a id="_idIndexMarker134" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.822.1">suitability for the ML project. </span><span class="kobospan" id="kobo.822.2">Data engineers work on tasks such as data cleaning, transformation, and feature selection to prepare the data for </span><span><span class="kobospan" id="kobo.823.1">ML modeling.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.824.1">ML engineer</span></strong><span class="kobospan" id="kobo.825.1">: ML engineers play a crucial role in designing and developing ML models. </span><span class="kobospan" id="kobo.825.2">They leverage the data provided by the data engineer to train and test the models. </span><span class="kobospan" id="kobo.825.3">ML engineers are </span><a id="_idIndexMarker135" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.826.1">responsible for selecting appropriate algorithms or model architectures, tuning hyperparameters, and optimizing the models for accuracy and efficiency. </span><span class="kobospan" id="kobo.826.2">They validate the model against validation test data and provide APIs for inference or export/deployment of the model </span><span><span class="kobospan" id="kobo.827.1">into production.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.828.1">Model consumer</span></strong><span class="kobospan" id="kobo.829.1">: The model </span><a id="_idIndexMarker136" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.830.1">consumer can be an individual or another application that interacts with the ML model. </span><span class="kobospan" id="kobo.830.2">They make API calls and provide input to the model for prediction or inference. </span><span class="kobospan" id="kobo.830.3">Model consumers utilize the insights generated by the ML model to make informed decisions or take </span><span><span class="kobospan" id="kobo.831.1">appropriate actions.</span></span></li>
</ul>
<h2 id="_idParaDest-48" class="calibre7"><a id="_idTextAnchor047" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.832.1">Privacy threats/attacks in ML</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.833.1">In the context of ML, an adversary refers to an entity or system that actively tries to undermine or exploit the machine learning model or system. </span><span class="kobospan" id="kobo.833.2">The goal of an adversary is typically to manipulate the model‚Äôs </span><a id="_idIndexMarker137" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.834.1">behavior, gain unauthorized access to sensitive information, or deceive the system by </span><span><span class="kobospan" id="kobo.835.1">exploiting vulnerabilities.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.836.1">Adversaries can take various forms and have </span><span><span class="kobospan" id="kobo.837.1">different motives.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.838.1">Here are a </span><span><span class="kobospan" id="kobo.839.1">few examples:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.840.1">Adversarial examples</span></strong><span class="kobospan" id="kobo.841.1">: In this case, the </span><a id="_idIndexMarker138" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.842.1">adversary aims to create input samples (e.g., images or text) that are intentionally crafted to mislead or deceive the ML model. </span><span class="kobospan" id="kobo.842.2">Adversarial examples are designed to exploit vulnerabilities in the model‚Äôs decision-making process, leading to incorrect predictions </span><span><span class="kobospan" id="kobo.843.1">or misclassifications.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.844.1">Data poisoning</span></strong><span class="kobospan" id="kobo.845.1">: An adversary may try to inject malicious or misleading data into the training dataset. </span><span class="kobospan" id="kobo.845.2">By inserting </span><a id="_idIndexMarker139" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.846.1">carefully crafted samples, the adversary aims to manipulate the model‚Äôs training process, leading to biased or compromised results. </span><span class="kobospan" id="kobo.846.2">This can be particularly problematic in scenarios where the training data is collected from untrusted or </span><span><span class="kobospan" id="kobo.847.1">unreliable sources.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.848.1">Model inversion</span></strong><span class="kobospan" id="kobo.849.1">: An adversary might attempt to extract sensitive information from a trained model. </span><span class="kobospan" id="kobo.849.2">By providing</span><a id="_idIndexMarker140" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.850.1"> specific input and observing the model‚Äôs output, the adversary aims to infer confidential or private data that was used to train the model, such as </span><strong class="bold"><span class="kobospan" id="kobo.851.1">personally identifiable information</span></strong><span class="kobospan" id="kobo.852.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.853.1">PII</span></strong><span class="kobospan" id="kobo.854.1">) or</span><a id="_idIndexMarker141" class="pcalibre1 calibre6 pcalibre"/> <span><span class="kobospan" id="kobo.855.1">proprietary knowledge.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.856.1">Evasion attacks</span></strong><span class="kobospan" id="kobo.857.1">: Adversaries can</span><a id="_idIndexMarker142" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.858.1"> also launch evasion attacks, also known as adversarial attacks, during the</span><a id="_idIndexMarker143" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.859.1"> deployment phase. </span><span class="kobospan" id="kobo.859.2">In these attacks, the adversary tries to bypass or manipulate the model‚Äôs defenses by carefully modifying input samples. </span><span class="kobospan" id="kobo.859.3">For example, in the case of a spam email classifier, an adversary may add specific patterns or keywords to trick the model into classifying a malicious email </span><span><span class="kobospan" id="kobo.860.1">as legitimate.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.861.1">To mitigate the impact of adversaries, researchers and practitioners develop robust ML models and techniques, such as adversarial training, defensive distillation, and input sanitization. </span><span class="kobospan" id="kobo.861.2">These approaches aim to enhance the resilience of ML systems against adversarial attacks and maintain their performance and reliability in the presence of </span><span><span class="kobospan" id="kobo.862.1">potential threats.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.863.1">Throughout the ML life cycle, privacy threats or attacks can occur, posing risks to the confidentiality of sensitive information. </span><span class="kobospan" id="kobo.863.2">In the context of ML, adversaries attempt to gain unauthorized access to confidential data used in ML, the core ML model, or specific features of </span><span><span class="kobospan" id="kobo.864.1">the data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.865.1">There are two primary types of attacks, white-box </span><span><span class="kobospan" id="kobo.866.1">and black-box:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.867.1">White-box attack</span></strong><span class="kobospan" id="kobo.868.1">: A white-box attack assumes</span><a id="_idIndexMarker144" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.869.1"> that the adversary has full knowledge and access to the ML model, including its </span><a id="_idIndexMarker145" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.870.1">architecture, input, output, and weights. </span><span class="kobospan" id="kobo.870.2">The attacker exploits this information to extract </span><span><span class="kobospan" id="kobo.871.1">confidential details.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.872.1">Black-box attack</span></strong><span class="kobospan" id="kobo.873.1">: In contrast, a </span><a id="_idIndexMarker146" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.874.1">black-box attack assumes that the attacker only has access to the input and output of the ML model. </span><span class="kobospan" id="kobo.874.2">They have no knowledge of the underlying</span><a id="_idIndexMarker147" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.875.1"> architecture or weights used in the ML/DL model. </span><span class="kobospan" id="kobo.875.2">Despite the limited information, they aim to infer sensitive information from </span><span><span class="kobospan" id="kobo.876.1">the model.</span></span></li>
</ul>
<h3 class="calibre9"><span class="kobospan" id="kobo.877.1">Privacy threats/attacks classification:</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.878.1">The following are the privacy attacks on the ML models </span><span><span class="kobospan" id="kobo.879.1">for classification</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.880.1">Membership inference attack</span></strong><span class="kobospan" id="kobo.881.1">: This attack aims to determine whether a particular data point was part of the training dataset used to train the</span><a id="_idIndexMarker148" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.882.1"> ML model. </span><span class="kobospan" id="kobo.882.2">The adversary tries to infer membership information by exploiting the </span><span><span class="kobospan" id="kobo.883.1">model‚Äôs responses.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.884.1">Model extraction attack</span></strong><span class="kobospan" id="kobo.885.1">: In this attack, the</span><a id="_idIndexMarker149" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.886.1"> adversary attempts to extract the entire or partial ML model architecture, weights, or parameters. </span><span class="kobospan" id="kobo.886.2">This attack allows the attacker to replicate the ML model for their own purposes, potentially leading to intellectual </span><span><span class="kobospan" id="kobo.887.1">property theft.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.888.1">Reconstruction attack</span></strong><span class="kobospan" id="kobo.889.1">: This attack </span><a id="_idIndexMarker150" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.890.1">focuses on reconstructing sensitive information from the ML model‚Äôs outputs. </span><span class="kobospan" id="kobo.890.2">The attacker aims to infer private data or specific features that were used to generate the model‚Äôs predictions. </span><span class="kobospan" id="kobo.890.3">By understanding and addressing these privacy threats, ML practitioners can take appropriate measures to safeguard sensitive data and ensure the security of ML models throughout their </span><span><span class="kobospan" id="kobo.891.1">life cycle.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.892.1">We‚Äôll look at these in more detail in the </span><span><span class="kobospan" id="kobo.893.1">following sections.</span></span></p>
<h2 id="_idParaDest-49" class="calibre7"><a id="_idTextAnchor048" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.894.1">Membership inference attack</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.895.1">Assume a classification model is developed with certain input training data, X { x1, x2, x3, ‚Ä¶. </span><span class="kobospan" id="kobo.895.2">Xn} to predict certain labels, y, using a</span><a id="_idIndexMarker151" class="pcalibre1 calibre6 pcalibre"/> <span><span class="kobospan" id="kobo.896.1">function, F.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.897.1">A membership inference attack</span><a id="_idIndexMarker152" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.898.1"> tries to determine whether an input sample, x, was used as part of the training dataset, X, or not. </span><span class="kobospan" id="kobo.898.2">Basically, an adversary (attacker) needs to find out whether the data point at hand belongs to the original dataset that is used for training the ML model </span><span><span class="kobospan" id="kobo.899.1">or not.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer026">
<span class="kobospan" id="kobo.900.1"><img alt="Figure 2.7 ‚Äì Membership inference attack - Example" src="image/B16573_02_07.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.901.1">Figure 2.7 ‚Äì Membership inference attack - Example</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.902.1">(Image source: Suha Hussain, </span><span><span class="kobospan" id="kobo.903.1">PrivacyRaven, </span></span><a href="https://blog.openmined.org/privacyraven-comprehensive-privacy-testing-for-deep-learning/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.904.1">https://blog.openmined.org/privacyraven-comprehensive-privacy-testing-for-deep-learning/</span></span></a><span><span class="kobospan" id="kobo.905.1">)</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.906.1">Let‚Äôs look at an example. </span><span class="kobospan" id="kobo.906.2">Suppose an adversary wants to determine whether a particular person‚Äôs data was used in the training data or not without the knowledge of that person. </span><span class="kobospan" id="kobo.906.3">Later, this data is used</span><a id="_idIndexMarker153" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.907.1"> to derive insights on whether to approve that person‚Äôs insurance policy </span><span><span class="kobospan" id="kobo.908.1">or not.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.909.1">This is the most popular category of attacks and was first introduced by Shokri </span><span><span class="kobospan" id="kobo.910.1">et al.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.911.1">Here is the reference to the full paper: </span><em class="italic"><span class="kobospan" id="kobo.912.1">Reza Shokri, Marco Stronati, Congzheng Song, and Vitaly Shmatikov. </span><span class="kobospan" id="kobo.912.2">2017. </span><span class="kobospan" id="kobo.912.3">Membership inference attacks against machine learning models. </span><span class="kobospan" id="kobo.912.4">In 2017 IEEE Symposium on Security and Privacy (SP). </span><span class="kobospan" id="kobo.912.5">IEEE, San Francisco, CA, </span></em><span><em class="italic"><span class="kobospan" id="kobo.913.1">USA, 3‚Äì18.</span></em></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.914.1">This is a kind of black-box testing attack because the adversary doesn‚Äôt have the details of the actual ML model; all they have is the set of input data and inference results from </span><span><span class="kobospan" id="kobo.915.1">the model.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.916.1">This is what the paper says about </span><span><span class="kobospan" id="kobo.917.1">this approach:</span></span></p>
<p class="author-quote"><span class="kobospan" id="kobo.918.1">‚ÄúThe attacker queries the target model with a data record and obtains the model‚Äôs prediction on that record. </span><span class="kobospan" id="kobo.918.2">The prediction is a vector of probabilities, one per class, that the record belongs to a certain class. </span><span class="kobospan" id="kobo.918.3">This prediction vector, along with the label of the target record, is passed to the attack model, which determines whether the record was in or out of the target model‚Äôs training dataset.‚Äù</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.919.1">The following figure also comes from the aforementioned </span><a id="_idIndexMarker154" class="pcalibre1 calibre6 pcalibre"/><span><span class="kobospan" id="kobo.920.1">paper (</span></span><a href="https://arxiv.org/pdf/1610.05820.pdf" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.921.1">https://arxiv.org/pdf/1610.05820.pdf</span></span></a><span><span class="kobospan" id="kobo.922.1">):</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer027">
<span class="kobospan" id="kobo.923.1"><img alt="Figure 2.8 ‚Äì Membership inference attack - Example" src="image/B16573_02_08.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.924.1">Figure 2.8 ‚Äì Membership inference attack - Example</span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.925.1">Membership inference attack‚Äîbasic example</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.926.1">In a membership inference attack, an adversary attempts to determine whether a specific data point was used in</span><a id="_idIndexMarker155" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.927.1"> the training set of an ML model, as </span><span><span class="kobospan" id="kobo.928.1">stated earlier.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.929.1">Here‚Äôs an example using a simple decision tree classifier (the source code can be found </span><span><span class="kobospan" id="kobo.930.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.931.1">Membership_Inference_basic_example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.932.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.933.1">
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
# Load the dataset (e.g., Iris dataset)
iris = datasets.load_iris()
X = iris.data
y = iris.target
# Split the data into training and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.5, random_state=42)
# Train a decision tree classifier on the training set
clf = DecisionTreeClassifier()
clf.fit(X_train, y_train)
for i in range (0,75):
¬†¬†¬†¬†# Select a data point from the test set
¬†¬†¬†¬†target_data = X_test[i]
¬†¬†¬†¬†#Determine if the target data point was in the training set
¬†¬†¬†¬†predicted_class = clf.predict([target_data])
¬†¬†¬†¬†is_in_training_set = predicted_class == y_test[i]
¬†¬†¬†¬†# Print the result
¬†¬†¬†¬†if is_in_training_set:
¬†¬†¬†¬†¬†¬†¬†¬†print(target_data, "Membership Inference Attack successful! </span><span class="kobospan1" id="kobo.933.2">Target data point was in the training set.")
¬†¬†¬†¬†else:
¬†¬†¬†¬†¬†¬†¬†¬†print( target_data, "Membership Inference Attack unsuccessful. </span><span class="kobospan1" id="kobo.933.3">Target data point was not in the training set.")
Output:
[6.9 3.1 5.1 2.3] Membership Inference Attack successful! </span><span class="kobospan1" id="kobo.933.4">Target data point was in the training set.
</span><span class="kobospan1" id="kobo.933.5">[6.2 2.2 4.5 1.5] Membership Inference Attack unsuccessful. </span><span class="kobospan1" id="kobo.933.6">Target data point was not in the training set.</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.934.1">In this example, we load the </span><strong class="source-inline"><span class="kobospan" id="kobo.935.1">Iris</span></strong><span class="kobospan" id="kobo.936.1"> dataset from scikit-learn and split it into a training set and a test set. </span><span class="kobospan" id="kobo.936.2">We then train a decision tree classifier on the training set. </span><span class="kobospan" id="kobo.936.3">Next, we select a data point (or set of points) from the test set and attempt to determine whether it was present in the training </span><a id="_idIndexMarker156" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.937.1">set by predicting its class. </span><span class="kobospan" id="kobo.937.2">If the predicted class matches the actual class from the test set, we infer that the target data point was in the training set, indicating a successful attack. </span><span class="kobospan" id="kobo.937.3">Remember, conducting membership inference attacks without proper authorization is unethical and </span><span><span class="kobospan" id="kobo.938.1">often illegal.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.939.1">Membership inference attack‚Äîadvanced example</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.940.1">Let‚Äôs consider a scenario where an </span><a id="_idIndexMarker157" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.941.1">adversary seeks to determine whether a specific individual‚Äôs data is present in the training data without any</span><a id="_idIndexMarker158" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.942.1"> prior knowledge of that person. </span><span class="kobospan" id="kobo.942.2">This scenario involves discovering whether a person‚Äôs name exists within a hospital‚Äôs sensitive clinical data. </span><span class="kobospan" id="kobo.942.3">The adversary intends to exploit this information to make decisions, such as granting or denying an insurance policy, based on the </span><span><span class="kobospan" id="kobo.943.1">insights gained.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.944.1">To illustrate this scenario, let‚Äôs use a sample dataset (for illustrative purposes only) similar to the classification example we previously discussed. </span><span class="kobospan" id="kobo.944.2">The dataset focuses on predicting whether a patient will live for the next 5 to 10 years or not based on factors such as age and </span><span><span class="kobospan" id="kobo.945.1">existing diseases.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.946.1">In this context, the adversary‚Äôs goal is to identify whether the data related to a specific person, whose identity they are unaware of, is present in the training data. </span><span class="kobospan" id="kobo.946.2">By discovering this information, the adversary can potentially manipulate decisions related to insurance policies based on the insights gained from the </span><span><span class="kobospan" id="kobo.947.1">training data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.948.1">It is important to note that this example serves to highlight a potential privacy threat and does not aim to validate its accuracy or real-world applicability. </span><span class="kobospan" id="kobo.948.2">The objective is to raise awareness about the importance of safeguarding sensitive data and implementing robust privacy measures to prevent</span><a id="_idIndexMarker159" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.949.1"> unauthorized access </span><span><span class="kobospan" id="kobo.950.1">and misuse.</span></span></p>
<table class="no-table-style" id="table011">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.951.1">Age (years)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.952.1">Has/had cancer (1 = yes, 0 = </span><span><span class="kobospan" id="kobo.953.1">no)</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.954.1">Survived ( 1 = yes, 0 = </span><span><span class="kobospan" id="kobo.955.1">no)</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.956.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.957.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.958.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.959.1">20</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.960.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.961.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.962.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.963.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.964.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.965.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.966.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.967.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.968.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.969.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.970.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.971.1">78</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.972.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.973.1">0</span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.974.1">Table 2.11 - Training data</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.975.1">The source code for this</span><a id="_idIndexMarker160" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.976.1"> ML model can be found </span><span><span class="kobospan" id="kobo.977.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.978.1">Membership_Inference_advanced_example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.979.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.980.1">
from sklearn import tree
X = [[10,1],[20,1],[30,1],[80,1],[75,0],[78,0]]
Y = [1,1,1,0,0,0]
clf = tree.DecisionTreeClassifier()
clf = clf.fit(X, Y)
clf.predict([[35,1]])</span></pre>
<h4 class="calibre17"><span class="kobospan" id="kobo.981.1">Inference results with sample test data</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.982.1">The adversary creates </span><a id="_idIndexMarker161" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.983.1">synthetic test data with diverse inputs to evaluate the model‚Äôs performance. </span><span class="kobospan" id="kobo.983.2">Their objective is to determine whether the given patient data exists in the training dataset or not using the </span><span><span class="kobospan" id="kobo.984.1">model‚Äôs predictions:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.985.1">
testY=[
¬†¬†¬†¬†¬†¬†¬†[25,1],[25,0],[30,1],[30,0],[45,0],[45,1],
¬†¬†¬†¬†¬†¬†¬†[50,1],[50,0],[60,1],[60,0],[75,0],[75,1],
¬†¬†¬†¬†¬†¬†¬†[80,1],[80,0],[90,1],[90,0],[100,0],[100,1],
¬†¬†¬†¬†¬†¬†¬†[10,1],[20,1],[30,1],[78,0]
¬†¬†¬†¬†¬†¬†]
clf.predict(testY)
array([1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0])
clf.predict_proba(testY)
array([[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[0., 1.],
¬†¬†¬†¬†¬†¬†¬†[1., 0.]])</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.986.1">The results are in the table </span><a id="_idIndexMarker162" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.987.1">format; 1 means the person has cancer and the predicted probability column shows the percentage of </span><span><span class="kobospan" id="kobo.988.1">predicted probability:</span></span></p>
<table class="no-table-style" id="table012">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<thead class="calibre18">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.989.1">Age</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.990.1">Cancer</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.991.1">Class predicted</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.992.1">Predicted probability</span></span></p>
</td>
</tr>
</thead>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.993.1">25</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.994.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.995.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.996.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.997.1">25</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.998.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.999.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1000.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1001.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1002.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1003.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1004.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1005.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1006.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1007.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1008.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1009.1">45</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1010.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1011.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1012.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1013.1">45</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1014.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1015.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1016.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1017.1">50</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1018.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1019.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1020.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1021.1">50</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1022.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1023.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1024.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1025.1">60</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1026.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1027.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1028.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1029.1">60</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1030.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1031.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1032.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1033.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1034.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1035.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1036.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1037.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1038.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1039.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1040.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1041.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1042.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1043.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1044.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1045.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1046.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1047.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1048.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1049.1">90</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1050.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1051.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1052.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1053.1">90</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1054.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1055.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1056.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1057.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1058.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1059.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1060.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1061.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1062.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1063.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1064.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1065.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1066.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1067.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1068.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1069.1">20</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1070.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1071.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1072.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1073.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1074.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1075.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1076.1">100</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1077.1">78</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1078.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1079.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1080.1">0</span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1081.1">Table 2.12 - Predicted probability</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1082.1">Next, the adversary proceeds to develop shadow models and a final attack model. </span><span class="kobospan" id="kobo.1082.2">These models are designed to predict whether a given data record was used in the training dataset. </span><span class="kobospan" id="kobo.1082.3">By utilizing</span><a id="_idIndexMarker163" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1083.1"> each record and its predicted class, along with the corresponding predicted probabilities, the adversary infers whether the data record was part of the training set </span><span><span class="kobospan" id="kobo.1084.1">or not.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer028">
<span class="kobospan" id="kobo.1085.1"><img alt="Figure 2.9 ‚Äì Shadow models" src="image/B16573_02_09.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1086.1">Figure 2.9 ‚Äì Shadow models</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1087.1">The preceding figure </span><a id="_idIndexMarker164" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1088.1">was sourced from the paper </span><span><span class="kobospan" id="kobo.1089.1">at </span></span><a href="https://arxiv.org/pdf/1610.05820.pdf" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1090.1">https://arxiv.org/pdf/1610.05820.pdf</span></span></a><span><span class="kobospan" id="kobo.1091.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1092.1">The attacker model makes use of the class label 'In' for the given input record used in the training, while 'out' means it is </span><span><span class="kobospan" id="kobo.1093.1">not used.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1094.1">This is the training data for the final </span><span><span class="kobospan" id="kobo.1095.1">attack model:</span></span></p>
<table class="no-table-style" id="table013">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1096.1">Age</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1097.1">Cancer</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1098.1">Class predicted</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1099.1">Predicted probability</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1100.1">Record used in the training set (in = 1, out = </span><span><span class="kobospan" id="kobo.1101.1">0)</span></span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1102.1">25</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1103.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1104.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1105.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1106.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1107.1">25</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1108.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1109.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1110.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1111.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1112.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1113.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1114.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1115.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1116.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1117.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1118.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1119.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1120.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1121.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1122.1">45</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1123.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1124.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1125.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1126.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1127.1">45</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1128.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1129.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1130.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1131.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1132.1">50</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1133.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1134.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1135.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1136.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1137.1">50</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1138.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1139.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1140.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1141.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1142.1">10</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1143.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1144.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1145.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1146.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1147.1">20</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1148.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1149.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1150.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1151.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1152.1">30</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1153.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1154.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1155.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1156.1">1</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1157.1">60</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1158.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1159.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1160.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1161.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1162.1">60</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1163.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1164.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1165.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1166.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1167.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1168.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1169.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1170.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1171.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1172.1">75</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1173.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1174.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1175.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1176.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1177.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1178.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1179.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1180.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1181.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1182.1">80</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1183.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1184.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1185.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1186.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1187.1">90</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1188.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1189.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1190.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1191.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1192.1">90</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1193.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1194.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1195.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1196.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1197.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1198.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1199.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1200.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1201.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1202.1">100</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1203.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1204.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1205.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1206.1">0</span></p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><span><span class="kobospan" id="kobo.1207.1">78</span></span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1208.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1209.1">1</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1210.1">0</span></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><span class="kobospan" id="kobo.1211.1">0</span></p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1212.1">Table 2.13 - Training data for final attack model</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1213.1">Membership inference </span><a id="_idIndexMarker165" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1214.1">attacks can be easily executed with remarkable accuracy in simple linear models, as shown in the preceding example. </span><span class="kobospan" id="kobo.1214.2">ML models hosted in the cloud are susceptible to such inference attacks, as researchers have successfully demonstrated membership attack models with accuracies </span><span><span class="kobospan" id="kobo.1215.1">exceeding 90%.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1216.1">Techniques to mitigate membership inference attacks</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1217.1">Membership inference attacks can be a </span><a id="_idIndexMarker166" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1218.1">concern in ML models that involve </span><span><span class="kobospan" id="kobo.1219.1">sensitive data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1220.1">Some techniques to mitigate membership inference attacks are </span><span><span class="kobospan" id="kobo.1221.1">as follows:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1222.1">Limit access to sensitive information</span></strong><span class="kobospan" id="kobo.1223.1">: One of the simplest ways to mitigate membership inference attacks is to limit access to sensitive information. </span><span class="kobospan" id="kobo.1223.2">By minimizing the amount of sensitive data that is exposed, you reduce the potential for attackers to perform </span><span><span class="kobospan" id="kobo.1224.1">membership inference.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1225.1">Differential privacy</span></strong><span class="kobospan" id="kobo.1226.1">: Differential privacy is a technique that adds noise to the training data or the model‚Äôs output, making it harder for an attacker to determine whether a specific record was part of the training set. </span><span class="kobospan" id="kobo.1226.2">Applying differential privacy mechanisms can help protect against membership inference attacks. </span><span class="kobospan" id="kobo.1226.3">We will learn about differential privacy in the </span><span><span class="kobospan" id="kobo.1227.1">next chapter.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1228.1">Training set augmentation</span></strong><span class="kobospan" id="kobo.1229.1">: By augmenting the training set with additional synthetic or generated data, you can make it more difficult for attackers to distinguish between genuine training instances and potential members. </span><span class="kobospan" id="kobo.1229.2">Augmentation techniques such as data generation, perturbation, or adding noise can help to increase the privacy of the </span><span><span class="kobospan" id="kobo.1230.1">training set.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1231.1">Regularization and dropout</span></strong><span class="kobospan" id="kobo.1232.1">: Applying regularization techniques such as L1 or L2 regularization and incorporating dropout layers in neural networks can improve model robustness and reduce overfitting. </span><span class="kobospan" id="kobo.1232.2">Regularization can help in reducing the memorization of training instances, making it harder for attackers to </span><span><span class="kobospan" id="kobo.1233.1">infer membership.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1234.1">Model compression</span></strong><span class="kobospan" id="kobo.1235.1">: When sharing models or making predictions, consider using model compression techniques to reduce the amount of information leaked about the training data. </span><span class="kobospan" id="kobo.1235.2">Techniques such as quantization, pruning, or knowledge distillation can help reduce the model‚Äôs sensitivity to the </span><span><span class="kobospan" id="kobo.1236.1">training set.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1237.1">Ensemble methods</span></strong><span class="kobospan" id="kobo.1238.1">: Training an ensemble of multiple models with different architectures or using different algorithms can make it more difficult for attackers to perform accurate membership inference. </span><span class="kobospan" id="kobo.1238.2">Ensemble methods make it harder for an attacker to learn the specific patterns in the </span><span><span class="kobospan" id="kobo.1239.1">training data.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1240.1">Secure aggregation</span></strong><span class="kobospan" id="kobo.1241.1">: If the model is trained using a distributed setting, secure aggregation protocols can be employed to ensure that individual contributions from different parties are protected and the membership information is </span><span><span class="kobospan" id="kobo.1242.1">not exposed.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1243.1">Randomized response</span></strong><span class="kobospan" id="kobo.1244.1">: Randomized response techniques can be used to introduce noise into the model‚Äôs outputs during inference, making it harder for an attacker to determine membership status. </span><span class="kobospan" id="kobo.1244.2">Randomized response mechanisms ensure plausible deniability for </span><span><span class="kobospan" id="kobo.1245.1">individual records.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1246.1">Access control and authorization</span></strong><span class="kobospan" id="kobo.1247.1">: Implementing access control measures and strong authorization mechanisms can help restrict access to sensitive models and data, limiting the exposure to </span><span><span class="kobospan" id="kobo.1248.1">potential attackers.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1249.1">Model monitoring</span></strong><span class="kobospan" id="kobo.1250.1">: Continuously monitoring the model‚Äôs behavior for any unusual patterns or unexpected outputs can help detect potential membership inference attacks. </span><span class="kobospan" id="kobo.1250.2">Monitoring </span><a id="_idIndexMarker167" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1251.1">can involve techniques such as outlier detection, adversarial robustness checks, or statistical analysis of </span><span><span class="kobospan" id="kobo.1252.1">model outputs.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1253.1">It‚Äôs important to note that no single technique can provide complete protection against membership inference attacks. </span><span class="kobospan" id="kobo.1253.2">A combination of multiple techniques and a comprehensive approach to privacy and security is usually required to effectively mitigate </span><span><span class="kobospan" id="kobo.1254.1">these attacks.</span></span></p>
<h2 id="_idParaDest-50" class="calibre7"><a id="_idTextAnchor049" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1255.1">Model extraction attack</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1256.1">A model extraction attack is a type of black-box attack in which the adversary aims to extract information, and possibly recreate a model, by creating a substitute model (denoted as </span><em class="italic"><span class="kobospan" id="kobo.1257.1">ùëì</span></em><span class="kobospan" id="kobo.1258.1">‚Äô) that closely emulates</span><a id="_idIndexMarker168" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1259.1"> the behavior of the</span><a id="_idIndexMarker169" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1260.1"> original model being targeted (denoted </span><span><span class="kobospan" id="kobo.1261.1">as </span></span><span><em class="italic"><span class="kobospan" id="kobo.1262.1">ùëì</span></em></span><span><span class="kobospan" id="kobo.1263.1">).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1264.1">Let‚Äôs consider a scenario where we have developed an ML model specifically designed to predict whether a given post/tweet pertains to a disaster or not. </span><span class="kobospan" id="kobo.1264.2">We provide APIs to consumers, enabling them to access these prediction capabilities, and charge a fee for each API </span><span><span class="kobospan" id="kobo.1265.1">request made.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer029">
<span class="kobospan" id="kobo.1266.1"><img alt="Figure 2.10 - Securing ML Model Integrity" src="image/B16573_02_10.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1267.1">Figure 2.10 - Securing ML Model Integrity</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1268.1">The adversary takes advantage of the API provided and systematically submits thousands of input tweets in order to obtain their respective predictions. </span><span class="kobospan" id="kobo.1268.2">Subsequently, the adversary proceeds to construct a new ML model using these tweets, which were obtained by querying the API exposed by the original author. </span><span class="kobospan" id="kobo.1268.3">The predicted results obtained from the API serve as the class labels for this new model, indicating whether the tweets are classified as </span><a id="_idIndexMarker170" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1269.1">disaster-related </span><span><span class="kobospan" id="kobo.1270.1">or not.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer030">
<span class="kobospan" id="kobo.1271.1"><img alt="Figure 2.11 ‚Äì Model extraction attack‚Äîadversary ML model" src="image/B16573_02_11.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1272.1">Figure 2.11 ‚Äì Model extraction attack‚Äîadversary ML model</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1273.1">In certain instances, the ML model developed by the adversary may exhibit superior accuracy compared to the original author‚Äôs ML model. </span><span class="kobospan" id="kobo.1273.2">As a consequence, this can significantly affect the revenue of the original author‚Äôs company. </span><span class="kobospan" id="kobo.1273.3">The adversary may exploit this advantage by exposing similar inference APIs, charging substantially lower fees than the original author, and potentially engaging in the theft of intellectual property. </span><span class="kobospan" id="kobo.1273.4">Furthermore, the model extraction attack enables the adversary to gain access to private information associated with the ML model, further exacerbating the potential </span><span><span class="kobospan" id="kobo.1274.1">damages caused.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1275.1">Example of a model extraction attack</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1276.1">The source code for this</span><a id="_idIndexMarker171" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1277.1"> example can be found in </span><strong class="source-inline"><span class="kobospan" id="kobo.1278.1">Model </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.1279.1">Extraction_Attack Example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.1280.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1281.1">In this example, we start by creating a sample dataset that consists of two features (</span><em class="italic"><span class="kobospan" id="kobo.1282.1">X</span></em><span class="kobospan" id="kobo.1283.1">) and their corresponding labels (</span><em class="italic"><span class="kobospan" id="kobo.1284.1">y</span></em><span class="kobospan" id="kobo.1285.1">). </span><span class="kobospan" id="kobo.1285.2">Subsequently, we train a logistic regression model on this dataset using the </span><strong class="source-inline"><span class="kobospan" id="kobo.1286.1">LogisticRegression</span></strong><span class="kobospan" id="kobo.1287.1"> class </span><span><span class="kobospan" id="kobo.1288.1">from scikit-learn.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1289.1">The attacker‚Äôs code aims to execute a model extraction attack by training a new </span><strong class="source-inline"><span class="kobospan" id="kobo.1290.1">LogisticRegression</span></strong><span class="kobospan" id="kobo.1291.1"> model (</span><strong class="source-inline"><span class="kobospan" id="kobo.1292.1">extracted_model</span></strong><span class="kobospan" id="kobo.1293.1">) on the same dataset. </span><span class="kobospan" id="kobo.1293.2">The attacker‚Äôs objective is to replicate the original model‚Äôs behavior without having direct access to its </span><span><span class="kobospan" id="kobo.1294.1">internal workings.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1295.1">Once the extracted model is successfully generated, it can be utilized for unauthorized purposes, such as making predictions on new data (</span><strong class="source-inline"><span class="kobospan" id="kobo.1296.1">new_data</span></strong><span class="kobospan" id="kobo.1297.1">) without requiring access to the original </span><a id="_idIndexMarker172" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1298.1">model. </span><span class="kobospan" id="kobo.1298.2">This unauthorized usage raises concerns regarding the security and integrity of the original </span><span><span class="kobospan" id="kobo.1299.1">model‚Äôs functionality.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1300.1">The following is the source code for the model extraction attack (</span><strong class="source-inline"><span class="kobospan" id="kobo.1301.1">Model </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.1302.1">Extraction_Attack Example.ipynb</span></strong></span><span><span class="kobospan" id="kobo.1303.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1304.1">
import numpy as np
from sklearn.linear_model import LogisticRegression
# Create a sample dataset for demonstration
X = np.array([[1, 1], [2, 2], [3, 3], [4, 4], [5, 5]])
y = np.array([0, 0, 0, 1, 1])
# Train a simple logistic regression model on the dataset
model = LogisticRegression()
model.fit(X, y)
# Attacker's code to perform model extraction attack
extracted_model = LogisticRegression()
extracted_model.fit(X, y)
# Extracted model can be further used for unauthorized purposes
# such as making predictions on new data without access to the original model
new_data = np.array([[6, 6], [7, 7]])
predictions = extracted_model.predict(new_data)
print(predictions)
[1 1]</span></pre>
<h4 class="calibre17"><span class="kobospan" id="kobo.1305.1">Techniques to mitigate model extraction attacks</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1306.1">Mitigating model extraction </span><a id="_idIndexMarker173" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1307.1">attacks, where an adversary tries to extract the underlying model‚Äôs architecture, parameters, or functionality, is crucial for protecting intellectual property and maintaining the security of </span><span><span class="kobospan" id="kobo.1308.1">sensitive models.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1309.1">Some of the techniques to mitigate model extraction attacks are </span><span><span class="kobospan" id="kobo.1310.1">as follows:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1311.1">Model watermarking</span></strong><span class="kobospan" id="kobo.1312.1">: Embedding a unique watermark into the model‚Äôs parameters or architecture can help identify the origin of the model and deter unauthorized extraction. </span><span class="kobospan" id="kobo.1312.2">Watermarking techniques can be designed to be resilient against removal attempts or modifications while remaining imperceptible to normal </span><span><span class="kobospan" id="kobo.1313.1">model operations.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1314.1">Model obfuscation</span></strong><span class="kobospan" id="kobo.1315.1">: Applying obfuscation techniques to the model‚Äôs code or architecture can make it harder for attackers to understand the internal workings of the model. </span><span class="kobospan" id="kobo.1315.2">Obfuscation can involve techniques such as code obfuscation, function renaming, control flow</span><a id="_idIndexMarker174" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1316.1"> diversification, or encryption to protect the model‚Äôs </span><span><span class="kobospan" id="kobo.1317.1">implementation details.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1318.1">Secure model sharing</span></strong><span class="kobospan" id="kobo.1319.1">: When sharing models with authorized users or collaborators, it‚Äôs important to employ secure sharing mechanisms. </span><span class="kobospan" id="kobo.1319.2">This can involve encryption during transit and at rest, strong access control measures, and secure authentication and authorization protocols to prevent unauthorized access to </span><span><span class="kobospan" id="kobo.1320.1">the model.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1321.1">Model compression</span></strong><span class="kobospan" id="kobo.1322.1">: Using model compression techniques such as quantization, pruning, or knowledge distillation can make the model more compact and reduce the amount of information that can be extracted. </span><span class="kobospan" id="kobo.1322.2">Compressed models often have fewer parameters and structural details, making them more resistant to model </span><span><span class="kobospan" id="kobo.1323.1">extraction attacks.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1324.1">Fine-grained access control</span></strong><span class="kobospan" id="kobo.1325.1">: Implementing fine-grained access control mechanisms can limit the exposure of sensitive models. </span><span class="kobospan" id="kobo.1325.2">This can involve providing access to only the necessary components or functionalities of the model based on user roles </span><span><span class="kobospan" id="kobo.1326.1">and permissions.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1327.1">Secure execution environment</span></strong><span class="kobospan" id="kobo.1328.1">: Running the model in a secure execution environment can help protect against extraction attacks. </span><span class="kobospan" id="kobo.1328.2">Techniques such as secure enclaves (e.g., Intel SGX or </span><a id="_idIndexMarker175" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1329.1">AMD SEV), </span><strong class="bold"><span class="kobospan" id="kobo.1330.1">trusted execution environments</span></strong><span class="kobospan" id="kobo.1331.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1332.1">TEEs</span></strong><span class="kobospan" id="kobo.1333.1">), and </span><strong class="bold"><span class="kobospan" id="kobo.1334.1">secure multiparty computation</span></strong><span class="kobospan" id="kobo.1335.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1336.1">MPC</span></strong><span class="kobospan" id="kobo.1337.1">) can provide isolation </span><a id="_idIndexMarker176" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1338.1">and integrity guarantees for executing models, preventing unauthorized access to the model‚Äôs internals. </span><span class="kobospan" id="kobo.1338.2">We will learn more about TEE in </span><a href="B16573_09.xhtml#_idTextAnchor204" class="pcalibre1 calibre6 pcalibre"><span><em class="italic"><span class="kobospan" id="kobo.1339.1">Chapter 9</span></em></span></a><span><span class="kobospan" id="kobo.1340.1">.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1341.1">Model metadata protection</span></strong><span class="kobospan" id="kobo.1342.1">: Protecting the metadata associated with the model, such as the training data, hyperparameters, or training process details, can make it harder for attackers to extract meaningful information about the model. </span><span class="kobospan" id="kobo.1342.2">Techniques such as differential privacy or data perturbation can help preserve privacy in </span><span><span class="kobospan" id="kobo.1343.1">model metadata.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1344.1">Monitoring for abnormal model usage</span></strong><span class="kobospan" id="kobo.1345.1">: Implementing model monitoring and anomaly detection mechanisms can help identify suspicious activities, such as repeated queries or excessive model interactions, which could indicate unauthorized extraction attempts. </span><span class="kobospan" id="kobo.1345.2">Monitoring can trigger alerts or initiate defensive actions when potential attacks </span><span><span class="kobospan" id="kobo.1346.1">are detected.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1347.1">Legal and licensing measures</span></strong><span class="kobospan" id="kobo.1348.1">: Implementing legal protections, such as copyright, patent, or licensing agreements, can provide additional legal recourse and deter unauthorized </span><a id="_idIndexMarker177" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1349.1">model extraction </span><span><span class="kobospan" id="kobo.1350.1">and usage.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1351.1">As we discussed with the membership inference attack, it‚Äôs important to note that no single technique can provide complete protection against model extraction attacks; a combination of multiple techniques is usually required. </span><span class="kobospan" id="kobo.1351.2">The choice of mitigation techniques depends on the specific threat model, the sensitivity of the model, and the desired level </span><span><span class="kobospan" id="kobo.1352.1">of protection.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1353.1">We have learned about membership inference attacks and model extraction attacks on ML models. </span><span class="kobospan" id="kobo.1353.2">Let‚Äôs now explore the third type of privacy attack on ML models: the </span><span><span class="kobospan" id="kobo.1354.1">reconstruction attack.</span></span></p>
<h2 id="_idParaDest-51" class="calibre7"><a id="_idTextAnchor050" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1355.1">Reconstruction attacks‚Äîmodel inversion attacks</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1356.1">Reconstruction attacks try to </span><a id="_idIndexMarker178" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1357.1">recreate one or more instances of training data and/or their respective class labels. </span><span class="kobospan" id="kobo.1357.2">The reconstruction may be partial or full, depending on the strength of the original model. </span><span class="kobospan" id="kobo.1357.3">A fully successful attack can generate more realistic training data and various samples to match exact class </span><span><span class="kobospan" id="kobo.1358.1">label predictions.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1359.1">Model inversion or attribute inference are kinds of reconstruction attacks. </span><span class="kobospan" id="kobo.1359.2">They come under the black-box attack category because the </span><a id="_idIndexMarker179" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1360.1">attacker doesn‚Äôt need to know the details of the model‚Äôs structure or internal workings. </span><span class="kobospan" id="kobo.1360.2">They only need access to the model‚Äôs output based on some input data. </span><span class="kobospan" id="kobo.1360.3">Using that, they can infer details about the data used to train </span><span><span class="kobospan" id="kobo.1361.1">the model.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1362.1">A step-by-step example of creating a model inversion attack</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1363.1">In this example, we first create a simple</span><a id="_idIndexMarker180" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1364.1"> dataset with two input features (</span><strong class="source-inline"><span class="kobospan" id="kobo.1365.1">X</span></strong><span class="kobospan" id="kobo.1366.1">) and binary labels (</span><strong class="source-inline"><span class="kobospan" id="kobo.1367.1">y</span></strong><span class="kobospan" id="kobo.1368.1">). </span><span class="kobospan" id="kobo.1368.2">We train a logistic regression model using this dataset. </span><span class="kobospan" id="kobo.1368.3">The </span><strong class="source-inline"><span class="kobospan" id="kobo.1369.1">model_inversion_attack</span></strong><span class="kobospan" id="kobo.1370.1"> function attempts to invert the model by finding an input that produces the desired </span><span><span class="kobospan" id="kobo.1371.1">output probability.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1372.1">Please note that this is a basic example to illustrate the concept of model inversion attacks. </span><span class="kobospan" id="kobo.1372.2">In real-world </span><a id="_idIndexMarker181" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1373.1">scenarios, model inversion attacks can be more complex and require sophisticated techniques to handle larger and more </span><span><span class="kobospan" id="kobo.1374.1">complex models.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1375.1">The full source code can be found </span><span><span class="kobospan" id="kobo.1376.1">in </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.1377.1">Model_Inversion_LR_Sample.ipynb</span></strong></span><span><span class="kobospan" id="kobo.1378.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1379.1">
from sklearn.linear_model import LogisticRegression
import numpy as np
# Create a sample dataset
X = np.array([[1, 2], [3, 4], [5, 6], [7, 8]])¬†¬†# Input features
y = np.array([0, 0, 1, 1])¬†¬†# Corresponding labels
# Train a logistic regression model on the dataset
model = LogisticRegression()
model.fit(X, y)
# Function to perform model inversion attack
def model_inversion_attack(model, output):
¬†¬†¬†¬†# Generate a random input within a certain range
¬†¬†¬†¬†input_range = np.arange(0, 10, 0.01)
¬†¬†¬†¬†best_input = None
¬†¬†¬†¬†best_loss = float('inf')
¬†¬†¬†¬†# Find the input that minimizes the loss function
¬†¬†¬†¬†for i in input_range:
¬†¬†¬†¬†¬†¬†¬†¬†input_guess = np.array([[i, i]])
¬†¬†¬†¬†¬†¬†¬†¬†predicted_output = model.predict_proba(input_guess)
¬†¬†¬†¬†¬†¬†¬†¬†loss = abs(predicted_output[0][1] - output)
if loss &lt; best_loss:
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†best_input = input_guess
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†best_loss = loss
¬†¬†¬†¬†
¬†¬†¬†¬†return best_input
# Perform model inversion attack on a specific output
target_output = 0.8
inverted_input = model_inversion_attack(model, target_output)
print("Inverted Input:", inverted_input)
target_output = 1
inverted_input = model_inversion_attack(model, target_output)
print("Inverted Input:", inverted_input)
target_output = 0.5
inverted_input = model_inversion_attack(model, target_output)
print("Inverted Input:", inverted_input)
target_output = 0
inverted_input = model_inversion_attack(model, target_output)
print("Inverted Input:", inverted_input)
Inverted Input: [[5.64 5.64]]
Inverted Input: [[9.99 9.99]]
Inverted Input: [[4.5 4.5]]
Inverted Input: [[0. </span><span class="kobospan1" id="kobo.1379.2">0.]]</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1380.1">Let‚Äôs explore a more </span><a id="_idIndexMarker182" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1381.1">complex example to understand model </span><span><span class="kobospan" id="kobo.1382.1">inversion attacks.</span></span></p>
<h2 id="_idParaDest-52" class="calibre7"><a id="_idTextAnchor051" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1383.1">Model inversion attacks in neural networks</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1384.1">Neural networks are a class of ML models inspired by the structure and functioning of the human brain. </span><span class="kobospan" id="kobo.1384.2">They are designed to recognize complex patterns and relationships in data. </span><span class="kobospan" id="kobo.1384.3">Neural networks consist of interconnected</span><a id="_idIndexMarker183" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1385.1"> layers of artificial neurons, known as nodes or units, which collectively form </span><span><span class="kobospan" id="kobo.1386.1">a network.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1387.1">Each neuron receives input signals, applies </span><a id="_idIndexMarker184" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1388.1">a mathematical operation to them, and produces an output signal. </span><span class="kobospan" id="kobo.1388.2">These signals are passed through the network, with weights assigned to the connections between neurons determining the strength of the signal. </span><span class="kobospan" id="kobo.1388.3">Neural networks are trained using a process called backpropagation, which</span><a id="_idIndexMarker185" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1389.1"> adjusts the weights based on the errors between predicted and </span><span><span class="kobospan" id="kobo.1390.1">actual outputs.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1391.1">The hidden layers of a neural network enable it to learn and represent intricate nonlinear relationships in the data, making it capable of solving highly complex tasks such as image and speech recognition, natural language processing, and even playing games. </span><span class="kobospan" id="kobo.1391.2">Popular neural network architectures</span><a id="_idIndexMarker186" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1392.1"> include feedforward neural </span><a id="_idIndexMarker187" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1393.1">networks, </span><strong class="bold"><span class="kobospan" id="kobo.1394.1">convolutional neural networks</span></strong><span class="kobospan" id="kobo.1395.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1396.1">CNNs</span></strong><span class="kobospan" id="kobo.1397.1">), and </span><strong class="bold"><span class="kobospan" id="kobo.1398.1">recurrent neural </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.1399.1">networks</span></strong></span><span><span class="kobospan" id="kobo.1400.1"> (</span></span><span><strong class="bold"><span class="kobospan" id="kobo.1401.1">RNNs</span></strong></span><span><span class="kobospan" id="kobo.1402.1">).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1403.1">Neural networks have achieved remarkable success in various fields, demonstrating state-of-the-art performance in many domains. </span><span class="kobospan" id="kobo.1403.2">They have become a fundamental tool in machine learning and continue to advance the boundaries of artificial intelligence by enabling sophisticated decision-making and pattern </span><span><span class="kobospan" id="kobo.1404.1">recognition capabilities.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1405.1">We will not delve into the intricacies of neural networks, as this exceeds the scope of </span><span><span class="kobospan" id="kobo.1406.1">this book.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1407.1">In this example, we will demonstrate how an adversary can generate input data using the output of a neural </span><a id="_idIndexMarker188" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1408.1">network model. </span><span class="kobospan" id="kobo.1408.2">The adversary‚Äôs goal is to reconstruct the original input that led to a specific output prediction by leveraging the characteristics of the model‚Äôs behavior. </span><span class="kobospan" id="kobo.1408.3">By reverse-engineering the relationship between the model‚Äôs output and the corresponding input data, the adversary can gain insights into the original data points used for training </span><span><span class="kobospan" id="kobo.1409.1">the </span></span><span><a id="_idIndexMarker189" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.1410.1">model.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer031">
<span class="kobospan" id="kobo.1411.1"><img alt="Figure 2.12 ‚Äì Neural network models of the original author and the adversary" src="image/B16573_02_12.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1412.1">Figure 2.12 ‚Äì Neural network models of the original author and the adversary</span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1413.1">Input data</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1414.1">In this example, we utilize the </span><strong class="bold"><span class="kobospan" id="kobo.1415.1">Modified National Institute of Standards and Technology</span></strong><span class="kobospan" id="kobo.1416.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1417.1">MNIST</span></strong><span class="kobospan" id="kobo.1418.1">) dataset to</span><a id="_idIndexMarker190" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1419.1"> train a neural network model. </span><span class="kobospan" id="kobo.1419.2">The MNIST dataset comprises 60,000 grayscale images</span><a id="_idIndexMarker191" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1420.1"> of handwritten single digits between 0 and 9. </span><span class="kobospan" id="kobo.1420.2">Each image is a small square with dimensions of 28 x </span><span><span class="kobospan" id="kobo.1421.1">28 pixels.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1422.1">Original authors model</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1423.1">The following code snippet demonstrates how to load the MNIST dataset from the PyTorch GitHub examples repository using the pickle format. </span><span class="kobospan" id="kobo.1423.2">It further splits the data into training and test datasets. </span><span class="kobospan" id="kobo.1423.3">In this example, the MNIST dataset is stored in a pickle file named </span><strong class="source-inline"><span class="kobospan" id="kobo.1424.1">mnist_data.pkl</span></strong><span class="kobospan" id="kobo.1425.1">. </span><span class="kobospan" id="kobo.1425.2">We </span><a id="_idIndexMarker192" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1426.1">open the file in binary read mode and load the dataset using the </span><strong class="source-inline"><span class="kobospan" id="kobo.1427.1">pickle.load()</span></strong><span class="kobospan" id="kobo.1428.1"> function. </span><span class="kobospan" id="kobo.1428.2">The dataset is then split into the training and test sets, with the </span><span><span class="kobospan" id="kobo.1429.1">corresponding labels.</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.1430.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.1431.1">Download the dataset from Github (</span><a href="https://github.com/pytorch/tutorials/blob/main/_static/mnist.pkl.gz" class="pcalibre1 calibre6 pcalibre"><span class="kobospan" id="kobo.1432.1">https://github.com/pytorch/tutorials/blob/main/_static/mnist.pkl.gz</span></a><span class="kobospan" id="kobo.1433.1">) and keep it in the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.1434.1">data/mnist</span></strong></span><span><span class="kobospan" id="kobo.1435.1"> directory.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1436.1">The full source code can be found in </span><strong class="source-inline"><span class="kobospan" id="kobo.1437.1">Model_Inversion_Attack_Example.ipynb</span></strong><span class="kobospan" id="kobo.1438.1">. </span><span class="kobospan" id="kobo.1438.2">We are using PyTorch version </span><span><span class="kobospan" id="kobo.1439.1">1.13.1 here:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1440.1">
from pathlib import Path
import requests
import pickle
import gzip
DATA_PATH = Path(‚Äúdata‚Äù)
PATH = DATA_PATH / ‚Äúmnist‚Äù
PATH.mkdir(parents=True, exist_ok=True)
# 10.195.33.40 - Github
URL = "https://10.195.33.40/pytorch/tutorials/raw/main/_static/"
FILENAME = ‚Äúmnist.pkl.gz‚Äù
with gzip.open((PATH / FILENAME).as_posix(), ‚Äúrb‚Äù) as f:
((x_train, y_train), (x_valid, y_valid), _) = pickle.load(f, encoding=‚Äùlatin-1‚Äù)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1441.1">After loading the data, you can visualize one sample image using the Matplotlib library and obtain its shape. </span><span class="kobospan" id="kobo.1441.2">Here‚Äôs</span><a id="_idIndexMarker193" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1442.1"> the </span><span><span class="kobospan" id="kobo.1443.1">code snippet:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1444.1">
from matplotlib import pyplot
import numpy as np
pyplot.imshow(x_train[0].reshape((28, 28)), cmap=‚Äùgray‚Äù)
print(x_train.shape, y_train[0])</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1445.1">This results in the </span><span><span class="kobospan" id="kobo.1446.1">following output:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer032">
<span class="kobospan" id="kobo.1447.1"><img alt="" role="presentation" src="image/B16573_02_13.jpg" class="calibre4"/></span>
</div>
</div>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.1448.1">(50000, 784) 5</span></strong></p>
<p class="calibre3"><span class="kobospan" id="kobo.1449.1">Now, convert the training samples into the tensor format in order to use the same in the neural network model </span><span><span class="kobospan" id="kobo.1450.1">as input:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1451.1">
import torch
x_train, y_train, x_valid, y_valid = map(
¬†¬†¬†¬†torch.tensor, (x_train, y_train, x_valid, y_valid)
)
n, c = x_train.shape
print(x_train, y_train)
print(x_train.shape)
print(y_train.min(), y_train.max())
tensor([[0., 0., 0.,¬†¬†..., 0., 0., 0.],
¬†¬†¬†¬†¬†¬†¬†¬†[0., 0., 0.,¬†¬†..., 0., 0., 0.],
¬†¬†¬†¬†¬†¬†¬†¬†[0., 0., 0.,¬†¬†..., 0., 0., 0.],
¬†¬†¬†¬†¬†¬†¬†¬†...,
¬†¬†¬†¬†¬†¬†¬†¬†[0., 0., 0.,¬†¬†..., 0., 0., 0.],
¬†¬†¬†¬†¬†¬†¬†¬†[0., 0., 0.,¬†¬†..., 0., 0., 0.],
¬†¬†¬†¬†¬†¬†¬†¬†[0., 0., 0.,¬†¬†..., 0., 0., 0.]])
tensor([5, 0, 4,¬†¬†..., 8, 4, 8])
print(x_train.shape)
torch.Size([50000, 784])
print(y_train.min(), y_train.max())
tensor(0) tensor(9)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1452.1">Let‚Äôs build a simple sequential</span><a id="_idIndexMarker194" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1453.1"> neural network model</span><a id="_idIndexMarker195" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1454.1"> with linear layers using </span><strong class="bold"><span class="kobospan" id="kobo.1455.1">rectified linear unit</span></strong><span class="kobospan" id="kobo.1456.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1457.1">ReLU</span></strong><span class="kobospan" id="kobo.1458.1">) as an </span><span><span class="kobospan" id="kobo.1459.1">activation function:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1460.1">
from torch import nn, optim
class AuthorsNN(nn.Module):
¬†¬†def __init__(self):
¬†¬†¬†¬†super().__init__()
¬†¬†¬†¬†self.first_sec = nn.Sequential(
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Linear(784, 450),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.ReLU(),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†)
¬†¬†¬†¬†self.second_sec = nn.Sequential(
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Linear(450, 450),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.ReLU(),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Linear(450, 10),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Softmax(dim=-1),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†)
¬†¬†def forward(self, x):
¬†¬†¬†¬†return self.second_sec(self.first_sec(x))</span></pre>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.1461.1">AuthorsNN</span></strong><span class="kobospan" id="kobo.1462.1"> class extends the </span><strong class="source-inline"><span class="kobospan" id="kobo.1463.1">nn.Module</span></strong><span class="kobospan" id="kobo.1464.1"> class from PyTorch. </span><span class="kobospan" id="kobo.1464.2">This class represents a neural network model designed for a classification task. </span><span class="kobospan" id="kobo.1464.3">Here‚Äôs a breakdown of the preceding code and </span><span><span class="kobospan" id="kobo.1465.1">its </span></span><span><a id="_idIndexMarker196" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.1466.1">functionality:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1467.1">The AuthorsNN class</span></strong><span class="kobospan" id="kobo.1468.1">: This class represents</span><a id="_idIndexMarker197" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1469.1"> the neural network model designed by the author(s). </span><span class="kobospan" id="kobo.1469.2">It inherits from the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1470.1">nn.Module</span></strong><span class="kobospan" id="kobo.1471.1"> class, which is the base class for all neural network modules </span><span><span class="kobospan" id="kobo.1472.1">in PyTorch.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1473.1">The __init__ method</span></strong><span class="kobospan" id="kobo.1474.1">: This method</span><a id="_idIndexMarker198" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1475.1"> is the constructor of the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1476.1">AuthorsNN</span></strong><span class="kobospan" id="kobo.1477.1"> class and is called when an instance of the class is created. </span><span class="kobospan" id="kobo.1477.2">Inside this method, the architecture of the model </span><span><span class="kobospan" id="kobo.1478.1">is defined:</span></span><ul class="calibre16"><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1479.1">self.first_sec</span></strong><span class="kobospan" id="kobo.1480.1"> is a sequential module consisting of </span><span><span class="kobospan" id="kobo.1481.1">two layers:</span></span><ul class="calibre16"><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1482.1">nn.Linear(784, 450)</span></strong><span class="kobospan" id="kobo.1483.1"> represents a linear layer with 784 input features and 450 </span><span><span class="kobospan" id="kobo.1484.1">output features.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1485.1">nn.ReLU()</span></strong><span class="kobospan" id="kobo.1486.1"> applies the ReLU activation function to </span><span><span class="kobospan" id="kobo.1487.1">introduce non-linearity.</span></span></li></ul></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1488.1">self.second_sec</span></strong><span class="kobospan" id="kobo.1489.1"> is another sequential module consisting of </span><span><span class="kobospan" id="kobo.1490.1">three layers:</span></span><ul class="calibre16"><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1491.1">nn.Linear(450, 450)</span></strong><span class="kobospan" id="kobo.1492.1"> represents a linear layer with 450 input features and 450 </span><span><span class="kobospan" id="kobo.1493.1">output features.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1494.1">nn.ReLU()</span></strong><span class="kobospan" id="kobo.1495.1"> applies the ReLU </span><span><span class="kobospan" id="kobo.1496.1">activation function.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1497.1">nn.Linear(450, 10)</span></strong><span class="kobospan" id="kobo.1498.1"> represents a linear layer with 450 input features and 10 output features, corresponding to the number </span><span><span class="kobospan" id="kobo.1499.1">of classes.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1500.1">nn.Softmax(dim=-1)</span></strong><span class="kobospan" id="kobo.1501.1"> applies the softmax activation function to convert the raw output scores into probabilities, ensuring they sum to </span><strong class="source-inline1"><span class="kobospan" id="kobo.1502.1">1</span></strong> <span><span class="kobospan" id="kobo.1503.1">across classes.</span></span></li></ul></li></ul></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1504.1">The forward method</span></strong><span class="kobospan" id="kobo.1505.1">: This method </span><a id="_idIndexMarker199" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1506.1">defines the forward pass of the model, specifying how input data flows through</span><a id="_idIndexMarker200" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1507.1"> the network. </span><span class="kobospan" id="kobo.1507.2">The input, </span><strong class="source-inline1"><span class="kobospan" id="kobo.1508.1">x</span></strong><span class="kobospan" id="kobo.1509.1">, is passed through </span><strong class="source-inline1"><span class="kobospan" id="kobo.1510.1">self.first_sec</span></strong><span class="kobospan" id="kobo.1511.1">, followed by </span><strong class="source-inline1"><span class="kobospan" id="kobo.1512.1">self.second_sec</span></strong><span class="kobospan" id="kobo.1513.1">, and the resulting output </span><span><span class="kobospan" id="kobo.1514.1">is returned.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1515.1">The following code creates an instance of the </span><strong class="source-inline"><span class="kobospan" id="kobo.1516.1">AuthorsNN</span></strong><span class="kobospan" id="kobo.1517.1"> class named </span><strong class="source-inline"><span class="kobospan" id="kobo.1518.1">auth_nn</span></strong><span class="kobospan" id="kobo.1519.1">. </span><span class="kobospan" id="kobo.1519.2">This instance represents the initialized neural </span><span><span class="kobospan" id="kobo.1520.1">network model:</span></span></p>
<pre class="source-code">
<strong class="source-inline2"><span class="kobospan1" id="kobo.1521.1">auth_nn = AuthorsNN()</span></strong>
<strong class="source-inline2"><span class="kobospan1" id="kobo.1522.1">auth_nn</span></strong></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1523.1">Printing </span><strong class="source-inline"><span class="kobospan" id="kobo.1524.1">auth_nn</span></strong><span class="kobospan" id="kobo.1525.1"> will display information about the model, such as its architecture and the number of </span><span><span class="kobospan" id="kobo.1526.1">trainable parameters:</span></span></p>
<pre class="console"><span class="kobospan1" id="kobo.1527.1">
AuthorsNN(
¬†¬†(first_sec): Sequential(
¬†¬†¬†¬†(0): Linear(in_features=784, out_features=450, bias=True)
¬†¬†¬†¬†(1): ReLU()
¬†¬†)
¬†¬†(second_sec): Sequential(
¬†¬†¬†¬†(0): Linear(in_features=450, out_features=450, bias=True)
¬†¬†¬†¬†(1): ReLU()
¬†¬†¬†¬†(2): Linear(in_features=450, out_features=10, bias=True)
¬†¬†¬†¬†(3): Softmax(dim=-1)
¬†¬†)
)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1528.1">Next, we define a loss function in order to measure the error between the actual data versus the </span><span><span class="kobospan" id="kobo.1529.1">predicted data:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1530.1">
loss_func = nn.CrossEntropyLoss()
loss_func
CrossEntropyLoss()</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1531.1">To enhance the network, let‚Äôs add the Adam optimizer function. </span><span class="kobospan" id="kobo.1531.2">This </span><a id="_idIndexMarker201" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1532.1">is an optimization algorithm that replaces </span><strong class="bold"><span class="kobospan" id="kobo.1533.1">stochastic gradient descent</span></strong><span class="kobospan" id="kobo.1534.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1535.1">SGD</span></strong><span class="kobospan" id="kobo.1536.1">) for training </span><span><span class="kobospan" id="kobo.1537.1">DL models.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1538.1">It combines the desirable aspects of the </span><strong class="source-inline"><span class="kobospan" id="kobo.1539.1">AdaGrad</span></strong><span class="kobospan" id="kobo.1540.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.1541.1">RMSProp</span></strong><span class="kobospan" id="kobo.1542.1"> algorithms, making it suitable for handling sparse gradients in noisy </span><span><span class="kobospan" id="kobo.1543.1">problem scenarios:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1544.1">
from torch import optim
optimizer = optim.Adam(auth_nn.parameters(), lr = 0.01)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1545.1">Here, we import the </span><strong class="source-inline"><span class="kobospan" id="kobo.1546.1">optim</span></strong><span class="kobospan" id="kobo.1547.1"> module from PyTorch. </span><span class="kobospan" id="kobo.1547.2">After instantiating the </span><strong class="source-inline"><span class="kobospan" id="kobo.1548.1">AuthorsNN</span></strong><span class="kobospan" id="kobo.1549.1"> class, we define the Adam optimizer using the </span><strong class="source-inline"><span class="kobospan" id="kobo.1550.1">optim.Adam()</span></strong><span class="kobospan" id="kobo.1551.1"> function. </span><span class="kobospan" id="kobo.1551.2">The optimizer is initialized with the model‚Äôs </span><a id="_idIndexMarker202" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1552.1">parameters (</span><strong class="source-inline"><span class="kobospan" id="kobo.1553.1">auth_nn.parameters()</span></strong><span class="kobospan" id="kobo.1554.1">), enabling it to optimize the model </span><span><span class="kobospan" id="kobo.1555.1">during training.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1556.1">Next, print </span><strong class="source-inline"><span class="kobospan" id="kobo.1557.1">optimizer</span></strong><span class="kobospan" id="kobo.1558.1"> to provide details about the model‚Äôs </span><span><span class="kobospan" id="kobo.1559.1">optimizer‚Äôs configuration:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1560.1">
optimizer</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1561.1">This results in the </span><span><span class="kobospan" id="kobo.1562.1">following output:</span></span></p>
<pre class="console"><span class="kobospan1" id="kobo.1563.1">
Adam (
Parameter Group 0
¬†¬†¬†¬†amsgrad: False
¬†¬†¬†¬†betas: (0.9, 0.999)
¬†¬†¬†¬†capturable: False
¬†¬†¬†¬†differentiable: False
¬†¬†¬†¬†eps: 1e-08
¬†¬†¬†¬†foreach: None
¬†¬†¬†¬†fused: False
¬†¬†¬†¬†lr: 0.01
¬†¬†¬†¬†maximize: False
¬†¬†¬†¬†weight_decay: 0
)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1564.1">Now, train the neural </span><a id="_idIndexMarker203" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1565.1">network model with the MNIST training dataset that we loaded earlier and wrap it in a </span><span><span class="kobospan" id="kobo.1566.1">Python function:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1567.1">
def train(num_epochs, ann):
¬†¬†¬†¬†ann.train()
¬†¬†¬†¬†for epoch in range(num_epochs):
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†output = ann(x_train)
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†loss = loss_func(output, y_train)
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†# clear gradients for this training step
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†optimizer.zero_grad()
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†# backpropagation, compute gradients
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†loss.backward()
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†# apply gradients
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†optimizer.step()
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†print(epoch, loss.item())
¬†¬†¬†¬†pass</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1568.1">Let‚Äôs break this </span><span><span class="kobospan" id="kobo.1569.1">code down:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1570.1">The</span></strong> <strong class="source-inline1"><span class="kobospan" id="kobo.1571.1">train</span></strong> <strong class="bold"><span class="kobospan" id="kobo.1572.1">function</span></strong><span class="kobospan" id="kobo.1573.1">: This function trains the neural network model (</span><strong class="source-inline1"><span class="kobospan" id="kobo.1574.1">ann</span></strong><span class="kobospan" id="kobo.1575.1">) for a specified number of epochs (</span><strong class="source-inline1"><span class="kobospan" id="kobo.1576.1">num_epochs</span></strong><span class="kobospan" id="kobo.1577.1">). </span><span class="kobospan" id="kobo.1577.2">The function assumes the presence of input data (</span><strong class="source-inline1"><span class="kobospan" id="kobo.1578.1">x_train</span></strong><span class="kobospan" id="kobo.1579.1">) and corresponding target labels (</span><strong class="source-inline1"><span class="kobospan" id="kobo.1580.1">y_train</span></strong><span class="kobospan" id="kobo.1581.1">) used for training the model. </span><span class="kobospan" id="kobo.1581.2">Here, </span><strong class="source-inline1"><span class="kobospan" id="kobo.1582.1">ann.train()</span></strong><span class="kobospan" id="kobo.1583.1"> is called to set the model in training mode, enabling </span><a id="_idIndexMarker204" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1584.1">functionalities such as dropout and </span><span><span class="kobospan" id="kobo.1585.1">batch normalization.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1586.1">The training loop</span></strong><span class="kobospan" id="kobo.1587.1">: For each epoch in the range of </span><strong class="source-inline1"><span class="kobospan" id="kobo.1588.1">num_epochs</span></strong><span class="kobospan" id="kobo.1589.1">, the following steps </span><span><span class="kobospan" id="kobo.1590.1">are executed:</span></span><ul class="calibre16"><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1591.1">output = ann(x_train)</span></strong><span class="kobospan" id="kobo.1592.1">: Forward passes through the model, obtaining the </span><span><span class="kobospan" id="kobo.1593.1">output predictions.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1594.1">loss = loss_func(output, y_train)</span></strong><span class="kobospan" id="kobo.1595.1">: Computes the loss between the predicted output and the ground </span><span><span class="kobospan" id="kobo.1596.1">truth labels.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1597.1">optimizer.zero_grad()</span></strong><span class="kobospan" id="kobo.1598.1">: Clears the gradients accumulated from the </span><span><span class="kobospan" id="kobo.1599.1">previous iteration.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1600.1">loss.backward()</span></strong><span class="kobospan" id="kobo.1601.1">: Performs backpropagation to compute the gradients of the model‚Äôs parameters with respect to </span><span><span class="kobospan" id="kobo.1602.1">the loss.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1603.1">optimizer.step()</span></strong><span class="kobospan" id="kobo.1604.1">: Updates the model‚Äôs parameters by applying the computed gradients using the </span><span><span class="kobospan" id="kobo.1605.1">chosen optimizer.</span></span></li><li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.1606.1">print(epoch, loss.item()</span></strong><span class="kobospan" id="kobo.1607.1">): Prints the current epoch number and the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.1608.1">loss</span></strong></span><span><span class="kobospan" id="kobo.1609.1"> value.</span></span></li><li class="calibre11"><span class="kobospan" id="kobo.1610.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.1611.1">pass</span></strong><span class="kobospan" id="kobo.1612.1"> statement: A placeholder that does nothing in this context and can be removed if </span><span><span class="kobospan" id="kobo.1613.1">not needed.</span></span></li></ul></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1614.1">Now, train the neural network model with the MNIST training dataset that we loaded earlier with the author‚Äôs neural network model, which was built in the previous step with </span><span><strong class="source-inline"><span class="kobospan" id="kobo.1615.1">100</span></strong></span><span><span class="kobospan" id="kobo.1616.1"> epochs:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1617.1">
train(100,auth_nn)
0 1.6085695028305054
1 1.6047792434692383
2 1.59657621383667
‚Ä¶.
</span><span class="kobospan1" id="kobo.1617.2">100 1.4667187929153442</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1618.1">Once the model is trained, it can be used for further predictions. </span><span class="kobospan" id="kobo.1618.2">Now, we will construct the adversary attacker model </span><a id="_idIndexMarker205" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1619.1">with the objective of recreating the </span><span><span class="kobospan" id="kobo.1620.1">training data.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1621.1">Adversary model to get the trained input data</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1622.1">Considering that the author‚Äôs model has been trained on the MNIST dataset and we have access to the size </span><strong class="source-inline"><span class="kobospan" id="kobo.1623.1">450</span></strong><span class="kobospan" id="kobo.1624.1"> vector output from the model‚Äôs first section (</span><strong class="source-inline"><span class="kobospan" id="kobo.1625.1">first_sec</span></strong><span class="kobospan" id="kobo.1626.1">), we can utilize this information for our </span><a id="_idIndexMarker206" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1627.1">attack. </span><span class="kobospan" id="kobo.1627.2">Next, we will develop our adversary model. </span><span class="kobospan" id="kobo.1627.3">This model takes a size </span><strong class="source-inline"><span class="kobospan" id="kobo.1628.1">450</span></strong><span class="kobospan" id="kobo.1629.1"> vector as input, which corresponds to the output of the target‚Äôs first section. </span><span class="kobospan" id="kobo.1629.2">The adversary model‚Äôs objective is to generate a size </span><strong class="source-inline"><span class="kobospan" id="kobo.1630.1">784</span></strong><span class="kobospan" id="kobo.1631.1"> vector, matching the size of the original </span><span><span class="kobospan" id="kobo.1632.1">input data:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1633.1">
class Adversary(nn.Module):
¬†¬†def __init__(self):
¬†¬†¬†¬†super().__init__()
¬†¬†¬†¬†self.layers= nn.Sequential(
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Linear(450, 800),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.ReLU(),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†nn.Linear(800, 784),
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†)
¬†¬†def forward(self, x):
¬†¬†¬†¬†return self.layers(x)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1634.1">Based on the information available, the authors‚Äô original model was trained on a dataset consisting of handwritten images. </span><span class="kobospan" id="kobo.1634.2">This knowledge provides us with an understanding of the model‚Äôs training </span><span><span class="kobospan" id="kobo.1635.1">data source.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1636.1">To train our adversary model, we can utilize the MNIST test data. </span><span class="kobospan" id="kobo.1636.2">Specifically, we will use the first 1,000 rows of the MNIST test data to train our adversary model. </span><span class="kobospan" id="kobo.1636.3">After training, we can evaluate the accuracy of the adversary model using the MNIST test data ranging from the 1,000th row to</span><a id="_idIndexMarker207" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1637.1"> the </span><span><span class="kobospan" id="kobo.1638.1">2,000th row.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1639.1">Let‚Äôs train the </span><span><span class="kobospan" id="kobo.1640.1">adversary model:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1641.1">
adversary = Adversary()
optimizer = optim.Adam(adversary.parameters(), lr=1e-4)
for i in range (0,1000):
¬†¬†¬†¬†optimiser.zero_grad()
¬†¬†¬†¬†#print(x_train[i])
¬†¬†¬†¬†target_outputs¬†¬†= auth_nn.first_sec(x_valid[i])
¬†¬†¬†¬†adversary_outputs = adversary(target_outputs)
¬†¬†¬†¬†#print(adversary_outputs)
¬†¬†¬†¬†loss = ((x_valid[i] - adversary_outputs)**2).mean()
¬†¬†¬†¬†#print(loss.item())
¬†¬†¬†¬†loss.backward()
¬†¬†¬†¬†optimiser.step()
Now, let‚Äôs test the</span><a id="_idIndexMarker208" class="pcalibre pcalibre1 calibre19"/><span class="kobospan1" id="kobo.1642.1"> adversary model:
for i in range (1000,2000):
¬†¬†¬†¬†target_outputs = auth_nn.first_sec(x_train[i])
¬†¬†¬†¬†recreated_data = adversary(target_outputs)
¬†¬†¬†¬†#print(recreated_data)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1643.1">To assess the similarity between the recreated data and the original trained images from the training dataset, we can utilize the Matplotlib library to visualize the images. </span><span class="kobospan" id="kobo.1643.2">By plotting the recreated image, we can determine the level of resemblance it holds with the original </span><span><span class="kobospan" id="kobo.1644.1">trained images:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1645.1">
With torch.no_grad():
 pyplot.imshow(recreated_data.reshape((28, 28)), cmap=‚Äùgray‚Äù)</span></pre>
<p class="calibre3"><span class="kobospan" id="kobo.1646.1">This results in the </span><span><span class="kobospan" id="kobo.1647.1">following output:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer033">
<span class="kobospan" id="kobo.1648.1"><img alt="" role="presentation" src="image/B16573_02_14.jpg" class="calibre4"/></span>
</div>
</div>
<p class="calibre3"><span class="kobospan" id="kobo.1649.1">It is evident that the images generated using model inversion attacks closely resemble the training data. </span><span class="kobospan" id="kobo.1649.2">This example demonstrates the successful recreation of training data without requiring complete</span><a id="_idIndexMarker209" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1650.1"> knowledge</span><a id="_idIndexMarker210" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1651.1"> of the model details, thereby achieving a model </span><span><span class="kobospan" id="kobo.1652.1">inversion attack.</span></span></p>
<h4 class="calibre17"><span class="kobospan" id="kobo.1653.1">Techniques to mitigate model inversion attacks</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.1654.1">Mitigating model inversion attacks, where an adversary tries to infer sensitive training data from a trained model‚Äôs outputs, is crucial for preserving privacy and protecting </span><span><span class="kobospan" id="kobo.1655.1">sensitive information.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1656.1">Some techniques to mitigate model inversion attacks include </span><span><span class="kobospan" id="kobo.1657.1">the following:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1658.1">Differential privacy</span></strong><span class="kobospan" id="kobo.1659.1">: Applying differential privacy mechanisms during the training process can help protect against model inversion attacks. </span><span class="kobospan" id="kobo.1659.2">Differential privacy adds controlled noise to the training data or model‚Äôs outputs, making it harder for an attacker to extract specific sensitive information from the model‚Äôs predictions. </span><span class="kobospan" id="kobo.1659.3">We will learn more about differential privacy in the next </span><span><span class="kobospan" id="kobo.1660.1">two chapters.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1661.1">Limit access to sensitive output</span></strong><span class="kobospan" id="kobo.1662.1">: Restricting access to sensitive model output or predictions can help mitigate model inversion attacks. </span><span class="kobospan" id="kobo.1662.2">By carefully controlling who has access to the output and under what circumstances, you can reduce the risk of an adversary inferring sensitive </span><span><span class="kobospan" id="kobo.1663.1">training data.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1664.1">Preprocessing and postprocessing</span></strong><span class="kobospan" id="kobo.1665.1">: Applying preprocessing and postprocessing techniques to the data and model‚Äôs output can help protect against model inversion attacks. </span><span class="kobospan" id="kobo.1665.2">For example, data anonymization, aggregation, or transformation techniques can be applied to remove or obfuscate sensitive information from the input or output. </span><span class="kobospan" id="kobo.1665.3">We will learn more about data anonymization and aggregation in the </span><span><span class="kobospan" id="kobo.1666.1">subsequent chapters.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1667.1">Regularization</span></strong><span class="kobospan" id="kobo.1668.1">: Incorporating regularization techniques such as L1 or L2 regularization during the model training process can help improve privacy by reducing the model‚Äôs reliance on specific sensitive features. </span><span class="kobospan" id="kobo.1668.2">Regularization can help prevent overfitting and limit the leakage of sensitive information through the </span><span><span class="kobospan" id="kobo.1669.1">model‚Äôs predictions.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1670.1">Generative adversarial networks</span></strong><span class="kobospan" id="kobo.1671.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1672.1">GANs</span></strong><span class="kobospan" id="kobo.1673.1">): Using generative models such as GANs can help protect against model inversion attacks. </span><span class="kobospan" id="kobo.1673.2">By generating synthetic data that preserves the statistical properties of the original data, GANs can provide alternative output for the attacker without revealing specific sensitive </span><span><span class="kobospan" id="kobo.1674.1">training instances.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1675.1">Secure multi-party computation</span></strong><span class="kobospan" id="kobo.1676.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1677.1">MPC</span></strong><span class="kobospan" id="kobo.1678.1">): Leveraging secure MPC protocols can enable multiple parties to collaboratively train a model while keeping their individual training data private. </span><span class="kobospan" id="kobo.1678.2">Secure MPC ensures that no party can access the sensitive data of others, thereby mitigating model </span><span><span class="kobospan" id="kobo.1679.1">inversion attacks.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1680.1">Secure aggregation</span></strong><span class="kobospan" id="kobo.1681.1">: In scenarios where models are trained using a distributed setting, secure aggregation protocols can be employed to prevent sensitive information leakage during the </span><a id="_idIndexMarker211" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1682.1">aggregation of model updates. </span><span class="kobospan" id="kobo.1682.2">This protects against model inversion attacks during the </span><span><span class="kobospan" id="kobo.1683.1">training process.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1684.1">Access control and authorization</span></strong><span class="kobospan" id="kobo.1685.1">: Implementing access control measures and strong authorization mechanisms can help restrict access to sensitive model output, limiting the exposure to potential attackers. </span><span class="kobospan" id="kobo.1685.2">Only authorized entities should have access to sensitive predictions </span><span><span class="kobospan" id="kobo.1686.1">or output.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1687.1">Synthetic data generation</span></strong><span class="kobospan" id="kobo.1688.1">: Instead of training models directly on sensitive data, using synthetic data generated from the original data can help mitigate model inversion attacks. </span><span class="kobospan" id="kobo.1688.2">Synthetic data retains the statistical characteristics of the original data but does not expose </span><span><span class="kobospan" id="kobo.1689.1">sensitive information.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.1690.1">Model monitoring</span></strong><span class="kobospan" id="kobo.1691.1">: Continuously monitoring the model‚Äôs behavior for any unusual patterns or unexpected output can help detect potential model inversion attacks. </span><span class="kobospan" id="kobo.1691.2">Monitoring can involve techniques such as outlier detection, adversarial robustness checks, or statistical </span><a id="_idIndexMarker212" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1692.1">analysis of </span><span><span class="kobospan" id="kobo.1693.1">model predictions.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1694.1">Like the previous two attacks, It‚Äôs important to note that choosing mitigation techniques depends on the specific context, the sensitivity of the data, and the desired level of privacy protection. </span><span class="kobospan" id="kobo.1694.2">Multiple techniques can be combined to achieve stronger privacy guarantees against model </span><span><span class="kobospan" id="kobo.1695.1">inversion attacks.</span></span></p>
<h1 id="_idParaDest-53" class="calibre5"><a id="_idTextAnchor052" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1696.1">Summary</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.1697.1">To summarize, we have covered different types of ML (supervised and unsupervised) and explored how to save and execute models in various formats. </span><span class="kobospan" id="kobo.1697.2">Additionally, we delved into the different phases of ML (data extraction, data preparation, model development, model deployment, and inferencing) and discussed the privacy threats and attacks associated with each phase </span><span><span class="kobospan" id="kobo.1698.1">in detail.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1699.1">In the next chapter, we will dive deeper into privacy-preserving data analysis and focus on understanding the concept of differential privacy. </span><span class="kobospan" id="kobo.1699.2">This will allow us to explore techniques and methodologies that ensure privacy while conducting data analysis tasks. </span><span class="kobospan" id="kobo.1699.3">By gaining a thorough understanding of differential privacy, we can better safeguard sensitive information and mitigate privacy risks in the context </span><span><span class="kobospan" id="kobo.1700.1">of ML.</span></span></p>
</div>
</body></html>