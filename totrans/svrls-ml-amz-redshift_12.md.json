["```py\n {\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"forecast:DescribeDataset\",\n                \"forecast:DescribeDatasetGroup\",\n                \"forecast:DescribeAutoPredictor\",\n                \"forecast:CreateDatasetImportJob\",\n                \"forecast:CreateForecast\",\n                \"forecast:DescribeForecast\",\n                \"forecast:DescribeForecastExportJob\",\n                \"forecast:CreateMonitor\",\n                \"forecast:CreateForecastExportJob\",\n                \"forecast:CreateAutoPredictor\",\n                \"forecast:DescribeDatasetImportJob\",\n                \"forecast:CreateDatasetGroup\",\n                \"forecast:CreateDataset\",\n                \"forecast:TagResource\",\n                \"forecast:UpdateDatasetGroup\"\n            ],\n            \"Resource\": \"*\"\n        } ,\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\":\"arn:aws:iam::<aws_account_id>:role/service-role/<Amazon_Redshift_cluster_iam_role_name>\"\n    }\n    ]\n}\n```", "```py\nCREATE MODEL forecast_model_name\nFROM { table_name | ( select_query ) }\nTARGET column_name\nIAM_ROLE { default | 'arn:aws:iam::<AWS account-id>:role/<role-name>' }\nAUTO ON MODEL_TYPE FORECAST\n[ OBJECTIVE optimization_metric ]\nSETTINGS (S3_BUCKET 'bucket',\n          HORIZON integer,\n          FREQUENCY forecast_frequency,\n          [, PERCENTILES perc_comma_delim_string],\n          [ S3_GARGABE_COLLECT OFF ])\n```", "```py\n    CREATE SCHEMA chapter12_forecasting;\n    ```", "```py\n    Create table chapter12_forecasting.web_retail_sales\n    ```", "```py\n    (invoice_Date date, item_id varchar(500), quantity int);\n    ```", "```py\n    COPY chapter12_forecasting.web_retail_sales\n    ```", "```py\n    FROM 's3://packt-serverless-ml-redshift/chapter12/web_retail_sales.csv'\n    ```", "```py\n    IAM_ROLE default\n    ```", "```py\n    FORMAT AS CSV\n    ```", "```py\n    DELIMITER ','\n    ```", "```py\n    IGNOREHEADER 1\n    ```", "```py\n    DATEFORMAT 'YYYY-MM-DD'\n    ```", "```py\n    REGION AS 'eu-west-1';\n    ```", "```py\n    select * from chapter12_forecasting.web_retail_sales;\n    ```", "```py\nCREATE MODEL forecast_sales_demand\nFROM (select item_id, invoice_date, quantity from  chapter12_forecasting.web_retail_sales where invoice_date <  '2020-10-31')\nTARGET quantity\nIAM_ROLE 'arn:aws:your-IAM-Role'\nAUTO ON MODEL_TYPE FORECAST\nOBJECTIVE 'AverageWeightedQuantileLoss'\nSETTINGS (S3_BUCKET '<<bucket name>>',\n HORIZON 5,\n FREQUENCY 'D',\n PERCENTILES '0.25,0.50,0.75,0.90,mean',\n S3_GARBAGE_COLLECT OFF);\n```", "```py\nSHOW MODEL forecast_sales_demand;\n```", "```py\nSHOW MODEL forecast_sales_demand;\n```", "```py\ncreate table chapter12_forecasting.tbl_forecast_sales_demand as SELECT\nFORECAST(forecast_sales_demand);\n```", "```py\nselect * from chapter12_forecasting.tbl_forecast_sales_demand;\n```", "```py\nselect a.item_id as product,\na.invoice_date,\na.quantity as actual_quantity ,\np90::int as p90_forecast,\np90::int - a.quantity as p90_error ,mean::int,\np50::int as p50_forecast\nfrom chapter12_forecasting.web_retail_sales a\ninner join chapter12_forecasting.tbl_forecast_sales_demand b\non upper(a.item_id) = upper(b.id)\nand a.invoice_date = to_date(b.time, 'YYYY-MM-DD')\nAND a.item_id = 'JUMBO BAG RED RETROSPOT'\nwhere invoice_date > '2020-10-31'\norder by 1,2;\n```"]