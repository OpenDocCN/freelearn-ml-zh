<html><head></head><body>
<div id="_idContainer279">
<h1 class="chapter-number" id="_idParaDest-90"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.1.1">7</span></h1>
<h1 id="_idParaDest-91"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.2.1">Deploying ML Models for Batch Scoring</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.3.1">Deploying ML models for batch scoring</span></strong><span class="koboSpan" id="kobo.4.1"> supports making predictions using a large volume of data. </span><span class="koboSpan" id="kobo.4.2">This solution supports use cases when you don’t need your model predictions immediately, but rather minutes or hours later. </span><span class="koboSpan" id="kobo.4.3">If you need to provide inferencing once a day, week, or month, using a large dataset, batch inferencing </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">is ideal.</span></span></p>
<p><span class="koboSpan" id="kobo.6.1">Batch inferencing </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.7.1">allows data scientists and ML professionals to leverage cloud compute when needed, rather than paying for compute resources to be available for real-time responses. </span><span class="koboSpan" id="kobo.7.2">This means that compute resources can be spun up to support batch inferencing and spun down after the results have been provided to the business users. </span><span class="koboSpan" id="kobo.7.3">We are going to show you how to leverage the Azure Machine Learning service to deploy trained models to managed endpoints, which are HTTPS REST APIs that clients can invoke to get the score results of a trained model for batch inferencing using the studio and the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">Python SDK.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">Deploying a model for batch inferencing using </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">the Studio</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Deploying a model for batch inferencing through the </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Python SDK</span></span></li>
</ul>
<h1 id="_idParaDest-92"><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.15.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.16.1">In order to access your workspace, recall the steps from the </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">previous chapter:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.18.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">to </span></span><a href="https://ml.azure.com"><span class="No-Break"><span class="koboSpan" id="kobo.20.1">https://ml.azure.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.21.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">Select </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">your workspace.</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">On the left side of the workspace’s UI, on </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.26.1">Compute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">On the compute screen, select your compute instance and </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.30.1">Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer258">
<span class="koboSpan" id="kobo.32.1"><img alt="Figure 7.1 – Start compute" src="image/B18003_07_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.33.1">Figure 7.1 – Start compute</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.34.1">Your compute instance will change from the </span><strong class="bold"><span class="koboSpan" id="kobo.35.1">Stopped</span></strong><span class="koboSpan" id="kobo.36.1"> to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.37.1">Starting</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.38.1"> status.</span></span></li>
<li><span class="koboSpan" id="kobo.39.1">In the previous chapter, we cloned the Git repository. </span><span class="koboSpan" id="kobo.39.2">If you have not done this, continue with this step. </span><span class="koboSpan" id="kobo.39.3">If you have already cloned the repository, skip to </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.40.1">step 7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.42.1">Open the terminal on your compute instance. </span><span class="koboSpan" id="kobo.42.2">Note that the path will include your user in the directory. </span><span class="koboSpan" id="kobo.42.3">Type the following into the terminal to clone the sample notebooks into your </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">working directory:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.44.1">
git clone </span><strong class="source-inline"><span class="koboSpan" id="kobo.45.1">https://github.com/PacktPublishing/Azure-Machine-Learning-Engineering.git</span></strong></pre>
<ol>
<li value="7"><span class="koboSpan" id="kobo.46.1">Clicking on the refresh icon shown in</span><em class="italic"> </em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.47.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.48.1">.2</span></em><span class="koboSpan" id="kobo.49.1"> will update and refresh the notebooks displayed on </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">your screen.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer259">
<span class="koboSpan" id="kobo.51.1"><img alt="Figure 7.2 – Refresh Icon" src="image/B18003_07_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.52.1">Figure 7.2 – Refresh Icon</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.53.1">Review the notebooks in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.54.1">Azure-Machine-Learning-Engineering</span></strong><span class="koboSpan" id="kobo.55.1"> directory. </span><span class="koboSpan" id="kobo.55.2">This will display the files cloned into your working directory, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.56.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.57.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer260">
<span class="koboSpan" id="kobo.59.1"><img alt="Figure 7.3 – Azure-Machine-Learning-Engineering" src="image/B18003_07_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.60.1">Figure 7.3 – Azure-Machine-Learning-Engineering</span></p>
<p><span class="koboSpan" id="kobo.61.1">Let’s start with deploying a model for batch inferencing using the </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">studio next.</span></span></p>
<h1 id="_idParaDest-93"><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.63.1">Deploying a model for batch inferencing using the Studio</span></h1>
<p><span class="koboSpan" id="kobo.64.1">In </span><a href="B18003_03.xhtml#_idTextAnchor053"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.65.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.66.1">, </span><em class="italic"><span class="koboSpan" id="kobo.67.1">Training Machine Learning Models in AMLS</span></em><span class="koboSpan" id="kobo.68.1">, we trained a model and registered it in an </span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.69.1">Azure Machine </span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.70.1">Learning workspace. </span><span class="koboSpan" id="kobo.70.2">We are going to deploy that model to a managed batch endpoint for </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">batch scoring:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.72.1">Navigate to your Azure Machine Learning workspace, select </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">Models</span></strong><span class="koboSpan" id="kobo.74.1"> from the left menu bar to see the models registered in your workspace, and select </span><strong class="bold"><span class="koboSpan" id="kobo.75.1">titanic_servival_model_</span></strong><span class="koboSpan" id="kobo.76.1">, as </span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.77.1">shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.78.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.79.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer261">
<span class="koboSpan" id="kobo.81.1"><img alt="Figure 7.4 – List of models registered in the workspace" src="image/B18003_07_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.82.1">Figure 7.4 – List of models registered in the workspace</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.83.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.84.1">Deploy</span></strong><span class="koboSpan" id="kobo.85.1"> and</span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.86.1"> select </span><strong class="bold"><span class="koboSpan" id="kobo.87.1">Deploy to batch endpoint</span></strong><span class="koboSpan" id="kobo.88.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.89.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.90.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer262">
<span class="koboSpan" id="kobo.92.1"><img alt="Figure 7.5 – Deploy the selected model to a batch endpoint" src="image/B18003_07_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.93.1">Figure 7.5 – Deploy the selected model to a batch endpoint</span></p>
<p><span class="koboSpan" id="kobo.94.1">This opens</span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.95.1"> the deployment wizard. </span><span class="koboSpan" id="kobo.95.2">Use</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.96.1"> the following values for the </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">required fields:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.98.1">Endpoint </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.99.1">name</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">titanic-survival-batch-endpoint</span></strong></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.102.1">Model</span></strong><span class="koboSpan" id="kobo.103.1">: Retain the default </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">of </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.105.1">titanic_survival_model_</span></strong></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.106.1">Deployment </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.107.1">name</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">titanic-deployment</span></strong></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.110.1">Environment</span></strong><span class="koboSpan" id="kobo.111.1">: For the selected model, the scoring script and environment are auto-generated </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">for you</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.113.1">Compute</span></strong><span class="koboSpan" id="kobo.114.1">: </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.115.1">cluster cpu-cluster</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.116.1">Review your batch deployment specs and click </span><strong class="bold"><span class="koboSpan" id="kobo.117.1">Create deployment</span></strong><span class="koboSpan" id="kobo.118.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.119.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.120.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer263">
<span class="koboSpan" id="kobo.122.1"><img alt="Figure 7.6 – Create batch deployment" src="image/B18003_07_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.123.1">Figure 7.6 – Create batch deployment</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.124.1">After a</span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.125.1"> minute or so, you </span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.126.1">should see a page that shows that your batch endpoint has been deployed successfully. </span><span class="koboSpan" id="kobo.126.2">It also has some information about your batch endpoint, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.127.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.128.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer264">
<span class="koboSpan" id="kobo.130.1"><img alt="Figure 7.7 – Successful batch deployment" src="image/B18003_07_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.131.1">Figure 7.7 – Successful batch deployment</span></p>
<p><span class="koboSpan" id="kobo.132.1">Now that you have a</span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.133.1"> batch endpoint up and</span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.134.1"> running, let’s create a scoring/inferencing job that invokes your endpoint. </span><span class="koboSpan" id="kobo.134.2">To do so, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">these steps:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.136.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.137.1">Endpoints</span></strong><span class="koboSpan" id="kobo.138.1"> in the left menu bar and click on your recently created batch endpoint, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.139.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.140.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer265">
<span class="koboSpan" id="kobo.142.1"><img alt="Figure 7.8 – List of deployed batch endpoints" src="image/B18003_07_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.143.1">Figure 7.8 – List of deployed batch endpoints</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.144.1">On</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.145.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">titanic-survival-batch-endpoint</span></strong><span class="koboSpan" id="kobo.147.1"> page, select</span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.148.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.149.1">Jobs</span></strong><span class="koboSpan" id="kobo.150.1"> tab, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.151.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.152.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer266">
<span class="koboSpan" id="kobo.154.1"><img alt="Figure 7.9 – titanic-survival-batch-endpoint Jobs tab" src="image/B18003_07_009.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.155.1">Figure 7.9 – titanic-survival-batch-endpoint Jobs tab</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.156.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.157.1">Create job</span></strong><span class="koboSpan" id="kobo.158.1"> and pick the</span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.159.1"> corresponding values for the fields in the wizard as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.160.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.161.1">.10</span></em><span class="koboSpan" id="kobo.162.1">. </span><span class="koboSpan" id="kobo.162.2">Click </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">Create</span></strong><span class="koboSpan" id="kobo.164.1"> once</span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.165.1"> you’re done. </span><span class="koboSpan" id="kobo.165.2">Please note that the deployment is pre-selected for you, but make sure the correct deployment is pre-selected. </span><span class="koboSpan" id="kobo.165.3">You should also have a test dataset called </span><strong class="bold"><span class="koboSpan" id="kobo.166.1">titanic-test-data</span></strong><span class="koboSpan" id="kobo.167.1">, which was created in </span><a href="B18003_03.xhtml#_idTextAnchor053"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.168.1">Chapter 3</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.169.1">, Training Machine Learning Models </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.170.1">in AMLS</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer267">
<span class="koboSpan" id="kobo.172.1"><img alt="Figure 7.10 – Create a batch scoring job" src="image/B18003_07_010.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.173.1">Figure 7.10 – Create a batch scoring job</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.174.1">Depending on the size of </span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.175.1">the test dataset</span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.176.1"> that you selected in the last step, it will take some time for the job to complete. </span><span class="koboSpan" id="kobo.176.2">Once it is complete, you will see a pipeline representing the batch scoring job for </span><strong class="bold"><span class="koboSpan" id="kobo.177.1">titanic-survival-batch-endpoint</span></strong><span class="koboSpan" id="kobo.178.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.179.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.180.1">.11</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer268">
<span class="koboSpan" id="kobo.182.1"><img alt="Figure 7.11 – Batch scoring job for titanic-survival-batch-endpoint" src="image/B18003_07_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.183.1">Figure 7.11 – Batch scoring job for titanic-survival-batch-endpoint</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.184.1">Now, in order to view the </span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.185.1">scoring results, click</span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.186.1"> on the </span><strong class="bold"><span class="koboSpan" id="kobo.187.1">batchscoring</span></strong><span class="koboSpan" id="kobo.188.1"> step of the pipeline, click on </span><strong class="bold"><span class="koboSpan" id="kobo.189.1">Job overview</span></strong><span class="koboSpan" id="kobo.190.1"> on the right, select the </span><strong class="bold"><span class="koboSpan" id="kobo.191.1">Outputs + logs</span></strong><span class="koboSpan" id="kobo.192.1"> tab, and finally, click on </span><strong class="bold"><span class="koboSpan" id="kobo.193.1">Show data outputs</span></strong><span class="koboSpan" id="kobo.194.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.195.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.196.1">.12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer269">
<span class="koboSpan" id="kobo.198.1"><img alt="Figure 7.12 – Batch scoring results" src="image/B18003_07_012.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.199.1">Figure 7.12 – Batch scoring results</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.200.1">After you click </span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.201.1">on </span><strong class="bold"><span class="koboSpan" id="kobo.202.1">Show data outputs</span></strong><span class="koboSpan" id="kobo.203.1">, you will see the </span><strong class="bold"><span class="koboSpan" id="kobo.204.1">Access data</span></strong><span class="koboSpan" id="kobo.205.1"> option, which opens the storage account</span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.206.1"> where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">predictions.csv</span></strong><span class="koboSpan" id="kobo.208.1"> file has been saved. </span><span class="koboSpan" id="kobo.208.2">Click on this file and select the </span><strong class="bold"><span class="koboSpan" id="kobo.209.1">Edit</span></strong><span class="koboSpan" id="kobo.210.1"> tab in order to view the scoring results, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.211.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.212.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer270">
<span class="koboSpan" id="kobo.214.1"><img alt="Figure 7.13 – Viewing batch scoring results" src="image/B18003_07_013.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.215.1">Figure 7.13 – Viewing batch scoring results</span></p>
<p><span class="koboSpan" id="kobo.216.1">In this section, you learned how to deploy an existing model to a managed endpoint for batch inferencing using the studio. </span><span class="koboSpan" id="kobo.216.2">In the next section, we will show you how to deploy a model to a managed endpoint for batch scoring using the </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">Python SDK.</span></span></p>
<h1 id="_idParaDest-94"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.218.1">Deploying a model for batch inferencing through the Python SDK</span></h1>
<p><span class="koboSpan" id="kobo.219.1">In this section, we are </span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.220.1">going to deploy an existing </span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.221.1">model to a managed endpoint for batch inferencing using the Python SDK by following </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">these steps:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.223.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">to </span></span><a href="https://ml.azure.com"><span class="No-Break"><span class="koboSpan" id="kobo.225.1">https://ml.azure.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.226.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.227.1">Select </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">your workspace.</span></span></li>
<li><span class="koboSpan" id="kobo.229.1">On the workspace user interface on the left side, </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.231.1">Compute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer271">
<span class="koboSpan" id="kobo.233.1"><img alt="Figure 7.14 –  Compute instance icon" src="image/B18003_07_014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.234.1">Figure 7.14 –  Compute instance icon</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.235.1">On the </span><strong class="bold"><span class="koboSpan" id="kobo.236.1">Compute</span></strong><span class="koboSpan" id="kobo.237.1"> screen, select your compute instance and </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.239.1">Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">:</span></span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer272">
<span class="koboSpan" id="kobo.241.1"><img alt="Figure 7.15 – Start compute" src="image/B18003_07_015.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.242.1">Figure 7.15 – Start compute</span></p>
<p><span class="koboSpan" id="kobo.243.1">Your compute instance will change from </span><strong class="bold"><span class="koboSpan" id="kobo.244.1">Stopped</span></strong><span class="koboSpan" id="kobo.245.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.246.1">Starting</span></strong><span class="koboSpan" id="kobo.247.1">. </span><span class="koboSpan" id="kobo.247.2">Once the compute instance moves from </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">Starting</span></strong><span class="koboSpan" id="kobo.249.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Running</span></strong><span class="koboSpan" id="kobo.251.1">, it is ready for use, so go ahead and clone our repository, which contains some sample notebooks to </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">walk through.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.253.1">Click on </span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.254.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.255.1">Terminal</span></strong><span class="koboSpan" id="kobo.256.1"> hyperlink </span><a id="_idIndexMarker494"/><span class="No-Break"><span class="koboSpan" id="kobo.257.1">under applications.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.258.1">This will open the terminal on your compute instance. </span><span class="koboSpan" id="kobo.258.2">Note that the path will include your user in the directory path. </span><span class="koboSpan" id="kobo.258.3">Type the following into the terminal to clone the sample notebooks into your </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">working directory:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.260.1">
git clone </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">https://github.com/PacktPublishing/Azure-Machine-Learning-Engineering.git</span></strong></pre>
<ol>
<li value="6"><span class="koboSpan" id="kobo.262.1">Click on the Jupyter link under applications, and this will display the folders that were just cloned. </span><span class="koboSpan" id="kobo.262.2">Navigate to </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">chapter 7</span></strong><span class="koboSpan" id="kobo.264.1"> and click on </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">Deploy_Model_for_Batch_Scoring.ipynb</span></strong><span class="koboSpan" id="kobo.266.1"> to bring up the notebook for </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">this section.</span></span></li>
<li><span class="koboSpan" id="kobo.268.1">The code snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.269.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.270.1">.16</span></em><span class="koboSpan" id="kobo.271.1"> shows the libraries that need to be imported and how to connect to the Azure ML workspace in your </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">compute instance:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer273">
<span class="koboSpan" id="kobo.273.1"><img alt="Figure 7.16 – Import required libraries and connecting to the Azure Machine Learning workspace" src="image/B18003_07_016.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.274.1">Figure 7.16 – Import required libraries and connecting to the Azure Machine Learning workspace</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.275.1">The code</span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.276.1"> snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.277.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.278.1">.17</span></em><span class="koboSpan" id="kobo.279.1"> shows </span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.280.1">how to create a </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">batch endpoint:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer274">
<span class="koboSpan" id="kobo.282.1"><img alt="Figure 7.17 – Creating a batch endpoint for inferencing" src="image/B18003_07_017.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.283.1">Figure 7.17 – Creating a batch endpoint for inferencing</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.284.1">The code snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.285.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.286.1">.18</span></em><span class="koboSpan" id="kobo.287.1"> shows how to retrieve an existing model from the workspace and how to create a batch deployment. </span><span class="koboSpan" id="kobo.287.2">The batch deployment must specify the batch endpoint, the trained model, and the compute </span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.288.1">cluster that is used for scoring, along </span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.289.1">with other </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">deployment parameters:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer275">
<span class="koboSpan" id="kobo.291.1"><img alt="Figure 7.18 – Creating a batch deployment" src="image/B18003_07_018.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.292.1">Figure 7.18 – Creating a batch deployment</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.293.1">Now, that your batch endpoint is ready to be invoked, you are going to pass some test data to the endpoint, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.294.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.295.1">.19</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer276">
<span class="koboSpan" id="kobo.297.1"><img alt="Figure 7.19 – Creating a batch deployment" src="image/B18003_07_019.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.298.1">Figure 7.19 – Creating a batch deployment</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.299.1">The code </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.300.1">snippet shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.301.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.302.1">.20</span></em><span class="koboSpan" id="kobo.303.1"> shows the</span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.304.1"> Python code required to monitor the batch scoring job that was submitted in the </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">previous step:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer277">
<span class="koboSpan" id="kobo.306.1"><img alt="Figure 7.20 – Creating a batch deployment" src="image/B18003_07_020.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.307.1">Figure 7.20 – Creating a batch deployment</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.308.1">Clicking on the output link from the previous step will open the workspace displaying the batch scoring job, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.309.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.310.1">.21</span></em><span class="koboSpan" id="kobo.311.1">. </span><span class="koboSpan" id="kobo.311.2">You can follow </span><em class="italic"><span class="koboSpan" id="kobo.312.1">steps 9</span></em><span class="koboSpan" id="kobo.313.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.314.1">10</span></em><span class="koboSpan" id="kobo.315.1"> from the last section to see </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">the results.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer278">
<span class="koboSpan" id="kobo.317.1"><img alt="Figure 7.21 – Batch scoring results" src="image/B18003_07_021.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.318.1">Figure 7.21 – Batch scoring results</span></p>
<p><span class="koboSpan" id="kobo.319.1">Let’s </span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.320.1">summarize the</span><a id="_idIndexMarker502"/> <span class="No-Break"><span class="koboSpan" id="kobo.321.1">chapter next.</span></span></p>
<h1 id="_idParaDest-95"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.322.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.323.1">We have covered a lot of topics in this chapter. </span><span class="koboSpan" id="kobo.323.2">We have shown you how to deploy a model for batch scoring using the studio and through the Python SDK. </span><span class="koboSpan" id="kobo.323.3">We also showed you how to pass some test data to be scored by the deployed model by invoking the </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">batch endpoint.</span></span></p>
<p><span class="koboSpan" id="kobo.325.1">In the next chapter, you will learn about responsible AI and the capabilities within Azure Machine Learning that allow you to develop, assess, and deploy models more responsibly to minimize unwanted bias in your </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">AI systems.</span></span></p>
</div>
</body></html>