<html><head></head><body><div class="chapter" title="Chapter&#xA0;12.&#xA0;Case Study Exercise I"><div class="titlepage"><div><div><h1 class="title"><a id="ch12"/>Chapter 12. Case Study Exercise I</h1></div></div></div><p>Now you already know a decent bit about Azure ML! It's time to use that knowledge to look at some real-world problems. You may not be able to solve them fully at this point, but you can certainly give it a try and come up with some kind of a working solution.</p><p>In this chapter, we will present a problem in the form of a case study and will solve it with a very simple, but end-to-end solution. Like in other chapters so far, it won't present a step-by-step guide with all the details; however, it would just provide pointers for you to solve the problem. This chapter assumes that you have successfully completed reading all the previous chapters or already know about Azure ML.</p><div class="section" title="Problem definition and scope"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec72"/>Problem definition and scope</h1></div></div></div><p>If you are flying <a id="id417" class="indexterm"/>somewhere, it becomes a very bizarre experience if the flight gets delayed. We can't do much in that regard, but given the historical dataset, we can predict and know well ahead whether a particular flight will get delayed or not. That's the problem we will solve as a case study.</p><p>The complete solution to the problem of predicting a flight delay will be huge and is beyond the scope of this book because of the huge data crunching that it takes. However, we will limit the scope by limiting the dataset and simplifying the solution.</p></div></div>
<div class="section" title="The dataset"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec73"/>The dataset</h1></div></div></div><p>We will use the sample <a id="id418" class="indexterm"/>dataset that comes by default in ML Studio. This is the subset of the passenger flight's on-time performance data taken from the <span class="strong"><strong>TranStats</strong></span> data <a id="id419" class="indexterm"/>collection from <span class="strong"><strong>U.S. Department of Transportation</strong></span> (<span class="strong"><strong>DOT</strong></span>) (<a class="ulink" href="http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&amp;DB_Short_Name=On-Time">http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&amp;DB_Short_Name=On-Time</a>).</p><p>The dataset has been <a id="id420" class="indexterm"/>preprocessed and is filtered to include only the 70 busiest airports in the continental United States for the period between April 2013 to October 2013. It contains the following columns:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Carrier</strong></span>: This contains the code assigned by IATA and is commonly used to identify a carrier.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>OriginAirportID</strong></span> (Origin Airport's Airport ID): This is an identification number assigned by DOT to identify a unique airport.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DestAirportID</strong></span> (Destination Airport;s Airport ID): This is an identification number assigned by DOT to identify a unique airport.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>CRSDepTime</strong></span>: This is the scheduled departure time (local time in hh:mm).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DepDelay</strong></span>: This is the difference in minutes between the scheduled and the actual departure time. Early departures show negative numbers.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DepDel15</strong></span> (Departure Delay Indicator): This shows a delay in the departure of a flight by 15 minutes or more (here, 1=Yes).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>CRSArrTime</strong></span>: This is the scheduled arrival time (local time in hh:mm).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ArrDelay</strong></span>: This is the difference in minutes between the scheduled and the actual arrival time. Early arrivals show negative numbers.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ArrDel15</strong></span> (Arrival Delay Indicator): This shows a delay in the arrival of a fight by 15 minutes or more (here, 1=Yes).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Cancelled</strong></span>: This is the cancelled flight indicator (here, 1=Yes).</li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>Note that the cancelled flights have been considered as delayed and have been set as <span class="emphasis"><em>ArrDel15 = 1</em></span>.</p></div></div><p>From our experience, we know that the flight timing often gets impacted by weather conditions, so it makes sense to collect and process the relevant weather data corresponding to the origin and destination airports. For simplicity, we will consider only the flights on time dataset here. However, you are encouraged to experiment and merge the weather dataset and prepare your dataset to build the model. There is a sample <span class="strong"><strong>Weather Dataset</strong></span> that comes by default in ML Studio.</p></div>
<div class="section" title="Data exploration and preparation"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec74"/>Data exploration and preparation</h1></div></div></div><p>In your <a id="id421" class="indexterm"/>experiment, drag the <span class="strong"><strong>Flight Delays Data</strong></span> sample dataset and click on the <a id="id422" class="indexterm"/>
<span class="strong"><strong>Visualize</strong></span> option to explore the dataset. You can find that some columns have lots of missing values. You can clean the missing data using a <span class="strong"><strong>Clean Missing Data</strong></span> module by replacing it with <span class="strong"><strong>MICE</strong></span> as the cleaning mode.</p><p>There are certain columns, such as <span class="strong"><strong>DayOfWeek</strong></span>, <span class="strong"><strong>OriginAirportID</strong></span>, and <span class="strong"><strong>DestAirportID</strong></span> which contain continuous numbers; however, they are categorical variables. So, use the <span class="strong"><strong>Metadata Editor</strong></span> module to set them as <span class="strong"><strong>Categorical</strong></span>.</p><div class="section" title="Feature selection"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec67"/>Feature selection</h2></div></div></div><p>Before you start developing the <a id="id423" class="indexterm"/>model, it is important to select or generate a set of variables that have the most predictive power and remove any redundant and not so important features. In this case, all the data points are of the same year, so the year column is not required here. We are interested in predicting the delays before the journey starts, so the <span class="strong"><strong>DepDel15</strong></span> and <span class="strong"><strong>DepDelay</strong></span> columns are not important. Again, both the <span class="strong"><strong>ArrDelay</strong></span> and <span class="strong"><strong>ArrDelay15</strong></span> columns are about arrival delay. Here, we are just interested in whether the flight got delayed or not. So, <span class="strong"><strong>ArrDelay</strong></span> is not required. All the cancelled flights are labeled as delayed, so the <span class="strong"><strong>Cancelled</strong></span> column is also not required. You filter these columns using the <span class="strong"><strong>Project Columns</strong></span> module and you will be left with the columns that contain the required features and label.</p></div></div>
<div class="section" title="Model development"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec75"/>Model development</h1></div></div></div><p>You have to predict <a id="id424" class="indexterm"/>whether the flight would be delayed or not. As you found from the dataset, any flight delayed for more than 15 minutes has been labeled as delayed and the <span class="strong"><strong>ArrDelay15</strong></span> corresponding label contains <span class="strong"><strong>1</strong></span>. Here, the <span class="strong"><strong>ArrDelay15</strong></span> column is the target variable and it only contains <span class="strong"><strong>0</strong></span> and <span class="strong"><strong>1</strong></span>. Clearly, it's a two-class classification problem.</p><p>As you have already explored, there are several two-class classification algorithms available in ML Studio. For simplicity, we would just build the model here with the <span class="strong"><strong>Two-Class Boosted Decision Tree</strong></span> module with the following parameters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="strong"><strong>Maximum number of leaves per tree</strong></span> option is set at <span class="strong"><strong>128</strong></span></li><li class="listitem" style="list-style-type: disc">The <span class="strong"><strong>Minimum number of samples per leaf node</strong></span> option is set at <span class="strong"><strong>50</strong></span></li><li class="listitem" style="list-style-type: disc">The <span class="strong"><strong>Learning rate</strong></span> option is set at <span class="strong"><strong>0.2</strong></span></li><li class="listitem" style="list-style-type: disc">The <span class="strong"><strong>Number of trees constructed</strong></span> option is set at <span class="strong"><strong>500</strong></span></li></ul></div><p>You are encouraged to try out different algorithms and also use the <span class="strong"><strong>Sweep Parameters</strong></span> module to choose the optimum parameters.</p><p>To train the model, you need to split the dataset and use one subset for training and other for scoring and evaluation.</p><p>Your experiment, after <a id="id425" class="indexterm"/>running successfully, may look something like the following:</p><div class="mediaobject"><img src="graphics/0792EN_12_01.jpg" alt="Model development"/></div><p>After you are happy with your experiment and satisfied with the trained model, you can proceed to deploy it by <a id="id426" class="indexterm"/>publishing it as a web service.</p></div>
<div class="section" title="Model deployment"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec76"/>Model deployment</h1></div></div></div><p>Before publishing your <a id="id427" class="indexterm"/>model as a web service, create a scoring experiment and make sure that the <span class="strong"><strong>Web service input</strong></span> and the <span class="strong"><strong>Web service output</strong></span> modules are properly connected. Also, process the model if you want your output in a proper format, for example, outputting only the scored label and input to the score model may not contain the label column; in this case, you can also filter the <span class="strong"><strong>ArrDelay15</strong></span> column along with the others in the <span class="strong"><strong>Project Columns</strong></span> module connected to the <span class="strong"><strong>Score Model</strong></span> module. Let's take a look at the following screenshot:</p><div class="mediaobject"><img src="graphics/0792EN_12_02.jpg" alt="Model deployment"/></div><p>Then, publish your scoring experiment, so that it would be available as a web service in the staging environment. Test <a id="id428" class="indexterm"/>your web service visually and also with Excel. If you are good at programming, you're encouraged to test your web service by writing a small client program as well.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec77"/>Summary</h1></div></div></div><p>You just finished building a predictive solution in this case study. You started the chapter by defining and understanding the problem. You acquired the dataset, which in this case is the sample dataset available in ML Studio. Then, you proceeded to perform data exploration and preparation before building the predictive model. You used the boosted decision tree to build the model. After running the experiment successfully, you created a scoring experiment and used a saved trained model in it. Finally, you published the experiment as a web service and tested it.</p><p>In the next chapter, you are going to learn to build your own models, with another case study where you would solve a regression problem.</p></div></body></html>