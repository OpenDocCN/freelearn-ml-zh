<html><head></head><body><div class="chapter" title="Chapter&#xA0;13.&#xA0;Case Study - Pricing Reinsurance Contracts"><div class="titlepage"><div><div><h1 class="title"><a id="ch13"/>Chapter 13. Case Study - Pricing Reinsurance Contracts</h1></div></div></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch13lvl1sec56"/>Introduction</h1></div></div></div><p>Reinsurance, as the name implies, has developed from insurance business and the extent of its use will depend not only upon the amount but also upon the characteristics of the risks to be underwritten by the direct insurer. The volume of reinsurance business which can be transacted depends primarily upon the volume of direct business available at any given time. The idea of reinsurance is rooted in the same human instinct that brought insurance into being, that is, the desire that the loss of one shall be shared by many.</p></div></div>
<div class="section" title="Pricing reinsurance contracts"><div class="titlepage"><div><div><h1 class="title"><a id="ch13lvl1sec57"/>Pricing reinsurance contracts</h1></div></div></div><p>The key objectives of an insurer in arranging reinsurance are inter alia; increasing capacity to handle larger risks by passing to the re insurer that part of the exposure which would not normally bear, because of financial constraints; enhancing ability to accept larger lines than capital allows; stabilizing operating results from year to year with the re insurer absorbing larger claims or catastrophe losses; increasing the chances making a profit by reinforcing the underwriter’s attempts to establish an account which is homogeneous in both size and quality of risk; ability to write and new risk exposures. The functions of reinsurance can be considered as providing services to protect increased capacity, financial stability, stabilization of claims ratio, accumulation of claims under different classes, spread of risks, protection of solvency margins and stabilize profits. The reinsurance helps to absorb newer risk exposure arising from economic changes, social changes, changes in insurance methods and changes caused by scientific development. There are only two ways a reinsurance contract can be arranged either by Facultative reinsurance one-off for a single policy or Treaty reinsurance automatic for a defined group of policies.</p><div class="section" title="Getting ready..."><div class="titlepage"><div><div><h2 class="title"><a id="ch13lvl2sec70"/>Getting ready...</h2></div></div></div><p>In order to carry out the pricing of reinsurance contracts, we shall be using a dataset collected on the Hurricane dataset.</p><div class="section" title="Step 1 - collecting and describing the data"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec170"/>Step 1 - collecting and describing the data</h3></div></div></div><p>The dataset, available in XLS format, called <code class="literal">publicdatamay2007.xls</code>, will be used. The dataset is in a standard format. There are 207 rows of data. There are seven variables. The numeric variables are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Year</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Base economic damage</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Normalized PL05</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Normalized CL05</code></li></ul></div><p>The non-numeric variables are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Hurricane description</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">State</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Category</code></li></ul></div></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch13lvl2sec71"/>How to do it...</h2></div></div></div><p>Let's get into the details.</p><div class="section" title="Step 2 - exploring the data"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec171"/>Step 2 - exploring the data</h3></div></div></div><p>Load up the following packages:</p><pre class="programlisting">
<span class="strong"><strong>    &gt; install.packages("gdata")</strong></span>
<span class="strong"><strong>    &gt; install.packages("evir")</strong></span>
<span class="strong"><strong>    &gt; library(gdata)</strong></span>
<span class="strong"><strong>    &gt; library(evir)</strong></span>
</pre><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note31"/>Note</h3><p>Version info: Code for this page was tested in R version 3.2.2</p></div></div><p>Let's explore the data and understand the relationships among the variables as follows. We'll begin by importing the XLS data file called <code class="literal">publicdatamay2007.xls</code>. We will be saving the data to the <code class="literal">StormDamageData</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; StormDamageData &lt;- read.xls("d:/publicdatamay2007.xls", sheet = 1)</strong></span>
</pre><p>Printing the <code class="literal">StormDamageData</code> frame: The <code class="literal">head()</code> function returns the first part of <code class="literal">StormDamageData</code> frame. The <code class="literal">StormDamageData</code> data frame is passed as an input parameter:</p><pre class="programlisting">
<span class="strong"><strong>&gt; head(StormDamageData)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_001.jpg" alt="Step 2 - exploring the data"/></div><p>
</p><p>The <code class="literal">tail()</code> function returns the last part of <code class="literal">StormDamageData</code> frame as follows. The <code class="literal">StormDamageData</code> frame is passed as an input parameter.</p><pre class="programlisting">
<span class="strong"><strong>&gt; tail(StormDamageData)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_002.jpg" alt="Step 2 - exploring the data"/></div><p>
</p><p>Exploring the dimension of the <code class="literal">StormDamageData</code> data frame: The <code class="literal">dim()</code> function returns the dimension of the <code class="literal">StormDamageData</code> frame. The <code class="literal">StormDamageData</code> data frame is passed as an input parameter. The result clearly states that there are 207 rows of data and nine columns:</p><pre class="programlisting">
<span class="strong"><strong>&gt; dim(StormDamageData)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_003.jpg" alt="Step 2 - exploring the data"/></div><p>
</p></div><div class="section" title="Step 3 - calculating the individual loss claims"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec172"/>Step 3 - calculating the individual loss claims</h3></div></div></div><p>Formatting the data: The wrapper function, <code class="literal">ChangeFormat</code>, eliminates the comma (<code class="literal">,</code>) from the values passed and returns the result as a numeric value:</p><pre class="programlisting">
<span class="strong"><strong>    &gt; ChangeFormat &lt;- function(x){</strong></span>
<span class="strong"><strong>      x = as.character(x)</strong></span>
<span class="strong"><strong>      for(i in 1:10){x=sub(",","",as.character(x))}</strong></span>
<span class="strong"><strong>        return(as.numeric(x)) }</strong></span>
</pre><p>Storing the <code class="literal">StormDamageData</code> data frame in base:</p><pre class="programlisting">
<span class="strong"><strong>&gt; base &lt;- StormDamageData[,1:4]</strong></span>
</pre><p>Calling the wrapper function, <code class="literal">ChangeFormat</code>: The <code class="literal">Base.Economic.Damage</code> of the <code class="literal">StormDamageData</code> data frame is passed as an input. The <code class="literal">Vectorize()</code> function creates the wrapper to the function <code class="literal">ChangeFormat()</code>. The result is then stored in the <code class="literal">base$Base.Economic.Damage</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; base$Base.Economic.Damage &lt;- Vectorize(ChangeFormat)(StormDamageData$Base.Economic.Damage)</strong></span>
</pre><p>Call the wrapper function, <code class="literal">ChangeFormat</code>: The <code class="literal">Normalized.PL05</code> of the <code class="literal">StormDamageData</code> data frame is passed as an input. The result is then stored in the <code class="literal">base$ Normalized.PL05</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; base$Normalized.PL05 &lt;- Vectorize(ChangeFormat)(StormDamageData$Normalized.PL05)</strong></span>
</pre><p>Call the wrapper function, <code class="literal">ChangeFormat</code>: The <code class="literal">Normalized.CL05</code> of the <code class="literal">StormDamageData</code> data frame is passed as an input. The result is then stored in the <code class="literal">base$ Normalized.CL05</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; base$Normalized.CL05 &lt;- Vectorize(ChangeFormat)(StormDamageData$Normalized.CL05)</strong></span>
</pre><p>Printing the <code class="literal">base</code> data frame: The <code class="literal">head()</code> function returns the first part of the base data frame. The <code class="literal">base</code> data frame is passed as an input parameter:</p><pre class="programlisting">
<span class="strong"><strong>&gt; head(base)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_004.jpg" alt="Step 3 - calculating the individual loss claims"/></div><p>
</p><p>Plotting the normalized cost of 207 hurricanes: <code class="literal">plot()</code> is a generic function. <code class="literal">base$Normalized.PL05/1e9</code> represents the <span class="emphasis"><em>x</em></span> coordinates of the plot. <code class="literal">type="h"</code> represents the histogram representational style. <code class="literal">ylim=c(0,155)</code> sets the upper limit of the y axis representation as 0 as the lower limit and 155 as the upper limit. The x axis represents the index of loss:</p><pre class="programlisting">
<span class="strong"><strong>&gt; plot(base$Normalized.PL05/1e9, type="h", ylim=c(0,155), main = "207 Hurricanes, Normalized Costs: 1900 - 2005", xlab = "Index of Loss", ylab = "Normalized Costs", col = "red")</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_005.jpg" alt="Step 3 - calculating the individual loss claims"/></div><p>
</p></div><div class="section" title="Step 4 - calculating the number of hurricanes"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec173"/>Step 4 - calculating the number of hurricanes</h3></div></div></div><p>Extracting the year and the frequency of the hurricanes count for each year: The base data frame contains the details as shown in the preceding text. <code class="literal">table()</code> uses <code class="literal">base$Year</code> to build a contingency table of the hurricanes count for each year. The result is stored in the <code class="literal">TestBase</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; TestBase &lt;- table(base$Year)</strong></span>
</pre><p>Printing the contents of the <code class="literal">TestBase</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; TestBase</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_006.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Extracting the year from the <code class="literal">TestBase</code> data frame: The <code class="literal">names()</code> function extracts the name of each year. <code class="literal">as.numeric()</code> converts each of the extracted names of the years into a numeric value. The result is stored in the years data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; years &lt;- as.numeric(names(TestBase))</strong></span>
</pre><p>Printing the contents of the <code class="literal">years</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; years</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_007.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Extracting the frequency of hurricanes count for each year from the <code class="literal">TestBase</code> data frame: <code class="literal">names()</code> extracts the frequency of hurricanes count for each year. <code class="literal">as.numeric()</code> converts each of the extracted frequency of hurricanes count into a numeric value. The result is stored in the frequency data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; frequency &lt;- as.numeric(TestBase)</strong></span>
</pre><p>Printing the contents of the <code class="literal">frequency</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; frequency</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_008.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Extracting the frequency of the hurricanes count for each year where there were no hurricane occurrences from the <code class="literal">TestBase</code> data frame: The result is stored in the <code class="literal">years0frequency</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; years0frequency &lt;- (1900:2005)[which(!(1900:2005)%in%years)]</strong></span>
</pre><p>Printing the contents of the <code class="literal">years0frequency</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; years0frequency</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_009.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Extracting all the counts of hurricanes for each year. The result is stored in the <code class="literal">StormDamageData</code> data frame:</p><pre class="programlisting">
<span class="strong"><strong>&gt; StormDamageData &lt;- data.frame(years=c(years, years0frequency), frequency=c(frequency, rep(0,length(years0frequency))))</strong></span>
</pre><p>Printing the <code class="literal">StormDamageData</code> data frame. The <code class="literal">head()</code> function returns the first part of the <code class="literal">StormDamageData</code> data frame. The <code class="literal">StormDamageData</code> data frame is passed as an input parameter:</p><pre class="programlisting">
<span class="strong"><strong>&gt; head(StormDamageData) </strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_010.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Ploting the years and frequency count for hurricanes for each year between 1900 and 2005: <code class="literal">plot()</code> is a generic function. years represents the <span class="emphasis"><em>x</em></span> coordinates of the plot, while frequency represents the y coordinates of the plot. <code class="literal">type="h"</code> represents the histogram representational style:</p><pre class="programlisting">
<span class="strong"><strong>&gt; plot(years, frequency, type="h", main = "Frequency of Hurricanes: 1900 - 2005", xlab = "Time (Years)", ylab = "Annual Frequency", col = "red")</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_011.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>Calculating the mean of the hurricane counts for all the years between 1900 to 2005:</p><pre class="programlisting">
<span class="strong"><strong>&gt; mean(StormDamageData$frequency)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_012.jpg" alt="Step 4 - calculating the number of hurricanes"/></div><p>
</p><p>On average there have been two hurricanes per year.</p></div><div class="section" title="Step 5 - building predictive models"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec174"/>Step 5 - building predictive models</h3></div></div></div><p>Let's find out the possible linear trend in the hurricane occurrence frequency. The <code class="literal">glm()</code> function is used to fit generalized linear models. <code class="literal">frequency~years</code> defines the formula. <code class="literal">data = StormDamageData</code> defines the dataset for the formula. The <code class="literal">family=poisson(link="identity")</code> function signifies the Poisson distribution.</p><p>The <code class="literal">lm()</code> function is used to fit linear models. <code class="literal">frequency~years</code> defines the formula. <code class="literal">data = StormDamageData</code> defines the dataset for the formula. Use the following commands:</p><pre class="programlisting">
<span class="strong"><strong>&gt; LinearTrend &lt;- glm(frequency~years, data = StormDamageData, family=poisson(link="identity"), start=lm(frequency~years, data = StormDamageData)$coefficients)</strong></span>
</pre><p>Printing the details of the <code class="literal">LinearTrend</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; LinearTrend</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_013.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Finding out the possible exponential trend in the hurricane occurrence frequency:</p><p>The <code class="literal">glm()</code> function is used to fit generalized linear models. <code class="literal">frequency~years</code> defines the formula. <code class="literal">data = StormDamageData</code> defines the dataset for the formula. The <code class="literal">family=poisson(link="identity")</code> function signifies the Poisson distribution. We do this by using the following command:</p><pre class="programlisting">
<span class="strong"><strong>&gt; ExpTrend &lt;- glm(frequency~years, data=StormDamageData, family = poisson(link="log"))</strong></span>
</pre><p>Printing the details of <code class="literal">ExpTrend</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; ExpTrend</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_014.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Plotting the years and frequency count for hurricanes for each year between <code class="literal">1900</code> and <code class="literal">2005</code>: <code class="literal">plot()</code> is a generic function. years represents the <span class="emphasis"><em>x</em></span> coordinates of the plot, while frequency represents the y coordinates of the plot. <code class="literal">type="h"</code> represents the histogram representational style. The <code class="literal">ylim=c(0,6)</code> function sets the upper limit of the <span class="emphasis"><em>y</em></span> axis representation as <code class="literal">0</code> as the lower limit and <code class="literal">6</code> as the upper limit:</p><pre class="programlisting">
<span class="strong"><strong>&gt; plot(years, frequency, type='h', ylim=c(0,6), main = "No. of Major Hurricanes Predicted for 2014", xlim=c(1900,2020))</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_015.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Predicting the trend for 2014 based on the exponential trend: The <code class="literal">predict()</code> function is used to predict values based on the linear model object. <code class="literal">ExpTrend</code> represents the object of the class inheriting from <code class="literal">lm</code>. The <code class="literal">newdata = data.frame(years=1890:2030)</code> function represents the data frame in which to look for variables with which to predict:</p><pre class="programlisting">
<span class="strong"><strong>&gt; cpred1 &lt;- predict(ExpTrend, newdata = data.frame(years=1890:2030), type="response")</strong></span>
</pre><p>Printing the details of <code class="literal">cpred1</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; cpred1</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_016.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Joining the points of <code class="literal">cpred1</code> with line segments: <code class="literal">lines()</code> is a generic function that takes the value of the <code class="literal">cpred1</code> data frame as the coordinates of the <span class="emphasis"><em>y</em></span> axis and joins the corresponding points with line segments. <code class="literal">1890:2030</code> represents the <span class="emphasis"><em>x</em></span> axis:</p><pre class="programlisting">
<span class="strong"><strong>&gt; lines(1890:2030,cpred1,col="blue")</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_017.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Predicting the trend for 2014 based on the linear trend: The <code class="literal">predict()</code> function is used to predict values based on the linear model object. <code class="literal">LinearTrend</code> represents the object of the class inheriting from <code class="literal">lm</code>. The <code class="literal">newdata = data.frame(years=1890:2030)</code> function represents the data frame in which to look for variables with which to predict:</p><pre class="programlisting">
<span class="strong"><strong>&gt; cpred0 &lt;- predict(LinearTrend, newdata=data.frame(years=1890:2030), type="response")</strong></span>
</pre><p>Printing the details of <code class="literal">cpred0</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; cpred0</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_018.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Joining the points of <code class="literal">cpred0</code> with line segments: <code class="literal">lines()</code> is a generic function which takes the value of the <code class="literal">cpred0</code> data frame as coordinates of the <span class="emphasis"><em>y-</em></span>axis and joins the corresponding points with line segments. <code class="literal">1890:2030</code> represents the <span class="emphasis"><em>x</em></span>-axis:</p><pre class="programlisting">
<span class="strong"><strong>&gt; lines(1890:2030, cpred0, col="red"))</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_019.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Plotting the mean value: <code class="literal">abline()</code> as a function plots the straight line using the mean value of the <code class="literal">StormDamageData$frequency</code> which is <code class="literal">1.95283</code>. <code class="literal">h = mean(StormDamageData$frequency)</code> is the <span class="emphasis"><em>y</em></span>-value for horizontal line:</p><pre class="programlisting">
<span class="strong"><strong>&gt; abline(h = mean(StormDamageData$frequency), col="black")</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_020.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Combine the data frame values for the mean of the <code class="literal">StormDamageData$frequency</code>, <code class="literal">cpred0</code> and <code class="literal">cpred1</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; predictions &lt;- cbind(constant = mean(StormDamageData$frequency), linear = cpred0[126], exponential=cpred1[126])</strong></span>
</pre><p>Printing the details of the predictions:</p><pre class="programlisting">
<span class="strong"><strong>&gt; predictions</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_021.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>Plotting the points of the predictions on the graph for the year 2014:</p><pre class="programlisting">
<span class="strong"><strong>&gt; points(rep((1890:2030)[126],3), predictions, col=c("black","red","blue"), pch=19)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_022.jpg" alt="Step 5 - building predictive models"/></div><p>
</p><p>It is important to observe that by changing the predictive model there will be a change in the premium. With a flat prediction, there are less than two (major) hurricanes, but with the exponential trend, there are more than four (major) hurricanes.</p></div><div class="section" title="Step 6 - calculating the pure premium of the reinsurance contract"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl3sec175"/>Step 6 - calculating the pure premium of the reinsurance contract</h3></div></div></div><p>Now we find a suitable model to compute the premium of a reinsurance treaty, with a deductible and limited cover. Estimate the tail index using Hill's tail-index estimator as follows. <code class="literal">hill()</code> is the function for estimating the tail of the index of the heavy-tailed data, <code class="literal">base$Normalized.PL05</code>:</p><pre class="programlisting">
<span class="strong"><strong>&gt; hill(base$Normalized.PL05)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_023.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>The preceding figure shows that the costs of major hurricanes are heavy tailed.</p><p>Set the threshold of losses above 500 million for the Pareto model as follows:</p><pre class="programlisting">
<span class="strong"><strong>&gt; threshold &lt;- .5</strong></span>
</pre><p>We return an object of the class, <code class="literal">gpd</code>, representing the fit of a generalized Pareto model to excesses over a threshold (0.5) with the following command. The dataset is represented by <code class="literal">base$Normalized.PL05/1e9/20</code>:</p><pre class="programlisting">
<span class="strong"><strong>   &gt; gpd.PL &lt;- gpd(base$Normalized.PL05/1e9/20, threshold)$par.ests</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_024.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>Calculating the mean of the <code class="literal">base$Normalized.CL05/1e9/20</code> data frame above the threshold value of 0.5:</p><pre class="programlisting">
<span class="strong"><strong>&gt; mean(base$Normalized.CL05/1e9/20&gt; .5)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_025.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>Given that the loss exceeds 500 million, we can now compute the expected value of the reinsurance contract:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_026.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><pre class="programlisting">
<span class="strong"><strong>    &gt; ExpectedValue &lt;- function(yinf,ysup,xi,beta){</strong></span>
<span class="strong"><strong>    + as.numeric(integrate(function(x) (x-yinf) * dgpd(x,xi,mu=threshold,beta),</strong></span>
<span class="strong"><strong>    + lower=yinf,upper=ysup)$value +</strong></span>
<span class="strong"><strong>    + (1-pgpd(ysup,xi,mu=threshold,beta))*(ysup-yinf))</strong></span>
<span class="strong"><strong>    + }</strong></span>
</pre><p>Find the mean value of the predictions data frame as follows:</p><pre class="programlisting">
<span class="strong"><strong>&gt; predictions[1]</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_027.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>Calculating the mean of the <code class="literal">base$Normalized.PL05/1e9/20</code> data frame above the threshold value of 0.5:</p><pre class="programlisting">
<span class="strong"><strong>&gt; mean(base$Normalized.PL05/1e9/20&gt;.5)</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_028.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>This indicates that each hurricane has a 12.5% chance of costing more than 500 million for the insurance company.</p><p>Calculating the expected value of the reinsurance contract:</p><pre class="programlisting">
<span class="strong"><strong>&gt; ExpectedValue(2,6,gpd.PL[1],gpd.PL[2])*1e3</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_029.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p><p>This indicates that the expected repayment by the reinsurance company is about 330.9865 million.</p><p>Calculating the premium of the reinsurance contract:</p><pre class="programlisting">
<span class="strong"><strong>&gt; predictions[1] * mean(base$Normalized.PL05/1e9/20&gt; .5) * ExpectedValue(2, 6, gpd.PL[1], gpd.PL[2]) * 1e3</strong></span>
</pre><p>The result is as follows:</p><p>
</p><div class="mediaobject"><img src="graphics/image_13_030.jpg" alt="Step 6 - calculating the pure premium of the reinsurance contract"/></div><p>
</p></div></div></div></body></html>