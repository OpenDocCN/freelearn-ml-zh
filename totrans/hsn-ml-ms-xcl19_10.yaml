- en: Implementing Time Series
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现时间序列
- en: Time evolving phenomena are fundamental to many disciplines. Understanding what
    happened and foreseeing how different variables will evolve is key knowledge for
    making correct, informed decisions.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 时间演变的现象对许多学科至关重要。了解发生了什么，预测不同变量将如何演变，是做出正确、明智决策的关键知识。
- en: Time series analysis is a broad field, with many different methods to detect
    patterns, predict behaviors, and decompose the time evolution into known and previously
    studied shapes. We are going to discuss some of them, focusing on the ones that
    are easily solved using Excel. The idea, as usual, is that our machines learn
    about the details in the data and can extract useful knowledge about the past
    and the possible future developments.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析是一个广泛的领域，有许多不同的方法来检测模式、预测行为，并将时间演变分解为已知和先前研究过的形状。我们将讨论其中的一些，重点关注那些易于使用Excel解决的问题。通常的想法是，我们的机器学习数据中的细节，并从中提取关于过去和可能未来发展的有用知识。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Modeling and visualizing time series
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 建模和可视化时间序列
- en: Forecasting time series automatically in Excel
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Excel中自动预测时间序列
- en: Studying the stationarity of a time series
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 研究时间序列的平稳性
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: To complete this chapter, the reader will need to download the `AirPassengers_modified.csv` file
    from the GitHub repository at [https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter07](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter07).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成本章，读者需要从GitHub仓库[https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter07](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter07)下载`AirPassengers_modified.csv`文件。
- en: Modeling and visualizing time series
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建模和可视化时间序列
- en: We have seen that doing a preliminary data analysis and visualizing the dataset
    is the first step in any machine learning project. Time series are no exception.
    So, we will start by exploring time series and learning about its different characteristics.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到，进行初步数据分析和可视化数据集是任何机器学习项目的第一步。时间序列也不例外。因此，我们将首先探索时间序列，并了解其不同的特征。
- en: In the case of a time series, a preliminary analysis implies *modeling* it;
    that is, understanding whether it is periodic, whether it shows a given tendency
    (increasing or decreasing with time), or whether it is stationary (mean and variance
    of the values don't change over time), among other measures. Visualization plays
    a fundamental role in this analysis, since many of the time series characteristics
    can be deduced using a graphical representation of the data points, even if there
    are numerical methods to calculate them.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在时间序列的情况下，初步分析意味着对其进行**建模**；也就是说，了解它是否具有周期性，是否显示出某种趋势（随时间增加或减少），或者它是否是平稳的（值的均值和方差随时间不变），以及其他一些指标。可视化在这个分析中起着基本的作用，因为许多时间序列的特征可以通过数据点的图形表示来推断，即使有数值方法可以计算它们。
- en: 'Let''s use a popular dataset to illustrate the modeling and visualization of
    a time series. The `AirPassengers_modified.csv` file is a simplified version of
    a very popular dataset, usually shown as an example when teaching time series
    analysis (source: *Box, G. E. P., Jenkins, G. M. and Reinsel, G. C. (1976) Time
    Series Analysis, Forecasting and Control. Third Edition. Holden-Day. Series G*).
    Our version contains the amount of international passengers (in thousands) that
    traveled by plane between 1949 and 1961, grouped by month. After loading the file
    the usual way (Data | From Text/CSV), we can visualize the time series in the
    following diagram, where we can see the number of passengers as a function of
    time:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用一个流行的数据集来说明时间序列的建模和可视化。`AirPassengers_modified.csv`文件是一个非常流行的数据集的简化版本，通常在教授时间序列分析时作为示例（来源：*Box,
    G. E. P., Jenkins, G. M. and Reinsel, G. C. (1976) 时间序列分析、预测与控制。第三版。Holden-Day.
    Series G*）。我们的版本包含1949年至1961年间通过飞机旅行的国际乘客数量（以千为单位），按月分组。通过常规方式（数据 | 从文本/CSV）加载文件后，我们可以在以下图表中可视化时间序列，其中我们可以看到乘客数量作为时间的函数：
- en: '![](img/19b36db8-a0d5-494a-a5e8-dcc305bd984f.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图表](img/19b36db8-a0d5-494a-a5e8-dcc305bd984f.png)'
- en: The first thing that we notice is that the number of passengers increases with
    time. Then, if we look carefully at the peaks in the series, there is a 12-month
    pattern that seems to repeat. Let's prove this observation with the data.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先注意到乘客数量随时间增加。然后，如果我们仔细观察序列中的峰值，似乎有一个12个月的重复模式。让我们用数据来证明这个观察结果。
- en: 'The easiest way to get a trend is to use Excel''s built-in capability to calculate
    trends. To use it, follow these steps:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 获取趋势的最简单方法是用Excel内置的趋势计算功能。要使用它，请按照以下步骤操作：
- en: Click on the chart area.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击图表区域。
- en: Check the box for Trendline.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 勾选“趋势线”复选框。
- en: 'Click on `More Options...`*, *as shown in the following screenshot:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“更多选项...”，如以下截图所示：
- en: '![](img/42bae62a-8491-43bc-bb00-6106d299b054.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/42bae62a-8491-43bc-bb00-6106d299b054.png)'
- en: 'The first selection will show the line in the chart and then, after selecting
    More options...,we can check the box to see the line equation expression on the
    chart. Notice that Linear is not the only option for a trend line and that more
    sophisticated regressions are available, as shown in the following screenshot:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个选择将显示图表中的线条，然后，在选择了“更多选项...”之后，我们可以勾选复选框以在图表上查看线条方程表达式。请注意，线性并不是趋势线的唯一选项，更复杂的回归分析也是可用的，如以下截图所示：
- en: '![](img/516e6884-4124-487b-b84e-6f3dbf3a05ca.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/516e6884-4124-487b-b84e-6f3dbf3a05ca.png)'
- en: 'The resulting equation, as shown on the chart, is as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如图表上所示的结果方程如下：
- en: '*Passengers = 0.0873*TravelDate - 1472*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*乘客数 = 0.0873*旅行日期 - 1472*'
- en: 'Looking at the resulting plot, we see that a straight line does not correctly
    follow the time evolution of the series. Some parts are mostly above the line
    and others below, as you can see in the following chart:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 观察生成的图表，我们看到一条直线并不能正确地跟随序列的时间演变。一些部分大部分在直线上方，而其他部分在直线下方，如以下图表所示：
- en: '![](img/a7f7282b-3225-457a-a9ec-0b9b689f1ddb.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a7f7282b-3225-457a-a9ec-0b9b689f1ddb.png)'
- en: 'How can we model the general behavior of the dataset? We can start by realizing
    that we could think about the series as composed of three parts:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何对数据集的一般行为进行建模？我们可以先意识到，我们可以将序列视为由三部分组成：
- en: A periodic part, which repeats every 12 months (we guess this because of the
    periodicity of the peaks, and call this 12 month period a *season*)
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个周期性部分，它每12个月重复一次（我们猜测这是由于峰值的周期性，我们将这个12个月周期称为*季节*）
- en: An increasing part, which we can obtain by regression or averaging the series
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个*增长*部分，我们可以通过回归或平均序列来获得
- en: A *noise* part, which we basically define as the remaining values once we isolate
    the first two parts
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个*噪声*部分，我们基本上将其定义为一旦我们隔离前两部分后剩下的值
- en: 'This model can then be written as follows:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型可以写成以下形式：
- en: '![](img/ef826447-abb0-4fe1-b7c1-928cf3dda60c.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ef826447-abb0-4fe1-b7c1-928cf3dda60c.png)'
- en: 'Let''s improve the calculation of the *increasing* part by using a moving average.
    This can be calculated automatically by Excel, but we will do it manually since
    it is simple and we can understand exactly how it works:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过使用移动平均来改进*增长*部分的计算。这可以通过Excel自动计算，但我们将手动进行，因为它很简单，我们可以确切地了解它是如何工作的：
- en: 'Start by calculating the average number of passengers in the first 12 months:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先计算前12个月的平均乘客数：
- en: '*=AVERAGE(B2:B13)*'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '*=AVERAGE(B2:B13)*'
- en: 'In the cell to the right, calculate the standard deviation (we will use it
    in the next section, when we test the stationarity of the series):'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在右侧的单元格中，计算标准差（我们将在下一节中使用它，当我们测试序列的平稳性时）：
- en: '*=STDEV.S(B2:B13)*'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '*=STDEV.S(B2:B13)*'
- en: Copy both calculations down to the end of the table.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这两个计算复制到表格的末尾。
- en: 'We then have the mean value and standard deviation of the previous 12 months in
    each pair of cells. In practice, we are defining a moving 12-month window and
    sliding it through the data. The resulting table looks similar to the following
    screenshot:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们就有前12个月的平均值和标准差，在每个单元格对中。在实践中，我们正在定义一个移动的12个月窗口，并滑动它通过数据。生成的表格看起来类似于以下截图：
- en: '![](img/22108a4a-5c18-4128-95e9-fb660f5bf21d.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/22108a4a-5c18-4128-95e9-fb660f5bf21d.png)'
- en: 'The first 12 places are obviously empty, since we need at least 12 values to
    start averaging. If we show everything in the same diagram, we will see a graph
    similar to the following:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 前十二位显然是空的，因为我们至少需要12个值来开始平均。如果我们把所有内容都放在同一个图表中，我们会看到一个类似于以下图表的图形：
- en: '![](img/77ac6e51-775d-46c4-8157-1681769b8294.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/77ac6e51-775d-46c4-8157-1681769b8294.png)'
- en: The moving average follows the details of the series better, and we are going
    to use it as a good approximation for *increasing(TravelDate)*.Notice that the
    moving standard deviation also increases with time, we will use this result in
    the next section.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 移动平均更好地遵循序列的细节，我们将用它作为*increasing(TravelDate)*的良好近似。注意，移动标准差也随时间增加，我们将在下一节中使用这个结果。
- en: 'Going back to our model for the time series, we can write:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 回到我们为时间序列建立的模式，我们可以写出：
- en: '![](img/6cf3a409-3e45-403d-a258-b2294ab742b9.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6cf3a409-3e45-403d-a258-b2294ab742b9.png)'
- en: The ratio is between the column *Passengers* and the moving average calculated
    right before. You will be missing the first 12 points, since the average need
    to start somewhere, but that is fine. For the rest of the rows you can calculate
    *Passengers/Moving Average*, which approximates *Passengers/increasing(TravelDate)*.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这个比率是在*Passengers*列和之前计算的移动平均之间。由于平均值需要从某个地方开始，所以你会缺少前12个点，但这没关系。对于其余的行，你可以计算*Passengers/Moving
    Average*，这近似于*Passengers/increasing(TravelDate)*。
- en: Add an extra column to calculate this ratio.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个额外的列来计算这个比率。
- en: 'Build a new diagram to show the calculation. You will see something like the
    following graph:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 建立一个新的图表来显示计算。你会看到以下类似的图表：
- en: '![](img/41c4d0e4-51b0-4cc6-9e1f-58fc1af80414.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/41c4d0e4-51b0-4cc6-9e1f-58fc1af80414.png)'
- en: We clearly managed to extract the increasing part, but we still have a mixture
    of oscillations and noise. Let's model *periodic(TravelDate) by *repeating the
    first 12 values in sequence.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们清楚地提取了增长部分，但我们仍然有振荡和噪声的混合。让我们通过重复前12个值来按顺序模拟*periodic(TravelDate)*。
- en: 'In a new column, copy and paste the first 12 values as many times as you need
    to fill the same number of cells. These values will give you the following graph:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在新列中，根据需要复制粘贴前12个值以填充相同数量的单元格。这些值将给出以下图表：
- en: '![](img/8bbdbf33-83cd-43bc-992e-7ac2a991185d.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8bbdbf33-83cd-43bc-992e-7ac2a991185d.png)'
- en: 'Finally, we will calculate *noise(TravelDate)*. We will, again, calculate this
    from our model:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将计算*noise(TravelDate)*。我们再次将从我们的模型中计算这个值：
- en: '![](img/72e26bb2-5c75-41c4-b78d-357bcbad2333.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/72e26bb2-5c75-41c4-b78d-357bcbad2333.png)'
- en: 'In another column, use the preceding calculation to create a new diagram:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在另一列中，使用前面的计算创建一个新的图表：
- en: '![](img/8d3c1419-fe81-4f79-8ed6-013b3f0359fd.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8d3c1419-fe81-4f79-8ed6-013b3f0359fd.png)'
- en: 'We now have a full model of the time series and we can use it to predict the
    future values! Let''s do it step by step:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了时间序列的完整模型，我们可以用它来预测未来的值！让我们一步一步来做：
- en: Open a new sheet.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的工作表。
- en: Copy the series values and extend the time period up to `Dec-62`.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制序列值并扩展时间范围至`Dec-62`。
- en: In column `C`, copy the *periodic(TravelDate)* values (24 values in two equal
    series of 12 values).
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`C`列中，复制*periodic(TravelDate)*值（两个12个值的相等序列中的24个值）。
- en: In column `D`, copy the noise values corresponding to the last two years.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`D`列中，复制对应于最后两年的噪声值。
- en: In column `E`, cell 146, calculate *increasing(TravelDate)* using the trendline
    formula (*=0.0873*A146 - 1472*).
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`E`列的第146个单元格中，使用趋势线公式(*=0.0873*A146 - 1472*)计算*increasing(TravelDate)*。
- en: 'Copy the formula down to the end of the table. Cell `B1` is then as follows:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将公式向下复制到表格末尾。然后单元格`B1`如下：
- en: '*=C146*D146*E146*'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*=C146*D146*E146*'
- en: 'The same calculation is then copied down. The resulting table is as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然后将相同的计算向下复制。得到的表格如下：
- en: '![](img/01f5b1a4-26c7-4e4b-bbe7-63c7ad0c56bf.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](img/01f5b1a4-26c7-4e4b-bbe7-63c7ad0c56bf.png)'
- en: Insert a new diagram, including the two data series, original and predicted.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入一个新的图表，包括原始和预测的两个数据序列。
- en: 'In the following graph, you can see that the prediction is pretty good! (Or,
    at least it follows the historical data; the only real measure of the prediction
    quality is to compare it with real data for those dates):'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在以下图表中，你可以看到预测相当准确！（或者至少它遵循了历史数据；预测质量的唯一真正衡量标准是将它与那些日期的真实数据进行比较）：
- en: '![](img/bf563981-effb-457c-90f4-9779ab03347d.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bf563981-effb-457c-90f4-9779ab03347d.png)'
- en: We have followed the necessary steps to model a time series based on its characteristics
    and extensively using calculations and visualizations. We will show in the next
    section that this can also be achieved automatically by using Excel's built-in
    capabilities.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经遵循了必要的步骤，根据其特征对时间序列进行建模，并广泛使用计算和可视化。我们将在下一节中展示这也可以通过使用Excel的内置功能自动实现。
- en: Forecasting time series automatically in Excel
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Excel中自动预测时间序列
- en: 'Now that we have forecast a time series the hard way, understanding every step,
    we can do it the easy way. We will use Excel''s built-in functions to predict
    the future number of passengers. Perform the following steps:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经艰难地预测了时间序列，理解了每一步，我们可以用简单的方法来做。我们将使用Excel的内置函数来预测未来乘客数量。执行以下步骤：
- en: Select both columns, `TravelDate` and `Passengers`,corresponding to the time
    and number of passengers.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择两个列，`TravelDate`和`Passengers`，对应于时间和乘客数量。
- en: Navigate to Datain the main menu.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在主菜单中导航到“数据”：
- en: 'Select Forecast Sheet (see the following screenshot for reference):'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择预测工作表（参考以下截图）：
- en: '![](img/c11c995a-ec99-4c7c-8d29-805e5afbe65b.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/c11c995a-ec99-4c7c-8d29-805e5afbe65b.png)'
- en: 'A window will pop up, showing a preview of the forecast and giving us the chance
    to change some parameters by clicking in Options:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将弹出一个窗口，显示预测预览，并允许我们通过点击“选项”来更改一些参数：
- en: '**Forecast End**: We can choose the end of the forecast period. By default,
    Excel forecasts three seasons ahead (more on this to follow).'
  id: totrans-77
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测结束**：我们可以选择预测期的结束。默认情况下，Excel预测三个季节之后（更多内容将在后面介绍）。'
- en: '**Forecast Start**: We can do the same with the start of the forecast period.
    Default is the last point in time of our time series.'
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测开始**：我们可以对预测期的开始做同样的处理。默认是我们时间序列的最后一点时间。'
- en: '**Confidence interval**: Thisis defined as the range centered on every predicted
    value, in which 95% of the predicted points will fall (assuming a normal distribution
    of the forecast points).'
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信区间**：这定义为围绕每个预测值的范围，其中95%的预测点将落在其中（假设预测点的正态分布）。'
- en: '**Seasonality**: A season is the period in which a time series repeats it pattern
    (if it is periodic, of course). It can be added manually or detected automatically.'
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**季节性**：季节是时间序列重复其模式（如果它是周期性的，当然）的时期。它可以手动添加或自动检测。'
- en: 'The following graph shows the pop-up window containing the available options:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表显示了包含可用选项的弹出窗口：
- en: '![](img/e3706936-75b3-4659-b525-a916133c97ad.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/e3706936-75b3-4659-b525-a916133c97ad.png)'
- en: Timeline Range and Values Range are the selected columns (in our case `TravelDate`
    and `Passenger`).
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 时间范围和值范围是选定的列（在我们的案例中是`TravelDate`和`Passenger`）。
- en: 'Clicking on Create*, *we obtain three new columns: `Forecast`, `Lower Confidence
    Bounds (Passengers)`, and `Upper Confidence Bounds (Passengers)`:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“创建”，我们获得三个新列：`Forecast`、`Lower Confidence Bounds (Passengers)`和`Upper Confidence
    Bounds (Passengers)`：
- en: '![](img/35e7ad5d-8053-4c7d-b050-b2338b1229d6.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/35e7ad5d-8053-4c7d-b050-b2338b1229d6.png)'
- en: 'We will also see the following diagrams, showing the time series plus the forecasted
    values:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还将看到以下图表，显示时间序列加上预测值：
- en: '![](img/6d3e7e9a-0e68-4f7e-b558-992eda82f225.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/6d3e7e9a-0e68-4f7e-b558-992eda82f225.png)'
- en: 'If we select Include forecast statistics in the pop-up window, we get the following
    table:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在弹出窗口中选择“包含预测统计信息”，我们将得到以下表格：
- en: '![](img/bb46d482-bf4e-4a89-889a-1e4ec3fe2d4d.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![截图](img/bb46d482-bf4e-4a89-889a-1e4ec3fe2d4d.png)'
- en: 'This values correspond to Excel''s built-in *FORECAST.ETS.STAT* function used
    internally by the forecast algorithm. The meaning of these values are as follows:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这些值对应于Excel内置的*FORECAST.ETS.STAT*函数，该函数是预测算法内部使用的。这些值的含义如下：
- en: '**Alpha**: This measures the weight given to the data points. A higher value
    means that we are giving a higher weight to recent data points.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Alpha**：这衡量了赋予数据点的权重。值越高意味着我们给予最近的数据点更高的权重。'
- en: '**Beta**: This measures the weight given to the trend. A higher value means
    that we are giving a higher weight to the recent trend.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Beta**：这衡量了赋予趋势的权重。值越高意味着我们给予最近趋势更高的权重。'
- en: '**Gamma**: This measures the weight given to the season. A higher value means
    that we are giving a higher weight to the recent seasonal period.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Gamma**：这衡量了赋予季节的权重。值越高意味着我们给予最近季节周期更高的权重。'
- en: '**Mean Absolute Scaled Error (MASE)**: This measures the accuracy of the forecasts.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对缩放误差 (MASE)**：这衡量了预测的准确性。'
- en: '**Symmetric Mean Absolute Percentage Erro****r (SMAPE)**: This measures the
    accuracy based on percentage errors.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对称平均绝对百分比误差 (SMAPE)**：这基于百分比误差来衡量准确性。'
- en: '**Mean Absolute Percentage Error** **(AE)**: This measures the accuracy based
    on percentage errors.'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平均绝对百分比误差 (MAPE)**：这基于百分比误差来衡量准确性。'
- en: '**Root Mean Squared Error (RMSE)**: This measures the differences between predicted
    and observed values.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**均方根误差 (RMSE)**：这衡量预测值和观察值之间的差异。'
- en: We have explained how to use Excel's built-in capabilities to analyze and forecast
    time series. In the next section, we will focus on the importance of time series
    stationarity.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经解释了如何使用 Excel 的内置功能来分析和预测时间序列。在下一节中，我们将关注时间序列平稳性的重要性。
- en: Studying the stationarity of a time series
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 研究时间序列的平稳性
- en: Most methods for a time series forecast rely on the fact that the series is
    stationary. This makes sense, since this increases the probability of repeating
    a certain behavior in the future and makes the prediction easier.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时间序列预测方法都依赖于序列是平稳的这一事实。这是有道理的，因为这增加了在未来重复某种行为的概率，并使预测变得更容易。
- en: 'How can we know whether a given time series is stationary or not? There are
    formal, statistical methods to measure this, but we can also look at some properties
    of the series. There are three main checks of stationarity in practice:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何知道给定的时间序列是否平稳？有正式的统计方法来衡量这一点，但我们也可以查看序列的一些属性。在实践中，有三个主要的平稳性检查：
- en: The mean value is constant (does not depend on time).
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 均值是恒定的（不依赖于时间）。
- en: The variance is constant.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 方差是恒定的。
- en: The covariance of the elements *i* and *i+m* is constant.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 元素 *i* 和 *i+m* 的协方差是恒定的。
- en: In our previous example, in the *Modeling and visualizing time series* section,
    we plotted the moving average (mean) and variance. If you revisit the diagram,
    you will see that none of them is constant with time, hence the series is non-stationary,
    and we had to model it to be able to forecast values.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们之前的例子中，在 *建模和可视化时间序列* 部分中，我们绘制了移动平均（均值）和方差。如果您重新访问该图表，您会看到它们都不是随时间恒定的，因此序列是非平稳的，我们必须对其进行建模才能预测值。
- en: A more formal statistical test is the *Dickey-Fuller test*, which is out of
    the scope of this book. This test is not automatically done by Excel, but there
    are a large number of add-ins that can perform it. Doing it manually makes no
    sense.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 更正式的统计测试是 *Dickey-Fuller 测试*，这超出了本书的范围。这个测试不是由 Excel 自动完成的，但有许多插件可以执行它。手动执行它没有意义。
- en: 'There are two ways of removing seasonality and trend:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种方法可以去除季节性和趋势：
- en: The technique of decomposing the series into noise, periodic, and increasing
    terms.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将序列分解为噪声、周期性和增长项的技术。
- en: Differencing – that is, creating a new series by taking the difference between
    the values *i* and (*i+m*). The position difference, *m* is known as **lag**.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 差分——即通过取值 *i* 和 (*i+m*) 之间的差值来创建一个新的序列。位置差， *m* 被称为**滞后**。
- en: You have now seen different methods for predicting the evolution of a time series,
    based on a detailed understanding of its characteristics. We will show more advanced
    forecasting methods, such as ARIMA, when we discuss using Azure machine learning
    models from Excel in [Chapter 10](c4a815b7-95bc-4573-89cf-0399d293e3f6.xhtml),
    *Azure and Excel – Machine Learning in the Cloud*.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在已经看到了基于对时间序列特征详细理解的不同预测方法。当我们讨论在 [第 10 章](c4a815b7-95bc-4573-89cf-0399d293e3f6.xhtml)
    中使用 Azure 机器学习模型时，我们将展示更多高级预测方法，例如 ARIMA。
- en: Visualization was also a key element throughout the analysis shown in the present
    chapter. We will see different visualization techniques in the next chapter, focusing
    in their particular use cases.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 可视化也是本章展示的分析过程中的一个关键要素。我们将在下一章中看到不同的可视化技术，重点关注它们的特定用例。
- en: Summary
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: We have seen a step-by-step method to decompose a time series and forecast its
    future values. This can help us, at least in general terms, to predict the outcome
    of different processes. Time series can be studied both graphically and numerically,
    extracting their characteristics and using them to understand how they will behave
    in the future. We have also seen that this can be done automatically in Excel,
    with the risk of using it as a black box and not understanding the full forecasting
    method. More advanced techniques exist, and we will discuss them in future chapters.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到了分解时间序列并预测其未来值的逐步方法。这至少在一般术语上可以帮助我们预测不同过程的结局。时间序列可以图形化和数值化地研究，提取其特征，并使用它们来理解它们在未来的行为。我们还看到，这可以在
    Excel 中自动完成，但存在将其作为黑盒使用而不理解完整预测方法的风险。存在更高级的技术，我们将在未来的章节中讨论它们。
- en: The next chapter will show you how to build some basic diagrams in Excel and
    how to use them to gain insights on your datasets.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将向您展示如何在 Excel 中构建一些基本图表以及如何使用它们来深入了解您的数据集。
- en: Questions
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: In our forecast, we modeled the increasing part of the time series using the
    trend function generated by Excel. We could also have used the moving average
    values. How can that be done? Try it and compare the results.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们的预测中，我们使用 Excel 生成的趋势函数来模拟时间序列的增长部分。我们也可以使用移动平均值。这该如何操作？尝试一下，并比较结果。
- en: Change the values of the seasonality and confidence interval and study how the
    forecast diagram and parameters change.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改季节性和置信区间的值，并研究预测图和参数如何变化。
- en: How can you calculate the covariance between two values in a time series?
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你如何计算时间序列中两个值的协方差？
- en: A possible way to make the variance independent of time is to take the logarithm
    of the time series values. Try this in the air passengers series and check the
    values of the variance.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使方差与时间无关的可能方法是对时间序列值取对数。在航空乘客数据序列中尝试这种方法，并检查方差值。
- en: Further reading
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Time Series Analysis and Its Applications*, by R.H. Shumway and D.S. Stoffer'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《时间序列分析与应用》，作者 R.H. Shumway 和 D.S. Stoffer
- en: '*An Introductory Study on Time Series Modeling and Forecasting*, by Ratnadip
    Adhikari R. K. Agrawal'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《时间序列建模与预测导论研究》，作者 Ratnadip Adhikari R. K. Agrawal
