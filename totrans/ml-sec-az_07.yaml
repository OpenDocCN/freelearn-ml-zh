- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Managing and Securing Your Azure Machine Learning Workspace
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理和保护您的 Azure Machine Learning 工作空间
- en: After data and access management comes infrastructure. Although Azure Machine
    Learning is a cloud service, it doesn’t mean that we cannot leverage services
    together with our Azure or on-premises infrastructure to isolate our resources
    and secure them from public access.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据和访问管理之后是基础设施。尽管 Azure Machine Learning 是一种云服务，但这并不意味着我们不能利用 Azure 或本地基础设施的服务来隔离我们的资源并保护它们免受公共访问。
- en: In this chapter, we will learn how to implement security best practices regarding
    the workspace. We will focus more on practices and scenarios around virtual networking
    and endpoint security as well as compute. Compute in Azure Machine Learning can
    be used both for model training and deployment and each option available has its
    own security best practices. Compute includes compute instances, compute clusters,
    and containers. The workspace uses Azure Container Registries to deploy models
    that can be deployed as containers, so we will review security options for all
    those services.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何实施有关工作空间的安全最佳实践。我们将更多地关注虚拟网络、端点安全和计算方面的实践和场景。Azure Machine Learning
    中的计算既可以用于模型训练和部署，每个选项都有其自己的安全最佳实践。计算包括计算实例、计算集群和容器。工作空间使用 Azure 容器注册表来部署可以作为容器部署的模型，因此我们将回顾所有这些服务的安全选项。
- en: 'In this chapter, we’re going to cover the following main topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要主题：
- en: Exploring network security
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索网络安全
- en: Working with Azure Machine Learning compute
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Azure Machine Learning 计算资源
- en: Managing container registries and containers
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理容器注册表和容器
- en: By the end of this chapter, we will know how to implement best practices and
    isolate our Azure Machine Learning workspace and its associated resources by using
    virtual networking in Azure.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，我们将了解如何通过在 Azure 中使用虚拟网络来实现最佳实践，并隔离我们的 Azure Machine Learning 工作空间及其相关资源。
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: This chapter deals heavily with networking and infrastructure in Azure. Although
    the tutorials can be implemented without much difficulty, properly implementing
    and maintaining a network architecture in Azure requires a lot of knowledge.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章大量涉及 Azure 中的网络和基础设施。尽管教程可以相对容易地实现，但在 Azure 中正确实施和维护网络架构需要大量的知识。
- en: 'If you have no experience with networking in Azure, I recommend taking a look
    at this overview of the service before moving on with the chapter:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有在 Azure 中使用网络的经验，我建议在继续本章之前先查看以下服务的概述：
- en: '**Virtual** **Networks overview**:'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**虚拟网络概述**：'
- en: '[https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview)'
  id: totrans-13
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview)'
- en: '**Networking** **architecture design**:'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络架构设计**：'
- en: '[https://learn.microsoft.com/en-us/azure/architecture/guide/networking/networking-start-here](https://learn.microsoft.com/en-us/azure/architecture/guide/networking/networking-start-here)'
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/architecture/guide/networking/networking-start-here](https://learn.microsoft.com/en-us/azure/architecture/guide/networking/networking-start-here)'
- en: Exploring network security
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索网络安全
- en: The Azure Machine Learning workspace is the main point of use. This is where
    you complete all your ML tasks, and by default, all endpoints and workspace have
    access to the public internet. However, if we are already using Azure infrastructure
    services for different purposes or want to restrict access to our resources, we
    can leverage **virtual networks** (**VNets**). Using VNets in Azure provides an
    extra layer of security and isolation for our Azure Machine Learning resources
    and better control for inbound and outbound network communications. In this section,
    we will explore several options we have to integrate VNets with Azure Machine
    Learning.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Machine Learning 工作空间是主要的使用点。这是你完成所有机器学习任务的地方，默认情况下，所有端点和工作空间都可以访问公共互联网。然而，如果我们已经使用
    Azure 基础设施服务用于不同的目的或想要限制对我们资源的访问，我们可以利用 **虚拟网络**（**VNet**）。在 Azure 中使用 VNet 为我们的
    Azure Machine Learning 资源提供了额外的安全层和隔离，以及更好的入站和出站网络通信控制。在本节中，我们将探讨我们将如何将 VNet 集成到
    Azure Machine Learning 中的几个选项。
- en: Let us start with the workspace.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从工作空间开始。
- en: Creating a VNet
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建 VNet
- en: 'The first thing we will need is a VNet. If you already have one, you can use
    it. If not, you can follow the next steps to create one:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先需要的是一个 VNet。如果你已经有了，你可以使用它。如果没有，你可以按照以下步骤创建一个：
- en: 'Search for **Virtual Networks** in the Azure search bar and click to create
    a new one. The create form will pop up. Choose the **Subscription** and **Resource
    group** and provide a **Virtual network name** and **Region** as shown in the
    following screenshot. Choose the same region as your workspace:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 7.1 – Filling in basic details](img/B21076_07_1.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
- en: Figure 7.1 – Filling in basic details
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: 'Click **Next** and leave the default values until you reach the **IP addresses**
    tab. Make sure the address space is adequate and that there is at least one subnet
    available. An example is shown in the following screenshot:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 7.2 – Add the address space](img/B21076_07_2.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
- en: Figure 7.2 – Add the address space
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: VNet best practice
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: Make sure the address space and subnet do not overlap with other networks in
    your subscription or on-premises systems. If you need more guidance on creating
    a VNet architecture, see more information at [https://learn.microsoft.com/en-us/azure/virtual-network/concepts-and-best-practices](https://learn.microsoft.com/en-us/azure/virtual-network/concepts-and-best-practices).
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: Click **Review + create** to create the VNet. Wait for the process to complete
    before you move forward with anything else.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now we are ready to start restricting access to our workspace using VNets.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: Securing the workspace
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Restricting public access to the workspace is very easily configurable through
    the Azure portal and can restrict all inbound and/or outbound connections. When
    we are talking about inbound traffic, we refer to connections coming into the
    Azure ML workspace or associated resources from the public internet. This can
    be data being ingested into the Azure ML workspace from on-premises locations,
    from other cloud resources, or from external applications and platforms. When
    you submit a dataset, a job, or any other request from your local machine to Azure
    Machine Learning, that’s considered inbound traffic. Outbound traffic is any connection
    leaving the workspace or associated resources to go elsewhere. This can be the
    results from a machine learning model, processed data, logs, and so on being sent
    back to your local machine, another cloud resource, or an external application
    or platform.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: The challenge is to make sure that all associated services to the workspace
    are also accessible and configured properly through that virtual network and not
    the public internet. Something else we need to consider when designing and implementing
    this solution is that the workspace needs to have outbound access to specific
    endpoints via the public internet. If we want to restrict outbound access as well,
    we need to ensure that these endpoints maintain their public access.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: Let us see how we can configure both options.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Restricting inbound traffic
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To restrict inbound traffic from the public internet, we need to use a VNet,
    which we learned how to configure in the preceding section. Here is the process
    of disabling public access and using a VNet with our workspace.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: 'First, open the Azure Machine Learning resource from the Azure portal and find
    the **Networking** section. In the first tab, called **Public access**, set the
    access to **Disabled** and click **Save,** as shown in the next screenshot:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，从 Azure 门户打开 Azure 机器学习资源，找到**网络**部分。在第一个选项卡，称为**公共访问**，将访问设置为**禁用**，然后点击**保存**，如图所示的下个截图：
- en: '![Figure 7.3 – Disable public access](img/B21076_07_3.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.3 – 禁用公共访问](img/B21076_07_3.jpg)'
- en: Figure 7.3 – Disable public access
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3 – 禁用公共访问
- en: Now we need to create a private endpoint connection. Azure Private Link is a
    service in Microsoft’s Azure cloud platform that enables you to securely access
    Azure services over a private endpoint in your virtual network, thus avoiding
    data exposure to the public internet. With Azure Private Link, Azure services
    can be accessed over a private IP address in your virtual network. This provides
    several benefits. If your virtual network is connected to on-premises work environments
    via a **virtual private network** (**VPN**) or ExpressRoute, resources can access
    the Azure service over these private connections with the use of Azure Private
    Link. Using global VNet peering, we can connect to Azure services from any region.
    Azure Private Link integrates with Azure Private DNS zones, meaning that the service’s
    private endpoint can be registered with a private DNS zone, thus making name resolution
    more straightforward.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要创建一个私有端点连接。Azure 私有链接是 Microsoft Azure 云平台中的一个服务，它允许你通过虚拟网络中的私有端点安全地访问
    Azure 服务，从而避免将数据暴露给公共互联网。使用 Azure 私有链接，Azure 服务可以通过虚拟网络中的私有 IP 地址进行访问。这提供了几个好处。如果你的虚拟网络通过**虚拟专用网络**（VPN）或
    ExpressRoute 连接到本地工作环境，资源可以使用 Azure 私有链接通过这些私有连接访问 Azure 服务。使用全局 VNet 对等连接，我们可以从任何区域连接到
    Azure 服务。Azure 私有链接与 Azure 私有 DNS 区域集成，这意味着服务的私有端点可以注册到私有 DNS 区域，从而使名称解析更加简单。
- en: Setting up a private endpoint is a straightforward process in the Azure portal.
    Once set up, all network traffic between the service provider and the service
    consumer can be routed through the private endpoint. So, now that we have disabled
    public access, we need to create a private link to re-establish access this time
    via the virtual network.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Azure 门户中设置私有端点是一个简单的过程。一旦设置完成，服务提供者和服务消费者之间的所有网络流量都可以通过私有端点进行路由。因此，现在我们已经禁用了公共访问，我们需要创建一个私有链接来通过虚拟网络重新建立这次访问。
- en: Virtual network peering
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟网络对等连接
- en: 'To learn more about Vnet peering, visit the following URL:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 Vnet 对等连接的信息，请访问以下网址：
- en: '[https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview)'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview)'
- en: 'Here is the creation process for the private links/endpoints. Move on to the
    next tab, **Private endpoint connections**, and click on **Private endpoint**
    to create one:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是创建私有链接/端点的过程。转到下一个选项卡，**私有端点连接**，然后点击**私有端点**来创建一个：
- en: '![Figure 7.4 – Creating a private endpoint](img/B21076_07_4.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.4 – 创建私有端点](img/B21076_07_4.jpg)'
- en: Figure 7.4 – Creating a private endpoint
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4 – 创建私有端点
- en: 'On the form, fill in some basic details including **Subscription**, **Resource
    group**, **Network interface name**, and **Region** and click **Next** as shown
    here:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在表单中填写一些基本详情，包括**订阅**、**资源组**、**网络接口名称**和**区域**，然后点击**下一步**，如图所示：
- en: '![Figure 7.5 – Filling in the basic details](img/B21076_07_5.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.5 – 填写基本详情](img/B21076_07_5.jpg)'
- en: Figure 7.5 – Filling in the basic details
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5 – 填写基本详情
- en: 'On the **Resource** tab, choose **amlworkspace** from the dropdown and click
    **Next**:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在**资源**选项卡中，从下拉菜单中选择**amlworkspace**，然后点击**下一步**：
- en: '![Figure 7.6 – Choosing the resource](img/B21076_07_6.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.6 – 选择资源](img/B21076_07_6.jpg)'
- en: Figure 7.6 – Choosing the resource
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6 – 选择资源
- en: Here, we will choose the desired VNet. You have to choose an existing one, so
    use the one we created previously. Make sure you select the proper subnet if your
    VNet has more than one. Leave the rest of the options as **default**.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将选择所需的虚拟网络。你必须选择一个现有的虚拟网络，所以请使用我们之前创建的那个。如果你的虚拟网络有多个子网，请确保选择正确的子网。其余选项保留为**默认**。
- en: '![Figure 7.7 – Selecting the virtual network](img/B21076_07_7.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.7 – 选择虚拟网络](img/B21076_07_7.jpg)'
- en: Figure 7.7 – Selecting the virtual network
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.7 – 选择虚拟网络
- en: Integrating with a DNS zone is optional but convenient, as it makes name resolution
    easier. Set the **Integrate with private DNS zone** option to **Yes** and then
    choose the **Subscription** and **Resource group**. The service will fill out
    the rest of the fields.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 与DNS区域集成是可选的但方便的，因为它使名称解析更容易。将**与私有DNS区域集成**选项设置为**是**，然后选择**订阅**和**资源组**。服务将填写其余字段。
- en: '![Figure 7.8 – Adding DNS integration](img/B21076_07_8.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![图7.8 – 添加DNS集成](img/B21076_07_8.jpg)'
- en: Figure 7.8 – Adding DNS integration
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 – 添加DNS集成
- en: DNS zones overview
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: DNS区域概述
- en: 'To learn more about DNS zones check the overview here:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于DNS区域的信息，请在此处查看概述：
- en: '[https://learn.microsoft.com/en-us/azure/dns/dns-zones-records](https://learn.microsoft.com/en-us/azure/dns/dns-zones-records)'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/dns/dns-zones-records](https://learn.microsoft.com/en-us/azure/dns/dns-zones-records)'
- en: Now move on to **Review + create** and start the deployment of the resources.
    Wait for this process to be completed before moving on with any other steps.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 现在转到**审查 + 创建**并开始部署资源。在继续进行任何其他步骤之前，等待此过程完成。
- en: Creating a private Link via the CLI
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 通过CLI创建私有链接
- en: 'For creating a private link, you can learn more here:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 关于创建私有链接，您可以在此处了解更多信息：
- en: '[https://learn.microsoft.com/en-us/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=cli](https://learn.microsoft.com/en-us/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=cli)'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=cli](https://learn.microsoft.com/en-us/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=cli)'
- en: If you try to access the workspace at this point, you will get the following
    error because public access has been disabled.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您此时尝试访问工作区，您将收到以下错误，因为公共访问已被禁用。
- en: '![Figure 7.9 – Workspace public access is disabled](img/B21076_07_9.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![图7.9 – 工作区公共访问已禁用](img/B21076_07_9.jpg)'
- en: Figure 7.9 – Workspace public access is disabled
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 – 工作区公共访问已禁用
- en: This was the basic configuration for the workspace’s inbound access. Before
    we validate the access through the VNet, we should first configure outbound traffic
    and restrict access to associated services as well.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这是工作区入站访问的基本配置。在我们通过VNet验证访问之前，我们首先应该配置出站流量并限制对相关服务的访问。
- en: Let us start with outbound traffic.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从出站流量开始。
- en: Restricting outbound traffic
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 限制出站流量
- en: 'To restrict outbound traffic, we will go through the **Networking** blade again
    in Azure Machine Learning, but this time, we will click on the **Workspace managed
    outbound** **access** tab:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 要限制出站流量，我们将再次在Azure Machine Learning中的**网络**选项卡中操作，但这次我们将点击**工作区管理出站****访问**选项卡：
- en: '![Figure 7.10 – Restricting outbound traffic](img/B21076_07_10.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![图7.10 – 限制出站流量](img/B21076_07_10.jpg)'
- en: Figure 7.10 – Restricting outbound traffic
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 – 限制出站流量
- en: 'To restrict outbound traffic, we have two options: **Allow Internet Outbound**
    where only compute is limited and **Allow Only Approved Outbound** where both
    compute and all outbound data movement are limited.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 要限制出站流量，我们有两种选择：**允许互联网出站**，其中只有计算受到限制，以及**仅允许批准的出站**，其中计算和所有出站数据移动都受到限制。
- en: Both of those options have some connection exceptions that you can see when
    enabling the options at the bottom of the screen. You can add some rules of your
    own, but the default ones cannot be disabled.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个选项都有一些连接例外，您可以在屏幕底部的选项启用时看到。您可以添加一些自己的规则，但默认规则不能被禁用。
- en: '![Figure 7.11 – Allowing only approved outbound option](img/B21076_07_11.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![图7.11 – 仅允许批准的出站选项](img/B21076_07_11.jpg)'
- en: Figure 7.11 – Allowing only approved outbound option
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.11 – 仅允许批准的出站选项
- en: If you are also using a firewall together with the network, make sure the connectivity
    is enabled through there as well, as restricting access to those resources will
    result in connectivity issues in the workspace and an inability to work with the
    services.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您同时使用防火墙和网络，请确保通过那里也启用了连接，因为限制对这些资源的访问将在工作区中导致连接问题，并且无法与这些服务一起工作。
- en: Securing the workspace was only the first step. Now we need to ensure that associated
    resources are also secured through the VNet.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 保护工作区只是第一步。现在我们需要确保通过VNet也保护了相关资源。
- en: Securing associated resources
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 保护相关资源
- en: As mentioned in [*Chapter 1*](B21076_01.xhtml#_idTextAnchor015), the workspace
    works closely with many resources, including storage accounts and key vaults,
    which are created to support the workspace. We need to configure the same networking
    settings if we truly want to ensure that they connect properly to the workspace
    through the Microsoft network but still maintain isolation from the public internet.
    The first thing we need to do is disable public access to those services as well.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 如[*第1章*](B21076_01.xhtml#_idTextAnchor015)中所述，工作区与许多资源紧密合作，包括存储账户和密钥保管库，这些资源是为了支持工作区而创建的。如果我们真正想要确保它们通过Microsoft网络正确连接到工作区，同时仍然保持与公共互联网的隔离，我们需要配置相同的网络设置。首先，我们需要禁用这些服务的公共访问。
- en: To disable public access and restrict the account to specific networks, we can
    go to the **Networking** tab in the **Storage** **account** blade.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用公共访问并限制账户访问特定网络，我们可以转到**存储** **账户**选项卡中的**网络**选项卡。
- en: In the **Public network access** options, click **Enabled from selected virtual
    networks and ID addresses**. Then, choose the previously created VNet in the **Virtual
    networks** section and subnet by clicking on the **Add existing virtual network**
    button and click **Save**.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在**公共网络访问**选项中，点击**从所选虚拟网络和ID地址启用**。然后，在**虚拟网络**部分选择之前创建的VNet，通过点击**添加现有虚拟网络**按钮，然后点击**保存**。
- en: 'The final view should look like the following screenshot:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 最终视图应如下所示截图：
- en: '![Figure 7.12 – Disabling public access in the storage account](img/B21076_07_12.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图7.12 – 在存储账户中禁用公共访问](img/B21076_07_12.jpg)'
- en: Figure 7.12 – Disabling public access in the storage account
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.12 – 在存储账户中禁用公共访问
- en: The next step is to do something similar this time to the key vault associated
    with the workspace. The steps are exactly the same as previously.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是执行与工作区关联的密钥保管库的类似操作。步骤与之前完全相同。
- en: To disable public access and restrict the account to specific networks, we can
    go to the **Networking** tab in the **Storage account** blade. For the **Public
    network access** option, click on **Enabled from selected virtual networks and
    ID addresses**. Then, choose the previously created VNet in the **Virtual networks**
    section and the subnet by clicking on the **Add existing virtual network** button
    and clicking **Save**.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用公共访问并限制账户访问特定网络，我们可以转到**存储账户**选项卡中的**网络**选项卡。对于**公共网络访问**选项，点击**从所选虚拟网络和ID地址启用**。然后，在**虚拟网络**部分选择之前创建的VNet，通过点击**添加现有虚拟网络**按钮，然后点击**保存**。
- en: 'The final view should look like the following:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 最终视图应如下所示：
- en: '![Figure 7.13 – Disabling public access in the key vault](img/B21076_07_13.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图7.13 – 在密钥保管库中禁用公共访问](img/B21076_07_13.jpg)'
- en: Figure 7.13 – Disabling public access in the key vault
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '![图7.13 – 在密钥保管库中禁用公共访问](img/B21076_07_13.jpg)'
- en: Note
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: We can still configure service endpoints without restricting network access
    to the services. In this case, traffic from the workspace will go through the
    VNet and any other traffic will still access the services through the public internet.
    Doing both ensures better isolation.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仍然可以配置服务端点，而不限制对服务的网络访问。在这种情况下，来自工作区的流量将通过VNet，而任何其他流量仍然将通过公共互联网访问服务。同时进行这两项操作可以确保更好的隔离。
- en: 'Now that we have disabled public access, we have two options for configuration:
    enabling service endpoints or creating private endpoints for each service.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经禁用了公共访问，我们有两种配置选项：启用服务端点或为每个服务创建私有端点。
- en: Let us explore both options starting with service endpoints.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从服务端点开始探索这两个选项。
- en: 'Option 1: configuring service endpoints'
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 选项1：配置服务端点
- en: This is the easiest and fastest option. Service endpoints in Azure provide enhanced
    security and optimized routing for VNets by extending your VNet’s private address
    space over to Azure service resources. This allows you to secure Azure service
    resources to your VNet.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这是最容易且最快的方法。Azure中的服务端点通过扩展您的VNet的私有地址空间到Azure服务资源，为VNets提供增强的安全性和优化的路由。这允许您将Azure服务资源安全地连接到您的VNet。
- en: Open the VNet we created previously and go to the **Subnets** section. Click
    on the desired subnet and scroll down in the popup on the right.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 打开我们之前创建的VNet，并转到**子网**部分。点击所需的子网，然后在右侧的弹出窗口中向下滚动。
- en: '![Figure 7.14 – Allowing only approved outbound traffic](img/B21076_07_14.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![图7.14 – 仅允许批准的出站流量](img/B21076_07_14.jpg)'
- en: Figure 7.14 – Allowing only approved outbound traffic
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.14 – 仅允许批准的出站流量
- en: It is essential to note that while service endpoints are beneficial for many
    scenarios, there are cases where you might consider using Azure Private Link or
    Private Endpoints instead, especially when you want Azure services to be accessed
    via private IP addresses in your VNet.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: So, let us see how to implement this option next.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: 'Option 2: creating private endpoints'
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The process of creating private endpoints is similar to the one we use to create
    the public endpoint for the workspace. Let us see the steps for each service.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: Azure storage account
  id: totrans-107
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: From the **Networking** screen of the **Storage account** resource, click on
    **Private endpoint connections**. Click the **+ Private endpoint** button and
    follow the tabs as we did previously for the workspace.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.15 – Creating a private endpoint](img/B21076_07_15.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
- en: Figure 7.15 – Creating a private endpoint
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: 'Fill in some basic information for the endpoint, as seen in the following screenshot:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.16 – Filling in the basics](img/B21076_07_16.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
- en: Figure 7.16 – Filling in the basics
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, on the **Resource** tab for the **Target sub-resource**, choose **blob**
    from the dropdown:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.17 – Choosing the blob resource](img/B21076_07_17.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
- en: Figure 7.17 – Choosing the blob resource
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: Go through the rest of the tabs exactly as for the workspace, filling in the
    **Virtual Network**, **DNS**, and then going to **Review +** **create**.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: Once you have completed this process, create another private endpoint, this
    time choosing **file** for the **Target sub-resource**.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: Once we are done with the storage account, here is how to do the same for the
    key vault.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: Azure Key Vault
  id: totrans-120
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'From the **Networking** screen of the key vault resource, click on **Private
    endpoint connections**. Click the **+ Private endpoint** button and follow the
    tabs as we did previously in the chapter for the storage account:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.18 – Creating a private endpoint](img/B21076_07_18.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
- en: Figure 7.18 – Creating a private endpoint
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: 'Fill in some basic information for the endpoint, as seen in the following screenshot:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.19 – Filling in the basics](img/B21076_07_19.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
- en: Figure 7.19 – Filling in the basics
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: Then, on the Resource tab for the **Target sub-resource**, choose **vault**.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 7.20 – Choosing the vault resource](img/B21076_07_20.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
- en: Figure 7.20 – Choosing the vault resource
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: Again, go through the rest of the tabs exactly as for the storage account, filling
    in the **Virtual Network** and **DNS** and then going to **Review +** **create**.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: We have completed the minimum required configurations. Now it is time to test
    it! Let us review some options to test connectivity.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: Validating connectivity
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In order to connect to a workspace that is behind a firewall, we have many options.
    They depend mostly on your individual Azure infrastructure and requirements.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: 'Let us review those options:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: '**Connecting from on-premises systems**: There is one option to establish secure,
    encrypted communications between your on-premises networks and Azure. It is done
    via a VPN gateway through the public internet. Azure offers two types of gateways:
    **VPN Gateway** and **ExpressRoute**. It’s important to choose the appropriate
    VPN solution, as they will have access to your internet activity, and not all
    VPN options offer the same level of security, privacy, and speed.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从本地系统连接**：有一种选项可以在您的本地网络和Azure之间建立安全、加密的通信。这是通过公共互联网上的VPN网关完成的。Azure提供两种类型的网关：**VPN网关**和**ExpressRoute**。选择合适的VPN解决方案很重要，因为它们将有权访问您的互联网活动，并且并非所有VPN选项都提供相同级别的安全性、隐私和速度。'
- en: VPN solutions on Azure
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: Azure上的VPN解决方案
- en: Here, you can find more information about the VPN gateway and ExpressRoute services
    in Azure.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以找到有关Azure中VPN网关和ExpressRoute服务的更多信息。
- en: For VPN Gateway, see [https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways](https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 对于VPN网关，请参阅[https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways](https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways)。
- en: For ExpressRoute, see [https://learn.microsoft.com/en-us/azure/expressroute/expressroute-introduction](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-introduction).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 对于ExpressRoute，请参阅[https://learn.microsoft.com/en-us/azure/expressroute/expressroute-introduction](https://learn.microsoft.com/en-us/azure/expressroute/expressroute-introduction)。
- en: '**Connecting from cloud infrastructure**: We can always create a virtual machine—also
    sometimes referred to as a **jump box**—that we will connect to. From there, we
    can access the services restricted by the network. In addition, you can enable
    **Azure Bastion** in the VM and access the machine through the browser without
    configuring public IPs on the VM, which reduces exposure to security vulnerabilities.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从云基础设施连接**：我们始终可以创建一个虚拟机——有时也称为**跳转盒**——然后将其连接到。从那里，我们可以访问受网络限制的服务。此外，您可以在虚拟机中启用**Azure
    Bastion**，并通过浏览器访问该机器，而无需在虚拟机上配置公共IP，这可以减少对安全漏洞的暴露。'
- en: For our example, we will use a VM in Azure deployed in the same VNet that the
    Azure Machine Learning workspace and associated services are behind. All you need
    to do is create a VM deployed in the same network or a peered network and try
    to access the workspace.
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于我们的示例，我们将使用部署在同一VNet中的Azure虚拟机。您需要做的就是创建一个在同一网络或对等网络中部署的虚拟机，并尝试访问该工作区。
- en: 'Quickstart: create a VM in the portal'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 快速入门：在门户中创建VM
- en: 'If you need to get started with VMs, check this quickstart guide here:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要开始使用虚拟机，请在此处查看快速入门指南：
- en: '[https://learn.microsoft.com/en-us/azure/virtual-machines/windows/quick-create-portal](https://learn.microsoft.com/en-us/azure/virtual-machines/windows/quick-create-portal)'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://learn.microsoft.com/en-us/azure/virtual-machines/windows/quick-create-portal](https://learn.microsoft.com/en-us/azure/virtual-machines/windows/quick-create-portal)'
- en: 'The result is as expected. We can access the workspace from the device inside
    the network, but everything outside the network is disabled. Here is a screenshot
    with a VM that is in the same VNet as the workspace accessing the page (left)
    and a browser trying to access the same workspace (right) through the public internet:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 结果符合预期。我们可以从网络内部的设备访问工作区，但网络之外的一切都被禁用。以下是同一VNet中工作区访问页面（左侧）和浏览器尝试通过公共互联网访问同一工作区（右侧）的截图：
- en: '![Figure 7.21 – Public access disabled](img/B21076_07_21.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![图7.21 – 公共访问已禁用](img/B21076_07_21.jpg)'
- en: Figure 7.21 – Public access disabled
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.21 – 公共访问已禁用
- en: VM security best practices
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机安全最佳实践
- en: 'To increase isolation and security, there are multiple ways to secure either
    the network itself or the VMs that belong to it. As an example, you can review
    the following services:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 为了增加隔离性和安全性，有多种方法可以保护网络本身或属于该网络的虚拟机。例如，您可以查看以下服务：
- en: '**Network security** **groups**: [https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview](https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview)'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络安全组**：[https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview](https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview)'
- en: '**Azure** **Firewall**: [https://learn.microsoft.com/en-us/azure/firewall/overview](https://learn.microsoft.com/en-us/azure/firewall/overview)'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure防火墙**：[https://learn.microsoft.com/en-us/azure/firewall/overview](https://learn.microsoft.com/en-us/azure/firewall/overview)'
- en: '**Azure** **Bastion**: [https://learn.microsoft.com/en-us/azure/bastion/bastion-overview](https://learn.microsoft.com/en-us/azure/bastion/bastion-overview)'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure** **堡垒机**：[https://learn.microsoft.com/en-us/azure/bastion/bastion-overview](https://learn.microsoft.com/en-us/azure/bastion/bastion-overview)'
- en: We can secure associated resources in a similar way, such as in databases and
    other types of data storages that can be used in Azure Machine Learning. If the
    services are already part of other VNets, we can always connect different networks
    via network peering as long as our VNets do not have overlapping addresses. We
    can connect networks by using VNet peering in the same or different subscriptions
    so ultimately your decision on how to segregate the networks in Azure is based
    on individual organizational requirements.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以用类似的方式保护相关的资源，例如在数据库和其他可用于 Azure 机器学习的类型的数据存储中。如果服务已经是其他 VNets 的一部分，只要我们的
    VNets 没有重叠的地址，我们就可以通过网络对等连接不同的网络。我们可以通过在同一或不同的订阅中使用 VNet 对等连接网络，因此最终您在 Azure 中如何隔离网络的决定基于个别组织的需求。
- en: Network architecture in Azure
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 中的网络架构
- en: 'Find out more about network architectures by exploring network peering, the
    hub-spoke topology, and Azure landing zones:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 通过探索网络对等、集中辐射拓扑和 Azure 登录区域来了解更多关于网络架构的信息：
- en: 'VNet peering: [https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview)'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VNet 对等：[https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview)
- en: 'Hub-spoke: [https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli](https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-s)'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集中辐射式：[https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli](https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-s)
- en: 'Azure landing zones: [https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/)'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 登录区域：[https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/)
- en: By integrating Azure Machine Learning with Azure VNets, we are adding an essential
    layer of security that will help in safeguarding our data, models, and other resources
    from unauthorized access and threats. Let us not forget to always monitor and
    regularly review the security measures to adapt to the evolving threat landscape.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将 Azure 机器学习与 Azure VNets 集成，我们添加了一个重要的安全层，这将有助于保护我们的数据、模型和其他资源免受未经授权的访问和威胁。让我们不要忘记始终监控并定期审查安全措施，以适应不断发展的威胁环境。
- en: Let us now explore further security practices for the workspace, starting with
    Azure Machine Learning compute.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们现在进一步探讨工作空间的安全实践，从 Azure 机器学习计算开始。
- en: Working with Azure Machine Learning compute
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure 机器学习计算
- en: Azure Machine Learning provides a scalable cloud environment to build, train,
    and deploy ML models. It offers different computational targets for running experiments,
    training models, and serving predictions.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 机器学习提供了一个可扩展的云环境，用于构建、训练和部署机器学习模型。它提供了不同的计算目标，用于运行实验、训练模型和提供预测。
- en: 'There are four targets overall, with two of these being managed internally
    from the workspace: **compute instances** and **compute clusters**. A compute
    instance is a managed VM that you use for development, training, and inferencing
    needs. It’s essentially a dedicated, personal workstation in the workspace. It
    can be used to run Jupyter notebooks and scripts. A compute cluster is a managed
    scalable set of virtual machines that are used for the large-scale training of
    ML models. Compute clusters automatically scale up or down (within the limits
    you set) based on the workload. So, for example, you can declare a minimum and
    maximum node and the machine will scale based on demand, which helps us optimize
    costs. There is also external compute, which you can use for inferencing, specifically
    the Azure Kubernetes service. You can also attach compute for training from external
    services to the workspace like Ubuntu VMs or Databricks compute.'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 总共有四个目标，其中两个由工作区内部管理：**计算实例** 和 **计算集群**。计算实例是一个用于开发、培训和推理需求的托管虚拟机。它本质上是在工作区中的专用个人工作站。它可以用于运行
    Jupyter 笔记本和脚本。计算集群是一组可管理的可扩展虚拟机，用于大规模训练机器学习模型。计算集群会根据工作负载自动扩展或缩减（在您设置的范围内）。例如，您可以声明最小和最大节点数，机器将根据需求进行扩展，这有助于我们优化成本。还有外部计算，您可以使用它进行推理，特别是
    Azure Kubernetes 服务。您还可以将外部服务（如 Ubuntu VM 或 Databricks 计算）用于训练并附加到工作区。
- en: 'In this section, we will focus on securing the internal resources. For external
    services, you must find the best practices for securing each service. Here are
    some links to give you more information about securing inference and attached
    compute:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将专注于确保内部资源的安全。对于外部服务，您必须找到确保每个服务最佳实践。以下是一些链接，为您提供有关确保推理和附加计算安全性的更多信息：
- en: 'Azure Kubernetes Service: [https://learn.microsoft.com/en-us/azure/aks/concepts-security](https://learn.microsoft.com/en-us/azure/aks/concepts-security
    )'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure Kubernetes 服务：[https://learn.microsoft.com/en-us/azure/aks/concepts-security](https://learn.microsoft.com/en-us/azure/aks/concepts-security)
- en: 'Virtual Machine security: [https://learn.microsoft.com/en-us/azure/virtual-machines/security-recommendations](https://learn.microsoft.com/en-us/azure/virtual-machines/security-recommendations
    )'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机安全：[https://learn.microsoft.com/en-us/azure/virtual-machines/security-recommendations](https://learn.microsoft.com/en-us/azure/virtual-machines/security-recommendations)
- en: 'Azure Databricks security guide: [https://learn.microsoft.com/en-us/azure/databricks/security/](https://learn.microsoft.com/en-us/azure/databricks/security/)'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure Databricks 安全指南：[https://learn.microsoft.com/en-us/azure/databricks/security/](https://learn.microsoft.com/en-us/azure/databricks/security/)
- en: 'Azure Data Lake security baseline: [https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/data-lake-analytics-security-baseline](https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/data-lake-analytics-security-baseline
    )'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure Data Lake 安全基线：[https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/data-lake-analytics-security-baseline](https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/data-lake-analytics-security-baseline)
- en: The following sections will help you understand how to secure compute instances
    and compute clusters.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分将帮助您了解如何确保计算实例和计算集群的安全。
- en: Securing compute instances
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 确保计算实例安全
- en: The basis of securing both compute instances and compute clusters lies in the
    combination of using managed identities and network isolation. Let us follow along
    with the steps to enable them starting with compute instances.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 确保计算实例和计算集群的基础在于使用托管标识和网络隔离的组合。让我们跟随以下步骤来启用它们，从计算实例开始。
- en: 'From the Azure Machine Learning workspace, find the **Compute** menu under
    **Manage** and open it to view the list of available compute. In the **Compute
    instances** tab, click **+ New** to create a new compute instance:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Azure Machine Learning 工作区中，在 **管理** 下的 **计算** 菜单中找到 **计算实例** 选项卡，点击 **+ 新建**
    创建新的计算实例：
- en: '![Figure 7.22 – New compute instance](img/B21076_07_22.jpg)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.22 – 新计算实例](img/B21076_07_22.jpg)'
- en: Figure 7.22 – New compute instance
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.22 – 新计算实例
- en: 'Fill in all tabs as desired until you reach the **Security** tab. Enable the
    **Assign a managed identity** button and leave the **Identity** type as **System-assigned**.
    Ensure that the **SSH** button is disabled to prevent public access, as when using
    a VNet, you can still **Secure Shell** (**SSH**) within that VNet to the machine.
    If you have previously restricted access to the workspace and associated resources,
    **Enable virtual network** will be enabled by default, making it mandatory to
    choose a **Virtual network** and **Subnet**. Choose the one created previously:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 根据需要填写所有选项卡，直到到达**安全**选项卡。启用**分配托管标识**按钮，并将**标识**类型保留为**系统分配**。确保**SSH**按钮被禁用以防止公开访问，因为当使用VNet时，你仍然可以在该VNet内使用**安全外壳协议**（**SSH**）连接到机器。如果你之前已限制对工作区和相关资源的访问，**启用虚拟网络**将默认启用，这使得选择**虚拟网络**和**子网**成为强制性的。选择之前创建的：
- en: '![Figure 7.23 – Setting compute instance security](img/B21076_07_23.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![图7.23 – 设置计算实例安全](img/B21076_07_23.jpg)'
- en: Figure 7.23 – Setting compute instance security
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.23 – 设置计算实例安全
- en: Fill in the rest of the tabs as desired and create the compute. Remember to
    use the proper credentials in the scripts when using this compute for training.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 根据需要填写其余选项卡，并创建计算实例。记住，当使用此计算实例进行训练时，在脚本中使用适当的凭据。
- en: Let us move on to securing compute clusters.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续学习如何确保计算集群的安全。
- en: Securing compute clusters
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 保护计算集群
- en: 'The process of securing compute clusters is very similar. To initiate the process
    from the **Compute** menu under **Manage**, choose the **Compute clusters** tab
    and click **+ New** to create a new compute instance:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 保护计算集群的过程非常相似。要从**管理**下的**计算**菜单中启动过程，请选择**计算集群**选项卡，然后点击**+ 新建**以创建新的计算实例：
- en: '![Figure 7.24 – New compute cluster](img/B21076_07_24.jpg)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![图7.24 – 新计算集群](img/B21076_07_24.jpg)'
- en: Figure 7.24 – New compute cluster
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.24 – 新计算集群
- en: Fill in the **Virtual machine** tab as desired until you reach the **Advanced
    settings** tab. Scroll down until you reach the **Advanced settings** drop-down
    and ensure that **Enable SSH access** is disabled to prevent public access, enable
    **Assign a managed identity**, and leave the **Identity type** as **System-assigned**.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 根据需要填写**虚拟机**选项卡，直到到达**高级设置**选项卡。向下滚动，直到到达**高级设置**下拉菜单，并确保**启用SSH访问**被禁用以防止公开访问，启用**分配托管标识**，并将**标识类型**保留为**系统分配**。
- en: 'If you have previously restricted access to the workspace and associated resources,
    again, the **Enable virtual network** will be enabled by default, making it mandatory
    to choose a **Virtual network** and **Subnet**. Choose the one created previously,
    as demonstrated in the following screenshot:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你之前已限制对工作区和相关资源的访问，再次，**启用虚拟网络**将默认启用，这使得选择**虚拟网络**和**子网**成为强制性的。选择之前创建的，如下面的截图所示：
- en: '![Figure 7.25 – Setting compute cluster security](img/B21076_07_25.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![图7.25 – 设置计算集群安全](img/B21076_07_25.jpg)'
- en: Figure 7.25 – Setting compute cluster security
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.25 – 设置计算集群安全
- en: The process might be simple, but it is enough to isolate our compute resources
    from the public internet, preventing further vulnerabilities. Just remember that
    when running scripts on notebooks through compute, ensure the appropriate credentials
    are passed in the code. For an example of how to use managed identities, review
    the *Working with managed identities* section in [*Chapter 6*](B21076_06.xhtml#_idTextAnchor141).
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程可能很简单，但足以将我们的计算资源从公共互联网隔离，防止进一步的漏洞。只需记住，当通过计算实例在笔记本上运行脚本时，确保在代码中传递适当的凭据。有关如何使用托管标识的示例，请参阅[*第6章*](B21076_06.xhtml#_idTextAnchor141)中的*使用托管标识*部分。
- en: 'Let us review the last resource associated with the workspace and its security
    features: Azure Container Registry.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾与工作区相关联的最后一个资源及其安全功能：Azure容器注册表。
- en: Managing container registries and containers
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理容器注册表和容器
- en: Azure Machine Learning provides an integrated, end-to-end data science workflow,
    enabling data scientists and developers to prepare data, experiment with models,
    and then deploy them in a scalable environment. A pivotal aspect of this deployment
    process involves containerization, which brings us to **Azure Container Registry**
    (**ACR**). ACR is a managed, private Docker container registry service based on
    the open source Docker Registry 2.0\. ACR allows users to build, store, and manage
    container images and artifacts in a secure and scalable manner within Azure. ACR
    integrates well with existing container development and deployment pipelines,
    and it’s especially useful for storing and managing the custom Docker images that
    can be deployed in various Azure services.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Machine Learning 提供了一个集成、端到端的数据科学工作流程，使数据科学家和开发者能够准备数据、实验模型，然后在可扩展的环境中部署它们。部署过程中的一个关键方面涉及容器化，这使我们来到了**Azure
    容器注册表**（**ACR**）。ACR 是基于开源 Docker Registry 2.0 的托管、私有 Docker 容器注册表服务。ACR 允许用户在
    Azure 中以安全且可扩展的方式构建、存储和管理容器镜像和工件。ACR 与现有的容器开发和部署管道集成良好，并且对于存储和管理可在各种 Azure 服务中部署的自定义
    Docker 镜像特别有用。
- en: When working with Azure Machine Learning, there’s an underlying process that
    packages models for deployment. This packaging involves creating a Docker image
    that contains the model, the scoring script, and all the dependencies required
    to run the model. Once this Docker image is created, it needs to be stored somewhere
    where it can be fetched and run.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用 Azure Machine Learning 时，有一个底层过程用于打包模型以进行部署。这个打包过程包括创建一个包含模型、评分脚本以及运行模型所需的所有依赖项的
    Docker 镜像。一旦创建了此 Docker 镜像，它就需要存储在一个可以检索和运行的地方。
- en: This is where ACR comes into play. When you deploy a model for the first time
    using Azure Machine Learning, even if you haven’t explicitly set up an Azure container
    registry, the platform will automatically create one for you. This is a seamless
    experience; however, we need to be aware of the implications for cost and security.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 ACR 发挥作用的地方。当您第一次使用 Azure Machine Learning 部署模型时，即使您没有明确设置 Azure 容器注册表，平台也会自动为您创建一个。这是一个无缝的体验；然而，我们需要意识到这对成本和安全性的影响。
- en: In the next section, we will see how to secure our ACR and deployed containers
    in **Azure Container Instances** (**ACI**). Let us start with ACR.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将了解如何保护我们的 ACR 和在 **Azure 容器实例**（**ACI**）中部署的容器。让我们从 ACR 开始。
- en: Securing images with Azure Container Registry
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Azure 容器注册表保护图像
- en: Securing ACR involves a combination of best practices in network security, access
    control, and image security. Similarly, to the compute, security best practices
    for ACR involve using managed identities where possible and ensuring that the
    ACR is behind the same virtual network as the workspace.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 保护 ACR 涉及网络安全、访问控制和图像安全方面的最佳实践的结合。同样，对于计算，ACR 的安全最佳实践涉及尽可能使用托管标识，并确保 ACR 位于与工作空间相同的虚拟网络后面。
- en: To isolate the container registry in a VNet, the steps are similar to other
    resources. However, before we are able to use the networking features, we need
    to update the service to use a **Premium** pricing tier.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 VNet 中隔离容器注册表，步骤与其他资源类似。然而，在我们能够使用网络功能之前，我们需要更新服务以使用**高级**定价层。
- en: 'To update the pricing tier, visit the ACR blade of the resource associated
    with your workspace and find the **Properties** section. Update the values as
    shown in the next screenshot and click **Save**:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 要更新定价层，请访问与您的工作空间关联的资源中的 ACR 刀片，并找到**属性**部分。按照下一张截图所示更新值，然后点击**保存**：
- en: '![Figure 7.26 – Updating container registry properties](img/B21076_07_26.jpg)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.26 – 更新容器注册表属性](img/B21076_07_26.jpg)'
- en: Figure 7.26 – Updating container registry properties
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.26 – 更新容器注册表属性
- en: 'Now we can use the networking features of the ACR. As we have already seen
    multiple times, go to the **Networking** section and set **Public access** to
    **Disabled**, as demonstrated in the following screenshot:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用 ACR 的网络功能了。正如我们已多次看到的，转到**网络**部分，将**公共访问**设置为**禁用**，如下截图所示：
- en: '![Figure 7.27 – Disable public access](img/B21076_07_27.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.27 – 禁用公共访问](img/B21076_07_27.jpg)'
- en: Figure 7.27 – Disable public access
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.27 – 禁用公共访问
- en: 'On the **Private access** tab, click on **Create a private** **endpoint connection**:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在**私有访问**选项卡上，点击**创建私有** **端点连接**：
- en: '![Figure 7.28 – Creating a private endpoint for the registry](img/B21076_07_28.jpg)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.28 – 为注册表创建私有端点](img/B21076_07_28.jpg)'
- en: Figure 7.28 – Creating a private endpoint for the registry
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.28 – 为注册表创建私有端点
- en: 'Follow the steps as usual, ensuring that in the **Resources** tab of the **Private
    endpoint** form, you fill in the proper **Resource** and **Resource type**:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 按照常规步骤操作，确保在**资源**选项卡下的**私有端点**表单中，填写正确的**资源**和**资源类型**：
- en: '![Figure 7.29 – Filling in the private endpoint form](img/B21076_07_29.jpg)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![图7.29 – 填写私有端点表单](img/B21076_07_29.jpg)'
- en: Figure 7.29 – Filling in the private endpoint form
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.29 – 填写私有端点表单
- en: Securing ACR is a multi-faceted process. By taking a comprehensive approach
    that encompasses network security, access control, and constant monitoring, you
    can ensure that your container images remain safe and are only accessed by authenticated
    users or applications.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 保护ACR是一个多方面的过程。通过采取涵盖网络安全、访问控制和持续监控的全面方法，您可以确保您的容器镜像保持安全，并且只能由经过身份验证的用户或应用程序访问。
- en: Container registries are only the repositories of the models. They can be exposed
    in published endpoints so that they can be available to applications. Let us explore
    how to secure those endpoints when deployed with ACI.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 容器注册库只是模型的存储库。它们可以通过发布的端点公开，以便它们可供应用程序使用。让我们探索如何在使用ACI部署时确保这些端点的安全性。
- en: Working with ML endpoints
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 与ML端点一起工作
- en: When we deploy a model via the workspace, the options available are Azure Kubernetes
    and ACI. The fastest option is to use ACI, as they are deployed quickly via the
    workspace and there is no further configuration. If you want to be reminded of
    the process of deploying a model, you can review the *Deploying the model* section
    of [*Chapter 1*](B21076_01.xhtml#_idTextAnchor015).
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们通过工作区部署模型时，可用的选项是Azure Kubernetes和ACI。最快的选项是使用ACI，因为它们可以通过工作区快速部署，并且无需进一步配置。如果您想回顾部署模型的过程，可以查看[*第1章*](B21076_01.xhtml#_idTextAnchor015)中的*部署模型*部分。
- en: After deploying an endpoint through the workspace, there is no option to disable
    public access to the container. In that case, what you can do is still register
    the model, but redeploy it using the saved container from the repository in a
    new ACI deployment. This provides the opportunity for network isolation.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在通过工作区部署端点后，没有选项可以禁用容器的公共访问。在这种情况下，您可以做的仍然是注册模型，但使用从存储库中保存的容器在新ACI部署中重新部署它。这提供了网络隔离的机会。
- en: 'To do this, we need to choose the deployed image from the ACR connected with
    our workspace in the **Basic** tab of the container instance form. Begin to fill
    out the form as usual like in the next screenshot:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 要做到这一点，我们需要在容器实例表单的**基本**选项卡中从与我们的工作区连接的ACR中选择已部署的镜像。开始填写表单，就像在下一个屏幕截图中所展示的那样：
- en: '![Figure 7.30 – Filling in the basic details](img/B21076_07_30.jpg)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![图7.30 – 填写基本详情](img/B21076_07_30.jpg)'
- en: Figure 7.30 – Filling in the basic details
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.30 – 填写基本详情
- en: 'When we reach the part where we need to choose an **Image source**, choose
    the ACR connected to your workspace. Fill in **Registry**, **Image**, and **Image
    tag** to correspond to your model and then fill out the rest of the form as desired:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们到达需要选择**图像源**的部分时，请选择连接到您工作区的ACR。填写**注册表**、**镜像**和**镜像标签**以匹配您的模型，然后根据需要填写表单的其余部分：
- en: '![Figure 7.31 – Choosing the correct ACR](img/B21076_07_31.jpg)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![图7.31 – 选择正确的ACR](img/B21076_07_31.jpg)'
- en: Figure 7.31 – Choosing the correct ACR
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.31 – 选择正确的ACR
- en: Next, you will find the **Networking** tab. From here, you can restrict networking.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您将找到**网络**选项卡。从这里，您可以限制网络。
- en: Application considerations with VNet isolation
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 与VNet隔离的应用程序考虑因素
- en: Be careful in this stage. It all depends on where your application is hosted
    since this endpoint is meant to be consumed by an external application to the
    service. If it is an application hosted on Azure, you can probably configure the
    access easily. If it is an internal application hosted on-premises, you would
    need some of the services mentioned previously, such as a VPN gateway to access
    the isolated endpoint. If it is a public-facing application, you might need to
    further configure the network security group or firewall attached to the VNet
    to allow access properly. As this part of the process is heavily dependent on
    other factors, ensure that you have explored all options of networking and authentication
    before proceeding to use that API endpoint for scoring, training, and so on.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段要小心。这完全取决于您的应用程序托管的位置，因为这个端点是打算由服务的外部应用程序使用的。如果它是在Azure上托管的应用程序，您可能可以轻松配置访问。如果它是在本地托管的内部应用程序，您可能需要之前提到的某些服务，例如VPN网关来访问隔离的端点。如果它是一个面向公众的应用程序，您可能需要进一步配置VNet附加的网络安全组或防火墙，以正确允许访问。由于这个过程的部分严重依赖于其他因素，在使用该API端点进行评分、训练等之前，请确保您已经探索了所有网络和身份验证选项。
- en: 'To isolate behind a VNet, choose the **Virtual network** and **Subnet**. The
    subnet must be a different one than the one we have used so far to accommodate
    endpoints instead of VMs. Refer to the following screenshot:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 要在VNet后面进行隔离，请选择**虚拟网络**和**子网**。子网必须与之前我们用来容纳端点而不是虚拟机的子网不同。请参考以下截图：
- en: '![Figure 7.32 – Configuring network isolation](img/B21076_07_32.jpg)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![图7.32 – 配置网络隔离](img/B21076_07_32.jpg)'
- en: Figure 7.32 – Configuring network isolation
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.32 – 配置网络隔离
- en: Then, you can complete the rest of the settings as desired and create the endpoint.
    Pay attention to environment variables if any are required. These can be filled
    in in the **Advanced** tab. Then, you can **Review + Create** the service. You
    can test the service from a VM deployed in the same VNet to test connectivity.
    This is just one way of isolating endpoints. Another way is to use workspace-managed
    network isolation, which is a new feature that is yet to be fully available. It
    is worth keeping up to date with this feature for the future.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，您可以按照需要完成其余的设置并创建端点。如果需要，请注意环境变量。这些可以在**高级**选项卡中填写。然后，您可以**审查 + 创建**服务。您可以从同一VNet中部署的虚拟机测试服务，以测试连接性。这只是隔离端点的一种方法。另一种方法是使用工作空间管理的网络隔离，这是一个尚未完全可用的新功能。值得关注这个功能未来的发展。
- en: Workspace-managed network isolation
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 工作空间管理的网络隔离
- en: 'Azure Machine Learning currently offers another option for integrated management
    for VNet isolation: automating the process with a VNet managed by the workspace.
    This feature is still in preview at the time of writing and should not be used
    for production workloads, as the service provides no **Service Level Agreement**
    (**SLA**). If you want to learn more, you can find more information at https://learn.microsoft.com/en-us/azure/machine-learning/how-to-managed-network?view=azureml-api-2&tabs=azure-cli.'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: Azure机器学习目前为VNet隔离提供了另一种集成管理选项：使用由工作空间管理的VNet自动化流程。在撰写本文时，此功能仍处于预览阶段，不应用于生产工作负载，因为服务不提供**服务级别协议**（**SLA**）。如果您想了解更多信息，您可以在https://learn.microsoft.com/en-us/azure/machine-learning/how-to-managed-network?view=azureml-api-2&tabs=azure-cli找到更多信息。
- en: We have explored multiple ways to leverage Azure infrastructure to secure our
    Azure Machine Learning workspace and its associated resources. It is easier if
    we already have cloud infrastructure we can leverage that is used within our organization
    for other purposes. It is worth exploring even if we do not, as it can help not
    only with isolating our resources and reducing the attack surface area but also
    with preventing data exfiltration in the case of a security incident.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经探讨了多种利用Azure基础设施来保护我们的Azure机器学习工作空间及其相关资源的方法。如果我们已经拥有可以用于组织其他目的的云基础设施，那么这会更容易。即使我们没有，也值得探索，因为它不仅可以帮助我们隔离资源并减少攻击面，还可以在发生安全事件的情况下防止数据泄露。
- en: Summary
  id: totrans-231
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we talked about multiple aspects of leveraging networking to
    protect our Azure Machine Learning workloads.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了利用网络保护我们的Azure机器学习工作负载的多个方面。
- en: The main aim of this chapter was to learn basic networking practices to isolate
    the workspace and all associated services, specifically storage accounts, key
    vaults, and Azure Container Registry. Although public access means access from
    the public internet and not unauthorized access, credentials can be leaked and
    malicious actors can gain access. By isolating our resources using VNets, we are
    reducing the attack surface area.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的主要目的是学习基本的网络实践，以隔离工作空间及其所有相关服务，特别是存储账户、密钥保管库和Azure容器注册库。尽管公共访问意味着来自公共互联网的访问，而不是未经授权的访问，但凭证可能会泄露，恶意行为者可能会获得访问权限。通过使用虚拟网络（VNets）隔离我们的资源，我们正在减少攻击面。
- en: Combining networking and best practices regarding identity, such as configuring
    managed identities where possible and using proper RBAC with our users and services,
    we can take one step closer to maintaining a baseline security posture across
    our cloud services and infrastructure.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 结合网络和关于身份的最佳实践，例如尽可能配置托管身份，并使用适当的基于角色的访问控制（RBAC）来管理我们的用户和服务，我们可以进一步确保在云服务和基础设施中保持基本的安全态势。
- en: In the next chapter, we will see how to automate best practices with **continuous
    integration and continuous delivery** (**CI/CD**) for our ML tasks.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将了解如何通过**持续集成和持续交付**（**CI/CD**）自动化我们的机器学习任务的最佳实践。
