- en: '11'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '11'
- en: Computational Fluid Dynamics
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 计算流体动力学
- en: '**Computational Fluid Dynamics** (**CFD**) is a technique used to analyze how
    fluid (air, water, and other fluids) flow over or inside objects of interest.
    CFD is a mature field that originated several decades ago and is used in fields
    of study related to manufacturing, healthcare, the environment, and aerospace
    and automotive industries that involve fluid flow, chemical reactions, or thermodynamic
    reactions and simulations. Given the field’s progress and long history, it is
    beyond the scope of this book to discuss many aspects of this field. However,
    these video links may be a great way for readers to get up to speed on what CFD
    is and some CFD tools, and best practices on AWS:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**计算流体动力学**（**CFD**）是一种分析流体（空气、水和其他流体）如何流过或穿过感兴趣物体的技术。CFD 是一个成熟的领域，起源于几十年前，并在与制造、医疗保健、环境以及涉及流体流动、化学反应或热力学反应和模拟的航空航天和汽车工业相关的学术领域中使用。鉴于该领域的进步和悠久的历史，本书的范围超出了讨论该领域许多方面的范围。然而，这些视频链接可能是读者了解
    CFD 是什么以及一些 CFD 工具，以及 AWS 上的最佳实践的一个很好的途径：'
- en: '[https://www.youtube.com/watch?v=__7_aHrNUF4&ab_channel=AWSPublicSector](https://www.youtube.com/watch?v=__7_aHrNUF4&ab_channel=AWSPublicSector)'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.youtube.com/watch?v=__7_aHrNUF4&ab_channel=AWSPublicSector](https://www.youtube.com/watch?v=__7_aHrNUF4&ab_channel=AWSPublicSector)'
- en: '[https://www.youtube.com/watch?v=8rAvNbCJ7M0&ab_channel=AWSOnlineTechTalks](https://www.youtube.com/watch?v=8rAvNbCJ7M0&ab_channel=AWSOnlineTechTalks)'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.youtube.com/watch?v=8rAvNbCJ7M0&ab_channel=AWSOnlineTechTalks](https://www.youtube.com/watch?v=8rAvNbCJ7M0&ab_channel=AWSOnlineTechTalks)'
- en: In this chapter, we are going to review the field of CFD and provide insights
    into how **Machine Learning** (**ML**) is being used today with CFD. Additionally,
    we will examine some of the ways you can run CFD tools on AWS.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将回顾计算流体力学（CFD）领域，并探讨今天如何使用**机器学习**（**ML**）与 CFD 结合。此外，我们还将探讨一些您可以在 AWS
    上运行 CFD 工具的方法。
- en: 'We will cover the following topics in this chapter:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Introducing CFD
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍计算流体力学（CFD）
- en: Reviewing best practices for running CFD on AWS
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查在 AWS 上运行 CFD 的最佳实践
- en: Discussing how ML can be applied to CFD
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 讨论如何将 ML 应用于 CFD
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'You should have the following prerequisites before getting started with this
    chapter:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始本章之前，您应具备以下先决条件：
- en: Familiarity with AWS and its basic usage.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 熟悉 AWS 及其基本使用。
- en: A web browser (for the best experience, it is recommended that you use a Chrome
    or Firefox browser).
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络浏览器（为了获得最佳体验，建议您使用 Chrome 或 Firefox 浏览器）。
- en: 'An AWS account (if you are unfamiliar with how to get started with an AWS account,
    you can go to this link: [https://aws.amazon.com/getting-started/](https://aws.amazon.com/getting-started/)).'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS 账户（如果您不熟悉如何开始使用 AWS 账户，可以访问此链接：[https://aws.amazon.com/getting-started/](https://aws.amazon.com/getting-started/)).
- en: Some familiarity with CFD. Although we will provide a brief overview of CFD,
    this chapter is best suited for readers that are at least aware of some of the
    typical use cases that can be solved using CFD.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对 CFD 有一定的了解。尽管我们将提供 CFD 的简要概述，但本章最适合那些至少对 CFD 可以解决的典型用例有所了解的读者。
- en: In the following section, we will introduce CFD through an example application
    problem – designing a race car!
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将通过一个示例应用问题——设计赛车！来介绍计算流体力学（CFD）。
- en: Introducing CFD
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍计算流体力学（CFD）
- en: '**CFD** is the prediction of fluid flow using numerical analysis. Let’s break
    that down:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '**CFD** 是使用数值分析预测流体流动。让我们来分解一下：'
- en: '**Prediction**: Just as with other physical phenomena, fluid flow can be modeled
    mathematically, and simulated. For readers from the field of ML, this is different
    from an ML model’s *prediction*. Here, we solve a set of equations iteratively
    to construct the flow inside or around a body. Mainly, we use **Navier-Stokes**
    equations.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测**：与其他物理现象一样，流体流动可以通过数学建模和模拟。对于来自 ML 领域的读者来说，这与 ML 模型的 *预测* 不同。在这里，我们通过迭代求解一系列方程来构建物体内部或周围的流动。主要使用
    **Navier-Stokes** 方程。'
- en: '**Numerical analysis**: Several tools have been created to help actually solve
    these equations – not surprisingly, these tools are called **solvers**. As with
    any set of tools, there are commercial and **open source** varieties of these
    solvers. It is uncommon nowadays to write any code related to the actual solving
    of equations – similar to how you don’t write your own ML framework before you
    start solving your ML problems. Numerical or mathematical methods that have been
    studied for decades are implemented through code in these solvers that help with
    the analysis of fluid flow.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数值分析**：为了实际解决这些方程，已经创建了几个工具——不出所料，这些工具被称为**求解器**。与任何一组工具一样，这些求解器有商业和**开源**两种版本。如今，编写任何与实际求解方程相关的代码是不常见的——类似于在开始解决你的机器学习问题之前，你不会编写自己的机器学习框架。这些求解器通过代码实现了数十年来研究过的数值或数学方法，这些方法有助于流体流动的分析。'
- en: Now, imagine you are the team principal for a new **Formula 1** (**F1**) team
    who is responsible for managing the design of a new car for the upcoming race
    season. The design of this car has to satisfy many new F1 regulations that define
    constraints of how the car can be designed. Fortunately, you have a large engineering
    team that can manage the design and manufacturing of a new car that is proposed.
    The largest teams spend millions of dollars on just the conceptual design of the
    car before even manufacturing a single part. It is typical for teams to start
    with a baseline design and improve this design iteratively. This iterative improvement
    of design is not unique to racing car development; think of the latest version
    of the iPhone in your pocket or purse, or how generations of commercial passenger
    aircraft designs look similar but are very different. You task your engineers
    with designing modifications to the existing car using **Computer-Aided Design**
    (**CAD**) tools, and after a month of working on potential design changes, they
    show you the design of your team’s latest car (see *Figure 11**.1*). This looks
    great!
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，假设你是即将到来的赛车赛季一支新**一级方程式**（**F1**）车队的主教练，负责管理新车的研发设计。这辆车的研发设计必须满足许多新的 F1 规则，这些规则定义了车辆设计可以施加的限制。幸运的是，你有一个庞大的工程团队可以管理新车的研发和制造。最大的车队在制造任何部件之前，仅在概念设计上就花费了数百万美元。车队通常从基准设计开始，并迭代地改进这个设计。这种设计的迭代改进并不仅限于赛车车身的开发；想想你口袋或包里的最新版
    iPhone，或者几代商用客机设计看起来相似但实际上却非常不同。你要求工程师使用**计算机辅助设计**（**CAD**）工具对现有车辆进行设计修改，经过一个月对潜在设计变更的工作后，他们向你展示了你团队最新车辆的设计（见图
    *图 11**.1*）。这看起来很棒！
- en: '![Figure 11.1 – F1 car design](img/B18493_11_001.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.1 – F1 赛车设计](img/B18493_11_001.jpg)'
- en: Figure 11.1 – F1 car design
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.1 – F1 赛车设计
- en: 'However, how do you know whether this car will perform better on track? Two
    key metrics that you can track are as follows:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，你怎么知道这辆车在赛道上会表现更好呢？你可以跟踪的两个关键指标如下：
- en: '**Drag**: The resistance caused by an object in fluid flow. The **coefficient
    of drag** is a dimensionless quantity that is used to quantify drag. For your
    F1 car, a higher coefficient of drag is worse since your car will move slower,
    considering all the other factors remain constant.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**阻力**：物体在流体流动中产生的阻力。**阻力系数**是一个无量纲量，用于量化阻力。对于你的 F1 赛车来说，更高的阻力系数更差，因为你的车会移动得更慢，假设其他所有因素保持不变。'
- en: '**Downforce**: Aerodynamic forces that push the car onto the track; the higher
    the downforce, the better it is since it provides greater grip when traveling
    or turning at high speeds.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**下压力**：将汽车推到赛道上的空气动力学力；下压力越高，越好，因为它在高速行驶或转弯时提供了更大的抓地力。'
- en: '*Figure 11**.2* shows the direction of these two forces applied to the F1 car:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 11**.2* 展示了这两个力作用在 F1 赛车上的方向：'
- en: '![Figure 11.2 – Drag and downforce directions on the F1 car](img/B18493_11_002.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.2 – F1 赛车的阻力和下压力方向](img/B18493_11_002.jpg)'
- en: Figure 11.2 – Drag and downforce directions on the F1 car
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.2 – F1 赛车的阻力和下压力方向
- en: Now, one way to measure drag and downforce is to manufacture the entire car,
    drive around a track with force sensors, and report this back to the team – but
    what if you had a different design in mind? Or a variation in one of the components
    of your car? You would have rebuilt these components, or the entire car, and then
    perform the same tests, or run a scale model in a wind tunnel – these options
    can be very time-consuming and very expensive. This is where numerical analysis
    codes such as CFD tools become useful. With CFD tools, you can simulate different
    flow conditions over the car and calculate the drag and downforce.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 现在测量阻力和下压力的一种方法是将整辆车制造出来，在赛道上驾驶并使用力传感器进行测试，然后将结果反馈给团队——但如果您有其他的设计想法呢？或者是对您汽车某个部件的变体？您将需要重新构建这些部件，或者整辆车，然后进行相同的测试，或者在风洞中运行比例模型——这些选项可能非常耗时且成本高昂。这就是数值分析代码，如CFD工具变得有用的地方。使用CFD工具，您可以模拟汽车上的不同流动条件并计算阻力和下压力。
- en: It is typical in CFD to create a **flow domain** with the object of interest
    inside it. This can look similar to *Figure 11**.3* for **external flows** (for
    example, the flow around the vehicle). On the other hand, you could have **internal
    flows** where the domain is defined in the object itself (such as the flow inside
    a bent pipe). In *Figure 11**.3*, the green and blue surfaces represent the **inlet**
    and **outlet** in this domain. Air flows from the **inlet**, over and around the
    car, and out through the **outlet**.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在CFD中，通常会在感兴趣的对象内部创建一个**流动域**。这可以类似于*图11.3*中的**外部流动**（例如，车辆周围的流动）。另一方面，您可能有**内部流动**，其中域定义在对象本身内（例如，弯曲管道内的流动）。在*图11.3*中，绿色和蓝色表面代表该域中的**入口**和**出口**。空气从**入口**流入，经过并绕过汽车，然后通过**出口**流出。
- en: '![Figure 11.3 – CFD domain defined around the F1 car](img/B18493_11_003.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![图11.3 – 围绕F1赛车的CFD域定义](img/B18493_11_003.jpg)'
- en: Figure 11.3 – CFD domain defined around the F1 car
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.3 – 围绕F1赛车的CFD域定义
- en: The car and the domain so far are conceptual ideas and need to be represented
    as objects or files that CFD code can ingest and use. A typical file format used
    to represent objects is the **Stereolithography** (**STL**) file format. Each
    object is represented as a set of triangles, and each triangle is represented
    by a set of 3D points. The same car in an STL format is shown in *Figure 11**.4*
    – the car is now a collection of tens of thousands of triangles.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，汽车和域是概念性的想法，需要以对象或文件的形式表示，以便CFD代码可以读取和使用。用于表示对象的典型文件格式是**立体光刻**（**STL**）文件格式。每个对象表示为一组三角形，每个三角形由一组3D点表示。在STL格式中的同一辆汽车如*图11.4*所示——汽车现在是由数万个三角形组成的集合。
- en: '![Figure 11.4 – F1 car in an STL format](img/B18493_11_004.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![图11.4 – STL格式的F1赛车](img/B18493_11_004.jpg)'
- en: Figure 11.4 – F1 car in an STL format
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.4 – STL格式的F1赛车
- en: We can now use this car object and **mesh** the CFD domain. Creating a **mesh**,
    or **meshing**, is the process of creating grid points in the CFD domain where
    numerical equations related to fluid flow are to be solved. Meshing is a very
    important process, as this can directly influence results, and also sometimes
    cause the numerical simulation to diverge or not solve.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以使用这个汽车对象并对CFD域进行**网格化**。创建**网格**或**网格化**是在CFD域中创建网格点的过程，其中要解决与流体流动相关的数值方程。网格化是一个非常重要的过程，因为它可以直接影响结果，有时也可能导致数值模拟发散或无法求解。
- en: Note
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Meshing techniques and details about the algorithms used are beyond the scope
    of this book. Each solver tool implements different meshing techniques with various
    configurations. Teams spend a significant amount of time getting high-quality
    meshes while balancing the complexity of the mesh to ensure faster solving times.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 网格化技术和所使用的算法的细节超出了本书的范围。每个求解器工具都使用不同的网格化技术，并具有各种配置。团队花费大量时间获得高质量的网格，同时平衡网格的复杂性以确保更快的求解时间。
- en: Once the mesh is built out, it may look similar to *Figure 11**.5*. We see that
    there is a concentration of grid cells closer to the body. Note that this is a
    slice of the mesh, and the actual mesh is a 3D volume with the bounds that were
    defined in *Figure 11**.3*.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦构建了网格，它可能看起来类似于*图11.5*。我们看到网格单元在车身附近有集中。请注意，这是一个网格的切片，实际的网格是一个3D体积，其边界在*图11.3*中定义。
- en: '![Figure 11.5 – CFD mesh built for the F1 car case](img/B18493_11_005.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![图11.5 – 为F1赛车案例构建的CFD网格](img/B18493_11_005.jpg)'
- en: Figure 11.5 – CFD mesh built for the F1 car case
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.5 – 为F1赛车案例构建的CFD网格
- en: Once the mesh is built out, we can use CFD solvers to calculate the flow around
    this F1 car, and then post-process these results to provide us with predictions
    for drag and downforce. *Figure 11**.6* and *Figure 11**.7* show typical post-processed
    images involving streamlines (the white lines in the images representing how fluid
    flows around the body), a velocity slice (the magnitude of the velocity on a plane
    or cross-section of interest), pressure on the car body (redder regions are higher
    pressure), and the original car geometry for context.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦构建了网格，我们就可以使用CFD求解器计算围绕这辆F1赛车的流动，然后对这些结果进行后处理，以提供关于阻力下压力的预测。*图11**.6*和*图11**.7*显示了涉及流线（图像中的白色线条表示流体如何围绕车身流动）、速度切片（在感兴趣平面或截面上的速度大小）、车身上的压力（红色区域表示更高的压力）以及原始汽车几何形状的典型后处理图像。
- en: '![Figure 11.6 – Post-processed results for the F1 car case showing streamlines
    and velocity slice](img/B18493_11_006.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![图11.6 – F1赛车案例的后处理结果，显示流线和速度切片](img/B18493_11_006.jpg)'
- en: Figure 11.6 – Post-processed results for the F1 car case showing streamlines
    and velocity slice
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.6 – F1赛车案例的后处理结果，显示流线和速度切片
- en: '*Figure 11**.7* shows a different output visualization of pressure on the surface
    of the car, along with the streamlines in a perspective view.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '*图11**.7*展示了汽车表面的压力不同输出可视化，以及透视视图中的流线。'
- en: '![Figure 11.7 – Post-processed results for the F1 car case showing pressure
    on the car body with streamlines](img/B18493_11_007.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![图11.7 – F1赛车案例的后处理结果，显示车身上的压力和流线](img/B18493_11_007.jpg)'
- en: Figure 11.7 – Post-processed results for the F1 car case showing pressure on
    the car body with streamlines
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.7 – F1赛车案例的后处理结果，显示车身上的压力和流线
- en: 'In summary, running a CFD case involves the following:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，运行CFD案例涉及以下步骤：
- en: Loading and manipulating the geometry
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载和处理几何形状
- en: Meshing the CFD domain
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网格化CFD域
- en: Using a solver to solve for the flow in the domain
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用求解器在域内求解流动
- en: Using post-processing tools to visualize the results
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用后处理工具可视化结果
- en: In the next section, we will discuss a few ways of running CFD analyses on AWS
    according to our documented best practices.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将讨论根据我们记录的最佳实践，在AWS上运行CFD分析的一些方法。
- en: Reviewing best practices for running CFD on AWS
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查在AWS上运行CFD的最佳实践
- en: 'CFD, being very compute-intensive, needs to be scaled massively to be practical
    for companies that depend on analysis results to make decisions about their product
    designs. AWS allows customers to run CFD simulations at a massive scale (thousands
    of cores), on-demand, with multiple commercial and **open source** tools, and
    without any capacity planning or up-front capital investment. You can find many
    useful links related to CFD on AWS here: [https://aws.amazon.com/hpc/cfd/](https://aws.amazon.com/hpc/cfd/).'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 由于CFD计算密集度很高，需要大规模扩展才能适用于依赖分析结果来做出产品设计决策的公司。AWS允许客户使用多种商业和**开源**工具，按需以大规模（数千个核心）运行CFD模拟，无需任何容量规划或前期资本投资。您可以在以下位置找到有关AWS上CFD的许多有用链接：[https://aws.amazon.com/hpc/cfd/](https://aws.amazon.com/hpc/cfd/)。
- en: 'As highlighted at the outset of this chapter, there are several commercial
    and open source tools available to solve your CFD problems that run at scale on
    AWS. Some of these tools are as follows:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如本章开头所强调的，有几种商业和开源工具可用于解决您的CFD问题，这些工具可以在AWS上大规模运行。以下是一些这些工具的例子：
- en: Siemens SimCenter STAR-CCM+
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 西门子SimCenter STAR-CCM+
- en: Ansys Fluent
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ansys Fluent
- en: OpenFOAM (open source)
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenFOAM（开源）
- en: 'In this chapter, we will be providing you with examples of how to set up and
    use *OpenFOAM*. For other tools, please take a look at this workshop provided
    by AWS: [https://cfd-on-pcluster.workshop.aws/](https://cfd-on-pcluster.workshop.aws/).'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将向您提供如何设置和使用*OpenFOAM*的示例。对于其他工具，请参阅AWS提供的此研讨会：[https://cfd-on-pcluster.workshop.aws/](https://cfd-on-pcluster.workshop.aws/)。
- en: Note
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'Note that the AWS **Well-Architected** pillar defines best practices for running
    any kind of workload on AWS. It includes the best practices for designing architectures
    on AWS with the following pillars: **Operational Excellence**, **Security**, **Reliability**,
    **Performance Efficiency**, **Cost Optimization**, and **Sustainability**.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，AWS **Well-Architected** 框架定义了在AWS上运行任何类型工作负载的最佳实践。它包括以下支柱在AWS上设计架构的最佳实践：**运营卓越**、**安全性**、**可靠性**、**性能效率**、**成本优化**和**可持续性**。
- en: 'If you are unfamiliar with the Well-Architected Framework, you can read about
    it in detail here: [https://docs.aws.amazon.com/wellarchitected/latest/framework/welcome.html/](https://docs.aws.amazon.com/wellarchitected/latest/framework/welcome.html/).'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不太熟悉“架构良好框架”，你可以在这里详细了解它：[https://docs.aws.amazon.com/wellarchitected/latest/framework/welcome.html/](https://docs.aws.amazon.com/wellarchitected/latest/framework/welcome.html/)。
- en: 'We will now discuss two different ways of running CFD simulations on AWS: using
    ParallelCluster and using CFD Direct.'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将讨论两种在 AWS 上运行 CFD 仿真模拟的不同方法：使用 ParallelCluster 和使用 CFD Direct。
- en: Using AWS ParallelCluster
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 AWS ParallelCluster
- en: 'On AWS, these Well-Architected best practices are encapsulated in a solution
    called AWS ParallelCluster that you can launch in your AWS account. ParallelCluster
    lets you configure and launch an entire HPC cluster with a simple **Command-Line
    Interface** (**CLI**). The CLI also allows you to dynamically scale resources
    needed for your CFD (and other HPC) applications as needed, in a secure manner.
    Popular schedulers such as **AWS Batch** or **Slurm** can be used to submit and
    monitor jobs on ParallelCluster. Here are some steps to follow for installing
    ParallelCluster (note that a complete set of steps can be found on the official
    AWS documentation page for ParallelCluster here: [https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3-pip.html](https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3-pip.html)).'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在 AWS 上，这些“架构良好”的最佳实践被封装在一个名为 AWS ParallelCluster 的解决方案中，你可以在你的 AWS 账户中启动它。ParallelCluster
    允许你通过简单的**命令行界面**（**CLI**）配置和启动整个 HPC 集群。CLI 还允许你以安全的方式动态扩展 CFD（以及其他 HPC）应用所需的资源。流行的调度器，如
    **AWS Batch** 或 **Slurm**，可以用于在 ParallelCluster 上提交和监控作业。以下是一些安装 ParallelCluster
    的步骤（请注意，完整的步骤可以在 ParallelCluster 的官方 AWS 文档页面找到：[https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3-pip.html](https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3-pip.html)）。
- en: Step 1 – creating an AWS Cloud9 IDE
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 1 – 创建 AWS Cloud9 IDE
- en: 'This helps us have access to a full IDE on the cloud on a specified instance
    type, with temporary, managed credentials that can be used to launch ParallelCluster.
    Follow the instructions here to launch an AWS Cloud9 IDE: [https://docs.aws.amazon.com/cloud9/latest/user-guide/setup-express.html](https://docs.aws.amazon.com/cloud9/latest/user-guide/setup-express.html).'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这有助于我们访问指定实例类型上的完整 IDE，并使用临时、管理的凭证来启动 ParallelCluster。按照以下说明启动 AWS Cloud9 IDE：[https://docs.aws.amazon.com/cloud9/latest/user-guide/setup-express.html](https://docs.aws.amazon.com/cloud9/latest/user-guide/setup-express.html)。
- en: 'Once you have created your Cloud9 IDE, navigate to the terminal as shown in
    the instructions here: [https://docs.aws.amazon.com/cloud9/latest/user-guide/tour-ide.html#tour-ide-terminal](https://docs.aws.amazon.com/cloud9/latest/user-guide/tour-ide.html#tour-ide-terminal).'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你创建了你的 Cloud9 IDE，按照以下说明导航到终端：[https://docs.aws.amazon.com/cloud9/latest/user-guide/tour-ide.html#tour-ide-terminal](https://docs.aws.amazon.com/cloud9/latest/user-guide/tour-ide.html#tour-ide-terminal)。
- en: Step 2 – installing the ParallelCluster CLI
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 2 – 安装 ParallelCluster CLI
- en: 'Once you are inside the terminal, do the following:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你进入了终端，请执行以下操作：
- en: 'Use `pip` to install `ParallelCluster`:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`pip`安装`ParallelCluster`：
- en: '[PRE0]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Next, make sure that you have **Node Version Manager** (**NVM**) installed:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，确保你已经安装了**节点版本管理器**（**NVM**）：
- en: '[PRE3]'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Lastly, verify that `ParallelCluster` has been installed successfully:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，验证`ParallelCluster`是否已成功安装：
- en: '[PRE10]'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Let’s move on to *step 3*.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续到*步骤 3*。
- en: Step 3 – configuring your ParallelCluster
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 3 – 配置你的 ParallelCluster
- en: 'Before you launch ParallelCluster, you need to define parameters using the
    `configure` command:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在你启动 ParallelCluster 之前，你需要使用 `configure` 命令定义参数：
- en: '[PRE14]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The command-line tool will ask you the following questions for creating a configuration
    (or config, for short) file:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行工具将询问你以下问题以创建一个配置（或简称 config）文件：
- en: Region in which to set up ParallelCluster (for example, US-East-1)
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置 ParallelCluster 的区域（例如，US-East-1）
- en: '**EC2 Key Pair** to use (learn more about **Key Pairs** here: [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html)'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**EC2 密钥对**使用（在此处了解更多关于**密钥对**的信息：[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html)）'
- en: Operating system (for example, Amazon Linux 2, CentOS 7, or Ubuntu)
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统（例如，Amazon Linux 2、CentOS 7 或 Ubuntu）
- en: Head node instance type (for example, **c5n.18xlarge**)
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主节点实例类型（例如，**c5n.18xlarge**）
- en: Whether to automate VPC creation
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否要自动化 VPC 创建
- en: Subnet configuration (for example, head or main node placed in a public subnet
    with the rest of the compute fleet in a private subnet or subnets)
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 子网配置（例如，将头节点或主节点放置在公共子网中，其余的计算集群在私有子网或子网中）
- en: Additional shared storage volume (for example, FSx configuration)
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 额外的共享存储卷（例如，FSx配置）
- en: 'This creates a config file that can be found in `~/.parallelcluster` and modified
    before the creation of the cluster. Here is an example of a ParallelCluster config
    file:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这将创建一个可以在 `~/.parallelcluster` 中找到并修改的配置文件，在创建集群之前。以下是一个ParallelCluster配置文件的示例：
- en: '[PRE15]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'A deeper dive into the intricacies of the ParallelCluster config file can be
    found here: [https://aws.amazon.com/blogs/hpc/deep-dive-into-the-aws-parallelcluster-3-configuration-file/](https://aws.amazon.com/blogs/hpc/deep-dive-into-the-aws-parallelcluster-3-configuration-file/).'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 深入了解ParallelCluster配置文件的复杂性，请参阅以下内容：[https://aws.amazon.com/blogs/hpc/deep-dive-into-the-aws-parallelcluster-3-configuration-file/](https://aws.amazon.com/blogs/hpc/deep-dive-into-the-aws-parallelcluster-3-configuration-file/)。
- en: Step 4 – launching your ParallelCluster
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第4步 – 启动您的ParallelCluster
- en: 'Once you have verified the config file, use the following command to create
    and launch `ParallelCluster`:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您已验证配置文件，请使用以下命令创建和启动 `ParallelCluster`：
- en: '[PRE16]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Here, our cluster has been named `mycluster`. This will launch a CloudFormation
    template with the required resources to work with ParallelCluster, based on the
    config file you previously defined. The following services are used by AWS ParallelCluster:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们的集群已被命名为 `mycluster`。这将基于您之前定义的配置文件启动一个包含所需资源的CloudFormation模板。AWS ParallelCluster使用以下服务：
- en: AWS Batch
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS Batch
- en: AWS CloudFormation
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS CloudFormation
- en: Amazon CloudWatch
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon CloudWatch
- en: Amazon CloudWatch Logs
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 日志
- en: AWS CodeBuild
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS CodeBuild
- en: Amazon DynamoDB
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon DynamoDB
- en: Amazon Elastic Block Store
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon 弹性块存储
- en: Amazon **Elastic Compute** **Cloud** (**EC2**)
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon **弹性计算云**（**EC2**）
- en: Amazon Elastic Container Registry
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon 弹性容器注册
- en: Amazon **Elastic File** **System** (**EFS**)
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon **弹性文件系统**（**EFS**）
- en: Amazon FSx for Lustre
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon FSx for Lustre
- en: AWS Identity and Access Management
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS 身份和访问管理
- en: AWS Lambda
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS Lambda
- en: NICE DCV
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NICE DCV
- en: Amazon Route 53
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon Route 53
- en: Amazon Simple Storage Service
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon 简单存储服务
- en: Amazon VPC
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon VPC
- en: 'For more details on the services used, please refer to the links provided in
    the *References* section of this chapter. A simplified architecture diagram of
    AWS ParallelCluster is shown in *Figure 11**.8* – more details can be found on
    the following blog: [https://aws.amazon.com/blogs/compute/running-simcenter-star-ccm-on-aws/](https://aws.amazon.com/blogs/compute/running-simcenter-star-ccm-on-aws/).
    Otherwise, see the documentation page for ParallelCluster ([https://docs.aws.amazon.com/parallelcluster/latest/ug/what-is-aws-parallelcluster.html](https://docs.aws.amazon.com/parallelcluster/latest/ug/what-is-aws-parallelcluster.html)).'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 关于所使用服务的更多详细信息，请参阅本章 *参考文献* 部分提供的链接。AWS ParallelCluster的简化架构图显示在 *图11.8* 中。更多详细信息可以在以下博客中找到：[https://aws.amazon.com/blogs/compute/running-simcenter-star-ccm-on-aws/](https://aws.amazon.com/blogs/compute/running-simcenter-star-ccm-on-aws/)。否则，请参阅ParallelCluster的文档页面（[https://docs.aws.amazon.com/parallelcluster/latest/ug/what-is-aws-parallelcluster.html](https://docs.aws.amazon.com/parallelcluster/latest/ug/what-is-aws-parallelcluster.html)）。
- en: '![Figure 11.8 – AWS ParallelCluster architecture](img/B18493_11_008.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![图11.8 – AWS ParallelCluster架构](img/B18493_11_008.jpg)'
- en: Figure 11.8 – AWS ParallelCluster architecture
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.8 – AWS ParallelCluster架构
- en: 'The launch will typically take about 10 minutes and can be tracked both on
    the console as well as on the CloudFormation page on the AWS Management Console.
    On the console, the following message will confirm that your launch is in progress:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 启动通常需要大约10分钟，可以在控制台以及AWS管理控制台上的CloudFormation页面上跟踪。在控制台上，以下消息将确认您的启动正在进行：
- en: '[PRE17]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Wait for the status to say `"``clusterStatus": "CREATE_COMPLETE"`'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '等待状态显示为 `"clusterStatus": "CREATE_COMPLETE"`'
- en: Step 5 – installing OpenFOAM on the cluster
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第5步 – 在集群上安装OpenFOAM
- en: 'To install OpenFOAM on your cluster, see the following:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 要在您的集群上安装OpenFOAM，请参阅以下内容：
- en: 'First, add **Secure Shell** (**SSH**) into the head node of your newly created
    ParallelCluster:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，将 **Secure Shell**（**SSH**）添加到您新创建的ParallelCluster的头节点：
- en: '[PRE18]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'You are now in the head node of the ParallelCluster. Next, download the OpenFOAM
    files as follows:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在位于ParallelCluster的头节点上。接下来，按照以下步骤下载OpenFOAM文件：
- en: '[PRE28]'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '[PRE30]'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[PRE31]'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Next, untar the two files you just downloaded:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，解压缩您刚刚下载的两个文件：
- en: '[PRE32]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '[PRE34]'
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '[PRE35]'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Change the directory to the newly extracted OpenFOAM folder and compile OpenFOAM:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将目录更改到新提取的OpenFOAM文件夹，并编译OpenFOAM：
- en: '[PRE36]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '[PRE38]'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '[PRE40]'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'To install OpenFOAM on all nodes, you can use the `sbatch` command, and submit
    the preceding commands as a file named `compile.sh`: for example, `sbatch compile.sh`.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 要在所有节点上安装OpenFOAM，你可以使用`sbatch`命令，并将前面的命令作为名为`compile.sh`的文件提交：例如，`sbatch compile.sh`。
- en: Once installation completes, you can run a sample CFD application as shown in
    *step 6*.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，你可以运行如*步骤6*中所示的示例CFD应用程序。
- en: Step 6 – running a sample CFD application
  id: totrans-163
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤6 – 运行示例CFD应用程序
- en: 'Here, we will run a sample CFD application using ParallelCluster. First, we
    access the head node of the cluster we just created using SSH:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将使用ParallelCluster运行一个示例CFD应用程序。首先，我们使用SSH访问我们刚刚创建的集群的头节点：
- en: '[PRE41]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Make sure you use the same `.pem` file that you created in *step 3*!
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 确保你使用与*步骤3*中创建的相同的`.pem`文件！
- en: 'In this case, we will be running an example from OpenFOAM – incompressible
    flow over a motorbike. The case files for this case can be found here: [https://static.us-east-1.prod.workshops.aws/public/a536ee90-eecd-4851-9b43-e7977e3a5929/static/motorBikeDemo.tgz](https://static.us-east-1.prod.workshops.aws/public/a536ee90-eecd-4851-9b43-e7977e3a5929/static/motorBikeDemo.tgz).'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个案例中，我们将运行OpenFOAM的一个示例——摩托车上的不可压缩流动。此案例的案例文件可以在以下位置找到：[https://static.us-east-1.prod.workshops.aws/public/a536ee90-eecd-4851-9b43-e7977e3a5929/static/motorBikeDemo.tgz](https://static.us-east-1.prod.workshops.aws/public/a536ee90-eecd-4851-9b43-e7977e3a5929/static/motorBikeDemo.tgz)。
- en: The geometry corresponding to this case is shown in *Figure 11**.9*.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 与此案例对应的几何体在*图11.9*中显示。
- en: '![Figure 11.9 – Geometry for the motorbike case in OpenFOAM](img/B18493_11_009.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![图11.9 – OpenFOAM中摩托车案例的几何体](img/B18493_11_009.jpg)'
- en: Figure 11.9 – Geometry for the motorbike case in OpenFOAM
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.9 – OpenFOAM中摩托车案例的几何体
- en: 'To run the case in just the head node, you can run the following commands:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 仅在头节点上运行案例，你可以运行以下命令：
- en: '[PRE42]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: We will go into detail about what these commands do in later sections. For now,
    our aim is just to run the example motorbike case.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在后面的章节中详细介绍这些命令的功能。现在，我们的目标只是运行示例摩托车案例。
- en: 'To run the same case in parallel with all your compute nodes, you can use `sbatch`
    to submit the following shell script (similar to submitting the installation shell
    script). We can define some input arguments to the script, followed by loading
    **OpenMPI** and **OpenFOAM**:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 要在所有计算节点上并行运行相同的案例，你可以使用`sbatch`提交以下shell脚本（类似于提交安装shell脚本）。我们可以在脚本中定义一些输入参数，然后加载**OpenMPI**和**OpenFOAM**：
- en: '[PRE43]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'First, we mesh the geometry using the `blockMesh` and `snappyHexMesh` tools
    (see the following code):'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用`blockMesh`和`snappyHexMesh`工具对几何体进行网格划分（参见以下代码）：
- en: '[PRE44]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'We then check the quality of the mesh using `checkMesh`, and renumber and print
    out a summary of the mesh (see code):'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们使用`checkMesh`检查网格的质量，并对网格进行重新编号并打印出网格的摘要（参见代码）：
- en: '[PRE45]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Finally, we run OpenFOAM through the `potentialFoam` and `simpleFoam` binaries
    as shown here:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们通过`potentialFoam`和`simpleFoam`二进制文件运行OpenFOAM，如下所示：
- en: '[PRE46]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'You can follow instructions in the following AWS workshop to visualize results
    from the CFD case: [https://catalog.us-east-1.prod.workshops.aws/workshops/21c996a7-8ec9-42a5-9fd6-00949d151bc2/en-US/openfoam/openfoam-visualization](https://catalog.us-east-1.prod.workshops.aws/workshops/21c996a7-8ec9-42a5-9fd6-00949d151bc2/en-US/openfoam/openfoam-visualization).'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以按照以下AWS工作坊中的说明来可视化CFD案例的结果：[https://catalog.us-east-1.prod.workshops.aws/workshops/21c996a7-8ec9-42a5-9fd6-00949d151bc2/en-US/openfoam/openfoam-visualization](https://catalog.us-east-1.prod.workshops.aws/workshops/21c996a7-8ec9-42a5-9fd6-00949d151bc2/en-US/openfoam/openfoam-visualization)。
- en: Let’s discuss CFD Direct next.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们讨论CFD Direct。
- en: Using CFD Direct
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用CFD Direct
- en: 'In the previous section, we saw how you can run a CFD simulation using ParallelCluster
    on AWS. Now, we will look at how to run CFD using the CFD Direct offering on AWS
    Marketplace: [https://aws.amazon.com/marketplace/pp/prodview-ojxm4wfrodtj4](https://aws.amazon.com/marketplace/pp/prodview-ojxm4wfrodtj4).
    CFD Direct provides an Amazon EC2 image built on top of Ubuntu with all the typical
    tools you need to run CFD with OpenFOAM.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我们看到了如何使用ParallelCluster在AWS上运行CFD模拟。现在，我们将探讨如何在AWS Marketplace上的CFD Direct产品中运行CFD：[https://aws.amazon.com/marketplace/pp/prodview-ojxm4wfrodtj4](https://aws.amazon.com/marketplace/pp/prodview-ojxm4wfrodtj4)。CFD
    Direct提供了一个基于Ubuntu的Amazon EC2镜像，其中包含了运行CFD所需的典型工具。
- en: 'Perform the following steps to get started:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤开始操作：
- en: Follow the link above to CFD Direct’s Marketplace offering, and click **Continue**
    **to Subscribe**.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击上面的链接访问CFD Direct的Marketplace产品，然后点击**继续** **订阅**。
- en: Then, follow the instructions provided and click **Continue to Configure** (leave
    all options as the default), and then **Continue to Launch**. Similar to ParallelCluster,
    remember to use the right EC2 key pair so you can SSH into the instance that is
    launched for you.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，按照提供的说明操作，并点击 **继续配置**（保留所有选项为默认），然后点击 **继续启动**。类似于 ParallelCluster，请记住使用正确的
    EC2 密钥对，以便您能够 SSH 进入为您启动的实例。
- en: '![Figure 11.10 – CFD Direct AWS Marketplace offering (screenshot taken as of
    August 5, 2022)](img/B18493_11_010.jpg)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.10 – CFD Direct AWS Marketplace 提供的产品（截至 2022 年 8 月 5 日的截图）](img/B18493_11_010.jpg)'
- en: Figure 11.10 – CFD Direct AWS Marketplace offering (screenshot taken as of August
    5, 2022)
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.10 – CFD Direct AWS Marketplace 提供的产品（截至 2022 年 8 月 5 日的截图）
- en: 'Follow the instructions and get more help on using CFD Direct’s image here:
    [https://cfd.direct/cloud/aws/](https://cfd.direct/cloud/aws/).'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 按照说明获取更多关于使用 CFD Direct 的图像的帮助，请参阅[https://cfd.direct/cloud/aws/](https://cfd.direct/cloud/aws/)。
- en: 'To connect to the instance for the first time, use the instructions given here:
    [https://cfd.direct/cloud/aws/connect/](https://cfd.direct/cloud/aws/connect/).'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 要首次连接到实例，请使用以下说明：[https://cfd.direct/cloud/aws/connect/](https://cfd.direct/cloud/aws/connect/)。
- en: In the following tutorial, we will use the NICE DCV client as a remote desktop
    to interact with the EC2 instance.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下教程中，我们将使用 NICE DCV 客户端作为远程桌面与 EC2 实例进行交互。
- en: 'To install NICE DCV, perform the following steps:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 NICE DCV 的步骤如下：
- en: 'First, SSH into the instance you just launched, and then download and install
    the server. For example, with Ubuntu 20.04, use the following command:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，SSH 进入您刚刚启动的实例，然后下载并安装服务器。例如，对于 Ubuntu 20.04，请使用以下命令：
- en: '[PRE47]'
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Then, execute the following command to extract the `tar` file:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，执行以下命令以提取 `tar` 文件：
- en: '[PRE48]'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Install NICE DCV by executing the following:'
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下命令安装 NICE DCV：
- en: '[PRE49]'
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'To start the NICE DCV server, use the following command:'
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启动 NICE DCV 服务器，请使用以下命令：
- en: '[PRE50]'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Finally, start a session using the following:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，使用以下命令启动会话：
- en: '[PRE51]'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Find the public IP of your launched EC2 instance and use any NICE DCV client
    to connect to the instance (see *Figure 11**.11*):'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到您启动的 EC2 实例的公网 IP，并使用任何 NICE DCV 客户端连接到该实例（见 *图 11**.11*）：
- en: '![Figure 11.11 – Connecting to the EC2 instance using a public IP](img/B18493_11_011.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.11 – 使用公网 IP 连接到 EC2 实例](img/B18493_11_011.jpg)'
- en: Figure 11.11 – Connecting to the EC2 instance using a public IP
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.11 – 使用公网 IP 连接到 EC2 实例
- en: Next, use the username and password for Ubuntu (see *Figure 11**.12*). If you
    haven’t set a password, use the `passwd` command on a terminal using SSH.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 Ubuntu 的用户名和密码（见 *图 11**.12*）。如果您尚未设置密码，请在 SSH 终端上使用 `passwd` 命令。
- en: '![Figure 11.12 – Entering a username and password for Ubuntu](img/B18493_11_012.jpg)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.12 – 输入 Ubuntu 的用户名和密码](img/B18493_11_012.jpg)'
- en: Figure 11.12 – Entering a username and password for Ubuntu
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.12 – 输入 Ubuntu 的用户名和密码
- en: If prompted, select the session you want to connect to. Here, we started a session
    called `cfd`. You should now be looking at your Ubuntu desktop with OpenFOAM 9
    preinstalled.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果提示，选择您想要连接的会话。在这里，我们启动了一个名为 `cfd` 的会话。现在您应该能看到预装了 OpenFOAM 9 的 Ubuntu 桌面。
- en: '![Figure 11.13 – Ubuntu desktop provided by CFD Direct](img/B18493_11_013.jpg)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.13 – 由 CFD Direct 提供的 Ubuntu 桌面](img/B18493_11_013.jpg)'
- en: Figure 11.13 – Ubuntu desktop provided by CFD Direct
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.13 – 由 CFD Direct 提供的 Ubuntu 桌面
- en: 'To locate all the OpenFOAM tutorials to try out, use the following command:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要定位所有要尝试的 OpenFOAM 教程，请使用以下命令：
- en: '[PRE52]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'We will run a basic airfoil tutorial that is located in the following directory:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将在以下目录中运行一个基本的翼型教程：
- en: '[PRE54]'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The directory is set up like a typical OpenFOAM case and has the following
    contents (explore using the `tree` command on Ubuntu):'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 目录设置与典型的 OpenFOAM 案例类似，包含以下内容（在 Ubuntu 上使用 `tree` 命令进行探索）：
- en: '[PRE55]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Let us explore some of these files, as this will give you an understanding
    of any OpenFOAM case. The folder called `0` represents the initial conditions
    (as in, time step 0) for these key quantities we will be solving for:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探索一些这些文件，因为这将帮助您了解任何 OpenFOAM 案例的结构。名为 `0` 的文件夹代表我们将要解决这些关键量的初始条件（即，时间步长
    0）：
- en: '**Velocity** (**U**)'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**速度** (**U**)'
- en: '**Pressure** (**p**)'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**压力** (**p**)'
- en: 'What do these files look like? Let’s take a look at the `U` (velocity) file:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 这些文件看起来是什么样子？让我们看看 `U`（速度）文件：
- en: '[PRE56]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: As we can see here, the file defines the dimensions of the CFD domain and the
    free stream velocity, along with the inlet, outlet, and wall boundary conditions.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，该文件定义了 CFD 域的尺寸、自由流速度，以及入口、出口和壁面边界条件。
- en: 'The `Airfoil2D` folder also contains a folder called `constant`; this folder
    contains files specific to the CFD mesh that we will be creating. The `momentumTransport`
    file defines the kind of models to be used to solve this problem:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '`Airfoil2D` 文件夹还包含一个名为 `constant` 的文件夹；此文件夹包含我们将要创建的 CFD 网格的特定文件。`momentumTransport`
    文件定义了解决此问题所使用的模型类型：'
- en: '[PRE57]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: Here, we use the `SpalartAllmaras` turbulence model under the **Reynolds-Averaged
    Flow** (**RAF**) type. For more information about this, please visit [https://www.openfoam.com/documentation/guides/latest/doc/guide-turbulence-ras-spalart-allmaras.html](https://www.openfoam.com/documentation/guides/latest/doc/guide-turbulence-ras-spalart-allmaras.html).
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用 **Reynolds-Averaged Flow** （**RAF**）类型的 `SpalartAllmaras` 湍流模型。有关更多信息，请访问
    [https://www.openfoam.com/documentation/guides/latest/doc/guide-turbulence-ras-spalart-allmaras.html](https://www.openfoam.com/documentation/guides/latest/doc/guide-turbulence-ras-spalart-allmaras.html)。
- en: The `boundary` file inside the `polyMesh` folder contains definitions of the
    walls themselves; this is to let the simulation know what a surface *inlet* or
    *wall* represents. There are several other files in the `polyMesh` folder that
    we will not explore in this section.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '`polyMesh` 文件夹内的 `boundary` 文件包含了墙壁本身的定义；这是为了让模拟知道表面 *入口* 或 *墙壁* 代表什么。`polyMesh`
    文件夹中还有其他几个文件，我们将在本节中不进行探讨。'
- en: Inside the `System` folder, the `controlDict` file defines what applications
    to run for this case. OpenFOAM contains over 200 compiled applications; many of
    these are solvers and preprocessing and post-processing for the code.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `System` 文件夹内，`controlDict` 文件定义了为此案例运行的应用程序。OpenFOAM 包含超过 200 个编译应用程序；其中许多是求解器以及代码的前处理和后处理。
- en: 'Finally, we get to one of the most important files you will find in any OpenFOAM
    case: the `Allrun` executable. The `Allrun` file is a shell script that runs the
    steps we defined earlier for every typical CFD application in order – to import
    the geometry, create a mesh, solve the CFD problem, and post-process results.'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们来到了 OpenFOAM 案例中最重要的一些文件之一：`Allrun` 可执行文件。`Allrun` 文件是一个 shell 脚本，按照我们之前定义的顺序运行每个典型
    CFD 应用程序的步骤 – 导入几何形状、创建网格、解决 CFD 问题以及后处理结果。
- en: 'Depending on the output intervals defined in your `ControlDict` file, several
    output folders will be output in the same directory that correspond to different
    time stamps in the simulation. The CFD solvers will solve the problem until they
    converge, or until a maximum number of time steps is reached. The output folders
    will look similar to the timestep `0` folder that we created earlier. To visualize
    these results, we use a tool called `ParaView`:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您在 `ControlDict` 文件中定义的输出间隔，将在同一目录中输出几个输出文件夹，对应于模拟中的不同时间戳。CFD 求解器将解决问题，直到收敛或达到最大时间步数。输出文件夹将类似于我们之前创建的
    `timestep 0` 文件夹。为了可视化这些结果，我们使用一个名为 `ParaView` 的工具：
- en: First, let us look at the mesh we have created (see *Figure 11**.14*). The executables
    included within OpenFOAM that are responsible for creating this mesh are `blockmesh`
    and `snappyhexmesh`. You can also run these commands manually instead of running
    the `Allrun` file.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们看看我们创建的网格（见图 *11*.14）。OpenFOAM 中包含的负责创建此网格的可执行文件是 `blockmesh` 和 `snappyhexmesh`。您也可以手动运行这些命令，而不是运行
    `Allrun` 文件。
- en: '![Figure 11.14 – Mesh for the Airfoil 2D case in OpenFOAM](img/B18493_11_014.jpg)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.14 – OpenFOAM 中 Airfoil 2D 案例的网格](img/B18493_11_014.jpg)'
- en: Figure 11.14 – Mesh for the Airfoil 2D case in OpenFOAM
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.14 – OpenFOAM 中 Airfoil 2D 案例的网格
- en: 'Great – after solving the problem using the `SimpleFoam` executable, let us
    take a look at the pressure distribution around the airfoil (see *Figure 11**.15*):'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 太好了 – 使用 `SimpleFoam` 可执行文件解决问题后，让我们看一下翼型周围的压力分布（见图 *11*.15）：
- en: '![Figure 11.15 – Pressure distribution for the Airfoil 2D case in OpenFOAM](img/B18493_11_015.jpg)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.15 – OpenFOAM 中 Airfoil 2D 案例的压力分布](img/B18493_11_015.jpg)'
- en: Figure 11.15 – Pressure distribution for the Airfoil 2D case in OpenFOAM
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.15 – OpenFOAM 中 Airfoil 2D 案例的压力分布
- en: 'Lastly, we can use `ParaView` to visualize the velocity distribution, along
    with streamlines (see *Figure 11**.16*):'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们可以使用 `ParaView` 来可视化速度分布，以及流线（见图 *11*.16）：
- en: '![Figure 11.16 – Velocity distribution for the Airfoil 2D case in OpenFOAM](img/B18493_11_016.jpg)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.16 – OpenFOAM 中 Airfoil 2D 案例的速度分布](img/B18493_11_016.jpg)'
- en: Figure 11.16 – Velocity distribution for the Airfoil 2D case in OpenFOAM
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.16 – OpenFOAM 中 Airfoil 2D 案例的速度分布
- en: Note that these plots are post-processed by initializing `ParaView` with the
    `paraFoam` executable, which automatically understands output formatted by OpenFOAM
    cases.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这些图表是通过使用`paraFoam`可执行文件初始化`ParaView`后进行后处理的，它能够自动理解由OpenFOAM案例格式化的输出。
- en: 'Let us now look at a slightly more complicated case – the flow around a car:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看一个稍微复杂一些的案例——汽车周围的流动：
- en: 'First, let us look at the geometry of the car (*Figure 11**.17* and *Figure
    11**.18*):'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们看看车辆的几何形状（*图11.17* 和 *图11.18*）：
- en: '![Figure 11.17 – Car geometry (perspective view)](img/B18493_11_017.jpg)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![图11.17 – 车辆几何形状（透视视图）](img/B18493_11_017.jpg)'
- en: Figure 11.17 – Car geometry (perspective view)
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.17 – 车辆几何形状（透视视图）
- en: '![Figure 11.18 – Car geometry (side view)](img/B18493_11_018.jpg)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![图11.18 – 车辆几何形状（侧面图）](img/B18493_11_018.jpg)'
- en: Figure 11.18 – Car geometry (side view)
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.18 – 车辆几何形状（侧面视图）
- en: 'Next, we can use the `blockmesh` and `snappyhexmesh` commands to create the
    CFD mesh around this car (see *Figure 11**.19*):'
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们可以使用`blockmesh`和`snappyhexmesh`命令来创建围绕汽车的CFD网格（参见*图11.19*）：
- en: '![Figure 11.19 – Mesh created for the car case](img/B18493_11_019.jpg)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![图11.19 – 为车辆案例创建的网格](img/B18493_11_019.jpg)'
- en: Figure 11.19 – Mesh created for the car case
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.19 – 为车辆案例创建的网格
- en: 'We can then run the `Allrun` file to solve the problem. Finally, we will visualize
    the output (*Figures 11.20* and *Figure 11**.21*):'
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们可以运行`Allrun`文件来解决问题。最后，我们将可视化输出（*图11.20* 和 *图11.21*）：
- en: '![Figure 11.20 – Streamlines (black) and pressure distribution (perspective
    view) created for the car case](img/B18493_11_020.jpg)'
  id: totrans-254
  prefs: []
  type: TYPE_IMG
  zh: '![图11.20 – 为车辆案例创建的流线（黑色）和压力分布（透视视图）](img/B18493_11_020.jpg)'
- en: Figure 11.20 – Streamlines (black) and pressure distribution (perspective view)
    created for the car case
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.20 – 为车辆案例创建的流线（黑色）和压力分布（透视视图）
- en: '![Figure 11.21 – Streamlines (black) and pressure distribution (side view)
    created for the car case](img/B18493_11_021.jpg)'
  id: totrans-256
  prefs: []
  type: TYPE_IMG
  zh: '![图11.21 – 为车辆案例创建的流线（黑色）和压力分布（侧面视图）](img/B18493_11_021.jpg)'
- en: Figure 11.21 – Streamlines (black) and pressure distribution (side view) created
    for the car case
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.21 – 为车辆案例创建的流线（黑色）和压力分布（侧面视图）
- en: 'The files needed for the following cases can be found in the ZIP files provided
    in the GitHub repository here: [https://github.com/PacktPublishing/Applied-Machine-Learning-and-High-Performance-Computing-on-AWS/tree/main/Chapter11/runs](https://github.com/PacktPublishing/Applied-Machine-Learning-and-High-Performance-Computing-on-AWS/tree/main/Chapter11/runs).'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 以下案例所需的文件可以在GitHub仓库提供的ZIP文件中找到：[https://github.com/PacktPublishing/Applied-Machine-Learning-and-High-Performance-Computing-on-AWS/tree/main/Chapter11/runs](https://github.com/PacktPublishing/Applied-Machine-Learning-and-High-Performance-Computing-on-AWS/tree/main/Chapter11/runs)。
- en: In the next section, we will discuss some advancements in the CFD field related
    to using ML and deep learning with CFD tools.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将讨论与使用CFD工具的机器学习和深度学习相关的CFD领域的某些进展。
- en: Discussing how ML can be applied to CFD
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 讨论如何将机器学习应用于CFD
- en: CFD, being a field that has been around for decades, has matured to be very
    useful to companies in various domains and has also been implemented at scale
    using cloud providers. Recent advances in ML have been applied to CFD, and in
    this section, we will provide readers with pointers to articles written about
    this domain.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: CFD（计算流体动力学）作为一个存在了几十年的领域，已经发展成熟，对各个领域的公司非常有用，并且已经通过云服务提供商大规模实施。最近在机器学习（ML）方面的进步已经应用于CFD，在本节中，我们将为读者提供关于这个领域的文章的指引。
- en: 'Overall, we see deep learning techniques being applied in two primary ways:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 总体来看，我们看到深度学习技术以两种主要方式得到应用：
- en: 'Using deep learning to map inputs to outputs. We explored the flow over an
    airfoil in this chapter and visualized these results. If we had enough input variation
    and saved the outputs as images, we could use **autoencoders** or **Generative
    Adversarial Networks** (**GANs**) to generate these images. As an example, the
    following paper uses GANs to predict flows over airfoils using sparse data: [https://www.sciencedirect.com/science/article/pii/S1000936121000728](https://www.sciencedirect.com/science/article/pii/S1000936121000728).
    As we can see in *Figure 11**.22*, the flow fields predicted by CFD and the GAN
    are visually very similar:'
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用深度学习将输入映射到输出。在本章中，我们探讨了翼型上的流动并可视化了这些结果。如果我们有足够的输入变化并将输出保存为图像，我们可以使用**自编码器**或**生成对抗网络（GANs**）来生成这些图像。例如，以下论文使用GANs来预测使用稀疏数据的翼型流动：[https://www.sciencedirect.com/science/article/pii/S1000936121000728](https://www.sciencedirect.com/science/article/pii/S1000936121000728)。正如我们在*图11.22*中看到的那样，CFD和GAN预测的流动场在视觉上非常相似：
- en: '![Figure 11.22 – Pressure distribution generated by a trained GAN (left) and
    CFD (right)](img/B18493_11_022.jpg)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![图11.22 – 由训练好的GAN（左）和CFD（右）生成的压力分布](img/B18493_11_022.jpg)'
- en: Figure 11.22 – Pressure distribution generated by a trained GAN (left) and CFD
    (right)
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.22 – 由训练好的GAN（左）和CFD（右）生成的压力分布
- en: 'Similarly, Autodesk trained a network with over 800 examples of cars and can
    instantaneously predict the flow and drag of a new car body: [https://dl.acm.org/doi/10.1145/3197517.3201325](https://dl.acm.org/doi/10.1145/3197517.3201325)
    (see *figure 11.23*).'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，Autodesk训练了一个包含800多个汽车示例的网络，可以瞬间预测新汽车体的流动和阻力：[https://dl.acm.org/doi/10.1145/3197517.3201325](https://dl.acm.org/doi/10.1145/3197517.3201325)（参见*图11.23*）。
- en: '![Figure 11.23 – Flow field and drag coefficient being predicted instantaneously
    for various car shapes](img/B18493_11_023.jpg)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![图11.23 – 预测各种汽车形状的流动场和阻力系数](img/B18493_11_023.jpg)'
- en: Figure 11.23 – Flow field and drag coefficient being predicted instantaneously
    for various car shapes
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.23 – 预测各种汽车形状的流动场和阻力系数
- en: The second general type of innovation is not just mapping inputs to outputs,
    but actually using ML techniques as part of the CFD solver itself. For example,
    NVIDIA’s SIMNET ([https://arxiv.org/abs/2012.07938](https://arxiv.org/abs/2012.07938))
    paper describes how deep learning can be used to model the actual **Partial Differential
    Equations** (**PDEs**) that define the fluid flow and other physical phenomena.
    See *Figure 11**.24* for example results from SIMNET for flow over a heat sink.
    Parameterized training runs are faster than commercial and open source solvers,
    and inference for new geometries are instantaneous.
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二种创新的一般类型不仅仅是将输入映射到输出，而是实际上将机器学习技术作为CFD求解器本身的一部分。例如，NVIDIA的SIMNET([https://arxiv.org/abs/2012.07938](https://arxiv.org/abs/2012.07938))论文描述了如何使用深度学习来模拟定义流体流动和其他物理现象的实际**偏微分方程**(**PDEs**)。参见*图11.24*中的示例结果，展示了SIMNET对散热片的流动。参数化训练运行比商业和开源求解器更快，对新几何形状的推理是瞬时的。
- en: "![Figure 11.24 – Velocity (top row) and temperature (bottom row) comparisons\
    \ of OpenFOAM \uFEFFversus SIMNET from NVIDIA](img/B18493_11_024.jpg)"
  id: totrans-270
  prefs: []
  type: TYPE_IMG
  zh: '![图11.24 – OpenFOAM与NVIDIA的SIMNET在速度（顶部行）和温度（底部行）比较](img/B18493_11_024.jpg)'
- en: Figure 11.24 – Velocity (top row) and temperature (bottom row) comparisons of
    OpenFOAM versus SIMNET from NVIDIA
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.24 – OpenFOAM与NVIDIA的SIMNET在速度（顶部行）和温度（底部行）比较
- en: Let’s summarize what you have learned in this chapter next.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们总结一下在本章中学到的内容。
- en: Summary
  id: totrans-273
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we provided a high-level introduction to the world of CFD,
    and then explored multiple ways to use AWS to solve CFD problems (using ParallelCluster
    and CFD Direct on EC2). Finally, we discussed some recent advancements connecting
    the field of CFD to ML. While it is out of the scope of this book to go into much
    more detail regarding CFD, we hope that the readers are inspired to dive deeper
    into the topics explored here.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们提供了对CFD世界的概述，然后探讨了多种使用AWS解决CFD问题的方法（使用ParallelCluster和EC2上的CFD Direct）。最后，我们讨论了一些将CFD领域与ML联系起来的最新进展。虽然本书的范围不包括对CFD的更多细节，但我们希望读者能受到启发，更深入地探索这里探讨的主题。
- en: In the next chapter, we will focus on genomics applications using HPC. Specifically,
    we will talk about drug discovery and do a detailed walk-through of a protein
    structure prediction problem.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将专注于使用HPC的基因组学应用。具体来说，我们将讨论药物发现，并对蛋白质结构预测问题进行详细的讲解。
- en: References
  id: totrans-276
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: '*AWS* *Batch*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-batch-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-batch-v3)'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*AWS* *Batch*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-batch-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-batch-v3)'
- en: '*AWS* *CloudFormation*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-services-cloudformation-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-services-cloudformation-v3)'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*AWS* *CloudFormation*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-services-cloudformation-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-services-cloudformation-v3)'
- en: '*Amazon* *CloudWatch*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-v3)'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon* *CloudWatch*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-v3)'
- en: '*Amazon CloudWatch* *Logs*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-logs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-logs-v3)'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon CloudWatch Logs*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-logs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-cloudwatch-logs-v3)'
- en: '*AWS* *CodeBuild*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-codebuild-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-codebuild-v3)'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*AWS CodeBuild*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-codebuild-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#aws-codebuild-v3)'
- en: '*Amazon* *DynamoDB*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-dynamodb-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-dynamodb-v3)'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon DynamoDB*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-dynamodb-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-dynamodb-v3)'
- en: '*Amazon Elastic Block* *Store*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-block-store-ebs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-block-store-ebs-v3)'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon Elastic Block Store*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-block-store-ebs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-block-store-ebs-v3)'
- en: '*Amazon Elastic Container* *Registry*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-container-registry-ecr-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-container-registry-ecr-v3)'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon Elastic Container Registry*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-container-registry-ecr-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-elastic-container-registry-ecr-v3)'
- en: '*Amazon* *EFS*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-efs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-efs-v3)'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon EFS*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-efs-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-efs-v3)'
- en: '*Amazon FSx for* *Lustre*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-fsx-for-lustre-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-fsx-for-lustre-v3)'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Amazon FSx for Lustre*: [https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-fsx-for-lustre-v3](https://docs.aws.amazon.com/parallelcluster/latest/ug/aws-services-v3.html#amazon-fsx-for-lustre-v3)'
