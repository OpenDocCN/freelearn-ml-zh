<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch011.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1 chapterHead" data-number="10" id="chapter-3-working-with-quadratic-unconstrained-binary-optimization-problems">
<h1 class="H1---Chapter chapterHead" data-number="10"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 3</span></span><br/>
<span id="x1-590003"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Working with Quadratic Unconstrained Binary Optimization Problems</span></span></h1>
<div class="flushright">
<p><em><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">The universe cannot be read until we have learned the language and</span></em> <em><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">become familiar with the characters in which it is written.</span></em><br/><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">
— Galileo Galilei</span></p>
</div>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">Starting with this chapter, we will be studying different algorithms that have been proposed to solve optimization problems with quantum computers. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">We will work </span><span id="dx1-59001"/><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">both with </span><strong><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealers</span></strong><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml"> and with computers that </span><span id="dx1-59002"/><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">implement the </span><strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">quantum circuit model</span></strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.12.2" xmlns="http://www.w3.org/1999/xhtml">We will use methods </span><span id="dx1-59003"/><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">such as the </span><strong><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Approximate Optimization Algorithm</span></strong><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">QAOA</span></strong><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">), </span><strong><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">Grover’s</span></strong> <strong><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">Adaptive Search</span></strong><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">GAS</span></strong><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">), and the </span><strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">Variational Quantum Eigensolver</span></strong><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">VQE</span></strong><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.26.2" xmlns="http://www.w3.org/1999/xhtml">We will also </span><span id="dx1-59004"/><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">learn how to adapt these </span><span id="dx1-59005"/><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">algorithms to different types of problems, and how to run them on simulators and actual quantum computers.</span></p>
<p><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">But before we can do all that, we need a language in which we can state problems in a manner that makes it possible for a </span><span id="dx1-59006"/><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">quantum computer to solve them. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">In this regard, with the </span><strong><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">Quadratic Unconstrained Binary</span></strong> <strong><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">Optimization</span></strong><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">QUBO</span></strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">) framework, we can formulate many different optimization problems in a way that maps directly into the quantum setting, allowing us to use a plethora of quantum algorithms to try to find solutions that are optimal or, at least, close to optimal.</span></p>
<p><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">This chapter will introduce all the tools that we need to work with QUBO formulations. </span><span class="koboSpan" id="kobo.36.2" xmlns="http://www.w3.org/1999/xhtml">We will start by studying the </span><strong><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">maximum cut</span></strong><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml"> (or </span><strong><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">Max-Cut</span></strong><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">) problem in graphs, probably the simplest problem that can be formulated in the QUBO framework, and we will work our way up from there.</span></p>
<p><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">We’ll cover the following topics in this chapter:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">The Max-Cut problem and the Ising model</span></p></li>
<li><p><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">Enter quantum: formulating optimization problems the quantum way</span></p></li>
<li><p><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">Moving from Ising to QUBO and back</span></p></li>
<li><p><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">Combinatorial optimization problems with the QUBO model</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">After reading this chapter, you will be ready to write your own optimization problems in a format that will allow you to solve them using quantum computers.</span></p>
<section class="level2 sectionHead" data-number="10.1" id="the-max-cut-problem-and-the-ising-model">
<h1 class="sectionHead" data-number="10.1"><span class="titlemark"><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">3.1 </span></span> <span id="x1-600003.1"><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">The Max-Cut problem and the Ising model</span></span></h1>
<p><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">In order for us to </span><span id="dx1-60001"/><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">understand how to use quantum computers to solve optimization problems, we need to get used to some abstractions and techniques that we will develop throughout this chapter. </span><span class="koboSpan" id="kobo.50.2" xmlns="http://www.w3.org/1999/xhtml">To get started, we will consider the problem of finding what we call </span><strong><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">maximum cuts</span></strong><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"> in a mathematical </span><span id="dx1-60002"/><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">structure called a </span><strong><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">graph</span></strong><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.55.2" xmlns="http://www.w3.org/1999/xhtml">This is possibly the simplest problem that can be written in the formalism that we will be using in the following chapters. </span><span class="koboSpan" id="kobo.55.3" xmlns="http://www.w3.org/1999/xhtml">It will help us in gaining intuition and it will provide a solid foundation for formulating more complicated problems later on.</span></p>
<section class="level3 subsectionHead" data-number="10.1.1" id="graphs-and-cuts">
<h2 class="subsectionHead" data-number="10.1.1"><span class="titlemark"><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">3.1.1 </span></span> <span id="x1-610003.1.1"><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">Graphs and cuts</span></span></h2>
<p><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">When you are </span><span id="dx1-61001"/><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">given a graph, you are essentially given some </span><em><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">elements</span></em><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">, which we will refer to as </span><strong><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">vertices</span></strong><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">, and some </span><em><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">connections</span></em><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml"> between pairs of these vertices, </span><span id="dx1-61002"/><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">which we will call </span><strong><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">edges</span></strong><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.68.2" xmlns="http://www.w3.org/1999/xhtml">See </span><em><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.1"><em><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">3.1</span></em></a><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml"> for an example of a </span><span id="dx1-61003"/><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">graph with five vertices and six edges.</span></p>
<figure>
<span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 3.1: Example of a graph" src="../media/file303.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure3.1"><strong><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.1</span></strong><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">Example of a graph</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">Given a graph, the </span><strong><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">Max-Cut problem</span></strong><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml"> consists in </span><span id="dx1-61006"/><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">finding a </span><strong><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">maximum cut</span></strong><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml"> of it. </span><span class="koboSpan" id="kobo.82.2" xmlns="http://www.w3.org/1999/xhtml">That is, we want to divide the vertices of the graph into two sets — that’s what we call </span><strong><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">cutting</span></strong><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> the graph into two parts — such that the number of edges with extremes in different sets of the cut is the maximum possible. </span><span class="koboSpan" id="kobo.84.2" xmlns="http://www.w3.org/1999/xhtml">We call the number of such </span><span id="dx1-61007"/><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">edges the </span><strong><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">size of the cut</span></strong><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">, and we say that these </span><span id="dx1-61008"/><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">edges are </span><strong><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">cut</span></strong><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.90.2" xmlns="http://www.w3.org/1999/xhtml">You can imagine that, for instance, the vertices represent workers of a company, edges have been added between people who don’t get along that well, and you need to form two teams trying to minimize the number of conflicts by putting potential enemies in different teams.</span></p>
<p><em><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2"><em><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">3.2</span></em></a><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"> presents two different cuts for the graph in </span><em><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.1"><em><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">3.1</span></em></a><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">, using different colors for vertices that go in different sets and using dashed lines for edges that have extremes in different parts of the cut. </span><span class="koboSpan" id="kobo.96.2" xmlns="http://www.w3.org/1999/xhtml">As you can see, the cut in </span><em><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2a"><em><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">3.2a</span></em></a><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml"> has size </span><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">, while the cut in </span><em><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2b"><em><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">3.2b</span></em></a><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml"> is of size </span><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.106.2" xmlns="http://www.w3.org/1999/xhtml">In fact, it is easy to check that no cut of this graph can have a size bigger than </span><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span> <span id="dx1-61009"/><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">since vertices </span><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0,1" class="math inline" src="../media/file304.png" style="vertical-align:middle" title="0,1"/></span><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"> can’t all go in </span><span id="dx1-61010"/><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">different sets and, hence, at least one of the edges </span><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,1)" class="math inline" src="../media/file305.png" style="vertical-align:middle" title="(0,1)"/></span><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,2)" class="math inline" src="../media/file306.png" style="vertical-align:middle" title="(0,2)"/></span><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml">, or </span><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(1,2)" class="math inline" src="../media/file307.png" style="vertical-align:middle" title="(1,2)"/></span><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml"> will not be cut. </span><span class="koboSpan" id="kobo.119.2" xmlns="http://www.w3.org/1999/xhtml">The cut in </span><em><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2a"><em><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">3.2a</span></em></a><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"> is, then, a </span><strong><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">maximum</span></strong><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">optimal</span></strong><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml"> cut.</span></p>
<figure>
<span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(a)" src="../media/file308.jpg"/></span>
<figcaption aria-hidden="true"><span id="Figure3.2a"><strong><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">(a)</span></strong></span></figcaption>
</figure>
<figure>
<span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(b)" src="../media/file309.jpg"/></span>
<figcaption aria-hidden="true"><span id="Figure3.2b"><strong><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">(b)</span></strong></span></figcaption>
</figure>
<p><span id="Figure3.2"><strong><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.2</span></strong></span><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">: Two different cuts of the same graph</span></p>
<div class="tcolorbox questionx" id="tcolobox-64">
<span id="x1-61016x3.1.1"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.1</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">The maximum cut in a graph doesn’t need to be unique. </span><span class="koboSpan" id="kobo.134.2" xmlns="http://www.w3.org/1999/xhtml">Find a maximum cut for the graph in </span><em><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.1"><em><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">3.1</span></em></a><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"> in which vertices </span><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml"> are in the same set.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">So now we know what the Max-Cut problem is about. </span><span class="koboSpan" id="kobo.142.2" xmlns="http://www.w3.org/1999/xhtml">But how do we formulate it mathematically? </span><span class="koboSpan" id="kobo.142.3" xmlns="http://www.w3.org/1999/xhtml">We will learn exactly that in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.1.2" id="formulating-the-problem">
<h2 class="subsectionHead" data-number="10.1.2"><span class="titlemark"><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">3.1.2 </span></span> <span id="x1-620003.1.2"><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">Formulating the problem</span></span></h2>
<p><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">Surprisingly enough, we can formulate the </span><span id="dx1-62001"/><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">Max-Cut problem as a combinatorial optimization problem with no reference whatsoever to graphs, edges, or vertices. </span><span class="koboSpan" id="kobo.146.2" xmlns="http://www.w3.org/1999/xhtml">In order to do that, we associate a variable </span><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{i}" class="math inline" src="../media/file310.png" style="vertical-align:middle" title="z_{i}"/></span><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml"> to each vertex </span><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="i = 0,\ldots,n - 1" class="math inline" src="../media/file311.png" style="vertical-align:middle" title="i = 0,\ldots,n - 1"/></span><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml"> of the graph. </span><span class="koboSpan" id="kobo.150.2" xmlns="http://www.w3.org/1999/xhtml">Variables </span><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{i}" class="math inline" src="../media/file310.png" style="vertical-align:middle" title="z_{i}"/></span><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml"> will take value </span><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.156.2" xmlns="http://www.w3.org/1999/xhtml">Each assignment of values to the variables determines a cut: vertices whose variables take value </span><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml"> will be in one set and vertices whose variables take value </span><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml"> will be in the other one. </span><span class="koboSpan" id="kobo.160.2" xmlns="http://www.w3.org/1999/xhtml">For instance, for the cut of </span><em><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2a"><em><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">3.2a</span></em></a><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"> we could have </span><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{2} = z_{3} = 1" class="math inline" src="../media/file313.png" style="vertical-align:middle" title="z_{0} = z_{2} = z_{3} = 1"/></span><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = z_{4} = - 1" class="math inline" src="../media/file314.png" style="vertical-align:middle" title="z_{1} = z_{4} = - 1"/></span><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.167.2" xmlns="http://www.w3.org/1999/xhtml">Notice that, for our purposes, we could also represent that cut with the assignment </span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{2} = z_{3} = - 1" class="math inline" src="../media/file315.png" style="vertical-align:middle" title="z_{0} = z_{2} = z_{3} = - 1"/></span><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = z_{4} = 1" class="math inline" src="../media/file316.png" style="vertical-align:middle" title="z_{1} = z_{4} = 1"/></span><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">The key observation to </span><span id="dx1-62002"/><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">formulate Max-Cut as a combinatorial optimization problem is to notice that, if there is an edge between two vertices </span><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">, then that edge is cut if and only if </span><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}z_{k} = - 1" class="math inline" src="../media/file318.png" style="vertical-align:middle" title="z_{j}z_{k} = - 1"/></span><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.179.2" xmlns="http://www.w3.org/1999/xhtml">This is because if the two vertices are in the same set, then either </span><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = z_{k} = 1" class="math inline" src="../media/file319.png" style="vertical-align:middle" title="z_{j} = z_{k} = 1"/></span><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = z_{k} = - 1" class="math inline" src="../media/file320.png" style="vertical-align:middle" title="z_{j} = z_{k} = - 1"/></span><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"> and, consequently, </span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}z_{k} = 1" class="math inline" src="../media/file321.png" style="vertical-align:middle" title="z_{j}z_{k} = 1"/></span><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.185.2" xmlns="http://www.w3.org/1999/xhtml">However, if they are in different sets, then either </span><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = 1" class="math inline" src="../media/file322.png" style="vertical-align:middle" title="z_{j} = 1"/></span><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{k} = - 1" class="math inline" src="../media/file323.png" style="vertical-align:middle" title="z_{k} = - 1"/></span><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">, or </span><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = - 1" class="math inline" src="../media/file324.png" style="vertical-align:middle" title="z_{j} = - 1"/></span><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{k} = 1" class="math inline" src="../media/file325.png" style="vertical-align:middle" title="z_{k} = 1"/></span><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">, yielding </span><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}z_{k} = - 1" class="math inline" src="../media/file318.png" style="vertical-align:middle" title="z_{j}z_{k} = - 1"/></span><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">Thus, our problem can be written as</span></p>
<p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {\sum\limits_{(j,k) \in E}z_{j}z_{k}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,n - 1\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file326.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {\sum\limits_{(j,k) \in E}z_{j}z_{k}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,n - 1\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml"> is the set of edges in the graph and the vertices are </span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\{ 0,\ldots,n - 1\}" class="math inline" src="../media/file328.png" style="vertical-align:middle" title="\{ 0,\ldots,n - 1\}"/></span><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.202.2" xmlns="http://www.w3.org/1999/xhtml">For instance, for the graph in </span><em><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.1"><em><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">3.1</span></em></a><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">, we would have the following formulation:</span></p>
<p><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2} + z_{1}z_{2} + z_{1}z_{3} + z_{2}z_{4} + z_{3}z_{4}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,4.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file329.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2} + z_{1}z_{2} + z_{1}z_{3} + z_{2}z_{4} + z_{3}z_{4}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,4.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">Note that the cut </span><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{2} = z_{3} = 1" class="math inline" src="../media/file313.png" style="vertical-align:middle" title="z_{0} = z_{2} = z_{3} = 1"/></span><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = z_{4} = - 1" class="math inline" src="../media/file314.png" style="vertical-align:middle" title="z_{1} = z_{4} = - 1"/></span><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"> (which is the one in </span><em><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2a"><em><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">3.2a</span></em></a><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">), attains a value of </span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 4" class="math inline" src="../media/file330.png" style="vertical-align:middle" title="- 4"/></span><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"> in the function to be minimized, which is the minimum possible value for this particular case — but notice that it does not coincide with the number of edges that are cut! </span><span class="koboSpan" id="kobo.216.2" xmlns="http://www.w3.org/1999/xhtml">The cut </span><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{3} = - 1" class="math inline" src="../media/file331.png" style="vertical-align:middle" title="z_{0} = z_{3} = - 1"/></span><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{1} = z_{2} = z_{4} = 1" class="math inline" src="../media/file332.png" style="vertical-align:middle" title="z_{1} = z_{2} = z_{4} = 1"/></span><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">, on the other hand, achieves a value of </span><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2" class="math inline" src="../media/file333.png" style="vertical-align:middle" title="- 2"/></span><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">, showing once again that the cut on </span><em><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.2b"><em><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">3.2b</span></em></a><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"> is not optimal.</span></p>
<div class="tcolorbox questionx" id="tcolobox-65">
<span id="x1-62004x3.1.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.2</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">Write the Max-Cut problem for the graph in </span><em><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.3"><em><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">3.3</span></em></a><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"> as an optimization problem. </span><span class="koboSpan" id="kobo.230.2" xmlns="http://www.w3.org/1999/xhtml">What is the value of the function to be minimized when </span><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{1} = z_{2} = 1" class="math inline" src="../media/file334.png" style="vertical-align:middle" title="z_{0} = z_{1} = z_{2} = 1"/></span><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{3} = z_{4} = z_{5} = - 1" class="math inline" src="../media/file335.png" style="vertical-align:middle" title="z_{3} = z_{4} = z_{5} = - 1"/></span><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.234.2" xmlns="http://www.w3.org/1999/xhtml">Is it an optimal cut?</span></p>
</div>
</div>
<figure>
<span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 3.3: Another example of a graph" src="../media/file336.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure3.3"><strong><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.3</span></strong><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">Another example of a graph</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">At first sight, solving the Max-Cut </span><span id="dx1-62007"/><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">problem might seem easy enough. </span><span class="koboSpan" id="kobo.240.2" xmlns="http://www.w3.org/1999/xhtml">However, it is an </span><strong><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">NP-hard</span></strong><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"> problem (refer to </span><em><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch026.xhtml#x1-233000C"><em><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">C</span></em></a><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">Computational</span></em> <em><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">Complexity</span></em><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">, for more details on this kind of problem). </span><span class="koboSpan" id="kobo.248.2" xmlns="http://www.w3.org/1999/xhtml">That </span><span id="dx1-62008"/><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">means that if we were able to solve it efficiently with a classical algorithm, we would have </span><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P = NP" class="math inline" src="../media/file337.png" style="vertical-align:middle" title="P = NP"/></span><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">, something the scientific community strongly believes not to be true. </span><span class="koboSpan" id="kobo.251.2" xmlns="http://www.w3.org/1999/xhtml">This would be the case even if we could find a classical algorithm that approximates the optimal cut within a factor of </span><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 16\slash 17 \right." class="math inline" src="../media/file338.png" style="vertical-align:middle" title="\left. 16\slash 17 \right."/></span><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">, as was proved by Håstad in a paper published in 2001 </span><span class="cite"><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xhastad01optimal"><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">50</span></a><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.257.2" xmlns="http://www.w3.org/1999/xhtml">So, even if we resort to looking for precise enough approximations, the problem is indeed hard!</span></p>
<div class="tcolorbox learnmore" id="tcolobox-66">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">If you want to learn more about </span><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="P" class="math inline" src="../media/file1.png" style="vertical-align:middle" title="P"/></span><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">-hard problems, please check </span><em><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch026.xhtml#x1-233000C"><em><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">C</span></em></a><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">Computational Complexity</span></em><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.271.2" xmlns="http://www.w3.org/1999/xhtml">We will be discussing the </span><strong><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">ratio of approximation</span></strong><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"> that quantum algorithms can achieve for the Max-Cut problem in </span><em><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum</span></em> <em><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">We are now able to </span><span id="dx1-62009"/><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">formulate Max-Cut as a minimization problem in which the variables take values </span><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.285.2" xmlns="http://www.w3.org/1999/xhtml">Is this just accidental or are there more problems that can be written in a similar way? </span><span class="koboSpan" id="kobo.285.3" xmlns="http://www.w3.org/1999/xhtml">Keep on reading and you will learn the answer in the next subsection.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.1.3" id="the-ising-model">
<h2 class="subsectionHead" data-number="10.1.3"><span class="titlemark"><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">3.1.3 </span></span> <span id="x1-630003.1.3"><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">The Ising model</span></span></h2>
<p><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">The Max-Cut problem, as </span><span id="dx1-63001"/><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">formulated in the previous pages, can be seen as just a particular case of a seemingly unrelated problem in statistical physics: finding the state of minimum </span><strong><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">energy</span></strong><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml"> of an instance of the </span><strong><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">Ising model</span></strong><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.293.2" xmlns="http://www.w3.org/1999/xhtml">For the physics geeks out there, this is a mathematical model for the ferromagnetic interaction of particles with </span><strong><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">spin</span></strong><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">, usually arranged in a lattice (see </span><em><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.4"><em><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">3.4</span></em></a><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"> and refer to the book by Gallavotti </span><span class="cite"><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xgallavotti1999statistical"><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">42</span></a><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"> for more details). </span><span class="koboSpan" id="kobo.302.2" xmlns="http://www.w3.org/1999/xhtml">The particle spins are represented by variables </span><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml"> that can take values </span><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"> (spin up) or </span><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> (spin down) — sounds familiar, doesn’t it?</span></p>
<figure>
<span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 3.4: Example of the Ising model" src="../media/file340.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure3.4"><strong><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.4</span></strong><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">Example of the Ising model</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">The total </span><span id="dx1-63004"/><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">energy of the system is given by a </span><span id="dx1-63005"/><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">quantity called the </span><strong><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian</span></strong><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml"> function (more about this later in this chapter) defined by</span></p>
<p><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- \sum\limits_{j,k}J_{jk}z_{j}z_{k} - \sum\limits_{j}h_{j}z_{j}" class="math display" src="../media/file341.png" style="vertical-align:middle" title="- \sum\limits_{j,k}J_{jk}z_{j}z_{k} - \sum\limits_{j}h_{j}z_{j}"/></span></p>
<p><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">where the coefficients </span><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"> represent the interaction between particles </span><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> (usually, only non-zero for adjacent particles) and the coefficients </span><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml"> represent the influence of an external magnetic field on particle </span><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">Finding the state of minimum energy of the system consists in obtaining a spin configuration for which the Hamiltonian function attains its minimum value. </span><span class="koboSpan" id="kobo.330.2" xmlns="http://www.w3.org/1999/xhtml">As you can easily check yourself, when all the </span><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml"> coefficients are </span><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml"> and all the </span><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml"> coefficients are </span><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">, the problem is exactly the same as getting the maximum cut in a graph — although in a completely different context! </span><span class="koboSpan" id="kobo.338.2" xmlns="http://www.w3.org/1999/xhtml">Of course, this makes the problem of finding the state of minimum energy of a given Ising model an </span><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">-hard problem.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-67">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">The quantum annealers that we will be using in </span><em><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch012.xhtml#x1-750004"><em><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml">4</span></em></a><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Adiabatic Computing and Quantum Annealing</span></em><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">, are quantum computers constructed with the specific purpose of sampling from states of low energy of systems whose behavior can be described with the Ising model. </span><span class="koboSpan" id="kobo.348.2" xmlns="http://www.w3.org/1999/xhtml">We will use this property to try to approximate solutions to Max-Cut and many other related problems.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">Let’s give an </span><span id="dx1-63006"/><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">example of the problem of finding the minimum energy state of an Ising model. </span><span class="koboSpan" id="kobo.350.2" xmlns="http://www.w3.org/1999/xhtml">Imagine that we have particles arranged as in </span><em><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.4"><em><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">3.4</span></em></a><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">, where the numbers on the edges represent the coefficients </span><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml"> and we assume that the external magnetic field is homogeneous and that all coefficients </span><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"> are equal to </span><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.359.2" xmlns="http://www.w3.org/1999/xhtml">Then, the problem can be formulated as follows:</span></p>
<p><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} - 2z_{1}z_{2} + z_{2}z_{3} - 3z_{0}z_{4} + z_{1}z_{5} + z_{2}z_{6} - 3z_{3}z_{7}\qquad} &amp; &amp; \qquad \\ &amp; {+ z_{4}z_{5} - 2z_{5}z_{6} + z_{6}z_{7} - 3z_{4}z_{8} + z_{5}z_{9} + z_{6}z_{10} - 3z_{7}z_{11}\qquad} &amp; &amp; \qquad \\ &amp; {+ z_{8}z_{9} - 2z_{9}z_{10} + z_{10}z_{11} - z_{0} - z_{1} - z_{2} - z_{3} - z_{4} - z_{5}\qquad} &amp; &amp; \qquad \\ &amp; {- z_{6} - z_{7} - z_{8} - z_{9} - z_{10} - z_{11}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,11.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file344.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} - 2z_{1}z_{2} + z_{2}z_{3} - 3z_{0}z_{4} + z_{1}z_{5} + z_{2}z_{6} - 3z_{3}z_{7}\qquad} &amp; &amp; \qquad \\  &amp; {+ z_{4}z_{5} - 2z_{5}z_{6} + z_{6}z_{7} - 3z_{4}z_{8} + z_{5}z_{9} + z_{6}z_{10} - 3z_{7}z_{11}\qquad} &amp; &amp; \qquad \\  &amp; {+ z_{8}z_{9} - 2z_{9}z_{10} + z_{10}z_{11} - z_{0} - z_{1} - z_{2} - z_{3} - z_{4} - z_{5}\qquad} &amp; &amp; \qquad \\  &amp; {- z_{6} - z_{7} - z_{8} - z_{9} - z_{10} - z_{11}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,\ldots,11.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">This seems a little more involved than the formulations of the Max-Cut problem that we have seen so far, but it clearly follows the same pattern. </span><span class="koboSpan" id="kobo.361.2" xmlns="http://www.w3.org/1999/xhtml">However, you could be wondering what all this has to with quantum computing, since all these formulas only involve classical variables. </span><span class="koboSpan" id="kobo.361.3" xmlns="http://www.w3.org/1999/xhtml">Fair point! </span><span class="koboSpan" id="kobo.361.4" xmlns="http://www.w3.org/1999/xhtml">It is now time to use our knowledge of qubits and quantum gates to try to see all these problems under a different, quantum light.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="10.2" id="enter-quantum-formulating-optimization-problems-the-quantum-way">
<h1 class="sectionHead" data-number="10.2"><span class="titlemark"><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">3.2 </span></span> <span id="x1-640003.2"><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">Enter quantum: formulating optimization problems the quantum way</span></span></h1>
<p><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">In this section, we will unveil how all the work that we have done so far in this chapter has followed a secret plan! </span><span class="koboSpan" id="kobo.364.2" xmlns="http://www.w3.org/1999/xhtml">Was the choice of </span><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z" class="math inline" src="../media/file81.png" style="vertical-align:middle" title="z"/></span><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml"> as the name for the variables in our problems completely arbitrary? </span><span class="koboSpan" id="kobo.366.2" xmlns="http://www.w3.org/1999/xhtml">Of course not! </span><span class="koboSpan" id="kobo.366.3" xmlns="http://www.w3.org/1999/xhtml">If it made you think of those lovely </span><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml"> quantum gates and matrices that we introduced back in </span><em><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch008.xhtml#x1-180001"><em><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">1</span></em></a><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">Foundations</span></em> <em><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">of Quantum Computing</span></em><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">, you were on the right track. </span><span class="koboSpan" id="kobo.374.2" xmlns="http://www.w3.org/1999/xhtml">It will be the key to introducing the </span><em><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">quantum factor</span></em><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml"> into our problems, as we will begin to see in the next subsection.</span></p>
<section class="level3 subsectionHead" data-number="10.2.1" id="from-classical-variables-to-qubits">
<h2 class="subsectionHead" data-number="10.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml">3.2.1 </span></span> <span id="x1-650003.2.1"><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">From classical variables to qubits</span></span></h2>
<p><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">So far, the </span><span id="dx1-65001"/><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">formulations that we have considered for the Max-Cut problem and for the Ising model are purely classical. </span><span class="koboSpan" id="kobo.380.2" xmlns="http://www.w3.org/1999/xhtml">They do not mention quantum elements such as qubits, quantum gates, or measurements. </span><span class="koboSpan" id="kobo.380.3" xmlns="http://www.w3.org/1999/xhtml">But we are closer than you might think to being able to give a quantum formulation for these problems. </span><span class="koboSpan" id="kobo.380.4" xmlns="http://www.w3.org/1999/xhtml">We will start with a very simple instance of the Max-Cut problem and show how we can easily transform it into </span><em><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">quantum form</span></em><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.382.2" xmlns="http://www.w3.org/1999/xhtml">Consider the graph in </span><em><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.5"><em><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">3.5</span></em></a><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.385.2" xmlns="http://www.w3.org/1999/xhtml">We already know that the corresponding Max-Cut problem can be written as follows:</span></p>
<p><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file345.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {z_{0}z_{1} + z_{0}z_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ - 1,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<figure>
<span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 3.5: A very simple Max-Cut problem" src="../media/file346.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure3.5"><strong><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.5</span></strong><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">A very simple Max-Cut problem</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">The crucial </span><span id="dx1-65004"/><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">observation that we need to make in order to transform this formulation into a quantum one is that our beloved </span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"> matrix can be used to evaluate the different terms in the function that we need to minimize. </span><span class="koboSpan" id="kobo.394.2" xmlns="http://www.w3.org/1999/xhtml">Namely, it is easy to check that</span></p>
<p><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle 0 \right|Z\left| 0 \right\rangle = \begin{pmatrix} 1 &amp; 0 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}\begin{pmatrix} 1 \\ 0 \\ \end{pmatrix} = 1,\qquad\left\langle 1 \right|Z\left| 1 \right\rangle = \begin{pmatrix} 0 &amp; 1 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}\begin{pmatrix} 0 \\ 1 \\ \end{pmatrix} = - 1." class="math display" src="../media/file347.png" style="vertical-align:middle" title="\left\langle 0 \right|Z\left| 0 \right\rangle = \begin{pmatrix} 1 &amp; 0 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}\begin{pmatrix} 1 \\ 0 \\ \end{pmatrix} = 1,\qquad\left\langle 1 \right|Z\left| 1 \right\rangle = \begin{pmatrix} 0 &amp; 1 \\ \end{pmatrix}\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; {- 1} \\ \end{pmatrix}\begin{pmatrix} 0 \\ 1 \\ \end{pmatrix} = - 1."/></span></p>
<p><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">Now, consider the tensor product </span><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes Z \otimes I" class="math inline" src="../media/file348.png" style="vertical-align:middle" title="Z \otimes Z \otimes I"/></span><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml"> and basis state </span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {010} \right\rangle" class="math inline" src="../media/file251.png" style="vertical-align:middle" title="\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.400.2" xmlns="http://www.w3.org/1999/xhtml">We know from </span><em><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-360001.5.1"><em><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">1.5.1</span></em></a><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml"> that</span></p>
<p><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle {010} \right|Z \otimes Z \otimes I\left| {010} \right\rangle} &amp; {= \left\langle {010} \right|\left( {Z\left| 0 \right\rangle \otimes Z\left| 1 \right\rangle \otimes I\left| 0 \right\rangle} \right)\qquad} &amp; &amp; \qquad \\ &amp; {= \left\langle 0 \right|Z\left| 0 \right\rangle\left\langle 1 \right|Z\left| 1 \right\rangle\left\langle 0 \right|I\left| 0 \right\rangle = 1 \cdot ( - 1) \cdot 1 = - 1.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file349.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle {010} \right|Z \otimes Z \otimes I\left| {010} \right\rangle} &amp; {= \left\langle {010} \right|\left( {Z\left| 0 \right\rangle \otimes Z\left| 1 \right\rangle \otimes I\left| 0 \right\rangle} \right)\qquad} &amp; &amp; \qquad \\  &amp; {= \left\langle 0 \right|Z\left| 0 \right\rangle\left\langle 1 \right|Z\left| 1 \right\rangle\left\langle 0 \right|I\left| 0 \right\rangle = 1 \cdot ( - 1) \cdot 1 = - 1.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">We interpret </span><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {010} \right\rangle" class="math inline" src="../media/file251.png" style="vertical-align:middle" title="\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml"> as representing a cut in which vertices </span><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml"> are assigned to one set (because the value of qubits </span><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {010} \right\rangle" class="math inline" src="../media/file251.png" style="vertical-align:middle" title="\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">) and vertex </span><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml"> is assigned to the other (because qubit </span><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> has value </span><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {010} \right\rangle" class="math inline" src="../media/file251.png" style="vertical-align:middle" title="\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.427.2" xmlns="http://www.w3.org/1999/xhtml">Then, the fact that the product </span><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {010} \right|Z \otimes Z \otimes I\left| {010} \right\rangle" class="math inline" src="../media/file350.png" style="vertical-align:middle" title="\left\langle {010} \right|Z \otimes Z \otimes I\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml"> evaluates to </span><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"> means that edge </span><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,1)" class="math inline" src="../media/file305.png" style="vertical-align:middle" title="(0,1)"/></span><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml"> has extremes in different sets of the cut; that is because we have used </span><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes Z \otimes I" class="math inline" src="../media/file348.png" style="vertical-align:middle" title="Z \otimes Z \otimes I"/></span><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">, having </span><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml"> operators acting on qubits </span><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.441.2" xmlns="http://www.w3.org/1999/xhtml">This behavior is analogous to the one that we had with term </span><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0}z_{1}" class="math inline" src="../media/file351.png" style="vertical-align:middle" title="z_{0}z_{1}"/></span><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"> in the function to minimize our classical formulation of the problem.</span></p>
<p><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">In fact, </span><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes Z \otimes I" class="math inline" src="../media/file348.png" style="vertical-align:middle" title="Z \otimes Z \otimes I"/></span><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml"> is usually denoted by just </span><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml"> (the subindices indicate the positions of each </span><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml"> gate; the other positions are assumed to be the identity) and, following this convention, we would have, for instance,</span></p>
<p><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {010} \right|Z_{0}Z_{2}\left| {010} \right\rangle = \left\langle 0 \right|Z\left| 0 \right\rangle\left\langle 1 \right|I\left| 1 \right\rangle\left\langle 0 \right|Z\left| 0 \right\rangle = 1 \cdot 1 \cdot 1 = 1" class="math display" src="../media/file353.png" style="vertical-align:middle" title="\left\langle {010} \right|Z_{0}Z_{2}\left| {010} \right\rangle = \left\langle 0 \right|Z\left| 0 \right\rangle\left\langle 1 \right|I\left| 1 \right\rangle\left\langle 0 \right|Z\left| 0 \right\rangle = 1 \cdot 1 \cdot 1 = 1"/></span></p>
<p><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">because the edge </span><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,2)" class="math inline" src="../media/file306.png" style="vertical-align:middle" title="(0,2)"/></span><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml"> is not cut with this particular assignment.</span></p>
<p><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">Of course, this is </span><span id="dx1-65005"/><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">analogous for any basis state </span><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x \in \{ 000,001,\ldots,111\}" class="math inline" src="../media/file354.png" style="vertical-align:middle" title="x \in \{ 000,001,\ldots,111\}"/></span><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">, so </span><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle" class="math inline" src="../media/file355.png" style="vertical-align:middle" title="\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml"> if the edge </span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(j,k)" class="math inline" src="../media/file356.png" style="vertical-align:middle" title="(j,k)"/></span><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml"> is cut under an assignment </span><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"> and it will be </span><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.470.2" xmlns="http://www.w3.org/1999/xhtml">We only need to notice that if </span><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"> are in different parts of the cut, then their qubits will have different values and the product will be </span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">Furthermore, by linearity it holds that</span></p>
<p><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle = \left\langle x \right|Z_{0}Z_{1}\left| x \right\rangle + \left\langle x \right|Z_{0}Z_{2}\left| x \right\rangle." class="math display" src="../media/file357.png" style="vertical-align:middle" title="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle = \left\langle x \right|Z_{0}Z_{1}\left| x \right\rangle + \left\langle x \right|Z_{0}Z_{2}\left| x \right\rangle."/></span></p>
<p><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">Thus, we can rewrite our problem as finding a basis state </span><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml"> for which </span><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle" class="math inline" src="../media/file358.png" style="vertical-align:middle" title="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> attains a minimum.</span></p>
<div class="tcolorbox questionx" id="tcolobox-68">
<span id="x1-65007x3.2.1"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.3</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">Compute </span><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {010} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {010} \right\rangle" class="math inline" src="../media/file359.png" style="vertical-align:middle" title="\left\langle {010} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {010} \right\rangle"/></span><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {100} \right\rangle" class="math inline" src="../media/file360.png" style="vertical-align:middle" title="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.489.2" xmlns="http://www.w3.org/1999/xhtml">Does any of those states minimize </span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle" class="math inline" src="../media/file358.png" style="vertical-align:middle" title="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">?</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">But that is not the end of the story. </span><span class="koboSpan" id="kobo.492.2" xmlns="http://www.w3.org/1999/xhtml">For any basis state </span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">, it holds that either </span><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}Z_{k}\left| x \right\rangle = \left| x \right\rangle" class="math inline" src="../media/file361.png" style="vertical-align:middle" title="Z_{j}Z_{k}\left| x \right\rangle = \left| x \right\rangle"/></span><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}Z_{k}\left| x \right\rangle = - \left| x \right\rangle" class="math inline" src="../media/file362.png" style="vertical-align:middle" title="Z_{j}Z_{k}\left| x \right\rangle = - \left| x \right\rangle"/></span><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">, as you can easily check. </span><span class="koboSpan" id="kobo.498.2" xmlns="http://www.w3.org/1999/xhtml">Notice that this </span><span id="dx1-65008"/><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">proves that each </span><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml"> is an </span><strong><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">eigenvector</span></strong><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}Z_{k}" class="math inline" src="../media/file363.png" style="vertical-align:middle" title="Z_{j}Z_{k}"/></span><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><strong><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">eigenvalue</span></strong> <span id="dx1-65009"/><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">either </span><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml"> (refer to </span><em><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch025.xhtml#x1-226000B"><em><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">B</span></em></a><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml">Basic Linear Algebra</span></em><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">, for more information about eigenvectors and eigenvalues). </span><span class="koboSpan" id="kobo.516.2" xmlns="http://www.w3.org/1999/xhtml">Thus, for </span><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x \neq y" class="math inline" src="../media/file364.png" style="vertical-align:middle" title="x \neq y"/></span><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml"> we will have</span></p>
<p><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \right|Z_{j}Z_{k}\left| x \right\rangle = \pm \left\langle y \middle| x \right\rangle = 0," class="math display" src="../media/file365.png" style="vertical-align:middle" title="\left\langle y \right|Z_{j}Z_{k}\left| x \right\rangle = \pm \left\langle y \middle| x \right\rangle = 0,"/></span></p>
<p><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml">because </span><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle y \middle| x \right\rangle = 0" class="math inline" src="../media/file366.png" style="vertical-align:middle" title="\left\langle y \middle| x \right\rangle = 0"/></span><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml"> whenever </span><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x \neq y" class="math inline" src="../media/file364.png" style="vertical-align:middle" title="x \neq y"/></span><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">, as we proved in </span><em><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-360001.5.1"><em><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">1.5.1</span></em></a><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">Consequently, since a general state </span><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml"> can always be written as </span><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle = {\sum}_{x}a_{x}\left| x \right\rangle" class="math inline" src="../media/file367.png" style="vertical-align:middle" title="\left| \psi \right\rangle = {\sum}_{x}a_{x}\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">, it follows by linearity that</span></p>
<p><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle} &amp; {= \left( {\sum\limits_{y}a_{y}^{\ast}\left\langle y \right|} \right)Z_{j}Z_{k}\left( {\sum\limits_{x}a_{x}\left| x \right\rangle} \right) = \sum\limits_{y}\sum\limits_{x}a_{y}^{\ast}a_{x}\left\langle y \right|Z_{j}Z_{k}\left| x \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file368.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle} &amp; {= \left( {\sum\limits_{y}a_{y}^{\ast}\left\langle y \right|} \right)Z_{j}Z_{k}\left( {\sum\limits_{x}a_{x}\left| x \right\rangle} \right) = \sum\limits_{y}\sum\limits_{x}a_{y}^{\ast}a_{x}\left\langle y \right|Z_{j}Z_{k}\left| x \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{j}Z_{k}\left| x \right\rangle,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">where we have used </span><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{x}^{\ast}a_{x} = \left| a_{x} \right|^{2}" class="math inline" src="../media/file369.png" style="vertical-align:middle" title="a_{x}^{\ast}a_{x} = \left| a_{x} \right|^{2}"/></span><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml">Hence, again by linearity, it is true that</span></p>
<p><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\left\langle \psi \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| \psi \right\rangle} &amp; {= \left\langle \psi \right|Z_{0}Z_{1}\left| \psi \right\rangle + \left\langle \psi \right|Z_{0}Z_{2}\left| \psi \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{0}Z_{1}\left| x \right\rangle + \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{0}Z_{2}\left| x \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file370.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\left\langle \psi \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| \psi \right\rangle} &amp; {= \left\langle \psi \right|Z_{0}Z_{1}\left| \psi \right\rangle + \left\langle \psi \right|Z_{0}Z_{2}\left| \psi \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{0}Z_{1}\left| x \right\rangle + \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|Z_{0}Z_{2}\left| x \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {= \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml">We know that </span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{x}\left| a_{x} \right|^{2} = 1" class="math inline" src="../media/file371.png" style="vertical-align:middle" title="{\sum}_{x}\left| a_{x} \right|^{2} = 1"/></span><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml"> and that every </span><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| a_{x} \right|^{2}" class="math inline" src="../media/file372.png" style="vertical-align:middle" title="\left| a_{x} \right|^{2}"/></span><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml"> is non-negative, so it holds that</span></p>
<p><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle} &amp; {\geq \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle\qquad} &amp; &amp; \qquad \\ &amp; {= \left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle\sum\limits_{x}\left| a_{x} \right|^{2}\qquad} &amp; &amp; \qquad \\ &amp; {= \left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file373.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle} &amp; {\geq \sum\limits_{x}\left| a_{x} \right|^{2}\left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle\qquad} &amp; &amp; \qquad \\  &amp; {= \left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle\sum\limits_{x}\left| a_{x} \right|^{2}\qquad} &amp; &amp; \qquad \\  &amp; {= \left\langle x_{\min} \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x_{\min} \right\rangle,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x_{\min} \right\rangle" class="math inline" src="../media/file374.png" style="vertical-align:middle" title="\left| x_{\min} \right\rangle"/></span><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml"> is a basis state (there could be more than one) for which </span><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle" class="math inline" src="../media/file358.png" style="vertical-align:middle" title="\left\langle x \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml"> is minimum and, hence, </span><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{\min}" class="math inline" src="../media/file375.png" style="vertical-align:middle" title="x_{\min}"/></span><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml"> represents a maximum cut.</span></p>
<p><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">This may all seem a little bit too abstract. </span><span class="koboSpan" id="kobo.552.2" xmlns="http://www.w3.org/1999/xhtml">But what we have proved is simply that the minimum over all possible </span><span id="dx1-65010"/><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">quantum states is always reached on one of the basis states — which are the only ones that we can directly interpret as representing cuts. </span><span class="koboSpan" id="kobo.553.2" xmlns="http://www.w3.org/1999/xhtml">Then, we can rewrite the problem of finding a maximum cut for the graph of </span><em><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.5"><em><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">3.5</span></em></a><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> as follows:</span></p>
<p><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} &amp; {\text{Minimize~}\quad\left\langle \psi \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| \psi \right\rangle = \left\langle \psi \right|Z_{0}Z_{1}\left| \psi \right\rangle + \left\langle \psi \right|Z_{0}Z_{2}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\ &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}3\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file376.png" style="vertical-align:middle" title="\begin{array}{rlrl}  &amp; {\text{Minimize~}\quad\left\langle \psi \right|\left( {Z_{0}Z_{1} + Z_{0}Z_{2}} \right)\left| \psi \right\rangle = \left\langle \psi \right|Z_{0}Z_{1}\left| \psi \right\rangle + \left\langle \psi \right|Z_{0}Z_{2}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\  &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}3\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml">Notice the change that we have introduced. </span><span class="koboSpan" id="kobo.558.2" xmlns="http://www.w3.org/1999/xhtml">In our previous formulation, we were only minimizing over basis states, but now that we know that the minimum over all possible states is reached on a basis state, we are minimizing over all possible </span><span id="dx1-65011"/><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">quantum states. </span><span class="koboSpan" id="kobo.559.2" xmlns="http://www.w3.org/1999/xhtml">This will make our life easier in future chapters when we introduce quantum algorithms to solve this kind of problem, because we will be justified in using any quantum state instead of just constraining ourselves to those that come from the basis.</span></p>
<div class="tcolorbox important" id="tcolobox-69">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml">Although the minimum energy is always achieved on one basis state, it could also be the case that it is also achieved on a non-basis state. </span><span class="koboSpan" id="kobo.561.2" xmlns="http://www.w3.org/1999/xhtml">In fact, if two different basis states </span><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| x \right\rangle" class="math inline" src="../media/file267.png" style="vertical-align:middle" title="\left| x \right\rangle"/></span><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| y \right\rangle" class="math inline" src="../media/file268.png" style="vertical-align:middle" title="\left| y \right\rangle"/></span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"> achieve the minimum energy, then any superposition </span><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a\left| x \right\rangle + b\left| y \right\rangle" class="math inline" src="../media/file377.png" style="vertical-align:middle" title="a\left| x \right\rangle + b\left| y \right\rangle"/></span><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml"> is of minimum energy as well. </span><span class="koboSpan" id="kobo.567.2" xmlns="http://www.w3.org/1999/xhtml">That is the case, for example, for </span><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml"> for which both </span><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {01} \right\rangle" class="math inline" src="../media/file199.png" style="vertical-align:middle" title="\left| {01} \right\rangle"/></span><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {10} \right\rangle" class="math inline" src="../media/file200.png" style="vertical-align:middle" title="\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml"> have energy </span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.575.2" xmlns="http://www.w3.org/1999/xhtml">Then, any superposition </span><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a\left| {01} \right\rangle + b\left| {10} \right\rangle" class="math inline" src="../media/file378.png" style="vertical-align:middle" title="a\left| {01} \right\rangle + b\left| {10} \right\rangle"/></span><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml"> also achieves energy </span><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">, which is the minimum possible for </span><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">It can be easily checked that our preceding argument holds for any number of qubits and any sum of tensor products </span><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}Z_{k}" class="math inline" src="../media/file363.png" style="vertical-align:middle" title="Z_{j}Z_{k}"/></span><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">, so if we have a graph with set of vertices </span><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V" class="math inline" src="../media/file379.png" style="vertical-align:middle" title="V"/></span><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">, of size </span><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml">, and set of edges </span><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">, we can rewrite the Max-Cut problem for the graph as follows:</span></p>
<p><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} &amp; {\text{Minimize~}\quad\sum\limits_{(j,k) \in E}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\ &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}n\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file380.png" style="vertical-align:middle" title="\begin{array}{rlrl}  &amp; {\text{Minimize~}\quad\sum\limits_{(j,k) \in E}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\  &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}n\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<div class="tcolorbox important" id="tcolobox-70">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">Let’s take a step back and examine what we have proved. </span><span class="koboSpan" id="kobo.593.2" xmlns="http://www.w3.org/1999/xhtml">First, notice that </span><span id="dx1-65012"/><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">matrices such as</span></p>
<span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{(j,k) \in E}Z_{j}Z_{k}" class="math display" src="../media/file381.png" style="vertical-align:middle" title="\sum\limits_{(j,k) \in E}Z_{j}Z_{k}"/></span>
<p><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">are </span><strong><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">Hermitian</span></strong><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><strong><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml">self-adjoint</span></strong><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.600.2" xmlns="http://www.w3.org/1999/xhtml">This </span><span id="dx1-65013"/><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml">means that they are equal to their conjugate transposes, as you can easily verify, and they have particular properties such as having real eigenvalues and being able to form an orthonormal basis with their eigenvectors (refer to </span><em><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch025.xhtml#x1-226000B"><em><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">B</span></em></a><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml">Basic Linear Algebra</span></em><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">, for more details). </span><span class="koboSpan" id="kobo.606.2" xmlns="http://www.w3.org/1999/xhtml">In our case, we have proved that the computational basis </span><em><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml">is</span></em><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml"> such an orthonormal basis of eigenvectors. </span><span class="koboSpan" id="kobo.608.2" xmlns="http://www.w3.org/1999/xhtml">Furthermore, the quantity</span></p>
<span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|\left( {\sum\limits_{(j,k) \in E}Z_{j}Z_{k}} \right)\left| \psi \right\rangle = \sum\limits_{(j,k) \in E}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle," class="math display" src="../media/file382.png" style="vertical-align:middle" title="\left\langle \psi \right|\left( {\sum\limits_{(j,k) \in E}Z_{j}Z_{k}} \right)\left| \psi \right\rangle = \sum\limits_{(j,k) \in E}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle,"/></span>
<p><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml">which is usually </span><span id="dx1-65014"/><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml">called the </span><strong><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml">expectation value</span></strong><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{(j,k) \in E}Z_{j}Z_{k}" class="math inline" src="../media/file383.png" style="vertical-align:middle" title="{\sum}_{(j,k) \in E}Z_{j}Z_{k}"/></span><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml">, attains its minimum value on one of those eigenvectors, </span><span id="dx1-65015"/><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml">called the </span><strong><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml">ground state</span></strong><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml">This result is </span><span id="dx1-65016"/><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml">known as the </span><strong><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml">variational principle</span></strong><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml">, and we will revisit it in a more general form in </span><em><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch015.xhtml#x1-1190007"><em><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml">7</span></em></a><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">VQE: Variational</span></em> <em><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml">Quantum Eigensolver</span></em><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml">For the Ising model, the </span><span id="dx1-65017"/><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml">situation is exactly the same. </span><span class="koboSpan" id="kobo.630.2" xmlns="http://www.w3.org/1999/xhtml">We can go through an analogous reasoning, only this time also involving terms of the form </span><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}" class="math inline" src="../media/file384.png" style="vertical-align:middle" title="Z_{j}"/></span><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.632.2" xmlns="http://www.w3.org/1999/xhtml">Each </span><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{j}" class="math inline" src="../media/file384.png" style="vertical-align:middle" title="Z_{j}"/></span><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml"> is a tensor product with all the factors equal to the identity matrix except for the one in the </span><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml">-th position, which is </span><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.638.2" xmlns="http://www.w3.org/1999/xhtml">Then, finding the state of minimum energy of an Ising model with </span><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml"> particles and coefficients </span><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="J_{jk}" class="math inline" src="../media/file342.png" style="vertical-align:middle" title="J_{jk}"/></span><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h_{j}" class="math inline" src="../media/file343.png" style="vertical-align:middle" title="h_{j}"/></span><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml"> is equivalent to the following problem:</span></p>
<p><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} &amp; {\text{Minimize~}\qquad - \sum\limits_{(j,k) \in E}J_{jk}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle - \sum\limits_{j}h_{j}\left\langle \psi \right|Z_{j}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\ &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}n\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file385.png" style="vertical-align:middle" title="\begin{array}{rlrl}  &amp; {\text{Minimize~}\qquad - \sum\limits_{(j,k) \in E}J_{jk}\left\langle \psi \right|Z_{j}Z_{k}\left| \psi \right\rangle - \sum\limits_{j}h_{j}\left\langle \psi \right|Z_{j}\left| \psi \right\rangle,\qquad} &amp; &amp; \qquad \\  &amp; {{\text{where~}\left| \psi \right\rangle\text{~is~taken~from~the~set~of~quantum~states~on~}n\text{~qubits.}}\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml">So, we have been able to cast several combinatorial optimization problems into a </span><em><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml">quantum form</span></em><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.648.2" xmlns="http://www.w3.org/1999/xhtml">More concretely, we have rewritten our problems as instances of finding the ground state of a self-adjoint matrix </span><span id="dx1-65018"/><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml">called the </span><strong><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">Hamiltonian</span></strong><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml"> of the system. </span><span class="koboSpan" id="kobo.651.2" xmlns="http://www.w3.org/1999/xhtml">Notice, however, that we do not really need to obtain the exact ground state. </span><span class="koboSpan" id="kobo.651.3" xmlns="http://www.w3.org/1999/xhtml">If we can prepare a state </span><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml"> such that the amplitude </span><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{x_{\min}} = \left\langle x_{\min} \middle| \psi \right\rangle" class="math inline" src="../media/file386.png" style="vertical-align:middle" title="a_{x_{\min}} = \left\langle x_{\min} \middle| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml"> is big in absolute value, then we will have a high probability of finding </span><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{\min}" class="math inline" src="../media/file375.png" style="vertical-align:middle" title="x_{\min}"/></span><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml"> when we measure </span><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.659.2" xmlns="http://www.w3.org/1999/xhtml">This approach will be behind the algorithms that we will introduce in </span><em><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">Chapters</span></em> <em/> <a href="ch012.xhtml#x1-750004"><em><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml">4</span></em></a><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml"> through </span><em/> <a href="ch015.xhtml#x1-1190007"><em><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">7</span></em></a><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">In the following sections, we will see that the possibility of rewriting combinatorial optimization problems as </span><span id="dx1-65019"/><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">instances of ground state problems is not just a happy coincidence, but rather the norm, and we will show how to write many other important problems in this form. </span><span class="koboSpan" id="kobo.666.2" xmlns="http://www.w3.org/1999/xhtml">But, before we turn to that, let us write some code to work with those tensor products of </span><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml"> matrices and to compute their expectation values.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.2.2" id="computing-expectation-values-with-qiskit">
<h2 class="subsectionHead" data-number="10.2.2"><span class="titlemark"><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml">3.2.2 </span></span> <span id="x1-660003.2.2"><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">Computing expectation values with Qiskit</span></span></h2>
<p><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch009.xhtml#x1-400002"><em><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml">2</span></em></a><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">The Tools of the Trade in Quantum Computing</span></em><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml">, we introduced the main ways in which </span><span id="dx1-66001"/><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">Qiskit can be used to work with </span><span id="dx1-66002"/><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml">quantum circuits and to execute them on simulators and real quantum computers. </span><span class="koboSpan" id="kobo.678.2" xmlns="http://www.w3.org/1999/xhtml">But Qiskit also allows us to work with quantum states and Hamiltonians, combining them with tensor products and computing their expectation values, something that can be useful when dealing with optimization problems, as we have just seen. </span><span class="koboSpan" id="kobo.678.3" xmlns="http://www.w3.org/1999/xhtml">Learning how to perform these computations will help make the concepts that we have introduced more concrete. </span><span class="koboSpan" id="kobo.678.4" xmlns="http://www.w3.org/1999/xhtml">Moreover, in </span><em><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum</span></em> <em><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml">Approximate Optimization Algorithm</span></em><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">, we will be working extensively with Hamiltonians in Qiskit, so we will need to know how to initialize and manipulate them.</span></p>
<p><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start by showing, for example, how to define in Qiskit a basis state of three qubits such as </span><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {100} \right\rangle" class="math inline" src="../media/file387.png" style="vertical-align:middle" title="\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.687.2" xmlns="http://www.w3.org/1999/xhtml">We can do this in several different ways. </span><span class="koboSpan" id="kobo.687.3" xmlns="http://www.w3.org/1999/xhtml">For instance, we can first define one-qubit states </span><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml"> and compute their tensor products. </span><span class="koboSpan" id="kobo.691.2" xmlns="http://www.w3.org/1999/xhtml">There are several possible approaches to achieve this. </span><span class="koboSpan" id="kobo.691.3" xmlns="http://www.w3.org/1999/xhtml">The first one is to directly use the amplitudes to initialize a </span><code><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml">Statevector</span></code><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml"> object. </span><span class="koboSpan" id="kobo.693.2" xmlns="http://www.w3.org/1999/xhtml">To do that, we need to import the class and then call its constructor with input </span><code><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">[1,0]</span></code><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml"> (the amplitudes of </span><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">) as shown in the following fragment of code:</span></p>
<p><span id="x1-66003"/></p>
<pre class="lstlisting" id="listing-31"><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.quantum_info import Statevector 
 
zero = Statevector([1,0]) 
 
print("zero is", zero)
</span></pre>
<p><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml">The output that you will get if you run this code is</span></p>
<pre class="lstlisting" id="listing-32"><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml">

zero is Statevector([1.+0.j, 0.+0.j], 
 
            dims=(2,))
</span></pre>
<p><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">which shows that, indeed, we have created a </span><span id="dx1-66009"/><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml">quantum state and set it to </span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.704.2" xmlns="http://www.w3.org/1999/xhtml">Of course, to initialize a </span><span id="dx1-66010"/><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml">quantum state to </span><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 1 \right\rangle" class="math inline" src="../media/file14.png" style="vertical-align:middle" title="\left| 1 \right\rangle"/></span><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">, we can run</span></p>
<pre class="lstlisting" id="listing-33"><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml">

one = Statevector([0,1]) 
 
print("one is",one)
</span></pre>
<p><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml">obtaining this output:</span></p>
<pre class="lstlisting" id="listing-34"><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">

one is Statevector([0.+0.j, 1.+0.j], 
 
            dims=(2,))
</span></pre>
<p><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">An alternative, probably more convenient way of achieving the same result is to initialize the </span><code><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">Statevector</span></code><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml"> object from an integer such as </span><code><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">0</span></code><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml">1</span></code><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.717.2" xmlns="http://www.w3.org/1999/xhtml">We will use the </span><code><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml">from_int</span></code><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml"> method and it is important to also use the </span><code><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml">dims</span></code><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml"> parameter to indicate the size of the statevector. </span><span class="koboSpan" id="kobo.721.2" xmlns="http://www.w3.org/1999/xhtml">Otherwise, </span><code><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml">0</span></code><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml"> could be interpreted to be </span><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 0 \right\rangle" class="math inline" src="../media/file6.png" style="vertical-align:middle" title="\left| 0 \right\rangle"/></span><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {00} \right\rangle" class="math inline" src="../media/file198.png" style="vertical-align:middle" title="\left| {00} \right\rangle"/></span><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {000} \right\rangle" class="math inline" src="../media/file388.png" style="vertical-align:middle" title="\left| {000} \right\rangle"/></span><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml"> or... </span><span class="koboSpan" id="kobo.729.2" xmlns="http://www.w3.org/1999/xhtml">(as we mentioned in </span><em><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="ch008.xhtml#x1-280001.4.1"><em><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">1.4.1</span></em></a><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.732.2" xmlns="http://www.w3.org/1999/xhtml">In our case, we set </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml">dims</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">2</span></code></span></span><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml">, but in general, we will have to set </span><code><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml">dims</span></code><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2^{n}" class="math inline" src="../media/file256.png" style="vertical-align:middle" title="2^{n}"/></span><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">, where </span><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml"> is the number of qubits, because that is the number of amplitudes on an </span><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="n" class="math inline" src="../media/file244.png" style="vertical-align:middle" title="n"/></span><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">-qubit system. </span><span class="koboSpan" id="kobo.744.2" xmlns="http://www.w3.org/1999/xhtml">Then, we can run</span></p>
<pre class="lstlisting" id="listing-35"><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">

zero = Statevector.from_int(0, dims = 2) 
 
one = Statevector.from_int(1, dims = 2) 
 
print("zero is",zero) 
 
print("one is",one)
</span></pre>
<p><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml">which results in the following output, as expected:</span></p>
<pre class="lstlisting" id="listing-36"><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">

zero is Statevector([1.+0.j, 0.+0.j], 
 
            dims=(2,)) 
 
one is Statevector([0.+0.j, 1.+0.j], 
 
            dims=(2,))
</span></pre>
<p><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml">In either case, we can now </span><span id="dx1-66023"/><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">construct states with a higher number of qubits by computing tensor </span><span id="dx1-66024"/><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml">products with the </span><code><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">tensor</span></code><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml"> method, as shown in the following lines:</span></p>
<pre class="lstlisting" id="listing-37"><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">

psi = one.tensor(zero.tensor(zero)) 
 
print("psi is",psi)
</span></pre>
<p><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml">After running them, we will get the following output:</span></p>
<pre class="lstlisting" id="listing-38"><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">

psi is Statevector([0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 1.+0.j, 0.+0.j, 
 
             0.+0.j, 0.+0.j], 
 
            dims=(2, 2, 2))
</span></pre>
<p><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">Notice that the amplitude whose value is </span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml"> is in the fifth position. </span><span class="koboSpan" id="kobo.758.2" xmlns="http://www.w3.org/1999/xhtml">It corresponds to </span><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {100} \right\rangle" class="math inline" src="../media/file387.png" style="vertical-align:middle" title="\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">, because, in binary, </span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="100" class="math inline" src="../media/file389.png" style="vertical-align:middle" title="100"/></span><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml"> and we start counting on </span><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml">As you can imagine, both the way in which we compute the tensor product and the representation as an amplitude vector can become difficult to parse when we are working with many qubits. </span><span class="koboSpan" id="kobo.767.2" xmlns="http://www.w3.org/1999/xhtml">The following lines show a more concise way of using tensor products and a much more beautiful way of presenting states, but they achieve exactly the same result as the code shown previously:</span></p>
<pre class="lstlisting" id="listing-39"><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">

psi = one^zero^zero 
 
psi.draw("latex")
</span></pre>
<p><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the output will be just </span><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 100\rangle \right." class="math inline" src="../media/file390.png" style="vertical-align:middle" title="\left| 100\rangle \right."/></span><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.771.2" xmlns="http://www.w3.org/1999/xhtml">More readable, right?</span></p>
<p><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">A faster way of constructing the </span><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| 100\rangle \right." class="math inline" src="../media/file390.png" style="vertical-align:middle" title="\left| 100\rangle \right."/></span><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml"> state is using, again, the </span><code><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">from_int</span></code><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml"> method, as in</span></p>
<pre class="lstlisting" id="listing-40"><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">

psi = Statevector.from_int(4, dims = 8)
</span></pre>
<p><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml">where we specify that we are working with three qubits by setting </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">dims</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">8</span></code></span></span><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml"> (because we need 8 amplitudes to define a three-qubit state).</span></p>
<p><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">So, we now know a bunch of ways of </span><span id="dx1-66033"/><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml">creating basis states. </span><span class="koboSpan" id="kobo.784.2" xmlns="http://www.w3.org/1999/xhtml">What about states that are in superposition? </span><span class="koboSpan" id="kobo.784.3" xmlns="http://www.w3.org/1999/xhtml">Well, it couldn’t be easier, because, in Qiskit, you can simply multiply basis states by </span><span id="dx1-66034"/><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">amplitudes and then add them together. </span><span class="koboSpan" id="kobo.785.2" xmlns="http://www.w3.org/1999/xhtml">For instance, the instructions</span></p>
<pre class="lstlisting" id="listing-41"><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">

from numpy import sqrt 
 
ghz = 1/sqrt(2)*(zero^zero^zero) + 1/sqrt(2)*(one^one^one)
</span></pre>
<p><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">create the state </span><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. 1\slash\sqrt{2}\left| {000} \right\rangle + 1\slash\sqrt{2}\left| {111} \right\rangle \right." class="math inline" src="../media/file391.png" style="vertical-align:middle" title="\left. 1\slash\sqrt{2}\left| {000} \right\rangle + 1\slash\sqrt{2}\left| {111} \right\rangle \right."/></span><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox important" id="tcolobox-71">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml">It may seem that we have included some unnecessary parenthesis in the previous code. </span><span class="koboSpan" id="kobo.791.2" xmlns="http://www.w3.org/1999/xhtml">However, if you remove them, you will not get the expected result. </span><span class="koboSpan" id="kobo.791.3" xmlns="http://www.w3.org/1999/xhtml">Qiskit overloads the </span><code><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml">^</span></code><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml"> operator to be used as the tensor product operation. </span><span class="koboSpan" id="kobo.793.2" xmlns="http://www.w3.org/1999/xhtml">But, in Python, </span><code><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml">^</span></code><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml"> has a lower precedence than </span><code><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml">+</span></code><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">, so we need the parenthesis for the operations to be performed in the desired order.</span></p>
</div>
</div>
<div class="tcolorbox learnmore" id="tcolobox-72">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content"><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml">
An additional, indirect way of setting the values of a quantum state is creating a quantum circuit that prepares the state and running it to obtain the state vector with </span><code><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml">get_stavector</span></code><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml"> as we learned to do in </span><em><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch009.xhtml#x1-400002"><em><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">2</span></em></a><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">The Tools of the Trade in Quantum Computing</span></em><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml">; or you can even just pass the quantum circuit to the </span><code><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">Statevector</span></code><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml"> constructor. </span><span class="koboSpan" id="kobo.809.2" xmlns="http://www.w3.org/1999/xhtml">For instance, to create basis states, you would only need a circuit with </span><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml"> gates on the qubits that you need to be set to </span><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.813.2" xmlns="http://www.w3.org/1999/xhtml">If you use this method, however, you need to be careful to remember that qubit </span><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml"> in Qiskit circuits is represented as the rightmost one in kets. </span><span class="koboSpan" id="kobo.815.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if you have a three-qubit </span><code><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">QuantumCircuit</span></code><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml"> called </span><code><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml">qc</span></code><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml"> and you use </span><code><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml">qc</span></code><span style="color:#000000"><code><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml">.</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml">x</span></code></span>
<code><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml">(0)</span></code><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml">, you will obtain </span><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {001} \right\rangle" class="math inline" src="../media/file392.png" style="vertical-align:middle" title="\left| {001} \right\rangle"/></span><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">!
</span></div>
</div>
<p><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml">In order to compute expectation values, quantum states are not enough. </span><span class="koboSpan" id="kobo.827.2" xmlns="http://www.w3.org/1999/xhtml">We also need to create Hamiltonians. </span><span class="koboSpan" id="kobo.827.3" xmlns="http://www.w3.org/1999/xhtml">For now, we will learn how to work with tensor products of </span><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"> gates, like the ones we used in the previous section, starting with simple ones that can be stored in Qiskit </span><code><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml">Pauli</span></code><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.831.2" xmlns="http://www.w3.org/1999/xhtml">Qiskit offers </span><span id="dx1-66037"/><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml">several ways to initialize them, like in the case of </span><code><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml">Statevector</span></code><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.834.2" xmlns="http://www.w3.org/1999/xhtml">The first one is to use a string to specify the positions of </span><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml"> matrices in the product. </span><span class="koboSpan" id="kobo.838.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if we are </span><span id="dx1-66038"/><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml">working with three qubits and we want to create </span><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml"> (which is, as you surely remember, the tensor product </span><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes Z \otimes I" class="math inline" src="../media/file348.png" style="vertical-align:middle" title="Z \otimes Z \otimes I"/></span><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml">), we can use the following instructions:</span></p>
<pre class="lstlisting" id="listing-42"><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.quantum_info import Pauli 
 
Z0Z1 = Pauli("ZZI") 
 
print("Z0Z1 is",Z0Z1) 
 
print("And its matrix is") 
 
print(Z0Z1.to_matrix())
</span></pre>
<p><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">They give the following output:</span></p>
<pre class="lstlisting" id="listing-43"><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml">

Z0Z1 is ZZI 
 
And its matrix is 
 
[[ 1.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  1.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j -1.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j  0.+0.j -1.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j  0.+0.j  0.+0.j -1.+0.j  0.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j -1.+0.j  0.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  1.+0.j  0.+0.j] 
 
 [ 0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  0.+0.j  1.+0.j]]
</span></pre>
<p><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml">The matrix representing </span><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml"> is of size </span><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="8 \times 8" class="math inline" src="../media/file393.png" style="vertical-align:middle" title="8 \times 8"/></span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml"> and, as you can see, it can be hard to read. </span><span class="koboSpan" id="kobo.851.2" xmlns="http://www.w3.org/1999/xhtml">Fortunately, we can use the fact that tensor products of diagonal matrices are always diagonal, and print only the non-zero coefficients with the following instructions:</span></p>
<pre class="lstlisting" id="listing-44"><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml">

print("The sparse representation of Z0Z1 is") 
 
print(Z0Z1.to_matrix(sparse=True))
</span></pre>
<p><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">They will give us:</span></p>
<pre class="lstlisting" id="listing-45"><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml">

Z0Z1 is ZZI 
 
The sparse representation of Z0Z1 is 
 
  (0, 0)    (1+0j) 
 
  (1, 1)    (1+0j) 
 
  (2, 2)    (-1+0j) 
 
  (3, 3)    (-1+0j) 
 
  (4, 4)    (-1+0j) 
 
  (5, 5)    (-1+0j) 
 
  (6, 6)    (1+0j) 
 
  (7, 7)    (1+0j)
</span></pre>
<div class="tcolorbox learnmore" id="tcolobox-73">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">When constructing a </span><code><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml">Pauli</span></code><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml"> object, we can also specify which positions of the tensor product are </span><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml"> matrices, passing them as a vector of ones (indicating the presence of </span><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml">) and zeroes (indicating the absence of </span><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml"> or, equivalently, the presence of </span><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="I" class="math inline" src="../media/file53.png" style="vertical-align:middle" title="I"/></span><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.867.2" xmlns="http://www.w3.org/1999/xhtml">Since the construction method is more general and it can be used to create other tensor products, we would need to specify another vector with positions of </span><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="X" class="math inline" src="../media/file9.png" style="vertical-align:middle" title="X"/></span><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml"> matrices, which we will set to all zeroes for the moment.</span></p>
<p><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml">For instance, you can run something like </span><span class="lstinline"><span style="color:#000000"><code><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">Z0Z1</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml">=</span></code></span><span style="color:#000000"> </span><span style="color:#000000"><code><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">Pauli</span></code></span><span style="color:#000000"><code><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">(([0,1,1],[0,0,0]))</span></code></span></span><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml"> in order to obtain </span><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z \otimes Z \otimes I" class="math inline" src="../media/file348.png" style="vertical-align:middle" title="Z \otimes Z \otimes I"/></span><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.877.2" xmlns="http://www.w3.org/1999/xhtml">Notice that, because of the convention of qubit numbering in Qiskit, we need to use </span><code><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">[0,1,1]</span></code><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml"> for the vector of </span><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml"> positions instead of </span><code><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml">[1,1,0]</span></code><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml">The main drawback of working with </span><code><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml">Pauli</span></code><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml"> objects is that you </span><span id="dx1-66066"/><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml">cannot add them or multiply them by scalars. </span><span class="koboSpan" id="kobo.887.2" xmlns="http://www.w3.org/1999/xhtml">To get </span><span id="dx1-66067"/><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">something like </span><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} + Z_{1}Z_{2}" class="math inline" src="../media/file394.png" style="vertical-align:middle" title="Z_{0}Z_{1} + Z_{1}Z_{2}"/></span><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml">, we need first to convert the </span><code><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">Pauli</span></code><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml"> objects to </span><code><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">PauliOp</span></code><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml">, which we can then add together as shown in the following code:</span></p>
<pre class="lstlisting" id="listing-46"><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.opflow.primitive_ops import PauliOp 
 
H_cut = PauliOp(Pauli("ZZI")) + PauliOp(Pauli("ZIZ")) 
 
print("H_cut is") 
 
print(H_cut) 
 
print("The sparse representation of H_cut is") 
 
print(H_cut.to_spmatrix())
</span></pre>
<p><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">The output, in this case, is:</span></p>
<pre class="lstlisting" id="listing-47"><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">

H_cut is 
 
1.0 * ZZI 
 
+ 1.0 * ZIZ 
 
The sparse representation of H_cut is 
 
  (0, 0)    (2+0j) 
 
  (3, 3)    (-2+0j) 
 
  (4, 4)    (-2+0j) 
 
  (7, 7)    (2+0j)
</span></pre>
<p><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">Since the sum of </span><span id="dx1-66082"/><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">diagonal matrices is diagonal, we have used the sparse representation to more </span><span id="dx1-66083"/><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">compactly show the non-zero terms of </span><code><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">H_cut</span></code><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.902.2" xmlns="http://www.w3.org/1999/xhtml">Notice that even some of the diagonal terms are zero, because some elements of </span><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1}" class="math inline" src="../media/file352.png" style="vertical-align:middle" title="Z_{0}Z_{1}"/></span><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml"> cancel with those of </span><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{2}" class="math inline" src="../media/file395.png" style="vertical-align:middle" title="Z_{0}Z_{2}"/></span><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">A more compact way of obtaining the same Hamiltonian is:</span></p>
<pre class="lstlisting" id="listing-48"><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml">

from qiskit.opflow import I, Z 
 
H_cut = (Z^Z^I) + (Z^I^Z) 
 
print("H_cut is") 
 
print(H_cut)
</span></pre>
<p><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">This evaluates to:</span></p>
<pre class="lstlisting" id="listing-49"><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml">

H_cut is 
 
1.0 * ZZI 
 
+ 1.0 * ZIZ
</span></pre>
<p><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml">Notice that we have used </span><code><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">^</span></code><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml"> to compute tensor products and parenthesis to get the operation priorities right.</span></p>
<p><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">Of course, more complicated Hamiltonians, even including coefficients, can be constructed.</span></p>
<p><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml">For example,</span></p>
<pre class="lstlisting" id="listing-50"><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml">

H_ising = -0.5*(Z^Z^I) + 2*(Z^I^Z) -(I^Z^Z) + (I^Z^I) -5*(I^I^Z)
</span></pre>
<p><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">defines the Hamiltonian </span><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. - 1\slash 2Z_{0}Z_{1} + 2Z_{0}Z_{2} - Z_{1}Z_{2} + Z_{1} - 5Z_{2} \right." class="math inline" src="../media/file396.png" style="vertical-align:middle" title="\left. - 1\slash 2Z_{0}Z_{1} + 2Z_{0}Z_{2} - Z_{1}Z_{2} + Z_{1} - 5Z_{2} \right."/></span><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">Now we are </span><span id="dx1-66092"/><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">ready to compute </span><span id="dx1-66093"/><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">expectation values. </span><span class="koboSpan" id="kobo.922.2" xmlns="http://www.w3.org/1999/xhtml">Thanks to the code that we have written and executed so far, </span><code><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml">psi</span></code><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml"> stores </span><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {100} \right\rangle" class="math inline" src="../media/file387.png" style="vertical-align:middle" title="\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">H_cut</span></code><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml"> stores </span><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} + Z_{1}Z_{2}" class="math inline" src="../media/file394.png" style="vertical-align:middle" title="Z_{0}Z_{1} + Z_{1}Z_{2}"/></span><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.930.2" xmlns="http://www.w3.org/1999/xhtml">Then, computing </span><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{1}Z_{2}} \right)\left| {100} \right\rangle" class="math inline" src="../media/file397.png" style="vertical-align:middle" title="\left\langle {100} \right|\left( {Z_{0}Z_{1} + Z_{1}Z_{2}} \right)\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml"> is as easy as running the following instruction:</span></p>
<pre class="lstlisting" id="listing-51"><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml">

print("The expectation value is", psi.expectation_value(H_cut))
</span></pre>
<p><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml">This will give us the following output:</span></p>
<pre class="lstlisting" id="listing-52"><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml">

The expectation value is (-2+0j)
</span></pre>
<p><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml">Since </span><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z_{0}Z_{1} + Z_{0}Z_{2}" class="math inline" src="../media/file398.png" style="vertical-align:middle" title="Z_{0}Z_{1} + Z_{0}Z_{2}"/></span><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml"> is the Hamiltonian for the Max-Cut problem of the graph in </span><em><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.5"><em><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml">3.5</span></em></a><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">, this indicates that the assignment represented by </span><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| {100} \right\rangle" class="math inline" src="../media/file387.png" style="vertical-align:middle" title="\left| {100} \right\rangle"/></span><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml"> (vertex </span><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml"> in one set and </span><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml"> in the other) cuts the two edges of the graph and is, therefore, an optimal solution. </span><span class="koboSpan" id="kobo.949.2" xmlns="http://www.w3.org/1999/xhtml">Notice how the output is represented as a complex number because inner products can, in general, have imaginary parts. </span><span class="koboSpan" id="kobo.949.3" xmlns="http://www.w3.org/1999/xhtml">However, these expectation values will always be real, and the coefficients that will go with the imaginary unit — represented in Python as </span><code><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">j</span></code><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"> — will just be </span><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox questionx" id="tcolobox-74">
<span id="x1-66097x3.2.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.4</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml">Write code to compute the expectation value of all the possible cuts of the graph in </span><em><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.5"><em><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml">3.5</span></em></a><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.958.2" xmlns="http://www.w3.org/1999/xhtml">How many optimal solutions are there?</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">If you want to evaluate expressions such as </span><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left\langle \psi \right|H_{\text{cut}}\left| \psi \right\rangle" class="math inline" src="../media/file399.png" style="vertical-align:middle" title="\left\langle \psi \right|H_{\text{cut}}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml"> step by step, you can also use Qiskit to first compute </span><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="H_{\text{cut}}\left| \psi \right\rangle" class="math inline" src="../media/file400.png" style="vertical-align:middle" title="H_{\text{cut}}\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml"> and, then, the inner product of </span><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left| \psi \right\rangle" class="math inline" src="../media/file43.png" style="vertical-align:middle" title="\left| \psi \right\rangle"/></span><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"> with that. </span><span class="koboSpan" id="kobo.965.2" xmlns="http://www.w3.org/1999/xhtml">This can be achieved with the following instruction:</span></p>
<pre class="lstlisting" id="listing-53"><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">

print("The expectation value is", psi.inner(psi.evolve(H_cut)))
</span></pre>
<p><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml">Here, the </span><code><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml">evolve</span></code><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml"> method is </span><span id="dx1-66099"/><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml">used to </span><span id="dx1-66100"/><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml">compute the matrix-vector multiplication, and </span><code><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">inner</span></code><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml"> is, obviously, used for the inner product.</span></p>
<div class="tcolorbox important" id="tcolobox-75">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">We must stress that all these operations are numerical and not something that we can run on actual quantum computers. </span><span class="koboSpan" id="kobo.975.2" xmlns="http://www.w3.org/1999/xhtml">In fact, as you already know, on real devices we have no access to the full state vector: this is something that we can only do when we run circuits on simulators. </span><span class="koboSpan" id="kobo.975.3" xmlns="http://www.w3.org/1999/xhtml">In any case, we know that state vectors grow exponentially in size with the number of qubits, so simulations can easily become unfeasible in many scenarios. </span><span class="koboSpan" id="kobo.975.4" xmlns="http://www.w3.org/1999/xhtml">But don’t worry. </span><span class="koboSpan" id="kobo.975.5" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml">QAOA: Quantum Approximate</span></em> <em><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml">Optimization Algorithm</span></em><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml">, we will learn how to use quantum computers to estimate expectation values of tensor products of </span><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Z" class="math inline" src="../media/file8.png" style="vertical-align:middle" title="Z"/></span><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml"> matrices. </span><span class="koboSpan" id="kobo.983.2" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em> <em/> <a href="ch015.xhtml#x1-1190007"><em><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml">7</span></em></a><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml">VQE: Variational Quantum Eigensolver</span></em><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml">, we will do the same with more general tensor products. </span><span class="koboSpan" id="kobo.988.2" xmlns="http://www.w3.org/1999/xhtml">In fact, the procedure that we will use will clarify why we call these quantities </span><em><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">expectation values</span></em><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml">!</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">But enough of tensor products and expectation values for now. </span><span class="koboSpan" id="kobo.991.2" xmlns="http://www.w3.org/1999/xhtml">Instead, in the next section, we will introduce a new formalism that will allow us to formulate some optimization problems more naturally than with the Ising model.</span></p>
</section>
</section>
<section class="level2 sectionHead" data-number="10.3" id="moving-from-ising-to-qubo-and-back">
<h1 class="sectionHead" data-number="10.3"><span class="titlemark"><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml">3.3 </span></span> <span id="x1-670003.3"><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">Moving from Ising to QUBO and back</span></span></h1>
<p><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml">Consider the </span><span id="dx1-67001"/><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml">following problem. </span><span class="koboSpan" id="kobo.995.2" xmlns="http://www.w3.org/1999/xhtml">Let’s say that you are given a set of integers </span><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S" class="math inline" src="../media/file73.png" style="vertical-align:middle" title="S"/></span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"> and a target integer value </span><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml">, and you are asked whether there is any subset of </span><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S" class="math inline" src="../media/file73.png" style="vertical-align:middle" title="S"/></span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"> whose sum is </span><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1003.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if </span><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ 1,3,4,7, - 4\}" class="math inline" src="../media/file401.png" style="vertical-align:middle" title="S = \{ 1,3,4,7, - 4\}"/></span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T = 6" class="math inline" src="../media/file402.png" style="vertical-align:middle" title="T = 6"/></span><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml">, then the answer is affirmative, because </span><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3 + 7 - 4 = 6" class="math inline" src="../media/file403.png" style="vertical-align:middle" title="3 + 7 - 4 = 6"/></span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1009.2" xmlns="http://www.w3.org/1999/xhtml">However, if </span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ 2, - 2,4,8, - 12\}" class="math inline" src="../media/file404.png" style="vertical-align:middle" title="S = \{ 2, - 2,4,8, - 12\}"/></span><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T = 1" class="math inline" src="../media/file405.png" style="vertical-align:middle" title="T = 1"/></span><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">, the answer is negative because all the numbers in the set are even and they cannot add up to an odd number.</span></p>
<p><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml">This problem, </span><span id="dx1-67002"/><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">called the </span><strong><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml">Subset Sum</span></strong><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml"> problem, is </span><span id="dx1-67003"/><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">known to be </span><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><strong><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml">-complete</span></strong><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml"> (see, for instance, </span><em><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">Section 7.5</span></em><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"> in the book by Sipser </span><span class="cite"><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsipser2012introduction"><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml">90</span></a><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml"> for a proof). </span><span class="koboSpan" id="kobo.1027.2" xmlns="http://www.w3.org/1999/xhtml">It turns out that we can </span><strong><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">reduce</span></strong><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml"> the Subset Sum problem to finding a spin configuration of minimal energy for an Ising model, (which is an </span><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">-hard problem – see </span><em><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml">Section</span></em> <em/> <a href="#x1-630003.1.3"><em><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml">3.1.3</span></em></a><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1034.2" xmlns="http://www.w3.org/1999/xhtml">This means that we can rewrite any instance of Subset Sum as an Ising ground state problem (check </span><em><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml">Appendix</span></em> <em/> <a href="ch026.xhtml#x1-233000C"><em><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">C</span></em></a><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">Computational</span></em> <em><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml">Complexity</span></em><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">, for a refresher on </span><strong><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">reductions</span></strong><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
<p><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">However, it may not be directly evident how to do so.</span></p>
<p><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">In fact, it is much simpler to pose the Subset Sum </span><span id="dx1-67004"/><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml">problem as a minimization problem by using binary variables instead of variables that take </span><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml"> values. </span><span class="koboSpan" id="kobo.1049.2" xmlns="http://www.w3.org/1999/xhtml">Indeed, if we are given </span><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ a_{0},\ldots,a_{m}\}" class="math inline" src="../media/file406.png" style="vertical-align:middle" title="S = \{ a_{0},\ldots,a_{m}\}"/></span><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml"> and an integer </span><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml">, we can define binary variables </span><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml">, and consider</span></p>
<p><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c(x_{0},x_{1},\ldots,x_{m}) = \left( {a_{0}x_{0} + a_{1}x_{1} + \ldots + a_{m}x_{m} - T} \right)^{2}." class="math display" src="../media/file409.png" style="vertical-align:middle" title="c(x_{0},x_{1},\ldots,x_{m}) = \left( {a_{0}x_{0} + a_{1}x_{1} + \ldots + a_{m}x_{m} - T} \right)^{2}."/></span></p>
<p><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml">Clearly, the Subset Sum problem has a positive answer if and only if we can find binary values </span><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml">, such that </span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c(x_{0},x_{1},\ldots,x_{m}) = 0" class="math inline" src="../media/file410.png" style="vertical-align:middle" title="c(x_{0},x_{1},\ldots,x_{m}) = 0"/></span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1065.2" xmlns="http://www.w3.org/1999/xhtml">In that case, the variables </span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml"> that are equal to </span><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml"> will indicate which numbers from the set are selected for the sum. </span><span class="koboSpan" id="kobo.1069.2" xmlns="http://www.w3.org/1999/xhtml">But </span><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c(x_{0},x_{1},\ldots,x_{m})" class="math inline" src="../media/file411.png" style="vertical-align:middle" title="c(x_{0},x_{1},\ldots,x_{m})"/></span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml"> is always non-negative, so we have reduced the Subset Sum problem to finding the minimum of </span><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c(x_{0},x_{1},\ldots,x_{m})" class="math inline" src="../media/file411.png" style="vertical-align:middle" title="c(x_{0},x_{1},\ldots,x_{m})"/></span><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml">: if the minimum is </span><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml">, the Subset Sum has a positive solution; otherwise, it doesn’t.</span></p>
<p><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml">For example, for the case of </span><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ 1,4, - 2\}" class="math inline" src="../media/file412.png" style="vertical-align:middle" title="S = \{ 1,4, - 2\}"/></span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T = 2" class="math inline" src="../media/file413.png" style="vertical-align:middle" title="T = 2"/></span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"> that we considered previously, the problem would be</span></p>
<p><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {x_{0}^{2} + 8x_{0}x_{1} - 4x_{0}x_{2} - 4x_{0} + 16x_{1}^{2} - 16x_{1}x_{2} - 16x_{1} + 4x_{2}^{2} + 8x_{2} + 4\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file414.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {x_{0}^{2} + 8x_{0}x_{1} - 4x_{0}x_{2} - 4x_{0} + 16x_{1}^{2} - 16x_{1}x_{2} - 16x_{1} + 4x_{2}^{2} + 8x_{2} + 4\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml">where we have expanded </span><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{(x_{0} + 4x_{1} - 2x_{2} - 2)}^{2}" class="math inline" src="../media/file415.png" style="vertical-align:middle" title="{(x_{0} + 4x_{1} - 2x_{2} - 2)}^{2}"/></span><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml"> to obtain the expression to be optimized. </span><span class="koboSpan" id="kobo.1084.2" xmlns="http://www.w3.org/1999/xhtml">If you wish, you can simplify it a little by taking into account that </span><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}^{2} = x_{j}" class="math inline" src="../media/file416.png" style="vertical-align:middle" title="x_{j}^{2} = x_{j}"/></span><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"> always holds for binary variables. </span><span class="koboSpan" id="kobo.1086.2" xmlns="http://www.w3.org/1999/xhtml">In any case, </span><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = 0,x_{1} = x_{2} = 1" class="math inline" src="../media/file417.png" style="vertical-align:middle" title="x_{0} = 0,x_{1} = x_{2} = 1"/></span><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml"> would be an optimal solution for this problem.</span></p>
<p><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml">Notice that, in all of these cases, the function </span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c(x_{0},x_{1},\ldots,x_{m})" class="math inline" src="../media/file411.png" style="vertical-align:middle" title="c(x_{0},x_{1},\ldots,x_{m})"/></span><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml"> that we need to minimize is a polynomial of degree </span><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml"> on the binary variables </span><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1095.2" xmlns="http://www.w3.org/1999/xhtml">We can thus </span><span id="dx1-67005"/><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">generalize this setting and define </span><strong><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml">Quadratic Unconstrained</span></strong> <strong><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml">Binary Optimization</span></strong><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">QUBO</span></strong><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml">) problems, which are of the form</span></p>
<p><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {q(x_{0},\ldots,x_{m})\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file418.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {q(x_{0},\ldots,x_{m})\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="q(x_{0},\ldots,x_{m})" class="math inline" src="../media/file419.png" style="vertical-align:middle" title="q(x_{0},\ldots,x_{m})"/></span><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml"> is a quadratic polynomial on the </span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml"> variables. </span><span class="koboSpan" id="kobo.1107.2" xmlns="http://www.w3.org/1999/xhtml">The reason why these problems are called </span><span id="dx1-67006"/><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">QUBO should now be clear: we are minimizing quadratic expressions over binary variables with no restrictions (because every combination of zeroes and ones is acceptable).</span></p>
<p><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml">From the preceding reduction of the Subset Sum problem, it follows that </span><span id="dx1-67007"/><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml">QUBO problems are </span><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">-hard. </span><span class="koboSpan" id="kobo.1112.2" xmlns="http://www.w3.org/1999/xhtml">Indeed, the QUBO model is very flexible, and it enables us to formulate many optimization problems in a natural way. </span><span class="koboSpan" id="kobo.1112.3" xmlns="http://www.w3.org/1999/xhtml">For example, it is quite easy to recast any Ising minimization problem as a QUBO instance. </span><span class="koboSpan" id="kobo.1112.4" xmlns="http://www.w3.org/1999/xhtml">If you need to minimize</span></p>
<p><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- \sum\limits_{j,k}J_{jk}z_{j}z_{k} - \sum\limits_{j}h_{j}z_{j}" class="math display" src="../media/file341.png" style="vertical-align:middle" title="- \sum\limits_{j,k}J_{jk}z_{j}z_{k} - \sum\limits_{j}h_{j}z_{j}"/></span></p>
<p><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml">with some variables </span><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml">, taking values </span><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">, you can define new variables </span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. x_{j} = (1 - z_{j})\slash 2 \right." class="math inline" src="../media/file420.png" style="vertical-align:middle" title="\left. x_{j} = (1 - z_{j})\slash 2 \right."/></span><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1124.2" xmlns="http://www.w3.org/1999/xhtml">Obviously, </span><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml"> when </span><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml"> when </span><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1138.2" xmlns="http://www.w3.org/1999/xhtml">Furthermore, if you make the substitutions </span><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = 1 - 2x_{j}" class="math inline" src="../media/file421.png" style="vertical-align:middle" title="z_{j} = 1 - 2x_{j}"/></span><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml">, you obtain a quadratic polynomial in the binary variables </span><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml"> that takes exactly the same values as the energy function of the original Ising model. </span><span class="koboSpan" id="kobo.1142.2" xmlns="http://www.w3.org/1999/xhtml">If you minimize the polynomial for the variables </span><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml">, you can then recover the spin values </span><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml"> that achieve the minimal energy.</span></p>
<p><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml">In case you were wondering, yes, you can also use the substitution </span><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = 2x_{j} - 1" class="math inline" src="../media/file422.png" style="vertical-align:middle" title="z_{j} = 2x_{j} - 1"/></span><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml"> to transform Ising problems into QUBO formalism. </span><span class="koboSpan" id="kobo.1149.2" xmlns="http://www.w3.org/1999/xhtml">In that case, values of </span><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml"> equal to </span><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml"> would be taken to values of </span><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml"> equal to </span><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml"> and values of </span><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml"> equal to </span><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml"> would be taken to </span><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1165.2" xmlns="http://www.w3.org/1999/xhtml">However, we will stick to the transformation </span><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = 1 - 2x_{j}" class="math inline" src="../media/file421.png" style="vertical-align:middle" title="z_{j} = 1 - 2x_{j}"/></span><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml"> for the rest of the book.</span></p>
<p><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml">For instance, if the Ising energy is given by </span><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. ( - 1\slash 2)z_{0}z_{1} + z_{2} \right." class="math inline" src="../media/file423.png" style="vertical-align:middle" title="\left. ( - 1\slash 2)z_{0}z_{1} + z_{2} \right."/></span><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml">, then, under the transformation </span><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j} = 1 - 2x_{j}" class="math inline" src="../media/file421.png" style="vertical-align:middle" title="z_{j} = 1 - 2x_{j}"/></span><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">, the corresponding QUBO problem will be the following:</span></p>
<p><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {- 2x_{0}x_{1} + x_{0} + x_{1} - 2x_{2} + \frac{1}{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file424.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {- 2x_{0}x_{1} + x_{0} + x_{1} - 2x_{2} + \frac{1}{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml">You can also go from a </span><span id="dx1-67008"/><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">QUBO problem to an Ising model instance by using the </span><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\left. x_{j} = (1 - z_{j})\slash 2 \right." class="math inline" src="../media/file420.png" style="vertical-align:middle" title="\left. x_{j} = (1 - z_{j})\slash 2 \right."/></span><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml"> substitution. </span><span class="koboSpan" id="kobo.1177.2" xmlns="http://www.w3.org/1999/xhtml">However, you will need to pay attention to a couple of details. </span><span class="koboSpan" id="kobo.1177.3" xmlns="http://www.w3.org/1999/xhtml">Let’s illustrate them with an example. </span><span class="koboSpan" id="kobo.1177.4" xmlns="http://www.w3.org/1999/xhtml">Suppose that your </span><span id="dx1-67009"/><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">QUBO problem is asking to minimize </span><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}^{2} + 2x_{0}x_{1} - 3" class="math inline" src="../media/file425.png" style="vertical-align:middle" title="x_{0}^{2} + 2x_{0}x_{1} - 3"/></span><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1180.2" xmlns="http://www.w3.org/1999/xhtml">Then, when you substitute the </span><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml"> variables, you obtain</span></p>
<p><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{z_{0}^{2}}{4} + \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - \frac{9}{4}." class="math display" src="../media/file426.png" style="vertical-align:middle" title="\frac{z_{0}^{2}}{4} + \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - \frac{9}{4}."/></span></p>
<p><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">But the Ising model does not allow squared variables or independent terms! </span><span class="koboSpan" id="kobo.1184.2" xmlns="http://www.w3.org/1999/xhtml">Fixing these problems is not difficult, though. </span><span class="koboSpan" id="kobo.1184.3" xmlns="http://www.w3.org/1999/xhtml">Regarding the squared variables, we can simply notice that it always holds that </span><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}^{2} = 1" class="math inline" src="../media/file427.png" style="vertical-align:middle" title="z_{j}^{2} = 1"/></span><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml">, because </span><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{j}" class="math inline" src="../media/file339.png" style="vertical-align:middle" title="z_{j}"/></span><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml"> is either </span><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1192.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we replace each squared variable with the constant value </span><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1194.2" xmlns="http://www.w3.org/1999/xhtml">In our case, we would get</span></p>
<p><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\frac{1}{4} + \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - \frac{9}{4} = \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - 2." class="math display" src="../media/file428.png" style="vertical-align:middle" title="\frac{1}{4} + \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - \frac{9}{4} = \frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2} - 2."/></span></p>
<p><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can simply drop the independent term, because we are dealing with a minimization problem and it won’t influence the choice of optimal variables (however, you should add it back when you want to recover the original value of the function to minimize). </span><span class="koboSpan" id="kobo.1196.2" xmlns="http://www.w3.org/1999/xhtml">In the preceding example, the equivalent Ising minimization problem would then be the following:</span></p>
<p><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {\frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ 1, - 1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file429.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize~}\quad} &amp; {\frac{z_{0}z_{1}}{2} - z_{0} - \frac{z_{1}}{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to~}\quad} &amp; {z_{j} \in \{ 1, - 1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml">It is easy to check that this problem has two optimal solutions: </span><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = z_{1} = 1" class="math inline" src="../media/file430.png" style="vertical-align:middle" title="z_{0} = z_{1} = 1"/></span><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="z_{0} = 1,z_{1} = - 1" class="math inline" src="../media/file431.png" style="vertical-align:middle" title="z_{0} = 1,z_{1} = - 1"/></span><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml">, both attaining the </span><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml"> value. </span><span class="koboSpan" id="kobo.1204.2" xmlns="http://www.w3.org/1999/xhtml">If we add back the independent term of value </span><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 2" class="math inline" src="../media/file333.png" style="vertical-align:middle" title="- 2"/></span><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml"> that we had dropped, we obtain an optimal cost of </span><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 3" class="math inline" src="../media/file432.png" style="vertical-align:middle" title="- 3"/></span><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml"> in the QUBO problem. </span><span class="koboSpan" id="kobo.1208.2" xmlns="http://www.w3.org/1999/xhtml">These solutions correspond to </span><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{1} = 0" class="math inline" src="../media/file433.png" style="vertical-align:middle" title="x_{0} = x_{1} = 0"/></span><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = 0,x_{1} = 1" class="math inline" src="../media/file434.png" style="vertical-align:middle" title="x_{0} = 0,x_{1} = 1"/></span><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml">, respectively, which indeed evaluate to </span><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 3" class="math inline" src="../media/file432.png" style="vertical-align:middle" title="- 3"/></span><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml"> and are optimal for the original problem.</span></p>
<div class="tcolorbox questionx" id="tcolobox-76">
<span id="x1-67011x3.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.5</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">Write the Subset Sum problem for </span><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ 1, - 2,3, - 4\}" class="math inline" src="../media/file435.png" style="vertical-align:middle" title="S = \{ 1, - 2,3, - 4\}"/></span><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T = 0" class="math inline" src="../media/file436.png" style="vertical-align:middle" title="T = 0"/></span><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml"> as a QUBO problem and transform it into an instance of the Ising model.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml">So now we know how to go from QUBO </span><span id="dx1-67012"/><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml">problems to Ising energy minimization problems and back, and we can use either formalism — whichever is more convenient at any given moment. </span><span class="koboSpan" id="kobo.1222.2" xmlns="http://www.w3.org/1999/xhtml">In fact, as we will learn in </span><em><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml">Chapters</span></em> <em/> <a href="ch012.xhtml#x1-750004"><em><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml">4</span></em></a><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><em/> <a href="ch013.xhtml#x1-940005"><em><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml">5</span></em></a><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml">, the Ising model is the preferred formulation when solving combinatorial optimization problems with quantum computers. </span><span class="koboSpan" id="kobo.1227.2" xmlns="http://www.w3.org/1999/xhtml">Also, the software tools that we will be using (Qiskit and D-Wave’s Ocean) will help us in rewriting our </span><span id="dx1-67013"/><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml">QUBO problems in the Ising formalism by using transformations like the ones we have described in this section.</span></p>
<p><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">We now have all the mathematical tools that we need in order to work with combinatorial optimization problems if we want to solve them with quantum computers. </span><span class="koboSpan" id="kobo.1229.2" xmlns="http://www.w3.org/1999/xhtml">Let’s play with our new, shiny toys and use them to write some important problems in QUBO formalism.</span></p>
</section>
<section class="level2 sectionHead" data-number="10.4" id="combinatorial-optimization-problems-with-the-qubo-model">
<h1 class="sectionHead" data-number="10.4"><span class="titlemark"><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml">3.4 </span></span> <span id="x1-680003.4"><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml">Combinatorial optimization problems with the QUBO model</span></span></h1>
<p><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml">In this final section of the chapter, we are going to introduce some techniques that will allow us to write </span><span id="dx1-68001"/><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">many important optimization problems as QUBO and Ising instances, so we can later solve them with different </span><span id="dx1-68002"/><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml">quantum algorithms. </span><span class="koboSpan" id="kobo.1234.2" xmlns="http://www.w3.org/1999/xhtml">These examples will also help you understand how to formulate your own optimization problems under these models, which is the first step in order to be able to use quantum computers to solve them.</span></p>
<section class="level3 subsectionHead" data-number="10.4.1" id="binary-linear-programming">
<h2 class="subsectionHead" data-number="10.4.1"><span class="titlemark"><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">3.4.1 </span></span> <span id="x1-690003.4.1"><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml">Binary linear programming</span></span></h2>
<p><strong><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml">Binary linear programming</span></strong><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml"> problems </span><span id="dx1-69001"/><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml">involve optimizing a linear function on binary variables </span><span id="dx1-69002"/><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml">subject to linear constraints. </span><span class="koboSpan" id="kobo.1240.2" xmlns="http://www.w3.org/1999/xhtml">Thus, the general form is</span></p>
<p><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {c_{0}x_{0} + c_{1}x_{1} + \ldots + c_{m}x_{m}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {Ax \leq b,\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file437.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {c_{0}x_{0} + c_{1}x_{1} + \ldots + c_{m}x_{m}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {Ax \leq b,\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{j}" class="math inline" src="../media/file438.png" style="vertical-align:middle" title="c_{j}"/></span><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml"> are integer coefficients, </span><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="A" class="math inline" src="../media/file183.png" style="vertical-align:middle" title="A"/></span><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml"> is an integer matrix, </span><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x" class="math inline" src="../media/file269.png" style="vertical-align:middle" title="x"/></span><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"> is the transpose of </span><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(x_{0},\ldots,x_{m})" class="math inline" src="../media/file439.png" style="vertical-align:middle" title="(x_{0},\ldots,x_{m})"/></span><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="b" class="math inline" src="../media/file17.png" style="vertical-align:middle" title="b"/></span><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml"> is an integer column vector.</span></p>
<p><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml">An example of this type of problem could be the following:</span></p>
<p><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} \leq 1,\qquad} &amp; &amp; \qquad \\ &amp; {3x_{0} - x_{1} + 3x_{2} \leq 4\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file440.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} \leq 1,\qquad} &amp; &amp; \qquad \\  &amp; {3x_{0} - x_{1} + 3x_{2} \leq 4\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml">Binary </span><span id="dx1-69003"/><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml">linear programming (also known as </span><strong><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml">zero-one linear programming</span></strong><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">) is </span><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml">-hard. </span><span class="koboSpan" id="kobo.1260.2" xmlns="http://www.w3.org/1999/xhtml">In fact, the decision version in which the goal is to determine if there is any assignment of zeroes and ones that satisfies the linear constraints (with no actual optimization performed) was one of Richard M. </span><span class="koboSpan" id="kobo.1260.3" xmlns="http://www.w3.org/1999/xhtml">Karp’s original 21 </span><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml">-complete problems published in his famous paper on reducibility </span><span class="cite"><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xkarp1972reducibility"><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">56</span></a><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1266.2" xmlns="http://www.w3.org/1999/xhtml">Assignments that satisfy the </span><span id="dx1-69004"/><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml">constraints are called </span><strong><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml">feasible</span></strong><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml">To write a binary linear program in QUBO formalism, we need to perform some transformations. </span><span class="koboSpan" id="kobo.1270.2" xmlns="http://www.w3.org/1999/xhtml">The first one is to convert the inequality constraints into equality constraints by adding </span><strong><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml">slack variables</span></strong><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1272.2" xmlns="http://www.w3.org/1999/xhtml">This is </span><span id="dx1-69005"/><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml">better understood with an example. </span><span class="koboSpan" id="kobo.1273.2" xmlns="http://www.w3.org/1999/xhtml">In the preceding problem, we have two constraints: </span><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + x_{2} \leq 1" class="math inline" src="../media/file441.png" style="vertical-align:middle" title="x_{0} + x_{2} \leq 1"/></span><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2} \leq 4" class="math inline" src="../media/file442.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2} \leq 4"/></span><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1277.2" xmlns="http://www.w3.org/1999/xhtml">In the first one, the minimum value of the left-hand side is </span><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">, attained when both </span><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0}" class="math inline" src="../media/file443.png" style="vertical-align:middle" title="x_{0}"/></span><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2}" class="math inline" src="../media/file444.png" style="vertical-align:middle" title="x_{2}"/></span><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml"> are 0. </span><span class="koboSpan" id="kobo.1283.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if we add a new binary slack variable </span><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0}" class="math inline" src="../media/file445.png" style="vertical-align:middle" title="y_{0}"/></span><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml"> to that left-hand side and substitute </span><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\leq" class="math inline" src="../media/file446.png" style="vertical-align:middle" title="\leq"/></span><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="=" class="math inline" src="../media/file447.png" style="vertical-align:middle" title="="/></span><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">, we have</span></p>
<p><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + x_{2} + y_{0} = 1," class="math display" src="../media/file448.png" style="vertical-align:middle" title="x_{0} + x_{2} + y_{0} = 1,"/></span></p>
<p><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">which can be satisfied if and only if </span><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + x_{2} \leq 1" class="math inline" src="../media/file441.png" style="vertical-align:middle" title="x_{0} + x_{2} \leq 1"/></span><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml"> can be satisfied. </span><span class="koboSpan" id="kobo.1293.2" xmlns="http://www.w3.org/1999/xhtml">Indeed, if </span><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{2} = 0" class="math inline" src="../media/file449.png" style="vertical-align:middle" title="x_{0} = x_{2} = 0"/></span><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">, then we can take </span><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0} = 1" class="math inline" src="../media/file450.png" style="vertical-align:middle" title="y_{0} = 1"/></span><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">; and, if </span><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = 0" class="math inline" src="../media/file451.png" style="vertical-align:middle" title="x_{0} = 0"/></span><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2} = 1" class="math inline" src="../media/file452.png" style="vertical-align:middle" title="x_{2} = 1"/></span><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml">, or </span><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = 1" class="math inline" src="../media/file453.png" style="vertical-align:middle" title="x_{0} = 1"/></span><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2} = 0" class="math inline" src="../media/file454.png" style="vertical-align:middle" title="x_{2} = 0"/></span><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">, we can take </span><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{0} = 0" class="math inline" src="../media/file455.png" style="vertical-align:middle" title="y_{0} = 0"/></span><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1307.2" xmlns="http://www.w3.org/1999/xhtml">If </span><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{2} = 1" class="math inline" src="../media/file456.png" style="vertical-align:middle" title="x_{0} = x_{2} = 1"/></span><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml">, it is not possible to satisfy the constraint. </span><span class="koboSpan" id="kobo.1309.2" xmlns="http://www.w3.org/1999/xhtml">That’s why we can replace </span><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + x_{2} \leq 1" class="math inline" src="../media/file441.png" style="vertical-align:middle" title="x_{0} + x_{2} \leq 1"/></span><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + x_{2} + y_{0} = 1" class="math inline" src="../media/file457.png" style="vertical-align:middle" title="x_{0} + x_{2} + y_{0} = 1"/></span><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml"> without changing the set of feasible solutions.</span></p>
<p><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">In the same way, the </span><span id="dx1-69006"/><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml">minimum value of </span><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2}" class="math inline" src="../media/file458.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2}"/></span><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml"> is </span><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 1" class="math inline" src="../media/file312.png" style="vertical-align:middle" title="- 1"/></span><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml">, and it is achieved when </span><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = 0" class="math inline" src="../media/file451.png" style="vertical-align:middle" title="x_{0} = 0"/></span><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1} = 1" class="math inline" src="../media/file459.png" style="vertical-align:middle" title="x_{1} = 1"/></span><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{2} = 0" class="math inline" src="../media/file454.png" style="vertical-align:middle" title="x_{2} = 0"/></span><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="tcolorbox important" id="tcolobox-77">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml">Important note</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">Notice how the general rule to minimize these linear expressions on binary variables within some constraints is to set the variables with positive coefficients to </span><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml"> and those with negative coefficients to </span><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml">Then, in order for </span><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2}" class="math inline" src="../media/file458.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2}"/></span><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml"> to reach up to </span><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">, which is the right-hand side of the constraint, we may need to add a number as big as </span><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1338.2" xmlns="http://www.w3.org/1999/xhtml">But to write non-negative numbers up to </span><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml"> we need only three bits, so we can add three new binary variables, </span><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{1}" class="math inline" src="../media/file460.png" style="vertical-align:middle" title="y_{1}"/></span><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{2}" class="math inline" src="../media/file461.png" style="vertical-align:middle" title="y_{2}"/></span><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{3}" class="math inline" src="../media/file462.png" style="vertical-align:middle" title="y_{3}"/></span><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml">, and consider </span><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 4y_{3} = 4," class="math display" src="../media/file463.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 4y_{3} = 4,"/></span></p>
<p><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">which can be satisfied if and only if </span><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2} \leq 4" class="math inline" src="../media/file442.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2} \leq 4"/></span><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml"> can be satisfied.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-78">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml">In fact, notice that </span><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="y_{1} + 2y_{2} + 4y_{3}" class="math inline" src="../media/file464.png" style="vertical-align:middle" title="y_{1} + 2y_{2} + 4y_{3}"/></span><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml"> may go up to </span><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">, but we only need to go up to </span><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5" class="math inline" src="../media/file296.png" style="vertical-align:middle" title="5"/></span><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1359.2" xmlns="http://www.w3.org/1999/xhtml">Thus, we could also use</span></p>
<span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} = 4" class="math display" src="../media/file466.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} = 4"/></span>
<p><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml">as a replacement for </span><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3x_{0} - x_{1} + 3x_{2} \leq 4" class="math inline" src="../media/file442.png" style="vertical-align:middle" title="3x_{0} - x_{1} + 3x_{2} \leq 4"/></span><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">Putting it all together, our original problem is equivalent to the following one:</span></p>
<p><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} + y_{0} = 1,\qquad} &amp; &amp; \qquad \\ &amp; {3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} = 4\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\ &amp; {y_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file467.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{0} + x_{2} + y_{0} = 1,\qquad} &amp; &amp; \qquad \\  &amp; {3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} = 4\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\  &amp; {y_{j} \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">Now, we are ready to write the </span><span id="dx1-69007"/><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml">problem as a QUBO instance. </span><span class="koboSpan" id="kobo.1367.2" xmlns="http://www.w3.org/1999/xhtml">The only thing that we need to do is to incorporate the </span><span id="dx1-69008"/><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">constraints as </span><strong><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">penalty terms</span></strong><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml"> in the expression that we are trying to minimize. </span><span class="koboSpan" id="kobo.1370.2" xmlns="http://www.w3.org/1999/xhtml">For that, we use an integer </span><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml"> (for which we will select a concrete value later on) and consider the problem</span></p>
<p><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2} + B{(x_{0} + x_{2} + y_{0} - 1)}^{2}\qquad} &amp; &amp; \qquad \\ &amp; {+ B{(3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} - 4)}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\ &amp; {y_{j}, \in \{ 0,1\},\qquad j = 0,1,2,3,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file468.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2} + B{(x_{0} + x_{2} + y_{0} - 1)}^{2}\qquad} &amp; &amp; \qquad \\  &amp; {+ B{(3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} - 4)}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\  &amp; {y_{j}, \in \{ 0,1\},\qquad j = 0,1,2,3,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml">which is already in QUBO form.</span></p>
<p><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">Since the new problem is unconstrained, we need to set </span><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml"> big enough so that violating the constraints does not </span><em><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">pay off</span></em><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml"> . </span><span class="koboSpan" id="kobo.1379.2" xmlns="http://www.w3.org/1999/xhtml">If one of the original constraints is violated, the terms that are multiplied by </span><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml"> will be greater than </span><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1383.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, the expression that we wanted to minimize in the original formulation of the problem was </span><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 5x_{0} + 3x_{1} - 2x_{2}" class="math inline" src="../media/file469.png" style="vertical-align:middle" title="- 5x_{0} + 3x_{1} - 2x_{2}"/></span><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml">, which can reach a minimum value of </span><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="- 7" class="math inline" src="../media/file470.png" style="vertical-align:middle" title="- 7"/></span><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml"> (when </span><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{2} = 1" class="math inline" src="../media/file456.png" style="vertical-align:middle" title="x_{0} = x_{2} = 1"/></span><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1} = 0" class="math inline" src="../media/file471.png" style="vertical-align:middle" title="x_{1} = 0"/></span><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">) and a maximum value of </span><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml"> (when </span><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} = x_{2} = 0" class="math inline" src="../media/file449.png" style="vertical-align:middle" title="x_{0} = x_{2} = 0"/></span><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{1} = 1" class="math inline" src="../media/file459.png" style="vertical-align:middle" title="x_{1} = 1"/></span><span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1397.2" xmlns="http://www.w3.org/1999/xhtml">Thus, if we choose, for instance, </span><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B = 11" class="math inline" src="../media/file473.png" style="vertical-align:middle" title="B = 11"/></span><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml">, any assignment that violates the constraints will achieve a value greater than at least </span><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml"> and will never be selected as the optimal solution to the QUBO problem if there is at least one feasible solution (which is the case for this particular problem).</span></p>
<p><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">In this way, a QUBO </span><span id="dx1-69009"/><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">problem whose optimal solution is the same as the optimal solution of the original one is the following one:</span></p>
<p><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2} + 11{(x_{0} + x_{2} + y_{0} - 1)}^{2}\qquad} &amp; &amp; \qquad \\ &amp; {+ 11{(3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} - 4)}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\ &amp; {y_{j}, \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file474.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} + 3x_{1} - 2x_{2} + 11{(x_{0} + x_{2} + y_{0} - 1)}^{2}\qquad} &amp; &amp; \qquad \\  &amp; {+ 11{(3x_{0} - x_{1} + 3x_{2} + y_{1} + 2y_{2} + 2y_{3} - 4)}^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2,\qquad} &amp; &amp; \qquad \\  &amp; {y_{j}, \in \{ 0,1\},\qquad j = 0,1,2,3.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">If you expand the expression to minimize, you will obtain a quadratic polynomial in the </span><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml"> variables, exactly what we need in the QUBO formulation.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-79">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><strong><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">Integer linear programming</span></strong><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml"> is a </span><span id="dx1-69010"/><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml">generalization of binary linear programming in which non-negative integer variables are used instead of binary ones. </span><span class="koboSpan" id="kobo.1412.2" xmlns="http://www.w3.org/1999/xhtml">In some instances of that kind of problem, the constraints allow us to deduce that the integer variables are bounded. </span><span class="koboSpan" id="kobo.1412.3" xmlns="http://www.w3.org/1999/xhtml">For instance, if you have the constraint</span></p>
<span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2a_{0} + 3a_{1} \leq 10" class="math display" src="../media/file475.png" style="vertical-align:middle" title="2a_{0} + 3a_{1} \leq 10"/></span>
<p><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml">then you can deduce that </span><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{0} \leq 5" class="math inline" src="../media/file476.png" style="vertical-align:middle" title="a_{0} \leq 5"/></span><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{1} \leq 3" class="math inline" src="../media/file477.png" style="vertical-align:middle" title="a_{1} \leq 3"/></span><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1418.2" xmlns="http://www.w3.org/1999/xhtml">Since both </span><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{0}" class="math inline" src="../media/file478.png" style="vertical-align:middle" title="a_{0}"/></span><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{1}" class="math inline" src="../media/file479.png" style="vertical-align:middle" title="a_{1}"/></span><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml"> are non-negative, we can replace them with expressions in binary variables in the same way that we introduced slack variables for binary integer programs. </span><span class="koboSpan" id="kobo.1422.2" xmlns="http://www.w3.org/1999/xhtml">In this case, for instance, we can replace </span><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{0}" class="math inline" src="../media/file478.png" style="vertical-align:middle" title="a_{0}"/></span><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{0} + 2x_{1} + 4x_{2}" class="math inline" src="../media/file480.png" style="vertical-align:middle" title="x_{0} + 2x_{1} + 4x_{2}"/></span><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{1}" class="math inline" src="../media/file479.png" style="vertical-align:middle" title="a_{1}"/></span><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{3} + 2x_{4}" class="math inline" src="../media/file481.png" style="vertical-align:middle" title="x_{3} + 2x_{4}"/></span><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1430.2" xmlns="http://www.w3.org/1999/xhtml">In that manner, the integer linear program is transformed into an equivalent binary linear program that, in turn, can be written as a QUBO problem.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml">The procedure that we have studied in this section can be applied to transform any binary linear </span><span id="dx1-69011"/><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">program into a QUBO problem. </span><span class="koboSpan" id="kobo.1432.2" xmlns="http://www.w3.org/1999/xhtml">You only need to first introduce slack variables and then add penalty terms that substitute the original constraints. </span><span class="koboSpan" id="kobo.1432.3" xmlns="http://www.w3.org/1999/xhtml">This is quite useful, since many important problems can be written directly as binary linear programs. </span><span class="koboSpan" id="kobo.1432.4" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will give a prominent example.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.4.2" id="the-knapsack-problem">
<h2 class="subsectionHead" data-number="10.4.2"><span class="titlemark"><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml">3.4.2 </span></span> <span id="x1-700003.4.2"><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml">The Knapsack problem</span></span></h2>
<p><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml">In the famous </span><strong><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">Knapsack problem</span></strong><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml">, you are given a list of objects </span><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml">, each of them with a weight </span><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{j}" class="math inline" src="../media/file482.png" style="vertical-align:middle" title="w_{j}"/></span><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml"> and a value </span><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{j}" class="math inline" src="../media/file438.png" style="vertical-align:middle" title="c_{j}"/></span><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1443.2" xmlns="http://www.w3.org/1999/xhtml">You are also given a </span><span id="dx1-70001"/><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml">maximum weight </span><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="W" class="math inline" src="../media/file483.png" style="vertical-align:middle" title="W"/></span><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml"> and the goal is to find a collection of objects that </span><span id="dx1-70002"/><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">maximizes the total value without going over the maximum weight allowed. </span><span class="koboSpan" id="kobo.1447.2" xmlns="http://www.w3.org/1999/xhtml">Think of it as if you were going on a journey and you want to pack as many valuable objects as possible without getting a knapsack that is too heavy to carry.</span></p>
<p><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">For instance, you can have objects with values </span><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{0} = 5" class="math inline" src="../media/file484.png" style="vertical-align:middle" title="c_{0} = 5"/></span><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{1} = 3" class="math inline" src="../media/file485.png" style="vertical-align:middle" title="c_{1} = 3"/></span><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{2} = 4" class="math inline" src="../media/file486.png" style="vertical-align:middle" title="c_{2} = 4"/></span><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml"> and weights </span><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{0} = 3" class="math inline" src="../media/file487.png" style="vertical-align:middle" title="w_{0} = 3"/></span><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{1} = 1" class="math inline" src="../media/file488.png" style="vertical-align:middle" title="w_{1} = 1"/></span><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{2} = 1" class="math inline" src="../media/file489.png" style="vertical-align:middle" title="w_{2} = 1"/></span><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1460.2" xmlns="http://www.w3.org/1999/xhtml">If the maximum weight is </span><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml">, then the optimal solution would be to choose objects </span><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml"> for a total value of </span><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="9" class="math inline" src="../media/file490.png" style="vertical-align:middle" title="9"/></span><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1468.2" xmlns="http://www.w3.org/1999/xhtml">However, that solution is unfeasible if the maximum weight is </span><span class="koboSpan" id="kobo.1469.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1470.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1470.2" xmlns="http://www.w3.org/1999/xhtml">In that case, we should choose objects </span><span class="koboSpan" id="kobo.1471.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1472.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1473.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1474.1" xmlns="http://www.w3.org/1999/xhtml"> to obtain a total value of </span><span class="koboSpan" id="kobo.1475.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="7" class="math inline" src="../media/file465.png" style="vertical-align:middle" title="7"/></span><span class="koboSpan" id="kobo.1476.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1477.1" xmlns="http://www.w3.org/1999/xhtml">Although, at first sight, this problem may seem easy to solve, the fact is that (surprise, surprise!) it is </span><span class="koboSpan" id="kobo.1478.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1479.1" xmlns="http://www.w3.org/1999/xhtml">-hard. </span><span class="koboSpan" id="kobo.1479.2" xmlns="http://www.w3.org/1999/xhtml">In fact, if we consider a decision version of the problem in which we are also given a value </span><span class="koboSpan" id="kobo.1480.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V" class="math inline" src="../media/file379.png" style="vertical-align:middle" title="V"/></span><span class="koboSpan" id="kobo.1481.1" xmlns="http://www.w3.org/1999/xhtml"> and we are asked if there is a selection of objects with a value of at least </span><span class="koboSpan" id="kobo.1482.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V" class="math inline" src="../media/file379.png" style="vertical-align:middle" title="V"/></span><span class="koboSpan" id="kobo.1483.1" xmlns="http://www.w3.org/1999/xhtml"> that also satisfies the weight constraint, then the problem is </span><span class="koboSpan" id="kobo.1484.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1485.1" xmlns="http://www.w3.org/1999/xhtml">-complete.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-80">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1486.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1487.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1488.1" xmlns="http://www.w3.org/1999/xhtml">Proving that the decision version of the Knapsack problem is </span><span class="koboSpan" id="kobo.1489.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1490.1" xmlns="http://www.w3.org/1999/xhtml">-complete is easy, because we already know that the Subset Sum problem is </span><span class="koboSpan" id="kobo.1491.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1492.1" xmlns="http://www.w3.org/1999/xhtml">-complete. </span><span class="koboSpan" id="kobo.1492.2" xmlns="http://www.w3.org/1999/xhtml">Suppose, then, that you are given an instance of the Subset Sum problem with set </span><span class="koboSpan" id="kobo.1493.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="S = \{ a_{0},\ldots,a_{m}\}" class="math inline" src="../media/file406.png" style="vertical-align:middle" title="S = \{ a_{0},\ldots,a_{m}\}"/></span><span class="koboSpan" id="kobo.1494.1" xmlns="http://www.w3.org/1999/xhtml"> and target sum </span><span class="koboSpan" id="kobo.1495.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="T" class="math inline" src="../media/file74.png" style="vertical-align:middle" title="T"/></span><span class="koboSpan" id="kobo.1496.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1496.2" xmlns="http://www.w3.org/1999/xhtml">Then, you can recast this as an instance of the Knapsack problem by considering objects </span><span class="koboSpan" id="kobo.1497.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1498.1" xmlns="http://www.w3.org/1999/xhtml"> with values </span><span class="koboSpan" id="kobo.1499.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{j} = a_{j}" class="math inline" src="../media/file491.png" style="vertical-align:middle" title="c_{j} = a_{j}"/></span><span class="koboSpan" id="kobo.1500.1" xmlns="http://www.w3.org/1999/xhtml"> and weights </span><span class="koboSpan" id="kobo.1501.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{j} = a_{j}" class="math inline" src="../media/file492.png" style="vertical-align:middle" title="w_{j} = a_{j}"/></span><span class="koboSpan" id="kobo.1502.1" xmlns="http://www.w3.org/1999/xhtml">, maximum weight </span><span class="koboSpan" id="kobo.1503.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="W = T" class="math inline" src="../media/file493.png" style="vertical-align:middle" title="W = T"/></span><span class="koboSpan" id="kobo.1504.1" xmlns="http://www.w3.org/1999/xhtml">, and minimum total value </span><span class="koboSpan" id="kobo.1505.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="V = T" class="math inline" src="../media/file494.png" style="vertical-align:middle" title="V = T"/></span><span class="koboSpan" id="kobo.1506.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1506.2" xmlns="http://www.w3.org/1999/xhtml">Then, a solution to the Knapsack decision problem will give you a selection of objects </span><span class="koboSpan" id="kobo.1507.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j_{0},\ldots,j_{k}" class="math inline" src="../media/file495.png" style="vertical-align:middle" title="j_{0},\ldots,j_{k}"/></span><span class="koboSpan" id="kobo.1508.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.1509.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{j_{0}} + \ldots + a_{j_{k}} \leq W = T" class="math inline" src="../media/file496.png" style="vertical-align:middle" title="a_{j_{0}} + \ldots + a_{j_{k}} \leq W = T"/></span><span class="koboSpan" id="kobo.1510.1" xmlns="http://www.w3.org/1999/xhtml"> because of the weight constraint and such that </span><span class="koboSpan" id="kobo.1511.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="a_{j_{0}} + \ldots + a_{j_{k}} \geq V = T" class="math inline" src="../media/file497.png" style="vertical-align:middle" title="a_{j_{0}} + \ldots + a_{j_{k}} \geq V = T"/></span><span class="koboSpan" id="kobo.1512.1" xmlns="http://www.w3.org/1999/xhtml"> because of the minimum value condition. </span><span class="koboSpan" id="kobo.1512.2" xmlns="http://www.w3.org/1999/xhtml">Obviously, that selection of objects would also be a solution to the Subset Sum problem.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1513.1" xmlns="http://www.w3.org/1999/xhtml">It is straightforward to write the </span><span id="dx1-70003"/><span class="koboSpan" id="kobo.1514.1" xmlns="http://www.w3.org/1999/xhtml">Knapsack problem as a binary linear program. </span><span class="koboSpan" id="kobo.1514.2" xmlns="http://www.w3.org/1999/xhtml">We only need to define binary variables </span><span class="koboSpan" id="kobo.1515.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j}" class="math inline" src="../media/file407.png" style="vertical-align:middle" title="x_{j}"/></span><span class="koboSpan" id="kobo.1516.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1517.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1518.1" xmlns="http://www.w3.org/1999/xhtml">, that indicate whether we choose object </span><span class="koboSpan" id="kobo.1519.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1520.1" xmlns="http://www.w3.org/1999/xhtml"> (if </span><span class="koboSpan" id="kobo.1521.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j} = 1" class="math inline" src="../media/file498.png" style="vertical-align:middle" title="x_{j} = 1"/></span><span class="koboSpan" id="kobo.1522.1" xmlns="http://www.w3.org/1999/xhtml">) or not (if </span><span class="koboSpan" id="kobo.1523.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{j} = 0" class="math inline" src="../media/file499.png" style="vertical-align:middle" title="x_{j} = 0"/></span><span class="koboSpan" id="kobo.1524.1" xmlns="http://www.w3.org/1999/xhtml">) and consider</span></p>
<p><span class="koboSpan" id="kobo.1525.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- c_{0}x_{0} - c_{1}x_{1} - \ldots - c_{m}x_{m}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {w_{0}x_{0} + w_{1}x_{1} + \ldots + w_{m}x_{m} \leq W,\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file500.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- c_{0}x_{0} - c_{1}x_{1} - \ldots - c_{m}x_{m}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {w_{0}x_{0} + w_{1}x_{1} + \ldots + w_{m}x_{m} \leq W,\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1526.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.1527.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="c_{j}" class="math inline" src="../media/file438.png" style="vertical-align:middle" title="c_{j}"/></span><span class="koboSpan" id="kobo.1528.1" xmlns="http://www.w3.org/1999/xhtml"> are the object values, </span><span class="koboSpan" id="kobo.1529.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{j}" class="math inline" src="../media/file482.png" style="vertical-align:middle" title="w_{j}"/></span><span class="koboSpan" id="kobo.1530.1" xmlns="http://www.w3.org/1999/xhtml"> are their weights, and </span><span class="koboSpan" id="kobo.1531.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="W" class="math inline" src="../media/file483.png" style="vertical-align:middle" title="W"/></span><span class="koboSpan" id="kobo.1532.1" xmlns="http://www.w3.org/1999/xhtml"> is the maximum weight of the knapsack. </span><span class="koboSpan" id="kobo.1532.2" xmlns="http://www.w3.org/1999/xhtml">Notice that, since the original problem was asking to maximize the value, we are now minimizing the negative value, which is completely equivalent.</span></p>
<p><span class="koboSpan" id="kobo.1533.1" xmlns="http://www.w3.org/1999/xhtml">For instance, in the example that we considered previously with object values </span><span class="koboSpan" id="kobo.1534.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="5,3" class="math inline" src="../media/file501.png" style="vertical-align:middle" title="5,3"/></span><span class="koboSpan" id="kobo.1535.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1536.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="4" class="math inline" src="../media/file143.png" style="vertical-align:middle" title="4"/></span><span class="koboSpan" id="kobo.1537.1" xmlns="http://www.w3.org/1999/xhtml">, weights </span><span class="koboSpan" id="kobo.1538.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3,1" class="math inline" src="../media/file502.png" style="vertical-align:middle" title="3,1"/></span><span class="koboSpan" id="kobo.1539.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1540.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1541.1" xmlns="http://www.w3.org/1999/xhtml">, and maximum weight </span><span class="koboSpan" id="kobo.1542.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1543.1" xmlns="http://www.w3.org/1999/xhtml">, the problem would be the following:</span></p>
<p><span class="koboSpan" id="kobo.1544.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} - 3x_{1} - 4x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {3x_{0} + x_{1} + x_{2} \leq 3,\qquad} &amp; &amp; \qquad \\ &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file503.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {- 5x_{0} - 3x_{1} - 4x_{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {3x_{0} + x_{1} + x_{2} \leq 3,\qquad} &amp; &amp; \qquad \\  &amp; {x_{j} \in \{ 0,1\},\qquad j = 0,1,2.\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1545.1" xmlns="http://www.w3.org/1999/xhtml">Of course, then we can add slack variables and introduce penalty terms, just as we did in the previous subsection, to rewrite the program as a QUBO problem. </span><span class="koboSpan" id="kobo.1545.2" xmlns="http://www.w3.org/1999/xhtml">And that is exactly what we will need to do in order solve these </span><span id="dx1-70004"/><span class="koboSpan" id="kobo.1546.1" xmlns="http://www.w3.org/1999/xhtml">problems with our quantum algorithms!</span></p>
<div class="tcolorbox questionx" id="tcolobox-81">
<span id="x1-70006x3.4.2"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1547.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.6</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1548.1" xmlns="http://www.w3.org/1999/xhtml">Consider objects with values </span><span class="koboSpan" id="kobo.1549.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3,1,7,7" class="math inline" src="../media/file504.png" style="vertical-align:middle" title="3,1,7,7"/></span><span class="koboSpan" id="kobo.1550.1" xmlns="http://www.w3.org/1999/xhtml"> and weights </span><span class="koboSpan" id="kobo.1551.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2,1,5,4" class="math inline" src="../media/file505.png" style="vertical-align:middle" title="2,1,5,4"/></span><span class="koboSpan" id="kobo.1552.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1552.2" xmlns="http://www.w3.org/1999/xhtml">Write the Knapsack problem for the case in which the maximum weight is </span><span class="koboSpan" id="kobo.1553.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="8" class="math inline" src="../media/file506.png" style="vertical-align:middle" title="8"/></span><span class="koboSpan" id="kobo.1554.1" xmlns="http://www.w3.org/1999/xhtml"> as a binary linear program.</span></p>
</div>
</div>
<div class="tcolorbox learnmore" id="tcolobox-82">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1555.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1556.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1557.1" xmlns="http://www.w3.org/1999/xhtml">A variant of the Knapsack problem allows us to choose several copies of the same object to put into the knapsack. </span><span class="koboSpan" id="kobo.1557.2" xmlns="http://www.w3.org/1999/xhtml">In that case, we should use integer variables instead of binary ones to represent the number of times that each object is chosen. </span><span class="koboSpan" id="kobo.1557.3" xmlns="http://www.w3.org/1999/xhtml">However, notice that, once we know the maximum weight allowed, each integer variable is bounded. </span><span class="koboSpan" id="kobo.1557.4" xmlns="http://www.w3.org/1999/xhtml">Thus, we can use the technique that we explained at the end of the previous subsection in order to replace the integer variables with binary variables. </span><span class="koboSpan" id="kobo.1557.5" xmlns="http://www.w3.org/1999/xhtml">And, afterwards, of course, we can rewrite the problem using the QUBO formalism.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1558.1" xmlns="http://www.w3.org/1999/xhtml">For our next examples of optimization problems, we shall go back to working with graphs. </span><span class="koboSpan" id="kobo.1558.2" xmlns="http://www.w3.org/1999/xhtml">In fact, in the next subsection, we will deal with a very colorful problem!</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.4.3" id="graph-coloring">
<h2 class="subsectionHead" data-number="10.4.3"><span class="titlemark"><span class="koboSpan" id="kobo.1559.1" xmlns="http://www.w3.org/1999/xhtml">3.4.3 </span></span> <span id="x1-710003.4.3"><span class="koboSpan" id="kobo.1560.1" xmlns="http://www.w3.org/1999/xhtml">Graph coloring</span></span></h2>
<p><span class="koboSpan" id="kobo.1561.1" xmlns="http://www.w3.org/1999/xhtml">In this subsection and the next, we will study some </span><span id="dx1-71001"/><span class="koboSpan" id="kobo.1562.1" xmlns="http://www.w3.org/1999/xhtml">problems that are related to graphs but have many applications in different fields. </span><span class="koboSpan" id="kobo.1562.2" xmlns="http://www.w3.org/1999/xhtml">The first one is </span><span id="dx1-71002"/><span class="koboSpan" id="kobo.1563.1" xmlns="http://www.w3.org/1999/xhtml">graph coloring, in which we are given a graph and we are asked to assign a color to each vertex in such a way that vertices that are </span><span id="dx1-71003"/><span class="koboSpan" id="kobo.1564.1" xmlns="http://www.w3.org/1999/xhtml">connected by an edge (also called </span><strong><span class="koboSpan" id="kobo.1565.1" xmlns="http://www.w3.org/1999/xhtml">adjacent</span></strong><span class="koboSpan" id="kobo.1566.1" xmlns="http://www.w3.org/1999/xhtml"> vertices) receive different colors. </span><span class="koboSpan" id="kobo.1566.2" xmlns="http://www.w3.org/1999/xhtml">Usually, we are asked to do this using the minimum possible number of colors or using no more than a given number of different colors. </span><span class="koboSpan" id="kobo.1566.3" xmlns="http://www.w3.org/1999/xhtml">If we can color a graph with </span><span class="koboSpan" id="kobo.1567.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1568.1" xmlns="http://www.w3.org/1999/xhtml"> colors, we say that it is </span><span class="koboSpan" id="kobo.1569.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><strong><span class="koboSpan" id="kobo.1570.1" xmlns="http://www.w3.org/1999/xhtml">-colorable</span></strong><span class="koboSpan" id="kobo.1571.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1571.2" xmlns="http://www.w3.org/1999/xhtml">The </span><span id="dx1-71004"/><span class="koboSpan" id="kobo.1572.1" xmlns="http://www.w3.org/1999/xhtml">minimum number of colors needed to color a graph is </span><span id="dx1-71005"/><span class="koboSpan" id="kobo.1573.1" xmlns="http://www.w3.org/1999/xhtml">called its </span><strong><span class="koboSpan" id="kobo.1574.1" xmlns="http://www.w3.org/1999/xhtml">chromatic</span></strong> <strong><span class="koboSpan" id="kobo.1575.1" xmlns="http://www.w3.org/1999/xhtml">number</span></strong><span class="koboSpan" id="kobo.1576.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.1577.1" xmlns="http://www.w3.org/1999/xhtml">In </span><em><span class="koboSpan" id="kobo.1578.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.6"><em><span class="koboSpan" id="kobo.1579.1" xmlns="http://www.w3.org/1999/xhtml">3.6</span></em></a><span class="koboSpan" id="kobo.1580.1" xmlns="http://www.w3.org/1999/xhtml">, we present three color assignments for the same graph. </span><span class="koboSpan" id="kobo.1580.2" xmlns="http://www.w3.org/1999/xhtml">The one in </span><em><span class="koboSpan" id="kobo.1581.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.6a"><em><span class="koboSpan" id="kobo.1582.1" xmlns="http://www.w3.org/1999/xhtml">3.6a</span></em></a><span class="koboSpan" id="kobo.1583.1" xmlns="http://www.w3.org/1999/xhtml"> is not a valid coloring, because there are adjacent vertices that share the same color. </span><span class="koboSpan" id="kobo.1583.2" xmlns="http://www.w3.org/1999/xhtml">The one in </span><em><span class="koboSpan" id="kobo.1584.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.6b"><em><span class="koboSpan" id="kobo.1585.1" xmlns="http://www.w3.org/1999/xhtml">3.6b</span></em></a><span class="koboSpan" id="kobo.1586.1" xmlns="http://www.w3.org/1999/xhtml"> is valid, but not optimal, because we do not need more than three colors for this graph, as </span><em><span class="koboSpan" id="kobo.1587.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.6c"><em><span class="koboSpan" id="kobo.1588.1" xmlns="http://www.w3.org/1999/xhtml">3.6c</span></em></a><span class="koboSpan" id="kobo.1589.1" xmlns="http://www.w3.org/1999/xhtml"> proves.</span></p>
<figure>
<span class="koboSpan" id="kobo.1590.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(a) Invalid coloring" src="../media/file507.jpg"/></span>
<figcaption aria-hidden="true"><span id="Figure3.6a"><strong><span class="koboSpan" id="kobo.1591.1" xmlns="http://www.w3.org/1999/xhtml">(a)</span></strong></span><span class="koboSpan" id="kobo.1592.1" xmlns="http://www.w3.org/1999/xhtml"> Invalid coloring</span></figcaption>
</figure>
<figure>
<span class="koboSpan" id="kobo.1593.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(b) Non-optimal coloring" src="../media/file508.jpg"/></span>
<figcaption aria-hidden="true"><span id="Figure3.6b"><strong><span class="koboSpan" id="kobo.1594.1" xmlns="http://www.w3.org/1999/xhtml">(b)</span></strong></span><span class="koboSpan" id="kobo.1595.1" xmlns="http://www.w3.org/1999/xhtml"> Non-optimal coloring</span></figcaption>
</figure>
<figure>
<span class="koboSpan" id="kobo.1596.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(c) Optimal coloring" src="../media/file509.jpg"/></span>
<figcaption aria-hidden="true"><span id="Figure3.6c"><strong><span class="koboSpan" id="kobo.1597.1" xmlns="http://www.w3.org/1999/xhtml">(c)</span></strong></span><span class="koboSpan" id="kobo.1598.1" xmlns="http://www.w3.org/1999/xhtml"> Optimal coloring</span></figcaption>
</figure>
<p><span id="Figure3.6"><strong><span class="koboSpan" id="kobo.1599.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.6</span></strong></span><span class="koboSpan" id="kobo.1600.1" xmlns="http://www.w3.org/1999/xhtml">: Different colorings of a graph</span></p>
<p><span class="koboSpan" id="kobo.1601.1" xmlns="http://www.w3.org/1999/xhtml">The graph coloring problem may look like a children’s game. </span><span class="koboSpan" id="kobo.1601.2" xmlns="http://www.w3.org/1999/xhtml">However, many very relevant practical problems can be written as instances of graph coloring. </span><span class="koboSpan" id="kobo.1601.3" xmlns="http://www.w3.org/1999/xhtml">For example, imagine that your company has several projects and you need to assign supervisors to each of them, but some projects are incompatible because of time overlaps or other restrictions. </span><span class="koboSpan" id="kobo.1601.4" xmlns="http://www.w3.org/1999/xhtml">You can create a graph in which the projects are the vertices and two projects are connected by an edge if and only if they are incompatible. </span><span class="koboSpan" id="kobo.1601.5" xmlns="http://www.w3.org/1999/xhtml">Then, finding the chromatic number of the graph is equivalent to finding the minimum number of project leaders that you need to assign. </span><span class="koboSpan" id="kobo.1601.6" xmlns="http://www.w3.org/1999/xhtml">Furthermore, finding a coloring will give you a way of assigning the supervisors while satisfying the constraints.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-83">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1602.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1603.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1604.1" xmlns="http://www.w3.org/1999/xhtml">The history of graph coloring dates back to the middle of the 19th century and it is full of surprising plot twists. </span><span class="koboSpan" id="kobo.1604.2" xmlns="http://www.w3.org/1999/xhtml">It originated from a seemingly simple problem: finding the minimum number of colors needed in order to color a geographical map in such a way that any pair of neighboring countries receive different colors. </span><span class="koboSpan" id="kobo.1604.3" xmlns="http://www.w3.org/1999/xhtml">But, in spite of its </span><em><span class="koboSpan" id="kobo.1605.1" xmlns="http://www.w3.org/1999/xhtml">humble</span></em><span class="koboSpan" id="kobo.1606.1" xmlns="http://www.w3.org/1999/xhtml"> origins, it evolved to even become a philosophical debate about the validity of computer-assisted mathematical proofs!</span></p>
<p><span class="koboSpan" id="kobo.1607.1" xmlns="http://www.w3.org/1999/xhtml">A very enjoyable popular recounting of this long and winding process can be found in </span><em><span class="koboSpan" id="kobo.1608.1" xmlns="http://www.w3.org/1999/xhtml">Four Colors Suffice</span></em><span class="koboSpan" id="kobo.1609.1" xmlns="http://www.w3.org/1999/xhtml">, by Robin Wilson </span><span class="cite"><span class="koboSpan" id="kobo.1610.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xwilson2021four"><span class="koboSpan" id="kobo.1611.1" xmlns="http://www.w3.org/1999/xhtml">98</span></a><span class="koboSpan" id="kobo.1612.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1613.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1614.1" xmlns="http://www.w3.org/1999/xhtml">Deciding whether a graph is </span><span class="koboSpan" id="kobo.1615.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1616.1" xmlns="http://www.w3.org/1999/xhtml">-colorable or not is relatively easy. </span><span class="koboSpan" id="kobo.1616.2" xmlns="http://www.w3.org/1999/xhtml">Indeed, notice that the vertices of a </span><span class="koboSpan" id="kobo.1617.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1618.1" xmlns="http://www.w3.org/1999/xhtml">-colorable graph can be </span><span id="dx1-71011"/><span class="koboSpan" id="kobo.1619.1" xmlns="http://www.w3.org/1999/xhtml">assigned to two disjoint sets depending on the color they receive and such that there are no edges among vertices of the same set — that’s why these graphs are </span><span id="dx1-71012"/><span class="koboSpan" id="kobo.1620.1" xmlns="http://www.w3.org/1999/xhtml">said to be </span><strong><span class="koboSpan" id="kobo.1621.1" xmlns="http://www.w3.org/1999/xhtml">bipartite graphs</span></strong><span class="koboSpan" id="kobo.1622.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1622.2" xmlns="http://www.w3.org/1999/xhtml">But it is a well-known fact (originally proved by König in 1936) that a graph is bipartite if and only if it has no </span><strong><span class="koboSpan" id="kobo.1623.1" xmlns="http://www.w3.org/1999/xhtml">cycles</span></strong><span class="koboSpan" id="kobo.1624.1" xmlns="http://www.w3.org/1999/xhtml"> of odd length (refer to </span><em><span class="koboSpan" id="kobo.1625.1" xmlns="http://www.w3.org/1999/xhtml">Section 1.6</span></em><span class="koboSpan" id="kobo.1626.1" xmlns="http://www.w3.org/1999/xhtml"> in the book by Diestel </span><span class="cite"><span class="koboSpan" id="kobo.1627.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xdiestel2017graph"><span class="koboSpan" id="kobo.1628.1" xmlns="http://www.w3.org/1999/xhtml">31</span></a><span class="koboSpan" id="kobo.1629.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1630.1" xmlns="http://www.w3.org/1999/xhtml">) and we can check for the presence of cycles by, for instance, computing the powers of the adjacency matrix of the graph (cf. </span><em><span class="koboSpan" id="kobo.1631.1" xmlns="http://www.w3.org/1999/xhtml">Section 10.4.7</span></em><span class="koboSpan" id="kobo.1632.1" xmlns="http://www.w3.org/1999/xhtml"> in Rosen’s book on discrete mathematics </span><span class="cite"><span class="koboSpan" id="kobo.1633.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xrosen2019discrete"><span class="koboSpan" id="kobo.1634.1" xmlns="http://www.w3.org/1999/xhtml">81</span></a><span class="koboSpan" id="kobo.1635.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1636.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1636.2" xmlns="http://www.w3.org/1999/xhtml">However, checking if a graph is </span><span class="koboSpan" id="kobo.1637.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1638.1" xmlns="http://www.w3.org/1999/xhtml">-colorable is </span><span class="koboSpan" id="kobo.1639.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1640.1" xmlns="http://www.w3.org/1999/xhtml">-complete for any </span><span class="koboSpan" id="kobo.1641.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k \geq 3" class="math inline" src="../media/file510.png" style="vertical-align:middle" title="k \geq 3"/></span><span class="koboSpan" id="kobo.1642.1" xmlns="http://www.w3.org/1999/xhtml"> (see the paper by Garey, Johnson, and Stockmeyer </span><span class="cite"><span class="koboSpan" id="kobo.1643.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xgarey1976simplified"><span class="koboSpan" id="kobo.1644.1" xmlns="http://www.w3.org/1999/xhtml">43</span></a><span class="koboSpan" id="kobo.1645.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1646.1" xmlns="http://www.w3.org/1999/xhtml">) and, thus, computing the chromatic number of a graph is </span><span class="koboSpan" id="kobo.1647.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1648.1" xmlns="http://www.w3.org/1999/xhtml">-hard.</span></p>
<p><span class="koboSpan" id="kobo.1649.1" xmlns="http://www.w3.org/1999/xhtml">Suppose we have a graph with vertices </span><span class="koboSpan" id="kobo.1650.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0,\ldots,m" class="math inline" src="../media/file511.png" style="vertical-align:middle" title="0,\ldots,m"/></span><span class="koboSpan" id="kobo.1651.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1651.2" xmlns="http://www.w3.org/1999/xhtml">In order to write the problem of determining if a graph is </span><span class="koboSpan" id="kobo.1652.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1653.1" xmlns="http://www.w3.org/1999/xhtml">-colorable using the QUBO framework, we will define some binary variables </span><span class="koboSpan" id="kobo.1654.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}" class="math inline" src="../media/file512.png" style="vertical-align:middle" title="x_{jl}"/></span><span class="koboSpan" id="kobo.1655.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><span class="koboSpan" id="kobo.1656.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1657.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1658.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l = 0,\ldots,k - 1" class="math inline" src="../media/file513.png" style="vertical-align:middle" title="l = 0,\ldots,k - 1"/></span><span class="koboSpan" id="kobo.1659.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1659.2" xmlns="http://www.w3.org/1999/xhtml">The variable </span><span class="koboSpan" id="kobo.1660.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}" class="math inline" src="../media/file512.png" style="vertical-align:middle" title="x_{jl}"/></span><span class="koboSpan" id="kobo.1661.1" xmlns="http://www.w3.org/1999/xhtml"> will get value </span><span class="koboSpan" id="kobo.1662.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1663.1" xmlns="http://www.w3.org/1999/xhtml"> if the vertex </span><span class="koboSpan" id="kobo.1664.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1665.1" xmlns="http://www.w3.org/1999/xhtml"> receives the </span><span class="koboSpan" id="kobo.1666.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1667.1" xmlns="http://www.w3.org/1999/xhtml">-th color (for simplicity, colors are usually identified with numbers) and </span><span class="koboSpan" id="kobo.1668.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1669.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise. </span><span class="koboSpan" id="kobo.1669.2" xmlns="http://www.w3.org/1999/xhtml">Then, the condition that vertex </span><span class="koboSpan" id="kobo.1670.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1671.1" xmlns="http://www.w3.org/1999/xhtml"> receives exactly one color can be algebraically written as</span></p>
<p><span class="koboSpan" id="kobo.1672.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{l = 0}^{k - 1}x_{jl} = 1." class="math display" src="../media/file515.png" style="vertical-align:middle" title="\sum\limits_{l = 0}^{k - 1}x_{jl} = 1."/></span></p>
<p><span class="koboSpan" id="kobo.1673.1" xmlns="http://www.w3.org/1999/xhtml">For this condition to hold, there must exist </span><span class="koboSpan" id="kobo.1674.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1675.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.1676.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl} = 1" class="math inline" src="../media/file516.png" style="vertical-align:middle" title="x_{jl} = 1"/></span><span class="koboSpan" id="kobo.1677.1" xmlns="http://www.w3.org/1999/xhtml"> and such that </span><span class="koboSpan" id="kobo.1678.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jh} = 0" class="math inline" src="../media/file517.png" style="vertical-align:middle" title="x_{jh} = 0"/></span><span class="koboSpan" id="kobo.1679.1" xmlns="http://www.w3.org/1999/xhtml"> for any </span><span class="koboSpan" id="kobo.1680.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h \neq l" class="math inline" src="../media/file518.png" style="vertical-align:middle" title="h \neq l"/></span><span class="koboSpan" id="kobo.1681.1" xmlns="http://www.w3.org/1999/xhtml">, exactly as we need.</span><span id="dx1-71013"/></p>
<p><span class="koboSpan" id="kobo.1682.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, we need to impose the constraint that adjacent vertices are not assigned the same color. </span><span class="koboSpan" id="kobo.1682.2" xmlns="http://www.w3.org/1999/xhtml">Notice that in the case that two vertices </span><span class="koboSpan" id="kobo.1683.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1684.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1685.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h" class="math inline" src="../media/file519.png" style="vertical-align:middle" title="h"/></span><span class="koboSpan" id="kobo.1686.1" xmlns="http://www.w3.org/1999/xhtml"> receive the same color </span><span class="koboSpan" id="kobo.1687.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1688.1" xmlns="http://www.w3.org/1999/xhtml">, then we would have </span><span class="koboSpan" id="kobo.1689.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}x_{hl} = 1" class="math inline" src="../media/file520.png" style="vertical-align:middle" title="x_{jl}x_{hl} = 1"/></span><span class="koboSpan" id="kobo.1690.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1690.2" xmlns="http://www.w3.org/1999/xhtml">Thus, for adjacent vertices </span><span class="koboSpan" id="kobo.1691.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1692.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1693.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h" class="math inline" src="../media/file519.png" style="vertical-align:middle" title="h"/></span><span class="koboSpan" id="kobo.1694.1" xmlns="http://www.w3.org/1999/xhtml"> we need to impose</span></p>
<p><span class="koboSpan" id="kobo.1695.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{l = 0}^{k - 1}x_{jl}x_{hl} = 0." class="math display" src="../media/file521.png" style="vertical-align:middle" title="\sum\limits_{l = 0}^{k - 1}x_{jl}x_{hl} = 0."/></span></p>
<p><span class="koboSpan" id="kobo.1696.1" xmlns="http://www.w3.org/1999/xhtml">We can write these constraints as penalty terms in the expression to minimize in our QUBO problem to get</span></p>
<p><span class="koboSpan" id="kobo.1697.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {\sum\limits_{j = 0}^{m}\left( {\sum\limits_{l = 0}^{k - 1}x_{jl} - 1} \right)^{2} + \sum\limits_{(j,h) \in E}\sum\limits_{l = 0}^{k - 1}x_{jl}x_{hl}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{jl} \in \{ 0,1\},\qquad j = 0,\ldots,m,l = 0,\ldots,k - 1,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file522.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {\sum\limits_{j = 0}^{m}\left( {\sum\limits_{l = 0}^{k - 1}x_{jl} - 1} \right)^{2} + \sum\limits_{(j,h) \in E}\sum\limits_{l = 0}^{k - 1}x_{jl}x_{hl}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{jl} \in \{ 0,1\},\qquad j = 0,\ldots,m,l = 0,\ldots,k - 1,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1698.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.1699.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="E" class="math inline" src="../media/file327.png" style="vertical-align:middle" title="E"/></span><span class="koboSpan" id="kobo.1700.1" xmlns="http://www.w3.org/1999/xhtml"> is the set of edges of the graph. </span><span class="koboSpan" id="kobo.1700.2" xmlns="http://www.w3.org/1999/xhtml">Notice that we do not need to square the terms </span><span class="koboSpan" id="kobo.1701.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="{\sum}_{l = 0}^{k - 1}x_{jl}x_{hl}" class="math inline" src="../media/file523.png" style="vertical-align:middle" title="{\sum}_{l = 0}^{k - 1}x_{jl}x_{hl}"/></span><span class="koboSpan" id="kobo.1702.1" xmlns="http://www.w3.org/1999/xhtml"> because they are always non-negative. </span><span class="koboSpan" id="kobo.1702.2" xmlns="http://www.w3.org/1999/xhtml">If we find that the optimal solution of the problem is </span><span class="koboSpan" id="kobo.1703.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1704.1" xmlns="http://www.w3.org/1999/xhtml">, then the </span><span id="dx1-71014"/><span class="koboSpan" id="kobo.1705.1" xmlns="http://www.w3.org/1999/xhtml">graph is </span><span class="koboSpan" id="kobo.1706.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1707.1" xmlns="http://www.w3.org/1999/xhtml">-colorable. </span><span class="koboSpan" id="kobo.1707.2" xmlns="http://www.w3.org/1999/xhtml">Otherwise, it is not.</span></p>
<div class="tcolorbox questionx" id="tcolobox-84">
<span id="x1-71016x3.4.3"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1708.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.7</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1709.1" xmlns="http://www.w3.org/1999/xhtml">Consider a graph with vertices </span><span class="koboSpan" id="kobo.1710.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0,1,2" class="math inline" src="../media/file524.png" style="vertical-align:middle" title="0,1,2"/></span><span class="koboSpan" id="kobo.1711.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1712.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="3" class="math inline" src="../media/file472.png" style="vertical-align:middle" title="3"/></span><span class="koboSpan" id="kobo.1713.1" xmlns="http://www.w3.org/1999/xhtml">, and edges </span><span class="koboSpan" id="kobo.1714.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,1)" class="math inline" src="../media/file305.png" style="vertical-align:middle" title="(0,1)"/></span><span class="koboSpan" id="kobo.1715.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1716.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(0,2)" class="math inline" src="../media/file306.png" style="vertical-align:middle" title="(0,2)"/></span><span class="koboSpan" id="kobo.1717.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="koboSpan" id="kobo.1718.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(1,3)" class="math inline" src="../media/file525.png" style="vertical-align:middle" title="(1,3)"/></span><span class="koboSpan" id="kobo.1719.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><span class="koboSpan" id="kobo.1720.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(2,3)" class="math inline" src="../media/file526.png" style="vertical-align:middle" title="(2,3)"/></span><span class="koboSpan" id="kobo.1721.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1721.2" xmlns="http://www.w3.org/1999/xhtml">Write the QUBO version of the problem of checking whether the graph is </span><span class="koboSpan" id="kobo.1722.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="2" class="math inline" src="../media/file302.png" style="vertical-align:middle" title="2"/></span><span class="koboSpan" id="kobo.1723.1" xmlns="http://www.w3.org/1999/xhtml">-colorable.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1724.1" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will study another optimization problem on graphs. </span><span class="koboSpan" id="kobo.1724.2" xmlns="http://www.w3.org/1999/xhtml">Do you like traveling? </span><span class="koboSpan" id="kobo.1724.3" xmlns="http://www.w3.org/1999/xhtml">Then, prepare yourself to optimize your travel plans with the help of QUBO formalism.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.4.4" id="the-traveling-salesperson-problem">
<h2 class="subsectionHead" data-number="10.4.4"><span class="titlemark"><span class="koboSpan" id="kobo.1725.1" xmlns="http://www.w3.org/1999/xhtml">3.4.4 </span></span> <span id="x1-720003.4.4"><span class="koboSpan" id="kobo.1726.1" xmlns="http://www.w3.org/1999/xhtml">The Traveling Salesperson Problem</span></span></h2>
<p><span class="koboSpan" id="kobo.1727.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.1728.1" xmlns="http://www.w3.org/1999/xhtml">Traveling Salesperson Problem</span></strong><span class="koboSpan" id="kobo.1729.1" xmlns="http://www.w3.org/1999/xhtml"> (or, simply, </span><strong><span class="koboSpan" id="kobo.1730.1" xmlns="http://www.w3.org/1999/xhtml">TSP</span></strong><span class="koboSpan" id="kobo.1731.1" xmlns="http://www.w3.org/1999/xhtml">) is one of the most </span><span id="dx1-72001"/><span class="koboSpan" id="kobo.1732.1" xmlns="http://www.w3.org/1999/xhtml">famous problems in </span><span id="dx1-72002"/><span class="koboSpan" id="kobo.1733.1" xmlns="http://www.w3.org/1999/xhtml">combinatorial optimization. </span><span class="koboSpan" id="kobo.1733.2" xmlns="http://www.w3.org/1999/xhtml">The goal of the problem is very simple to state: you need to find a route that goes through each of the cities in a given set once and only once while minimizing some global quantity (distance traveled, time spent, total cost...).</span></p>
<p><span class="koboSpan" id="kobo.1734.1" xmlns="http://www.w3.org/1999/xhtml">We can formulate the problem mathematically using graphs. </span><span class="koboSpan" id="kobo.1734.2" xmlns="http://www.w3.org/1999/xhtml">In this formulation, we would be given a set of vertices </span><span class="koboSpan" id="kobo.1735.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1736.1" xmlns="http://www.w3.org/1999/xhtml"> representing the cities, and, for each pair of vertices </span><span class="koboSpan" id="kobo.1737.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1738.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1739.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1740.1" xmlns="http://www.w3.org/1999/xhtml">, we would also be given the cost </span><span class="koboSpan" id="kobo.1741.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{jl}" class="math inline" src="../media/file527.png" style="vertical-align:middle" title="w_{jl}"/></span><span class="koboSpan" id="kobo.1742.1" xmlns="http://www.w3.org/1999/xhtml"> of traveling from </span><span class="koboSpan" id="kobo.1743.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1744.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><span class="koboSpan" id="kobo.1745.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1746.1" xmlns="http://www.w3.org/1999/xhtml"> (this cost does not need to be the same, in general, as </span><span class="koboSpan" id="kobo.1747.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{lj}" class="math inline" src="../media/file528.png" style="vertical-align:middle" title="w_{lj}"/></span><span class="koboSpan" id="kobo.1748.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.1748.2" xmlns="http://www.w3.org/1999/xhtml">We then need to find a </span><strong><span class="koboSpan" id="kobo.1749.1" xmlns="http://www.w3.org/1999/xhtml">path</span></strong><span class="koboSpan" id="kobo.1750.1" xmlns="http://www.w3.org/1999/xhtml"> in the graph (that is, a set of edges such that the end of an edge is the beginning of the next one) that visits each vertex once and only once and that </span><span id="dx1-72003"/><span class="koboSpan" id="kobo.1751.1" xmlns="http://www.w3.org/1999/xhtml">minimizes the sum of the costs of all the edges used.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-85">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1752.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1753.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1754.1" xmlns="http://www.w3.org/1999/xhtml">As you have probably guessed, the TSP is </span><span class="koboSpan" id="kobo.1755.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1756.1" xmlns="http://www.w3.org/1999/xhtml">-hard (refer to </span><em><span class="koboSpan" id="kobo.1757.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 15</span></em><span class="koboSpan" id="kobo.1758.1" xmlns="http://www.w3.org/1999/xhtml"> in the book on combinatorial optimization by Korte and Vygen </span><span class="cite"><span class="koboSpan" id="kobo.1759.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xkorte2012combinatorial"><span class="koboSpan" id="kobo.1760.1" xmlns="http://www.w3.org/1999/xhtml">61</span></a><span class="koboSpan" id="kobo.1761.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1762.1" xmlns="http://www.w3.org/1999/xhtml"> for more details). </span><span class="koboSpan" id="kobo.1762.2" xmlns="http://www.w3.org/1999/xhtml">In fact, given a graph, a set of costs for the edges and a value </span><span class="koboSpan" id="kobo.1763.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C" class="math inline" src="../media/file234.png" style="vertical-align:middle" title="C"/></span><span class="koboSpan" id="kobo.1764.1" xmlns="http://www.w3.org/1999/xhtml">, it is </span><span class="koboSpan" id="kobo.1765.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1766.1" xmlns="http://www.w3.org/1999/xhtml">-complete to decide whether there is a path that visits all the cities and has a cost less than or equal to </span><span class="koboSpan" id="kobo.1767.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="C" class="math inline" src="../media/file234.png" style="vertical-align:middle" title="C"/></span><span class="koboSpan" id="kobo.1768.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1769.1" xmlns="http://www.w3.org/1999/xhtml">For instance, in </span><em><span class="koboSpan" id="kobo.1770.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.7"><em><span class="koboSpan" id="kobo.1771.1" xmlns="http://www.w3.org/1999/xhtml">3.7</span></em></a><span class="koboSpan" id="kobo.1772.1" xmlns="http://www.w3.org/1999/xhtml"> we can see a TSP instance with four cities. </span><span class="koboSpan" id="kobo.1772.2" xmlns="http://www.w3.org/1999/xhtml">The numbers that appear to label the edges are their costs. </span><span class="koboSpan" id="kobo.1772.3" xmlns="http://www.w3.org/1999/xhtml">For simplicity, we have assumed that for every pair of vertices, the travel cost is, in this case, the same in both directions.</span></p>
<figure>
<span class="koboSpan" id="kobo.1773.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 3.7: An example of the Traveling Salesperson Problem" src="../media/file529.jpg"/></span>
<figcaption aria-hidden="true"><span class="id" id="Figure3.7"><strong><span class="koboSpan" id="kobo.1774.1" xmlns="http://www.w3.org/1999/xhtml">Figure 3.7</span></strong><span class="koboSpan" id="kobo.1775.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="koboSpan" id="kobo.1776.1" xmlns="http://www.w3.org/1999/xhtml">An example of the Traveling Salesperson Problem</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.1777.1" xmlns="http://www.w3.org/1999/xhtml">To formulate the TSP in the QUBO framework, we will define binary variables </span><span class="koboSpan" id="kobo.1778.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}" class="math inline" src="../media/file512.png" style="vertical-align:middle" title="x_{jl}"/></span><span class="koboSpan" id="kobo.1779.1" xmlns="http://www.w3.org/1999/xhtml"> that will indicate the order of visiting the different vertices. </span><span class="koboSpan" id="kobo.1779.2" xmlns="http://www.w3.org/1999/xhtml">More concretely, if vertex </span><span class="koboSpan" id="kobo.1780.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1781.1" xmlns="http://www.w3.org/1999/xhtml"> is the </span><span class="koboSpan" id="kobo.1782.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1783.1" xmlns="http://www.w3.org/1999/xhtml">-th in the tour, then </span><span class="koboSpan" id="kobo.1784.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}" class="math inline" src="../media/file512.png" style="vertical-align:middle" title="x_{jl}"/></span><span class="koboSpan" id="kobo.1785.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.1786.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="1" class="math inline" src="../media/file13.png" style="vertical-align:middle" title="1"/></span><span class="koboSpan" id="kobo.1787.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1788.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jh}" class="math inline" src="../media/file530.png" style="vertical-align:middle" title="x_{jh}"/></span><span class="koboSpan" id="kobo.1789.1" xmlns="http://www.w3.org/1999/xhtml"> will be </span><span class="koboSpan" id="kobo.1790.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="0" class="math inline" src="../media/file12.png" style="vertical-align:middle" title="0"/></span><span class="koboSpan" id="kobo.1791.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><span class="koboSpan" id="kobo.1792.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="h \neq l" class="math inline" src="../media/file518.png" style="vertical-align:middle" title="h \neq l"/></span><span class="koboSpan" id="kobo.1793.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1793.2" xmlns="http://www.w3.org/1999/xhtml">Thus, for every vertex </span><span class="koboSpan" id="kobo.1794.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1795.1" xmlns="http://www.w3.org/1999/xhtml">, we need to impose the constraint</span></p>
<p><span class="koboSpan" id="kobo.1796.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{l = 0}^{m}x_{jl} = 1," class="math display" src="../media/file531.png" style="vertical-align:middle" title="\sum\limits_{l = 0}^{m}x_{jl} = 1,"/></span></p>
<p><span class="koboSpan" id="kobo.1797.1" xmlns="http://www.w3.org/1999/xhtml">because every vertex needs to be visited exactly once. </span><span class="koboSpan" id="kobo.1797.2" xmlns="http://www.w3.org/1999/xhtml">But we also need to impose</span></p>
<p><span class="koboSpan" id="kobo.1798.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{j = 0}^{m}x_{jl} = 1" class="math display" src="../media/file532.png" style="vertical-align:middle" title="\sum\limits_{j = 0}^{m}x_{jl} = 1"/></span></p>
<p><span class="koboSpan" id="kobo.1799.1" xmlns="http://www.w3.org/1999/xhtml">for every position </span><span class="koboSpan" id="kobo.1800.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1801.1" xmlns="http://www.w3.org/1999/xhtml">, because we can only visit one city at a time.</span></p>
<p><span class="koboSpan" id="kobo.1802.1" xmlns="http://www.w3.org/1999/xhtml">If those two </span><span id="dx1-72006"/><span class="koboSpan" id="kobo.1803.1" xmlns="http://www.w3.org/1999/xhtml">constraints are met, we will have a path that visits every vertex once and only once. </span><span class="koboSpan" id="kobo.1803.2" xmlns="http://www.w3.org/1999/xhtml">However, that is not enough. </span><span class="koboSpan" id="kobo.1803.3" xmlns="http://www.w3.org/1999/xhtml">We also want to minimize the total cost of the path, so we need an expression that gives us that cost in terms of the </span><span class="koboSpan" id="kobo.1804.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}" class="math inline" src="../media/file512.png" style="vertical-align:middle" title="x_{jl}"/></span><span class="koboSpan" id="kobo.1805.1" xmlns="http://www.w3.org/1999/xhtml"> variables. </span><span class="koboSpan" id="kobo.1805.2" xmlns="http://www.w3.org/1999/xhtml">Notice that an edge </span><span class="koboSpan" id="kobo.1806.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="(j,k)" class="math inline" src="../media/file356.png" style="vertical-align:middle" title="(j,k)"/></span><span class="koboSpan" id="kobo.1807.1" xmlns="http://www.w3.org/1999/xhtml"> is used if and only if the vertices </span><span class="koboSpan" id="kobo.1808.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1809.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1810.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1811.1" xmlns="http://www.w3.org/1999/xhtml"> are consecutive in the path. </span><span class="koboSpan" id="kobo.1811.2" xmlns="http://www.w3.org/1999/xhtml">That is, if and only if there exists an </span><span class="koboSpan" id="kobo.1812.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1813.1" xmlns="http://www.w3.org/1999/xhtml"> such that </span><span class="koboSpan" id="kobo.1814.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1815.1" xmlns="http://www.w3.org/1999/xhtml"> is visited in position </span><span class="koboSpan" id="kobo.1816.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1817.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1818.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1819.1" xmlns="http://www.w3.org/1999/xhtml"> is visited in position </span><span class="koboSpan" id="kobo.1820.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l + 1" class="math inline" src="../media/file533.png" style="vertical-align:middle" title="l + 1"/></span><span class="koboSpan" id="kobo.1821.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1821.2" xmlns="http://www.w3.org/1999/xhtml">In that case, the cost of using the edge will be given by </span><span class="koboSpan" id="kobo.1822.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{jk}x_{jl}x_{kl + 1}" class="math inline" src="../media/file534.png" style="vertical-align:middle" title="w_{jk}x_{jl}x_{kl + 1}"/></span><span class="koboSpan" id="kobo.1823.1" xmlns="http://www.w3.org/1999/xhtml">, because </span><span class="koboSpan" id="kobo.1824.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}x_{kl + 1} = 1" class="math inline" src="../media/file535.png" style="vertical-align:middle" title="x_{jl}x_{kl + 1} = 1"/></span><span class="koboSpan" id="kobo.1825.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1825.2" xmlns="http://www.w3.org/1999/xhtml">But if </span><span class="koboSpan" id="kobo.1826.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j" class="math inline" src="../media/file258.png" style="vertical-align:middle" title="j"/></span><span class="koboSpan" id="kobo.1827.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><span class="koboSpan" id="kobo.1828.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="k" class="math inline" src="../media/file317.png" style="vertical-align:middle" title="k"/></span><span class="koboSpan" id="kobo.1829.1" xmlns="http://www.w3.org/1999/xhtml"> are not consecutive in the path, then </span><span class="koboSpan" id="kobo.1830.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="x_{jl}x_{kl + 1} = 0" class="math inline" src="../media/file536.png" style="vertical-align:middle" title="x_{jl}x_{kl + 1} = 0"/></span><span class="koboSpan" id="kobo.1831.1" xmlns="http://www.w3.org/1999/xhtml"> for every </span><span class="koboSpan" id="kobo.1832.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="l" class="math inline" src="../media/file514.png" style="vertical-align:middle" title="l"/></span><span class="koboSpan" id="kobo.1833.1" xmlns="http://www.w3.org/1999/xhtml">, which is also the cost of that path in our route — we are not using it, so we don’t pay for it!</span></p>
<p><span class="koboSpan" id="kobo.1834.1" xmlns="http://www.w3.org/1999/xhtml">Thus, the total cost of the tour is given by</span></p>
<p><span class="koboSpan" id="kobo.1835.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\sum\limits_{l = 0}^{m - 1}\sum\limits_{j = 0}^{m}\sum\limits_{k = 0}^{m}w_{jk}x_{jl}x_{kl + 1}," class="math display" src="../media/file537.png" style="vertical-align:middle" title="\sum\limits_{l = 0}^{m - 1}\sum\limits_{j = 0}^{m}\sum\limits_{k = 0}^{m}w_{jk}x_{jl}x_{kl + 1},"/></span></p>
<p><span class="koboSpan" id="kobo.1836.1" xmlns="http://www.w3.org/1999/xhtml">where we are assuming that </span><span class="koboSpan" id="kobo.1837.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="w_{jj} = 0" class="math inline" src="../media/file538.png" style="vertical-align:middle" title="w_{jj} = 0"/></span><span class="koboSpan" id="kobo.1838.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><span class="koboSpan" id="kobo.1839.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="j = 0,\ldots,m" class="math inline" src="../media/file408.png" style="vertical-align:middle" title="j = 0,\ldots,m"/></span><span class="koboSpan" id="kobo.1840.1" xmlns="http://www.w3.org/1999/xhtml"> — staying in the same place costs nothing!</span></p>
<p><span class="koboSpan" id="kobo.1841.1" xmlns="http://www.w3.org/1999/xhtml">Then, we can incorporate the constraints as penalty terms in the function to minimize and write the TSP problem as</span></p>
<p><span class="koboSpan" id="kobo.1842.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {\sum\limits_{l = 0}^{m - 1}\sum\limits_{j = 0}^{m}\sum\limits_{k = 0}^{m}w_{jk}x_{jl}x_{kl + 1} + B\left( {\sum\limits_{l = 0}^{m}x_{jl} - 1} \right)^{2} + B\left( {\sum\limits_{j = 0}^{m}x_{jl} - 1} \right)^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{jl} \in \{ 0,1\},\qquad j,l = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}" class="math display" src="../media/file539.png" style="vertical-align:middle" title="\begin{array}{rlrl} {\text{Minimize}\quad} &amp; {\sum\limits_{l = 0}^{m - 1}\sum\limits_{j = 0}^{m}\sum\limits_{k = 0}^{m}w_{jk}x_{jl}x_{kl + 1} + B\left( {\sum\limits_{l = 0}^{m}x_{jl} - 1} \right)^{2} + B\left( {\sum\limits_{j = 0}^{m}x_{jl} - 1} \right)^{2}\qquad} &amp; &amp; \qquad \\ {\text{subject~to}\quad} &amp; {x_{jl} \in \{ 0,1\},\qquad j,l = 0,\ldots,m,\qquad} &amp; &amp; \qquad \\ \end{array}"/></span></p>
<p><span class="koboSpan" id="kobo.1843.1" xmlns="http://www.w3.org/1999/xhtml">where </span><span class="koboSpan" id="kobo.1844.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B" class="math inline" src="../media/file184.png" style="vertical-align:middle" title="B"/></span><span class="koboSpan" id="kobo.1845.1" xmlns="http://www.w3.org/1999/xhtml"> is chosen so that unfeasible </span><span id="dx1-72007"/><span class="koboSpan" id="kobo.1846.1" xmlns="http://www.w3.org/1999/xhtml">solutions never achieve an optimal value. </span><span class="koboSpan" id="kobo.1846.2" xmlns="http://www.w3.org/1999/xhtml">For instance, if we select</span></p>
<p><span class="koboSpan" id="kobo.1847.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="B = 1 + \sum\limits_{j,k = 0}^{m}w_{jk}," class="math display" src="../media/file540.png" style="vertical-align:middle" title="B = 1 + \sum\limits_{j,k = 0}^{m}w_{jk},"/></span></p>
<p><span class="koboSpan" id="kobo.1848.1" xmlns="http://www.w3.org/1999/xhtml">then those solutions that violate the constraints will get a penalty that is bigger than the cost of any valid tour and will not be selected as optimal.</span></p>
<div class="tcolorbox questionx" id="tcolobox-86">
<span id="x1-72009x3.4.4"/>
<div class="tcolorbox-title">
<p><span class="koboSpan" id="kobo.1849.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 3.8</span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1850.1" xmlns="http://www.w3.org/1999/xhtml">Obtain the expression for the route cost in the TSP problem with the graph in </span><em><span class="koboSpan" id="kobo.1851.1" xmlns="http://www.w3.org/1999/xhtml">Figure</span></em> <em/> <a href="#Figure3.7"><em><span class="koboSpan" id="kobo.1852.1" xmlns="http://www.w3.org/1999/xhtml">3.7</span></em></a><span class="koboSpan" id="kobo.1853.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1854.1" xmlns="http://www.w3.org/1999/xhtml">We have shown how to formulate several important problems in the QUBO formalism. </span><span class="koboSpan" id="kobo.1854.2" xmlns="http://www.w3.org/1999/xhtml">But the ones that we have focused on are not, by any means, the only ones that these techniques can address. </span><span class="koboSpan" id="kobo.1854.3" xmlns="http://www.w3.org/1999/xhtml">In the next subsection, we will give you a couple of hints of where to look for more.</span></p>
</section>
<section class="level3 subsectionHead" data-number="10.4.5" id="other-problems-and-other-formulations">
<h2 class="subsectionHead" data-number="10.4.5"><span class="titlemark"><span class="koboSpan" id="kobo.1855.1" xmlns="http://www.w3.org/1999/xhtml">3.4.5 </span></span> <span id="x1-730003.4.5"><span class="koboSpan" id="kobo.1856.1" xmlns="http://www.w3.org/1999/xhtml">Other problems and other formulations</span></span></h2>
<p><span class="koboSpan" id="kobo.1857.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we have introduced the Ising and QUBO models and we have shown how to use them to formulate combinatorial optimization problems. </span><span class="koboSpan" id="kobo.1857.2" xmlns="http://www.w3.org/1999/xhtml">In fact, in the last part of the chapter, we have studied several famous problems, including binary linear programming and the Traveling Salesperson Problem, and we have given QUBO formulations for them.</span></p>
<p><span class="koboSpan" id="kobo.1858.1" xmlns="http://www.w3.org/1999/xhtml">The possibility of using these frameworks to formulate optimization problems is not reduced to the examples that we have worked with. </span><span class="koboSpan" id="kobo.1858.2" xmlns="http://www.w3.org/1999/xhtml">Other important problems that can be readily written as QUBO and Ising instances include finding cliques in graphs, determining whether a logic formula is satisfiable, and scheduling jobs under constraints. </span><span class="koboSpan" id="kobo.1858.3" xmlns="http://www.w3.org/1999/xhtml">Using the techniques described in this chapter, you are now equipped to write your own formulations for these and other problems.</span></p>
<p><span class="koboSpan" id="kobo.1859.1" xmlns="http://www.w3.org/1999/xhtml">However, it is useful to have some references to problems that have already been formulated as QUBO instances to be used out of the box or to serve as inspiration if your problem doesn’t exactly fit any of them. </span><span class="koboSpan" id="kobo.1859.2" xmlns="http://www.w3.org/1999/xhtml">A good survey of such formulations is the one compiled by Lucas </span><span class="cite"><span class="koboSpan" id="kobo.1860.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xlucas2014ising"><span class="koboSpan" id="kobo.1861.1" xmlns="http://www.w3.org/1999/xhtml">65</span></a><span class="koboSpan" id="kobo.1862.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1863.1" xmlns="http://www.w3.org/1999/xhtml">, which includes all 21 of Karp’s </span><span class="koboSpan" id="kobo.1864.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="NP" class="math inline" src="../media/file2.png" style="vertical-align:middle" title="NP"/></span><span class="koboSpan" id="kobo.1865.1" xmlns="http://www.w3.org/1999/xhtml">-complete problems and more.</span></p>
<p><span class="koboSpan" id="kobo.1866.1" xmlns="http://www.w3.org/1999/xhtml">An important thing that you should always keep in mind when using the QUBO framework is that, usually, there is more than just one way of formulating a problem. </span><span class="koboSpan" id="kobo.1866.2" xmlns="http://www.w3.org/1999/xhtml">For example, sometimes it is straightforward to state a problem as a binary linear program and then use the transformations that we have studied to obtain a QUBO and, eventually, an Ising version of the problem. </span><span class="koboSpan" id="kobo.1866.3" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, it could be possible that with a different approach, you may find a more compact formulation that reduces, for instance, the number of variables or the length of the expression to minimize.</span></p>
<p><span class="koboSpan" id="kobo.1867.1" xmlns="http://www.w3.org/1999/xhtml">In recent years, the comparison of alternative QUBO formulations of important combinatorial optimization problems has become a very active research area. </span><span class="koboSpan" id="kobo.1867.2" xmlns="http://www.w3.org/1999/xhtml">It is good advice to keep an open mind (and an eye on the scientific literature) because, in many cases, choosing the right formulation can be a crucial factor to obtain better results when using quantum computers to solve optimization problems.</span></p>
<div class="tcolorbox learnmore" id="tcolobox-87">
<div class="tcolorbox-title">
<p><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1868.1" xmlns="http://www.w3.org/1999/xhtml">To learn more</span></span><span class="cmss-10x-x-109"><span class="koboSpan" id="kobo.1869.1" xmlns="http://www.w3.org/1999/xhtml">…</span></span></p>
</div>
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.1870.1" xmlns="http://www.w3.org/1999/xhtml">A recent paper by Salehi, Glos, and Miszczak </span><span class="cite"><span class="koboSpan" id="kobo.1871.1" xmlns="http://www.w3.org/1999/xhtml">[</span><a href="ch030.xhtml#Xsalehi2022unconstrained"><span class="koboSpan" id="kobo.1872.1" xmlns="http://www.w3.org/1999/xhtml">83</span></a><span class="koboSpan" id="kobo.1873.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.1874.1" xmlns="http://www.w3.org/1999/xhtml"> addresses the task of representing the TSP and some of its variants with QUBO formalism and studies how different formulations can affect the performance of quantum optimization algorithms.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.1875.1" xmlns="http://www.w3.org/1999/xhtml">Our next stop will be using actual quantum devices to solve the type of problem that we have been focusing on in this chapter. </span><span class="koboSpan" id="kobo.1875.2" xmlns="http://www.w3.org/1999/xhtml">Get ready to learn how to use quantum annealers!</span></p>
</section>
</section>
<section class="level2 likesectionHead" data-number="10.5" id="summary-2">
<h1 class="likesectionHead" data-number="10.5"><span id="x1-740003.4.5"><span class="koboSpan" id="kobo.1876.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></span></h1>
<p><span id="Q1-1-94"/></p>
<p><span class="koboSpan" id="kobo.1877.1" xmlns="http://www.w3.org/1999/xhtml">This chapter has been devoted to introducing two different mathematical frameworks, the Ising model and the QUBO formalism, which allow us to write combinatorial optimization problems in a way that we will later be able to use to find approximate solutions with the help of quantum computers. </span><span class="koboSpan" id="kobo.1877.2" xmlns="http://www.w3.org/1999/xhtml">We started with some simple examples and worked our way up to some famous problems such as graph coloring and the Traveling Salesperson Problem.</span></p>
<p><span class="koboSpan" id="kobo.1878.1" xmlns="http://www.w3.org/1999/xhtml">In order to achieve that, we studied different techniques that find wider applications in the process of writing optimization problems for quantum computers. </span><span class="koboSpan" id="kobo.1878.2" xmlns="http://www.w3.org/1999/xhtml">We saw, for example, how to use slack variables and how to replace constraints with penalty terms. </span><span class="koboSpan" id="kobo.1878.3" xmlns="http://www.w3.org/1999/xhtml">We also learned how to transform integer variables into a series of binary ones.</span></p>
<p><span class="koboSpan" id="kobo.1879.1" xmlns="http://www.w3.org/1999/xhtml">After all that we have covered in this chapter, you are now prepared to write your own problems in the languages required by optimization algorithms that can run on quantum computers. </span><span class="koboSpan" id="kobo.1879.2" xmlns="http://www.w3.org/1999/xhtml">The rest of the chapters in this part of the book will be devoted to learning how to implement and run those quantum optimization algorithms. </span><span class="koboSpan" id="kobo.1879.3" xmlns="http://www.w3.org/1999/xhtml">In fact, in the next chapter, we will explain how to use a type of quantum computer called a </span><strong><span class="koboSpan" id="kobo.1880.1" xmlns="http://www.w3.org/1999/xhtml">quantum annealer</span></strong><span class="koboSpan" id="kobo.1881.1" xmlns="http://www.w3.org/1999/xhtml"> to solve QUBO and Ising problems.</span></p>
</section>
</section>
</body>
</html>
