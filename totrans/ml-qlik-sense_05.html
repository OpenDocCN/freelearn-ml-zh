<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer041">
<h1 class="chapter-number" id="_idParaDest-71"><a id="_idTextAnchor071"/>5</h1>
<h1 id="_idParaDest-72"><a id="_idTextAnchor072"/>Setting Up the Environments</h1>
<p>In previous chapters, we discovered some of the theories and frameworks behind machine learning problems. In this chapter, we will move toward practical implementation. Installing Qlik machine learning environments is an essential step in leveraging the power of machine learning within Qlik Sense. In this chapter, we will cover the process of installing and setting up various Qlik machine <span class="No-Break">learning environments.</span></p>
<p>By the end of this chapter, we will have a solid understanding of the installation and configuration process for Qlik machine learning environments, allowing us to leverage the power of machine learning within Qlik Sense for data-driven <span class="No-Break">decision making.</span></p>
<p>Here is what we will learn as part of <span class="No-Break">this chapter:</span></p>
<ul>
<li>Advanced Analytics Integration with R <span class="No-Break">and Python</span></li>
<li>Setting up <span class="No-Break">Qlik AutoML</span></li>
<li>Cloud integrations <span class="No-Break">with REST</span></li>
</ul>
<h1 id="_idParaDest-73"><a id="_idTextAnchor073"/>Advanced Analytics Integration with R and Python</h1>
<p>Advanced Analytics Integration<a id="_idIndexMarker273"/> is a feature that allows users to perform advanced data analysis and predictive modeling tasks within the Qlik Sense environment. With Advanced Analytics Integration, users can use popular statistical analysis and machine learning tools, such as R and Python, to build predictive models, perform data mining tasks, and gain insights from <span class="No-Break">their data.</span></p>
<p>Data fetched from third-party systems using the Advanced Analytics connection is combined with data handled by the Qlik <span class="No-Break">Associative Engine.</span></p>
<p>The workflow for Advanced Analytics Integration is illustrated in the <span class="No-Break">following diagram:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer029">
<img alt="Figure 5.1: Advanced Analytics Integration workflow" height="699" src="image/B19863_05_01.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1: Advanced Analytics Integration workflow</p>
<p>Next, we will take a <a id="_idIndexMarker274"/>step-by-step look into the installation of R and <span class="No-Break">Python integrations.</span></p>
<h2 id="_idParaDest-74"><a id="_idTextAnchor074"/>Installing Advanced Analytics Integration with R</h2>
<p>In this section, we <a id="_idIndexMarker275"/>will install R with Advanced Analytics Integration<a id="_idIndexMarker276"/> in a Qlik Sense client-managed environment. Let’s work through the <span class="No-Break">following steps:</span></p>
<ol>
<li><strong class="bold">Prerequisites</strong>: You need the latest version of client-managed Qlik Sense installed and properly licensed (Server Side Extensions are supported since the Feb 2018 release of Qlik Sense). You should also have a user account with appropriate access rights to<a id="_idIndexMarker277"/> configure the connection in the <strong class="bold">Qlik Management </strong><span class="No-Break"><strong class="bold">Console</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">QMC</strong></span><span class="No-Break">).</span></li>
<li>First, we need to download and install the R environment. It can be downloaded <span class="No-Break">from </span><a href="https://cloud.r-project.org/"><span class="No-Break">https://cloud.r-project.org/</span></a><span class="No-Break">.</span><p class="list-inset">The base package of R is enough. At the time of writing, R-4.3.1 is the latest version but you should use the most recent one. The correct binary is determined by your given operating system. You can install R on the same server as the client-managed Qlik Sense instance or on a separate server. In this example, we will install R on the same server as Qlik Sense. You can proceed with the default settings in <span class="No-Break">the installer.</span></p></li>
<li>Next, we will need to install the <strong class="source-inline">Rserve</strong> package on our R environment in order to extend R functionality to applications via TCP/IP. Rserve makes it possible to invoke R scripts remotely and the SSE bridge is utilizing it as a part of communication flow. Open the Windows command line and navigate to the <strong class="source-inline">bin</strong> folder of your R environment directory. You might need to run an elevated command prompt that requires administrator privileges. In our example, the command to navigate to the right directory is <span class="No-Break">as follows:</span><pre class="source-code">
cd C:\Program Files\R\R-4.3.0\bin</pre><p class="list-inset">Once<a id="_idIndexMarker278"/> you are in the correct<a id="_idIndexMarker279"/> directory, open the R environment by typing <strong class="source-inline">R</strong> and pressing <em class="italic">Enter</em>. You should see a similar view to that shown in the <span class="No-Break">following screenshot:</span></p></li> </ol>
<div>
<div class="IMG---Figure" id="_idContainer030">
<img alt="Figure 5.2: R environment running on the command line" height="457" src="image/B19863_05_02.jpg" width="631"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2: R environment running on the command line</p>
<p class="list-inset">Type the following command to install the <span class="No-Break"><strong class="source-inline">Rserve</strong></span><span class="No-Break"> package:</span></p>
<pre class="source-code">
<strong class="bold">install.packages('Rserve')</strong></pre> <p class="list-inset">You might <a id="_idIndexMarker280"/>get a prompt asking you to select a CRAN mirror. Just select a location near you and press <strong class="bold">OK</strong>. <strong class="source-inline">Rserve</strong> is now installed on our environment. You can invoke it by typing the <span class="No-Break">following commands:</span></p>
<pre class="source-code">
<strong class="bold">library(Rserve)</strong>
<strong class="bold">Rserve()</strong></pre> <p class="list-inset">You <a id="_idIndexMarker281"/>should see the following message stating that <strong class="source-inline">Rserve</strong> is now running and ready <span class="No-Break">for commands:</span></p>
<pre class="source-code">
<strong class="bold">&gt; Rserve: Ok, ready to answer queries.</strong></pre> <ol>
<li value="4">We need a bridge component between Rserve and Qlik Sense. Qlik provides an open source plugin version of this bridge component for R, which we will use in this example. There is also the possibility of developing your own bridge. Download the bridge from the following <span class="No-Break">URL:</span><a href="https://github.com/qlik-oss/sse-r-plugin"><span class="No-Break"> https://github.com/qlik-oss/sse-r-plugin</span></a><span class="No-Break">.</span></li>
</ol>
<p class="callout-heading">Note</p>
<p class="callout">The plugin is written using C# and by default must be built. There is a prebuilt version of the plugin available in the <strong class="source-inline">releases</strong> section of the <span class="No-Break">repository: </span><a href="https://github.com/qlik-oss/sse-r-plugin/releases/tag/v1.2.1"><span class="No-Break">https://github.com/qlik-oss/sse-r-plugin/releases/tag/v1.2.1</span></a><span class="No-Break">.</span></p>
<p class="callout">In this example, we will use the newest prebuilt version since compiling C# source code is out of the scope of this book.The <strong class="bold">Bridge</strong> component is used to provide the interface between the Qlik Advanced Analytics connector and third-party analytics engine. It is based on Google Remote <span class="No-Break">Procedure Calls.</span></p>
<p class="list-inset">Once you have either built the package or downloaded the prebuilt version, open a new command line, navigate to the folder containing <strong class="source-inline">SSEtoRserve.exe</strong>, and launch it from the command line. The following view <span class="No-Break">should appear:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer031">
<img alt="Figure 5.3: SSEtoRserve running on the command line" height="249" src="image/B19863_05_03.jpg" width="673"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3: SSEtoRserve running on the command line</p>
<p class="list-inset">We have <a id="_idIndexMarker282"/>now verified that the bridge component can connect to Rserve. You should now close all open <a id="_idIndexMarker283"/>command-line windows before moving to the <span class="No-Break">next step!</span></p>
<p class="callout-heading">Note</p>
<p class="callout">The bridge component can run on the same server as the Qlik Sense environment or R environment, or on a separate server. Typically, it is recommended to install the bridge on the same server as Qlik Sense. In this example, we will install all the components on the <span class="No-Break">same server.</span></p>
<p class="callout">If the bridge component and R environment are on different servers, you have to configure the bridge component to connect to the correct IP address and port where Rserve is running. To do that, modify the values in the <strong class="source-inline">SSEtoRserve.exe.config</strong> file in the same directory as <strong class="source-inline">SSEtoRserve.exe</strong>. There are also other options in this file, including settings for certificates, among <span class="No-Break">other things.</span></p>
<ol>
<li value="5">Next, we will set up both R and our SSE-to-R bridge to run as a service. This will allow us to have an environment up and running all the time without the need to manually restart the services from the command line. There are multiple tools that can be used to run command-line scripts and programs as a service. In this example, we will use a free tool called NSSM. NSSM makes it easier to install and manage Windows services. Let’s start by downloading NSSM from the <a id="_idIndexMarker284"/>following <span class="No-Break">link: </span><a href="https://nssm.cc/download"><span class="No-Break">https://nssm.cc/download</span></a><span class="No-Break">.</span><p class="list-inset">Once you <a id="_idIndexMarker285"/>have finished downloading NSSM, extract the files from the <strong class="source-inline">.zip</strong> package and navigate to the <strong class="source-inline">win64</strong> folder (or <strong class="source-inline">win32</strong> if you are using a 32-bit environment) found inside the extracted folder using the command line. Make sure that you are running the command line with <span class="No-Break">admin privileges.</span></p><p class="list-inset">We will <a id="_idIndexMarker286"/>start by installing Rserve as a service. To launch NSSM, type the <span class="No-Break">following command:</span></p><pre class="source-code">
<strong class="bold">nssm install RserveService</strong></pre><p class="list-inset">You should see a small window open, as shown in the following figure. Next, we will configure our Rserve instance to run as a service. The <strong class="bold">Path</strong> field needs to point to the <strong class="source-inline">Rserve.exe</strong> file that can be found among the libraries in our R installation folder. An example path is <span class="No-Break">the following:</span></p><pre class="source-code">C:\Program Files\R\R-4.3.0\library\Rserve\libs\x64\Rserve.exe</pre><p class="list-inset">The <strong class="bold">Startup directory</strong> field should point to the directory where <strong class="source-inline">Rserve.exe</strong> is located. An example of these settings is shown in the <span class="No-Break">following screenshot:</span></p></li> </ol>
<div>
<div class="IMG---Figure" id="_idContainer032">
<img alt="Figure 5.4: NSSM Rserve setup" height="230" src="image/B19863_05_04.jpg" width="429"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4: NSSM Rserve setup</p>
<p class="list-inset">Press the <strong class="bold">Install service</strong> button and you should get a message stating that the service was <span class="No-Break">installed successfully.</span></p>
<p class="list-inset">To<a id="_idIndexMarker287"/> successfully<a id="_idIndexMarker288"/> run our Rserve service, we need to define the path to our R environment in the environment variables. To do that, let’s first open the environment variables window. It can be found by launching <strong class="bold">Control Panel</strong> � <strong class="bold">System and Security</strong> � <strong class="bold">System</strong> and selecting <strong class="bold">Advanced system settings</strong> on the left. The <strong class="bold">System Properties</strong> window will open. Click the <strong class="bold">Environment Variables</strong> button at the bottom of <span class="No-Break">the window.</span></p>
<p class="list-inset">The <strong class="bold">Environment Variables</strong> window will open and, at the bottom part of the window, you should see <strong class="bold">System variables</strong>. Find the variable called <strong class="source-inline">Path</strong> and activate that. Then, press the <strong class="bold">Edit</strong> button. The <strong class="bold">Edit environment variable</strong> <span class="No-Break">window opens.</span></p>
<p class="list-inset">Select <strong class="bold">New</strong> on the right side of the window and type the correct path to the directory containing your R executable. An example path is the following (You should use the actual path of your R <span class="No-Break">installation here):</span></p>
<pre class="source-code">
C:\Program Files\R\R-4.3.0\bin\x64</pre> <p class="list-inset">Confirm the edit by pressing <strong class="bold">OK</strong>. We also need to configure the <strong class="source-inline">R_HOME</strong> environment variable. For that, select <strong class="bold">New</strong> under <strong class="bold">System variables</strong>. Insert <strong class="source-inline">R_HOME</strong> into the <strong class="bold">Variable name</strong> field and add the path to the R environment root folder into the <strong class="bold">Variable </strong><span class="No-Break"><strong class="bold">value</strong></span><span class="No-Break"> field.</span></p>
<p class="list-inset">The following screenshot shows <span class="No-Break">an example:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<img alt="Figure 5.5: System variable example" height="164" src="image/B19863_05_05.jpg" width="648"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5: System variable example</p>
<p class="list-inset">Press <strong class="bold">OK</strong> on all three windows until you get back to <strong class="bold">Control Panel</strong>. The system variables have now <span class="No-Break">been created.</span></p>
<p class="list-inset">Next, we<a id="_idIndexMarker289"/> will install the bridge<a id="_idIndexMarker290"/> component as a service. Start by typing the following command into the same command-line window that we used in the <span class="No-Break">previous step:</span></p>
<pre class="source-code">
nssm install SSEtoRServe</pre> <p class="list-inset">A similar setup window to the one we saw in an earlier step should appear. Here, we will set our path to point to our <strong class="source-inline">SSEtoRServe.exe</strong> file located in our bridge connector folder. An example path is <span class="No-Break">the following:</span></p>
<pre class="source-code">
C:\Users\qmi\Downloads\sse-r-plugin-1.2.1-qlik-oss\sse-r-plugin-1.2.1-qlik-oss\SSEtoRserve.exe</pre> <p class="list-inset">The setup should look similar to the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<img alt="Figure 5.6: NSSM SSEtoRserve setup" height="230" src="image/B19863_05_06.jpg" width="429"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6: NSSM SSEtoRserve setup</p>
<p class="list-inset">Next, we <a id="_idIndexMarker291"/>will set <strong class="source-inline">RserveService</strong> as a dependency for our <strong class="source-inline">SSEtoRServe</strong> service. To do that, open the <strong class="bold">Dependencies</strong> tab and type <strong class="source-inline">RserveService</strong> into the window, <span class="No-Break">as follows:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<img alt="Figure 5.7: SSEtoRServe dependencies configuration" height="228" src="image/B19863_05_07.jpg" width="424"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7: SSEtoRServe dependencies configuration</p>
<p class="list-inset">After<a id="_idIndexMarker292"/> pressing the <strong class="bold">Install service</strong> button, we should get confirmation of a <span class="No-Break">successful installation.</span></p>
<p class="list-inset">Next, we can open the <strong class="bold">Services</strong> view from Windows and start our <strong class="bold">SSEtoRserve</strong> service. That should also fire up <strong class="bold">RserveService</strong>. Verify that both services are running correctly before proceeding to the <span class="No-Break">next step.</span></p>
<ol>
<li value="6">The next step is<a id="_idIndexMarker293"/> to configure the <a id="_idIndexMarker294"/>Advanced Analytics connection in the QMC. Open <strong class="bold">QMC</strong> and navigate to the <strong class="bold">Analytic Connections</strong> section. Select <strong class="bold">Create New</strong>. The <strong class="bold">Edit analytic connection</strong> view will open. Insert the following parameters and <span class="No-Break">press </span><span class="No-Break"><strong class="bold">Apply</strong></span><span class="No-Break">:</span><ul><li><span class="No-Break"><strong class="bold">Name</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">R</strong></span></li><li><span class="No-Break"><strong class="bold">Host</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">localhost</strong></span></li><li><span class="No-Break"><strong class="bold">Port</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">50051</strong></span></li><li><strong class="bold">Certificate file path</strong>: Leave empty at this point. This can be used to configure a certificate for <span class="No-Break">the connection.</span></li><li><strong class="bold">Reconnect timeout (</strong><span class="No-Break"><strong class="bold">seconds)</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">20</strong></span></li><li><strong class="bold">Request timeout (</strong><span class="No-Break"><strong class="bold">seconds)</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">0</strong></span></li></ul><p class="list-inset">An example of the settings is shown in the <span class="No-Break">following screenshot:</span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer036">
<img alt="Figure 5.8: Analytic connection settings in the QMC" height="270" src="image/B19863_05_08.jpg" width="576"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8: Analytic connection settings in the QMC</p>
<ol>
<li value="7">Next, we can test that our connection works correctly. Open any Qlik Sense application or create a new one with some dummy data. Add a new sheet in the application and drag a KPI object onto <span class="No-Break">the canvas.</span><p class="list-inset">Insert the following formula into the expression field in the <span class="No-Break">KPI object:</span></p><pre class="source-code">
R.ScriptEval('1+2')</pre><p class="list-inset">The first part of<a id="_idIndexMarker295"/> the script tells the engine to utilize our newly created analytics connection. You can reference any analytics connection using its name as defined in the QMC. In this case, the name of our connection is <strong class="source-inline">R</strong>. The second part is a function provided by our bridge plugin. There are eight functions provided in total. We will take a deeper look at how to utilize these in <a href="B19863_07.xhtml#_idTextAnchor096"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>. In this test, we will send a simple formula to sum two numbers in the R environment. R returns the sum of our calculation, and we should see it displayed in the <span class="No-Break">KPI object:</span></p></li> </ol>
<div>
<div class="IMG---Figure" id="_idContainer037">
<img alt="Figure 5.9: Example of a KPI calculated in R" height="195" src="image/B19863_05_09.jpg" width="400"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9: Example of a KPI calculated in R</p>
<p class="list-inset">We <a id="_idIndexMarker296"/>have now verified that our environment is working correctly. You can utilize the connection from the load script during data loads or on the fly just as we did with our <span class="No-Break">example KPI.</span></p>
<p class="callout-heading">Note</p>
<p class="callout">The <strong class="source-inline">SSEtoRserve</strong> component writes a log into the <strong class="source-inline">/logs</strong> folder located in the <strong class="source-inline">root</strong> folder of the bridge. That log is a good place to start debugging possible issues and monitoring the performance of the environment and <span class="No-Break">the models.</span></p>
<p class="callout-heading">Note</p>
<p class="callout">If you want to run the Advanced Analytics connection on a Qlik Sense Desktop instance, you can add the connection details to the <strong class="source-inline">Settings.ini</strong> file located under <strong class="source-inline">Documents/Qlik/Sense</strong>. To create a connection to the R environment, add the <span class="No-Break">following line:</span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline">SSEPlugin=R,localhost:50051</strong></span></p>
<p class="callout">Remember to add an empty line at the end of the file and then save it. Your Qlik Sense Desktop instance should now be able to connect to R using the Advanced Analytics connection. (Note that the <strong class="source-inline">SSEtoRserve</strong> bridge and Rserve must be running on your computer before starting Qlik <span class="No-Break">Sense Desktop.)</span></p>
<h2 id="_idParaDest-75"><a id="_idTextAnchor075"/>Installing Advanced Analytics Integration with Python</h2>
<p>We can<a id="_idIndexMarker297"/> also utilize Python with the<a id="_idIndexMarker298"/> Advanced Analytics connection. In this section, we will install Python with Advanced Analytics Integration in a client-managed Qlik Sense environment. Let’s do this with the <span class="No-Break">following steps:</span></p>
<ol>
<li><strong class="bold">Prerequisites</strong>: You need the latest version of client-managed Qlik Sense installed and properly licensed. You should also have a user account with appropriate access rights to configure the connection in <span class="No-Break">the QMC.</span></li>
<li>Download<a id="_idIndexMarker299"/> and install <span class="No-Break">Python: </span><a href="https://www.python.org/downloads/"><span class="No-Break">https://www.python.org/downloads/</span></a><span class="No-Break">.</span><p class="list-inset">When the installer launches, select <strong class="bold">Add python.exe to PATH</strong> and press <span class="No-Break"><strong class="bold">Install Now</strong></span><span class="No-Break">.</span></p><p class="list-inset">This phase of <a id="_idIndexMarker300"/>the installer can be seen in the <span class="No-Break">following screenshot:</span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer038">
<img alt="Figure 5.10: Python installation settings" height="402" src="image/B19863_05_10.jpg" width="647"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10: Python installation settings</p>
<ol>
<li value="3">After <a id="_idIndexMarker301"/>Python is successfully installed, we will add some libraries to it. Here, we are installing some of the most common statistical libraries needed in order to communicate through the bridge component. You can also install additional libraries based on your needs. Open a new command-line window and type the <span class="No-Break">following commands:</span><pre class="source-code">
<strong class="bold">python -m pip install --upgrade pip</strong>
<strong class="bold">python -m pip install grpcio</strong>
<strong class="bold">python -m pip install numpy</strong>
<strong class="bold">python -m pip install nose</strong>
<strong class="bold">python -m pip install google</strong>
<strong class="bold">python -m pip install protobuf==3.20.*</strong></pre></li> <li>For this example, we will also use predefined bridge that is created by Qlik. Download it from <a href="https://github.com/qlik-oss/server-side-extension/releases/tag/v1.1.0">https://github.com/qlik-oss/server-side-extension/releases/tag/v1.1.0</a> and extract it to <span class="No-Break">the server.</span></li>
<li>Next, we <a id="_idIndexMarker302"/>will configure our analytics connection in the QMC. Open <strong class="bold">QMC</strong> and select <strong class="bold">Analytics connection</strong>. Insert the <span class="No-Break">following values:</span><ul><li><span class="No-Break"><strong class="bold">Name</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">Script</strong></span></li><li><span class="No-Break"><strong class="bold">Host</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">localhost</strong></span></li><li><span class="No-Break"><strong class="bold">Port</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">50051</strong></span></li><li><strong class="bold">Certificate file path</strong>: Leave empty at this point. This can be used to configure a certificate for <span class="No-Break">the connection.</span></li><li><strong class="bold">Reconnect timeout (</strong><span class="No-Break"><strong class="bold">seconds)</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">20</strong></span></li><li><strong class="bold">Request timeout (</strong><span class="No-Break"><strong class="bold">seconds)</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">0</strong></span></li></ul></li>
<li>Next, we <a id="_idIndexMarker303"/>will import our example application. Navigate to the folder containing the bridge downloaded in <em class="italic">step 4</em>. From there, navigate to the <strong class="source-inline">\examples\python\FullScriptSupport</strong> folder and look for an application called <strong class="source-inline">SSE_Full_Script_Support.qvf</strong>. Import that into your Qlik <span class="No-Break">Sense environment.</span></li>
<li>Open the command line and navigate to the folder containing the bridge downloaded in <em class="italic">step 4</em>. From there, navigate to the <strong class="source-inline">\examples\python\FullScriptSupport</strong> folder. Type the following command and <span class="No-Break">press </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">:</span><pre class="source-code">
<strong class="bold">python ExtensionService_Script.py</strong></pre><p class="list-inset">You should see the following lines in a <span class="No-Break">command-line window:</span></p><pre class="source-code">2023-04-23 13:29:19,950 — INFO — Logging enabled
2023-04-23 13:29:19,966 — INFO - *** Running server in insecure mode on port: 50051 ***</pre><p class="list-inset">The Python environment is now running and ready to take commands from the <span class="No-Break">Qlik </span><span class="No-Break"><a id="_idIndexMarker304"/></span><span class="No-Break">application.</span></p></li> </ol>
<p class="callout-heading">Note</p>
<p class="callout">If you are installing this example on the same environment as the previous R example, you need to change the port for this Python example. To do that, you can modify the code in the <strong class="source-inline">ExtensionService_Script.py</strong> file located in the same folder where we ran our example in <em class="italic">step 7</em>. The port is defined on <span class="No-Break">line </span><span class="No-Break"><em class="italic">117</em></span><span class="No-Break">:</span></p>
<p class="callout"><strong class="source-inline">parser.add_argument('—port', </strong><span class="No-Break"><strong class="source-inline">nargs='?', default='50051')</strong></span></p>
<p class="callout">Change that and make the corresponding change in <strong class="bold">QMC </strong>� <span class="No-Break"><strong class="bold">Analytic connection</strong></span><span class="No-Break">.</span></p>
<p class="callout-heading">Note</p>
<p class="callout">You can also set up a Python environment to run as a service using the same method described earlier with R components. We will not cover that part in detail here, but basically, you can install Python as a service using NSSM and give the script as <span class="No-Break">an argument.</span></p>
<ol>
<li value="8">Open<a id="_idIndexMarker305"/> the <strong class="source-inline">SSE_Full_Script_Support.qvf</strong> file that we imported in <em class="italic">step 6</em> to verify the functionality. If you open the first sheet of the application, you should see <span class="No-Break">the following:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer039">
<img alt="Figure 5.11: Python connection working" height="339" src="image/B19863_05_11.jpg" width="847"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11: Python connection working</p>
<p>We have <a id="_idIndexMarker306"/>now <a id="_idIndexMarker307"/>successfully installed Python with the Advanced Analytics connection <span class="No-Break">on Qlik.</span></p>
<h1 id="_idParaDest-76"><a id="_idTextAnchor076"/>Setting up Qlik AutoML</h1>
<p>Since Qlik AutoML is <a id="_idIndexMarker308"/>a SaaS solution, there is minimal setup required. In this section, we will look at the necessary steps to utilize AutoML. We will assume that a Qlik Cloud tenant is up and running. The Basic tier of Qlik AutoML is included as part of the Qlik Cloud subscription license. We will take a deep dive into Qlik AutoML itself in <a href="B19863_08.xhtml#_idTextAnchor101"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>. To prepare our environment for that chapter, the following steps <span class="No-Break">are needed:</span></p>
<ol>
<li>Navigate to <strong class="bold">Management Console</strong> in Qlik Cloud and open the <span class="No-Break"><strong class="bold">Settings</strong></span><span class="No-Break"> tab.</span></li>
<li>Under the <strong class="bold">Feature control</strong> section, make sure that <strong class="bold">Machine learning endpoints</strong> is enabled, as seen in the <span class="No-Break">following screenshot:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer040">
<img alt="Figure 5.12: Machine learning endpoints setting" height="586" src="image/B19863_05_12.jpg" width="1081"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12: Machine learning endpoints setting</p>
<ol>
<li value="3">Select <strong class="bold">Analytics Services</strong> and <a id="_idIndexMarker309"/>create a shared space called <strong class="source-inline">ML</strong> <strong class="source-inline">experiments</strong>. This will be our space for all the work done in <a href="B19863_08.xhtml#_idTextAnchor101"><span class="No-Break"><em class="italic">Chapter 8</em></span></a><span class="No-Break">.</span></li>
</ol>
<p>Our cloud environment is now set up and ready. We will now explore various integrations that we can use with <span class="No-Break">Qlik Cloud.</span></p>
<h1 id="_idParaDest-77"><a id="_idTextAnchor077"/>Cloud integrations with REST</h1>
<p>There are many<a id="_idIndexMarker310"/> third-party machine learning and AI platforms on the market. You can connect to most of these from Qlik Cloud. In this section, we will briefly look at the different options and requirements for each connection. We will not create the actual models on top of third-party tools in <span class="No-Break">this chapter.</span></p>
<p>To start using connections to third-party machine learning endpoints, you must enable them from <strong class="bold">Management Console</strong> in Qlik Cloud. If you have been following this chapter from the beginning, we completed that step in the <span class="No-Break">previous section.</span></p>
<p>There are dedicated connectors available for the most common machine learning tools out there. At the time of writing this book, the connectors are <span class="No-Break">as follows:</span></p>
<ul>
<li>The general Advanced <span class="No-Break">Analytics connector</span></li>
<li>Amazon <span class="No-Break">Comprehend connector</span></li>
<li>Amazon <span class="No-Break">SageMaker connector</span></li>
<li>Azure <span class="No-Break">ML connector</span></li>
<li>Azure <span class="No-Break">OpenAI connector</span></li>
<li>Databricks <span class="No-Break">MLflow connector</span></li>
<li><span class="No-Break">DataRobot connector</span></li>
<li>Qlik <span class="No-Break">AutoML connector</span></li>
<li>Qlik <span class="No-Break">GeoOperations connector</span></li>
<li><span class="No-Break">OpenAI connector</span></li>
</ul>
<p>All these <a id="_idIndexMarker311"/>connections are available when you select <strong class="bold">Add New</strong> � <strong class="bold">Data connection</strong> in Qlik Cloud. Analytics connections can send data to external machine learning endpoints for calculation. The functionality is similar to what we discovered with the R and Python connections earlier in this chapter. The data connection can be utilized either from a load script or <em class="italic">on the fly</em> from visualization expressions. We will go deeper into the syntax in <a href="B19863_07.xhtml#_idTextAnchor096"><span class="No-Break"><em class="italic">Chapter 7</em></span></a><span class="No-Break">.</span></p>
<p>Let’s take a closer look at some of <span class="No-Break">these connectors.</span></p>
<h2 id="_idParaDest-78"><a id="_idTextAnchor078"/>General Advanced Analytics connector</h2>
<p>To use a<a id="_idIndexMarker312"/> generic connector, there<a id="_idIndexMarker313"/> must be an endpoint to connect to, and this endpoint must be publicly accessible by the Qlik Cloud environment. The <a id="_idIndexMarker314"/>parameters for these connections are <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">URL</strong>: Host URL for the platform where the model <span class="No-Break">is deployed.</span></li>
<li><strong class="bold">Method</strong>: GET <span class="No-Break">or POST.</span></li>
<li><strong class="bold">Content Type</strong>: Content type for the request header. For <span class="No-Break">example, </span><span class="No-Break"><strong class="source-inline">application/json</strong></span><span class="No-Break">.</span></li>
<li><strong class="bold">HTTP Headers</strong>: Custom headers sent with <span class="No-Break">each request.</span></li>
<li><strong class="bold">Query Parameters</strong>: Parameters that will be attached to the end of <span class="No-Break">the URL.</span></li>
<li><strong class="bold">Authorization Method</strong>: None, Bearer Token, or AWS Auth <span class="No-Break">v4 Signature.</span></li>
<li><strong class="bold">Request</strong>: Format and content of <span class="No-Break">the request.</span></li>
<li><strong class="bold">Response Fields</strong>: Whether to load all fields. If this is not selected, you can specify the fields to <span class="No-Break">be loaded.</span></li>
<li><strong class="bold">Response Table</strong>: Definition of specific table fields. If the previous parameter is not checked, this is used to determine the fields to <span class="No-Break">be loaded.</span></li>
<li><strong class="bold">Association</strong>: A field containing a unique identifier. The result table will be associated with the source table using this information. This can be any field containing a <span class="No-Break">unique ID.</span></li>
<li><strong class="bold">Name</strong>: <span class="No-Break">Connection name.</span></li>
</ul>
<p>Once <a id="_idIndexMarker315"/>you <a id="_idIndexMarker316"/>create a connection, it will appear under <strong class="bold">Data connections</strong> in <strong class="bold">Data </strong><span class="No-Break"><strong class="bold">load editor</strong></span><span class="No-Break">.</span></p>
<h2 id="_idParaDest-79"><a id="_idTextAnchor079"/>Amazon SageMaker connector</h2>
<p>Amazon SageMaker<a id="_idIndexMarker317"/> is a <a id="_idIndexMarker318"/>well-known <a id="_idIndexMarker319"/>machine learning platform. There is a dedicated connector to interact with SageMaker from Qlik Cloud. To connect to a SageMaker endpoint, it must be publicly accessible by Qlik Cloud. The parameters for this connector are <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Endpoint Name</strong>: Identifier used by the endpoint in the <span class="No-Break">AWS environment.</span></li>
<li><strong class="bold">Model Name</strong>: Name given for the deployed model <span class="No-Break">in AWS.</span></li>
<li><strong class="bold">Model Variant Name</strong>: If a multi-model endpoint is deployed, this parameter is used to recognize the variant. For a simple endpoint, this should not <span class="No-Break">be provided.</span></li>
<li><strong class="bold">Settings</strong>: <strong class="bold">Region</strong> is where the AWS Region for the service is specified, and <strong class="bold">Use FIPS Endpoint</strong> specifies whether there is a need for a <span class="No-Break">FIPS-compliant endpoint.</span></li>
<li><strong class="bold">Authentication</strong>: Here we use the AWS access key and secret key found in the <span class="No-Break">AWS console.</span></li>
<li><strong class="bold">Response Format</strong>: JSON or Text Array. Most models <span class="No-Break">use JSON.</span></li>
<li><strong class="bold">Response Table</strong>: <strong class="bold">Name of Returned Table</strong> identifies the table returned by the model and <strong class="bold">Table Path </strong>can be used to specify the table using a <span class="No-Break">JMES path.</span></li>
<li><strong class="bold">Response Fields</strong>: Whether to load all fields. If this is not selected, you can specify the fields to be loaded using the <strong class="bold">Table </strong><span class="No-Break"><strong class="bold">Fields</strong></span><span class="No-Break"> selector.</span></li>
<li><strong class="bold">Association</strong>: A <a id="_idIndexMarker320"/>field <a id="_idIndexMarker321"/>containing a unique identifier. The result table will be associated with the source table using this information. This can be any field with a <span class="No-Break">unique ID.</span></li>
<li><strong class="bold">Name</strong>: <span class="No-Break">Connection name.</span></li>
</ul>
<h2 id="_idParaDest-80"><a id="_idTextAnchor080"/>Azure ML connector</h2>
<p>Azure ML is <a id="_idIndexMarker322"/>another well-known <a id="_idIndexMarker323"/>machine learning platform. To connect to an Azure ML endpoint, it must be publicly accessible by Qlik Cloud. These are the parameters for <span class="No-Break">this </span><span class="No-Break"><a id="_idIndexMarker324"/></span><span class="No-Break">connector:</span></p>
<ul>
<li><strong class="bold">Format</strong>: Azure ML or Azure ML (Legacy). Legacy format should be used for models created before <span class="No-Break">January 2022.</span></li>
<li><strong class="bold">Endpoint Name</strong>: Identifier used for the endpoint <span class="No-Break">in Azure.</span></li>
<li><strong class="bold">Authentication</strong>: The Azure ML Endpoint Key obtained from the <span class="No-Break">Azure portal.</span></li>
<li><strong class="bold">Request</strong>: <strong class="bold">Web Service Input Name</strong> is the name of the JSON object expected by <span class="No-Break">the model.</span></li>
<li><strong class="bold">Response Table</strong>: Here, <strong class="bold">Name of Returned Table</strong> identifies the table returned by the model and <strong class="bold">Table Path</strong> can be used to specify the table using the <span class="No-Break">JMES path.</span></li>
<li><strong class="bold">Response Fields</strong>: Whether to load all fields. If this is not selected, you can specify the fields to be loaded using the <strong class="bold">Table </strong><span class="No-Break"><strong class="bold">Fields</strong></span><span class="No-Break"> selector.</span></li>
<li><strong class="bold">Association</strong>: A field<a id="_idIndexMarker325"/> containing a<a id="_idIndexMarker326"/> unique identifier. The result table will be associated with the source table using this information. This can be any field with a <span class="No-Break">unique ID.</span></li>
<li><strong class="bold">Name</strong>: <span class="No-Break">Connection name.</span></li>
</ul>
<h2 id="_idParaDest-81"><a id="_idTextAnchor081"/>Qlik AutoML connector</h2>
<p>Qlik AutoML is <a id="_idIndexMarker327"/>a machine learning environment<a id="_idIndexMarker328"/> in Qlik Cloud and has its own dedicated connection. We will take a closer look at AutoML and how to use it in <a href="B19863_08.xhtml#_idTextAnchor101"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>. The<a id="_idIndexMarker329"/> parameters for Qlik AutoML connector are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="bold">Connection</strong>: Name of the deployed <span class="No-Break">ML model.</span></li>
<li><strong class="bold">Response Table</strong>: <strong class="bold">Name of the Returned Table</strong> is the table returned by the model. You can also specify whether you would like to include SHAP values, the source dataset, and any errors in <span class="No-Break">the response.</span></li>
<li><strong class="bold">Association</strong>: A field containing a unique identifier. The result table will be associated with the source table using this information. This can be any field with a <span class="No-Break">unique ID.</span></li>
<li><strong class="bold">Name</strong>: <span class="No-Break">Connection name.</span></li>
</ul>
<p>We have now looked briefly at some of the parameters required by Advanced Analytics connections from Qlik Cloud to both third-party machine learning environments and Qlik AutoML. We will utilize some of these endpoints in later parts of <span class="No-Break">this book.</span></p>
<p class="callout-heading">Note</p>
<p class="callout">An interesting part of the analytics connector package are the OpenAI connector and Azure OpenAI connector. These connectors will provide a seamless integration into generative AI models. The principles of the connection are similar to the other analytics connections but there are an endless number of possibilities. In this chapter, we are not going deeper into setting up a connection, but you can find detailed instructions in the Qlik <span class="No-Break">help site.</span></p>
<h1 id="_idParaDest-82"><a id="_idTextAnchor082"/>Summary</h1>
<p>In this chapter, we started to move toward the practical implementation of machine learning models with Qlik. To prepare for the coming chapters, we installed <span class="No-Break">different environments.</span></p>
<p>First, we went through the installation of the R environment and the Advanced Analytics connection from a client-managed Qlik Sense instance in R. We covered the steps to run the components as a service and created a simple sample application to verify <span class="No-Break">the functionality.</span></p>
<p>We also installed a Python environment and connected that to our Qlik environment using Advanced Analytics Integration. We demonstrated the functionality of this environment using an example application. At the end of this chapter, we moved from on-premises into cloud environments and discovered how to create connections to external AI and machine learning platforms using REST. We also did a few setup steps for our AutoML environment to get it ready for our <span class="No-Break">coming chapters.</span></p>
<p>In the next chapter, we will investigate the data-modeling capabilities of Qlik Sense. We will learn how to create a data model, how to clean data, and how to analyze it. We will learn about different techniques and tools to be able to prepare a perfect dataset for our machine learning purposes. We will utilize the skills learned here throughout the next chapter when we start to implement and create actual machine <span class="No-Break">learning models.</span></p>
</div>
</div></body></html>