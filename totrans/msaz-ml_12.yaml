- en: Chapter 12. Case Study Exercise I
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第12章 案例研究练习I
- en: Now you already know a decent bit about Azure ML! It's time to use that knowledge
    to look at some real-world problems. You may not be able to solve them fully at
    this point, but you can certainly give it a try and come up with some kind of
    a working solution.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经对Azure ML有了相当的了解！是时候利用这些知识来研究一些现实世界的问题了。你可能现在还不能完全解决这些问题，但你可以尝试并提供某种形式的解决方案。
- en: In this chapter, we will present a problem in the form of a case study and will
    solve it with a very simple, but end-to-end solution. Like in other chapters so
    far, it won't present a step-by-step guide with all the details; however, it would
    just provide pointers for you to solve the problem. This chapter assumes that
    you have successfully completed reading all the previous chapters or already know
    about Azure ML.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将以案例研究的形式提出一个问题，并使用一个非常简单但端到端的方法来解决它。像之前的章节一样，它不会提供包含所有细节的逐步指南；然而，它只会为你提供解决问题的线索。本章假设你已经成功完成了所有前几章的阅读，或者已经了解Azure
    ML。
- en: Problem definition and scope
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题定义和范围
- en: If you are flying somewhere, it becomes a very bizarre experience if the flight
    gets delayed. We can't do much in that regard, but given the historical dataset,
    we can predict and know well ahead whether a particular flight will get delayed
    or not. That's the problem we will solve as a case study.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你正在飞往某个地方，如果航班延误，那将是一个非常奇怪的经历。我们在这方面无能为力，但鉴于历史数据集，我们可以预测并提前知道某个航班是否会延误。这就是我们将作为案例研究解决的问题。
- en: The complete solution to the problem of predicting a flight delay will be huge
    and is beyond the scope of this book because of the huge data crunching that it
    takes. However, we will limit the scope by limiting the dataset and simplifying
    the solution.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 预测航班延误问题的完整解决方案将非常庞大，由于需要大量数据处理，它超出了本书的范围。然而，我们将通过限制数据集和简化解决方案来缩小范围。
- en: The dataset
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据集
- en: We will use the sample dataset that comes by default in ML Studio. This is the
    subset of the passenger flight's on-time performance data taken from the **TranStats**
    data collection from **U.S. Department of Transportation** (**DOT**) ([http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time](http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time)).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用ML Studio默认提供的样本数据集。这是从**美国运输部**（**DOT**）的**TranStats**数据收集中提取的乘客航班准时性能数据的子集（[http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time](http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time)）。
- en: 'The dataset has been preprocessed and is filtered to include only the 70 busiest
    airports in the continental United States for the period between April 2013 to
    October 2013\. It contains the following columns:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 该数据集已经预处理并筛选，仅包括2013年4月至2013年10月期间美国大陆上最繁忙的70个机场。它包含以下列：
- en: '**Carrier**: This contains the code assigned by IATA and is commonly used to
    identify a carrier.'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Carrier**：这包含由IATA分配的代码，通常用于识别一个承运人。'
- en: '**OriginAirportID** (Origin Airport''s Airport ID): This is an identification
    number assigned by DOT to identify a unique airport.'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OriginAirportID**（出发机场的机场ID）：这是DOT分配的一个识别号，用于识别一个独特的机场。'
- en: '**DestAirportID** (Destination Airport;s Airport ID): This is an identification
    number assigned by DOT to identify a unique airport.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DestAirportID**（目的地机场的机场ID）：这是DOT分配的一个识别号，用于识别一个独特的机场。'
- en: '**CRSDepTime**: This is the scheduled departure time (local time in hh:mm).'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CRSDepTime**：这是预定出发时间（当地时间，格式为hh:mm）。'
- en: '**DepDelay**: This is the difference in minutes between the scheduled and the
    actual departure time. Early departures show negative numbers.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DepDelay**：这是预定出发时间和实际出发时间之间的分钟数差异。提前出发显示为负数。'
- en: '**DepDel15** (Departure Delay Indicator): This shows a delay in the departure
    of a flight by 15 minutes or more (here, 1=Yes).'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DepDel15**（出发延误指示器）：这表示航班延误15分钟或更长时间（在此处，1=是）。'
- en: '**CRSArrTime**: This is the scheduled arrival time (local time in hh:mm).'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CRSArrTime**：这是预定到达时间（当地时间，格式为hh:mm）。'
- en: '**ArrDelay**: This is the difference in minutes between the scheduled and the
    actual arrival time. Early arrivals show negative numbers.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ArrDelay**：这是预定到达时间和实际到达时间之间的分钟数差异。提前到达显示为负数。'
- en: '**ArrDel15** (Arrival Delay Indicator): This shows a delay in the arrival of
    a fight by 15 minutes or more (here, 1=Yes).'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ArrDel15**（到达延误指示器）：这表示航班延误15分钟或更长时间（在此处，1=是）。'
- en: '**Cancelled**: This is the cancelled flight indicator (here, 1=Yes).'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cancelled**：这是取消航班的指示符（在这里，1=是）。'
- en: Note
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that the cancelled flights have been considered as delayed and have been
    set as *ArrDel15 = 1*.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，已取消的航班已被视为延误，并设置为 *ArrDel15 = 1*。
- en: From our experience, we know that the flight timing often gets impacted by weather
    conditions, so it makes sense to collect and process the relevant weather data
    corresponding to the origin and destination airports. For simplicity, we will
    consider only the flights on time dataset here. However, you are encouraged to
    experiment and merge the weather dataset and prepare your dataset to build the
    model. There is a sample **Weather Dataset** that comes by default in ML Studio.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的经验，我们知道航班时间经常受到天气条件的影响，因此收集和处理与出发和目的地机场相关的相关天气数据是有意义的。为了简化，我们在这里只考虑准时到达的航班数据集。然而，我们鼓励您进行实验，合并天气数据集，并准备您的数据集以构建模型。ML
    Studio中默认包含一个**天气数据集**样本。
- en: Data exploration and preparation
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据探索和准备
- en: In your experiment, drag the **Flight Delays Data** sample dataset and click
    on the **Visualize** option to explore the dataset. You can find that some columns
    have lots of missing values. You can clean the missing data using a **Clean Missing
    Data** module by replacing it with **MICE** as the cleaning mode.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的实验中，拖动**Flight Delays Data**样本数据集，并点击**Visualize**选项来探索数据集。您会发现某些列有很多缺失值。您可以使用**Clean
    Missing Data**模块通过将其替换为**MICE**作为清理模式来清理缺失数据。
- en: There are certain columns, such as **DayOfWeek**, **OriginAirportID**, and **DestAirportID**
    which contain continuous numbers; however, they are categorical variables. So,
    use the **Metadata Editor** module to set them as **Categorical**.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些列，如**DayOfWeek**、**OriginAirportID**和**DestAirportID**包含连续数字；然而，它们是分类变量。因此，使用**Metadata
    Editor**模块将它们设置为**Categorical**。
- en: Feature selection
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征选择
- en: Before you start developing the model, it is important to select or generate
    a set of variables that have the most predictive power and remove any redundant
    and not so important features. In this case, all the data points are of the same
    year, so the year column is not required here. We are interested in predicting
    the delays before the journey starts, so the **DepDel15** and **DepDelay** columns
    are not important. Again, both the **ArrDelay** and **ArrDelay15** columns are
    about arrival delay. Here, we are just interested in whether the flight got delayed
    or not. So, **ArrDelay** is not required. All the cancelled flights are labeled
    as delayed, so the **Cancelled** column is also not required. You filter these
    columns using the **Project Columns** module and you will be left with the columns
    that contain the required features and label.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在您开始开发模型之前，选择或生成一组具有最大预测能力的变量，并删除任何冗余和不那么重要的特征是非常重要的。在这种情况下，所有数据点都是同一年份的，因此年份列在这里不是必需的。我们感兴趣的是预测旅程开始前的延误，因此**DepDel15**和**DepDelay**列不是重要的。同样，**ArrDelay**和**ArrDelay15**列都是关于到达延误的。在这里，我们只对航班是否延误感兴趣。所以，**ArrDelay**是不需要的。所有取消的航班都被标记为延误，因此**Cancelled**列也是不必要的。您可以使用**Project
    Columns**模块过滤这些列，剩下的将是包含所需特征和标签的列。
- en: Model development
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型开发
- en: You have to predict whether the flight would be delayed or not. As you found
    from the dataset, any flight delayed for more than 15 minutes has been labeled
    as delayed and the **ArrDelay15** corresponding label contains **1**. Here, the
    **ArrDelay15** column is the target variable and it only contains **0** and **1**.
    Clearly, it's a two-class classification problem.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您必须预测航班是否会延误。如您从数据集中发现的那样，任何延误超过15分钟的航班都被标记为延误，并且相应的**ArrDelay15**标签包含**1**。在这里，**ArrDelay15**列是目标变量，它只包含**0**和**1**。显然，这是一个二分类问题。
- en: 'As you have already explored, there are several two-class classification algorithms
    available in ML Studio. For simplicity, we would just build the model here with
    the **Two-Class Boosted Decision Tree** module with the following parameters:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所探索的那样，ML Studio中提供了几种二分类算法。为了简化，我们在这里将使用**Two-Class Boosted Decision Tree**模块构建模型，以下是一些参数：
- en: The **Maximum number of leaves per tree** option is set at **128**
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**每棵树的最大叶节点数**选项设置为**128**'
- en: The **Minimum number of samples per leaf node** option is set at **50**
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**每个叶节点所需的最小样本数**选项设置为**50**'
- en: The **Learning rate** option is set at **0.2**
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**学习率**选项设置为**0.2**'
- en: The **Number of trees constructed** option is set at **500**
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**构建的树的数量**选项设置为**500**'
- en: You are encouraged to try out different algorithms and also use the **Sweep
    Parameters** module to choose the optimum parameters.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 鼓励您尝试不同的算法，并使用**Sweep Parameters**模块来选择最佳参数。
- en: To train the model, you need to split the dataset and use one subset for training
    and other for scoring and evaluation.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 为了训练模型，您需要将数据集拆分，并使用一部分进行训练，另一部分用于评分和评估。
- en: 'Your experiment, after running successfully, may look something like the following:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 您的实验在成功运行后可能看起来如下所示：
- en: '![Model development](img/0792EN_12_01.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![模型开发](img/0792EN_12_01.jpg)'
- en: After you are happy with your experiment and satisfied with the trained model,
    you can proceed to deploy it by publishing it as a web service.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在您对实验满意且对训练模型满意后，您可以继续部署它，通过将其作为网络服务发布。
- en: Model deployment
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型部署
- en: 'Before publishing your model as a web service, create a scoring experiment
    and make sure that the **Web service input** and the **Web service output** modules
    are properly connected. Also, process the model if you want your output in a proper
    format, for example, outputting only the scored label and input to the score model
    may not contain the label column; in this case, you can also filter the **ArrDelay15**
    column along with the others in the **Project Columns** module connected to the
    **Score Model** module. Let''s take a look at the following screenshot:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在将您的模型作为网络服务发布之前，创建一个评分实验，并确保**Web服务输入**和**Web服务输出**模块已正确连接。如果您希望输出格式正确，例如，仅输出评分标签和输入到评分模型中可能不包含标签列；在这种情况下，您还可以在连接到**Score
    Model**模块的**Project Columns**模块中过滤**ArrDelay15**列以及其他列。让我们看一下以下截图：
- en: '![Model deployment](img/0792EN_12_02.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![模型部署](img/0792EN_12_02.jpg)'
- en: Then, publish your scoring experiment, so that it would be available as a web
    service in the staging environment. Test your web service visually and also with
    Excel. If you are good at programming, you're encouraged to test your web service
    by writing a small client program as well.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，发布您的评分实验，以便它可以在预发布环境中作为网络服务使用。通过视觉和Excel测试您的网络服务。如果您擅长编程，鼓励您通过编写一个小型客户端程序来测试您的网络服务。
- en: Summary
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: You just finished building a predictive solution in this case study. You started
    the chapter by defining and understanding the problem. You acquired the dataset,
    which in this case is the sample dataset available in ML Studio. Then, you proceeded
    to perform data exploration and preparation before building the predictive model.
    You used the boosted decision tree to build the model. After running the experiment
    successfully, you created a scoring experiment and used a saved trained model
    in it. Finally, you published the experiment as a web service and tested it.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经在这个案例研究中完成了预测解决方案的构建。您从定义和理解问题开始本章。您获取了数据集，在这个案例中是ML Studio中可用的样本数据集。然后，您继续进行数据探索和准备，在构建预测模型之前。您使用了提升决策树来构建模型。在实验成功运行后，您创建了一个评分实验，并在其中使用了保存的训练模型。最后，您将实验作为网络服务发布并进行了测试。
- en: In the next chapter, you are going to learn to build your own models, with another
    case study where you would solve a regression problem.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，您将学习如何构建自己的模型，其中包含另一个案例研究，您将解决一个回归问题。
