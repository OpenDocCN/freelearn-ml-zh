<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Visualizing Data in Diagrams, Histograms, and Maps</h1>
                </header>
            
            <article>
                
<p><span>If we are talking about machine learning, why should we care about visualization? The answer is simple: if you cannot show what you have analyzed and the outcome of your models to somebody without any technical knowledge, then you will not be able to show any added value. We have already shown how important data visualization is for understanding a dataset and to decide which features will be most useful for training our model. We are now going to investigate which type of diagram is best suited to tell the story of our data and the new information we got from it.</span></p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>Showing basic comparisons and relationships between variables</li>
<li>Building data distributions using histograms</li>
<li>Representing geographical distribution of data in maps</li>
<li>Showing data that changes over time</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>To complete this chapter, the reader will need to download the <span><kbd>1976USpresident.xlsx</kbd> and <kbd>subte.xlsx</kbd></span> <span>files</span> from the GitHub repository at <a href="https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter08">https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-Microsoft-Excel-2019/tree/master/Chapter08</a>.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Showing basic comparisons and relationships between variables</h1>
                </header>
            
            <article>
                
<p>Data visualization is extremely important in the context of data analytics and machine learning. Some of the reasons for this are as follows:</p>
<ul>
<li>Tell the story of your data and help decision makers with their job.</li>
<li>Predict the future evolution of some variable(s).</li>
<li>Find hidden trends and patterns in the data.</li>
<li>Find outliers, that is, anomalies in the data.</li>
<li>Understand the distribution, composition, and relationships.</li>
<li>Build groups and categories.</li>
</ul>
<p>We will show different types of charts used to show different types of data. The data used in the example charts is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td><strong>Year</strong></td>
<td><strong>Sales</strong></td>
<td><strong>Cost</strong></td>
<td><strong>Profit</strong></td>
<td><strong>ROI</strong></td>
</tr>
<tr>
<td class="CDPAlignLeft CDPAlign">2015</td>
<td class="CDPAlignLeft CDPAlign">23455</td>
<td class="CDPAlignLeft CDPAlign">18294.9</td>
<td class="CDPAlignLeft CDPAlign">5160.1</td>
<td class="CDPAlignLeft CDPAlign">28.21%</td>
</tr>
<tr>
<td class="CDPAlignLeft CDPAlign">2016</td>
<td class="CDPAlignLeft CDPAlign">19226</td>
<td class="CDPAlignLeft CDPAlign">12881.42</td>
<td class="CDPAlignLeft CDPAlign">6344.58</td>
<td class="CDPAlignLeft CDPAlign">49.25%</td>
</tr>
<tr>
<td class="CDPAlignLeft CDPAlign">2017</td>
<td class="CDPAlignLeft CDPAlign">34557</td>
<td class="CDPAlignLeft CDPAlign">24881.04</td>
<td class="CDPAlignLeft CDPAlign">9675.96</td>
<td class="CDPAlignLeft CDPAlign">38.89%</td>
</tr>
<tr>
<td class="CDPAlignLeft CDPAlign">2018</td>
<td class="CDPAlignLeft CDPAlign">20134</td>
<td class="CDPAlignLeft CDPAlign">14697.82</td>
<td class="CDPAlignLeft CDPAlign">5436.18</td>
<td class="CDPAlignLeft CDPAlign">36.99%</td>
</tr>
<tr>
<td class="CDPAlignLeft CDPAlign">2019</td>
<td class="CDPAlignLeft CDPAlign">22314</td>
<td class="CDPAlignLeft CDPAlign">14057.82</td>
<td class="CDPAlignLeft CDPAlign">8256.18</td>
<td class="CDPAlignLeft CDPAlign">58.73%</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Also consider the following data:</p>
<p class="mce-root">&lt;td"&gt;20134</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Year</strong></p>
</td>
<td>
<p><strong>SalesA</strong></p>
</td>
<td>
<p><strong>CostA</strong></p>
</td>
<td>
<p><strong>ProfitA</strong></p>
</td>
<td>
<p><strong>SalesB</strong></p>
</td>
<td>
<p><strong>CostB</strong></p>
</td>
<td>
<p><strong>ProfitB</strong></p>
</td>
</tr>
<tr>
<td>
<p>2015</p>
</td>
<td>
<p>23455</p>
</td>
<td>
<p>18294.9</p>
</td>
<td>
<p>5160.1</p>
</td>
<td>
<p>23455</p>
</td>
<td>
<p>18294.9</p>
</td>
<td>
<p>5160.1</p>
</td>
</tr>
<tr>
<td>
<p>2016</p>
</td>
<td>
<p>19226</p>
</td>
<td>
<p>12881.42</p>
</td>
<td>
<p>6344.58</p>
</td>
<td>
<p>19226</p>
</td>
<td>
<p>12881.42</p>
</td>
<td>
<p>6344.58</p>
</td>
</tr>
<tr>
<td>
<p>2017</p>
</td>
<td>
<p>34557</p>
</td>
<td>
<p>24881.04</p>
</td>
<td>
<p>9675.96</p>
</td>
<td>
<p>34557</p>
</td>
<td>
<p>24881.04</p>
</td>
<td>
<p>9675.96</p>
</td>
</tr>
<tr>
<td>
<p>2018</p>
</td>
<td>
<p>20134</p>
</td>
<td>
<p>14697.82</p>
</td>
<td>
<p>5436.18</p>
</td>
<td>
<p>14697.82</p>
</td>
<td>
<p>5436.18</p>
</td>
</tr>
<tr>
<td>
<p>2019</p>
</td>
<td>
<p>22314</p>
</td>
<td>
<p>14057.82</p>
</td>
<td>
<p>8256.18</p>
</td>
<td>
<p>22314</p>
</td>
<td>
<p>14057.82</p>
</td>
<td>
<p>8256.18</p>
</td>
</tr>
</tbody>
</table>
<p>Type this data into an Excel worksheet so that you can create the charts shown in the following sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The basic parts of an Excel diagram</h1>
                </header>
            
            <article>
                
<p class="mce-root">An Excel chart has different parts and it is important to know their names so that we can modify the chart at will. The following chart shows them in <span>detail:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b2057b21-6468-496e-83da-5fd7ce1ca045.png" style="width:31.42em;height:21.50em;"/></p>
<p>The <em>x</em> axis represents the data categories and the <em>y</em> axis the data series.</p>
<div class="packt_tip">All charts shown in the following subsections can be created by selecting the data range and navigating to <span class="packt_screen">Insert</span> | <span class="packt_screen">Recommended Charts</span>. There, we see previews and select the one that better tells the story of our data.</div>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Column charts</h1>
                </header>
            
            <article>
                
<p>Clustered column charts can be used when you want to show between two and four different data series in the same chart. To plot only one series does not make sense, and more than four might look cluttered. Look at the following example:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5e0a8d62-948f-49fa-8ad4-f4958504efe5.png" style="width:27.92em;height:16.58em;"/></p>
<p>In this case, it certainly looks better if we split the data, for example, to show a smaller group of years and to switch the time series and categories (see the following chart):</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c127445c-8054-4726-8099-ac04f9ac4a48.png" style="width:29.08em;height:17.33em;"/></p>
<p>The series in the column charts should be expressed in the same units, otherwise they cannot be compared, or their comparison might be misguiding.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Combination charts</h1>
                </header>
            
            <article>
                
<p>If we need to show data series expressed in different units, we can use combination charts. The basic difference is that these charts have two vertical axes with different units of measurement. The following chart shows an example of this:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e7543c24-c99a-467f-b551-4b18091c506d.png" style="width:27.25em;height:16.42em;"/></p>
<p>In this case, the primary vertical axis (left) is expressed in currency units and the secondary vertical axis in percentages.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Stacked charts</h1>
                </header>
            
            <article>
                
<p>This type of chart is used when it is important to point out the importance of the relative values in the data series. For example, <em>Cost + Profit = Sales</em>. We can see that it is easy to compare the values at first sight, as in the following chart:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e85785d6-8cd8-4b15-ab67-498182a544b7.png" style="width:27.75em;height:16.67em;"/></p>
<p>This chart can be created by first including the <strong><span class="packt_screen">Cost</span></strong> and <strong><span class="packt_screen">Profit</span></strong> variables and then adding <strong><span class="packt_screen">Sales</span></strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Pie and bar charts</h1>
                </header>
            
            <article>
                
<p>A pie chart is useful to compare many series. As an example we will use the results of the 2016 US President Election in the state of Oregon, listed in the following table:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Candidate</strong></p>
</td>
<td>
<p><strong>Votes</strong></p>
</td>
</tr>
<tr>
<td>
<p>Clinton, Hillary</p>
</td>
<td>
<p>1,002,106</p>
</td>
</tr>
<tr>
<td>
<p>Trump, Donald J.</p>
</td>
<td>
<p>782,403</p>
</td>
</tr>
<tr>
<td>
<p>Johnson, Gary</p>
</td>
<td>
<p>94,231</p>
</td>
</tr>
<tr>
<td>
<p>Other</p>
</td>
<td>
<p>72,594</p>
</td>
</tr>
<tr>
<td>
<p>Stein, Jill</p>
</td>
<td>
<p>50,002</p>
</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The resulting pie chart is as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9fd014e6-3538-4471-aa52-9c4f31b8aa95.png" style="width:32.25em;height:20.50em;"/></p>
<p>The same results can be shown in a bar chart, and the differences in the number of votes are easier to compare.</p>
<div class="packt_tip">Change the chart type to a bar chart by right-clicking on any part of the diagram.</div>
<p>The bar chart will look similar to the following:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/6f8bf82a-45a4-4b35-8dc1-c0832c583ece.png" style="width:35.25em;height:17.08em;"/></p>
<p>We know now how to choose the best diagrams for each type of data. In the following section, we will study one of the most important and most often used diagrams when previewing data using histograms.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building data distributions using histograms</h1>
                </header>
            
            <article>
                
<p class="mce-root">We used histograms in <a href="0da64bd8-0bc9-491b-875c-7ec7c35c6165.xhtml">Chapter 5</a>, <em>Correlations and the Importance of Variables</em>, without formally introducing them. This type of chart shows the count of values, either numerical or categorical. To show numerical data, we can build categories, as we did with the age of the Titanic passengers:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d5498252-31dc-431f-b6cf-9e003a9b3fe4.png" style="width:29.17em;height:17.83em;"/></p>
<p>Or, we could have used the age variable as a number and distributed the values in bins (groups of data points falling between the same numerical range):</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/dec739e7-a32f-458b-a2cc-2d2218a0aca6.png" style="width:29.92em;height:17.50em;"/></p>
<p>The preceding histogram was created following these steps:</p>
<ol>
<li>Navigate to <span class="packt_screen">Insert</span> | <span class="packt_screen">Histogram.</span></li>
<li>Double-click the <em>x</em> axis to set the number of bins to <kbd>15</kbd>.</li>
</ol>
<p>We can immediately see a large amount of entries in the first bin corresponding to the missing age values, which we defined as <kbd>-1</kbd> to identify them easily. We also notice that the larger number of passengers were between 20 and 26 years old and that the distribution is not symmetrical; it seems to show an exponential decay toward older ages and a much faster decrease in younger ones. This can be interpreted by thinking about the fact that not many small children travelled in a transatlantic ship (at least at the time of the Titanic sinking).</p>
<p>You will also notice that histograms are an excellent graphical method for spotting <strong>outliers</strong><em>;</em> that is, data points that do not follow the same distribution as the rest. In our current example, missing values are also outliers.</p>
<p>Another useful application of histograms is in comparing values when there are a large number of items to compare. Let's suppose that we made a prediction using a machine learning model. We are predicting a numerical value and we want to compare it with the real one to test our model. We can then, for each set of feature values, plot the difference between the real and predicted values. If our model is a good predictor, we should see something like the following chart:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1954a396-c53f-4c9f-bd01-3b44388b24ba.png" style="width:30.75em;height:18.00em;"/></p>
<p>The distribution is centered at <strong>0</strong> and is mostly symmetrical, with a few large values toward the right. These are, obviously, bad predictions.</p>
<p>We have seen that histograms are a valuable tool for identifying different characteristics of the datasets. Let's concentrate now on more complex data representations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Representing geographical distribution of data in maps</h1>
                </header>
            
            <article>
                
<p>Localizing information in a map is extremely useful to understand data in the spatial dimension, which is often difficult by other means. Excel offers different options and we are going to show a couple of them. We will start by using data containing geographical coordinates, that is, latitude and longitude. The widespread use of the GPS system nowadays makes it easy to obtain this information. In any case, if this precise information is not available, we will see that the built-in information in Excel will still make it simple to draw maps and show us useful information.</p>
<p>In our first example, we will use data from the <em><span>Massachusetts Institute of Technology</span> <span>Election Data and Science Lab</span></em> <span>about the 1976 US presidential election. The</span> <kbd>1976USpresident.xlsx</kbd> file <span>contains, among other information, the list of US states and the vote count for each presidential candidate. We would like to put this information in a map, resembling those shown in the news with Republican states colored in red and Democrat states colored in blue.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p>The input data table is the following:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/df484c6a-3796-4d6a-bb51-041858bba131.png"/></p>
<p>From this table, we need to extract the winner party in each state, namely the one with more votes. We will use <span class="packt_screen">Power Query</span> and its <span class="packt_screen">Group By</span> function.</p>
<ol>
<li>Navigate to <span class="packt_screen">Data</span> | <span class="packt_screen">From Table/Range</span>.</li>
<li>Open the <span class="packt_screen">Power Query</span> window. You should see something similar to the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/fff0bfff-155b-48b5-b9ee-86b68df4bb36.png"/></p>
<ol start="3">
<li>Select <span class="packt_screen">Group By</span> | <span class="packt_screen">Advanced</span> then select <span class="packt_screen">state</span> for the <span class="packt_screen">Group by</span> option.</li>
<li>Then, we will add a new column called <kbd>Winner</kbd>, where we will <span class="packt_screen">Sum</span> <span>the values of</span> <span class="packt_screen">party</span><em>.</em> <span>This will give an error, but will give us the base function to get the winner party name later.</span></li>
<li><span>The second column we will add is named</span> <kbd>Votes</kbd>, <span>where we select the maximum value of</span> <span class="packt_screen">candidatevotes</span><em>.</em> <span>This will show the larger number of votes in each state.</span></li>
</ol>
<p style="padding-left: 60px">The following screenshot shows how the window should look like after selecting the detailed options:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/815bad01-3b77-4ceb-88ca-8701aa8b1aa0.png" style="width:33.67em;height:21.08em;"/></p>
<p style="padding-left: 60px">After clicking <span class="packt_screen">OK</span>, the resulting table is as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c5f0dc79-21fd-4639-863b-74cdd8c4eb12.png" style="width:67.08em;height:19.50em;"/></p>
<ol start="6">
<li>To fix the error and get the party name in the <kbd>Winner</kbd> column, we replace the function:</li>
</ol>
<p style="padding-left: 90px"><span><em>= Table.Group(#"Changed Type", {"state"}, {{"Winner", each List.<strong>Sum</strong>([party]), type text}, {"Votes", each List.Max([candidatevotes]), type number}})</em></span></p>
<p style="padding-left: 60px">We replace the preceding function with the following:</p>
<p style="padding-left: 90px"><em><span>= Table.Group(#"Changed Type", {"state"}, {{"Winner", each List.<strong>First</strong>([party]), type text}, {"Votes", each List.Max([candidatevotes]), type number}})</span></em></p>
<p class="mce-root"/>
<p style="padding-left: 60px">This will show the winning party, like in the following table:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b83d7488-698f-4d30-bf6d-9951dff8fbca.png" style="width:55.92em;height:18.92em;"/></p>
<ol start="7">
<li>Click on <span class="packt_screen">Close &amp; Load</span>.</li>
<li>Use the generated table to create the map. Select any cell in the table and then navigate to <span class="packt_screen">Insert</span> | <span class="packt_screen">Recommended Charts</span>. <span>The first suggestion will be a map like the one we want.</span></li>
<li><span>Click <span class="packt_screen">OK</span></span>.</li>
<li><span>Change the title and colors by double-clicking on the legends.</span> The resulting map is as follows:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/57061ee7-e0e1-41b2-945f-e9fbcb2a1b55.png" style="width:30.08em;height:18.25em;"/></p>
<p>Our second example will use data from the Argentinean Government public database (<kbd>datos.gob.ar</kbd>). The latitude and longitude of all underground stations in Buenos Aires is listed, together with their names and the lines they belong to.</p>
<p>The nickname of the Buenos Aires underground is <strong>Subte</strong>, a short form of the word <strong>subterrÃ¡neo (underground)</strong>, hence the name of the file.</p>
<p>Geographical coordinates are not accepted as input in regular Excel maps, so we are going to show the 3D Maps functions, which also has other advantages.</p>
<p class="mce-root">Perform the following steps:</p>
<ol>
<li class="mce-root">Load the <span><kbd>subte.xlsx</kbd> file and you will see</span> the following table (partially shown):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/bb3568c2-34a3-4a4a-ae2f-40a5657216d9.png" style="width:22.58em;height:23.25em;"/></p>
<ol start="2">
<li>Select the full data range.</li>
<li>Navigate to <span class="packt_screen">Insert</span> | <span class="packt_screen">3D Map</span>. You should see something similar to the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/3b45695a-6cad-47c2-9986-33c67434dde0.png" style="width:57.17em;height:12.58em;"/></p>
<div class="packt_tip">Should the icon be greyed out, refer linkÂ <a href="https://support.office.com/en-ie/article/get-started-with-3d-maps-6b56a50d-3c3e-4a9e-a527-eea62a387030">https://support.office.com/en-ie/article/get-started-with-3d-maps-6b56a50d-3c3e-4a9e-a527-eea62a387030</a>Â for step-by-step instructions to activate 3D Maps.</div>
<ol start="4">
<li>Click on <span class="packt_screen">New tour</span> as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/7128a2d2-75a5-48a5-bb7e-b357995dfbac.png" style="width:15.08em;height:15.83em;"/></p>
<p style="padding-left: 60px">The 3D Maps window will open, showing the default view of Earth, as seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/a465bb88-e5dc-463a-9120-e85e3ea64955.png" style="width:54.50em;height:29.25em;"/></p>
<p class="mce-root"/>
<ol start="5">
<li>Add two fields to the <span class="packt_screen">Location</span> window: <kbd>Long</kbd> and <kbd>Lat</kbd>. They should be automatically assigned to the corresponding variables. If not, select them from the menu to the right of the names (see the following screenshot).</li>
<li>The map should now be centered in the city of Buenos Aires, but the zoom might still be too far out.</li>
<li>Zoom in by scrolling with your mouse or using the <span class="packt_screen">+</span> button.</li>
<li>In the <span class="packt_screen">Category</span> field, add <span class="packt_screen">Line</span>, <span>since we want to distinguish between the different groups of stations.</span></li>
<li><span>The map will look similar to this screenshot:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d752667f-0273-4c09-9c0a-f2b01ccacf06.png" style="width:54.33em;height:27.92em;"/></p>
<p>Let's improve it a little. Instead of those large columns representing each station, we want small symbols. To achieve this, perform the following steps:</p>
<ol start="1">
<li>Click on <span class="packt_screen">Layer Options.</span></li>
<li>Set <span class="packt_screen">Height</span> to <span class="packt_screen">0%</span> and <span class="packt_screen">Thickness</span> to between <span class="packt_screen">50%</span> and <span class="packt_screen">70%</span>.</li>
<li>You can also change the color for each line (category). As in many other cities, the Subte lines are identified by colors. <span class="packt_screen">A</span> is light blue, <span class="packt_screen">B</span> is red, <span class="packt_screen">C</span> is blue, <span class="packt_screen">D</span> is green, <span class="packt_screen">E</span> is purple, and <span class="packt_screen">H</span> is yellow (what happened to <span class="packt_screen">F</span> and <span class="packt_screen">G</span>? They, and <span class="packt_screen">I</span>, are not yet built). The final result is shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/49ffe5e5-ee94-42dc-ab83-a3df9f852421.png" style="width:55.42em;height:29.92em;"/></p>
<p class="mce-root">One last thing we can do, since 3D Maps can be used interactively, is to add useful information to the data card (or tool tip, as it is usually called in visualizations). To do this, perform the following steps:</p>
<ol>
<li class="mce-root">Click on the <span class="packt_screen">Customize</span> button (below <span class="packt_screen">Data Card</span>) and you can see that, by default, the three variables included so far are there (see the following sample screenshot):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8320b081-90ed-4d16-94db-647a3c3ab8be.png" style="width:29.58em;height:18.75em;"/></p>
<ol start="2">
<li>Delete <span class="packt_screen">Lat</span> and <span class="packt_screen">Long</span> by clicking on the red X.</li>
<li>Add <span class="packt_screen">Station</span>.</li>
</ol>
<p>After this, if we move the mouse over any of the symbols representing the underground stations, we will see its name and the line it belongs to, like in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ba7d6320-53cc-4f20-8142-c9f40d5f44b1.png" style="width:55.00em;height:29.67em;"/></p>
<p>We now know how to use Excel to usefully represent geographical data, using both the names of places or GPS coordinates.</p>
<p class="CDPAlignLeft CDPAlign">In our last example, we will revisit time series to show the different ways of representing them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Showing data that changes over time</h1>
                </header>
            
            <article>
                
<p>In previous chapters, we analyzed time series in detail. We mainly used line charts to represent the evolution of the data. Can time evolution be represented in a different way? We know from experience that lines can be misguiding when we want to compare two values, and that other methods are better.</p>
<p>Going back to the US election data, suppose we want to compare the time evolution of the two major parties, Democrat and Republican, in one state, over several years. Perform the following steps:</p>
<ol>
<li>Load the <span><kbd>1976_2016USpresident.xlsx</kbd> file in Excel and you will see the same information in the table that we used in the previous section, except that we can now see the results corresponding to every election in every state from 1976 to 2016.</span></li>
<li><span>Select one state at random (California, in our case) and try to compare how the number of votes per party changed with time.</span></li>
<li>Navigate to <span class="packt_screen">Data</span> | <span class="packt_screen">From Table/Range</span>.</li>
<li><span>In the</span> <span class="packt_screen">Power Query</span> <span>window, click on</span> <span class="packt_screen">Choose Columns</span>.</li>
<li><span>Select only the columns we are interested in: <kbd>year</kbd>, <kbd>state</kbd>, <kbd>party</kbd>, <kbd>candidatevotes</kbd>, and <kbd>totalvotes</kbd>, as shown in the following screenshot:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c6fd352a-ba0b-40e7-bc77-a2b3d714bcad.png" style="width:18.83em;height:30.42em;"/></p>
<ol start="6">
<li>Add a new column by clicking on <span class="packt_screen">Add Column</span> | <span class="packt_screen">Custom Column</span> to calculate the percentage of votes by party, that is, <em>[candidatevotes]/[totalvotes]</em>.</li>
<li>Change the type of that column to <span class="packt_screen">Percentage</span> (in <span class="packt_screen">Home</span> | <span class="packt_screen">Data Type</span>). The result is similar to what is shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ed4b2186-c245-4085-9912-724b589af8ed.png" style="width:59.25em;height:22.75em;"/></p>
<ol start="8">
<li>Filter the rows to leave only <kbd>state</kbd> as <kbd>California</kbd> and <kbd>party</kbd> as <kbd>republican</kbd> or <kbd>democrat</kbd>.</li>
</ol>
<p>We need to format the table in such a way that we can compare both time series in a meaningful way. To do this, perform the following steps:</p>
<ol>
<li>Select the <kbd>party</kbd> column.</li>
<li><span>Navigate to</span> <span class="packt_screen">Transform.</span></li>
<li><span>Click on</span> <span class="packt_screen">Pivot Column</span>. <span>The pop-up window should look like the following screenshot before clicking <span class="packt_screen">OK</span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/16c9fe33-0ecf-4780-bd78-cf4fb95364d2.png" style="width:24.83em;height:16.92em;"/></p>
<p style="padding-left: 60px">The result is the following table:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/71deb815-90bc-4534-91a9-2bc620b90a55.png"/></p>
<p class="mce-root"/>
<p class="mce-root">We will now repeat some steps that we have used before, so I will explain them quickly:</p>
<ol>
<li class="mce-root">Select both <kbd>%</kbd> columns.</li>
<li class="mce-root">Navigate to <span class="packt_screen">Transform</span> | <span class="packt_screen">Replace Values.</span></li>
<li class="mce-root">Change all <kbd>nulls</kbd> to zeroes.</li>
<li class="mce-root">Use <span class="packt_screen">Home</span> | <span class="packt_screen">Group By</span> to group by state.</li>
<li class="mce-root">Select <span class="packt_screen">Sum</span> as aggregation.</li>
<li class="mce-root">The last step would be to create another column to account for the difference between the percentage of Democrat and Republican votes and the total:</li>
</ol>
<p style="padding-left: 90px" class="CDPAlignLeft CDPAlign"><em>100%- % republican -% democrat</em></p>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign">This will give us the percentage of votes going to other parties. The table we will use to create the diagram is as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ce0aa87f-4f2c-4179-89e3-a9f532a67d4e.png" style="width:28.17em;height:14.83em;"/></p>
<ol start="7">
<li>Click on any cell in the chart.</li>
<li>Navigate to <span class="packt_screen">Insert</span> | <span class="packt_screen">Recommended Charts.</span></li>
<li>Choose <span class="packt_screen"><span class="packt_screen">Stacked Bars.</span></span></li>
</ol>
<p style="padding-left: 60px">The result will be something similar to the following diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/77ce6480-6b90-4c08-9fdd-872eab45712e.png" style="width:26.25em;height:15.83em;"/></p>
<p>It is clear that this type of chart is better for comparing the amount of votes obtained by each party and other details of the data. For example, we immediately see that, in 1992, both parties, but especially Republican, lost votes to other, non-traditional parties.</p>
<div class="packt_tip">Hint: search for <kbd>Ross Perot</kbd> in Google.</div>
<p>We have shown there are other ways of showing the information contained in a time series beyond the line charts. You can now experiment with other types of charts, depending on the information you need to display.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>We have discussed different types of diagrams in Excel, which can be used to compare variables and show data in meaningful ways, helping us to extract value from our results.</p>
<p>We can now go back to the pure machine learning models and take a leap forward to the advanced world of neural networks.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>What types of data can be represented in charts? Make a list and think about the best charts to use in each case.</li>
<li>What happens when you try to use a pie chart to show more than five or six data series?</li>
<li>What type of chart would be a good alternative to stacked bars?</li>
<li>Try using other geographical data (for example, street addresses) to create a diagram.</li>
<li>Can you use the US President election data to predict the results for 2020? In principle, it should be possible to forecast the values of the time series. Try it and think about the accuracy of the predictions and the possible explanations.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<ul>
<li><em>The Visual Display of Quantitative Information</em>, by Edward R.Tufte</li>
<li><em>Storytelling with Data: A Data Visualization Guide for Business Professionals</em>, by Cole Nussbaumer Knaflic</li>
</ul>


            </article>

            
        </section>
    </body></html>