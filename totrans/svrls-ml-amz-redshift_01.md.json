["```py\nSELECT eventname, total_price\nFROM  (SELECT eventid, total_price, ntile(1000) over(order by total_price desc) as percentile\n       FROM (SELECT eventid, sum(pricepaid) total_price\n             FROM   tickit.sales\n             GROUP BY eventid)) Q, tickit.event E\n       WHERE Q.eventid = E.eventid\n       AND percentile = 1\nORDER BY total_price desc\nlimit 10;\n```"]