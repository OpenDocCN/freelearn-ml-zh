- en: Chapter 2. Build Your First Recommendation Engine
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章. 构建你的第一个推荐引擎
- en: In the previous chapter, we had an introduction to various types of recommendation
    engines, which we will be building in the subsequent chapters. Now that we have
    got introduced to recommendation engines, let's build our first recommendation
    engine using R.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了各种类型的推荐引擎，这些推荐引擎将在后续章节中构建。现在我们已经了解了推荐引擎，让我们使用R构建我们的第一个推荐引擎。
- en: Before we proceed further for implementation, let's have a brief discussion
    about the required software and packages for building our first recommendation
    using R.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进一步进行实现之前，让我们简要讨论一下构建我们第一个R推荐引擎所需的软件和包。
- en: For this exercise, we have used the R 3.2.2 version and RStudio 0.99 or above.
    For installation and setup of R and RStudio, please refer to the software and
    hardware list section of the book.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个练习，我们使用了R 3.2.2版本和RStudio 0.99或更高版本。有关R和RStudio的安装和设置，请参阅书籍中的软件和硬件列表部分。
- en: 'The R packages we have used for this exercise are as follows:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这个练习中使用的R包如下：
- en: '`dplyr`'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dplyr`'
- en: '`data.table`'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`data.table`'
- en: '`reshape2`'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`reshape2`'
- en: 'Installing a R package is given by the following codes:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 安装R包的代码如下：
- en: '[PRE0]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'For offline installation, first download the required `gz` file from CRAN Repository
    to a local folder, and then execute the following code:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对于离线安装，首先从CRAN仓库下载所需的`gz`文件到本地文件夹，然后执行以下代码：
- en: '[PRE1]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The recommendation engine we are going to build is based on the collaborative
    filtering approach. As explained in [Chapter 1](part0014.xhtml#aid-DB7S1 "Chapter 1. Introduction
    to Recommendation Engines"), *Introduction to Recommendation Engines*, is based
    on the user''s neighbourhood, as explained in the following figure:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要构建的推荐引擎基于协同过滤方法。正如在[第一章](part0014.xhtml#aid-DB7S1 "第一章. 推荐引擎简介")中解释的，*推荐引擎简介*基于用户的邻域，如下图中所示：
- en: '![Build Your First Recommendation Engine](img/image00213.jpeg)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![构建你的第一个推荐引擎](img/image00213.jpeg)'
- en: Building our basic recommendation engine
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建我们的基本推荐引擎
- en: 'The steps to build our basic recommendation engine are as follows:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 构建我们的基本推荐引擎的步骤如下：
- en: Loading and formatting data.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载和格式化数据。
- en: Calculating similarity between users.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算用户之间的相似度。
- en: Predicting the unknown ratings for users.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 预测用户未知的评分。
- en: Recommending items to users based on user-similarity score.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据用户相似度评分向用户推荐项目。
- en: 'These steps can be seen in the following diagram:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 这些步骤可以在以下图中看到：
- en: '![Building our basic recommendation engine](img/image00214.jpeg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![构建我们的基本推荐引擎](img/image00214.jpeg)'
- en: Loading and formatting data
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载和格式化数据
- en: The dataset used for this chapter can be downloaded from [https://raw.githubusercontent.com/sureshgorakala/RecommenderSystems_R/master/movie_rating.csv](https://raw.githubusercontent.com/sureshgorakala/RecommenderSystems_R/master/movie_rating.csv).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 用于本章的数据集可以从[https://raw.githubusercontent.com/sureshgorakala/RecommenderSystems_R/master/movie_rating.csv](https://raw.githubusercontent.com/sureshgorakala/RecommenderSystems_R/master/movie_rating.csv)下载。
- en: 'The dataset chosen for the chapter is a movie-rating dataset containing ratings
    for six movies given by six users on a scale of 0 to 5:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 本章选择的数据集是一个包含六个用户对六部电影评分（评分范围为0到5，以5为步长）的电影评分数据集：
- en: '![Loading and formatting data](img/image00215.jpeg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![加载和格式化数据](img/image00215.jpeg)'
- en: Before we load the data, let me explain a few things about the data. The dataset
    chosen is a comma-separated file having movie ratings from 1 to 5 in steps of
    5 given by six users on six movies. Not all critics have rated all the titles
    in the dataset.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们加载数据之前，让我解释一下关于数据的一些事情。选择的数据集是一个逗号分隔的文件，包含六个用户对六部电影从1到5的评分（以5为步长）。并非所有评论家都对该数据集中的所有标题进行了评分。
- en: Our objective is to build a recommendation engine that recommends unknown movies
    to users based on the ratings of similar users.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是构建一个推荐引擎，根据相似用户的评分向用户推荐未知电影。
- en: 'Loading the data from a `csv` file in R is given by `read.csv()`:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 从R中的`csv`文件加载数据的代码是`read.csv()`：
- en: '[PRE2]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The first six rows of the data can be viewed using `head()`, an inbuilt function
    in R:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 使用R中的内置函数`head()`可以查看数据的前六行：
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![Loading and formatting data](img/image00216.jpeg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![加载和格式化数据](img/image00216.jpeg)'
- en: 'To see the dimensions of the dataset, we use `dim()`, an inbuilt function in
    R:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看数据集的维度，我们使用R中的内置函数`dim()`：
- en: '[PRE4]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To see the structure of the input data, we may use the `str()` function in
    R, as follows:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看输入数据的结构，我们可以在R中使用`str()`函数，如下所示：
- en: '[PRE5]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![Loading and formatting data](img/image00217.jpeg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![加载和格式化数据](img/image00217.jpeg)'
- en: We see that we have a dataset containing 31 observations and three variables
    such as critic, title, and rating. Also, we see that six critics have rated six
    movies. The ratings are between 1 and 5.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，我们有一个包含31个观测值和三个变量（如评论、标题和评分）的数据集。此外，我们还看到有六位评论家对六部电影进行了评分。评分介于1到5之间。
- en: 'To see the levels of the attributes of a variable, we use `levels()` in R:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看变量的属性级别，我们使用R中的`levels()`：
- en: '![Loading and formatting data](img/image00218.jpeg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![加载和格式化数据](img/image00218.jpeg)'
- en: To build a recommender system, we would be requiring a matrix where rows contain
    users, columns contain items, and the cells contain the ratings given by users
    to the items.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 要构建推荐系统，我们需要一个矩阵，其中行包含用户，列包含项目，单元格包含用户对项目的评分。
- en: The next step is to arrange the data in a format that is useful to build the
    recommendation engine. The current data contains a row containing critic, title,
    and rating. This has to be converted to matrix format containing critics as rows,
    title as columns, and ratings as the cell values.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是将数据排列成对构建推荐引擎有用的格式。当前数据包含一行，包含评论家、标题和评分。这必须转换为包含评论家作为行、标题作为列和评分作为单元格值的矩阵格式。
- en: The following code helps us achieve this. We use the `acast()` function available
    in `reshape2` package. The `reshape2` package is a R package popularly used for
    restructuring data. The `acast()` function in `reshape2` package casts a data
    frame to matrix representation.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码帮助我们实现这一点。我们使用`acast()`函数，该函数在`reshape2`包中可用。`reshape2`包是一个流行的R包，用于重构数据。`reshape2`包中的`acast()`函数将数据框转换为矩阵表示。
- en: The `cast` function takes the ratings dataset as input, `title` as row attribute,
    `critic` as column attribute, and `rating` as value.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '`cast`函数接受评分数据集作为输入，`title`作为行属性，`critic`作为列属性，`rating`作为值。'
- en: '[PRE6]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The transformed data can be viewed as follows:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 转换后的数据可以如下查看：
- en: '[PRE7]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![Loading and formatting data](img/image00219.jpeg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![加载和格式化数据](img/image00219.jpeg)'
- en: 'From the formatted data, we see that `Toby` has rated three movies. `Lisa Rose`,
    `Mick LaSalle`, and `Gene Seymour` have rated all the movies. `Claudia Puig` *,*
    and `Jack Matthews` have not rated one movie each. Here, let''s revisit our objective,
    which is defined at the beginning of the section: we shall recommend to critics
    movies that they have not rated, based on similar users. For example, we shall
    recommend movies to `Toby` based on the ratings provided by other critics similar
    to `Toby`.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 从格式化数据中，我们看到`Toby`评了三部电影。`Lisa Rose`、`Mick LaSalle`和`Gene Seymour`评了所有电影。`Claudia
    Puig`*和*`Jack Matthews`每人未评一部电影。在这里，让我们回顾一下我们最初在本节开头定义的目标：我们将根据相似用户推荐给评论家他们未评分的电影。例如，我们将根据其他与`Toby`相似的评论家的评分向`Toby`推荐电影。
- en: Calculating similarity between users
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 计算用户之间的相似度
- en: This is a very important step as we need to recommend the previously unseen
    movies based on the ratings given to these movies by other similar critics. There
    are various similarity measures, such as Euclidean distance, cosine distance,
    Pearson coefficient, Jaccard distance, and so on. The details of these measures
    or similarity metrics are explained in detail in the [Chapter 4](part0029.xhtml#aid-RL0A2
    "Chapter 4. Data Mining Techniques Used in Recommendation Engines"), *Data Mining
    Techniques Used in Recommendation Engines*.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个非常重要的步骤，因为我们需要根据其他相似评论家对电影的评分来推荐之前未见过的电影。有各种相似度度量，如欧几里得距离、余弦距离、皮尔逊系数、Jaccard距离等。这些度量或相似度指标的详细信息在[第4章](part0029.xhtml#aid-RL0A2
    "第4章。推荐引擎中使用的数据挖掘技术")*推荐引擎中使用的数据挖掘技术*中进行了详细解释。
- en: In this chapter, we'll use correlation as the similarity measure between users.
    The reason for choosing correlation is that correlation represents the association
    two items or how closely two item vectors covary or are related to each other.
    So for this chapter, we have chosen the correlation value as the measure of similarity
    between two items in a matrix.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用相关性作为用户之间的相似度度量。选择相关性的原因是相关性表示两个项目之间的关联或两个项目向量如何协变或相互关联。因此，对于本章，我们选择了相关性值作为矩阵中两个项目之间相似度的度量。
- en: 'In R, we have the `cor()` function to find correlation between variables in
    a dataset. The following code calculates the similarity between critics:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在R中，我们有`cor()`函数来查找数据集中变量的相关性。以下代码计算了评论家之间的相似度：
- en: 'While finding similarity between Toby and other critics,use the `use="complete.obs"`
    attribute, of the `cor()` function to consider complete observations:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在寻找托比与其他评论家之间的相似性时，使用`cor()`函数的`use="complete.obs"`属性来考虑完整的观测值：
- en: '[PRE8]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![Calculating similarity between users](img/image00220.jpeg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![计算用户之间的相似度](img/image00220.jpeg)'
- en: From the preceding code, we observe that `Lisa Rose` is very similar to `Toby`
    with `0.99` and `Mick LaSalle` with `0.92`.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的代码中，我们可以观察到“Lisa Rose”与“Toby”的相似度为`0.99`，与“Mick LaSalle”的相似度为`0.92`。
- en: Predicting the unknown ratings for users
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预测用户未知评分
- en: 'In this section, we will predict the unrated movies of Toby using the ratings
    given by similar users. The following are the steps to achieve this:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用相似用户的评分来预测托比的未评分电影。以下是实现这一目标的步骤：
- en: Extract the titles which Toby has not rated.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提取托比未评分的标题。
- en: For these titles, separate all the ratings given by other critics.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于这些标题，分别提取其他评论家给出的所有评分。
- en: Multiply the ratings given for these movies by all critics other than Toby with
    the similarity values of critics with Toby.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这些电影给出的评分与除托比以外的所有评论家的相似度值相乘。
- en: Sum up the total ratings for each movie, and divide this summed up value with
    the sum of similarity critic values.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对每部电影的总评分进行汇总，然后将这个汇总值除以相似度评论家值的总和。
- en: Before we go into the code, let's learn a bit about the `data.table` package
    and the `setDT()` method we have used in the following code.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进入代码之前，让我们了解一下`data.table`包和我们在以下代码中使用的`setDT()`方法。
- en: '`Data.table` is a popular R package that provides an enhanced `data.frame`
    version, which allows us to do manipulations on data with lightening speed. Another
    advantage of the `data.table` package is that it can handle very large datasets
    up to 100 GB data in RAM. Various operations, such as creating a data table, an
    enhanced version of data frame, sub-setting data, manipulating the data, joins
    etc.'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '`Data.table`是一个流行的R包，它提供了一个增强的`data.frame`版本，允许我们以闪电般的速度对数据进行操作。`data.table`包的另一个优点是它可以处理非常大的数据集，高达100
    GB的数据在RAM中。各种操作，如创建数据表、数据框的增强版本、数据子集、数据操作、连接等。'
- en: For this exercise, we have made use of the `setDT()` method available in `data.table`.
    The `set*` functions in `data.table` help manipulate input data by reference instead
    of value, that is, while transforming data, there won't be any physical copy of
    the data.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个练习，我们使用了`data.table`中可用的`setDT()`方法。`data.table`中的`set*`函数通过引用而不是值来操作输入数据，也就是说，在转换数据时，不会有数据的物理副本。
- en: 'The preceding explanation is written as code, as follows:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的解释被编写成如下代码：
- en: 'Extract the titles which Toby has not rated. We have used the `setDT()` function
    available in the `data.table` package to extract the non-rated titles and create
    a `data.table` and `data.frame` object, `rating_critic`. The `setDT()` method
    extracts column values and corresponding row names and creates a two-dimension
    `data.frame` or `data.table` object:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提取托比未评分的标题。我们使用了`data.table`包中可用的`setDT()`函数来提取未评分的标题并创建一个`data.table`和`data.frame`对象，`rating_critic`。`setDT()`方法提取列值和相应的行名，并创建一个二维`data.frame`或`data.table`对象：
- en: '[PRE9]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![Predicting the unknown ratings for users](img/image00221.jpeg)'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00221.jpeg)'
- en: 'Isolate the non-rated movies from the aforementioned list:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从上述列表中隔离未评分的电影：
- en: '[PRE10]'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![Predicting the unknown ratings for users](img/image00222.jpeg)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00222.jpeg)'
- en: Note
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Please note that the `is.na()` function is used to filter out NA values.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，`is.na()`函数用于过滤掉NA值。
- en: Take the ratings based on the original dataset and subset all the critics who
    have rated the aforementioned shown movies.
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 根据原始数据集取评分，并子集所有已对上述显示的电影进行评分的评论家。
- en: 'In the following code, `%in%` acts as the where condition in SQL:'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在以下代码中，`%in%`充当SQL中的where条件：
- en: '[PRE11]'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![Predicting the unknown ratings for users](img/image00223.jpeg)'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00223.jpeg)'
- en: 'To the aforementioned data frame, now let''s add a new variable, `similarity,`
    using the similarity values of each `critic` w.r.t Toby:'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于上述数据框，现在让我们添加一个新的变量`similarity`，使用每个`critic`相对于托比的相似度值：
- en: '[PRE12]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![Predicting the unknown ratings for users](img/image00224.jpeg)'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00224.jpeg)'
- en: 'Multiply rating with similarity value, and add the resultant as a new variable,
    `sim_rating`:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将评分与相似度值相乘，并将结果作为新变量`sim_rating`添加：
- en: '[PRE13]'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![Predicting the unknown ratings for users](img/image00225.jpeg)'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00225.jpeg)'
- en: 'Sum up all the rating values for each title calculated in the preceding step,
    and then divide this summed up value for each title with the sum of similarity
    values of each critic, that is, for the `Just My Luck` title, the rating for `Toby`
    is calculated by summing up all the `sim_rating` values for `Just My Luck` divided
    by the sum of similarity values of all the critics who have rated the `Just My
    Luck` title:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将前一步计算中每个标题的所有评分值汇总，然后除以每个评论家相似度值的总和，即对于`Just My Luck`标题，Toby的评分是通过将`Just My
    Luck`的所有`sim_rating`值相加，然后除以所有评价`Just My Luck`标题的评论家的相似度值总和来计算的：
- en: '*(2.6802154+0.5718696+2.9737221+1.8489469)/(0.8934051+0.3812464+0.9912407+0.9244735)
    = 2.530981*'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*(2.6802154+0.5718696+2.9737221+1.8489469)/(0.8934051+0.3812464+0.9912407+0.9244735)
    = 2.530981*'
- en: The preceding calculation for all the titles are done in R using two functions
    available in the `dplyr` package, `group_by()`, and `summarise()`.
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 之前对所有标题的计算都是在R中使用`dplyr`包中的两个函数`group_by()`和`summarise()`完成的。
- en: The `dplyr` package is an R package used for data manipulations. This package
    is very useful, like `data.table`; it comes in very handy for exploratory analysis
    and data manipulation. The `summarise()` function is available in the `dply` package
    for summarizing results. The `group_by()` function is used to group data by one
    or more variables.
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`dplyr`包是一个用于数据操作的R包。这个包非常有用，就像`data.table`一样；它在探索性分析和数据处理方面非常方便。`summarise()`函数在`dply`包中用于汇总结果。`group_by()`函数用于根据一个或多个变量对数据进行分组。'
- en: 'The `%>%` operator available in the `dply` package is a very handy function
    used to group multiple codes together. In the following code, we are using the
    `%>%` code to group the `group_by()` and `summarise()` functions together and
    compute the results without writing intermediate results:'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`dply`包中可用的`%>%`操作符是一个非常有用的函数，用于将多个代码组合在一起。在以下代码中，我们使用`%>%`代码将`group_by()`和`summarise()`函数组合在一起，并计算结果，而无需编写中间结果：'
- en: '[PRE14]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You can see the calculated or predicted ratings for all the three titles not
    rated by Toby. Now you can recommend these new titles, the ratings for which are
    greater than the average ratings given by Toby. For example, the `mean` rating
    given by Toby to three titles is given by the following code:'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以看到为Toby未评分的三个标题计算或预测的评分。现在您可以推荐这些新标题，其评分高于Toby给出的平均评分。例如，Toby对三个标题的平均评分如下代码所示：
- en: '[PRE15]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Now that we know the average rating by Toby is `3.16`, we can recommend movies
    with ratings greater than the mean values. From the predicted values, we can recommend
    the movie `The Night Listener`, which is above his mean value.
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 既然我们知道Toby的平均评分是`3.16`，我们就可以推荐评分高于平均值的电影。从预测值中，我们可以推荐电影《The Night Listener》，其评分高于他的平均值。
- en: 'The aforementioned generating recommendations for all the users can be easily
    extended by writing a function as follows:'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 所述为所有用户生成推荐的方法可以通过编写以下函数轻松扩展：
- en: '[PRE16]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Making predictions now for each of the users will be very easy and is shown
    next:'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在为每个用户进行预测将非常容易，下面将展示：
- en: '![Predicting the unknown ratings for users](img/image00226.jpeg)'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![预测用户未知评分](img/image00226.jpeg)'
- en: 'Kudos to us for having built our first and basic recommender system. Let''s
    put together the entire code we have done till now. The following is the full
    version of the code:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 为我们构建了第一个基本推荐系统而感到自豪。现在让我们把到目前为止所写的全部代码放在一起。以下是完全版本的代码：
- en: '[PRE17]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Summary
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Congratulations! We have built a very basic recommendation engine using R. We
    have seen the step-by-step approach of building a recommendation engine. In the
    following chapters, we will learn about different types of recommendation engines
    and their implementations in various technologies such, as Spark, Mahout, Neo4j,
    R, and Python. In the next chapter, we will learn about the various types of recommendation
    engines in depth.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！我们已经使用R构建了一个非常基本的推荐引擎。我们看到了构建推荐引擎的逐步方法。在接下来的章节中，我们将学习不同类型的推荐引擎及其在各种技术中的实现，例如Spark、Mahout、Neo4j、R和Python。在下一章中，我们将深入了解各种类型的推荐引擎。
