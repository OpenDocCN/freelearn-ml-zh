<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Feature Extraction - A Bag of Tricks</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will provide a hands-on guide to the extraction and selection of features from real-life data, with emphasis on the fact that practical machine learning<span> </span><span>systems are all about proper feature engineering. This</span> chapter <span>will focus on teaching you the best practices for feeding data to your machine learning algorithms.</span> Moreover, it will show you how to remove redundant data that can negatively impact the performance of your machine learning system.<span> Lastly, it will show you some strategies for combining data from different sources.</span></p>
<p>We will cover the following topics in this chapter:</p>
<ul>
<li>Preprocessing</li>
<li>Dimensional reduction </li>
<li>Data fusion</li>
<li>A bag of tricks</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Preprocessing</h1>
                </header>
            
            <article>
                
<p>What does preprocessing mean?</p>
<p>Beyond selecting a specific set of data that you want to use for a particular machine learning project, you also need to preprocess that data. This typically involves tasks such as formatting, cleaning, and sampling (or profiling). We won't be delving too far into the definitions of each of these tasks, and will assume that the reader grasps their meaning and purpose. We'll say that <strong>formatting</strong> is a way of simply putting the data source into a form that can be <span>easily</span><span> </span><span>understood and consumed within your project.</span> <strong>Cleaning</strong> <span>is mostly concerned with removing unwanted data and</span> <strong>sampling</strong> <span>is all about reducing the overall size of the data for performance reasons.</span></p>
<p>Although, being a developer at heart, I am anxious to take on these tasks by crafting a script or perusing and selecting a function from an open source library, instead, let's explore what Watson Studio offers us for achieving these objectives.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The data refinery</h1>
                </header>
            
            <article>
                
<p>As part of preprocessing, Watson Studio gives you the ability to refine data. Refining data is described in the online documentation as the cleansing and shaping of data.</p>
<p>As you manipulate data within Watson Studio using the refinery feature, you build what is referred to as a customized data refinery flow. We can try out some of the features and functions offered by the data refinery by going through the following steps (starting with some setup):</p>
<ol>
<li>To create a project, you click on <span class="packt_screen">New project</span> on the right side of the Watson Studio <span class="packt_screen">My Projects</span> page, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9d10a881-21fb-410e-8866-972520fc53e8.png"/></div>
<ol start="2">
<li>Next, choose a project starter. We'll choose <span class="packt_screen">Data Engineering</span>, as shown in the following screenshot (you may need to select or provision the required services at this step, depending upon what you selected; for our selection, no additional services are needed):</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/45b8d86c-5741-40dd-94a1-7ec6d19f67f8.png" style=""/></div>
<p class="mce-root"/>
<ol start="3">
<li>On the <span class="packt_screen">New project</span> screen, you can add a name and description for the project, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/db5afac9-205b-4a44-a685-1d88d348a4b2.png" style=""/></div>
<p class="mce-root" style="padding-left: 60px">At this point, you need to choose whether to restrict who you can add as collaborators (we'll use the default settings in this example), and you might be prompted to add services as you add assets that require them (in this example, no additional services will be needed, but as an FYI, you can also add other services after you create a project using the <span class="packt_screen">Settings</span> page).</p>
<ol start="4">
<li>Next, click on <span class="packt_screen">Create</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0b741bc9-f4ab-40ff-b539-246762aa39f5.png" style=""/></div>
<p style="padding-left: 60px"><span>After clicking on <span class="packt_screen">Create</span>, Watson Studio will prepare the project for you, displaying the dialog shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8fe07921-02e9-450f-8035-17c76aa9171a.png" style=""/></div>
<p>And finally (typically, it only takes a minute or two), your new project will open, ready to go, and you can start having fun developing it!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data</h1>
                </header>
            
            <article>
                
<p>Of course, every project needs data, and so the next step is to add data to our project. When you add data, it is considered a <strong>data asset</strong>, and by default, all of the project's collaborators are automatically authorized to access the data. <span>Go through the following steps to add a data file to your project</span><span>:</span></p>
<ol>
<li>From the project's <span class="packt_screen">Assets</span> page, click on the Find and add data icon, as shown in the following screenshot<em>:</em></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5f4911f4-0b61-4ec7-8bd5-047324cfe999.png" style=""/></div>
<ol start="2">
<li>Next, click on <span class="packt_screen">Load</span> and then browse to find the file or drag it onto the <span class="packt_screen">Load</span> pane, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/28b19291-3742-4b5a-aa95-6686414724b4.png" style=""/></div>
<div class="packt_infobox">
<p>You must stay on the page until the load is complete. You can cancel an ongoing load process if you want to stop loading a file. Be advised that there really isn't any progress indicator while the file is loading, so give it a few minutes!!</p>
</div>
<div>
<p style="padding-left: 60px">The file we are using in this project (<kbd>combine.csv</kbd>) is a comma-delimited text file containing statistics on players who attended the NFL scouting combine.</p>
</div>
<ol start="3">
<li>The files you add are saved in the object storage bin that is associated with your project and are listed as data assets on the <strong><span class="packt_screen">Assets</span></strong> page of your project (as you can see in the preceding screenshot). From there, you must select the specific file and click on <span class="packt_screen">Add as data asset</span>. At that point, you will be prompted to click on <span class="packt_screen">Apply</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/da127cbb-65fa-47e8-aa29-b72979e72e19.png" style=""/></div>
<p style="padding-left: 90px">Now, we are ready to use the file in our project:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6b54d8ae-a9a9-4dbc-a687-3240b0bd7ebf.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding the refinery</h1>
                </header>
            
            <article>
                
<p>Let's go through the following steps to add the refinery:</p>
<ol>
<li>To access the IBM Watson Studio data refinery, you can click on <span class="packt_screen">Add to project</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1dfdf932-830c-4b55-80bb-1ead5c67da74.png"/></div>
<ol start="2">
<li>Then, choose <span><span class="packt_screen">Data Refinery Flow</span></span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c30b5262-129e-45f3-a93d-80578d6c2b2f.png"/></div>
<ol start="3">
<li>After you've invoked the refinery, you need to add our data file (by clicking on the data asset (file)) and then click on <strong><span class="packt_screen">Add</span></strong> at the bottom-right of the page. Once the data is read into the refinery (as shown in the following screenshot), you will be ready to process it:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e1a7ba6e-7d9b-4e6c-880e-76b1d0415fd4.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Refining data by using commands</h1>
                </header>
            
            <article>
                
<p>Rather than using scripting to process or refine your data, you can use commands (also known as <strong>operations</strong>) to preprocess the data. To do this, you can start by entering a command (or <strong>operation name</strong>) and let Watson Studio's autocomplete function help you find the right operation and syntax (no programming involved!). </p>
<div class="packt_infobox">
<p>Note that, if you hover over any operation or function name, you'll see both a description and detailed information for completing the command.</p>
</div>
<p>When you're ready, you can then click on <span class="packt_screen">Apply</span> to add the operation to your data refinery flow.</p>
<p>For example, you might want to sort or reorder a column of data. If you start typing <kbd>arra</kbd>, you'll see the following result:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1e0d7c6e-84bf-4223-98d8-8913cf73ffb3.png" style=""/></div>
<p>If you then click to select the <span class="packt_screen">arrange()</span> function, you can click on the <span class="packt_screen">()</span> and select a column from your data file, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/99dd668b-2e31-4a6c-a6cc-66344a81896a.png" style=""/></div>
<p>When you're ready, click on the <span class="packt_screen">Apply</span> button to add the command to the data refinery flow, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5558dd3b-66ea-4de0-95ff-c5db14b0d8be.png" style=""/></div>
<p>Without saving the data refinery (more on this in a moment), Watson Studio will display the effect of applying the command to your data, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1e96330a-0572-4106-969b-0a7803cda3ed.png" style=""/></div>
<p class="mce-root"/>
<p>There are numerous commands available to add to the data refinery flow. Each command will be added as a step within the flow. If you click on <span class="packt_screen">Steps</span> (as shown in the following screenshot) you can view and edit each of the steps you have defined for the flow; you can even delete them, if you wish. In our case, I have added three steps: the first to arrange (sort) the data, the second to convert the first column from a string into an integer, and the third to filter out only those records for the years before 2011, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f715883f-13e6-4770-92c0-1ddc47e2782f.png"/></div>
<p>At any time, you can save and run the data refinery flow by clicking the save data refinery flow and run data refinery flow icons shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1d9b0f4e-4a07-4aae-8a95-d5261b42539b.png"/></div>
<p class="mce-root"/>
<p>Again, there are commands to perform almost any of the preprocessing tasks required in most machine learning projects, such as <kbd>group</kbd>, <kbd>rename</kbd>, <kbd>sample_n</kbd>, and <kbd>summarize</kbd>. Perhaps most importantly, the data refinery provides scripting support for the many <kbd>dplyr</kbd> R library operations, functions, and logical operators. For example, <kbd>sample_frac</kbd> and <kbd>sample_n</kbd> are supported by the data refinery and are very useful for generating sample datasets for your original data source.</p>
<p>We can use the following command to take our original file (<kbd>combine_.csv</kbd>) and create a data refinery flow to generate a sample:</p>
<pre><strong>Sample_n(199, replace=TRUE)</strong></pre>
<p class="mce-root">The preceding command will generate the following output:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6aa399e9-8d2e-4c1c-87f8-82ae57ed0b42.png"/></div>
<p>This will automatically read our original file and create a a random sample of data based on the number of rows indicated (in our case, 99). The <kbd>replace</kbd> parameter indicates that if a dataset already exists with the output filename, then it will be overwritten.</p>
<p>After saving and running the data refinery flow, we will see a summary of our results (along with a list of our prior runs), as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c9ce6b4a-7951-4fde-88db-b496ca236bdd.png"/></div>
<p>We can see that we have created a sample file from the original, named <kbd>combine.csv_sharped_199.csv</kbd>, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a6e92791-cc70-42ea-8ce8-e88e7f85f757.png"/></div>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dimensional reduction</h1>
                </header>
            
            <article>
                
<p><strong>Dimensional reduction</strong> is usually used to reduce the number of variables that are to be considered in an machine learning  project. It is often used where columns of data in a file have more than an acceptable number of missing values, have low variance, or are extremely variable in nature. Before attempting to reduce your data source by removing those unwanted columns, you need to be comfortable that this is the right thing to be doing. In other words, you want to make sure that the data you reduce does not create a bias in the remaining data. Profiling the data is an excellent way to determine whether the dimensional reduction of a particular column or columns is appropriate. <strong>Data</strong> <strong>profiling</strong> is a technique that is used to examine <strong>data</strong> to determine its accuracy and completeness. This is the process of examining a <strong>data source</strong> to uncover the erroneous sections in the <strong>data</strong>.</p>
<p>You can create effective scripts to accomplish this, and, as expected, there are numerous packages and libraries available to for you to download and use. However, once again, Watson Studio can easily do this for us.</p>
<p>We can gather the information we need to profile our data source without the need for scripting or programming by creating a data asset profile. The profile of a data asset created by Watson Studio by default includes generated metadata and statistics about the textual content of a data file.</p>
<p>To create a profile for your data, you can go to the asset's <span class="packt_screen">Profile</span> page and click on <span class="packt_screen">Create Profile</span>.</p>
<div class="packt_infobox">
<p>You can update any existing profile when the data changes.</p>
</div>
<p>After clicking on <span class="packt_screen">Create Profile</span>, the results will be displayed, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/13453bad-1445-4d40-9ac8-558d7fc6cf21.png"/></div>
<p>You can take a minute or two to scroll though the generated profile to view the various statistics, such as the overall number of columns and rows. You can search by column or data point, value frequencies, unique values, min/max, mean, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data fusion</h1>
                </header>
            
            <article>
                
<p>Data fusion is not a data analysis practice, but rather describes the integration of data from disparate sources. Thankfully, you will find that you can use Watson Studio to collect and combine data sources without much effort.</p>
<p>With Watson Studio, you can set up a <strong>catalog</strong> for all of your data sources so that you can easily find and share data (and other assets). A catalog is a defined private space within an environment or organization. It is a way to organize your resources across many data science projects—resources such as data assets and analytical assets—and can be used to manage the access that users have to each of these assets.</p>
<p class="mce-root"/>
<p>What is particularly exciting about this feature is the fact that you can organize and control access to many different types of asset within a single catalog including the following:</p>
<ul>
<li>Data in files</li>
<li>Connected data</li>
<li>Connections themselves</li>
<li>Folders</li>
<li>A host of other analytical assets (which we'll experiment with later in this book)</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Catalog setup</h1>
                </header>
            
            <article>
                
<p><span>Creating a catalog is easy. </span>Let's create a catalog by going through the following steps:</p>
<ol>
<li>Start by clicking on <span class="packt_screen">Catalog</span>, then <span class="packt_screen">View All Catalogs</span>, and then <span class="packt_screen">New Catalog</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b3081db9-ea70-4d04-8dda-c6f02a708f78.png" style=""/></div>
<ol start="2">
<li>Then provide, some basic information, such as a name and a description f<span>or your new catalog, and then click on</span> <span class="packt_screen">Create</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bb0f780f-ff2d-4d80-8673-2caa3e36083f.png" style=""/></div>
<p style="padding-left: 60px">Almost instantly, the fresh new catalog will be created and ready to be used, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/af08d0fa-847b-435f-a8eb-3bd9b2dba884.png"/></div>
<ol start="3">
<li>To add some assets to the catalog, you can click on <span class="packt_screen">Add to Catalog</span> (in the top-right of the page) and select the type of asset you want to add (<span class="packt_screen">Local files</span>, <span class="packt_screen">Connected asset</span>, or <span class="packt_screen">Connection</span>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5673f1ef-5496-48c0-93fb-984ca8ba1d9b.png" style=""/></div>
<ol start="4">
<li>Here, we will just add some local files to our catalog. Once we click on <span class="packt_screen">Local files</span>, the <span class="packt_screen">Add data assets from local files</span> page will be displayed (as shown in the follow screenshot), where you can browse and select the files you want to add:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/532b5d73-3d33-40f4-ab2c-cfe292384ab9.png"/></div>
<ol start="5">
<li>Once you have added all of your files to this page, you must click on <span class="packt_screen">Add</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/289bd8b6-5e9e-409b-bb79-cf91930bc4e8.png"/></div>
<p style="padding-left: 60px">Again, after a short pause, the catalog will be updated, organized, and ready to use, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/707e6493-c548-4b28-b880-c80bdfb5cc09.png"/></div>
<p class="mce-root"/>
<ol start="6">
<li>Once you create and update your catalog, you can mange who can access the catalog, as well as how they can access it, by clicking on <span class="packt_screen">Access Control</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1fd87c89-5815-4072-8538-61c4fbcaca9e.png"/></div>
<p class="mce-root"/>
<p>Watson Studio catalogs allow collaborators to quickly and easily find, preview, rate, and consume each asset in the catalog. We will look at catalogs in more detail later in this book.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Recommended assets</h1>
                </header>
            
            <article>
                
<p>Another cool feature of Watson Studio catalogs is that Watson Studio actually uses <strong>Watson Machine Learning</strong> to derive a list of assets that you haven't accessed yet based on attributes common to the assets that you've viewed, created, and added to projects, such as tags, asset classification, attribute classifiers, data types, asset owners, and asset types. The more assets you access and catalog, the better the recommendations are. Again, we'll dig deeper into this feature in later chapters of this book!</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">A bag of tricks</h1>
                </header>
            
            <article>
                
<p>The more orderly you are in your handling of data, the more consistent and better results you are like likely to achieve (with any project). The process for getting data ready for a machine learning algorithm (selecting, preprocessing, and transforming) can be accomplished using IBM Watson Studio with little programming or scripting required and, by leveraging the data refinery and catalog features, the work that you did at the start can be used over and over with little or no reworking required.</p>
<p>Here are a few parting words of advice:</p>
<ul>
<li>Take the time to add descriptions for your assets and always use descriptive names</li>
<li>Manage your data assets well: remove extraneous copies or test versions right away and keep your catalogs clean</li>
<li>Use the profiling feature religiously to better understand your assets</li>
<li>Control who can access your assets by managing project and asset collaborators</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we jumped right into using IBM Watson Studio's various features to accomplish various data preprocessing and setup objectives, such as using built-in R libraries for data preprocessing, dimensional reduction, and data fusion. We then offered a number of recommendations to save you time when preparing an ML project.</p>
<p>In the next chapter, we'll examine the machine learning paradigm and focus on various approaches and algorithms. The chapter will start by giving a practical background to model evaluation, model selection, and algorithm selection in machine learning and will then cover supervised learning.</p>


            </article>

            
        </section>
    </body></html>