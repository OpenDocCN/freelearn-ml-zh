- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Conformal Prediction for Regression
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回归问题的共形预测
- en: In this chapter, we will cover conformal prediction for regression problems.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍回归问题的共形预测。
- en: Regression is a cornerstone of machine learning, enabling us to predict continuous
    outcomes from given data. However, as with many predictive tasks, the predictions
    are never free from uncertainty. Traditional regression techniques give us a point
    estimate but fail to measure the uncertainty. This is where the power of conformal
    prediction comes into play, extending our regression models to produce well-calibrated
    prediction intervals.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 回归是机器学习的基础，使我们能够从给定数据中预测连续结果。然而，与许多预测任务一样，预测永远不会没有不确定性。传统的回归技术给我们一个点估计，但无法衡量不确定性。这就是共形预测力量的体现，它扩展了我们的回归模型，以产生良好校准的预测区间。
- en: This chapter delves deep into conformal prediction tailored specifically for
    regression problems. By understanding and appreciating the importance of quantifying
    uncertainty, we will explore how conformal prediction augments regression to provide
    not just a point prediction but an entire interval or even a distribution where
    the actual outcome will likely fall with pre-specified confidence. This is invaluable
    in many real-world scenarios, especially when making decisions based on predictions
    where stakes are high and being “approximately right” isn’t good enough.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章深入探讨了专门针对回归问题的共形预测。通过理解和欣赏量化不确定性的重要性，我们将探讨共形预测如何增强回归，不仅提供点预测，还提供整个区间，甚至分布，其中实际结果可能以预指定的置信度出现。这在许多现实场景中非常有价值，尤其是在基于预测做出决策且风险很高，仅仅“大致正确”还不够的情况下。
- en: 'We will cover the following topics in the chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Uncertainty quantification for regression problems
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回归问题的不确定性量化
- en: Various approaches to produce prediction intervals
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产生预测区间的各种方法
- en: Conformal prediction for regression problems
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回归问题的共形预测
- en: Building prediction intervals and predictive distributions using conformal prediction
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用共形预测构建预测区间和预测分布
- en: Uncertainty quantification for regression problems
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回归问题的不确定性量化
- en: 'After completing this chapter, whenever you predict any continuous variable,
    you’ll be equipped to add a layer of robustness and reliability to your predictions.
    Understanding and quantifying this uncertainty is crucial for several reasons:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章学习后，无论何时预测任何连续变量，你都将能够为你的预测添加一层稳健性和可靠性。理解和量化这种不确定性对于以下几个原因至关重要：
- en: '**Model interpretability and trust**: Uncertainty quantification helps us understand
    the reliability of our model predictions. By providing a range of possible outcomes,
    we can build trust in our model’s predictions and interpret them more effectively.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型可解释性和可信度**：不确定性量化帮助我们理解我们模型预测的可靠性。通过提供一系列可能的输出，我们可以建立对我们模型预测的信任，并更有效地解释它们。'
- en: '**Decision-making**: In many practical applications of regression analysis,
    decision-makers must rely on something other than point estimates. They often
    need to know the range within which the actual value will likely fall with a certain
    probability. This range, or prediction interval, provides crucial information
    about the uncertainty of the prediction and aids in risk management.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**决策制定**：在回归分析的许多实际应用中，决策者必须依赖点估计之外的东西。他们通常需要知道实际值可能落在某个概率范围内的范围。这个范围，或预测区间，提供了关于预测不确定性的关键信息，有助于风险管理。'
- en: '**Model improvement**: Uncertainty can highlight the areas where the model
    may benefit from additional data or feature engineering. High uncertainty may
    indicate that the model needs help capturing the underlying relationship, suggesting
    the need for model revision or additional data.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型改进**：不确定性可以突出模型可能从额外数据或特征工程中受益的领域。高不确定性可能表明模型需要帮助捕捉潜在关系，这表明需要修订模型或添加更多数据。'
- en: '**Outlier detection**: Uncertainty quantification can also help us identify
    outliers or anomalies in the data. Observations associated with high predictive
    uncertainty may be outliers or indicate a novel situation not captured during
    model training.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**异常值检测**：不确定性量化还可以帮助我们识别数据中的异常值或异常情况。与高预测不确定性相关的观测值可能是异常值或表明在模型训练期间未捕获的新情况。'
- en: Therefore, uncertainty quantification forms an essential part of regression
    problems. It provides a more holistic picture of predictive performance, allows
    for better risk management, and improves model trust and interpretability. Conformal
    prediction for regression, a framework that we will discuss in this chapter, is
    the approach to efficiently quantifying uncertainty in regression problems.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，不确定性量化是回归问题的一个基本组成部分。它提供了一个更全面的预测性能图景，允许更好的风险管理，并提高模型的信任度和可解释性。本章将讨论的回归的符合性预测，是一种在回归问题中有效量化不确定性的方法。
- en: Understanding the types and sources of uncertainty in regression modeling
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解回归模型中不确定性的类型和来源
- en: 'Uncertainty in regression modeling can arise from several sources and manifests
    in different ways. Broadly, these uncertainties can be classified into two main
    types – **aleatoric** and **epistemic**:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 回归模型中的不确定性可能来自几个来源，并以不同的方式表现出来。广义上，这些不确定性可以分为两大类——**随机性**和**认知性**：
- en: '**Aleatoric uncertainty**: This type of uncertainty is often called “inherent,”
    “irreducible,” or “random” uncertainty. It arises due to the inherent variability
    in the data itself, which is usually beyond our control. This uncertainty would
    not be eliminated if we were to collect more data or improve our measurements.
    Aleatoric uncertainty reflects the randomness, variability, or heterogeneity in
    our sample population.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**随机不确定性**：这种类型的不确定性通常被称为“内在的”、“不可减少的”或“随机的”不确定性。它源于数据本身的固有变异性，这通常超出了我们的控制范围。即使我们收集更多数据或改进测量，这种不确定性也不会消失。随机不确定性反映了我们的样本群体中的随机性、变异性或异质性。'
- en: '**Epistemic uncertainty**: Also known as “reducible” or “systematic” uncertainty,
    this type originates from the lack of knowledge about the system or process under
    study. It could be due to insufficient data, measurement errors, or incorrect
    assumptions about the underlying data distribution or model structure. Unlike
    aleatoric uncertainty, epistemic uncertainty can be reduced with more information
    or data.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**认知不确定性**：也称为“可减少的”或“系统性的”不确定性，这种类型源于对研究中的系统或过程的了解不足。这可能是由于数据不足、测量误差或对潜在数据分布或模型结构的错误假设。与随机不确定性不同，认知不确定性可以通过更多的信息或数据来减少。'
- en: 'The primary sources of these uncertainties in regression modeling are as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这些不确定性的主要来源如下：
- en: '**Data uncertainty**: This includes measurement errors, missing values, and
    variability in the data. Data might be collected under different conditions or
    sources, adding more uncertainty to the dataset.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据不确定性**：这包括测量误差、缺失值和数据中的变异性。数据可能在不同的条件下或来源下收集，这会给数据集增加更多的不确定性。'
- en: '**Model uncertainty**: This comes from the model’s inability to precisely capture
    the proper relationship between predictors and the outcome. Every model makes
    certain assumptions (for example, linearity, independence, normality, and so on),
    and any violation of these assumptions introduces uncertainty.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型不确定性**：这源于模型无法精确捕捉预测变量和结果之间的适当关系。每个模型都做出某些假设（例如，线性、独立性、正态性等），任何对这些假设的违反都会引入不确定性。'
- en: '**Parameter uncertainty**: Every regression model involves estimating parameters
    (for example, coefficients). There’s always some uncertainty about these estimates,
    which can contribute to the overall uncertainty in predictions.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**参数不确定性**：每个回归模型都涉及估计参数（例如，系数）。这些估计总是存在一些不确定性，这可能会对预测的整体不确定性做出贡献。'
- en: '**Structural uncertainty**: This refers to uncertainty due to the choice of
    a specific model form. Different model structures or types (for example, linear
    regression, polynomial regression, and so on) might lead to different interpretations
    and predictions.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**结构不确定性**：这指的是由于选择特定模型形式而产生的不确定性。不同的模型结构或类型（例如，线性回归、多项式回归等）可能会导致不同的解释和预测。'
- en: '**Residual uncertainty**: This comes from the residuals or errors of the model.
    It represents the difference between the observed outcomes and the outcomes predicted
    by the model.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**残差不确定性**：这来自模型的残差或误差。它代表了观察到的结果与模型预测的结果之间的差异。'
- en: In the context of regression modeling, recognizing these types and sources of
    uncertainty can help interpret the model’s predictions more accurately. It can
    guide the process of model refinement and validation.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在回归模型的情况下，识别这些不确定性的类型和来源可以帮助更准确地解释模型的预测。它可以指导模型精炼和验证的过程。
- en: The concept of prediction intervals
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预测区间的概念
- en: A prediction interval is an interval estimate associated with a regression prediction,
    indicating a range within which the actual outcome will likely fall with a certain
    probability. While a point prediction gives us a singular value as the most likely
    outcome, a prediction interval offers a range, providing a clearer picture of
    the uncertainty associated with that prediction.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 预测区间是与回归预测相关的区间估计，表示实际结果可能落在这个范围内的概率。虽然点预测给出一个最可能的结果值，但预测区间提供了一个范围，提供了关于该预测不确定性的更清晰图景。
- en: Why do we need prediction intervals?
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们为什么需要预测区间？
- en: 'Let’s take a look:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看：
- en: '**Quantification of uncertainty**: The primary reason for employing prediction
    intervals is to quantify our predictions’ uncertainty. No matter how sophisticated
    the model is, every prediction comes with inherent variability. By using prediction
    intervals, we can communicate this variability effectively.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**量化不确定性**：采用预测区间的首要原因是量化我们预测的不确定性。无论模型多么复杂，每个预测都伴随着固有的变异性。通过使用预测区间，我们可以有效地传达这种变异性。'
- en: '**Risk management**: In various industries, particularly finance, healthcare,
    and engineering, understanding the range of potential outcomes is crucial for
    risk assessment and mitigation. A prediction interval helps decision-makers weigh
    their actions’ potential risks and benefits.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**风险管理**：在各个行业中，特别是在金融、医疗保健和工程领域，了解潜在结果的范围对于风险评估和缓解至关重要。预测区间有助于决策者权衡他们行动的潜在风险和收益。'
- en: '**Model transparency**: Providing an interval instead of just a point estimate
    can enhance the transparency of the model. Stakeholders can gauge not only what
    the model predicts but also the confidence the model has in that prediction.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型透明度**：提供区间而不是仅仅的点估计可以增强模型的透明度。利益相关者不仅可以了解模型预测的内容，还可以了解模型对该预测的信心程度。'
- en: '**Guided decision-making**: Decision-makers can act more decisively when they
    understand the worst-case and best-case scenarios. For example, knowing the lower
    and upper bounds of predicted sales in sales forecasting can help allocate resources.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**指导决策**：当决策者了解最坏和最好的情况时，他们可以更加果断地采取行动。例如，了解销售预测中预测销售的上下限可以帮助分配资源。'
- en: Understanding the necessity for prediction intervals in various contexts paves
    the way for a deeper discussion of their nature, particularly in comparision with
    confidence intervals.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在各种情境中理解预测区间的必要性为深入讨论其本质铺平了道路，尤其是在与置信区间比较时。
- en: How is it different from a confidence interval?
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它与置信区间有何不同？
- en: This distinction is crucial. A confidence interval pertains to the uncertainty
    regarding a population parameter based on a sample statistic. For instance, we
    might use a confidence interval to estimate the mean value of a population based
    on a sample mean. On the other hand, a prediction interval is about predicting
    a single future observation and quantifying the uncertainty around that individual
    prediction.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这种区别至关重要。置信区间涉及基于样本统计量的关于总体参数的不确定性。例如，我们可能会使用置信区间来估计基于样本均值的总体均值。另一方面，预测区间是关于预测单个未来观察值并量化该单个预测的不确定性的。
- en: The components of a prediction interval
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 预测区间的组成部分
- en: 'A prediction interval typically has the following components:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 预测区间通常具有以下组成部分：
- en: '**Lower bound**: The minimum value within the predicted range.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**下限**：预测范围内的最小值。'
- en: '**Upper bound**: The maximum value within the expected range.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**上限**：预期范围内的最大值。'
- en: '**Coverage probability**: The probability of the actual outcome falling within
    the prediction interval. Commonly used probabilities are 90%, 95%, and 99%.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**覆盖概率**：实际结果落在预测区间内的概率。常用的概率是90%、95%和99%。'
- en: 'There are various approaches to producing prediction intervals. Quantifying
    uncertainty in regression models is crucial for understanding the reliability
    of predictions. Here are some of the most used techniques:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 产生预测区间有各种方法。在回归模型中量化不确定性对于理解预测的可靠性至关重要。以下是一些最常用的技术：
- en: '**Confidence and prediction intervals**: These are fundamental techniques for
    quantifying uncertainty. Confidence intervals provide a range of values where
    we expect the true regression parameters to fall, given a certain confidence level.
    Prediction intervals, on the other hand, give a range for predicting a new observation,
    incorporating both the uncertainty in the estimate of the mean function and the
    randomness of the new observation.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信区间和预测区间**：这些是量化不确定性的基本技术。置信区间提供了一个范围，其中我们期望在给定的置信水平下，真实的回归参数将落在其中。另一方面，预测区间提供了一个范围，用于预测新的观测值，它结合了均值函数估计的不确定性和新观测值的随机性。'
- en: '**Resampling methods**: Techniques such as bootstrapping and cross-validation
    can provide empirical estimates of model uncertainty. Bootstrapping, for example,
    involves repeatedly sampling from the dataset with replacement and recalculating
    the regression estimates to get an empirical distribution of the estimates.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重采样方法**：如自助法和交叉验证等技术可以提供模型不确定性的经验估计。例如，自助法涉及从数据集中有放回地重复采样并重新计算回归估计，以获得估计的经验分布。'
- en: '**Bayesian methods**: Bayesian regression analysis provides a probabilistic
    framework for quantifying uncertainty. Instead of single-point estimates, Bayesian
    regression gives a posterior distribution for the model parameters, which can
    be used to construct prediction intervals.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**贝叶斯方法**：贝叶斯回归分析提供了一个概率框架来量化不确定性。贝叶斯回归不是给出单点估计，而是给出模型参数的后验分布，这可以用来构建预测区间。'
- en: '**Conformal prediction**: Conformal prediction is a more recent approach that
    measures the certainty of predictions made by machine learning algorithms. It
    builds prediction regions that attain valid coverage in finite samples without
    making assumptions about data distribution.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**同构预测**：同构预测是一种较新的方法，它衡量机器学习算法做出的预测的确定性。它构建预测区域，在有限样本中达到有效的覆盖范围，而不对数据分布做出假设。'
- en: '**Quantile regression**: Unlike standard regression techniques, which model
    the conditional mean of the response variable given specific values of predictor
    variables, quantile regression models the conditional median or other quantiles.
    It can provide a more comprehensive view of the possible outcomes and their associated
    probabilities.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分位数回归**：与标准回归技术不同，后者根据预测变量的特定值来建模响应变量的条件均值，分位数回归模型的是条件中位数或其他分位数。它可以提供对可能结果及其相关概率的更全面视角。'
- en: '**Monte Carlo methods**: Monte Carlo methods are a class of computational algorithms
    that use random sampling to obtain numerical results. In the context of uncertainty
    quantification, Monte Carlo methods can be used to propagate the uncertainties
    from the input variables to the response variable.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**蒙特卡洛方法**：蒙特卡洛方法是一类使用随机采样来获得数值结果的计算算法。在不确定性量化方面，蒙特卡洛方法可以用来传播输入变量到响应变量的不确定性。'
- en: '**Sensitivity analysis**: Sensitivity analysis is a technique that’s used to
    determine how different values of an independent variable will impact a particular
    dependent variable under a given set of assumptions. This technique is used within
    specific boundaries that depend on one or more input variables.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**敏感性分析**：敏感性分析是一种技术，用于确定在给定的一组假设下，独立变量的不同值将如何影响特定的依赖变量。这种技术是在依赖于一个或多个输入变量的特定边界内使用的。'
- en: Understanding the inherent value and significance of prediction intervals makes
    it vital to discern the methodologies and tools to help us generate them. While
    traditional statistical methods have their merits, the dynamic landscape of data-driven
    industries necessitates more adaptive and reliable techniques. Conformal prediction,
    with its roots grounded in algorithmic randomness and validity, offers an enticing
    approach. As we transition into the next section, we will explore how conformal
    prediction tailors itself to regression problems, ensuring that our prediction
    intervals are accurate and theoretically sound. Let’s dive in and unveil the intricacies
    of conformal prediction in the context of regression.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 理解预测区间的内在价值和重要性对于辨别帮助我们生成它们的方方法和工具至关重要。虽然传统统计方法有其优点，但数据驱动行业的动态格局需要更适应性和可靠的技巧。基于算法随机性和有效性的同构预测提供了一种诱人的方法。随着我们过渡到下一部分，我们将探讨同构预测如何适应回归问题，确保我们的预测区间既准确又具有理论上的合理性。让我们深入探讨，揭示回归背景下同构预测的复杂性。
- en: Conformal prediction for regression problems
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回归问题的符合预测
- en: 'In the preceding chapters, we investigated the numerous advantages that conformal
    prediction provides. These include the following:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在前几章中，我们探讨了符合预测提供的众多优势。以下是一些包括：
- en: '**Validity and calibration**: Conformal prediction maintains its validity and
    calibration, irrespective of the dataset’s size. This makes it a robust method
    for prediction across different dataset sizes.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**有效性和校准**：符合预测无论数据集的大小如何，都保持其有效性和校准。这使得它成为不同数据集大小预测的稳健方法。'
- en: '**Distribution-free nature**: One of the significant benefits of conformal
    prediction is its distribution-free nature. It makes no specific assumptions about
    the underlying data distribution, making it a flexible and versatile tool for
    many prediction problems.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无分布特性**：符合预测的一个重要优点是其无分布特性。它不对底层数据分布做出具体假设，使其成为许多预测问题的灵活和多功能工具。'
- en: '**Compatibility with various predictors**: Conformal prediction can seamlessly
    integrate with any point predictor, irrespective of its nature. This property
    enhances its adaptability and widens its scope of application in diverse domains.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**与各种预测器的兼容性**：符合预测可以无缝地与任何点预测器集成，无论其性质如何。这一特性增强了其适应性，扩大了其在不同领域的应用范围。'
- en: '**Non-intrusiveness**: The conformal prediction framework is non-intrusive,
    implying that it does not interfere with or alter the original prediction model.
    Instead, it is an additional layer that quantifies uncertainty, providing a holistic
    perspective of the model’s predictions.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**非侵入性**：符合预测框架是非侵入性的，这意味着它不会干扰或改变原始预测模型。相反，它是一个额外的层，量化不确定性，提供对模型预测的整体视角。'
- en: In regression analysis, one paramount concern is the validity and calibration
    of various uncertainty quantification methods. These qualities are particularly
    essential in generating prediction intervals, where it’s expected that these intervals
    provide coverage that matches the specified confidence level, which can sometimes
    be challenging.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在回归分析中，一个至关重要的关注点是各种不确定性量化方法的有效性和校准。这些品质在生成预测区间时尤为重要，因为这些区间预期提供与指定置信水平相匹配的覆盖范围，这有时可能具有挑战性。
- en: 'In the comprehensive study titled *Valid prediction intervals for regression
    problems*, by Nicolas Dewolf, Bernard De Baets, and Willem Waegeman ([https://arxiv.org/abs/2107.00363](https://arxiv.org/abs/2107.00363)),
    the authors explored four broad categories of methods designed for estimating
    prediction intervals in regression scenarios – Bayesian methods, ensemble methods,
    direct estimation methods, and conformal prediction methods:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在由Nicolas Dewolf、Bernard De Baets和Willem Waegeman撰写的综合研究论文《回归问题的有效预测区间》中（[https://arxiv.org/abs/2107.00363](https://arxiv.org/abs/2107.00363)），作者们探讨了四种旨在回归场景中估计预测区间的广泛方法类别——贝叶斯方法、集成方法、直接估计方法和符合预测方法：
- en: '**Bayesian methods**: This category encompasses techniques that use Bayes’
    theorem to predict the posterior probability of the intervals. These methods can
    give robust prediction intervals by modeling the entire output distribution.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**贝叶斯方法**：这个类别包括使用贝叶斯定理来预测区间后验概率的技术。这些方法可以通过对整个输出分布进行建模来提供稳健的预测区间。'
- en: '**Ensemble methods**: Ensemble methods such as random forest or bagging can
    generate prediction intervals by leveraging the variability among individual models
    in the ensemble.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集成方法**：如随机森林或袋装等集成方法可以通过利用集成中各个模型的变异性来生成预测区间。'
- en: '**Direct estimation methods**: These techniques involve the direct calculation
    of prediction intervals. They often necessitate specific assumptions about the
    underlying data or the error distribution.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**直接估计方法**：这些技术涉及直接计算预测区间。它们通常需要对底层数据或误差分布做出特定的假设。'
- en: '**Conformal prediction methods**: Conformal prediction stands out for its distribution-free
    nature and ability to provide valid prediction intervals across diverse scenarios.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**符合预测方法**：符合预测因其无分布特性和能够在各种场景下提供有效预测区间而脱颖而出。'
- en: The authors of this study underscore that the adoption of artificial intelligence
    systems by humans is significantly tied to the reliability these systems can offer.
    The reliability here refers not only to producing accurate point predictions but
    also to the system’s ability to gauge and communicate its uncertainty level accurately.
    Thus, these systems should be adept at highlighting their areas of knowledge and
    limitations, particularly the aspects they need clarification on.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 本研究的作者强调，人类对人工智能系统的采用与这些系统能够提供的可靠性密切相关。这里的可靠性不仅指产生准确的点预测，还包括系统准确评估和传达其不确定性水平的能力。因此，这些系统应该擅长突出其知识领域和局限性，特别是需要澄清的方面。
- en: Converting uncertainties or “what they do not know” becomes even more crucial
    in real-world applications, where predictions often drive significant decisions.
    Therefore, uncertainty quantification aids in making informed and risk-aware decisions,
    contributing to the broader acceptance and trust in artificial intelligence systems.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实世界的应用中，将不确定性或“他们不知道的事情”转换为更关键，因为预测往往驱动着重要的决策。因此，不确定性量化有助于做出明智和风险意识的决定，有助于人工智能系统的更广泛接受和信任。
- en: Calibration refers to the degree to which the actual coverage of a prediction
    interval matches its nominal coverage level. In other words, a prediction interval
    is well-calibrated if it contains the true value of the response variable with
    the expected frequency. Calibration is essential because it ensures that the prediction
    intervals are not too narrow or too broad and that they provide accurate information
    about the uncertainty associated with the predictions. In this study, the authors
    use conformal prediction as a general calibration procedure to ensure the prediction
    intervals are well-calibrated.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 校准是指预测区间的实际覆盖范围与其名义覆盖水平相匹配的程度。换句话说，如果预测区间以预期的频率包含响应变量的真实值，则该预测区间是良好校准的。校准是必不可少的，因为它确保预测区间既不太窄也不太宽，并且提供关于预测不确定性的准确信息。在本研究中，作者使用保形预测作为一般的校准程序，以确保预测区间得到良好校准。
- en: Methods other than conformal prediction can suffer from calibration issues because
    they may make assumptions about the distribution of the errors or the model parameters
    that do not hold in practice. For example, Bayesian methods might assume that
    the errors are normally distributed with a fixed variance, which may not be the
    case. Ensemble methods, on the other hand, may not consider the correlation between
    the predictions of the individual models in the ensemble. Outliers or other noise
    sources in the data may also affect direct estimation methods. In addition, some
    interval estimators can, at best, be asymptotically valid; since this is only
    guaranteed for infinitely large datasets, there is no guarantee that it will hold
    for real datasets of final size, especially for medium-sized and smaller datasets.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 除了保形预测之外的方法可能会遭受校准问题，因为它们可能对误差分布或模型参数的分布做出假设，而这些假设在实际情况中并不成立。例如，贝叶斯方法可能假设误差是具有固定方差的正态分布，这可能并不成立。另一方面，集成方法可能没有考虑集成中各个模型预测之间的相关性。数据中的异常值或其他噪声源也可能影响直接估计方法。此外，一些区间估计器最多只能是渐近有效的；由于这仅对无限大的数据集有保证，因此无法保证它适用于最终大小为实数的数据集，尤其是对于中等大小和更小的数据集。
- en: These issues can lead to prediction intervals that are poorly calibrated, meaning
    that they do not provide accurate information about the uncertainty associated
    with the predictions.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这些问题可能导致校准不良的预测区间，这意味着它们没有提供关于预测不确定性的准确信息。
- en: Conversely, conformal prediction is a non-parametric method that does not make
    any assumptions about the distribution of the errors or the model parameters.
    Instead, it uses the data to construct prediction intervals that are guaranteed
    to be well-calibrated, regardless of the underlying distribution of the errors.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，保形预测是一种非参数方法，它不对误差分布或模型参数的分布做出任何假设。相反，它使用数据来构建预测区间，这些区间保证能够很好地校准，无论误差的潜在分布如何。
- en: 'The following table provides a summary of the characteristics of the four classes
    of methods for constructing prediction intervals in a regression setting:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 下表总结了在回归设置中构建预测区间的四种方法类别的特征：
- en: '| **Method** | **Marginal Validity** | **Scalability** | **Domain Knowledge**
    | **Validation Set** |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| **方法** | **边缘有效性** | **可扩展性** | **领域知识** | **验证集** |'
- en: '| Bayesian methods | No | Only scalable with approximate inference | Yes |
    No |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| 贝叶斯方法 | 否 | 仅在近似推理下可扩展 | 是 | 否 |'
- en: '| Ensemble methods | No | Yes (when scalable models are used) | No | No |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| 集成方法 | 否 | 是（当使用可扩展模型时） | 否 | 否 |'
- en: '| Direct interval estimation | No | Yes | No | Yes |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| 直接区间估计 | 否 | 是 | 否 | 是 |'
- en: '| Conformal prediction | Yes | Yes (for ICP) | No | Yes |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| 一致性预测 | 是 | 是（对于ICP） | 否 | 是 |'
- en: Table 7.1 – Summary of the uncertainty quantification methods
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.1 – 不确定性量化方法的总结
- en: For each class of methods, this table indicates whether the method has marginal
    validity (meaning that it does not require any assumptions about the distribution
    of the errors or the model parameters), whether it is scalable (meaning that it
    can be applied to large datasets), whether it requires domain knowledge (meaning
    that it requires knowledge of the specific problem domain), and whether it requires
    a validation set (meaning that it requires a separate dataset to evaluate the
    performance of the method).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每种方法类别，该表指出了该方法是否具有边缘有效性（意味着它不需要关于误差分布或模型参数的任何假设），是否可扩展（意味着它可以应用于大型数据集），是否需要领域知识（意味着它需要特定问题域的知识），以及是否需要验证集（意味着它需要一个单独的数据集来评估该方法的表现）。
- en: 'This table shows the following:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 该表显示了以下内容：
- en: Bayesian methods do not have marginal validity, are only scalable with approximate
    inference, require domain knowledge, and do not require a validation set
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 贝叶斯方法没有边缘有效性，仅在近似推理下可扩展，需要领域知识，并且不需要验证集
- en: Ensemble methods do not have marginal validity, are scalable, do not require
    domain knowledge, and do not require a validation set
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集成方法没有边缘有效性，可扩展，不需要领域知识，并且不需要验证集
- en: Direct interval estimation methods do not have marginal validity, are scalable,
    do not require domain knowledge, and require a validation set
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 直接区间估计方法没有边缘有效性，可扩展，不需要领域知识，并需要一个验证集
- en: Conformal prediction has marginal validity, is scalable, does not require domain
    knowledge, and requires a validation set (in the **inductive conformal prediction**
    (**ICP**) version)
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一致性预测具有边缘有效性，可扩展，不需要领域知识，并且需要验证集（在**归纳一致性预测**（**ICP**）版本中）
- en: 'Several types of prediction interval estimators for regression problems were
    reviewed and compared, as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 对回归问题的几种预测区间估计器进行了回顾和比较，如下所示：
- en: '**Bayesian methods**: Gaussian process and approximate GP'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**贝叶斯方法**：高斯过程和近似高斯过程'
- en: '**Ensemble methods**: Dropout ensemble, deep ensembles, and mean-variance estimator'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集成方法**：Dropout集成、深度集成和均值-方差估计器'
- en: '**Direct interval estimation methods**: Neural network quantile regression'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**直接区间估计方法**：神经网络分位数回归'
- en: '**Conformal prediction**: Neural networks and random forest'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**一致性预测**：神经网络和随机森林'
- en: This comparison was based on two main properties – the *coverage degree* and
    the *average width of the* *prediction intervals*.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这种比较基于两个主要属性——*覆盖度*和*预测区间*的*平均宽度*。
- en: Before calibration, the performance of prediction interval estimators varied
    significantly across different benchmark datasets, with large fluctuations in
    performance from one dataset to another. This is due to the violation of certain
    assumptions that are inherent to some classes of methods. For example, some methods
    may perform well on datasets with normally distributed errors, but poorly on datasets
    with strongly skewed errors. Similarly, some methods may perform well on datasets
    with low levels of noise, but poorly on datasets with high levels of noise.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在校准之前，预测区间估计器的性能在不同基准数据集之间差异显著，性能从一个数据集到另一个数据集之间有大幅波动。这是由于某些方法类别的内在假设被违反所致。例如，某些方法可能在正态分布误差的数据集上表现良好，但在强偏斜误差的数据集上表现不佳。同样，某些方法可能在噪声水平低的数据集上表现良好，但在噪声水平高的数据集上表现不佳。
- en: The paper also found that the performance of the different methods for constructing
    prediction intervals depends on several factors, such as the size of the dataset,
    the complexity of the model, and the degree of skewness in the data.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 论文还发现，构建预测区间的不同方法的性能取决于几个因素，例如数据集的大小、模型的复杂性和数据的偏斜程度。
- en: For example, the paper found that Bayesian methods tend to perform better on
    small datasets, while ensemble methods tend to perform well on large datasets.
    The paper also found that the mean-variance estimator, which is a type of ensemble
    method, can be sensitive to the normality assumption and may perform poorly on
    strongly skewed datasets.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，该论文发现贝叶斯方法在小数据集上往往表现更好，而集成方法在大数据集上往往表现良好。论文还发现，均值-方差估计器，作为一种集成方法，可能对正态性假设敏感，并在强偏斜数据集上可能表现不佳。
- en: Finally, the paper found that direct interval estimation methods, such as neural
    network quantile regression, can be computationally expensive and may require
    many training samples to achieve good performance.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，论文发现直接区间估计方法，如神经网络分位数回归，可能计算成本高昂，并且可能需要许多训练样本才能达到良好的性能。
- en: The conformal prediction framework was used for post-hoc calibration, and it
    was found that all methods attained the desired coverage after calibration, and
    in certain cases, the calibrated models even produced intervals with a smaller
    average width.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 符合性预测框架被用于事后校准，发现所有方法在校准后都达到了预期的覆盖率，在某些情况下，校准后的模型甚至产生了更小的平均宽度区间。
- en: The authors illustrated how conformal prediction can be used as a general calibration
    procedure for methods that deliver poor results without a calibration step and
    show that it can improve the performance of these methods on a wide range of datasets,
    making conformal prediction a promising framework for constructing prediction
    intervals in a regression setting. In particular, the paper showed that conformal
    prediction can be used as a general calibration procedure for methods that deliver
    poor results without a calibration step. The paper also found that conformal prediction
    has several significant advantages over other methods for constructing prediction
    intervals. For example, conformal prediction has marginal validity, meaning that
    it does not require any assumptions about the distribution of the errors or the
    model parameters. Additionally, conformal prediction is scalable, meaning that
    it can be applied to large datasets. Finally, conformal prediction does not require
    domain knowledge, meaning that it does not require knowledge of the specific problem
    domain.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 作者说明了如何将符合性预测用作一种通用校准程序，用于那些在没有校准步骤的情况下提供较差结果的方法，并表明它可以在广泛的数据库上提高这些方法的性能，使符合性预测成为回归设置中构建预测区间的有希望框架。特别是，论文表明符合性预测可以用作一种通用校准程序，用于那些在没有校准步骤的情况下提供较差结果的方法。论文还发现，符合性预测在构建预测区间方面与其他方法相比具有几个显著优势。例如，符合性预测具有边缘有效性，这意味着它不需要对误差分布或模型参数的任何假设。此外，符合性预测是可扩展的，这意味着它可以应用于大数据集。最后，符合性预测不需要领域知识，这意味着它不需要了解特定的问题领域。
- en: Conformal prediction is a powerful framework for quantifying uncertainty in
    machine learning predictions. Its principles can be applied to various types of
    problems involving uncertainty quantification, including regression, which involves
    predicting a continuous output variable.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 符合性预测是量化机器学习预测不确定性的强大框架。其原理可以应用于涉及不确定性量化的各种类型的问题，包括回归，其中涉及预测一个连续的输出变量。
- en: When applied to regression problems, conformal prediction provides prediction
    intervals rather than point predictions. These prediction intervals offer a range
    of plausible values for the target variable, with a specified confidence level.
    For example, a 95% prediction interval indicates that we can be 95% confident
    that the true value of the target variable falls within this range.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 当应用于回归问题时，符合性预测提供预测区间而不是点预测。这些预测区间为目标变量提供一系列可能的值，并指定一个置信水平。例如，95%的预测区间表示我们可以有95%的信心，目标变量的真实值位于这个范围内。
- en: The most compelling feature of conformal prediction in regression scenarios
    is its validity, which refers to the fact that if we claim a 95% confidence level,
    the true value will indeed be in the prediction interval 95% of the time. Importantly,
    this validity is assured for unseen test data, any sample size (not just for large
    or infinite samples), and any underlying point regressor model.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 符合性预测在回归场景中最引人注目的特征是其有效性，这指的是如果我们声称95%的置信水平，那么真实值确实会在预测区间内95%的时间。重要的是，这种有效性对于未见过的测试数据、任何样本大小（不仅仅是大型或无限样本）以及任何潜在的点回归模型都是保证的。
- en: Moreover, conformal prediction for regression is non-parametric, which means
    it does not make any specific assumptions about the underlying data distribution.
    This makes it broadly applicable across different types of regression problems
    and datasets.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，回归的一致性预测是非参数的，这意味着它不对基础数据分布做出任何特定的假设。这使得它在不同的回归问题和数据集上具有广泛的应用性。
- en: To implement conformal prediction for regression, we need a nonconformity measure,
    which quantifies how much each observation deviates from the norm. Common choices
    for regression include the absolute residuals. Once we have the nonconformity
    scores, we can generate prediction intervals based on the ordered nonconformity
    scores of the calibration set.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 要实现回归的一致性预测，我们需要一个非一致性度量，它量化了每个观测值偏离正常值多少。回归中常见的选项包括绝对残差。一旦我们有了非一致性得分，我们就可以根据校准集的非一致性得分的顺序生成预测区间。
- en: Different variants of conformal prediction can be used in regression, such as
    transductive (full) conformal prediction, ICP, which is more computationally efficient
    than classical TCP, jackknife+, and cross-conformal methods, which offer improved
    precision and robustness.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 一致性预测的不同变体可以用于回归，例如归纳（完整）一致性预测、ICP，它比经典的TCP更高效，还有jackknife+和交叉一致性方法，它们提供了更高的精度和稳健性。
- en: Overall, conformal prediction provides a flexible, robust, and reliable approach
    to uncertainty quantification in regression problems, offering valid and well-calibrated
    prediction intervals.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，一致性预测为回归问题中的不确定性量化提供了一种灵活、稳健和可靠的方法，提供了有效且校准良好的预测区间。
- en: Building prediction intervals and predictive distributions using conformal prediction
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用一致性预测构建预测区间和预测分布
- en: ICP is a computationally efficient variant of the original transductive conformal
    prediction framework. Like all other models from the conformal prediction family,
    ICP is model-agnostic in terms of the underlying point prediction model and data
    distribution and comes with automatic validity guarantees for final samples of
    any size.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ICP是原始归纳一致性预测框架的一种计算高效的变体。像一致性预测家族中的所有其他模型一样，ICP在基础点预测模型和数据分布方面是模型无关的，并为任何大小的最终样本提供自动的有效性保证。
- en: The key advantage of ICP compared to the original variant of conformal prediction
    (transductive conformal prediction) is that ICP requires training the underlying
    regression model only once, leading to efficient computations during the calibration
    and prediction phases. ICP is highly computationally efficient as the conformal
    layer requires very little additional computation overhead compared to training
    the underlying model.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 与原始的一致性预测变体（归纳一致性预测）相比，ICP的关键优势在于ICP只需要对基础回归模型进行一次训练，从而在校准和预测阶段实现高效的计算。由于与基础模型训练相比，一致性层只需要很少的计算开销，因此ICP在计算效率上非常高。
- en: The ICP process involves splitting the dataset into a proper training set and
    a calibration set. The training set is used to create the initial point prediction
    model, while the calibration set is utilized to calculate conformity scores and
    produce the prediction intervals of the unseen points.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: ICP过程涉及将数据集分成合适的训练集和校准集。训练集用于创建初始点预测模型，而校准集则用于计算一致性得分并产生未见点的预测区间。
- en: ICP automatically guarantees validity and ensures that prediction intervals
    include actual test points with a specified degree of selected coverage.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: ICP自动保证有效性，并确保预测区间包含实际测试点，并具有指定的选择覆盖度。
- en: ICP’s efficiency and flexibility have made it a popular choice for uncertainty
    estimation in various applications.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: ICP的效率和灵活性使其成为各种应用中不确定性估计的热门选择。
- en: 'We will use the notebook at https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb
    to illustrate how to use ICP:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用位于https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb的笔记本来说明如何使用ICP：
- en: "![Figure 7.1 – Predictions by \uFEFFRandomForestRegressor on the test set](img/B19925_07_01.jpg)"
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![图7.1 – RandomForestRegressor在测试集上的预测](img/B19925_07_01.jpg)'
- en: Figure 7.1 – Predictions by RandomForestRegressor on the test set
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.1 – RandomForestRegressor在测试集上的预测
- en: 'Let’s generate prediction intervals by utilizing `RandomForestRegressor` as
    the core predictive model, and employ ICP to transform the point forecasts made
    by the base machine learning model into well-calibrated prediction intervals:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们利用`RandomForestRegressor`作为核心预测模型来生成预测区间，并使用ICP将基础机器学习模型做出的点预测转换为良好校准的预测区间：
- en: '**Model training**: Initiate the process by training the chosen model using
    the proper training dataset:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**模型训练**：通过使用适当的训练数据集训练所选模型来启动这个过程：'
- en: '[PRE0]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Making predictions**: Utilize the trained model to generate predictions on
    the calibration and test datasets:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**进行预测**：利用训练好的模型在校准集和测试集上生成预测：'
- en: '[PRE3]'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**Nonconformity metric calculation**: For every observation within the calibration
    set, compute the nonconformity metric:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**非一致性度量计算**：对于校准集中的每个观测值，计算非一致性度量：'
- en: '[PRE5]'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '**Quantile calculation**: Determine the quantile of the nonconformity metrics
    using the formula designed for final sample correction. The formula includes the
    final sample correction factor:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**量数计算**：使用为最终样本校正设计的公式确定非一致性度量值的量数。该公式包括最终样本校正因子：'
- en: '[PRE6]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '**Form prediction intervals**: Using the quantile you calculated in the previous
    step, establish prediction intervals for the test set. These intervals should
    be based on the point predictions made by the underlying model:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**建立预测区间**：使用上一步计算的量数，为测试集建立预测区间。这些区间应基于底层模型做出的点预测：'
- en: '[PRE7]'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We can illustrate the prediction outcomes on a plot that encompasses point
    estimates, actual values, and prediction intervals yielded by ICP:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在一个包含点估计、实际值和ICP生成的预测区间的图表上展示预测结果：
- en: '![Figure 7.2 – Actual versus predicted values with a prediction interval](img/B19925_07_02.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![图7.2 – 实际值与预测值及预测区间](img/B19925_07_02.jpg)'
- en: Figure 7.2 – Actual versus predicted values with a prediction interval
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.2 – 实际值与预测值及预测区间
- en: We can confirm that in ICP, the width of the prediction interval remains constant
    (as designed).
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以确认在ICP中，预测区间的宽度保持恒定（如设计所示）。
- en: ICP for regression offers several advantages and a few drawbacks. Let’s consider
    these.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ICP回归提供了几个优点和一些缺点。让我们考虑这些。
- en: 'We’ll cover the advantages first:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先介绍其优势：
- en: '**Model-agnostic**: ICP can be applied to any existing regression model. This
    means it’s a flexible method that can be used to enhance a wide variety of regression
    models.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模型无关性**：ICP可以应用于任何现有的回归模型。这意味着它是一种灵活的方法，可以用来增强各种回归模型。'
- en: '**Efficiency**: ICP only requires the underlying regression model to be trained
    once, leading to efficient computations during the calibration and prediction
    phases. This makes it computationally more efficient compared to the original
    transductive conformal prediction framework, which requires the model to be retrained
    for every new prediction.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**效率**：ICP只需要对底层回归模型进行一次训练，在校准和预测阶段计算效率高。这使得它在计算上比原始的归纳一致性预测框架更高效，后者需要对每个新的预测重新训练模型。'
- en: '**Validity**: ICP comes with automatic validity guarantees. If the data distribution
    is exchangeable (that is, the order of the data points does not matter), then
    the prediction intervals produced by ICP will have the desired coverage probability.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**有效性**：ICP自带自动有效性保证。如果数据分布是可交换的（即数据点的顺序不重要），那么ICP生成的预测区间将具有所需的覆盖概率。'
- en: '**Distribution-free**: ICP does not make any assumptions about the distribution
    of the data. This means it can be applied even when the data does not follow any
    known statistical distribution.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无分布假设**：ICP对数据的分布没有任何假设。这意味着即使数据不遵循任何已知的统计分布，也可以应用它。'
- en: 'Now, let’s cover the disadvantages:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们谈谈其缺点：
- en: '**Performance dependency**: The effectiveness of ICP relies heavily on the
    performance of the underlying regression model. If the underlying model does not
    fit the data well, the prediction intervals produced by ICP may be too wide.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性能依赖性**：ICP的有效性高度依赖于底层回归模型的表现。如果底层模型没有很好地拟合数据，ICP生成的预测区间可能会太宽。'
- en: '**Assumption of exchangeability**: ICP’s validity guarantees depend on the
    assumption of exchangeability, which may not hold in many real-world scenarios
    (for example, when dealing with time series data).'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可交换性假设**：ICP的有效性保证依赖于可交换性的假设，这在许多现实场景中可能不成立（例如，处理时间序列数据时）。'
- en: '**Lack of adaptivity**: Unlike other conformal prediction methods, such as
    **conformalized quantile regression** (**CQR**) and jackknife+ methods, which
    we’ll cover later in this chapter, ICP isn’t inherently adaptive. It does not
    dynamically adjust to the data’s complexity or structure. For example, it won’t
    naturally produce narrower intervals in regions of the data where the model is
    more confident and wider intervals where the model is less confident.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**适应性不足**：与我们在本章后面将要介绍的如**一致性量化回归**（CQR）和 jackknife+ 方法等其他一致性预测方法不同，ICP 并非本质上具有适应性。它不会动态调整以适应数据的复杂度或结构。例如，它不会自然地在模型更自信的数据区域产生更窄的区间，在模型不太自信的数据区域产生更宽的区间。'
- en: In the ensuing section, we’ll deep dive into one of the most popular conformal
    prediction models – CQR. This is a sophisticated technique that amalgamates conformal
    prediction’s robustness with the precision of quantile regression. This fusion
    facilitates the generation of reliable prediction intervals and ensures that these
    intervals are optimally tuned to encapsulate the true values with a high degree
    of certainty. By harnessing the strengths of both conformal prediction and quantile
    regression, CQR emerges as a formidable tool for constructing well-calibrated
    prediction intervals, thereby augmenting the interpretability and trustworthiness
    of predictive models. As we traverse this section, we will unravel the mechanics
    of CQR, elucidate its advantages, and illustrate its application in real-world
    predictive scenarios.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将深入探讨最流行的一致性预测模型之一——CQR。这是一种将一致性预测的鲁棒性与量化回归的精度相结合的复杂技术。这种融合促进了可靠预测区间的生成，并确保这些区间以最佳方式调整以高概率包含真实值。通过利用一致性预测和量化回归的优势，CQR
    成为了构建良好校准预测区间的强大工具，从而增强了预测模型的可解释性和可信度。随着我们进入这一节，我们将揭示 CQR 的机制，阐明其优势，并展示其在现实世界预测场景中的应用。
- en: Mechanics of CQR
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CQR 的力学
- en: In the previous section, we observed that ICP generates prediction intervals
    of uniform width. Consequently, it doesn’t adjust adaptively to heteroscedastic
    data, where the variability of the response variable isn’t constant across different
    regions of the data.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我们观察到 ICP 生成的是宽度均匀的预测区间。因此，它不会对异方差数据进行自适应调整，其中响应变量的变异性在不同数据区域并不恒定。
- en: In many cases, not only it is crucial to ensure valid coverage in final samples
    but it is also beneficial to generate the most concise prediction intervals for
    each point within the input space. This helps maintain the informativeness of
    these intervals. When dealing with heteroscedastic data, the model should be capable
    of adjusting the length of prediction intervals to match the local variability
    associated with each point in the feature space.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，不仅确保最终样本中的有效覆盖至关重要，而且生成输入空间中每个点的最简洁预测区间也是有益的。这有助于保持这些区间的信息量。当处理异方差数据时，模型应能够调整预测区间的长度以匹配特征空间中每个点的局部变异性。
- en: CQR (developed by Yaniv Romano, Evan Patterson, and Emmanuel Candes and published
    in the paper *Conformalized Quantile Regression* ([https://arxiv.org/abs/1905.03222](https://arxiv.org/abs/1905.03222)))
    is one of the most popular and widely adopted conformal prediction models. It
    was specifically designed to address the need for adaptivity by employing quantile
    regression as the underlying regression model.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: CQR（由 Yaniv Romano、Evan Patterson 和 Emmanuel Candes 开发，并在论文《一致性量化回归》中发表[https://arxiv.org/abs/1905.03222](https://arxiv.org/abs/1905.03222)）是最受欢迎和最广泛采用的一致性预测模型之一。它专门设计用来解决适应性需求，通过采用量化回归作为基础回归模型。
- en: Roger Koenker developed quantile regression – a statistical method that estimates
    the conditional quantiles of a response variable given a set of features. Unlike
    classical regression, which focuses on estimating the conditional mean, quantile
    regression provides a more complete picture of the relationship between the predictors
    and the response by estimating specified quantiles. Quantile regression provides
    adaptivity by allowing quantiles to adjust to the local variability of the data.
    This is particularly important when the data is heteroscedastic, meaning that
    the variance of the response variable changes across the range of the predictors.
    However, unlike models in the conformal prediction framework, quantile regression
    does not have automatic validity guarantees.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 罗杰·科恩克开发了分位数回归——一种统计方法，它根据一组特征估计响应变量的条件分位数。与经典回归不同，经典回归侧重于估计条件均值，而分位数回归通过估计指定的分位数，提供了预测变量和响应变量之间关系的更完整图景。分位数回归通过允许分位数调整到数据的局部变异性，提供了适应性。这在数据异方差时尤为重要，意味着响应变量的方差在预测变量的范围内变化。然而，与符合预测框架中的模型不同，分位数回归没有自动的有效性保证。
- en: By combining the concept of quantile regression with the conformal prediction
    framework, CQR inherits the distribution-free validity guarantees for finite samples
    from conformal prediction, as well as the statistical efficiency and adaptivity
    of quantile regression.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将分位数回归的概念与符合预测框架相结合，CQR继承了符合预测在有限样本中的分布自由有效性保证，以及分位数回归的统计效率和适应性。
- en: 'Combining conformal prediction with quantile regression to create CQR provides
    several advantages over existing methods:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 将符合预测与分位数回归相结合以创建CQR，与现有方法相比提供了几个优势：
- en: Conformal prediction is a technique for constructing prediction intervals that
    attain valid coverage in finite samples, without making distributional assumptions.
    This means that the prediction intervals produced by CQR are guaranteed to contain
    the true response value with a certain probability, regardless of the underlying
    distribution of the data.
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 符合预测是一种构建预测区间的方法，在有限样本中实现有效的覆盖，而不做分布假设。这意味着CQR产生的预测区间保证以一定的概率包含真实响应值，无论数据的潜在分布如何。
- en: Quantile regression provides a flexible and efficient way to estimate the conditional
    quantiles of the response variable, which allows CQR to adjust the length of the
    prediction intervals to the local variability of the data. This adaptivity is
    particularly important when the data is heteroscedastic, meaning that the variance
    of the response variable changes across the range of the predictors. By estimating
    the conditional quantiles at each query point in predictor space, CQR can construct
    prediction intervals that are shorter and more informative than those obtained
    from classical regression methods.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分位数回归提供了一种灵活且高效的方法来估计响应变量的条件分位数，这使得CQR能够根据数据的局部变异性调整预测区间的长度。这种适应性在数据异方差时尤为重要，意味着响应变量的方差在预测变量的范围内变化。通过在预测空间中的每个查询点估计条件分位数，CQR可以构建比经典回归方法获得的预测区间更短、更具有信息量的区间。
- en: According to the results published in the paper *Conformalized Quantile Regression*,
    CQR tends to produce shorter intervals than ICP and is adaptive. This is because
    CQR can adjust the length of the prediction intervals to the local variability
    of the data using quantile regression.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据论文《符合化分位数回归》中发布的结果，CQR倾向于产生比ICP更短的区间，并且具有适应性。这是因为CQR可以使用分位数回归调整预测区间的长度，以适应数据的局部变异性。
- en: We will now describe the mechanics of CRQ, starting with classical quantile
    regression.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将描述CRQ的机制，从经典分位数回归开始。
- en: Quantile regression
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分位数回归
- en: Quantile regression is a statistical method that estimates the conditional quantiles
    of a response variable given a set of predictor variables (features). Unlike classical
    regression, which focuses on estimating the conditional mean, quantile regression
    provides a more complete picture of the relationship between the predictors and
    the response by estimating the entire conditional distribution.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 分位数回归是一种统计方法，它根据一组预测变量（特征）估计响应变量的条件分位数。与经典回归不同，经典回归侧重于估计条件均值，而分位数回归通过估计整个条件分布，提供了预测变量和响应变量之间关系的更完整图景。
- en: 'At a high level, quantile regression minimizes a loss function that measures
    the difference between the observed response values and the predicted quantiles.
    The loss function that’s used in quantile regression is typically pinball loss,
    a piecewise linear function that places more weight on the residuals at the specified
    quantile level:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 从高层次来看，分位数回归最小化一个损失函数，该函数衡量观察到的响应值与预测分位数之间的差异。在分位数回归中使用的损失函数通常是指示球损失，这是一个分段线性函数，在指定的分位数水平上对残差赋予更大的权重：
- en: '![Figure 7.3 – Visualization of the pinball loss function, where y=y_hat](img/B19925_07_03.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![图7.3 – 指示球损失函数的可视化，其中y=y_hat](img/B19925_07_03.jpg)'
- en: Figure 7.3 – Visualization of the pinball loss function, where y=y_hat
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.3 – 指示球损失函数的可视化，其中y=y_hat
- en: Under the hood, quantile regression can be implemented using a variety of algorithms,
    including linear quantile regression, neural networks, quantile random forest,
    and gradient boosting methods.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在底层，分位数回归可以使用各种算法实现，包括线性分位数回归、神经网络、分位数随机森林和梯度提升方法。
- en: One common strategy for estimating uncertainty with quantile regression involves
    calculating the lower (*q_lo*) and upper (*q_hi*) quantiles for each X value in
    the test dataset, and then outputting [*q_lo, q_hi*] as a prediction interval.
    While this method can sometimes perform well and adapt to heteroscedasticity,
    it doesn’t come with guarantees for achieving the desired coverage. Without such
    assurance for final samples, the outcomes of using such strategies could be catastrophic,
    particularly in critical applications such as healthcare, finance, and autonomous
    vehicles. This is confirmed by the results of the experiments in the paper, which
    show that prediction intervals produced by neural networks can significantly undercover
    actual values.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 估计分位数回归中的不确定性的一个常见策略是计算测试数据集中每个X值的下分位数（*q_lo*）和上分位数（*q_hi*），然后输出[*q_lo, q_hi*]作为预测区间。虽然这种方法有时可以表现良好并适应异方差性，但它并不保证实现所需的覆盖范围。如果没有对最终样本的这种保证，使用此类策略的结果可能会灾难性，尤其是在医疗保健、金融和自动驾驶等关键应用中。这一点由论文中的实验结果得到证实，这些结果表明神经网络产生的预测区间可能会显著低估实际值。
- en: Several methods exist to provide asymptotic consistent results for quantile
    regression, including for related methods such as quantile random forests. However,
    none of these methods provide validity guarantees in final samples.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 存在多种方法可以提供分位数回归的渐近一致结果，包括对于相关方法如分位数随机森林。然而，这些方法中没有任何一种在最终样本中提供有效性保证。
- en: CQR
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CQR
- en: In previous chapters, we discussed how conformal prediction, in both its transductive
    and inductive forms, can offer validity guarantees in final samples. While both
    variants of conformal prediction can be applied to quantile regression, considering
    the prevalent use of ICP, we will focus solely on the application of ICP in the
    context of CQR.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们讨论了符合预测（无论是其传递形式还是归纳形式）如何在最终样本中提供有效性保证。虽然符合预测的两种变体都可以应用于分位数回归，但由于ICP（局部一致性预测）的广泛应用，我们将仅关注CQR（条件分位数回归）中ICP的应用。
- en: 'The following figure from [https://arxiv.org/abs/1905.03222](https://arxiv.org/abs/1905.03222)
    presents a comparison between the prediction intervals produced by the standard
    ICP model (known as split-conformal), its locally adaptive variant, and CQR:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的图来自[https://arxiv.org/abs/1905.03222](https://arxiv.org/abs/1905.03222)，展示了标准ICP模型（称为分割符合性）产生的预测区间、其局部自适应变体和CQR之间的比较：
- en: '![Figure 7.4 – Prediction intervals on simulated heteroscedastic data with
    outliers – (a) the standard split conformal method, (b) its locally adaptive variant,
    and (c) CQR. The interval length as a function of X is shown in (d). The target
    coverage rate is 90%](img/B19925_07_04.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![图7.4 – 在具有异常值的模拟异方差数据上的预测区间 – (a) 标准分割符合性方法，(b) 其局部自适应变体，和(c) CQR。区间长度作为X的函数在(d)中显示。目标覆盖率为90%](img/B19925_07_04.jpg)'
- en: Figure 7.4 – Prediction intervals on simulated heteroscedastic data with outliers
    – (a) the standard split conformal method, (b) its locally adaptive variant, and
    (c) CQR. The interval length as a function of X is shown in (d). The target coverage
    rate is 90%
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.4 – 在具有异常值的模拟异方差数据上的预测区间 – (a) 标准分割符合性方法，(b) 其局部自适应变体，和(c) CQR。区间长度作为X的函数在(d)中显示。目标覆盖率为90%
- en: The heteroscedastic dataset, which contains outliers, is modeled by three different
    methods, all achieving a user-specified coverage of 90%. As we discussed when
    we talked about ICP, ICP (split-conformal) generates prediction intervals of a
    constant width, indicating its non-adaptive nature. The locally weighted variant
    of ICP shows partial adaptivity. CQR, however, is fully adaptive and notably produces
    prediction intervals with the shortest average length.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 异方差数据集，包含异常值，通过三种不同的方法建模，所有方法都实现了用户指定的 90% 覆盖率。正如我们在讨论 ICP 时所讨论的，ICP（分割符合性）生成恒定宽度的预测区间，表明其非自适应性质。ICP
    的局部加权变体显示出部分自适应。然而，CQR 是完全自适应的，并且显著地产生了平均长度最短的预测区间。
- en: 'Let’s describe the steps involved in CQR:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们描述 CQR 所涉及到的步骤：
- en: Split the data into a proper training set and a calibration set. The proper
    training set is used to fit the quantile regression model, while the calibration
    set is used to construct the prediction intervals.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据分为适当的训练集和校准集。适当的训练集用于拟合分位数回归模型，而校准集用于构建预测区间。
- en: Fit the quantile regression model to the proper training set using any algorithm
    for quantile regression, such as random forest or deep neural networks. This step
    involves estimating the conditional quantiles of the response variable given the
    predictor variables.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用任何分位数回归算法（如随机森林或深度神经网络）将分位数回归模型拟合到适当的训练集。这一步涉及估计给定预测变量的响应变量的条件分位数。
- en: 'Compute conformity scores that quantify the errors made by the prediction interval
    obtained from quantile regression [`q_lo`, `q_hi`] by computing nonconformity
    scores using E i : = max{ ˆ q  α lo(X i) − Y i, Y i −  ˆ q  α hi(X i)}. The nonconformity
    score can be interpreted as follows – if the actual label, y, falls below the
    lower bound of the interval, the nonconformity score corresponds to the distance
    from *y* to the lower bound. Conversely, if *y* exceeds the upper bound, the nonconformity
    score is the distance from *y* to the upper bound. However, if the actual label,
    *y*, is within the interval, the nonconformity score is considered negative and
    corresponds to the distance from *y* to the nearest bound.'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '计算符合性分数，该分数量化了从分位数回归得到的预测区间[`q_lo`, `q_hi`]所犯的错误，通过使用 E i : = max{ ˆ q  α lo(X i)
    − Y i, Y i −  ˆ q  α hi(X i)}来计算非符合性分数。非符合性分数可以这样解释——如果实际标签 y 落在区间的下限以下，非符合性分数对应于
    y 到下限的距离。相反，如果 y 超过上限，非符合性分数是 y 到上限的距离。然而，如果实际标签 y 在区间内，非符合性分数被认为是负数，并对应于 y 到最近边界的距离。'
- en: Compute the prediction intervals for each test point by using empirical quantiles
    of E i.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过使用 E i 的经验分位数来计算每个测试点的预测区间。
- en: 'The last step of the formula for prediction intervals is as follows:'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 预测区间公式的最后一步如下：
- en: C(X n+1) = [ ˆ q  α lo(X n+1) − Q 1−α(E, ℐ 2),  ˆ q  α hi(X n+1) + Q 1−α(E,
    ℐ 2)]
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: C(X n+1) = [ ˆ q  α lo(X n+1) − Q 1−α(E, ℐ 2),  ˆ q  α hi(X n+1) + Q 1−α(E,
    ℐ 2)]
- en: 'Here, Q 1−α(E, ℐ 2) : = (1 − α)(1 + 1 / |ℐ 2|) is the empirical quantile of
    E i, ℐ 2 is the calibration set, and |ℐ 2| is just a mathematical notation for
    the number of elements in the calibration set.'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '在这里，Q 1−α(E, ℐ 2) : = (1 − α)(1 + 1 / |ℐ 2|) 是 E i 的经验分位数，ℐ 2 是校准集，而 |ℐ 2|
    只是一个数学符号，表示校准集中的元素数量。'
- en: The conformal prediction idea here is similar to what we did in ICP – we simply
    use the calibration set to compute some form of nonconformity metric and then
    use the quantiles of the nonconformity metric to produce uncertainty intervals
    around the point forecast from the trained point prediction model. The only difference
    is that instead of adjusting the point predictions produced by the regression
    model, we adjust quantiles produced by the underlying statistical, machine learning,
    or deep learning model. Otherwise, the ideas and the mechanism of quantile calculation
    are the same as in ICP, given the definition of the nonconformity metric that
    we have described.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的符合性预测思想与我们之前在 ICP 中所做的是相似的——我们简单地使用校准集来计算某种形式的非符合性度量，然后使用非符合性度量的分位数来产生围绕训练的点预测模型预测点的预测区间。唯一的区别是，我们不是调整回归模型产生的点预测，而是调整由基础统计、机器学习或深度学习模型产生的分位数。否则，考虑到我们已描述的非符合性度量定义，分位数计算的思想和机制与
    ICP 相同。
- en: The key result in the paper is that if the data exchangeable, then the prediction
    interval constructed by the split (inductive) CQR algorithm satisfies the property
    of validity – that is, ℙ{Y n+1 ∈ C(X n+1)} ≥ 1 − α.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 论文中的关键结果是，如果数据可交换，那么由分割（归纳）CQR算法构建的预测区间满足有效性属性——也就是说，ℙ{Y n+1 ∈ C(X n+1)} ≥ 1
    − α。
- en: This is like in all other models in conformal prediction and says that given
    the user-specified confidence level, 1 − α, the probability of having the actual
    value of *y* within the constructed prediction interval is guaranteed to exceed
    1 − α. So, if the specified user confidence is 90%, the actual points are guaranteed
    to lie within the prediction interval 90% of the time.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 这就像在所有其他一致性预测模型中一样，意味着给定用户指定的置信水平1 − α，实际值*y*落在构建的预测区间内的概率保证超过1 − α。所以，如果指定的用户置信度为90%，实际点保证有90%的时间落在预测区间内。
- en: The additional bonus point is that if the nonconformity scores, E i, are almost
    surely distinct, then the coverage is also bounded as ℙ{Y n+1 ∈ C(X n+1)} ≤ 1
    − α +  1 _ |ℐ 2| + 1, where |ℐ 2| is the size of the calibration dataset. By way
    of example, for 500 points in the calibration dataset, the coverage is guaranteed
    to be bound between 90% and ~90.2%.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个额外的好处是，如果非一致性得分E i几乎肯定不同，那么覆盖度也有界，即ℙ{Y n+1 ∈ C(X n+1)} ≤ 1 − α +  1 _ |ℐ 2|
    + 1，其中|ℐ 2|是校准数据集的大小。例如，对于校准数据集中的500个点，覆盖度保证在90%和~90.2%之间。
- en: To summarize, CQR tends to produce shorter intervals compared to ICP. This is
    because CQR adjusts the length of the prediction intervals to the local variability
    of the data using quantile regression, which is particularly important when the
    data is heteroscedastic.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，CQR与ICP相比，往往产生更短的区间。这是因为CQR使用分位数回归调整预测区间的长度以适应数据的局部变化，这在数据异方差时尤为重要。
- en: Overall, the combination of conformal prediction and quantile regression in
    CQR provides a powerful and flexible framework for constructing prediction intervals
    that are both distribution-free and adaptive to heteroscedasticity.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，CQR中将一致性预测和分位数回归相结合提供了一个强大且灵活的框架，用于构建既无分布依赖又适应异方差的预测区间。
- en: Jackknife+
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Jackknife+
- en: We will now describe another widely used conformal prediction method for regression,
    known as jackknife+. The description of the jackknife+ technique aligns closely
    with the details outlined in the seminal paper *Predictive Inference with the
    Jackknife+*, where this method was first introduced.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将描述另一种广泛使用的回归一致性预测方法，称为Jackknife+。Jackknife+技术的描述与开创性论文《使用Jackknife+进行预测推理》中概述的细节紧密一致，在该论文中首次介绍了这种方法。
- en: 'We aim to fit a regression function to the training data, which consists of
    pairs of features (*X**i*, *Y**i*). Our goal is to predict the output, Yn+1, given
    a new feature vector, Xn+1=x, and generate a corresponding uncertainty interval
    for this test point. We require that the interval contains the true Yn+1 given
    the specified target coverage – that is, 1 − α : ℙ{Y n+1 ∈ C(X n+1)} ≥ 1 − α.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '我们的目标是将回归函数拟合到训练数据上，该数据由特征对(*X**i*, *Y**i*)组成。我们的目标是给定新的特征向量Xn+1=x，预测输出Yn+1，并为这个测试点生成相应的置信区间。我们要求该区间包含在指定的目标覆盖度下真实的Yn+1——也就是说，1
    − α : ℙ{Y n+1 ∈ C(X n+1)} ≥ 1 − α。'
- en: 'A naive solution could be to use the residuals after fitting the underlying
    regressor on the training data, |Y i −  ˆ μ (X i)|, and compute the quantile of
    the residuals to estimate the width of the prediction interval on the new test
    point, as follows:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的解决方案可能是使用在训练数据上拟合的底层回归器的残差，|Y i −  ˆ μ (X i)|，并计算残差的分位数来估计新测试点的预测区间宽度，如下所示：
- en: ˆ μ (X n+1) ± ( the (1 − α) quantile of |Y 1 −  ˆ μ (X 1)|, … , |Y n −  ˆ μ (X n)|)
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: ˆ μ (X n+1) ± ( |Y 1 −  ˆ μ (X 1)|的(1 − α)分位数, … , |Y n −  ˆ μ (X n)|)
- en: However, in practice, such an approach will underestimate uncertainty due to
    overfitting as the residuals on the training set are typically smaller than residuals
    on unseen test data.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在实践中，这种方法将低估不确定性，因为训练集上的残差通常小于未见过的测试数据上的残差。
- en: 'To circumvent overfitting, statisticians developed a robust technique known
    as the jackknife. This technique was originally designed to reduce bias and estimate
    variance. It functions by iteratively omitting one observation from the dataset
    and recalculating the model. This offers an empirical approach to evaluate the
    model’s stability and resilience to individual data points:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免过拟合，统计学家开发了一种称为“刀切法”的稳健技术。这种方法最初是为了减少偏差和估计方差而设计的。它通过迭代地从数据集中省略一个观测值并重新计算模型来工作。这为评估模型对单个数据点的稳定性和弹性提供了一个经验方法：
- en: "![Figure 7.5 – Illustration of the \uFEFFjackknife prediction method](img/B19925_07_05.jpg)"
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![图7.5 – 刀切预测方法的示意图](img/B19925_07_05.jpg)'
- en: Figure 7.5 – Illustration of the jackknife prediction method
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.5 – 刀切预测方法的示意图
- en: Jackknife regression
  id: totrans-190
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 刀切回归
- en: Each time jackknife regression is performed, it fits the model to all data points,
    excluding the one specified by (Xi, Yi). This process allows jackknife regression
    to estimate the leave-one-out residual denoted by |Y i −  ˆ μ  −i(X i)|. By treating
    these leave-one-out residuals as nonconformity scores, we can estimate the 1 −
    α quantile and form prediction intervals similarly to ICP. Conceptually, this
    method is expected to achieve the desired coverage as it effectively tackles the
    issue of overfitting. This is because the residuals, |Y i −  ˆ μ  −i(X i)|, are
    computed in an out-of-sample manner, thus providing a more realistic evaluation
    of model performance.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 每次执行刀切回归时，它都会将模型拟合到所有数据点，除了由(Xi, Yi)指定的那个。这个过程使得刀切回归可以估计出单个数据点留下的残差，表示为|Y i
    −  ˆ μ  −i(X i)|。通过将这些单个数据点留下的残差视为非一致性分数，我们可以估计出1 − α分位数，并形成类似于ICP的预测区间。从概念上讲，这种方法有望实现所需的覆盖范围，因为它有效地解决了过拟合的问题。这是因为残差|Y i
    −  ˆ μ  −i(X i)|是在样本外的方式下计算的，因此提供了对模型性能的更现实评估。
- en: However, the jackknife procedure does not have universal theoretical guarantees
    and can have poor coverage properties in certain cases, particularly when the
    data is highly skewed or has heavy tails. Although there are statistical results
    under asymptotic settings or assumptions of stability regarding the jackknife
    regression algorithm, it is clear that in situations where the jackknife estimator
    is unstable, the jackknife method can result in a loss of predictive coverage.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，刀切程序并没有普遍的理论保证，在某些情况下可能具有较差的覆盖特性，尤其是当数据高度偏斜或具有重尾时。尽管在刀切回归算法的渐近设置或稳定性假设下有统计结果，但很明显，在刀切估计量不稳定的情况下，刀切方法可能导致预测覆盖范围的损失。
- en: In some cases, the jackknife method can even have zero coverage, meaning that
    the true value is not contained in the estimated prediction interval. Additionally,
    the jackknife method can be computationally intensive as it requires fitting the
    model multiple times on reduced datasets.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，刀切方法甚至可以有零覆盖，这意味着真实值不包含在估计的预测区间内。此外，刀切方法可能计算量很大，因为它需要在减少的数据集上多次拟合模型。
- en: These challenges prompted the creation of an improved variant known as jackknife+.
    This method not only aims to bolster the original jackknife method’s coverage
    properties and computational efficiency but also aligns with the conformal prediction
    family of methods. As a result, jackknife+ benefits from all the robust features
    of the conformal prediction framework. It guarantees validity even in final samples
    of any size, exhibits a distribution-free nature, and is versatile enough to be
    applied to any regression model.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 这些挑战促使人们创造了一种改进的变体，称为刀切+。这种方法不仅旨在加强原始刀切方法的覆盖特性和计算效率，而且与符合预测方法家族保持一致。因此，刀切+从符合预测框架的所有稳健特性中受益。它保证了即使在任何大小的最终样本中也能保证有效性，表现出无分布的特性，并且足够灵活，可以应用于任何回归模型。
- en: The main difference between the jackknife and jackknife+ methods for constructing
    predictive intervals is that the jackknife+ method uses leave-one-out predictions
    at the test point to account for the variability in the fitted regression function,
    in addition to the quantiles of leave-one-out residuals used by the jackknife
    method. This modification allows the jackknife+ method to provide rigorous coverage
    guarantees, regardless of the distribution of the data points, for any algorithm
    that treats the training points symmetrically. In contrast, the original jackknife
    method offers no theoretical guarantees without stability assumptions and can
    sometimes have poor coverage properties. Leave-one-out predictions capture the
    uncertainty in the fitted model’s predictions at the target point, allowing the
    intervals to adapt based on model variability. In contrast, the original jackknife
    method offers no theoretical guarantees without stability assumptions and can
    sometimes have poor coverage properties.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 构建预测区间时，jackknife方法和jackknife+方法之间的主要区别在于，jackknife+方法在测试点使用留一法预测来解释拟合回归函数的变异性，以及除了jackknife方法使用的留一法残差分位数外。这种改进使得jackknife+方法能够为任何将训练点对称对待的算法提供严格的覆盖保证，无论数据点的分布如何。相比之下，原始的jackknife方法在没有稳定性假设的情况下不提供理论保证，有时可能具有较差的覆盖特性。留一法预测捕捉了在目标点拟合模型预测的不确定性，使区间能够根据模型变异性进行调整。相比之下，原始的jackknife方法在没有稳定性假设的情况下不提供理论保证，有时可能具有较差的覆盖特性。
- en: The jackknife+ method is related to cross-conformal prediction proposed by Vovk
    in that both methods aim to construct predictive intervals that provide rigorous
    coverage guarantees, regardless of the distribution of the data points, for any
    algorithm that treats the training points symmetrically.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: jackknife+方法与Vovk提出的交叉一致性预测有关，因为这两种方法都旨在构建提供严格覆盖保证的预测区间，无论数据点的分布如何，对于任何将训练点对称对待的算法。
- en: However, the jackknife+ method differs from cross-conformal prediction in that
    it uses leave-one-out predictions at the test point to account for the variability
    in the fitted regression function and the quantiles of leave-one-out residuals
    used by cross-conformal prediction.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，jackknife+方法与交叉一致性预测不同，因为它在测试点使用留一法预测来解释拟合回归函数的变异性以及交叉一致性预测中使用的留一法残差的分位数。
- en: Jackknife+ regression
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Jackknife+回归
- en: To recap, ICP provides validity guarantees at a user-specified 1 − α confidence
    level and is highly computationally efficient as it does not necessitate retraining
    the base regression model. However, these advantages come at the expense of needing
    to divide the data into a separate calibration dataset. As this reduces the amount
    of data available for training the underlying regressor, it can lead to a less
    optimal fit for the regression model and subsequently wider prediction intervals,
    particularly if the original dataset is small. Conversely, if the calibration
    set is small, it could result in higher variability.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾一下，ICP在用户指定的1 − α置信水平下提供有效性保证，并且由于它不需要重新训练基础回归模型，因此在计算上非常高效。然而，这些优势是以需要将数据分成单独的校准数据集为代价的。由于这减少了可用于训练基础回归器的数据量，可能会导致回归模型拟合度降低，从而预测区间变宽，尤其是在原始数据集较小的情况下。相反，如果校准集较小，可能会导致更高的变异性。
- en: 'Jackknife+ is a modification of jackknife. Similar to jackknife, we fit the
    regressor *n* times for each of the *n* points in the dataset:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: Jackknife+是对jackknife的一种改进。与jackknife类似，我们对数据集中的每个点*n*进行*n*次回归器的拟合：
- en: ˆ μ  −i = 𝒜((X 1, Y 1), … , (X i−1, Y i−1), (X i+1, Y i+1), … , (X n, Y n))
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: ˆμ−i = 𝒜((X1, Y1), … , (Xi−1, Yi−1), (Xi+1, Yi+1), … , (Xn, Yn))
- en: The primary distinction between the jackknife and jackknife+ methods lies in
    the latter’s utilization of leave-one-out predictions at the test point, in addition
    to the quantiles of leave-one-out residuals that the jackknife method employs.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: jackknife方法和jackknife+方法之间的主要区别在于，后者除了使用jackknife方法使用的留一法残差分位数外，还在测试点使用留一法预测。
- en: 'The prediction interval generated by the jackknife+ method leverages quantiles
    to construct prediction intervals. However, it not only examines the quantiles
    of leave-one-out prediction errors but it also considers the *n* predictions produced
    by the regression model for the point prediction of X n+1\. This approach effectively
    broadens the scope of the predictive model, taking into account both error estimations
    and individual predictions:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: Jackknife+方法生成的预测区间利用分位数来构建预测区间。然而，它不仅检查留一法预测错误的分位数，还考虑了回归模型对X n+1点预测产生的*n*个预测。这种方法有效地扩大了预测模型的范围，同时考虑了误差估计和个别预测：
- en: ˆ C  n,α jackknife +(X n+1) = [ ˆ q  n,α − { ˆ μ  −i(X n+1) − R i LOO},  ˆ q  n,α + { ˆ μ  −i(X n+1)
    + R i LOO}]
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: ˆ C  n,α Jackknife +(X n+1) = [ ˆ q  n,α − { ˆ μ  −i(X n+1) − R i LOO},  ˆ q  n,α + { ˆ μ  −i(X n+1)
    + R i LOO}]
- en: 'Compare this formula with the formula for jackknife:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 将此公式与Jackknife的公式进行比较：
- en: ˆ C  n,α jackknife (X n+1) = [ ˆ q  n,α − { ˆ μ (X n+1) − R i LOO},  ˆ q  n,α + { ˆ μ (X n+1)
    + R i LOO}]
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: ˆ C  n,α Jackknife (X n+1) = [ ˆ q  n,α − { ˆ μ (X n+1) − R i LOO},  ˆ q  n,α + { ˆ μ (X n+1)
    + R i LOO}]
- en: The significant divergence between jackknife and jackknife+ lies in the manner
    in which point predictions are made for the X n+1 test point. While the jackknife
    model makes the prediction only once, the jackknife+ model makes *n* predictions,
    each time fitting the model to *n-1* data points while excluding one point at
    a time.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: Jackknife和Jackknife+之间的显著差异在于对X n+1测试点进行点预测的方式。虽然Jackknife模型只进行一次预测，但Jackknife+模型进行*n*次预测，每次将模型拟合到*n-1*个数据点，同时每次排除一个点。
- en: This structure effectively accommodates potential instability in the regression
    algorithm, an issue that previously hindered jackknife from fulfilling theoretical
    validity guarantees. In scenarios where the regression model is highly sensitive
    to the training data, the output can vary substantially. Thus, jackknife+ provides
    a more nuanced and flexible prediction model, catering to possible variability
    in the data.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 这种结构有效地适应了回归算法中可能的不稳定性，这是一个以前阻碍Jackknife实现理论有效性保证的问题。在回归模型对训练数据高度敏感的情况下，输出可能会显著变化。因此，Jackknife+提供了一个更加细致和灵活的预测模型，以适应数据可能的变化。
- en: 'The following figure presents a comparative illustration of prediction intervals
    produced by both the jackknife and jackknife+ models:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了Jackknife和Jackknife+模型产生的预测区间的比较图：
- en: '![Figure 7.6 – Prediction intervals produced by jackknife and jackknife+](img/B19925_07_06.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![图7.6 – Jackknife和Jackknife+模型产生的预测区间](img/B19925_07_06.jpg)'
- en: Figure 7.6 – Prediction intervals produced by jackknife and jackknife+
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.6 – Jackknife和Jackknife+模型产生的预测区间
- en: In scenarios where the regression algorithm is stable, both models perform quite
    similarly, delivering empirical coverage approximately equal to 1 − α. However,
    in situations where the regression model is unstable and sensitive to training
    data, to the extent that removing a single data point can significantly alter
    the predicted value at X n+1, the output from both models can diverge significantly.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 在回归算法稳定的情况下，两种模型的表现相当相似，提供的经验覆盖度大约等于1 − α。然而，在回归模型不稳定且对训练数据敏感的情况下，以至于删除单个数据点可以显著改变X n+1处的预测值，两个模型的输出可能会显著偏离。
- en: Contrary to the jackknife method, which lacks theoretical validity guarantees,
    the jackknife+ model will, even in the worst-case scenarios, assure coverage of
    at least 1-2\alpha. Furthermore, in most practical scenarios, barring instances
    involving instability, the jackknife+ model is expected to provide empirical coverage
    of 1-\alpha, making it a robust method for uncertainty prediction.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 与缺乏理论有效性保证的Jackknife方法相反，Jackknife+模型即使在最坏的情况下也能保证至少1-2\alpha的覆盖度。此外，在大多数实际场景中，除非涉及不稳定的实例，否则预计Jackknife+模型将提供1-\alpha的经验覆盖度，使其成为不确定性预测的稳健方法。
- en: While the jackknife method provides a robust way of calculating nonconformity
    scores, it has a significant computational overhead as it requires retraining
    the model for each instance in the calibration set. This is where the jackknife+
    method comes in.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然Jackknife方法提供了一种计算非一致性分数的稳健方法，但它具有显著的计算开销，因为它需要为校准集中的每个实例重新训练模型。这就是Jackknife+方法出现的地方。
- en: The jackknife+ method improves upon the jackknife method by allowing for the
    calculation of nonconformity scores without the need to retrain the model for
    each instance in the calibration set. This is achieved by adjusting the nonconformity
    score calculation to account for the influence of each example on the model’s
    predictions.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: jackknife+方法通过允许在不重新训练校准集中的每个实例的情况下计算非一致性分数，从而改进了jackknife方法。这是通过调整非一致性分数的计算来考虑每个示例对模型预测的影响来实现的。
- en: First, the jackknife+ method trains the model on the entire training dataset.
    Then, for each instance in the calibration set, the method calculates an adjusted
    prediction that approximates the prediction that would have been made if the instance
    had been left out when training the model. The nonconformity score for each instance
    is the absolute difference between its actual value and the adjusted prediction.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，jackknife+方法在完整训练数据集上训练模型。然后，对于校准集中的每个实例，该方法计算一个调整后的预测，该预测近似于在训练模型时省略该实例所做出的预测。每个实例的非一致性分数是其实际值与调整后预测之间的绝对差。
- en: The primary benefit of the Jackknife+ method is computational efficiency as
    it doesn’t require the model to be retrained for each instance in the calibration
    set.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: Jackknife+方法的主要优点是计算效率，因为它不需要为校准集中的每个实例重新训练模型。
- en: Conformal predictive distributions
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一致预测分布
- en: '**Conformal predictive distribution** (**CPD**) is an innovative method that
    applies the principles of conformal prediction to generate predictive distributions.
    These distributions provide a comprehensive view of prediction uncertainty, offering
    not just interval estimates but a complete distribution over all potential outcomes.'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '**一致预测分布**（**CPD**）是一种创新方法，它将一致预测的原则应用于生成预测分布。这些分布提供了对预测不确定性的全面视图，不仅提供了区间估计，而且还提供了所有潜在结果的完整分布。'
- en: The concept of CPD was first introduced in the paper *Nonparametric predictive
    distributions based on Conformal Prediction* ([https://link.springer.com/article/10.1007/s10994-018-5755-8](https://link.springer.com/article/10.1007/s10994-018-5755-8)),
    by Vladimir Vovk, Jieli Shen, Valery Manokhin, and Min-ge Xie. In this paper,
    the authors applied conformal prediction to derive valid predictive distributions
    under a nonparametric assumption.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: CPD的概念首次在论文《基于一致预测的非参数预测分布*》([https://link.springer.com/article/10.1007/s10994-018-5755-8](https://link.springer.com/article/10.1007/s10994-018-5755-8))中提出，作者为Vladimir
    Vovk、Jieli Shen、Valery Manokhin和Min-ge Xie。在这篇论文中，作者将一致预测应用于在非参数假设下推导有效的预测分布。
- en: In a subsequent paper, *Conformal predictive distributions with kernels* ([https://arxiv.org/abs/1710.08894](https://arxiv.org/abs/1710.08894)),
    by Vladimir Vovk, Ilia Nouretdinov, Valery Manokhin, and Alex Gammerman, the authors
    reviewed the history of predictive distributions in statistics and discussed two
    key developments. The first was the integration of predictive distributions into
    machine learning, and the second was the combination of predictive distributions
    with kernel methods.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在随后的论文《*具有核的一致预测分布*》([https://arxiv.org/abs/1710.08894](https://arxiv.org/abs/1710.08894))中，作者Vladimir
    Vovk、Ilia Nouretdinov、Valery Manokhin和Alex Gammerman回顾了统计学中预测分布的历史，并讨论了两个关键发展。第一个是将预测分布集成到机器学习中，第二个是将预测分布与核方法相结合。
- en: In the paper *Cross-conformal predictive distributions* ([http://proceedings.mlr.press/v91/vovk18a.html](http://proceedings.mlr.press/v91/vovk18a.html)),
    by Vladimir Vovk, Ilia Nouretdinov, Valery Manokhin, and Alexander Gammerman,
    the authors extended CPD to any underlying model, whether it be statistical, machine
    learning, or deep learning.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在论文《*交叉一致预测分布*》([http://proceedings.mlr.press/v91/vovk18a.html](http://proceedings.mlr.press/v91/vovk18a.html))中，作者Vladimir
    Vovk、Ilia Nouretdinov、Valery Manokhin和Alexander Gammerman将CPD扩展到任何底层模型，无论是统计模型、机器学习模型还是深度学习模型。
- en: Inductive (split) conformal predictive systems are computationally efficient
    versions of conformal predictive systems that output probability distributions
    for labels of test observations in regression problems. These systems provide
    additional information that can be useful in decision-making.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 归纳（分割）一致预测系统是一致预测系统的计算高效版本，在回归问题中为测试观察值的标签输出概率分布。这些系统提供了在决策中可能有用的额外信息。
- en: Cross-conformal predictive systems are a novel application of conformal prediction
    that facilitates automatic decision-making. They are built on top of split conformal
    predictive systems, and while they can lose their validity in principle, they
    usually satisfy the validity requirement in practice. Therefore, cross-conformal
    predictive systems differ from traditional conformal predictors in that they are
    more computationally efficient versions that can be used for automatic decision-making.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉一致性预测系统是符合预测的一种新颖应用，它促进了自动决策。它们建立在分割一致性预测系统之上，虽然在原则上可能会失去其有效性，但在实践中通常满足有效性要求。因此，交叉一致性预测系统与传统的一致性预测器不同，它们是更高效的计算版本，可用于自动决策。
- en: 'The subsequent figure depicts the CPD prediction process for a single test
    instance:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个图展示了单个测试实例的CPD预测过程：
- en: '![Figure 7.7 – CPD](img/B19925_07_07.jpg)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![图7.7 – CPD](img/B19925_07_07.jpg)'
- en: Figure 7.7 – CPD
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.7 – CPD
- en: Let’s apply these concepts in practice; we will use the notebook *Conformal
    Prediction for* *Regression* ([https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb](https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb)).
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在实践中应用这些概念；我们将使用笔记本 *Conformal Prediction for* *Regression* ([https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb](https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction/blob/main/Chapter_07.ipynb))。
- en: 'We will follow the MAPIE tutorial for CQR. The target variable of this dataset
    is the median house value for the California districts. This dataset comprises
    eight features, including variables such as the house’s age, the neighborhood’s
    median income, the average number of rooms or bedrooms, and even the location
    in latitude and longitude. In total, there are around 20k observations. We compute
    the correlation between features and also between features and the target. As
    is evident from the analysis, the most significant correlation of house prices
    is with the neighborhood’s median income:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将遵循MAPIE教程进行CQR。该数据集的目标变量是加利福尼亚地区的房屋中位数价值。该数据集包括八个特征，包括房屋的年龄、社区的 median 收入、平均房间或卧室数量，甚至经纬度位置。总共有大约20k个观测值。我们计算了特征之间的相关性，以及特征与目标之间的相关性。从分析中可以看出，房价与社区
    median 收入的相关性最为显著：
- en: '![Figure 7.8 – California housing – correlation matrix](img/B19925_07_08.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![图7.8 – 加利福尼亚房价 – 相关系数矩阵](img/B19925_07_08.jpg)'
- en: Figure 7.8 – California housing – correlation matrix
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 – 加利福尼亚房价 – 相关系数矩阵
- en: 'We can also plot the distribution of house prices:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以绘制房价的分布：
- en: '![Figure 7.9 – California housing – histogram of house prices](img/B19925_07_09.jpg)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![图7.9 – 加利福尼亚房价 – 房价直方图](img/B19925_07_09.jpg)'
- en: Figure 7.9 – California housing – histogram of house prices
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 – 加利福尼亚房价 – 房价直方图
- en: 'Now, we can train and optimize the underlying model:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以训练和优化底层模型：
- en: '[PRE9]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-245
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Several methods are used to produce probabilistic predictions, including CQR
    and a variant of jackknife.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 使用多种方法产生概率预测，包括CQR和一种jackknife变体。
- en: 'We can plot the results that are produced by using different methods:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以绘制使用不同方法产生的结果：
- en: '![Figure 7.10 – Predicting California housing prices using various methods](img/B19925_07_10.jpg)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![图7.10 – 使用各种方法预测加利福尼亚房价](img/B19925_07_10.jpg)'
- en: Figure 7.10 – Predicting California housing prices using various methods
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 – 使用各种方法预测加利福尼亚房价
- en: 'We observe increased flexibility in the prediction intervals for CQR compared
    to other methods that maintain a fixed interval width. Specifically, as the prices
    rise, the prediction intervals expand correspondingly. To substantiate these observations,
    we will examine the conditional coverage and interval width across these intervals,
    segmented by quantiles:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 我们观察到，与其他保持固定区间宽度的方法相比，CQR的预测区间具有更高的灵活性。具体来说，随着价格的上升，预测区间相应地扩大。为了证实这些观察结果，我们将检查这些区间内的条件覆盖和区间宽度，按分位数进行分段：
- en: '![Figure 7.11 – Prediction interval coverage by binned house prices depending
    on price level](img/B19925_07_11.jpg)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![图7.11 – 根据价格水平对分箱房价的预测区间覆盖](img/B19925_07_11.jpg)'
- en: Figure 7.11 – Prediction interval coverage by binned house prices depending
    on price level
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.11 – 根据价格水平对分箱房价的预测区间覆盖
- en: As we can see, CQR adjusts to larger prices more adeptly. Its conditional coverage
    closely aligns with the target coverage for higher prices and lower prices where
    other methods exceed the necessary coverage. This adaptation is likely to influence
    the widths of the intervals.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，CQR在调整较大价格方面更为熟练。其条件覆盖率与较高价格和较低价格下的目标覆盖率紧密一致，在其他方法超过必要覆盖率的地方。这种适应性可能会影响区间的宽度。
- en: 'We can also plot interval width by bin:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以按分箱绘制区间宽度：
- en: '![Figure 7.12 – Prediction of interval width by binned house prices depending
    on house price level](img/B19925_07_12.jpg)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![图7.12 – 根据房价水平通过分箱房价预测区间宽度](img/B19925_07_12.jpg)'
- en: Figure 7.12 – Prediction of interval width by binned house prices depending
    on house price level
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.12 – 根据房价水平通过分箱房价预测区间宽度
- en: 'Now, we can look at CPD in action using the same notebook:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以使用相同的笔记本来查看CPD的实际应用：
- en: 'We will demonstrate the use of CPD with the Crepes package. For a quick start
    guide on the Crepes package, refer to https://github.com/henrikbostrom/crepes.
    We will wrap the standard random forest regressor using the `WrapRegressor` class
    from Crepes and fit it (in the usual way) to the proper training set:'
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用Crepes包来演示CPD的使用。有关Crepes包的快速入门指南，请参阅https://github.com/henrikbostrom/crepes。我们将使用Crepes中的`WrapRegressor`类包装标准的随机森林回归器，并以通常的方式将其拟合到适当的训练集：
- en: '[PRE26]'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Then, we will calibrate the regressor using the calibration set:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将使用校准集校准回归器：
- en: '[PRE28]'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The conformal regressor is now ready to generate prediction intervals for the
    test set, utilizing a 99% confidence level. The output will be a NumPy array.
    Each row corresponds to a test instance, with two columns indicating each prediction
    interval’s lower and upper bounds:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 符合性回归器现在已准备好生成测试集的预测区间，使用99%的置信水平。输出将是一个NumPy数组。每一行对应一个测试实例，有两列表示每个预测区间的下限和上限：
- en: '[PRE29]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'We can specify that we wish to trim the intervals to omit impossible values
    – in this scenario, values below 0\. Using the default confidence level (0.95),
    the resulting output intervals will be slightly more concise:'
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以指定我们希望修剪区间以省略不可能的值 – 在这个场景中，值低于0。使用默认的置信水平（0.95），生成的输出区间将稍微更简洁：
- en: '[PRE30]'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'We will employ `DifficultyEstimator()` from `crepes` to make intervals more
    adaptive. Here, the difficulty is estimated by the standard deviation of the target
    of the default k=25 nearest neighbors in the proper training set for each object
    in the calibration set. First, we will obtain the difficulty estimates for the
    calibration set:'
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用`crepes`中的`DifficultyEstimator()`来使区间更适应。在这里，难度是通过校准集中每个对象的适当训练集中默认k=25最近邻的目标的标准差来估计的。首先，我们将获得校准集的难度估计：
- en: '[PRE31]'
  id: totrans-275
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '[PRE32]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'These can now be used for the calibration, which will produce a normalized
    conformal regressor:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这些现在可以用于校准，这将产生一个归一化的符合性回归器：
- en: '[PRE34]'
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'We also need difficulty estimates for the test set, which we provide as input
    to `predict_int`:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还需要测试集的难度估计，我们将它作为输入提供给`predict_int`：
- en: '[PRE35]'
  id: totrans-281
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '[PRE36]'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'We will get the following output:'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们将得到以下输出：
- en: '![Figure 7.13 – Actual versus predicted values with prediction interval coverage](img/B19925_07_13.jpg)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![图7.13 – 实际值与预测值以及预测区间覆盖率的比较](img/B19925_07_13.jpg)'
- en: Figure 7.13 – Actual versus predicted values with prediction interval coverage
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.13 – 实际值与预测值以及预测区间覆盖率的比较
- en: CPD (conformal predictive systems) in the Crepes package
  id: totrans-286
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Crepes包中的CPD（符合性预测系统）
- en: CPD yields cumulative distribution functions (conformal predictive distributions).
    These not only allow us to create prediction intervals but also enable us to derive
    percentiles, calibrated point predictions, and *p* values for specific target
    values. Let’s explore how to accomplish this.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: CPD产生累积分布函数（符合性预测分布）。这不仅允许我们创建预测区间，还使我们能够推导出特定目标值的百分位数、校准点预测和*p*值。让我们探索如何实现这一点。
- en: 'The only modification that’s required is to pass `cps=True` to the `calibrate`
    method:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 所需的唯一修改是将`cps=True`传递给`calibrate`方法：
- en: 'For instance, we can establish normalized Mondrian conformal predictive systems
    by supplying both `bins` and `sigmas` to the `calibrate` method. In this case,
    we will examine Mondrian categories formed by binning the point predictions:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 例如，我们可以通过向`calibrate`方法提供`bins`和`sigmas`来建立归一化的Mondrian符合性预测系统。在这种情况下，我们将检查由分箱点预测形成的Mondrian类别：
- en: '[PRE37]'
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '[PRE38]'
  id: totrans-291
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'By supplying `bins` (and `sigmas`) for the test objects, we can make predictions
    using the conformal predictive system by utilizing the `predict_cps` method. This
    method offers flexible control over the output. In this instance, we seek to obtain
    prediction intervals with 95% confidence:'
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过为测试对象提供`bins`（和`sigmas`），我们可以通过使用`predict_cps`方法利用正则预测系统进行预测。此方法提供了对输出的灵活控制。在此实例中，我们寻求获得95%置信水平的预测区间：
- en: '[PRE39]'
  id: totrans-293
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '[PRE40]'
  id: totrans-294
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-295
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'We can instruct the `predict_cps` method to return the complete CPD for each
    test instance, as delineated by the threshold values, by setting `return_cpds=True`.
    The structure of these distributions differs based on the type of conformal predictive
    system. For standard and normalized CPS, the output is an array with a row for
    each test instance and a column for each calibration instance (residual). Conversely,
    for a Mondrian CPS, the default output is a vector with one CPD for each test
    instance, as the number of values may fluctuate between categories:'
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以通过设置`return_cpds=True`来指示`predict_cps`方法返回每个测试实例的完整CPD，这些CPD由阈值值界定。这些分布的结构根据正则预测系统的类型而有所不同。对于标准化和归一化的CPS，输出是一个数组，每行对应一个测试实例，每列对应一个校准实例（残差）。相反，对于Mondrian
    CPS，默认输出是一个向量，每个测试实例有一个CPD，因为值数量可能在类别之间波动：
- en: '[PRE42]'
  id: totrans-297
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'We can plot CPD for a random object from the test set:'
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以绘制测试集中随机对象的CPD：
- en: '![Figure 7.14 – CPD for a test object](img/B19925_07_14.jpg)'
  id: totrans-299
  prefs: []
  type: TYPE_IMG
  zh: '![图7.14 – 测试对象的CPD](img/B19925_07_14.jpg)'
- en: Figure 7.14 – CPD for a test object
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.14 – 测试对象的CPD
- en: Summary
  id: totrans-301
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter explored uncertainty quantification for regression problems, a
    critical aspect of data science and machine learning. It highlighted the importance
    of uncertainty and the methods to handle it effectively to make more reliable
    predictions and decisions.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 本章探讨了回归问题的不确定性量化，这是数据科学和机器学习的一个关键方面。它强调了不确定性的重要性以及有效处理不确定性的方法，以做出更可靠的预测和决策。
- en: One of the significant sections of this chapter was dedicated to various approaches
    that can be used to produce prediction intervals. It systematically broke down
    and explained diverse methods, elucidating how each works and their advantages
    and disadvantages. This detailed analysis aids in understanding the mechanisms
    behind these approaches and their practical application in real-world regression
    problems.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的一个重要部分是介绍可用于生成预测区间的各种方法。它系统地分解并解释了不同的方法，阐明了每种方法的工作原理及其优缺点。这种详细分析有助于理解这些方法背后的机制及其在现实世界回归问题中的实际应用。
- en: Furthermore, this chapter discussed building prediction intervals and predictive
    distributions using conformal prediction. We provided a step-by-step guide to
    constructing these intervals and distributions. This chapter also offered practical
    insights and tips for effectively utilizing conformal prediction to achieve more
    reliable and trustworthy predictions in regression problems.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，本章讨论了使用正则预测来构建预测区间和预测分布。我们提供了构建这些区间和分布的逐步指南。本章还提供了关于如何有效地利用正则预测在回归问题中实现更可靠和可信预测的实际见解和建议。
- en: In addition, we delved into advanced topics such as CQR, jackknife+, and CPD.
    These advanced techniques were broken down and explained in detail, helping you
    grasp their complexity and utility in handling regression problems.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们还深入探讨了高级主题，如CQR、jackknife+和CPD。这些高级技术被详细分解和解释，帮助您掌握它们的复杂性和在处理回归问题中的实用性。
- en: Practical illustration was crucial in this chapter, offering hands-on experience
    and insights. This chapter utilized housing price datasets to demonstrate the
    application of the discussed models and techniques. Libraries such as MAPIE and
    Crepes were applied to the datasets, providing you with practical knowledge and
    experience beyond theoretical understanding.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，实际演示至关重要，它提供了实际经验和见解。本章利用房价数据集来展示所讨论的模型和技术应用。MAPIE和Crepes等库被应用于数据集，为您提供超越理论理解的实用知识和经验。
- en: In conclusion, this chapter provided a comprehensive and practical guide that
    covered various topics related to uncertainty quantification, prediction intervals,
    and conformal prediction for regression problems. The realistic illustrations,
    using real-world datasets and libraries, further enhanced the learning experience,
    making this chapter a valuable resource for anyone looking to deepen their understanding
    and strengthen their skills in these critical areas.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，本章提供了一本全面且实用的指南，涵盖了与不确定性量化、预测区间和回归问题的同构预测相关的各种主题。使用真实世界的数据集和库的实例说明进一步增强了学习体验，使本章成为任何希望深化对这些关键领域理解和加强技能的人的有价值资源。
