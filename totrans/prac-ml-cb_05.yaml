- en: Chapter 5. Nonlinearity
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 5 章。非线性
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍以下食谱：
- en: Generalized additive models - measuring the household income of New Zealand
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 广义加性模型 - 测量新西兰的家庭收入
- en: Smoothing splines - understanding cars and speed
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 光滑样条 - 理解汽车和速度
- en: Local regression - understanding drought warnings and impact
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 局部回归 - 理解干旱预警和影响
- en: Generalized additive models - measuring the household income of New Zealand
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 广义加性模型 - 测量新西兰的家庭收入
- en: An income survey provides a snapshot of income levels for people and households.
    It gives median and average weekly income from most sources. There are income
    comparisons across different population groups. Income is only received intermittently,
    whereas consumption is smoothed over time. As a consequence, it is reasonable
    to expect that consumption is more directly related to current living standards
    than current income, at least for short reference periods.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 收入调查提供了人们和家庭收入水平的快照。它给出了来自大多数来源的中位数和平均每周收入。存在不同人口群体之间的收入比较。收入是间歇性收到的，而消费是随时间平滑的。因此，可以合理地预期，消费与当前生活水平比当前收入更直接相关，至少在短期参考期内是这样。
- en: Getting ready
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: In order to perform shrinkage methods, we will be using a dataset collected
    on the New Zealand Census 2013.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了执行收缩方法，我们将使用 2013 年新西兰人口普查收集的数据集。
- en: Step 1 - collecting and describing data
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 1 - 收集和描述数据
- en: The `nzcensus` package contains demographic values of New Zealand that are more
    than 60 in number. These values have been accumulated at the level of mesh block,
    area unit, territorial authority, and regional council.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '`nzcensus` 包包含超过 60 个新西兰人口统计值。这些值在网格块、面积单位、地区当局和地区议会级别累积。'
- en: How to do it...
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到这一点...
- en: Let's get into the details.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入了解。
- en: Step 2 - exploring data
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 2 - 探索数据
- en: 'The first step is to load the following packages:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是加载以下包：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Removing Chatham Islands from the dataset. `AreaUnits2013` is an esriGeometryPolygon
    Geometry Type object. It defines area units from the 2013 Census pattern:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 从数据集中删除查塔姆群岛。`AreaUnits2013` 是一个 esriGeometryPolygon 几何类型对象。它定义了来自 2013 年人口普查模式的面积单位：
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Creating a color palette function:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 创建颜色调色板函数：
- en: '[PRE2]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Creating labels for popups. The `paste0()` function concatenates vectors after
    converting to character:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 为弹出窗口创建标签。`paste0()` 函数在转换为字符后将向量连接起来：
- en: '[PRE3]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Drawing the map:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制地图：
- en: '[PRE4]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The result is as follows:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - exploring data](img/image_05_001.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 探索数据](img/image_05_001.jpg)'
- en: Step 3 - setting up the data for the model
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 3 - 为模型设置数据
- en: 'Getting the data into a convenient shape. Eliminate the area''s code and name,
    and the redundant coordinate system:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据整理成方便的形状。消除区域的代码和名称，以及冗余的坐标系：
- en: '[PRE5]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Replacing all occurrences of a repetitive pattern. The `gsub()` function searches
    for patterns `"_2013"`, `"2013"`, and `"Prop"`, and then replaces them with `names(au)`:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 替换所有重复模式的实例。`gsub()` 函数搜索模式 `"_2013"`、`"2013"` 和 `"Prop"`，然后将它们替换为 `names(au)`：
- en: '[PRE6]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Fetching a logical vector indicating that a set of cases is complete:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 获取一个逻辑向量，指示一组案例是否完整：
- en: '[PRE7]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Providing a generic name:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 提供一个通用名称：
- en: '[PRE8]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Exploring the dimension of the `data_use` data frame. The `dim()` function
    returns the dimension of the `data_use` frame. The `data_use` `data` frame is
    passed as an input parameter. The result clearly states that there are `1785`
    rows of data and `69` columns:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 探索 `data_use` 数据框的维度。`dim()` 函数返回 `data_use` 框架的维度。将 `data_use` 数据框作为输入参数传递。结果清楚地表明有
    `1785` 行数据和 `69` 列：
- en: '[PRE9]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The result is as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - setting up the data for the model](img/image_05_002.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 3 - 为模型设置数据](img/image_05_002.jpg)'
- en: '[PRE10]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Creating syntactically valid names out of character vectors and setting them.
    The `names()` function sets the names of the `data_use` object while it creates
    syntactically valid names out of character vectors returned:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 从字符向量创建语法有效的名称并设置它们。`names()` 函数在从返回的字符向量创建语法有效的名称的同时设置 `data_use` 对象的名称：
- en: '[PRE11]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Displaying the names created from the `data_use` data frame:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 显示从 `data_use` 数据框创建的名称：
- en: '[PRE12]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The result is as follows:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - setting up the data for the model](img/image_05_003.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 3 - 为模型设置数据](img/image_05_003.jpg)'
- en: Step 4 - building the model
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 4 - 构建模型
- en: 'Estimating the strength of the non-parametric model. `spearman2()` computes
    the square of Spearman''s rho rank correlation, and a generalization of it in
    which *x* can relate non-monotonically to *y*. This is done by computing the Spearman
    multiple rho-squared between *(rank(x), rank(x)^2)*, and *y*:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 估计非参数模型的强度。`spearman2()`计算Spearman的rho秩相关系数的平方，以及其推广，其中*x*可以非单调地与*y*相关。这是通过计算*(rank(x),
    rank(x)^2)*与*y*之间的Spearman多重rho平方来完成的：
- en: '[PRE13]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Ordering data in descending order:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 按降序排列数据：
- en: '[PRE14]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The result is as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - building the model](img/image_05_004.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 构建模型](img/image_05_004.jpg)'
- en: 'Allocating flexible splines to the first 15 variables. The `terms()` function
    extracts `terms` objects from multiple R data objects:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 将灵活的样条分配给前15个变量。`terms()`函数从多个R数据对象中提取`terms`对象：
- en: '[PRE15]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Fitting the generalized additive model. `reg_formula` is the formula, while
    `data_use` is the dataset.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 拟合广义加性模型。`reg_formula`是公式，而`data_use`是数据集。
- en: '[PRE16]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Plotting `gam_model`.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制`gam_model`。
- en: '[PRE17]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The result is as follows:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - building the model](img/image_05_005.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 构建模型](img/image_05_005.jpg)'
- en: '[PRE18]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Printing the `rmses_gam_boot` data frame:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`rmses_gam_boot`数据框：
- en: '[PRE19]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The result is as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - building the model](img/image_05_006.jpg)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 构建模型](img/image_05_006.jpg)'
- en: 'Calculating the mean of `rmses_gam_boot$t`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 计算`rmses_gam_boot$t`的均值：
- en: '[PRE20]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Printing the `gam_rmse` data frame:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`gam_rmse`数据框：
- en: '[PRE21]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The result is as follows:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - building the model](img/image_05_007.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 构建模型](img/image_05_007.jpg)'
- en: Smoothing splines - understanding cars and speed
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 平滑样条 - 理解汽车和速度
- en: 'In order to determine the parameters required in statistics for fitting a model,
    multiple methods can be used. In each of the cases, fitting involves the estimating
    of a small number of parameters from the data. Apart from estimating parameters,
    two important stages are the identification of a suitable model and the verification
    of the model. These smoothing methods can be used in a variety of ways: to aid
    understanding and produce smoothed plots, to identify a suitable parametric model
    from the shape of the smoothed data, or to focus on the effects of interest in
    order to eliminate complex effects which are of no use.'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定用于拟合模型的统计参数，可以使用多种方法。在每种情况下，拟合都涉及从数据中估计少量参数。除了估计参数外，两个重要阶段是确定合适的模型和验证模型。这些平滑方法可以以多种方式使用：帮助理解并生成平滑图，从平滑数据形状中识别合适的参数模型，或者专注于感兴趣的效应，以消除无用的复杂效应。
- en: How to do it...
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到这一点...
- en: Let's get into the details.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入了解细节。
- en: Step 1 - exploring the data
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤1 - 探索数据
- en: 'The first step is to load the following packages:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是加载以下包：
- en: '[PRE22]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Creating a matrix. The `cbind()` function takes the sequence of numbers and
    creates a matrix. The result is then passed to the `matrix()` function, which
    creates the matrix with two rows. The result is then stored in the matrix:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 创建矩阵。`cbind()`函数将数字序列组合成一个矩阵。然后将结果传递给`matrix()`函数，创建一个两行的矩阵。结果存储在矩阵中：
- en: '[PRE23]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Step 2 - creating the model
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤2 - 创建模型
- en: 'Cholesky factorization creates positive-definite matrix *A*, which can be factored
    as *A=LL^T*, where *L* is lower triangular with positive diagonal elements. The `chol()` function
    computes Cholesky factorization of a real, symmetrical, positive-definite square
    matrix. The result is then stored in `cholsky`:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Cholesky分解创建正定矩阵*A*，它可以分解为*A=LL^T*，其中*L*是下三角矩阵，对角线元素为正。`chol()`函数计算实对称正定方阵的Cholesky分解。结果存储在`cholsky`中：
- en: '[PRE24]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![Step 2 - creating the model](img/image_05_008.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![步骤2 - 创建模型](img/image_05_008.jpg)'
- en: 'Number of observations for density distribution:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 密度分布的观测数：
- en: '[PRE25]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Calculating a matrix using normal distribution. `rnorm()` calculates normal
    distribution, with `numobs` as the number of observations to be used. The result
    is then used by the `matrix()` function to the compute matrix, with `nrow=nvars`
    as two rows and `ncol=numobs` as 1,000 columns. The result is stored in `random_normal`:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 使用正态分布计算矩阵。`rnorm()`计算正态分布，`numobs`为要使用的观测数。然后将结果用于`matrix()`函数计算矩阵，`nrow=nvars`为两行，`ncol=numobs`为1,000列。结果存储在`random_normal`中：
- en: '[PRE26]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Performing matrix multiplication. `cholsky` is multiplied with matrix `random_normal`:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 执行矩阵乘法。`cholsky`与矩阵`random_normal`相乘：
- en: '[PRE27]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Transposing matrix `X`:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 转置矩阵`X`：
- en: '[PRE28]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Creating a data frame of the matrix. The `as.data.frame()` function creates
    the data frame raw, tightly coupled collections of variables which share many
    of the properties of matrix `newX`:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 创建矩阵的数据框。`as.data.frame()` 函数创建数据框 raw，它是一组紧密耦合的变量，这些变量共享矩阵 `newX` 的许多属性：
- en: '[PRE29]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Printing the raw data frame. The `head()` function returns the first part of
    the raw data frame. The raw data frame is passed as an input parameter:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 打印原始数据框。`head()` 函数返回原始数据框的第一部分。原始数据框作为输入参数传递：
- en: '[PRE30]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The result is as follows:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_009.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_009.jpg)'
- en: 'Creating a transposed data frame of `random_normal`. The `t()` function creates
    a transposed matrix of the `random_normal` matrix, which is then converted to
    tightly coupled collections of variables. These share many of the properties of
    the matrix:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 创建 `random_normal` 的转置数据框。`t()` 函数创建 `random_normal` 矩阵的转置矩阵，然后将其转换为紧密耦合的变量集合。这些变量共享矩阵的许多属性：
- en: '[PRE31]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Combining the names response and `predictor1`. The `c()` function combines
    the arguments response and `predictor1` to form a vector:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 结合响应和 `predictor1` 的名称。`c()` 函数将响应和 `predictor1` 作为参数结合，形成一个向量：
- en: '[PRE32]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Exponential rise of `raw$predictor1` to power 3:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`raw$predictor1` 的指数增长到 3 次方：'
- en: '[PRE33]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Printing the `raw$predictor1_3` data frame. The `head()` function returns the
    first part of the `raw$predictor1_3` data frame. The `raw$predictor1_3data` frame
    is passed as an input parameter:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `raw$predictor1_3` 数据框。`head()` 函数返回 `raw$predictor1_3` 数据框的第一部分。`raw$predictor1_3`
    数据框作为输入参数传递：
- en: '[PRE34]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The result is as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_010.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_010.jpg)'
- en: 'Exponential rise of `raw$predictor1` to power 2:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '`raw$predictor1` 的指数增长到 2 次方：'
- en: '[PRE35]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Printing the `raw$predictor1_2` data frame. The `head()` function returns the
    first part of the `raw$predictor1_2` data frame. The `raw$predictor1_2` data frame
    is passed as an input parameter:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `raw$predictor1_2` 数据框。`head()` 函数返回 `raw$predictor1_2` 数据框的第一部分。`raw$predictor1_2`
    数据框作为输入参数传递：
- en: '[PRE36]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The result is as follows:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_011.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_011.jpg)'
- en: 'Building an ordinary least squares estimation with `raw$response ~ raw$predictor1_3`
    as the formula. The `lm()` function is used to fit linear models. `raw$response
    ~ raw$predictor1_3` is the formula. The result is then stored in the fit data
    frame:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `raw$response ~ raw$predictor1_3` 作为公式的普通最小二乘估计。`lm()` 函数用于拟合线性模型。`raw$response
    ~ raw$predictor1_3` 是公式。结果存储在拟合数据框中：
- en: '[PRE37]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Printing the fit data frame:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 打印拟合数据框：
- en: '[PRE38]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The result is as follows:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_012.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_012.jpg)'
- en: 'Plotting the ordinary least squares estimation formula. The `plot()` function
    is a Generic function for plotting R objects. The `raw$response ~ raw$predictor1_3`
    formula is passed as a function value:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制普通最小二乘估计公式。`plot()` 函数是用于绘制 R 对象的通用函数。`raw$response ~ raw$predictor1_3` 公式作为函数值传递：
- en: '[PRE39]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The result is as follows:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_013.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_013.jpg)'
- en: 'Adding a straight function through the current plot:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在当前图表上添加直线函数：
- en: '[PRE40]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The result is as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - creating the model](img/image_05_014.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 创建模型](img/image_05_014.jpg)'
- en: 'Fitting the value of cars and speeds on the *x* axis:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *x* 轴上拟合汽车和速度的值：
- en: '[PRE41]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Fitting the value of cars and speeds on the y axis:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在 y 轴上拟合汽车和速度的值：
- en: '[PRE42]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Setting the number of points for smooth curve evaluation:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 设置平滑曲线评估的点数：
- en: '[PRE43]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Step 3 - fitting the smooth curve model
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 3 步 - 拟合平滑曲线模型
- en: Fitting a smooth curve between two variables is a non-parametric method, because
    the linearity assumptions of conventional regression methods have been relaxed.
    It is called **local regression**, because the fitting at, say, point *x*, is
    weighted toward the data nearest to *x*.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在两个变量之间拟合平滑曲线是一种非参数方法，因为传统回归方法的线性假设已经被放宽。它被称为**局部回归**，因为在点 *x* 处的拟合是加权向 *x*
    附近的数据：
- en: 'The `loess.smooth()` function plots and adds a smooth curve computed to a scatter
    plot. `x_axis`, `y_axis` are the arguments provided to the x and y coordinates
    of the plot. `evaluation = eval.length` for example `eval_length = 50`, represents
    the points for smooth curve evaluation. `span=.75` is the smoothness parameter.
    `degree=1` is the degree of the local polynomial:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '`loess.smooth()`函数在散点图上绘制并添加计算出的平滑曲线。`x_axis`，`y_axis`是提供给绘图x和y坐标的参数。例如`evaluation
    = eval.length`，`eval_length = 50`表示平滑曲线评估的点数。`span=.75`是平滑度参数。`degree=1`是局部多项式的次数：'
- en: '[PRE44]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Printing the `fit_loess` data frame:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_loess`数据框：
- en: '[PRE45]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'The result is as follows:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_015.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_015.jpg)'
- en: 'Fitting a polynomial surface on the basis of one or more numerical predictors,
    using local fitting. The `loess()` function fits the polynomial surface. `y_axis
    ~ x_axis` represents the formula. `span=.75` is the smoothness parameter. `degree=1`
    is the degree of the local polynomial:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个或多个数值预测的基础上，使用局部拟合拟合多项式表面。`loess()`函数拟合多项式表面。`y_axis ~ x_axis`表示公式。`span=.75`是平滑度参数。`degree=1`是局部多项式的次数：
- en: '[PRE46]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Printing the `fit_loess_2` data frame:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_loess_2`数据框：
- en: '[PRE47]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'The result is as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_016.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_016.jpg)'
- en: 'Generating regular sequences of minimum and maximum values of the *y* axis.
    The `Seq()` function takes in `length.out=eval_length` for example `eval_length
    = 50`, which indicates the desired length of the sequence to be generated from
    the minimum and maximum values of the *x* axis:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 生成*y*轴最小值和最大值的常规序列。`Seq()`函数接受`length.out=eval_length`，例如`eval_length = 50`，表示从*x*轴的最小值和最大值生成的序列的期望长度：
- en: '[PRE48]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Printing the `new_x_axis` data frame:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`new_x_axis`数据框：
- en: '[PRE49]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The result is as follows:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_017.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_017.jpg)'
- en: 'Setting a confidence level of 95% on the `fit.loess` model:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在`fit.loess`模型上设置95%的置信水平：
- en: '[PRE50]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Building an ordinary least squares estimation with `y_axis ~ x_axis` as the
    formula. The `lm()` function is used to fit linear models. `y_axis ~ x_axis` is
    the formula. The result is then stored in the `fit_lm` data frame:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`y_axis ~ x_axis`作为公式构建普通最小二乘估计。使用`lm()`函数拟合线性模型。`y_axis ~ x_axis`是公式。结果存储在`fit_lm`数据框中：
- en: '[PRE51]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Printing the `fit_lm` data frame:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_lm`数据框：
- en: '[PRE52]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The result is as follows:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_018.jpg)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_018.jpg)'
- en: 'Building a polynomial function. `y_axis ~ poly(x_axis,3)` is a polynomial function
    with three degrees of freedom. The `lm()` function is used to fit linear models.
    `y_axis ~ poly(x_axis,3)` is the formula. The result is then stored in the `fit_poly`
    data frame:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 构建多项式函数。`y_axis ~ poly(x_axis,3)`是具有三个自由度的多项式函数。使用`lm()`函数拟合线性模型。`y_axis ~ poly(x_axis,3)`是公式。结果存储在`fit_poly`数据框中：
- en: '[PRE53]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Printing the `fit_poly` data frame:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_poly`数据框：
- en: '[PRE54]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The result is as follows:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_019.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_019.jpg)'
- en: 'Building a natural spline function. `y_axis ~ ns(x_axis, 3)` is the natural
    spline function with degree 3 of freedom. The `lm()` function is used to fit linear
    models. `y_axis ~ ns(x_axis, 3)` is the formula. The result is then stored in
    the `fit_nat_spline` data frame:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 构建自然样条函数。`y_axis ~ ns(x_axis, 3)`是具有3个自由度的自然样条函数。使用`lm()`函数拟合线性模型。`y_axis ~
    ns(x_axis, 3)`是公式。结果存储在`fit_nat_spline`数据框中：
- en: '[PRE55]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Printing the `fit_nat_spline` data frame:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_nat_spline`数据框：
- en: '[PRE56]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'The result is as follows:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_020.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_020.jpg)'
- en: 'Smoothing of the spline:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 样条曲线的平滑处理：
- en: '[PRE57]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'Printing the `fit_smth_spline` data frame:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 打印`fit_smth_spline`数据框：
- en: '[PRE58]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'The result is as follows:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - fitting the smooth curve model](img/image_05_021.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![步骤3 - 拟合平滑曲线模型](img/image_05_021.jpg)'
- en: Step 4 - plotting the results
  id: totrans-181
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤4 - 绘制结果
- en: 'Plotting the model:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制模型：
- en: '[PRE59]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'The result is as follows:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_022.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 绘制结果](img/image_05_022.jpg)'
- en: 'Adding additional models to the graph. Plotting LOESS with Confidence Intervals:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 向图中添加额外的模型。绘制带有置信区间的LOESS：
- en: '[PRE60]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'The result is as follows:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_023.jpg)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![步骤4 - 绘制结果](img/image_05_023.jpg)'
- en: 'Plotting an ordinary least squares estimation. The `predict()` function predicts
    values based on linear models. `fit_lm` is an object of class `lm`:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制普通最小二乘估计。`predict()` 函数根据线性模型预测值。`fit_lm` 是 `lm` 类的对象：
- en: '[PRE61]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'The result is as follows:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_024.jpg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 绘制结果](img/image_05_024.jpg)'
- en: 'Plotting a polynomial function estimation:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制多项式函数估计：
- en: '[PRE62]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'The result is as follows:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/B04714_05_38.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 绘制结果](img/B04714_05_38.jpg)'
- en: 'Plotting a natural spline function:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制自然样条函数：
- en: '[PRE63]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'The result is as follows:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_025.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 绘制结果](img/image_05_025.jpg)'
- en: 'Plotting a smoothed spline:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制平滑样条：
- en: '[PRE64]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The result is as follows:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_026.jpg)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 绘制结果](img/image_05_026.jpg)'
- en: 'Plotting a kernel curve. The `ksmooth()` function:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制核曲线。`ksmooth()` 函数：
- en: '[PRE65]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'The result is as follows:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - plotting the results](img/image_05_027.jpg)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 绘制结果](img/image_05_027.jpg)'
- en: Local regression - understanding drought warnings and impact
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 局部回归 - 理解干旱预警和影响
- en: Drought is a natural hazard which is measured and characterized by lower-than-expected
    or lower-than-normal rainfall. This condition, when prolonged over a longer-than-normal
    time period is insufficient to meet the demands of human activities and hazardous
    to the environment. Drought is a temporary phenomenon. Three main distinguishing
    features of droughts are intensity, duration, and spatial coverage. A drought
    early warning system can help to identify the climatic changes, understand water
    supply trends, and prepare for upcoming emergencies. The drought warning can help
    decision-makers take appropriate measures to face the upcoming challenge. They
    can then measure the severity of the impact and understand the underlying causes
    of vulnerability to reduce risk for a particular location and for a specific group
    of people or economic sector.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 干旱是一种自然灾害，其特征是低于预期的或低于正常水平的降雨。当这种状况在超过正常时间周期的更长时期内持续时，不足以满足人类活动的需求，对环境有害。干旱是一种暂时现象。干旱的三个主要特征是强度、持续时间和空间覆盖范围。干旱预警系统可以帮助识别气候变化，了解供水趋势，并为即将到来的紧急情况做好准备。干旱预警可以帮助决策者采取适当的措施来应对即将到来的挑战。然后，他们可以衡量影响的严重程度，并了解特定地点、特定人群或经济部门脆弱性的潜在原因，以降低风险。
- en: Getting ready
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: Let's get started with the recipe.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从配方开始。
- en: Step 1 - collecting and describing data
  id: totrans-214
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 1 步 - 收集和描述数据
- en: The `dataRetrieval` package is a collection of functions to help retrieve **US
    Geological Survey** (**USGS**) and **US Environmental Protection Agency** (**EPA**).
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '`dataRetrieval` 包是一组函数，用于帮助检索美国地质调查局（**USGS**）和美国环境保护署（**EPA**）。'
- en: How to do it...
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: Let's get into the details.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入了解细节。
- en: Step 2 - collecting and exploring data
  id: totrans-218
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 2 步 - 收集和探索数据
- en: 'The first step is to load the following packages:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是加载以下包：
- en: '[PRE66]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Retrieving the site number. The site number is usually an eight-digit number,
    which is represented as a string or vector:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 获取站点编号。站点编号通常是一个八位数的数字，它被表示为一个字符串或向量：
- en: '[PRE67]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Retrieving parameter codes:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 获取参数代码：
- en: '[PRE68]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Using site number and parameter codes importing data from NWIS web service.
    The result is then stored in the `Q_daily` data frame:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 使用站点编号和参数代码从 NWIS 网络服务导入数据。结果存储在 `Q_daily` 数据框中：
- en: '[PRE69]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'Printing the `Q_daily` data frame. The `tail()` function returns the last part
    of the `Q_daily` data frame. The `Q_daily` data frame is passed as an input parameter:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_daily` 数据框。`tail()` 函数返回 `Q_daily` 数据框的最后部分。`Q_daily` 数据框作为输入参数传递：
- en: '[PRE70]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'The result is as follows:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - collecting and exploring data](img/image_05_028.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 收集和探索数据](img/image_05_028.jpg)'
- en: 'Exploring the internal structure of the `Q_daily` data frame. The `str()` function
    displays the internal structure of the data frame. The `Q_daily` is passed as
    an R object to the `str()` function:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 探索 `Q_daily` 数据框的内部结构。`str()` 函数显示数据框的内部结构。`Q_daily` 作为 R 对象传递给 `str()` 函数：
- en: '[PRE71]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'The result is as follows:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - collecting and exploring data](img/image_05_029.jpg)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 收集和探索数据](img/image_05_029.jpg)'
- en: 'Renaming columns--the `renameNWISColumns()` function renames columns retrieved
    from NWIS. `Q_daily` is the daily or unit-values dataset retrieved from NWIS Web:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 重命名列 -- `renameNWISColumns()` 函数重命名从 NWIS 获取的列。`Q_daily` 是从 NWIS 网站获取的每日或单位值数据集：
- en: '[PRE72]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Printing the renamed `Q_daily` data frame. The `tail()` function returns the
    last part of the `Q_daily` data frame. The `Q_daily` data frame is passed as an
    input parameter:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 打印重命名的 `Q_daily` 数据框。`tail()` 函数返回 `Q_daily` 数据框的最后部分。`Q_daily` 数据框作为输入参数传递：
- en: '[PRE73]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'The result is as follows:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 2 - collecting and exploring data](img/image_05_030.jpg)'
  id: totrans-240
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 2 - 收集和探索数据](img/image_05_030.jpg)'
- en: 'Importing data from the USGS file site. The `readNWISsite()` function uses
    `siteNumber` 8 digit number which represents the USGS site number. The result
    is then stored in the `stationInfo` data frame:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 从 USGS 文件站点导入数据。`readNWISsite()` 函数使用 8 位数字的 `siteNumber`，它代表 USGS 站点编号。结果存储在
    `stationInfo` 数据框中：
- en: '[PRE74]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Step 3 - calculating the moving average
  id: totrans-243
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 3 - 计算移动平均
- en: 'Checking for missing days:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 检查缺失天数：
- en: '[PRE75]'
  id: totrans-245
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'Calculating the moving average for 30 days. The `filter()` function applies
    linear filtering to a time series. `sides=1`, the filter coefficients are applied
    for past values only:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 计算 30 天的移动平均。`filter()` 函数对时间序列应用线性滤波。`sides=1`，仅对过去值应用滤波系数：
- en: '[PRE76]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Printing the `Q_daily` data frame. The `tail()` function returns the last part
    of the `Q_daily` data frame. The `Q_daily` data frame is passed as an input parameter:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_daily` 数据框。`tail()` 函数返回 `Q_daily` 数据框的最后部分。`Q_daily` 数据框作为输入参数传递：
- en: '[PRE77]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'The result is as follows:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 3 - calculating the moving average](img/image_05_031.jpg)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 3 - 计算移动平均](img/image_05_031.jpg)'
- en: Step 4 - calculating percentiles
  id: totrans-252
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 4 - 计算百分位数
- en: 'Calculating historical percentiles. The various quantiles are calculated using
    respective probabilities. Then, the data frame is collapsed into a single row,
    using the `summarize()` function. Finally, using the function `group_by()`, the
    results, which are in table form, are converted and grouped into a table:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 计算历史百分位数。使用相应的概率计算各种分位数。然后，使用 `summarize()` 函数将数据框折叠成单行。最后，使用 `group_by()` 函数，将结果（以表格形式）转换为并分组到表格中：
- en: '[PRE78]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'Obtaining the current year from the system:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 从系统中获取当前年份：
- en: '[PRE79]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'Combining each of the data frames:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 合并每个数据框：
- en: '[PRE80]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'Printing the `Q_summary` data frame:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary` 数据框：
- en: '[PRE81]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'The result is as follows:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_032.jpg)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_032.jpg)'
- en: '[PRE82]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'Predicting values based on a linear model and fitting a polynomial surface.
    The `loess()` function fits the polynomial surface. `p75~day.of.year` represents
    the formula, while `span = smooth.span` for example `smooth.span= 0.3`, controls
    the degree of smoothing:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 根据线性模型预测值并拟合多项式曲面。`loess()` 函数拟合多项式曲面。`p75~day.of.year` 表示公式，而 `span = smooth.span`
    例如 `smooth.span= 0.3` 控制平滑程度：
- en: '[PRE83]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'Printing the `Q_summary$sm.75` data frame:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary$sm.75` 数据框：
- en: '[PRE84]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'The result is as follows:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_033.jpg)'
  id: totrans-269
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_033.jpg)'
- en: '[PRE85]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'Printing the `Q_summary$sm.25` data frame:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary$sm.25` 数据框：
- en: '[PRE86]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'The result is as follows:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_034.jpg)'
  id: totrans-274
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_034.jpg)'
- en: '[PRE87]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'Printing the `Q_summary$sm.10` data frame:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary$sm.10` 数据框：
- en: '[PRE88]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'The result is as follows:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_035.jpg)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_035.jpg)'
- en: '[PRE89]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Printing the `Q_summary$sm.05` data frame:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary$sm.05` 数据框：
- en: '[PRE90]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'The result is as follows:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_036.jpg)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_036.jpg)'
- en: '[PRE91]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'Printing the `Q_summary$sm.05` data frame:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary$sm.05` 数据框：
- en: '[PRE92]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'The result is as follows:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_037.jpg)'
  id: totrans-289
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_037.jpg)'
- en: '[PRE93]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'Printing the `Q_summary` data frame:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 打印 `Q_summary` 数据框：
- en: '[PRE94]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'The result is as follows:'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 4 - calculating percentiles](img/image_05_038.jpg)'
  id: totrans-294
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 4 - 计算百分位数](img/image_05_038.jpg)'
- en: '[PRE95]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: Step 5 - plotting results
  id: totrans-296
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 步骤 5 - 绘制结果
- en: 'Plotting the data:'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制数据：
- en: '[PRE96]'
  id: totrans-298
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'The result is as follows:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 5 - plotting results](img/image_05_039.jpg)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 5 - 绘制结果](img/image_05_039.jpg)'
- en: '[PRE97]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'The result is as follows:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 5 - plotting results](img/image_05_040.jpg)'
  id: totrans-303
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 5 - 绘制结果](img/image_05_040.jpg)'
- en: '[PRE98]'
  id: totrans-304
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'The result is as follows:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![Step 5 - plotting results](img/image_05_041.jpg)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![步骤 5 - 绘制结果](img/image_05_041.jpg)'
