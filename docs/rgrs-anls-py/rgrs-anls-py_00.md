# 前言

|   | *"Frustra fit per plura, quod potest fieri per pauciora.**(用更多的东西去做可以用更少的东西完成的事情是徒劳的)"* |   |
| --- | --- | --- |
|   | --*威廉·奥卡姆（1285-1347)* |

线性模型早已为学者和实践者所熟知，并被他们长期研究。在它们被纳入数据科学领域，并被众多训练营的课程大纲以及许多实践指南的早期章节所采用之前，它们一直是统计学、经济学以及许多其他受人尊敬的定量研究领域知识体系中的一个突出且相关的元素。

因此，关于线性回归、逻辑回归（其分类变体）以及不同类型的广义线性模型，有大量的专著、书籍章节和论文；这些模型在公式化中适应了原始的线性回归范式，以解决更复杂的问题。

尽管如此，尽管有如此丰富的资源，我们从未遇到过任何一本书真正解释了当作为一个开发者或数据科学家，你必须快速创建一个应用程序或 API，其响应不能通过编程定义，但确实需要从数据中学习时，这些线性模型的快速和易于实现的速度。

当然，我们非常清楚线性模型的局限性（简单不幸地有一些缺点），我们也知道没有任何数据科学问题有固定的解决方案；然而，我们在该领域的经验告诉我们，线性模型以下优势不容忽视：

+   它很容易向自己、管理层或任何人解释它是如何工作的

+   它在处理你的数据问题时非常灵活，因为它可以处理数值和概率估计、排名以及多达多个类别的分类

+   无论你处理的数据量有多少，训练速度都很快

+   它在任何生产环境中快速且易于实现

+   它可以扩展到对用户实时响应

如果你，就像我们每天所做的那样，至关重要的是以快速和有形的方式从数据中创造价值，只需跟随我们，发现线性模型能帮助你达到多远。

# 本书涵盖的内容

第一章, *回归 – 数据科学的工作马,* 介绍了为什么回归对于数据科学确实很有用，如何快速设置 Python 进行数据科学，并通过示例概述了本书中使用的所有包。在本章的结尾，我们将能够运行以下章节中包含的所有示例。你将清楚地了解回归分析不仅仅是从统计学中取出的一个被低估的技术，而是一个强大且有效的数据科学算法。

第二章, *简单线性回归的入门*，首先通过描述一个回归问题，即如何拟合回归器，然后给出其算法数学公式的直觉，来介绍简单线性回归。然后，您将学习如何调整模型以获得更高的性能并深入理解其每个参数。最后，将描述梯度下降背后的引擎。

第三章, *实际中的多元回归*，将简单线性回归扩展到从多个特征中提取预测信息并创建可以解决现实生活预测任务的模型。在前一章中解释的随机梯度下降技术将被提升以处理特征矩阵，并为了完成概述，您将了解多重共线性、交互作用和多项式回归主题。

第四章, *逻辑回归*，继续奠定您对线性模型知识的基石。从必要的数学定义开始，它展示了如何进一步将线性回归扩展到分类问题，包括二元和多类。

第五章, *数据准备*，讨论了为模型提供数据的内容，描述了如何以最佳方式准备数据以及如何处理不寻常的情况，特别是当数据缺失和存在异常值时。

第六章, *实现泛化*，将向您介绍全面测试您模型的关键数据科学配方，调整其最佳状态，使其简洁，并在将其与真实新鲜数据对比之前，介绍更复杂的技术。

第七章, *在线和批量学习*，阐述了在大数据上训练分类器的最佳实践；它首先关注批量学习及其局限性，然后介绍在线学习。最后，您将看到一个大数据的例子，结合了在线学习的优点和哈希技巧的力量。

第八章, *高级回归方法*，介绍了回归的一些高级方法。我们不会深入到它们的数学公式，但始终关注实际应用，我们将讨论最小角回归、贝叶斯回归和具有铰链损失的随机梯度下降背后的思想，并简要提及袋装和提升技术。

第九章, *回归模型的实际应用*，包含了四个通过线性模型解决的现实世界数据科学问题的实际示例。最终目标是展示如何处理这类问题以及如何围绕其解决方案进行推理，以便它们可以作为你将遇到的类似挑战的蓝图。

# 你需要为这本书准备的内容

本书提供的代码示例的执行需要安装 Python 3.4.3 或更新的版本，在 Mac OS X、Linux 或 Microsoft Windows 上。

本书展示的代码也将频繁使用 Python 的科学和统计计算基本库，如 SciPy、NumPy、Scikit-learn、Statsmodels，在一定程度上使用 matplotlib 和 pandas。

除了利用科学发行版（如 Continuum Analytics 的 Anaconda）来节省创建工作环境中的耗时操作外，我们还建议你采用 Jupyter 及其 IPython 笔记本，这是一种更高效且对科学友好的方式来在 Python 中编写你的线性模型。

第一章将为你提供逐步设置 Python 环境、这些核心库以及所有必要工具的说明和一些有用的提示。

# 本书面向的对象

首先，这本书是为那些至少对数据科学、统计学和数学有基本理解的 Python 开发者所写的。尽管这本书不需要你在数据科学或统计学方面有先前的背景知识，但它可以很好地满足任何资历的数据科学家，他们希望学习如何在数据集上最佳地进行回归分析。我们想象你希望将智能融入你的数据产品，但又不想依赖任何黑盒。因此，你更倾向于选择一种简单、易懂且有效的技术，以便将其用于生产级应用。通过这本书，我们将为你提供使用 Python 构建快速且更好的线性模型以及部署这些模型到 Python 或你喜欢的任何计算机语言中的知识。

# 术语约定

在这本书中，你会找到许多不同的文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 标签以以下方式显示：“检查线性模型时，首先检查`coef_`属性。”

代码块设置如下：

```py
from sklearn import datasets 
iris = datasets.load_iris()  
```

由于我们将使用 IPython 笔记本来展示大部分示例，因此请预期在包含代码块的单元格中始终有一个输入（标记为`In:`）和经常有一个输出（标记为`Out:`）。在你的电脑上，你只需在`In:`之后输入代码，并检查结果是否与`Out:`内容相符：

```py
In: clf.fit(X, y)
Out: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0, degree=3, gamma=0.0, kernel='rbf', max_iter=-1, probability=False, random_state=None, shrinking=True, tol=0.001, verbose=False) 
```

当需要在终端命令行中给出命令时，你会看到带有前缀`$>`的命令，否则，如果它是针对 Python 交互式解释器（REPL），它将前面带有`>>>`：

```py
    $>python
    >>> import sys

>>> print sys.version_info

```

**新术语**和**重要词汇**以粗体显示。你在屏幕上看到的单词，例如在菜单或对话框中，在文本中会以这样的形式出现：“转到**数据库**部分，并使用 UTF 排序创建一个新的数据库。”

### 注意

警告或重要提示会以这样的框出现。

### 小贴士

小贴士和技巧会以这样的形式出现。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们你对这本书的看法——你喜欢什么或不喜欢什么。读者的反馈对我们很重要，因为它帮助我们开发出你真正能从中获得最大价值的标题。

要向我们发送一般反馈，只需通过电子邮件发送到`<feedback@packtpub.com>`，并在邮件的主题中提及本书的标题。

如果你在一个领域有专业知识，并且你对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南，网址为[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 书籍的骄傲所有者了，我们有一些事情可以帮助你从你的购买中获得最大价值。

## 下载示例代码

你可以从[`www.packtpub.com`](http://www.packtpub.com)的账户下载本书的示例代码文件。如果你在其他地方购买了这本书，你可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给你。

你可以通过以下步骤下载代码文件：

1.  使用你的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误表**。

1.  在**搜索**框中输入书的名称。

1.  选择你想要下载代码文件的书籍。

1.  从下拉菜单中选择你购买这本书的地方。

1.  点击**代码下载**。

一旦文件下载完成，请确保使用最新版本的以下软件解压缩或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

## 下载本书的颜色图像

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/RegressionAnalysisWithPython_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/RegressionAnalysisWithPython_ColorImages.pdf)下载此文件。

## 勘误

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何勘误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**勘误提交表单**链接，并输入您的勘误详情来报告它们。一旦您的勘误得到验证，您的提交将被接受，勘误将被上传到我们的网站或添加到该标题的勘误部分下的现有勘误列表中。

要查看之前提交的勘误，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将在**勘误**部分显示。

## 盗版

互联网上版权材料的盗版是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过链接版权@packtpub.com 与我们联系，并提供涉嫌盗版材料的链接。

我们感谢您在保护我们作者和我们为您提供有价值内容的能力方面的帮助。

## 问题

如果您对本书的任何方面有问题，您可以通过链接问题@packtpub.com 与我们联系，我们将尽力解决问题。
