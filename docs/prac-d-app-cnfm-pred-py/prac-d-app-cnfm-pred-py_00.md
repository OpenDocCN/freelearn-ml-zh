# 前言

与“Python 应用符合预测实用指南”一起踏上一次富有洞察力的旅程，这是您掌握机器学习中不确定性量化的全面指南。本书揭示了符合预测的复杂性，重点关注跨越分类、回归、预测、计算机视觉和自然语言处理的实际应用。它还深入探讨了处理不平衡数据集和多类分类挑战的复杂技术，通过案例研究将理论与实际应用相结合。

本资源精心制作，面向多元化的读者群体，包括数据科学家、机器学习工程师、行业专业人士、研究人员、学者和学生，他们有兴趣在各自领域掌握不确定性量化和符合预测。

无论您是刚开始数据科学之旅，还是希望深化现有的专业知识，本书都提供了在机器学习中自信地导航不确定性量化的基础知识和高级策略。

通过“Python 应用符合预测实用指南”，您不仅获得了知识，还获得了将尖端技术应用于行业应用、提高预测模型精度和可靠性的能力。抓住这个机会，利用符合预测的潜力来提升您的机器学习职业生涯。

# 这本书面向谁？

对于对符合预测感兴趣的读者来说，这是一本必读之作，它满足了广泛的职业和学习者的需求。它专门为数据科学家、机器学习工程师、教育者和学者、研究专业人士、应用开发者、对数据充满热情的学生、分析专家以及致力于扩展知识的统计学家设计。

# 本书涵盖内容

*第一章**，介绍符合预测*，《Python 应用符合预测实用指南》的开篇章节为本书的核心主题——符合预测提供了一个基本介绍。它通过阐明符合预测作为有效量化预测不确定性和增强机器学习模型信任的强大框架的目的来奠定基础。

在本章中，我们回顾了这一变革性框架的历史演变和日益增长的赞誉。探讨了支撑符合预测的关键概念和原则，揭示了其多方面的优势。本章强调了符合预测如何与传统机器学习技术区分开来。它通过提供预测区域和置信度度量来实现这一区别，所有这些都有有限的样本有效性保证，同时避免了需要限制性分布假设的需求。

*第二章**，一致性预测概述*，在《Python 应用一致性预测实用指南》的第二章中，我们开始了一段全面探索一致性预测领域的旅程，重点关注其在量化预测不确定性中的关键作用。

本章首先阐述了量化预测不确定性的关键需求，并介绍了随机不确定性和认知不确定性的概念。它强调了与传统的统计、贝叶斯和模糊逻辑方法相比，一致性预测提供的独特优势。这些优势包括保证覆盖范围、摆脱分布约束以及与各种机器学习模型的兼容性。

本章的大部分内容致力于阐明如何在内分类场景下进行一致性预测。它揭示了使用非一致性分数来衡量预测与训练数据分布之间一致性的复杂过程。这些分数随后被转换为 p 值和置信水平，为构建预测集奠定了基础。

第二章向读者提供了对一致性预测原理及其在量化不确定性中的深远意义的深入理解。这种知识在需要伴随预测的可靠置信估计的关键应用中尤其宝贵，增强了结果的总体可信度。

*第三章**，一致性预测的基础知识*，深入探讨了一致性预测背后的基本原理和数学基础。它解释了基本组成部分，如非一致性度量、校准集和预测过程。

它涵盖了分类和回归中的不同类型的非一致性度量，解释了它们的优缺点。流行的选择，如铰链损失、边缘和归一化误差，都得到了讨论。

本章通过示例说明了如何计算非一致性分数、p 值、置信水平和可信度水平。它还解释了校准集的作用、在线与离线一致性预测以及无条件与条件覆盖。

总体而言，*第三章*使读者对一致性预测的核心概念和数学原理有了深刻的理解。通过掌握这些基础，从业者可以将一致性预测应用于增强各种机器学习任务中预测的可靠性。

*第四章**，一致性预测的有效性与效率*，扩展了前一章中引入的概念，并深入探讨了有效性和效率的关键概念。通过实际案例，读者将发现准确（无偏）预测模型的重要性。

本章将深入探讨有效和高效模型的定义、指标和现实世界实例。我们还将探索一致预测提供的内在有效性保证。到本章结束时，你将具备评估和提升预测模型有效性和效率所需的知识，为你在各自领域带来更可靠和有影响力的应用打开大门。

*第五章**，一致预测的类型*，本章探讨了引人入胜的一致预测领域，探讨了其各种类型和独特属性。涵盖的关键主题包括一致预测的基础原理及其在机器学习中的相关性。本章解释了经典的**归纳一致预测**（TCP）和归纳**一致预测**（ICP），指导读者根据具体问题需求选择合适的类型。此外，还介绍了在二分类、多分类和回归中一致预测的实际应用案例。

*第六章**，分类中的一致预测*，本章探讨了用于量化机器学习预测不确定性的不同类型的一致预测器。它涵盖了经典的**归纳一致预测**（TCP）和更高效的**归纳****一致预测**（ICP）的基础。TCP 利用完整数据集进行训练，但需要对每个新预测进行模型重新训练。ICP 将数据分为训练集和校准集，通过一次训练实现计算加速。讨论了不同变体之间的权衡。

本章提供了将 TCP 和 ICP 应用于分类和回归问题的算法描述。它通过代码示例详细介绍了计算非一致性得分、p 值和预测区域。

根据数据大小、实时需求和计算约束等因素，提供了选择合适一致预测器的指南。示例用例说明了何时 TCP 或 ICP 更可取。

我们还介绍了一致预测中称为 Venn-ABERS 预测器的专业技术。

总体而言，本章为读者提供了对不同类型一致预测器的全面了解，以及如何根据问题背景选择最佳方法。

*第七章**，一致性预测在回归中的应用*，本章提供了使用一致性预测对回归问题进行不确定性量化的全面指南。它涵盖了不确定性量化的必要性，生成预测区间的技术，针对回归定制的一致性预测框架，以及如一致性分位数回归、Jackknife+和一致性预测分布等高级方法。读者将学习一致性预测的理论和实际应用，以产生有效、校准良好的预测区间和分布。本章包括使用现实世界房价数据和 Python 库的详细解释和代码示例，以提供实际应用这些方法的动手经验。总体而言，读者将获得可靠量化不确定性和为回归问题构建良好校准预测区域的知识。

*第八章**，一致性预测在时间序列和预测中的应用*，本章致力于一致性预测在时间序列预测领域的应用。

本章从探讨预测中不确定性量化的重要性开始，强调预测区间的概念。它涵盖了生成预测区间的多种方法，包括参数方法、如自助法等非参数技术、贝叶斯方法和一致性预测。

使用 Amazon Fortuna（EnbPI 方法）、Nixtla（statsforecast 包）和 NeuralProphet 等库展示了时间序列一致性预测的实际实现。提供了代码示例，说明了预测区间的生成和有效性的评估。

本质上，第八章为读者提供了实用的工具和技术，以利用一致性预测在时间序列预测模型中创建可靠且校准良好的预测区间。通过采用这些方法，预测者可以有效地量化不确定性并增强其预测的鲁棒性。

*第九章**，一致性预测在计算机视觉中的应用*，在这一章中，我们将开始探索一致性预测在计算机视觉领域的应用。

本章首先强调了在视觉任务中不确定性量化的极端重要性，特别是在具有安全关键影响的领域，如医学成像和自动驾驶。它解决了现代深度学习中的一个常见挑战——过度自信和校准不当的预测。

在突出一致性预测的独特优势之前，包括其无分布保证，探讨了多种不确定性量化方法。

本章生动地展示了符合预测在图像分类中的实际应用，重点关注 RAPS 算法，该算法以其生成紧凑且稳定的预测集而闻名。本章提供了代码示例，说明了在 ImageNet 数据上构建具有良好校准预测集的分类器，采用各种符合预测方法。

从本质上讲，第九章使读者理解了在计算机视觉系统中不确定性量化的价值。它提供了利用符合预测来构建具有有效置信度估计的可靠图像分类器的实践经验。

*第十章**，自然语言处理中的符合预测*，本章探讨了自然语言处理（NLP）中的不确定性量化领域，利用符合预测的力量。

本章首先深入探讨了语言固有的歧义性及其源于复杂深度学习模型的校准预测失误的后果。

比较了不确定性量化各种方法，如贝叶斯方法、自助法和分布外检测，并进行了深思熟虑。本章还揭示了将符合预测应用于 NLP 的机制，包括非一致性分数和 p 值的计算。

采用符合预测进行自然语言处理的优势被巧妙地概述，包括无分布保证、可解释性和适应性。本章还深入当代研究，突出符合预测如何增强大型语言模型的可靠性、安全性和信任度。

*第十一章**，处理不平衡数据*，本章探讨了处理不平衡数据的常见机器学习挑战的解决方案，其中一类数据远多于其他类。它解释了这种分布偏差为何对预测建模造成复杂问题。

本章比较了各种传统方法，如过采样和 SMOTE，指出它们在模型校准方面的问题。然后介绍了符合预测作为一种创新方法来处理不平衡数据，而不会损害可靠性。

通过在现实世界的信用卡欺诈检测数据集上的代码示例，本章展示了即使在高度倾斜的数据中，如何应用符合预测进行概率校准。读者将学习解决不平衡问题的最佳实践，同时确保决策准备好的概率预测。

*第十二章**，多类符合预测*，最后一章探讨了多类分类以及如何将符合预测应用于具有两个以上结果类别的难题。它涵盖了评估模型性能的指标，如精确率、召回率、F1 分数、对数损失和 Brier 分数。

本章解释了将支持向量机或神经网络等二分类算法扩展到多类环境的技术，使用一对一和一对多策略。

然后演示了如何通过正则预测提供每个类别的预测集或区间，并保证其有效性。还介绍了用于多类概率估计的高级方法，如 Venn-ABERS 预测器。

通过代码示例，本章展示了如何在多类问题上实现归纳正则预测，输出具有可信度和置信度分数的预测。读者将学习将正则预测应用于具有多个潜在类别的分类任务的最佳实践。

# 要充分利用本书

您需要在您的计算机上有一个有效的 Python 环境。我们建议使用 Python 3.6 或更高版本。

确保您已安装必要的库，例如 scikit-learn、NumPy 和 Matplotlib。如果没有，您可以使用 Conda 或 pip 轻松安装它们。

笔记本可以在本地运行，也可以使用 Google Colab ([`colab.research.google.com`](https://colab.research.google.com))。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python | Windows, macOS 或 Linux |
| Colab (在 Google Cloud 中运行笔记本) | Windows, macOS 或 Linux |
| MAPIE | Windows, macOS 或 Linux |
| Amazon Fortuna | Windows, macOS 或 Linux |
| NIxtla statsforecast | Windows, macOS 或 Linux |
| NeuralProphet | Windows, macOS 或 Linux |

**如果您正在使用本书的数字版，我们建议您从本书的 GitHub 仓库（下一节中有一个链接）访问代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件 [`github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction`](https://github.com/PacktPublishing/Practical-Guide-to-Applied-Conformal-Prediction)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的书籍和视频目录的代码包，可在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 获取。查看它们吧！

# 使用的约定

本书使用了许多文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 处理。以下是一个示例：首先，我们必须使用 `nonconformist` 的包装器创建 ICP 分类器。

代码块设置如下：

```py
y_pred_calib = model.predict(X_calib)
```

```py
y_pred_score_calib = model.predict_proba(X_calib)
```

```py
y_pred_test = model.predict(X_test)
```

```py
y_pred_score_test = model.predict_proba(X_test)
```

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**: 如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误**: 尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**: 如果您在互联网上发现我们作品的任何形式的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过电子邮件发送至 copyright@packt.com 并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com.](http://authors.packtpub.com.)

# 分享您的想法

一旦您阅读了*Python 应用一致预测实用指南*，我们很乐意听听您的想法！请[点击此处直接进入该书的亚马逊评论页面](https://packt.link/r/1-805-12276-2)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买这本书！

您喜欢在旅途中阅读，但无法携带您的印刷书籍到处走？您的电子书购买是否与您选择的设备不兼容？

别担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取这些好处：

1.  扫描二维码或访问以下链接

![二维码图片](img/B19925_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781805122760`](https://packt.link/free-ebook/9781805122760)

1.  提交您的购买证明

1.  就这样！我们将直接将免费 PDF 和其他好处发送到您的电子邮件。

# 第一部分：简介

本部分将向您介绍一致预测。它将详细解释一致预测可以解决的问题类型，并概述其基于的一般思想。

本部分包含以下章节：

+   *第一章*, *介绍一致预测*

+   *第二章*, *一致预测概述*
