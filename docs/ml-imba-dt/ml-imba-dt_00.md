# 前言

欢迎大家！**机器学习**（**ML**）使计算机能够通过算法从数据中学习，以做出明智的决策、自动化任务并提取有价值的见解。一个经常引起注意的特定方面是不平衡数据，其中某些类别可能比其他类别有显著较少的样本。

本书提供了深入了解和导航倾斜数据复杂性的指南。你将获得在机器学习环境中管理不平衡数据集的最佳实践见解。

**尽管不平衡数据可能带来挑战，但重要的是要理解，解决这种不平衡的技术并非普遍适用。它们的相关性和必要性取决于各种因素，如领域、数据分布、你正在优化的性能指标以及商业目标。在采用任何技术之前，建立基线是至关重要的。即使你目前没有面临不平衡数据的问题，了解本书中讨论的挑战和解决方案也可能是有益的。熟悉这些技术将为你提供一套全面的工具箱，帮助你为可能尚未遇到的情况做好准备。如果你发现模型性能不佳，尤其是对于代表性不足（少数）类别，书中涵盖的见解和策略可以在指导有效改进方面发挥关键作用。**

随着机器学习和人工智能领域的不断扩展，对能够熟练处理各种数据挑战，包括不平衡数据的专业人士的需求将会增加。本书旨在为你提供知识和工具，让你成为那些备受追捧的专家之一。

# 本书面向的对象

这本全面的书精心设计，以满足各种专业人士的需求，包括以下人员：

+   **机器学习研究人员、机器学习科学家、机器学习工程师和学生**：在机器学习和深度学习领域寻求获得宝贵见解和实用知识，以应对数据不平衡带来的挑战的专业人士和学习者

+   **数据科学家和分析师**：渴望通过实际、现实世界的解决方案来扩展他们处理倾斜数据知识的数据专家

+   **软件工程师**：在处理不平衡数据时，希望有效地将机器学习和深度学习解决方案集成到他们的应用程序中的软件工程师

+   **实用洞察寻求者**：来自各个背景的专业人士和爱好者，他们希望通过实际、与行业相关的途径高效地处理机器学习和深度学习中的数据不平衡，从而在各自的岗位上脱颖而出

# 本书涵盖的内容

*第一章*, *机器学习中的数据不平衡介绍*，探讨了机器学习环境中数据不平衡的问题。本章阐述了不平衡数据的本质，将其与其他数据集类型区分开来。它还全面介绍了机器学习的基本组成部分以及当存在数据不平衡时最相关的模型性能指标。本章探讨了处理不平衡数据所涉及的问题和关注点，解释了它何时可能发生以及为什么有时可能是一个挑战。更重要的是，我们将讨论何时不必担心数据不平衡，或者何时可能不值得担心。此外，它介绍了`imbalanced-learn`库，提供了处理不平衡数据集复杂性的宝贵见解和一般指南。

*第二章*, *过采样方法*，介绍了过采样的概念，概述了何时使用以及何时不使用，以及增强不平衡数据集的各种技术。它通过使用`imbalanced-learn`库指导这些技术的实际应用，并比较它们在经典机器学习模型中的性能。本章以这些技术在现实场景中的有效性方面的实用建议结束。

*第三章*, *欠采样方法*，介绍了欠采样作为在标准过采样不可行时平衡数据的有效方法的概念。本章涵盖了从不平衡数据中有效删除示例的策略，处理噪声观察的不同方法，以及处理易于分类实例的程序。我们还将讨论何时应避免对多数类进行欠采样。

*第四章*, *集成方法*，探讨了包括袋装和提升在内的集成技术在增强机器学习模型性能中的应用。此外，它通过结合前几章中介绍的技术来解决不平衡数据集的挑战，其中传统的集成方法可能无效。

*第五章*, *代价敏感学习*，探讨了包括过采样和欠采样在内的采样技术的替代方案。本章强调了代价敏感学习作为一种有效策略来克服不平衡数据集问题的意义。我们还讨论了**阈值调整技术**，这在数据不平衡的背景下可能非常相关。

*第六章*, *深度学习中的数据不平衡*，介绍了深度学习的核心概念，并探讨了不平衡数据集提出的问题。您将研究各种深度学习应用中典型的不平衡数据挑战类型，并了解它们的影响。

*第七章*，*数据级深度学习方法*，标志着从传统机器学习到深度学习的转变，探讨了熟悉的数据级采样技术的调整，并在深度学习模型的背景下揭示了改进这些方法的机会。它深入探讨了结合深度学习与过采样和欠采样技术，包括图像和文本的动态采样和数据增强。它强调了深度学习和传统机器学习之间的基本区别，尤其是它们处理数据的性质，而深度学习处理的是如图像、文本、音频和视频这样的非结构化数据。本章还探讨了处理计算机视觉中类别不平衡的技术，以及它们在**自然语言处理**（**NLP**）问题中的应用。

*第八章*，*算法级深度学习技术*，在*第五章*，*成本敏感学习*的基础上扩展了概念，并将其应用于深度学习模型。我们通过使用 PyTorch 深度学习框架对损失函数进行修改来调整深度学习模型，从而提高模型性能并实现更有效的预测。

*第九章*，*混合深度学习方法*，探讨了连接前两章中数据级和算法级方法的创新技术。本章介绍了图机器学习的概念，并使用一个真实的 Facebook 社交网络数据集提供了关于解决深度学习中数据不平衡的有价值见解和实际应用。我们还将介绍硬挖掘损失的概念，并在此基础上探索一种称为**少数类增量校正**的专门技术，该技术将硬挖掘与交叉熵损失相结合。

*第十章*，*模型校准*，从不同的角度解决数据不平衡问题。本章不是关注数据预处理或模型构建，而是强调从训练模型获得的预测分数的后处理。这种后处理对于实时预测和离线模型评估都非常有价值。本章探讨了如何衡量模型的校准，并解释了为什么在处理不平衡数据时这一方面可能是不可或缺的。这尤其重要，因为数据平衡技术往往会导致模型校准不当。

*附录*，*生产环境中的机器学习管道*，提供了一个构建生产环境中遇到数据不平衡的 ML 管道的基础指南。本附录提供了一个简要的路线图，概述了在哪个顺序和阶段应该整合解决数据不平衡的技术。

# 📌 技术的使用 - 生产环境提示

在本书的整个过程中，你将遇到“在生产中”提示框，如下所示，突出显示所讨论技术的实际应用：

🚀 OpenAI 在生产中的类别重加权

OpenAI 试图解决图像生成模型 DALL-E 2 训练数据中的偏差问题[1]。DALL-E 2 在来自互联网的大量图像数据集上训练，这些数据可能包含偏差。例如，数据集中可能包含比女性更多的男性图像，或者比其他种族或民族群体更多的图像。

这些片段提供了关于知名公司如何应对数据不平衡以及他们采用了哪些策略来有效应对这些挑战的见解。例如，关于 OpenAI 使用 DALL-E 2 的方法的提示，揭示了在过滤训练数据和无意中放大偏差之间的复杂平衡。这样的例子强调了在处理不平衡数据时既要策略性强又要谨慎的重要性。为了深入了解具体细节并理解这些实现的细节，我们鼓励你关注公司博客或提供的论文链接。这些见解可以提供更清晰的理解，了解如何有效地适应和在不同现实场景中应用技术。 

# 要充分利用这本书

本书假设读者对机器学习、深度学习和 Python 编程有一定的基础知识。对`scikit-learn`和`PyTorch`的基本了解可能会有所帮助，尽管这些可以在学习过程中掌握。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Google Colab | Windows、macOS 或 Linux |

对于软件要求，你有两种执行本书中提供代码的选项。你可以选择在[`colab.research.google.com/`](https://colab.research.google.com/)的 Google Colab 在线运行代码，或者将代码下载到你的本地计算机上并执行。Google Colab 提供了一个无烦恼的选项，因为它预装了所有必要的库，因此你不需要在本地机器上安装任何东西。你只需要一个网络浏览器来访问 Google Colab 和一个 Google 账户。如果你更喜欢本地工作，请确保你已经安装了 Python（3.6 或更高版本），以及指定的库，如 PyTorch、torchvision、NumPy 和 scikit-learn。所需库的列表可以在本书的 GitHub 仓库中找到。这些库与 Windows、macOS 和 Linux 操作系统兼容。现代 GPU 可以加速书中稍后出现的深度学习章节的代码执行；然而，这不是强制性的。

**如果你使用的是本书的数字版，我们建议你亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将有助于避免与代码复制和粘贴相关的任何潜在错误。**

关于参考文献，我们使用编号参考文献，如“[6]”，你可以去该章节末尾的*参考文献*部分下载相应的参考文献（论文/博客/文章），无论是通过链接（如果提到）还是通过谷歌学术搜索（[`scholar.google.com/`](https://scholar.google.com/)）。

每章结束时，你将找到一系列旨在测试你对所涵盖内容的理解程度的问题。我们强烈建议你参与这些问题，以巩固你的学习。所选问题的答案或解决方案可以在本书末尾的评估部分找到。

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件[`github.com/PacktPublishing/Machine-Learning-for-Imbalanced-Data`](https://github.com/PacktPublishing/Machine-Learning-for-Imbalanced-Data)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`: 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个例子：“由于可以向`BaggingClassifier`提供一个基估计器，让我们使用最大树深为`6`的`DecisionTreeClassifier`。”

代码块设置如下：

```py
from collections import Counter X, y = make_data(sep=2)print(y.value_counts()) sns.scatterplot(data=X, x="feature_1", y="feature_2")plt.title('Separation: {}'.format(separation))plt.show()
```

**粗体**: 表示新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个例子：“**真负率**（**TNR**）：TNR 衡量的是实际负例被正确识别为负例的比例。”

小贴士或重要注意事项

看起来像这样。

# 联系我们

我们读者反馈总是受欢迎的。

**一般反馈**: 如果你对本书的任何方面有疑问，请通过客户关怀@packtpub.com 给我们发邮件，并在邮件主题中提及书名。

**勘误**: 尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果你在这本书中发现了错误，我们将不胜感激，如果你能向我们报告这个错误。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**: 如果你在互联网上以任何形式遇到我们作品的非法副本，如果你能提供位置地址或网站名称，我们将不胜感激。请通过版权@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《不平衡数据机器学习》，我们很乐意听听您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://www.packtpub.com/)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢随时随地阅读，但又无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

不要担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地点、任何设备上阅读。从您最喜欢的技术书籍中搜索、复制和粘贴代码直接到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件访问权限

按照以下简单步骤获取好处：

1.  扫描下面的二维码或访问以下链接

![](img/B17259_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781801070836`](https://packt.link/free-ebook/9781801070836)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件中
