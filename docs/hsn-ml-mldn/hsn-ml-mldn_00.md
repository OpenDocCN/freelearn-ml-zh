# 前言

**机器学习**（**ML**）在许多行业中得到广泛应用，如科学、医疗保健和研究，其受欢迎程度仍在不断增长。2018 年 3 月，微软推出了 ML.NET，以帮助.NET 爱好者与机器学习（ML）进行工作。通过这本书，你将探索如何使用 C#代码构建 ML.NET 应用程序，并使用各种 ML 模型。

本书首先为你概述了机器学习和使用的 ML 算法类型，同时介绍了 ML.NET 是什么以及为什么需要它来构建 ML 应用程序。然后，你将探索 ML.NET 框架、其组件和 API。本书将作为一本实用指南，帮助你使用 ML.NET 库构建智能应用程序。你将逐渐精通如何使用真实世界示例和数据集实现回归、分类和聚类等 ML 算法。每一章都将涵盖实际应用，展示如何在.NET 应用程序中实现 ML。你还将学习如何将 TensorFlow 集成到 ML.NET 应用程序中。稍后，你将发现如何将回归模型房价预测结果存储在数据库中，并使用 ASP.NET Core Blazor 和 SignalR 在 Web 应用程序中显示从数据库实时预测的结果。

在本书结束时，你将学会如何在 ML.NET 中自信地执行从基础到高级的机器学习任务。

# 本书面向对象

如果你是一名希望使用 ML.NET 实现机器学习模型的.NET 开发者，那么这本书适合你。这本书对寻找有效工具以实现各种机器学习算法的数据科学家和机器学习开发者也有益。为了有效地掌握本书中涵盖的概念，对 C#和.NET 的基本理解是必需的。

# 本书涵盖内容

第一章，*开始使用机器学习和 ML.NET*，讨论了机器学习是什么以及机器学习在我们当今社会中的重要性。它还介绍了 ML.NET，并在了解机器学习的概念及其相关性的基础上，更详细地介绍了如何开始使用它。

第二章，*设置 ML.NET 环境*，更详细地介绍了如何开始使用 ML.NET，继续概述机器学习以及 ML.NET 如何在新旧应用程序中帮助开发和运行模型。你将确保你的开发环境已设置好，章节结束时，将有一个简单的预训练模型在控制台应用程序中演示，表明你已准备好继续进行训练。

第三章，*回归模型*，讨论了在 ML.NET 中使用回归和逻辑回归模型，以及相关的数学知识以及这些模型可以帮助解决哪些问题。此外，本章提供了创建和使用 ML.NET 中的回归模型和逻辑回归模型的逐步说明。本章末尾详细介绍了使用数据集和 ML.NET 中的两个模型快速创建的命令行应用程序。

第四章，*分类模型*，讨论了在 ML.NET 中使用分类训练器模型以及分类模型可以帮助解决哪些问题。对于本章，我们将创建两个应用程序来展示 ML.NET 中的分类训练器支持。第一个应用程序使用 ML.NET 提供的 FastTree 训练器，根据几个属性和比较价格预测汽车是否具有良好价值。第二个应用程序使用 ML.NET 中的 SDCA 训练器对电子邮件数据（主题、正文、发件人）进行分类，将其分类为订单、垃圾邮件或朋友。通过这些应用程序，你还将学习如何评估分类模型。

第五章，*聚类模型*，讨论了在 ML.NET 中使用 k-means 聚类训练器，以及聚类模型可以帮助解决哪些问题。在本章中，我们将使用 ML.NET 提供的 k-means 聚类训练器来创建一个示例应用程序，该应用程序将文件分类为可执行文件、文档或脚本。此外，你还将学习如何在 ML.NET 中评估聚类模型。

第六章，*异常检测模型*，讨论了在 ML.NET 中使用异常检测模型以及异常检测模型可以帮助解决哪些问题。对于本章，我们将创建两个示例应用程序。第一个应用程序使用 ML.NET 与 SSA 检测网络流量异常，而第二个示例使用 ML.NET 与 PCA 检测一系列用户登录中的异常。通过这些应用程序，我们还将探讨如何在你训练了异常检测模型之后评估它。

第七章，*矩阵分解模型*，讨论了在 ML.NET 中使用矩阵分解模型，以及相关的数学知识以及矩阵分解模型可以帮助解决哪些问题。在本章中，我们将创建一个音乐推荐应用程序，使用 ML.NET 提供的矩阵分解训练器。利用几个数据点，这个推荐引擎将根据模型提供的训练数据推荐音乐。此外，在创建此应用程序之后，我们将学习如何在 ML.NET 中评估矩阵分解模型。

第八章，*使用 ML.NET 与.NET Core 和预测*，介绍了一个利用.NET Core 的实战应用，并使用回归和时间序列模型来演示股票价格的预测。

第九章，*使用 ML.NET 与 ASP.NET Core*，介绍了一个利用 ASP.NET 的实战应用，通过前端上传文件以确定其是否恶意。本章重点介绍如何使用二分类器并将其集成到 ASP.NET 应用程序中。

第十章，*使用 ML.NET 与 UWP*，介绍了一个利用 UWP 和 ML.NET 的实战应用。该应用将使用 ML.NET 来分类网页内容是否恶意。本章还将简要介绍 UWP 应用程序设计和 MVVM，以提供一个真正的生产就绪的示例应用程序，用于构建或适应其他应用程序以使用 ML.NET 与 UWP。

第十一章，*训练和构建生产模型*，涵盖了在规模上训练模型的所有考虑因素，以及使用 DMTP 项目正确训练生产模型。所学到的经验包括获取适当的训练集（多样性是关键）、适当的特征以及对你模型的真正评估。本章的重点是关于训练生产就绪模型的技巧、窍门和最佳实践。

第十二章，*使用 TensorFlow 与 ML.NET*，讨论了使用预训练的 TensorFlow 模型与 ML.NET 结合，通过 UWP 应用程序确定图片中是否有汽车。

第十三章，*使用 ONNX 与 ML.NET*，讨论了使用预训练的 ONNX 模型与 ML.NET 结合，以及将现有的 ONNX 格式模型直接带入 ML.NET 所增加的价值。

# 为了充分利用本书

您需要在计算机上安装 Angular 版本——如果可能的话，安装最新版本。所有代码示例都已使用 Windows OS 上的 Angular 9 进行测试。然而，它们也应该适用于未来的版本发布。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Microsoft Visual Studio 2019 | 一个常见的 Windows 10 开发环境，具有 20-50 GB 的空闲空间（强烈推荐使用四核处理器和 8 GB 的 RAM） |

**如果您正在使用这本书的数字版，我们建议您亲自输入代码或通过 GitHub 仓库（下一节中提供链接）访问代码。这样做将帮助您避免与代码复制/粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从[www.packt.com](http://www.packt.com)的账户下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问[www.packtpub.com/support](https://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com)登录或注册。

1.  选择支持选项卡。

1.  点击代码下载。

1.  在搜索框中输入书名，并遵循屏幕上的说明。

下载文件后，请确保使用最新版本解压缩或提取文件夹：

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

书籍的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Hands-On-Machine-Learning-with-ML.NET`](https://github.com/PacktPublishing/Hands-On-Machine-Learning-with-ML.NET)。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还有其他代码包，这些代码包来自我们丰富的书籍和视频目录，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`www.packtpub.com/sites/default/files/downloads/9781789801781_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/9781789801781_ColorImages.pdf)。

# 使用的约定

本书使用了多种文本约定。

`CodeInText`：表示文本中的代码词汇、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“应用程序首次运行时，使用图像和`tags.tsv`文件（将在下一节中讨论）训练 ML.NET 模型版本。”

代码块设置如下：

```py
public void Classify(string imagePath)
{
    var result = _prediction.Predict(imagePath);

    ImageClassification = $"Image ({imagePath}) is a picture of {result.PredictedLabelValue} with a confidence of {result.Score.Max().ToString("P2")}";
}
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
dotnet --version
3.0.100
```

**粗体**：表示新术语、重要词汇或屏幕上看到的词汇。例如，菜单或对话框中的文字会以这种方式显示。以下是一个示例：“首先，确保已选中**.NET 桌面开发**、**通用 Windows 平台开发**和**ASP.NET 和 Web 开发**。”

警告或重要提示如下所示。

技巧和窍门如下所示。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请在邮件主题中提及书名，并通过`customercare@packtpub.com`给我们发邮件。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告这一点，我们将不胜感激。请访问 [www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上以任何形式发现了我们作品的非法副本，如果您能向我们提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packt.com`与我们联系，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com/)。

# 评价

请留下您的评价。一旦您阅读并使用了这本书，为何不在购买它的网站上留下评价呢？潜在读者可以查看并使用您的客观意见来做出购买决定，我们 Packt 可以了解您对我们产品的看法，并且我们的作者可以查看他们对书籍的反馈。谢谢！

如需了解更多关于 Packt 的信息，请访问 [packt.com](http://www.packt.com/)。
