# 前言

*Python 特征工程食谱*涵盖了表格数据特征工程的几乎每个方面，包括缺失数据估计、分类编码、变量转换、离散化、缩放和异常值的处理。它还讨论了如何从日期和时间、文本、时间序列和关系数据集中提取特征。

本书将通过展示如何使用开源 Python 库来加速特征工程过程，通过多个实用的、动手的食谱来减轻特征工程的痛苦。在整个书中，你将利用`pandas`和`scikit-learn`转换和创建新的变量。此外，你还将学会利用四大开源特征工程库的力量——Feature-engine、Category Encoders、Featuretools 和 tsfresh。

你还将发现第二版中没有的额外食谱。这些包括在时间序列中估计缺失数据、使用决策树创建新特征以及使用中位数绝对偏差突出显示异常值。更重要的是，我们提供了指导方针，帮助你根据你的模型和数据特征决定使用哪些转换。你将确切知道每个特征转换是什么、为什么以及如何实现。

# 本书面向对象

本书面向机器学习和数据科学的学生和专业人员，以及参与部署机器学习模型的软件工程师，他们希望提高在数据转换和特征创建方面的技能，以改善模型训练。本书旨在为任何对特征工程感兴趣或正在从事特征工程的人提供清晰的指导，说明做什么、如何做以及为什么它很重要。本资源超越了基础知识，提供了实用的见解和详细的解释，帮助你有效地掌握特征工程。

# 本书涵盖内容

*第一章*，*估计缺失数据*，探讨了用合适的估计值替换数值、分类和时间序列数据中缺失值的技术。它涵盖了单次和多次估计方法，并展示了如何使用 scikit-learn 和 Feature-engine 简化估计过程。

*第二章*，*编码分类变量*，涵盖了将分类变量转换为数值特征的方法。它从常见技术如独热编码和顺序编码开始，然后探讨高基数和线性模型的适应性。本章还讨论了特定领域的编码方法，如证据权重，并展示了如何使用目标编码等方法编码高基数变量，确保你了解如何规范化过程以避免过拟合。

*第三章*，*转换数值变量*，讨论了何时以及为什么需要在机器学习模型中使用变量转换。然后展示了不同的变量转换函数，并强调每个函数最适合哪种类型的变量。到本章结束时，你将了解何时需要转换你的变量，以及为什么你应用对数或其他函数。

*第四章*，*执行变量离散化*，介绍了离散化的概念，强调了其在机器学习中的应用。该章节探讨了各种离散化方法，详细说明了它们的优缺点。它涵盖了基本的等宽和等频离散化过程，以及使用决策树和*k*-means 的离散化。最后，它将离散化与编码相结合，以返回与目标单调的变量。

*第五章*，*处理异常值*，介绍了识别异常值及其特征的方法。然后讨论了移除异常值或调整其值以适应可接受边界的技巧，利用 pandas 和 Feature-engine。

*第六章*，*从日期和时间变量中提取特征*，描述了如何从日期和时间变量中创建特征。它涵盖了如何从特征中提取日期和时间组件，以及如何组合日期时间变量以及如何处理不同的时区。

*第七章*，*执行特征缩放*，涵盖了将变量置于相似尺度的方法。它讨论了标准化，如何缩放到最大和最小值，以及如何执行更稳健的变量缩放形式。你还将找到关于根据你的模型和变量选择哪种方法的指南。

*第八章*，*创建新特征*，描述了将现有变量组合起来生成新特征的各种方法。它展示了基于领域知识的数学运算如何结合特征。然后讨论了如何通过正弦、余弦和样条曲线的使用来转换特征。最后，它展示了通过决策树从一个或多个变量中创建特征的价值。

*第九章*，*使用 Featuretools 从关系数据中提取特征*，介绍了关系数据集，然后解释了如何利用 Featuretools 在不同数据聚合级别上创建特征。你将学习如何从数值和分类变量、日期时间以及文本中自动创建数十个特征。

*第十章*，*使用 tsfresh 从时间序列创建特征*，讨论了如何自动从时间序列数据中创建数百个特征，用于监督分类或回归。您将利用 tsfresh 的强大功能来自动创建和选择与您的时序数据相关的特征。

*第十一章*，*从文本变量中提取特征*，探讨了有效的方法来清理和提取用于监督学习模型的短文本段特征。本章涵盖了计数单词、句子和字符以及测量词汇多样性的技术。此外，它指导您通过文本清理过程，并演示了如何通过计数单词来构建特征矩阵。

# 要充分利用本书

本书提供了实用的工具和技术，以简化您的特征工程流程，让您能够提高代码质量并简化流程。本书探讨了使用 Python 转换和创建特征的方法，以有效地训练机器学习模型。因此，熟悉机器学习和 Python 编程将有助于您理解和应用所提出的概念。

这些食谱已在以下库版本中进行了测试：

+   `category-encoders == 2.6.3`

+   `Feature-engine == 1.8.0`

+   `featuretools == 1.31.0`

+   `matplotlib==3.8.3`

+   `nltk=3.8.1`

+   `numpy==1.26.4`

+   `pandas==2.2.1`

+   `scikit-learn==1.5.0`

+   `scipy==1.12.0`

+   `seaborn==0.13.2`

+   `tsfresh==0.20.0`

| **本书中涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.9 或更高版本 | Windows、macOS 或 Linux |

*请注意，Python 库的较早或较新版本可能会阻止代码运行。如果您使用的是较新版本，请确保检查其文档以获取任何最近的更新、参数名称更改或弃用。*

**如果您使用的是本书的数字版，我们建议您亲自输入代码或通过 GitHub 仓库（下一节中提供链接）访问代码。这样做将帮助您避免与代码复制和粘贴相关的任何潜在错误。**

## 下载示例代码文件

您可以从 GitHub（[`github.com/PacktPublishing/Python-Feature-Engineering-Cookbook-Third-Edition`](https://github.com/PacktPublishing/Python-Feature-Engineering-Cookbook-Third-Edition)）下载本书的示例代码文件。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还有其他丰富的图书和视频的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“我们使用`year`、`month`和`quarter`分别在新列中捕获年份、月份和季度。”

代码块设置如下：

```py
date = "2024-05-17"
rng_hr = pd.date_range(date, periods=20, freq="h")
rng_month = pd.date_range(date, periods=20, freq="ME")
df = pd.DataFrame({"date1": rng_hr, "date2": rng_month})
```

任何命令行输入或输出都如下所示：

```py
pip install yellowbrick
```

小贴士或重要提示

看起来像这样。

# 部分

在这本书中，你将发现几个经常出现的标题（*准备就绪*，*如何操作...*，*它是如何工作的...*，*还有更多...*，以及*也看看*）。

为了清楚地说明如何完成食谱，请按照以下方式使用这些部分：

## 准备就绪

本节告诉您在食谱中可以期待什么，并描述如何设置任何软件或任何为食谱所需的初步设置。

## 如何操作…

本节包含遵循食谱所需的步骤。

## 它是如何工作的…

本节通常包含对前一个节中发生的事情的详细解释。

## 还有更多…

本节包含有关食谱的附加信息，以使您对其有更深入的了解。

## 也看看

本节提供了对食谱的其他有用信息的链接。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请在邮件主题中提及书名，并通过客户关怀@packtpub.com 给我们发送电子邮件。

**勘误表**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现错误，我们将不胜感激，如果您能向我们报告，我们将非常感谢。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)，选择您的书，点击**勘误提交表单**链接，并输入详细信息。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过版权@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

读完*Python 特征工程食谱*后，我们非常乐意听到您的想法！请[点击此处直接进入本书的亚马逊评论页面](https://packt.link/r/1835883591)并分享您的反馈。

您的评论对我们和科技社区都很重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但又无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在购买每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止这些，您还可以获得独家折扣、时事通讯和丰富的免费内容，每天直接发送到您的收件箱

按照以下简单步骤获取福利：

1.  扫描下面的二维码或访问以下链接

![图片](img/B22396_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83588-358-7`](https://packt.link/free-ebook/978-1-83588-358-7)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他福利发送到您的邮箱
