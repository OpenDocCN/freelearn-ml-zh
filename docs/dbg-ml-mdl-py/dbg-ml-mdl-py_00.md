# 前言

欢迎阅读 *使用 Python 调试机器学习模型* – 您掌握机器学习的全面指南。本书旨在帮助您从机器学习的基本概念进步到专家级模型开发的复杂性，确保您的旅程既具有教育性又具有实用性。在本书中，我们超越了简单的代码片段，深入到构建可靠、工业级模型的整体过程。从模块化数据准备的细微差别到模型无缝集成到更广泛的技术生态系统中，每一章都是精心策划的，以弥合基本理解和高级专业知识之间的差距。

我们的旅程不仅仅停留在模型创建上。我们将深入探讨评估模型性能、定位挑战，并为您提供有效的解决方案。强调在生产环境中引入和维护可靠模型的重要性，本书将为您提供应对数据处理和建模问题的技术。您将了解可重复性的重要性，并获得实现它的技能，确保您的模型既一致又可靠。此外，我们将强调公平性、消除偏见以及模型可解释性的艺术，确保您的机器学习解决方案是道德的、透明的和可理解的。随着我们的进展，我们还将探索深度学习和生成建模的前沿，通过使用 PyTorch 和 scikit-learn 等知名 Python 库的实践练习来丰富内容。

在机器学习不断演变的领域中，持续学习和适应是必不可少的。本书不仅是一个知识库，也是一个激励者，激发您进行实验和创新。随着我们深入探讨每个主题，我邀请您以好奇心和探索的意愿来对待它，确保您获得的知识是深入且可操作的。让我们共同塑造机器学习的未来，一次构建一个模型。

# 本书面向对象

本书面向数据科学家、分析师、机器学习工程师、Python 开发人员和希望为各种工业应用构建可靠、高性能、可重复、可信和可解释的机器学习模型的学生。您只需要基本的 Python 技能就可以深入理解本书涵盖的概念和实践示例。无论您是机器学习的新手还是有经验的从业者，本书都提供了广泛的知识和实践见解，以提升您的建模技能。

# 本书涵盖内容

*第一章*，*超越代码调试*，概述了代码调试的简要回顾以及为什么调试机器学习模型超出了这一点。

*第二章*，*机器学习生命周期*，教您如何为您的项目设计一个模块化的机器学习生命周期。

*第三章*，*向负责任的 AI 调试*，解释了负责任机器学习建模中的担忧、挑战和一些技术。

*第四章*，*检测机器学习模型中的性能和效率问题*，教你如何正确评估你的机器学习模型的性能。

*第五章*，*提高机器学习模型性能*，教你不同的技术来提高你的机器学习模型性能和泛化能力。

*第六章*，*机器学习建模中的可解释性和可解释性*，涵盖了机器学习可解释性技术。

*第七章*，*减少偏差和实现公平性*，解释了一些技术细节和工具，你可以使用它们来评估模型的公平性并减少偏差。

*第八章*，*使用测试驱动开发控制风险*，展示了如何使用测试驱动开发工具和技术来降低不可靠建模的风险。

*第九章*，*生产环境下的测试和调试*，解释了测试和模型监控技术，以确保在生产中有可靠的模型。

*第十章*，*版本控制和可重复的机器学习建模*，教你如何使用数据和模型版本控制来实现机器学习项目中的可重复性。

*第十一章*，*避免和检测数据与概念漂移*，教你如何检测你的机器学习模型中的漂移，以确保在生产中有可靠的模型。

*第十二章*，*超越 ML 调试的深度学习*，涵盖了深度学习建模的介绍。

*第十三章*，*高级深度学习技术*，涵盖了卷积神经网络、转换器和图神经网络，用于不同数据类型的深度学习建模。

*第十四章*，*机器学习最新进展介绍*，解释了生成建模、强化学习和自监督学习的最新进展的介绍。

*第十五章*，*相关性对因果性*，解释了因果建模的益处和一些实际的技术。

*第十六章*，*机器学习中的安全和隐私*，展示了在机器学习环境中保护隐私和确保安全的一些挑战，并教你一些应对这些挑战的技术。

*第十七章*，*人机协同机器学习*，阐述了人机协同建模的益处和挑战。

# 为了充分利用这本书

为了遵循本书中给出的说明，您需要了解以下基本知识：

+   通过**集成开发环境**（**IDE**）、Jupyter 笔记本或 Colab 笔记本访问 Python。

+   Python 编程基础。

+   对机器学习建模和术语的基本理解，例如监督学习、无监督学习以及模型训练和测试。

拥有包含所有所需库的虚拟环境将帮助您在本书的每个章节中运行代码，这些代码以 Jupyter 笔记本的形式提供在本书的关联 GitHub 仓库中。

本书所需的 Python 库包括：sklearn >= 1.2.2, numpy >= 1.22.4, pandas >= 1.4.4, matplotlib >= 3.5.3, collections >= 3.8.16, xgboost >= 1.7.5, sklearn >= 1.2.2, ray >= 2.3.1, tune_sklearn >= 0.4.5, bayesian_optimization >= 1.4.2, imblearn, pytest >= 7.2.2, shap >= 0.41.0, aif360 >= 0.5.0, fairlearn >= 0.8.0, pytest >= 3.6.4, ipytest >= 0.13.0, mlflow >= 2.1.1, libi_detect >= 0.11.1, lightgbm >= 3.3.5, evidently >= 0.2.8, torch >= 2.0.0, torchvision >= 0.15.1, transformers >= 4.28.0, datasets >= 2.12.0, torch_geometric == 2.3.1, dowhy == 0.5.1, bnlearn == 0.7.16, tenseal >= 0.3.14, pycryptodome = 3.18.0, pycryptodomex = 3.18.0

或者，您可以使用在线服务，如 Colab，并作为 Colab 笔记本运行笔记本。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python >=3.6 | Windows, macOS, 或 Linux |
| DVC >= 1.10.0 |  |

为了避免重复并使本书尽可能简短，每个代码单元中省略了导入所需库的步骤。拥有本书的 GitHub 仓库将帮助您确定每段代码所需的库以及如何安装它们。由于本书不是单一命令教程书，大多数示例都包括多行过程。因此，在大多数章节中，您不能在不注意所需库、它们的安装以及之前的代码行的情况下复制粘贴单个行。

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误**。

# 下载示例代码文件

您可以从 GitHub 在[`github.com/PacktPublishing/Debugging-Machine-Learning-Models-with-Python`](https://github.com/PacktPublishing/Debugging-Machine-Learning-Models-with-Python)上下载本书的示例代码文件。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有来自我们丰富的图书和视频目录的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“将下载的`WebStorm-10*.dmg`磁盘映像文件作为系统中的另一个磁盘挂载。”

代码块设置如下：

```py
import pandas as pdorig_df = pd.DataFrame({
    'age': [45, 43, 54, 56, 54, 52, 41],
    'gender': ['M', 'F', 'F', 'M', 'M', 'F', 'M'],
    'group': ['H1', 'H1', 'H2', 'H3', 'H2', 'H1', 'H3'],
    'target': [0, 0, 1, 0, 1, 1, 0]})
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
in_encrypt = open("molecule_enc.bin", "rb")nonce, tag, ciphertext = [in_encrypt.read(x) for x in (16, 16, -1) ]
in_encrypt.close()
```

任何命令行输入或输出都如下所示：

```py
python -m pytest
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“您可能能够找到其他裂纹产品的图像，或者您可以使用称为**数据增强**的过程生成新的图像。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

读者的反馈总是受欢迎的。

**总体反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送给我们 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告这一点。请访问[www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过电子邮件联系版权@packt.com，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](https://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《使用 Python 调试机器学习模型》，我们很乐意听到您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://www.packtpub.com/)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

不要担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不会就此结束，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取好处：

1.  扫描下面的二维码或访问以下链接

![二维码](img/B16369_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-80020-858-2`](https://packt.link/free-ebook/978-1-80020-858-2)

1.  提交您的购买证明

1.  就这些了！我们将直接将您的免费 PDF 和其他福利发送到您的邮箱

# 第一部分：机器学习建模调试

在本书的这一部分，我们将深入探讨机器学习发展的不同方面，这些方面超越了传统的范式。第一章阐明了传统代码调试与机器学习调试专门领域的细微差别，强调机器学习中的挑战超越了单纯的代码错误。下一章提供了一个关于机器学习生命周期的全面概述，突出了模块化在简化并增强模型开发中的作用。最后，我们将强调在追求负责任的人工智能过程中模型调试的重要性，强调其在确保道德、透明和有效的机器学习解决方案中的作用。

本部分包含以下章节：

+   *第一章**，超越代码调试*

+   *第二章**，机器学习生命周期*

+   *第三章**，向负责任的人工智能调试*
