# 前言

在这本书中，你将发现是什么让 Databricks 数据智能平台成为顶级机器学习解决方案的首选。*Databricks ML in Action* 通过在 Databricks 平台上执行数据科学、机器学习和生成式 AI 项目的端到端示例，展示了云无关的实践。你将在学习如何在实际工作流程中实际应用它们的过程中，掌握 Databricks 的托管 MLflow、向量搜索、AutoML、Unity 目录和模型服务方面的专业知识。这本书不仅提供了详细的代码解释，还促进了代码的无缝导入，以便实际使用。你会发现如何利用开源的 Databricks 平台，通过补充资源来增强你的学习，提高你的技能，并提高你的生产力。到本书结束时，你将精通使用 Databricks 进行数据科学、机器学习和生成式 AI，使你能够交付卓越的数据产品。

# 这本书面向谁

这本书面向寻求在实施和利用 Databricks 数据智能平台及其湖仓架构以创建数据产品的机器学习工程师、数据科学家和技术经理。

# 这本书涵盖的内容

*第一章*，*使用本书和湖仓概念入门*，涵盖了数据工程和机器学习的技术和方法。目标不是揭示以前从未见过的数据洞察。如果是那样的话，这将是一篇学术论文。相反，本章的目标是利用开放和免费的数据来展示高级技术和最佳实践。你将列出并描述书中出现的每个数据集。

*第二章*，*设计 Databricks：第一天*，涵盖了工作空间设计、模型生命周期实践、命名约定、不要放入 DBFS 中的内容以及其他准备性话题。Databricks 平台易于使用。然而，有许多选项可供选择，以满足不同组织的需求。在我的承包商生涯和我在 Databricks 的时间中，我看到了团队的成功与失败。我将与你分享成功的动态以及本章中伴随这些洞察的任何配置。

*第三章*，*构建我们的青铜层*，通过探索奖牌架构青铜层的基本原理，开始你在 Databricks DI 平台中的数据之旅。青铜层是转换你的数据以用于下游项目的第一步，本章将重点介绍你可用于必要转换的 Databricks 功能和技术。我们将首先向你介绍自动加载器，这是一个用于自动化数据摄入的工具，你可以使用或不需要**Delta Live Tables**（**DLT**）来插入和转换你的数据。

*第四章*，*了解您的数据*，探讨了 Databricks DI 平台内有助于提高和监控数据质量以及促进数据探索的功能。使用 Databricks 更好地了解数据有众多方法。首先，我们将介绍如何使用 DLT 来监督数据质量，以尽早发现质量问题并防止整个管道的污染。我们将首次深入了解 Lakehouse 监控，它帮助我们分析数据随时间的变化，并可以提醒我们关注的变化。

*第五章*，*在 Databricks 上进行特征工程*，从*第四章*开始，我们在那里利用 Databricks 的力量来探索和精炼我们的数据集，深入探讨 Databricks 的组件，这些组件使下一步的特征工程成为可能。我们将首先介绍在 Unity Catalog 中的**Databricks 特征工程**（**DFE**），向您展示您如何使用 Unity Catalog 高效地管理工程特征。了解如何在 UC 中利用 DFE 对于创建跨训练和推理的可重复和一致的特征至关重要。然后，您将学习如何利用 Structured Streaming 在流上计算特征，这允许您创建模型做出快速决策所需的状态化特征。

*第六章*，*寻找信号*，探讨了如何利用数据科学在数据的噪声中寻找隐藏的信号。我们将利用上一章在 Databricks 平台上创建的特征。我们将首先使用 AutoML 进行基本的建模方法，提供自动生成的代码，并快速使数据科学家能够建立基准模型以超越。在寻找信号时，我们尝试不同的特征、超参数和模型。从历史上看，跟踪这些配置及其相应的评估指标本身就是一项耗时的工作。MLflow 提供的一种低开销跟踪机制，如用于管理数据科学项目和支撑 MLOps 的开源平台 MLflow 提供的跟踪，将减轻手动捕获配置的负担。更具体地说，我们将介绍 MLflow 跟踪，这是一个显著提高跟踪每个排列众多输出的 MLflow 组件。然而，这仅仅是开始。

*第七章*，*在 Databricks 上生产化机器学习*，探讨了使用 Databricks 产品生产化机器学习模型，通过整合 Unity Catalog 注册、Databricks 工作流、Databricks 资产包和模型服务功能等功能，使这一旅程更加直接和连贯。本章将涵盖将您的模型从开发到生产的工具和实践。

*第八章*，*监控、评估和更多*，介绍了如何在新的 Lakeview 仪表板和标准的 DBSQL 仪表板中创建仪表板的可视化。部署的模型可以通过网络应用程序共享。因此，我们不仅将介绍 Hugging Face Spaces，还将使用 Gradio 应用程序部署 RAG 聊天机器人，以应用我们所学到的知识。

# 要充分利用本书

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Databricks | Windows, macOS, 或 Linux |
| Python 及其相关库 | Windows, macOS, 或 Linux |

**如果您正在使用本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

本书包含一些较长的截图，这些截图是为了展示工作流程的概览以及用户界面。因此，在 100% 缩放时，这些图像中的内容可能看起来很小。请查看随书提供的 PDF 复印件以放大以获得更清晰的图像。

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件 [`github.com/PacktPublishing/Databricks-ML-In-Action`](https://github.com/PacktPublishing/Databricks-ML-In-Action)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的书籍和视频目录的代码包可供在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 获取。查看它们吧！

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“例如，你可以选择`ml_in_action.favorita_forecasting.train_set`表。”

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以粗体显示。以下是一个示例：“一旦你有了数据集，请返回到**画布**选项卡。”

小贴士或重要注意事项

看起来像这样。

# 联系我们

读者反馈始终欢迎。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将非常感激您能向我们报告。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过版权@packtpub.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

读完《Databricks ML in Action》后，我们非常乐意听到您的想法！请[点击此处直接转到该书的亚马逊评论页面](https://packt.link/r/1-800-56489-9)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？

您选择的设备是否与您的电子书购买不兼容？

不要担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不止于此，您还可以获得独家访问折扣、时事通讯和每日收件箱中的精彩免费内容。

按照以下简单步骤获取这些优惠：

1.  扫描二维码或访问以下链接

![](img/B16865_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-80056-489-3`](https://packt.link/free-ebook/978-1-80056-489-3)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件中

# 第一部分：Databricks 统一湖仓平台概述

本部分的目标不是揭示以前从未见过的数据洞察。如果是那样，这将是一篇学术论文。相反，目标是使用开放和免费的数据来展示高级技术和最佳实践。本部分将列出并描述本书中存在的每个数据集。它还向您介绍本部分中洞察背后的成功动态以及任何配置。本部分涵盖工作空间设计、模型生命周期实践、命名约定、不要放入 DBFS 的内容以及其他准备性话题。

本部分包含以下章节：

+   *第一章*，*本书和湖仓概念入门*

+   *第二章*，*设计 Databricks：第一天*

+   *第三章*，*构建我们的青铜层*
