# 前言

**机器学习**（**ML**）以之前被认为不可能的方式革命了技术行业和我们的日常生活。通过将 ML 算法与**微服务架构**（**MSA**）相结合，组织能够创建智能、健壮、灵活和可扩展的企业系统，这些系统能够适应不断变化的企业需求并提高整体系统性能。

这本书是一本全面的指南，涵盖了构建智能 MSA 系统的不同方法以及解决系统设计和运营中面临的常见实际挑战。

书的第一部分提供了对 MSA 及其应用的全面介绍。你将了解常见的企业系统架构、MSA 的概念和价值，以及它与传统企业系统的不同之处。在这一部分，你将了解 MSA 的设计、部署和运营，包括 DevOps 流程的基础。

书的第二部分深入探讨了 ML 及其在 MSA 系统中的应用。你将了解关键的 ML 算法及其在 MSA 中的应用，包括回归模型、多类分类、文本分析和**深度学习**（**DL**）。这一部分提供了如何开发 ML 模型、组件和子组件的全面指南，以及如何在 MSA 系统中应用它们。

书的最后一部分将前几部分涵盖的内容汇总在一起。它提供了一个逐步指南，用于设计和开发智能系统，包括实际案例和可导入实际用例的实际代码。你还将了解 DevOps 在企业 MSA 系统中的应用，包括组织结构对齐、质量保证测试和变更管理。

在阅读完这本书之后，你将对 MSA 及其益处有一个扎实的理解，并具备构建自己的智能 MSA 系统以及迈向实现更好的业务成果、运营绩效和业务连续性的第一步所需的技术和知识。无论你是初学者还是有经验的开发者，这本书都是理解并应用 MSA 和 ML 在企业系统中的完美指南。

# 这本书面向谁

这本书非常适合 ML 解决方案架构师、系统和 ML 开发者以及系统和解决方案集成人员。这些人将从这本书中获得最大收益，因为它涵盖了 ML 中的关键概念和最佳实践。这本书的编写是为了给这些专业人士提供实施智能 MSA 解决方案所需的知识和技能。

要充分利用本书，您应具备基本的系统架构和操作知识。此外，对 Python 编程语言的熟练掌握非常受欢迎。这是因为本书中的示例和案例研究主要是用 Python 实现的。然而，本书涵盖的概念和最佳实践也可以应用于其他编程语言和技术。本书旨在提供 ML 的坚实基础，同时帮助您深化现有的知识和技能。

# 本书涵盖的内容

*第一章*，*MSA 和机器学习在企业系统中的重要性*，介绍了 MSA 及其在提供具有竞争力和可靠性的企业系统中的作用。本章将比较 MSA 与传统单体企业系统，并讨论部署和运营 MSA 系统的益处和挑战。它还将涵盖 MSA 的关键概念，包括服务驱动和事件驱动架构以及拥抱 DevOps 在构建 MSA 系统中的重要性。

*第二章*，*重构单体系统*，专注于从单体架构到 MSA 的过渡过程。它强调如何重构单体系统以构建灵活且可靠 MSA 系统。本章将探讨过渡到 MSA 所需的步骤，包括识别微服务、分解业务需求和分解功能和数据。本章将提供通过采用 MSA 来现代化组织企业系统的见解。

*第三章*，*解决常见的 MSA 企业系统挑战*，讨论了应对保持可靠、耐用和顺畅运行的 MSA 系统挑战的方法。本章涵盖了使用**反腐败层**（**ACL**）进行 MSA 系统隔离、API 网关、服务目录和编排器、微服务聚合器和微服务断路器等主题；网关、编排器和聚合器之间的区别；以及其他 MSA 系统增强措施。

*第四章*，*关键机器学习算法和概念*，提供了对基本 AI、ML 和 DL 概念的全面理解，以使您具备在 MSA 系统中构建和部署 AI 模型所需的知识。它涵盖了这些领域之间的区别，并概述了在 Python 中使用的常见 ML 包和库。然后，章节深入探讨了 ML 的各种应用，包括构建回归模型、多类分类、文本情感分析和主题建模、模式分析和预测，以及使用 DL 构建增强模型。

*第五章*, 《机器学习系统设计》，全面介绍了构建 ML 管道的设计考虑因素和涉及组件，并为您提供构建和部署强大且高效的 ML 系统所需的知识。本章涵盖了拟合和转换接口、训练和提供接口以及编排的主要概念。

*第六章*, 《稳定机器学习系统》，使您对数据集偏移现象及其在 ML 系统中如何解决有全面的理解，以确保稳定和准确的结果。本章讨论了在保持其功能目标的同时，可以应用于解决数据集偏移的优化方法。本章涵盖了 ML 参数化概念、数据集偏移的原因、识别数据集偏移的方法以及处理和稳定数据集偏移的技术。

*第七章*, 《机器学习和深度学习如何帮助 MSA 企业系统》，通过讨论您可以在智能企业 MSA 系统中应用 ML 和 DL 的不同用例来总结前几章。您将了解一些可能的用例，例如使用监督线性回归模型进行模式分析和使用深度学习进行自我修复。

*第八章*, 《在构建智能 MSA 系统中 DevOps 的作用》，向您介绍如何在构建和运行 MSA 系统中应用 DevOps 的概念。本章涵盖了 DevOps 与组织结构的对齐、企业 MSA 系统操作中的 DevOps 流程，以及从开始到运维和应用的 DevOps 应用。

*第九章*, 《使用 Docker 容器构建 MSA》，介绍了容器及其在 Docker 平台上的应用，Docker 是该领域广泛使用的平台。本章涵盖了容器及其用途概述、Docker 的安装、创建我们示例项目的容器，以及 MSA 项目中的微服务之间的交互通信。目标是为您提供对容器及其在 MSA 中如何利用的全面理解。

*第十章*，*构建智能 MSA 系统*，将 MSA 和**人工智能**（**AI**）的概念结合起来，构建一个演示智能-MSA 系统。该系统将使用各种 AI 算法来增强之前在书中创建的原生 MSA 演示系统的性能和操作。智能-MSA 将能够检测交通模式中的潜在问题，并自我纠正或自我调整以防止问题发生。本章涵盖了使用机器学习的优势、构建第一个 AI 微服务、演示智能-MSA 系统的实际操作以及分析 AI 服务的操作。目标是让您全面了解如何将 AI 集成到 MSA 系统中以增强其性能和操作。

*第十一章*，*管理新系统的部署——绿地与棕地对比*，介绍了在绿地和棕地部署中部署智能-MSA 系统。它提供了在保持整体系统稳定性和业务连续性的同时平稳部署新系统的方法。本章涵盖了部署策略、绿地与棕地部署之间的差异以及克服部署挑战的方法，特别是在棕地部署中，现有系统已经投入生产。

*第十二章*，*部署、测试和运行智能 MSA 系统*，是最后一章，它整合了书中涵盖的所有概念，提供了部署智能 MSA 系统的实际操作和实用示例。它教您如何将书中学到的概念应用到您的部署需求和标准中。本章假设存在一个现有的单体架构系统，并涵盖了克服部署依赖性、部署 MSA 系统、测试和调整系统以及进行部署后审查。

# 为了最大限度地利用这本书

为了最大化您的学习体验，您应该对系统架构、软件开发概念、DevOps 和数据库系统有基本的了解。虽然不需要有 MySQL 和 Python 的先前经验，但它将有助于更有效地理解代码示例中的概念。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Docker | Ubuntu Linux 或 macOS |
| Python | Linux、Windows 或 macOS |
| MySQL | Ubuntu Linux 或 macOS |
| VirtualBox | Windows 或 macOS |

我们建议您安装一个 Python IDE，例如 PyCharm，以便能够跟随 Python 示例。PyCharm 可以从[`www.jetbrains.com/lp/pycharm-anaconda/`](https://www.jetbrains.com/lp/pycharm-anaconda/)下载。

使用 VirtualBox 构建演示环境和创建测试虚拟机。您可以从 [`www.virtualbox.org/wiki/Downloads`](https://www.virtualbox.org/wiki/Downloads) 下载 VirtualBox。

Ubuntu Linux 是我们在书中用来安装 Docker 和其他工具的操作系统。要下载最新的 Ubuntu 版本，请使用以下链接：[`ubuntu.com/desktop`](https://ubuntu.com/desktop)。

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件 [`github.com/PacktPublishing/Machine-Learning-in-Microservices`](https://github.com/PacktPublishing/Machine-Learning-in-Microservices)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包，可在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 获取。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码词汇、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号。以下是一个示例：“完成 Dockerfile 的编写后，您需要将其保存为 `Dockerfile`，以便能够使用它创建 Docker 镜像。”

代码块设置如下：

```py
import torch
model = torch.nn.Sequential( # create a single layer Neural Network
    torch.nn.Linear(3, 1),
    torch.nn.Flatten(0, 1)
)
loss = torch.nn.MSELoss(reduction='sum')
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
import numpy as np
from scipy import linalg
a = np.array([[1,4,2], [3,9,7], [8,5,6]])
print(linalg.det(a)) # calculate the matrix determinate
57.0
```

任何命令行输入或输出都按照以下方式编写：

```py
$ docker --version
Docker version 20.10.18, build b40c2f6
```

**粗体**：表示新术语、重要词汇或屏幕上看到的词汇。例如，菜单或对话框中的文字会以粗体显示。以下是一个示例：“从**管理**面板中选择**系统信息**。”

提示或重要注意事项

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过 customercare@packtpub.com 发送电子邮件，并在邮件主题中提及书名。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们非常感谢您能向我们报告。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

**盗版**：如果您在互联网上发现我们作品的任何非法副本，我们非常感谢您能提供位置地址或网站名称。请通过 copyright@packt.com 联系我们，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com.](http://authors.packtpub.com.)

# 分享您的想法

一旦您阅读了《微服务中的机器学习》，我们很乐意听听您的想法！请[点击此处直接进入亚马逊评论页面](https://packt.link/r/1-804-61774-1)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？您的电子书购买是否与您选择的设备不兼容？

请放心，现在每购买一本 Packt 图书，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件访问权限

按照以下简单步骤获取福利：

1.  扫描二维码或访问以下链接

![二维码](img/B18934_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781804617748`](https://packt.link/free-ebook/9781804617748)

1.  提交您的购买证明

1.  这就是全部！我们将直接将您的免费 PDF 和其他福利发送到您的电子邮件中

# 第一部分：微服务设计和架构概述

我们将从提供对**微服务架构**（**MSA**）及其在企业系统中的应用的全面介绍开始*第一部分*。我们将了解常见的企业系统架构、MSA 的概念和价值，以及它与传统企业系统的不同之处。在整个本部分中，我们将了解 MSA 的设计、部署和运营，包括 DevOps 流程的基础。

我们将更深入地了解每个企业架构模型最佳使用案例的使用情况。*第一部分*还将探讨如何设计一个基本的模块化、灵活、可扩展和健壮的 MSA，包括如何将业务需求转化为微服务。我们将获得关于过渡到 MSA 的不同方法及其优缺点的深入了解。

本部分讨论了设计真实 MSA 的挑战，并提供了解决这些挑战的工具和技术。我们将了解用于优化系统模块化、可测试性、可部署性和运营的企业系统组件。

*第一部分*旨在为读者提供对 MSA、其优势和如何在企业系统中实施 MSA 的坚实基础。

本部分包括以下章节：

+   *第一章*，*企业系统中 MSA 和机器学习的重要性*

+   *第二章*, *重构单体架构*

+   *第三章*, *解决常见 MSA 企业系统挑战*
